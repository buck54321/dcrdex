{"version":3,"file":"entry.js","mappings":";2BAAA,IAAIA,EAAU,eACd,SAASC,IACP,aACAC,EAAOC,QAAUF,EAAsB,WACrC,OAAOE,CACT,EAAGD,EAAOC,QAAQC,YAAa,EAAMF,EAAOC,QAAiB,QAAID,EAAOC,QACxE,IAAIA,EAAU,CAAC,EACbE,EAAKC,OAAOC,UACZC,EAASH,EAAGI,eACZC,EAAiBJ,OAAOI,gBAAkB,SAAUC,EAAKC,EAAKC,GAC5DF,EAAIC,GAAOC,EAAKC,KAClB,EACAC,EAAU,mBAAqBC,OAASA,OAAS,CAAC,EAClDC,EAAiBF,EAAQG,UAAY,aACrCC,EAAsBJ,EAAQK,eAAiB,kBAC/CC,EAAoBN,EAAQO,aAAe,gBAC7C,SAASC,EAAOZ,EAAKC,EAAKE,GACxB,OAAOR,OAAOI,eAAeC,EAAKC,EAAK,CACrCE,MAAOA,EACPU,YAAY,EACZC,cAAc,EACdC,UAAU,IACRf,EAAIC,EACV,CACA,IACEW,EAAO,CAAC,EAAG,GACb,CAAE,MAAOI,GACPJ,EAAS,SAAgBZ,EAAKC,EAAKE,GACjC,OAAOH,EAAIC,GAAOE,CACpB,CACF,CACA,SAASc,EAAKC,EAASC,EAASC,EAAMC,GACpC,IAAIC,EAAiBH,GAAWA,EAAQvB,qBAAqB2B,EAAYJ,EAAUI,EACjFC,EAAY7B,OAAO8B,OAAOH,EAAe1B,WACzC8B,EAAU,IAAIC,EAAQN,GAAe,IACvC,OAAOtB,EAAeyB,EAAW,UAAW,CAC1CrB,MAAOyB,EAAiBV,EAASE,EAAMM,KACrCF,CACN,CACA,SAASK,EAASC,EAAI9B,EAAK+B,GACzB,IACE,MAAO,CACLC,KAAM,SACND,IAAKD,EAAGG,KAAKjC,EAAK+B,GAEtB,CAAE,MAAOf,GACP,MAAO,CACLgB,KAAM,QACND,IAAKf,EAET,CACF,CACAxB,EAAQyB,KAAOA,EACf,IAAIiB,EAAmB,CAAC,EACxB,SAASX,IAAa,CACtB,SAASY,IAAqB,CAC9B,SAASC,IAA8B,CACvC,IAAIC,EAAoB,CAAC,EACzBzB,EAAOyB,EAAmB/B,GAAgB,WACxC,OAAOgC,IACT,IACA,IAAIC,EAAW5C,OAAO6C,eACpBC,EAA0BF,GAAYA,EAASA,EAASG,EAAO,MACjED,GAA2BA,IAA4B/C,GAAMG,EAAOoC,KAAKQ,EAAyBnC,KAAoB+B,EAAoBI,GAC1I,IAAIE,EAAKP,EAA2BxC,UAAY2B,EAAU3B,UAAYD,OAAO8B,OAAOY,GACpF,SAASO,EAAsBhD,GAC7B,CAAC,OAAQ,QAAS,UAAUiD,SAAQ,SAAUC,GAC5ClC,EAAOhB,EAAWkD,GAAQ,SAAUf,GAClC,OAAOO,KAAKS,QAAQD,EAAQf,EAC9B,GACF,GACF,CACA,SAASiB,EAAcxB,EAAWyB,GAChC,SAASC,EAAOJ,EAAQf,EAAKoB,EAASC,GACpC,IAAIC,EAASxB,EAASL,EAAUsB,GAAStB,EAAWO,GACpD,GAAI,UAAYsB,EAAOrB,KAAM,CAC3B,IAAIsB,EAASD,EAAOtB,IAClB5B,EAAQmD,EAAOnD,MACjB,OAAOA,GAAS,UAAYd,EAAQc,IAAUN,EAAOoC,KAAK9B,EAAO,WAAa8C,EAAYE,QAAQhD,EAAMoD,SAASC,MAAK,SAAUrD,GAC9H+C,EAAO,OAAQ/C,EAAOgD,EAASC,EACjC,IAAG,SAAUpC,GACXkC,EAAO,QAASlC,EAAKmC,EAASC,EAChC,IAAKH,EAAYE,QAAQhD,GAAOqD,MAAK,SAAUC,GAC7CH,EAAOnD,MAAQsD,EAAWN,EAAQG,EACpC,IAAG,SAAUI,GACX,OAAOR,EAAO,QAASQ,EAAOP,EAASC,EACzC,GACF,CACAA,EAAOC,EAAOtB,IAChB,CACA,IAAI4B,EACJ5D,EAAeuC,KAAM,UAAW,CAC9BnC,MAAO,SAAe2C,EAAQf,GAC5B,SAAS6B,IACP,OAAO,IAAIX,GAAY,SAAUE,EAASC,GACxCF,EAAOJ,EAAQf,EAAKoB,EAASC,EAC/B,GACF,CACA,OAAOO,EAAkBA,EAAkBA,EAAgBH,KAAKI,EAA4BA,GAA8BA,GAC5H,GAEJ,CACA,SAAShC,EAAiBV,EAASE,EAAMM,GACvC,IAAImC,EAAQ,iBACZ,OAAO,SAAUf,EAAQf,GACvB,GAAI,cAAgB8B,EAAO,MAAM,IAAIC,MAAM,gCAC3C,GAAI,cAAgBD,EAAO,CACzB,GAAI,UAAYf,EAAQ,MAAMf,EAC9B,MAuEG,CACL5B,WAAO4D,EACPC,MAAM,EAxEN,CACA,IAAKtC,EAAQoB,OAASA,EAAQpB,EAAQK,IAAMA,IAAO,CACjD,IAAIkC,EAAWvC,EAAQuC,SACvB,GAAIA,EAAU,CACZ,IAAIC,EAAiBC,EAAoBF,EAAUvC,GACnD,GAAIwC,EAAgB,CAClB,GAAIA,IAAmBhC,EAAkB,SACzC,OAAOgC,CACT,CACF,CACA,GAAI,SAAWxC,EAAQoB,OAAQpB,EAAQ0C,KAAO1C,EAAQ2C,MAAQ3C,EAAQK,SAAS,GAAI,UAAYL,EAAQoB,OAAQ,CAC7G,GAAI,mBAAqBe,EAAO,MAAMA,EAAQ,YAAanC,EAAQK,IACnEL,EAAQ4C,kBAAkB5C,EAAQK,IACpC,KAAO,WAAaL,EAAQoB,QAAUpB,EAAQ6C,OAAO,SAAU7C,EAAQK,KACvE8B,EAAQ,YACR,IAAIR,EAASxB,EAASX,EAASE,EAAMM,GACrC,GAAI,WAAa2B,EAAOrB,KAAM,CAC5B,GAAI6B,EAAQnC,EAAQsC,KAAO,YAAc,iBAAkBX,EAAOtB,MAAQG,EAAkB,SAC5F,MAAO,CACL/B,MAAOkD,EAAOtB,IACdiC,KAAMtC,EAAQsC,KAElB,CACA,UAAYX,EAAOrB,OAAS6B,EAAQ,YAAanC,EAAQoB,OAAS,QAASpB,EAAQK,IAAMsB,EAAOtB,IAClG,CACF,CACF,CACA,SAASoC,EAAoBF,EAAUvC,GACrC,IAAI8C,EAAa9C,EAAQoB,OACvBA,EAASmB,EAAS1D,SAASiE,GAC7B,QAAIT,IAAcjB,EAAQ,OAAOpB,EAAQuC,SAAW,KAAM,UAAYO,GAAcP,EAAS1D,SAAiB,SAAMmB,EAAQoB,OAAS,SAAUpB,EAAQK,SAAMgC,EAAWI,EAAoBF,EAAUvC,GAAU,UAAYA,EAAQoB,SAAW,WAAa0B,IAAe9C,EAAQoB,OAAS,QAASpB,EAAQK,IAAM,IAAI0C,UAAU,oCAAsCD,EAAa,aAActC,EAClY,IAAImB,EAASxB,EAASiB,EAAQmB,EAAS1D,SAAUmB,EAAQK,KACzD,GAAI,UAAYsB,EAAOrB,KAAM,OAAON,EAAQoB,OAAS,QAASpB,EAAQK,IAAMsB,EAAOtB,IAAKL,EAAQuC,SAAW,KAAM/B,EACjH,IAAIwC,EAAOrB,EAAOtB,IAClB,OAAO2C,EAAOA,EAAKV,MAAQtC,EAAQuC,EAASU,YAAcD,EAAKvE,MAAOuB,EAAQkD,KAAOX,EAASY,QAAS,WAAanD,EAAQoB,SAAWpB,EAAQoB,OAAS,OAAQpB,EAAQK,SAAMgC,GAAYrC,EAAQuC,SAAW,KAAM/B,GAAoBwC,GAAQhD,EAAQoB,OAAS,QAASpB,EAAQK,IAAM,IAAI0C,UAAU,oCAAqC/C,EAAQuC,SAAW,KAAM/B,EACrW,CACA,SAAS4C,EAAaC,GACpB,IAAIC,EAAQ,CACVC,OAAQF,EAAK,IAEf,KAAKA,IAASC,EAAME,SAAWH,EAAK,IAAK,KAAKA,IAASC,EAAMG,WAAaJ,EAAK,GAAIC,EAAMI,SAAWL,EAAK,IAAKzC,KAAK+C,WAAWC,KAAKN,EACrI,CACA,SAASO,EAAcP,GACrB,IAAI3B,EAAS2B,EAAMQ,YAAc,CAAC,EAClCnC,EAAOrB,KAAO,gBAAiBqB,EAAOtB,IAAKiD,EAAMQ,WAAanC,CAChE,CACA,SAAS1B,EAAQN,GACfiB,KAAK+C,WAAa,CAAC,CACjBJ,OAAQ,SACN5D,EAAYwB,QAAQiC,EAAcxC,MAAOA,KAAKmD,OAAM,EAC1D,CACA,SAAS/C,EAAOgD,GACd,GAAIA,EAAU,CACZ,IAAIC,EAAiBD,EAASpF,GAC9B,GAAIqF,EAAgB,OAAOA,EAAe1D,KAAKyD,GAC/C,GAAI,mBAAqBA,EAASd,KAAM,OAAOc,EAC/C,IAAKE,MAAMF,EAASG,QAAS,CAC3B,IAAIC,GAAK,EACPlB,EAAO,SAASA,IACd,OAASkB,EAAIJ,EAASG,QAAS,GAAIhG,EAAOoC,KAAKyD,EAAUI,GAAI,OAAOlB,EAAKzE,MAAQuF,EAASI,GAAIlB,EAAKZ,MAAO,EAAIY,EAC9G,OAAOA,EAAKzE,WAAQ4D,EAAWa,EAAKZ,MAAO,EAAIY,CACjD,EACF,OAAOA,EAAKA,KAAOA,CACrB,CACF,CACA,MAAO,CACLA,KAAMmB,EAEV,CACA,SAASA,IACP,MAAO,CACL5F,WAAO4D,EACPC,MAAM,EAEV,CACA,OAAO7B,EAAkBvC,UAAYwC,EAA4BrC,EAAe4C,EAAI,cAAe,CACjGxC,MAAOiC,EACPtB,cAAc,IACZf,EAAeqC,EAA4B,cAAe,CAC5DjC,MAAOgC,EACPrB,cAAc,IACZqB,EAAkB6D,YAAcpF,EAAOwB,EAA4B1B,EAAmB,qBAAsBlB,EAAQyG,oBAAsB,SAAUC,GACtJ,IAAIC,EAAO,mBAAqBD,GAAUA,EAAOE,YACjD,QAASD,IAASA,IAAShE,GAAqB,uBAAyBgE,EAAKH,aAAeG,EAAKE,MACpG,EAAG7G,EAAQ8G,KAAO,SAAUJ,GAC1B,OAAOvG,OAAO4G,eAAiB5G,OAAO4G,eAAeL,EAAQ9D,IAA+B8D,EAAOM,UAAYpE,EAA4BxB,EAAOsF,EAAQxF,EAAmB,sBAAuBwF,EAAOtG,UAAYD,OAAO8B,OAAOkB,GAAKuD,CAC5O,EAAG1G,EAAQiH,MAAQ,SAAU1E,GAC3B,MAAO,CACLwB,QAASxB,EAEb,EAAGa,EAAsBI,EAAcpD,WAAYgB,EAAOoC,EAAcpD,UAAWY,GAAqB,WACtG,OAAO8B,IACT,IAAI9C,EAAQwD,cAAgBA,EAAexD,EAAQkH,MAAQ,SAAUxF,EAASC,EAASC,EAAMC,EAAa4B,QACxG,IAAWA,IAAgBA,EAAc0D,SACzC,IAAIC,EAAO,IAAI5D,EAAc/B,EAAKC,EAASC,EAASC,EAAMC,GAAc4B,GACxE,OAAOzD,EAAQyG,oBAAoB9E,GAAWyF,EAAOA,EAAKhC,OAAOpB,MAAK,SAAUF,GAC9E,OAAOA,EAAOU,KAAOV,EAAOnD,MAAQyG,EAAKhC,MAC3C,GACF,EAAGhC,EAAsBD,GAAK/B,EAAO+B,EAAIjC,EAAmB,aAAcE,EAAO+B,EAAIrC,GAAgB,WACnG,OAAOgC,IACT,IAAI1B,EAAO+B,EAAI,YAAY,WACzB,MAAO,oBACT,IAAInD,EAAQqH,KAAO,SAAUC,GAC3B,IAAIC,EAASpH,OAAOmH,GAClBD,EAAO,GACT,IAAK,IAAI5G,KAAO8G,EAAQF,EAAKvB,KAAKrF,GAClC,OAAO4G,EAAKG,UAAW,SAASpC,IAC9B,KAAOiC,EAAKhB,QAAS,CACnB,IAAI5F,EAAM4G,EAAKI,MACf,GAAIhH,KAAO8G,EAAQ,OAAOnC,EAAKzE,MAAQF,EAAK2E,EAAKZ,MAAO,EAAIY,CAC9D,CACA,OAAOA,EAAKZ,MAAO,EAAIY,CACzB,CACF,EAAGpF,EAAQkD,OAASA,EAAQf,EAAQ/B,UAAY,CAC9CwG,YAAazE,EACb8D,MAAO,SAAeyB,GACpB,GAAI5E,KAAK6E,KAAO,EAAG7E,KAAKsC,KAAO,EAAGtC,KAAK8B,KAAO9B,KAAK+B,WAAQN,EAAWzB,KAAK0B,MAAO,EAAI1B,KAAK2B,SAAW,KAAM3B,KAAKQ,OAAS,OAAQR,KAAKP,SAAMgC,EAAWzB,KAAK+C,WAAWxC,QAAQ0C,IAAiB2B,EAAe,IAAK,IAAIb,KAAQ/D,KAAM,MAAQ+D,EAAKe,OAAO,IAAMvH,EAAOoC,KAAKK,KAAM+D,KAAUT,OAAOS,EAAKgB,MAAM,MAAQ/E,KAAK+D,QAAQtC,EACtU,EACAuD,KAAM,WACJhF,KAAK0B,MAAO,EACZ,IAAIuD,EAAajF,KAAK+C,WAAW,GAAGG,WACpC,GAAI,UAAY+B,EAAWvF,KAAM,MAAMuF,EAAWxF,IAClD,OAAOO,KAAKkF,IACd,EACAlD,kBAAmB,SAA2BmD,GAC5C,GAAInF,KAAK0B,KAAM,MAAMyD,EACrB,IAAI/F,EAAUY,KACd,SAASoF,EAAOC,EAAKC,GACnB,OAAOvE,EAAOrB,KAAO,QAASqB,EAAOtB,IAAM0F,EAAW/F,EAAQkD,KAAO+C,EAAKC,IAAWlG,EAAQoB,OAAS,OAAQpB,EAAQK,SAAMgC,KAAc6D,CAC5I,CACA,IAAK,IAAI9B,EAAIxD,KAAK+C,WAAWQ,OAAS,EAAGC,GAAK,IAAKA,EAAG,CACpD,IAAId,EAAQ1C,KAAK+C,WAAWS,GAC1BzC,EAAS2B,EAAMQ,WACjB,GAAI,SAAWR,EAAMC,OAAQ,OAAOyC,EAAO,OAC3C,GAAI1C,EAAMC,QAAU3C,KAAK6E,KAAM,CAC7B,IAAIU,EAAWhI,EAAOoC,KAAK+C,EAAO,YAChC8C,EAAajI,EAAOoC,KAAK+C,EAAO,cAClC,GAAI6C,GAAYC,EAAY,CAC1B,GAAIxF,KAAK6E,KAAOnC,EAAME,SAAU,OAAOwC,EAAO1C,EAAME,UAAU,GAC9D,GAAI5C,KAAK6E,KAAOnC,EAAMG,WAAY,OAAOuC,EAAO1C,EAAMG,WACxD,MAAO,GAAI0C,GACT,GAAIvF,KAAK6E,KAAOnC,EAAME,SAAU,OAAOwC,EAAO1C,EAAME,UAAU,OACzD,CACL,IAAK4C,EAAY,MAAM,IAAIhE,MAAM,0CACjC,GAAIxB,KAAK6E,KAAOnC,EAAMG,WAAY,OAAOuC,EAAO1C,EAAMG,WACxD,CACF,CACF,CACF,EACAZ,OAAQ,SAAgBvC,EAAMD,GAC5B,IAAK,IAAI+D,EAAIxD,KAAK+C,WAAWQ,OAAS,EAAGC,GAAK,IAAKA,EAAG,CACpD,IAAId,EAAQ1C,KAAK+C,WAAWS,GAC5B,GAAId,EAAMC,QAAU3C,KAAK6E,MAAQtH,EAAOoC,KAAK+C,EAAO,eAAiB1C,KAAK6E,KAAOnC,EAAMG,WAAY,CACjG,IAAI4C,EAAe/C,EACnB,KACF,CACF,CACA+C,IAAiB,UAAY/F,GAAQ,aAAeA,IAAS+F,EAAa9C,QAAUlD,GAAOA,GAAOgG,EAAa5C,aAAe4C,EAAe,MAC7I,IAAI1E,EAAS0E,EAAeA,EAAavC,WAAa,CAAC,EACvD,OAAOnC,EAAOrB,KAAOA,EAAMqB,EAAOtB,IAAMA,EAAKgG,GAAgBzF,KAAKQ,OAAS,OAAQR,KAAKsC,KAAOmD,EAAa5C,WAAYjD,GAAoBI,KAAK0F,SAAS3E,EAC5J,EACA2E,SAAU,SAAkB3E,EAAQ+B,GAClC,GAAI,UAAY/B,EAAOrB,KAAM,MAAMqB,EAAOtB,IAC1C,MAAO,UAAYsB,EAAOrB,MAAQ,aAAeqB,EAAOrB,KAAOM,KAAKsC,KAAOvB,EAAOtB,IAAM,WAAasB,EAAOrB,MAAQM,KAAKkF,KAAOlF,KAAKP,IAAMsB,EAAOtB,IAAKO,KAAKQ,OAAS,SAAUR,KAAKsC,KAAO,OAAS,WAAavB,EAAOrB,MAAQoD,IAAa9C,KAAKsC,KAAOQ,GAAWlD,CACtQ,EACA+F,OAAQ,SAAgB9C,GACtB,IAAK,IAAIW,EAAIxD,KAAK+C,WAAWQ,OAAS,EAAGC,GAAK,IAAKA,EAAG,CACpD,IAAId,EAAQ1C,KAAK+C,WAAWS,GAC5B,GAAId,EAAMG,aAAeA,EAAY,OAAO7C,KAAK0F,SAAShD,EAAMQ,WAAYR,EAAMI,UAAWG,EAAcP,GAAQ9C,CACrH,CACF,EACA,MAAS,SAAgB+C,GACvB,IAAK,IAAIa,EAAIxD,KAAK+C,WAAWQ,OAAS,EAAGC,GAAK,IAAKA,EAAG,CACpD,IAAId,EAAQ1C,KAAK+C,WAAWS,GAC5B,GAAId,EAAMC,SAAWA,EAAQ,CAC3B,IAAI5B,EAAS2B,EAAMQ,WACnB,GAAI,UAAYnC,EAAOrB,KAAM,CAC3B,IAAIkG,EAAS7E,EAAOtB,IACpBwD,EAAcP,EAChB,CACA,OAAOkD,CACT,CACF,CACA,MAAM,IAAIpE,MAAM,wBAClB,EACAqE,cAAe,SAAuBzC,EAAUf,EAAYE,GAC1D,OAAOvC,KAAK2B,SAAW,CACrB1D,SAAUmC,EAAOgD,GACjBf,WAAYA,EACZE,QAASA,GACR,SAAWvC,KAAKQ,SAAWR,KAAKP,SAAMgC,GAAY7B,CACvD,GACC1C,CACL,CACAD,EAAOC,QAAUF,EAAqBC,EAAOC,QAAQC,YAAa,EAAMF,EAAOC,QAAiB,QAAID,EAAOC,iBC/S3G,SAASH,EAAQW,GAGf,OAAQT,EAAOC,QAAUH,EAAU,mBAAqBgB,QAAU,iBAAmBA,OAAOE,SAAW,SAAUP,GAC/G,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAO,mBAAqBK,QAAUL,EAAIoG,cAAgB/F,QAAUL,IAAQK,OAAOT,UAAY,gBAAkBI,CAC1H,EAAGT,EAAOC,QAAQC,YAAa,EAAMF,EAAOC,QAAiB,QAAID,EAAOC,QAAUH,EAAQW,EAC5F,CACAT,EAAOC,QAAUH,EAASE,EAAOC,QAAQC,YAAa,EAAMF,EAAOC,QAAiB,QAAID,EAAOC,uBCP/F,IAAI4I,EAAU,EAAQ,IAAR,GACd7I,EAAOC,QAAU4I,EAGjB,IACEC,mBAAqBD,CACvB,CAAE,MAAOE,GACmB,iBAAfC,WACTA,WAAWF,mBAAqBD,EAEhCI,SAAS,IAAK,yBAAdA,CAAwCJ,EAE5C,ICbIK,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB5E,IAAjB6E,EACH,OAAOA,EAAapJ,QAGrB,IAAID,EAASkJ,EAAyBE,GAAY,CAGjDnJ,QAAS,CAAC,GAOX,OAHAqJ,EAAoBF,GAAUpJ,EAAQA,EAAOC,QAASkJ,GAG/CnJ,EAAOC,OACf,CCrBAkJ,EAAoBI,EAAKvJ,IACxB,IAAIwJ,EAASxJ,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAmJ,EAAoBM,EAAED,EAAQ,CAAEE,EAAGF,IAC5BA,CAAM,ECLdL,EAAoBM,EAAI,CAACxJ,EAAS0J,KACjC,IAAI,IAAIjJ,KAAOiJ,EACXR,EAAoBS,EAAED,EAAYjJ,KAASyI,EAAoBS,EAAE3J,EAASS,IAC5EN,OAAOI,eAAeP,EAASS,EAAK,CAAEY,YAAY,EAAMuI,IAAKF,EAAWjJ,IAE1E,ECNDyI,EAAoBS,EAAI,CAACnJ,EAAKqJ,IAAU1J,OAAOC,UAAUE,eAAemC,KAAKjC,EAAKqJ,sBCAnE,SAASC,EAAkBC,EAAKC,IAClC,MAAPA,GAAeA,EAAMD,EAAI1D,UAAQ2D,EAAMD,EAAI1D,QAC/C,IAAK,IAAIC,EAAI,EAAG2D,EAAO,IAAIC,MAAMF,GAAM1D,EAAI0D,EAAK1D,IAAK2D,EAAK3D,GAAKyD,EAAIzD,GACnE,OAAO2D,CACT,CCHe,SAASE,EAA4BR,EAAGS,GACrD,GAAKT,EAAL,CACA,GAAiB,iBAANA,EAAgB,OAAO,EAAiBA,EAAGS,GACtD,IAAId,EAAInJ,OAAOC,UAAUiK,SAAS5H,KAAKkH,GAAG9B,MAAM,GAAI,GAEpD,MADU,WAANyB,GAAkBK,EAAE/C,cAAa0C,EAAIK,EAAE/C,YAAYC,MAC7C,QAANyC,GAAqB,QAANA,EAAoBY,MAAMI,KAAKX,GACxC,cAANL,GAAqB,2CAA2CiB,KAAKjB,GAAW,EAAiBK,EAAGS,QAAxG,CALc,CAMhB,CCJe,SAASI,EAAmBT,GACzC,OCJa,SAA4BA,GACzC,GAAIG,MAAMO,QAAQV,GAAM,OAAO,EAAiBA,EAClD,CDES,CAAkBA,IELZ,SAA0B3C,GACvC,GAAsB,oBAAXvG,QAAmD,MAAzBuG,EAAKvG,OAAOE,WAA2C,MAAtBqG,EAAK,cAAuB,OAAO8C,MAAMI,KAAKlD,EACtH,CFGmC,CAAgB2C,IAAQ,EAA2BA,IGLvE,WACb,MAAM,IAAI9E,UAAU,uIACtB,CHG8F,EAC9F,CIFe,SAASyF,EAAeX,EAAKzD,GAC1C,OCLa,SAAyByD,GACtC,GAAIG,MAAMO,QAAQV,GAAM,OAAOA,CACjC,CDGS,CAAeA,IELT,SAA+BA,EAAKzD,GACjD,IAAIqE,EAAK,MAAQZ,EAAM,KAAO,oBAAsBlJ,QAAUkJ,EAAIlJ,OAAOE,WAAagJ,EAAI,cAC1F,GAAI,MAAQY,EAAI,CACd,IAAIC,EACFC,EACAC,EACAC,EACAC,EAAO,GACPC,GAAK,EACLC,GAAK,EACP,IACE,GAAIJ,GAAMH,EAAKA,EAAGlI,KAAKsH,IAAM3E,KAAM,IAAMkB,EAAG,CAC1C,GAAInG,OAAOwK,KAAQA,EAAI,OACvBM,GAAK,CACP,MAAO,OAASA,GAAML,EAAKE,EAAGrI,KAAKkI,IAAKnG,QAAUwG,EAAKlF,KAAK8E,EAAGjK,OAAQqK,EAAK3E,SAAWC,GAAI2E,GAAK,GAClG,CAAE,MAAOzJ,GACP0J,GAAK,EAAIL,EAAKrJ,CAChB,CAAE,QACA,IACE,IAAKyJ,GAAM,MAAQN,EAAW,SAAMI,EAAKJ,EAAW,SAAKxK,OAAO4K,KAAQA,GAAK,MAC/E,CAAE,QACA,GAAIG,EAAI,MAAML,CAChB,CACF,CACA,OAAOG,CACT,CACF,CFrBgC,CAAqBjB,EAAKzD,IAAM,EAA2ByD,EAAKzD,IGLjF,WACb,MAAM,IAAIrB,UAAU,4IACtB,CHGsG,EACtG,CINA,SAASkG,EAAmBC,EAAKzH,EAASC,EAAQyH,EAAOC,EAAQ7K,EAAK8B,GACpE,IACE,IAAI2C,EAAOkG,EAAI3K,GAAK8B,GAChB5B,EAAQuE,EAAKvE,KACnB,CAAE,MAAOuD,GAEP,YADAN,EAAOM,EAET,CACIgB,EAAKV,KACPb,EAAQhD,GAERwG,QAAQxD,QAAQhD,GAAOqD,KAAKqH,EAAOC,EAEvC,CACe,SAASC,EAAkBjJ,GACxC,OAAO,WACL,IAAIV,EAAOkB,KACT0I,EAAOC,UACT,OAAO,IAAItE,SAAQ,SAAUxD,EAASC,GACpC,IAAIwH,EAAM9I,EAAGoJ,MAAM9J,EAAM4J,GACzB,SAASH,EAAM1K,GACbwK,EAAmBC,EAAKzH,EAASC,EAAQyH,EAAOC,EAAQ,OAAQ3K,EAClE,CACA,SAAS2K,EAAO9J,GACd2J,EAAmBC,EAAKzH,EAASC,EAAQyH,EAAOC,EAAQ,QAAS9J,EACnE,CACA6J,OAAM9G,EACR,GACF,CACF,CC7Be,SAASoH,EAAgBC,EAAUC,GAChD,KAAMD,aAAoBC,GACxB,MAAM,IAAI5G,UAAU,oCAExB,CCJe,SAASpF,EAAQW,GAG9B,OAAOX,EAAU,mBAAqBgB,QAAU,iBAAmBA,OAAOE,SAAW,SAAUP,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAO,mBAAqBK,QAAUL,EAAIoG,cAAgB/F,QAAUL,IAAQK,OAAOT,UAAY,gBAAkBI,CAC1H,EAAGX,EAAQW,EACb,CCNe,SAASsL,EAAevJ,GACrC,IAAI9B,ECFS,SAAsBsL,GACnC,GAAuB,WAAnBlM,EAAQkM,IAAiC,OAAVA,EAAgB,OAAOA,EAC1D,IAAIC,EAAOD,EAAMlL,OAAOoL,aACxB,QAAa1H,IAATyH,EAAoB,CACtB,IAAIE,EAAMF,EAAKvJ,KAAKsJ,EAAOI,UAC3B,GAAqB,WAAjBtM,EAAQqM,GAAmB,OAAOA,EACtC,MAAM,IAAIjH,UAAU,+CACtB,CACA,OAA4BmH,OAAiBL,EAC/C,CDPY,CAAYxJ,GACtB,MAAwB,WAAjB1C,EAAQY,GAAoBA,EAAM2L,OAAO3L,EAClD,CEJA,SAAS4L,EAAkBC,EAAQC,GACjC,IAAK,IAAIjG,EAAI,EAAGA,EAAIiG,EAAMlG,OAAQC,IAAK,CACrC,IAAIkG,EAAaD,EAAMjG,GACvBkG,EAAWnL,WAAamL,EAAWnL,aAAc,EACjDmL,EAAWlL,cAAe,EACtB,UAAWkL,IAAYA,EAAWjL,UAAW,GACjDpB,OAAOI,eAAe+L,EAAQ,EAAcE,EAAW/L,KAAM+L,EAC/D,CACF,CACe,SAASC,EAAaZ,EAAaa,EAAYC,GAM5D,OALID,GAAYL,EAAkBR,EAAYzL,UAAWsM,GACrDC,GAAaN,EAAkBR,EAAac,GAChDxM,OAAOI,eAAesL,EAAa,YAAa,CAC9CtK,UAAU,IAELsK,CACT,CChBe,SAASe,EAAgBpM,EAAKC,EAAKE,GAYhD,OAXAF,EAAM,EAAcA,MACTD,EACTL,OAAOI,eAAeC,EAAKC,EAAK,CAC9BE,MAAOA,EACPU,YAAY,EACZC,cAAc,EACdC,UAAU,IAGZf,EAAIC,GAAOE,EAENH,CACT,uBCde,SAASqM,EAAuBjL,GAC7C,QAAa,IAATA,EACF,MAAM,IAAIkL,eAAe,6DAE3B,OAAOlL,CACT,CCLe,SAASmL,EAAgBpD,EAAGqD,GAKzC,OAJAD,EAAkB5M,OAAO4G,eAAiB5G,OAAO4G,eAAekG,OAAS,SAAyBtD,EAAGqD,GAEnG,OADArD,EAAE3C,UAAYgG,EACPrD,CACT,EACOoD,EAAgBpD,EAAGqD,EAC5B,CCLe,SAASE,EAAUC,EAAUC,GAC1C,GAA0B,mBAAfA,GAA4C,OAAfA,EACtC,MAAM,IAAInI,UAAU,sDAEtBkI,EAAS/M,UAAYD,OAAO8B,OAAOmL,GAAcA,EAAWhN,UAAW,CACrEwG,YAAa,CACXjG,MAAOwM,EACP5L,UAAU,EACVD,cAAc,KAGlBnB,OAAOI,eAAe4M,EAAU,YAAa,CAC3C5L,UAAU,IAER6L,GAAY,EAAeD,EAAUC,EAC3C,CCde,SAASC,EAA2BzL,EAAMa,GACvD,GAAIA,IAA2B,WAAlB5C,EAAQ4C,IAAsC,mBAATA,GAChD,OAAOA,EACF,QAAa,IAATA,EACT,MAAM,IAAIwC,UAAU,4DAEtB,OAAO,EAAsBrD,EAC/B,CCTe,SAAS0L,EAAgB3D,GAItC,OAHA2D,EAAkBnN,OAAO4G,eAAiB5G,OAAO6C,eAAeiK,OAAS,SAAyBtD,GAChG,OAAOA,EAAE3C,WAAa7G,OAAO6C,eAAe2G,EAC9C,EACO2D,EAAgB3D,EACzB,2GCHA,IACqB4D,EAAK,oBAAAA,IAAA5B,EAAA,KAAA4B,EAAA,CA4EvB,OA5EuBd,EAAAc,EAAA,OAAA9M,IAAA,YAAAE,MAqBxB,SAAkB6M,EAAeC,GAC/B,IAAMjE,EAAI,IAAIkE,KAEdlE,EAAEmE,QAAQnE,EAAEoE,UAAa,SACzB,IAAMC,EAAU,WAAarE,EAAEsE,cAC/BC,SAASC,OAASR,EAAQ,IAAMC,EAAS,IAAMI,EAAU,SAC3D,GAEA,CAAApN,IAAA,YAAAE,MAGA,SAAkB6M,GAAe,IACcS,EADdC,65BAAAC,CACZJ,SAASC,OAAOI,MAAM,MAAI,IAA7C,IAAAF,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAA+C,KACf8J,EAAA5D,EADjBuD,EAAAtN,MACOyN,MAAM,KAAI,GAAvBG,EAACD,EAAA,GAAEE,EAACF,EAAA,GACX,GAAIC,EAAEE,SAAWjB,EAAO,OAAOgB,CACjC,CAAC,OAAAhN,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACD,OAAO,IACT,GAEA,CAAAlO,IAAA,eAAAE,MAKA,SAAqBiO,GACnBb,SAASC,OAAS,GAAHa,OAAMD,EAAI,2CAC3B,GAEA,CAAAnO,IAAA,SAAAE,MAGA,WACE,MAA8C,MAAvC4M,EAAMuB,WAAWvB,EAAMwB,WAChC,GAEA,CAAAtO,IAAA,aAAAE,MACA,SAAmB4N,EAAWC,GAC5BQ,OAAOC,aAAaC,QAAQX,EAAGY,KAAKC,UAAUZ,GAChD,GAEA,CAAA/N,IAAA,aAAAE,MAIA,SAAmB4N,GACjB,IAAMC,EAAIQ,OAAOC,aAAaI,QAAQd,GACtC,OAAU,OAANC,EACKW,KAAKG,MAAMd,GAEb,IACT,GAEA,CAAA/N,IAAA,cAAAE,MACA,SAAoB4N,GAClBS,OAAOC,aAAaM,WAAWhB,EACjC,KAAChB,CAAA,CA5EuB,GCAnB,SAAeiC,EAAW1E,EAAA2E,EAAAC,GAAA,OAAAC,EAAAjE,MAAA,KAAAD,UAAA,CAmBjC,SAAAkE,IAFC,OAEDA,EAAApE,EAAAzL,IAAAA,MAnBO,SAAA8P,EAA4BtM,EAAgBuM,EAAcC,GAAa,IAAAC,EAAAvP,EAAA,OAAAV,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,cAAA4K,EAAArI,KAAA,EAAAqI,EAAA5K,KAAA,EAEnD4J,OAAOiB,MAAMJ,EAAM,CACxCvM,OAAQA,EACR4M,QAAS,IAAIlB,OAAOmB,QAAQ,CAAE,eAAgB,qBAE9CC,KAAMN,IACN,OALY,GAMU,OANlBC,EAAQC,EAAApL,MAMDyL,OAAc,CAAAL,EAAA5K,KAAA,cAAU2K,EAAQ,cAAAC,EAAA5K,KAAA,EAC3B2K,EAASO,OAAM,OACL,OADtB9P,EAAGwP,EAAApL,MACL2L,mBAAoB,EAAIP,EAAAjL,OAAA,SACrBvE,GAAG,QAEwB,OAFxBwP,EAAArI,KAAA,GAAAqI,EAAAQ,GAAAR,EAAA,SAEVA,EAAAQ,GAASD,mBAAoB,EAAKP,EAAA5K,KAAA,GACb4K,EAAAQ,GAASC,OAAM,QAAxB,OAAZT,EAAAQ,GAASE,IAAGV,EAAApL,KAAAoL,EAAAjL,OAAA,SAAAiL,EAAAQ,IAAA,yBAAAR,EAAAlI,OAAA,GAAA8H,EAAA,oBAGflE,MAAA,KAAAD,UAAA,CAMM,SAAekF,EAAQC,EAAAC,GAAA,OAAAC,EAAApF,MAAA,KAAAD,UAAA,CAI9B,SAAAqF,IAFC,OAEDA,EAAAvF,EAAAzL,IAAAA,MAJO,SAAAiR,EAAyBlB,EAAcmB,GAAU,OAAAlR,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,cAAA6L,EAAAlM,OAAA,SAC/CyK,EAAY,OAAQK,EAAMV,KAAKC,UAAU4B,KAAM,wBAAAC,EAAAnJ,OAAA,GAAAiJ,EAAA,MACvDrF,MAAA,KAAAD,UAAA,CAKM,SAAeyF,EAAOC,GAAA,OAAAC,EAAA1F,MAAA,KAAAD,UAAA,CAE5B,SAAA2F,IAAA,OAAAA,EAAA7F,EAAAzL,IAAAA,MAFM,SAAAuR,EAAwBxB,GAAY,OAAA/P,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,cAAAkM,EAAAvM,OAAA,SAClCyK,EAAY,MAAOK,IAAK,wBAAAyB,EAAAxJ,OAAA,GAAAuJ,EAAA,MAChC3F,MAAA,KAAAD,UAAA,CD/BCmB,EADmBW,EAAK,aAEJ,YAAUX,EAFXW,EAAK,SAGR,WAASX,EAHNW,EAAK,UAIP,cACjBX,EALmBW,EAAK,WAMN,UAAQX,EANPW,EAAK,YAOL,WAASX,EAPTW,EAAK,cAQH,aAAWX,EARbW,EAAK,eASF,kBAAgBX,EATnBW,EAAK,cAUH,aAAWX,EAVbW,EAAK,iBAWA,YAAUX,EAXfW,EAAK,qBAYI,gBAAcX,EAZvBW,EAAK,mBAaE,kBAAgBX,EAbvBW,EAAK,kBAcC,iBAAeX,EAdrBW,EAAK,kBAeC,iBAAgBX,EAftBW,EAAK,yBAgBQ,UAAQX,EAhBrBW,EAAK,uBAiBM,sBAAoBX,EAjB/BW,EAAK,iBAkBA,iBAAeX,EAlBpBW,EAAK,YAmBL,YA6DsB,OAAvCA,EAAMuB,WAAWvB,EAAMwB,aAAsBxB,EAAMgE,WAAWhE,EAAMwB,WAAY,KAC3C,OAArCxB,EAAMuB,WAAWvB,EAAMiE,WAAoBjE,EAAMgE,WAAWhE,EAAMiE,SAAU,KAC/B,OAA7CjE,EAAMuB,WAAWvB,EAAMkE,mBAA4BlE,EAAMgE,WAAWhE,EAAMkE,iBAAkB,KChDzF,ICyLHC,EDzLQC,EAAM,SAANA,GAAM,OAANA,EAAAA,EAAM,yBAANA,EAAAA,EAAM,iCAANA,EAAAA,EAAM,uCAANA,EAAAA,EAAM,2BAANA,EAAAA,EAAM,qCAANA,EAAAA,EAAM,6BAANA,EAAAA,EAAM,+BAANA,EAAAA,EAAM,2BAANA,EAAAA,EAAM,mCAANA,EAAAA,EAAM,2BAANA,EAAAA,EAAM,8BAANA,EAAAA,EAAM,gCAANA,EAAAA,EAAM,kCAANA,EAAAA,EAAM,4BAANA,EAAAA,EAAM,sCAANA,EAAAA,EAAM,oCAANA,EAAAA,EAAM,kBAANA,EAAAA,EAAM,sBAANA,EAAAA,EAAM,wCAANA,EAAAA,EAAM,wCAANA,EAAAA,EAAM,kCAANA,EAAAA,EAAM,0BAANA,EAAAA,EAAM,oDAANA,EAAAA,EAAM,sCAANA,EAAAA,EAAM,8BAANA,EAAAA,EAAM,0BAANA,EAAAA,EAAM,sCAANA,EAAAA,EAAM,sBAANA,EAAAA,EAAM,8BAANA,EAAAA,EAAM,kCAANA,EAAAA,EAAM,4CAANA,EAAAA,EAAM,0CAANA,EAAAA,EAAM,wCAANA,EAAAA,EAAM,0CAANA,EAAAA,EAAM,sCAANA,EAAAA,EAAM,sCAANA,EAAAA,EAAM,4BAANA,CAAM,MChCLC,EAAuB,oBAYvBC,EAAS,MACTC,EAAU,OAEVC,EAA2B,wBAQ3BC,EAAqB,kBACrBC,EAAc,WACdC,EAAY,SACZC,EAAe,YACfC,EAAwB,qBAMxBC,EAAa,UAGbC,EAAc,WAEdC,EAAc,WACdC,EAAa,UAEbC,EAAmB,gBAEnBC,EAAe,YAoBfC,EAAY,SAKZC,EAAyB,sBAYzBC,EAAiB,cAEjBC,EAAkB,eAMlBC,EAAkC,+BAClCC,EAAuC,6BAGvCC,EAAiC,8BAMjCC,EAAgC,6BAEhCC,EAAkB,eA4ClBC,GAA0B,uBAK1BC,GAAoC,iCACpCC,GAAqC,kCACrCC,GAA4B,yBAC5BC,GAAiC,8BACjCC,GAA6B,0BAE7BC,GAA0B,uBAC1BC,GAAwB,qBAsBxBC,GAAkB,eAClBC,GAAmB,gBACnBC,GAAmB,gBACnBC,GAAa,UACbC,GAAsB,mBACtBC,GAAoB,iBACpBC,GAAwB,qBAGxBC,GAAoB,iBACpBC,GAAa,UACbC,GAAc,WAyBdC,GAAuB,oBAK7B,SAAeC,GAAUzJ,EAAA2E,EAAAC,GAAA,OAAA8E,GAAA9I,MAAA,KAAAD,UAAA,CAahC,SAAA+I,KAFC,OAEDA,GAAAjJ,EAAAzL,IAAAA,MAbO,SAAA8P,EAA2B6E,EAAcC,EAAoBC,GAAkB,IAAAC,EAAA,OAAA9U,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,UAC/EuP,EAAW,CAAF3E,EAAA5K,KAAA,QACwC,KAA9CwP,EAAQrH,EAAMuB,WAAWvB,EAAMsH,kBACxBD,EAAMH,OAASA,GAAQG,EAAMF,aAAeA,EAAU,CAAA1E,EAAA5K,KAAA,QACvB,OAA1CsM,EAASnE,EAAMuB,WAAWvB,EAAMuH,WAAU9E,EAAAjL,OAAA,wBAAAiL,EAAA5K,KAAA,EAI/BuL,EAAS,cAAe8D,GAAK,OAA5C/C,EAAM1B,EAAApL,KACN2I,EAAMgE,WAAWhE,EAAMsH,eAAgB,CAAEJ,KAAAA,EAAMC,WAAAA,IAC/CnH,EAAMgE,WAAWhE,EAAMuH,UAAWpD,GAAO,yBAAA1B,EAAAlI,OAAA,GAAA8H,EAAA,MAC1ClE,MAAA,KAAAD,UAAA,CAGM,SAASsJ,GAAMxG,EAAW/C,GAC/B,OAeF,SAA+BwJ,EAAoBxJ,GAMjD,OAAOwJ,EAAWC,QADM,yBACmB,SAACC,EAAGvU,GAAK,OAAK6K,EAAK7K,EAAM,GACtE,CAtBSwU,CAAqBzD,EAAOnD,GAAI/C,GAAQ,CAAC,EAClD,8uCAEAwD,OAAOoG,YAAc,WACnB7H,EAAM8H,YAAY9H,EAAMsH,gBACxBtH,EAAM8H,YAAY9H,EAAMuH,UAC1B,ECrOA,IAAMQ,GAAS,IAAItG,OAAOuG,UAIpBC,GAAiC,CACrC,EAAG,MACH,GAAI,MACJ,EAAG,MACH,EAAG,OACH,GAAI,MACJ,GAAI,OACJ,GAAI,MACJ,EAAG,OACH,IAAK,MACL,GAAI,MACJ,MAAO,WACP,MAAO,WACP,MAAO,YACP,IAAK,OACL,IAAK,MACL,IAAK,UACL,OAAQ,eACR,OAAQ,eACR,OAAQ,eACR,OAAQ,eACR,IAAK,OAGDC,GAAuC,CAAC,GAC9C,WACE,IAAK,IAAL9K,EAAA,EAAA+K,EAAgBvV,OAAOkH,KAAKmO,IAAO7K,EAAA+K,EAAArP,OAAAsE,IAAE,CAAhC,IAAM4D,EAACmH,EAAA/K,GACV8K,GAAaD,GAAOG,SAASpH,KAAOoH,SAASpH,EAC/C,CACD,CAJD,GAMA,IAAMqH,GAAazV,OAAO+C,OAAOsS,IAE3BK,GAAqB,IAErBC,GAA0BC,KAAKC,MAAMD,KAAKE,MAAMJ,KAEhDK,GAAYC,UAAUD,UAAUE,QAAO,SAAC1E,GAAc,MAAgB,MAAXA,CAAc,IAEzE2E,GAAe,IAAIC,KAAKC,aAAaL,GAAW,CAAEM,sBAAuB,IAEzEC,GAAc,IAAIH,KAAKC,aAAaL,GAAW,CACnDQ,yBAA0B,EAC1BC,yBAA0B,IAItBC,GAAuD,CAAC,EAWxDC,GAA6D,CAAC,EAMpE,SAASC,GAAwBC,EAAcC,GAC7C,OAAOC,GAAUJ,GAAyBE,EAAMA,EAAMC,EACxD,CAMA,SAASC,GAAWC,EAA+CC,EAAaC,EAAaJ,GAC3F,IAAMzI,EAAI,GAAHM,OAAMsI,EAAG,KAAAtI,OAAIuI,GAChBC,EAAMH,EAAW3I,GAQrB,OAPK8I,IACHA,EAAM,IAAIf,KAAKC,aAAaS,QAAAA,EAAWd,GAAW,CAChDoB,sBAAuBH,EACvBX,sBAAuBY,IAEzBF,EAAW3I,GAAK8I,GAEXA,CACT,CAMA,SAASE,GAAuB/I,EAAWgJ,GACzC,IAAIT,EAAO,EACX,GAAIS,EAAU,CACZ,IAAM7I,EAAI6I,EAASC,aAAaC,iBAChClJ,GAAKG,EACLoI,EAAOhB,KAAKC,MAAMD,KAAKE,MAAMtH,GAC/B,CACA,MAAO,CAACH,EAAGuI,EACb,CA+BA,IACqBY,GAAG,oBAAAA,IAAAhM,EAAA,KAAAgM,EAAA,CA0IrB,IAAAC,EAVDC,EAuWC,OAveqBpL,EAAAkL,EAAA,OAAAlX,IAAA,OAAAE,MAKtB,SAAamX,EAAwBC,GACnC,OAAOD,EAAGE,cAAc,IAADnJ,OAAKkJ,GAC9B,GAEA,CAAAtX,IAAA,OAAAE,MACA,SAAamX,EAAiBG,EAAuBtJ,EAAuCuJ,GAA6C,IACzFC,EADyFC,EAAAjK,GACtHjE,MAAMO,QAAQwN,GAAMA,EAAK,CAACA,IAAG,IAA9C,IAAAG,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAiD,KAAtCkK,EAACyJ,EAAAxX,MAAqCmX,EAAGO,iBAAiB3J,EAAGC,EAAGuJ,EAAI,CAAC,OAAA1W,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CAClF,GAEA,CAAAlO,IAAA,SAAAE,MACA,SAAemX,EAAiBG,EAAYtJ,GAC1CmJ,EAAGQ,oBAAoBL,EAAItJ,EAC7B,GAEA,CAAAlO,IAAA,WAAAE,MACA,SAAiB4X,GACf,OAAOjD,GAAOkD,gBAAgBD,EAAM,YACtC,GAEA,CAAA9X,IAAA,iBAAAE,MAIA,SAAuB+N,EAAeoJ,GACpC,GAAIA,EAAGW,SAAS/J,EAAEpC,QAAiB,OAAO,EAC1C,IAAMoM,EAAOZ,EAAGa,wBAChB,OAAOjK,EAAEkK,OAASF,EAAKG,MAAQnK,EAAEkK,OAASF,EAAKI,OAC7CpK,EAAEqK,OAASL,EAAKM,KAAOtK,EAAEqK,OAASL,EAAKO,MAC3C,GAEA,CAAAxY,IAAA,gBAAAE,MAGA,SAAsBmX,GACpB,IAAMoB,EAAMpB,EAAGa,wBACTQ,EAAQpL,SAASqL,gBACjBJ,EAAME,EAAIF,IAAMG,EAAME,UACtBR,EAAOK,EAAIL,KAAOM,EAAMG,WACxBC,EAAIzB,EAAG0B,YACPC,EAAI3B,EAAG4B,aACb,MAAO,CACLC,QAASX,EACTY,SAAUf,EACVgB,MAAON,EACPO,OAAQL,EACRM,QAASlB,EAAOU,EAAI,EACpBS,QAAShB,EAAMS,EAAI,EAEvB,GAAC,CAAAhZ,IAAA,oBAAAE,MAED,SAA0BsZ,EAAqBC,GAC7C,IAAMC,EAAgBxC,EAAIyC,cAAcH,GAClCI,EAAa1C,EAAIyC,cAAcF,GACrC,MAAO,CACLP,QAASU,EAAWV,QAAUQ,EAAcR,QAC5CC,SAAUS,EAAWT,SAAWO,EAAcP,SAC9CC,MAAOQ,EAAWR,MAClBC,OAAQO,EAAWP,OACnBC,QAASM,EAAWN,QAAUI,EAAcP,SAC5CI,QAASK,EAAWL,QAAUG,EAAcR,QAEhD,GAEA,CAAAlZ,IAAA,QAAAE,MACA,WAAiC,QAAA2Z,EAAA7O,UAAApF,OAAhBkU,EAAG,IAAArQ,MAAAoQ,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAHD,EAAGC,GAAA/O,UAAA+O,GAClB,IAAK,IAALC,EAAA,EAAAC,EAAiBH,EAAGE,EAAAC,EAAArU,OAAAoU,IAAE,IAAjB,IAAM3C,EAAE4C,EAAAD,GAAgB3C,EAAG6C,YAAY7C,EAAG8C,YAAY9C,EAAG6C,WAChE,GAEA,CAAAla,IAAA,aAAAE,MAIA,SAAmBka,GACjBlD,EAAImD,MAAMD,GAAS,QAAAE,EAAAtP,UAAApF,OADwB2U,EAAI,IAAA9Q,MAAA6Q,EAAA,EAAAA,EAAA,KAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAJD,EAAIC,EAAA,GAAAxP,UAAAwP,GAE/C,IAAK,IAALC,EAAA,EAAAC,EAAgBH,EAAIE,EAAAC,EAAA9U,OAAA6U,IAAA,CAAf,IAAM3M,EAAC4M,EAAAD,GAAUL,EAASO,YAAY7M,EAAE,CAC/C,GAEA,CAAA9N,IAAA,OAAAE,MAIA,WAAgC,QAAA0a,EAAA5P,UAAApF,OAAhBkU,EAAG,IAAArQ,MAAAmR,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAHf,EAAGe,GAAA7P,UAAA6P,GACjB,IAAK,IAALC,EAAA,EAAAC,EAAiBjB,EAAGgB,EAAAC,EAAAnV,OAAAkV,IAAPC,EAAAD,GAAYE,UAAUC,IAAI,SACzC,GAEA,CAAAjb,IAAA,OAAAE,MAIA,WAAgC,QAAAgb,EAAAlQ,UAAApF,OAAhBkU,EAAG,IAAArQ,MAAAyR,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAHrB,EAAGqB,GAAAnQ,UAAAmQ,GACjB,IAAK,IAALC,EAAA,EAAAC,EAAiBvB,EAAGsB,EAAAC,EAAAzV,OAAAwV,IAAPC,EAAAD,GAAYJ,UAAUM,OAAO,SAC5C,GAEA,CAAAtb,IAAA,kBAAAE,MAIA,SAAwBqb,GAAoC,QAAAC,EAAA,KAAAC,EAAAzQ,UAAApF,OAAhBkU,EAAG,IAAArQ,MAAAgS,EAAA,EAAAA,EAAA,KAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAH5B,EAAG4B,EAAA,GAAA1Q,UAAA0Q,GAC7CrZ,KAAKsZ,KAAI1Q,MAAT5I,KAAayX,GACb8B,YAAW,WACTJ,EAAKK,KAAI5Q,MAATuQ,EAAa1B,EACf,GAAGyB,EACL,GAEA,CAAAvb,IAAA,SAAAE,MAIA,SAAe4b,GAA6B,QAAAC,EAAA/Q,UAAApF,OAAhBkU,EAAG,IAAArQ,MAAAsS,EAAA,EAAAA,EAAA,KAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAHlC,EAAGkC,EAAA,GAAAhR,UAAAgR,GACzBF,EAAK5E,EAAIyE,KAAI1Q,MAARiM,EAAY4C,GAChB5C,EAAI2E,KAAI5Q,MAARiM,EAAY4C,EACnB,GAEA,CAAA9Z,IAAA,WAAAE,MACA,SAAiBmX,GACf,OAAOA,EAAG2D,UAAUhD,SAAS,SAC/B,GAEA,CAAAhY,IAAA,cAAAE,MACA,SAAoBmX,GAClB,OAAQA,EAAG2D,UAAUhD,SAAS,SAChC,GAEA,CAAAhY,IAAA,UAAAE,OAAAkX,EAAAtM,EAAAzL,IAAAA,MAQA,SAAA8P,EAAsB8M,EAAkB/N,EAA+BgO,GAAmB,OAAA7c,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,cAAA4K,EAAA5K,KAAA,EAClF,IAAIwX,GAAUF,EAAU/N,EAAGgO,GAAYE,OAAM,wBAAA7M,EAAAlI,OAAA,GAAA8H,EAAA,KACpD,SAAA9E,EAAA2E,EAAAC,GAAA,OAAAmI,EAAAnM,MAAA,KAAAD,UAAA,KAAAhL,IAAA,QAAAE,OAAAiX,EAAArM,EAAAzL,IAAAA,MAED,SAAAiR,EAAoB+G,GAAe,IAAAgF,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAApd,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAAA0X,EACfvP,EAAM4P,SAAW,CAAC,IAAK,IAAK,KAAO,CAAC,EAAG,EAAG,GAAEJ,EAAArS,EAAAoS,EAAA,GAAvDE,EAACD,EAAA,GAAEE,EAACF,EAAA,GAAEG,EAACH,EAAA,GAEdpF,EAAIyF,QAAQ,KAAM,SAACpQ,GACjB8K,EAAGuF,MAAMC,QAAU,kBAAHzO,OAAqBmO,EAAC,MAAAnO,OAAKoO,EAAC,MAAApO,OAAKqO,EAAC,MAAArO,QAFrC,IAEoD7B,GAAc,EAAC,IAClF,IAAE,wBAAAiE,EAAAnJ,OAAA,GAAAiJ,EAAA,KACH,SAAAH,GAAA,OAAAgH,EAAAlM,MAAA,KAAAD,UAAA,KAAAhL,IAAA,gBAAAE,MAED,SAAsBka,EAAuBtM,GAC3C,OAAOrE,MAAMI,KAAKuQ,EAAS0C,iBAAiBhP,GAC9C,GAAC,CAAA9N,IAAA,OAAAE,MAED,SAAaka,GACX,OAAO3Q,MAAMI,KAAKuQ,EAAS2C,SAC7B,GAAC,CAAA/c,IAAA,eAAAE,MAED,SAAqBka,EAAuBtM,GAE1C,OADWsM,EAAS7C,cAAczJ,KAElCkP,QAAQC,KAAK,kCAAD7O,OAAmCN,EAAC,mBAAmBsM,GAC5D9M,SAAS4P,cAAc,OAChC,GAEA,CAAAld,IAAA,gBAAAE,MAKA,SAAsBka,GACpB,IACoD+C,EAD9CpU,EAAiC,CAAC,EAACqU,EAAA1P,GACxBwJ,EAAImG,cAAcjD,EAAU,SAAO,IAApD,IAAAgD,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAsD,KAA3CsT,EAAE8F,EAAAjd,MAAyC6I,EAAEsO,EAAGC,IAAMD,CAAC,CAAC,OAAAtW,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CACnE,OAAOnF,CACT,GAEA,CAAA/I,IAAA,kBAAAE,MAKA,SAAwBod,EAAiBvG,GACvC,IAA0DwG,EAAAtT,EAAxC6M,GAAsBwG,EAASvG,GAAS,GAAnDhJ,EAACwP,EAAA,GAAEjH,EAAIiH,EAAA,GACd,OAAIC,OAAOC,UAAU1P,GAAW6H,GAAa8H,OAAO3P,GAjQxD,SAA2BuI,GACzB,OAAOE,GAAUL,GAAmB,EAAGG,EACzC,CAgQWqH,CAAiBrH,GAAMoH,OAAO3P,EACvC,GAAC,CAAA/N,IAAA,wBAAAE,MAED,SAA8Bod,EAAiBvG,GAE7C,OADoD9M,EAAxC6M,GAAsBwG,EAASvG,GAAS,GAA5C,EAEV,GAEA,CAAA/W,IAAA,0BAAAE,MAIA,SAAgC0d,EAAiBC,EAAeC,EAAeC,GAC7E,IACMC,EAAWJ,GADPC,EAAI7G,aAAaC,iBAAmB6G,EAAI9G,aAAaC,kBAChC7B,GACzB6I,EAAiB5I,GAA0BC,KAAK4I,MAAM5I,KAAKE,MAAMuI,IACrEzI,KAAK4I,MAAM5I,KAAKE,MAAMqI,EAAI7G,aAAaC,kBAAoB3B,KAAKE,MAAMsI,EAAI9G,aAAaC,mBACzF,OAAIgH,GAAkB,EAAUrI,GAAa8H,OAAOM,GAC7C3H,GAAuB4H,GAAgBP,OAAOM,EACvD,GAAC,CAAAhe,IAAA,oBAAAE,MAED,SAA0B2I,EAAWsV,GACnC,OAmhBJ,SAAsCvI,EAAiCwI,EAAoCvV,EAAWsV,GAA2D,IAAAE,EAAAC,EAC/K,GAAIzV,GAAK,IAAM,OAAO+M,EAAa8H,OAAO7U,GAC1C,IAAM+E,EAAIwQ,EAAgBV,OAAO7U,GACjC,MAA2B,iBAAhBsV,IACoH,QAA/GE,EAAwG,QAAxGC,EAAGF,EAAgBG,cAAc1V,GAAG8M,QAAO,SAAC6I,GAA2B,MAAmB,aAAdA,EAAKzc,IAAmB,IAAE,UAAE,IAAAuc,OAAA,EAArGA,EAAuGpe,aAAK,IAAAme,EAAAA,EAAI,IACpHzY,QAAUuY,EAFmBvQ,EAGrCyI,GAAuB8H,OAzhBrBM,GAyhB2Cf,OAAO7U,EAC7D,CA1hBW4V,CAA4B7I,GAAcI,GAAanN,EAAGsV,EACnE,GAAC,CAAAne,IAAA,YAAAE,MAED,SAAkB2F,GAChB,OAAO+P,GAAa8H,OAAO7X,EAC7B,GAEA,CAAA7F,IAAA,sBAAAE,MAKA,SAA4Bod,EAAiBvG,GAC3C,IAA0D2H,EAAAzU,EAAxC6M,GAAsBwG,EAASvG,GAAS,GAAnDhJ,EAAC2Q,EAAA,GACR,OAAOrI,GADOqI,EAAA,IACsBhB,OAAO3P,EAC7C,GAEA,CAAA/N,IAAA,uBAAAE,MAIA,SAA6Bod,EAAiBqB,EAAc5H,GAC1D,IAAK4H,GAAiB,IAATA,EAAY,OAAOC,GDvQN,eCwQ1B,IAEM1e,EAD8C+J,EAAxC6M,GAAsBwG,EAASvG,GAAS,GAA5C,GACU4H,EAClB,OAAOtI,GAHM,GAGuBqH,OAAOxd,EAC7C,GAAC,CAAAF,IAAA,YAAAE,MAED,WACE,OAAOuV,EACT,GAAC,CAAAzV,IAAA,kBAAAE,MAED,SAAwBA,GACtB,OAAOmW,GAAuB,GAAGqH,OAAOxd,EAC1C,GAEA,CAAAF,IAAA,iBAAAE,MAKA,SAAuB2e,EAAeC,EAAcC,GAIlD,IAHA,IAAMC,EAnQV,SAAiCF,EAAcC,GAAyD,IAAAE,EAChGD,GAAmC7S,EAAA8S,EAAG,CAAC,EAC1CH,EAAGI,WAAa,GAAC/S,EAAA8S,EACjBH,EAAG9H,aAAamI,KAAOL,EAAG9H,aAAaC,kBAAgBgI,GAE1D,GAAIH,EAAGM,eAAiBL,EAAO,KACKvR,EADLC,EAAAC,GACXoR,EAAGM,eAAa,IAAlC,IAAA3R,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAoC,KAAzBsb,EAAG7R,EAAAtN,MAA0B6e,EAAMM,EAAIF,QAAOH,EAAYK,EAAIF,MAAQE,EAAIpI,iBAAe,CAAC,OAAAlW,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACvG,CACA,OAAO8Q,CACT,CA0PwBM,CAAuBR,EAAIC,GACzCQ,EAA+B,GAC/BC,EAAY,SAACza,GAAuB,OAAKuQ,KAAKmK,IAAInK,KAAKE,MAAMqJ,EAAQ9Z,EAAM,IA7Q5D,EA6QmF,EACxG2a,EAAA,EAAAC,EAAoBjgB,OAAOkgB,QAAQZ,GAAYU,EAAAC,EAAA/Z,OAAA8Z,IAAA,CAA1C,IAAM3a,EAAK4a,EAAAD,GAAiCH,EAASla,KAAK,CAACN,EAAM,GAAIya,EAAUza,IAAQ,CAC5F,IAAM8a,EAAON,EAASO,QAAO,SAACD,EAAwB9a,GAAuB,OAAKA,EAAM,GAAK8a,EAAK,GAAK9a,EAAQ8a,CAAI,IAC7GV,EAAOU,EAAK,GACZE,EAAUf,EAAYG,GAE5B,MAAO,CADGN,EAAQkB,EACPzK,KAAKC,MAAMD,KAAKE,MAAMuK,IAAWZ,EAC9C,GAEA,CAAAnf,IAAA,+BAAAE,MAIA,SAAqC2e,EAAeC,EAAcC,GAChE,IAA6DiB,EAAA/V,EAArC5H,KAAK4d,eAAepB,EAAOC,EAAIC,GAAM,GAAtDhR,EAACiS,EAAA,GAAE1J,EAAI0J,EAAA,GAAEb,EAAIa,EAAA,GACpB,OAAIxC,OAAOC,UAAU1P,GAAW,CAAC6H,GAAa8H,OAAO3P,GAAIoR,GAClD,CAAC9I,GAAuBC,GAAMoH,OAAO3P,GAAIoR,EAClD,GAEA,CAAAnf,IAAA,6BAAAE,MAIA,SAAmC2e,EAAeC,EAAcC,GAC9D,IAA6DmB,EAAAjW,EAArC5H,KAAK4d,eAAepB,EAAOC,EAAIC,GAAM,GAAtDhR,EAACmS,EAAA,GAAE5J,EAAI4J,EAAA,GAAEf,EAAIe,EAAA,GACpB,MAAO,CAAChJ,EAAIiJ,kBAAkBpS,EAAGuI,GAAO6I,EAC1C,GAEA,CAAAnf,IAAA,wBAAAE,MAKA,SAA8Bka,EAAuBgG,EAAiBvB,EAAeC,EAAcC,GACjG7H,EAAImJ,uBAAuBjG,EAAUgG,EAASvB,EAAOC,EAAIC,GACzD7H,EAAIoJ,QAAQlG,EAAU,eAAgB0E,EAAGyB,aAC3C,GAEA,CAAAvgB,IAAA,yBAAAE,MAKA,SAA+Bka,EAAuBgG,EAAiBvB,EAAeC,EAAcC,GAClG,IAAmEyB,EAAAvW,EAAjD5H,KAAKoe,2BAA2B5B,EAAOC,EAAIC,GAAM,GAA5DhR,EAACyS,EAAA,GAAErB,EAAIqB,EAAA,GACdtJ,EAAIoJ,QAAQlG,EAAU,eAAgBrM,GACtCmJ,EAAIoJ,QAAQlG,EAAU,cAAe+E,GACrC,IAAMuB,EAAOxJ,EAAIyJ,aAAavG,EAAU,mBACxCsG,EAAKE,QAAQ/B,MAAQlT,OAAOkT,GAC5B6B,EAAKE,QAAQR,QAAUzU,OAAOyU,EAChC,GAAC,CAAApgB,IAAA,uBAAAE,MAED,SAA6B6d,EAAqB8C,EAAwBC,GACxE,IAAAC,EAA2B,CAACD,EAAc9J,aAAaC,iBAAkB4J,EAAa7J,aAAaC,kBACnG,OAAO8G,EAAc3I,IADE2L,EAAA,GAATA,EAAA,GAEhB,GAEA,CAAA/gB,IAAA,WAAAE,MAKA,SAAiB8gB,GAGf,OAFoC,IAAhC7L,GAAW8L,QAAQD,KAAgBA,EAASA,EAAOE,UAAU,EAAG,IACpEF,EAASA,EAAOrT,MAAM,KAAK,GACpB,cAAPS,OAAqB4S,EAAM,OAC7B,GAAC,CAAAhhB,IAAA,YAAAE,MAED,SAAkBkgB,GAChB,OAAOrL,GAAOqL,EAChB,GAAC,CAAApgB,IAAA,kBAAAE,MAED,SAAwB8gB,GACtB,OAAOhM,GAAagM,EACtB,GAAC,CAAAhhB,IAAA,eAAAE,MAED,SAAqBkgB,GACnB,IAAMe,EAAYpM,GAAOqL,GACzB,IAAKe,GAA2B,KAAdA,EAAkB,MAAO,GAC3C,IAAMC,EAAQD,EAAUxT,MAAM,KAC9B,MAAiB,SAAbyT,EAAM,GAAsB,MACzBA,EAAM,EACf,GAAC,CAAAphB,IAAA,iBAAAE,MAED,SAAuBkgB,GACrB,OAAOlJ,EAAImK,SAAStM,GAAOqL,GAC7B,GAEA,CAAApgB,IAAA,YAAAE,MAKA,SAAkBohB,EAAmBC,GACnC,IAAMC,EAASF,EAAMvK,SAASC,aAAamI,KACrCsC,EAAanU,SAAS4P,cAAc,QAC1CuE,EAAWC,YAAcF,EAAOG,cAChC,IAAMP,EAAQE,EAAMN,OAAOrT,MAAM,KAEjC,GADiC,IAAjByT,EAAMxb,OACR,OAAO6b,EACrB,IAAMG,EAAeR,EAAM,GACrBV,EAAOpT,SAAS4P,cAAc,QAEpC,GADAwD,EAAK/F,YAAY8G,GACbF,EAAS,CACX,IAAMM,EAAavU,SAAS4P,cAAc,OAI1C,OAHA2E,EAAWC,IAAM5K,EAAImK,SAASO,GAC9BC,EAAW7G,UAAUC,IAAI,gBACzByF,EAAK/F,YAAYkH,GACVnB,CACT,CACA,IAAMqB,EAAYzU,SAAS4P,cAAc,OAIzC,OAHA6E,EAAUL,YAAcE,EAAaD,cACrCI,EAAU/G,UAAUC,IAAI,gBACxByF,EAAK/F,YAAYoH,GACVrB,CACT,GAEA,CAAA1gB,IAAA,cAAAE,MAIA,SAAoB8gB,GAClB,OAAOA,EAAOrT,MAAM,KAAK,GAAGgU,aAC9B,GAEA,CAAA3hB,IAAA,UAAAE,MAIA,SAAgBka,EAAuB4H,EAAkBN,GAAqB,IACtBO,EADsBC,EAAAxU,GAC3DwJ,EAAImG,cAAcjD,EAAU4H,IAAS,IAAtD,IAAAE,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAake,EAAA/hB,MAA8CwhB,YAAcA,CAAW,OAAA3gB,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CACtF,GAAC,CAAAlO,IAAA,SAAAE,MAED,SAAeka,EAAuB4H,EAAkBN,GAAqB,IACpBS,EADoBC,EAAA1U,GACzDwJ,EAAImG,cAAcjD,EAAU4H,IAAS,IAAvD,IAAAI,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,MAAcoe,EAAAjiB,MAA+C4hB,IAAMJ,CAAW,OAAA3gB,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CAChF,GAEA,CAAAlO,IAAA,iBAAAE,MAIA,WAAgD,QAAAmiB,EAAArX,UAAApF,OAAtB0c,EAAK,IAAA7Y,MAAA4Y,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAALD,EAAKC,GAAAvX,UAAAuX,GAC7BD,EAAM1f,SAAQ,SAAA4f,GACZA,EAAKlH,SACLkH,EAAKC,gBAAgB,KACvB,GACF,GAEA,CAAAziB,IAAA,cAAAE,MAIA,SAAoBka,EAAkCxM,GACpD,OAAOwM,EAAS7C,cAAc,eAADnJ,OAAgBR,EAAC,QAASN,SAAS4P,cAAc,MAChF,GAEA,CAAAld,IAAA,gBAAAE,MAIA,SAAsBka,GACpB,IAC2DsI,EADrD3Z,EAAiC,CAAC,EAAC4Z,EAAAjV,GACxBwJ,EAAImG,cAAcjD,EAAU,gBAAc,IAA3D,IAAAuI,EAAA/U,MAAA8U,EAAAC,EAAA9Z,KAAA9E,MAA6D,KAAlDsT,EAAEqL,EAAAxiB,MAAgD6I,EAAEsO,EAAGuJ,QAAQ4B,MAAQ,IAAMnL,CAAC,CAAC,OAAAtW,GAAA4hB,EAAA1U,EAAAlN,EAAA,SAAA4hB,EAAAzU,GAAA,CAC1F,OAAOnF,CACT,GAEA,CAAA/I,IAAA,YAAAE,MAIA,SAAkB0iB,GAChB,OAAO1L,EAAI2L,gBAAgB,IAAI5V,MAAOE,UAAayV,EACrD,GAEA,CAAA5iB,IAAA,WAAAE,MAIA,SAAiB4iB,GACf,IAAIvG,GAAK,IAAItP,MAAOE,UAAY,IAAQ2V,EAClC9J,EAAIrN,OAAO2J,KAAK4I,MAAM3B,EAAI,OAChCA,GAAQ,KACR,IAAMwG,EAAIpX,OAAO2J,KAAK4I,MAAM3B,EAAI,KAC1B3O,EAAIjC,OAAO2J,KAAK4I,MAAM3B,EAAI,KAChC,MAAO,GAAPnO,OAAU4K,EAAEgK,SAAS,EAAG,KAAI,KAAA5U,OAAI2U,EAAEC,SAAS,EAAG,KAAI,KAAA5U,OAAIR,EAAEoV,SAAS,EAAG,KACtE,GAEA,CAAAhjB,IAAA,iBAAAE,MACA,SAAuB+iB,GACrB,IAQIC,EAAGC,EAAIpa,EAAGiQ,EAAG+J,EAAGnV,EARhBwV,EAAU9N,KAAK4I,MAAM+E,GACrB5f,EAAS,GACTggB,EAAQ,EACNpI,EAAM,SAACpS,EAAW+E,GAGtB,OAFI/E,EAAI,GAAKwa,EAAQ,IAAGA,IACpBxa,EAAI,IAAGxF,GAAU,GAAJ+K,OAAOvF,EAAC,KAAAuF,OAAIR,EAAC,MACvByV,GAAS,CAClB,EAEsCC,EAAArZ,EAAvBsZ,GAAQH,EAASI,IAAM,GACtC,GADCN,EAACI,EAAA,GAAEF,EAAOE,EAAA,GACPrI,EAAIiI,EAAG,KAAQ,OAAO7f,EAAQ,IACMogB,EAAAxZ,EAAxBsZ,GAAQH,EAASM,IAAO,GACxC,GADCP,EAAEM,EAAA,GAAEL,EAAOK,EAAA,GACRxI,EAAIkI,EAAI,MAAS,OAAO9f,EAAQ,IACCsgB,EAAA1Z,EAAtBsZ,GAAQH,EAASQ,IAAK,GACrC,GADC7a,EAAC4a,EAAA,GAAEP,EAAOO,EAAA,GACP1I,EAAIlS,EAAG,KAAQ,OAAO1F,EAAQ,IACKwgB,EAAA5Z,EAAxBsZ,GAAQH,EAASU,IAAO,GACvC,GADC9K,EAAC6K,EAAA,GAAET,EAAOS,EAAA,GACP5I,EAAIjC,EAAG,KAAQ,OAAO3V,EAAQ,IACM0gB,EAAA9Z,EAAzBsZ,GAAQH,EAASY,IAAQ,GACxC,GADCjB,EAACgB,EAAA,GAAEX,EAAOW,EAAA,GACP9I,EAAI8H,EAAG,KAAQ,OAAO1f,EAAQ,IACG4gB,EAAAha,EAAtBsZ,GAAQH,EAAS,KAAK,GAErC,OAFCxV,EAACqW,EAAA,GAAEb,EAAOa,EAAA,GACXhJ,EAAIrN,EAAG,KACAvK,GAAU,KACnB,GAEA,CAAArD,IAAA,oBAAAE,MAOA,WAAqD,QAAAgkB,EAAAlZ,UAAApF,OAAxBue,EAAW,IAAA1a,MAAAya,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAXD,EAAWC,GAAApZ,UAAAoZ,GACtC,IAAK,IAALC,EAAA,EAAAC,EAAyBH,EAAWE,EAAAC,EAAA1e,OAAAye,IAAE,CAAjC,IAAME,EAAUD,EAAAD,GACnBnN,EAAI1K,KAAK+X,EAAY,SAAS,WAAkB,GAAI,CAAEC,SAAS,GACjE,CACF,GAEA,CAAAxkB,IAAA,gBAAAE,MACA,SAAsBmX,EAAiBpH,GACrCoH,EAAGqK,YAAczR,EACjBiH,EAAIyE,KAAKtE,EACX,GAEA,CAAArX,IAAA,gBAAAE,MACA,SAAsBukB,EAAsBC,EAAgB/F,EAAcG,GACpEH,GACF8F,EAAQ/C,YAAcxK,EAAIyN,qBAAqBD,EAAQ/F,EAAMG,GAC7D5H,EAAIyE,KAAK8I,EAAQG,gBACZ1N,EAAI2E,KAAK4I,EAAQG,cAC1B,KAAC1N,CAAA,CAveqB,GA6eXiF,GAAS,WAMpB,SAAAA,EAAaF,EAAkB/N,EAA+BgO,EAAqBnY,GAAmBmH,EAAA,KAAAiR,GAAAhQ,EAAA,oBAAAA,EAAA,4BAAAA,EAAA,sBACpG9J,KAAK0B,KAAOA,EACZ1B,KAAKwiB,OAASxiB,KAAKyiB,IAAI7I,EAAU/N,EAAGgO,EACtC,CAmCA,IAAA6I,EAVAC,EAvBAC,EA6CC,OA7CDjZ,EAAAmQ,EAAA,EAAAnc,IAAA,MAAAE,OAAA+kB,EAAAna,EAAAzL,IAAAA,MAIA,SAAAuR,EAAWqL,EAAkB/N,EAA+BgO,GAAmB,IAAAgJ,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAlmB,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OAC7EsX,EAAWA,GAAY,EAAIA,EAAW,QAChCiJ,EAAQhJ,EAAasJ,GAAOtJ,GAAcsJ,GAAOC,OACjDN,GAAQ,IAAIlY,MAAOE,UACnBiY,EAAOnJ,IAAaE,EAAUuJ,QAAWlI,OAAOmI,iBAAmBR,EAAQlJ,EAC3EoJ,EAAQD,EAAMD,EACdG,EAAgB,IAroBd,GAsoBJC,EAAMJ,EACV9iB,KAAKujB,cAAe,EAAK,YAClBL,EAAMH,GAAG,CAAAvU,EAAAlM,KAAA,aACVtC,KAAKujB,aAAc,CAAF/U,EAAAlM,KAAA,gBAAAkM,EAAAvM,OAAA,SAASjC,KAAKwjB,yBAAuB,QAC3B,OAA/B3X,EAAEgX,GAAOK,EAAMJ,GAASE,IAAOxU,EAAAlM,KAAA,GACzBmhB,GAAMR,GAAc,QAC1BC,GAAM,IAAItY,MAAOE,UAAS0D,EAAAlM,KAAA,gBAE5BuJ,EAAE,GACF7L,KAAKwjB,wBAAuB,yBAAAhV,EAAAxJ,OAAA,GAAAuJ,EAAA,UAC7B,SAAAR,EAAAM,EAAAqV,GAAA,OAAAd,EAAAha,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,OAAAE,OAAA8kB,EAAAla,EAAAzL,IAAAA,MACA,SAAA2mB,IAAA,OAAA3mB,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,cAAAshB,EAAAthB,KAAA,EACQtC,KAAKwiB,OAAM,wBAAAoB,EAAA5e,OAAA,GAAA2e,EAAA,UAClB,kBAAAhB,EAAA/Z,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,OAAAE,MACA,WACEmC,KAAKujB,cAAe,CACtB,GAEA,CAAA5lB,IAAA,cAAAE,OAAA6kB,EAAAja,EAAAzL,IAAAA,MAIA,SAAA6mB,IAAA,OAAA7mB,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OACa,OAAXtC,KAAKgF,OAAM8e,EAAAxhB,KAAA,EACLtC,KAAK+Z,OAAM,wBAAA+J,EAAA9e,OAAA,GAAA6e,EAAA,UAClB,kBAAAnB,EAAA9Z,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,wBAAAE,MACA,WACMmC,KAAK0B,MAAM1B,KAAK0B,MACtB,KAACoY,CAAA,CAxDmB,GAyDrBhQ,EAzDYgQ,GAAS,kBA0DtBA,GAAUuJ,SAAW,EAGd,IAAMF,GAAgD,CAC3DC,OAAQ,SAAAW,GAAC,OAAIA,CAAC,EACdC,OAAQ,SAAAD,GAAC,OAAIA,EAAIA,CAAC,EAClBE,QAAS,SAAAF,GAAC,OAAIA,GAAK,EAAIA,EAAE,EACzBG,WAAY,SAAAH,GAAC,OAAIA,EAAIA,EAAIA,CAAC,EAC1BI,YAAa,SAAAJ,GAAC,QAAOA,EAAKA,EAAIA,EAAI,CAAC,EACnCK,eAAgB,SAAAL,GACd,IAAMM,EAAM,EAAIpR,KAAKqR,GAAM,EAC3B,OAAa,IAANP,EACH,EACM,IAANA,EACE,EACA9Q,KAAKsR,IAAI,GAAI,GAAKR,GAAK9Q,KAAKuR,KAAS,GAAJT,EAAS,KAAQM,GAAM,CAChE,GAIWI,GAAW,WAItB,SAAAA,EAAarO,GAAkBvN,EAAA,KAAA4b,GAAA3a,EAAA,qBAAAA,EAAA,sBAC7B,IAAM4a,EAAe,SAAC3gB,GAAY,OAAKqS,EAAIlB,cAAc,eAADnJ,OAAgBhI,EAAI,KAAI,EAChF/D,KAAK2kB,MAAQ,CAAC,EACd3kB,KAAK2kB,MAAMC,SAAWF,EAAa,YACnC1kB,KAAK2kB,MAAME,OAASH,EAAa,UACjC1kB,KAAK2kB,MAAMG,SAAWJ,EAAa,YACnC1kB,KAAK2kB,MAAMI,SAAWL,EAAa,YACnC1kB,KAAK2kB,MAAMK,QAAUN,EAAa,WAClC1kB,KAAK2kB,MAAMM,QAAUP,EAAa,WAClC1kB,KAAK2kB,MAAMO,SAAWR,EAAa,YACnC1kB,KAAKuN,OAASmX,EAAa,SAC7B,CAyFC,OAvFD/a,EAAA8a,EAAA,EAAA9mB,IAAA,WAAAE,MACA,WACE,IAAM2F,EAAIxD,KAAK2kB,MACf9P,GAAI2E,KAAKhW,EAAEqhB,OAAQrhB,EAAEshB,SAAUthB,EAAEuhB,SAAUvhB,EAAEwhB,QAASxhB,EAAE0hB,UACxDrQ,GAAIyE,KAAK9V,EAAEohB,UACP5kB,KAAKuN,SAAQvN,KAAKuN,OAAO8R,YAAc9C,GD7tBzB,OC8tBpB,GAEA,CAAA5e,IAAA,SAAAE,MAGA,WACE,IAAM2F,EAAIxD,KAAK2kB,MACf9P,GAAI2E,KAAKhW,EAAEshB,SAAUthB,EAAEuhB,SAAUvhB,EAAEohB,SAAUphB,EAAE0hB,UAC/CrQ,GAAIyE,KAAK9V,EAAEqhB,QACP7kB,KAAKuN,SAAQvN,KAAKuN,OAAO8R,YAAc9C,GAAUA,GACvD,GAEA,CAAA5e,IAAA,WAAAE,MAIA,WACE,IAAM2F,EAAIxD,KAAK2kB,MACf9P,GAAI2E,KAAKhW,EAAEqhB,OAAQrhB,EAAEuhB,SAAUvhB,EAAEohB,SAAUphB,EAAE0hB,UAC7CrQ,GAAIyE,KAAK9V,EAAEshB,UACP9kB,KAAKuN,SAAQvN,KAAKuN,OAAO8R,YAAc9C,GDhvBvB,SCivBtB,GAEA,CAAA5e,IAAA,WAAAE,MACA,WACE,IAAM2F,EAAIxD,KAAK2kB,MACf9P,GAAI2E,KAAKhW,EAAEqhB,OAAQrhB,EAAEshB,SAAUthB,EAAEohB,SAAUphB,EAAEwhB,QAASxhB,EAAE0hB,UACxDrQ,GAAIyE,KAAK9V,EAAEuhB,UACP/kB,KAAKuN,SAAQvN,KAAKuN,OAAO8R,YAAc9C,GDvvBnB,aCwvB1B,GAEA,CAAA5e,IAAA,WAAAE,MACA,WACE,IAAM2F,EAAIxD,KAAK2kB,MACf9P,GAAI2E,KAAKhW,EAAEqhB,OAAQrhB,EAAEshB,SAAUthB,EAAEohB,SAAUphB,EAAEwhB,QAASxhB,EAAEuhB,SAAUvhB,EAAEyhB,SACpEpQ,GAAIyE,KAAK9V,EAAE0hB,UACX1hB,EAAE0hB,SAAS3G,QAAQ4G,QAAU5I,GD9vBF,eC+vB7B,GAAC,CAAA5e,IAAA,aAAAE,MAED,SAAYunB,GACV,IAAMC,EAAWrlB,KAAK2kB,MAAMK,QAC5B,GAAKI,GAAWA,EAAOE,UAAWF,EAAOF,SAAzC,CAKA,GAAyB,IAArBE,EAAOG,UAGT,OAFA1Q,GAAIyE,KAAKtZ,KAAK2kB,MAAMM,cACpBpQ,GAAI2E,KAAK6L,GAKX,GAFAxQ,GAAI2E,KAAKxZ,KAAK2kB,MAAMM,UAEfG,EAAOI,OAGV,OAFA3Q,GAAIyE,KAAK+L,QACTA,EAAS9G,QAAQ4G,QAAU5I,GDhxBM,uBCgxBkC,CAAEkJ,cAAqC,IAAtBL,EAAOK,cAAoBC,QAAQ,MAGzH7Q,GAAI2E,KAAK6L,EAdT,MAFExQ,GAAI2E,KAAK6L,EAiBb,GAEA,CAAA1nB,IAAA,aAAAE,MACA,SAAYunB,GAEV,GADAplB,KAAK2lB,WAAWP,IACXA,EAAQ,OAAOplB,KAAK+kB,WACzB,QAAQ,GACN,KAAMK,EAAOF,SACXllB,KAAKklB,WACL,MACF,KAAOE,EAAOE,QACZtlB,KAAK4kB,WACL,MACF,KAAOQ,EAAOQ,KACZ5lB,KAAK6kB,SACL,MACF,KAAMO,EAAOQ,KACX5lB,KAAK8kB,WACL,MACF,QACEnK,QAAQvZ,MAAM,0BAA2BgkB,GAE/C,KAACX,CAAA,CAxGqB,GAmHXoB,GAAS,WAIpB,SAAAA,EAAaC,EAAqBC,EAAsBC,EAAuBC,GAA+C,IAAAC,EAAA,KAAArd,EAAA,KAAAgd,GAAA/b,EAAA,sBAAAA,EAAA,wBAC5H9J,KAAK8lB,OAASA,EACiB,IAA3BA,EAAOpL,SAASnX,QAAcuiB,EAAOxN,YAAYrN,SAAS4P,cAAc,QAE5EhG,GAAI1K,KAAK2b,EAAQ,QAAO,eAAAK,EAAA1d,EAAAzL,IAAAA,MAAE,SAAAopB,EAAOxa,GAAa,IAAAya,EAAA,OAAArpB,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OAIxB,OAHpBsJ,EAAE2a,kBACF1R,GAAI2E,KAAKuM,GACHM,GAAYP,EAAOnN,UAAUhD,SAAS,MAC5CuQ,EAAKM,UAAW,EAAIF,EAAAzhB,KAAA,EAAAyhB,EAAAhkB,KAAA,EAEZ2jB,EAASI,GAAS,OAAAC,EAAAhkB,KAAA,gBAIuD,OAJvDgkB,EAAAzhB,KAAA,EAAAyhB,EAAA5Y,GAAA4Y,EAAA,SAExBJ,EAAKM,UAAW,EAChB3R,GAAIyE,KAAKyM,GACTA,EAAQ1G,YAAc9C,GAAUA,EAAmB,CAAE3O,IAAK0Y,EAAA5Y,GAAEE,KAAOtE,OAAMgd,EAAA5Y,MAAM4Y,EAAArkB,OAAA,kBAGjFikB,EAAKM,UAAW,EAAK,yBAAAF,EAAAthB,OAAA,GAAAohB,EAAA,kBACtB,gBAAAK,GAAA,OAAAN,EAAAvd,MAAA,KAAAD,UAAA,EAduB,IAexB3I,KAAK0mB,SAASV,EAChB,CAKC,OALArc,EAAAkc,EAAA,EAAAloB,IAAA,WAAAE,MAED,SAAU0D,GACJA,EAAOvB,KAAK8lB,OAAOnN,UAAUC,IAAI,MAChC5Y,KAAK8lB,OAAOnN,UAAUM,OAAO,KACpC,KAAC4M,CAAA,CA7BmB,GAiCtB,SAASpC,GAAOlD,GACd,OAAO,IAAIlc,SAAQ,SAAAxD,GAAO,OAAI0Y,WAAW1Y,EAAS0f,EAAG,GACvD,CAEA,IAAMY,GAAQ,QACRE,GAAS,OACTE,GAAO,MACPE,GAAS,KACTE,GAAU,IAGhB,SAAST,GAAS6C,EAAWnD,GAC3B,IAAMpa,EAAIyM,KAAK4I,MAAMkI,EAAInD,GACzB,MAAO,CAACpa,EAAGud,EAAIvd,EAAIoa,EACrB,CAuGO,IAAM+F,GAAW,WAQtB,SAAAA,EAAa1d,EAAoBmM,GAAuB,IAAAwR,EAAAC,EAAAC,EAAAC,EAAA,KAAAle,EAAA,KAAA8d,GAAA7c,EAAA,qBAAAA,EAAA,oBAAAA,EAAA,mBAAAA,EAAA,uBAAAA,EAAA,mBAAAA,EAAA,mBACtD9J,KAAKiJ,MAAQA,EACbjJ,KAAKiU,KAAgB,QAAZ2S,EAAGxR,EAAKnB,YAAI,IAAA2S,EAAAA,EAAI,EACzB5mB,KAAKuU,IAAMa,EAAK4R,QAAUC,GAAgBC,GAC1ClnB,KAAKmnB,QAAsB,QAAfN,EAAGzR,EAAK+R,eAAO,IAAAN,EAAAA,EAAK,WAAkB,EAClD7mB,KAAKonB,IAAMhS,EAAKgS,IAChBpnB,KAAKqU,IAAc,QAAXyS,EAAG1R,EAAKf,WAAG,IAAAyS,EAAAA,EAAI,EAEvBjS,GAAI1K,KAAKlB,EAAO,UAAU,WAAQ8d,EAAKM,cAAe,GACxD,CAmBC,OAnBA1d,EAAAgd,EAAA,EAAAhpB,IAAA,eAAAE,MAED,WACE,IAAQspB,EAAYnnB,KAAZmnB,QACJA,GAASA,EAAQnnB,KAAKnC,QAC5B,GAAC,CAAAF,IAAA,WAAAE,MAED,SAAU6N,GACR1L,KAAKiJ,MAAMpL,MAAQyL,OAAOoC,GAC1BA,EAAI1L,KAAKnC,QACLmC,KAAKonB,KAAKpnB,KAAKonB,IAAI1b,EAAG1L,KAAKiJ,MAAMpL,MACvC,GAAC,CAAAF,IAAA,QAAAE,MAED,WACE,IAAQoL,EAA0BjJ,KAA1BiJ,MAAOoL,EAAmBrU,KAAnBqU,IAAKJ,EAAcjU,KAAdiU,KAEeqT,EAAA1f,GAApB2M,EAFmBvU,KAARuU,KACbtB,KAAKqB,IAAIiT,GAAkBte,EAAMpL,MAAOwW,QAAAA,EAAO,GAAIA,QAAAA,EAAO,GAC9CJ,QAAAA,EAAQ,GAAE,GAA5BvI,EAAC4b,EAAA,GAAE/b,EAAC+b,EAAA,GAEX,OADAre,EAAMpL,MAAQ0N,EACPG,CACT,KAACib,CAAA,CApCqB,GA2CXa,GAAgB,SAAAC,GAAArd,EAAAod,EAAAC,GAAA,QAAAC,KAAAF,iZAI3B,SAAAA,EAAapR,EAAkBhB,GAA4B,IAAAuS,EAAAC,EAAA/e,EAAA,KAAA2e,GACd1d,EAAAC,EAA3C6d,EAAAF,EAAA/nB,KAAA,KAAMkV,GAAIyJ,aAAalI,EAAK,SAAUhB,IAAK,cAAAtL,EAAAC,EAAA6d,GAAA,eAC3CA,EAAKxS,KAAOA,EACZwS,EAAKC,IAAc,QAAXF,EAAGvS,EAAKyS,WAAG,IAAAF,EAAAA,EAAI,EAEvB,IAAMG,EAAKjT,GAAIyJ,aAAalI,EAAK,gBAC3B2R,EAAOlT,GAAIyJ,aAAalI,EAAK,kBAGkB,OADrDvB,GAAI1K,KAAK2d,EAAI,SAAS,WAAQF,EAAKI,UAAU,EAAG,IAChDnT,GAAI1K,KAAK4d,EAAM,SAAS,WAAQH,EAAKI,WAAW,EAAG,IAAEJ,CACvD,CAWC,OAXAje,EAAA6d,EAAA,EAAA7pB,IAAA,yBAAAE,MAED,SAAwBgqB,EAAaxT,GACnCrU,KAAK6nB,IAAMA,EACX7nB,KAAKqU,IAAMA,CACb,GAAC,CAAA1W,IAAA,YAAAE,MAED,SAAWoqB,GACT,IAAQJ,EAAoB7nB,KAApB6nB,IAAKxT,EAAerU,KAAfqU,IAAerU,KAAViJ,MACZpL,MAAQyL,OAAO2J,KAAKqB,IAAItU,KAAKnC,QAAUoqB,EAAOJ,EAAKxT,IACzDrU,KAAKqnB,cACP,KAACG,CAAA,CAzB0B,CAASb,IA4BzBuB,GAAU,WAMrB,SAAAA,EAAa9R,EAAkB+Q,GAA8B,IAAAgB,EAAA,KAAAtf,EAAA,KAAAqf,GAAApe,EAAA,qBAAAA,EAAA,oBAAAA,EAAA,iBAAAA,EAAA,uBAC3D9J,KAAKmnB,QAAUA,EACfnnB,KAAKka,EAAI,EAET,IAAMkO,EAAQnd,SAAS4P,cAAc,OACrCuN,EAAM7J,QAAQ4B,KAAO,QACrB/J,EAAIkC,YAAY8P,GAChB,IAAMC,EAAQroB,KAAKqoB,MAAQpd,SAAS4P,cAAc,OAClDwN,EAAM9J,QAAQ4B,KAAO,QACrBiI,EAAM9P,YAAY+P,GAClB,IAAMC,EAAOtoB,KAAKsoB,KAAOrd,SAAS4P,cAAc,OAChDyN,EAAK/J,QAAQ4B,KAAO,OACpBkI,EAAM/P,YAAYgQ,GAElBzT,GAAI1K,KAAKiM,EAAK,aAAa,SAACxK,GAC1B,GAAiB,IAAbA,EAAE2c,OAAN,CACA3c,EAAE4c,iBACF5c,EAAE2a,kBACF,IAAMkC,EAAS7c,EAAEkK,MACXW,EAAI4R,EAAMK,YACVC,EAAYR,EAAKjO,EAAIzD,EAErBmS,EAAa,SAACC,GAClBA,EAAGL,iBACH,IAAMM,EAHK,SAACD,GAAc,OAAK5V,KAAKqB,IAAIrB,KAAKoB,IAAIsU,GAAaE,EAAG/S,MAAQ2S,GAAShS,GAAI,EAAE,CAG9EV,CAAK8S,GACfV,EAAKjO,EAAI4O,EAAIrS,EACb6R,EAAK/N,MAAMxE,KAAO,GAAHhK,OAAe,IAAToc,EAAKjO,EAAO,KACjCiO,EAAKhB,QAAQgB,EAAKjO,EACpB,EAMArF,GAAI1K,KAAKc,SAAU,YAAa2d,GAChC/T,GAAI1K,KAAKc,SAAU,WANH,SAAV8d,EAAWF,GACfD,EAAWC,GACXhU,GAAImU,OAAO/d,SAAU,YAAa2d,GAClC/T,GAAImU,OAAO/d,SAAU,UAAW8d,EAClC,GAlB0B,CAqB5B,IAEAlU,GAAI1K,KAAKiM,EAAK,SAAS,SAACxK,GACtB,GAAiB,IAAbA,EAAE2c,OAAN,CACA,IAAMU,EAAIrd,EAAEkK,MACN4K,EAAI7L,GAAIyC,cAAc+Q,GAC5BF,EAAKjO,EAAIgP,IAAOD,EAAIvI,EAAE5J,UAAY4J,EAAE3J,MAAO,EAAG,GAC9CuR,EAAK/N,MAAMxE,KAAO,GAAHhK,OAAMoc,EAAKjO,EAAIwG,EAAE3J,MAAK,MACrCoR,EAAKhB,QAAQgB,EAAKjO,EALQ,CAM5B,GACF,CAKC,OALAvQ,EAAAue,EAAA,EAAAvqB,IAAA,WAAAE,MAED,SAAUqc,GACRla,KAAKka,EAAIgP,GAAMhP,EAAG,EAAG,GACrBla,KAAKsoB,KAAK/N,MAAMxE,KAAO,GAAHhK,OAAe,IAAT/L,KAAKka,EAAO,IACxC,KAACgO,CAAA,CAzDoB,GA4DhB,SAAShB,GAAaxb,EAAWuI,GACtC,IAAMkV,EAAMlW,KAAKsR,IAAI,GAAItQ,QAAAA,EAAQ,GAE7B1I,GADJG,EAAIuH,KAAKC,MAAMxH,EAAIyd,GAAOA,GAChBzD,QAAQzR,GAClB,GAAIA,EAAO,EAAG,CACZ,KAAO1I,EAAE6d,SAAS,MAAM7d,EAAIA,EAAEsT,UAAU,EAAGtT,EAAEhI,OAAS,GAClDgI,EAAE6d,SAAS,OAAM7d,EAAIA,EAAEsT,UAAU,EAAGtT,EAAEhI,OAAS,GACrD,CACA,MAAO,CAACmI,EAAGH,EACb,CAEO,SAAS0b,GAAevb,EAAW2d,GACxC,IAAMF,EAAMlW,KAAK4I,MAAM5I,KAAKE,MAAMF,KAAKmK,IAAI1R,KAC3C,OAAIyd,GAAO,EAAU,CAAClW,KAAKC,MAAMxH,GAAIA,EAAEga,QAAQ,IAExCwB,GAAYxb,EADNuH,KAAKoB,IAAI,EAAI8U,EAAKE,GAEjC,CAEO,SAAS9B,GAAmB+B,EAAgCC,GACjE,IAAM7d,EAAI8d,YAAYF,QAAAA,EAAc,IAAInX,QAAQ,KAAM,KACtD,OAAK7O,MAAMoI,GACJ6d,QAAAA,EAAgB,EADD7d,CAExB,CAGO,SAASwd,GAAOxd,EAAW2I,EAAaC,GAC7C,OAAI5I,EAAI2I,EAAYA,EAChB3I,EAAI4I,EAAYA,EACb5I,CACT,CAEO,SAAe+d,GAAYC,EAAAC,EAAAC,EAAAC,GAAA,OAAAC,GAAAlhB,MAAA,KAAAD,UAAA,CAcjC,SAAAmhB,KAAA,OAAAA,GAAArhB,EAAAzL,IAAAA,MAdM,SAAA+sB,EAA6BC,EAAaC,EAAqBC,EAAoB9B,GAAa,IAAA+B,EAAAC,EAAA,OAAAptB,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,cAAA+nB,EAAAxlB,KAAA,EAAAwlB,EAAA/nB,KAAA,EAE7F+Q,UAAUiX,UAAUC,UAAUP,GAAI,OAAAK,EAAA/nB,KAAA,eAAA+nB,EAAAxlB,KAAA,EAAAwlB,EAAA3c,GAAA2c,EAAA,SAExC1P,QAAQvZ,MAAM,mBAAkBipB,EAAA3c,IAAM,OAElCyc,EAAoBF,EAAO1P,MAAM6N,MACjCgC,EAAmBF,EAAM3P,MAAM6N,MACrC6B,EAAO1P,MAAM6N,MAAQA,EACrB8B,EAAM3P,MAAM6N,MAAQA,EACpB7O,YAAW,WACT0Q,EAAO1P,MAAM6N,MAAQ+B,EACrBD,EAAM3P,MAAM6N,MAAQgC,CACtB,GAAG,KAAI,yBAAAC,EAAArlB,OAAA,GAAA+kB,EAAA,mBACRnhB,MAAA,KAAAD,UAAA,KCuKG6hB,GClyCAC,GAA2BC,GAA6BC,GCdvCC,GAAQ,oBAAAA,IAAA/hB,EAAA,KAAA+hB,EAAA,CAI1B,OAJ0BjhB,EAAAihB,EAAA,EAAAjtB,IAAA,SAAAE,MAE3B,WACE,KACD+sB,CAAA,CAJ0B,GFoBjBC,GAAgB,SAAhBA,GAAgB,OAAhBA,EAAAA,EAAgB,+BAAhBA,EAAAA,EAAgB,yBAAhBA,EAAAA,EAAgB,6BAAhBA,CAAgB,MAuMhBC,GAAc,SAAdA,GAAc,OAAdA,EAAAA,EAAc,uBAAdA,EAAAA,EAAc,qBAAdA,EAAAA,EAAc,6BAAdA,CAAc,MA03BdC,GAAU,SAAVA,GAAU,OAAVA,EAAAA,EAAU,iCAAVA,EAAAA,EAAU,yBAAVA,EAAAA,EAAU,2BAAVA,CAAU,MA2JTC,GAAgB,WAsEtB,SAASC,KACd,OAAOT,EACT,yaCvyCO,SAASU,GAAoBC,GAAyC,IAAAnR,EAC5B,CAACmR,EAAKT,eAAgBS,EAAKR,aAAcQ,EAAKV,cAA5FC,GAAc1Q,EAAA,GAAE2Q,GAAY3Q,EAAA,GAAEyQ,GAAYzQ,EAAA,EAC7C,CAEA,IAAMoR,GAAe,IAAI5X,KAAKC,aAAaoB,GAAIzB,YAAa,CAC1DQ,yBAA0B,EAC1BC,yBAA0B,IAQfwX,GAAM1hB,GAMjB,SAAA0hB,EAAaC,EAAkB3M,EAAgB4M,GAA0B,IAAApS,EAAA,KAAAtQ,EAAA,KAAAwiB,GAAAvhB,EAAA,mBAAAA,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,kBACvE9J,KAAKsrB,IAAMA,EACX,IAAME,EAAOxrB,KAAKwrB,KAAOf,GAAagB,WAAU,GAC1CtL,EAAOngB,KAAKmgB,KAAOtL,GAAI6W,cAAcF,GAE3CrL,EAAKwL,QAAQtM,YAAciM,EAAIM,YAC/BzL,EAAKgF,QAAQ5G,QAAQ4G,QAAUmG,EAAIO,YAI/BlN,EAAQwB,EAAK2L,UAAUrM,IAAM5K,GAAImK,SAASL,GACzC9J,GAAI2E,KAAK2G,EAAK2L,WAEnB9rB,KAAK+rB,IAAK,EACVlX,GAAI1K,KAAKqhB,EAAM,SAAS,WAClBrS,EAAK4S,KACT5S,EAAK4S,IAAK,EACVP,EAAK7S,UAAUC,IAAI,YACnB2S,EAAOS,SACT,IACAnX,GAAI1K,KAAKgW,EAAK2F,OAAQ,SAAS,SAAAla,GACxBuN,EAAK4S,KACVngB,EAAE2a,kBACFpN,EAAK4S,IAAK,EACVP,EAAK7S,UAAUM,OAAO,YACtBsS,EAAOU,UACT,GACF,IAOWC,GAAa,SAAAC,GAAA/hB,EAAA8hB,EAAAC,GAAA,IAAAzE,EAAA0E,GAAAF,GAKxB,SAAAA,EAAaZ,EAAkB3M,EAAgB0N,EAA2BlF,GAAqB,IAAAjB,EAO7F,GAP6Frd,EAAA,KAAAqjB,GAI3FpiB,EAAAC,EAHFmc,EAAAwB,EAAA/nB,KAAA,KAAM2rB,EAAK3M,EAAQ,CACjBqN,OAAQ,kBAAM9F,EAAK8F,QAAQ,EAC3BC,QAAS,kBAAM/F,EAAK+F,SAAS,KAC7B,kBAAAniB,EAAAC,EAAAmc,GAAA,kBAAApc,EAAAC,EAAAmc,GAAA,eACFA,EAAKmG,KAAOA,EACZnG,EAAKiB,QAAU,kBAAMA,GAAS,OACV1lB,IAAhB6pB,EAAG,QAAwB,MAAM9pB,MAAM,qBAC3C,IAAM8qB,EAAMhB,EAAG,QACTiB,EAAUrG,EAAKqG,QAAU7B,GAAee,WAAU,GAMR,OAJhDvF,EAAK/F,KAAKqM,SAASlU,YAAYiU,GAClB1X,GAAI6W,cAAca,GAC1BE,OAAOpN,YAAciN,EAAIG,OAC9BvG,EAAK6F,QAA8B,IAAlBM,EAAKf,EAAI3tB,KAAuB0uB,EAAKf,EAAI3tB,KAAO2tB,EAAG,QAChEpF,EAAK6F,IAAI7F,EAAKsF,KAAK7S,UAAUC,IAAI,YAAWsN,CAClD,CAcC,OAdAvc,EAAAuiB,EAAA,EAAAvuB,IAAA,QAAAE,MAED,WACMmC,KAAK+rB,KAAO/rB,KAAKsrB,IAAG,eAAiBtrB,KAAKqsB,KAAKrsB,KAAKsrB,IAAI3tB,KACvDqC,KAAKqsB,KAAKrsB,KAAKsrB,IAAI3tB,KAAOqC,KAAK+rB,GACpC/rB,KAAKmnB,SACP,GAAC,CAAAxpB,IAAA,SAAAE,MAED,WACEmC,KAAK0sB,OACP,GAAC,CAAA/uB,IAAA,UAAAE,MAED,WACEmC,KAAK0sB,OACP,KAACR,CAAA,CAnCuB,CAASb,IA2CtBsB,GAAa,SAAAC,GAAAxiB,EAAAuiB,EAAAC,GAAA,IAAAC,EAAAT,GAAAO,GAMxB,SAAAA,EAAarB,EAAkB3M,EAAgB0N,EAA2BlF,GAAqB,IAAAJ,EAO7F,GAP6Fle,EAAA,KAAA8jB,GAI3F7iB,EAAAC,EAHFgd,EAAA8F,EAAAltB,KAAA,KAAM2rB,EAAK3M,EAAQ,CACjBqN,OAAQ,kBAAMjF,EAAKiF,QAAQ,EAC3BC,QAAS,kBAAMlF,EAAKkF,SAAS,KAC7B,kBAAAniB,EAAAC,EAAAgd,GAAA,YAAAjd,EAAAC,EAAAgd,GAAA,kBAAAjd,EAAAC,EAAAgd,GAAA,eACFA,EAAKsF,KAAOA,EACZtF,EAAKI,QAAUA,OACK1lB,IAAhB6pB,EAAIwB,QAAuB,MAAMtrB,MAAM,uBAC3C,IAAM8qB,EAAMhB,EAAIwB,QACVC,EAASV,EAAKf,EAAI3tB,KAU4B,OATpDopB,EAAKgF,QAAuB,IAAXgB,EACbhG,EAAKgF,IACPhF,EAAKyE,KAAK7S,UAAUC,IAAI,YACxBmO,EAAKkC,EAAI8D,GAEThG,EAAKkC,EAAIqC,EAAG,QAGdvE,EAAKiG,QAAU,IAAIC,GAAeX,EAAKvF,EAAKkC,EAAG,CAAE9B,QAAAA,EAAS+F,SADzC,WAAQnG,EAAKyE,KAAK7S,UAAUC,IAAI,WAAY,EACOuU,aAAcd,EAAMe,YAAa9B,EAAI3tB,MACzGopB,EAAK5G,KAAKqM,SAASlU,YAAYyO,EAAKiG,QAAQT,SAAQxF,CACtD,CAgBC,OAhBApd,EAAAgjB,EAAA,EAAAhvB,IAAA,SAAAE,MAED,WACEmC,KAAKqsB,KAAKrsB,KAAKsrB,IAAI3tB,KAAOqC,KAAKipB,EAC/BjpB,KAAKmnB,SACP,GAAC,CAAAxpB,IAAA,UAAAE,MAED,kBACSmC,KAAKqsB,KAAKrsB,KAAKsrB,IAAI3tB,KAC1BqC,KAAKmnB,SACP,GAAC,CAAAxpB,IAAA,WAAAE,MAED,SAAUorB,GACRjpB,KAAKgtB,QAAQK,SAASpE,GACtBjpB,KAAK+rB,IAAK,EACV/rB,KAAKwrB,KAAK7S,UAAUC,IAAI,WAC1B,KAAC+T,CAAA,CA1CuB,CAAStB,IAmEtB4B,GAAc,WAmBzB,SAAAA,EACEjK,EACAsK,EACAlY,GACA,IAAAmY,EAAA1G,EAAA2G,EAAAC,EAAA7F,EAAA,KAAA/e,EAAA,KAAAokB,GAAAnjB,EAAA,uBAAAA,EAAA,qBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,4BAAAA,EAAA,2BAAAA,EAAA,iBAAAA,EAAA,0BAAAA,EAAA,iBAAAA,EAAA,iBAAAA,EAAA,sBAAAA,EAAA,sBAAAA,EAAA,wBAAAA,EAAA,uBAToCA,EAAA,uBAClBA,EAAA,wBAAAA,EAAA,uBASlB,IAAMyiB,EAAUvsB,KAAKusB,QAAU5B,GAAac,WAAU,GAChDtL,EAAOngB,KAAKmgB,KAAOtL,GAAI6W,cAAca,GAC3CpM,EAAKuN,cAAcrO,YAAc2D,EAAMF,MAAM6K,MAC7CxN,EAAKyN,YAAYvO,YAAc2D,EAAMD,IAAI4K,MACzCxN,EAAK0N,MAAMxO,YAAc2D,EAAM6K,MAC/B1N,EAAK2N,MAAMzO,YAAc2D,EAAM8K,MAC/B9tB,KAAKgjB,MAAQA,EACbhjB,KAAKstB,QAAUA,EACfttB,KAAKmtB,aAAe/X,EAAK+X,aACzBntB,KAAKotB,YAA8B,QAAnBG,EAAGnY,EAAKgY,mBAAW,IAAAG,EAAAA,EAAI,GACvCvtB,KAAK+tB,OAASC,QAAQ5Y,EAAK2Y,QAC3B/tB,KAAKiuB,OAASD,QAAQ5Y,EAAK6Y,QAE3BjuB,KAAKkuB,YAAYF,QAAQ5Y,EAAK8P,WAC9BllB,KAAKmnB,QAAsB,QAAfN,EAAGzR,EAAK+R,eAAO,IAAAN,EAAAA,EAAK,WAAkB,EAClD7mB,KAAKktB,SAAwB,QAAhBM,EAAGpY,EAAK8X,gBAAQ,IAAAM,EAAAA,EAAK,WAAkB,EACpDxtB,KAAKmuB,QAAsB,QAAfV,EAAGrY,EAAK+Y,eAAO,IAAAV,EAAAA,EAAK,WAAkB,EAClDztB,KAAKouB,QAAUhZ,EAAKgZ,SAAY,SAACnF,GAAS,OAAKA,CAAC,EAEhD,IAAQoF,EAAmBlO,EAAnBkO,OAAQjpB,EAAW+a,EAAX/a,OACVkpB,EAAStL,EAAMD,IAAIkG,EAAIjG,EAAMF,MAAMmG,EACnCsF,EAASvL,EAAMD,IAAIlC,EAAImC,EAAMF,MAAMjC,EACnC2N,EAAa,SAACvF,GAAS,OAAMA,EAAIjG,EAAMF,MAAMmG,GAAKqF,CAAM,EAI9DtuB,KAAKka,EAAIsU,EAAWlB,GACpBttB,KAAKyuB,WAAazuB,KAAKipB,EAAIqE,EAC3BttB,KAAK6gB,EAAI7gB,KAAKka,EAAIqU,EAASvL,EAAMF,MAAMjC,EACvC7gB,KAAK0uB,OAAO1uB,KAAKyuB,WAAY,CAAEE,YAAY,IAG3C,IAAMC,EAAY,SAAZA,EAAahjB,GACjB,IAAIgc,EAAK1C,WACM,WAAXtZ,EAAElM,MAAqBkM,EAAEpC,SAAW2W,EAAK0O,QAA7C,CACA,IAAMtjB,EAAI4U,EAAK0O,OAAOhxB,MACtB,GAAI0N,EAAG,CACL,IAAMujB,EAAKtF,WAAWje,GACjBjI,MAAMwrB,KACTlH,EAAK6G,WAAavF,GAAM4F,EAAI9L,EAAMF,MAAMmG,EAAGjG,EAAMD,IAAIkG,GACrDrB,EAAK1N,EAAIsU,EAAW5G,EAAK6G,YACzB7G,EAAK/G,EAAI+G,EAAK1N,EAAIqU,EAASvL,EAAMF,MAAMjC,EACvC+G,EAAK8G,OAAO9G,EAAK6G,YAErB,CACA5Z,GAAI2E,KAAK2G,EAAK0O,QACdha,GAAIyE,KAAK6G,EAAK8I,GACdpU,GAAImU,OAAO/d,SAAU,QAAS2jB,GAC9BhH,EAAKT,SAdsD,CAe7D,EAEAtS,GAAI1K,KAAKgW,EAAK8I,EAAG,SAAS,SAAArd,GACpBgc,EAAK1C,WACTrQ,GAAI2E,KAAK2G,EAAK8I,GACdpU,GAAIyE,KAAK6G,EAAK0O,QACd1O,EAAK0O,OAAOE,QACZ5O,EAAK0O,OAAOhxB,MAAQutB,GAAa/P,OAAOuM,EAAK6G,YAC7C5Z,GAAI1K,KAAKc,SAAU,QAAS2jB,GAC5BhjB,EAAE2a,kBACJ,IAEA1R,GAAI1K,KAAKgW,EAAK0O,OAAQ,SAAUD,GAEhC,IAAMI,EAAY,SAAZA,EAAapjB,GACjB,IAAIgc,EAAK1C,WACM,WAAXtZ,EAAElM,MAAqBkM,EAAEpC,SAAW2W,EAAK8O,QAA7C,CACA,IAAM1jB,EAAI4U,EAAK8O,OAAOpxB,MACtB,GAAI0N,EAAG,CACL,IAAM2jB,EAAK1F,WAAWje,GACjBjI,MAAM4rB,KACTtH,EAAK/G,EAAIqI,GAAMgG,EAAIlM,EAAMF,MAAMjC,EAAGmC,EAAMD,IAAIlC,GAC5C+G,EAAK1N,GAAK0N,EAAK/G,EAAImC,EAAMF,MAAMjC,GAAK0N,EACpC3G,EAAK6G,WAAazL,EAAMF,MAAMmG,EAAIrB,EAAK1N,EAAIoU,EAC3C1G,EAAK8G,OAAO9G,EAAK6G,YAErB,CACA5Z,GAAI2E,KAAK2G,EAAK8O,QACdpa,GAAIyE,KAAK6G,EAAKU,GACdhM,GAAImU,OAAO/d,SAAU,QAAS+jB,GAC9BpH,EAAKT,SAdsD,CAe7D,EAEAtS,GAAI1K,KAAKgW,EAAKU,EAAG,SAAS,SAAAjV,GACpBgc,EAAK1C,WACTrQ,GAAI2E,KAAK2G,EAAKU,GACdhM,GAAIyE,KAAK6G,EAAK8O,QACd9O,EAAK8O,OAAOF,QACZ5O,EAAK8O,OAAOpxB,MAAQutB,GAAa/P,OAAOuM,EAAK/G,GAC7ChM,GAAI1K,KAAKc,SAAU,QAAS+jB,GAC5BpjB,EAAE2a,kBACJ,IAEA1R,GAAI1K,KAAKgW,EAAK8O,OAAQ,SAAUD,GAGhCna,GAAI1K,KAAK/E,EAAQ,aAAa,SAACwG,GAC7B,IAAIgc,EAAK1C,UACQ,IAAbtZ,EAAE2c,OAAN,CACA3c,EAAE4c,iBACF5c,EAAE2a,kBACFqB,EAAKsF,WACL,IAAMzE,EAAS7c,EAAEkK,MACXW,EAAI4X,EAAO3F,YAActjB,EAAOsR,YAChCiS,EAAY6F,EAAW5G,EAAK6G,YAAchY,EAE1CmS,EAAa,SAACC,EAAgBsG,GAClCtG,EAAGL,iBACHZ,EAAK1N,EAHM,SAAC2O,GAAc,OAAK5V,KAAKqB,IAAIrB,KAAKoB,IAAIsU,GAAaE,EAAG/S,MAAQ2S,GAAShS,GAAI,EAAE,CAG/EV,CAAK8S,GAAMpS,EACpBmR,EAAK6G,WAAa7G,EAAK1N,EAAIoU,EAAStL,EAAMF,MAAMmG,EAChDrB,EAAK/G,EAAI+G,EAAK1N,EAAIqU,EAASvL,EAAMF,MAAMjC,EACvC+G,EAAK8G,OAAO9G,EAAK6G,WAAY,CAAEW,YAAaD,GAC9C,EAOAta,GAAI1K,KAAKc,SAAU,YAAa2d,GAChC/T,GAAI1K,KAAKc,SAAU,WAPH,SAAV8d,EAAWF,GACfD,EAAWC,GAAI,GACfhU,GAAImU,OAAO/d,SAAU,YAAa2d,GAClC/T,GAAImU,OAAO/d,SAAU,UAAW8d,GAChCnB,EAAKT,SACP,GApB0B,CAuB5B,IAEAtS,GAAI1K,KAAKgW,EAAKkP,UAAW,SAAS,SAACzjB,GACjC,IAAIgc,EAAK1C,UACQ,IAAbtZ,EAAE2c,OAAN,CACA,IAAMU,EAAIrd,EAAEkK,MACN4K,EAAI7L,GAAIyC,cAAc6I,EAAKkO,QACjCzG,EAAK1N,EAAIgP,IAAOD,EAAIvI,EAAE5J,UAAY4J,EAAE3J,MAAO,EAAG,GAC9C6Q,EAAK6G,WAAa7G,EAAK1N,EAAIoU,EAAStL,EAAMF,MAAMmG,EAChDrB,EAAK/G,EAAI+G,EAAK1N,EAAIqU,EAASvL,EAAMF,MAAMjC,EACvC+G,EAAK8G,OAAO9G,EAAK6G,WANS,CAO5B,GACF,CA+CC,OA/CA9kB,EAAAsjB,EAAA,EAAAtvB,IAAA,cAAAE,MAED,SAAaqnB,GACXllB,KAAKusB,QAAQ5T,UAAUmN,OAAO,WAAYZ,GAC1CllB,KAAKklB,SAAWA,CAClB,GAAC,CAAAvnB,IAAA,YAAAE,MAED,SAAW0N,GACTvL,KAAKmgB,KAAK8I,EAAE5J,YAAc9T,CAC5B,GAAC,CAAA5N,IAAA,YAAAE,MAED,SAAW0N,GACTvL,KAAKmgB,KAAKU,EAAExB,YAAc9T,CAC5B,GAAC,CAAA5N,IAAA,SAAAE,MAED,SAAQorB,EAAWqD,GAAwB,IAAAgD,EACnCnP,EAAOngB,KAAKmgB,KACdngB,KAAK+tB,SAAQ9E,EAAIhW,KAAKC,MAAM+V,IAC5BjpB,KAAKiuB,SAAQjuB,KAAK6gB,EAAI5N,KAAKC,MAAMlT,KAAK6gB,IAC1CV,EAAK8I,EAAE5J,YAAc+L,GAAa/P,OAAO4N,GACzC9I,EAAKU,EAAExB,YAAc+L,GAAa/P,OAAOrb,KAAK6gB,GAC1C7gB,KAAKiuB,SAAQ9N,EAAKU,EAAExB,YAAc,GAAHtT,OAAM/L,KAAK6gB,IAC9C,IAAM0O,EAAarG,GAAMlpB,KAAKka,EAAG,EAAG,GACpCiG,EAAK/a,OAAOmV,MAAMxE,KAAO,QAAHhK,OAAwB,IAAbwjB,EAAgB,QAAAxjB,OAAoB,GAAbwjB,EAAe,OACvEvvB,KAAKipB,EAAIA,EACTjpB,KAAKyuB,WAAaxF,EAClBqD,EAAS,QAANgD,EAAGhD,SAAG,IAAAgD,EAAAA,EAAI,CAAC,EACVtvB,KAAKmtB,eAAcntB,KAAKmtB,aAAantB,KAAKotB,aAAeptB,KAAKouB,QAAQpuB,KAAKipB,EAAGjpB,KAAK6gB,IAClFyL,EAAIqC,aACP3uB,KAAKmuB,QAAQlF,EAAGjpB,KAAK6gB,GAChByL,EAAI8C,YAAYpvB,KAAKmnB,UAE9B,GAAC,CAAAxpB,IAAA,WAAAE,MAED,SAAUorB,EAAW0F,GACnB,IAAM3L,EAAQhjB,KAAKgjB,MACnBhjB,KAAKka,GAAK+O,EAAIjG,EAAMF,MAAMmG,IAAMjG,EAAMD,IAAIkG,EAAIjG,EAAMF,MAAMmG,GAC1DjpB,KAAK6gB,EAAImC,EAAMF,MAAMjC,EAAI7gB,KAAKka,GAAK8I,EAAMD,IAAIlC,EAAImC,EAAMF,MAAMjC,GAC7D7gB,KAAK0uB,OAAOzF,EAAG,CAAE0F,WAAAA,GACnB,GAAC,CAAAhxB,IAAA,WAAAE,MAED,WACE,OAAOmC,KAAKipB,IAAMjpB,KAAKstB,OACzB,GAAC,CAAA3vB,IAAA,QAAAE,MAED,WACEmC,KAAKqtB,SAASrtB,KAAKstB,SAAS,EAC9B,KAACL,CAAA,CA3MwB,GA8MrB/D,GAAQ,SAACxd,EAAW2I,EAAaC,GAAW,OAAa5I,EAAI2I,EAAMA,EAAM3I,EAAI4I,EAAMA,EAAM5I,CAAC,6gCExXzF,IAwCMqH,GAAqB,IAE3B,SAASyc,GAAYrG,GAC1B,IAAMxrB,EAAMwrB,EAAIsG,KAAOlT,EAAeA,EAChC5K,EAAO1G,SAASqL,gBAAgB3E,KAAK+d,cAC3C,OAAOnT,GAAU5e,GAAKgyB,kBAAkBhe,EAC1C,CAEO,SAASie,GAAYzG,GAC1B,OAjDmB,IAiDZA,EAAIzpB,KAxCe,IAwCGypB,EAAI0G,IAAuBtT,GL0Bd,6BK1B6DA,GAAUA,GAAwBA,GAAUA,EACrJ,CAGO,SAASuT,GAAa3G,GAC3B,OArDoB,IAqDbA,EAAIzpB,OAAoBypB,EAAIsG,IACrC,CAMO,SAASM,GAAkBC,GAChC,IAAKA,EAAMC,QAAS,OAAO,EAAK,IACC9kB,EADDC,EAAAC,GACZ2kB,EAAMC,SAAO,IAAjC,IAAA7kB,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MACE,GADcyJ,EAAAtN,MACJqyB,OAAQ,OAAO,CAC1B,OAAAxxB,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACD,OAAO,CACT,CAQO,SAASskB,GAAcH,GAC5B,IAAKA,EAAM/a,GAAI,OAAOsH,GL/CW,oBKgDjC,IAAM6T,EAASL,GAAiBC,GAChC,OAAQA,EAAMziB,QACZ,KAlEyB,EAkEL,OAAOgP,GAAUA,GACrC,KAlEuB,EAkEL,OAAOA,GLpDL,SKqDpB,KAlEwB,EAmEtB,OAAIyT,EAAMK,WAAmB9T,GAAUA,GAChC6T,EAAS,GAAHrkB,OAAMwQ,GAAUA,GAAe,KAAAxQ,OAAIwQ,GAAUA,IAAsBA,GAAUA,GAC5F,KApE0B,EAqExB,OAAI6T,EAAe7T,GAAUA,GACR,IAAjByT,EAAMM,QApFM,IAoFUN,EAAMtwB,KAAwB6c,GLvDnC,YKwDdA,GAAUA,GACnB,KAvE0B,EAwExB,OAAO6T,EAAS,GAAHrkB,OAAMwQ,GAAUA,GAAiB,KAAAxQ,OAAIwQ,GAAUA,IAAsBA,GAAUA,GAC9F,KAxEyB,EAyEvB,OAAO6T,EAAS,GAAHrkB,OAAMwQ,GAAUA,GAAgB,KAAAxQ,OAAIwQ,GAAUA,IAAsBA,GAAUA,GAE/F,OAAOA,GAAUA,EACnB,CAGO,SAAS+T,GAAQN,GACtB,IAAKA,EAAMC,QAAS,OAAO,EAC3B,IAAMM,EAAMT,GAAYE,GAAS,SAACtP,GAAQ,OAAKA,EAAE6P,IAAM7P,EAAEpE,KAAOvJ,EAAkB,EAAG,SAAC2N,GAAQ,OAAKA,EAAE6P,GAAG,EACxG,OAAOP,EAAMC,QAAQxS,QAAO,SAAC6S,EAAQE,GACnC,OAAIA,EAAMC,SAAiBH,EACpBA,EAASC,EAAIC,EACtB,GAAG,EACL,CAGO,SAASE,GAASV,GACvB,IAAKA,EAAMC,QAAS,OAAO,EAC3B,IAAMM,EAAMT,GAAYE,GAAS,SAACtP,GAAQ,OAAKA,EAAE6P,IAAM7P,EAAEpE,KAAOvJ,EAAkB,EAAG,SAAC2N,GAAQ,OAAKA,EAAE6P,GAAG,EACxG,OAAOP,EAAMC,QAAQxS,QAAO,SAACiT,EAASF,GACpC,OAAIA,EAAMC,SAAiBC,EAlFV,IAmFCF,EAAMG,MAAkBH,EAAMjjB,QAxFvB,GAMR,IAmFdijB,EAAMG,MAAkBH,EAAMjjB,QAxFR,EAyFPmjB,EAAUH,EAAIC,GAASE,CAC3C,GAAG,EACL,CAIO,SAASE,GAA8BzH,GAAoB,IAAA0H,EAChE,GAAgB,QAAZA,EAAC1H,EAAI8G,eAAO,IAAAY,IAAXA,EAAattB,OAAQ,OAAOgZ,GAAUA,GAC3C,IAAIuU,EAAUjc,GAAIkc,gBAAgB9F,KAAM+F,iBAAiB7H,EAAI8H,OAAQ9H,EAAI+H,QAASC,GAAYhI,KAE9F,OADIA,EAAI8G,QAAQ1sB,OAAS,IAAGutB,EAAU,KAAOA,GACtCA,CACT,CAIO,SAASK,GAAahI,GAAoB,IAAAiI,EAC/C,GAAgB,QAAZA,EAACjI,EAAI8G,eAAO,IAAAmB,IAAXA,EAAa7tB,OAAQ,OAAO,EACjC,IAE2B8R,EAFvBgc,EAAc,EACdC,EAAU,EAAChc,EAAAjK,GACC8d,EAAI8G,SAAO,IAA3B,IAAA3a,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAA6B,KAAlBgf,EAACrL,EAAAxX,MACVyzB,GAAW5Q,EAAE6P,IACbc,GAAgB3Q,EAAEpE,KAAOoE,EAAE6P,GAC7B,CAAC,OAAA7xB,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACD,OAAOwlB,EAAcC,CACvB,CAGO,SAASC,GAAajV,EAAckV,GACzC,OAAOlV,EAAOkV,EAAOze,EACvB,CA4DA,SAAS0e,GAAoBC,GAC3B,OAAOnV,GLxH8B,uBKwHU,CAAEhP,OAAQgP,GAAUmV,IACrE,CA2BO,SAASC,GAAexI,GAC7B,OAzOmB,IAyOZA,EAAIzpB,MA/Nc,IA+NIypB,EAAI0G,KAAuB1G,EAAI5b,OAzNhC,CA0N9B,spDC/OA,IAAMpD,GAAO0K,GAAI1K,KACXynB,GAAO,EAAI3e,KAAKqR,GAChBuN,GAAWvoB,OAAOwoB,aAAa,OAC/BC,GAAYzoB,OAAOwoB,aAAa,OA+FhCE,GAAmB,CACvB1kB,KAAM,UACN2kB,UAAW,UACXC,WAAY,UACZC,UAAW,UACXC,QAAS,UACTv0B,MAAO,UACPw0B,KAAM,UACNC,UAAW,OACXC,SAAU,UACVC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,WAAY,OACZC,WAAY,QACZC,WAAY,WAGRC,GAAoB,CACxBxlB,KAAM,UACN2kB,UAAW,UACXC,WAAY,OACZC,UAAW,OACXC,QAAS,UACTv0B,MAAO,UACPw0B,KAAM,OACNC,UAAW,OACXC,SAAU,UACVC,QAAS,UACTC,SAAU,UACVC,QAAS,UACTC,WAAY,UACZC,WAAY,UACZC,WAAY,WAIDE,GAAK,WAkBhB,SAAAA,EAAa5b,EAAqB6b,GAA2B,IAAA7Z,EAAA,KAAAtQ,EAAA,KAAAkqB,GAAAjpB,EAAA,sBAAAA,EAAA,sBAAAA,EAAA,qBAAAA,EAAA,sBAAAA,EAAA,uBAAAA,EAAA,+BAAAA,EAAA,mBAAAA,EAAA,wBAAAA,EAAA,oBAAAA,EAAA,4BAAAA,EAAA,4BAAAA,EAAA,0BAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,2BAAAA,EAAA,2BAC3D9J,KAAKmX,OAASA,EACdnX,KAAKurB,OAASyH,EACdhzB,KAAKizB,MAAQxoB,EAAM4P,SAAW2X,GAAYc,GAC1C9yB,KAAKkzB,OAASjoB,SAAS4P,cAAc,UACrC7a,KAAKmzB,SAAU,EACfhc,EAAOmB,YAAYtY,KAAKkzB,QACxB,IAAME,EAAMpzB,KAAKkzB,OAAOG,WAAW,MACnC,GAAKD,EAAL,CAIApzB,KAAKozB,IAAMA,EACXpzB,KAAKozB,IAAIE,UAAY,SACrBtzB,KAAKozB,IAAIG,aAAe,SAExBvzB,KAAKwzB,SAAW,KAChBrpB,GAAKnK,KAAKkzB,OAAQ,aAAa,SAACtnB,GAEzBuN,EAAKvD,OACVuD,EAAKqa,SAAW,CACdvK,EAAGrd,EAAE6nB,QAAUta,EAAKvD,KAAKG,KACzB8K,EAAGjV,EAAE8nB,QAAUva,EAAKvD,KAAKiL,GAE3B1H,EAAKwa,OACP,IACAxpB,GAAKnK,KAAKkzB,OAAQ,cAAc,WAC9B/Z,EAAKqa,SAAW,KAChBra,EAAKwa,MACP,IAGuB,IAAIC,gBAAe,kBAAMza,EAAK0a,QAAQ,IAC9CC,QAAQ9zB,KAAKmX,QAG5BnX,KAAK+zB,aAAe,KACpB5pB,GAAKnK,KAAKkzB,OAAQ,SAAS,SAACtnB,GAAoBuN,EAAK6a,MAAMpoB,EAAG,GAAG,CAAEuW,SAAS,IAC5EhY,GAAKnK,KAAKkzB,OAAQ,SAAS,SAACtnB,GAAoBuN,EAAK8a,MAAMroB,EAAG,IAC9D,IAAMsoB,EAAS,WACb/a,EAAKga,QAAuC,WAA7BloB,SAASkpB,gBACpBhb,EAAKga,SAAWha,EAAKib,kBACvBjb,EAAKib,iBAAkB,EACvBjb,EAAKwa,OAET,EACAxpB,GAAKc,SAAU,mBAAoBipB,GACnCl0B,KAAKq0B,YAAc,CAAC,WAAQxf,GAAImU,OAAO/d,SAAU,mBAAoBipB,EAAQ,EApC7E,MAFEvZ,QAAQvZ,MAAM,+BAuClB,CAkMC,OAlMAuI,EAAAopB,EAAA,EAAAp1B,IAAA,UAAAE,MAED,WAAW,IAAAqoB,EAAA,KACTlmB,KAAK+zB,aAAe7nB,OAAOqN,YAAW,WAAQ2M,EAAK6N,aAAe,IAAK,GAAG,IAC5E,GAEA,CAAAp2B,IAAA,QAAAE,MACA,WACEmC,KAAKozB,IAAIkB,UAAU,EAAG,EAAGt0B,KAAKkzB,OAAOnc,MAAO/W,KAAKkzB,OAAOlc,OAC1D,GAEA,CAAArZ,IAAA,OAAAE,MACA,WACEmC,KAAKu0B,QACP,GAEA,CAAA52B,IAAA,QAAAE,MACA,SAAO+N,GACL5L,KAAKurB,OAAO0I,MAAMroB,EACpB,GAEA,CAAAjO,IAAA,QAAAE,MACA,SAAO+N,GACL5L,KAAKqyB,KAAKzmB,EAAE4oB,OAAS,EACvB,GAEA,CAAA72B,IAAA,SAAAE,MAKA,WAAU,IAAAkpB,EAAA,KACR/mB,KAAKkzB,OAAOnc,MAAQ/W,KAAKmX,OAAOuR,YAChC1oB,KAAKkzB,OAAOlc,OAAShX,KAAKmX,OAAOsd,aACjC,IAEMC,EAAc,IAAIC,GAAQ,EAAG30B,KAAKkzB,OAAOnc,MAAO,EAAG/W,KAAKkzB,OAAOlc,OAFlD,IAGb4d,EAAc,IAAID,GAAQ,EAAG30B,KAAKkzB,OAAOnc,MAAO/W,KAAKkzB,OAAOlc,OAH/C,GAGoEhX,KAAKkzB,OAAOlc,QAC7F6d,EAAc,IAAIF,GAAQ,EAHjB,GAG4B,EAAG30B,KAAKkzB,OAAOlc,OAJvC,IAKnBhX,KAAK80B,WAAa,IAAIC,GAAO/0B,KAAKozB,IAAKsB,GACvC10B,KAAKg1B,QAAU,IAAID,GAAO/0B,KAAKozB,IAAKwB,GACpC50B,KAAKi1B,QAAU,IAAIF,GAAO/0B,KAAKozB,IAAKyB,GAGpC3oB,OAAOgpB,uBAAsB,WAC3BnO,EAAKnR,KAAOmR,EAAKmM,OAAOrd,wBACxBkR,EAAKwE,OAAOsI,QACd,GACF,GAEA,CAAAl2B,IAAA,OAAAE,MACA,SAAMs3B,GACAn1B,KAAK+zB,cACT/zB,KAAKurB,OAAO8G,KAAK8C,EACnB,GAEA,CAAAx3B,IAAA,WAAAE,MACA,WAAY,IACsBsN,EADtBC,EAAAC,GACMrL,KAAKq0B,aAAW,IAAhC,IAAAjpB,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,OAAkC0zB,EAAtBjqB,EAAAtN,QAAyB,OAAAa,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACrC7L,KAAKq0B,YAAc,EACrB,GAEA,CAAA12B,IAAA,SAAAE,MACA,WACE8c,QAAQvZ,MAAM,0CAChB,GAEA,CAAAzD,IAAA,kBAAAE,MACA,SAAiBw3B,GACfr1B,KAAKozB,IAAIE,UAAY,SACrBtzB,KAAKozB,IAAIG,aAAe,SACxBvzB,KAAKozB,IAAIkC,KAAO,GAAHvpB,OAAMspB,QAAAA,EAAY,KAAI,yBACnCr1B,KAAKozB,IAAImC,UAAYv1B,KAAKizB,MAAMhB,SAClC,GAEA,CAAAt0B,IAAA,cAAAE,MACA,SAAa23B,EAAkBC,EAAcC,EAAcC,GAAqB,IAAA/N,EAAA,KACxEgO,EAAU,IAAIjB,GAAQc,EAAMC,EAAM,EAAG,GAC3C11B,KAAKg1B,QAAQa,KAAKD,GAAS,SAACxC,EAA+B0C,GACzDlO,EAAKmO,kBACL,IAAM9e,GAAWye,EAAOD,GAAQ,EAC5BO,EAAQP,EACRQ,EAAahf,EACjB+C,EAA8B,CAAC8b,EAAM7M,EAAEwM,GAAOK,EAAM7M,EAAEyM,IAA/CQ,EAAQlc,EAAA,GAAEmc,EAASnc,EAAA,GACpB9C,EAAU4e,EAAMjV,EAAE,IACxB2U,EAAOY,KAAK71B,SAAQ,SAAA81B,GAClB,IAAM3V,EAAI0S,EAAIkD,YAAYD,EAAIrM,KACxBf,EAAI6M,EAAM7M,EAAEoN,EAAI7xB,KAClBykB,EAAIvI,EAAE3J,MAAQ,EAAImf,GAAYjN,EAAIvI,EAAE3J,MAAQ,EAAIof,IACpD/C,EAAImD,SAASF,EAAIrM,IAAKf,EAAG/R,GACrBD,GAAW+e,GAAS/e,EAAUof,EAAI7xB,MACpCyxB,GAAcD,EAAQK,EAAI7xB,KAAO,GAEnCwxB,EAAQK,EAAI7xB,IACd,IACA4uB,EAAIkC,KAAO,0BACc,IAArBK,EAAUpyB,QACZ6vB,EAAImD,SAASZ,EAAU,GAAIG,EAAM7M,EAAEgN,GAAaH,EAAMjV,EAAE,MACxDuS,EAAImD,SAASZ,EAAU,GAAIG,EAAM7M,EAAEgN,GAAaH,EAAMjV,EAAE,OAC1B,IAArB8U,EAAUpyB,QACnB6vB,EAAImD,SAASZ,EAAU,GAAIG,EAAM7M,EAAEgN,GAAa/e,EAEpD,IAAG,EACL,GAAC,CAAAvZ,IAAA,YAAAE,MAED,SAAW23B,EAAkBC,EAAcC,GAAc,IAAAvN,EAAA,KACjDyN,EAAU,IAAIjB,GAAQc,EAAMC,EAAM,EAAG,GAC3C11B,KAAK80B,WAAWe,KAAKD,GAAS,SAACxC,EAA+B0C,GAC5D1C,EAAIoD,UAAY,EAChBpD,EAAIqD,YAActO,EAAK8K,MAAMd,UAC7BqD,EAAOY,KAAK71B,SAAQ,SAAA81B,GAClBK,GAAKtD,EAAK0C,EAAM7M,EAAEoN,EAAI7xB,KAAMsxB,EAAMjV,EAAE,GAAIiV,EAAM7M,EAAEoN,EAAI7xB,KAAMsxB,EAAMjV,EAAE,GACpE,GACF,IAAG,EACL,GAEA,CAAAljB,IAAA,cAAAE,MAIA,SAAa23B,EAAkBmB,EAAcC,EAAc9Z,GAAc,IAAA+Z,EAAA,KACjEjB,EAAU,IAAIjB,GAAQ,EAAG,EAAGgC,EAAMC,GAElCE,EAAW,SAAC1D,EAA+BnK,EAAWpI,EAAWpK,EAAWE,EAAWuD,GAC3FkZ,EAAI2D,OACJ3D,EAAImC,UAAYsB,EAAK5D,MAAM3lB,KAC3B8lB,EAAI4D,YACA5D,EAAI6D,UAAW7D,EAAI6D,UAAUhO,EAAGpI,EAAGpK,EAAGE,EAAGuD,GACxCkZ,EAAIxd,KAAKqT,EAAGpI,EAAGpK,EAAGE,GACvByc,EAAI8D,OACJ9D,EAAI+D,SACN,EAEAn3B,KAAKi1B,QAAQY,KAAKD,GAAS,SAACxC,EAA+B0C,GACzDe,EAAKd,kBACLc,EAAKzD,IAAIE,UAAY,OACrB,IAAMpc,EAAU0f,EAAO,EACnBQ,EAAQ,EACRnB,EAAa/e,EACX+R,EAAI6M,EAAM7M,EAAE,GAElBuM,EAAOY,KAAK71B,SAAQ,SAAA81B,GAClB,IAAMxV,EAAIiV,EAAMjV,EAAEwV,EAAI7xB,KACtB,KAAIqc,EAAIiV,EAAMjV,EAAE+V,GAHO,EAGQ,GAAK/V,EAAIiV,EAAMjV,EAAE8V,GAHzB,EAGwC,GAA/D,CACA,IAAMjW,EAAI0S,EAAIkD,YAAYD,EAAIrM,KAC9B8M,EAAS1D,EAAKnK,EAAGpI,EAAI,EALE,EAKQH,EAAE3J,MAAQsgB,EAAU,GAAe,GAClEjE,EAAImD,SAASF,EAAIrM,IAAKf,EANF,EAMYpI,EAAI,GAChC3J,GAAWkgB,GAASlgB,EAAUmf,EAAI7xB,MACpCyxB,GAAcmB,EAAQf,EAAI7xB,KAAO,GAEnC4yB,EAAQf,EAAI7xB,GAP4D,CAQ1E,IACA,IAAMkc,EAAI0S,EAAIkD,YAAYxZ,GACpB+D,EAAIiV,EAAMjV,EAAEoV,GAClBa,EAAS1D,EAAKnK,EAAGpI,EAdQ,EAcG,EAAGH,EAAE3J,MAAQsgB,EAAU,GAAe,GAClEjE,EAAImD,SAASzZ,EAAMmM,EAfG,EAeO6M,EAAMjV,EAAEoV,GACvC,IAAG,EACL,GAAC,CAAAt4B,IAAA,YAAAE,MAED,SAAWy5B,EAAgB9B,EAAkBmB,EAAcC,GAAc,IAAAW,EAAA,KACjE3B,EAAU,IAAIjB,GAAQ,EAAG,EAAGgC,EAAMC,GACxCU,EAAOzB,KAAKD,GAAS,SAACxC,EAA+B0C,GACnD1C,EAAIoD,UAAY,EAChBpD,EAAIqD,YAAcc,EAAKtE,MAAMd,UAC7BqD,EAAOY,KAAK71B,SAAQ,SAAA81B,GAClBK,GAAKtD,EAAK0C,EAAM7M,EAAE,GAAI6M,EAAMjV,EAAEwV,EAAI7xB,KAAMsxB,EAAM7M,EAAE,GAAI6M,EAAMjV,EAAEwV,EAAI7xB,KAClE,GACF,IAAG,EACL,GAEA,CAAA7G,IAAA,cAAAE,MAIA,SAAay5B,EAAgBE,EAAc1a,EAAc2a,GACvDz3B,KAAK+1B,kBACL,IAAM2B,EAAUC,GAAW33B,KAAKozB,IAAKkE,EAAOtgB,SAAUhX,KAAK43B,YAAY/W,EAAExM,IACvErU,KAAK43B,YAAY/W,EAAEvM,IAAK,GAAIkjB,EAAM1a,EAAM2a,GAGpCI,GAAcH,EAAQI,QAAU,GAAK,GAI3C,OAHA93B,KAAKi1B,QAAQW,QAAQ3M,EAAE3U,IAAMujB,EAC7B73B,KAAKi1B,QAAQW,QAAQ/U,EAAEvM,IAAMgjB,EAAO1B,QAAQ/U,EAAEvM,IAEvCojB,CACT,GAAC,CAAA/5B,IAAA,OAAAE,MAED,SAAMk6B,EAAYC,EAAYC,EAAYC,EAAYC,GACpDzB,GAAK12B,KAAKozB,IAAK2E,EAAIC,EAAIC,EAAIC,EAAIC,EACjC,GAEA,CAAAx6B,IAAA,MAAAE,MACA,SAAKorB,EAAWpI,EAAWuH,EAAegQ,GACxCC,GAAIr4B,KAAKozB,IAAKnK,EAAGpI,EAAGuH,EAAOgQ,EAC7B,KAACrF,CAAA,CApQe,GAwQLuF,GAAU,SAAAC,GAAAnuB,EAAAkuB,EAAAC,GAAA,IAAA7Q,EAAA0E,GAAAkM,GAarB,SAAAA,EAAanhB,EAAqB6b,EAA2BX,GAAc,IAAAmG,EAc5D,OAd4D3vB,EAAA,KAAAyvB,GAKvExuB,EAAAC,EAJFyuB,EAAA9Q,EAAA/nB,KAAA,KAAMwX,EAAQ,CACZ0c,OAAQ,kBAAM2E,EAAKC,SAAS,EAC5BxE,MAAO,SAACroB,GAAa,OAAK4sB,EAAKE,QAAQ9sB,EAAE,EACzCymB,KAAM,SAAC8C,GAAe,OAAKqD,EAAKG,OAAOxD,EAAO,KAC9C,oBAAArrB,EAAAC,EAAAyuB,GAAA,eAAA1uB,EAAAC,EAAAyuB,GAAA,oBAAA1uB,EAAAC,EAAAyuB,GAAA,kBAAA1uB,EAAAC,EAAAyuB,GAAA,+BAAA1uB,EAAAC,EAAAyuB,GAAA,gBAAA1uB,EAAAC,EAAAyuB,GAAA,kBAAA1uB,EAAAC,EAAAyuB,GAAA,qBAAA1uB,EAAAC,EAAAyuB,GAAA,sBAAA1uB,EAAAC,EAAAyuB,GAAA,mBAAA1uB,EAAAC,EAAAyuB,GAAA,oBACFA,EAAKxF,UAAYA,EACjBwF,EAAKI,UAAYvG,EACjBmG,EAAKK,MAAQ,GACbL,EAAKM,QAAU,CACbC,KAAM,GACNC,MAAO,IAETR,EAAKS,eACLT,EAAK3E,SAAQ2E,CACf,CAoZC,OAjZD7uB,EAAA2uB,EAAA,EAAA36B,IAAA,eAAAE,MACA,WACEmC,KAAKk5B,WAAa,IAAInE,GAAO/0B,KAAKozB,IAAK,IAAIuB,GAAQ,EAAG,EAAG,EAAG,IAC5D30B,KAAKm5B,YAAc,IAAIpE,GAAO/0B,KAAKozB,IAAK,IAAIuB,GAAQ,EAAG,EAAG,EAAG,GAC/D,GAEA,CAAAh3B,IAAA,UAAAE,MACA,WAEEmC,KAAKi5B,eACDj5B,KAAKo5B,MAAMp5B,KAAK2zB,MACtB,GAEA,CAAAh2B,IAAA,SAAAE,MACA,SAAQs3B,GACDn1B,KAAK44B,WACL54B,KAAKo5B,KAAKL,MAAS/4B,KAAKo5B,KAAKJ,QAClCh5B,KAAKq5B,UAGLr5B,KAAK44B,WAAazD,EAAS,EAAI,EAAI,IACnCn1B,KAAK44B,UAAY1P,GAAMlpB,KAAK44B,UAAW,KAAO,GAC9C54B,KAAK2zB,OACL3zB,KAAKgzB,UAAUX,KAAKryB,KAAK44B,WAC3B,GAEA,CAAAj7B,IAAA,UAAAE,MACA,SAAS+N,GACP,GAAK5L,KAAK43B,YAAV,CACA,IAAM3O,EAAIrd,EAAE6nB,QAAUzzB,KAAK4V,KAAKG,KAC1B8K,EAAIjV,EAAE8nB,QAAU1zB,KAAK4V,KAAKiL,EAChC,GAAI7gB,KAAKk5B,WAAWvjB,SAASsT,EAAGpI,GAAM7gB,KAAKqyB,MAAK,QAChD,GAAIryB,KAAKm5B,YAAYxjB,SAASsT,EAAGpI,GAAM7gB,KAAKqyB,MAAK,OAAjD,CACA,IAAMiH,EAAat5B,KAAK80B,WAAWwE,WAAWt5B,KAAK43B,aACnD53B,KAAKgzB,UAAUiB,MAAMqF,EAAWC,IAAItQ,GAF4B,CAJnC,CAO/B,GAEA,CAAAtrB,IAAA,MAAAE,MACA,SAAKu7B,EAAiBI,EAAiB9d,EAAqB8C,EAAwBC,GAMlF,GALAze,KAAKo5B,KAAOA,EACZp5B,KAAKw5B,QAAUA,EAAUhb,EAAa7J,aAAaC,iBACnD5U,KAAKy5B,qBAAuB5kB,GAAI4kB,qBAAqB/d,EAAa8C,EAAcC,GAChFze,KAAK05B,SAAWlb,EAAa7J,aAAamI,KAC1C9c,KAAK25B,UAAYlb,EAAc9J,aAAamI,MACvC9c,KAAK44B,UAAW,CACnB,IAAqCgB,EAAAhyB,EAAV5H,KAAK65B,MAAK,GAA9BC,EAAMF,EAAA,GAAEG,EAAQH,EAAA,GAGjBI,EAAU/mB,KAAKqB,IAAIylB,EAAWD,EAAS,EAAG,KAChD95B,KAAK44B,UAAY3lB,KAAKoB,IAAI2lB,EAAS,EACrC,CACAh6B,KAAK2zB,MACP,GAEA,CAAAh2B,IAAA,SAAAE,MAWA,WAAU,IAAAo8B,EAAA,KAER,GAAKj6B,KAAKo5B,MAASp5B,KAAKmzB,SAAiC,IAAtBnzB,KAAKkzB,OAAOnc,MAA/C,CAKA/W,KAAKk6B,QAEL,IAAM9G,EAAMpzB,KAAKozB,IACXI,EAAWxzB,KAAKwzB,SAChBuF,EAAO/4B,KAAKo5B,KAAKL,KACjBC,EAAQh5B,KAAKo5B,KAAKJ,MAEamB,EAAAvyB,EAAV5H,KAAK65B,MAAK,GAA9BC,EAAMK,EAAA,GAAEJ,EAAQI,EAAA,GAEjBC,EAAap6B,KAAK44B,UAAYkB,EAAS,EACvCO,EAAOP,EAASM,EAChBE,EAAMR,EAASM,EAGfG,EAAU7yB,EAAO1H,KAAK84B,QAAQC,MAC9ByB,EAAW9yB,EAAO1H,KAAK84B,QAAQE,OACrCuB,EAAWE,MAAK,SAAC9zB,EAAGyT,GAAC,OAAKA,EAAEkC,KAAO3V,EAAE2V,IAAI,IACzCke,EAAYC,MAAK,SAAC9zB,EAAGyT,GAAC,OAAKzT,EAAE2V,KAAOlC,EAAEkC,IAAI,IAkB1C,IAjBA,IAAMwc,EAAuB,GAEvB4B,EAA+B,GAC/BC,EAA+B,GAC/BC,EAAgC,GAChCC,EAAgC,GAChCC,EAAe,CACnBC,QAAS,EACTC,SAAU,EACVC,SAAU,EACVC,UAAW,GAETC,EAAM,EAGNC,EAAW,EAEN53B,EAAI,EAAGA,EAAIu1B,EAAKx1B,OAAQC,IAAK,CACpC,IAAM2lB,EAAM4P,EAAKv1B,GAGjB,GAFA43B,GAAYjS,EAAIoH,IACZpH,EAAI7M,MAAQge,GAAKK,EAAS33B,KAAK,CAACmmB,EAAI7M,KAAM8e,KAC1CjS,EAAIkS,MAKR,IAJAF,GAAOhS,EAAIoH,IACXmK,EAAS13B,KAAK,CAACmmB,EAAI7M,KAAM6e,IACzBL,EAAaC,SAAW5R,EAAIoH,IAC5BuK,EAAaE,UAAY7R,EAAIoH,IAAMpH,EAAI7M,KAChCie,EAAWh3B,QAAU+3B,GAAaf,EAAW,GAAGje,KAAM6M,EAAI7M,OAAO,CACtE,IAAMtY,EAAOu2B,EAAWgB,QACnBv3B,GACL80B,EAAQ91B,KAAK,CACXsZ,KAAMtY,EAAKsY,KACXiU,IAAKpH,EAAIkS,MAAQD,EAAWD,EAC5B1L,KAAMtG,EAAIsG,KACVS,OAAQlsB,EAAKksB,QAEjB,CACF,CACA,IAAMsL,EAASd,EAASn3B,OAASk4B,GAAKf,GAAU,GAAK,EACrDA,EAAS13B,KAAK,CAACs3B,EAAKkB,IACpB,IAAME,EAAcf,EAASp3B,OAASk4B,GAAKd,GAAU,GAAK,EAC1DA,EAAS33B,KAAK,CAACs3B,EAAKoB,IAEpBN,EAAWD,EAAM,EACjB,IAAK,IAAI33B,EAAI,EAAGA,EAAIw1B,EAAMz1B,OAAQC,IAAK,CACrC,IAAM2lB,EAAM6P,EAAMx1B,GAGlB,GAFA43B,GAAYjS,EAAIoH,IACZpH,EAAI7M,MAAQ+d,GAAMQ,EAAU73B,KAAK,CAACmmB,EAAI7M,KAAM8e,KAC5CjS,EAAIkS,MAKR,IAJAF,GAAOhS,EAAIoH,IACXqK,EAAU53B,KAAK,CAACmmB,EAAI7M,KAAM6e,IAC1BL,EAAaG,UAAY9R,EAAIoH,IAC7BuK,EAAaI,WAAa/R,EAAIoH,IAAMpH,EAAI7M,KACjCke,EAAYj3B,QAAU+3B,GAAad,EAAY,GAAGle,KAAM6M,EAAI7M,OAAO,CACxE,IAAMtY,EAAOw2B,EAAYe,QACpBv3B,GACL80B,EAAQ91B,KAAK,CACXsZ,KAAMtY,EAAKsY,KACXiU,IAAKpH,EAAIkS,MAAQD,EAAWD,EAC5B1L,KAAMtG,EAAIsG,KACVS,OAAQlsB,EAAKksB,QAEjB,CACF,CAGA,IAAMyL,EAAUf,EAAUr3B,OAASk4B,GAAKb,GAAW,GAAK,EACxDA,EAAU53B,KAAK,CAACq3B,EAAMsB,IACtB,IAAMC,EAAef,EAAUt3B,OAASk4B,GAAKZ,GAAW,GAAK,EAC7DA,EAAU73B,KAAK,CAACq3B,EAAMuB,IAGtB,IAAMjlB,EAAI3W,KAAKg1B,QAAQY,QAAQ/U,EAAExM,IAC3BwnB,GAAgBllB,EAAI,IAAMA,EAC1BigB,GAAQgF,GAAgBF,EAAczoB,KAAKqB,IAAIonB,EAAaE,GAAgBA,GAAgBF,GAAe,GAAKG,EAEhHjE,EAAc,IAAIjD,GAAQ2F,EAAKD,EAAM,EAAGzD,GAC9C52B,KAAK43B,YAAcA,EAGnB,IAAIkE,EAAgC,KAG9BC,EAAUpE,GAAWvE,EAAKpzB,KAAK80B,WAAW/d,QAAS6gB,EAAY3O,EAAE5U,IAAKujB,EAAY3O,EAAE3U,IAAK,IAAKtU,KAAKy5B,qBAAsB,IAC/Hz5B,KAAKg8B,UAAUD,EAASzB,EAAKD,GAC7B,IAAM3C,EAAU13B,KAAKi8B,YAAYj8B,KAAK80B,WAAY90B,KAAKw5B,QAASx5B,KAAK05B,UACrE15B,KAAKk8B,UAAUl8B,KAAK80B,WAAY4C,EAAS13B,KAAK43B,YAAY/W,EAAExM,IAAKrU,KAAK43B,YAAY/W,EAAEvM,KAEpFtU,KAAK80B,WAAWe,KAAK+B,GAAa,SAACxE,EAAK0C,GACtC1C,EAAIoD,UAAY,EAEhBpD,EAAIqD,YAAcwD,EAAKhH,MAAMf,WAE7BkB,EAAIoD,UAAY,IAChBpD,EAAIqD,YAAcwD,EAAKhH,MAAMb,QAC7BsE,GAAKtD,EAAK0C,EAAM7M,EAAE6Q,GAAShE,EAAMjV,EAAE,GAAIiV,EAAM7M,EAAE6Q,GAAShE,EAAMjV,EAAE,GAAM+W,EAAY/W,EAAEvM,MAEpF8e,EAAIkC,KAAO,+BACXlC,EAAIE,UAAY,SAChBF,EAAIG,aAAe,SACnBH,EAAImC,UAAY0E,EAAKhH,MAAMp1B,MAC3B,IAAMgjB,EAAI,GAAM+W,EAAY/W,EAAEvM,IAC9B8e,EAAImD,SAAS1hB,GAAIiJ,kBAAkBgc,GAAShE,EAAM7M,EAAE6Q,GAAShE,EAAMjV,EAAEA,IACrEuS,EAAIkC,KAAO,0BAEXlC,EAAImD,SAAS,GAADxqB,QAAKguB,EAAWD,EAAS,KAAKpU,QAAQ,GAAE,YAClDoQ,EAAM7M,EAAE6Q,GAAShE,EAAMjV,EAAEA,GAAK,IAGhCuS,EAAIE,UAAY,SAChBF,EAAIG,aAAe,SACnB,IAAM4I,EAAalC,EAAKnF,WAAWc,QAAQwG,KACrCC,EAAavG,EAAMjV,EAAS,GAAP+V,GACrB0F,EAAU1E,EAAY2E,OAASzC,EAAS,IACxC0C,EAAW,GAAHzwB,OAAMuwB,EAAQ5W,QAAQ,GAAE,KAChCjP,EAAI2c,EAAIkD,YAAYkG,GAAUzlB,MACpCqc,EAAIkC,KAAO,0BACXlC,EAAImD,SAASiG,EAAUL,EAAYE,EAAa,GAEhD,IAEII,EAAWN,EAAa1lB,EAAI,EADnB,GADI,GAGXimB,EAAUL,EAAaM,GAC7B1C,EAAKd,YAAYyD,WACfH,EACAA,EANe,GAOfC,EACAA,EARe,IAUjB,IAAIG,EAAQrJ,GAAYyG,EAAKd,YAAYxjB,SAAS6d,EAASvK,EAAGuK,EAAS3S,GACvEoZ,EAAKd,YAAYtD,KAAK,IAAIlB,GAAQ,EAAG,EAAG,EAAG,IAAI,SAAAvB,GAC7CA,EAAIkC,KAAO,iBACXlC,EAAImC,UAAY0E,EAAKhH,MAAMZ,KACvBwK,IACFzJ,EAAImC,UAAY0E,EAAKhH,MAAMX,UAC3Bc,EAAIkC,KAAO,kBAEblC,EAAImD,SAASxE,GAAWkI,EAAKd,YAAYvD,QAAQwG,KAAMnC,EAAKd,YAAYvD,QAAQkH,KAClF,IACAL,EAAWN,EAAa1lB,EAAI,EAnBf,GAoBbwjB,EAAKf,WAAW0D,WACdH,EACAA,EAvBe,GAwBfC,EACAA,EAzBe,IA2BjBG,EAAQrJ,GAAYyG,EAAKf,WAAWvjB,SAAS6d,EAASvK,EAAGuK,EAAS3S,GAClEoZ,EAAKf,WAAWrD,KAAK,IAAIlB,GAAQ,EAAG,EAAG,EAAG,IAAI,SAAAvB,GAC5CA,EAAIkC,KAAO,iBACXlC,EAAImC,UAAY0E,EAAKhH,MAAMZ,KACvBwK,IACFzJ,EAAImC,UAAY0E,EAAKhH,MAAMX,UAC3Bc,EAAIkC,KAAO,kBAEblC,EAAImD,SAAS1E,GAAUoI,EAAKf,WAAWtD,QAAQwG,KAAMnC,EAAKf,WAAWtD,QAAQkH,KAC/E,IAoBA,IAhBA,IAcMC,EAA2B,MAAd1C,EAAOC,GACpB0C,EAAe,GACrBrlB,EAAA,EAAAzP,EAAqB4wB,GAAW,GAAEnhB,EAAAzP,EAAA3E,OAAAoU,IAAE,CAA/B,IAAMslB,EAAM/0B,EAAAyP,GACTulB,EAAW1J,GAAY2J,GAAgBF,EAAO3gB,KAAMwZ,EAAMyD,IAAI/F,EAASvK,GAAI8T,GAC7EG,GAASF,EAAah6B,KAAKi6B,EAAO3gB,MACtC8W,EAAI2D,OACJ3D,EAAIoD,UAAa0G,GAAWD,EAAO/M,OAAU,EAAI,EACjDkD,EAAIqD,YAAcwG,EAAOxN,KAAOwK,EAAKhH,MAAMV,SAAW0H,EAAKhH,MAAMT,QACjEY,EAAImC,UAAY0H,EAAOxN,KAAOwK,EAAKhH,MAAMR,SAAWwH,EAAKhH,MAAMP,QAC/D,IAAM0K,EAAQF,GAAWD,EAAO/M,OAAU,GAAK,EAC/CkD,EAAI4D,YACJ,IAAMqG,EAAM,CACVpU,EAAG6M,EAAM7M,EAAEgU,EAAO3gB,MAClBuE,EAAGiV,EAAMjV,EAAEoc,EAAO1M,KAAO,GAErBra,EAAMmnB,EAAIxc,EAAK5N,KAAKqqB,KAAK,GAAKF,EAAO,EAC3ChK,EAAImK,OAAOF,EAAIpU,EAAGoU,EAAIxc,GACtBuS,EAAIoK,OAAOH,EAAIpU,EAAImU,EAAO,EAAGlnB,GAC7Bkd,EAAIoK,OAAOH,EAAIpU,EAAImU,EAAO,EAAGlnB,GAC7Bkd,EAAIqK,YACJrK,EAAIsK,SACJtK,EAAI8D,OACJ9D,EAAI+D,SACN,CAGA,GAAK3D,GACAyG,EAAKnF,WAAWnf,SAAS6d,EAASvK,EAAGuK,EAAS3S,GAAnD,CAGA,IAAM8c,EAAQ7H,EAAMyD,IAAI/F,EAASvK,GAC7B2U,EAAWhD,EACXiD,EAAU,SAACC,GAAW,OAAKA,GAAOH,CAAK,EACvCI,EAAW9D,EAAKhH,MAAMV,SACtBoL,EAAQ7D,IACV8D,EAAWlD,EACXmD,EAAU,SAACC,GAAG,OAAKA,GAAOH,CAAK,EAC/BI,EAAW9D,EAAKhH,MAAMT,SAGxB,IADA,IArDkBvJ,EAAWb,EAqDzB4V,EAAYJ,EAAS,GAChBp6B,EAAI,EAAGA,EAAIo6B,EAASr6B,OAAQC,IAAK,CACxC,IAAMy6B,EAAKL,EAASp6B,GACpB,GAAIq6B,EAAQI,EAAG,IAAK,MACpBD,EAAYC,CACd,CA1DkBhV,EA2DT0U,EA3DoBvV,EA2Db6R,EAAKhH,MAAMN,WA1DrB1J,EAAIoR,GAAQpR,EAAIqR,IACpBlH,EAAI2D,OACJ3D,EAAI8K,YAAY,CAAC,EAAG,IACpB9K,EAAIoD,UAAY,IAChBpD,EAAIqD,YAAcrO,EAClBsO,GAAKtD,EAAK0C,EAAM7M,EAAEA,GAAI6M,EAAMjV,EAAE,GAAIiV,EAAM7M,EAAEA,GAAI6M,EAAMjV,EAAE+V,IACtDxD,EAAI+D,WAqDN2E,EAAY,CACVxf,KAAMqhB,EACNQ,MAAOH,EAAU,GACjBD,SAAUA,EACVf,aAAcA,EAvB6C,CAyB/D,IAGA5J,EAAIoD,UAAY,IAChBpD,EAAI8K,YAAY,CAAC,EAAG,IAEpB9K,EAAImC,UAAYv1B,KAAKizB,MAAMR,SAC3BW,EAAIqD,YAAcz2B,KAAKizB,MAAMV,SAC7BvyB,KAAKo+B,UAAUvD,GAEfzH,EAAImC,UAAYv1B,KAAKizB,MAAMP,QAC3BU,EAAIqD,YAAcz2B,KAAKizB,MAAMT,QAC7BxyB,KAAKo+B,UAAUzD,GAGfvH,EAAIoD,UAAY,IAChBpD,EAAI8K,YAAY,IAEhB9K,EAAImC,UAAYv1B,KAAKizB,MAAMR,SAC3BW,EAAIqD,YAAcz2B,KAAKizB,MAAMV,SAC7BvyB,KAAKo+B,UAAUxD,GAEfxH,EAAImC,UAAYv1B,KAAKizB,MAAMP,QAC3BU,EAAIqD,YAAcz2B,KAAKizB,MAAMT,QAC7BxyB,KAAKo+B,UAAU1D,GAEf16B,KAAKq+B,YAAY3G,EAAS13B,KAAK43B,YAAY/W,EAAExM,IAAKrU,KAAK43B,YAAY/W,EAAEvM,IAAKtU,KAAK05B,UAC/E15B,KAAKs+B,YAAYvC,EAASzB,EAAKD,EAAM,CAAC,GAADtuB,OAAI/L,KAAK25B,UAAS,KAAK35B,KAAK05B,WAI7DoC,GACF97B,KAAK80B,WAAWe,KAAK+B,GAAa,SAACxE,EAAK0C,GACjCgG,GACLzD,GAAIjF,EAAK0C,EAAM7M,EAAE6S,EAAUxf,MAAOwZ,EAAMjV,EAAEib,EAAUqC,OAAQrC,EAAUiC,SAAU,EAClF,IAIF/9B,KAAKgzB,UAAUuL,OAAOzD,GACtB96B,KAAKgzB,UAAUwL,MAAM1C,EA5RrB,MAFE97B,KAAKo0B,iBAAkB,CA+R3B,GAEA,CAAAz2B,IAAA,YAAAE,MACA,SAAWsgC,GACT,IACIlV,EADEwV,EAAUN,EAAM,GAEtBn+B,KAAK80B,WAAWe,KAAK71B,KAAK43B,aAAa,SAACxE,EAAK0C,GAC3C,IAAM4I,EAAQ5I,EAAMjV,EAAE,GAClBA,EAAIiV,EAAMjV,EAAE4d,EAAQ,IACxBrL,EAAI4D,YACJ5D,EAAImK,OAAOzH,EAAM7M,EAAEwV,EAAQ,IAAK3I,EAAMjV,EAAE4d,EAAQ,KAChD,IAAK,IAAIj7B,EAAI,EAAGA,EAAI26B,EAAM56B,OAAQC,IAEhCylB,EAAI6M,EAAM7M,EAAEkV,EAAM36B,GAAG,IACrB4vB,EAAIoK,OAAOvU,EAAGpI,GAEdA,EAAIiV,EAAMjV,EAAEsd,EAAM36B,GAAG,IACrB4vB,EAAIoK,OAAOvU,EAAGpI,GAEhBuS,EAAIsK,SACJtK,EAAIoK,OAAOvU,EAAGyV,GACdtL,EAAIoK,OAAO1H,EAAM7M,EAAEwV,EAAQ,IAAKC,GAChCtL,EAAIqK,YACJrK,EAAIuL,YAAc,IAClBvL,EAAI8D,MACN,GACF,GAEA,CAAAv5B,IAAA,MAAAE,MACA,WACE,IAAAoc,EAAe,CAACja,KAAKo5B,KAAKwF,aAAc5+B,KAAKo5B,KAAKyF,eAA3CzkB,EAACH,EAAA,GAAE1O,EAAC0O,EAAA,GACX,OAAKG,EAGO7O,EACL,EAAEA,EAAE+Q,KAAOlC,EAAEkC,MAAQ,EAAG/Q,EAAE+Q,KAAOlC,EAAEkC,MADpB,CAAClC,EAAEkC,KAAM,GAFxB/Q,EACE,CAACA,EAAE+Q,KAAM,GADD,CAAC,EAAG,EAIvB,GAEA,CAAA3e,IAAA,WAAAE,MACA,SAAUg7B,GACR74B,KAAK64B,MAAQA,CACf,GAEA,CAAAl7B,IAAA,aAAAE,MACA,SAAYi7B,GACV94B,KAAK84B,QAAUA,CACjB,KAACR,CAAA,CAhboB,CAASvF,IAobnB+L,GAAW,SAAAC,GAAA30B,EAAA00B,EAAAC,GAAA,IAAAlS,EAAAT,GAAA0S,GAYtB,SAAAA,EAAa3nB,EAAqB6b,GAA4B,IAAAgM,EAS/C,OAT+Cn2B,EAAA,KAAAi2B,GAK1Dh1B,EAAAC,EAJFi1B,EAAAnS,EAAAltB,KAAA,KAAMwX,EAAQ,CACZ0c,OAAQ,kBAAMmL,EAAKvG,SAAS,EAC5BxE,MAAO,WAA2B+K,EAAKtG,SAAU,EACjDrG,KAAM,SAAC8C,GAAe,OAAK6J,EAAKrG,OAAOxD,EAAO,KAC9C,oBAAArrB,EAAAC,EAAAi1B,GAAA,eAAAl1B,EAAAC,EAAAi1B,GAAA,oBAAAl1B,EAAAC,EAAAi1B,GAAA,oBAAAl1B,EAAAC,EAAAi1B,GAAA,uBAAAl1B,EAAAC,EAAAi1B,GAAA,uBAAAl1B,EAAAC,EAAAi1B,GAAA,sBAAAl1B,EAAAC,EAAAi1B,GAAA,qBAAAl1B,EAAAC,EAAAi1B,GAAA,iBAAAl1B,EAAAC,EAAAi1B,GAAA,+BACFA,EAAKhM,UAAYA,EACjBgM,EAAKpG,UAAY,EACjBoG,EAAKC,UAAY,IACjBD,EAAKnL,SAAQmL,CACf,CA2LC,OAzLDr1B,EAAAm1B,EAAA,EAAAnhC,IAAA,UAAAE,MACA,WAAW,IAAAqhC,EAAA,KACHC,EAAMn/B,KAAK80B,WAAWc,QACtBwJ,EAAgB,IAAIzK,GAAQwK,EAAIlW,EAAE5U,IAAK8qB,EAAIlW,EAAE3U,IAAK6qB,EAAIte,EAAExM,IAAK8qB,EAAIte,EAAExM,IAAmB,IAAb8qB,EAAIE,QACnFr/B,KAAKs/B,aAAe,IAAIvK,GAAO/0B,KAAKozB,IAAKgM,GACzC,IAAMG,EAAgB,IAAI5K,GAAQwK,EAAIlW,EAAE5U,IAAK8qB,EAAIlW,EAAE3U,IAAK6qB,EAAIte,EAAExM,IAAM,IAAO8qB,EAAIE,OAAQF,EAAIte,EAAEvM,KAC7FtU,KAAKw/B,aAAe,IAAIzK,GAAO/0B,KAAKozB,IAAKmM,GAErCv/B,KAAKy/B,aAAaC,aAAa1/B,KAAKy/B,aACxCz/B,KAAKy/B,YAAcvzB,OAAOqN,YAAW,kBAAM2lB,EAAKvL,MAAM,GAAE,IAC1D,GAAC,CAAAh2B,IAAA,UAAAE,MAED,WACE,GAGF,CAAAF,IAAA,SAAAE,MACA,SAAQs3B,GAEN,IAAMwK,EAAM3/B,KAAK4/B,WAAWhhB,QAAQ5e,KAAKi/B,WACzC,GAAI9J,EAAQ,CACV,GAAY,IAARwK,EAAW,OACf3/B,KAAKi/B,UAAYj/B,KAAK4/B,WAAWD,EAAM,EACzC,KAAO,CACL,GAAI3/B,KAAK4/B,WAAWr8B,QAAUo8B,EAAM,GAAK3/B,KAAKi/B,UAAYj/B,KAAKkO,KAAK2xB,QAAQt8B,OAAQ,OACpFvD,KAAKi/B,UAAYj/B,KAAK4/B,WAAWD,EAAM,EACzC,CACA3/B,KAAK2zB,MACP,GAEA,CAAAh2B,IAAA,SAAAE,MACA,WAAU,IAAAiiC,EAAAC,EAAA,KACF7xB,EAAOlO,KAAKkO,KAClB,GAAKA,GAASlO,KAAKmzB,SAAiC,IAAtBnzB,KAAKkzB,OAAOnc,MAA1C,CAIA,IAAMipB,EAAc9xB,EAAKqS,GACnBiT,EAAWxzB,KAAKwzB,SAChByM,EAAa/xB,EAAK2xB,SAAW,GAE7Br5B,EAAIyM,KAAKoB,IAAIrU,KAAKi/B,UAAWgB,EAAW18B,QACxCs8B,EAAUI,EAAWl7B,MAAMk7B,EAAW18B,OAASiD,GAKrD,GAHAxG,KAAKk6B,QAGK,IAAN1zB,EAAJ,CAGA,IAUuB6O,EATjByN,EAAQ,SAACod,GAAS,OAAKC,GAASD,EAAEE,SAAUJ,EAAY,EACxDjd,EAAM,SAACmd,GAAS,OAAKpd,EAAMod,GAAKF,CAAW,EAC3CK,EAAc,SAACH,GAAS,OAAKpd,EAAMod,GAHd,GAGwCF,CAAW,EACxEM,EAAc,GAA+BN,EAE7CO,EAAQV,EAAQ,GAChBpE,EAAOoE,EAAQr5B,EAAI,GAEzBkY,EAA2B,CAAC6hB,EAAMC,SAAUD,EAAME,QAASF,EAAMG,aAA5DrG,EAAI3b,EAAA,GAAE4b,EAAG5b,EAAA,GAAEiiB,EAAOjiB,EAAA,GAAsDpJ,EAAAjK,GAC7Dw0B,GAAO,IAAvB,IAAAvqB,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAyB,KAAdw+B,EAAC7qB,EAAAxX,MACNqiC,EAAEM,SAAWnG,IAAMA,EAAO6F,EAAEM,UAC5BN,EAAEO,QAAUnG,IAAKA,EAAM4F,EAAEO,SACzBP,EAAEQ,YAAcC,IAASA,EAAUT,EAAEQ,YAC3C,CAAC,OAAAhiC,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CAEDwuB,GAAuB,IAAdA,EAAOC,GAChB,IAAMsG,EAAS9d,EAAMyd,GACjBM,EAAO9d,EAAI0Y,GACfoF,GAA0B,KAAjBA,EAAOD,GAGhB,IAAME,EAAW9gC,KAAK+gC,OAAOC,SACvBpJ,EAAc,IAAIjD,GAAQiM,EAAQC,EAAMvG,EAAKD,GAC/CC,IAAQD,IAGVzC,EAAY/W,EAAExM,KAAOysB,EACrBlJ,EAAY/W,EAAEvM,KAAOwsB,GAEvB9gC,KAAK43B,YAAcA,EAEnB,IAAIqJ,EAA6B,KAC7BzN,GACFxzB,KAAK80B,WAAWe,KAAK,IAAIlB,GAAQiD,EAAY3O,EAAE5U,IAAKujB,EAAY3O,EAAE3U,IAAK,EAAG,IAAI,SAAC8e,EAAK0C,GAClF,IACuBhb,EADjBomB,EAAqBf,GAASrK,EAAMyD,IAAI/F,EAASvK,GAAI+W,GAAYjlB,EAAA1P,GACvDw0B,GAAO,IAAvB,IAAA9kB,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAyB,KAAdw+B,EAACplB,EAAAjd,MACV,GAAIilB,EAAMod,KAAOgB,EAAoB,CACnCD,EAAcf,EACd9M,EAAImC,UAAYwK,EAAK9M,MAAMd,UAC3BiB,EAAI0D,SAAShB,EAAM7M,EAAEnG,EAAMod,IAAKpK,EAAMjV,EAAE,GAAIiV,EAAMrf,EAAEupB,GAAclK,EAAMnf,EAAE,IAC1E,KACF,CACF,CAAC,OAAAjY,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CACH,IAIF,IAAMs1B,EAAUnhC,KAAKohC,qBACf1H,GAA2C,QAAhCoG,EAAA7U,KAAMoW,OAAOrhC,KAAK+gC,OAAOO,eAAO,IAAAxB,OAAA,EAAhCA,EAAkCprB,SAASC,aAAamI,OAAQ9c,KAAK+gC,OAAOQ,WAAWjiB,cAClGyc,EAmaV,SAA+B8D,EAAmBjf,EAAa4gB,GAC7D,IAAMjB,EAAQV,EAAQ,GAChBpE,EAAOoE,EAAQA,EAAQt8B,OAAS,GAChCuf,EAAQqd,GAASI,EAAMH,SAAUxf,GACjCmC,EAAMod,GAAS1E,EAAK2E,SAAUxf,GAAOA,EACrC6gB,EAAO1e,EAAMD,EACbtc,EAAIyM,KAAKoB,IAAIwrB,EAAQt8B,OAAQi+B,EAzamD,KA0ahFE,EAAOvB,GAASsB,EAAOj7B,EAAGoa,GAChC,GAAa,IAAT8gB,EAEF,OADA/mB,QAAQvZ,MAAM,YAAawf,EAAK6gB,EAAMj7B,GAC/B,CAAE4vB,KAAM,IAEjB,IAAInN,EAAInG,EACF6e,GAAa,IAAI/2B,MAAOg3B,oBACxBC,EAAW,SAAC5Y,GAEhB,OADAA,GAAqB,IAAb0Y,GACI1Y,EAAI,KAClB,EACI6Y,EAAUD,EAAS/e,GACnBif,EAAW,EACXF,EAAStB,EAAMH,YAAcyB,EAASpG,EAAK2E,YAAW0B,EAAU,GACpE,IACInU,EADEqU,EAAM,GAeZ,IAZErU,EADE/M,EAAM,MACA,SAACla,EAASuiB,GAEhB,OADY4Y,EAAS5Y,KACT6Y,EAAgB,GAAP/1B,OAAUk2B,GAAOv7B,EAAEw7B,aAAWn2B,OAAGrF,EAAEy7B,UAAS,KAAAp2B,OAAIrF,EAAE07B,WAAU,KAAAr2B,OAAIzC,OAAO5C,EAAE27B,cAAc1hB,SAAS,EAAG,MAC5G,GAAP5U,OAAUrF,EAAE07B,WAAU,KAAAr2B,OAAIzC,OAAO5C,EAAE27B,cAAc1hB,SAAS,EAAG,KACpE,EAEQ,SAACja,GACP,IAAM47B,EAAO57B,EAAE67B,cACf,OAAID,IAASP,EAAiB,GAAPh2B,OAAUk2B,GAAOv7B,EAAEw7B,aAAWn2B,OAAGrF,EAAEy7B,UAAS,MAAAp2B,OAAKzC,OAAOg5B,GAAMv9B,MAAM,EAAG,IAClF,GAAPgH,OAAUk2B,GAAOv7B,EAAEw7B,aAAWn2B,OAAGrF,EAAEy7B,UAC1C,EAEKlZ,GAAKlG,GAAK,CACf,IAAMrc,EAAI,IAAIkE,KAAKqe,GACnB+Y,EAAIh/B,KAAK,CACPwB,IAAKykB,EACLe,IAAK2D,EAAMjnB,EAAGuiB,KAEhB6Y,EAAUD,EAAS5Y,GACnB8Y,EAAWr7B,EAAE67B,cACbtZ,GAAKyY,CACP,CACA,MAAO,CAAEtL,KAAM4L,EACjB,CAldoBQ,CAAqB3C,EAASG,EAAahgC,KAAK80B,WAAW/d,SAC3E/W,KAAKg8B,UAAUD,EAAS6E,EAAQC,GAChC,IAAMnJ,EAAU13B,KAAKi8B,YAAYj8B,KAAKs/B,aAAcwB,EAAUpH,GAAU,SAAAhuB,GAAC,OAAImJ,GAAIiJ,kBAAkBpS,EAAIy1B,EAAQ,IAC/GnhC,KAAKk8B,UAAUl8B,KAAKs/B,aAAc5H,EAAS13B,KAAK43B,YAAY/W,EAAExM,IAAKrU,KAAK43B,YAAY/W,EAAEvM,KAGtF,IAAMmuB,EAAiB,IAAI9N,GAAQiM,EAAQC,EAAM,EAAGF,GAiCpD,GAhCA3gC,KAAKw/B,aAAa3J,KAAK4M,GAAgB,SAACrP,EAAK0C,GAC3C1C,EAAImC,UAAYwK,EAAK9M,MAAMf,WAAU,IACdtS,EADcC,EAAAxU,GACrBw0B,GAAO,IAAvB,IAAAhgB,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAyB,KAAdw+B,EAACtgB,EAAA/hB,MACVu1B,EAAI0D,SAAShB,EAAM7M,EAAEoX,EAAYH,IAAKpK,EAAMjV,EAAE,GAAIiV,EAAMrf,EAAE6pB,GAAcxK,EAAMnf,EAAEupB,EAAEQ,aACpF,CAAC,OAAAhiC,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CACH,IAGA7L,KAAKs/B,aAAazJ,KAAK+B,GAAa,SAACxE,EAAK0C,GACxC1C,EAAIoD,UAAY,EAAC,IACM1W,EADNC,EAAA1U,GACDw0B,GAAO,IAAvB,IAAA9f,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,MAAyB,KAAdw+B,EAACpgB,EAAAjiB,MACJD,EAAOsiC,EAAEwC,UAAYxC,EAAEyC,QAC7Bxc,EAAqB,CAAC2P,EAAM7M,EAAEoX,EAAYH,IAAKpK,EAAMjV,EAAEqf,EAAEwC,WAAY5M,EAAMrf,EAAE6pB,GAAcxK,EAAMnf,EAAEupB,EAAEyC,QAAUzC,EAAEwC,YAA1GzZ,EAAC9C,EAAA,GAAEtF,EAACsF,EAAA,GAAE1P,EAAC0P,EAAA,GAAExP,EAACwP,EAAA,GACjByc,EAAwB,CAAC9M,EAAMjV,EAAEqf,EAAEM,UAAW1K,EAAMjV,EAAEqf,EAAEO,SAAUhqB,EAAI,EAAIwS,GAAnEoR,EAAIuI,EAAA,GAAEtI,EAAGsI,EAAA,GAAEC,EAAED,EAAA,GACpBxP,EAAIqD,YAAc74B,EAAOmiC,EAAK9M,MAAMV,SAAWwN,EAAK9M,MAAMT,QAC1DY,EAAImC,UAAY33B,EAAOmiC,EAAK9M,MAAMR,SAAWsN,EAAK9M,MAAMP,QAExDU,EAAI4D,YACJ5D,EAAImK,OAAOsF,EAAIxI,GACfjH,EAAIoK,OAAOqF,EAAIvI,GACflH,EAAIsK,SAEJtK,EAAI0D,SAAS7N,EAAGpI,EAAGpK,EAAGE,GACtByc,EAAI0P,WAAW7Z,EAAGpI,EAAGpK,EAAGE,EAC1B,CAAC,OAAAjY,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CACH,IAGA7L,KAAKs+B,YAAYvC,EAAS6E,EAAQC,EAAM,IACxC7gC,KAAKq+B,YAAY3G,EAAS13B,KAAK43B,YAAY/W,EAAExM,IAAKrU,KAAK43B,YAAY/W,EAAEvM,IAAKolB,GAGtEuH,EAAa,CACf,IAAM8B,EAAO/iC,KAAKg1B,QAAQY,QAAQ/U,EAClC7gB,KAAKg1B,QAAQa,KAAK,IAAIlB,GAAQiD,EAAY3O,EAAE5U,IAAKujB,EAAY3O,EAAE3U,IAAKyuB,EAAK1uB,IAAK0uB,EAAKzuB,MAAM,SAAC8e,EAAK0C,GAC7F,GAAKmL,EAAL,CACAlB,EAAKhK,kBACL,IAAMiN,EAAW,GAAHj3B,OAAM,IAAInB,KAAKkY,EAAMme,IAAcgC,iBAAgB,OAAAl3B,OAAM,IAAInB,KAAKmY,EAAIke,IAAcgC,kBAE5FC,EAAa9P,EAAIkD,YAAY0M,GAAUjsB,MAAQ,GAEjDE,EAAU6e,EAAM7M,GAAGnG,EAAMme,GAAele,EAAIke,IAAgB,GAC5DlrB,EAAOkB,EAAUisB,EAAa,EAC5BC,EAAOpD,EAAK/K,QAAQY,QAAQ3M,EAC9BlT,EAAOotB,EAAK9uB,IAAK0B,EAAOotB,EAAK9uB,IACxB0B,EAAOmtB,EAAaC,EAAK7uB,MAAKyB,EAAOotB,EAAK7uB,IAAM4uB,GACzDjsB,EAAUlB,EAAOmtB,EAAa,EAC9B,IAAMhtB,EAAM6sB,EAAK1uB,KAAO0rB,EAAK/K,QAAQhe,SAPjB,IAO2C,EAC/Doc,EAAImC,UAAYwK,EAAK9M,MAAML,WAC3BQ,EAAIqD,YAAcsJ,EAAK9M,MAAMf,WAC7B,IAAMkR,EAA6C,CAACrtB,EAZ9B,GAY2CG,EAZvC,EAYmDgtB,EAAa,GAAUG,IACpGjQ,EAAI0D,SAAQluB,MAAZwqB,EAAgBgQ,GAChBhQ,EAAI0P,WAAUl6B,MAAdwqB,EAAkBgQ,GAClBrD,EAAKhK,kBACL3C,EAAImD,SAASyM,EAAU/rB,EAAS8oB,EAAK/K,QAAQY,QAAQkH,KAAMoG,EAnBnC,CAoB1B,GACF,CAGAljC,KAAKgzB,UAAUwL,MAAMyC,EAvHF,CAXnB,MAFEjhC,KAAKo0B,iBAAkB,CAqI3B,GAEA,CAAAz2B,IAAA,aAAAE,MACA,SAAYqQ,EAAsB6yB,EAAgBviB,EAAwBC,GAExE,GADAze,KAAKkO,KAAOA,EACPA,EAAK2xB,QAAV,CACA7/B,KAAK+gC,OAASA,EACd,IAAAuC,EAA2B,CAAC7kB,EAAc9J,aAAaC,iBAAkB4J,EAAa7J,aAAaC,kBAA5F2uB,EAAOD,EAAA,GAAEE,EAAOF,EAAA,GACvBtjC,KAAKohC,qBAAuBruB,GAAqBwwB,EAAUC,EAC3D,IAAIh9B,EAAI,GACRxG,KAAK4/B,WAAa,GAElB,IADA,IAAM6D,EAAaxwB,KAAKqB,IAAIpG,EAAK2xB,QAAQt8B,OAAQ,KAC1CiD,EAAIi9B,GACTzjC,KAAK4/B,WAAW58B,KAAKwD,GACrBA,GAAK,EAEPxG,KAAKi/B,UAAY,IACjBj/B,KAAK2zB,MAZoB,CAa3B,KAACmL,CAAA,CAjNqB,CAAS/L,IA0NpB2Q,GAAI,SAAAC,GAAAv5B,EAAAs5B,EAAAC,GAAA,IAAAC,EAAAxX,GAAAsX,GASf,SAAAA,EAAavsB,EAAqB/B,GAAiB,IAAAyuB,EAAAh7B,EAAA,KAAA66B,GAK/C55B,EAAAC,EAJF85B,EAAAD,EAAAjkC,KAAA,KAAMwX,EAAQ,CACZ0c,OAAQ,kBAAMgQ,EAAKpL,SAAS,EAC5BxE,MAAO,WAAqC,EAC5C5B,KAAM,WAAuC,KAC7C,cAAAvoB,EAAAC,EAAA85B,GAAA,eAAA/5B,EAAAC,EAAA85B,GAAA,iBAAA/5B,EAAAC,EAAA85B,GAAA,qBAAA/5B,EAAAC,EAAA85B,GAAA,eAAA/5B,EAAAC,EAAA85B,GAAA,oBAAA/5B,EAAAC,EAAA85B,GAAA,mBACFA,EAAK3Q,OAAOva,UAAUC,IAAI,YAC1BirB,EAAK3Q,OAAO3Y,MAAMupB,OAAS,IAE3BD,EAAKzuB,KAAOA,QAAAA,EAAQ,CAAC,EAErB,IACM0N,EADS,KACD7P,KAAK8wB,SACnBF,EAAKG,WAA6B,IAAhB/wB,KAAK8wB,SAIvB,IAAME,EAAa,CAAC,EAAG,IAAM,KACvBC,EAAK,CAAC,EAAG,EAAG,GACZC,EAAS,CAAClxB,KAAKqR,GAAc,GAAVrR,KAAKqR,GAAU,EAAGrR,KAAKqR,GAAK,KAC/C8f,EAAS,CAAC,EAAG,EAAa,IAAVnxB,KAAKqR,IAErB+f,EAAS,SAAC79B,EAAW89B,EAAkBC,GAC3C,OAAON,EAAWz9B,GAAKyM,KAAKuxB,IAAIN,EAAG19B,GAAK89B,EAAWH,EAAO39B,GAAK+9B,EAAcH,EAAO59B,GACtF,EACM3I,EAAQ,SAACorB,EAAWsb,GACxB,IAAMD,EAAWrb,EAAIhW,KAAKqR,GAAK,EAC/B,OAAQ+f,EAAO,EAAGC,EAAUC,GAAeF,EAAO,EAAGC,EAAUC,GAAeF,EAAO,EAAGC,EAAUC,IAAgB,CACpH,EASE,OARFV,EAAKhQ,SACLgQ,EAAKY,IAAM,IAAI3qB,GAAUA,GAAUuJ,SAAS,WAG1C,IAFA,IAAMkhB,IAAe,IAAI35B,MAAOE,UAAYgY,GApB/B,KAoBiD7P,KAAKqR,GAAK,EAClElkB,EAAS,GACNoD,EAAI,EAAGA,EAZR,GAYeA,IACrBpD,EAAO4C,KAAKnF,EAAM2F,EAAI,GAAS+gC,IAEjCV,EAAKa,WAAWtkC,EAClB,IAAEyjC,CACJ,CAgEC,OAhEAl6B,EAAA+5B,EAAA,EAAA/lC,IAAA,UAAAE,MAED,WACE,IAAMuX,EAAOpV,KAAKoV,KAElBuvB,EAAiB,CAAC3kC,KAAKkzB,OAAOnc,MAAO/W,KAAKkzB,OAAOlc,QAA1C4tB,EAAED,EAAA,GAAEE,EAAEF,EAAA,GACRluB,EAAc,GAALmuB,EAANjuB,EAAqB,GAALkuB,EACpBpuB,EAHkB,MAGRA,EAHQ,KAIlBE,EAJuB,MAIbA,EAJa,KAK3B,IAAKmS,GAAU8b,EAAKnuB,GAAK,EAAjBsN,GAAqB8gB,EAAKluB,GAAK,EACvC,GAAIvB,EAAK0vB,QAAS,CAChB9kC,KAAKq1B,SAAWnM,GAAU,IAAJvS,EAAU,GAAI,IACpC3W,KAAK+1B,gBAAgB/1B,KAAKq1B,UAC1B,IAAM0P,EAAuB,GAAhB/kC,KAAKq1B,SACZ2P,EAAShlC,KAAKq1B,SAAW,EAAK0P,EACpChhB,GAAKihB,EACLhlC,KAAKilC,UAAY,IAAIlQ,GAAO/0B,KAAKozB,IAAK,IAAIuB,GAAQ,EAAGiQ,EAAI7gB,EAAIpN,EAAGoN,EAAIpN,EAAI,EAAIquB,GAC9E,CACAhlC,KAAKs3B,OAAS,IAAIvC,GAAO/0B,KAAKozB,IAAK,IAAIuB,GAAQ7L,EAAGA,EAAIrS,EAAGsN,EAAGA,EAAIpN,GAClE,GAAC,CAAAhZ,IAAA,aAAAE,MAED,SAAYuC,GAAkB,IAAA8kC,EAAA,KAC5B,GAAKllC,KAAKs3B,OAAV,CACAt3B,KAAKk6B,QACL,IAAMiL,EAAM,SAACxuB,GAAS,aAAA5K,OAAY4K,EAAC,gBAE3B2gB,EAAqHt3B,KAArHs3B,OAAQ2N,EAA6GjlC,KAA7GilC,UAASG,EAAoGplC,KAAlGkzB,OAAiBzc,EAAC2uB,EAARruB,MAAkBJ,EAACyuB,EAATpuB,OAAMquB,EAAwErlC,KAAjEoV,KAAyBkwB,EAAED,EAAnBE,gBAA8B33B,EAAGy3B,EAAZP,QAAgBd,EAAoBhkC,KAApBgkC,WAAY5Q,EAAQpzB,KAARozB,IAEjHkS,IACelS,EAAImC,WAAV,IAAP+P,EAA6B76B,EAAM4P,SAAW,UAAY,UACzCirB,EACrBlS,EAAI0D,SAAS,EAAG,EAAGrgB,EAAGE,IAGxB2gB,EAAOzB,KAAK,IAAIlB,GAAQ,EAAG,GAAI,EAAG,IAAI,SAACvB,EAA+BrP,GACpEqP,EAAIoD,UAAY,EAChBpD,EAAIoS,QAAU,QAEd,IAAMjK,EAAQyI,GAAc,IAAIp5B,MAAOE,UAAY,IAAQ,IAAO,IAC5D26B,EAAOrS,EAAIsS,qBAAqB3hB,EAAEkF,EAAE,GAAI,EAAGlF,EAAEkF,EAAE,GAAI,GACzDwc,EAAKE,aAAa,EAAGR,EAAI5J,IACzBnI,EAAIqD,YAAcgP,EAElBrS,EAAI4D,YACJ5D,EAAImK,OAAOxZ,EAAEkF,EAAE,GAAIlF,EAAElD,EAAEzgB,EAAO,KAC9B,IAAK,IAAIoD,EAAI,EAAGA,EAAIpD,EAAOmD,OAAQC,IAAK,CACtC,IAAMoiC,EAAOpiC,GAAKpD,EAAOmD,OAAS,GAClCkiC,EAAKE,aAAaC,EAAMT,EAAW,IAAPS,EAAarK,IACzCnI,EAAIoK,OAAOzZ,EAAEkF,EAAE2c,GAAO7hB,EAAElD,EAAEzgB,EAAOoD,IACnC,CACA4vB,EAAIsK,QACN,IACK9vB,GACLq3B,EAAUpP,KAAK,IAAIlB,GAAQ,EAAG,EAAG,EAAG,IAAI,SAACvB,EAA+BrP,GACtEmhB,EAAKnP,gBAAgBmP,EAAK7P,UAC1BjC,EAAImD,SAAS3oB,EAAKmW,EAAEkF,EAAE,IAAMlF,EAAElD,EAAE,IAAMqkB,EAAKD,UAAUluB,QACvD,GAlCwB,CAmC1B,GAAC,CAAApZ,IAAA,SAAAE,MAED,WAAsB,GAAE,CAAAF,IAAA,OAAAE,MAExB,WACEmC,KAAKykC,IAAIz/B,OACThF,KAAKkzB,OAAOja,QACd,KAACyqB,CAAA,CA/Gc,CAAS3Q,IAsHb4B,GAAO,WAIlB,SAAAA,EAAakR,EAAcC,EAAcC,EAAcC,GAAcn9B,EAAA,KAAA8rB,GAAA7qB,EAAA,iBAAAA,EAAA,iBACnE9J,KAAK48B,WAAWiJ,EAAMC,EAAMC,EAAMC,EACpC,CA2BC,OA3BAr8B,EAAAgrB,EAAA,EAAAh3B,IAAA,aAAAE,MAED,SAAYgoC,EAAcC,EAAcC,EAAcC,GACpDhmC,KAAKipB,EAAI,CACP5U,IAAKwxB,EACLvxB,IAAKwxB,GAEP9lC,KAAK6gB,EAAI,CACPxM,IAAK0xB,EACLzxB,IAAK0xB,EAET,GAAC,CAAAroC,IAAA,SAAAmJ,IAED,WACE,OAAO9G,KAAKipB,EAAE3U,IAAMtU,KAAKipB,EAAE5U,GAC7B,GAAC,CAAA1W,IAAA,OAAAmJ,IAED,WACE,OAAQ9G,KAAKipB,EAAE3U,IAAMtU,KAAKipB,EAAE5U,KAAO,CACrC,GAAC,CAAA1W,IAAA,SAAAmJ,IAED,WACE,OAAO9G,KAAK6gB,EAAEvM,IAAMtU,KAAK6gB,EAAExM,GAC7B,GAAC,CAAA1W,IAAA,OAAAmJ,IAED,WACE,OAAQ9G,KAAK6gB,EAAEvM,IAAMtU,KAAK6gB,EAAExM,KAAO,CACrC,KAACsgB,CAAA,CAjCiB,GAwCPI,GAAM,WAIjB,SAAAA,EAAa31B,EAAmCw2B,GAAkB/sB,EAAA,KAAAksB,GAAAjrB,EAAA,uBAAAA,EAAA,uBAChE9J,KAAKZ,QAAUA,EACfY,KAAK41B,QAAUA,CACjB,CA4GC,OA5GAjsB,EAAAorB,EAAA,EAAAp3B,IAAA,aAAAE,MAED,SAAYgoC,EAAcC,EAAcC,EAAcC,GACpDhmC,KAAK41B,QAAQgH,WAAWiJ,EAAMC,EAAMC,EAAMC,EAC5C,GAAC,CAAAroC,IAAA,QAAAE,MAED,WACE,OAAOmC,KAAK41B,QAAQ2G,MACtB,GAAC,CAAA5+B,IAAA,SAAAE,MAED,WACE,OAAOmC,KAAK41B,QAAQyJ,MACtB,GAAC,CAAA1hC,IAAA,WAAAE,MAED,SAAUorB,EAAWpI,GACnB,IAAMse,EAAMn/B,KAAK41B,QACjB,OAAQ3M,EAAIkW,EAAIlW,EAAE3U,KAAO2U,EAAIkW,EAAIlW,EAAE5U,KACjCwM,EAAIse,EAAIte,EAAEvM,KAAOuM,EAAIse,EAAIte,EAAExM,GAC/B,GAEA,CAAA1W,IAAA,aAAAE,MAKA,SAAY+5B,GACV,IAAMN,EAASt3B,KAAK41B,QACdiQ,EAAOjO,EAAY3O,EAAE5U,IAErB0xB,EAAOnO,EAAY/W,EAAExM,IAErBgrB,EAASzH,EAAYyH,OACrB9C,EAAS3E,EAAY2E,OACrB0J,EAAa3O,EAAOrO,EAAE5U,IACtBmtB,EAAUlK,EAAOrO,EAAE3U,IAAM2xB,EACzBC,EAAa5O,EAAOzW,EAAEvM,IACtB6xB,EAAUD,EAAa5O,EAAOzW,EAAExM,IAChC+xB,EAAU5E,EAAUjF,EACpB8J,EAAUF,EAAU9G,EAC1B,MAAO,CACLpW,EAAG,SAAFtc,GAAA,SAAAsc,EAAArc,GAAA,OAAAD,EAAA/D,MAAA,KAAAD,UAAA,QAAAsgB,EAAA1hB,SAAA,kBAAAoF,EAAApF,UAAA,EAAA0hB,CAAA,CAAE,WAACA,GAAS,OAAMA,EAAI4c,GAAQO,EAAUH,CAAU,IACnDplB,EAAG,SAAFylB,GAAA,SAAAzlB,EAAA/S,GAAA,OAAAw4B,EAAA19B,MAAA,KAAAD,UAAA,QAAAkY,EAAAtZ,SAAA,kBAAA++B,EAAA/+B,UAAA,EAAAsZ,CAAA,CAAE,WAACA,GAAS,OAAKqlB,GAAcrlB,EAAIklB,GAAQM,CAAO,IACnD9M,IAAK,SAACtQ,GAAS,OAAMA,EAAIgd,GAAcG,EAAUP,CAAI,EACrDU,IAAK,SAAC1lB,GAAS,OAAKklB,GAAQllB,EAAIqlB,GAAcG,CAAO,EACrD5vB,EAAG,SAAF+vB,GAAA,SAAA/vB,EAAA1I,GAAA,OAAAy4B,EAAA59B,MAAA,KAAAD,UAAA,QAAA8N,EAAAlP,SAAA,kBAAAi/B,EAAAj/B,UAAA,EAAAkP,CAAA,CAAE,WAACA,GAAS,OAAKA,EAAI8lB,EAASiF,CAAO,IACtC7qB,EAAG,SAAF8vB,GAAA,SAAA9vB,EAAAtI,GAAA,OAAAo4B,EAAA79B,MAAA,KAAAD,UAAA,QAAAgO,EAAApP,SAAA,kBAAAk/B,EAAAl/B,UAAA,EAAAoP,CAAA,CAAE,WAACA,GAAS,OAAMA,EAAI0oB,EAAS8G,CAAO,IAE3C,GAEA,CAAAxoC,IAAA,QAAAE,MACA,WACE,IAAMshC,EAAMn/B,KAAK41B,QACjB51B,KAAKZ,QAAQk1B,UAAU6K,EAAIlW,EAAE5U,IAAK8qB,EAAIte,EAAExM,IAAK8qB,EAAI5C,OAAQ4C,EAAIE,OAC/D,GAEA,CAAA1hC,IAAA,OAAAE,MACA,SAAM+5B,EAAsB8O,EAAsEC,GAChG,IAAMvT,EAAMpzB,KAAKZ,QACXk4B,EAASt3B,KAAK41B,QACpBxC,EAAI2D,OACC4P,IACHvT,EAAI4D,YACJ5D,EAAIxd,KAAK0hB,EAAOrO,EAAE5U,IAAKijB,EAAOzW,EAAExM,IAAKijB,EAAOiF,OAAQjF,EAAO+H,QAC3DjM,EAAIwT,QAKN,IAAM9Q,EAAQ91B,KAAKs5B,WAAW1B,GAsC9B8O,EAAS1mC,KAAKZ,QAAS02B,GACvB1C,EAAI+D,SACN,KAACpC,CAAA,CAnHgB,GA0HnB,SAAS4C,GACPvE,EACAoO,EACAntB,EACAC,EACAuyB,EACArP,EACA1a,EACA2a,GAEAA,EAASA,GAAU5iB,GAAIiJ,kBACvB,IAAMtX,EAAIg7B,EAAUqF,EACdpF,EAAOntB,EAAMD,EACnB,GAAI7N,EAAI,GAAKi7B,GAAQ,EAAG,MAAO,CAAErL,KAAM,IAWvC,IAVA,IAAM0Q,EAAYrF,EAAOj7B,EAEnBk7B,EAAOoF,EAAYtP,EAAQsP,EAAYtP,EACzCvO,EAAI5U,EAAMqtB,EAAQrtB,EAAMqtB,EACtBqF,EAAS9zB,KAAKqB,IAAIrB,KAAKmK,IAAI9I,GAAMrB,KAAKmK,IAAI/I,IAG1C2S,EAAU/T,KAAKC,MAAMD,KAAKE,MAAM4zB,EAASrF,IAAS,EAClDM,EAAe,GACjBlK,EAAS,EACN7O,EAAI3U,GAAK,CAEd,IAAM+hB,EAAMoB,EADZxO,EAAI9N,OAAO8N,EAAE/B,YAAYF,KAEzB8Q,EAAS7kB,KAAKqB,IAAIwjB,EAAQ1E,EAAIkD,YAAYD,GAAKtf,OAC/CirB,EAAIh/B,KAAK,CACPwB,IAAKykB,EACLe,IAAKqM,IAEPpN,GAAKyY,CACP,CACA,IAAMsF,EAAQ5T,EAAIkD,YAAYxZ,GAAM/F,MAEpC,OADIiwB,EAAQlP,IAAQA,EAASkP,GACtB,CACLlP,OAAQA,EACR1B,KAAM4L,EAEV,CAEA,IAAMC,GAAS,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,OAqD7F,SAASxG,GAAMx0B,GACb,OAAOA,EAAIA,EAAI1D,OAAS,EAC1B,CAGA,SAASmzB,GAAMtD,EAA+B2E,EAAYC,EAAYC,EAAYC,EAAYC,GAC5F/E,EAAI4D,YACJ5D,EAAImK,OAAOxF,EAAIC,GACf5E,EAAIoK,OAAOvF,EAAIC,GACVC,GAAY/E,EAAIsK,QACvB,CAGA,SAASrF,GAAKjF,EAA+BnK,EAAWpI,EAAWuH,EAAegQ,GAChFhF,EAAImC,UAAYnN,EAChBgL,EAAI4D,YACJ5D,EAAI6T,IAAIhe,EAAGpI,EAAGuX,EAAQ,EAAGxG,IACzBwB,EAAI8D,MACN,CAGA,SAASoE,GAAc30B,EAAWyT,GAChC,OAAO+iB,GAAgBx2B,EAAGyT,EAAG,KAC/B,CAMA,SAAS+iB,GAAiBx2B,EAAWyT,EAAW2iB,GAC9C,OAAO9pB,KAAKmK,IAAIzW,EAAIyT,GAAKnH,KAAKmK,IAAI2f,EACpC,CAEA,SAASoD,GAAUz0B,EAAW+K,GAC5B,OAAO/K,EAAKA,EAAI+K,CAClB,4gCCx6CO,IAIMywB,GAAe,WAI1B,SAAAA,EAAaC,GAAkBt+B,EAAA,KAAAq+B,GAAAp9B,EAAA,oBAAAA,EAAA,oBAC7B9J,KAAKmrB,KAAOtW,GAAI6W,cAAcyb,GAC9BtyB,GAAIuyB,eAAepnC,KAAKmrB,KAAKkc,kBAC/B,CAqCC,OArCA19B,EAAAu9B,EAAA,EAAAvpC,IAAA,UAAAE,MAED,SAASypC,GACPtnC,KAAKsnC,KAAOA,CACd,GAAC,CAAA3pC,IAAA,SAAAE,MAED,WACE,IAAQstB,EAAenrB,KAAfmrB,KAAMmc,EAAStnC,KAATsnC,KACdC,EAA6Ctc,KAAMuc,UAAUF,GAArDG,EAAIF,EAAJE,KAAMC,EAAQH,EAARG,SAAUC,EAAgBJ,EAAhBI,iBACTC,EAAYH,EAAnBI,IAAOD,MAETE,EAAcC,GAAWN,GAEzBO,EAAWF,EAAcA,EAAcH,GAAoB,GAAwB,EAApBA,EAC/DM,EAAU,GAEhB9c,EAAK+c,UAAU3tB,MAAMxD,MAAQ,GAAHhL,OAAMk8B,EAAO,KACvC,IAAME,EAAMP,GAAS,EAAIK,EAAWL,EAAQF,EAF3B,GAEkDO,EAAWh1B,KAAKoB,IAAI4zB,EAASL,EAAQI,EAAWC,GAEnH9c,EAAKid,aAAa7tB,MAAMxE,KAAO,GAAHhK,OAAMo8B,EAAG,KACrChd,EAAKkd,SAAShpB,YAAc/V,OAAO0+B,GACnC7c,EAAKmd,SAASjpB,YAAc/V,OAAOo+B,GACnC,IAAMa,EAAQC,GAAWZ,EAAOF,GAChCvc,EAAKqd,WAAWnpB,YAAckpB,EAAM7iB,QAAQ,GAAE,IACsBva,EADtBC,EAAAC,GAC9BwJ,GAAImG,cAAcmQ,EAAKsd,UAAW,oBAAkB,IAApE,IAAAr9B,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAYyJ,EAAAtN,MAA4Dob,QAAQ,OAAAva,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CAChF,GAAIi8B,EAAc,EAEhB,IADA,IAAMY,EAAYT,EAAUH,EACnBtkC,EAAI,EAAGA,EAAIskC,EAAatkC,IAAK,CACpC,IAAM2jC,EAAMhc,EAAKkc,kBAAkB5b,WAAU,GAC7CN,EAAKsd,UAAUnwB,YAAY6uB,GAC3BA,EAAI5sB,MAAMxE,KAAO,GAAHhK,OAAM28B,EAAYllC,EAAC,IACnC,CAEF2nB,EAAKyc,MAAMvoB,YAAc/V,OAAOs+B,GAChCzc,EAAKwd,UAAUhwB,UAAUM,OAAO,WAAY,YACxC2uB,EAAQ,EAAGzc,EAAKwd,UAAUhwB,UAAUC,IAAI,YACvCuS,EAAKwd,UAAUhwB,UAAUC,IAAI,WACpC,KAACsuB,CAAA,CA5CyB,GAoDrB,SAASa,GAAYN,GAC1B,IAAQmB,EAA4CnB,EAA5CmB,aAAcC,EAA8BpB,EAA9BoB,WAAYC,EAAkBrB,EAAlBqB,cAClC,GAAIA,EAAgBD,EAAY,CAC9B,IAAMpH,EAAOqH,EAAgBD,EAC7B,OAAID,GAAgBnH,EAAaoH,EAC1BA,GAAcpH,EAAOmH,EAC9B,CACA,OAAOE,CACT,CAUA,wCAAMC,GAAoB,SAAC5f,EAAY6f,EAAclP,GAAoB,IAAAmP,EAAAC,EACjE3Y,EAAMpH,EAAIoH,IAAMpH,EAAImH,OAC1B,GFlF4B,IEkFxBnH,EAAIzpB,KAAyB,OAAO6wB,EACxC,GAAIpH,EAAIsG,KAAM,OAAOc,EAAMpH,EAAI7M,KAAOvJ,GACtC,IAAMuJ,EAAOwd,IAAUkP,SAAS,QAANC,EAAHD,EAAKG,YAAI,IAAAF,OAAN,EAAHA,EAAW3sB,OAAQ,EAE1C,OAAK0sB,EAGD1sB,KAAS0sB,SAAS,QAANE,EAAHF,EAAKG,YAAI,IAAAD,OAAN,EAAHA,EAAWE,aAAc,GAAK,EAAU7Y,EAAMxd,GAAqBuJ,EACzE0sB,EAAIK,QAJM,CAKnB,EA0BA,SAASC,GAAcngB,EAAY6f,EAAalP,GAC9C,OFpH6B,IEoHzB3Q,EAAIzpB,KAAiC,EAzBpC,SAAsBypB,EAAY6f,EAAalP,GAAiB,IAAAyP,EACrE,GFpFyB,IEoFrBpgB,EAAI5b,OAAwB,OAAO,EACvC,IAAMgjB,EAAMwY,GAAkB5f,EAAK6f,EAAKlP,GAExC,OAzBK,SAAsB3Q,EAAY7M,GACvC,OFxE6B,IEwEzB6M,EAAIzpB,MFpEkB,IEoEUypB,EAAI0G,KAE3B,IAATvT,IACA6M,EAAIsG,KAAatG,EAAI7M,KAAOA,EACzB6M,EAAI7M,KAAOA,EACpB,CAmBMktB,CAAYrgB,EADH2Q,IAAkB,QAAZyP,EAAIP,EAAIG,YAAI,IAAAI,OAAA,EAARA,EAAUjtB,OAAQ,GACA,EAANiU,EAC5BA,CACT,CAoBSkZ,CAAYtgB,EAAK6f,EAAKlP,GAlB/B,SAAqB3Q,GACnB,OF3F0B,IE2FtBA,EAAI5b,OAAgC,EACjCw7B,GAAkB5f,EAC3B,CAeyCugB,CAAWvgB,GAbpD,SAAyBA,GACvB,IACkC9T,EAD9B8lB,EAAM,EAAC7lB,EAAAjK,GACM8d,EAAI8G,SAAW,IAAE,IAAlC,IAAA3a,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAqC,KAA1Bgf,EAACrL,EAAAxX,MACV,GFjF0B,IEiFtB6iB,EAAEiQ,MACJ,GAAIjQ,EAAEnT,OF1FiB,EE0FO,cACzB,GAAImT,EAAEnT,OF5FY,EE4FY,SACrC4tB,GAAOza,EAAE6P,GACX,CAAC,OAAA7xB,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACD,OAAOsvB,CACT,CAI2DwO,CAAexgB,EAC1E,CAMA,SAASqf,GAAYZ,EAAeF,GAClC,OAAOE,EAAQ,EAAI,EAAIA,EAAQF,EAAW,EAAmC,CAC/E,CCzIO,IAIDkC,GAAkC,6BAIxC,SAASC,GAAqBC,GAC5B,OAAIA,EAAIC,WAAWH,IAAyC,CAACE,EAAIjrB,UAAU+qB,KAAyC,GAC5F,KAAfE,EAAIvmC,OAAsB,CAACumC,GAAK,GAC7B,CAACA,GAAK,EACpB,CAEA,IAAME,IAAqDlgC,EAAAmgC,GAAG,CAAC,EAdxC,GAeV,SAACH,GACV,IAA8CI,EAAAtiC,EAAxBiiC,GAAoBC,GAAI,GAAvCrqC,EAAGyqC,EAAA,GACV,OADkBA,EAAA,GACF,gCAAHn+B,OAAmCtM,GAAG,2BAAAsM,OAAgCtM,EACrF,IAACqK,EAAAmgC,GAjBoB,GAkBV,SAACH,GACV,IAA8CK,EAAAviC,EAAxBiiC,GAAoBC,GAAI,GAAvCrqC,EAAG0qC,EAAA,GACV,OADkBA,EAAA,GACF,wCAAHp+B,OAA2CtM,GAAG,mCAAAsM,OAAwCtM,EACrG,IAACqK,EAAAmgC,GApBmB,GAqBV,SAACH,GACT,IAA8CM,EAAAxiC,EAAxBiiC,GAAoBC,GAAI,GAAvCrqC,EAAG2qC,EAAA,GACV,OADkBA,EAAA,GACF,gCAAHr+B,OAAmCtM,GAAG,2BAAAsM,OAAgCtM,EACrF,IAACwqC,IAGGI,IAAyDvgC,EAAAwgC,GAAG,CAAC,EA7B5C,GA8BV,SAACR,GACV,IAA8CS,EAAA3iC,EAAxBiiC,GAAoBC,GAAI,GAAvCrqC,EAAG8qC,EAAA,GACV,OADkBA,EAAA,GACF,mCAAHx+B,OAAsCtM,GAAG,8BAAAsM,OAAmCtM,EAC3F,IAACqK,EAAAwgC,GAhCoB,GAiCV,SAACR,GACV,IAA8CU,EAAA5iC,EAAxBiiC,GAAoBC,GAAI,GAAvCrqC,EAAG+qC,EAAA,GACV,OADkBA,EAAA,GACF,wCAAHz+B,OAA2CtM,GAAG,mCAAAsM,OAAwCtM,EACrG,IAACqK,EAAAwgC,GAnCmB,GAoCV,SAACR,GACT,IAA8CW,EAAA7iC,EAAxBiiC,GAAoBC,GAAI,GAAvCrqC,EAAGgrC,EAAA,GACV,OADkBA,EAAA,GACF,mCAAH1+B,OAAsCtM,GAAG,8BAAAsM,OAAmCtM,EAC3F,IAAC6qC,IAGUI,GAAyE,CACpF,IAAEt4B,GAAA,GAAAtI,EAAAsI,GA7CmB,GA8CR,SAAC03B,GACV,IAAmCa,EAAA/iC,EAAdkiC,EAAIx+B,MAAM,KAAI,GAA5Bs/B,EAAID,EAAA,GAAEE,EAAIF,EAAA,GACjB,YAAalpC,IAATopC,EAA2B,mCAAP9+B,OAA0C6+B,EAAI,SAAA7+B,OAAQ8+B,GACvE,mCAAP9+B,OAA0C6+B,EAC5C,IAAC9gC,EAAAsI,GAjDkB,GAkDR,SAAC03B,GACV,IAAmCgB,EAAAljC,EAAdkiC,EAAIx+B,MAAM,KAAI,GAA5Bs/B,EAAIE,EAAA,GAAED,EAAIC,EAAA,GACjB,YAAarpC,IAATopC,EAA2B,kCAAP9+B,OAAyC6+B,EAAI,SAAA7+B,OAAQ8+B,GACtE,kCAAP9+B,OAAyC6+B,EAC3C,IAAC9gC,EAAAsI,GArDiB,GAsDR,SAAC03B,GACT,IAAmCiB,EAAAnjC,EAAdkiC,EAAIx+B,MAAM,KAAI,GAA5Bs/B,EAAIG,EAAA,GAAEF,EAAIE,EAAA,GACjB,YAAatpC,IAATopC,EAA2B,6BAAP9+B,OAAoC6+B,EAAI,SAAA7+B,OAAQ8+B,GACjE,8BAAP9+B,OAAqC6+B,EACvC,IAACx4B,IAEH,GAAC44B,GAAA,GAAAlhC,EAAAkhC,GA9DoB,GA+DR,SAAClB,GAAW,kCAAA/9B,OAAiC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAkhC,GA9DxD,GA+DR,SAAClB,GAAW,0CAAA/9B,OAAyC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAkhC,GA9DjE,GA+DR,SAAClB,GAAW,kCAAA/9B,OAAiC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAE0/B,IAE5E,GAACC,GAAA,GAAAnhC,EAAAmhC,GAnEoB,GAoER,SAACnB,GAAW,gCAAA/9B,OAA+B+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAmhC,GAnEtD,GAoER,SAACnB,GAAW,wCAAA/9B,OAAuC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAmhC,GAnE/D,GAoER,SAACnB,GAAW,gCAAA/9B,OAA+B+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAE2/B,IAE1E,IAAEC,GAAA,GAAAphC,EAAAohC,GAxEmB,GAyER,SAACpB,GAAW,sCAAA/9B,OAAqC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAohC,GAxE5D,GAyER,SAACpB,GAAW,uDAAA/9B,OAAsD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAohC,GAxE9E,GAyER,SAACpB,GAAW,sCAAA/9B,OAAqC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAE4/B,IAEhF,GAAIlB,GACJ,MAAOA,GACP,MAAOA,GACP,GAACmB,GAAA,GAAArhC,EAAAqhC,GAhFoB,GAiFR,SAACrB,GAAW,mCAAA/9B,OAAkC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAqhC,GAhFzD,GAiFR,SAACrB,GAAW,uDAAA/9B,OAAsD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAqhC,GAhF9E,GAiFR,SAACrB,GAAW,mCAAA/9B,OAAkC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAE6/B,IAE7E,GAACC,GAAA,GAAAthC,EAAAshC,GArFoB,GAsFR,SAACtB,GAAW,mDAAA/9B,OAAkD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAshC,GArFzE,GAsFR,SAACtB,GAAW,mDAAA/9B,OAAkD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAshC,GArF1E,GAsFR,SAACtB,GAAW,mDAAA/9B,OAAkD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAE8/B,IAE7F,KAAGC,GAAA,GAAAvhC,EAAAuhC,GA1FkB,GA2FR,SAACvB,GAAW,qDAAA/9B,OAAoD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAuhC,GA1F3E,GA2FR,SAACvB,GAAW,oDAAA/9B,OAAmD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAuhC,GA1F3E,GA2FR,SAACvB,GAAW,qDAAA/9B,OAAoD+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAE+/B,IAE/F,KAAGC,GAAA,GAAAxhC,EAAAwhC,GA/FkB,GAgGR,SAACxB,GAAW,4CAAA/9B,OAA2C+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAwhC,GA9FnE,GA+FR,SAACxB,GAAW,4CAAA/9B,OAA2C+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAEggC,IAEtF,KAAGC,GAAA,GAAAzhC,EAAAyhC,GAnGkB,GAoGR,SAACzB,GAAW,sCAAA/9B,OAAqC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAyhC,GAnG5D,GAoGR,SAACzB,GAAW,0CAAA/9B,OAAyC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAAyhC,GAnGjE,GAoGR,SAACzB,GAAW,sCAAA/9B,OAAqC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAEigC,IAEhF,KAAGC,GAAA,GAAA1hC,EAAA0hC,GAxGkB,GAyGR,SAAC1B,GAAW,mCAAA/9B,OAAkC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAA0hC,GAxGzD,GAyGR,SAAC1B,GAAW,qCAAA/9B,OAAoC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAExB,EAAA0hC,GAxG5D,GAyGR,SAAC1B,GAAW,mCAAA/9B,OAAkC+9B,EAAIx+B,MAAM,KAAK,GAAE,IAAEkgC,IAE7E,IAAKnB,GACL,OAAQA,GACR,OAAQA,GACR,OAAQA,GACR,OAAQA,IAGH,SAASoB,GAAc3B,GAC5B,OAAIA,EAAIC,WAAWH,IAEVrtB,GRzBoC,+BQyBY,CAAEmvB,UADvC5B,EAAIjrB,UAAU+qB,MAG3BE,CACT,CAeO,SAAS6B,GAAa5tB,EAAiB6tB,GAC5C,IAAMC,EAAM5gB,KAAM6gB,KAAKD,IACjBE,EAAgBrB,GAXxB,SAAsB3sB,GACpB,IAAMkB,EAAQgM,KAAM6gB,KAAKzK,OAAOtjB,GAChC,OAAOkB,EAAM+sB,MAAQ/sB,EAAM+sB,MAAMC,SAAWluB,CAC9C,CAQsCmuB,CAAYnuB,IAChD,GAAKguB,EAAL,CACA,IAAM53B,EAAY43B,EAAcF,GAC3B13B,IACLy3B,EAAKjzB,UAAUM,OAAO,aACtB2yB,EAAKjzB,UAAUC,IAAI,cACnBgzB,EAAKO,KAAOh4B,EAAUy3B,EAAKrtB,QAAQ6tB,cAAgB,IALzB,CAM5B,+kDChHO,IAAMC,GAAwB,aACxBC,GAAsB,WACtBC,GAA0B,gBAC1BC,GAAqB,UACrBC,GAAyB,eAEzBC,GAAiB,UACjBC,GAAe,QACfC,GAAkB,WAOlBC,GAAkD,CAC7D,QAAW,CACT9oC,KAAM,UACN+oC,KAAM,wBAER,UAAa,CACX/oC,KAAM,eACN+oC,KAAM,wBAsEGC,GAAK,IA9DE,oBAAAC,IAAAnkC,EAAA,KAAAmkC,GAAAljC,EAAA,uBACiD,CAAC,EAAC,CAkDpE,IAAAmjC,EApBAC,EAJAC,EAJAC,EAJAC,EAJAC,EALDC,EAPAC,EAuDC,OAzDoE7jC,EAAAqjC,EAAA,EAAArvC,IAAA,kBAAAE,OAErE2vC,EAAA/kC,EAAAzL,IAAAA,MAGA,SAAA8P,EAAuBwf,GAAc,OAAAtvB,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,cAAA4K,EAAAjL,OAAA,SAC5B4L,EAAS,uBAAwBye,IAAI,wBAAApf,EAAAlI,OAAA,GAAA8H,EAAA,KAC7C,SAAA9E,GAAA,OAAAwlC,EAAA5kC,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,kBAAAE,OAAA0vC,EAAA9kC,EAAAzL,IAAAA,MAGA,SAAAiR,EAAuBqe,GAAc,OAAAtvB,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,cAAA6L,EAAAlM,OAAA,SAC5B4L,EAAS,uBAAwBye,IAAI,wBAAAne,EAAAnJ,OAAA,GAAAiJ,EAAA,KAC7C,SAAAtB,GAAA,OAAA4gC,EAAA3kC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,kBAAAE,OAAAyvC,EAAA7kC,EAAAzL,IAAAA,MAED,SAAAuR,EAAuB+4B,EAAcrW,EAAgBC,GAAe,OAAAl0B,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,cAAAkM,EAAAvM,OAAA,SAC3D4L,EAAS,uBAAwB,CAAEy5B,KAAAA,EAAMrW,OAAAA,EAAQC,QAAAA,KAAU,wBAAA1iB,EAAAxJ,OAAA,GAAAuJ,EAAA,KACnE,SAAA3B,EAAAkB,EAAAC,GAAA,OAAAu/B,EAAA1kC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,OAAAwvC,EAAA5kC,EAAAzL,IAAAA,MAED,SAAA2mB,EAAc2jB,EAAcrW,EAAgBC,GAAe,OAAAl0B,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,cAAAshB,EAAA3hB,OAAA,SAClD4L,EAAS,oBAAqB,CAAEy5B,KAAAA,EAAMrW,OAAAA,EAAQC,QAAAA,KAAU,wBAAAtN,EAAA5e,OAAA,GAAA2e,EAAA,KAChE,SAAAtV,EAAAqV,EAAA+C,GAAA,OAAA4mB,EAAAzkC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,WAAAE,OAAAuvC,EAAA3kC,EAAAzL,IAAAA,MAED,SAAA6mB,EAAgB4pB,GAAmB,OAAAzwC,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,cAAAwhB,EAAAxhB,KAAA,EACpBuL,EAAS,4BAA6B,CAAE4/B,OAAAA,IAAS,cAAA3pB,EAAA7hB,OAAA,SAAA6hB,EAAAhiB,MAAA,wBAAAgiB,EAAA9e,OAAA,GAAA6e,EAAA,KAC/D,SAAA6F,GAAA,OAAA0jB,EAAAxkC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,UAAAE,OAAAsvC,EAAA1kC,EAAAzL,IAAAA,MAED,SAAAopB,EAAe2a,GAAsB,OAAA/jC,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,cAAAgkB,EAAAhkB,KAAA,EAC7BuL,EAAS,2BAA4B,CAAEkzB,OAAAA,IAAS,wBAAAza,EAAAthB,OAAA,GAAAohB,EAAA,KACvD,SAAAuD,GAAA,OAAAwjB,EAAAvkC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,OAAAqvC,EAAAzkC,EAAAzL,IAAAA,MAED,SAAA+sB,IAAA,OAAA/sB,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,cAAA+nB,EAAA/nB,KAAA,EACgB8L,EAAQ,2BAA0B,cAAAic,EAAApoB,OAAA,SAAAooB,EAAAvoB,KAAEyL,QAAM,wBAAA8c,EAAArlB,OAAA,GAAA+kB,EAAA,KACzD,kBAAAmjB,EAAAtkC,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,WAAAE,MACA,SAAUozB,EAAgBC,EAAiBoW,EAAcoG,GACvD,IAAK,IAAL7lC,EAAA,EAAA8lC,EAAwBtwC,OAAO+C,OAAO6qB,KAAM2iB,SAASC,MAAKhmC,EAAA8lC,EAAApqC,OAAAsE,IAAE,CAAvD,IAAMimC,EAASH,EAAA9lC,GAClB,GAAKimC,EAAUC,SAAf,CACA,IAAMA,EAAWD,EAAUC,SACrBzhB,EAAMwhB,EAAUL,OACtB,GAAInhB,EAAI2E,SAAWA,GAAU3E,EAAI4E,UAAYA,GAAW5E,EAAIgb,OAASA,GAAQyG,EAASL,YAAcA,EAClG,OAAOK,CAJwB,CAMnC,CACF,GAAC,CAAApwC,IAAA,mBAAAE,MAED,SAAkBmwC,EAAiBjwB,GAA8C,IAAAkwB,EAC/E,OAAoC,QAApCA,EAAOjuC,KAAKkuC,gBAAgBF,UAAQ,IAAAC,OAAA,EAA7BA,EAAgClwB,EACzC,GAAC,CAAApgB,IAAA,aAAAE,OAAAovC,EAAAxkC,EAAAzL,IAAAA,MAED,SAAAmxC,EAAkBH,EAAiBjwB,GAAe,IAAAqwB,EAAA,OAAApxC,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OACsB,OAAjEtC,KAAKkuC,gBAAgBF,KAAUhuC,KAAKkuC,gBAAgBF,GAAW,CAAC,GAACK,EAAA/rC,KAAA,EAC5CuL,EAAS,kBAAmB,CAAEmgC,QAAAA,EAASjwB,QAAAA,IAAU,OACxB,OAD7CqwB,EAAUC,EAAAvsC,KAA6DssC,WAC7EpuC,KAAKkuC,gBAAgBF,GAASjwB,GAAWqwB,EAAUC,EAAApsC,OAAA,SAC5CmsC,GAAU,wBAAAC,EAAArpC,OAAA,GAAAmpC,EAAA,UAClB,SAAAvkB,EAAAC,GAAA,OAAAojB,EAAArkC,MAAA,KAAAD,UAAA,MAAAqkC,CAAA,CA1DiB,IAgEb,SAASsB,GAAqBvwB,GACnC,OAAOkN,KAAM2iB,SAASC,KAAKpwB,QAAO,SAAC/R,EAACsO,GAA4B,IAAAu0B,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAxB3B,EAAQ/zB,EAAR+zB,SACtC,IADuD/zB,EAAPsL,UAC/ByoB,EAAU,OAAOriC,EAClC,IAAqBhF,EAAsBqnC,EAAnC4B,YAA6BzP,EAAM6N,EAAnB6B,YAWxB,OAVAlkC,EAAEmkC,IAAIhrB,QAA4B,QAAtB0pB,EAAc,QAAdC,EAAItO,EAAEniB,UAAQ,IAAAywB,OAAA,EAAVA,EAAY3pB,cAAM,IAAA0pB,EAAAA,EAAI,EACtC7iC,EAAEmkC,IAAIhrB,QAA8B,QAAxB4pB,EAAc,QAAdC,EAAIxO,EAAEniB,UAAQ,IAAA2wB,OAAA,EAAVA,EAAYoB,gBAAQ,IAAArB,EAAAA,EAAI,EACxC/iC,EAAEmkC,IAAIE,OAA8B,QAAzBpB,EAAc,QAAdC,EAAI1O,EAAEniB,UAAQ,IAAA6wB,OAAA,EAAVA,EAAYoB,iBAAS,IAAArB,EAAAA,EAAI,EACxCjjC,EAAEmkC,IAAII,MAAQvkC,EAAEmkC,IAAIE,MAAQrkC,EAAEmkC,IAAIhrB,OAClCnZ,EAAEwkC,IAAIrrB,QAA4B,QAAtBgqB,EAAc,QAAdC,EAAIpoC,EAAEqX,UAAQ,IAAA+wB,OAAA,EAAVA,EAAYjqB,cAAM,IAAAgqB,EAAAA,EAAI,EACtCnjC,EAAEwkC,IAAIrrB,QAA8B,QAAxBkqB,EAAc,QAAdC,EAAItoC,EAAEqX,UAAQ,IAAAixB,OAAA,EAAVA,EAAYc,gBAAQ,IAAAf,EAAAA,EAAI,EACxCrjC,EAAEwkC,IAAIH,OAA8B,QAAzBd,EAAc,QAAdC,EAAIxoC,EAAEqX,UAAQ,IAAAmxB,OAAA,EAAVA,EAAYc,iBAAS,IAAAf,EAAAA,EAAI,EACxCvjC,EAAEwkC,IAAID,MAAQvkC,EAAEwkC,IAAIH,MAAQrkC,EAAEwkC,IAAIrrB,OAClCnZ,EAAEqkC,QAA+B,QAAtBZ,EAAW,QAAXC,EAAC1oC,EAAEqX,UAAQ,IAAAqxB,OAAA,EAAVA,EAAYY,iBAAS,IAAAb,EAAAA,EAAI,IAA2B,QAA1BE,EAAe,QAAfC,EAAKpP,EAAEniB,UAAQ,IAAAuxB,OAAA,EAAVA,EAAYU,iBAAS,IAAAX,EAAAA,EAAI,GACpE3jC,EAAEmZ,SAA6B,QAAnB0qB,EAAW,QAAXC,EAAC9oC,EAAEqX,UAAQ,IAAAyxB,OAAA,EAAVA,EAAY3qB,cAAM,IAAA0qB,EAAAA,EAAI,IAAwB,QAAvBE,EAAe,QAAfC,EAAKxP,EAAEniB,UAAQ,IAAA2xB,OAAA,EAAVA,EAAY7qB,cAAM,IAAA4qB,EAAAA,EAAI,GACxD/jC,CACT,GAAG,CAAEqkC,MAAO,EAAGlrB,OAAQ,EAAGgrB,IAAK,CAAEE,MAAO,EAAGlrB,OAAQ,EAAGorB,MAAO,GAAKC,IAAK,CAAEH,MAAO,EAAGlrB,OAAQ,EAAGorB,MAAO,IACvG,CAEO,SAASE,GAAmBp4B,EAAuBkZ,EAAgBC,EAAiBoW,GACzFzyB,GAAIoJ,QAAQlG,EAAU,cAAeuvB,GACrC,IAAA8I,EAAgFnlB,KAAMoW,OAAOpQ,GAA3EzV,EAAG40B,EAAb17B,SAAqB27B,EAAQD,EAAdrsC,KAAwBusC,EAAUF,EAAlBzxB,OAA2B4xB,EAASH,EAAhBpE,MAC3Dn3B,GAAIoJ,QAAQlG,EAAU,mBAAoBs4B,GAC1Cx7B,GAAI27B,OAAOz4B,EAAU,mBAAoBlD,GAAImK,SAASsxB,IACtDz7B,GAAIoJ,QAAQlG,EAAU,qBAAsByD,EAAI7G,aAAamI,MAC7D,IAAA2zB,EAA0ExlB,KAAMoW,OAAOkP,EAAYA,EAAUtE,SAAWhb,GAAtGyf,EAASD,EAAnB/7B,SAA2Bi8B,EAAWF,EAAjB1sC,KAA2B6sC,EAAaH,EAArB9xB,OAChD9J,GAAIoJ,QAAQlG,EAAU,uBAAwB44B,GAC9C97B,GAAI27B,OAAOz4B,EAAU,uBAAwBlD,GAAImK,SAAS4xB,IAC1D/7B,GAAIoJ,QAAQlG,EAAU,yBAA0B24B,EAAU/7B,aAAamI,MACvE,IAAA+zB,EAAmF5lB,KAAMoW,OAAOnQ,GAA9EzV,EAAGo1B,EAAbn8B,SAAqBo8B,EAASD,EAAf9sC,KAAyBgtC,EAAWF,EAAnBlyB,OAA4BqyB,EAAUH,EAAjB7E,MAC7Dn3B,GAAIoJ,QAAQlG,EAAU,oBAAqB+4B,GAC3Cj8B,GAAI27B,OAAOz4B,EAAU,oBAAqBlD,GAAImK,SAAS+xB,IACvDl8B,GAAIoJ,QAAQlG,EAAU,sBAAuB0D,EAAI9G,aAAamI,MAC9D,IAAAm0B,EAA6EhmB,KAAMoW,OAAO2P,EAAaA,EAAW/E,SAAW/a,GAA3GggB,EAAUD,EAApBv8B,SAA4By8B,EAAYF,EAAlBltC,KAA4BqtC,EAAcH,EAAtBtyB,OAClD9J,GAAIoJ,QAAQlG,EAAU,wBAAyBo5B,GAC/Ct8B,GAAI27B,OAAOz4B,EAAU,wBAAyBlD,GAAImK,SAASoyB,IAC3Dv8B,GAAIoJ,QAAQlG,EAAU,0BAA2Bm5B,EAAWv8B,aAAamI,KAC3E,CAEO,SAASu0B,GAAgBt5B,EAAuBi2B,GACrD,IAAMsD,EAAQzE,GAAgBmB,GAC9Bn5B,GAAIoJ,QAAQlG,EAAU,kBAAmBu5B,EAAMvtC,MAC/C8Q,GAAI27B,OAAOz4B,EAAU,kBAAmBu5B,EAAMxE,MAAK,IACa3hC,EADbC,EAAAC,GACjCwJ,GAAImG,cAAcjD,EAAU,oBAAkB,IAAhE,IAAA3M,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAkE,KAAvD6vC,EAAGpmC,EAAAtN,MAAoDgX,GAAIyE,KAAKi4B,EAAG,CAAC,OAAA7yC,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACjF,CAEO,SAAS2lC,GAAmBhY,EAAiBvI,EAAgBC,EAAiBiY,GACnF,IAAMsI,EAAWxmB,KAAMymB,aAAazgB,GAC9B0gB,EAAY1mB,KAAMymB,aAAaxgB,GACiBsS,EAAgBvY,KAAMoW,OAAOpQ,GAA3Evc,SAAYC,aAAgBC,iBACkB2uB,EAAgBtY,KAAMoW,OAAOnQ,GAA3Exc,SAAYC,aAAgBC,iBACpC,OAAI68B,GAAYE,EACPnY,EAAUiY,EAAWE,EAAYpO,EAAUC,EACzC2F,EACF3P,EAAU2P,EAAK7sB,KAAOs1B,GAExBrO,CACT,CAaO,IAAMsO,GAAe,SAAAtZ,GAAAnuB,EAAAynC,EAAAtZ,GAAA,QAAA7Q,KAAAmqB,iZAK1B,SAAAA,EAAa16B,GAAqB,IAAAgC,EAK9B,OAL8BtQ,EAAA,KAAAgpC,GAK9B/nC,EAAAC,EAJFoP,EAAAuO,EAAA/nB,KAAA,KAAMwX,EAAQ,CACZ0c,OAAQ,kBAAM1a,EAAKsf,SAAS,EAC5BxE,MAAO,WAAqC,EAC5C5B,KAAM,WAAuC,KAC7C,cAAAvoB,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,kBAAAA,CACJ,CAgIC,OAhIAxP,EAAAkoC,EAAA,EAAAl0C,IAAA,UAAAE,MAED,WACEmC,KAAKu0B,QACP,GAAC,CAAA52B,IAAA,OAAAE,MAED,WAAoB,GAAE,CAAAF,IAAA,YAAAE,MAEtB,SAAWyuB,GAA2B,IAAApG,EAAA,KACpClmB,KAAKssB,IAAMA,EACX,IAAQwlB,EAAgC9xC,KAAhC8xC,UAAkB9D,EAAchuC,KAArBssB,IAAO0hB,QACtBA,GAAWA,IAAY8D,IACzB9xC,KAAK8xC,UAAY9D,EACjBhuC,KAAK+xC,QAAU,IAAIC,MACnBn9B,GAAI1K,KAAKnK,KAAK+xC,QAAS,QAAQ,WAAQ7rB,EAAKqO,QAAS,IACrDv0B,KAAK+xC,QAAQtyB,IAAMotB,GAAgBmB,GAAW,IAAIlB,MAEpD9sC,KAAKu0B,QACP,GAAC,CAAA52B,IAAA,SAAAE,MAED,WAAU,IAAAkpB,EAAA,KACAqM,EAA4BpzB,KAA5BozB,IAAKF,EAAuBlzB,KAAvBkzB,OAAQD,EAAejzB,KAAfizB,MAAO3G,EAAQtsB,KAARssB,IAC5B,GAAqB,IAAjB4G,EAAOnc,OAAgBuV,EAA3B,CACA,IAAA2lB,EAAmF3lB,EAA3ED,KAAQ6lB,EAAaD,EAAbC,cAAeC,EAAcF,EAAdE,eAAgBC,EAAMH,EAANG,OAAUC,EAA0B/lB,EAA1B+lB,aAAcC,EAAYhmB,EAAZgmB,QACvE,GAAIA,IAAY1F,GAAhB,CAEA5sC,KAAKk6B,QAEL,IAAMqY,EAAiB,SAACxa,EAAYC,EAAYC,EAAYC,EAAY9P,GACtEgL,EAAI2D,OACJ3D,EAAI8K,YAAY,CAAC,EAAG,IACpB9K,EAAIoD,UAAY,IAChBpD,EAAIqD,YAAcrO,EAClBrB,EAAK2P,KAAKqB,EAAIC,EAAIC,EAAIC,GACtB9E,EAAI+D,SACN,EAEMqb,EAAYF,IAAY5F,GACxB7J,EAAK3P,EAAOnc,MAAQ,EACkE2H,EAAA9W,EAAjE4qC,EAAY,CAAC3P,EAAIA,GAAM,CAAC,IAAO3P,EAAOnc,MAAO,IAAOmc,EAAOnc,OAAM,GAArF07B,EAAO/zB,EAAA,GAAEg0B,EAAOh0B,EAAA,GAEjBi0B,EAAUT,EAAcz0B,QAAO,SAAC/R,EAAWxB,GAAiB,OAAKwB,EAAIxB,EAAE0oC,IAAI,GAAE,GAC7EC,EAAWV,EAAe10B,QAAO,SAAC/R,EAAWxB,GAAiB,OAAKwB,EAAIxB,EAAE0oC,IAAI,GAAE,GAC/EE,EAAU7/B,KAAKqB,IAAIq+B,EAASE,GAE9B/a,EAAS,EACTib,EAAa,EACjB,GAAIP,EAAW,CACb,IAAMQ,EAAWd,EAAcz0B,QAAO,SAAC/R,EAAWxB,GAAiB,OAAK+I,KAAKqB,IAAI5I,EAAGxB,EAAE+oC,UAAU,GAAE,GAC5FC,EAAYf,EAAe10B,QAAO,SAAC/R,EAAWxB,GAAiB,OAAK+I,KAAKqB,IAAI5I,EAAGxB,EAAE+oC,UAAU,GAAE,GACpGnb,EAAS7kB,KAAKqB,IAAI0+B,EAAUE,EAC9B,KAAO,CAML,IAAMC,EAAK,GAAHpnC,OAAArE,EAAOwqC,GAAaxqC,EAAKyqC,IAC3BiB,EAAcD,EAAG11B,QAAO,SAAC0d,EAAajxB,GAAiB,OAAKixB,EAAMjxB,EAAE+oC,SAAS,GAAE,GAAKE,EAAG5vC,OAC7FwvC,EAAa,KAAQ,EAAIK,GACzBtb,EAAS7kB,KAAKoB,IAAI,GAAIpB,KAAKqB,IAAI49B,EAAc3uC,OAAQ4uC,EAAe5uC,SAAWwvC,CACjF,CAIA,IAAMM,EAAWjB,EAASta,EAEpB9U,EAAQ/P,KAAKqB,IAAe,KAAX++B,EADF,MAIfC,EAAeR,EAAUT,EACzBkB,EAAe,GAAM,GAAMtgC,KAAKugC,IAAItqB,GAAMoqB,EAAc,EAAG,MAAQrgC,KAAKugC,IAAI,KAG5E1e,EAAa,IAAIC,GAAO3B,EAAK,IAAIuB,GAAQ,EAAGzB,EAAOnc,MAAO,EAAGmc,EAAOlc,SAEtEw7B,EACFD,EAAe1P,EAAI,EAAGA,EAAI3P,EAAOlc,OAAQic,EAAMb,SAE/C0C,EAAWe,KAAK,IAAIlB,GAAQ,EAAG,EAAG,EAAG,IAAI,SAACvB,EAA+B0C,GACvE,IAAA3P,EAAiB,CAAC2P,EAAMjV,EAAE,GAAIiV,EAAMjV,EAAE,IAA/BmX,EAAE7R,EAAA,GAAE+R,EAAE/R,EAAA,GACbosB,EAAeE,EAASza,EAAIya,EAASva,EAAIjF,EAAMb,SAC/CmgB,EAAeG,EAAS1a,EAAI0a,EAASxa,EAAIjF,EAAMb,SAC/C,IAAMvR,EAAIiV,EAAMjV,EAAE,KAClBuS,EAAIqgB,UAAU1sB,EAAKgrB,QAASlP,EAAK,EAAGhiB,EAAG,GAAI,IAC3CkG,EAAKgP,gBAAgB,IACrB3C,EAAImD,SAAS,IAAKsM,EAAIhiB,EAAI,GAC5B,IAGF,IAAM6yB,EAAW,SAACC,EAAgBC,GAChC,GAAKA,SAAAA,EAAYrwC,OAAjB,CACA,IAAmE+/B,EAAA17B,EAA9C+rC,EAAQ,CAAC,EAAGlB,GAAW,CAACC,EAASxf,EAAOnc,OAAM,GAA5D8uB,EAAIvC,EAAA,GAAEwC,EAAIxC,EAAA,GACXuQ,EAAM,IAAI9e,GAAO3B,EAAK,IAAIuB,GAAQkR,EAAMC,EAAM5S,EAAOlc,QAAU,EAAIu8B,GAAergB,EAAOlc,SAChD88B,EAAAlsC,EAAhC+rC,EAAQ,EAAE3wB,EAAO,GAAK,CAAC,EAAGA,GAAM,GAAxC8F,EAACgrB,EAAA,GAAE55B,EAAC45B,EAAA,GACXD,EAAIhe,KAAK,IAAIlB,GAAQ7L,EAAG5O,EAAG,EAAG44B,IAAU,SAAC1f,EAA+B0C,GACtE1C,EAAIoD,UAAY,IAChBpD,EAAIqD,YAAckd,EAAQ1gB,EAAMT,QAAUS,EAAMV,SAChDa,EAAImC,UAAYoe,EAAQ1gB,EAAMP,QAAUO,EAAMR,SAC9CW,EAAI4D,YACJ,IAAM+c,EAAaJ,GAAS,EAAI,EAC1BlV,EAAUmV,EAAW,GACrB5b,EAAKlC,EAAMjV,EAAE,GACbmzB,EAASle,EAAM7M,GAAGupB,EAAY/T,EAAQwU,UAAYb,EAASW,GAAcgB,GAC/E3gB,EAAImK,OAAOyW,EAAQhc,GAEnB,IADA,IAAIic,EAAiB,EACZzwC,EAAI,EAAGA,EAAIowC,EAAWrwC,OAAQC,IAAK,CAC1C,IAAM0G,EAAI0pC,EAAWpwC,GAEf0wC,EAAO1B,EAAYtoC,EAAE+oC,UAAYb,GAAU5uC,EAAI,GAAKuvC,EACpD9pB,EAAI6M,EAAM7M,EAAEirB,EAAOH,GACzB3gB,EAAIoK,OAAOvU,EAAG6M,EAAMjV,EAAEozB,IACtBA,GAAkB/pC,EAAE0oC,KACpBxf,EAAIoK,OAAOvU,EAAG6M,EAAMjV,EAAEozB,GACxB,CACA,IAAME,EAAYR,GAAwB,GAAhBzgB,EAAOnc,MAA8B,IAAfmc,EAAOnc,MACvDqc,EAAIoK,OAAO2W,EAAWre,EAAMjV,EAAEozB,IAC9B7gB,EAAIsK,SACJtK,EAAIoK,OAAO2W,EAAWnc,GACtB5E,EAAIoK,OAAOwW,EAAQhc,GACnB5E,EAAIqK,YACJrK,EAAIuL,YAAc,IAClBvL,EAAI8D,MACN,IAAG,EAhC4B,CAiCjC,EAEAwc,GAAS,EAAOvB,GAChBuB,GAAS,EAAMxB,EAvGwB,CAFD,CA0GxC,KAACL,CAAA,CA3IyB,CAAS9e,IA8I9B,SAASqhB,GAAgB9M,EAAcrW,EAAgBC,GAC5D,MAAO,GAAPnlB,OAAUu7B,EAAI,KAAAv7B,OAAIklB,EAAM,KAAAllB,OAAImlB,EAC9B,CAEO,SAASmjB,GAAe/M,EAAcrW,EAAgBC,GAC3D,IAAM3lB,EAAI+oC,GAAchN,EAAMrW,EAAQC,GACtC,GAAI3lB,EAAG,OAAOA,EAAEkiC,MAClB,CAEO,SAAS6G,GAAehN,EAAcrW,EAAgBC,GAC3D,IAAMqjB,GAAYtpB,KAAM2iB,SAASC,MAAQ,IAAIv6B,QAAO,SAAC/H,GACnD,OAAOA,EAAEkiC,OAAOxc,SAAWA,GAAU1lB,EAAEkiC,OAAOvc,UAAYA,GAAW3lB,EAAEkiC,OAAOnG,OAASA,CACzF,IACA,GAAIiN,EAAShxC,OAAQ,OAAOgxC,EAAS,EACvC,CAMA,SAASC,GAAS5B,EAAc1oC,GAC9B,OAAO0oC,EAAO1oC,EAAE0oC,IAClB,CAYO,IAAM6B,GAAS,WAiDpB,SAAAA,EAAanoB,GAAgBzjB,EAAA,KAAA4rC,GAAA3qC,EAAA,mBAAAA,EAAA,oBAAAA,EAAA,sBAAAA,EAAA,0BAAAA,EAAA,0BAAAA,EAAA,yBAAAA,EAAA,mCAAAA,EAAA,6BAAAA,EAAA,6BAAAA,EAAA,yBAAAA,EAAA,uBAAAA,EAAA,2BAAAA,EAAA,2BAAAA,EAAA,0BAAAA,EAAA,oCAAAA,EAAA,8BAAAA,EAAA,8BAAAA,EAAA,0BAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,qBAAAA,EAAA,qBAAAA,EAAA,oBAAAA,EAAA,mBAAAA,EAAA,0BAAAA,EAAA,yBAAAA,EAAA,6BAAAA,EAAA,mBAAAA,EAAA,2BAAAA,EAAA,0BAAAA,EAAA,8BAAAA,EAAA,kBAjBlBA,EAAA,qBAAAA,EAAA,uBAAAA,EAAA,2BAAAA,EAAA,0BAAAA,EAAA,wBAAAA,EAAA,4BAAAA,EAAA,2BAAAA,EAAA,wBAAAA,EAAA,+BAAAA,EAAA,gCAAAA,EAAA,wBAAAA,EAAA,yBAAAA,EAAA,4BAAAA,EAAA,8BAAAA,EAAA,+BAkBT,IAAMw9B,EAAOtnC,KAAKsnC,KAAOhb,EAAIgb,KACvBrW,EAASjxB,KAAKixB,OAAS3E,EAAI2E,OAC3BC,EAAUlxB,KAAKkxB,QAAU5E,EAAI4E,QACnClxB,KAAKguC,QAAU1hB,EAAI0hB,QACnB,IAAMzgC,EAAS0d,KAAM2iB,SAASC,KAAK6G,MAAK,SAAAC,GAAA,IAAWzU,EAACyU,EAATlH,OAAM,OAAuBvN,EAAEjP,SAAWA,GAAUiP,EAAEhP,UAAYA,GAAWgP,EAAEoH,OAASA,CAAI,IACvI,IAAK/5B,EAAQ,MAAM/L,MAAM,2BACzBxB,KAAKssB,IAAM/e,EAAOkgC,OAElB,IAAAmH,EAAgE3pB,KAAMoW,OAAOpQ,GAA9Dsf,EAASqE,EAAhB5I,MAA0BsE,EAAUsE,EAAlBj2B,OAA8BnD,EAAGo5B,EAAblgC,SAC9C1U,KAAKswC,WAAaA,EAClBtwC,KAAK60C,WAAar5B,EAAI7G,aAAamI,KACnC9c,KAAKwb,IAAMA,EACXxb,KAAK80C,WAAat5B,EAAI7G,aAAaC,iBACnC5U,KAAKuwC,UAAYA,EACjB,IAAMwE,EAAY/0C,KAAK+0C,UAAYxE,EAAYA,EAAUtE,SAAWhb,EACpE+jB,EAA2E/pB,KAAMoW,OAAOrhC,KAAK+0C,WAA3ErE,EAASsE,EAAnBtgC,SAA6Bk8B,EAAaoE,EAArBr2B,OAA+Bs2B,EAAUD,EAAlB5vB,OAEpDplB,KAAKk1C,qBADsB,MACCD,EAAWE,QAA+B,EACtEn1C,KAAK0wC,UAAYA,EACjB1wC,KAAKo1C,cAAgB1E,EAAU/7B,aAAamI,KAC5C9c,KAAK4wC,cAAgBA,EACrB5wC,KAAKq1C,cAAgBr1C,KAAK0wC,UAAU/7B,aAAaC,iBAEjD,IAAA0gC,EAAkErqB,KAAMoW,OAAOnQ,GAAhE8f,EAAUsE,EAAjBtJ,MAA2B+E,EAAWuE,EAAnB32B,OAA+BlD,EAAG65B,EAAb5gC,SAChD1U,KAAK+wC,YAAcA,EACnB/wC,KAAKu1C,YAAc95B,EAAI9G,aAAamI,KACpC9c,KAAKyb,IAAMA,EACXzb,KAAKw1C,YAAc/5B,EAAI9G,aAAaC,iBACpC5U,KAAKgxC,WAAaA,EAClB,IAAMyE,EAAaz1C,KAAKy1C,WAAazE,EAAaA,EAAW/E,SAAW/a,EACxEwkB,EAA8EzqB,KAAMoW,OAAOrhC,KAAKy1C,YAA9EvE,EAAUwE,EAApBhhC,SAA8B08B,EAAcsE,EAAtB/2B,OAAgCg3B,EAAWD,EAAnBtwB,OACtDplB,KAAK41C,sBAfsB,MAeED,EAAYR,QAA+B,EACxEn1C,KAAKkxC,WAAaA,EAClBlxC,KAAK61C,eAAiB3E,EAAWv8B,aAAamI,KAC9C9c,KAAKoxC,eAAiBA,EACtBpxC,KAAK81C,eAAiB91C,KAAKkxC,WAAWv8B,aAAaC,iBAEnD5U,KAAKiV,GAAKm/B,GAAe9M,EAAMrW,EAAQC,GACvClxB,KAAK+1C,MAAQ,GAAHhqC,OAAMukC,EAAU,KAAAvkC,OAAIglC,GAE9B,IACAiF,EADoB/qB,KAAMuc,UAAUF,GAA5B2O,QACiDj2C,KAAK+1C,OAA7Cvc,EAAOwc,EAAhB3M,QAA4BvI,EAAQkV,EAAlBhV,SAC1BhhC,KAAKw5B,QAAUA,EACfx5B,KAAKk2C,YAAc1c,EAAUhe,EAAI7G,aAAaC,iBAC9C5U,KAAK8gC,SAAWA,EAChB9gC,KAAKm2C,SAAW3E,GAAkBhY,EAASvI,EAAQC,GACnDlxB,KAAKo2C,aAAep2C,KAAKm2C,SAAW16B,EAAI9G,aAAaC,iBAErD5U,KAAKq2C,gBAAkBprB,KAAMymB,aAAaqD,GAC1C/0C,KAAKs2C,iBAAmBrrB,KAAMymB,aAAa+D,GAEvCnpB,EAAIiqB,uBACNv2C,KAAKsyC,QAAU3F,GACf3sC,KAAKw2C,SAAWlqB,EAAIiqB,sBAAsBpE,eAAe10B,OAAO+2B,GAAS,GACzEx0C,KAAKy2C,UAAYnqB,EAAIiqB,sBAAsBrE,cAAcz0B,OAAO+2B,GAAS,GACzEx0C,KAAK02C,eAAiBpqB,EAAIiqB,sBAAsBrE,cAAc3uC,OAC9DvD,KAAK22C,gBAAkBrqB,EAAIiqB,sBAAsBpE,eAAe5uC,QACvD+oB,EAAIsqB,iBACb52C,KAAKsyC,QAAU1F,GACf5sC,KAAKw2C,SAAWlqB,EAAIuqB,SAASC,cAC7B92C,KAAKy2C,UAAYnqB,EAAIuqB,SAASC,eACrBxqB,EAAIyqB,0BACb/2C,KAAKsyC,QAAU5F,GACf1sC,KAAKw2C,SAAWlqB,EAAIyqB,wBAAwB5E,eAAe10B,OAAO+2B,GAAS,GAC3Ex0C,KAAKy2C,UAAYnqB,EAAIyqB,wBAAwB7E,cAAcz0B,OAAO+2B,GAAS,GAC3Ex0C,KAAK02C,eAAiBpqB,EAAIyqB,wBAAwB7E,cAAc3uC,OAChEvD,KAAK22C,gBAAkBrqB,EAAIyqB,wBAAwB5E,eAAe5uC,OAEtE,CAAC,IAAAyzC,EA+QA,OA/QArtC,EAAA8qC,EAAA,EAAA92C,IAAA,aAAAE,OAAAm5C,EAAAvuC,EAAAzL,IAAAA,MAED,SAAAi6C,IAAA,IAAA3P,EAAArW,EAAAC,EAAAglB,EAAAE,EAAAhtC,EAAA8Q,EAAA,OAAAld,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,OAC0D,OAAhDglC,EAAqDtnC,KAArDsnC,KAAMrW,EAA+CjxB,KAA/CixB,OAAQC,EAAuClxB,KAAvCkxB,QAASglB,EAA8Bl2C,KAA9Bk2C,YAAaE,EAAiBp2C,KAAjBo2C,aAAYc,EAAA50C,KAAA,EACtCyqC,GAAGxhB,OAAO+b,EAAMrW,EAAQC,GAAQ,OAA5C9nB,EAAG8tC,EAAAp1C,KACHoY,EAAIla,KAAKm3C,aAAe/tC,EAAImiB,OAClCvrB,KAAKo3C,WAAalB,EAAch8B,EAAEm4B,aAClCryC,KAAKq3C,YAAcjB,EAAel8B,EAAEo9B,cACpCt3C,KAAKu3C,KAAOv3C,KAAKw3C,uBAAsB,wBAAAN,EAAAlyC,OAAA,GAAAiyC,EAAA,UACxC,kBAAAD,EAAApuC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,MAED,WACE,IAAQozB,EAAoBjxB,KAApBixB,OAAQC,EAAYlxB,KAAZkxB,QACV4c,EAAY7iB,KAAM2iB,SAASC,KAAK6G,MAAK,SAACnpC,GAAc,OAAKA,EAAEkiC,OAAOxc,SAAWA,GAAU1lB,EAAEkiC,OAAOvc,UAAYA,CAAO,IACzH,OAAK4c,EAEE,CAAE2J,OAD+D3J,EAAhEL,OACSnoB,QADuDwoB,EAAhDxoB,QACEyoB,SAD8CD,EAAvCC,SACG2J,YADoC5J,EAA7B4J,YACMC,YADuB7J,EAAhB6J,aADjC,CAAEF,OAAQ,CAAC,EAAgBnyB,SAAS,EAAOyoB,SAAU,CAAC,EAG/E,GAEA,CAAApwC,IAAA,mBAAAE,MAIA,WACE,IAYI+5C,EACAC,EAZF5mB,EAEEjxB,KAFFixB,OAAQC,EAENlxB,KAFMkxB,QAAS6jB,EAEf/0C,KAFe+0C,UAAWU,EAE1Bz1C,KAF0By1C,WAAYzH,EAEtChuC,KAFsCguC,QACxC8G,EACE90C,KADF80C,WAAYU,EACVx1C,KADUw1C,YAAaH,EACvBr1C,KADuBq1C,cAAeS,EACtC91C,KADsC81C,eAE1CgC,EAAkC,CAAC7sB,KAAM8sB,UAAU9mB,GAAShG,KAAM8sB,UAAU7mB,IAArE+jB,EAAU6C,EAAA,GAAEnC,EAAWmC,EAAA,GAC9BE,EAAqB,CAAC1J,GAAoBrd,GAASqd,GAAoBpd,IAAhE+mB,EAAID,EAAA,GAAEE,EAAIF,EAAA,GAKbG,EAAe,EACfC,EAAgB,EAGpB,GAAIpK,EAAS,CACX,IAAM6B,EAAM5kB,KAAM2iB,SAASyK,MAAMrK,GACjC,IAAK6B,EAAK,MAAMruC,MAAM,2BACtBo2C,EAAiB/H,EAAIyI,SAASrnB,GAC9B4mB,EAAkBhI,EAAIyI,SAASpnB,EACjC,CACI0mB,IAAgBO,GAAgBP,EAAe5H,WAAa,GAAKiI,EAAKpI,IAAIE,OAC1E8H,IAAiBO,GAAiBP,EAAgB7H,WAAa,GAAKkI,EAAKrI,IAAIE,OACjF,IAAOwI,EAAgCtD,EAAWuD,QAAQxI,UAAYiI,EAAK/H,IAAIH,MAA1D0I,EAAiE9C,EAAY6C,QAAQxI,UAAYkI,EAAKhI,IAAIH,MACzH2I,EAAYH,EAAeJ,EAC3BQ,EAAaF,EAAgBL,EAC7BQ,EAAgB7D,IAAc9jB,EAASgkB,EAAahqB,KAAM8sB,UAAUhD,GACpE8D,EAAiBpD,IAAevkB,EAAUykB,EAAc1qB,KAAM8sB,UAAUtC,GAEzEqD,EAAmDJ,EAArCK,EAAgDR,EAA/BS,EAA6Cb,EACjF,GAAIpD,IAAc9jB,EAAQ,CACxB,IAAMgoB,EAAU3K,GAAoBrd,GACpC8nB,EAAkBH,EAAcJ,QAAQxI,UAAYiJ,EAAQ/I,IAAID,MAC5D2H,IAAgBoB,GAAmBpB,EAAe5H,WAAa,GAAKiJ,EAAQpJ,IAAII,OACpF6I,EAAeC,EAAkBC,CACnC,CACA,IAAKE,EAAsDP,EAAvCQ,EAAmDV,EAAjCW,EAAgDhB,EACtF,GAAI3C,IAAevkB,EAAS,CAC1B,IAAMmoB,EAAU/K,GAAoBpd,GACpCioB,EAAmBN,EAAeL,QAAQxI,UAAYqJ,EAAQnJ,IAAID,MAC9D4H,IAAiBuB,GAAoBvB,EAAgB7H,WAAa,GAAKqJ,EAAQxJ,IAAII,OACvFiJ,EAAgBC,EAAmBC,CACrC,CACA,MAAO,CACLV,UAAWA,EAAY5D,EACvB6D,WAAYA,EAAanD,EACzB+C,aAAcA,EAAezD,EAC7B2D,cAAeA,EAAgBjD,EAC/B2C,aAAcA,EAAerD,EAC7BsD,cAAeA,EAAgB5C,EAC/BsD,aAAcA,EAAezD,EAC7B6D,cAAeA,EAAgBpD,EAC/BiD,gBAAiBA,EAAkB1D,EACnC8D,iBAAkBA,EAAmBrD,EACrCkD,gBAAiBA,EAAkB3D,EACnC+D,iBAAkBA,EAAmBtD,EAEzC,GAEA,CAAAn4C,IAAA,gBAAAE,MAMA,WACE,IACEozB,EAGEjxB,KAHFixB,OAAQC,EAGNlxB,KAHMkxB,QAAOooB,EAGbt5C,KAHem3C,aAAgBoC,EAAQD,EAARC,SAAUC,EAASF,EAATE,UAAahgB,EAGtDx5B,KAHsDw5B,QACxDgd,EAEEx2C,KAFFw2C,SAAUC,EAERz2C,KAFQy2C,UAAW1B,EAEnB/0C,KAFmB+0C,UAAWU,EAE9Bz1C,KAF8By1C,WAAYP,EAE1Cl1C,KAF0Ck1C,oBAAqBU,EAE/D51C,KAF+D41C,qBAAoB6D,EAEnFz5C,KADFssB,IAAOuqB,SAAY6C,EAAUD,EAAVC,WAAYC,EAAWF,EAAXE,YAGjC,OAAOC,GACL3oB,EAAQC,EAASqoB,EAAUC,EAAWhgB,EAASgd,EAAUC,EACzD1B,EAAWU,EAAYP,EAAqBU,EAC5C8D,EAAWG,oBAAqBF,EAAYE,oBAEhD,GAEA,CAAAl8C,IAAA,uBAAAE,MAIA,WACE,IAAAi8C,EAKI95C,KAJFssB,IAAOuqB,SAAY8C,EAAWG,EAAXH,YAAaD,EAAUI,EAAVJ,WAChC5E,EAGE90C,KAHF80C,WAAYU,EAGVx1C,KAHUw1C,YAAavkB,EAGvBjxB,KAHuBixB,OAAQC,EAG/BlxB,KAH+BkxB,QAASglB,EAGxCl2C,KAHwCk2C,YAAaE,EAGrDp2C,KAHqDo2C,aACvDf,EAEEr1C,KAFFq1C,cAAeS,EAEb91C,KAFa81C,eAAgBf,EAE7B/0C,KAF6B+0C,UAAWU,EAExCz1C,KAFwCy1C,WAAYlF,EAEpDvwC,KAFoDuwC,UACtDS,EACEhxC,KADFgxC,WAAYhD,EACVhuC,KADUguC,QAEd+L,EAAyB/5C,KAAK45C,gBAAtBI,EAAMD,EAANC,OAAQC,EAAIF,EAAJE,KAEVC,EA5OD,CAAE9gB,KAAM,EAAG+gB,YAAa,EAAGC,gBAAiB,EAAGvK,IAAK,EAAGwK,cAAe,EAAGC,eAAgB,GA6OxFC,EA7OD,CAAEnhB,KAAM,EAAG+gB,YAAa,EAAGC,gBAAiB,EAAGvK,IAAK,EAAGwK,cAAe,EAAGC,eAAgB,GA+O9FJ,EAAM9gB,KAAO4gB,EAAO9J,IAAI1e,KAAKohB,KAAOsD,EACpCqE,EAAMnhB,KAAO4gB,EAAOnK,IAAIre,KAAKohB,KAAOwD,EAEpC8D,EAAMG,cAAgBpnC,KAAKqB,IAAI0lC,EAAOnK,IAAIre,KAAKhtB,IAAKw1C,EAAO9J,IAAI1e,KAAKhtB,KAAOk1C,EAAWG,oBAAsB/E,EAC5GyF,EAAMF,cAAgBpnC,KAAKqB,IAAI0lC,EAAOnK,IAAI2K,MAAMh2C,IAAKw1C,EAAO9J,IAAIsK,MAAMh2C,KAAOm1C,EAAYE,oBAAsBrE,EAE3GxH,IACFkM,EAAMrK,IAAMmK,EAAOnK,IAAIre,KAAKohB,KAAOsD,EACnCqE,EAAM1K,IAAMmK,EAAOnK,IAAI2K,MAAM5H,KAAOwD,GAGtC8D,EAAMC,YAAcF,EAAKzoB,KAAK2oB,YAAc9E,EAC5CkF,EAAMJ,YAAcF,EAAKO,MAAML,YAAcrE,EAEzCvF,IAAW2J,EAAME,gBAAkBH,EAAKzoB,KAAKipB,iBAAmBf,EAAWgB,SAAWrF,GACtFrE,IAAYuJ,EAAMH,gBAAkBH,EAAKO,MAAMC,iBAAmBd,EAAYe,SAAW5E,GAC7FyE,EAAMD,gBAAkBC,EAAMnhB,KAAOmhB,EAAM1K,IAAM0K,EAAMF,eAAiBV,EAAYgB,qBAEpF,IAAMC,EAAgC,CAAC,EACjCC,EAAW,SAAC98B,EAAiB+8B,GAAgB,IAAAC,EAAEH,EAAM78B,IAA0B,QAAfg9B,EAACH,EAAM78B,UAAQ,IAAAg9B,EAAAA,EAAI,GAAKD,CAAI,EAMlG,OALAD,EAAS5pB,EAAQhe,KAAKC,OAAOgnC,EAAM9gB,KAAO8gB,EAAMrK,IAAMqK,EAAMG,eAAiBvF,IAC7E+F,EAAS9F,EAAW9hC,KAAKC,OAAOgnC,EAAMC,YAAcD,EAAME,iBAAmB/E,IAC7EwF,EAAS3pB,EAASje,KAAKC,OAAOqnC,EAAMnhB,KAAOmhB,EAAM1K,IAAM0K,EAAMF,cAAgBE,EAAMD,gBAAkB9E,IACrGqF,EAASpF,EAAYxiC,KAAKC,OAAOqnC,EAAMJ,YAAcI,EAAMH,iBAAmBtE,IAEvE,CAAEyE,MAAAA,EAAOL,MAAAA,EAAOU,MAAAA,EACzB,GAEA,CAAAj9C,IAAA,eAAAE,MAKA,WACE,IAAAm9C,EAGIh7C,KAFFu3C,KAAQ2C,EAAKc,EAALd,MAAOK,EAAKS,EAALT,MAAStpB,EAEtBjxB,KAFsBixB,OAAQC,EAE9BlxB,KAF8BkxB,QAAS6jB,EAEvC/0C,KAFuC+0C,UAAWU,EAElDz1C,KAFkDy1C,WACjCwF,EACjBj7C,KADFssB,IAAOuqB,SAAYoE,aAAkBjN,EACnChuC,KADmCguC,QAEvCkN,EAGIl7C,KAAKm7C,mBAFPzC,EAASwC,EAATxC,UAAWC,EAAUuC,EAAVvC,WAAYJ,EAAY2C,EAAZ3C,aAAcE,EAAayC,EAAbzC,cAAeN,EAAY+C,EAAZ/C,aAAcC,EAAa8C,EAAb9C,cAClEW,EAAemC,EAAfnC,gBAAiBI,EAAgB+B,EAAhB/B,iBAGbiC,EAAeptB,QAAQggB,GAAWiN,GAWlCI,EAAkBnB,EAAMrK,IAC9ByL,EAA8D,CAACpB,EAAM9gB,KAAM,EAAG,GAAzEmiB,EAAeD,EAAA,GAAEE,EAAqBF,EAAA,GAAEG,EAAaH,EAAA,GAEtDrqB,IAAW8jB,EAAWwG,GAAmBrB,EAAMC,YAE9CsB,GAAiBvB,EAAMC,YAAcD,EAAME,gBAE5CgB,EAAcI,GAAyBtB,EAAMG,cAE5CkB,GAAmBrB,EAAMG,cAG1BppB,IAAWwkB,IACT2F,EAAcI,GAAyBjB,EAAMJ,YAAcI,EAAMH,gBAChEmB,GAAmBhB,EAAMJ,YAAcI,EAAMH,iBAGpD,IAAAsB,EAAmF,CAACnB,EAAMnhB,KAAMmhB,EAAM1K,IAAK,EAAG,GAAzG8L,EAAgBD,EAAA,GAAEE,EAAgBF,EAAA,GAAEG,EAAsBH,EAAA,GAAEI,EAAcJ,EAAA,GAG/E,GAFIxqB,IAAYukB,EAAYkG,GAAoBpB,EAAMJ,YACjD2B,GAAkBvB,EAAMJ,YAAcI,EAAMH,gBAC7CgB,EAAcS,GAA0BtB,EAAMF,cAAgBE,EAAMD,mBACnE,CAEHqB,GAAoBpB,EAAMF,cAC1B,IAAM0B,EAAQxB,EAAMnhB,KAAOmhB,EAAM1K,IAAM0K,EAAMF,cAC7CsB,IAAqBpB,EAAMnhB,KAAOmhB,EAAMF,eAAiB0B,EAAQxB,EAAMD,eACvEsB,GAAoBrB,EAAM1K,IAAMkM,EAAQxB,EAAMD,cAChD,CACIppB,IAAY6jB,IACVqG,EAAcS,GAA0B3B,EAAMC,YAAcD,EAAME,gBACjEuB,GAAoBzB,EAAMC,YAAcD,EAAME,iBAGrD,IAAM4B,EAAgBzD,GAAgBgD,EAChCU,EAAgB9D,GAAgBkD,EAChCa,EAAiBzD,GAAiBkD,EAClCQ,EAAiB/D,GAAiBwD,EAClCQ,EAAeb,EAAkBF,EAAkBG,EACnDa,EAAgBV,EAAmBC,EAAmBC,EACtDS,EAAwBN,GAAiBC,GAAiBvD,GAAa0D,EACvEG,EAAyBL,GAAkBC,GAAkBxD,GAAc0D,EAC3EG,EAAiBzD,GAAmB0C,EACpCgB,EAAkBtD,GAAoB2C,EAEtCY,EAAoBJ,GAAyBC,GAA0BC,GAAkBC,EAG3FE,GAAwBD,EAO5B,OANKA,IAGHC,EAFqBjE,GAAa0D,GAAgBzD,GAAc0D,GAC7CG,GAAkBC,GACgBrB,GAGhD,CACL5pB,KAAM,CACJ0e,IAAK,CACHH,MAAOwI,EACPqE,IAAKrB,EACLsB,OAAQb,GAEVnM,IAAK,CACHE,MAAOoI,EACPyE,IAAKvB,EACLwB,OAAQZ,GAEVa,aAActB,EACdvB,KAAM,CACJlK,MAAOgJ,EACP6D,IAAKnB,EACLoB,OAAQL,GAEVE,kBAAmBJ,EACnBK,sBAAuBL,GAAyB5D,GAAa0D,GAAgBhB,GAE/EZ,MAAO,CACLtK,IAAK,CACHH,MAAO0I,EACPmE,IAAKjB,EACLkB,OAAQX,GAEVrM,IAAK,CACHE,MAAOqI,EACPwE,IAAKhB,EACLiB,OAAQV,GAEVW,aAAcjB,EACd5B,KAAM,CACJlK,MAAOoJ,EACPyD,IAAKd,EACLe,OAAQJ,GAEVC,kBAAmBH,EACnBI,sBAAuBJ,GAA0B5D,GAAc0D,GAAiBjB,GAElFsB,kBAAAA,EACAC,qBAAAA,EACAI,SAAUL,IAAsBC,EAEpC,KAAClI,CAAA,CArYmB,GA+YTuI,GAAyB,WAiBpC,SAAAA,EAAa7V,EAAkB8V,EAAcC,EAAoC/xB,GAAc,IAAAvD,EAAA,KAAA/e,EAAA,KAAAm0C,GAAAlzC,EAAA,mBAAAA,EAAA,oBAAAA,EAAA,mBAAAA,EAAA,yBAAAA,EAAA,sBAAAA,EAAA,2BAAAA,EAAA,qBAAAA,EAAA,2BAAAA,EAAA,2BAAAA,EAAA,iCAAAA,EAAA,+BAAAA,EAAA,4CAAAA,EAAA,kCAAAA,EAAA,gCAAAA,EAAA,mCAC7F9J,KAAKmnC,IAAMA,EACXnnC,KAAKmrB,KAAOtW,GAAI6W,cAAcyb,GAC9BnnC,KAAKm9C,kBAAoBD,EAASE,gBAClCp9C,KAAKo9C,gBAAkBvoC,GAAIwoC,cAAcH,EAASE,iBAClDp9C,KAAKs9C,mBAAqBJ,EAASI,mBACnCt9C,KAAKu9C,iBAAmBL,EAASK,iBACjCv9C,KAAKw9C,oBAAsBN,EAASM,oBACpC3oC,GAAIuyB,eAAepnC,KAAKs9C,mBAAoBt9C,KAAKu9C,iBAAkBv9C,KAAKw9C,qBACxEx9C,KAAKi9C,MAAQA,EACbpoC,GAAI1K,KAAKnK,KAAKmrB,KAAKsyB,SAAU,SAAS,kBAAM71B,EAAK5iB,MAAM,IACvD6P,GAAI1K,KAAKnK,KAAKmrB,KAAKuyB,YAAa,SAAS,WACvC,IAAAC,EAAsD/1B,EAA9CohB,IAAO/X,EAAM0sB,EAAN1sB,OAAQC,EAAOysB,EAAPzsB,QAASoW,EAAIqW,EAAJrW,KAAQoG,EAAc9lB,EAAd8lB,UACxCziB,KAAM2yB,SAAS,SAAU,CAAE3sB,OAAAA,EAAQC,QAAAA,EAASoW,KAAAA,EAAMoG,UAAAA,EAAWmQ,WAAY1yB,GAC3E,IACAtW,GAAI1K,KAAKnK,KAAKmrB,KAAK2yB,cAAe,SAAS,kBAAMl2B,EAAKm2B,gBAAgB,OAAO,IAC7ElpC,GAAI1K,KAAKnK,KAAKmrB,KAAK6yB,eAAgB,SAAS,kBAAMp2B,EAAKm2B,gBAAgB,QAAQ,GACjF,CAeC,IAAAE,EARAC,EAPAC,EAyYA,OAzYAx0C,EAAAqzC,EAAA,EAAAr/C,IAAA,OAAAE,OAAAsgD,EAAA11C,EAAAzL,IAAAA,MAED,SAAAohD,IAAA,IAAAjzB,EAAAkzB,EAAA/W,EAAArW,EAAAC,EAAAotB,EAAA,OAAAthD,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,OAE6C,OADnC6oB,EAAyCnrB,KAAzCmrB,KAAIkzB,EAAqCr+C,KAAnCgpC,IAAO1B,EAAI+W,EAAJ/W,KAAMrW,EAAMotB,EAANptB,OAAQC,EAAOmtB,EAAPntB,QAC7BotB,EAASrzB,KAAMuzB,QAAQrzB,EAAKsyB,UAASc,EAAAj8C,KAAA,EACrCyqC,GAAG0R,QAAQ,CAAEnX,KAAAA,EAAMrW,OAAQA,EAAQC,QAASA,IAAU,OAC5DotB,IAAQ,wBAAAC,EAAAv5C,OAAA,GAAAo5C,EAAA,UACT,kBAAAD,EAAAv1C,MAAA,KAAAD,UAAA,KAAAhL,IAAA,YAAAE,OAAAqgD,EAAAz1C,EAAAzL,IAAAA,MAED,SAAA0hD,EAAiBpX,EAAcrW,EAAgBC,GAAe,IAAA4c,EAAA9E,EAAA,OAAAhsC,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,OAC+E,GAArIwrC,EAAY7iB,KAAM2iB,SAASC,KAAK6G,MAAK,SAAAkK,GAAA,IAAW1e,EAAC0e,EAATnR,OAAM,OAAuBvN,EAAEjP,SAAWA,GAAUiP,EAAEhP,UAAYA,GAAWgP,EAAEoH,OAASA,CAAI,IAC1H,CAAFqX,EAAAr8C,KAAA,eAAAq8C,EAAA18C,OAAA,iBAC6B,OAArC+mC,EAAM,IAAIyL,GAAU3G,EAAUL,QAAOkR,EAAAr8C,KAAA,EACrC0mC,EAAI6V,aAAY,OACtB7+C,KAAK8+C,aAAa9V,GAAI,wBAAA2V,EAAA35C,OAAA,GAAA05C,EAAA,UACvB,SAAAK,EAAAC,EAAAC,GAAA,OAAAf,EAAAt1C,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,OAAAogD,EAAAx1C,EAAAzL,IAAAA,MAED,SAAAkiD,EAAoBlW,GAAc,IAAAmW,EAAAC,EAAAC,EAAAC,EAAAC,EAAAp0B,EAAAgc,EAAAqY,EAAAlY,EAAArW,EAAAC,EAAA6jB,EAAAU,EAAAzH,EAAA4C,EAAAQ,EAAAgE,EAAAS,EAAAvpB,EAAAwoB,EAAAU,EAAAiK,EAAAC,EAAAzM,EAAAla,EAAAC,EAAA,OAAAh8B,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,OAChCtC,KAAKgpC,IAAMA,EAET7d,EAIEnrB,KAJFmrB,KAAMgc,EAIJnnC,KAJImnC,IAAGqY,EAIPx/C,KAJSgpC,IACT1B,EAAIkY,EAAJlY,KAAMrW,EAAMuuB,EAANvuB,OAAQC,EAAOsuB,EAAPtuB,QAAS6jB,EAASyK,EAATzK,UAAWU,EAAU+J,EAAV/J,WAAYzH,EAAOwR,EAAPxR,QAAS4C,EAAa4O,EAAb5O,cACvDQ,EAAcoO,EAAdpO,eAAgBgE,EAAaoK,EAAbpK,cAAeS,EAAc2J,EAAd3J,eAAgBvpB,EAAGkzB,EAAHlzB,IAAKwoB,EAAU0K,EAAV1K,WAAYU,EAAWgK,EAAXhK,YAGpErF,GAAkBhJ,EAAKlW,EAAQC,EAASoW,GACxCzyB,GAAIqf,OAAO6gB,IAAc9jB,EAAQ9F,EAAKy0B,oBACtC/qC,GAAIqf,OAAOuhB,IAAevkB,EAAS/F,EAAK00B,qBACxChrC,GAAIqf,OAAMtrB,MAAViM,GAAG,CAAQmZ,QAAQggB,IAAQjiC,OAAArE,EAAKmN,GAAImG,cAAcmsB,EAAK,sBACvDhc,EAAK20B,YAAYrgC,IAAM5K,GAAImK,SAAS4xB,GACpCzlB,EAAKiqB,cAAc/1B,YAAc+1B,EACjCjqB,EAAK40B,aAAatgC,IAAM5K,GAAImK,SAASoyB,GACrCjmB,EAAK0qB,eAAex2B,YAAcw2B,EAE5B4J,EAAWnzB,EAAIyqB,wBACf2I,EAAmC,QAAxBP,EAAGM,aAAQ,EAARA,EAAUC,mBAAW,IAAAP,EAAAA,EAAI3S,GACzCyG,EAAmF,QAA1EmM,EAAoC,QAApCC,EAA4B,QAA5BC,EAAGhzB,EAAIiqB,6BAAqB,IAAA+I,OAAA,EAAzBA,EAA2BlN,cAAM,IAAAiN,EAAAA,EAAuB,QAAvBE,EAAIjzB,EAAIsqB,uBAAe,IAAA2I,OAAA,EAAnBA,EAAqBS,qBAAa,IAAAZ,EAAAA,EAAI,EACvFK,IACI1mB,EAAOrxB,EAAI+3C,EAASvN,eAAezX,MAAK,SAAC9zB,EAAmByT,GAAiB,OAAKzT,EAAEssC,UAAY74B,EAAE64B,SAAS,IAC3Gja,EAAQtxB,EAAI+3C,EAAStN,gBAAgB1X,MAAK,SAAC9zB,EAAmByT,GAAiB,OAAKzT,EAAEssC,UAAY74B,EAAE64B,SAAS,IAG/GA,EAFAla,EAAKx1B,OAAS,EACZy1B,EAAMz1B,OAAS,GACJw1B,EAAK,GAAGka,UAAYja,EAAM,GAAGia,WAAa,EAE3Cla,EAAK,GAAGka,UAELja,EAAM,GAAGia,WAE9Bp+B,GAAI2E,KAAK2R,EAAK80B,YAAa90B,EAAK+0B,SAAU/0B,EAAKg1B,gBAAiBh1B,EAAKi1B,WAAYj1B,EAAKk1B,QAASl1B,EAAKm1B,gBAAeX,EAAAjyC,GAC3GgyC,EAAWC,EAAAr9C,KAAAq9C,EAAAjyC,KACZ8+B,IAAkBmT,EAAAjyC,KAClB++B,GADkB,GACIkT,EAAAjyC,KAItB2+B,GAAqB,oBAFiC,OADzDx3B,GAAIyE,KAAK6R,EAAK80B,YAAa90B,EAAKi1B,YAChCj1B,EAAK8nB,UAAU5zB,aAA2B,IAAZ4zB,GAAiBvtB,QAAQ,GAAEi6B,EAAA19C,OAAA,oBAIA,OADzD4S,GAAIyE,KAAK6R,EAAKg1B,gBAAiBh1B,EAAKm1B,gBACpCn1B,EAAK8nB,UAAU5zB,aAA2B,IAAZ4zB,GAAiBvtB,QAAQ,GAAEi6B,EAAA19C,OAAA,oBAGzDkpB,EAAK8nB,UAAU5zB,YAAcxK,GAAIiJ,kBAAkBm1B,EAAYrB,GAA+BkD,EAAaU,GAAY,QAG3Hx1C,KAAKugD,SACLvgD,KAAKwgD,WAAU,yBAAAb,EAAA36C,OAAA,GAAAk6C,EAAA,UAChB,SAAAuB,GAAA,OAAAxC,EAAAr1C,MAAA,KAAAD,UAAA,KAAAhL,IAAA,oBAAAE,MAED,SAAmB2I,GACjB,GAAKxG,KAAKgpC,IAAV,CACA,IAAA0X,EAAmD1gD,KAAKgpC,IAAhD/X,EAAMyvB,EAANzvB,OAAQC,EAAOwvB,EAAPxvB,QAAS6jB,EAAS2L,EAAT3L,UAAWU,EAAUiL,EAAVjL,WAChCjvC,EAAEuX,UAAYkT,GAAUzqB,EAAEuX,UAAYg3B,GAAavuC,EAAEuX,UAAYmT,GAAW1qB,EAAEuX,UAAY03B,GAC9Fz1C,KAAKugD,QAHgB,CAIvB,GAAC,CAAA5iD,IAAA,wBAAAE,MAED,SAAuB2I,GACrB,GAAKxG,KAAKgpC,IAAV,CACA,IAAA2X,EAAkC3gD,KAAKgpC,IAA/B/X,EAAM0vB,EAAN1vB,OAAQC,EAAOyvB,EAAPzvB,QAASoW,EAAIqZ,EAAJrZ,KACzB,GAAI9gC,EAAEyqB,SAAWA,GAAUzqB,EAAE0qB,UAAYA,GAAW1qB,EAAE8gC,OAASA,GAC1D9gC,EAAE+kB,OAAP,CAEA,GADAvrB,KAAK03C,YAAclxC,EAAE+kB,OACjBvrB,KAAKi9C,MAAM2D,cAAgB5gD,KAAKm9C,mBAAqBn9C,KAAKi9C,MAAM4D,gBAAkB7gD,KAAKgpC,IAAI/zB,GAAI,CACjG,IAAM6rC,EAAoD,SAAtC9gD,KAAK+gD,6BAA0Cv6C,EAAE+kB,OAAOy1B,WAAax6C,EAAE+kB,OAAO01B,YAC9FH,EAAa9gD,KAAKkhD,kBAAkBJ,EAAa9gD,KAAK+gD,6BAA8Bv6C,EAAE+kB,OAAO41B,UAC5FnhD,KAAKi9C,MAAMmE,OAClB,CACAphD,KAAKugD,QAPgB,CAHA,CAWvB,GAAC,CAAA5iD,IAAA,wBAAAE,MAED,SAAuB2I,GACrB,GAAKxG,KAAKgpC,IAAV,CACA,IAAAqY,EAAkCrhD,KAAKgpC,IAA/B/X,EAAMowB,EAANpwB,OAAQC,EAAOmwB,EAAPnwB,QAASoW,EAAI+Z,EAAJ/Z,KACrB9gC,EAAEyqB,SAAWA,GAAUzqB,EAAE0qB,UAAYA,GAAW1qB,EAAE8gC,OAASA,IAC/DtnC,KAAK23C,YAAcnxC,EAAE86C,SACrBthD,KAAKugD,SAJgB,CAKvB,GAAC,CAAA5iD,IAAA,YAAAE,MAED,WACEmC,KAAKmrB,KAAKo2B,QAAQliC,YAAcxK,GAAI2sC,SAASxhD,KAAK0tC,UACpD,GAAC,CAAA/vC,IAAA,SAAAE,MAED,WAAU,IAAA4jD,EAAAC,EAAAC,EAAAx5B,EAAA,KAENgf,EAIEnnC,KAJFmnC,IAAKhc,EAIHnrB,KAJGmrB,KAAIy2B,EAIP5hD,KAJSgpC,IACT/X,EAAM2wB,EAAN3wB,OAAQC,EAAO0wB,EAAP1wB,QAAS6jB,EAAS6M,EAAT7M,UAAWU,EAAUmM,EAAVnM,WAAYX,EAAU8M,EAAV9M,WAAYU,EAAWoM,EAAXpM,YAAaH,EAAauM,EAAbvM,cACjES,EAAc8L,EAAd9L,eAAc+L,EAAAD,EAAEzK,aAAgB9E,EAAYwP,EAAZxP,aAAciF,EAAauK,EAAbvK,cAIlDwK,EAAqG9hD,KAAKgpC,IAAIz7B,SAAQw0C,EAAAD,EAA9GrK,OAAUzJ,EAAO+T,EAAP/T,QAAkCgU,EAAMD,EAA/BhL,wBAAmChJ,EAAQ+T,EAAR/T,SAAU2J,EAAWoK,EAAXpK,YAAaC,EAAWmK,EAAXnK,YAMrF,GALA33C,KAAK03C,YAAcA,EACnB13C,KAAK23C,YAAcA,EAEnB9iC,GAAI2E,KAAK2R,EAAK82B,MAAO92B,EAAK+2B,OAAQ/2B,EAAKg3B,kBAAmBh3B,EAAKi3B,sBAE1DrU,EAAL,CAMY/tC,KAAKmf,SACfnf,KAAK0tC,UAAYK,EAASL,UAC1B1tC,KAAKqiD,YACLriD,KAAKmf,OAASmjC,aAAY,kBAAMn6B,EAAKk6B,WAAW,GAAE,MAGpDxtC,GAAIyE,KAAK6R,EAAK82B,OACdM,GAAiD,IAAlCxU,EAASyU,WAAWC,YAAmBt3B,EAAKinB,OAAQjnB,EAAKu3B,WAAY,GACpFH,GAAexU,EAASyU,WAAWpQ,OAAQjnB,EAAKq3B,WAAYr3B,EAAKw3B,OAAQ,GACzE3iD,KAAK0tC,UAAYK,EAASL,UAE1B,IAAMkV,EAAgB,SAACxoC,GACrB,OAAKA,EACEA,EAAE41B,UAAY51B,EAAEyK,OAASzK,EAAEyoC,QAAUzoC,EAAE01B,SAD/B,CAEjB,EAEMgT,EAAaF,EAAc7U,EAAS4B,YAAY1e,IAAW6jB,EACjE3pB,EAAK43B,oBAAoB1jC,YAAcxK,GAAIiJ,kBAAkBglC,GAC7D33B,EAAK63B,kBAAkB3jC,YAAcxK,GAAIiJ,kBAAkBglC,EAAazQ,EAAc,GACtF,IAAM4Q,EAAcL,EAAc7U,EAAS4B,YAAYze,IAAYskB,EAKnE,GAJArqB,EAAK+3B,qBAAqB7jC,YAAcxK,GAAIiJ,kBAAkBmlC,GAC9D93B,EAAKg4B,mBAAmB9jC,YAAcxK,GAAIiJ,kBAAkBmlC,EAAc3L,EAAe,GAEzFziC,GAAIqf,OAAO8Z,EAAS7iB,EAAK+2B,QACrBlU,EAAS,CACXn5B,GAAIyE,KAAK6R,EAAKg3B,kBAAmBh3B,EAAKi3B,sBACtC/Q,GAAelK,EAAK6G,GACpB,IAAMoV,EAAaR,EAAc7U,EAAS6B,YAAY3e,IAAW6jB,EACjE3pB,EAAKk4B,iBAAiBhkC,YAAcxK,GAAIiJ,kBAAkBslC,GAC1Dj4B,EAAKm4B,qBAAqBjkC,YAAcxK,GAAIiJ,kBAAkBslC,EAAa/Q,EAAc,GACzF,IAAMkR,EAAcX,EAAc7U,EAAS6B,YAAY1e,IAAYskB,EACnErqB,EAAKq4B,kBAAkBnkC,YAAcxK,GAAIiJ,kBAAkBylC,GAC3Dp4B,EAAKs4B,sBAAsBpkC,YAAcxK,GAAIiJ,kBAAkBylC,EAAcjM,EAAe,EAC9F,CAEA,GAAIvC,IAAc9jB,EAAQ,CACxB,IAAMyyB,EAAad,EAAc7U,EAAS4B,YAAYoF,IAAcM,EACpElqB,EAAKw4B,gBAAgBtkC,YAAcxK,GAAIiJ,kBAAkB4lC,EAC3D,CACA,GAAIjO,IAAevkB,EAAS,CAC1B,IAAMwyB,EAAad,EAAc7U,EAAS4B,YAAY8F,IAAeK,EACrE3qB,EAAKy4B,iBAAiBvkC,YAAcxK,GAAIiJ,kBAAkB4lC,EAC5D,CAEAv4B,EAAK04B,gBAAgBxkC,YAAc/V,OAAO2J,KAAKC,MAAM66B,EAAS8V,kBAC9D14B,EAAK24B,mBAAmBzkC,YAAc/V,OAAO2J,KAAKC,MAAM66B,EAAS+V,qBACjE34B,EAAK44B,iBAAiB1kC,YAAc/V,OAAO2J,KAAKC,MAAM66B,EAASgW,mBAC/DlvC,GAAIqf,OAAO6Z,EAASiW,UAAW74B,EAAK84B,cAChClW,EAASiW,UAAY,IAAG74B,EAAK64B,UAAU3kC,YAAcxK,GAAIiJ,kBAAkBiwB,EAASiW,YACxFnvC,GAAIqf,OAAOme,EAAclnB,EAAK+4B,kBAC1B7R,IAAclnB,EAAKg5B,iBAAiB9kC,YAAcxK,GAAIiJ,mBAAkC,QAAf2jC,EAAA1T,EAASqW,cAAM,IAAA3C,OAAA,EAAfA,EAAiB4C,eAAgBvP,EAAazC,GAAiB,IAC5I,IAAMiS,EAAar5B,KAAM+F,iBAAiBC,EAAQC,GAAwB,QAAfwwB,EAAA3T,EAASqW,cAAM,IAAA1C,OAAA,EAAfA,EAAiB4C,aAAc,GAC1Fn5B,EAAKm5B,WAAWjlC,YAAcxK,GAAIiJ,kBAAkBwmC,GAEpD,IAAMC,GAAiBvC,GAAUA,EAAOtC,cAAgBnT,IAA2ByV,EAAOtC,cAAgBjT,GAE1G,GADA53B,GAAIqf,OAAOqwB,EAAep5B,EAAKq5B,WAC3BD,EAAe,KAAAE,EACXL,EAASn5B,KAAM+F,iBAAiBC,EAAQC,GAAwB,QAAfuzB,EAAA1W,EAASqW,cAAM,IAAAK,OAAA,EAAfA,EAAiBL,SAAU,GAClFj5B,EAAKi5B,OAAO/kC,YAAcxK,GAAIiJ,kBAAkBsmC,GAChDj5B,EAAKu5B,UAAUrlC,aAAe+kC,EAASE,EAAa,KAAO,GAAG5+B,QAAQ,EACxE,CACA7Q,GAAIqf,OAAO8tB,EAAQ72B,EAAKw5B,gBACpB3C,IAAQ72B,EAAKu0B,YAAYrgC,YAAc2iC,EAAOtC,aAElD,IAAMkF,EAAY35B,KAAM+F,iBAAiBC,EAAQC,GAAwB,QAAfywB,EAAA5T,EAASqW,cAAM,IAAAzC,OAAA,EAAfA,EAAiBiD,YAAa,GAQxF,GAPA/vC,GAAIqf,OAAO0wB,EAAWz5B,EAAK05B,cACvBD,IACFz5B,EAAKy5B,UAAUvlC,YAAcxK,GAAIiJ,kBAAkB8mC,GACnDz5B,EAAK25B,aAAazlC,aAAeulC,EAAYN,EAAa,KAAO,GAAG5+B,QAAQ,IAG9E7Q,GAAIqf,OAAOwjB,aAAW,EAAXA,EAAasJ,WAAY71B,EAAK45B,oBACrCrN,SAAAA,EAAasJ,WAAY,CAC3B,IAAMgE,EAAYC,GAAgBvN,EAAYsJ,YAC9CnsC,GAAIqf,OAAO8wB,EAAW75B,EAAK+5B,kBAC3BrwC,GAAIqf,QAAQ8wB,EAAW75B,EAAKg6B,gBAC9B,CAGA,GADAtwC,GAAIqf,OAAOwjB,aAAW,EAAXA,EAAauJ,YAAa91B,EAAKi6B,qBACtC1N,SAAAA,EAAauJ,YAAa,CAC5B,IAAM+D,EAAYC,GAAgBvN,EAAYuJ,aAC9CpsC,GAAIqf,OAAO8wB,EAAW75B,EAAKk6B,mBAC3BxwC,GAAIqf,QAAQ8wB,EAAW75B,EAAKm6B,iBAC9B,CAEA,IAAMC,EAA0BC,GAAmB9N,aAAW,EAAXA,EAAa+N,iBAAkBzlD,KAAKgpC,IAAIgF,QAAShuC,KAAKgpC,IAAI1B,MACvGoe,EAmVV,SAA6BpE,GAC3B,IAAKA,EAAU,MAAO,GACtB,IAAMqE,EAAiB,GACvB,GAAIrE,EAASsE,WACX,IAAK,IAAL5jC,EAAA,EAAA6jC,EAAoCxoD,OAAOkgB,QAAQ+jC,EAASsE,YAAW5jC,EAAA6jC,EAAAtiD,OAAAye,IAAE,CAApE,IAAA8jC,EAAAl+C,EAAAi+C,EAAA7jC,GAAA,GAAOjE,EAAO+nC,EAAA,GAAEF,EAAUE,EAAA,GAC7BH,EAAK3iD,KAAKuZ,GTvoCgB,gBSwoCxB,CACEwpC,YAAa96B,KAAMoW,OAAOlmB,OAAO4C,IAAUY,OAAOW,cAClD0mC,KAAM,IAAIp7C,KAAwB,IAAnBg7C,EAAWK,OAAchjB,iBACxC7hC,MAAOwkD,EAAWxkD,QAExB,CAEF,GAAIkgD,EAAS4E,YACX,IAAK,IAALC,EAAA,EAAAC,EAAqC/oD,OAAOkgB,QAAQ+jC,EAAS4E,aAAYC,EAAAC,EAAA7iD,OAAA4iD,IAAE,CAAtE,IAAAE,EAAAz+C,EAAAw+C,EAAAD,GAAA,GAAOpoC,EAAOsoC,EAAA,GAAEH,EAAWG,EAAA,GAC9BV,EAAK3iD,KAAKuZ,GThpCiB,iBSipCzB,CACEwpC,YAAa96B,KAAMoW,OAAOlmB,OAAO4C,IAAUY,OAAOW,cAClD0mC,KAAM,IAAIp7C,KAAyB,IAApBs7C,EAAYD,OAAchjB,iBACzC7hC,MAAO8kD,EAAY9kD,QAEzB,CASF,OAPIkgD,EAASgF,UACXX,EAAK3iD,KAAKuZ,GT9oCoB,kBS+oC5B,CACEypC,KAAM,IAAIp7C,KAA+B,IAA1B02C,EAASgF,SAASL,OAAchjB,iBAC/C7hC,MAAOkgD,EAASgF,SAASllD,SAGxBukD,CACT,CAlX6BY,CAAmBvmD,KAAK23C,aAC3C6O,EAAc,GAAHz6C,OAAOw5C,EAA4BG,GACpD7wC,GAAIqf,OAAOsyB,EAAYjjD,OAAS,EAAG4nB,EAAKs7B,qBACxC5xC,GAAImD,MAAMmT,EAAKs7B,qBAAoB,IACNpxC,EADMC,EAAAjK,GACjBm7C,GAAW,IAA7B,IAAAlxC,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAA+B,KAApBkM,EAAGyH,EAAAxX,MACN6oD,EAASz7C,SAAS4P,cAAc,QACtC6rC,EAAOrnC,YAAc,KAAHtT,OAAQ6B,GAC1Bud,EAAKs7B,oBAAoBnuC,YAAYouC,EACvC,CAAC,OAAAhoD,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CA1FD,MATM7L,KAAKmf,SACPwnC,cAAc3mD,KAAKmf,QACnBnf,KAAKmf,YAAS1d,EAkGpB,GAAC,CAAA9D,IAAA,oBAAAE,MAED,SAAmB0tB,EAAqBoF,EAAwBwwB,GAAkB,IAAAtqB,EAAA,KAC1E+vB,EAAO5mD,KAAKo9C,gBACZyJ,EAA4BtqC,GAAT,SAAToU,EAA4BpU,EAAyBA,GAKrE,GAJAqqC,EAAKE,iBAAiBznC,YAAc9C,GThzBH,qBSgzByC,CAAEoU,KAAMk2B,EAAS1F,SAAU,GAAFp1C,OAAKo1C,KAExGtsC,GAAIqf,OAAO3I,EAAOnqB,MAAOwlD,EAAKG,kBAC9BlyC,GAAIqf,QAAQ3I,EAAOnqB,MAAOwlD,EAAKI,oBAC3Bz7B,EAAOnqB,MAAX,CACE,IAAM6lD,EAAkBzB,GAAmBj6B,EAAOnqB,MAAOpB,KAAKgpC,IAAIgF,QAAShuC,KAAKgpC,IAAI1B,MACpFzyB,GAAImD,MAAM4uC,EAAKG,kBACf,IAAK,IAALpvC,EAAA,EAAAuvC,EAAkBD,EAAetvC,EAAAuvC,EAAA3jD,OAAAoU,IAAE,CAA9B,IAAM/J,EAAGs5C,EAAAvvC,GACN+uC,EAASz7C,SAAS4P,cAAc,QACtC6rC,EAAOrnC,YAAc,KAAHtT,OAAQ6B,GAC1Bg5C,EAAKG,iBAAiBzuC,YAAYouC,EACpC,CAEF,KATA,CAWA7xC,GAAImD,MAAM4uC,EAAKO,gBAAiBP,EAAKQ,gBACrC,IAAMC,EAAY,SAACtpC,GACjB,IAAMupC,EAAMzwB,EAAKymB,mBAAmB7xB,WAAU,GACxC87B,EAAU1yC,GAAI6W,cAAc47B,GAC5BroC,EAAQgM,KAAMoW,OAAOtjB,GAC3BwpC,EAAQtoC,MAAMI,YAAcJ,EAAMN,OAAOW,cACzCioC,EAAQC,UAAU/nC,IAAM5K,GAAImK,SAASC,EAAMN,QAC3C,IAAMjK,EAAWuK,EAAMvK,SACjBs7B,EAAYzkB,EAAOk8B,iBAAiB1pC,GAAWwN,EAAOk8B,iBAAiB1pC,GAASiyB,UAAY,EAC5F0X,EAAWn8B,EAAOo8B,gBAAgB5pC,GAAWwN,EAAOo8B,gBAAgB5pC,GAAW,EAC/E6pC,EAAYr8B,EAAOs8B,iBAAiB9pC,GAAWwN,EAAOs8B,iBAAiB9pC,GAAW,EAClF8kC,EAAUt3B,EAAOk8B,iBAAiB1pC,GAAWwN,EAAOk8B,iBAAiB1pC,GAAS8kC,QAAU,EACxFh+B,EAAS0G,EAAOk8B,iBAAiB1pC,GAAWwN,EAAOk8B,iBAAiB1pC,GAAS8G,OAAS,EACtFijC,EAAOv8B,EAAOw8B,YAAYhqC,GAAWwN,EAAOw8B,YAAYhqC,GAAW,EACzEwpC,EAAQvX,UAAU3wB,YAAcxK,GAAIkc,gBAAgBif,EAAWt7B,GAC/D6yC,EAAQ1iC,OAAOxF,YAAcxK,GAAIkc,gBAAgBlM,EAAQnQ,GACzD6yC,EAAQG,SAASroC,YAAcxK,GAAIkc,gBAAgB22B,EAAUhzC,GAC7D6yC,EAAQK,UAAUvoC,YAAcxK,GAAIkc,gBAAgB62B,EAAWlzC,GAC/D6yC,EAAQ1E,QAAQxjC,YAAcxK,GAAIkc,gBAAgB8xB,EAASnuC,GAC3D6yC,EAAQO,KAAKzoC,YAAcxK,GAAIkc,gBAAgB+2B,EAAMpzC,GACrD,IAAMszC,EAAaC,GAAQP,EAAU1X,GACrCuX,EAAQS,WAAW3oC,YAAcxK,GAAIkc,gBAAgBi3B,EAAYtzC,GAC7DszC,EAAa,GAAGT,EAAQS,WAAWrvC,UAAUC,IAAI,gBACrD,IAAMsvC,EAAwBD,GAAQD,EAAYnF,GAGlD,OAFA0E,EAAQW,sBAAsB7oC,YAAcxK,GAAIkc,gBAAgBm3B,EAAuBxzC,GACnFwzC,EAAwB,GAAGX,EAAQW,sBAAsBvvC,UAAUC,IAAI,gBACpE,CAAC0uC,EAAKU,EACf,EAQMG,EAAW,CAACnoD,KAAKgpC,IAAI/X,OAAQjxB,KAAKgpC,IAAI9X,SACvCi3B,EAASC,SAASpoD,KAAKgpC,IAAI+L,YAAYoT,EAASnlD,KAAKhD,KAAKgpC,IAAI+L,WAC9DoT,EAASC,SAASpoD,KAAKgpC,IAAIyM,aAAa0S,EAASnlD,KAAKhD,KAAKgpC,IAAIyM,YAGpE,IAFA,IAWI4S,EAXAC,EAAkB,EAChBC,EAAuB,GAC7BnwC,EAAA,EAAAowC,EAAsBL,EAAQ/vC,EAAAowC,EAAAjlD,OAAA6U,IAAE,CAA3B,IACyCqwC,EAAA7gD,EAAlBy/C,EADVmB,EAAApwC,IAC4B,GAArCkvC,EAAGmB,EAAA,GACVH,GADsBG,EAAA,GAEtB7B,EAAKO,gBAAgB7uC,YAAYgvC,GACjCiB,EAAKvlD,KAAKskD,EACZ,CAKA,GAtBgC,SAACU,EAAqBO,GACpD1zC,GAAIqf,OAAO8zB,EAAYpB,EAAK8B,oBAAqB9B,EAAK+B,gCAA+B,IAC/D7tC,EAD+DC,EAAA1P,GACnEk9C,GAAI,IAAtB,IAAAxtC,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAwB,KAAb4lD,EAAGxsC,EAAAjd,MACN0pD,EAAU1yC,GAAI6W,cAAc47B,GAClCzyC,GAAIqf,OAAO8zB,EAAYT,EAAQS,WAAYT,EAAQW,sBACrD,CAAC,OAAAxpD,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CACH,CAYA+8C,CAAwBN,EAAkB,EAAGC,GAE7C1zC,GAAIqf,OAAOl0B,KAAKgpC,IAAIgF,QAAS4Y,EAAKiC,WAAYjC,EAAKkC,uBAAwBlC,EAAKmC,kBAAmBnC,EAAKoC,eAEpGhpD,KAAKgpC,IAAIgF,QAAS,CACpB,IAAMib,EAAiBpc,GAAgB7sC,KAAKgpC,IAAIgF,SAC5Cib,GACFrC,EAAK7U,QAAQtyB,IAAMwpC,EAAenc,KAClC8Z,EAAKsC,iBAAiB7pC,YAAc9C,GTp3Bb,eSo3B6C,CAAEyxB,QAASib,EAAellD,QAE9F4W,QAAQvZ,MAAM,gCAAD2K,OAAiC/L,KAAKgpC,IAAIgF,UAEzD,IAAMmb,EAAsB,SAATx4B,EAAkB3wB,KAAKgpC,IAAI/X,OAASjxB,KAAKgpC,IAAI9X,QAChEm3B,EAAWp9B,KAAMoW,OAAO8nB,GACxBvC,EAAKyB,SAAShpC,YAAcgpC,EAAS1pC,OAAOW,cAC5CsnC,EAAKwC,aAAa3pC,IAAM5K,GAAImK,SAASqpC,EAAS1pC,QAC9C,IAAM0qC,EAAkB99B,EAAO89B,gBAAkB99B,EAAO89B,gBAAgBrZ,UAAY,EAC9EsZ,EAAiB/9B,EAAO+9B,eAAiB/9B,EAAO+9B,eAAiB,EACjEC,EAAkBh+B,EAAOg+B,gBAAkBh+B,EAAOg+B,gBAAkB,EACpEC,EAAgBj+B,EAAO89B,gBAAkB99B,EAAO89B,gBAAgBxG,QAAU,EAC1E4G,EAAiBl+B,EAAO89B,gBAAkB99B,EAAO89B,gBAAgBvZ,SAAW,EAC5E4Z,EAAan+B,EAAOm+B,WAAan+B,EAAOm+B,WAAa,EACrDC,EAAmB1B,GAAQqB,EAAgBD,GAC3CO,EAA8B3B,GAAQ0B,EAAkBH,GAC9D5C,EAAKiD,aAAaxqC,YAAcxK,GAAIkc,gBAAgBs4B,EAAiBhB,EAAS3zC,UAC9EkyC,EAAKkD,UAAUzqC,YAAcxK,GAAIkc,gBAAgB04B,EAAgBpB,EAAS3zC,UAC1EkyC,EAAKmD,YAAY1qC,YAAcxK,GAAIkc,gBAAgBu4B,EAAgBjB,EAAS3zC,UAC5EkyC,EAAKoD,aAAa3qC,YAAcxK,GAAIkc,gBAAgBw4B,EAAiBlB,EAAS3zC,UAC9EkyC,EAAKqD,WAAW5qC,YAAcxK,GAAIkc,gBAAgBy4B,EAAenB,EAAS3zC,UAC1EkyC,EAAKsD,QAAQ7qC,YAAcxK,GAAIkc,gBAAgB24B,EAAYrB,EAAS3zC,UACpE,IAAMy1C,EAAYR,EAAmB,EACrC90C,GAAIqf,OAAOi2B,EAAWvD,EAAKwD,oBAAqBxD,EAAKyD,+BACnDzD,EAAK0D,cAAe1D,EAAK2D,0BACvBJ,IACFvD,EAAK0D,cAAcjrC,YAAcxK,GAAIkc,gBAAgB44B,EAAkBtB,EAAS3zC,UAChFkyC,EAAK2D,yBAAyBlrC,YAAcxK,GAAIkc,gBAAgB64B,EAA6BvB,EAAS3zC,UAClGk1C,EAA8B,EAAGhD,EAAK2D,yBAAyB5xC,UAAUC,IAAI,gBAC5EguC,EAAK2D,yBAAyB5xC,UAAUM,OAAO,gBAExD,CAEA,IACyC2G,EADrC4qC,GAAY,EAAK3qC,EAAAxU,GACGkgB,EAAOqoB,YAAU,IAAzC,IAAA/zB,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAA2C,GAAvBke,EAAA/hB,MAAqCuD,MAAO,CAAEopD,GAAY,EAAM,KAAM,CAAC,OAAA9rD,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CAC3FgJ,GAAIqf,OAAOs2B,EAAW5D,EAAK6D,aAkD3B,IAjDA,IAAMC,EAAqB,SAACC,EAA2BC,GACrD,IAAMtD,EAAMzwB,EAAK0mB,iBAAiB9xB,WAAU,GACtC87B,EAAU1yC,GAAI6W,cAAc47B,GAC5BuD,EAAS5/B,KAAMoW,OAAOxK,EAAKmS,IAAI/X,QAAQvc,SACvCo2C,EAAU7/B,KAAMoW,OAAOxK,EAAKmS,IAAI9X,SAASxc,SAC/C6yC,EAAQqD,SAASvrC,YAAc/V,OAAOshD,GACtCrD,EAAQjrC,KAAK+C,YAAcxK,GAAIk2C,wBAAwBJ,EAAUruC,KAAMuuC,EAAQC,EAASj0B,EAAKmS,IAAIlI,UACjGymB,EAAQ3U,KAAKvzB,YAAc/V,OAAOqhD,EAAU/X,MAC5C2U,EAAQyD,aAAa3rC,YAAc/V,OAAOqhD,EAAUK,cACpDzD,EAAQ0D,YAAY5rC,YAAc/V,OAAOqhD,EAAUM,aAC/CN,EAAUK,aAAeL,EAAUM,YAAcN,EAAU/X,OAC7D2U,EAAQ3U,KAAKj6B,UAAUC,IAAI,gBAC3B2uC,EAAQyD,aAAaryC,UAAUC,IAAI,gBACnC2uC,EAAQ0D,YAAYtyC,UAAUC,IAAI,iBAEpC/D,GAAIqf,OAAOy2B,EAAUO,iBAAmB,EAAG3D,EAAQ2D,kBACnD3D,EAAQ2D,iBAAiB7rC,YAAcxK,GAAIk2C,wBAAwBJ,EAAUO,iBAAkBL,EAAQC,EAASj0B,EAAKmS,IAAIlI,UACzH,IAAK,IAALroB,EAAA,EAAA0yC,EAAsBhD,EAAQ1vC,EAAA0yC,EAAA5nD,OAAAkV,IAAE,CAA3B,IAAMsF,EAAOotC,EAAA1yC,GACVwG,EAAQgM,KAAMoW,OAAOtjB,GACrBrJ,EAAWuK,EAAMvK,SACjB02C,EAAcT,EAAUU,YAAYttC,GAAW4sC,EAAUU,YAAYttC,GAAW,EAChFutC,EAAUX,EAAUY,QAAQxtC,GAAW4sC,EAAUY,QAAQxtC,GAAW,EACpEytC,EAAc30B,EAAK2mB,oBAAoB/xB,WAAU,GACjDggC,EAAkB52C,GAAI6W,cAAc8/B,GACpCE,EAAU70B,EAAK2mB,oBAAoB/xB,WAAU,GAC7CkgC,EAAc92C,GAAI6W,cAAcggC,GACtCD,EAAgB3Q,IAAIz7B,YAAcxK,GAAIkc,gBAAgBq6B,EAAa12C,GACnE+2C,EAAgBjE,UAAU/nC,IAAM5K,GAAImK,SAASC,EAAMN,QACnD8sC,EAAgB1F,YAAY1mC,YAAcJ,EAAMN,OAAOW,cACvDqsC,EAAY7Q,IAAIz7B,YAAcxK,GAAIkc,gBAAgBu6B,EAAS52C,GAC3Di3C,EAAYnE,UAAU/nC,IAAM5K,GAAImK,SAASC,EAAMN,QAC/CgtC,EAAY5F,YAAY1mC,YAAcJ,EAAMN,OAAOW,cACnDioC,EAAQqE,YAAYtzC,YAAYkzC,GAChCjE,EAAQsE,QAAQvzC,YAAYozC,EAC9B,CAEA,GADA72C,GAAIqf,OAAO2C,EAAKmS,IAAIgF,QAASuZ,EAAQuE,YAAavE,EAAQwE,SACtDl1B,EAAKmS,IAAIgF,QAAS,CACpB,IAAMod,EAAcv2C,GAAIkc,gBAAgB45B,EAAUqB,YAAa3D,EAAS3zC,UACxE6yC,EAAQuE,YAAYzsC,YAAc,GAAHtT,OAAMq/C,EAAW,KAAAr/C,OAAIs8C,EAAS1pC,OAAOW,eACpE,IAAMgsC,EAAUz2C,GAAIkc,gBAAgB45B,EAAUsB,QAAS5D,EAAS3zC,UAChE6yC,EAAQwE,QAAQ1sC,YAAc,GAAHtT,OAAMu/C,EAAO,KAAAv/C,OAAIs8C,EAAS1pC,OAAOW,cAC9D,CAEA,GADAzK,GAAIqf,OAAOs2B,EAAWjD,EAAQnmD,OAC1BupD,EAAUvpD,MAAO,CACnB,IAAM8qD,EAAc1G,GAAmBmF,EAAUvpD,MAAOy1B,EAAKmS,IAAIgF,QAASnX,EAAKmS,IAAI1B,MACnFigB,EAAQnmD,MAAMie,YAAc6sC,EAAYC,KAAK,KAC/C,CACA,OAAO7E,CACT,EACS9jD,EAAI,EAAGA,EAAI+nB,EAAOqoB,WAAWrwC,OAAQC,IAC5CojD,EAAKQ,eAAe9uC,YAAYoyC,EAAmBn/B,EAAOqoB,WAAWpwC,GAAIA,EAAI,GA9I/E,CAgJF,GAAC,CAAA7F,IAAA,kBAAAE,MAED,SAAiB8yB,GACf,GAAK3wB,KAAK03C,YAAV,CACA,IAAMnsB,EAAkB,SAAToF,EAAkB3wB,KAAK03C,YAAYsJ,WAAahhD,KAAK03C,YAAYuJ,YAC3E11B,IACLvrB,KAAKkhD,kBAAkB31B,EAAQoF,EAAM3wB,KAAK03C,YAAYyJ,UACtDnhD,KAAK+gD,6BAA+BpwB,EACpC3wB,KAAKi9C,MAAM3jC,KAAKtZ,KAAKm9C,kBAAmBn9C,KAAKgpC,IAAI/zB,IALpB,CAM/B,GAAC,CAAAtX,IAAA,WAAAE,MAED,WACE,GAAKmC,KAAKgpC,IAAV,CACA,IAAQ7d,EAA+BnrB,KAA/BmrB,KAAIihC,EAA2BpsD,KAAzBgpC,IAAO1B,EAAI8kB,EAAJ9kB,KAAMyO,EAAKqW,EAALrW,MACrBsW,EAASphC,KAAMuc,UAAUF,GAAM2O,QAAQF,GAAOsW,QAAU,GAC9DlhC,EAAKmhC,cAAcjtC,YAAc/V,OAAO+iD,EAAO/4C,QAAO,SAAC6V,GAAU,OJ1pCzC,II0pC8CA,EAAI5b,MAAiC,IAAEhK,OAHxF,CAIvB,KAACy5C,CAAA,CA3amC,GA8atC,SAASiI,GAAiB15B,GACxB,GAAIA,EAAOnqB,MAAO,OAAO,EACzB,IAAK,IAAIoC,EAAI,EAAGA,EAAI+nB,EAAOqoB,WAAWrwC,OAAQC,IAAK,CACjD,IAAMmnD,EAAYp/B,EAAOqoB,WAAWpwC,GACpC,GAAImnD,EAAUM,YAAcN,EAAUK,aAAeL,EAAU/X,KAAM,OAAO,EAC5E,GAAI+X,EAAUvpD,MAAO,OAAO,CAC9B,CACA,OAAO,CACT,CAEA,SAASmhD,GAAgB72C,EAAW6gD,EAAkBC,EAAqB1wC,GACzEywC,EAAIltC,YAAcxK,GAAIiJ,kBAAkBpS,EAAGoQ,GAC3C0wC,EAAO7zC,UAAUmN,OAAO,WAAYpa,EAAI,GACxC8gD,EAAO7zC,UAAUmN,OAAO,YAAapa,EAAI,EAE3C,CAEO,SAASkuC,GACd3oB,EAAgBC,EAAiBqoB,EAAuBC,EACxDhgB,EAAiBgd,EAAkBC,EAAmB1B,EAAmBU,EACzEP,EAA8BU,EAA+B6W,EAC7DC,GAEA,IAAMvW,EAAW3E,GAAkBhY,EAASvI,EAAQC,GAE9C8oB,EAAS,CACb9J,IAAK,CACH1e,KAAM,CACJohB,KAAM4D,EACNhyC,IAAKgyC,EAAWhd,GAElBghB,MAAO,CACL5H,KAAM6D,EACNjyC,IAAKiyC,EAAYN,IAGrBtG,IAAK,CACHre,KAAM,CACJohB,KAd+B6D,EAe/BjyC,IAf+BiyC,EAeZjd,GAErBghB,MAAO,CACL5H,KAlB0C4D,EAmB1ChyC,IAnB0CgyC,EAmBtBL,KAKtBwW,EAAuB,EACvBC,EAA2B,EAC3B37B,IAAW8jB,IACb4X,GAAwBpT,EAASsT,UAAUC,KACvC/X,IAAcU,IAAYkX,GAAwBnT,EAAUqT,UAAUE,SAE5E,IAAIC,EAAwBzT,EAASjlC,IAAIw4C,KACrC77B,IAAWwkB,IAAYuX,GAAyBxT,EAAUllC,IAAIy4C,QAC9D7X,IACF8X,GAAyBzT,EAASjlC,IAAI24C,OACjCrX,GAAwBb,IAAcU,IAAYmX,EAA2BrT,EAASjlC,IAAIy4C,SAGjG,IAAIG,EAAwB,EACxBC,EAA4B,EAC5Bj8B,IAAYukB,IACdyX,GAAyB1T,EAAUqT,UAAUC,KACzCrX,IAAeV,IAAWmY,GAAyB3T,EAASsT,UAAUE,SAE5E,IAAIK,EAAyB5T,EAAUllC,IAAIw4C,KACvC57B,IAAY6jB,IAAWqY,GAA0B7T,EAASjlC,IAAIy4C,QAC9DnX,IACFwX,GAA0B5T,EAAUllC,IAAI24C,OACnC/X,GAAuBO,IAAeV,IAAWoY,EAA4B3T,EAAUllC,IAAIy4C,SAGlG,IAAMM,EAAqB,EAAIZ,EACzBa,EAAsB,EAAIZ,EAE1Ba,EAAmBP,EAAwBxW,EAAY6W,EACvDG,EAAkBZ,EAA2BnW,EAAa6W,EAC1DG,EAAoBL,EAAyB3W,EAAa6W,EAC1DI,EAAmBP,EAA4B3W,EAAY6W,EAuBjE,MAAO,CAAErT,OAAAA,EAAQC,KArBS,CACxBzoB,KAAIm8B,GAAAA,GAAA,GACCpU,GAAQ,IACXqU,kBAAmBZ,EACnBa,yBAA0BjB,EAC1BzS,YAAaoT,EAAkBC,EAC/BM,mBAAoBT,EACpBU,qBAAsBT,EACtB7S,iBAAkBkS,IAEpBnS,MAAKmT,GAAAA,GAAA,GACAnU,GAAS,IACZoU,kBAAmBR,EACnBS,yBAA0BV,EAC1BhT,YAAasT,EAAmBC,EAChCI,mBAAoBR,EACpBS,qBAAsBV,EACtB5S,iBAAkByS,KAKxB,CAEA,SAAS1H,GAAoBlE,EAAmCtT,EAAiBggB,GAC/E,IAAK1M,EAAU,MAAO,GACtB,IAAMqE,EAAiB,GAEvB,GAAIrE,EAAS2M,gBACX,IAAK,IAALl1C,EAAA,EAAAuE,EAAmCjgB,OAAOkgB,QAAQ+jC,EAAS2M,iBAAgBl1C,EAAAuE,EAAA/Z,OAAAwV,IAAE,CAAxE,IAAAm1C,EAAAtmD,EAAA0V,EAAAvE,GAAA,GAAOgF,EAAOmwC,EAAA,GAAWA,EAAA,IAE1BvI,EAAK3iD,KAAKuZ,GThmCkB,oBSgmCmB,CAAEwpC,YAAa96B,KAAMoW,OAAOlmB,OAAO4C,IAAUY,OAAOW,gBAEvG,CAGF,GAAIgiC,EAAS6M,cACX,IAAK,IAAL9wC,EAAA,EAAA+wC,EAAiC/wD,OAAOkgB,QAAQ+jC,EAAS6M,eAAc9wC,EAAA+wC,EAAA7qD,OAAA8Z,IAAE,CAApE,IAAAgxC,EAAAzmD,EAAAwmD,EAAA/wC,GAAA,GAAOU,EAAOswC,EAAA,GAASA,EAAA,IAExB1I,EAAK3iD,KAAKuZ,GTvmCgB,kBSumCmB,CAAEwpC,YAAa96B,KAAMoW,OAAOlmB,OAAO4C,IAAUY,OAAOW,gBAErG,CAuBF,OApBIgiC,EAASgN,kBACX3I,EAAK3iD,KAAKuZ,GTvmCsB,oBSumCe,CAAEyxC,QAASA,KAGxD1M,EAASiN,iBACX5I,EAAK3iD,KAAKuZ,GT1mCuB,qBS0mCe,CAAEyxC,QAASA,KAGzD1M,EAASkN,eACX7I,EAAK3iD,KAAKuZ,GT7mCoB,oBSgnC5B+kC,EAASmN,sBACX9I,EAAK3iD,KAAKuZ,GThnC2B,yBSgnCe,CAAEyxB,QAASA,KAG7DsT,EAASoN,iBACX/I,EAAK3iD,KAAKuZ,GT7mCsB,sBSgnC3BopC,CACT,CAmCA,SAASsC,GAASthD,EAAWyT,GAC3B,OAAOzT,EAAIyT,EAAI,EAAIzT,EAAIyT,EAAI,CAC7B,8uCAEAlO,OAAOyiD,SAAW,WAChB,OAAO5hB,GAAGx/B,QACZ,EChzCO,IAAMqhD,GAAK,WAOhB,SAAAA,EAAaC,EAAuBviC,GAAmB,IAAAnT,EAAA,KAAAtQ,EAAA,KAAA+lD,GAAA9kD,EAAA,wBAAAA,EAAA,2BAAAA,EAAA,6BAAAA,EAAA,qBAAAA,EAAA,sBACrD9J,KAAK6uD,SAAWA,EAChB7uD,KAAK8uD,OAASxiC,aAAG,EAAHA,EAAKwiC,OAEnBD,EAASp0C,iBAAiB,gBAAgBla,SAAQ,SAAAyU,GAChDH,GAAI1K,KAAK6K,EAAI,SAAS,WAAQmE,EAAKioC,OAAQ,GAC7C,IAEAvsC,GAAI1K,KAAK0kD,EAAU,aAAa,SAACjjD,GAC1BuN,EAAKynC,cACL/rC,GAAIk6C,eAAenjD,EAAGuN,EAAKynC,cAAgBznC,EAAKioC,QACvD,IAEAphD,KAAKgvD,MAAQ,SAACpjD,GACE,WAAVA,EAAEjO,KACJwb,EAAKioC,OAET,EACAvsC,GAAI1K,KAAKc,SAAU,QAASjL,KAAKgvD,MACnC,CAEA,IAAAC,EAwBC,OAxBDtlD,EAAAilD,EAAA,EAAAjxD,IAAA,OAAAE,OAAAoxD,EAAAxmD,EAAAzL,IAAAA,MACA,SAAA8P,EAAY85C,EAAmB3xC,GAAW,IAAAsmB,EAAA,OAAAv+B,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAMwB,OALhEtC,KAAK4gD,YAAcgG,EACnB5mD,KAAK6gD,cAAgB5rC,EACrBJ,GAAI2E,KAAI5Q,MAARiM,GAAGnN,EAASN,MAAMI,KAAKxH,KAAK6uD,SAASn0C,YACrCksC,EAAKrsC,MAAMvE,MAAQ,UACnBnB,GAAIyE,KAAKtZ,KAAK6uD,SAAUjI,GAClBrrB,GAASv7B,KAAK6uD,SAASn4C,YAAckwC,EAAKlwC,aAAe,EAACxJ,EAAA5K,KAAA,EAC1DuS,GAAIyF,QAAQ40C,IAAiB,SAAAC,GACjCvI,EAAKrsC,MAAMvE,MAAQ,GAAHjK,QAAO,EAAIojD,GAAY5zB,EAAK,KAC9C,GAAG,eAAc,OACjBqrB,EAAKrsC,MAAMvE,MAAQ,IAAG,wBAAA9I,EAAAlI,OAAA,GAAA8H,EAAA,UACvB,SAAA9E,EAAA2E,GAAA,OAAAsiD,EAAArmD,MAAA,KAAAD,UAAA,KAAAhL,IAAA,QAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAK6uD,UACd,IAAMO,EAAapvD,KAAK4gD,YACxB5gD,KAAK4gD,iBAAcn/C,EACnBzB,KAAK6gD,mBAAgBp/C,EACjBzB,KAAK8uD,QAAQ9uD,KAAK8uD,OAAOM,EAC/B,GAAC,CAAAzxD,IAAA,OAAAE,MAED,WACEgX,GAAImU,OAAO/d,SAAU,QAASjL,KAAKgvD,MACrC,KAACJ,CAAA,CApDe,GA2DLS,GAAa,WAUxB,SAAAA,EAAazI,EAAmB0I,EAAoCC,GAAuB,IAAArpC,EAAA,KAAArd,EAAA,KAAAwmD,GAAAvlD,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,8BAAAA,EAAA,4BAAAA,EAAA,6BACzF9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EACf,IAAMnkC,EAAOnrB,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,GAEvC2I,IACF16C,GAAIyE,KAAK6R,EAAKqkC,QACd36C,GAAI1K,KAAKghB,EAAKqkC,OAAQ,SAAS,WAAQD,GAAW,KAGpD16C,GAAImD,MAAMmT,EAAKskC,eACftkC,EAAKskC,cAAcrvC,gBAAgB,MAGnCpgB,KAAK0vD,QAAU,IAAIC,GAAiBxkC,EAAKykC,gBAAgB,GAEzD5vD,KAAK6vD,eAAiBh7C,GAAIi7C,YAAYlJ,EAAM,kBAE5Cz8C,GAAKy8C,EAAMz7B,EAAK4kC,WAAW,kBAAM7pC,EAAK8pC,QAAQ,IAC9C7lD,GAAKy8C,EAAMz7B,EAAK8kC,SAAS,kBAAM/pC,EAAK8pC,QAAQ,IAE5C/kC,KAAMilC,mBAAmB,CACvBC,YAAa,SAACC,GAA4BlqC,EAAKmqC,kBAAkBD,EAAKhrC,OAAQ,EAC9EkrC,WAAY,SAACF,GAA+BlqC,EAAKqqC,cAAcrqC,EAAKqqC,aAAatlC,KAAM8sB,UAAUqY,EAAKryC,SAAU,EAChHyyC,aAAc,SAACJ,GAA+BlqC,EAAKuqC,qBAAqBL,EAAM,GAElF,CA2QA,IAAAM,EANAC,EAzECC,EAjEDC,EA7DAC,EA9BCC,EAfAC,EAmRA,OAlSDrnD,EAAA0lD,EAAA,EAAA1xD,IAAA,oBAAAE,MAKA,SAAmB4Y,GACbzW,KAAKuwD,cAAcvwD,KAAKuwD,aAAa95C,EAC3C,GAEA,CAAA9Y,IAAA,uBAAAE,MAIA,SAAsBuyD,GAChBpwD,KAAKixD,eAAejxD,KAAKixD,cAAcb,EAC7C,GAAC,CAAAzyD,IAAA,eAAAE,OAAAmzD,EAAAvoD,EAAAzL,IAAAA,MAED,SAAAiR,EAAoB8P,EAAiBmzC,EAAoBC,GAAyB,IAAAC,EAAA3sB,EAAAr7B,EAAA,OAAApM,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAStB,OARpD8uD,EAAa,CACjBrzC,QAASA,EACTszC,KAAMrxD,KAAKmrB,KAAKmmC,cAAczzD,OAAS,GACvC4vC,OAAQztC,KAAK0vD,QAAQ6B,IAAIxzC,GACzBmzC,WAAYA,EACZC,WAAYA,GAGR1sB,EAAM,IAAIf,GAAK1jC,KAAK4mD,KAAM,CAAErhB,iBAAiB,IAAOp3B,EAAA7L,KAAA,EACxCuL,EAAS,iBAAkBujD,GAAW,OAC9C,OADJhoD,EAAG+E,EAAArM,KACT2iC,EAAIz/B,OAAMmJ,EAAAlM,OAAA,SACHmH,GAAG,wBAAA+E,EAAAnJ,OAAA,GAAAiJ,EAAA,UACX,SAAArB,EAAAkB,EAAAC,GAAA,OAAAijD,EAAApoD,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,OAAAkzD,EAAAtoD,EAAAzL,IAAAA,MAED,SAAAuR,IAAA,IAAA4c,EAAAmmC,EAAAE,EAAAvyC,EAAAwyC,EAAAC,EAAAP,EAAAD,EAAA9nD,EAAA,OAAApM,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OAiBE,OAhBM6oB,EAAOnrB,KAAKmrB,KACZmmC,EAAgBnmC,EAAKmmC,cAC3Bz8C,GAAI2E,KAAK2R,EAAKwmC,cAAaH,EAEIxxD,KAAK4xD,QAA5B3yC,EAAKuyC,EAALvyC,MAAOwyC,EAAWD,EAAXC,YACTC,EAAc1xD,KAAK4xD,QAAQF,YAE7BR,EAAaQ,EAAYhyD,KACzB+xD,IACFP,EAAcjyC,EAAM+sB,MAAgBplC,WAAWlH,KAC/CyxD,EAAa,CACXpzC,QAAS0zC,EAAYx8C,GACrBw4B,OAAQztC,KAAK0vD,QAAQ6B,IAAIE,EAAYx8C,IACrCi8C,WAAYQ,EAAYhyD,OAG5B8O,EAAAlM,KAAA,EACkBtC,KAAK6xD,aAAa5yC,EAAMhK,GAAIi8C,EAAYC,GAAW,OAA5D,GAAH/nD,EAAGoF,EAAA1M,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFoF,EAAAlM,KAAA,SACL,OAAtBtC,KAAK+xD,SAAS3oD,EAAIwE,KAAIY,EAAAvM,OAAA,kBAGA,GAAxBqvD,EAAczzD,MAAQ,IAClB4zD,EAAa,CAAFjjD,EAAAlM,KAAA,gBAAAkM,EAAAlM,KAAA,GAAQtC,KAAKgyD,gBAAe,QAAAxjD,EAAAlM,KAAA,iBACtCtC,KAAKsvD,QAAQtvD,KAAK4xD,QAAQ3yC,MAAMhK,IAAG,yBAAAzG,EAAAxJ,OAAA,GAAAuJ,EAAA,UACzC,kBAAAwiD,EAAAnoD,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,OAAAizD,EAAAroD,EAAAzL,IAAAA,MAKA,SAAA2mB,IAAA,IAAAwH,EAAA8mC,EAAAR,EAAAxyC,EAAA,OAAAjiB,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAC6C,GAAnC6oB,EAA0CnrB,KAA1CmrB,KAAI8mC,EAAsCjyD,KAApC4xD,QAAWH,EAAWQ,EAAXR,YAAaxyC,EAAKgzC,EAALhzC,MACjCwyC,EAAa,CAAF7tC,EAAAthB,KAAA,eAAAshB,EAAA3hB,OAAA,iBAQY,OAN5BkpB,EAAK+mC,cAAc7yC,YAAc,IACjC8L,EAAKgnC,WAAW9yC,YAAcoyC,EAAY1tD,KAC1ConB,EAAK3L,WAAWC,IAAM5K,GAAImK,SAASyyC,EAAY9yC,QAC/CwM,EAAKinC,UAAU/yC,YAAcJ,EAAMlb,KACnConB,EAAKknC,UAAU5yC,IAAM5K,GAAImK,SAASC,EAAMN,QACxC9J,GAAI2E,KAAK2R,EAAKmnC,UACdz9C,GAAIyE,KAAK6R,EAAKonC,eAAc3uC,EAAA/e,KAAA,GAAA+e,EAAAthB,KAAA,GAGpBtC,KAAKwyD,WAAWf,GAAY,QAClCzxD,KAAKsvD,QAAQtvD,KAAK4xD,QAAQ3yC,MAAMhK,IAAG2O,EAAAthB,KAAA,iBAAAshB,EAAA/e,KAAA,GAAA+e,EAAAlW,GAAAkW,EAAA,UAEnC5jB,KAAK+xD,SAASnuC,EAAAlW,GAAMo3B,SAAOlhB,EAAAlW,IAAU,QAEvCmH,GAAIyE,KAAK6R,EAAKmnC,UACdz9C,GAAI2E,KAAK2R,EAAKonC,eAAc,yBAAA3uC,EAAA5e,OAAA,GAAA2e,EAAA,oBAC7B,kBAAAmtC,EAAAloD,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,MAIA,SAAY4zD,GAA4C,IAAA1qC,EAAA,KAC9CoE,EAA6BnrB,KAA7BmrB,KAAiBlM,EAAYjf,KAAvB4xD,QAAW3yC,MACzB,OAAO,IAAI5a,SAAQ,SAACxD,EAASC,GAE3B,IAAM2V,EAAIwU,KAAMoW,OAAOowB,EAAYx8C,IAAImQ,OACvC,GAAI3O,GAAKA,EAAE+O,OAAQ,OAAO3kB,IAE1BkmB,EAAKwpC,aAAe,SAAC95C,GACfA,EAAEsH,UAAY0zC,EAAYx8C,KAC9BkW,EAAK+mC,cAAc7yC,aAAgC,IAAjB5I,EAAEgP,cAAoBC,QAAQ,GAClE,EAEAqB,EAAKkqC,cAAgB,SAACb,GACpB,GAAIA,EAAKryC,UAAYkB,EAAMhK,GAA3B,CACA,OAAQm7C,EAAKqC,OACX,IAAK,uBACH3xD,EAAO,IAAIU,MAAM,GAADuK,OAAIqkD,EAAKsC,QAAO,MAAA3mD,OAAKqkD,EAAKuC,WAC1C,MACF,IAAK,wBACH9xD,IACA,MACF,QACE,OAEJkmB,EAAKwpC,aAAe,KACpBxpC,EAAKkqC,cAAgB,IAZgB,CAavC,CACF,GACF,GAEA,CAAAtzD,IAAA,WAAAE,OAAAgzD,EAAApoD,EAAAzL,IAAAA,MACA,SAAA6mB,EAAgB9F,GAAe,IAAAoN,EAAAynC,EAAAC,EAAAC,EAAA7zC,EAAAwyC,EAAAsB,EAAAC,EAAA5nD,EAAAD,EAAA8nD,EAAArrC,EAAA,YAAA5qB,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,UACxBtC,KAAKkzD,WAAWn1C,GAAU,CAAFuI,EAAAhkB,KAAA,eAAAgkB,EAAArkB,OAAA,iBAiBsI,GAhB7JkpB,EAAOnrB,KAAKmrB,KACZynC,EAAOznC,EAAKgoC,eAAcN,EACM7yD,KAAK4xD,QAAnCkB,EAAKD,EAALC,MAAO7zC,EAAK4zC,EAAL5zC,MAAOwyC,EAAWoB,EAAXpB,YACtBtmC,EAAKioC,UAAU/zC,YAAcyzC,EAAM/uD,KACnConB,EAAKmmC,cAAczzD,MAAQ,GAE3BgX,GAAImD,MAAM46C,GACV/9C,GAAI2E,KAAKo5C,EAAMznC,EAAKwmC,aAAcxmC,EAAKkoC,aACvCrzD,KAAKmrB,KAAKq8B,UAAU/nC,IAAM5K,GAAImK,SAASC,EAAMN,QACzC8yC,IACFtmC,EAAKmoC,gBAAgB7zC,IAAM5K,GAAImK,SAASyyC,EAAY9yC,QACpDwM,EAAKooC,gBAAgBl0C,YAAcoyC,EAAY1tD,KAC/C8Q,GAAIyE,KAAK6R,EAAKkoC,cAGVN,EAAQtB,EAAcA,EAAYrvD,KAAO,QACzC4wD,EAAaD,EAAQA,EAAMS,iBAAoBV,EAAqBU,iBAAoBV,EAAqBU,iBAAmB,CAAEV,EAAgBlsD,aAEzIrD,OAAS,GAAC,CAAA+iB,EAAAhkB,KAAA,SACvBuS,GAAIyE,KAAKs5C,GAAKxnD,EAAAC,GACK2nD,GAAU1sC,EAAAzhB,KAAA,GAAAouD,EAAAj2D,IAAAA,MAAA,SAAAi2D,IAAA,IAAAQ,EAAAC,EAAA,OAAA12D,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAAlBmxD,EAAItoD,EAAAtN,OACP61D,EAAMvoC,EAAKskC,cAAchkC,WAAU,IACrClN,QAAQ4G,QAAUsuC,EAAK5nC,YAC3B6nC,EAAIr0C,YAAco0C,EAAKC,IACvBd,EAAKt6C,YAAYo7C,GACjB7+C,GAAI1K,KAAKupD,EAAK,SAAS,WAAM,IACGr+C,EADHC,EAAAjK,GACXwJ,GAAIqD,KAAK06C,IAAK,IAA9B,IAAAt9C,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAY2T,EAAAxX,MAAsB8a,UAAUM,OAAO,WAAW,OAAAva,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CAC9D6nD,EAAI/6C,UAAUC,IAAI,YAClBgP,EAAK24B,OAAOkT,EACd,IAAE,wBAAA3vC,EAAA9e,OAAA,GAAAiuD,EAAA,IAAA7nD,EAAAG,IAAA,YAAAJ,EAAAC,EAAA5E,KAAA9E,KAAA,CAAA4kB,EAAAhkB,KAAA,gBAAAgkB,EAAAzgB,cAAAotD,IAAA,iBAAA3sC,EAAAhkB,KAAA,iBAAAgkB,EAAAhkB,KAAA,iBAAAgkB,EAAAzhB,KAAA,GAAAyhB,EAAAqtC,GAAArtC,EAAA,UAAAlb,EAAAQ,EAAA0a,EAAAqtC,IAAA,eAAArtC,EAAAzhB,KAAA,GAAAuG,EAAAS,IAAAya,EAAA3gB,OAAA,YAEJslB,KAAM2oC,aAAahB,GACLA,EAAK/6C,WACbc,UAAUC,IAAI,YAAW,eAAA0N,EAAAhkB,KAAA,GAG3BtC,KAAKugD,OAAOvgD,KAAK4xD,QAAQF,aAAY,YACvCzyC,EAAM40C,sBAAuB,CAAFvtC,EAAAhkB,KAAA,gBAAAgkB,EAAAhkB,KAAA,GAAQtC,KAAKgyD,gBAAe,yBAAA1rC,EAAAthB,OAAA,GAAA6e,EAAA,0BAC5D,SAAAxV,GAAA,OAAAwiD,EAAAjoD,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,MAGA,SAAYkgB,GACV,GAAI/d,KAAK4xD,SAAW5xD,KAAK4xD,QAAQ3yC,MAAMhK,KAAO8I,EAAS,OAAO,EAC9D,IAAMkB,EAAQgM,KAAMoW,OAAOtjB,GACrBiuB,EAAQ/sB,EAAM+sB,MACpB,IAAKA,EAAO,CACV,IAAK/sB,EAAM7c,KAAM,MAAMZ,MAAM,4CAE7B,OADAxB,KAAK4xD,QAAU,CAAE3yC,MAAAA,EAAO6zC,MAAO7zC,EAAM7c,KAAMsvD,YAAazyC,EAAM7c,KAAKoxD,iBAAiB,KAC7E,CACT,CACA,IAAM/B,EAAcxmC,KAAM6gB,KAAKzK,OAAO2K,EAAMC,UAC5C,GAAIwlB,EAAYrsC,OAId,OADAplB,KAAK4xD,QAAU,CAAE3yC,MAAAA,EAAO6zC,MAAO9mB,EAAO0lB,YAAa1lB,EAAMplC,aAClD,EAET,IAAK6qD,EAAYrvD,KAAM,MAAMZ,MAAM,mCAEnC,OADAxB,KAAK4xD,QAAU,CAAE3yC,MAAAA,EAAOwyC,YAAAA,EAAaqB,MAAO9mB,EAAO0lB,YAAaD,EAAYrvD,KAAKoxD,iBAAiB,KAC3F,CACT,GAAC,CAAA71D,IAAA,SAAAE,OAAA+yD,EAAAnoD,EAAAzL,IAAAA,MAED,SAAAopB,EAAc0tC,GAA2B,IAAA3oC,EAAA4oC,EAAAC,EAAAC,EAAAl5C,EAAAD,EAAAo5C,EAAAj1C,EAAAwyC,EAAAqB,EAAAqB,EAAAC,EAAAv0C,EAAAD,EAAAy0C,EAAAC,EAAAv0C,EAAAD,EAAA,OAAA9iB,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,OACjC6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK4xD,QAAQF,YAAcoC,EAC3Bj/C,GAAI2E,KAAK2R,EAAKopC,wBAAyBppC,EAAKqpC,WAAYrpC,EAAKspC,kBACvDV,EAAYD,EAAUY,WACtBV,EAAaF,EAAUa,YAAc,IAIhCpD,KAAI,SAACjmC,GAId,OAHIA,EAAIspC,kBAAoB3pC,KAAM4pC,YAAc,IAC9CvpC,EAAG,QAAWwpC,GAAW,IAAIlqD,OAExB0gB,CACT,IAGI2oC,GAAmB,EAAKl5C,EAAA1P,GACV2oD,GAAU3pC,EAAAxlB,KAAA,EAAAkW,EAAAxP,IAAA,YAAAuP,EAAAC,EAAAvU,KAAA9E,KAAE,CAAF2oB,EAAA/nB,KAAA,SAAd,IAAAwY,EAAAjd,MACJ6pD,SAAU,CAAFr9B,EAAA/nB,KAAA,SACS,OAAvB2xD,GAAmB,EAAI5pC,EAAApoB,OAAA,oBAAAooB,EAAA/nB,KAAA,iBAAA+nB,EAAA/nB,KAAA,iBAAA+nB,EAAAxlB,KAAA,GAAAwlB,EAAA3c,GAAA2c,EAAA,SAAAtP,EAAAnP,EAAAye,EAAA3c,IAAA,eAAA2c,EAAAxlB,KAAA,GAAAkW,EAAAlP,IAAAwe,EAAA1kB,OAAA,YAmB3B,GAnB2BuuD,EAIWl0D,KAAK4xD,QAAnC3yC,EAAKi1C,EAALj1C,MAAOwyC,EAAWyC,EAAXzC,YAAaqB,EAAKoB,EAALpB,OACtBqB,EAAmBL,EAAUiB,QAAU/mC,QAAQ/O,EAAM+sB,UAClCioB,GACvBp/C,GAAI2E,KAAK2R,EAAK6pC,sBACdngD,GAAIyE,KAAK6R,EAAKqpC,aACLL,GACTt/C,GAAIyE,KAAK6R,EAAKopC,wBAAyBppC,EAAK6pC,sBAC5C7pC,EAAKmmC,cAAczzD,MAAQ,GAC3BstB,EAAK4kC,UAAU1wC,YAAc9C,GV/UV,YUiVnB1H,GAAIyE,KAAK6R,EAAKopC,wBAAyBppC,EAAK6pC,sBACvClB,EAAUmB,QAAQpgD,GAAIyE,KAAK6R,EAAKspC,kBACrCtpC,EAAK4kC,UAAU1wC,YAAc9C,GVpVb,QUuVdk1C,EAAa,CACT2C,EAAqB/nD,KAAKG,MAAMH,KAAKC,UAAU0nD,IAGrDn0C,EAAAxU,GACkB+oD,GAAkB,IAApC,IAAAv0C,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAcke,EAAA/hB,MAA4Bq3D,SAAWzD,EAAYx8C,EAAE,OAAAvW,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CAEnE,IADMwoD,EAAavB,EAAgBlsD,WAAW+tD,YAAc,IAC9CpxD,OAAS,EAAG,CAClB+wD,EAAgBjoD,KAAKG,MAAMH,KAAKC,UAAU+nD,IAAWt0C,EAAA1U,GACzCipD,GAAa,IAA/B,IAAAv0C,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,MAAcoe,EAAAjiB,MAAuBq3D,SAAWj2C,EAAMhK,EAAE,OAAAvW,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CACxDuoD,EAAmBpxD,KAAI4F,MAAvBwrD,EAAkB1sD,EAAS4sD,GAC7B,CACAt0D,KAAK0vD,QAAQnP,OAAOthC,EAAMhK,GAAIm/C,GAAoB,EACpD,MAAOp0D,KAAK0vD,QAAQnP,OAAOthC,EAAMhK,GAAI++C,GAAY,GAMT,OALxCh0D,KAAKm1D,aAAapB,GAIdD,EAAUiB,QAAU/mC,QAAQhuB,KAAK4xD,QAAQ3yC,MAAM+sB,OAAQn3B,GAAI2E,KAAKxZ,KAAK0vD,QAAQ0F,cAC5EvgD,GAAIyE,KAAKtZ,KAAK0vD,QAAQ0F,cAAa/qC,EAAA/nB,KAAA,GAElCtC,KAAKq1D,eAAc,yBAAAhrC,EAAArlB,OAAA,GAAAohB,EAAA,yBAC1B,SAAA1C,GAAA,OAAAktC,EAAAhoD,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,MAED,SAAck2D,GACZl/C,GAAI2E,KAAKxZ,KAAK6vD,gBACI,KAAdkE,IACF/zD,KAAK6vD,eAAe1jB,KAAO4nB,EAC3Bl/C,GAAIyE,KAAKtZ,KAAK6vD,gBAElB,GAEA,CAAAlyD,IAAA,WAAAE,OAAA8yD,EAAAloD,EAAAzL,IAAAA,MACA,SAAA+sB,EAAgBurC,GAAc,OAAAt4D,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OAC5BtC,KAAKmrB,KAAKwmC,aAAatyC,YAAci2C,EACrCzgD,GAAIyE,KAAKtZ,KAAKmrB,KAAKwmC,cAAa,wBAAAtjB,EAAArpC,OAAA,GAAA+kB,EAAA,UACjC,SAAAtD,GAAA,OAAAkqC,EAAA/nD,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,OAAA6yD,EAAAjoD,EAAAzL,IAAAA,MAKA,SAAAmxC,IAAA,IAAAonB,EAAAt2C,EAAAwyC,EAAAC,EAAA8D,EAAAlX,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,OAEyC,GADvCizD,EAC4Cv1D,KAAK4xD,QAAzC3yC,EAAKs2C,EAALt2C,MAAOwyC,EAAW8D,EAAX9D,aAAaC,EAAW6D,EAAX7D,aACX+D,WAAY,CAAFve,EAAA50C,KAAA,eAAA40C,EAAAj1C,OAAA,iBACJ,GAAnBuzD,EAAWv2C,EAAMhK,IACjBw8C,EAAa,CAAFva,EAAA50C,KAAA,YACTovD,EAAYqD,OAAQ,CAAF7d,EAAA50C,KAAA,eAAA40C,EAAAj1C,OAAA,iBACtBuzD,EAAW/D,EAAYx8C,GAAE,OAEY,OAAjCqpC,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAAK1P,EAAA50C,KAAA,GACrBuL,EAAS,wBAAyB,CAClDkQ,QAASy3C,EACT91D,KAAMgyD,EAAYhyD,OAClB,QACM,GAJF0J,EAAG8tC,EAAAp1C,KAITw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF8tC,EAAA50C,KAAA,SACL,OAAtBtC,KAAK+xD,SAAS3oD,EAAIwE,KAAIspC,EAAAj1C,OAAA,kBAGxBjC,KAAK0vD,QAAQgG,gBAAgBtsD,EAAIqkC,QAAO,yBAAAyJ,EAAAlyC,OAAA,GAAAmpC,EAAA,UACzC,kBAAAuiB,EAAA9nD,MAAA,KAAAD,UAAA,MAAA0mD,CAAA,CAxUuB,GA2UtBsG,GAAsB,EAMbhG,GAAgB,WA2B3B,SAAAA,EAAa/I,EAAmBgP,GAAqB,IAAAztC,EAAA,KAAAtf,EAAA,KAAA8mD,GAAA7lD,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,8BAAAA,EAAA,0BAAAA,EAAA,0BAAAA,EAAA,2BAAAA,EAAA,2BAAAA,EAAA,6BAAAA,EAAA,6BAAAA,EAAA,4BAAAA,EAAA,8BAAAA,EAAA,4BAAAA,EAAA,yBAAAA,EAAA,sBAAAA,EAAA,yBAAAA,EAAA,wBAAAA,EAAA,wBAAAA,EAAA,2BAAAA,EAAA,6BAAAA,EAAA,iCAAAA,EAAA,8BAAAA,EAAA,kCAAAA,EAAA,+BAAAA,EAAA,oCAAAA,EAAA,uBACnD9J,KAAKmrB,KAAOtW,GAAIwoC,cAAcuJ,GAC9B5mD,KAAK4mD,KAAOA,EAEZ5mD,KAAK61D,eAAiB,GAEtB71D,KAAKg0D,WAAa,GAClBh0D,KAAK41D,WAAaA,EAGlB51D,KAAK81D,YAAcjhD,GAAIi7C,YAAYlJ,EAAM,eACzC5mD,KAAK+1D,YAAclhD,GAAIi7C,YAAYlJ,EAAM,eACzC5mD,KAAKg2D,cAAgBnhD,GAAIi7C,YAAYlJ,EAAM,aAC3C5mD,KAAKg2D,cAAc/8C,SACnBjZ,KAAKi2D,cAAgBphD,GAAIi7C,YAAYlJ,EAAM,aAC3C5mD,KAAKi2D,cAAch9C,SACnBjZ,KAAKk2D,aAAerhD,GAAIi7C,YAAYlJ,EAAM,YAC1C5mD,KAAKk2D,aAAaj9C,SAClBjZ,KAAKm2D,eAAiBthD,GAAIi7C,YAAYlJ,EAAM,mBAC5C5mD,KAAKm2D,eAAel9C,SACpBjZ,KAAKo1D,aAAevgD,GAAIi7C,YAAYlJ,EAAM,gBAC1C5mD,KAAKo2D,UAAYvhD,GAAIi7C,YAAYlJ,EAAM,aACvC5mD,KAAKs1D,OAASzgD,GAAIi7C,YAAYlJ,EAAM,UACpC5mD,KAAKq2D,UAAYxhD,GAAIi7C,YAAYlJ,EAAM,aACvC5mD,KAAKs2D,SAAWzhD,GAAIi7C,YAAYlJ,EAAM,YACtC5mD,KAAKu2D,SAAW1hD,GAAIi7C,YAAYlJ,EAAM,YACtC5mD,KAAKw2D,YAAc3hD,GAAIi7C,YAAYlJ,EAAM,eACzC5mD,KAAKy2D,cAAgB5hD,GAAIi7C,YAAYlJ,EAAM,iBAC3C5mD,KAAK02D,kBAAoB7hD,GAAIi7C,YAAYlJ,EAAM,qBAC/C5mD,KAAK22D,eAAiB9hD,GAAIi7C,YAAYlJ,EAAM,kBAC5C5mD,KAAK42D,mBAAqB/hD,GAAIi7C,YAAYlJ,EAAM,sBAChD5mD,KAAK62D,gBAAkBhiD,GAAIi7C,YAAYlJ,EAAM,mBAExCgP,GAAY/gD,GAAI2E,KAAKxZ,KAAKq2D,WAE/BxhD,GAAI1K,KAAKnK,KAAKo1D,aAAc,SAAS,kBAAMjtC,EAAKiuC,UAAUniC,OAAO,IAGjEpf,GAAI1K,KAAKnK,KAAKo2D,UAAW,SAAQ3tD,EAAAzL,IAAAA,MAAE,SAAAi6C,IAAA,OAAAj6C,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,cAAAi8C,EAAAt8C,OAAA,SAAYkmB,EAAK2uC,oBAAkB,wBAAAvY,EAAAv5C,OAAA,GAAAiyC,EAAA,MAEtEpiC,GAAI1K,KAAKnK,KAAKq2D,UAAW,SAAS,WAChCluC,EAAK4uC,oBAAoB5uC,EAAKouC,SAAS59C,UAAUhD,SAAS,UAC5D,GACF,CAEA,IAAAqhD,EAsPC,OAtPDrtD,EAAAgmD,EAAA,EAAAhyD,IAAA,mBAAAE,OAAAm5D,EAAAvuD,EAAAzL,IAAAA,MAKA,SAAAohD,IAAA,IAAA6Y,EAAAC,EAAA5Y,EAAA7Q,EAAArkC,EAAA6Q,EAAAk9C,EAAAC,EAAA,OAAAp6D,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,OACuB,GAArBuS,GAAI2E,KAAKxZ,KAAKs1D,QACTt1D,KAAKo2D,UAAUv4D,MAAO,CAAF8gD,EAAAr8C,KAAA,eAAAq8C,EAAA18C,OAAA,iBACS,IAA5Bi1D,EAAQl3D,KAAKo2D,UAAUc,QACE,IAAjBA,EAAM3zD,OAAY,CAAAo7C,EAAAr8C,KAAA,eAAAq8C,EAAA18C,OAAA,iBACO,OAAjCq8C,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAAKjI,EAAAr8C,KAAA,EAClB40D,EAAM,GAAGvpD,OAAM,OAAxB,GAAN8/B,EAAMkR,EAAA78C,KACC,CAAF68C,EAAAr8C,KAAA,gBAAAq8C,EAAA18C,OAAA,yBAAA08C,EAAAr8C,KAAA,GACOuL,EAAS,mBAAoB,CAC7CwpD,WAAY5pB,IACZ,QACM,GAHFrkC,EAAGu1C,EAAA78C,KAGTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFu1C,EAAAr8C,KAAA,SAEN,OADrBtC,KAAKs1D,OAAOj2C,YAAcjW,EAAIwE,IAC9BiH,GAAIyE,KAAKtZ,KAAKs1D,QAAO3W,EAAA18C,OAAA,qBAGa,IAAhC5E,OAAOkH,KAAK6E,EAAImoD,KAAKhuD,OAAY,CAAAo7C,EAAAr8C,KAAA,gBAAAq8C,EAAA18C,OAAA,mBACrCg1D,EAAAj3D,KAAK+1D,aAAYuB,OAAM1uD,MAAAquD,EAAAvvD,EAAI1H,KAAKu3D,UAAUnuD,EAAImoD,OAC9CvxD,KAAKw3D,QAAQx3D,KAAK+1D,aAAY97C,EACI,CAACja,KAAK22D,eAAej8C,SAASnX,OAAQvD,KAAK62D,gBAAgBn8C,SAASnX,QAAnF6zD,EAAWn9C,EAAA,GACX,KADZk9C,EAAUl9C,EAAA,KACKpF,GAAI2E,KAAKxZ,KAAK22D,eAAgB32D,KAAK02D,mBACrC,IAAhBU,GAAmBviD,GAAI2E,KAAKxZ,KAAK62D,gBAAiB72D,KAAK42D,oBACvDO,EAAaC,IAAgB,GAAGviD,GAAI2E,KAAKxZ,KAAKq2D,UAAWr2D,KAAKy2D,eAAc,yBAAA9X,EAAA35C,OAAA,GAAAo5C,EAAA,UACjF,kBAAA4Y,EAAApuD,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,MAED,SAAQuY,EAAkBkV,EAAmBmsC,EAA2BC,GAAoC,IAAAC,EACtG3iD,EADsG6hB,EAAA,KAE1G,GAAIvL,EAAIssC,UAAW5iD,EAAKhV,KAAKk2D,aAAazqC,WAAU,QAC/C,GAAIH,EAAIusC,OAAQ7iD,EAAKhV,KAAKi2D,cAAcxqC,WAAU,QAClD,GAAIH,EAAIwsC,YAMX,IALA9iD,EAAKhV,KAAKm2D,eAAe1qC,WAAU,IAChC9S,UAAUC,IAAI,cACjB/D,GAAI1K,KAAK0K,GAAIi7C,YAAY96C,EAAI,OAAQ,SAAS,WAC5C6hB,EAAKkhC,OAAO3hD,EAAKkV,EAAKtW,GAAI,EAC5B,KACK0iD,EAAa,IAAK,IAAIl0D,EAAI,EAAGA,GAAK8nB,EAAI0sC,QAAU1sC,EAAI0sC,QAAU,EAAI,GAAIx0D,IAAKxD,KAAK+3D,OAAO3hD,EAAKkV,EAAKmsC,GAAa,QAC9GziD,EAAKhV,KAAKg2D,cAAcvqC,WAAU,IAEF,MADiB,QAAnCksC,EAAA1sC,KAAMgtC,gBAAgBj4D,KAAK+d,gBAAQ,IAAA45C,OAAA,EAAnCA,EAAqCO,eAAgB,IACzDt5C,QAAQ0M,EAAI3tB,MAAakX,GAAI2E,KAAKxE,GACnDhV,KAAK61D,eAAe7yD,KAAK,CAACsoB,EAAKtW,IAC/B,IAAM/L,EAAQ+L,EAAGE,cAAc,SAC/BjM,EAAMsV,QAAQ45C,UAAY7sC,EAAI3tB,IAG9Bg4D,KACA,IAAMyC,EAAO,QAAU9uD,OAAOqsD,IAC9B1sD,EAAMgM,GAAKmjD,EACX,IAAMzqC,EAAQ9Y,GAAIyJ,aAAatJ,EAAI,SAGnC,GAFA2Y,EAAM0qC,QAAUD,EAChBzqC,EAAM2qC,QAAQhtC,EAAIM,kBACGnqB,IAAjB6pB,EAAI4pC,SAAwB,CAC9B,IAAMpoB,EAAO,IAAI5gC,OAAO8lC,MAAM,GAAI,IAClClF,EAAKrtB,IAAM5K,GAAI0jD,eAAejtC,EAAI4pC,WAAa,GAC/CvnC,EAAM2qC,QAAQxrB,EAChB,CAQA,GAPI2qB,EAAaA,EAAYe,MAAMxjD,GAC9BoB,EAAIkC,YAAYtD,GACjBsW,EAAImtC,SACNxvD,EAAMvJ,KAAO,WACbuJ,EAAMyvD,aAAe,OAEnBptC,EAAIO,cAAa8B,EAAMpP,QAAQ4G,QAAUmG,EAAIO,aAC7CP,EAAIssC,UAAW3uD,EAAM0vD,QAAUrtC,EAAG,aACjC,GAAIA,EAAIusC,OAAQ,CACnB,IAAMe,EAAe,SAACC,GACpB,OAAKA,EACwBC,GAAd,QAAXD,EAAsC,IAAIjuD,KAC1B,IAAIA,KAA0B,IAApBiuD,IAFV,EAGtB,EACA5vD,EAAMqL,IAAMskD,EAAattC,EAAIhX,KAC7BrL,EAAMoL,IAAMukD,EAAattC,EAAIjX,KAC7B,IAAM0kD,EAAOztC,EAAG,QAAW,IAAI1gB,KAAmB,IAAd0gB,EAAG,SAAmB,IAAI1gB,KAI9D3B,EAAMpL,MAAQi7D,GAAaC,EAC7B,MAAO9vD,EAAMpL,MAAwB,OAAhBytB,EAAG,QAAoBA,EAAG,QAAW,GAE1D,OADAriB,EAAMic,SAAW8I,QAAQ1C,EAAI0tC,mBAAqBh5D,KAAKi5D,sBAChDjkD,CACT,GAEA,CAAArX,IAAA,SAAAE,MAGA,SAAQkgB,EAAiBi2C,EAAmCkF,GAQ1D,GAPAl5D,KAAKi5D,qBAAuBC,EAC5Bl5D,KAAK61D,eAAiB,GACtB71D,KAAKg0D,WAAaA,GAAc,GAChCh0D,KAAK+d,QAAUA,EACflJ,GAAImD,MAAMhY,KAAK+1D,YAAa/1D,KAAK62D,gBAAiB72D,KAAK22D,gBAGxB,IAA3B32D,KAAKg0D,WAAWzwD,OAAc,OAAOsR,GAAI2E,KAAKxZ,KAAK4mD,MACvD/xC,GAAIyE,KAAKtZ,KAAK4mD,MAEd5mD,KAAK+2D,qBAAoB,GACzBliD,GAAI2E,KACFxZ,KAAK02D,kBAAmB12D,KAAK22D,eAAgB32D,KAAK42D,mBAClD52D,KAAK62D,gBAAiB72D,KAAKs1D,QAE7B,IACiCj1C,EAD3B84C,EAAgB,GAAE74C,EAAAjV,GACNrL,KAAKg0D,YAAU,IAAjC,IAAA1zC,EAAA/U,MAAA8U,EAAAC,EAAA9Z,KAAA9E,MAAmC,KAAxB4pB,EAAGjL,EAAAxiB,MACRmC,KAAK41D,YAA8B,OAAhBtqC,EAAG,QAAmB6tC,EAAcn2D,KAAKsoB,GAC3DtrB,KAAK+3D,OAAO/3D,KAAK+1D,YAAazqC,EACrC,CAAC,OAAA5sB,GAAA4hB,EAAA1U,EAAAlN,EAAA,SAAA4hB,EAAAzU,GAAA,CACD,GAAIstD,EAAc51D,OAAQ,KACO61D,EADPC,EAAAhuD,GACN8tD,GAAa,IAA/B,IAAAE,EAAA9tD,MAAA6tD,EAAAC,EAAA7yD,KAAA9E,MAAiC,KAAtB4pB,EAAG8tC,EAAAv7D,MAAmBmC,KAAK+3D,OAAO/3D,KAAK62D,gBAAiBvrC,EAAG,CAAC,OAAA5sB,GAAA26D,EAAAztD,EAAAlN,EAAA,SAAA26D,EAAAxtD,GAAA,CACvEgJ,GAAIyE,KAAKtZ,KAAKq2D,UAAWr2D,KAAK42D,mBAAoB52D,KAAK62D,gBACzD,MACEhiD,GAAI2E,KAAKxZ,KAAKq2D,WAEhBprC,KAAM2oC,aAAa5zD,KAAK81D,aACpB91D,KAAK+1D,YAAYr7C,SAASnX,OAAQsR,GAAIyE,KAAKtZ,KAAK+1D,aAC/ClhD,GAAI2E,KAAKxZ,KAAK+1D,YACrB,GAEA,CAAAp4D,IAAA,sBAAAE,MAGA,SAAqBs1B,GACnB,GAAIA,EAIF,OAHAte,GAAI2E,KAAKxZ,KAAKs2D,UACdzhD,GAAIyE,KAAKtZ,KAAKu2D,SAAUv2D,KAAKy2D,oBAC7Bz2D,KAAKw2D,YAAYn3C,YAAc9C,GV1oBM,6BU6oBvC1H,GAAI2E,KAAKxZ,KAAKu2D,SAAUv2D,KAAKy2D,eAC7B5hD,GAAIyE,KAAKtZ,KAAKs2D,UACdt2D,KAAKw2D,YAAYn3C,YAAc9C,GV9oBQ,2BU+oBzC,GAEA,CAAA5e,IAAA,YAAAE,MAKA,SAAWyuB,GAIT,IAHA,IAojDqB/gB,EApjDf+tD,EAAuB,GACvBC,EAA8C,CAAC,EAC/CC,EAAyC,GAC/C3xD,EAAA,EAAAK,EAAAR,EAAoB1H,KAAK61D,gBAAchuD,EAAAK,EAAA3E,OAAAsE,IAAG,CAArC,IAAMqS,EAAChS,EAAAL,GACVI,EAAAL,EAAkBsS,EAAC,GAAZoR,EAAGrjB,EAAA,GAAE+M,EAAE/M,EAAA,GACRyD,EAAI4gB,EAAIhB,EAAI3tB,KAClB,QAAU8D,IAANiK,EACJ,GAAI4f,EAAIwsC,WAAR,CACE,GAAIyB,EAAmBjuC,EAAI3tB,KAAM,CAC/BqX,EAAGiE,SACHugD,EAAQx2D,KAAKkX,GACb,QACF,CACAq/C,EAAmBjuC,EAAI3tB,MAAO,EAC9B,IAAM87D,EAAO/tD,EAAEJ,MAAMggB,EAAIwsC,YACnB4B,EAAWD,EAAK,GACtBH,EAAMt2D,KAAKgS,GACXH,GAAIyJ,aAAatJ,EAAI,SAASnX,MAAQ67D,EAItC,IAAK,IAAIl2D,EAAI,EAAGA,GAAK8nB,EAAI0sC,SAAW,GAAIx0D,IAAK81D,EAAMt2D,KAAKhD,KAAK+3D,OAAO/iD,EAAGuN,cAA8B+I,EAAKtW,GAAI,IAC9G,IAAK,IAAIxR,EAAI,EAAGA,EAAIi2D,EAAKl2D,OAAQC,IAAK,CACpC,IAAMm2D,EAAQ35D,KAAK+3D,OAAO/iD,EAAGuN,cAA8B+I,EAAKtW,GAAI,GACpEH,GAAIyJ,aAAaq7C,EAAO,SAAS97D,MAAQ47D,EAAKj2D,GAC9C81D,EAAMt2D,KAAK22D,EACb,CAEF,KArBA,CAsBAL,EAAMt2D,KAAKgS,GACX,IAAM/L,EAAQ4L,GAAIyJ,aAAatJ,EAAI,SAC/BsW,EAAIssC,UAAW3uD,EAAM0vD,QAshDhB,OADUptD,EArhD+BG,IAshDd,SAApBH,EAAEmkB,cArhDTpE,EAAIusC,OACX5uD,EAAMpL,MAAQi7D,GAAa,IAAIluD,KAAmB,IAAdiI,SAASnH,KAExCzC,EAAMpL,MAAQ6N,CAPrB,CAQF,CACA,IAAK,IAAL0M,EAAA,EAAAwhD,EAAgBJ,EAAOphD,EAAAwhD,EAAAr2D,OAAA6U,IAAE,CAApB,IAAM8B,EAAC0/C,EAAAxhD,GACJ5U,EAAIxD,KAAK61D,eAAej3C,QAAQ1E,GAClC1W,GAAK,GAAGxD,KAAK61D,eAAegE,OAAOr2D,EAAG,EAC5C,CAEA,OAAO81D,CACT,GAEA,CAAA37D,IAAA,kBAAAE,MAIA,SAAiByuB,GAA6B,IAAAwtC,EACtCR,EAAQt5D,KAAKu3D,UAAUjrC,GACxBtsB,KAAK41D,YAA+B,IAAjB0D,EAAM/1D,UAC9Bu2D,EAAA95D,KAAK22D,gBAAeW,OAAM1uD,MAAAkxD,EAAApyD,EAAI4xD,IAC9Bt5D,KAAKw3D,QAAQx3D,KAAK22D,gBAClB9hD,GAAIyE,KAAKtZ,KAAK22D,eAAgB32D,KAAK02D,mBACU,IAAzC12D,KAAK62D,gBAAgBn8C,SAASnX,QAAcsR,GAAI2E,KAAKxZ,KAAK62D,gBAAiB72D,KAAK42D,oBACtF,GAEA,CAAAj5D,IAAA,MAAAE,MAIA,SAAKkgB,GACH,IAC2Cg8C,EADrCtsB,EAAiC,CAAC,EAACusB,EAAA3uD,GACjBrL,KAAK61D,gBAAc,IAA3C,IAAAmE,EAAAzuD,MAAAwuD,EAAAC,EAAAxzD,KAAA9E,MAA6C,KAAAu4D,EAAAryD,EAAAmyD,EAAAl8D,MAAA,GAAjCytB,EAAG2uC,EAAA,GAAEjlD,EAAEilD,EAAA,GACXhxD,EAAQ4L,GAAIyJ,aAAatJ,EAAI,SACnC,QAAqBvT,IAAjB6pB,EAAI4pC,UAA0B5pC,EAAI4pC,WAAan3C,EACnD,GAAIuN,EAAIssC,WAAatsC,EAAI3tB,IACvB8vC,EAAOniB,EAAI3tB,KAAOsL,EAAM0vD,QAAU,IAAM,SACnC,GAAIrtC,EAAIusC,QAAUvsC,EAAI3tB,IAAK,CAGhC,IAAMu8D,EAAUjxD,EAAMoL,IAAMygD,GAAW,IAAIlqD,KAAK3B,EAAMoL,IAAM,WAAa8G,OAAOg/C,iBAC1EC,EAAUnxD,EAAMqL,IAAMwgD,GAAW,IAAIlqD,KAAK3B,EAAMqL,IAAM,WAAa6G,OAAOmI,iBAC5Ey1C,EAAO9vD,EAAMpL,MAAQi3D,GAAW,IAAIlqD,KAAK3B,EAAMpL,MAAQ,WAAa,EACpEk7D,EAAOmB,EAASnB,EAAOmB,EAClBnB,EAAOqB,IAASrB,EAAOqB,GAChC3sB,EAAOniB,EAAI3tB,KAAO2L,OAAOyvD,EAC3B,MAAW9vD,EAAMpL,QACXytB,EAAIwsC,YAAcrqB,EAAOniB,EAAI3tB,KAAM8vC,EAAOniB,EAAI3tB,MAAQ2tB,EAAIwsC,WAAa7uD,EAAMpL,MAC5E4vC,EAAOniB,EAAI3tB,KAAOsL,EAAMpL,MAEjC,CAAC,OAAAa,GAAAs7D,EAAApuD,EAAAlN,EAAA,SAAAs7D,EAAAnuD,GAAA,CACD,OAAO4hC,CACT,GAEA,CAAA9vC,IAAA,UAAAE,MAIA,SAASuY,GAAkB,IAAAmhB,EAAA,KACnB8iC,EAAwC,CAAC,EAC/CjkD,EAAIqE,iBAAiB,SAASla,SAAQ,SAAC0I,GACrC,IAAMwC,EAAIxC,EAAMsV,QAAQ45C,UACxB,GAAK1sD,EAAL,CACA,IAC2C6uD,EADrC7iD,EAAM,GAAE8iD,EAAAlvD,GACUksB,EAAKs+B,gBAAc,IAA3C,IAAA0E,EAAAhvD,MAAA+uD,EAAAC,EAAA/zD,KAAA9E,MAA6C,KAAA84D,EAAA5yD,EAAA0yD,EAAAz8D,MAAA,GAAjCytB,EAAGkvC,EAAA,GAAExlD,EAAEwlD,EAAA,GAA8BlvC,EAAI3tB,MAAQ8N,GAAGgM,EAAIzU,KAAKgS,EAAE,CAAC,OAAAtW,GAAA67D,EAAA3uD,EAAAlN,EAAA,SAAA67D,EAAA1uD,GAAA,CAC5EwuD,EAAO5uD,GAAKgM,CAHE,CAIhB,IAAE,IAC+BgjD,EAD/BC,EAAArvD,GACgBrL,KAAKg0D,YAAU,IAAjC,IAAA0G,EAAAnvD,MAAAkvD,EAAAC,EAAAl0D,KAAA9E,MAAmC,KAEbi5D,EAFXrvC,EAAGmvC,EAAA58D,MACqB+8D,EAAAvvD,GAArBgvD,EAAO/uC,EAAI3tB,MAAQ,IACX,IAApB,IAAAi9D,EAAArvD,MAAAovD,EAAAC,EAAAp0D,KAAA9E,MAAsB,KAAXsT,EAAE2lD,EAAA98D,MAASuY,EAAIkhD,OAAOtiD,EAAE,CAAC,OAAAtW,GAAAk8D,EAAAhvD,EAAAlN,EAAA,SAAAk8D,EAAA/uD,GAAA,CACtC,CAAC,OAAAnN,GAAAg8D,EAAA9uD,EAAAlN,EAAA,SAAAg8D,EAAA7uD,GAAA,CACH,KAAC8jD,CAAA,CA9T0B,GAqUhBkL,GAAuB,WAUlC,SAAAA,EAAajU,EAAmB0I,EAAqBE,GAAoB,IAAAh3B,EAAA,KAAA3vB,EAAA,KAAAgyD,GAAA/wD,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,oBAAAA,EAAA,kBAAAA,EAAA,wBAAAA,EAAA,2BAAAA,EAAA,oBAAAA,EAAA,oBACvE9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EACftvD,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,GAC9B5mD,KAAK86D,SAAW,GAEhBjmD,GAAI1K,KAAKnK,KAAKmrB,KAAKqkC,OAAQ,SAAS,kBAAMA,GAAQ,IAClDrlD,GAAKy8C,EAAM5mD,KAAKmrB,KAAK6kC,QAAQ,kBAAMx3B,EAAKuiC,YAAY,GACtD,CAgDA,IAAAC,EAZAjmD,EAqDC,OAzFApL,EAAAkxD,EAAA,EAAAl9D,IAAA,cAAAE,MAED,SAAao9D,EAAcH,GACzB96D,KAAKi7D,GAAKA,EACVj7D,KAAK86D,SAAWA,EAChB96D,KAAKmrB,KAAKmc,KAAKjoB,YAAc47C,EAAG3zB,IAClC,GAAC,CAAA3pC,IAAA,WAAAE,MAED,SAAUkgB,EAAiBm9C,EAAcjhB,GACvC,IAAMh7B,EAAQgM,KAAMoW,OAAOtjB,GAC3Bo9C,EAAmCl8C,EAAMvK,SAASC,aAA1CC,EAAgBumD,EAAhBvmD,iBAAkBkI,EAAIq+C,EAAJr+C,KAC1B9c,KAAKo7D,YAAcn8C,EAAMhK,GACzBjV,KAAKk7D,KAAOA,EACZl7D,KAAKi6C,KAAOA,EACZ,IAAM9uB,EAAOnrB,KAAKmrB,KAGZkwC,EAFYr7D,KAAKi7D,GAAGK,WAAWr8C,EAAMN,QAChB0D,OAAS64C,EHlyBH,EGmyBOtmD,EACxCuW,EAAKowC,YAAYl8C,YAAc/V,OAAO4xD,GACtC/vC,EAAK2hB,KAAKrtB,IAAM5K,GAAImK,SAASC,EAAMN,QACnCwM,EAAKqwC,SAASn8C,YAAcxK,GAAIiJ,kBAAkBu9C,GAClDlwC,EAAKswC,SAASp8C,YAAcvC,EAC5B,IAAM5C,EAAI+Q,KAAMymB,aAAa3zB,GAC7BlJ,GAAIyE,KAAK6R,EAAKuwC,gBACVxhD,EAAGiR,EAAKwwC,YAAYt8C,YAAcxK,GAAIiJ,kBAAkBu9C,EAAuBnhD,GAC9ErF,GAAI2E,KAAK2R,EAAKuwC,gBACfzhB,IAAM9uB,EAAKywC,YAAYv8C,YAAcxK,GAAIiJ,kBAAkBm8B,EAAOrlC,IACtEuW,EAAK0wC,aAAax8C,YAAcvC,CAClC,GAAC,CAAAnf,IAAA,UAAAE,MAED,SAASkgB,EAAiBk8B,GACxBj6C,KAAKi6C,KAAOA,EACZ,IAAMrlC,EAAmBqW,KAAMoW,OAAOtjB,GAASrJ,SAASC,aAAaC,iBACrE5U,KAAKmrB,KAAKywC,YAAYv8C,YAAcxK,GAAIiJ,kBAAkBm8B,EAAOrlC,EACnE,GAEA,CAAAjX,IAAA,UAAAE,OAAAkX,EAAAtM,EAAAzL,IAAAA,MACA,SAAA0hD,IAAA,IAAAkI,EAAA,OAAA5pD,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,OACQskD,EAAO5mD,KAAK4mD,KAClB/xC,GAAIyF,QAAQ,KAAK,SAAAsrB,GACfghB,EAAKrsC,MAAMuhD,UAAY,SAAH/vD,OAAY65B,EAAI,KACpCghB,EAAKrsC,MAAMwhD,QAAUzyD,OAAO2J,KAAKsR,IAAIqhB,EAAM,IAC3C,IAAMo2B,EAAS,GAAHjwD,OAAmB,KAAZ,EAAI65B,GAAW,MAClCghB,EAAKrsC,MAAMrE,IAAM8lD,EACjBpV,EAAKrsC,MAAMxE,KAAOimD,CACpB,IAAE,wBAAArc,EAAA36C,OAAA,GAAA05C,EAAA,UACH,kBAAA3pC,EAAAnM,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,OAAAm9D,EAAAvyD,EAAAzL,IAAAA,MAGA,SAAAkiD,IAAA,IAAA/zB,EAAAiwC,EAAAH,EAAAH,EAAAI,EAAAj8C,EAAAg9C,EAAAC,EAAAtV,EAAAuV,EAAA7d,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAo/D,GAAA,cAAAA,EAAAv3D,KAAAu3D,EAAA95D,MAAA,OAEyC,GAD/B6oB,EAA0CnrB,KAA1CmrB,KAAMiwC,EAAoCp7D,KAApCo7D,YAAaH,EAAuBj7D,KAAvBi7D,GAAIH,EAAmB96D,KAAnB86D,SAAUI,EAASl7D,KAATk7D,KACnCj8C,EAAQgM,KAAMoW,OAAO+5B,GACf,CAAFgB,EAAA95D,KAAA,QAEa,OADrB6oB,EAAKkxC,OAAOC,UAAY//C,GV/uBkB,iCUgvB1C1H,GAAIyE,KAAK6R,EAAKkxC,QAAOD,EAAAn6D,OAAA,iBAwBgB,OArBvC4S,GAAI2E,KAAK2R,EAAKkxC,QACRJ,EAAYhB,EAAGK,WAAWr8C,EAAMmG,OAAOzG,QACvCu9C,EAAUjB,EAAG3zB,MAGdrc,KAAMuc,UAAUyzB,EAAG3zB,OAASrc,KAAMuc,UAAUyzB,EAAG3zB,MAAMi1B,UACxD3V,EAAO,CACL75C,KAAMmvD,EACNM,KAAM1B,EACN2B,KAAMR,EAAU55C,OAAS64C,EACzBj8C,MAAOg9C,EAAUhnD,IAEnBknD,EAAM,kBAENvV,EAAO,CACLtf,KAAM40B,EACNrzB,WAAYqyB,EACZE,YAAaA,GAEfe,EAAM,0BAEF7d,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAAKwV,EAAA95D,KAAA,GACrBuL,EAASsuD,EAAKvV,GAAK,QAC7B,GADFx9C,EAAGgzD,EAAAt6D,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFgzD,EAAA95D,KAAA,SAEN,OADrB6oB,EAAKkxC,OAAOh9C,YAAcjW,EAAIwE,IAC9BiH,GAAIyE,KAAK6R,EAAKkxC,QAAOD,EAAAn6D,OAAA,kBAGvBjC,KAAKsvD,UAAS,yBAAA8M,EAAAp3D,OAAA,GAAAk6C,EAAA,UACf,kBAAA8b,EAAApyD,MAAA,KAAAD,UAAA,MAAAkyD,CAAA,CA3GiC,GA2HvB6B,GAAqB,WAUhC,SAAAA,EAAa9V,EAAmB0I,GAA2D,IAAAr1B,EAAA,KAAApxB,EAAA,KAAA6zD,GAAA5yD,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,kBAAAA,EAAA,+BAAAA,EAAA,wBAAAA,EAAA,oBAAAA,EAAA,yBAAAA,EAAA,0BACzF9J,KAAK4mD,KAAOA,EACZ5mD,KAAK86D,SAAW,GAChB96D,KAAKsvD,QAAUA,EACf,IAAMnkC,EAAOnrB,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,GAC3C/xC,GAAIuyB,eAAejc,EAAKwxC,gBAAiBxxC,EAAKyxC,cAAezxC,EAAK0xC,YAElEhoD,GAAI1K,KAAKghB,EAAK2xC,iBAAkB,SAAS,WAAQ7iC,EAAK8iC,SAAU,IAChEloD,GAAI1K,KAAKghB,EAAK2xC,iBAAkB,SAAS,SAAClxD,GAAqC,UAAVA,EAAEjO,KAAiBs8B,EAAK+iC,YAAa,IAC1GnoD,GAAI1K,KAAKghB,EAAK8xC,kBAAmB,SAAS,WAAQhjC,EAAK+iC,YAAa,IAEpEnoD,GAAI1K,KAAKghB,EAAK+xC,OAAQ,SAAS,WAAQjjC,EAAKkjC,eAAc,EAAM,IAChEtoD,GAAI1K,KAAKghB,EAAKiyC,SAAU,SAAS,WAAQnjC,EAAKkjC,eAAc,EAAO,IAEnEtoD,GAAI1K,KAAKghB,EAAKkyC,eAAgB,SAAS,WACrCxoD,GAAI2E,KAAK2R,EAAKmyC,iBACdzoD,GAAIyE,KAAK6R,EAAKoyC,UAChB,IAEA1oD,GAAI1K,KAAKghB,EAAKqyC,WAAY,SAAS,WACjC3oD,GAAI2E,KAAK2R,EAAKoyC,WACd1oD,GAAIyE,KAAK6R,EAAKsyC,gBAChB,IAEA,IAAMC,EAAiB,WACrB7oD,GAAIyE,KAAK6R,EAAKoyC,WACd1oD,GAAI2E,KAAK2R,EAAKsyC,gBAChB,EAEA5oD,GAAI1K,KAAKghB,EAAKwyC,UAAW,SAAS,WAAQD,GAAiB,IAE3D7oD,GAAI1K,KAAKghB,EAAKyyC,eAAgB,SAAS,WAAQF,GAAiB,IAEhE7oD,GAAI1K,KAAKghB,EAAK0yC,eAAgB,SAAS,WAAQ5jC,EAAK6jC,qBAAsB,IAC1EjpD,GAAI1K,KAAKghB,EAAK4yC,UAAW,SAAS,WAAQ9jC,EAAK+jC,qBAAsB,IACrEnpD,GAAI1K,KAAKghB,EAAK8yC,kBAAmB,SAAS,WAAQhkC,EAAKgkC,mBAAoB,IAE3EhzC,KAAMilC,mBAAmB,CACvBM,aAAc,SAACJ,GACM,0BAAfA,EAAKqC,OAAmCx4B,EAAKikC,cAAc9N,EAAKryC,QACtE,GAEJ,CAwOC,IAAAogD,EAjCDC,EAmDC,OA1PAz0D,EAAA+yD,EAAA,EAAA/+D,IAAA,eAAAE,MAED,SAAcy3D,GACZt1D,KAAKmrB,KAAKkzC,eAAeh/C,YAAci2C,EACvCzgD,GAAIyE,KAAKtZ,KAAKmrB,KAAKkzC,eACrB,GAAC,CAAA1gE,IAAA,gBAAAE,MAED,SAAey3D,GACbt1D,KAAKmrB,KAAKmzC,YAAYj/C,YAAci2C,EACpCzgD,GAAIyE,KAAKtZ,KAAKmrB,KAAKmzC,YACrB,GAAC,CAAA3gE,IAAA,cAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAKmrB,KAAKmzC,YAAat+D,KAAKmrB,KAAKkzC,eAC5C,GAAC,CAAA1gE,IAAA,cAAAE,MAED,SAAao9D,EAAcH,GAAkB,IAAA97B,EAAA,KAC3Ch/B,KAAKi7D,GAAKA,EACVj7D,KAAK86D,SAAWA,EAChB96D,KAAKu+D,UAAY,CAAC,EAClBv+D,KAAKw+D,WAAa,GAClB,IAAMrzC,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKoyC,UAAWpyC,EAAKmyC,gBAAiBnyC,EAAKsyC,gBAAiBtyC,EAAKszC,cAC1E5pD,GAAImD,MAAMmT,EAAKmwC,WAAYnwC,EAAK8qB,SAChCj2C,KAAK0+D,cAyDL,IAvDA,IAAMC,EAAa,SAAC5gD,EAAiBk+C,GACnC,IAAMh9C,EAAQgM,KAAMoW,OAAOtjB,GAC3B,GAAKkB,EAAL,CACA,IAAA2/C,EAAiF3/C,EAAzEvK,SAAYC,aAAgBmI,EAAI8hD,EAAJ9hD,KAAMlI,EAAgBgqD,EAAhBhqD,iBAAsB7Q,EAAiBkb,EAAjBlb,KAAM4a,EAAWM,EAAXN,OAChEkgD,EAAK1zC,EAAKyxC,cAAcnxC,WAAU,GACxCN,EAAKmwC,WAAWhjD,YAAYumD,GAC5B,IAAM1+C,EAAOtL,GAAI6W,cAAcmzC,GAE/B1+C,EAAK2sB,KAAKrtB,IAAM5K,GAAImK,SAASL,GAC7BwB,EAAKpc,KAAKsb,YAActb,EAExB8Q,GAAI1K,KAAK00D,EAAI,SAAS,WAAQ7/B,EAAK8/B,cAAc/gD,EAAS,IAC1DoC,EAAK4+C,UAAU1/C,YAAcvC,EAC7B,IAAMkiD,EAAuB/C,EAAU55C,OAASzN,EAChDuL,EAAK8+C,OAAO5/C,YAAcxK,GAAIiJ,kBAAkBkhD,GAChD,IAAME,EAAWj0C,KAAMymB,aAAa3zB,GACpClJ,GAAIqf,OAAOgrC,EAAU/+C,EAAKg/C,SACtBD,IAAU/+C,EAAKi/C,eAAe//C,YAAcxK,GAAIiJ,kBAAkBkhD,EAAuBE,IAC7FlgC,EAAKu/B,UAAUxgD,GAAW,CAAEshD,MAAOl/C,EAAKk/C,MAhBtB,CAiBpB,EAEMC,EAAe,SAACt2B,GACpB,IAAgB/X,EAA6B+X,EAArC1H,OAAyBpQ,EAAY8X,EAArBu2B,QACxB7gD,EAAe,CAACuM,KAAMoW,OAAOpQ,GAAShG,KAAMoW,OAAOnQ,IACnD,GADQxS,EAAA,IAAGA,EAAA,GACX,CACA,IAAMmgD,EAAK1zC,EAAK0xC,WAAWpxC,WAAU,GACrCN,EAAK8qB,QAAQ39B,YAAYumD,GACzB,IAE4DW,EAF5DC,EAA8CxE,EAAG55B,OAAOpQ,GAAxCqf,EAAUmvB,EAAlB9gD,OAA8BnD,EAAGikD,EAAb/qD,SAC5BgrD,EAA+CzE,EAAG55B,OAAOnQ,GAAzC6f,EAAW2uB,EAAnB/gD,OAA+BlD,EAAGikD,EAAbhrD,SAAoCirD,EAAAt0D,GAChDwJ,GAAImG,cAAc6jD,EAAI,uBAAqB,IAA5D,IAAAc,EAAAp0D,MAAAi0D,EAAAG,EAAAn5D,KAAA9E,MAAa89D,EAAA3hE,MAAoDwhB,YAAc7D,EAAI7G,aAAamI,IAAI,OAAApe,GAAAihE,EAAA/zD,EAAAlN,EAAA,SAAAihE,EAAA9zD,GAAA,KACvC+zD,EADuCC,EAAAx0D,GACnFwJ,GAAImG,cAAc6jD,EAAI,wBAAsB,IAA7D,IAAAgB,EAAAt0D,MAAAq0D,EAAAC,EAAAr5D,KAAA9E,MAAak+D,EAAA/hE,MAAqDwhB,YAAc5D,EAAI9G,aAAamI,IAAI,OAAApe,GAAAmhE,EAAAj0D,EAAAlN,EAAA,SAAAmhE,EAAAh0D,GAAA,CAErG,IAAMsU,EAAOtL,GAAI6W,cAAcmzC,GAC/B1+C,EAAK2/C,SAASrgD,IAAM5K,GAAImK,SAASsxB,GACjCnwB,EAAK4/C,UAAUtgD,IAAM5K,GAAImK,SAAS+xB,GAElC,IAAMgsB,EAAU,SAAC7B,GACf,IAAoB8E,EAAiCh3B,EAA7Ci3B,WACFC,EAD+Cl3B,EAArBK,QACM7tB,EAAI7G,aAAaC,iBACjDurD,EAAgBD,EAAsBF,EH/+Bd,EG++BoD9E,EAC5EkF,EAAkBF,EAAsBF,EHh/BhB,EACI,EG++B+E9E,EACjH/6C,EAAKkgD,cAAchhD,YAAcxK,GAAIiJ,kBAAkBqiD,GACvDhgD,EAAKmgD,eAAejhD,YAAcxK,GAAIiJ,kBAAkBsiD,GACxD,IAAM/tB,EAAepnB,KAAMymB,aAAazgB,GACpCohB,IACFlyB,EAAKogD,kBAAkBlhD,YAAcxK,GAAIiJ,kBAAkBqiD,EAAgB9tB,GAC3ElyB,EAAKqgD,mBAAmBnhD,YAAcxK,GAAIiJ,kBAAkBsiD,EAAkB/tB,IAEhFx9B,GAAIqf,OAAOme,EAAclnB,EAAKs1C,gBAAiBt1C,EAAKu1C,iBACtD,EAEA3D,EAAQh1B,GAAWkzB,EAAGxzB,OAAS,GAC/BzI,EAAKw/B,WAAWx7D,KAAK,CAAEgmC,IAAAA,EAAK7oB,KAAAA,EAAM48C,QAAAA,GA5Bd,CA6BtB,EAEAhkD,EAAA,EAAA40B,EAAsCtwC,OAAO+C,OAAO66D,EAAG55B,QAAU,CAAC,GAAEtoB,EAAA40B,EAAApqC,OAAAwV,IAAE,CAAjE,IAAA4nD,EAAAhzB,EAAA50B,GAAQ4F,EAAMgiD,EAANhiD,OAAYZ,EAAO4iD,EAAX1rD,GACnB,GAAKgW,KAAMoW,OAAOtjB,GAAlB,CACA,IAAMk+C,EAAYhB,EAAGK,WAAW38C,GAC5Bs9C,GAAW0C,EAAW5gD,EAASk+C,EAFC,CAGtC,CAEA,IAAK,IAAL5+C,EAAA,EAAAujD,EAAkBvjE,OAAO+C,OAAO66D,EAAGhlB,SAAW,CAAC,GAAE54B,EAAAujD,EAAAr9D,OAAA8Z,IAAEiiD,EAArCsB,EAAAvjD,IAGd8N,EAAK2xC,iBAAiBj/D,MAAQo9D,EAAGxzB,KAAKoB,WAAav/B,OAAO2xD,EAAGxzB,KAAKoB,YAAc,IAE5E7oC,KAAK6gE,uBAAuB5F,GAAKj7D,KAAK8+D,cAAc7D,EAAGxzB,KAAK2zB,aAC3DvmD,GAAIyE,KAAK6R,EAAKoyC,UACrB,GAAC,CAAA5/D,IAAA,yBAAAE,MAED,SAAwBo9D,GACtB,GAAIA,EAAGsB,SAAU,OAAO,EACxB,IAAAuE,EAAoC7F,EAAGxzB,KAA/BoB,EAAUi4B,EAAVj4B,WAAYuyB,EAAW0F,EAAX1F,YACpB,GAAIvyB,EAAa,EAAG,OAAO,EAC3B,IAAMliC,EAAIskB,KAAMoW,OAAO+5B,GACvB,OAAOz0D,GAAKqnB,QAAQitC,EAAGK,WAAW30D,EAAEgY,QACtC,GAEA,CAAAhhB,IAAA,gBAAAE,MAIA,SAAekgB,GACb,IAAMpX,EAAI3G,KAAKu+D,UAAUxgD,GACnBkB,EAAQgM,KAAMoW,OAAOtjB,IAkJ/B,SAA0B/I,EAAiBiK,GACrCA,EAAMmG,OAAQpQ,EAAGqK,YAAc9C,GVjpCN,gBUkpCpB0C,EAAM40C,sBAAuB7+C,EAAGqK,YAAc9C,GV/oCxB,kBUgpC1BvH,EAAGqK,YAAc9C,GV/oCO,gBUgpC7BvH,EAAG2D,UAAUM,OAAO,aAAc,eAClCjE,EAAG2D,UAAUC,IAAIqG,EAAMmG,OAAS,aAAe,cACjD,CAvJI27C,CAAgBp6D,EAAE04D,MAAOpgD,EAC3B,GAAC,CAAAthB,IAAA,UAAAE,MAED,WACEmC,KAAKghE,YAAYhhE,KAAKi7D,GAAIj7D,KAAK86D,SACjC,GAAC,CAAAn9D,IAAA,gBAAAE,MAED,SAAekgB,GACb/d,KAAKihE,gBAAkBljD,EACvB/d,KAAK+8D,UACL,IAAAmE,EAAmElhE,KAA3DmrB,KAAQoyC,EAAS2D,EAAT3D,UAAWD,EAAe4D,EAAf5D,gBAAiBR,EAAgBoE,EAAhBpE,iBAC5CjoD,GAAI2E,KAAK+jD,GACT1oD,GAAIyE,KAAKgkD,GACTR,EAAiB/tC,OACnB,GAAC,CAAApxB,IAAA,UAAAE,MAED,WAAW,IAAAsjE,EACDh2C,EAAuDnrB,KAAvDmrB,KAAYmwC,EAA2Ct7D,KAAjDi7D,GAAMK,WAA+Bv9C,EAAY/d,KAA7BihE,gBAClCG,EAAiCn2C,KAAMoW,OAAOtjB,GAAtCY,EAAMyiD,EAANziD,OAAkBlC,EAAE2kD,EAAZ1sD,SAChB2sD,EAAqD5kD,EAA7C9H,aAAgBC,EAAgBysD,EAAhBzsD,iBAAkBkI,EAAIukD,EAAJvkD,KAEpCm/C,EAAYX,EAAW38C,GACvB2iD,EAAiC,QAA9BH,EAAGh2C,EAAK2xC,iBAAiBj/D,aAAK,IAAAsjE,EAAAA,EAAI,GAC3C,GAAKG,EAAL,CACA,IAAMpG,EAAOroD,SAASyuD,GACtB,GAAIh+D,MAAM43D,GACRl7D,KAAKuhE,aAAahlD,GAAUA,SAD9B,CAIA4O,EAAK2xC,iBAAiBj/D,MAAQyL,OAAO4xD,GACrC/vC,EAAKq2C,gBAAgBniD,YAAcxK,GAAIkc,gBAAgBkrC,EAAU55C,OAAQ5F,GAAG,IACLglD,EADKC,EAAAr2D,GAC3DwJ,GAAImG,cAAcmQ,EAAKmyC,gBAAiB,gBAAc,IAAvE,IAAAoE,EAAAn2D,MAAAk2D,EAAAC,EAAAl7D,KAAA9E,MAAa+/D,EAAA5jE,MAA+DwhB,YAAc/V,OAAO4xD,EAAK,OAAAx8D,GAAAgjE,EAAA91D,EAAAlN,EAAA,SAAAgjE,EAAA71D,GAAA,KAClB81D,EADkBC,EAAAv2D,GACrFwJ,GAAImG,cAAcmQ,EAAKmyC,gBAAiB,6BAA2B,IAApF,IAAAsE,EAAAr2D,MAAAo2D,EAAAC,EAAAp7D,KAAA9E,MAAaigE,EAAA9jE,MAA4EwhB,YAAcvC,CAAI,OAAApe,GAAAkjE,EAAAh2D,EAAAlN,EAAA,SAAAkjE,EAAA/1D,GAAA,CAC3G,IAAM2vD,EAAWS,EAAU55C,OAAS64C,EH/jCH,EGgkCjC/vC,EAAK02C,gBAAgBxiD,YAAcxK,GAAIkc,gBAAgByqC,EAAU/+C,GACjE,IAAMyiD,EAAWj0C,KAAMymB,aAAa3zB,GAChCmhD,IAAU/zC,EAAK22C,gBAAgBziD,YAAcxK,GAAIiJ,kBAAkB09C,EAAW5mD,EAAmBsqD,IACrG,IAAK,IAALl9C,EAAA,EAAA+/C,EAAgB1kE,OAAO+C,OAAOJ,KAAKw+D,YAAWx8C,EAAA+/C,EAAAx+D,OAAAye,IAAlC+/C,EAAA//C,GAAsC+6C,QAAQ7B,GAE1D,IADA,IAAM8G,EAA0C,CAAC,EACjD7b,EAAA,EAAA7oC,EAAuCjgB,OAAOkgB,QAAQ0N,KAAMoW,QAAO8kB,EAAA7oC,EAAA/Z,OAAA4iD,IAAE,CAAhE,IAAA+H,EAAAtmD,EAAA0V,EAAA6oC,GAAA,GAAO8b,EAAU/T,EAAA,GAAI9oC,EAAM8oC,EAAA,GAAN9oC,OACxB,GAAKA,EAAL,CACA,IAAA88C,EAAkD98C,EAA1CozB,QACF2pB,EADuBD,EAAVE,WAAwBF,EAAZG,aAE3BF,EAAS,IAAGH,EAAgBnvD,SAASovD,IAAeE,EAHnC,CAIvB,CACA,IAAMG,EAAWjlE,OAAOkH,KAAKy9D,GAAiBz+D,OAAS,EAEvD,GADAsR,GAAIqf,OAAOouC,EAAUn3C,EAAKo3C,gBACtBD,EAAU,CACZztD,GAAImD,MAAMmT,EAAKq3C,cACf,IAAK,IAALC,EAAA,EAAArU,EAAuC/wD,OAAOkgB,QAAQykD,GAAgBS,EAAArU,EAAA7qD,OAAAk/D,IAAE,CAAnE,IAAApU,EAAAzmD,EAAAwmD,EAAAqU,GAAA,GAAOR,EAAU5T,EAAA,GAAEqU,EAAUrU,EAAA,GAC1BtwC,EAAUlL,SAASovD,GACzBU,EAAuC13C,KAAMoW,OAAOtjB,GAAlCtB,EAAEkmD,EAAZjuD,SAAciK,EAAMgkD,EAANhkD,OAAQ5a,EAAI4+D,EAAJ5+D,KAC9B6+D,EAAqDnmD,EAA7C9H,aAAgBC,EAAgBguD,EAAhBhuD,iBAAkBkI,EAAI8lD,EAAJ9lD,KACpC+hD,EAAK1zC,EAAKwxC,gBAAgBlxC,WAAU,GAC1CN,EAAKq3C,aAAalqD,YAAYumD,GAC9B,IAAM1+C,EAAOtL,GAAI6W,cAAcmzC,GAC/B1+C,EAAK0iD,KAAKpjD,IAAM5K,GAAImK,SAASL,GAC7BwB,EAAKpc,KAAKsb,YAActb,EACxBoc,EAAK26B,IAAIz7B,YAAcxK,GAAIkc,gBAAgB2xC,EAAYjmD,GACvD0D,EAAKhB,OAAOE,YAAcvC,EAC1BqD,EAAKpc,KAAKsb,YAActb,EACxB,IAAMm7D,EAAWj0C,KAAMymB,aAAa3zB,GACpClJ,GAAIqf,OAAO/T,EAAKg/C,SACZD,IAAU/+C,EAAK2iD,QAAQzjD,YAAcxK,GAAIiJ,kBAAkB4kD,EAAa9tD,EAAmBsqD,GACjG,CACF,CACArqD,GAAIqf,OAAOgrC,EAAU/zC,EAAK43C,YAtC1B,CALgB,CA4ClB,GAAC,CAAAplE,IAAA,aAAAE,MAED,WAAc,IAAAmlE,EACJ73C,EAAmCnrB,KAAnCmrB,KAAuBpN,EAAY/d,KAA7BihE,gBACdjhE,KAAK0+D,cACL,IAAM4C,EAAiC,QAA9B0B,EAAG73C,EAAK2xC,iBAAiBj/D,aAAK,IAAAmlE,EAAAA,EAAI,GAC3C,GAAK1B,EAAL,CACA,IAAMpG,EAAOroD,SAASyuD,GAClBh+D,MAAM43D,GACRl7D,KAAKuhE,aAAahlD,GAAUA,KAG9Bvc,KAAKsvD,QAAQvxC,EAASm9C,EANN,CAOlB,GAAC,CAAAv9D,IAAA,gBAAAE,MAED,SAAeiqB,GAAa,IAAAm7C,EACQh6D,EAAYjJ,KAAtCmrB,KAAQ2xC,iBAChB7zD,EAAMpL,MAAQyL,OAAO2J,KAAKqB,IAAI,GAAIzB,SAAoB,QAAZowD,EAACh6D,EAAMpL,aAAK,IAAAolE,EAAAA,EAAI,KAAO,IAAMn7C,EAAK,GAAK,KACjF9nB,KAAK+8D,SACP,GAEA,CAAAp/D,IAAA,UAAAE,OAAAugE,EAAA31D,EAAAzL,IAAAA,MAIA,SAAAkmE,IAAA,IAAA/3C,EAAAy7B,EAAAuc,EAAA,OAAAnmE,IAAAA,MAAA,SAAAomE,GAAA,cAAAA,EAAAv+D,KAAAu+D,EAAA9gE,MAAA,OAOoB,OANV6oB,EAAenrB,KAAfmrB,KAAMy7B,EAAS5mD,KAAT4mD,KAGRuc,EAAmB/7D,MAAMI,KAAK2jB,EAAKmwC,WAAW5gD,UACpDksC,EAAKrsC,MAAMwhD,QAAU,IAEHqH,EAAA9gE,KAAA,EACZuS,GAAIyF,QADK,KACW,SAAAsrB,GACxB,IAAK,IAALy9B,EAAA,EAAAC,EAAiBH,EAAgBE,EAAAC,EAAA//D,OAAA8/D,IAAE,CAA9B,IAAMruD,EAAEsuD,EAAAD,GACXruD,EAAGuF,MAAMgpD,UAAY,GAAHx3D,OARF,IAQS,EAAI65B,GAAmB,MAChD5wB,EAAGuF,MAAMuhD,UAAY,SAAH/vD,OAAY65B,EAAI,IACpC,CACAghB,EAAKrsC,MAAMwhD,QAAU9oD,KAAKsR,IAAIqhB,EAAM,GAAGlgB,QAAQ,GAC/CkhC,EAAKrsC,MAAMrE,IAAM,GAAHnK,OAXC,IAWM,EAAI65B,GAAgB,KAC3C,GAAG,WAAU,wBAAAw9B,EAAAp+D,OAAA,GAAAk+D,EAAA,UACd,kBAAA9E,EAAAx1D,MAAA,KAAAD,UAAA,KAAAhL,IAAA,sBAAAE,MAED,WACE,IAAQstB,EAASnrB,KAATmrB,KACRtW,GAAI2E,KAAK2R,EAAKoyC,UAAWpyC,EAAKq4C,gBAC9Br4C,EAAKs4C,gBAAgB5lE,MAAQ,GAC7BgX,GAAIyE,KAAK6R,EAAKszC,aAChB,GAAC,CAAA9gE,IAAA,sBAAAE,MAED,WACE,IAAQstB,EAASnrB,KAATmrB,KACRtW,GAAI2E,KAAK2R,EAAKszC,cACd5pD,GAAIyE,KAAK6R,EAAKoyC,UAChB,GAAC,CAAA5/D,IAAA,oBAAAE,OAAAsgE,EAAA11D,EAAAzL,IAAAA,MAED,SAAA0mE,IAAA,IAAAv4C,EAAAmc,EAAAq8B,EAAAv6D,EAAA,OAAApM,IAAAA,MAAA,SAAA4mE,GAAA,cAAAA,EAAA/+D,KAAA++D,EAAAthE,MAAA,OAGyC,GAF/B6oB,EAAuBnrB,KAAvBmrB,KAAYmc,EAAWtnC,KAAjBi7D,GAAM3zB,KACpBzyB,GAAI2E,KAAK2R,EAAKq4C,gBACRG,EAAOx4C,EAAKs4C,gBAAgB5lE,MACvB,CAAF+lE,EAAAthE,KAAA,QAEsB,OAD7B6oB,EAAKq4C,eAAenkD,YAAc9C,GAAUA,IAC5C1H,GAAIyE,KAAK6R,EAAKq4C,gBAAeI,EAAA3hE,OAAA,wBAAA2hE,EAAAthE,KAAA,EAGbuL,EAAS,yBAA0B,CAAEy5B,KAAAA,EAAMq8B,KAAAA,EAAMnH,KAAMx8D,KAAK86D,WAAW,OAAhF,GAAH1xD,EAAGw6D,EAAA9hE,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFw6D,EAAAthE,KAAA,SAEE,OAD7B6oB,EAAKq4C,eAAenkD,YAAcjW,EAAIwE,IACtCiH,GAAIyE,KAAK6R,EAAKq4C,gBAAeI,EAAA3hE,OAAA,kBAG/BjC,KAAKsvD,QAAQtkC,GAAe5hB,EAAI8xD,MAAK,yBAAA0I,EAAA5+D,OAAA,GAAA0+D,EAAA,UACtC,kBAAAvF,EAAAv1D,MAAA,KAAAD,UAAA,MAAA+zD,CAAA,CA9S+B,GAgUrBmH,GAAc,WAgBzB,SAAAA,EAAajd,EAAmB0I,EAAqBE,GAAoB,IAAAtwB,EAAA,KAAAr2B,EAAA,KAAAg7D,GAAA/5D,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,sBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,wBAAAA,EAAA,kBAAAA,EAAA,yBAAAA,EAAA,6BAAAA,EAAA,0BAAAA,EAAA,sBAJzEA,EAAA,6BACsBA,EAAA,iCAIpB9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EACftvD,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,GAC9B5mD,KAAK+d,SAAW,EAChB/d,KAAK8jE,cAAgB,GACrB9jE,KAAK+jE,YAAa,EAClB/jE,KAAK68C,QAAS,EAEdhoC,GAAI1K,KAAKnK,KAAKmrB,KAAKqkC,OAAQ,SAAS,WAClCtwB,EAAKnhB,SAAW,EAChByxC,GACF,IAEAvkC,KAAMilC,mBAAmB,CACvBC,YAAa,SAACC,GAAqB,OAAKlxB,EAAKmxB,kBAAkBD,EAAKhrC,OAAO,EAC3EkrC,WAAY,SAACF,GACX,GAAIA,EAAKryC,UAAYmhB,EAAKnhB,QAA1B,CACA,IAAMtH,EAAIwU,KAAM8sB,UAAUqY,EAAKryC,SAC/BmhB,EAAK8kC,eAAevtD,EAAE+O,OAAQ/O,EAAEgP,aAFS,CAG3C,EACA+yB,QAAS,SAAC4X,GAAiB,OAAKlxB,EAAK+kC,cAAc7T,EAAKryC,QAAQ,GAEpE,CAiLC,OA/KDpU,EAAAk6D,EAAA,EAAAlmE,IAAA,cAAAE,MACA,SAAao9D,GACXj7D,KAAKi7D,GAAKA,CACZ,GAEA,CAAAt9D,IAAA,YAAAE,MACA,SAAWkgB,EAAiBmmD,EAAuBhJ,GACjDl7D,KAAK+d,QAAUA,EACf/d,KAAK8jE,cAAgB,GACrB9jE,KAAK+jE,YAAa,EAClB/jE,KAAK68C,QAAS,EACd78C,KAAKkkE,cAAgBA,EACrBlkE,KAAKmkE,mBAAoB,EACzB,IAAMh5C,EAAOnrB,KAAKmrB,KACZlM,EAAQgM,KAAMoW,OAAOtjB,GACnBY,EAAyFM,EAAzFN,OAAkBlC,EAAuEwC,EAAjFvK,SAAQ0vD,EAAyEnlD,EAAnEmG,OAAmBi/C,EAAGD,EAAZ5rB,QAAc8rB,EAAOF,EAAPE,QAAS9+C,EAAM4+C,EAAN5+C,OAAQC,EAAY2+C,EAAZ3+C,aAAgBumB,EAAU/sB,EAAV+sB,MACvFhsC,KAAKisC,SAAWD,aAAK,EAALA,EAAOC,SACvB,IAOwDs4B,EAPlDtI,EAAYj8D,KAAKi8D,UAAYj8D,KAAKi7D,GAAGK,WAAW38C,GAEhD6lD,EAAY,SAACxvD,EAAiBiK,GAClCpK,GAAImD,MAAMhD,GACVA,EAAGsD,YAAYzD,GAAI2vD,UAAUvlD,GAC/B,EAACwlD,EAAAp5D,GAEkBwJ,GAAImG,cAAchb,KAAK4mD,KAAM,UAAQ,IAAxD,IAAA6d,EAAAl5D,MAAAg5D,EAAAE,EAAAj+D,KAAA9E,MAA0D8iE,EAA3CD,EAAA1mE,MAA2DohB,EAAM,OAAAvgB,GAAA+lE,EAAA74D,EAAAlN,EAAA,SAAA+lE,EAAA54D,GAAA,CAChFsf,EAAK2hB,KAAKrtB,IAAM5K,GAAImK,SAASL,GAC7BwM,EAAKu5C,SAASrlD,YAAcilD,EAE5BzvD,GAAI2E,KAAK2R,EAAKw5C,YAAax5C,EAAKy5C,UAAWz5C,EAAK05C,WAAY15C,EAAK25C,SAAU35C,EAAK45C,cAAe55C,EAAK65C,mBACpGnwD,GAAIyE,KAAK6R,EAAK85C,YAEd,IAAIzJ,EAAW,EAAIS,EAAU55C,OAAS64C,EACtC,GAAIgJ,EAAgB,EAAG,CACrBrvD,GAAIyE,KAAK6R,EAAK65C,mBACd75C,EAAK+5C,eAAe7lD,YAAcxK,GAAIkc,gBAAgByqC,EAAU/+C,GAChE0O,EAAKg6C,aAAa9lD,YAAcxK,GAAIkc,gBAAgBmzC,EAAeznD,GACnE++C,GAAY0I,EACZ,IAAMkB,EAAOnyD,KAAKqB,IAAIknD,EAAW6I,EAAIr0B,UAAYq0B,EAAIgB,gBAAiB,GAMtE,GALAl6C,EAAKm6C,aAAajmD,YAAcxK,GAAIkc,gBAAgBq0C,EAAM3oD,GAC1D5H,GAAI2E,KAAK2R,EAAKo6C,YACd1wD,GAAI2E,KAAK2R,EAAKq6C,SAAUr6C,EAAKs6C,mBAAoBt6C,EAAKu6C,iBACtD7wD,GAAI2E,KAAK2R,EAAKw6C,mBAEV35B,EAAO,CACTn3B,GAAIyE,KAAK6R,EAAKq6C,SAAUr6C,EAAKs6C,mBAAoBt6C,EAAKu6C,iBACtD,IAAMjU,EAAcxmC,KAAMoW,OAAO2K,EAAMC,UACvC9gB,EAAKy6C,MAAMvmD,YAAcxK,GAAIkc,gBAAgBmzC,EAAezS,EAAY/8C,UACxEyW,EAAK06C,WAAWxmD,YAAcxK,GAAIkc,gBAAgBmzC,EAAezS,EAAY/8C,UAC7EyW,EAAK26C,UAAUzmD,YAAcxK,GAAIkc,gBAAgBq0C,EAAM3oD,GACvD+nD,EAAUr5C,EAAK46C,UAAWtU,GAC1B+S,EAAUr5C,EAAK66C,WAAYvU,GAC3B+S,EAAUr5C,EAAK86C,cAAexU,GAC9BtmC,EAAK+6C,UAAU7mD,YAAcoyC,EAAYrsC,OAASvQ,GAAIkc,gBAAgB0gC,EAAYrsC,OAAOozB,QAAQxI,UAAWyhB,EAAY/8C,UAAY,GACtI,MACEG,GAAIyE,KAAK6R,EAAKw6C,mBAEhBx6C,EAAKg7C,IAAI9mD,YAAcxK,GAAIkc,gBAAgByqC,EAAU/+C,EACvD,MACE5H,GAAIyE,KAAK6R,EAAKo6C,YAGhB1wD,GAAIyE,KAAKkM,EAAS2F,EAAKy5C,UAAYn/C,GAAgB,EAAI0F,EAAKi7C,YAAcj7C,EAAKw5C,aAC/E9vD,GAAIyE,KAAK+qD,EAAIr0B,WAAa,EAAIisB,EAAU55C,OAAS6hD,EAAgB/4C,EAAK25C,SAAW35C,EAAK05C,YAEtF15C,EAAKgkC,SAAS9vC,aAA8B,IAAfoG,GAAoBC,QAAQ,GAErDF,IACFxlB,KAAK+jE,YAAa,GAEpB/jE,KAAKikE,cAAclmD,EACrB,GAEA,CAAApgB,IAAA,oBAAAE,MAIA,SAAmBunB,GACbplB,KAAK+jE,YAAc/jE,KAAK68C,SACxBz3B,EAAOrH,UAAY/d,KAAK+d,SAAS/d,KAAKgkE,eAAe5+C,EAAOI,OAAQJ,EAAOK,cAC/EzlB,KAAKikE,cAAc7+C,EAAOrH,SAC5B,GAEA,CAAApgB,IAAA,gBAAAE,MAIA,SAAekgB,GACb,IAAI/d,KAAK68C,SAA4B,IAAlB78C,KAAK+d,UACpBA,IAAY/d,KAAK+d,SAAWA,IAAY/d,KAAKisC,UAAjD,CACA,IAAM9gB,EAAOnrB,KAAKmrB,KACZlM,EAAQgM,KAAMoW,OAAOrhC,KAAK+d,SAE1BgyB,EAAQ9wB,EAAMmG,OAAOozB,QAAQxI,UAGnC,GAFA7kB,EAAKqtB,QAAQn5B,YAAcxK,GAAIkc,gBAAgBgf,EAAO9wB,EAAMvK,UAExDuK,EAAM+sB,MAAO,CACf,IAAMylB,EAAcxmC,KAAMoW,OAAOpiB,EAAM+sB,MAAMC,UACvCo6B,EAAc5U,EAAYrsC,OAAOozB,QAAQxI,UAE/C,GADA7kB,EAAK+6C,UAAU7mD,YAAcxK,GAAIkc,gBAAgBs1C,EAAa5U,EAAY/8C,UACtE2xD,EAAcrmE,KAAKkkE,cAAe,MACxC,CAKIn0B,EAAQ,EAAI/vC,KAAKi8D,UAAU55C,OAASriB,KAAKkkE,gBAE7CrvD,GAAIyE,KAAK6R,EAAK25C,UACdjwD,GAAI2E,KAAK2R,EAAK05C,WAAY15C,EAAK85C,WAAY95C,EAAKo6C,YAChDvlE,KAAK68C,QAAS,EACV78C,KAAK+jE,YAAY/jE,KAAKsvD,UAtBuC,CAuBnE,GAEA,CAAA3xD,IAAA,iBAAAE,MAIA,SAAgB2nB,EAAiBogB,GAC/B,IAAMza,EAAOnrB,KAAKmrB,KAClB,GAAI3F,EAMF,OALA2F,EAAKgkC,SAAS9vC,YAAc,MAC5BxK,GAAI2E,KAAK2R,EAAKw5C,YAAax5C,EAAK45C,cAAe55C,EAAKi7C,aACpDvxD,GAAIyE,KAAK6R,EAAKy5C,WACd5kE,KAAK+jE,YAAa,OACd/jE,KAAK68C,QAAQ78C,KAAKsvD,WAWxB,GAToB,IAAT1pB,GACT/wB,GAAI2E,KAAK2R,EAAKw5C,aACd9vD,GAAIyE,KAAK6R,EAAKi7C,eAEdvxD,GAAI2E,KAAK2R,EAAKi7C,aACdvxD,GAAIyE,KAAK6R,EAAKw5C,cAEhBx5C,EAAKgkC,SAAS9vC,aAAsB,IAAPumB,GAAYlgB,QAAQ,GAE7CkgB,GAAQ,KASV,OARA/wB,GAAI2E,KAAK2R,EAAKm7C,eACdzxD,GAAIyE,KAAK6R,EAAKo7C,iBACd1xD,GAAIyE,KAAK6R,EAAK45C,oBAKd55C,EAAKo7C,gBAAgBlnD,YAAc9C,GVvxCE,6BU6xCvC,IACMiqD,EAAQxmE,KAAK8jE,cAKnB,GAJA0C,EAAMxjE,KAAK,CACTijD,OAAO,IAAIr7C,MAAOE,UAClBqkD,SAAUvpB,MAER4gC,EAAMjjE,OAAS,GAAnB,CAIA,KAAOijE,EAAMjjE,OAVK,IAUeijE,EAAMjrC,QACvC,IAAApV,EAAsB,CAACqgD,EAAM,GAAIA,EAAMA,EAAMjjE,OAAS,IAA/Cg9B,EAAKpa,EAAA,GAAEsV,EAAItV,EAAA,GACZsgD,EAAYhrC,EAAK0zB,SAAW5uB,EAAM4uB,SACxC,GAAkB,IAAdsX,EAAJ,CAKA5xD,GAAI2E,KAAK2R,EAAKo7C,iBACd1xD,GAAIyE,KAAK6R,EAAKm7C,eACdzxD,GAAIyE,KAAK6R,EAAK45C,eACd,IACM2B,EAAWD,GADChrC,EAAKwqB,MAAQ1lB,EAAM0lB,OAG/B0gB,GADW,EAAIlrC,EAAK0zB,UACEuX,EAC5Bv7C,EAAKy7C,WAAWvnD,YAAcxK,GAAI2L,eAAemmD,EARjD,CARA,CAiBF,KAAC9C,CAAA,CAxNwB,GA0OdgD,GAAmB,WAS9B,SAAAA,EAAajgB,EAAmB0I,GAAqB,IAAAvvB,EAAA,KAAAl3B,EAAA,KAAAg+D,GAAA/8D,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,qBAAAA,EAAA,+BAAAA,EAAA,iCAAAA,EAAA,4BAAAA,EAAA,uBACnD9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EACf,IAAMnkC,EAAOnrB,KAAKmrB,KAAOtW,GAAIwoC,cAAcuJ,GAE3C/xC,GAAI1K,KAAKghB,EAAK27C,iBAAkB,SAAS,WACvC/mC,EAAKiwB,QACP,IACAn7C,GAAI1K,KAAKghB,EAAK47C,mBAAoB,SAAS,WACzChnC,EAAKinC,uBACP,GACF,CA8FA,IAAAC,EAhCAC,EAXAC,EAvBAC,EA+FC,OAzHDz9D,EAAAk9D,EAAA,EAAAlpE,IAAA,8BAAAE,MAMA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAEbnrB,KAAKqnE,oBACVl8C,EAAKm8C,uBAAuBjoD,YAAc,GAAHtT,OAAMkH,KAAK4I,MAAM7b,KAAKqnE,kBAAkBE,SAAW,KAC1Fp8C,EAAKq8C,eAAenoD,YAAc,GAAHtT,OAAMkH,KAAK4I,MAAM7b,KAAKqnE,kBAAkBE,SAAW,KAC9EvnE,KAAKqnE,kBAAkBI,iBACzB5yD,GAAIyE,KAAK6R,EAAKu8C,uBACd7yD,GAAI2E,KAAK2R,EAAKw8C,eACdx8C,EAAKm8C,uBAAuBjoD,YAAc,GAAHtT,OAAMkH,KAAK4I,MAAM7b,KAAKqnE,kBAAkBE,SAAW,OAE1F1yD,GAAIyE,KAAK6R,EAAKw8C,eACd9yD,GAAI2E,KAAK2R,EAAKu8C,uBACdv8C,EAAKq8C,eAAenoD,YAAc,GAAHtT,OAAMkH,KAAK4I,MAAM7b,KAAKqnE,kBAAkBE,SAAW,MAEpF1yD,GAAI2E,KAAK2R,EAAKy8C,yBAA0Bz8C,EAAK08C,eAC7ChzD,GAAIyE,KAAK6R,EAAK28C,sBAChB,GAGA,CAAAnqE,IAAA,wBAAAE,OAAAupE,EAAA3+D,EAAAzL,IAAAA,MACA,SAAA+qE,IAAA,IAAA/3C,EAAA7E,EAAAyxB,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAgrE,GAAA,cAAAA,EAAAnjE,KAAAmjE,EAAA1lE,MAAA,OAOsD,OAN9C0tB,EAAQhwB,KAAKgwB,MACb7E,EAAOnrB,KAAKmrB,KACZyxB,EAAM,CACVqrB,QAASj4C,EAAM/a,GACfizD,QAASloE,KAAKmoE,iBAEV7pB,EAASrzB,KAAMuzB,QAAQrzB,EAAKi9C,mBAAkBJ,EAAA1lE,KAAA,EAClCuL,EAAS,uBAAwB+uC,GAAI,OAAjDxzC,EAAG4+D,EAAAlmE,KACTw8C,IACIrzB,KAAM6mC,cAAc1oD,IACtB+hB,EAAKk9C,eAAehpD,YAAcjW,EAAIk/D,KACtCzzD,GAAI2E,KAAK2R,EAAKi9C,kBAAmBj9C,EAAKo9C,iBAAkBp9C,EAAK08C,eAC7DhzD,GAAIyE,KAAK6R,EAAKq9C,iBAAkBr9C,EAAKs9C,mBACrCzoE,KAAKsvD,YAELnkC,EAAK08C,cAAcxoD,YAAc9C,GAAUA,EAAoC,CAAE3O,IAAKxE,EAAIwE,MAC1FiH,GAAI2E,KAAK2R,EAAK28C,sBACdjzD,GAAIyE,KAAK6R,EAAK08C,cAAe18C,EAAKy8C,2BACnC,wBAAAI,EAAAhjE,OAAA,GAAA+iE,EAAA,UACF,kBAAAX,EAAAx+D,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,SAAAE,OAAAspE,EAAA1+D,EAAAzL,IAAAA,MACA,SAAA0rE,IAAA,OAAA1rE,IAAAA,MAAA,SAAA2rE,GAAA,cAAAA,EAAA9jE,KAAA8jE,EAAArmE,MAAA,OACMtC,KAAKqnE,kBACPrnE,KAAK4oE,8BAEL5oE,KAAKgnE,wBACN,wBAAA2B,EAAA3jE,OAAA,GAAA0jE,EAAA,UACF,kBAAAvB,EAAAv+D,MAAA,KAAAD,UAAA,IAID,CAAAhL,IAAA,UAAAE,OAAAqpE,EAAAz+D,EAAAzL,IAAAA,MACA,SAAA6rE,EAAe74C,GAAY,IAAA7E,EAAA/hB,EAAA0/D,EAAA57C,EAAA67C,EAAAC,EAAAnlC,EAAA,YAAA7mC,IAAAA,MAAA,SAAAisE,GAAA,cAAAA,EAAApkE,KAAAokE,EAAA3mE,MAAA,OAEP,OADZ6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAKgwB,MAAQA,EAAKi5C,EAAA3mE,KAAA,EACAuL,EAAS,qBAAsBmiB,EAAM/a,IAAG,OAAjD,GAAH7L,EAAG6/D,EAAAnnE,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAF6/D,EAAA3mE,KAAA,SAG2B,OAFtD6oB,EAAKo9C,iBAAiBlpD,YAAc9C,GAAUA,EAAoC,CAAE3O,IAAKxE,EAAIwE,MAC7FiH,GAAI2E,KAAK2R,EAAKi9C,kBAAmBj9C,EAAKs9C,mBACtC5zD,GAAIyE,KAAK6R,EAAKq9C,iBAAkBr9C,EAAKo9C,kBAAiBU,EAAAhnE,OAAA,kBAGxD4S,GAAI2E,KAAK2R,EAAKq9C,iBAAkBr9C,EAAKo9C,iBAAkBp9C,EAAK08C,cAAe18C,EAAK+9C,eAAgB/9C,EAAK28C,sBACrGjzD,GAAIyE,KAAK6R,EAAKi9C,kBAAmBj9C,EAAKs9C,kBAAmBt9C,EAAKy8C,0BACxDkB,EAA+B1/D,EAAI0/D,cACzC9oE,KAAKqnE,kBAAoByB,EAAczB,kBACvCrnE,KAAKmpE,aAAeL,EAAcM,eAAet7C,MACjD3C,EAAKk+C,qBAAqBhqD,YAAc,GAAHtT,OAAM+8D,EAAcQ,SAAQ,KAAAv9D,OAAI+8D,EAAcM,eAAet7C,OAClG3C,EAAKo+C,yBAAyBlqD,YAAc,GAAHtT,OAAM+8D,EAAcU,cAAa,KAAAz9D,OAAI+8D,EAAcM,eAAet7C,OAC3G9tB,KAAKmoE,gBAAkBW,EAAcM,eAAetmD,MAAMjC,EACpDqM,EAAW,WAAwB,EAEnC67C,EAAa,SAAC32D,EAAWq3D,GAAmB5lC,EAAKskC,gBAAkBsB,CAAK,EACxET,EAAe,IAAI/7C,GAAe67C,EAAcM,eAAgBN,EAAcM,eAAetmD,MAAMmG,EAAG,CAC1GkF,QAAS46C,EAAY5hD,QAAS,kBAAM0c,EAAK6lC,4BAA4B,EAAEx8C,SAAAA,EAAUe,QAHpE,IAKfpZ,GAAImD,MAAMmT,EAAKw+C,iBACfx+C,EAAKw+C,gBAAgBrxD,YAAY0wD,EAAaz8C,SAC9CvsB,KAAK0pE,6BAA4B,yBAAAT,EAAAjkE,OAAA,GAAA6jE,EAAA,UAClC,SAAAn/C,GAAA,OAAAw9C,EAAAt+D,MAAA,KAAAD,UAAA,IAID,CAAAhL,IAAA,6BAAAE,OAAAopE,EAAAx+D,EAAAzL,IAAAA,MACA,SAAA4sE,IAAA,IAAAz+C,EAAA6E,EAAA4sB,EAAA0B,EAAAl1C,EAAA2U,EAAAgoC,EAAArxC,EAAA,OAAA1X,IAAAA,MAAA,SAAA6sE,GAAA,cAAAA,EAAAhlE,KAAAglE,EAAAvnE,MAAA,OAOoD,OAN5C6oB,EAAOnrB,KAAKmrB,KACZ6E,EAAQhwB,KAAKgwB,MACb4sB,EAAM,CACVqrB,QAASj4C,EAAM/a,GACfizD,QAASloE,KAAKmoE,iBAEV7pB,EAASrzB,KAAMuzB,QAAQrzB,EAAKw+C,iBAAgBE,EAAAvnE,KAAA,EAChCuL,EAAS,4BAA6B+uC,GAAI,OACpD,GADFxzC,EAAGygE,EAAA/nE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFygE,EAAAvnE,KAAA,SAEC,OAD5B6oB,EAAK08C,cAAcxoD,YAAc9C,GVl9CU,iCUk9CwC,CAAE3O,IAAKxE,EAAIwE,MAC9FiH,GAAIyE,KAAK6R,EAAK08C,eAAcgC,EAAA5nE,OAAA,kBAG9BkpB,EAAK2+C,gBAAgBzqD,YAAc,GAAHtT,OAAM/L,KAAKmoE,gBAAe,KAAAp8D,OAAI/L,KAAKmpE,cAG/Dn5C,EAAMP,MACR1R,EAAUiS,EAAMiB,OAChB80B,EAAc/1B,EAAMsgB,aAEpBvyB,EAAUiS,EAAMkB,QAChB60B,EAAc/1B,EAAM+gB,aAEhBr8B,EAAWuW,KAAMvW,SAASqJ,GAChCoN,EAAK4+C,YAAY1qD,YAAc,GAAHtT,OAAM3C,EAAI+8D,IAAMzxD,EAASC,aAAaC,iBAAgB,KAAA7I,OAAIg6C,GACtFlxC,GAAIyE,KAAK6R,EAAK+9C,gBAAe,yBAAAW,EAAA7kE,OAAA,GAAA4kE,EAAA,UAC9B,kBAAA3C,EAAAr+D,MAAA,KAAAD,UAAA,MAAAk+D,CAAA,CA/I6B,GAmJnBmD,GAAc,WAQzB,SAAAA,EAAapjB,EAAmB0I,EAA+C2a,GAAsB,IAAA/kC,EAAA,KAAAr8B,EAAA,KAAAmhE,GAAAlgE,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,oBAAAA,EAAA,8BAAAA,EAAA,2BAAAA,EAAA,0BACnG9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EAEf,IAAMnkC,EAAOnrB,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,GAE3C5mD,KAAKkqE,WAAa,IAAIC,GAAkBvjB,GAExC/xC,GAAI1K,KAAKghB,EAAKi/C,iBAAkB,UAAU,kBAAMllC,EAAKmlC,sBAAsB,IAC3Ex1D,GAAI1K,KAAKghB,EAAKm/C,WAAY,SAAS,WACjCz1D,GAAI2E,KAAK2R,EAAKm/C,YACdz1D,GAAIyE,KAAK6R,EAAKo/C,UAAWp/C,EAAKsc,KAChC,IAEAznC,KAAKwqE,eAAiBpjE,MAAMI,KAAK2jB,EAAKs/C,SAAShwD,iBAAiB,oBAAmB,IAC9CiwD,EAD8CC,EAAAt/D,GACjErL,KAAKwqE,gBAAc,QAAAI,EAAA,WAAE,IAA5BzjC,EAAGujC,EAAA7sE,MACZgX,GAAI1K,KAAKg9B,EAAK,SAAS,WACrB,IACmC0jC,EAD7BvjC,EAAOH,EAAI5oB,QAAQ+oB,KAAIwjC,EAAAz/D,GACb65B,EAAKslC,gBAAc,IAAnC,IAAAM,EAAAv/D,MAAAs/D,EAAAC,EAAAtkE,KAAA9E,MAAYmpE,EAAAhtE,MAA2B8a,UAAUM,OAAO,WAAW,OAAAva,GAAAosE,EAAAl/D,EAAAlN,EAAA,SAAAosE,EAAAj/D,GAAA,CACnE,OAAOq5B,EAAK6lC,SAASzjC,EACvB,GACF,EANA,IAAAqjC,EAAAp/D,MAAAm/D,EAAAC,EAAAnkE,KAAA9E,MAAAkpE,GAMC,OAAAlsE,GAAAisE,EAAA/+D,EAAAlN,EAAA,SAAAisE,EAAA9+D,GAAA,CAED1B,GAAKy8C,EAAMz7B,EAAK6kC,QAAQ,kBAAM9qB,EAAK6lC,UAAU,IAEzCd,IACFp1D,GAAI2E,KAAK2R,EAAK6/C,UAAW7/C,EAAK8/C,qBAC9Bp2D,GAAIyE,KAAK6R,EAAK+/C,cACdlrE,KAAKiqE,YAAcA,GAGrBjqE,KAAKmrE,SACP,CAsCC,IAAAC,EAPDC,EAsDC,OArFA1hE,EAAAqgE,EAAA,EAAArsE,IAAA,UAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBA,EAAKpe,KAAKlP,MAAQ,GAClBmC,KAAKkqE,WAAWoB,gBAChBz2D,GAAI2E,KAAK2R,EAAKzsB,KACqB,IAA/BsB,KAAKwqE,eAAejnE,QAAgBvD,KAAKiqE,aAC3Cp1D,GAAIyE,KAAK6R,EAAKo/C,UAAWp/C,EAAKsc,MAC9B5yB,GAAI2E,KAAK2R,EAAKm/C,WAAYn/C,EAAKs/C,SAAUt/C,EAAKogD,cAAepgD,EAAKqgD,gBAElE32D,GAAI2E,KAAK2R,EAAKo/C,WACd11D,GAAIyE,KAAK6R,EAAKm/C,aACf,IACoCmB,EADpCC,EAAArgE,GACiBrL,KAAKwqE,gBAAc,IAArC,IAAAkB,EAAAngE,MAAAkgE,EAAAC,EAAAllE,KAAA9E,MAAc+pE,EAAA5tE,MAA6B8a,UAAUM,OAAO,WAAW,OAAAva,GAAAgtE,EAAA9/D,EAAAlN,EAAA,SAAAgtE,EAAA7/D,GAAA,CACvE7L,KAAKqqE,sBACP,GAEA,CAAA1sE,IAAA,uBAAAE,MAIA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBtW,GAAIqf,OAAOrf,GAAI82D,YAAYxgD,EAAKo/C,WAAYp/C,EAAKsc,KACnD,GAAC,CAAA9pC,IAAA,mBAAAE,MAED,WAA8B,IAAA+tE,EAC5B,OAAyC,QAAzCA,EAAO5rE,KAAKmrB,KAAKi/C,iBAAiBzR,eAAO,IAAAiT,GAAAA,CAC3C,GAEA,CAAAjuE,IAAA,UAAAE,OAAAwtE,EAAA5iE,EAAAzL,IAAAA,MACA,SAAA6uE,IAAA,IAAAjlB,EAAA,OAAA5pD,IAAAA,MAAA,SAAA8uE,GAAA,cAAAA,EAAAjnE,KAAAinE,EAAAxpE,MAAA,OACQskD,EAAO5mD,KAAK4mD,KAClB/xC,GAAIyF,QAAQ,KAAK,SAAAsrB,GACfghB,EAAKrsC,MAAMuhD,UAAY,SAAH/vD,OAAY,GAAM,GAAM65B,EAAI,KAChDghB,EAAKrsC,MAAMwhD,QAAUzyD,OAAO2J,KAAKsR,IAAIqhB,EAAM,GAC7C,GAAG,WAAU,wBAAAkmC,EAAA9mE,OAAA,GAAA6mE,EAAA,UACd,kBAAAR,EAAAziE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,WAAAE,OAAAutE,EAAA3iE,EAAAzL,IAAAA,MAED,SAAA+uE,EAAgBh/D,GAAa,IAAAoe,EAAAqxC,EAAA4N,EAAA4B,EAAApvB,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAivE,GAAA,cAAAA,EAAApnE,KAAAonE,EAAA3pE,MAAA,OAGG,GAFxB6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKzsB,KAED,MADbqO,EAAOA,GAAQoe,EAAKpe,KAAKlP,OACV,CAAAouE,EAAA3pE,KAAA,QAEK,OADlB6oB,EAAKzsB,IAAI2gB,YAAc9C,GVpjDW,yBUqjDlC1H,GAAIyE,KAAK6R,EAAKzsB,KAAIutE,EAAAhqE,OAAA,wBAAAgqE,EAAA3pE,KAAA,EAGDtC,KAAKkqE,WAAWgC,OAAM,OAkBF,OAlBjC1P,EAAIyP,EAAAnqE,KACJsoE,EAAmBpqE,KAAKoqE,mBAE1BpqE,KAAKiqE,aACP+B,EAAW,qBACXpvB,EAAM,CACJuvB,QAASp/D,EACTyvD,KAAMA,EACN4P,QAASpsE,KAAKiqE,eAGhB+B,EAAW5B,EAAmB,cAAgB,oBAC9CxtB,EAAM,CACJ7vC,KAAMA,EACNyvD,KAAMA,IAIJle,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAAKqlB,EAAA3pE,KAAA,GACrBuL,EAASm+D,EAAUpvB,GAAI,QACjC,GADFxzC,EAAG6iE,EAAAnqE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF6iE,EAAA3pE,KAAA,SAM1B,OALGgH,OAAOF,EAAIwE,KAAKw6C,SAAS,wBAC3BvzC,GAAIyE,KAAK6R,EAAKkhD,WAEdlhD,EAAKzsB,IAAI2gB,YAAcjW,EAAIwE,IAC3BiH,GAAIyE,KAAK6R,EAAKzsB,MACfutE,EAAAhqE,OAAA,yBAAAgqE,EAAA3pE,KAAA,GAGG2oB,KAAMqhD,YAAW,WAClBtsE,KAAKiqE,eAAgBG,GAAoBhhE,EAAImjE,MAAQlvE,OAAOkH,KAAK6E,EAAI6xD,GAAGxzB,KAAK+kC,cAAcjpE,OAAS,GAAE,CAAA0oE,EAAA3pE,KAAA,gBAAA2pE,EAAA3pE,KAAA,GACnG2oB,KAAM2yB,SAAS,WAAU,eAAAquB,EAAAhqE,OAAA,kBAGjCjC,KAAKsvD,QAAQlmD,EAAI6xD,GAAIuB,GAAK,yBAAAyP,EAAAjnE,OAAA,GAAA+mE,EAAA,UAC3B,SAAApiD,GAAA,OAAAyhD,EAAAxiE,MAAA,KAAAD,UAAA,MAAAqhE,CAAA,CA7HwB,GAiIdyC,GAAmB,WAM9B,SAAAA,EAAa7lB,EAAmB75C,EAAcuiD,GAAiC,IAAAod,EAAA,KAAA7jE,EAAA,KAAA4jE,GAAA3iE,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,oBAC7E9J,KAAK4mD,KAAOA,EACZ5mD,KAAK+M,KAAOA,EACZ/M,KAAKsvD,QAAUA,EAEf,IAAMnkC,EAAOnrB,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,GAC3Cz7B,EAAK6iC,QAAQ3uC,YAActS,EAC3B5C,GAAKy8C,EAAMz7B,EAAK6kC,QAAQ,kBAAM0c,EAAK3B,UAAU,GAC/C,CASC,IAAA4B,EAPDC,EA6BC,OA7BDjjE,EAAA8iE,EAAA,EAAA9uE,IAAA,UAAAE,OAAA+uE,EAAAnkE,EAAAzL,IAAAA,MACA,SAAA6vE,IAAA,IAAAjmB,EAAA,OAAA5pD,IAAAA,MAAA,SAAA8vE,GAAA,cAAAA,EAAAjoE,KAAAioE,EAAAxqE,MAAA,OACQskD,EAAO5mD,KAAK4mD,KAClB/xC,GAAIyF,QAAQ,KAAK,SAAAsrB,GACfghB,EAAKrsC,MAAMuhD,UAAY,SAAH/vD,OAAY,GAAM,GAAM65B,EAAI,KAChDghB,EAAKrsC,MAAMwhD,QAAUzyD,OAAO2J,KAAKsR,IAAIqhB,EAAM,GAC7C,GAAG,WAAU,wBAAAknC,EAAA9nE,OAAA,GAAA6nE,EAAA,UACd,kBAAAD,EAAAhkE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,WAAAE,OAAA8uE,EAAAlkE,EAAAzL,IAAAA,MAED,SAAA+vE,IAAA,IAAA5hD,EAAAyxB,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAgwE,GAAA,cAAAA,EAAAnoE,KAAAmoE,EAAA1qE,MAAA,OAMyC,OALjC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKzsB,KACRk+C,EAAM,CACV7vC,KAAM/M,KAAK+M,MAEPuxC,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAAKomB,EAAA1qE,KAAA,EACrBuL,EAAS,oBAAqB+uC,GAAI,OAC5C,GADFxzC,EAAG4jE,EAAAlrE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF4jE,EAAA1qE,KAAA,SAET,OADlB6oB,EAAKzsB,IAAI2gB,YAAcjW,EAAIwE,IAC3BiH,GAAIyE,KAAK6R,EAAKzsB,KAAIsuE,EAAA/qE,OAAA,sBAGhBmH,EAAImjE,KAAM,CAAFS,EAAA1qE,KAAA,gBAAA0qE,EAAA1qE,KAAA,GACJ2oB,KAAMqhD,YAAW,eAAAU,EAAA1qE,KAAA,GACjB2oB,KAAM2yB,SAAS,WAAU,eAAAovB,EAAA/qE,OAAA,kBAGjCjC,KAAKsvD,QAAQlmD,EAAI6xD,IAAG,yBAAA+R,EAAAhoE,OAAA,GAAA+nE,EAAA,UACrB,kBAAAJ,EAAA/jE,MAAA,KAAAD,UAAA,MAAA8jE,CAAA,CA7C6B,GAiDnBQ,GAAS,WAKpB,SAAAA,EAAarmB,EAAmB0I,GAAqB,IAAA4d,EAAA,KAAArkE,EAAA,KAAAokE,GAAAnjE,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,oBACnD9J,KAAKsvD,QAAUA,EACftvD,KAAK4mD,KAAOA,EAEZz8C,GAAKy8C,GADQ5mD,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,IAC3BoJ,QAAQ,WAAQkd,EAAKld,QAAS,IAC9C/kC,KAAMilC,mBAAmB,CACvBid,MAAO,SAAC/c,GAAqB8c,EAAKE,gBAAgBhd,EAAM,GAE5D,CA0CA,IAAAid,EA1BCC,EAiCA,OAjDA3jE,EAAAsjE,EAAA,EAAAtvE,IAAA,kBAAAE,MAED,SAAiB2I,GACf,GAAkB,KAAdA,EAAEmsD,QAAN,CACA,IAAM4a,EAAW14D,GAAI24D,KAAKxtE,KAAK4mD,KAAM,aACrC/xC,GAAIyE,KAAKi0D,GACLA,IAAUA,EAASluD,YAAc7Y,EAAEmsD,QAHX,CAI9B,GAAC,CAAAh1D,IAAA,QAAAE,MAED,WACEmC,KAAKmrB,KAAKsiD,GAAG1+C,OACf,GAAC,CAAApxB,IAAA,UAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAKmrB,KAAKmqC,QACnBt1D,KAAKmrB,KAAKsiD,GAAG5vE,MAAQ,EACvB,GAAC,CAAAF,IAAA,SAAAE,OAAAyvE,EAAA7kE,EAAAzL,IAAAA,MAED,SAAA0wE,IAAA,IAAAviD,EAAAsiD,EAAAnvB,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA2wE,GAAA,cAAAA,EAAA9oE,KAAA8oE,EAAArrE,MAAA,OAGgC,GAFxB6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKmqC,QAEH,MADLmY,EAAKtiD,EAAKsiD,GAAG5vE,OAAS,IACf,CAAA8vE,EAAArrE,KAAA,QACyD,OAApEuS,GAAI+4D,cAAcziD,EAAKmqC,OAAQ/4C,GAAUA,IAA2BoxD,EAAA1rE,OAAA,iBAG/B,OAAjCq8C,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAAK+mB,EAAArrE,KAAA,EACrBuL,EAAS,aAAc,CAAEwjD,KAAMoc,IAAK,OAEpC,GAFZrkE,EAAGukE,EAAA7rE,KACTw8C,IACAnzB,EAAKsiD,GAAG5vE,MAAQ,GACXotB,KAAM6mC,cAAc1oD,GAAM,CAAFukE,EAAArrE,KAAA,SACY,OAAvCuS,GAAI+4D,cAAcziD,EAAKmqC,OAAQlsD,EAAIwE,KAAI+/D,EAAA1rE,OAAA,yBAAA0rE,EAAArrE,KAAA,GAGnC2oB,KAAMqhD,YAAW,QACvBljE,EAAIykE,MAAQzkE,EAAIykE,OAAS,GACzBzkE,EAAIykE,MAAMnpE,UACV0E,EAAI0kE,MAAQ1kE,EAAI0kE,OAAS,GACzB7iD,KAAM8iD,SAAS3kE,EAAIykE,MAAOzkE,EAAI0kE,OAC9B9tE,KAAKsvD,UAAS,yBAAAqe,EAAA3oE,OAAA,GAAA0oE,EAAA,UACf,kBAAAJ,EAAA1kE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,UAAAE,OAAAwvE,EAAA5kE,EAAAzL,IAAAA,MACA,SAAAgxE,IAAA,IAAApnB,EAAA,OAAA5pD,IAAAA,MAAA,SAAAixE,GAAA,cAAAA,EAAAppE,KAAAopE,EAAA3rE,MAAA,OACQskD,EAAO5mD,KAAK4mD,KAClB/xC,GAAIyF,QAAQ,KAAK,SAAAsrB,GACfghB,EAAKrsC,MAAMuhD,UAAY,SAAH/vD,OAAY,GAAM,GAAM65B,EAAI,KAChDghB,EAAKrsC,MAAMwhD,QAAUzyD,OAAO2J,KAAKsR,IAAIqhB,EAAM,GAC7C,GAAG,WAAU,wBAAAqoC,EAAAjpE,OAAA,GAAAgpE,EAAA,UACd,kBAAAX,EAAAzkE,MAAA,KAAAD,UAAA,MAAAskE,CAAA,CA9DmB,GAuETiB,GAAc,WAKzB,SAAAA,EAAatnB,GAAmB,IAAAunB,EAAA,KAAAtlE,EAAA,KAAAqlE,GAAApkE,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,uBAC9B9J,KAAK4mD,KAAOA,EACZ,IAAMz7B,EAAOnrB,KAAKmrB,KAAOtW,GAAIwoC,cAAcuJ,GAC3C/xC,GAAIuyB,eAAejc,EAAKijD,qBACxBv5D,GAAI1K,KAAKghB,EAAKkjD,eAAgB,QAAO5lE,EAAAzL,IAAAA,MAAE,SAAAsxE,IAAA,OAAAtxE,IAAAA,MAAA,SAAAuxE,GAAA,cAAAA,EAAA1pE,KAAA0pE,EAAAjsE,MAAA,OAAc6rE,EAAKK,oBAAmB,wBAAAD,EAAAvpE,OAAA,GAAAspE,EAAA,MAC7Ez5D,GAAI1K,KAAKghB,EAAKsjD,eAAgB,SAAS,WAAQN,EAAKO,aAAc,GACpE,CAqEC,IAAAC,EAhBDC,EAnDAC,EAiFC,OAjFDllE,EAAAukE,EAAA,EAAAvwE,IAAA,WAAAE,OAAAgxE,EAAApmE,EAAAzL,IAAAA,MACA,SAAA8xE,EAAgB/wD,GAAe,IAAAoN,EAAAlM,EAAAmG,EAAAqsC,EAAA,OAAAz0D,IAAAA,MAAA,SAAA+xE,GAAA,cAAAA,EAAAlqE,KAAAkqE,EAAAzsE,MAAA,OAC7BtC,KAAK+d,QAAUA,EACToN,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKy6B,WAAYz6B,EAAK6jD,oBACzB/vD,EAAQgM,KAAMoW,OAAOtjB,GAC3BoN,EAAK8jD,YAAYxvD,IAAM5K,GAAImK,SAASC,EAAMN,QACpCyG,EAAS6F,KAAM8sB,UAAUh6B,GAC/BoN,EAAK+jD,YAAY7vD,YAAcJ,EAAMvK,SAASC,aAAamI,KACvDmC,EAAM+sB,QACFylB,EAAcxmC,KAAMoW,OAAOpiB,EAAM+sB,MAAMC,UAC7C9gB,EAAKgkD,uBAAuB1vD,IAAM5K,GAAImK,SAASyyC,EAAY9yC,QAC3DwM,EAAKikD,uBAAuB/vD,YAAcoyC,EAAY1tD,KACtD8Q,GAAIyE,KAAK6R,EAAK6jD,qBAEhBn6D,GAAIqf,UAlCkB,EAkCV9O,EAAO+vB,QAAmChqB,EAAKkkD,mBAC3DrvE,KAAKsvE,WAAWlqD,EAAOk/C,SAAQ,yBAAAyK,EAAA/pE,OAAA,GAAA8pE,EAAA,UAChC,SAAAllD,GAAA,OAAAilD,EAAAjmE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,aAAAE,MAED,SAAYkP,GAAc,IAAAwiE,EAAA,KAClBpkD,EAAOnrB,KAAKmrB,KAElB,GADAtW,GAAI2E,KAAK2R,EAAKqkD,kBACVziE,EAAKg9B,WAAW,YAAa,CAC/B,IAAM0lC,EAAYpjE,KAAKG,MAAMO,EAAK8R,UAAU,IAC5ChK,GAAImD,MAAMmT,EAAKqkD,kBACf36D,GAAIyE,KAAK6R,EAAKqkD,kBAEd,IADA,IAAqCE,EAAA,WAChC,IAAA5pB,EAAAl+C,EAAAi+C,EAAA8pB,GAAA,GAAOC,EAAQ9pB,EAAA,GAAE+pB,EAAI/pB,EAAA,GAClB3e,EAAMhc,EAAKijD,oBAAoB3iD,WAAU,GAC/CN,EAAKqkD,iBAAiBl3D,YAAY6uB,GAClCA,EAAI9nB,YAAcuwD,EAClBzoC,EAAI5oB,QAAQ7e,KAAOkwE,EALO,YAMtBA,GAAkCzoC,EAAIxuB,UAAUC,IAAI,YAExD/D,GAAI1K,KAAKg9B,EAAK,SAAS,WACrB,IAAK,IAAL2oC,EAAA,EAAAC,EAAoB3oE,MAAMI,KAAK2jB,EAAKqkD,iBAAiB90D,UAASo1D,EAAAC,EAAAxsE,OAAAusE,IAAA,CAAzD,IAAME,EAAID,EAAAD,GAAmEE,EAAKr3D,UAAUmN,OAAO,WAAYkqD,EAAKzxD,QAAQ7e,OAASkwE,EAAS,CACnJL,EAAKU,kBAAkBJ,EACzB,GACF,EAXAF,EAAA,EAAA9pB,EAA+BxoD,OAAOkgB,QAAQkyD,GAAUE,EAAA9pB,EAAAtiD,OAAAosE,IAAAD,IAYxD3iE,EAAO0iE,EAAUS,OACnB,CAEAlwE,KAAKiwE,kBAAkBljE,EACzB,GAAC,CAAApP,IAAA,oBAAAE,MAED,SAAmBkP,GACjB,IAAMoe,EAAOnrB,KAAKmrB,KAClBA,EAAKglD,eAAe9wD,YAActS,EAClCoe,EAAKilD,OAAO3wD,IAAM,2BAAH1T,OAA8BgB,EAC/C,GAEA,CAAApP,IAAA,oBAAAE,OAAA+wE,EAAAnmE,EAAAzL,IAAAA,MACA,SAAAqzE,IAAA,IAAAllD,EAAApN,EAAA6oC,EAAAtI,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAszE,GAAA,cAAAA,EAAAzrE,KAAAyrE,EAAAhuE,MAAA,OAGoC,OAF1B6oB,EAAwBnrB,KAAxBmrB,KAAMpN,EAAkB/d,KAAlB+d,QAAS6oC,EAAS5mD,KAAT4mD,KACvB/xC,GAAI2E,KAAK2R,EAAKy6B,YACRtH,EAASrzB,KAAMuzB,QAAQoI,GAAK0pB,EAAAhuE,KAAA,EAChBuL,EAAS,sBAAuB,CAChDkQ,QAASA,IACT,OACM,GAHF3U,EAAGknE,EAAAxuE,KAGTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFknE,EAAAhuE,KAAA,SAEF,OADzB6oB,EAAKy6B,WAAWvmC,YAAcjW,EAAIwE,IAClCiH,GAAIyE,KAAK6R,EAAKy6B,YAAW0qB,EAAAruE,OAAA,kBAG3BgpB,KAAM8sB,UAAUh6B,GAASumD,QAAUl7D,EAAIk7D,QACvCtkE,KAAKsvE,WAAWlmE,EAAIk7D,SAAQ,yBAAAgM,EAAAtrE,OAAA,GAAAqrE,EAAA,UAC7B,kBAAAzB,EAAAhmE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,cAAAE,OAAA8wE,EAAAlmE,EAAAzL,IAAAA,MAED,SAAAuzE,IAAA,IAAAplD,EAAA,OAAAnuB,IAAAA,MAAA,SAAAwzE,GAAA,cAAAA,EAAA3rE,KAAA2rE,EAAAluE,MAAA,OACQ6oB,EAAOnrB,KAAKmrB,KAClB9X,UAAUiX,UAAUC,UAAUY,EAAKglD,eAAe9wD,aAAe,IAC9Dne,MAAK,WACJ2T,GAAIyE,KAAK6R,EAAKslD,WACdl3D,YAAW,WACT1E,GAAI2E,KAAK2R,EAAKslD,UAChB,GAAG,IACL,IAAE,OACK,SAAChkD,GACN9R,QAAQvZ,MAAM,mBAAoBqrB,EACpC,IAAE,wBAAA+jD,EAAAxrE,OAAA,GAAAurE,EAAA,UACL,kBAAA5B,EAAA/lE,MAAA,KAAAD,UAAA,MAAAulE,CAAA,CA9FwB,GAkGdwC,GAAgB,WAK3B,SAAAA,EAAa9pB,EAAmB0I,GAAqB,IAAAqhB,EAAA,KAAA9nE,EAAA,KAAA6nE,GAAA5mE,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,uBACnD9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EAEfnlD,GAAKy8C,GADQ5mD,KAAKmrB,KAAOtW,GAAIwoC,cAAcuJ,IAC3BgqB,qBAAqB,kBAAMD,EAAKE,YAAY,GAC9D,CAAC,IAAAC,EA0CA,OA1CAnnE,EAAA+mE,EAAA,EAAA/yE,IAAA,aAAAE,OAAAizE,EAAAroE,EAAAzL,IAAAA,MAED,SAAA+zE,IAAA,IAAA5lD,EAAA6lD,EAAAC,EAAA3yB,EAAAl1C,EAAA8nE,EAAA,YAAAl0E,IAAAA,MAAA,SAAAm0E,GAAA,cAAAA,EAAAtsE,KAAAssE,EAAA7uE,MAAA,OAG0D,GAFlD6oB,EAAOnrB,KAAKmrB,KACZ6lD,EAAW7lD,EAAKimD,eAAevzE,OAAS,GACxCozE,EAAkB9lD,EAAKkmD,sBAAsBxzE,MAClC,KAAbmzE,EAAe,CAAAG,EAAA7uE,KAAA,QAC6D,OAA9EuS,GAAI+4D,cAAcziD,EAAKmmD,iBAAkB/0D,GAAUA,IAA2B40D,EAAAlvE,OAAA,oBAG5E+uE,IAAaC,EAAe,CAAAE,EAAA7uE,KAAA,QACiD,OAA/EuS,GAAI+4D,cAAcziD,EAAKmmD,iBAAkB/0D,GAAUA,IAA4B40D,EAAAlvE,OAAA,iBAI1C,OAAjCq8C,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAAKuqB,EAAA7uE,KAAA,GACrBuL,EAAS,wBAAyB,CAClD0jE,QAASP,EACTQ,KAAMrmD,EAAKsmD,UAAU5zE,QACrB,QACM,GAJFuL,EAAG+nE,EAAArvE,KAITw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF+nE,EAAA7uE,KAAA,SACsB,OAAjDuS,GAAI+4D,cAAcziD,EAAKmmD,iBAAkBloE,EAAIwE,KAAIujE,EAAAlvE,OAAA,kBAI/C4S,GAAI82D,YAAYxgD,EAAKmmD,mBAAmBz8D,GAAI2E,KAAK2R,EAAKmmD,kBAC1DnmD,EAAKumD,qBAAqBryD,YAAc9C,GVzzDC,8BU0zDzC1H,GAAIyE,KAAK6R,EAAKumD,sBACdn4D,YAAW,kBAAM23D,EAAK5hB,SAAS,GAAE,KAAM,yBAAA6hB,EAAAnsE,OAAA,GAAA+rE,EAAA,UACxC,kBAAAD,EAAAloE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,QAAAE,MAED,WACEmC,KAAKmrB,KAAKimD,eAAeriD,OAC3B,GAAC,CAAApxB,IAAA,UAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBA,EAAKimD,eAAevzE,MAAQ,GAC5BstB,EAAKkmD,sBAAsBxzE,MAAQ,GACnCstB,EAAKsmD,UAAU5zE,MAAQ,GACvBgX,GAAI2E,KAAK2R,EAAKumD,qBAAsBvmD,EAAKmmD,iBAC3C,KAACZ,CAAA,CApD0B,GAuDhBvG,GAAiB,WAG5B,SAAAA,EAAahzD,GAAqB,IAAAw6D,EAAA,KAAA9oE,EAAA,KAAAshE,GAAArgE,EAAA,oBAChC,IAAMqhB,EAAOnrB,KAAKmrB,KAAOtW,GAAI6W,cAAcvU,GAC3CgU,EAAKymD,aAAavyD,YAAc9C,GAAUA,GAC1C1H,GAAI1K,KAAKghB,EAAK2vC,SAAU,UAAU,kBAAM6W,EAAKE,kBAAkB,IAC/Dh9D,GAAI1K,KAAKghB,EAAK2mD,WAAY,SAAS,kBAAMH,EAAKrG,eAAe,IAC7Dz2D,GAAI1K,KAAKghB,EAAK4mD,QAAS,SAAS,kBAAM5mD,EAAK2vC,SAAS7mC,OAAO,GAC7D,CAsBC,IAAA+9C,EApBDC,EA+BC,OA/BDtoE,EAAAwgE,EAAA,EAAAxsE,IAAA,mBAAAE,OAAAo0E,EAAAxpE,EAAAzL,IAAAA,MAIA,SAAAk1E,IAAA,IAAA/mD,EAAA+rC,EAAA,OAAAl6D,IAAAA,MAAA,SAAAm1E,GAAA,cAAAA,EAAAttE,KAAAstE,EAAA7vE,MAAA,OAEmC,GAD3B6oB,EAAOnrB,KAAKmrB,MACZ+rC,EAAQ/rC,EAAK2vC,SAAS5D,QACbA,EAAM3zD,OAAM,CAAA4uE,EAAA7vE,KAAA,eAAA6vE,EAAAlwE,OAAA,iBAC3BkpB,EAAKymD,aAAavyD,YAAc63C,EAAM,GAAGnzD,KACzC8Q,GAAIyE,KAAK6R,EAAK2mD,YACdj9D,GAAI2E,KAAK2R,EAAK4mD,SAAQ,wBAAAI,EAAAntE,OAAA,GAAAktE,EAAA,UACvB,kBAAAD,EAAArpE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,MACA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBA,EAAK2vC,SAASj9D,MAAQ,GACtBstB,EAAKymD,aAAavyD,YAAc9C,GAAUA,GAC1C1H,GAAI2E,KAAK2R,EAAK2mD,YACdj9D,GAAIyE,KAAK6R,EAAK4mD,QAChB,GAAC,CAAAp0E,IAAA,OAAAE,OAAAm0E,EAAAvpE,EAAAzL,IAAAA,MAED,SAAAo1E,IAAA,IAAAjnD,EAAA+rC,EAAA,OAAAl6D,IAAAA,MAAA,SAAAq1E,GAAA,cAAAA,EAAAxtE,KAAAwtE,EAAA/vE,MAAA,OACwB,KAAhB6oB,EAAOnrB,KAAKmrB,MACT2vC,SAASj9D,MAAO,CAAFw0E,EAAA/vE,KAAA,QACY,KAA3B40D,EAAQ/rC,EAAK2vC,SAAS5D,SACfA,EAAM3zD,OAAM,CAAA8uE,EAAA/vE,KAAA,eAAA+vE,EAAA/vE,KAAA,EACV40D,EAAM,GAAGvpD,OAAM,cAAA0kE,EAAApwE,OAAA,SAAAowE,EAAAvwE,MAAA,cAAAuwE,EAAApwE,OAAA,SAGzB,IAAE,wBAAAowE,EAAArtE,OAAA,GAAAotE,EAAA,UACV,kBAAAJ,EAAAppE,MAAA,KAAAD,UAAA,MAAAwhE,CAAA,CA1C2B,GA6CjBmI,GAAiB,WAQ5B,SAAAA,EAAan7D,EAAqBm4C,GAAsB,IAAAijB,EAAA,KAAA1pE,EAAA,KAAAypE,GAAAxoE,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,wBAAAA,EAAA,qBAAAA,EAAA,oBACtD9J,KAAKmrB,KAAOtW,GAAI6W,cAAcvU,GAC9BnX,KAAKsvD,QAAUA,EACfz6C,GAAI1K,KAAKnK,KAAKmrB,KAAK6kC,OAAQ,SAAS,WAAQuiB,EAAKC,SAAU,GAC7D,CA2CA,IAAAC,EA3CCC,EA4EA,OA5EA/oE,EAAA2oE,EAAA,EAAA30E,IAAA,WAAAE,OAAA60E,EAAAjqE,EAAAzL,IAAAA,MAED,SAAA21E,EAAgB50D,EAAiBupB,GAAY,IAAAsrC,EAAAC,EAAA5mC,EAAA9gB,EAAA2nD,EAAA1pE,EAAA2pE,EAAAt2D,EAAAu2D,EAAA1O,EAAAv0B,EAAAoiB,EAAAyT,EAAAqN,EAAA32D,EAAA,OAAAtf,IAAAA,MAAA,SAAAk2E,GAAA,cAAAA,EAAAruE,KAAAquE,EAAA5wE,MAAA,OAY0B,OAXrEtC,KAAK+d,QAAUA,EACf/d,KAAKsnC,KAAOA,EACNurC,EAAa5nD,KAAMoW,OAAOtjB,GAC1BkuB,EAAWjsC,KAAKisC,SAA2B,QAAnB2mC,EAAGC,EAAW7mC,aAAK,IAAA4mC,OAAA,EAAhBA,EAAkB3mC,SAC3C9gB,EAASnrB,KAATmrB,KAERtW,GAAIyE,KAAK6R,EAAKgoD,oBACdt+D,GAAI2E,KAAK2R,EAAKioD,MAAOjoD,EAAKmqC,OAAQnqC,EAAKkoD,WAAYloD,EAAK85C,WAAY95C,EAAKkoD,YAEzEx+D,GAAImD,MAAMmT,EAAKmoD,aACfnoD,EAAKmoD,YAAYh7D,YAAYzD,GAAI2vD,UAAUqO,GAAY,IACjDC,EAAkB7nD,KAAMuc,UAAUF,GAAMjG,OAAOtjB,GAASw1D,QAAOL,EAAA5wE,KAAA,GACnDuL,EAAS,uBAAwB,CACjDkQ,QAAS80D,EAAW59D,GACpBs+D,QAAST,EACTU,WAAW,IACX,QAJIpqE,EAAG8pE,EAAApxE,KAKJmpB,KAAM6mC,cAAc1oD,IAGlB2pE,EAC0F9nD,KAAMoW,OAAO4K,GAA1FxvB,EAAEs2D,EAAZr+D,SAAQs+D,EAAAD,EAAM3tD,OAAUk/C,EAAO0O,EAAP1O,QAA+Bv0B,EAAKijC,EAA3Bx6B,QAAWxI,UAA4BmiB,EAAU4gB,EAAhBhvE,KACpE6hE,EAAQ5lE,KAAK4lE,MAAQx8D,EAAIw8D,MAC3BqN,EAAU,GAAHlnE,OAAM8I,GAAIkc,gBAAgB60C,EAAOnpD,GAAG,KAAA1Q,OAAI0Q,EAAG9H,aAAamI,OAC7DR,EAAO2O,KAAMymB,aAAazF,MAE9BgnC,GAAW,KAAJlnE,OAAS8I,GAAIyN,qBAAqBsjD,EAAOtpD,EAAMG,GAAG,UAE3D0O,EAAK4+C,YAAY1qD,YAAc4zD,EAC/Bp+D,GAAIyE,KAAK6R,EAAK85C,YACd95C,EAAKqtB,QAAQn5B,YAAcxK,GAAIkc,gBAAgBgf,EAAOtzB,GACtD0O,EAAKsoD,aAAap0D,YAAc5C,EAAG9H,aAAamI,KAChDqO,EAAKgnC,WAAW9yC,YAAc8yC,EAC1BpiB,EAAQ61B,IACV/wD,GAAIyE,KAAK6R,EAAKkoD,YACdloD,EAAKm5C,QAAQjlD,YAAcilD,KAjB7Bn5C,EAAKmqC,OAAOj2C,YAAcjW,EAAIwE,IAC9BiH,GAAIyE,KAAK6R,EAAKmqC,SAkBf,yBAAA4d,EAAAluE,OAAA,GAAA2tE,EAAA,UACF,SAAA9oD,EAAAk1B,GAAA,OAAA2zB,EAAA9pE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,UAAAE,OAAA40E,EAAAhqE,EAAAzL,IAAAA,MAGA,SAAA02E,IAAA,IAAAvoD,EAAApN,EAAAupB,EAAAgoB,EAAAujB,EAAAzpE,EAAA2iC,EAAA,OAAA/uC,IAAAA,MAAA,SAAA22E,GAAA,cAAAA,EAAA9uE,KAAA8uE,EAAArxE,MAAA,OAG0C,OAFhC6oB,EAAiCnrB,KAAjCmrB,KAAMpN,EAA2B/d,KAA3B+d,QAASupB,EAAkBtnC,KAAlBsnC,KAAMgoB,EAAYtvD,KAAZsvD,QAEvBujB,EAAa5nD,KAAMoW,OAAOtjB,GAAQ41D,EAAArxE,KAAA,EACtBuL,EAFL,oBAEoB,CAC/BkQ,QAAS80D,EAAW59D,GACpBinD,QAAS50B,IACT,OAHO,GAAHl+B,EAAGuqE,EAAA7xE,KAIJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFuqE,EAAArxE,KAAA,SAEN,OADrB6oB,EAAKmqC,OAAOj2C,YAAcjW,EAAIwE,IAC9BiH,GAAIyE,KAAK6R,EAAKmqC,QAAOqe,EAAA1xE,OAAA,kBAGvBkpB,EAAKyf,KAAK0xB,UAAYlzD,EAAIk/D,MACpBv8B,EAAgBrB,GAAcmoC,EAAW59D,MAC1B82B,EAAc9gB,KAAM6gB,KAAKD,OAC5C1gB,EAAKyf,KAAKuB,KAAOJ,EAAc9gB,KAAM6gB,KAAKD,KAAKziC,EAAIk/D,OAErDzzD,GAAI2E,KAAK2R,EAAKgoD,mBAAoBhoD,EAAK85C,WAAY95C,EAAKkoD,YACxDx+D,GAAIyE,KAAK6R,EAAKioD,OACV9jB,GAASA,IAAS,yBAAAqkB,EAAA3uE,OAAA,GAAA0uE,EAAA,UACvB,kBAAAjB,EAAA7pE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,oBAAAE,MAED,SAAmB2I,GACjB,IAAQ2kB,EAA0BnrB,KAA1BmrB,KAAM8gB,EAAoBjsC,KAApBisC,SAAU25B,EAAU5lE,KAAV4lE,MACpBp/D,EAAEuX,UAAYkuB,IAClB9gB,EAAKqtB,QAAQn5B,YAAcxK,GAAIkc,gBAAgBvqB,EAAEgyC,QAAQxI,UAAW/kB,KAAMoW,OAAO4K,GAAUv3B,UACvFlO,EAAEgyC,QAAQxI,WAAa41B,EACzB/wD,GAAI2E,KAAK2R,EAAKkoD,YACTx+D,GAAI2E,KAAK2R,EAAKmqC,QACvB,KAACgd,CAAA,CAxF2B,GA2FjBsB,GAAoB,WAM/B,SAAAA,EAAahtB,EAAmBz4B,GAAsD,IAAA0lD,EAAA,KAAAhrE,EAAA,KAAA+qE,GAAA9pE,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,uBACpF9J,KAAK4mD,KAAOA,EACZ5mD,KAAKmuB,QAAUA,EACfnuB,KAAKmrB,KAAOtW,GAAI6W,cAAck7B,GAC9B/xC,GAAI1K,KAAKnK,KAAKmrB,KAAK2oD,UAAW,SAAS,kBAAMD,EAAK7jB,QAAQ,GAC5D,CAqBA,IAAA+jB,EA6BC,OAlDApqE,EAAAiqE,EAAA,EAAAj2E,IAAA,SAAAE,MAED,SAAQmwC,GACNhuC,KAAKguC,QAAUA,EACfqD,GAAerxC,KAAK4mD,KAAM5Y,GAC1B,IAAM7iB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK6oD,gBAAiB7oD,EAAK8oD,iBAAkB9oD,EAAK+oD,YAC3D/oD,EAAKgpD,eAAet2E,MAAQ,GAC5BstB,EAAKipD,eAAev2E,MAAQ,GAC5B,IAAMw2E,EAAYppD,KAAM2iB,SAASyK,MAAMrK,GACjCsmC,EAAaD,aAAS,EAATA,EAAWC,WAC1BA,GACFz/D,GAAIyE,KAAK6R,EAAK8oD,kBACd9oD,EAAKopD,cAAcl1D,YAAci1D,EACjCnpD,EAAKgpD,eAAet2E,MAAQw2E,EAAU5mC,OAAO+mC,OAC7CrpD,EAAKipD,eAAev2E,MAAQw2E,EAAU5mC,OAAOgnC,WAE7C5/D,GAAIyE,KAAK6R,EAAK6oD,gBAElB,GAEA,CAAAr2E,IAAA,SAAAE,OAAAk2E,EAAAtrE,EAAAzL,IAAAA,MAGA,SAAA03E,IAAA,IAAAvpD,EAAA6iB,EAAA4Y,EAAA4tB,EAAAC,EAAAn2B,EAAAl1C,EAAAurE,EAAA,OAAA33E,IAAAA,MAAA,SAAA43E,GAAA,cAAAA,EAAA/vE,KAAA+vE,EAAAtyE,MAAA,OAI6C,GAHnC6oB,EAAwBnrB,KAAxBmrB,KAAM6iB,EAAkBhuC,KAAlBguC,QAAS4Y,EAAS5mD,KAAT4mD,KACvB/xC,GAAI2E,KAAK2R,EAAK+oD,YACRM,EAASrpD,EAAKgpD,eAAet2E,MAC7B42E,EAAYtpD,EAAKipD,eAAev2E,MACjC22E,GAAWC,EAAS,CAAAG,EAAAtyE,KAAA,QAE2C,OADlEuS,GAAIyE,KAAK6R,EAAK+oD,YACd/oD,EAAK+oD,WAAW70D,YAAc9C,GAAUA,GAA0Bq4D,EAAA3yE,OAAA,iBAGlC,OAA5Bq8C,EAASrzB,KAAMuzB,QAAQoI,GAAKguB,EAAA/vE,KAAA,EAAA+vE,EAAAtyE,KAAA,GAEdyqC,GAAG8nC,gBAAgB,CACnC9wE,KAAMiqC,EACNwmC,OAAQA,EACRC,UAAWA,IACX,QAJO,GAAHrrE,EAAGwrE,EAAA9yE,KAKJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFwrE,EAAAtyE,KAAA,eAAQ8G,EAAG,QACxCpJ,KAAKmuB,QAAQ6f,GAAS,GAAK4mC,EAAAtyE,KAAA,iBAAAsyE,EAAA/vE,KAAA,GAAA+vE,EAAAlnE,GAAAknE,EAAA,SAE3B//D,GAAIyE,KAAK6R,EAAK+oD,YACd/oD,EAAK+oD,WAAW70D,YAAc9C,GAAUA,EAAmB,CAAE3O,IAAU,QAAP+mE,EAAEC,EAAAlnE,GAAEE,WAAG,IAAA+mE,EAAAA,EAAIrrE,OAAMsrE,EAAAlnE,MACjF1N,KAAKmuB,QAAQ6f,GAAS,GAAM,QAEpB,OAFoB4mC,EAAA/vE,KAAA,GAE5By5C,IAAQs2B,EAAAjvE,OAAA,6BAAAivE,EAAA5vE,OAAA,GAAA0vE,EAAA,yBAEX,kBAAAX,EAAAnrE,MAAA,KAAAD,UAAA,MAAAirE,CAAA,CA7D8B,GAgE3B1kB,GAAkB,IAGjB,SAAe4lB,GAAS91B,EAAAC,GAAA,OAAA81B,GAAAnsE,MAAA,KAAAD,UAAA,CAgB9B,SAAAosE,KAAA,OAAAA,GAAAtsE,EAAAzL,IAAAA,MAhBM,SAAAg4E,EAA0BC,EAAoBC,GAAkB,IAAA35C,EAAA,OAAAv+B,IAAAA,MAAA,SAAAm4E,GAAA,cAAAA,EAAAtwE,KAAAswE,EAAA7yE,MAAA,OAC1B,OAArCi5B,EAAQtwB,SAASqC,KAAKoJ,YAAc,EAACy+D,EAAA7yE,KAAA,EACrCuS,GAAIyF,QAAQ40C,IAAiB,SAAAC,GACjC8lB,EAAM16D,MAAMvE,MAAQ,GAAHjK,OAAMojD,EAAW5zB,EAAK,KACzC,GAAG,cAAa,OAOf,OAND1mB,GAAI2E,KAAKy7D,GACTA,EAAM16D,MAAMvE,MAAQ,IACpBk/D,EAAM36D,MAAMvE,MAAQ1M,QAAQiyB,GAC5B1mB,GAAIyE,KAAK47D,GACLA,EAAMhgE,cAAc,UACtBL,GAAIyJ,aAAa42D,EAAO,SAASnmD,QAClComD,EAAA7yE,KAAA,GACKuS,GAAIyF,QAAQ40C,IAAiB,SAAAC,GACjC+lB,EAAM36D,MAAMvE,MAAQ,GAAHjK,OAAeojD,EAAW5zB,EAAnBA,EAAwB,KAClD,GAAG,eAAc,QACjB25C,EAAM36D,MAAMvE,MAAQ,IAAG,yBAAAm/D,EAAAnwE,OAAA,GAAAgwE,EAAA,MACxBpsE,MAAA,KAAAD,UAAA,CAEM,SAASysE,GAAajqD,EAAmCvd,GAC9Dud,EAAKkqD,eAAeh2D,YAAczR,EAClCiH,GAAIyE,KAAK6R,EAAK8xB,MAAO9xB,EAAKmqD,eAC1BnqD,EAAKmqD,cAAc/6D,MAAMvE,MAAQ,IACjCmV,EAAKoqD,UAAUh7D,MAAM8a,SAAW,MAEhC,IAAgFsP,EAAA/8B,EAA/C6C,EAAM4P,SAAW,CAAC,IAAK,IAAK,KAAO,CAAC,GAAI,GAAI,IAAG,GAAzEm7D,EAAM7wC,EAAA,GAAE8wC,EAAM9wC,EAAA,GAAE+wC,EAAM/wC,EAAA,GAEtBgxC,EADqB,GACUH,EAAxBI,EADkB,IACqBH,EAAhCI,EADgB,GAC+BH,EAEpE,OAAO,IAAI57D,GAAU,MAAM,SAAC8rB,GAC1Bza,EAAKoqD,UAAUh7D,MAAM8a,SAAW,GAAHtpB,OAAa,GAAP65B,EAAS,MAC5Cza,EAAKoqD,UAAUh7D,MAAM6N,MAAQ,OAAHrc,OAAUypE,EAAS5vC,EAAO+vC,EAAK,MAAA5pE,OAAK0pE,EAAS7vC,EAAOgwC,EAAK,MAAA7pE,OAAK2pE,EAAS9vC,EAAOiwC,EAAK,IAC/G,GAAG,iBACL,CAMO,SAAS1rE,GAAMy8C,EAAmBkvB,EAAyB9oD,GAChE,IAAM+oD,EAAU,SAACnqE,GACXA,EAAE4c,gBAAgB5c,EAAE4c,iBACxBwE,EAAQphB,EACV,EACAiJ,GAAI1K,KAAK2rE,EAAY,QAASC,GAC9BlhE,GAAI1K,KAAKy8C,EAAM,SAAUmvB,EAC3B,CAUA,SAASjhB,GAAYiE,GACnB,OAAO9lD,KAAK4I,MAAMk9C,EAAKjuD,UAAY,IACrC,CAeA,SAASguD,GAAcC,GACrB,OAPF,SAA0BA,GACxB,OAAO,IAAInuD,KAAKmuD,EAAKjuD,UAAuC,GAA3BiuD,EAAKn3B,oBAA2B,IACnE,CAKSo0C,CAAgBjd,GAAMkd,cAAc3qE,MAAM,KAAK,EAGxD,4GCruEmB,IAOE4qE,GAAgB,SAAAC,GAAA/rE,EAAA8rE,EAAAC,GAAA,IA4JlCC,EALDC,EAVAC,EAXAC,EAPAC,EAPAC,EAVCC,EAHDC,MAvGmCjvD,KAAAwuD,iZAYnC,SAAAA,EAAa5oE,EAAmBY,GAA4B,IAAAiL,EAAAtQ,EAAA,KAAAqtE,GACnDpsE,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,aAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,8BACPA,EAAK7L,KAAOA,EACZ6L,EAAKjL,KAAOA,EACZ,IAAMid,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAc/vC,GAEvCY,EAAKo5B,MAAQnc,EAAKyrD,YAAYj+D,UAAUhD,SAAS,cACnDwV,EAAKyrD,YAAYj+D,UAAUM,OAAO,YAClCkS,EAAK0rD,iBAAiBl+D,UAAUC,IAAI,YACpCuS,EAAK0rD,iBAAiBt4D,QAAQ+oB,KAAOp5B,EAAKo5B,MAI5C,IACsDn8B,EADtDC,+5BAAAC,CACiBiC,EAAKmN,iBAAiB,iBAAe,IAAtD,IAAArP,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAwD,KAA7CsT,EAAE7J,EAAAtN,MAA+CmX,IAAOmW,EAAK2rD,qBAAqBjiE,GAAI2E,KAAKxE,EAAE,CAAC,OAAAtW,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CAEzGsN,EAAK49D,cAAgB,IAAI1nB,GACvBlkC,EAAK4rD,eACL,SAAAh5D,GAAO,OAAI5E,EAAK69D,iBAAiBj5D,EAAS5E,EAAK89D,oBAAoB/b,KAAK,IACxE,kBAAM/hD,EAAK+9D,gBAAgB/rD,EAAK4rD,cAAc,IAIhD59D,EAAKy9D,YAAc,IAAI5M,GAAe7+C,EAAKyrD,YAAW,eAAA58D,EAAAvR,EAAAzL,IAAAA,MAAE,SAAA8P,EAAOmuD,EAAIH,GAAQ,OAAA99D,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OACzE6W,EAAKg+D,kBAAkBhsD,EAAKyrD,YAAa3b,EAAIH,GAAS,wBAAA5tD,EAAAlI,OAAA,GAAA8H,EAAA,KACvD,gBAAA9E,EAAA2E,GAAA,OAAAqN,EAAApR,MAAA,KAAAD,UAAA,EAFqD,IAItD,IAAMoE,EAAOoe,EAAK0rD,iBAAiBt4D,QAAQ+oB,KACvCv6B,IACFoM,EAAK09D,iBAAmB,IAAIpK,GAAoBthD,EAAK0rD,iBAAkB9pE,EAAI,eAAAkN,EAAAxR,EAAAzL,IAAAA,MAAE,SAAAiR,EAAOgtD,GAAE,OAAAj+D,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OACpF6W,EAAKg+D,kBAAkBhsD,EAAK0rD,iBAAkB5b,EAAI,IAAG,wBAAA9sD,EAAAnJ,OAAA,GAAAiJ,EAAA,KACtD,gBAAArB,GAAA,OAAAqN,EAAArR,MAAA,KAAAD,UAAA,EAF0E,KAM7EwQ,EAAKi+D,aAAe,IAAI1a,GAAsBvxC,EAAKisD,aAAY,eAAA14D,EAAAjW,EAAAzL,IAAAA,MAAE,SAAAuR,EAAOwP,EAAiBm9C,GAAY,IAAAj8C,EAAAmG,EAAA62C,EAAAob,EAAA,OAAAr6E,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,UAC/Fyb,IAAYiN,GAAa,CAAAxc,EAAAlM,KAAA,QACF,OAAzB6W,EAAKm+D,qBAAoB9oE,EAAAvM,OAAA,iBAIA,GADrBgd,EAAQgM,KAAMoW,OAAOtjB,KACrBqH,EAASnG,EAAMmG,QACT,CAAF5W,EAAAlM,KAAA,SAC0C,OAA5C25D,EAAY9iD,EAAK8hD,GAAGK,WAAWr8C,EAAMN,QAAOnQ,EAAAlM,KAAA,EACrB6W,EAAKo+D,kBAAkBx5D,EAASoN,EAAKisD,cAAa,OACf,GAD1DC,EAAc7oE,EAAA1M,KACpBqX,EAAK89D,oBAAoBO,SAASz5D,EAASm9C,EAAMmc,KAC7CjyD,EAAOI,QAAUJ,EAAOozB,QAAQxI,WAAa,EAAIisB,EAAU55C,OAASg1D,GAAc,CAAA7oE,EAAAlM,KAAA,SAC1C,OAA1C6W,EAAKs+D,mBAAmBtsD,EAAKisD,cAAa5oE,EAAAvM,OAAA,kBAIC,OAD7CkX,EAAKu+D,eAAeC,UAAU55D,EAASs5D,EAAgBnc,GACvD4Z,GAAU3pD,EAAKisD,aAAcjsD,EAAKysD,YAAWppE,EAAAvM,OAAA,kBAG/CkX,EAAK89D,oBAAoB/b,KAAOA,EAChC/hD,EAAK49D,cAAcS,SAASz5D,GAC5B+2D,GAAU3pD,EAAKisD,aAAcjsD,EAAK4rD,eAAc,yBAAAvoE,EAAAxJ,OAAA,GAAAuJ,EAAA,KACjD,gBAAAT,EAAAC,GAAA,OAAA2Q,EAAA9V,MAAA,KAAAD,UAAA,EAtB8D,IAwB/DwQ,EAAKu+D,eAAiB,IAAI7T,GAAe14C,EAAKysD,YAAY,WACxDz+D,EAAKs+D,mBAAmBtsD,EAAKysD,WAC/B,IAAG,WAAQz+D,EAAK+9D,gBAAgB/rD,EAAKysD,WAAY,IAGjDz+D,EAAK89D,oBAAsB,IAAIpc,GAAwB1vC,EAAK0sD,gBAAgB,WAC1E1+D,EAAKm+D,oBACP,IAAG,WACDn+D,EAAK+9D,gBAAgB/rD,EAAK0sD,eAC5B,IAEA,IAAMj3B,EAAc/rC,GAAIyJ,aAAa6M,EAAK8xB,MAAO,0BAEjD,OADA2D,EAAYjoC,UAAUM,OAAO,YACrB2nC,GACN,KAAKz1B,EAAKyrD,YACRz9D,EAAKy9D,YAAYt8D,UACjB,MACF,KAAK6Q,EAAK0rD,iBACR19D,EAAK09D,iBAAiBv8D,UAWG,OAT7BzF,GAAIyE,KAAKsnC,GAKLA,IAAgBz1B,EAAK0rD,kBACvB19D,EAAK09D,iBAAiB1rD,KAAK6kC,OAAO/7B,QAGhChJ,KAAM6sD,QAAQ3+D,EAAKsuB,OAAMtuB,CAC/B,CA2EC,OAzEDxP,EAAAusE,EAAA,EAAAv4E,IAAA,OAAAE,OAAA84E,EAAAluE,EAAAzL,IAAAA,MACA,SAAA2mB,IAAA,OAAA3mB,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,cAAAshB,EAAAthB,KAAA,EACQ2oB,KAAMqhD,YAAW,wBAAA1oD,EAAA5e,OAAA,GAAA2e,EAAA,KACxB,kBAAAgzD,EAAA/tE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,oBAAAE,OAAA64E,EAAAjuE,EAAAzL,IAAAA,MAED,SAAA6mB,EAAyBk0D,EAAsB9c,EAAcH,GAAgB,OAAA99D,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAC3EtC,KAAKi7D,GAAKA,EACVj7D,KAAKi3E,oBAAoBjW,YAAY/F,EAAIH,GACzC96D,KAAK03E,eAAe1W,YAAY/F,GAChCj7D,KAAKo3E,aAAapW,YAAY/F,EAAIH,GAClC96D,KAAKk3E,gBAAgBa,GAAQ,wBAAAj0D,EAAA9e,OAAA,GAAA6e,EAAA,UAC9B,SAAAxV,EAAAqV,EAAA+C,GAAA,OAAAiwD,EAAA9tE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,kBAAAE,OAAA44E,EAAAhuE,EAAAzL,IAAAA,MACA,SAAAopB,EAAuB2xD,GAAoB,OAAA/6E,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OACzCuS,GAAI2E,KAAKu+D,GACT/3E,KAAKo3E,aAAa98D,UAClBzF,GAAIyE,KAAKtZ,KAAKmrB,KAAKisD,cAAa,wBAAA9wD,EAAAthB,OAAA,GAAAohB,EAAA,UACjC,SAAAsD,GAAA,OAAA+sD,EAAA7tE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,qBAAAE,OAAA24E,EAAA/tE,EAAAzL,IAAAA,MACA,SAAA+sB,EAA0BguD,GAAoB,OAAA/6E,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,OAC5CtC,KAAKi3E,oBAAoB38D,UACzBzF,GAAI2E,KAAKu+D,GACTljE,GAAIyE,KAAKtZ,KAAKmrB,KAAK0sD,gBAAe,wBAAAxtD,EAAArlB,OAAA,GAAA+kB,EAAA,UACnC,SAAAJ,GAAA,OAAA6sD,EAAA5tE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,oBAAAE,OAAA04E,EAAA9tE,EAAAzL,IAAAA,MACA,SAAAmxC,EAAyBpwB,EAAiB6oC,GAAiB,IAAAtI,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OACvB,OAA5Bg8C,EAASrzB,KAAMuzB,QAAQoI,GAAKvY,EAAA/rC,KAAA,EAChBuL,EAAS,sBAAuB,CAAEkQ,QAAAA,IAAU,OACtD,GADF3U,EAAGilC,EAAAvsC,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFilC,EAAA/rC,KAAA,eAAA+rC,EAAApsC,OAAA,SACpB,GAAC,cAAAosC,EAAApsC,OAAA,SAEHmH,EAAI4uE,WAAS,wBAAA3pC,EAAArpC,OAAA,GAAAmpC,EAAA,KACrB,SAAAvkB,EAAAC,GAAA,OAAA0sD,EAAA3tE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,cAAAE,OAAAy4E,EAAA7tE,EAAAzL,IAAAA,MACA,SAAAi6C,IAAA,IAAAulB,EAAAtF,EAAA,OAAAl6D,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,OACe,GAATk6D,EAAO,IACPx8D,KAAK42E,YAAYzrD,KAAK2vC,SAASj9D,MAAO,CAAFq5C,EAAA50C,KAAA,QACY,KAA5C40D,EAAQl3D,KAAK42E,YAAYzrD,KAAK2vC,SAAS5D,SAChCA,EAAM3zD,OAAM,CAAA2zC,EAAA50C,KAAA,eAAA40C,EAAA50C,KAAA,EAAe40D,EAAM,GAAGvpD,OAAM,OAA5B6uD,EAAItlB,EAAAp1C,KAAA,cAAAo1C,EAAAj1C,OAAA,SAE1Bu6D,GAAI,wBAAAtlB,EAAAlyC,OAAA,GAAAiyC,EAAA,UACZ,kBAAAq/B,EAAA1tE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,qBAAAE,OAAAw4E,EAAA5tE,EAAAzL,IAAAA,MACA,SAAAohD,IAAA,OAAAphD,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,cAAAi8C,EAAAj8C,KAAA,EACQ2oB,KAAMqhD,YAAW,OACO,OAA9BrhD,KAAMgtD,yBAAwB15B,EAAAj8C,KAAA,EACxB2oB,KAAM2yB,SAAS59C,KAAKkO,KAAKgqE,QAAU,WAAU,wBAAA35B,EAAAv5C,OAAA,GAAAo5C,EAAA,UACpD,kBAAAi4B,EAAAztE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,OAAAu4E,EAAA3tE,EAAAzL,IAAAA,MAED,SAAA0hD,EAAwB3gC,EAAiBm9C,GAAY,IAAApvB,EAAA3gB,EAAAlM,EAAAmG,EAAA+yD,EAAAd,EAAA,OAAAr6E,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,OACxB,OAA3BtC,KAAKo3E,aAAajM,UAASxsB,EAAAr8C,KAAA,EACR2oB,KAAMqhD,YAAW,OAA1B,GAAJxgC,EAAI6S,EAAA78C,KACC,CAAF68C,EAAAr8C,KAAA,eAAAq8C,EAAA18C,OAAA,iBAI8C,OAHjDkpB,EAAOnrB,KAAKmrB,KACZlM,EAAQ6sB,EAAKzK,OAAOtjB,GACpBqH,EAASnG,EAAMmG,OACf+yD,EAAUn4E,KAAKi7D,GAAGK,WAAWr8C,EAAMN,QAAQ0D,OAAMs8B,EAAAr8C,KAAA,GAE1BtC,KAAKu3E,kBAAkBx5D,EAASoN,EAAK4rD,eAAc,QAEhB,GAF1DM,EAAc14B,EAAA78C,KACpB9B,KAAK03E,eAAeC,UAAU55D,EAASs5D,EAAgBnc,GACvDl7D,KAAKi3E,oBAAoBO,SAASz5D,EAASm9C,EAAMmc,KAC7CjyD,EAAOI,QAAUJ,EAAOozB,QAAQxI,WAAa,EAAImoC,EAAUd,GAAc,CAAA14B,EAAAr8C,KAAA,gBAAAq8C,EAAAr8C,KAAA,GACrEtC,KAAKy3E,mBAAmBtsD,EAAK4rD,eAAc,eAAAp4B,EAAA18C,OAAA,yBAAA08C,EAAAr8C,KAAA,GAI7CwyE,GAAU3pD,EAAK4rD,cAAe5rD,EAAKysD,YAAW,yBAAAj5B,EAAA35C,OAAA,GAAA05C,EAAA,UACrD,SAAAK,EAAAC,GAAA,OAAAo3B,EAAAxtE,MAAA,KAAAD,UAAA,MAAAutE,CAAA,CAhLkC,CAAStrD,ICnB9C,IAGqBwtD,GAAS,SAAAjC,GAAA/rE,EAAAguE,EAAAjC,GAAA,IA6B5BkC,MA7B4B3wD,KAAA0wD,iZAK5B,SAAAA,EAAa9qE,GAAmB,IAAA6L,EAAAtQ,EAAA,KAAAuvE,GACvBtuE,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,oBAAAmK,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,2BACP,IAAMgS,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAc/vC,GAC3C6L,EAAKm/D,UAAY,IAAIrL,GAAU9hD,EAAKmtD,WAAW,WAAQn/D,EAAK40D,UAAW,IAEvE,IAAMwK,EAA0B,WAC9B1jE,GAAI2E,KAAK2R,EAAKqtD,gBACdr/D,EAAKm/D,UAAUnN,UACft2D,GAAIyE,KAAK6R,EAAKmtD,WACdn/D,EAAKm/D,UAAUvpD,OACjB,EAWE,OAVFwpD,IAEAp/D,EAAKs/D,iBAAmB,IAAI/H,GAAiBvlD,EAAKqtD,gBAAgB,WAAQD,GAA0B,IACpG1jE,GAAI1K,KAAKghB,EAAKutD,cAAe,SAAS,WACpCv/D,EAAKs/D,iBAAiBtN,UACtB2J,GAAU3pD,EAAKmtD,UAAWntD,EAAKqtD,eACjC,IACA3jE,GAAI1K,KAAKghB,EAAK2rD,oBAAqB,SAAS,WAAQyB,GAA0B,IAC9E1jE,GAAI1K,KAAKghB,EAAK8xB,MAAO,aAAa,SAACrxC,IAC5BiJ,GAAIk6C,eAAenjD,EAAGuf,EAAKqtD,iBAAmB3jE,GAAI82D,YAAYxgD,EAAKqtD,iBAAmBD,GAC7F,IAAEp/D,CACJ,CAKC,OAHDxP,EAAAyuE,EAAA,EAAAz6E,IAAA,WAAAE,OAAAw6E,EAAA5vE,EAAAzL,IAAAA,MACA,SAAA8P,IAAA,OAAA9P,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,cAAA4K,EAAA5K,KAAA,EACQ2oB,KAAM2yB,SAAS,WAAU,wBAAA1wC,EAAAlI,OAAA,GAAA8H,EAAA,KAChC,kBAAAurE,EAAAzvE,MAAA,KAAAD,UAAA,MAAAyvE,CAAA,CAhC2B,CAASxtD,ivCCoDvC,IAWM+tD,GAAkB,GAAK,GAchBC,GAA8B,CbsDH,wBACA,wBACC,yBACJ,qBACC,sBACC,uBACC,wBACA,wBACA,yBa/BlCC,GAA6B,CAjBN,EAED,EACA,EAGI,EAMA,GACM,IAahCC,GAA6B,CA3BT,EAEA,EAIM,EAMI,GAGJ,IAoB1BC,GAA0B,CA9BL,EAGO,EACA,GAEO,IA+BzC,SAASC,GAAoBC,GAC3B,OAAIJ,GAAgBzwB,SAAS6wB,GAAgB,CAAC,IAAK,eAC/CH,GAAgB1wB,SAAS6wB,GAAgB,CAAC,IAAK,eAC5C,CAAC,GAAI,GACd,CAEA,IAAMC,GAAwB,CbiBI,kBACH,eACG,kBACH,eACE,iBACA,iBACD,gBACM,sBACA,sBACE,wBACD,uBACC,wBACQ,gCACN,0BACJ,sBACM,4BACL,uBACT,eabvB,SAASC,GAAcF,GAC5B,OAAO18D,GAAU28D,GAAsBD,GACzC,CAEA,UAAMG,GAAiB,GA2CnBvtC,GAAM,EAEWwtC,GAAW,SAAAlD,GAAA/rE,EAAAivE,GAAAlD,GAAA,IA0pE9BmD,EAvBCC,EAdDC,EApBAC,EAVAC,EAZCC,EATDC,EApCAC,EA9BAC,EAtBAC,EAvBAC,EAtEAC,EANAC,EAjHAC,EAfAC,EAnCCC,EA5BAC,EA7CAC,EA5BAC,EAvQAC,EA9IAC,EAxBAC,EApGAC,EAJAC,EALAC,EAvCAC,EAzDAC,EAvCAC,EA/CAC,EAhFAC,EARAC,EAvGAC,EA1EDC,EAZCC,EAZDC,EAdAC,EA/BAC,GA3BAC,GAjBAC,GATAC,GA/EAC,GAzCAC,GArCAC,GA1BAC,GA9CAC,GAPAC,GAxFAC,GAVCC,SA9N6B30D,OAAA2xD,qZA8B9B,SAAAA,GAAa/rE,EAAmBY,GAAwB,IAAAiL,EAAAtQ,EAAA,KAAAwwE,IAC/CvvE,EAAAC,EAAPoP,EAAAuO,GAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,kBAAArP,EAAAC,EAAAoP,GAAA,kCAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,iBAAArP,EAAAC,EAAAoP,GAAA,iBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,uBACPA,EAAK7L,KAAOA,EACZ6L,EAAKjL,KAAOA,EACZ,IAAMid,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAc/vC,GAC3C6L,EAAKmjE,SAAW,GAChBzwC,GAAM5gB,KAAM6gB,KAAKD,IASjB1yB,EAAKojE,aAAerwE,OAAOo2C,aAAY,YAPtB,WAAM,IACWn3C,EADXC,EAAAC,GACF8N,EAAKmjE,UAAQ,IAAhC,IAAAlxE,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAkC,KAAvB2c,EAAIlT,EAAAtN,MACTwgB,EAAKE,QAAQ0nC,QACf5nC,EAAKgB,YAAcxK,GAAI2nE,UAA+C,IAArC3pE,SAASwL,EAAKE,QAAQ0nC,OAAS,KAEpE,CAAC,OAAAvnD,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACH,CAEE4wE,EACF,GAAG,KAEH5nE,GAAIuyB,eAAejc,EAAKuxD,gBAAiBvxD,EAAKwxD,kBAAmBxxD,EAAKyxD,qBAAsBzxD,EAAK0xD,gBACjG1jE,EAAKujE,gBAAkBvxD,EAAKuxD,gBAAgBjxD,WAAU,GACtD5W,GAAIyE,KAAK6R,EAAKwxD,kBAAmBxxD,EAAKyxD,qBAAsBzxD,EAAK0xD,gBAEjE1jE,EAAK8jC,MAAQpoC,GAAImG,cAAcmQ,EAAK8xB,MAAO,iBAC3C9xB,EAAK8xB,MAAMxiC,iBAAiB,gBAAgBla,SAAQ,SAAAyU,GAClDH,GAAI1K,KAAK6K,EAAI,SAAS,WAAQmE,EAAK2jE,aAAc,GACnD,IACAjoE,GAAI1K,KAAKghB,EAAK4xD,YAAa,SAAS,WAAQ5jE,EAAK2jE,aAAc,IAE/D3jE,EAAK8nD,iBAAmB,EACxBpsD,GAAIuyB,eACFjc,EAAK6xD,eAAgB7xD,EAAK8xD,iBAAkB9xD,EAAK+xD,gBAAiB/xD,EAAKgyD,WACvEhyD,EAAKiyD,qBAAsBjyD,EAAKkyD,iBAAkBlyD,EAAKmyD,iBAAkBnyD,EAAKoyD,WAC9EpyD,EAAKqyD,SAAUryD,EAAKsyD,iBAAkBtyD,EAAKuyD,sBAG7C7oE,GAAI1K,KAAKghB,EAAK0mC,aAAc,SAAS,kBAAM14C,EAAKwkE,cAAcxkE,EAAK8nD,gBAAgB,IACnFpsD,GAAI1K,KAAKghB,EAAKyyD,YAAa,SAAS,kBAAMzkE,EAAK0kE,UAAU1kE,EAAK8nD,gBAAgB,IAC9EpsD,GAAI1K,KAAKghB,EAAK2yD,KAAM,SAAS,kBAAM3kE,EAAK4kE,aAAa5kE,EAAK8nD,gBAAgB,IAC1EpsD,GAAI1K,KAAKghB,EAAK6yD,QAAS,SAAS,kBAAM7kE,EAAK8kE,YAAY9kE,EAAK8nD,gBAAgB,IAC5EpsD,GAAI1K,KAAKghB,EAAK+yD,WAAY,SAAS,kBAAM/kE,EAAKglE,WAAWhlE,EAAK8nD,gBAAgB,IAC9EpsD,GAAI1K,KAAKghB,EAAKizD,SAAU,SAAS,kBAAMjlE,EAAKklE,KAAKllE,EAAK8nD,gBAAgB,IACtEpsD,GAAI1K,KAAKghB,EAAKmzD,gBAAiB,SAAS,kBAAMnlE,EAAKolE,aAAaplE,EAAK8nD,gBAAgB,IACrFpsD,GAAI1K,KAAKghB,EAAKqzD,kBAAmB,SAAS,kBAAMrlE,EAAKolE,aAAaplE,EAAK8nD,gBAAgB,IACvFpsD,GAAI1K,KAAKghB,EAAKszD,aAAc,SAAS,kBAAMtlE,EAAKslE,aAAatlE,EAAK8nD,gBAAgB,IAClFpsD,GAAI1K,KAAKghB,EAAKuzD,WAAY,SAAS,kBAAMvlE,EAAKwlE,gBAAgB,IAE9D9pE,GAAI1K,KAAKghB,EAAKyzD,YAAa,SAAS,WAAM,IAAAC,EAAEp1D,IAAwB,QAAXo1D,EAAA1lE,EAAK2lE,cAAM,IAAAD,OAAA,EAAXA,EAAa5pE,KAAM,GAAIkW,EAAK4zD,YAAa5zD,EAAKyzD,YAAa,UAAW,IAC/H/pE,GAAI1K,KAAKghB,EAAK6zD,iBAAkB,SAAS,WAAM,IAAAC,EAAEx1D,IAAwB,QAAXw1D,EAAA9lE,EAAK2lE,cAAM,IAAAG,OAAA,EAAXA,EAAaC,YAAa,GAAI/zD,EAAKg0D,mBAAoBh0D,EAAK6zD,iBAAkB,UAAW,IACvJnqE,GAAI1K,KAAKghB,EAAKi0D,cAAe,SAAS,WAAM,IAAAC,EAAAC,EAAE71D,IAAwB,QAAX41D,EAAAlmE,EAAK2lE,cAAM,IAAAO,GAAU,QAAVC,EAAXD,EAAaE,gBAAQ,IAAAD,OAAV,EAAXA,EAAuBE,SAAU,GAAIr0D,EAAKs0D,gBAAiBt0D,EAAKi0D,cAAe,UAAW,IACrJvqE,GAAI1K,KAAKghB,EAAKu0D,qBAAsB,SAAS,WAAM,IAAAC,EAAAC,EAAEn2D,IAAwB,QAAXk2D,EAAAxmE,EAAK2lE,cAAM,IAAAa,GAAU,QAAVC,EAAXD,EAAaJ,gBAAQ,IAAAK,OAAV,EAAXA,EAAuBC,YAAa,GAAI10D,EAAK20D,uBAAwB30D,EAAKu0D,qBAAsB,UAAW,IAC7K7qE,GAAI1K,KAAKghB,EAAK40D,mBAAoB,UAAU,WAAQ5mE,EAAK6mE,cAAc7mE,EAAK8nD,gBAAiB,IAG7F9nD,EAAK49D,cAAgB,IAAI1nB,GAAclkC,EAAK4rD,eAAe,SAACh5D,GAC1D,IAAMkiE,EAAY,CAAE7sB,UAAWnoC,KAAMoW,OAAOtjB,GAASha,MACrDoV,EAAK+mE,aAAaniE,EAASoN,EAAK4rD,cAAex6D,GblPhB,qBakPsD0jE,IACrF9mE,EAAKgnE,mBACLhnE,EAAKinE,kBAAkBriE,GACvB5E,EAAKknE,cAActiE,EACrB,IAGA5E,EAAKmnE,aAAe,IAAI3wB,GAAiBxkC,EAAKo1D,gBAAgB,GAE9DpnE,EAAK02C,eAAiBh7C,GAAIi7C,YAAY3kC,EAAKm1D,aAAc,kBAGzDE,GAASr1D,EAAKs1D,SAAUt1D,EAAKu1D,eAAcj4E,EAAAzL,IAAAA,MAAE,SAAA8P,IAAA,OAAA9P,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAAc6W,EAAKwnE,WAAU,wBAAAzzE,EAAAlI,OAAA,GAAA8H,EAAA,MAE1E0zE,GAASr1D,EAAKy1D,UAAWz1D,EAAK01D,MAAKp4E,EAAAzL,IAAAA,MAAE,SAAAiR,IAAA,OAAAjR,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAAc6W,EAAK2kE,OAAM,wBAAA3vE,EAAAnJ,OAAA,GAAAiJ,EAAA,MAE9DuyE,GAASr1D,EAAKm1D,aAAcn1D,EAAK21D,gBAAgB,kBAAM3nE,EAAK4nE,UAAU,IAEtE51D,EAAK8xB,MAAMxiC,iBAAiB,gBAAgBla,SAAQ,SAAAyU,GAClDH,GAAI1K,KAAK6K,EAAI,SAAS,kBAAMmE,EAAK2jE,aAAa,GAChD,IAEAjoE,GAAI1K,KAAKghB,EAAK8xB,MAAO,aAAa,SAACrxC,GAC5BiJ,GAAIk6C,eAAenjD,EAAGuN,EAAKynC,cAAgBznC,EAAK2jE,aACvD,IAEA3jE,EAAK6nE,YAAc,IAAIn7D,GAAUsF,EAAK81D,YAAa91D,EAAK+1D,WAAW,GAAO,SAAC76D,GAAwB,OAAOlN,EAAKgoE,iBAAiB96D,EAAU,IAE1IlN,EAAK61C,MAAQ,SAACpjD,GACE,WAAVA,EAAEjO,KACAkX,GAAI82D,YAAYxyD,EAAKgS,KAAK8xB,QAAQ9jC,EAAK2jE,aAE/C,EACAjoE,GAAI1K,KAAKc,SAAU,QAASkO,EAAK61C,OAEjCn6C,GAAI1K,KAAKghB,EAAKi2D,aAAc,QAAO34E,EAAAzL,IAAAA,MAAE,SAAAuR,IAAA,OAAAvR,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OAAc6W,EAAKioE,eAAc,wBAAA5yE,EAAAxJ,OAAA,GAAAuJ,EAAA,MACtEsG,GAAI1K,KAAKghB,EAAKk2D,aAAc,QAAO54E,EAAAzL,IAAAA,MAAE,SAAA2mB,IAAA,OAAA3mB,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAAc6W,EAAKmoE,0BAAyB,wBAAA19D,EAAA5e,OAAA,GAAA2e,EAAA,MACjF9O,GAAI1K,KAAKghB,EAAKo2D,cAAe,QAAO94E,EAAAzL,IAAAA,MAAE,SAAA6mB,IAAA,OAAA7mB,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAAc6W,EAAKqoE,oBAAmB,wBAAA19D,EAAA9e,OAAA,GAAA6e,EAAA,MAC5E28D,GAASr1D,EAAKs2D,iBAAkBt2D,EAAKu2D,uBAAsBj5E,EAAAzL,IAAAA,MAAE,SAAAopB,IAAA,OAAAppB,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OAAc6W,EAAKuoE,yBAAwB,wBAAAp7D,EAAAthB,OAAA,GAAAohB,EAAA,MACxGo6D,GAASr1D,EAAKw2D,qBAAsBx2D,EAAKy2D,qBAAqB,WAAQzoE,EAAKooE,eAAgB,IAC3Ff,GAASr1D,EAAK02D,aAAc12D,EAAK22D,mBAAkBr5E,EAAAzL,IAAAA,MAAE,SAAA+sB,IAAA,OAAA/sB,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,OAAc6W,EAAK2oE,qBAAoB,wBAAAz3D,EAAArlB,OAAA,GAAA+kB,EAAA,MAC5FlV,GAAI1K,KAAKghB,EAAK42D,cAAe,QAAOt5E,EAAAzL,IAAAA,MAAE,SAAAmxC,IAAA,OAAAnxC,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OAAc6W,EAAK6oE,wBAAuB,GAAK,wBAAA3zC,EAAArpC,OAAA,GAAAmpC,EAAA,MACrFt5B,GAAI1K,KAAKghB,EAAK82D,aAAc,QAAOx5E,EAAAzL,IAAAA,MAAE,SAAAi6C,IAAA,OAAAj6C,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,OAAc6W,EAAK6oE,wBAAuB,GAAM,wBAAA9qC,EAAAlyC,OAAA,GAAAiyC,EAAA,MACrFupC,GAASr1D,EAAK+2D,0BAA2B/2D,EAAKg3D,yBAAwB15E,EAAAzL,IAAAA,MAAE,SAAAohD,IAAA,OAAAphD,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,OAAc6W,EAAKipE,qBAAoB,wBAAA7jC,EAAAv5C,OAAA,GAAAo5C,EAAA,MAC/GvpC,GAAI1K,KAAKghB,EAAKk3D,YAAa,QAAO55E,EAAAzL,IAAAA,MAAE,SAAA0hD,IAAA,OAAA1hD,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,OAAc6W,EAAKmpE,sBAAqB,wBAAA3jC,EAAA35C,OAAA,GAAA05C,EAAA,MAC5E7pC,GAAI1K,KAAKghB,EAAKo3D,cAAe,QAAO95E,EAAAzL,IAAAA,MAAE,SAAAkiD,IAAA,OAAAliD,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,OAAc6W,EAAKqpE,gBAAe,wBAAA7iC,EAAA36C,OAAA,GAAAk6C,EAAA,MACxErqC,GAAI1K,KAAKghB,EAAKs3D,wBAAyB,QAAOh6E,EAAAzL,IAAAA,MAAE,SAAAkmE,IAAA,OAAAlmE,IAAAA,MAAA,SAAAo/D,GAAA,cAAAA,EAAAv3D,KAAAu3D,EAAA95D,MAAA,OAAc6W,EAAKupE,uCAAsC,wBAAAtmB,EAAAp3D,OAAA,GAAAk+D,EAAA,MACzGruD,GAAI1K,KAAKghB,EAAKw3D,qBAAsB,QAAOl6E,EAAAzL,IAAAA,MAAE,SAAA0mE,IAAA,OAAA1mE,IAAAA,MAAA,SAAAomE,GAAA,cAAAA,EAAAv+D,KAAAu+D,EAAA9gE,MAAA,OAAc6W,EAAKypE,gCAA+B,wBAAAxf,EAAAp+D,OAAA,GAAA0+D,EAAA,MAC/F7uD,GAAI1K,KAAKghB,EAAK03D,SAAU,SAAS,WAAQ1pE,EAAK2pE,eAAgB,IAC9DjuE,GAAI1K,KAAKghB,EAAK43D,WAAY,SAAS,WAAQ5pE,EAAK2pE,eAAgB,IAChEtC,GAASr1D,EAAK63D,UAAW73D,EAAK83D,gBAAex6E,EAAAzL,IAAAA,MAAE,SAAA+qE,IAAA,OAAA/qE,IAAAA,MAAA,SAAA4mE,GAAA,cAAAA,EAAA/+D,KAAA++D,EAAAthE,MAAA,OAAc6W,EAAK+pE,eAAc,wBAAAtf,EAAA5+D,OAAA,GAAA+iE,EAAA,MAChFlzD,GAAI1K,KAAKghB,EAAKg4D,oBAAqB,SAAS,WAAQhqE,EAAKiqE,2BAA4B,IACrF5C,GAASr1D,EAAKk4D,oBAAqBl4D,EAAKm4D,iBAAiB,WAAQnqE,EAAKoqE,iBAAkB,IACxF1uE,GAAI1K,KAAKghB,EAAKq4D,eAAgB,UAAU,WAAQrqE,EAAKsqE,uBAAwB,IAC7E5uE,GAAI1K,KAAKghB,EAAKu4D,cAAe,SAAS,WAAQvqE,EAAKwqE,mBAAoB,IACvE9uE,GAAI1K,KAAKghB,EAAKy4D,sBAAuB,SAAS,WAAQzqE,EAAK0qE,gBAAiB,IAC5EhvE,GAAI1K,KAAKghB,EAAK24D,sBAAuB,SAAS,WAAQ3qE,EAAK4qE,gBAAiB,IAC5ElvE,GAAI1K,KAAKghB,EAAK64D,SAAU,SAAS,WAAQ7qE,EAAK8qE,oBAAqB,IACnEpvE,GAAI1K,KAAKghB,EAAK+4D,yBAA0B,SAAS,WAAQrvE,GAAI2E,KAAK2R,EAAKg5D,sBAAuB,IAC9FtvE,GAAI1K,KAAKghB,EAAKi5D,gBAAiB,SAAS,WAAQjrE,EAAKkrE,SAASl5D,EAAKm5D,WAAY,IAG/EnrE,EAAKorE,gBAAkB,IAAIrW,GAAe/iD,EAAKq5D,SAI/C3vE,GAAI1K,KAAKghB,EAAKs5D,UAAW,SAAS,WAAQtrE,EAAKurE,iBAAkB,IAGjE7vE,GAAI1K,KAAKghB,EAAKw5D,QAAS,SAAS,WAC9B,IAAkBloE,EAAOwO,KAAMoW,OAAOloB,EAAK8nD,iBAAnCvsD,SACFomC,EAAMvzB,GAAkB4D,EAAKw5D,QAAQ9mF,OACrC+W,EAAmB6H,EAAG9H,aAAaC,iBACzCC,GAAI+vE,cAAcz5D,EAAK05D,UAAW/pC,EAAMlmC,EAAkBqW,KAAMymB,aAAav4B,EAAK8nD,iBAAkBxkD,EACtG,IAGA5H,GAAI1K,KAAKghB,EAAK25D,QAAS,SAAS,WAAQ3rE,EAAKurE,iBAAkB,IAG/D7vE,GAAI1K,KAAKghB,EAAK45D,SAAU,QAAOt8E,EAAAzL,IAAAA,MAAE,SAAA0rE,IAAA,IAAAzpD,EAAAlS,EAAA,OAAA/P,IAAAA,MAAA,SAAAgrE,GAAA,cAAAA,EAAAnjE,KAAAmjE,EAAA1lE,MAAA,OAGO,GAFhC2c,EAAQgM,KAAMoW,OAAOloB,EAAK8nD,iBAChC91C,EAAK45D,SAASpsE,UAAUM,OAAO,gBAAiB,kBAC1ClM,EAAOoe,EAAK45D,SAASlnF,OAAS,GAC/BohB,GAAkB,KAATlS,EAAW,CAAAi7D,EAAA1lE,KAAA,eAAA0lE,EAAA/lE,OAAA,wBAAA+lE,EAAA1lE,KAAA,EACL6W,EAAK6rE,oBAAoBj4E,EAAMkS,EAAMhK,IAAG,OAAjD+yD,EAAAlmE,KACAqpB,EAAK45D,SAASpsE,UAAUC,IAAI,kBAClCuS,EAAK45D,SAASpsE,UAAUC,IAAI,iBAAgB,wBAAAovD,EAAAhjE,OAAA,GAAA0jE,EAAA,MAInD7zD,GAAI1K,KAAKghB,EAAK85D,aAAc,SAAS,WACnC9rE,EAAK+rE,gBAAkB/rE,EAAK+rE,eAC5B/rE,EAAKgsE,gBAAgBhsE,EAAK+rE,eAC5B,IAGArwE,GAAI1K,KAAKghB,EAAKi6D,uBAAwB,UAAU,WAC9CjsE,EAAKksE,kBACP,IACAxwE,GAAI1K,KAAKghB,EAAKm6D,eAAgB,SAAS,WACjCzwE,GAAI0wE,SAASp6D,EAAKk6D,mBACpBxwE,GAAIyE,KAAK6R,EAAKk6D,iBAAkBl6D,EAAKq6D,oBACrC3wE,GAAI2E,KAAK2R,EAAKs6D,oBACdt6D,EAAKu6D,cAAcrmE,YAAc9C,GbhWN,qBaiWtBpD,EAAKolE,aAAaplE,EAAK8nD,gBAAiB,CAAE0kB,eAAe,GAClE,IAEA16D,KAAMilC,mBAAmB,CACvB01B,eAAgB,SAACx1B,GAAqBj3C,EAAK0sE,gBAAgBz1B,EAAM,EACjE5X,QAAS,SAAC4X,GAAwBj3C,EAAK2sE,kBAAkB11B,EAAM,EAC/DD,YAAa,SAACC,GAA4Bj3C,EAAK4sE,sBAAsB31B,EAAM,EAC3E41B,aAAc,SAAC51B,GAA4Bj3C,EAAK4sE,sBAAsB31B,EAAM,EAC5EE,WAAY,SAACF,GAA2Bj3C,EAAK8sE,mBAAmB71B,EAAKryC,QAAS,EAC9EyyC,aAAc,SAACJ,GAA+Bj3C,EAAK+sE,uBAAuB91B,EAAM,EAChF+1B,WAAY,SAAC/1B,GAAuBj3C,EAAKitE,uBAAuBh2B,EAAM,IAGxE,IACIi2B,EADeltE,EAAKgnE,mBACOlrE,GACzBgtD,EAAax3D,EAAMuB,WAAWvB,EAAM67E,iBASlC,OARJrkB,IAAYokB,EAAgBlrE,OAAO8mD,IACvC9oD,EAAKotE,iBAAiBF,GAEtB/jC,aAAY,WAAM,IACuCjtC,EADvCC,EAAAjK,GACE8N,EAAKgS,KAAKq7D,mBAAmB9rE,UAAQ,IAAvD,IAAApF,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAyD,KAA9C4lD,EAAGjyC,EAAAxX,MACN4oF,EAAM5xE,GAAIi7C,YAAYxI,EAAoB,OAChDm/B,EAAIpnE,YAAcxK,GAAI2nE,UAAU3pE,SAAS4zE,EAAIloE,QAAQmoE,WACvD,CAAC,OAAAhoF,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACH,GAAG,KAAKsN,CACV,CAyiEC,OAziEAxP,EAAA0vE,GAAA,EAAA17E,IAAA,cAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAKmrB,KAAK8xB,OACnBj9C,KAAK8+E,YAASr9E,EACVzB,KAAK2mF,WAAW3mF,KAAK2mF,UAAU3hF,MACrC,GAAC,CAAArH,IAAA,WAAAE,OAAAw+E,GAAA5zE,EAAAzL,IAAAA,MAED,SAAA6rE,EAAgB+d,EAAcl+E,GAAS,IAAAqV,EAAA3U,EAAA,OAAApM,IAAAA,MAAA,SAAA2rE,GAAA,cAAAA,EAAA9jE,KAAA8jE,EAAArmE,MAAA,OACD,OAA9Byb,EAAU/d,KAAKihE,gBAAe0H,EAAArmE,KAAA,EAClBuL,EAAS+4E,EAAMl+E,GAAK,OAA7B,GAAHU,EAAGu/D,EAAA7mE,KACLic,IAAY/d,KAAKihE,gBAAe,CAAA0H,EAAArmE,KAAA,cAAQd,MAAM,0CAAyC,cAAAmnE,EAAA1mE,OAAA,SACpFmH,GAAG,wBAAAu/D,EAAA3jE,OAAA,GAAA6jE,EAAA,UACX,SAAA7gE,EAAA2E,GAAA,OAAA0vE,GAAAzzE,MAAA,KAAAD,UAAA,IAGD,CAAAhL,IAAA,WAAAE,OAAAu+E,GAAA3zE,EAAAzL,IAAAA,MACA,SAAA4sE,IAAA,IAAAz+C,EAAApN,EAAAiuB,EAAA66C,EAAAjyE,EAAA/W,EAAAkP,EAAAq0D,EAAAh8C,EAAA3I,EAAAkC,EAAAmoE,EAAAlhE,EAAA04B,EAAAl1C,EAAA29E,EAAAC,EAAAjoB,EAAAkoB,EAAA5iB,EAAA6iB,EAAAC,EAAA,OAAAnqF,IAAAA,MAAA,SAAAisE,GAAA,cAAAA,EAAApkE,KAAAokE,EAAA3mE,MAAA,OAQwC,GAPhC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKi8D,SAAUj8D,EAAKk8D,QAASl8D,EAAKm8D,eAAgBn8D,EAAKo8D,mBAC1DxpE,EAAUlL,SAASsY,EAAKs1D,SAASliE,QAAQR,SAAW,IACpDiuB,EAAQ/gB,KAAMoW,OAAOtjB,GAASiuB,MAC9B66C,EAAW17D,EAAKq8D,iBAAiB7uB,UAAW,EAC5C/jD,EAAmBqW,KAAMvW,SAASqJ,GAASpJ,aAAaC,iBACxD/W,EAAQoV,KAAKC,MAAMqU,GAAkB4D,EAAKw5D,QAAQ9mF,MAAO,GAAK+W,GAEvD,MADP7H,EAAOoe,EAAK45D,SAASlnF,OAAS,IACrB,CAAAorE,EAAA3mE,KAAA,gBAAA2mE,EAAAhnE,OAAA,SAAS4S,GAAI+4D,cAAcziD,EAAKk8D,QAAS9qE,GAAUA,EAA6B,CAAE+nD,QAASv3D,MAAQ,QAKrG,GALqGq0D,EACzEn2C,KAAMoW,OAAOtjB,GAA9CqH,EAAMg8C,EAANh8C,OAAkB3I,EAAE2kD,EAAZ1sD,SAAciK,EAAMyiD,EAANziD,OAI1BmoE,EAAQ,IA7YY,IA8YnB1hE,EAAO+vB,QAAmC,CAAA8zB,EAAA3mE,KAAA,SAQF,OAPrCsjB,EAAO,CACX7Y,KAAMoe,EAAK45D,SAASlnF,MACpBkgB,QAASA,EACT8oE,SAAUA,EACVhpF,MAAOA,GAGHygD,EAASrzB,KAAMuzB,QAAQrzB,EAAKs1D,UAASxX,EAAA3mE,KAAA,GACzBuL,EAAS,aAAc+X,GAAK,QACtC,GADFxc,EAAG6/D,EAAAnnE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF6/D,EAAA3mE,KAAA,SAI3B,OAHA6oB,EAAKo8D,kBAAkBhpE,QAAQ4G,QAAU5I,GbjZjB,gBaiZkD,CAAE7d,IAAK0K,EAAIwE,MACrFiH,GAAIyE,KAAK6R,EAAKo8D,mBAEdte,EAAA3mE,KAAA,GACoBtC,KAAKglF,oBAAoBj4E,EAAMgR,GAAQ,QAAhD,GAAAkrD,EAAAnnE,KACC,CAAFmnE,EAAA3mE,KAAA,gBAAA2mE,EAAAhnE,OAAA,SAAS4S,GAAI+4D,cAAcziD,EAAKk8D,QAAS9qE,GAAUA,EAA6B,CAAE+nD,QAASv3D,GAAQ,OAAM,QAAAk8D,EAAA3mE,KAAA,qBAC1G8G,EAAIq+E,GAAI,CAAFxe,EAAA3mE,KAAA,YACV8G,EAAIs+E,aAAc,CAAFze,EAAA3mE,KAAA,gBAAA2mE,EAAAhnE,OAAA,SAAS4S,GAAI+4D,cAAcziD,EAAKk8D,QAAS9qE,GAAUA,EAA6B,CAAE+nD,QAASn5C,EAAK45D,SAASlnF,OAAS,OAAM,QAC7IipF,EAAQ19E,EAAI09E,MACZjyE,GAAIyE,KAAK6R,EAAKm8D,gBAAe,QAAAre,EAAA3mE,KAAA,wBAAA2mE,EAAA3mE,KAAA,GAIXtC,KAAKglF,oBAAoBj4E,EAAMgR,GAAQ,QAAhD,GAAAkrD,EAAAnnE,KACC,CAAFmnE,EAAA3mE,KAAA,gBAAA2mE,EAAAhnE,OAAA,SAAS4S,GAAI+4D,cAAcziD,EAAKk8D,QAAS9qE,GAAUA,EAA6B,CAAE+nD,QAASv3D,GAAQ,OAAM,QA0C9F,OAvCvBoe,EAAKw8D,YAAYtoE,YAAcV,EAAOW,cACtC6L,EAAKy8D,UAAUnoE,IAAM5K,GAAImK,SAASL,GAE9BqtB,GAAO+6C,EACsC97D,KAAMoW,OAAO2K,EAAMC,UAAhD+6C,EAAKD,EAAfryE,SAAyBqqD,EAASgoB,EAAjBpoE,OACzBwM,EAAK08D,SAASxoE,YAAcxK,GAAIizE,oBAAoBhB,EAAOE,GAAS,IAAMjoB,GAE1E5zC,EAAK08D,SAASxoE,YAAcxK,GAAIizE,oBAAoBhB,EAAOrqE,GAEvDwqE,EAASh8D,KAAMymB,aAAa3zB,GAClClJ,GAAI+vE,cAAcz5D,EAAK48D,aAAcjB,EAAOG,EAAQxqE,GACpD0O,EAAK68D,oBAAoB3oE,YAAcxK,GAAIizE,oBAAoBjqF,EAAQipF,EAAOrqE,GAC9E0O,EAAK88D,WAAW5oE,YAAcxK,GAAIizE,oBAAoBjqF,EAAO4e,GAC7D5H,GAAI+vE,cAAcz5D,EAAK+8D,eAAgBrqF,EAAOopF,EAAQxqE,GACtD0O,EAAKg9D,UAAU9oE,YAAc8L,EAAK45D,SAASlnF,OAAS,GAC9CwmE,EAAMj/C,EAAOozB,QAAQxI,UAAYnyC,EACvCstB,EAAKi9D,iBAAiB/oE,YAAcxK,GAAIizE,oBAAoBzjB,EAAK5nD,GACjE5H,GAAI+vE,cAAcz5D,EAAKk9D,qBAAsBhkB,EAAK4iB,EAAQxqE,GAC1D5H,GAAIyE,KAAK6R,EAAKm9D,YAETzB,IACHhyE,GAAI2E,KAAK2R,EAAKm9D,YACdn9D,EAAK68D,oBAAoB3oE,YAAcxK,GAAIizE,oBAAoBjqF,EAAO4e,GAClEyqE,EAAYrpF,EACXmuC,IAAOk7C,GAAaJ,GACzB37D,EAAK88D,WAAW5oE,YAAcxK,GAAIizE,oBAAoBZ,EAAWzqE,GACjE5H,GAAI+vE,cAAcz5D,EAAK+8D,eAAgBhB,EAAWD,EAAQxqE,GACtD4nD,EAAMj/C,EAAOozB,QAAQxI,UAAYnyC,EAChCmuC,IAAOq4B,GAAOyiB,GAGfziB,GAAO,GACTl5C,EAAKi9D,iBAAiB/oE,YAAcxK,GAAIizE,oBAAoB,EAAGrrE,GAC/D5H,GAAI+vE,cAAcz5D,EAAKk9D,qBAAsB,EAAGpB,EAAQxqE,KAExD0O,EAAKi9D,iBAAiB/oE,YAAcxK,GAAIizE,oBAAoBzjB,EAAK5nD,GACjE5H,GAAI+vE,cAAcz5D,EAAKk9D,qBAAsBhkB,EAAK4iB,EAAQxqE,KAG9D5H,GAAI2E,KAAK2R,EAAKs1D,UAASxX,EAAA3mE,KAAA,GACjBtC,KAAKqkF,SAASl5D,EAAKy1D,WAAU,yBAAA3X,EAAAjkE,OAAA,GAAA4kE,EAAA,UACpC,kBAAAwS,GAAAxzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,OAAAs+E,GAAA1zE,EAAAzL,IAAAA,MACA,SAAA6uE,IAAA,IAAA1gD,EAAA,OAAAnuB,IAAAA,MAAA,SAAA6sE,GAAA,cAAAA,EAAAhlE,KAAAglE,EAAAvnE,MAAA,OAEwC,OADhC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKy1D,UAAWz1D,EAAKk8D,SAAQxd,EAAAvnE,KAAA,EAChCtC,KAAKqkF,SAASl5D,EAAKs1D,UAAS,wBAAA5W,EAAA7kE,OAAA,GAAA6mE,EAAA,UACnC,kBAAAsQ,GAAAvzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,sBAAAE,OAAAq+E,GAAAzzE,EAAAzL,IAAAA,MAGA,SAAA+uE,EAA2Bh/D,EAAcgR,GAAe,IAAAwqE,EAAA,OAAAvrF,IAAAA,MAAA,SAAA8uE,GAAA,cAAAA,EAAAjnE,KAAAinE,EAAAxpE,MAAA,cAAAwpE,EAAAxpE,KAAA,EACnCuL,EAAS,uBAAwB,CAAEd,KAAMA,EAAMgR,QAASA,IAAU,OAA3E,OAAJwqE,EAAIzc,EAAAhqE,KAAAgqE,EAAA7pE,OAAA,SACHgpB,KAAM6mC,cAAcy2B,IAAK,wBAAAzc,EAAA9mE,OAAA,GAAA+mE,EAAA,KACjC,SAAAn/D,EAAAkB,GAAA,OAAAouE,GAAAtzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,kBAAAE,MAGA,SAAiBs1B,GACf,IAAMhI,EAAOnrB,KAAKmrB,KAClB,GAAIgI,EAIF,OAHAte,GAAI2E,KAAK2R,EAAKmrC,UACdzhD,GAAIyE,KAAK6R,EAAKorC,SAAUprC,EAAKq9D,eAC7Br9D,EAAKs9D,YAAYppE,YAAc9C,Gb7gBF,qBaghB/B1H,GAAI2E,KAAK2R,EAAKorC,SAAUprC,EAAKq9D,UAC7B3zE,GAAIyE,KAAK6R,EAAKmrC,UACdnrC,EAAKs9D,YAAYppE,YAAc9C,GbjhBD,kBakhBhC,GAEA,CAAA5e,IAAA,0BAAAE,MAIA,WACE,IAAMkgB,EAAU/d,KAAKihE,gBACfynB,EAAiB,CAAC,EAClBlhD,EAAYvc,KAAMuc,UAExB,IAAK,IAAMF,KAAQE,EAAW,CAC5B,IAAMmhD,EAAWnhD,EAAUF,GACrBshD,EAAgBD,EAAStnD,OAAOtjB,GACjC6qE,IACAF,EAAeE,EAAcrV,WAChCmV,EAAeE,EAAcrV,SAAW,IAE1CmV,EAAeE,EAAcrV,SAASvwE,KAAK2lF,EAASrhD,MACtD,CAEA,OAAOohD,CACT,GAEA,CAAA/qF,IAAA,gCAAAE,OAAAo+E,GAAAxzE,EAAAzL,IAAAA,MAIA,SAAA6vE,IAAA,IAAA1hD,EAAA/hB,EAAA2iC,EAAA,OAAA/uC,IAAAA,MAAA,SAAAivE,GAAA,cAAAA,EAAApnE,KAAAonE,EAAA3pE,MAAA,OAEoC,OAD5B6oB,EAAOnrB,KAAKmrB,KACgB8gD,EAAA3pE,KAAA,EAChBuL,EADL,sBACoB,CAC/BkQ,QAAS/d,KAAKihE,gBACdsS,QAASvzE,KAAK6oF,0BACd,OAHO,GAAHz/E,EAAG6iE,EAAAnqE,KAIJmpB,KAAM6mC,cAAc1oD,GAAM,CAAF6iE,EAAA3pE,KAAA,QAEK,OADhC6oB,EAAK29D,kBAAkBzpE,YAAcjW,EAAIwE,IACzCiH,GAAIyE,KAAK6R,EAAK29D,mBAAkB7c,EAAAhqE,OAAA,kBAI5B8pC,EAAgBrB,GAAc1qC,KAAKihE,mBACpBl1B,EAAcF,MACjC1gB,EAAK49D,mBAAmB58C,KAAOJ,EAAcF,IAAKziC,EAAIk/D,OAExDn9C,EAAK49D,mBAAmB1pE,YAAcjW,EAAIk/D,KAC1CzzD,GAAI2E,KAAK2R,EAAK69D,iCAAkC79D,EAAK29D,mBACrDj0E,GAAIyE,KAAK6R,EAAK89D,qBAAoB,yBAAAhd,EAAAjnE,OAAA,GAAA6nE,EAAA,UACnC,kBAAAoP,GAAArzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,kCAAAE,OAAAm+E,GAAAvzE,EAAAzL,IAAAA,MAIA,SAAA+vE,EAAuCwG,GAAe,IAAApoD,EAAAlM,EAAAwyC,EAAAroD,EAAA6pE,EAAA32D,EAAA,OAAAtf,IAAAA,MAAA,SAAA8vE,GAAA,cAAAA,EAAAjoE,KAAAioE,EAAAxqE,MAAA,OAKJ,GAJ1C6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK6oF,wBAA0BtV,EAC/B1+D,GAAIyE,KAAK6R,EAAK69D,kCACdn0E,GAAI2E,KAAK2R,EAAK89D,oBAAqB99D,EAAK29D,oBAClC7pE,EAAQgM,KAAMoW,OAAOrhC,KAAKihE,mBACjBhiD,EAAM+sB,MAAK,CAAA8gC,EAAAxqE,KAAA,eAAAwqE,EAAA7qE,OAAA,iBAC4B,GAAhDwvD,EAAcxmC,KAAMoW,OAAOpiB,EAAM+sB,MAAMC,UAC3B,CAAF6gC,EAAAxqE,KAAA,gBAAAwqE,EAAA7qE,OAAA,kBAKmB,OAJnC4S,GAAImD,MAAMmT,EAAK+9D,4BACf/9D,EAAK+9D,2BAA2B5wE,YAAYzD,GAAI2vD,UAAUvlD,GAAO,IACjEkM,EAAKg+D,4BAA4B9pE,YAAck0D,EAAQhsE,WAEpBulE,EAAAxqE,KAAA,GACjBuL,EADL,uBACoB,CAC/BkQ,QAAS/d,KAAKihE,gBACdsS,QAASA,EACTC,WAAW,IACX,QAJIpqE,EAAG0jE,EAAAhrE,KAKJmpB,KAAM6mC,cAAc1oD,IAInB6pE,EAAU,GAAHlnE,OAAM8I,GAAIkc,gBAAgB3nB,EAAIw8D,MAAOnU,EAAY/8C,UAAS,KAAA3I,OAAI0lD,EAAY/8C,SAASC,aAAamI,OACrGR,EAAO2O,KAAMymB,aAAa+f,EAAYx8C,OAE1Cg+D,GAAW,KAAJlnE,OAAS8I,GAAIyN,qBAAqBlZ,EAAIw8D,MAAOtpD,EAAMm1C,EAAY/8C,UAAS,UAEjFyW,EAAKi+D,sBAAsB/pE,YAAc4zD,IARzC9nD,EAAK29D,kBAAkBzpE,YAAcjW,EAAIwE,IACzCiH,GAAIyE,KAAK6R,EAAK29D,oBAShB9oF,KAAKqkF,SAASl5D,EAAKk+D,oBAAmB,yBAAAvc,EAAA9nE,OAAA,GAAA+nE,EAAA,UACvC,SAAAh/D,GAAA,OAAAiuE,GAAApzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,uCAAAE,OAAAk+E,GAAAtzE,EAAAzL,IAAAA,MAKA,SAAA0wE,IAAA,IAAAviD,EAAAlM,EAAAypE,EAAAY,EAAAr2B,EAAAzvD,EAAA0iB,EAAA,YAAAlpB,IAAAA,MAAA,SAAA2wE,GAAA,cAAAA,EAAA9oE,KAAA8oE,EAAArrE,MAAA,OAEkD,GAD1C6oB,EAAOnrB,KAAKmrB,MACZlM,EAAQgM,KAAMoW,OAAOrhC,KAAKihE,mBACjBhiD,EAAMmG,QAAWnG,EAAMmG,OAAOmkE,SAAQ,CAAA5b,EAAArrE,KAAA,eAAAqrE,EAAA1rE,OAAA,iBACrD,KAAOkpB,EAAKq+D,iBAAiB3xE,YAC3BsT,EAAKq+D,iBAAiB1xE,YAAYqT,EAAKq+D,iBAAiB3xE,YAE1DhD,GAAImD,MAAMmT,EAAKs+D,8BACft+D,EAAKs+D,6BAA6BnxE,YAAYzD,GAAI2vD,UAAUvlD,GAAO,IAC7DypE,EAAiB1oF,KAAK0pF,0BAExBJ,GAAY,EAAKr2B,EAAAj2D,IAAAA,MAAA,SAAAi2D,EAAAzvD,GAAA,IAAAmmF,EAAAriC,EAAAnnC,EAAAypE,EAAA,OAAA5sF,IAAAA,MAAA,SAAAgwE,GAAA,cAAAA,EAAAnoE,KAAAmoE,EAAA1qE,MAAA,OAE4B,QACxBb,KADjBkoF,EAAiB1qE,EAAMmG,OAAOmkE,SAAS/lF,KACTmmF,IAAmB7+D,GAAe++D,SAAQ,CAAA7c,EAAA1qE,KAAA,eAAA0qE,EAAA/qE,OAAA,4BAG9EqnF,GAAY,EACNhiC,EAAMn8B,EAAK2+D,gBAAgBr+D,WAAU,IACrCtL,EAAOtL,GAAI6W,cAAc47B,IAC1BisB,QAAQl0D,YAAc7b,EAAE+D,WACzBmhF,EAAellF,KACjB2c,EAAK4pE,OAAO1qE,YAAcqpE,EAAellF,GAAG2oD,KAAK,OAE7Cy9B,EAAa1jE,EAAKiF,KAAK0xD,eAAepxD,WAAU,GACtD5W,GAAI1K,KAAKy/E,EAAY,SAAS,WAC5B1jE,EAAK8jE,gCAAgCxmF,EACvC,IACA2c,EAAKlH,OAAOX,YAAYsxE,GACxBz+D,EAAKq+D,iBAAiBlxE,YAAYgvC,GAAI,yBAAA0lB,EAAAhoE,OAAA,GAAAiuD,EAAA,IAjB/BzvD,EAAI,EAAC,aAAEA,GAAKyb,EAAMmG,OAAOmuD,SAAO,CAAA5F,EAAArrE,KAAA,gBAAAqrE,EAAA9nE,cAAAotD,EAAAzvD,GAAA,iCAAAmqE,EAAAjgE,GAAA,CAAAigE,EAAArrE,KAAA,gBAAAqrE,EAAA1rE,OAAA,uBAAEuB,IAAGmqE,EAAArrE,KAAA,iBAmB9CuS,GAAIqf,OAAOo1D,EAAWn+D,EAAK8+D,mBAC3Bp1E,GAAIqf,QAAQo1D,EAAWn+D,EAAK++D,kBAC5BlqF,KAAKqkF,SAASl5D,EAAKg/D,yBAAwB,yBAAAxc,EAAA3oE,OAAA,GAAA0oE,EAAA,UAC5C,kBAAAqO,GAAAnzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,yBAAAE,OAAAi+E,GAAArzE,EAAAzL,IAAAA,MAIA,SAAAsxE,IAAA,IAAAnjD,EAAA/hB,EAAAghF,EAAAC,EAAAC,EAAAC,EAAAxjE,EAAA,YAAA/pB,IAAAA,MAAA,SAAAuxE,GAAA,cAAAA,EAAA1pE,KAAA0pE,EAAAjsE,MAAA,OAG4B,OAFpB6oB,EAAOnrB,KAAKmrB,KAElBtW,GAAI2E,KAAK2R,EAAKq/D,aAAYjc,EAAAjsE,KAAA,EAERuL,EAAS,sBAAuB,CAChDkQ,QAAS/d,KAAKihE,kBACd,OAFO,GAAH73D,EAAGmlE,EAAAzsE,KAGJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFmlE,EAAAjsE,KAAA,QAEE,OAD7B6oB,EAAKs/D,eAAeprE,YAAcjW,EAAIwE,IACtCiH,GAAIyE,KAAK6R,EAAKs/D,gBAAelc,EAAAtsE,OAAA,iBAI/B,KAAOkpB,EAAKu/D,eAAe7yE,YACzBsT,EAAKu/D,eAAe5yE,YAAYqT,EAAKu/D,eAAe7yE,aAGhDuyE,EAAuBhhF,EAAIghF,OAAS,IACpC3vD,MAAK,SAAC9zB,EAAeyT,GACzB,OAAOzT,EAAEgkF,OAASvwE,EAAEuwE,MACtB,IAEMN,EAAc9tE,Gb/nBE,WagoBhB+tE,EAAY/tE,Gb/nBE,SagoBdguE,EAAiBhuE,Gb/nBE,caioBzB6tE,EAAM7pF,SAAQ,SAACqqF,GACb,IAiBIC,EAjBEvjC,EAAMn8B,EAAK2/D,aAAar/D,WAAU,GAClCtL,EAAOtL,GAAI6W,cAAc47B,GAI/B,OAFAnnC,EAAKpT,KAAKsS,YAAcurE,EAAK79E,KAErB69E,EAAKD,QACX,KAAK5/D,GAAWggE,cACd5qE,EAAKwqE,OAAOtrE,YAAcgrE,EAC1B,MACF,KAAKt/D,GAAWigE,UACd7qE,EAAKwqE,OAAOtrE,YAAcirE,EAC1B,MACF,KAAKv/D,GAAWkgE,WACd9qE,EAAKwqE,OAAOtrE,YAAckrE,EAY9B,GANEM,EADED,EAAKM,UACUnkE,EAAKoE,KAAKwxD,kBAAkBlxD,WAAU,GAEtC1E,EAAKoE,KAAKyxD,qBAAqBnxD,WAAU,GAE5DtL,EAAK+qE,UAAU5yE,YAAYuyE,GAEvBD,EAAKD,SAAW5/D,GAAWigE,UAAW,CACxC,IAAMpB,EAAa7iE,EAAKoE,KAAK0xD,eAAepxD,WAAU,GACtD5W,GAAI1K,KAAKy/E,EAAY,QAAOnhF,EAAAzL,IAAAA,MAAE,SAAAgxE,IAAA,IAAA5kE,EAAA,OAAApM,IAAAA,MAAA,SAAAixE,GAAA,cAAAA,EAAAppE,KAAAopE,EAAA3rE,MAAA,OACC,OAA7BuS,GAAI2E,KAAK2R,EAAKs/D,gBAAexc,EAAA3rE,KAAA,EACXuL,EAAS,wBAAyB,CAClDkQ,QAASgJ,EAAKk6C,gBACdl0D,KAAM69E,EAAK79E,OACX,OAHO,GAAH3D,EAAG6kE,EAAAnsE,KAIJmpB,KAAM6mC,cAAc1oD,GAAM,CAAF6kE,EAAA3rE,KAAA,QAEE,OAD7B6oB,EAAKs/D,eAAeprE,YAAcjW,EAAIwE,IACtCiH,GAAIyE,KAAK6R,EAAKs/D,gBAAexc,EAAAhsE,OAAA,iBAG/B8kB,EAAKokE,uBAAsB,wBAAAld,EAAAjpE,OAAA,GAAAgpE,EAAA,MAE7B7tD,EAAKlH,OAAOX,YAAYsxE,EAC1B,CAEAz+D,EAAKu/D,eAAepyE,YAAYgvC,EAClC,IAAE,yBAAAinB,EAAAvpE,OAAA,GAAAspE,EAAA,UACH,kBAAAwN,GAAAlzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,sBAAAE,OAAAg+E,GAAApzE,EAAAzL,IAAAA,MACA,SAAA8xE,IAAA,IAAA3jD,EAAA,OAAAnuB,IAAAA,MAAA,SAAA+xE,GAAA,cAAAA,EAAAlqE,KAAAkqE,EAAAzsE,MAAA,OACwB,OAAhB6oB,EAAOnrB,KAAKmrB,KAAI4jD,EAAAzsE,KAAA,EAChBtC,KAAKorF,yBAAwB,OACnCv2E,GAAI2E,KAAK2R,EAAKs/D,gBACdzqF,KAAKqkF,SAASl5D,EAAKkgE,iBAAgB,wBAAAtc,EAAA/pE,OAAA,GAAA8pE,EAAA,UACpC,kBAAA+M,GAAAjzE,MAAA,KAAAD,UAAA,IAGD,CAAAhL,IAAA,gBAAAE,OAAA+9E,GAAAnzE,EAAAzL,IAAAA,MACA,SAAAqzE,IAAA,IAAAllD,EAAA/hB,EAAA,OAAApM,IAAAA,MAAA,SAAAszE,GAAA,cAAAA,EAAAzrE,KAAAyrE,EAAAhuE,MAAA,OAE+B,OADvB6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKs/D,gBAAena,EAAAhuE,KAAA,EACXuL,EAAS,qBAAsB,CAC/CkQ,QAAS/d,KAAKihE,gBACdl0D,KAAMoe,EAAKmgE,aAAaztF,QACxB,OAHO,GAAHuL,EAAGknE,EAAAxuE,KAIJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFknE,EAAAhuE,KAAA,QAEE,OAD7B6oB,EAAKs/D,eAAeprE,YAAcjW,EAAIwE,IACtCiH,GAAIyE,KAAK6R,EAAKs/D,gBAAena,EAAAruE,OAAA,iBAG/BjC,KAAKmrF,uBACLhgE,EAAKmgE,aAAaztF,MAAQ,GAAE,yBAAAyyE,EAAAtrE,OAAA,GAAAqrE,EAAA,UAC7B,kBAAAuL,GAAAhzE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,uBAAAE,OAAA89E,GAAAlzE,EAAAzL,IAAAA,MAKA,SAAAuzE,IAAA,IAAAplD,EAAAvD,EAAA,YAAA5qB,IAAAA,MAAA,SAAAwzE,GAAA,cAAAA,EAAA3rE,KAAA2rE,EAAAluE,MAAA,OACQ6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAIyE,KAAK6R,EAAKq/D,aACdjxE,YAAW,WACL1E,GAAI82D,YAAYxgD,EAAKq/D,cACvB5iE,EAAKwjE,wBAET,GAAG,KAAM,wBAAA5a,EAAAxrE,OAAA,GAAAurE,EAAA,UACV,kBAAAoL,GAAA/yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,yBAAAE,MAIA,SAAwBouB,GACtB,IAAMd,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKogE,sBAAuBpgE,EAAKqgE,oBAAqBrgE,EAAKsgE,iBAAkBtgE,EAAKugE,mBAAoBvgE,EAAKwgE,iBAChH1/D,EAASpX,GAAIyE,KAAK6R,EAAKqgE,oBAAqBrgE,EAAKsgE,kBAChD52E,GAAIyE,KAAK6R,EAAKugE,mBAAoBvgE,EAAKwgE,iBAC5C3rF,KAAKqkF,SAASl5D,EAAK+2D,0BACrB,GAEA,CAAAvkF,IAAA,qBAAAE,OAAA69E,GAAAjzE,EAAAzL,IAAAA,MAGA,SAAA+zE,IAAA,IAAA5lD,EAAAlM,EAAAgN,EAAA2wB,EAAAqjC,EAAA3hC,EAAAl1C,EAAAwiF,EAAA,OAAA5uF,IAAAA,MAAA,SAAAm0E,GAAA,cAAAA,EAAAtsE,KAAAssE,EAAA7uE,MAAA,OAa8D,OAZtD6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKogE,uBAERtsE,EAAQgM,KAAMoW,OAAOrhC,KAAKihE,iBAC1Bh1C,GAAWhN,EAAMmG,OAAOF,SAExB03B,EAAM,CACV7+B,QAAS/d,KAAKihE,gBACdh1C,QAASA,GAGLg0D,EAAY,CAAE7sB,UAAWn0C,EAAMlb,MAC/Bu6C,EAASrzB,KAAMuzB,QAAQrzB,EAAK+2D,2BAA0B/Q,EAAA7uE,KAAA,GAC1CuL,EARN,0BAQoB+uC,GAAI,QAC5B,GADFxzC,EAAG+nE,EAAArvE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF+nE,EAAA7uE,KAAA,SAGS,OAFhC8G,EAAIu6D,OAAS90D,EAAOg9E,gBAAiB1gE,EAAKogE,sBAAsBlsE,YAAc9C,Gb3wBhD,wBa2wByF0jE,GACtH90D,EAAKogE,sBAAsBlsE,YAAcjW,EAAIwE,IAClDiH,GAAIyE,KAAK6R,EAAKogE,uBAAsBpa,EAAAlvE,OAAA,kBAIlC2pF,EAAarvE,GbnxBiB,kBamxBsB0jE,GACnDh0D,IAAS2/D,EAAarvE,GbnxBM,iBamxBgC0jE,IACjEjgF,KAAKkgF,aAAalgF,KAAKihE,gBAAiB91C,EAAK+2D,0BAA2B0J,GAAW,yBAAAza,EAAAnsE,OAAA,GAAA+rE,EAAA,UACpF,kBAAA2K,GAAA9yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,UAAAE,OAAA49E,EAAAhzE,EAAAzL,IAAAA,MAGA,SAAAk1E,EAAe97D,EAAkB01E,GAAqB,OAAA9uF,IAAAA,MAAA,SAAAm1E,GAAA,cAAAA,EAAAttE,KAAAstE,EAAA7vE,MAAA,OAGxB,OAF5B8T,EAAImE,MAAMwhD,QAAU,IACpBlnD,GAAIyE,KAAKlD,GACL01E,GAASA,EAAQ/8D,QAAOojD,EAAA7vE,KAAA,EACtBuS,GAAIyF,QAnyBU,KAmyBe,SAAA60C,GACjC/4C,EAAImE,MAAMwhD,QAAU,GAAHhwD,OAAMojD,EACzB,GAAG,WAAU,OACb/4C,EAAImE,MAAMwhD,QAAU,IACpB/7D,KAAK+rF,UAAY31E,EAAG,wBAAA+7D,EAAAntE,OAAA,GAAAktE,EAAA,UACrB,SAAA7jE,EAAAqV,GAAA,OAAA+3D,EAAA7yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,WAAAE,OAAA29E,EAAA/yE,EAAAzL,IAAAA,MACA,SAAAo1E,EAAgBxrB,GAAiB,IAAAz7B,EAAAoQ,EAAA,OAAAv+B,IAAAA,MAAA,SAAAq1E,GAAA,cAAAA,EAAAxtE,KAAAwtE,EAAA/vE,MAAA,OAM8B,OALvD6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK4gD,YAAcgG,EACnB5mD,KAAKi9C,MAAM18C,SAAQ,SAAAqmD,GAAI,OAAI/xC,GAAI2E,KAAKotC,EAAK,IACzCA,EAAKrsC,MAAMvE,MAAQ,UACnBnB,GAAIyE,KAAK6R,EAAK8xB,MAAO2J,GACfrrB,GAASpQ,EAAK8xB,MAAMvmC,YAAckwC,EAAKlwC,aAAe,EAAC27D,EAAA/vE,KAAA,EACvDuS,GAAIyF,QAlzBU,KAkzBe,SAAA60C,GACjCvI,EAAKrsC,MAAMvE,MAAQ,GAAHjK,QAAO,EAAIojD,GAAY5zB,EAAK,KAC9C,GAAG,eAAc,OACjBqrB,EAAKrsC,MAAMvE,MAAQ,IAAG,wBAAAq8D,EAAArtE,OAAA,GAAAotE,EAAA,UACvB,SAAA3rD,GAAA,OAAA+0D,EAAA5yE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,cAAAE,OAAA09E,EAAA9yE,EAAAzL,IAAAA,MAED,SAAA21E,EAAmB/kE,GAAW,IAAAua,EAAA,YAAAnrB,IAAAA,MAAA,SAAAk2E,GAAA,cAAAA,EAAAruE,KAAAquE,EAAA5wE,MAAA,OAGgB,OAF5CtC,KAAKi9C,MAAM18C,SAAQ,SAAAqmD,GAAI,OAAI/xC,GAAI2E,KAAKotC,EAAK,IACzC5mD,KAAK4gD,YAAc5gD,KAAKmrB,KAAKmqD,cAC7Bt1E,KAAK2mF,UAAYvR,GAAYp1E,KAAKmrB,KAAMvd,GAAIslE,EAAA5wE,KAAA,EACtCtC,KAAK2mF,UAAU5sE,OAAM,OAC3B/Z,KAAK2mF,UAAY,IAAI7sE,GAAU,MAAM,WAAkB,GAAI,IAAI,WACzDqO,EAAKy4B,cAAgBz4B,EAAKgD,KAAKmqD,eAAentD,EAAK20D,aACzD,IAAE,wBAAA5J,EAAAluE,OAAA,GAAA2tE,EAAA,UACH,SAAAjpD,GAAA,OAAA6xD,EAAA3yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,OAAAy9E,EAAA7yE,EAAAzL,IAAAA,MACA,SAAA02E,EAAqB31D,GAAe,IAAAoN,EAAA/U,EAAA41E,EAAA,OAAAhvF,IAAAA,MAAA,SAAA22E,GAAA,cAAAA,EAAA9uE,KAAA8uE,EAAArxE,MAAA,OAIsB,OAHlD6oB,EAAOnrB,KAAKmrB,KACZ/U,EAAM+U,EAAK4rD,cACjB/2E,KAAK+2E,cAAcS,SAASz5D,GACtBiuE,EAAiBhsF,KAAK+2E,cAAc1hB,eAAcse,EAAArxE,KAAA,EAClDtC,KAAKqkF,SAASjuE,GAAI,cAAAu9D,EAAArxE,KAAA,EAClB0pF,EAAc,wBAAArY,EAAA3uE,OAAA,GAAA0uE,EAAA,UACrB,SAAA/pD,GAAA,OAAA2xD,EAAA1yE,MAAA,KAAAD,UAAA,IAGD,CAAAhL,IAAA,mBAAAE,MACA,WAAoC,IAAAg5B,EAAA,KAC5B1L,EAAOnrB,KAAKmrB,KAClBnrB,KAAKisF,aAAe,CAAC,EACrBp3E,GAAImD,MAAMmT,EAAK+gE,aACf,IAAMC,EAAYzkF,EAAOrK,OAAO+C,OAAO6qB,KAAMoW,SAC7C8qD,EAAa1xD,MAAK,SAAC9zB,EAAmByT,GACpC,GAAIzT,EAAEye,SAAWhL,EAAEgL,OAAQ,OAAQ,EACnC,IAAKze,EAAEye,QAAUhL,EAAEgL,OAAQ,OAAO,EAClC,IAAKze,EAAEye,SAAWhL,EAAEgL,OAAQ,MAAoB,QAAbze,EAAEgY,QAAoB,EAAI,EAC7D,IAAAytE,EAAqB,CAACzlF,EAAEye,OAAOozB,QAASp+B,EAAEgL,OAAOozB,SAA1C6zC,EAAID,EAAA,GAAEE,EAAIF,EAAA,GACVG,EAAmBF,EAAKr8C,UAAYq8C,EAAKG,SAAWH,EAAKxnE,OAAjD4nE,EAAyDH,EAAKt8C,UAAYs8C,EAAKE,SAAWF,EAAKznE,OAC9G,GAAe,IAAX0nE,GAA2B,IAAXE,EAAc,OAAO9lF,EAAEgY,OAAO+tE,cAActyE,EAAEuE,QAC7D,GAAe,IAAX4tE,EAAc,OAAO,EACzB,GAAe,IAAXA,EAAc,OAAQ,EAC/B,IAAAI,EAAuB,CAAC1hE,KAAMymB,aAAa/qC,EAAEsO,IAAKgW,KAAMymB,aAAat3B,EAAEnF,KAAhE23E,EAAKD,EAAA,GAAEE,EAAKF,EAAA,GACnB,OAAIC,IAAUC,GAAe,GACxBD,GAASC,EAAc,EACrBA,EAAQJ,EAASG,EAAQL,CAClC,IAAE,IAC0BzxE,EAD1BC,EAAA1P,GACc8gF,GAAY,QAAAvhB,EAAA,WAAE,IAAnBjkE,EAACmU,EAAAjd,MACJmyE,EAAO7kD,EAAK6xD,eAAevxD,WAAU,GAC3CN,EAAK+gE,YAAY5zE,YAAY03D,GAC7B,IAAM7vD,EAAOtL,GAAI6W,cAAcskD,GAC/Bn5C,EAAKo1D,aAAatlF,EAAEsO,IAAM,CAAEkL,KAAAA,EAAM6vD,KAAAA,GAClCn5C,EAAKi2D,kBAAkBnmF,EAAEsO,IACzBJ,GAAI1K,KAAK6lE,EAAM,SAAS,WACtBn5C,EAAK0vD,iBAAiB5/E,EAAEsO,IACxBxK,EAAMgE,WAAWhE,EAAM67E,gBAAiBh9E,OAAO3C,EAAEsO,IACnD,GACF,EAVA,IAAA8F,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAAkpE,GAUC,OAAAlsE,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CAED,OADAsf,EAAK+gE,YAAYvzE,UAAUM,OAAO,aAC3BkzE,EAAa,EACtB,GAAC,CAAAxuF,IAAA,oBAAAE,MAED,SAAmBkgB,GAAiB,IAAAgvE,EAC5BpmF,EAAIskB,KAAMoW,OAAOtjB,GACvBivE,EAAuBhtF,KAAKisF,aAAaluE,GAAjCiyD,EAAIgd,EAAJhd,KAAM7vD,EAAI6sE,EAAJ7sE,KACdtL,GAAI2E,KAAK2G,EAAKg/C,QAASh/C,EAAK8sE,UAC5Bjd,EAAKr3D,UAAUC,IAAI,aACnBm0E,EAAA5sE,EAAKoxB,KAAI9xB,MAATstE,EAASttE,IAAQ5K,GAAImK,SAASrY,EAAEgY,SAChC,IAAMuuE,EAAcvmF,EAAEgY,OAAOrT,MAAM,KACnC,GAA2B,IAAvB4hF,EAAY3pF,OAAc,KAAA4pF,EACtB5tE,EAAe2tE,EAAY,GACjC/sE,EAAKitE,UAAUz0E,UAAUM,OAAO,WAChCk0E,EAAAhtE,EAAKitE,WAAU3tE,MAAf0tE,EAAe1tE,IAAQ5K,GAAImK,SAASO,GACtC,CAGA,GAFIvf,KAAKihE,kBAAoBljD,GAASiyD,EAAKr3D,UAAUC,IAAI,YACzDuH,EAAKpc,KAAKsb,YAAc1Y,EAAE5C,KACtB4C,EAAEye,OAAQ,CACZ4qD,EAAKr3D,UAAUM,OAAO,YACtB,IAA2BmB,EAAsBzT,EAAzCye,OAAUozB,QAAwB/7B,EAAO9V,EAAjB+N,SAC1B24E,EAAejzE,EAAE41B,UAAY51B,EAAEyK,OAASzK,EAAEoyE,SACkBc,EAAA1lF,EAAhDiN,GAAIuJ,2BAA2BivE,EAAc5wE,GAAG,GAA3DlR,EAAC+hF,EAAA,GAAExwE,EAAIwwE,EAAA,GACdntE,EAAKq4B,QAAQn5B,YAAc9T,EAC3B4U,EAAKrD,KAAKuC,YAAcvC,EACxBjI,GAAIyE,KAAK6G,EAAK8kD,YACd,IAAM/F,EAAWj0C,KAAMymB,aAAa/qC,EAAEsO,IAClCiqD,IACFrqD,GAAIyE,KAAK6G,EAAKg/C,SACdh/C,EAAKotE,KAAKluE,YAAcxK,GAAIiJ,kBAAkBuvE,EAAe5wE,EAAG9H,aAAaC,iBAAmBsqD,GAEpG,MAAOrqD,GAAIyE,KAAK6G,EAAK8sE,SACvB,GAAC,CAAAtvF,IAAA,mBAAAE,OAAAw9E,EAAA5yE,EAAAzL,IAAAA,MAED,SAAA03E,EAAwB32D,GAAe,IAAAmuE,EAAArsE,EAAAD,EAAAjZ,EAAAyT,EAAA8lB,EAAAx5B,EAAAmB,EAAAK,EAAAgC,EAAA,OAAAlN,IAAAA,MAAA,SAAA43E,GAAA,cAAAA,EAAA/vE,KAAA+vE,EAAAtyE,MAAA,OAC7B4pF,EAAgBlsF,KAAKmrB,KAArB+gE,YAAWrsE,EAAAxU,GACH6gF,EAAYxxE,UAAQ,IAApC,IAAAmF,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAYke,EAAA/hB,MAA4B8a,UAAUM,OAAO,WAAW,OAAAva,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CACpE7L,KAAKisF,aAAaluE,GAASiyD,KAAKr3D,UAAUC,IAAI,YAC9C5Y,KAAKihE,gBAAkBljD,EACvB/d,KAAKmrB,KAAK40D,mBAAmBpnB,SAAU,EACvC34D,KAAKwtF,qBAAqBzvE,GAC1B/d,KAAKytF,qBAAqB1vE,GACpBpX,EAAI3G,KAAK0tF,mBAAmB3vE,GAC5B3D,EAAIpa,KAAKggF,cAAcjiE,GACvBmiB,EAAIlgC,KAAKogF,kBAAkBriE,GAC3BrX,EAAI1G,KAAKqgF,cAActiE,GAAQlW,EAAA,EAAAK,EACrB,CAACvB,EAAGyT,EAAG8lB,EAAGx5B,GAAE,aAAAmB,EAAAK,EAAA3E,QAAA,CAAAqxE,EAAAtyE,KAAA,SAAhB,OAAD4H,EAAChC,EAAAL,GAAA+sE,EAAAtyE,KAAA,GAAwB4H,EAAC,QAAArC,IAAA+sE,EAAAtyE,KAAA,kCAAAsyE,EAAA5vE,OAAA,GAAA0vE,EAAA,UACtC,SAAA9qD,GAAA,OAAAyxD,EAAAzyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,uBAAAE,MAED,SAAsBkgB,GACpB,GAAIA,IAAY/d,KAAKihE,gBAArB,CACA,IAAA0sB,EAAkD1iE,KAAMoW,OAAOtjB,GAAvDY,EAAMgvE,EAANhvE,OAAQyG,EAAMuoE,EAANvoE,OAAQrhB,EAAI4pF,EAAJ5pF,KAAMioC,EAAK2hD,EAAL3hD,MAAOt3B,EAAQi5E,EAARj5E,SAC7ByW,EAAenrB,KAAfmrB,KAAM7d,EAAStN,KAATsN,KAad,GAZAuH,GAAIoJ,QAAQ3Q,EAAM,oBAAqBvJ,GACvC8Q,GAAIoJ,QAAQ3Q,EAAM,gBAAiBoH,EAASC,aAAamI,MACzDqO,EAAKq8B,UAAU/nC,IAAM5K,GAAImK,SAASL,GAClC9J,GAAI2E,KACF2R,EAAK85C,WAAY95C,EAAKyiE,eAAgBziE,EAAK0mC,aAAc1mC,EAAK0iE,cAC9D1iE,EAAK2iE,YAAa3iE,EAAK4iE,eAAgB5iE,EAAK6iE,aAAc7iE,EAAK8iE,YAC/D9iE,EAAK+iE,UAAW/iE,EAAKgjE,cAAehjE,EAAKijE,YAAajjE,EAAK4iE,eAC3D5iE,EAAKkjE,aAAcljE,EAAKmjE,gBAAiBnjE,EAAKojE,eAAgBpjE,EAAKqjE,aACnErjE,EAAKsjE,iBAAkBtjE,EAAKujE,YAAavjE,EAAKwjE,UAAWxjE,EAAKyjE,WAC9DzjE,EAAK0jE,gBAEP7uF,KAAK8uF,mBAAmB/wE,GACpBiuB,EAAO,CACT,IAAMylB,EAAcxmC,KAAMoW,OAAO2K,EAAMC,UACvC9gB,EAAKmoC,gBAAgB7zC,IAAM5K,GAAImK,SAASyyC,EAAY9yC,QACpDwM,EAAKooC,gBAAgBl0C,YAAcoyC,EAAY1tD,KAC/ConB,EAAK4jE,gBAAgB1vE,YAAc2sB,EAAM+iD,gBACzCl6E,GAAIyE,KAAK6R,EAAKqjE,aAChB,CACA,GAAIppE,EAAQ,CACVplB,KAAKgvF,8BACL,IAAQC,EAAkD7pE,EAAlD6pE,SAAU3pE,EAAwCF,EAAxCE,QAASJ,EAA+BE,EAA/BF,SAAgBgsC,EAAe9rC,EAArB1lB,KAE/Bo0D,EAAY7oC,KAAMikE,iBAAiBnxE,EAASmzC,GAClD/lC,EAAK+lC,WAAW7xC,YAAcy0C,EAAUJ,IACpCu7B,GAAUjvF,KAAKmvF,eAAeF,GAC9B/pE,EAAUrQ,GAAIyE,KAAK6R,EAAKojE,gBACnBjpE,EACPtlB,KAAKimF,mBAAmB7gE,EAAOrH,SAC1BlJ,GAAIyE,KAAK6R,EAAK+iE,UAAW/iE,EAAK4iE,eACvC,MAAOl5E,GAAIyE,KAAK6R,EAAK0mC,cAErB1mC,EAAKikE,iBAAiBz2E,UAAUM,OAAO,YAnCK,CAoC9C,GAAC,CAAAtb,IAAA,qBAAAE,MAED,SAAoBkgB,GAClB,IAAQoN,EAA0BnrB,KAA1BmrB,KACR,GAAIpN,IAD8B/d,KAApBihE,gBACd,CACA,IAAAouB,EAA0EpkE,KAAM8sB,UAAUh6B,GAAlFwH,EAAS8pE,EAAT9pE,UAAWE,EAAY4pE,EAAZ5pE,aAAc6pE,EAAUD,EAAVC,WAAYC,EAASF,EAATE,UAAW3pE,EAAIypE,EAAJzpE,KACxD,GADqEypE,EAAP/pE,UAE9DzQ,GAAIyE,KAAK6R,EAAK2iE,YAAa3iE,EAAKkjE,aAAcljE,EAAKmjE,iBACnDnjE,EAAK5F,UAAUlG,YAAc/V,OAAOic,GACpC4F,EAAK1F,aAAapG,YAAc,GAAHtT,QAAsB,IAAf0Z,GAAoBC,QAAQ,GAAE,KAC9DE,GACF/Q,GAAIyE,KAAK6R,EAAK8iE,cACThjE,KAAMukE,iBAAiBzxE,IAAYwxE,GAAW16E,GAAIyE,KAAK6R,EAAKijE,cAC5Dv5E,GAAIyE,KAAK6R,EAAK6iE,aAAc7iE,EAAKgjE,eACxCt5E,GAAIqf,YAA0BzyB,IAAnB6tF,EAAWG,IAAmBtkE,EAAKwjE,gBACvBltF,IAAnB6tF,EAAWG,KAEb,GADA56E,GAAI2E,KAAK2R,EAAKyjE,WAAYzjE,EAAK0jE,gBACR,IAAnBS,EAAWG,KAAaH,EAAWI,QAAUJ,EAAWK,aAAc96E,GAAIyE,KAAK6R,EAAK0jE,oBACnF,CACHh6E,GAAIyE,KAAK6R,EAAKyjE,YACd,IAAMhpD,EAAO0pD,EAAWG,IAAMH,EAAWK,aACzCxkE,EAAKyjE,WAAWvvE,YAAc,GAAHtT,QAAc,IAAP65B,GAAYlgB,QAAQ,GAAE,IAC1D,CAlBqC,CAoBzC,GAAC,CAAA/nB,IAAA,iBAAAE,MAED,SAAgBoxF,GACd,IAAQ9jE,EAAmCnrB,KAAnCmrB,KAAuBpN,EAAY/d,KAA7BihE,gBACdpsD,GAAI2E,KAAK2R,EAAKujE,aACd,IAAAkB,EAAgC3kE,KAAMoW,OAAOtjB,GAA3BtB,EAAEmzE,EAAZl7E,SAAcs3B,EAAK4jD,EAAL5jD,MAChBkzB,EAAWj0C,KAAMymB,aAAa3zB,GACpC,GAAKmhD,EAAL,CACA,IAAM2wB,EAAa7jD,EAAQA,EAAMC,SAAWluB,EACtC+xE,EAAc7kE,KAAMymB,aAAam+C,GACvC,IAAI7jD,GAAU8jD,EAAd,CACAj7E,GAAIyE,KAAK6R,EAAKujE,aACd,IAAM1H,EAAQh7C,EAAQ/gB,KAAMoW,OAAO2K,EAAMC,UAAUv3B,SAAW+H,EAC9D5H,GAAIk7E,sBAAsB5kE,EAAK6kE,gBAAiBH,EAAYZ,EAAS3yE,KAAM0qE,GAC3EnyE,GAAImJ,uBAAuBmN,EAAK8kE,iBAAkBJ,EAAYZ,EAASnR,KAAMkJ,GAC7EnyE,GAAImJ,uBAAuBmN,EAAK+kE,iBAAkBL,EAAYZ,EAASniC,KAAMk6B,GAC7EnyE,GAAImJ,uBAAuBmN,EAAKglE,mBAAoBN,EAAYZ,EAASliC,OAAQi6B,GACjF77D,EAAKilE,eAAe/wE,YAAcxK,GAAIiJ,kBAAkBohD,GACxD,IAAMmxB,EAAWpB,EAASnR,KAAOkJ,EAAMryE,aAAaC,iBAAmBk7E,EACvE3kE,EAAKmlE,iBAAiBjxE,YAAcxK,GAAIiJ,kBAAkBuyE,GAC1D,IAAME,EAAWtB,EAASniC,KAAOk6B,EAAMryE,aAAaC,iBAAmBk7E,EACvE3kE,EAAKqlE,iBAAiBnxE,YAAcxK,GAAIiJ,kBAAkByyE,GAC1D,IAAME,EAAaxB,EAASliC,OAASi6B,EAAMryE,aAAaC,iBAAmBk7E,EAC3E3kE,EAAKulE,mBAAmBrxE,YAAcxK,GAAIiJ,kBAAkB2yE,GAC5D57E,GAAIyE,KAAK6R,EAAKujE,YAdmB,CAHZ,CAkBvB,GAAC,CAAA/wF,IAAA,qBAAAE,OAAAu9E,EAAA3yE,EAAAzL,IAAAA,MAED,SAAAg4E,EAA0Bj3D,GAAe,IAAA4yE,EAAAzvB,EAAA9qD,EAAA45D,EAAA,OAAAhzE,IAAAA,MAAA,SAAAm4E,GAAA,cAAAA,EAAAtwE,KAAAswE,EAAA7yE,MAAA,cAAA6yE,EAAA7yE,KAAA,EACnB2oB,KAAM2lE,oBAAoB7yE,GAAQ,OAEhC,GAFhB4yE,EAAKxb,EAAArzE,KAAAo/D,EAC0DlhE,KAA7DmrB,KAA0B/U,EAAG8qD,EAArButB,iBAA0Cze,EAAI9O,EAAvBsd,kBACvC3pE,GAAIqf,OAAOy8D,EAAOv6E,GACbu6E,EAAO,CAAFxb,EAAA7yE,KAAA,eAAA6yE,EAAAlzE,OAAA,iBACV4S,GAAIg8E,MAAM7gB,GAAK,wBAAAmF,EAAAnwE,OAAA,GAAAgwE,EAAA,UAChB,SAAAnrD,GAAA,OAAAuxD,EAAAxyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,oBAAAE,OAAAs9E,EAAA1yE,EAAAzL,IAAAA,MAED,SAAA8zF,EAAyB/yE,GAAe,IAAA45C,EAAAo5B,EAAA3rE,EAAA3I,EAAA0O,EAAAmzB,EAAAl1C,EAAA4nF,EAAA,OAAAh0F,IAAAA,MAAA,SAAAi0F,GAAA,cAAAA,EAAApsF,KAAAosF,EAAA3uF,MAAA,OAYrC,GAXDtC,KAAKkxF,WAAa,CAChBC,OAAQ,EACRC,QAAS,GACTC,SAAS,GACVN,EACgC9lE,KAAMoW,OAAOtjB,GAAtCqH,EAAM2rE,EAAN3rE,OAAkB3I,EAAEs0E,EAAZr8E,SACVyW,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KACF2R,EAAKmmE,WAAYnmE,EAAKomE,QAASpmE,EAAKqmE,eAAgBrmE,EAAKsmE,WACzDtmE,EAAKumE,cAAevmE,EAAKwmE,eAAgBxmE,EAAKymE,mBAC9CzmE,EAAK0mE,iBAAkB1mE,EAAK2mE,iBAEzB1sE,SAAAA,EAAQE,SAjgCQ,MAigCIF,EAAO+vB,OAAgC,CAAA87C,EAAA3uF,KAAA,eAAA2uF,EAAAhvF,OAAA,iBAEnB,OAD7C4S,GAAIyE,KAAK6R,EAAKmmE,YACRhzC,EAASrzB,KAAMuzB,QAAQrzB,EAAKmmE,YAAWL,EAAA3uF,KAAA,GAC3BtC,KAAK+xF,SAAS,mBAAoBh0E,GAAQ,QACpD,GADF3U,EAAG6nF,EAAAnvF,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF6nF,EAAA3uF,KAAA,aAEvB8G,EAAIwE,IAAIw6C,SAAS,mCAAoC,CAAF6oC,EAAA3uF,KAAA,SACtB,OAA/BuS,GAAIyE,KAAK6R,EAAK0mE,kBAAiBZ,EAAAhvF,OAAA,kBAII,OADrC4S,GAAIyE,KAAK6R,EAAKsmE,YACdtmE,EAAKsmE,WAAWpyE,YAAcjW,EAAIwE,IAAGqjF,EAAAhvF,OAAA,kBAY2C,GATlF4S,GAAIyE,KAAK6R,EAAKqmE,eAAgBrmE,EAAKwmE,gBAC7BX,EAAc5nF,EAAImE,OACxBvN,KAAKgxF,YAAcA,EACnB7lE,EAAK6mE,mBAAmB3yE,YAAc/V,OAAO0nF,EAAYiB,QAAQC,QAAQ3uF,QACzE4nB,EAAKgnE,mBAAmB9yE,YAAc/V,OAAO0nF,EAAYiB,QAAQG,QAAQ7uF,QACzE4nB,EAAKknE,sBAAsBhzE,YAAcxK,GAAIiJ,kBAAkBkzE,EAAYsB,YAAc71E,EAAG9H,aAAaC,kBACzGuW,EAAKonE,aAAalzE,YAAcxK,GAAIkc,gBAAgB3L,EAAOozB,QAAQxI,UAAWvzB,GAC9Ezc,KAAKwyF,kBAAkBxB,EAAY/uC,MAAOxlC,EAAIu0E,EAAYsB,YAAatB,EAAYyB,iBAEjB,QAA9C96B,EAAG1sC,KAAMgtC,gBAAgBj4D,KAAKihE,wBAAgB,IAAAtJ,OAAA,EAA3CA,EAA6C+6B,gBAChD,CAAFzB,EAAA3uF,KAAA,SAG2D,OAF3EuS,GAAI2E,KAAK2R,EAAK64D,SAAU74D,EAAK03D,UAC7BhuE,GAAIyE,KAAK6R,EAAK2mE,iBACd3mE,EAAKwnE,qBAAqBtzE,YAAc4L,KAAM6gB,KAAK8mD,oBAAoB7uF,KAAIktF,EAAAhvF,OAAA,kBAI7EjC,KAAK6yF,UAAU7B,EAAY8B,KAAI,yBAAA7B,EAAAjsF,OAAA,GAAA8rF,EAAA,UAChC,SAAA/xC,GAAA,OAAAo8B,EAAAvyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,YAAAE,MAED,SAAWi1F,GACT,IAAQ3nE,EAAsBnrB,KAAtBmrB,KAAM6lE,EAAgBhxF,KAAhBgxF,YAEd,GADAn8E,GAAI2E,KAAK2R,EAAKumE,eACVoB,EAIF,OAHAj+E,GAAIyE,KAAK6R,EAAKumE,cAAevmE,EAAKymE,oBAClC/8E,GAAI2E,KAAK2R,EAAKomE,cACdpmE,EAAK4nE,OAAO1zE,YAAcyzE,GAG5Bj+E,GAAIqf,QAAQ88D,EAAYgC,MAAO7nE,EAAKomE,SACpC18E,GAAIqf,OAAO88D,EAAYgC,MAAO7nE,EAAKymE,mBACrC,GAAC,CAAAj0F,IAAA,oBAAAE,MAED,SAAmBokD,EAAoBxlC,EAAc61E,EAAsBG,GACzE,IAAQtnE,EAAsBnrB,KAAtBmrB,KAAM6lE,EAAgBhxF,KAAhBgxF,YACdA,EAAY/uC,MAAQA,EAChBqwC,IAAatB,EAAYsB,YAAcA,GACvCG,IAAezB,EAAYyB,cAAgBA,GAC/C,IAAMQ,EAAkBjC,EAAYkC,QAAQ5/E,QAAO,SAAC6/E,GAAW,OAAKA,EAAI5lF,QA7iC5C,GA6iC0E4lF,EAAI5lF,QA/iC3E,CA+iCwG,IAAEhK,OACzI4nB,EAAKioE,mBAAmB/zE,YAAc/V,OAAO2pF,GAC7C9nE,EAAKkoE,oBAAoBh0E,YAAc/V,OAAO24C,EAAMqxC,SACpDz+E,GAAIqf,OAAO+tB,EAAMqxC,QAAU,EAAGnoE,EAAKooE,wBACnCpoE,EAAKqoE,kBAAkBn0E,YAAc/V,OAAO24C,EAAMwxC,QAClDtoE,EAAKuoE,cAAcr0E,YAAc/V,OAAO24C,EAAMwxC,QAC9C5+E,GAAIqf,OAAO+tB,EAAMwxC,OAAS,EAAGtoE,EAAKwoE,gBAAiBxoE,EAAKyoE,sBACxDzoE,EAAK0oE,iBAAiBx0E,YAAc/V,OAAO24C,EAAM6xC,aACjD3oE,EAAK4oE,mBAAmB10E,YAAcxK,GAAIiJ,kBAAkBmkC,EAAM+xC,aAAev3E,EAAG9H,aAAaC,kBACjGuW,EAAK8oE,iBAAiB50E,YAAc/V,OAAO24C,EAAMiyC,OAC7C5B,IAAannE,EAAKmnE,YAAYjzE,YAAcxK,GAAIiJ,kBAAkBw0E,EAAc71E,EAAG9H,aAAaC,mBAChG69E,IAAetnE,EAAKsnE,cAAcpzE,YAAcxK,GAAIiJ,kBAAkB20E,EAAgBh2E,EAAG9H,aAAaC,kBAC5G,GAAC,CAAAjX,IAAA,gBAAAE,OAAAq9E,EAAAzyE,EAAAzL,IAAAA,MAED,SAAAm3F,IAAA,IAAAp2E,EAAAoN,EAAAmzB,EAAAl1C,EAAAgrF,EAAAr0E,EAAAD,EAAA4vD,EAAAn4C,EAAA,YAAAv6B,IAAAA,MAAA,SAAAq3F,GAAA,cAAAA,EAAAxvF,KAAAwvF,EAAA/xF,MAAA,OAM8C,OALtCyb,EAAU/d,KAAKihE,gBACf91C,EAAOnrB,KAAKmrB,KAClBnrB,KAAKqkF,SAASl5D,EAAK63D,WACnBnuE,GAAImD,MAAMmT,EAAKmpE,eACfz/E,GAAI2E,KAAK2R,EAAKsmE,YACRnzC,EAASrzB,KAAMuzB,QAAQrzB,EAAK63D,WAAUqR,EAAA/xF,KAAA,EAC1BtC,KAAK+xF,SAAS,gBAAiBh0E,GAAQ,OACjD,GADF3U,EAAGirF,EAAAvyF,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFirF,EAAA/xF,KAAA,SAEU,OADrCuS,GAAIyE,KAAK6R,EAAKsmE,YACdtmE,EAAKsmE,WAAWpyE,YAAcjW,EAAIwE,IAAGymF,EAAApyF,OAAA,kBAGjCmyF,EAAOhrF,EAAIgrF,KAAIr0E,EAAA1U,GACH+oF,GAAIC,EAAAxvF,KAAA,GAAA6qE,EAAA1yE,IAAAA,MAAA,SAAA0yE,IAAA,IAAAojB,EAAAxrC,EAAAnnC,EAAA,OAAAnjB,IAAAA,MAAA,SAAAu3F,GAAA,cAAAA,EAAA1vF,KAAA0vF,EAAAjyF,MAAA,OAAXwwF,EAAGhzE,EAAAjiB,MACNypD,EAAMn8B,EAAKgyD,WAAW1xD,WAAU,GACtCN,EAAKmpE,cAAch8E,YAAYgvC,IACzBnnC,EAAOtL,GAAI6W,cAAc47B,IAC1B6U,IAAI98C,YAAcyzE,EAAI32B,IAC3Bh8C,EAAKq0E,QAAQn1E,YAAcyzE,EAAI2B,cAAc/uE,QAAQ,GACrDvF,EAAKu0E,OAAOr1E,YAAc/V,OAAOwpF,EAAI4B,QACrC7/E,GAAI1K,KAAKm9C,EAAK,SAAS,WACrBzyC,GAAI2E,KAAK2R,EAAKsmE,YACdl6D,EAAKo9D,OAAO52E,EAAS+0E,EACvB,IAAE,wBAAAyB,EAAAvvF,OAAA,GAAA0qE,EAAA,IAAA3vD,EAAAxU,IAAA,YAAAuU,EAAAC,EAAAvZ,KAAA9E,KAAA,CAAA2yF,EAAA/xF,KAAA,gBAAA+xF,EAAAxuF,cAAA6pE,IAAA,iBAAA2kB,EAAA/xF,KAAA,iBAAA+xF,EAAA/xF,KAAA,iBAAA+xF,EAAAxvF,KAAA,GAAAwvF,EAAA1gC,GAAA0gC,EAAA,UAAAt0E,EAAAnU,EAAAyoF,EAAA1gC,IAAA,eAAA0gC,EAAAxvF,KAAA,GAAAkb,EAAAlU,IAAAwoF,EAAA1uF,OAAA,6BAAA0uF,EAAArvF,OAAA,GAAAmvF,EAAA,0BAEL,kBAAAjZ,EAAAtyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,4BAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBA,EAAKq4D,eAAe3lF,MAAQ,GAC5BgX,GAAI2E,KAAK2R,EAAKypE,cACd50F,KAAKqkF,SAASrkF,KAAKmrB,KAAKk4D,qBACxBl4D,EAAKq4D,eAAez0D,OACtB,GAAC,CAAApxB,IAAA,wBAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACZ3kB,EAAIqM,SAASsY,EAAKq4D,eAAe3lF,OAAS,KAE9CstB,EAAKq4D,eAAe3lF,MADlB2I,GAAK,EACqB,IAGF8C,OAAO9C,EACrC,GAAC,CAAA7I,IAAA,kBAAAE,OAAAo9E,EAAAxyE,EAAAzL,IAAAA,MAED,SAAA63F,IAAA,IAAA1pE,EAAApN,EAAAvX,EAAA83C,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA83F,GAAA,cAAAA,EAAAjwF,KAAAiwF,EAAAxyF,MAAA,OAOsD,GAN5C6oB,EAAmCnrB,KAAnCmrB,KAAuBpN,EAAY/d,KAA7BihE,mBAMRz6D,EAAIqM,SAASsY,EAAKq4D,eAAe3lF,OAAS,MACxC,GAAC,CAAAi3F,EAAAxyF,KAAA,eAAAwyF,EAAA7yF,OAAA,iBAE6C,OAAhDq8C,EAASrzB,KAAMuzB,QAAQrzB,EAAKk4D,qBAAoByR,EAAAxyF,KAAA,EACpCtC,KAAK+xF,SAAS,uBAAwB,CAAEh0E,QAAAA,EAASvX,EAAAA,IAAI,OAC/D,GADF4C,EAAG0rF,EAAAhzF,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF0rF,EAAAxyF,KAAA,SAEA,OAD3B6oB,EAAKypE,aAAav1E,YAAcjW,EAAIwE,IACpCiH,GAAIyE,KAAK6R,EAAKypE,cAAaE,EAAA7yF,OAAA,kBAG7BjC,KAAKo1E,YAAY74D,GbhkCe,oBagkCsB,CAAE/V,EAAGA,EAAEy8B,eAAepuB,GAAIzB,gBAAgB,yBAAA0hF,EAAA9vF,OAAA,GAAA6vF,EAAA,UACjG,kBAAA5Z,EAAAryE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,8BAAAE,MAED,SAA6Bk3F,GAC3B,IAAQ/D,EAAuChxF,KAAvCgxF,YAAa/vB,EAA0BjhE,KAA1BihE,gBAAiB91C,EAASnrB,KAATmrB,KAC9BpN,EAAYg3E,EAAZh3E,QACRi3E,EAA2CD,EAAWE,QAA9Cv2F,EAAGs2F,EAAHt2F,IAAKkpD,EAASotC,EAATptC,UAAWsrC,EAAO8B,EAAP9B,QAASjxC,EAAK+yC,EAAL/yC,MACjC,GAAIlkC,IAAYkjD,EAAhB,CACA,GAAIviE,EAGF,OAFAmW,GAAIyE,KAAK6R,EAAKg5D,4BACdh5D,EAAK+pE,mBAAmB71E,YAAc3gB,GAGpCw0F,IAASlC,EAAYkC,QAAUA,EAAQnnF,OAAOilF,EAAYkC,UAC1DjxC,GAAOjiD,KAAKwyF,kBAAkBvwC,EAAOh3B,KAAMoW,OAAOtjB,GAASrJ,UAC/Ds8E,EAAY/uC,MAAMwxC,OAAS7rC,EAC3Bz8B,EAAKqoE,kBAAkBn0E,YAAc/V,OAAOs+C,GAC5Cz8B,EAAKuoE,cAAcr0E,YAAc/V,OAAOs+C,GACxC/yC,GAAIqf,OAAO0zB,EAAY,EAAGz8B,EAAKyoE,qBAXQ,CAYzC,GAAC,CAAAj2F,IAAA,SAAAE,OAAAm9E,EAAAvyE,EAAAzL,IAAAA,MAED,SAAAm4F,EAAcp3E,EAAiB+0E,GAA0B,IAAA3nE,EAAAmzB,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAo4F,GAAA,cAAAA,EAAAvwF,KAAAuwF,EAAA9yF,MAAA,OAGV,OAF7CtC,KAAK88E,cACC3xD,EAAOnrB,KAAKmrB,KACZmzB,EAASrzB,KAAMuzB,QAAQrzB,EAAKmmE,YAAW8D,EAAA9yF,KAAA,EAC3BtC,KAAK+xF,SAAS,cAAe,CAAEh0E,QAAAA,EAASo+C,IAAK22B,EAAI32B,MAAM,OACjE,GADF/yD,EAAGgsF,EAAAtzF,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFgsF,EAAA9yF,KAAA,SAEU,OADrCuS,GAAIyE,KAAK6R,EAAKsmE,YACdtmE,EAAKsmE,WAAWpyE,YAAcjW,EAAIwE,IAAGwnF,EAAAnzF,OAAA,kBAGvCjC,KAAK6yF,UAAUC,EAAI32B,KAAI,yBAAAi5B,EAAApwF,OAAA,GAAAmwF,EAAA,UACxB,SAAAn2C,EAAAC,GAAA,OAAA+7B,EAAApyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,MAED,WACE,IAAMkgB,EAAU/d,KAAKihE,gBACf6xB,EAAM,CAAE32B,IAAKn8D,KAAKmrB,KAAKkqE,aAAax3F,OAC1CmC,KAAK20F,OAAO52E,EAAS+0E,EACvB,GAAC,CAAAn1F,IAAA,gBAAAE,MAED,SAAey3F,GACb,IAAQtE,EAA4BhxF,KAA5BgxF,YAAaE,EAAelxF,KAAfkxF,WACjBqE,EAAcD,EAAQlc,GACpBoc,EAA0B,GAChC,GAAID,EAAcvE,EAAYkC,QAAQ3vF,QAEpC,GADAiyF,EAAcxyF,KAAI4F,MAAlB4sF,EAAa9tF,EAASspF,EAAYkC,QAAQnuF,MAAMwwF,EAAaA,EAAcnc,MACvEoc,EAAcjyF,OAAS61E,GAAgB,CACzC,IAAMhU,EAAOgU,GAAiBoc,EAAcjyF,OAC5CiyF,EAAcxyF,KAAI4F,MAAlB4sF,EAAa9tF,EAASwpF,EAAWE,QAAQrsF,MAAM,EAAGqgE,IACpD,OAEAmwB,GAAevE,EAAYkC,QAAQ3vF,OACnCiyF,EAAcxyF,KAAI4F,MAAlB4sF,EAAa9tF,EAASwpF,EAAWE,QAAQrsF,MAAMwwF,EAAaA,EAAcnc,MAE5E,OAAOoc,CACT,GAAC,CAAA73F,IAAA,oBAAAE,MAED,SAAmB43F,EAAoBD,GACrC,IAAQrqE,EAAmCnrB,KAAnCmrB,KAAuBpN,EAAY/d,KAA7BihE,gBACRxkD,EAAKwO,KAAMvW,SAASqJ,GACpB23E,EAAWhrD,GAAc3sB,GAASkN,KAAM6gB,KAAKD,KACnDh3B,GAAImD,MAAMmT,EAAKwqE,mBACfxqE,EAAKyqE,kBAAkBv2E,YAAc/V,OAAOmsF,GAAW,IACbp1E,EADaC,EAAAjV,GAC1BmqF,GAAa,IAA1C,IAAAl1E,EAAA/U,MAAA8U,EAAAC,EAAA9Z,KAAA9E,MAA4C,KAAAm0F,EAAAx1E,EAAAxiB,MAA/Bi4F,EAAED,EAAFC,GAAIvoF,EAAMsoF,EAANtoF,OACTsxD,EAAK1zC,EAAKiyD,qBAAqB3xD,WAAU,GAC/CN,EAAKwqE,kBAAkBr9E,YAAYumD,GACnC5zC,KAAM8qE,gBAAgBl3B,GACtB,IAAM1+C,EAAOtL,GAAI6W,cAAcmzC,GAC/B1+C,EAAKsmE,IAAIpnE,YAAcxK,GAAI2nE,UAAqB,IAAXsZ,EAAG7vC,OACxC9lC,EAAK61E,MAAM32E,YAAcxK,GAAIizE,oBAAoBgO,EAAGxD,YAAa71E,GACjE0D,EAAK5S,OAAO8R,YAAc9C,GAAUq8D,GAA4BrrE,IAChE4S,EAAK81E,UAAU52E,YAAcy2E,EAAGI,KAAKnxF,MAAM,EAAG,GAC9Cob,EAAKg2E,QAAQ92E,YAAcy2E,EAAGI,KAAKnxF,OAAO,GAC1Cob,EAAKi2E,eAAeC,aAAa,OAAQX,EAASI,EAAGI,MACvD,CAAC,OAAAx3F,GAAA4hB,EAAA1U,EAAAlN,EAAA,SAAA4hB,EAAAzU,GAAA,CACH,GAAC,CAAAlO,IAAA,cAAAE,OAAAk9E,EAAAtyE,EAAAzL,IAAAA,MAED,SAAAs5F,EAAmBb,GAAkB,IAAAtqE,EAAA6lE,EAAAE,EAAAnzE,EAAAy3E,EAAAe,EAAA/vF,EAAAgwF,EAAAC,EAAAC,EAAAp4C,EAAAl1C,EAAAutF,EAAAC,EAAA,OAAA55F,IAAAA,MAAA,SAAA65F,GAAA,cAAAA,EAAAhyF,KAAAgyF,EAAAv0F,MAAA,OAEiB,GAD5C6oB,EAA4DnrB,KAA5DmrB,KAAM6lE,EAAsDhxF,KAAtDgxF,YAAaE,EAAyClxF,KAAzCkxF,WAA6BnzE,EAAY/d,KAA7BihE,mBACjCu0B,EAAgBx1F,KAAKw1F,cAAcC,IACvBlyF,OAAS61E,KAAmB8X,EAAWG,QAAO,CAAAwF,EAAAv0F,KAAA,SAKV,OAJ9CkE,EAAI4yE,GAAiBoc,EAAcjyF,OACnCizF,EAAWtF,EAAWE,QAAQ7tF,OAAS,EAAI2tF,EAAWE,QAAUJ,EAAYkC,QAC5EuD,EAAYD,EAASjzF,OAAS,EAAIizF,EAASA,EAASjzF,OAAS,GAAGuyF,GAAGgB,aAlnCtD,EAmnCbJ,EAAQF,EAASljF,QAAO,SAAC6/E,GAAW,OAAKA,EAAI2C,GAAGgB,cAAgBL,CAAS,IAAElzF,OAC3E+6C,EAASrzB,KAAMuzB,QAAQrzB,EAAK4rE,mBAAkBF,EAAAv0F,KAAA,GAClCtC,KAAK+xF,SAAS,kBAAmB,CAAEh0E,QAAAA,EAAS04E,UAAAA,EAAWjwF,EAAAA,EAAGkwF,MAAAA,IAAQ,QAC5E,GADFttF,EAAGytF,EAAA/0F,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFytF,EAAAv0F,KAAA,SACyB,OAApDqY,QAAQvZ,MAAM,6BAA8BgI,EAAIwE,KAAIipF,EAAA50F,OAAA,mBAGtDs0F,EAAAv2F,KAAKkxF,WAAWE,SAAQpuF,KAAI4F,MAAA2tF,EAAA7uF,EAAI0B,EAAI8pF,UACpCsC,EAAcxyF,KAAI4F,MAAlB4sF,EAAa9tF,EAAS0B,EAAI8pF,UACtB9pF,EAAI8pF,QAAQ3vF,OAASiD,IAAGxG,KAAKkxF,WAAWG,SAAU,GAAI,QAMX,GAH3CsF,EAAW3F,EAAYkC,QAAQ3vF,OAAS2tF,EAAWE,QAAQ7tF,OACjEsR,GAAIqf,OAAOyiE,GAAYvd,GAAgBjuD,EAAK6rE,yBAC5CniF,GAAIqf,OAAOyiE,EAAW,EAAGxrE,EAAK8rE,oBAC9BpiF,GAAIqf,OAAoB,IAAbyiE,EAAgBxrE,EAAK+rE,kBACH,IAAzB1B,EAAcjyF,OAAY,CAAAszF,EAAAv0F,KAAA,SAKQ,OAApCuS,GAAI2E,KAAK2R,EAAKy4D,uBAAsBiT,EAAA50F,OAAA,kBAGtCjC,KAAKm3F,kBAAkB1B,EAAYD,GACnCtE,EAAWC,OAASsE,EACdmB,EAAQnB,EAAarc,GAAiBoc,EAAcjyF,SAAWozF,EACrE9hF,GAAIqf,QAAQ0iE,IAAU1F,EAAWG,QAASlmE,EAAKy4D,uBAC/C/uE,GAAIqf,OAAOuhE,EAAa,EAAGtqE,EAAK24D,uBAAsB,yBAAA+S,EAAA7xF,OAAA,GAAAsxF,EAAA,UACvD,SAAA71C,GAAA,OAAAs6B,EAAAnyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,oBAAAE,OAAAi9E,EAAAryE,EAAAzL,IAAAA,MAED,SAAAo6F,IAAA,OAAAp6F,IAAAA,MAAA,SAAAq6F,GAAA,cAAAA,EAAAxyF,KAAAwyF,EAAA/0F,MAAA,OAC4C,OAA1CtC,KAAKqkF,SAASrkF,KAAKmrB,KAAK4rE,mBAAkBM,EAAA/0F,KAAA,EACpCtC,KAAKs3F,YAAYt3F,KAAKkxF,WAAWC,QAAO,wBAAAkG,EAAAryF,OAAA,GAAAoyF,EAAA,UAC/C,kBAAAtc,EAAAlyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,iBAAAE,OAAAg9E,EAAApyE,EAAAzL,IAAAA,MAED,SAAAu6F,IAAA,OAAAv6F,IAAAA,MAAA,SAAAw6F,GAAA,cAAAA,EAAA3yF,KAAA2yF,EAAAl1F,MAAA,cAAAk1F,EAAAl1F,KAAA,EACQtC,KAAKs3F,YAAYt3F,KAAKkxF,WAAWC,OAAS,GAAE,wBAAAqG,EAAAxyF,OAAA,GAAAuyF,EAAA,UACnD,kBAAA1c,EAAAjyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,iBAAAE,OAAA+8E,EAAAnyE,EAAAzL,IAAAA,MAED,SAAAy6F,IAAA,OAAAz6F,IAAAA,MAAA,SAAA06F,GAAA,cAAAA,EAAA7yF,KAAA6yF,EAAAp1F,MAAA,cAAAo1F,EAAAp1F,KAAA,EACQtC,KAAKs3F,YAAYt3F,KAAKkxF,WAAWC,OAAS,GAAE,wBAAAuG,EAAA1yF,OAAA,GAAAyyF,EAAA,UACnD,kBAAA7c,EAAAhyE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,qBAAAE,MAED,WAAsB,IAAA85F,EAAAn/D,EAAA,KACZrN,EAAgDnrB,KAAhDmrB,KAAM6lE,EAA0ChxF,KAA1CgxF,YAA8BjzE,EAAY/d,KAA7BihE,gBACrBxkD,EAAKwO,KAAMvW,SAASqJ,GAC1BlJ,GAAI2E,KAAK2R,EAAKysE,eACd,IAAMlC,EAAWhrD,GAAc3sB,GAASkN,KAAM6gB,KAAKD,KAG7Cm4C,EAAQ,eAAA6T,EAAApvF,EAAAzL,IAAAA,MAAG,SAAA86F,EAAOl7C,GAAQ,IAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA+6F,GAAA,cAAAA,EAAAlzF,KAAAkzF,EAAAz1F,MAAA,OAEe,OAD7CuS,GAAI2E,KAAK2R,EAAKysE,eACRt5C,EAASrzB,KAAMuzB,QAAQrzB,EAAK6sE,YAAWD,EAAAz1F,KAAA,EAC3Bk2B,EAAKu5D,SAAS,gBAAiBn1C,GAAI,OAC7C,GADFxzC,EAAG2uF,EAAAj2F,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF2uF,EAAAz1F,KAAA,SAEa,MADxCuS,GAAIyE,KAAK6R,EAAKysE,eACdzsE,EAAKysE,cAAcv4E,YAAcjW,EAAIwE,IAC/BpM,MAAM4H,EAAIwE,KAAI,yBAAAmqF,EAAA/yF,OAAA,GAAA8yF,EAAA,KAEvB,gBAVaG,GAAA,OAAAJ,EAAAjvF,MAAA,KAAAD,UAAA,KAYRuvF,EAAe,eAAAC,EAAA1vF,EAAAzL,IAAAA,MAAG,SAAAo7F,EAAOC,EAAkBC,GAAgB,IAAAj/B,EAAAD,EAAAm/B,EAAA,OAAAv7F,IAAAA,MAAA,SAAAw7F,GAAA,cAAAA,EAAA3zF,KAAA2zF,EAAAl2F,MAAA,cAAAk2F,EAAAl2F,KAAA,EACzD0hF,EAAS,CAAEjmE,QAAAA,EAAS06E,QAAO3uF,EAAA,GAAKuuF,EAAWC,KAAa,OAAAj/B,EAAAhuD,GACzC2lF,EAAYiB,QAAQC,SAAO,IAAhD,IAAA74B,EAAA9tD,MAAA6tD,EAAAC,EAAA7yD,KAAA9E,OAAW62F,EAAMn/B,EAAAv7D,OAA4CoX,KAAOojF,IAAUE,EAAOG,cAAgBJ,EAAQ,OAAA55F,GAAA26D,EAAAztD,EAAAlN,EAAA,SAAA26D,EAAAxtD,GAAA,yBAAA2sF,EAAAxzF,OAAA,GAAAozF,EAAA,KAC9G,gBAHoBO,EAAAC,GAAA,OAAAT,EAAAvvF,MAAA,KAAAD,UAAA,KAKrBkM,GAAImD,MAAMmT,EAAK0tE,eAAc,IACmB9+B,EADnBC,EAAA3uD,GACR2lF,EAAYiB,QAAQC,SAAO,QAAA4G,EAAA,WAAE,IAAvCP,EAAMx+B,EAAAl8D,MACTspC,EAAMhc,EAAKmyD,iBAAiB7xD,WAAU,GAC5CN,EAAK0tE,cAAcvgF,YAAY6uB,GAC/B,IAAMhnB,EAAOtL,GAAI6W,cAAcyb,GAC/BhnB,EAAK0L,YAAYxM,YAAck5E,EAAO1sE,YAAW,IACd+zC,EADcC,EAAAx0D,GAC5BktF,EAAOE,SAAO,QAAAM,EAAA,WAAE,IAA1BC,EAAMp5B,EAAA/hE,MACTspC,EAAMhc,EAAKkyD,iBAAiB5xD,WAAU,GAC5CtL,EAAKs4E,QAAQngF,YAAY6uB,GACzB,IA5Be57B,EA4BT0tF,EAAapkF,GAAI6W,cAAcyb,GACrC8xD,EAAWhkF,GAAGoK,aA7BC9T,EA6BuBytF,EAAO/jF,IA7BdnQ,OAAO,GAAGwa,cAAgB/T,EAAExG,MAAM,GA8BjEk0F,EAAWhkF,GAAGsJ,QAAQ4G,QAAU6zE,EAAOntE,YACvCotE,EAAWC,MAAMr7F,MAAQm7F,EAAO/jF,GAChCgkF,EAAWC,MAAMn1F,KAAOw0F,EAAOtjF,GAC/BJ,GAAI1K,KAAK8uF,EAAWC,MAAO,UAAU,WAC9BD,EAAWC,MAAMvgC,SACtBu/B,EAAgBK,EAAOtjF,GAAI+jF,EAAO/jF,GACpC,IACI+jF,EAAO/jF,KAAOsjF,EAAOG,gBAAeO,EAAWC,MAAMvgC,SAAU,EACrE,EAbA,IAAAkH,EAAAt0D,MAAAq0D,EAAAC,EAAAr5D,KAAA9E,MAAAq3F,GAaC,OAAAr6F,GAAAmhE,EAAAj0D,EAAAlN,EAAA,SAAAmhE,EAAAh0D,GAAA,CACDof,KAAM2oC,aAAazzC,EAAKs4E,QAC1B,EApBA,IAAAz+B,EAAAzuD,MAAAwuD,EAAAC,EAAAxzD,KAAA9E,MAAAo3F,GAoBC,OAAAp6F,GAAAs7D,EAAApuD,EAAAlN,EAAA,SAAAs7D,EAAAnuD,GAAA,CAED,IAAMstF,EAAa,eAAAC,EAAA3wF,EAAAzL,IAAAA,MAAG,SAAAq8F,EAAOC,EAAgBC,GAAgB,IAAAh/B,EAAAD,EAAAk/B,EAAA,OAAAx8F,IAAAA,MAAA,SAAAy8F,GAAA,cAAAA,EAAA50F,KAAA40F,EAAAn3F,MAAA,cAAAm3F,EAAAn3F,KAAA,EACrD0hF,EAAS,CAAEjmE,QAAAA,EAAS27E,aAAY5vF,EAAA,GAAKwvF,EAASC,KAAa,OAAAh/B,EAAAlvD,GAC5C2lF,EAAYiB,QAAQG,SAAO,IAAhD,IAAA73B,EAAAhvD,MAAA+uD,EAAAC,EAAA/zD,KAAA9E,OAAW83F,EAAMl/B,EAAAz8D,OAA4Cq4F,OAASoD,IAAQE,EAAOG,cAAgBJ,EAAQ,OAAA76F,GAAA67D,EAAA3uD,EAAAlN,EAAA,SAAA67D,EAAA1uD,GAAA,yBAAA4tF,EAAAz0F,OAAA,GAAAq0F,EAAA,KAC9G,gBAHkBO,EAAAC,GAAA,OAAAT,EAAAxwF,MAAA,KAAAD,UAAA,KAKnBkM,GAAImD,MAAMmT,EAAK2uE,eAAc,IACmBr/B,EADnBC,EAAArvD,GACR2lF,EAAYiB,QAAQG,SAAO,QAAA2H,EAAA,WAAE,IAAvCP,EAAM/+B,EAAA58D,MACTspC,EAAMhc,EAAKoyD,WAAW9xD,WAAU,GACtCN,EAAK2uE,cAAcxhF,YAAY6uB,GAC/Blc,KAAM8qE,gBAAgB5uD,GAEtB,IADA,IAAMhnB,EAAOtL,GAAI6W,cAAcyb,GAAI6yD,EAAA,WAC9B,IAAM1uE,EAAGykD,EAAAp4D,GACZ2T,EAAIvnB,KAAOy1F,EAAOtD,KACdsD,EAAOG,gBAAkBruE,EAAIztB,QAAOytB,EAAIqtC,SAAU,GACtD9jD,GAAI1K,KAAKmhB,EAAK,UAAU,WAAM,IAAA2uE,EACvB3uE,EAAIqtC,SACTwgC,EAAcK,EAAOtD,KAAe,QAAX+D,EAAE3uE,EAAIztB,aAAK,IAAAo8F,EAAAA,EAAI,GAC1C,GACF,EAPAtiF,EAAA,EAAAo4D,EAAkB,CAAC5vD,EAAK+5E,IAAK/5E,EAAKg6E,IAAGxiF,EAAAo4D,EAAAxsE,OAAAoU,IAAAqiF,IAQjCR,EAAO37F,MAAQ,EAAGsiB,EAAKtiB,MAAMwhB,YAAcxK,GAAIiJ,kBAAkB07E,EAAO37F,MAAQ4e,EAAG9H,aAAaC,kBAC/FC,GAAI2E,KAAK2G,EAAKtiB,OACnBsiB,EAAK+1E,KAAK72E,YAAcm6E,EAAOtD,KAC/B/1E,EAAKi6E,aAAa/D,aAAa,OAAQX,EAAS8D,EAAOtD,MACzD,EAjBA,IAAAx7B,EAAAnvD,MAAAkvD,EAAAC,EAAAl0D,KAAA9E,MAAAq4F,GAiBC,OAAAr7F,GAAAg8D,EAAA9uD,EAAAlN,EAAA,SAAAg8D,EAAA7uD,GAAA,CAED,IAAMwuF,EAAa,eAAAC,EAAA7xF,EAAAzL,IAAAA,MAAG,SAAAu9F,EAAO58F,EAAa68F,GAAc,IAAA5/B,EAAAD,EAAA8/B,EAAA,OAAAz9F,IAAAA,MAAA,SAAA09F,GAAA,cAAAA,EAAA71F,KAAA61F,EAAAp4F,MAAA,cAAAo4F,EAAAp4F,KAAA,EAChD0hF,EAAS,CAAEjmE,QAAAA,EAAS48E,eAAc7wF,EAAA,GAAKnM,EAAM68F,KAAW,OAAA5/B,EAAAvvD,GAC3C2lF,EAAYiB,QAAQ2I,cAAY,IAAnD,IAAAhgC,EAAArvD,MAAAovD,EAAAC,EAAAp0D,KAAA9E,OAAW+4F,EAAI9/B,EAAA98D,OAA+CF,MAAQA,IAAK88F,EAAKD,OAASA,EAAM,OAAA97F,GAAAk8D,EAAAhvD,EAAAlN,EAAA,SAAAk8D,EAAA/uD,GAAA,yBAAA6uF,EAAA11F,OAAA,GAAAu1F,EAAA,KAChG,gBAHkBM,EAAAC,GAAA,OAAAR,EAAA1xF,MAAA,KAAAD,UAAA,KAKnBkM,GAAImD,MAAMmT,EAAK4vE,aAAY,IACoCv7B,EADpCG,EAAAt0D,GAC8B,QAD9BssF,EACF3G,EAAYiB,QAAQ2I,oBAAY,IAAAjD,EAAAA,EAAI,IAAE,QAAAqD,EAAA,WAAG,IAAvDC,EAASz7B,EAAA3hE,MACZspC,EAAMhc,EAAKqyD,SAAS/xD,WAAU,GACpCN,EAAK4vE,YAAYziF,YAAY6uB,GAE7B,IADA,IAAMhnB,EAAOtL,GAAI6W,cAAcyb,GAAI+zD,EAAA,WAC9B,IAAM5vE,EAAG6vE,EAAA/iF,GACZkT,EAAIvnB,KAAOk3F,EAAUt9F,IACjBs9F,EAAUT,SAAWlvE,EAAIztB,QAAOytB,EAAIqtC,SAAU,GAClD9jD,GAAI1K,KAAKmhB,EAAK,UAAU,WAAM,IAAA8vE,EACvB9vE,EAAIqtC,SACT0hC,EAAcY,EAAUt9F,IAAc,QAAXy9F,EAAE9vE,EAAIztB,aAAK,IAAAu9F,EAAAA,EAAI,GAC5C,GACF,EAPAhjF,EAAA,EAAA+iF,EAAkB,CAACh7E,EAAK+5E,IAAK/5E,EAAKg6E,IAAG/hF,EAAA+iF,EAAA53F,OAAA6U,IAAA8iF,IAQrC/6E,EAAKxiB,IAAI0hB,YAAc47E,EAAUt9F,GACnC,EAbA,IAAAgiE,EAAAp0D,MAAAi0D,EAAAG,EAAAn5D,KAAA9E,MAAAs5F,GAaC,OAAAt8F,GAAAihE,EAAA/zD,EAAAlN,EAAA,SAAAihE,EAAA9zD,GAAA,CAED7L,KAAKqkF,SAASl5D,EAAK6sE,WACrB,GAAC,CAAAr6F,IAAA,gBAAAE,OAAA88E,EAAAlyE,EAAAzL,IAAAA,MAED,SAAAq+F,EAAqBt9E,GAAe,IAAAu9E,EAAAC,EAAAn2E,EAAA+F,EAAA/hB,EAAA,OAAApM,IAAAA,MAAA,SAAAw+F,GAAA,cAAAA,EAAA32F,KAAA22F,EAAAl5F,MAAA,OAOlC,GANMi5F,EAA+C,QAAjCD,EAAGrwE,KAAMgtC,gBAAgBl6C,UAAQ,IAAAu9E,OAAA,EAA9BA,EAAgCC,eACvDv7F,KAAKy7F,QAAS,EACNr2E,EAAW6F,KAAMoW,OAAOtjB,GAAxBqH,OACF+F,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKuwE,UAAWvwE,EAAKwwE,SAAUxwE,EAAKywE,UAGzCL,GAAmBn2E,SAAAA,EAAQE,SAAYF,EAAO+vB,OAASwjC,GAAsB,CAAA6iB,EAAAl5F,KAAA,eAAAk5F,EAAAv5F,OAAA,iBACtC,OAA3C4S,GAAIyE,KAAK6R,EAAKuwE,UAAWvwE,EAAK0wE,cAAaL,EAAAl5F,KAAA,GACzBtC,KAAK+xF,SAAS,mBAAoB,CAAEh0E,QAAAA,IAAU,QACrC,GADrB3U,EAAGoyF,EAAA15F,KACT+S,GAAI2E,KAAK2R,EAAK0wE,cACT5wE,KAAM6mC,cAAc1oD,GAAM,CAAFoyF,EAAAl5F,KAAA,SAES,OADpCuS,GAAIyE,KAAK6R,EAAK+1D,WACd/1D,EAAK+1D,UAAU7hE,YAAcjW,EAAIwE,IAAG4tF,EAAAv5F,OAAA,kBAItCjC,KAAKy7F,OAASryF,EAAI64C,MAAM65C,QACpB97F,KAAKy7F,OAAQ5mF,GAAIyE,KAAK6R,EAAKywE,SAC1B/mF,GAAIyE,KAAK6R,EAAKwwE,UACnB37F,KAAKghF,YAAYt6D,SAAS1mB,KAAKy7F,QAAO,yBAAAD,EAAAx2F,OAAA,GAAAq2F,EAAA,UACvC,SAAAU,GAAA,OAAAphB,EAAA/xE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,OAAA68E,EAAAjyE,EAAAzL,IAAAA,MAED,SAAAg/F,EAAwBjwE,GAAW,IAAAZ,EAAAmzB,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAi/F,GAAA,cAAAA,EAAAp3F,KAAAo3F,EAAA35F,MAAA,OAGW,OAFtC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK+1D,WACR5iC,EAASrzB,KAAMuzB,QAAQrzB,EAAKuwE,WAAUO,EAAA35F,KAAA,EAC1BuL,EAAS,sBAAuB,CAAEkQ,QAAS/d,KAAKihE,gBAAiB66B,QAAS/vE,IAAK,OACzF,GADF3iB,EAAG6yF,EAAAn6F,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF6yF,EAAA35F,KAAA,SAEH,OADxB6oB,EAAK+1D,UAAU7hE,YAAc9C,GAAUA,EAAmB,CAAE3O,IAAKxE,EAAIwE,MACrEiH,GAAIyE,KAAK6R,EAAK+1D,WAAU+a,EAAAh6F,OAAA,kBAG1B4S,GAAIqf,OAAOnI,EAAIZ,EAAKywE,SACpB/mF,GAAIqf,QAAQnI,EAAIZ,EAAKwwE,UACrB37F,KAAKghF,YAAYt6D,SAASqF,GAAG,yBAAAkwE,EAAAj3F,OAAA,GAAAg3F,EAAA,UAC9B,SAAAE,GAAA,OAAAxhB,EAAA9xE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,8BAAAE,MAED,WAAqC,IAAAs+F,EAAAC,EAAAC,EAC7BlxE,EAAOnrB,KAAKmrB,KACZlM,EAAQgM,KAAMoW,OAAOrhC,KAAKihE,iBACxB77C,EAAsCnG,EAAtCmG,OAAkB3I,EAAoBwC,EAA9BvK,SAAkBqJ,EAAYkB,EAAhBhK,GACxBovD,EAAMj/C,EAAOozB,QACnB3jC,GAAIyE,KAAK6R,EAAK85C,WAAY95C,EAAK0iE,eAC/B,IAAMyO,EAAcj4B,EAAIx/C,OAASw/C,EAAIk4B,eAAiBl4B,EAAIjC,WACpDirB,EAAehpB,EAAIr0B,UAAYssD,EAAcj4B,EAAImoB,SACvDrhE,EAAKqtB,QAAQn5B,YAAcxK,GAAIkc,gBAAgBs8D,EAAc5wE,GAC7D0O,EAAKqxE,YAAYn9E,YAAc5C,EAAG9H,aAAamI,KAC/C,IAAMR,EAAO2O,KAAMymB,aAAa3zB,GAC5BzB,IACFzH,GAAIyE,KAAK6R,EAAKyiE,gBACdziE,EAAKsxE,YAAYp9E,YAAcxK,GAAIyN,qBAAqB+qE,EAAc/wE,EAAMG,IAE9E5H,GAAImD,MAAMmT,EAAKuxE,kBAEf,IAaIC,EACAC,EAdEC,EAAgB,SAACC,EAAaz4B,EAAa04B,GAC/C,IAAMz1C,EAAMn8B,EAAK8xD,iBAAiBxxD,WAAU,GAC5CN,EAAKuxE,iBAAiBpkF,YAAYgvC,GAClC,IAAMnnC,EAAOtL,GAAI6W,cAAc47B,GAO/B,OANAnnC,EAAKpc,KAAKsb,YAAcy9E,EACpBC,IACF58E,EAAK48E,WAAWx+E,QAAQ4G,QAAU43E,EAClCloF,GAAIyE,KAAK6G,EAAK48E,aAEhB58E,EAAKq4B,QAAQn5B,YAAcxK,GAAIkc,gBAAgBszC,EAAK5nD,GAC7C6qC,CACT,EAIM01C,EAAoB,SAACF,EAAaz4B,EAAa04B,GACnDJ,OAAmBl7F,EACnBm7F,EAAiBC,EAAcC,EAAKz4B,EAAK04B,EAC3C,EACME,EAAgB,SAACH,EAAaz4B,EAAa04B,IAC/CJ,EAAmBE,EAAcC,EAAKz4B,EAAK04B,IAC1BpkF,UAAUC,IAAI,MACjC,EACMskF,EAAgB,WACfP,IACJC,EAA+BjkF,UAAUC,IAAI,YAC9C+jF,EAAiBhkF,UAAUC,IAAI,QACjC,EAGA,GADAokF,EAAkBzgF,Gb74CY,mBa64CwB8nD,EAAIr0B,UAAW,SACzCvuC,KAAf,QAAT06F,EAAA93B,EAAI84B,aAAK,IAAAhB,OAAA,EAATA,EAAWiB,UAAwB,CACrC,IAAMC,EAAch5B,EAAIr0B,UAAYq0B,EAAI84B,MAAMC,SAAStiD,IACvDmiD,EAAc1gF,Gbl4CU,eak4CsB8gF,GAC9CJ,EAAc1gF,Gbp4CO,Yao4CsB8nD,EAAI84B,MAAMC,SAAStiD,IAChE,CACAoiD,IAEAF,EAAkBzgF,Gbp5CS,gBao5CwB+/E,EAAa//E,Gbh5CnC,mBai5CzB8nD,EAAIi5B,YAAc,GAAGL,EAAc1gF,Gbt4CnB,Sas4C6C8nD,EAAIi5B,YAAa/gF,Gbr4C/C,yBas4C/B8nD,EAAIk4B,eAAiB,GAAGU,EAAc1gF,Gbp5CnB,Yao5CgD8nD,EAAIk4B,eAAgBhgF,Gbh5CrD,4Bai5ClC8nD,EAAIjC,WAAa,GAAG66B,EAAc1gF,Gbp5CjB,Uao5C4C8nD,EAAIjC,WAAY7lD,Gbh5C/C,wBai5C9B8nD,EAAIhC,aAAe,GAAG46B,EAAc1gF,Gb94CZ,iBa84C8C8nD,EAAIhC,aAAc9lD,Gb74C5D,2Ba84CL9a,KAAvB4iE,SAAU,QAAP+3B,EAAH/3B,EAAK84B,aAAK,IAAAf,OAAP,EAAHA,EAAYmB,SAAsBN,EAAc,SAAU54B,EAAI84B,MAAMI,OAAOziD,KAC/EoiD,IAEI74B,EAAImoB,UAAUwQ,EAAkBzgF,Gb35CP,kBa25C0C8nD,EAAImoB,SAAUjwE,Gbv5CtD,0Baw5CH9a,KAAxB4iE,SAAU,QAAPg4B,EAAHh4B,EAAK84B,aAAK,IAAAd,OAAP,EAAHA,EAAYmB,UAAuBP,EAAc,UAAW54B,EAAI84B,MAAMK,QAAQ1iD,KAClFoiD,IAKA/xE,EAAKonE,aAAalzE,YAAcxK,GAAIiJ,kBAAkBumD,EAAIr0B,UAAYvzB,EAAG9H,aAAaC,kBACtFqW,KAAM2oC,aAAazoC,EAAKuxE,iBAC1B,GAAC,CAAA/+F,IAAA,uBAAAE,MAED,SAAsBkgB,GAIpB,IAHA,IAAMoN,EAAOnrB,KAAKmrB,KACZqc,EAAYvc,KAAM6gB,KAAKtE,UACvByO,EAAwC,GAC9Cx9B,EAAA,EAAAk1B,EAAiBtwC,OAAO+C,OAAOonC,GAAU/uB,EAAAk1B,EAAApqC,OAAAkV,IAAE,CAAtC,IAAMwiD,EAAEttB,EAAAl1B,GACX,GAAKwiD,EAAGhlB,QACR,IAAK,IAALl9B,EAAA,EAAA6nD,EAAkBvjE,OAAO+C,OAAO66D,EAAGhlB,SAAQl9B,EAAA6nD,EAAAr9D,OAAAwV,IAAE,CAAxC,IAAMiwB,EAAG43B,EAAA7nD,GACRiwB,EAAI1H,SAAWvjB,GAAWirB,EAAIu2B,UAAYxhD,GAASk4B,EAAQjzC,KAAK,CAACi4D,EAAG3zB,KAAM2zB,EAAIjyB,GACpF,CACF,CAEA,IAAMy0D,EAAa,SAAC1/E,EAAiBirB,GACnC,IAAMG,EAAOH,EAAIG,KACjB,IAAKA,EAAM,OAAO,EAClB,IAAMv0B,EAAmBqW,KAAMvW,SAASqJ,GAASpJ,aAAaC,iBAE9D,OADemJ,IAAYirB,EAAI1H,OAAS6H,EAAKu0D,MAAQv0D,EAAKu0D,MAAQv0D,EAAK7sB,KAAOs1B,IAC9Dh9B,CAClB,EAEAqhC,EAAQxb,MAAK,SAAC9zB,EAA+ByT,GAC3C,IAAAujF,EAAA/1F,EAAuBjB,EAAC,GAAjBi3F,EAAKD,EAAA,GAAGE,EAAIF,EAAA,GACnBG,EAAAl2F,EAAuBwS,EAAC,GAAjB2jF,EAAKD,EAAA,GAAGE,EAAIF,EAAA,GACnB,OAAKD,EAAK10D,MAAS60D,EAAK70D,KACjBs0D,EAAW1/E,EAASigF,GAAQP,EAAW1/E,EAAS8/E,GADlBD,EAAMlR,cAAcqR,EAE3D,IACAlpF,GAAImD,MAAMmT,EAAK8yE,kBAEf,IAFgC,IAAAC,EAAA,WAE3B,IAAAC,EAAAv2F,EAAAw2F,EAAA/gF,GAAA,GAAOiqB,EAAI62D,EAAA,GAAEljC,EAAEkjC,EAAA,GAAEn1D,EAAGm1D,EAAA,GACfh1D,EAAmDH,EAAnDG,KAAM7H,EAA6C0H,EAA7C1H,OAAQC,EAAqCyH,EAArCzH,WAAYg+B,EAAyBv2B,EAAzBu2B,QAAS8+B,EAAgBr1D,EAAhBq1D,YACrC/2C,EAAMn8B,EAAKmzE,UAAU7yE,WAAU,GACrCN,EAAK8yE,iBAAiB3lF,YAAYgvC,GAClC,IAAMnnC,EAAOtL,GAAI6W,cAAc47B,GAQ/B,GAPAnnC,EAAKmnB,KAAKjoB,YAAcioB,EACxBnnB,EAAK2/C,SAASrgD,IAAM5K,GAAImK,SAASuiB,GACjCphB,EAAK4/C,UAAUtgD,IAAM5K,GAAImK,SAASq/E,GAClCxpF,GAAImD,MAAMmI,EAAKmwB,WAAYnwB,EAAK4wB,aAChC5wB,EAAKmwB,WAAWh4B,YAAYzD,GAAI2vD,UAAUvJ,EAAG55B,OAAOC,IAAS,IAC7DnhB,EAAK4wB,YAAYz4B,YAAYzD,GAAI2vD,UAAUvJ,EAAG55B,OAAOk+B,IAAU,IAE3Dp2B,EAAM,CACR,IAAMxtB,EAAWsP,KAAM+F,iBAAiBsQ,EAAQi+B,EAASp2B,EAAK7sB,KAAMkrB,EAAUF,IAC9EnnB,EAAK61E,MAAM32E,YAAcxK,GAAIiJ,kBAAkBnC,GAC/C,IAAM4iF,EAAY,SAAChzF,GAAS,OAAKA,EAAED,MAAM,KAAK,GAAGgU,aAAa,EAC9Da,EAAKq+E,eAAen/E,YAAck/E,EAAUF,GAC5Cl+E,EAAKs+E,cAAcp/E,YAAck/E,EAAUh9D,GAC3CphB,EAAKoe,OAAOlf,YAAcxK,GAAIiJ,kBAAkB2/E,EAAW1/E,EAASirB,IACpE7oB,EAAKu+E,WAAWr/E,YAAmCk/E,EAArBxgF,IAAYujB,EAAmBC,EAAwB88D,EACvF,MAAOxpF,GAAI2E,KAAK2G,EAAKw+E,SAAUx+E,EAAKy+E,WACpC/pF,GAAI1K,KAAKm9C,EAAK,SAAS,kBAAMr8B,KAAM2yB,SAAS,UAAW,CAAEtW,KAAAA,EAAMrW,OAAQqQ,EAAQpQ,QAASquC,GAAU,GACpG,EAtBAliD,EAAA,EAAA+gF,EAA8BnoD,EAAO54B,EAAA+gF,EAAA76F,OAAA8Z,IAAA6gF,IAuBrC/yE,EAAK0zE,mBAAmBlmF,UAAUM,OAAO,YAC3C,GAAC,CAAAtb,IAAA,qBAAAE,OAAA48E,EAAAhyE,EAAAzL,IAAAA,MAED,SAAA8hG,EAA0B/gF,GAAe,IAAAoN,EAAAmzB,EAAAhrC,EAAAlK,EAAA4Y,EAAA+8E,EAAA51E,EAAAm+B,EAAAnnC,EAAA3Y,EAAAw3F,EAAAC,EAAAzgF,EAAAC,EAAAygF,EAAAC,EAAA,OAAAniG,IAAAA,MAAA,SAAAoiG,GAAA,cAAAA,EAAAv6F,KAAAu6F,EAAA98F,MAAA,OAQtC,OAPK6oB,EAAOnrB,KAAKmrB,KACZmzB,EAASrzB,KAAMuzB,QAAQrzB,EAAKk0E,kBAC5B/rF,EAAsB,CAC1B9M,EAAG,GACH66B,OAAQ,CAACtjB,GACTuhF,MAAO,GACP/qD,SAAU,IACX6qD,EAAA98F,KAAA,EACiBuL,EAAS,cAAeyF,GAAO,OAEJ,GAFvClK,EAAGg2F,EAAAt9F,KACTw8C,IACAzpC,GAAI2E,KAAK2R,EAAKo0E,WAAYp0E,EAAKq0E,eAC1Bp2F,EAAIijD,QAAgC,IAAtBjjD,EAAIijD,OAAO9oD,OAAY,CAAA67F,EAAA98F,KAAA,SAEW,OADnDuS,GAAIyE,KAAK6R,EAAKo0E,YACdp0E,EAAKk0E,iBAAiB1mF,UAAUM,OAAO,aAAYmmF,EAAAn9F,OAAA,kBAKrD,IAFA4S,GAAIyE,KAAK6R,EAAKq0E,eACd3qF,GAAImD,MAAMmT,EAAKs0E,cACfz9E,EAAA,EAAA+8E,EAAmB31F,EAAIijD,OAAMrqC,EAAA+8E,EAAAx7F,OAAAye,IAAlBmH,EAAG41E,EAAA/8E,GACNslC,EAAMn8B,EAAK+xD,gBAAgBzxD,WAAU,GAC3CN,EAAKs0E,aAAannF,YAAYgvC,GACxBnnC,EAAOtL,GAAI6W,cAAc47B,GAC3B9/C,OAAoB,EAAEw3F,OAAkB,EAAAC,EACN,CAACh0E,KAAMvW,SAASyU,EAAI8H,QAAShG,KAAMvW,SAASyU,EAAI+H,UAA/E1S,EAAYygF,EAAA,GAAExgF,EAAawgF,EAAA,GAC9B91E,EAAIsG,MAAMyvE,EACC,CAACj0E,KAAMoW,OAAOlY,EAAI8H,QAAShG,KAAMoW,OAAOlY,EAAI+H,UAAxD1pB,EAAI03F,EAAA,GAAEF,EAAEE,EAAA,GACT/+E,EAAKu/E,QAAQrgF,YAAcxK,GAAIkc,gBAAgB5H,EAAIoH,IAAK/R,GRlmD3C,IQmmDT2K,EAAIzpB,OACNygB,EAAKw/E,MAAMtgF,YAAcxK,GAAIkc,gBAAgB5H,EAAIoH,IAAMqhB,GAA+BzoB,EAAI7M,KAAMmC,MAE7F0gF,EACQ,CAACl0E,KAAMoW,OAAOlY,EAAI+H,SAAUjG,KAAMoW,OAAOlY,EAAI8H,SAAzDzpB,EAAI23F,EAAA,GAAEH,EAAEG,EAAA,GRtmDK,IQumDVh2E,EAAIzpB,KACNygB,EAAKu/E,QAAQrgF,YAAcxK,GAAIkc,gBAAgB5H,EAAIoH,IAAK/R,IAExD2B,EAAKu/E,QAAQrgF,YAAcxK,GAAIkc,gBAAgB5H,EAAIoH,IAAMqhB,GAA+BzoB,EAAI7M,KAAMmC,GAClG0B,EAAKw/E,MAAMtgF,YAAcxK,GAAIkc,gBAAgB5H,EAAIoH,IAAK/R,KAI1D2B,EAAKy/E,SAASngF,IAAM5K,GAAImK,SAASxX,EAAKmX,QACtC9J,GAAImD,MAAMmI,EAAK0/E,WAAY1/E,EAAK2/E,UAChC3/E,EAAK0/E,WAAWvnF,YAAYzD,GAAI2vD,UAAUh9D,GAAM,IAChD2Y,EAAK4/E,OAAOtgF,IAAM5K,GAAImK,SAASggF,EAAGrgF,QAClCwB,EAAK2/E,SAASxnF,YAAYzD,GAAI2vD,UAAUw6B,GAAI,IAC5C7+E,EAAK5S,OAAO8R,YAAcuyB,GAAuBzoB,GACjDhJ,EAAKmQ,OAAOjR,YAAc,GAAHtT,QAAO6lC,GAAiBzoB,GAAOA,EAAIoH,IAAM,KAAK7K,QAAQ,GAAE,KAC/EvF,EAAKsmE,IAAIpnE,YAAcxK,GAAI2nE,UAAUrzD,EAAI62E,YACzC7/E,EAAKyrB,KAAKO,KAAO,SAAHpgC,OAAYod,EAAIlU,IAC9BgW,KAAMg1E,uBAAuB34C,GAE/Bn8B,EAAKk0E,iBAAiB1mF,UAAUM,OAAO,aAAY,yBAAAmmF,EAAAp6F,OAAA,GAAA85F,EAAA,UACpD,SAAAoB,GAAA,OAAAzlB,EAAA7xE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,qBAAAE,MAED,SAAoBypD,EAAkBwuC,EAAuB/3E,GAC3D,IAAMoC,EAAOtL,GAAI6W,cAAc47B,GAC3B64C,EAAapiF,EACbqiF,EAAcriF,EAClB,GAAI+3E,EAAGuK,QAEL,GADAF,EAAarK,EAAGuK,QACZtiF,IAAY+3E,EAAGuK,QAASD,EAAcriF,MACrC,CACH,IAAMkB,EAAQgM,KAAMoW,OAAOtjB,GACvBkB,EAAM+sB,MAAOo0D,EAAcnhF,EAAM+sB,MAAMC,SACtCtxB,QAAQvZ,MAAM,wCAAD2K,OAAyC+pF,EAAG7gF,IAChE,CAEF,IAAMqrF,EAAar1E,KAAMvW,SAASyrF,GAC5BI,EAAct1E,KAAMvW,SAAS0rF,GACnCjgF,EAAKsmE,IAAIpnE,YAAcxK,GAAI2nE,UAAyB,IAAfsZ,EAAGpP,WACxCvmE,EAAKsmE,IAAIloE,QAAQmoE,UAAYp9E,OAAsB,IAAfwsF,EAAGpP,WACvC7xE,GAAIqf,OAAwB,IAAjB4hE,EAAGpP,UAAiBvmE,EAAK0iC,SACpChuC,GAAIqf,OAAwB,IAAjB4hE,EAAGpP,UAAiBvmE,EAAKsmE,KAChCqP,EAAGpP,UAAY,IAAGvmE,EAAKsmE,IAAIloE,QAAQ0nC,MAAQ38C,OAAOwsF,EAAGpP,YACzD,IAAIzN,EAASE,GAAa2c,EAAGp2F,MAC7B,GAAIo2F,EAAGuK,SAAWvK,EAAGuK,UAAYtiF,EAAS,CACxC,IACMu1D,EADaroD,KAAMoW,OAAOy0D,EAAGuK,SACJ3rF,SAASC,aAAamI,KACrDm8D,EAAS,GAAHltE,OAAMunE,EAAW,KAAAvnE,OAAIktE,EAC7B,CAKA,GAJA94D,EAAKzgB,KAAK2f,YAAc45D,EACxB94D,EAAKlL,GAAGoK,YAAcmhF,GAAuB1K,EAAG7gF,GAAI,IACpDkL,EAAKlL,GAAGohF,aAAa,QAASP,EAAG7gF,IACjCkL,EAAK85B,KAAK56B,YAAcxK,GAAIkc,gBAAgB+kE,EAAG77C,KAAMsmD,GACjDxnB,GAAa3wB,SAAS0tC,EAAGp2F,MAC3BygB,EAAKkC,OAAOhD,YAAc,QACrB,CACL,IAA0CohF,EAAA74F,EAA3BoxE,GAAmB8c,EAAGp2F,MAAK,GAAnC01B,EAACqrE,EAAA,GAAEvgE,EAACugE,EAAA,GACL3lD,EAAMjmC,GAAIkc,gBAAgB+kE,EAAGzzE,OAAQi+E,GAC3CngF,EAAKkC,OAAOhD,YAAc,GAAHtT,OAAMqpB,GAACrpB,OAAG+uC,GACvB,KAAN5a,GAAU/f,EAAKkC,OAAO1J,UAAUC,IAAIsnB,EAC1C,CACF,GAAC,CAAAviC,IAAA,eAAAE,MAED,SAAci4F,EAAuB/3E,GAA+B,IAAAkc,EAAA,KAC5DqtB,EAAMtnD,KAAKmrB,KAAKsyD,iBAAiBhyD,WAAU,GACjD67B,EAAI/oC,QAAQqsB,KAAOkrD,EAAG7gF,GACtBJ,GAAI1K,KAAKm9C,EAAK,SAAS,kBAAMrtB,EAAKymE,mBAAmB5K,EAAG7gF,GAAG,IAC3DjV,KAAK2gG,mBAAmBr5C,EAAKwuC,EAAI/3E,GACjC,IAAMoC,EAAOtL,GAAI6W,cAAc47B,GAE/B,OADAtnD,KAAKs8E,SAASt5E,KAAKmd,EAAKsmE,KACjBn/B,CACT,GAAC,CAAA3pD,IAAA,mBAAAE,MAED,SAAkBk7D,GAChB,IAAMzR,EAAMtnD,KAAKmrB,KAAKuyD,qBAAqBjyD,WAAU,GAGrD,OAFa5W,GAAI6W,cAAc47B,GAC1ByR,KAAK15C,YAAc05C,EACjBzR,CACT,GAAC,CAAA3pD,IAAA,4BAAAE,MAED,SAA2Bi4F,GACzB,IAAM3qE,EAAOnrB,KAAKmrB,KAGZ4gB,EAAgBrB,GAAc1qC,KAAKihE,iBACrCl1B,GAAiBA,EAAcF,MACjC1gB,EAAKy1E,oBAAoBz0D,KAAOJ,EAAcF,IAAKiqD,EAAG7gF,KAIxD,IAAIgkE,EAASE,GAAa2c,EAAGp2F,MAC7B,GAAIo2F,EAAGuK,SAAWvK,EAAGuK,UAAYrgG,KAAKihE,gBAAiB,CACrD,IAAMqS,EAAcroD,KAAMoW,OAAOy0D,EAAGuK,SAAS1hF,OAAOrT,MAAM,KAAK,GAAGgU,cAClE25D,EAAS,GAAHltE,OAAMunE,EAAW,KAAAvnE,OAAIktE,EAC7B,CAMA,GALA9tD,EAAK01E,cAAcxhF,YAAc45D,EACjCpkE,GAAIqf,OAjmDwB,KAimDjB4hE,EAAGp2F,KAA2ByrB,EAAK21E,eAC9C31E,EAAK21E,cAAcviF,QAAQ4G,QAAU5I,Gb9hDF,wBaiiD/Bw8D,GAAa3wB,SAAS0tC,EAAGp2F,MAC3BmV,GAAI2E,KAAK2R,EAAK41E,yBACT,CACL,IAAIhjF,EAAU/d,KAAKihE,gBACf60B,EAAGuK,UAAStiF,EAAU+3E,EAAGuK,SAC7BxrF,GAAIyE,KAAK6R,EAAK41E,qBACd,IAAMtkF,EAAKwO,KAAMvW,SAASqJ,GACpB+8B,EAAMjmC,GAAIkc,gBAAgB+kE,EAAGzzE,OAAQ5F,GACDukF,EAAAp5F,EAA3BoxE,GAAmB8c,EAAGp2F,MAAK,GAAnC6L,EAACy1F,EAAA,GAAE9gE,EAAC8gE,EAAA,GACX71E,EAAK81E,gBAAgB5hF,YAAc,GAAHtT,OAAMR,GAACQ,OAAG+uC,EAAG,KAAA/uC,OAAI0Q,EAAG9H,aAAamI,MACvD,KAANojB,GAAU/U,EAAK81E,gBAAgBtoF,UAAUC,IAAIsnB,EACnD,CAGA,IAAIghE,EAAWlhG,KAAKihE,gBACpB,QAAmBx/D,IAAfq0F,EAAGuK,QAAuB,CAC5B,IAAMphF,EAAQgM,KAAMoW,OAAOy0D,EAAGuK,SAC1BphF,EAAM+sB,MACRk1D,EAAWjiF,EAAM+sB,MAAMC,SAEvBtxB,QAAQvZ,MAAM,sBAAD2K,OAAuB+pF,EAAG7gF,GAAE,6CAAAlJ,OAA4C+pF,EAAGuK,QAAO,mBAEnG,CACA,IAAMrZ,EAAQ/7D,KAAMvW,SAASwsF,GACvB/6B,EAAMtxD,GAAIkc,gBAAgB+kE,EAAG77C,KAAM+sC,GACzC77D,EAAKg2E,aAAa9hF,YAAc,GAAHtT,OAAMo6D,EAAG,KAAAp6D,OAAIi7E,EAAMryE,aAAamI,MAG7DqO,EAAKi2E,qBAAqB/hF,YAAc,GAAHtT,OAAM+pF,EAAGuL,aAC9C,IAAMtoC,EAAO,IAAInuD,KAAoB,IAAfkrF,EAAGpP,WACnB4a,EAAUvoC,EAAKwoC,qBACfC,EAAUzoC,EAAK0oC,qBAmBrB,GAlBAt2E,EAAKu2E,mBAAmBriF,YAAc,GAAHtT,OAAMu1F,EAAO,KAAAv1F,OAAIy1F,GACpD3sF,GAAIqf,OAA0B,IAAnB4hE,EAAGuL,YAAmBl2E,EAAKw2E,iBAAkBx2E,EAAKy2E,oBAC7D/sF,GAAIqf,OAA0B,IAAnB4hE,EAAGuL,YAAmBl2E,EAAKi2E,qBAAsBj2E,EAAKu2E,oBAGjEv2E,EAAK4zD,YAAY1/D,YAAcmhF,GAAuB1K,EAAG7gF,GAAI,IAC7DkW,EAAK4zD,YAAYsX,aAAa,QAASP,EAAG7gF,IAGtC6gF,EAAG5W,WACLrqE,GAAIyE,KAAK6R,EAAK02E,2BACd12E,EAAKg0D,mBAAmB9/D,YAAcmhF,GAAuB1K,EAAG5W,UAAW,IAC3E/zD,EAAKg0D,mBAAmBkX,aAAa,QAASP,EAAG5W,YAEjDrqE,GAAI2E,KAAK2R,EAAK02E,2BAIZ/L,EAAGvW,SAAU,CACf1qE,GAAIyE,KAAK6R,EAAK22E,uBAAwB32E,EAAK42E,8BAC3CltF,GAAIqf,OAAiC,KAA1B4hE,EAAGvW,SAASM,UAAkB10D,EAAK62E,+BAC9C72E,EAAKs0D,gBAAgBpgE,YAAcmhF,GAAuB1K,EAAGvW,SAASC,OAAQ,IAC9Er0D,EAAKs0D,gBAAgB4W,aAAa,QAASP,EAAGvW,SAASC,QACvD,IAAMzmB,EAAO,IAAInuD,KAA4B,IAAvBkrF,EAAGvW,SAAS0iB,UAC5BX,EAAUvoC,EAAKwoC,qBACfC,EAAUzoC,EAAK0oC,qBACrBt2E,EAAK+2E,sBAAsB7iF,YAAc,GAAHtT,OAAMu1F,EAAO,KAAAv1F,OAAIy1F,GACvDr2E,EAAK20D,uBAAuBzgE,YAAcmhF,GAAuB1K,EAAGvW,SAASM,UAAW,IACxF10D,EAAK20D,uBAAuBuW,aAAa,QAASP,EAAGvW,SAASM,UAChE,MACEhrE,GAAI2E,KAAK2R,EAAK22E,uBAAwB32E,EAAK42E,6BAA8B52E,EAAK62E,+BAI5ElM,EAAGqM,gBAAkBrM,EAAGqM,eAAeC,OACzCvtF,GAAIyE,KAAK6R,EAAKk3E,uBACdl3E,EAAKm3E,eAAejjF,YAAc,GAAHtT,OAAM+pF,EAAGqM,eAAeC,QAEvDvtF,GAAI2E,KAAK2R,EAAKk3E,sBAElB,GAAC,CAAA1kG,IAAA,qBAAAE,MAED,SAAoBoX,GAClB,IAAM6gF,EAAK7qE,KAAMs3E,YAAYviG,KAAKihE,gBAAiBhsD,GAC9C6gF,GAIL91F,KAAK8+E,OAASgX,EACd91F,KAAKwiG,0BAA0B1M,GAC/B91F,KAAKqkF,SAASrkF,KAAKmrB,KAAKs3E,YALtB9nF,QAAQvZ,MAAM,sBAAD2K,OAAuBkJ,EAAE,cAM1C,GAAC,CAAAtX,IAAA,2BAAAE,MAED,WACE,OAAImC,KAAKmrB,KAAKq7D,mBAAmB9rE,SAASnX,QAAU,GACrCsR,GAAI6W,cAAc1rB,KAAKmrB,KAAKq7D,mBAAmB9rE,SAAS,IACzDq+C,KAAK15C,aAEZ,EACT,GAAC,CAAA1hB,IAAA,SAAAE,MAED,SAAQi4F,GACN,OAAqB,IAAjBA,EAAGpP,WACG,IAAI97E,MAAQ22F,qBAEd,IAAI32F,KAAoB,IAAfkrF,EAAGpP,WAAmB6a,oBACzC,GAAC,CAAA5jG,IAAA,eAAAE,MAED,SAAci4F,EAAuB4M,GAAgB,IAAAC,EAGnD,KAFU13E,KAAMoW,OAAOrhC,KAAKihE,iBAAiB77C,OACvB+vB,OAASwjC,IAA4B34E,KAAKmrB,KAAKy3E,WAAWjqC,UA1sDxD,KA2sDNm9B,EAAGp2F,KACrB,GAAIgjG,EACG1iG,KAAK6iG,SAMC7iG,KAAK8iG,OAAOhN,KAAQ91F,KAAK+iG,4BAClC/iG,KAAKmrB,KAAKq7D,mBAAmBwc,aAAahjG,KAAKijG,aAAanN,EAAI91F,KAAKihE,iBAAkBjhE,KAAKmrB,KAAKq7D,mBAAmB9rE,SAAS,IAC7H1a,KAAKmrB,KAAKq7D,mBAAmBwc,aAAahjG,KAAKkjG,iBAAiBljG,KAAK8iG,OAAOhN,IAAM91F,KAAKmrB,KAAKq7D,mBAAmB9rE,SAAS,KAExH1a,KAAKmrB,KAAKq7D,mBAAmBwc,aAAahjG,KAAKijG,aAAanN,EAAI91F,KAAKihE,iBAAkBjhE,KAAKmrB,KAAKq7D,mBAAmB9rE,SAAS,KAT7H7F,GAAIyE,KAAKtZ,KAAKmrB,KAAKg4E,gBACnBtuF,GAAI2E,KAAKxZ,KAAKmrB,KAAKi4E,aACnBpjG,KAAKmrB,KAAKq7D,mBAAmBluE,YAAYtY,KAAKkjG,iBAAiBljG,KAAK8iG,OAAOhN,KAC3E91F,KAAKmrB,KAAKq7D,mBAAmBluE,YAAYtY,KAAKijG,aAAanN,EAAI91F,KAAKihE,kBACpEjhE,KAAK6iG,SAAW/M,OANpB,CAcC,IACsDr0B,EADtDC,EAAAr2D,GACiBrL,KAAKmrB,KAAKq7D,mBAAmB9rE,UAAQ,IAAvD,IAAAgnD,EAAAn2D,MAAAk2D,EAAAC,EAAAl7D,KAAA9E,MAAyD,KACjD2hG,EADM5hC,EAAA5jE,MAEZ,GAAIwlG,EAAM9kF,QAAQqsB,OAASkrD,EAAG7gF,GAAI,CAChCjV,KAAK2gG,mBAAmB0C,EAAOvN,EAAI91F,KAAKihE,iBACxC,KACF,CACF,CAAC,OAAAviE,GAAAgjE,EAAA91D,EAAAlN,EAAA,SAAAgjE,EAAA71D,GAAA,CACGiqF,EAAG7gF,MAAkB,QAAhB0tF,EAAK3iG,KAAK8+E,cAAM,IAAA6jB,OAAA,EAAXA,EAAa1tF,KACzBjV,KAAKwiG,0BAA0B1M,EATjC,CAWF,GAAC,CAAAn4F,IAAA,eAAAE,OAAA28E,EAAA/xE,EAAAzL,IAAAA,MAED,SAAAsmG,EAAoBvlF,EAAiB6kF,EAAqBpqC,GAAc,IAAA+qC,EAAAn6F,EAAAo6F,EAAAhgG,EAAAigG,EAAAhU,EAAAiU,EAAAC,EAAAC,EAAA,OAAA5mG,IAAAA,MAAA,SAAA6mG,GAAA,cAAAA,EAAAh/F,KAAAg/F,EAAAvhG,MAAA,OAClEihG,EAAa,GACbX,IAAYW,EAAa,IAEvBn6F,EAAwB,CAAEqmF,IAAK,GAAIqU,QAAQ,GAC7CN,EAAMhrC,EAEDh1D,EAAI,EAAC,YAAEA,EAAI,IAAE,CAAAqgG,EAAAvhG,KAAA,gBAAAuhG,EAAAvhG,KAAA,EACE2oB,KAAM84E,UAAUhmF,EAASwlF,EAAYC,GAAI,OAc9D,IAdKC,EAAOI,EAAA/hG,MACD2tF,IAAIlsF,OAAS,IACvBigG,EAAMC,EAAQhU,IAAIgU,EAAQhU,IAAIlsF,OAAS,GAAG0R,IAExCw6E,EAAMgU,EAAQhU,IACdmT,IACFnT,EAAMA,EAAIn8E,QAAO,SAACwiF,GAAE,OArvDA,KAqvDKA,EAAGp2F,IAAqB,KAE/C0J,EAAIqmF,IAAIlsF,OAASksF,EAAIlsF,OAAS,IAC1BogG,EAAY,GAAKv6F,EAAIqmF,IAAIlsF,QAC/BmgG,EAAAt6F,EAAIqmF,KAAIzsF,KAAI4F,MAAA86F,EAAAh8F,EAAI+nF,EAAI1qF,MAAM,EAAG4+F,OAEzBF,EAAQK,SAAQ16F,EAAI06F,QAAS,IACjCF,EAAAx6F,EAAIqmF,KAAIzsF,KAAI4F,MAAAg7F,EAAAl8F,EAAI+nF,OAEdrmF,EAAIqmF,IAAIlsF,QAAU,IAAMkgG,EAAQK,QAAM,CAAAD,EAAAvhG,KAAA,gBAAAuhG,EAAA5hG,OAAA,oBAhBpBuB,IAAGqgG,EAAAvhG,KAAA,uBAAAuhG,EAAA5hG,OAAA,SAkBpBmH,GAAG,yBAAAy6F,EAAA7+F,OAAA,GAAAs+F,EAAA,KACX,SAAAU,EAAAC,EAAAC,GAAA,OAAA1pB,EAAA5xE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,gBAAAE,OAAA08E,EAAA9xE,EAAAzL,IAAAA,MAED,SAAAmnG,EAAqBpmF,GAAe,IAAAoN,EAAAi5E,EAAA3tF,EAAA4tF,EAAAC,EAAAC,EAAA3iC,EAAAD,EAAAm0B,EAAA/8B,EAAAzR,EAAA,OAAAtqD,IAAAA,MAAA,SAAAwnG,GAAA,cAAAA,EAAA3/F,KAAA2/F,EAAAliG,MAAA,OAKI,GAJhC6oB,EAAOnrB,KAAKmrB,KAElBtW,GAAI2E,KAAK2R,EAAKg4E,eAAgBh4E,EAAKs5E,aAAct5E,EAAKi4E,YAAaj4E,EAAKuzD,WAAYvzD,EAAKu5E,sBAAuBv5E,EAAKy3E,YACrH/tF,GAAImD,MAAMmT,EAAKq7D,qBACT/vE,EAAIwU,KAAMoW,OAAOtjB,GAASqH,UACtB3O,EAAEyO,UArzDO,MAqzDMzO,EAAE0+B,OAA8B,CAAAqvD,EAAAliG,KAAA,QACnB,OAApCuS,GAAIyE,KAAK6R,EAAKu5E,uBAAsBF,EAAAviG,OAAA,iBAW4B,OAPlEjC,KAAK6iG,cAAWphG,EAEV4iG,KAAY5tF,EAAE0+B,OAASwjC,IAC7B9jE,GAAIqf,OAAOmwE,EAAUl5E,EAAKy3E,YAC1B/tF,GAAIyE,KAAK6R,EAAKs5E,cAAaD,EAAA3/F,KAAA,GAGnBy/F,EAAaD,KAAcl5E,EAAK40D,mBAAmBpnB,QAAO6rC,EAAAliG,KAAA,GAClDtC,KAAK2kG,aAAa5mF,EAASumF,GAAW,QAApDF,EAAKI,EAAA1iG,KAAA0iG,EAAAliG,KAAG,GAAH,cAEqB,OAFrBkiG,EAAA3/F,KAAG,GAAH2/F,EAAA92F,GAAA82F,EAAA,UAEL3vF,GAAIyE,KAAK6R,EAAKi4E,aAAYoB,EAAAviG,OAAA,qBAGH,IAArBmiG,EAAM3U,IAAIlsF,OAAY,CAAAihG,EAAAliG,KAAA,SACE,OAA1BuS,GAAIyE,KAAK6R,EAAKi4E,aAAYoB,EAAAviG,OAAA,kBAIxBsiG,EAAavkG,KAAK8iG,OAAOsB,EAAM3U,IAAI,IACvCtkE,EAAKq7D,mBAAmBluE,YAAYtY,KAAKkjG,iBAAiBqB,IAAY3iC,EAAAv2D,GACrD+4F,EAAM3U,KAAG,IAA1B,IAAA7tB,EAAAr2D,MAAAo2D,EAAAC,EAAAp7D,KAAA9E,MAAWo0F,EAAEn0B,EAAA9jE,OACLk7D,EAAO/4D,KAAK8iG,OAAOhN,MACZyO,IACXA,EAAaxrC,EACb5tC,EAAKq7D,mBAAmBluE,YAAYtY,KAAKkjG,iBAAiBnqC,KAEtDzR,EAAMtnD,KAAKijG,aAAanN,EAAI/3E,GAClCoN,EAAKq7D,mBAAmBluE,YAAYgvC,EACrC,OAAA5oD,GAAAkjE,EAAAh2D,EAAAlN,EAAA,SAAAkjE,EAAA/1D,GAAA,CACD7L,KAAK6iG,SAAWuB,EAAM3U,IAAI2U,EAAM3U,IAAIlsF,OAAS,GAC7CsR,GAAIyE,KAAK6R,EAAKg4E,gBACdtuF,GAAIqf,QAAQkwE,EAAMN,OAAQ34E,EAAKuzD,YAAW,yBAAA8lB,EAAAx/F,OAAA,GAAAm/F,EAAA,oBAC3C,SAAAS,GAAA,OAAArqB,EAAA3xE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,iBAAAE,OAAAy8E,EAAA7xE,EAAAzL,IAAAA,MAED,SAAA6nG,IAAA,IAAA15E,EAAAi5E,EAAA3tF,EAAA6tF,EAAAC,EAAA9/B,EAAAF,EAAAuxB,EAAA/8B,EAAAzR,EAAA,OAAAtqD,IAAAA,MAAA,SAAA8nG,GAAA,cAAAA,EAAAjgG,KAAAigG,EAAAxiG,MAAA,UACOtC,KAAK6iG,SAAU,CAAFiC,EAAAxiG,KAAA,eAAAwiG,EAAA7iG,OAAA,iBAIwE,OAHpFkpB,EAAOnrB,KAAKmrB,KAEZ1U,EAAIwU,KAAMoW,OAAOrhC,KAAKihE,iBAAiB77C,OACvCk/E,KAAc7tF,EAAE0+B,OAASwjC,OAA4BxtD,EAAK40D,mBAAmBpnB,QAAOmsC,EAAAjgG,KAAA,EAAAigG,EAAAxiG,KAAA,EAE1EtC,KAAK2kG,aAAa3kG,KAAKihE,gBAAiBqjC,EAAYtkG,KAAK6iG,SAAS5tF,IAAG,OAAnFmvF,EAAKU,EAAAhjG,KAAAgjG,EAAAxiG,KAAG,GAAH,cAEa,OAFbwiG,EAAAjgG,KAAG,GAAHigG,EAAAp3F,GAAAo3F,EAAA,SAELnqF,QAAQvZ,MAAK0jG,EAAAp3F,IAAKo3F,EAAA7iG,OAAA,kBAGhBsiG,EAAavkG,KAAK8iG,OAAO9iG,KAAK6iG,UAASp+B,EAAAp5D,GAC1B+4F,EAAM3U,KAAG,IAA1B,IAAAhrB,EAAAl5D,MAAAg5D,EAAAE,EAAAj+D,KAAA9E,MAAWo0F,EAAEvxB,EAAA1mE,OACLk7D,EAAO/4D,KAAK8iG,OAAOhN,MACZyO,IACXA,EAAaxrC,EACb5tC,EAAKq7D,mBAAmBluE,YAAYtY,KAAKkjG,iBAAiBnqC,KAEtDzR,EAAMtnD,KAAKijG,aAAanN,EAAI91F,KAAKihE,iBACvC91C,EAAKq7D,mBAAmBluE,YAAYgvC,EACrC,OAAA5oD,GAAA+lE,EAAA74D,EAAAlN,EAAA,SAAA+lE,EAAA54D,GAAA,CACDgJ,GAAIqf,QAAQkwE,EAAMN,OAAQ34E,EAAKuzD,YAC3B0lB,EAAM3U,IAAIlsF,OAAS,IACrBvD,KAAK6iG,SAAWuB,EAAM3U,IAAI2U,EAAM3U,IAAIlsF,OAAS,IAC9C,yBAAAuhG,EAAA9/F,OAAA,GAAA6/F,EAAA,mBACF,kBAAAvqB,EAAA1xE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,OAAAw8E,EAAA5xE,EAAAzL,IAAAA,MAED,SAAA+nG,EAAoBhnF,GAAe,IAAAoN,EAAAgxC,EAAAvf,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAgoG,GAAA,cAAAA,EAAAngG,KAAAmgG,EAAA1iG,MAAA,OAOM,OANjC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK85E,aAER9oC,EAAM,oBACNvf,EAAM,CAAE7+B,QAASA,GAEjBugC,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAK03F,EAAA1iG,KAAA,EACrBuL,EAASsuD,EAAKvf,GAAI,OAC5B,GADFxzC,EAAG47F,EAAAljG,KACTw8C,IACIl1C,EAAIu6D,OAAS90D,EAAOg9E,gBAAe,CAAAmZ,EAAA1iG,KAAA,SAGd,OAFvBtC,KAAKklG,SAAW/oC,EAChBn8D,KAAKmlG,SAAWvoD,EAChB58C,KAAKolG,mBAAkBJ,EAAA/iG,OAAA,qBAGpBgpB,KAAM6mC,cAAc1oD,GAAM,CAAF47F,EAAA1iG,KAAA,SACiB,OAA5CuS,GAAI+4D,cAAcziD,EAAK85E,YAAa77F,EAAIwE,KAAIo3F,EAAA/iG,OAAA,kBAG9CjC,KAAKkgF,aAAaniE,EAASoN,EAAKm1D,aAAc/jE,Gbv5DjB,mBau5DmD,yBAAAyoF,EAAAhgG,OAAA,GAAA+/F,EAAA,UACjF,SAAAM,GAAA,OAAAhrB,EAAAzxE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAKmrB,KAAKm6E,iBACnBtlG,KAAKqkF,SAASrkF,KAAKmrB,KAAK02D,aAC1B,GAAC,CAAAlkF,IAAA,oBAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAKmrB,KAAKo6E,kBACnBvlG,KAAKqkF,SAASrkF,KAAKmrB,KAAKw2D,qBAC1B,GAEA,CAAAhkF,IAAA,aAAAE,OAAAu8E,EAAA3xE,EAAAzL,IAAAA,MAGA,SAAAwoG,EAAkBznF,GAAe,IAAA6H,EAAAxc,EAAA,OAAApM,IAAAA,MAAA,SAAAyoG,GAAA,cAAAA,EAAA5gG,KAAA4gG,EAAAnjG,MAAA,OAG9B,OAFKsjB,EAAO,CACX7H,QAASA,GACV0nF,EAAAnjG,KAAA,EACiBuL,EAAS,kBAAmB+X,GAAK,OAA1C,GAAHxc,EAAGq8F,EAAA3jG,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFq8F,EAAAnjG,KAAA,QACW,OAAtCqY,QAAQvZ,MAAM,mBAAoBgI,GAAIq8F,EAAAxjG,OAAA,iBAGxCjC,KAAKkgF,aAAaniE,OAAStc,EAAW8a,Gb96DR,oBa86D2C,wBAAAkpF,EAAAzgG,OAAA,GAAAwgG,EAAA,UAC1E,SAAAE,GAAA,OAAAtrB,EAAAxxE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,OAAAs8E,EAAA1xE,EAAAzL,IAAAA,MACA,SAAA2oG,EAAoB5nF,EAAiBuO,GAAsB,IAAAs5E,EAAAz6E,EAAAlM,EAAA4mF,EAAA7yC,EAAA8yC,EAAAn7B,EAAAD,EAAAjX,EAAAsyC,EAAAj7B,EAAAD,EAAAv/C,EAAAlG,EAAAk5B,EAAAl1C,EAAA6vD,EAAA,OAAAj8D,IAAAA,MAAA,SAAAgpG,GAAA,cAAAA,EAAAnhG,KAAAmhG,EAAA1jG,MAAA,OAezD,GAdM6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KACF2R,EAAKk6D,iBAAkBl6D,EAAKq6D,mBAAoBr6D,EAAK85E,YACrD95E,EAAKm6D,eAAgBn6D,EAAKq6D,mBAAoBr6D,EAAK85E,YACnD95E,EAAK82D,aAAc92D,EAAK42D,eAG1B/hF,KAAKklF,gBAAiB,EACtBllF,KAAKmlF,gBAAgBnlF,KAAKklF,gBACpBjmE,EAAQgM,KAAMoW,OAAOtjB,GAErB8nF,EAAa56E,KAAMg7E,wBAAwBloF,GAC3Ci1C,EAAa/zC,EAAM+sB,MAAQ,CAAC/sB,EAAM+sB,MAAMplC,YAAcqY,EAAM7c,KAAO6c,EAAM7c,KAAKoxD,iBAAmB,GACjGsyC,EAAkD,QAAjCF,EAAG36E,KAAMgtC,gBAAgBl6C,UAAQ,IAAA6nF,OAAA,EAA9BA,EAAgCE,kBACtD9yC,EAAWzvD,OAAS,IAAMuiG,EAAmB,CAC/CjxF,GAAImD,MAAMmT,EAAKi6D,wBACfvwE,GAAIyE,KAAK6R,EAAKm6D,eAAgBn6D,EAAKs6D,oBACnCt6D,EAAKu6D,cAAcrmE,YAAc9C,Gb58DF,sBa48DuCouD,EAAAt/D,GACnD2nD,GAAU,IAA7B,IAAA2X,EAAAp/D,MAAAm/D,EAAAC,EAAAnkE,KAAA9E,MAAW+xD,EAAIiX,EAAA7sE,MACPkoG,EAAS96F,SAAS4P,cAAc,UAClC44C,EAAK/zD,OAASmmG,EAAWnmG,OAAMqmG,EAAO74E,UAAW,GACrD64E,EAAOloG,MAAQkoG,EAAO1mF,YAAco0C,EAAK/zD,KACzCyrB,EAAKi6D,uBAAuB9sE,YAAYytF,EACzC,OAAArnG,GAAAisE,EAAA/+D,EAAAlN,EAAA,SAAAisE,EAAA9+D,GAAA,CACH,CAEA,GAAIygB,SAAAA,EAAK45E,iBAAkB,CAAAp7B,EAAAz/D,GACNw6F,EAAWlxC,YAAU,IAAxC,IAAAmW,EAAAv/D,MAAAs/D,EAAAC,EAAAtkE,KAAA9E,MAA2D,eAAhD4pB,EAAGu/C,EAAAhtE,OAAqCF,MAAqB2tB,EAAIo8B,UAAW,EAAI,OAAAhpD,GAAAosE,EAAAl/D,EAAAlN,EAAA,SAAAosE,EAAAj/D,GAAA,CAC7F,CAoB+C,OAlBzCuZ,EAAS6F,KAAM8sB,UAAUh6B,GAC/BlJ,GAAIqf,OAj9Dc,EAi9DP9O,EAAO+vB,OAAwBhqB,EAAKi2D,cAC/CvsE,GAAIqf,OAj9De,GAi9DR9O,EAAO+vB,OAAyBhqB,EAAKo2D,eAChD1sE,GAAIqf,OAh9Dc,IAg9DP9O,EAAO+vB,OAAwBhqB,EAAKk2D,cAC/CxsE,GAAIqf,OAr9De,EAq9DR9O,EAAO+vB,OAAyBhqB,EAAKszD,cAChD5pE,GAAIqf,OAh9DiB,KAg9DV9O,EAAO+vB,SAA8B/vB,EAAOF,SAAUiG,EAAKk3D,aACtExtE,GAAIqf,OAh9DmB,KAg9DZ9O,EAAO+vB,SAAgC/vB,EAAOF,SAAUiG,EAAKs3D,yBAExE5tE,GAAIqf,OA78DgBiyE,KA68DT/gF,EAAO+vB,OAA0BhqB,EAAKi7E,mBAE7ChhF,EAAOF,SAAUrQ,GAAIyE,KAAK6R,EAAK82D,cAC9BptE,GAAIyE,KAAK6R,EAAK42D,eAEnB/hF,KAAKqmG,6BAA6BjhF,EAAQygF,EAAW9wC,QAErD5pC,EAAKm7E,eAAe7mF,IAAM5K,GAAImK,SAASC,EAAMN,QAC7CwM,EAAKo7E,eAAelnF,YAAcJ,EAAMlb,KACnCuoB,SAAAA,EAAKq5D,eAAe3lF,KAAKqkF,SAASl5D,EAAKm1D,cACtChiC,EAASrzB,KAAMuzB,QAAQrzB,EAAKm1D,cAAa0lB,EAAA1jG,KAAA,GAC7BuL,EAAS,sBAAuB,CAAEkQ,QAAAA,IAAU,QACtD,GADF3U,EAAG48F,EAAAlkG,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF48F,EAAA1jG,KAAA,SACiB,OAA5CuS,GAAI+4D,cAAcziD,EAAK85E,YAAa77F,EAAIwE,KAAIo4F,EAAA/jG,OAAA,kBAGxCg3D,EAAuBhuC,KAAMukE,iBAAiBzxE,GACpD/d,KAAKsgF,aAAa//B,OAAOthC,EAAMhK,GAAI4wF,EAAWlxC,YAAc,GAAIsE,GAChEj5D,KAAKm1D,aAAa0wC,EAAWnxC,WAC7B10D,KAAKsgF,aAAa/oB,UAAUnuD,EAAImoD,KAChCvxD,KAAKwmG,8BAA8BX,GAAW,yBAAAG,EAAAhhG,OAAA,GAAA2gG,EAAA,UAC/C,SAAAc,EAAAC,GAAA,OAAAvsB,EAAAvxE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,+BAAAE,MAED,SAA8BunB,EAAqB2vC,GACjD/0D,KAAK2mG,yBAAyB5xC,IAAW3vC,EAAOE,UAAYF,EAAOF,UAAY8I,QAh/D5D,GAg/DoE5I,EAAO+vB,QAA0B/vB,EAAOzG,OACjI,GAAC,CAAAhhB,IAAA,2BAAAE,MAED,SAA0B+oG,EAAcjoF,GACtC,IAAMwM,EAAOnrB,KAAKmrB,KAClB,GAAIy7E,EAKF,OAJAz7E,EAAK07E,mBAAmBxnF,YAAc9C,Gb56DE,8Ba46D6C,CAAEuqF,aAAcnoF,EAAOooF,sBAC5GlyF,GAAIyE,KAAK6R,EAAK07E,oBACd17E,EAAK21D,eAAeuV,aAAa,WAAY,SAC7ClrE,EAAK21D,eAAenoE,UAAUC,IAAI,QAGpCuS,EAAK21D,eAAe1gE,gBAAgB,YACpC+K,EAAK21D,eAAenoE,UAAUM,OAAO,QACrCpE,GAAImD,MAAMmT,EAAK07E,oBACfhyF,GAAI2E,KAAK2R,EAAK07E,mBAChB,GAAC,CAAAlpG,IAAA,mBAAAE,MAED,WACE,IACMqzD,EADOlxD,KAAKmrB,KACMi6D,uBAAuBvnF,OAAS,GAClDi2D,EAAY7oC,KAAMikE,iBAAiBlvF,KAAKihE,gBAAiB/P,GAC/DlxD,KAAKsgF,aAAa//B,OAAOvgD,KAAKihE,gBAAiBnN,EAAUa,YAAc,IAAI,GAC3E,IAAMvvC,EAAS6F,KAAM8sB,UAAU/3C,KAAKihE,iBAC9B4kC,EAAa56E,KAAMg7E,wBAAwBjmG,KAAKihE,iBAClDnN,EAAUp0D,OAASmmG,EAAWnmG,KAAMM,KAAK2mG,0BAAyB,EAAOvhF,EAAOzG,QAC/E3e,KAAKqmG,6BAA6BjhF,EAAQ0uC,EAAUiB,QACzD/0D,KAAKm1D,aAAarB,EAAUY,WAC5B10D,KAAKwmG,8BAA8B1yC,EACrC,GAAC,CAAAn2D,IAAA,eAAAE,MAED,SAAck2D,GACZl/C,GAAI2E,KAAKxZ,KAAK6vD,gBACI,KAAdkE,IACF/zD,KAAK6vD,eAAe1jB,KAAO4nB,EAC3Bl/C,GAAIyE,KAAKtZ,KAAK6vD,gBAElB,GAAC,CAAAlyD,IAAA,gCAAAE,MAED,SAA+Bi2D,GAA6B,IAAAkzC,EACpDC,EAA6D,QAA9CD,EAAG/7E,KAAMgtC,gBAAgBj4D,KAAKihE,wBAAgB,IAAA+lC,OAAA,EAA3CA,EAA6CC,gBACjEnzC,EAAUiB,QAA6B,UAAnBjB,EAAUp0D,MAAoBunG,GACpDpyF,GAAI2E,KAAKxZ,KAAKmrB,KAAK85D,aAAcjlF,KAAKsgF,aAAalrB,cACnDp1D,KAAKklF,gBAAiB,EACtBllF,KAAKmlF,iBAAgB,IAChBtwE,GAAIyE,KAAKtZ,KAAKmrB,KAAK85D,aAAcjlF,KAAKsgF,aAAalrB,aAC5D,GAEA,CAAAz3D,IAAA,cAAAE,OAAAq8E,EAAAzxE,EAAAzL,IAAAA,MACA,SAAAkqG,EAAmBnpF,GAAe,OAAA/gB,IAAAA,MAAA,SAAAmqG,GAAA,cAAAA,EAAAtiG,KAAAsiG,EAAA7kG,MAAA,OAChCtC,KAAKukF,gBAAgB/M,SAASz5D,GAC9B/d,KAAKqkF,SAASrkF,KAAKmrB,KAAKq5D,SAAQ,wBAAA2iB,EAAAniG,OAAA,GAAAkiG,EAAA,UACjC,SAAAE,GAAA,OAAAltB,EAAAtxE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,OAAAo8E,EAAAxxE,EAAAzL,IAAAA,MACA,SAAAqqG,EAAoBtpF,GAAe,IAAAoN,EAAA/U,EAAAkxF,EAAAliF,EAAA3I,EAAAkC,EAAAqtB,EAAAu7D,EAAAtgB,EAAAx1B,EAAA+1C,EAAAlpD,EAAAl1C,EAAAq+F,EAAAzgB,EAAA,OAAAhqF,IAAAA,MAAA,SAAA0qG,GAAA,cAAAA,EAAA7iG,KAAA6iG,EAAAplG,MAAA,OA4BjC,GA3BM6oB,EAAOnrB,KAAKmrB,KACZ/U,EAAM+U,EAAKs1D,SAAQ6mB,EACuBr8E,KAAMoW,OAAOtjB,GAArDqH,EAAMkiF,EAANliF,OAAkB3I,EAAE6qF,EAAZ5yF,SAAciK,EAAM2oF,EAAN3oF,OAAQqtB,EAAKs7D,EAALt7D,MACtCn3B,GAAI2E,KAAK2R,EAAKw8E,gBACdx8E,EAAKq8D,iBAAiB7uB,SAAU,GAE1B4uC,KA7iEc,GA6iEEniF,EAAO+vB,UAE3BtgC,GAAIyE,KAAK6R,EAAKw8E,gBAGhB9yF,GAAI2E,KAAK2R,EAAKk8D,QAASl8D,EAAKy8E,eAAgBz8E,EAAK08E,iBACjD18E,EAAK45D,SAASpsE,UAAUM,OAAO,gBAAiB,kBAChDkS,EAAK45D,SAASlnF,MAAQ,GACtBstB,EAAKw5D,QAAQ9mF,MAAQ,GACfopF,EAASh8D,KAAMymB,aAAa3zB,GAClClJ,GAAI+vE,cAAcz5D,EAAK05D,UAAW,EAAGoC,EAAQxqE,GAC7C0O,EAAKs5D,UAAUplE,YAAcxK,GAAIizE,oBAAoB1iE,EAAOozB,QAAQxI,UAAWvzB,GAC/E0O,EAAK28E,SAASroF,IAAM5K,GAAImK,SAASL,GACjCwM,EAAK48E,SAAS1oF,YAAc5C,EAAG9H,aAAamI,KACxCkvB,IACIylB,EAAcxmC,KAAMoW,OAAO2K,EAAMC,UACvC9gB,EAAK68E,oBAAoBvoF,IAAM5K,GAAImK,SAASyyC,EAAY9yC,QACxDwM,EAAK88E,oBAAoB5oF,YAAcoyC,EAAY1tD,KACnD8Q,GAAIyE,KAAK6R,EAAK08E,oBAKZziF,EAAOozB,QAAQxI,UAAY,GAlkEP,IAkkEa5qB,EAAO+vB,QAAmC,CAAAuyD,EAAAplG,KAAA,SAQtC,OAPjCklG,EAAS,CACbzpF,QAASA,EACT8oE,SAAU0gB,EACVW,aAAa,EACbrqG,MAAOunB,EAAOozB,QAAQxI,WAGlBsO,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAKo6F,EAAAplG,KAAA,GACrBuL,EAAS,aAAc25F,GAAO,QAA1Cp+F,EAAGs+F,EAAA5lG,KACTw8C,IACIrzB,KAAM6mC,cAAc1oD,KAClBq+F,EAAUriF,EAAOozB,QAAQxI,UACxBhE,IACHy7D,GAAWr+F,EAAI09E,OACD,IAAG2gB,EAAU,GAG7BznG,KAAK8kF,QAAU2iB,EACft8E,EAAK25D,QAAQzlE,YAAcxK,GAAIizE,oBAAoB2f,EAAShrF,GAC5D5H,GAAI+vE,cAAcz5D,EAAKg9E,YAAaV,EAASxgB,EAAQxqE,GACjDuvB,GACIg7C,EAAQ/7D,KAAMoW,OAAO2K,EAAMC,UAAUv3B,SAC3CyW,EAAKi9E,WAAW/oF,YAAcxK,GAAIizE,oBAAoB1+E,EAAI09E,MAAOE,GAAS,IAAMA,EAAMryE,aAAamI,KACnGjI,GAAI+vE,cAAcz5D,EAAKk9E,eAAgBj/F,EAAI09E,MAAO77D,KAAMymB,aAAa1F,EAAMC,UAAW+6C,KAEtF77D,EAAKi9E,WAAW/oF,YAAcxK,GAAIizE,oBAAoB1+E,EAAI09E,MAAOrqE,GACjE5H,GAAI+vE,cAAcz5D,EAAKk9E,eAAgBj/F,EAAI09E,MAAOG,EAAQxqE,IAE5D5H,GAAIyE,KAAK6R,EAAKy8E,iBACf,QAGH/yF,GAAI+vE,cAAcz5D,EAAK05D,UAAW,EAAGoC,EAAQxqE,GAC7C0O,EAAKs5D,UAAUplE,YAAcxK,GAAIizE,oBAAoB1iE,EAAOozB,QAAQxI,UAAWvzB,GAC/ErG,EAAImI,QAAQR,QAAUzU,OAAOyU,GAC7B/d,KAAKqkF,SAASjuE,GAAI,yBAAAsxF,EAAA1iG,OAAA,GAAAqiG,EAAA,UACnB,SAAAiB,GAAA,OAAAruB,EAAArxE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,YAAAE,OAAAm8E,EAAAvxE,EAAAzL,IAAAA,MACA,SAAAurG,EAAiBxqF,GAAe,IAAAugC,EAAAl1C,EAAAuV,EAAAwM,EAAA,OAAAnuB,IAAAA,MAAA,SAAAwrG,GAAA,cAAAA,EAAA3jG,KAAA2jG,EAAAlmG,MAAA,OACS,OAAjCg8C,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAKk7F,EAAAlmG,KAAA,EACrBuL,EAAS,qBAAsB,CAAEkQ,QAAAA,IAAU,OAAvD3U,EAAGo/F,EAAA1mG,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,KACfuV,EAAWsM,KAAMoW,OAAOtjB,GAAxBY,QACFwM,EAAOnrB,KAAKmrB,MACbs9E,cAAcppF,YAAc9C,GbjkEE,4BaikEwC,CAAE62C,UAAWz0C,EAAQ22C,OAAQlsD,EAAIwE,MAC5G5N,KAAKqkF,SAASl5D,EAAKu9E,aAErB1oG,KAAKwtF,qBAAqBzvE,GAAQ,wBAAAyqF,EAAAxjG,OAAA,GAAAujG,EAAA,UACnC,SAAAI,GAAA,OAAA3uB,EAAApxE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,MAED,SAAckgB,EAAiBg6D,EAAuB6T,GAChD7tE,IAAY/d,KAAKihE,kBACrBjhE,KAAKwtF,qBAAqBzvE,GACtBg6D,GAAW16E,OAAOurG,GAAG5oG,KAAK4gD,YAAam3B,KACrC6T,EAAY5rF,KAAKo1E,YAAYwW,GAC5B5rF,KAAK88E,eAEd,GAEA,CAAAn/E,IAAA,kBAAAE,OAAAk8E,EAAAtxE,EAAAzL,IAAAA,MAIA,SAAA6rG,IAAA,IAAA19E,EAAA29E,EAAA/qF,EAAAtB,EAAA2I,EAAA6hE,EAAAnsC,EAAA,OAAA99C,IAAAA,MAAA,SAAA+rG,GAAA,cAAAA,EAAAlkG,KAAAkkG,EAAAzmG,MAAA,OACQ6oB,EAAOnrB,KAAKmrB,KAAI29E,EACwB79E,KAAMoW,OAAOrhC,KAAKihE,iBAApDljD,EAAO+qF,EAAX7zF,GAAuBwH,EAAEqsF,EAAZp0F,SAAc0Q,EAAM0jF,EAAN1jF,OAG7B6hE,EAASh8D,KAAMymB,aAAa3zB,GA3oEd,GA4oEfqH,EAAO+vB,QAKJ2F,EAAM11B,EAAOozB,QAAQxI,UAC3B7kB,EAAKw5D,QAAQ9mF,MAAQyL,OAAOwxC,EAAMr+B,EAAG9H,aAAaC,kBAClDC,GAAI+vE,cAAcz5D,EAAK05D,UAAW/pC,EAAKmsC,EAAQxqE,GAC/C0O,EAAKq8D,iBAAiB7uB,SAAU,IAPhCxtC,EAAKw5D,QAAQ9mF,MAAQyL,OAAOtJ,KAAK8kF,QAAUroE,EAAG9H,aAAaC,kBAC3DC,GAAI+vE,cAAcz5D,EAAK05D,UAAW7kF,KAAK8kF,QAASmC,EAAQxqE,GACxD0O,EAAKq8D,iBAAiB7uB,SAAU,GAMjC,wBAAAowC,EAAA/jG,OAAA,GAAA6jG,EAAA,UACF,kBAAA9uB,EAAAnxE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,OAAAE,OAAAi8E,EAAArxE,EAAAzL,IAAAA,MACA,SAAAgsG,IAAA,IAAAC,EAAAC,EAAA/9E,EAAApN,EAAA8oE,EAAAjyE,EAAA64D,EAAA7nD,EAAA04B,EAAAl1C,EAAArF,EAAA,OAAA/G,IAAAA,MAAA,SAAAmsG,GAAA,cAAAA,EAAAtkG,KAAAskG,EAAA7mG,MAAA,OAMyB,GALjB6oB,EAAOnrB,KAAKmrB,KACZpN,EAAUlL,SAAsC,QAA9Bo2F,EAAC99E,EAAKs1D,SAASliE,QAAQR,eAAO,IAAAkrF,EAAAA,EAAI,IACpDpiB,EAAwC,QAAhCqiB,EAAG/9E,EAAKq8D,iBAAiB7uB,eAAO,IAAAuwC,GAAAA,EACxCt0F,EAAmBqW,KAAMvW,SAASqJ,GAASpJ,aAAaC,iBACxD64D,EAAKtiD,EAAKi+E,QAAQvrG,OAAS,GACjCstB,EAAKi+E,QAAQvrG,MAAQ,GACV,KAAP4vE,EAAS,CAAA07B,EAAA7mG,KAAA,QAC2D,OAAtEuS,GAAI+4D,cAAcziD,EAAKi8D,SAAU7qE,GAAUA,IAA2B4sF,EAAAlnG,OAAA,iBAU5B,OAPtC2jB,EAAO,CACX7H,QAASA,EACTumD,QAASn5C,EAAK45D,SAASlnF,MACvBgpF,SAAUA,EACVhpF,MAAOoV,KAAKC,MAAMqU,GAAkB4D,EAAKw5D,QAAQ9mF,OAAS+W,GAC1D64D,GAAIA,GAEAnvB,EAASrzB,KAAMuzB,QAAQrzB,EAAKy1D,WAAUuoB,EAAA7mG,KAAA,GAC1BuL,EAAS,YAAa+X,GAAK,QACrC,GADFxc,EAAG+/F,EAAArnG,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF+/F,EAAA7mG,KAAA,SACc,OAAzCuS,GAAI+4D,cAAcziD,EAAKi8D,SAAUh+E,EAAIwE,KAAIu7F,EAAAlnG,OAAA,kBAGrC8B,EAAOknB,KAAMoW,OAAOtjB,GAASha,KACnC/D,KAAKkgF,aAAaniE,EAASoN,EAAKy1D,UAAWrkE,Gb1rEhB,ea0rEgD,CAAE62C,UAAWrvD,KAAQ,yBAAAolG,EAAAnkG,OAAA,GAAAgkG,EAAA,UACjG,kBAAAlvB,EAAAlxE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,WAAAE,OAAAg8E,EAAApxE,EAAAzL,IAAAA,MACA,SAAAqsG,IAAA,IAAAC,EAAAn+E,EAAApN,EAAAmzC,EAAA5S,EAAA1B,EAAAxzC,EAAA,OAAApM,IAAAA,MAAA,SAAAusG,GAAA,cAAAA,EAAA1kG,KAAA0kG,EAAAjnG,MAAA,OAe6D,OAdrD6oB,EAAOnrB,KAAKmrB,KACZpN,EAAU/d,KAAKihE,gBACrBpsD,GAAI2E,KAAK2R,EAAK85E,aACV/zC,EAAajmC,KAAMg7E,wBAAwBloF,GAASre,KACnDmV,GAAI0wE,SAASp6D,EAAKk6D,oBACrBn0B,EAAa/lC,EAAKi6D,uBAAuBvnF,OAAS,IAG9CygD,EAASrzB,KAAMuzB,QAAQrzB,EAAKm1D,cAC5B1jC,EAAuB,CAC3B7+B,QAASA,EACT0vB,OAAQztC,KAAKsgF,aAAa/uB,IAAIxzC,GAC9BmzC,WAAYA,GAEVlxD,KAAKklF,iBAAgBtoC,EAAI4sD,YAAcr+E,EAAKs+E,MAAM5rG,OAAK0rG,EAAAjnG,KAAA,GACzCtC,KAAK+xF,SAAS,yBAA0Bn1C,GAAI,QAEtD,GAFFxzC,EAAGmgG,EAAAznG,KACTqpB,EAAKs+E,MAAM5rG,MAAQ,GACnBygD,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFmgG,EAAAjnG,KAAA,SACiB,OAA5CuS,GAAI+4D,cAAcziD,EAAK85E,YAAa77F,EAAIwE,KAAI27F,EAAAtnG,OAAA,qBAGjC,QAHiCqnG,EAG1CtpG,KAAKkO,YAAI,IAAAo7F,IAATA,EAAW95C,OAAM,CAAA+5C,EAAAjnG,KAAA,SACa,OAAhC2oB,KAAM2yB,SAAS59C,KAAKkO,KAAKshD,QAAO+5C,EAAAtnG,OAAA,kBAGlCjC,KAAKkgF,aAAaniE,EAASoN,EAAKm1D,aAAc/jE,GbxtEf,qBaytE/Bvc,KAAKogF,kBAAkBriE,GACvBkN,KAAMy+E,eAAe3rF,GACrB/d,KAAKggF,cAAcjiE,GACnB/d,KAAKqgF,cAActiE,GACnB/d,KAAK8uF,mBAAmB/wE,GAAQ,yBAAAwrF,EAAAvkG,OAAA,GAAAqkG,EAAA,UACjC,kBAAAxvB,EAAAjxE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,OAAAE,OAAA+7E,EAAAnxE,EAAAzL,IAAAA,MACA,SAAA2sG,EAAY5rF,GAAe,IAAAoN,EAAAmzB,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA4sG,GAAA,cAAAA,EAAA/kG,KAAA+kG,EAAAtnG,MAAA,OAEuB,OAD1C6oB,EAAOnrB,KAAKmrB,KACZmzB,EAASrzB,KAAMuzB,QAAQrzB,EAAK4rD,eAAc6yB,EAAAtnG,KAAA,EAC9BuL,EAAS,mBAAoB,CAAEkQ,QAASA,IAAU,OAC5D,GADF3U,EAAGwgG,EAAA9nG,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFwgG,EAAAtnG,KAAA,eAAAsnG,EAAA3nG,OAAA,iBAC7BjC,KAAKwtF,qBAAqBzvE,GAC1B/d,KAAKqgF,cAActiE,GAAQ,yBAAA6rF,EAAA5kG,OAAA,GAAA2kG,EAAA,UAC5B,SAAAE,GAAA,OAAAjwB,EAAAhxE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,OAAA87E,EAAAlxE,EAAAzL,IAAAA,MAED,SAAA8sG,IAAA,IAAAC,EAAA5tC,EAAA,OAAAn/D,IAAAA,MAAA,SAAAgtG,GAAA,cAAAA,EAAAnlG,KAAAmlG,EAAA1nG,MAAA,QACQynG,EAAS,IAAIE,gBAAgB,KAC5B3yC,OAAO,UAAW,GAAFvrD,OAAK/L,KAAKihE,mBAC3B9E,EAAM,IAAI+tC,IAAIh+F,OAAOi+F,SAASh+D,OAChC49D,OAASA,EAAOxiG,WACpB40D,EAAIiuC,SAAW,mBACfl+F,OAAO0Z,KAAKu2C,EAAI50D,YAAW,wBAAAyiG,EAAAhlG,OAAA,GAAA8kG,EAAA,UAC5B,kBAAAnwB,EAAA/wE,MAAA,KAAAD,UAAA,IAGD,CAAAhL,IAAA,0BAAAE,OAAA67E,EAAAjxE,EAAAzL,IAAAA,MACA,SAAAqtG,IAAA,IAAAl/E,EAAA,OAAAnuB,IAAAA,MAAA,SAAAstG,GAAA,cAAAA,EAAAzlG,KAAAylG,EAAAhoG,MAAA,OACQ6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKo/E,iBACdp/E,EAAKq/E,eAAe3sG,MAAQ,GAC5BmC,KAAKqkF,SAASl5D,EAAKs2D,kBAAiB,wBAAA6oB,EAAAtlG,OAAA,GAAAqlG,EAAA,UACrC,kBAAA3wB,EAAA9wE,MAAA,KAAAD,UAAA,IAID,CAAAhL,IAAA,yBAAAE,OAAA47E,EAAAhxE,EAAAzL,IAAAA,MACA,SAAAytG,IAAA,IAAAt/E,EAAAyxB,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA0tG,GAAA,cAAAA,EAAA7lG,KAAA6lG,EAAApoG,MAAA,OAO0C,OANlC6oB,EAAOnrB,KAAKmrB,KACZyxB,EAAM,CACV7+B,QAAS/d,KAAKihE,gBACd5P,KAAMlmC,EAAKq/E,eAAe3sG,OAGtBygD,EAASrzB,KAAMuzB,QAAQrzB,EAAK8xB,OAAMytD,EAAApoG,KAAA,EACtBuL,EAFN,yBAEoB+uC,GAAI,OAA9BxzC,EAAGshG,EAAA5oG,KACTw8C,IACIrzB,KAAM6mC,cAAc1oD,IACtB+hB,EAAKq/E,eAAe3sG,MAAQ,GAC5BmC,KAAK2qG,yBAAyBvhG,EAAIwhG,kBAElC/1F,GAAI+4D,cAAcziD,EAAKo/E,gBAAiBnhG,EAAIwE,KAC7C,wBAAA88F,EAAA1lG,OAAA,GAAAylG,EAAA,UACF,kBAAAhxB,EAAA7wE,MAAA,KAAAD,UAAA,IAGD,CAAAhL,IAAA,2BAAAE,OAAA27E,EAAA/wE,EAAAzL,IAAAA,MACA,SAAA6tG,EAAgCzoG,GAAyB,IAAA+oB,EAAAugD,EAAAD,EAAAq/B,EAAAC,EAAA5qF,EAAA,OAAAnjB,IAAAA,MAAA,SAAAguG,GAAA,cAAAA,EAAAnmG,KAAAmmG,EAAA1oG,MAAA,OACjD6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAImD,MAAMmT,EAAK8/E,sBAAqBv/B,EAAArgE,GACnBjJ,GAAI,IAArB,IAAAspE,EAAAngE,MAAAkgE,EAAAC,EAAAllE,KAAA9E,MAAWopG,EAAEr/B,EAAA5tE,MACLktG,EAAO/qG,KAAK08E,gBAAgBjxD,WAAU,IACtCtL,EAAOtL,GAAI6W,cAAcq/E,IAC1BhnG,KAAKsb,YAAcyrF,EAAGthG,OAC3B2W,EAAKqxD,KAAKnyD,YAAcyrF,EAAGt5B,KAC3BrxD,EAAK+qF,SAAS7rF,YAAc,GAAHtT,OAAM++F,EAAGI,SAAQ,KAC1C/qF,EAAKgrF,aAAa9rF,YAAcyrF,EAAGK,aACnChgF,EAAK8/E,qBAAqB3yF,YAAYyyF,EACvC,OAAArsG,GAAAgtE,EAAA9/D,EAAAlN,EAAA,SAAAgtE,EAAA7/D,GAAA,CACD7L,KAAKqkF,SAASl5D,EAAKigF,mBAAkB,wBAAAJ,EAAAhmG,OAAA,GAAA6lG,EAAA,UACtC,SAAAQ,GAAA,OAAA7xB,EAAA5wE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,gBAAAE,OAAA07E,EAAA9wE,EAAAzL,IAAAA,MAED,SAAAsuG,IAAA,IAAAngF,EAAAyxB,EAAAuf,EAAA7d,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAuuG,GAAA,cAAAA,EAAA1mG,KAAA0mG,EAAAjpG,MAAA,OAO0C,OANlC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKo6E,kBACR3oD,EAAM,CACV7+B,QAAS/d,KAAKihE,iBAEV9E,EAAM,qBACN7d,EAASrzB,KAAMuzB,QAAQrzB,EAAK8xB,OAAMsuD,EAAAjpG,KAAA,EACtBuL,EAASsuD,EAAKvf,GAAI,OAA9BxzC,EAAGmiG,EAAAzpG,KACTw8C,IACIl1C,EAAIu6D,OAAS90D,EAAOg9E,iBACtB7rF,KAAKklG,SAAW/oC,EAChBn8D,KAAKmlG,SAAWvoD,EAChB58C,KAAKolG,oBACIn6E,KAAM6mC,cAAc1oD,GAC7BpJ,KAAK88E,cAELjoE,GAAI+4D,cAAcziD,EAAKo6E,iBAAkBn8F,EAAIwE,KAC9C,yBAAA29F,EAAAvmG,OAAA,GAAAsmG,EAAA,UACF,kBAAA/xB,EAAA3wE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,qBAAAE,OAAAy7E,EAAA7wE,EAAAzL,IAAAA,MAKA,SAAAwuG,IAAA,IAAArgF,EAAAmzB,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAyuG,GAAA,cAAAA,EAAA5mG,KAAA4mG,EAAAnpG,MAAA,OAG0C,OAFlC6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAKmlG,SAASuG,OAAQ,EAChBptD,EAASrzB,KAAMuzB,QAAQrzB,EAAK8xB,OAAMwuD,EAAAnpG,KAAA,EACtBuL,EAAS7N,KAAKklG,SAAUllG,KAAKmlG,UAAS,OAAlD/7F,EAAGqiG,EAAA3pG,KACTw8C,IACIrzB,KAAM6mC,cAAc1oD,GAAMpJ,KAAK88E,cAEjCjoE,GAAI+4D,cAAcziD,EAAKm6E,gBAAiBl8F,EAAIwE,KAC7C,wBAAA69F,EAAAzmG,OAAA,GAAAwmG,EAAA,UACF,kBAAAlyB,EAAA1wE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,oBAAAE,MAGA,SAAmBuyD,GACjBpwD,KAAK8sF,kBAAkB18B,EAAKryC,SACxBqyC,EAAKryC,UAAY/d,KAAKihE,iBAAiBjhE,KAAKgvF,6BAClD,GAEA,CAAArxF,IAAA,kBAAAE,MAGA,SAAiBuyD,GAEf,GADApwD,KAAK8sF,kBAAkB9sF,KAAKihE,iBACvB7Q,EAAKu7C,UAAU3rG,KAAKihE,iBAAzB,CACAjhE,KAAKgvF,8BACL,IAAQC,EAAahkE,KAAM8sB,UAAU/3C,KAAKihE,iBAAlCguB,SACJA,GAAUjvF,KAAKmvF,eAAeF,EAHe,CAInD,GAEA,CAAAtxF,IAAA,wBAAAE,MAIA,SAAuBuyD,GACrB,IAAAw7C,EAA8Bx7C,EAAKhrC,OAA3BrH,EAAO6tF,EAAP7tF,QAASkxE,EAAQ2c,EAAR3c,SACjBjvF,KAAK8sF,kBAAkB/uE,GACvB/d,KAAKkgF,aAAaniE,GACC,sBAAfqyC,EAAKqC,OACL10C,IAAY/d,KAAKihE,iBACjBpsD,GAAI82D,YAAY3rE,KAAKmrB,KAAKkgE,kBAC5BrrF,KAAKorF,yBAEH6D,GAAYlxE,IAAY/d,KAAKihE,iBAAiBjhE,KAAKmvF,eAAeF,EACxE,GAEA,CAAAtxF,IAAA,yBAAAE,MAGA,SAAwBuyD,GACtBpwD,KAAK8sF,kBAAkB18B,EAAKryC,SAC5B/d,KAAKkgF,aAAa9vB,EAAKryC,SACvB/d,KAAKggF,cAAc5vB,EAAKryC,QAC1B,GAAC,CAAApgB,IAAA,yBAAAE,MAED,SAAwBuyD,GACtB,IAAM2kC,EAAa3kC,EAAK6kC,QACxB,OAAQF,EAAW8W,OACjB,IAAK,YACH,IAAMrlG,EAAIuuF,EACV,GACO,KADCvuF,EAAEuX,QACR,CACE,IAAK/d,KAAKgxF,YAAa,OACvB,IAAM9iF,EAAO1H,EAAE0H,KAEf,GADe+c,KAAM8sB,UAAUvxC,EAAEuX,SAASyH,OAC9B,CACV,IAAM/I,EAAKwO,KAAMvW,SAASlO,EAAEuX,SAC5B/d,KAAKwyF,kBAAkBtkF,EAAK+zC,MAAOxlC,EAAIvO,EAAKokF,YAAapkF,EAAKukF,cAChE,CACF,CAEF,MAEF,IAAK,uBACHzyF,KAAK8rG,4BAA4B/W,GACjC,MAEF,IAAK,cACH,IAAMvuF,EAAIuuF,EACNvuF,EAAEuX,UAAY/d,KAAKihE,iBAAiBjhE,KAAK+rG,aAAavlG,EAAEwlG,YAAaxlG,EAAC,KAC1E,MAEF,IAAK,2BACH,IAAMA,EAAIuuF,EACNvuF,EAAEuX,UAAY/d,KAAKihE,iBAAiBjhE,KAAKggF,cAAcx5E,EAAEuX,SAInE,GAEA,CAAApgB,IAAA,SAAAE,MAIA,WACE8oD,cAAc3mD,KAAKu8E,cACnB1nE,GAAImU,OAAO/d,SAAU,QAASjL,KAAKgvD,MACrC,KAACqqB,EAAA,CAjwE6B,CAASzuD,IAowEzC,SAAS41E,GAAwByL,EAAaC,GAC5C,OAAID,EAAI1oG,QAAU2oG,EAAeD,EAC1B,GAAPlgG,OAAUkgG,EAAIptF,UAAU,EAAGqtF,EAAS,GAAE,OAAAngG,OAAMkgG,EAAIptF,UAAUotF,EAAI1oG,OAAS2oG,EAAS,GAClF,CC99Ee,SAASC,GAAyBxhB,EAAQyhB,GACvD,GAAc,MAAVzhB,EAAgB,MAAO,CAAC,EAC5B,IACIhtF,EAAK6F,EADLgG,ECHS,SAAuCmhF,EAAQyhB,GAC5D,GAAc,MAAVzhB,EAAgB,MAAO,CAAC,EAC5B,IAEIhtF,EAAK6F,EAFLgG,EAAS,CAAC,EACV6iG,EAAahvG,OAAOkH,KAAKomF,GAE7B,IAAKnnF,EAAI,EAAGA,EAAI6oG,EAAW9oG,OAAQC,IACjC7F,EAAM0uG,EAAW7oG,GACb4oG,EAASxtF,QAAQjhB,IAAQ,IAC7B6L,EAAO7L,GAAOgtF,EAAOhtF,IAEvB,OAAO6L,CACT,CDRe,CAA6BmhF,EAAQyhB,GAElD,GAAI/uG,OAAOivG,sBAAuB,CAChC,IAAIC,EAAmBlvG,OAAOivG,sBAAsB3hB,GACpD,IAAKnnF,EAAI,EAAGA,EAAI+oG,EAAiBhpG,OAAQC,IACvC7F,EAAM4uG,EAAiB/oG,GACnB4oG,EAASxtF,QAAQjhB,IAAQ,GACxBN,OAAOC,UAAUkvG,qBAAqB7sG,KAAKgrF,EAAQhtF,KACxD6L,EAAO7L,GAAOgtF,EAAOhtF,GAEzB,CACA,OAAO6L,CACT,CEmBA,IAAMijG,GAAgB,QAChBC,GAAgB,QAChBC,GAAmB,WACnBC,GAAoB,OAU1B,SAASC,KACP,MAAO,yBAAP9gG,OAAgCG,OAAOi+F,SAAS7iE,KAClD,CAEO,IAcHwlE,GAdSC,IAA0CjjG,EAAAkjG,GAAG,CAAC,EACxDP,GhBkGmC,uBgBlGQ3iG,EAAAkjG,GAC3CN,GhBkGoC,wBgBlGQ5iG,EAAAkjG,GAC5CL,GhBkGkC,sBgBlGW7iG,EAAAkjG,GAC7CJ,GhBkGwC,4BgBlGYI,IAajDC,IAVqDnjG,EAAAojG,GAAG,CAAC,EAC5DT,IAAgB,GAAI3iG,EAAAojG,GACpBR,IAAgB,GAAI5iG,EAAAojG,GACpBP,IAAmB,GAAI7iG,EAAAojG,GACvBN,IAAoB,GAMF,oBAAAK,IAAApkG,EAAA,KAAAokG,EAAA,CAmBlB,IAAAE,EAZAC,EAqBA,OA5BkBzjG,EAAAsjG,EAAA,OAAAtvG,IAAA,wBAAAE,MACnB,WACE,MAA0C,YAAnCqO,OAAOmhG,aAAaC,UAC7B,GAAC,CAAA3vG,IAAA,uBAAAE,MAED,WACE,MAA0C,WAAnCqO,OAAOmhG,aAAaC,UAC7B,GAAC,CAAA3vG,IAAA,wBAAAE,OAAAuvG,EAAA3kG,EAAAzL,IAAAA,MAED,SAAA8P,IAAA,OAAA9P,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,UACQ,iBAAkB4J,OAAM,CAAAgB,EAAA5K,KAAA,eAAA4K,EAAAjL,OAAA,qBAG1BgrG,EAAgBM,wBAAyB,CAAFrgG,EAAA5K,KAAA,QACzC2qG,EAAgBO,wBAAwBjxF,GAAUA,KAA8BrP,EAAA5K,KAAA,mBACtE2qG,EAAgBQ,uBAAwB,CAAFvgG,EAAA5K,KAAA,gBAAA4K,EAAA5K,KAAA,EAC1C+qG,aAAaK,oBAAmB,OACtCT,EAAgBO,wBAAwBjxF,GAAUA,KAA8B,yBAAArP,EAAAlI,OAAA,GAAA8H,EAAA,KAEnF,kBAAAsgG,EAAAxkG,MAAA,KAAAD,UAAA,KAAAhL,IAAA,0BAAAE,OAAAsvG,EAAA1kG,EAAAzL,IAAAA,MAED,SAAAiR,EAAsC0/F,EAAergG,GAAa,IAAAsgG,EAAA,OAAA5wG,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,UAC3D2qG,EAAgBM,wBAAyB,CAAFp/F,EAAA7L,KAAA,eAAA6L,EAAAlM,OAAA,iBAI1C,OAHI2rG,EAAO,IAAI1hG,OAAOmhG,aAAaM,EAAO,CAC1CrgG,KAAMA,EACNu1D,KAAM,2BACN10D,EAAAlM,OAAA,SACK2rG,GAAI,wBAAAz/F,EAAAnJ,OAAA,GAAAiJ,EAAA,KACZ,SAAAjG,EAAA2E,GAAA,OAAAwgG,EAAAvkG,MAAA,KAAAD,UAAA,MAAAskG,CAAA,CA5BkB,IAkCfY,GAAiB,oBAAAA,IAAAhlG,EAAA,KAAAglG,EAAA,CAYpB,IAAAC,EALAC,EAcA,OArBoBpkG,EAAAkkG,EAAA,OAAAlwG,IAAA,wBAAAE,MACrB,WACE,OAAO,CACT,GAAC,CAAAF,IAAA,uBAAAE,MAED,WACE,OAAO,CACT,GAAC,CAAAF,IAAA,wBAAAE,OAAAkwG,EAAAtlG,EAAAzL,IAAAA,MAED,SAAAuR,IAAA,OAAAvR,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,cAAAkM,EAAAlM,KAAA,EACQurG,EAAkBL,wBAAwBjxF,GAAUA,KAA8B,cAAA/N,EAAAvM,OAAA,SACjFoC,QAAQxD,WAAS,wBAAA2N,EAAAxJ,OAAA,GAAAuJ,EAAA,KACzB,kBAAAw/F,EAAAnlG,MAAA,KAAAD,UAAA,KAAAhL,IAAA,0BAAAE,OAAAiwG,EAAArlG,EAAAzL,IAAAA,MAED,SAAA2mB,EAAsCgqF,EAAergG,GAAa,OAAAtQ,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,WAE5D0rG,KAAoB,CAAFpqF,EAAAthB,KAAA,eAAAshB,EAAAthB,KAAA,EAAQ4J,OAAO+hG,mBAAmBN,EAAOrgG,GAAK,OAAAsW,EAAAthB,KAAA,oBAG3D4rG,KAAmB,CAAFtqF,EAAAthB,KAAA,gBAAAshB,EAAAthB,KAAA,EAAQ4J,OAAOiiG,OAAOC,gBAAgBC,UAAUC,YAAY,CAAC,qBAAsBX,EAAOrgG,IAAM,OAAAsW,EAAAthB,KAAA,iBACrHqY,QAAQvZ,MAAM,gDAA+C,yBAAAwiB,EAAA5e,OAAA,GAAA2e,EAAA,KACnE,SAAA/W,EAAAkB,GAAA,OAAAggG,EAAAllG,MAAA,KAAAD,UAAA,MAAAklG,CAAA,CArBoB,GAyBvB,SAASG,KACP,YAA4BvsG,IAArByK,OAAOqiG,SAChB,CAIA,SAASL,KAA4B,IAAAM,EAAAC,EACnC,YAAqDhtG,KAAjC,QAAb+sG,EAAAtiG,OAAOiiG,cAAM,IAAAK,GAAiB,QAAjBC,EAAbD,EAAeJ,uBAAe,IAAAK,OAAjB,EAAbA,EAAgCJ,UACzC,CAIO,IAAMK,GAAWV,MAAsBE,KAAoBL,GAAoBZ,GAKrF,SAAA0B,KAAA,OAAAA,GAAAlmG,EAAAzL,IAAAA,MAHM,SAAA6mB,EAA8BusC,GAAc,OAAApzD,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,UAC5CwqG,GAAoB8B,oBAAuB9B,GAAoB18C,EAAK1wD,MAAK,CAAAokB,EAAAxhB,KAAA,eAAAwhB,EAAA7hB,OAAA,wBAAA6hB,EAAAxhB,KAAA,EACxEosG,GAASlB,wBAAwBp9C,EAAKsC,QAASm8C,GAAUz+C,EAAKuC,UAAS,wBAAA7uC,EAAA9e,OAAA,GAAA6e,EAAA,MAC9Ejb,MAAA,KAAAD,UAAA,CAEM,SAASmmG,KAAgD,IAAAC,EAC9D,QAA4BttG,IAAxBqrG,GACF,OAAOA,GAET,IAAMrhG,EAAIohG,KAEV,OADAC,GAA0C,QAAvBiC,EAAItkG,EAAMuB,WAAWP,UAAE,IAAAsjG,EAAAA,EAAI,CAAC,CAEjD,CAQA,IAAMC,GAAsB,gCACtBC,GAAe,8BAOd,SAASC,GAAgB/3F,EAAqBg4F,GAgBnD,IAfA,IAAM5jG,EAAI4jG,EAAYh9F,QAAQ88F,IAAc,SAACG,EAAQC,GACnD,IAAMzjE,EAAO3gC,SAAS4P,cAAc,KAIpC,OAHA+wB,EAAKyqD,aAAa,OAAQ,UAAYgZ,GACtCzjE,EAAKyqD,aAAa,QAAS,cAC3BzqD,EAAKvsB,YAAcgwF,EAAWtqG,MAAM,EAAG,GAChC6mC,EAAK0jE,SACd,IAAGn9F,QAAQ68F,IAAqB,SAACI,EAAQrxF,EAASm4E,GAChD,IAAMtqD,EAAO3gC,SAAS4P,cAAc,KAKpC,OAJA+wB,EAAKyqD,aAAa,qBAAsBH,GACxCtqD,EAAKyqD,aAAa,SAAU,UAC5BzqD,EAAKvsB,YAAc62E,EAAKnxF,MAAM,EAAG,GACjC4mC,GAAY5tB,EAAS6tB,GACdA,EAAK0jE,SACd,IACM73F,EAAM5C,GAAI06F,SAAShkG,GAAG+B,KACrBmK,EAAII,YAAYV,EAAOmB,YAAYb,EAAII,WAChD,CAMO,SAASg3F,GAAWM,GAIzB,OAHuBA,EAAYh9F,QAAQ68F,IAAqB,SAACI,EAAQI,EAAUtZ,GACjF,OAAOA,EAAKnxF,MAAM,EAAG,EACvB,GAEF,kBChLA,IAEqB0qG,GAAY,SAAAt5B,GAAA/rE,EAAAqlG,EAAAt5B,GAAA,IAsb9Bu5B,EAPDl5B,EATAC,EA7CAk5B,EALAt5B,EAVAC,EAdAkF,EAnBCo0B,EAxCDC,EARCC,EAlBAC,EAnBA35B,EATDG,EAxDCy5B,MAnL8BtoF,KAAA+nF,iZAe/B,SAAAA,EAAaniG,GAAmB,IAAA6L,EAAAtQ,EAAA,KAAA4mG,GACvB3lG,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,8BAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,gBACPA,EAAK7L,KAAOA,EACZ,IAAM6d,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAc/vC,GAE3C6L,EAAK8jC,MAAQpoC,GAAImG,cAAcmQ,EAAK8xB,MAAO,iBAC3C9jC,EAAK82F,gBAAkBp7F,GAAImG,cAAcmQ,EAAK8kF,gBAAiB,wBAE/D9kF,EAAK+kF,SAASv3C,QAAiD,MAAvCluD,EAAMuB,WAAWvB,EAAMwB,YAC/C4I,GAAI1K,KAAKghB,EAAK+kF,SAAU,SAAS,WAC/BzlG,EAAMgE,WAAWhE,EAAMwB,WAAYkf,EAAK+kF,SAASv3C,QAAmB,IAAM,KACtExtC,EAAK+kF,SAASv3C,QAChB1tD,SAASqC,KAAKqL,UAAUC,IAAI,QAE5B3N,SAASqC,KAAKqL,UAAUM,OAAO,OAEnC,IAEAkS,EAAKglF,UAAUx3C,QAA+C,MAArCluD,EAAMuB,WAAWvB,EAAMiE,UAChDmG,GAAI1K,KAAKghB,EAAKglF,UAAW,SAAS,WAChC,IAAM72F,EAAO6R,EAAKglF,UAAUx3C,UAAW,EACvCluD,EAAMgE,WAAWhE,EAAMiE,SAAU4K,EAAO,IAAM,KAC9C2R,KAAMmlF,WAAa92F,CACrB,IAEA6R,EAAKvZ,WAAWyN,YAAc4L,KAAMrZ,WAAWiN,UAAU,EAAG,GAC5DhK,GAAI1K,KAAKghB,EAAKklF,QAAS,SAAS,WAC9Bl3F,EAAKy9D,YAAYzL,UACjBhyD,EAAKkrE,SAASl5D,EAAKyrD,YACrB,IAEAz9D,EAAK82F,gBAAgB1vG,SAAQ,SAAAkf,GAC3B5K,GAAI1K,KAAKsV,EAAK,SAAQhX,EAAAzL,IAAAA,MAAE,SAAA8P,IAAA,IAAA1D,EAAA,OAAApM,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,cAAA4K,EAAA5K,KAAA,EACJuL,EAAS,wBAAyB,CAClDoe,SAAUxM,EAAIk5C,QACdgyB,OAAQlrE,EAAI5hB,QACZ,OAIF,OAPMuL,EAAG8D,EAAApL,KAIJmpB,KAAM6mC,cAAc1oD,KACvBqW,EAAIk5C,SAAWl5C,EAAIk5C,SAErBzrD,EAAA5K,KAAA,EACM2oB,KAAMqhD,YAAW,wBAAAp/D,EAAAlI,OAAA,GAAA8H,EAAA,KAE3B,IAGAqM,EAAKi+D,aAAe,IAAIn6B,GAA4B9xB,EAAKisD,aAAY,eAAAn9D,EAAAxR,EAAAzL,IAAAA,MAAE,SAAAiR,EAAO8P,EAAiBm9C,GAAY,IAAAj8C,EAAAmG,EAAA62C,EAAAob,EAAA,OAAAr6E,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,UACrGyb,IAAYiN,GAAa,CAAA7c,EAAA7L,KAAA,eAAA6L,EAAA7L,KAAA,EACrB2oB,KAAMqhD,YAAW,OACC,OAAxBpgE,OAAOi+F,SAASmG,SAAQniG,EAAAlM,OAAA,iBAIC,GADrBgd,EAAQgM,KAAMoW,OAAOtjB,KACrBqH,EAASnG,EAAMmG,QACT,CAAFjX,EAAA7L,KAAA,SACkD,OAApD25D,EAAY9iD,EAAKo3F,WAAWj1C,WAAWr8C,EAAMN,QAAOxQ,EAAA7L,KAAA,GAC7B6W,EAAKo+D,kBAAkBx5D,EAASoN,EAAKisD,cAAa,QACf,GAD1DC,EAAclpE,EAAArM,KACpBqX,EAAK89D,oBAAoBO,SAASz5D,EAASm9C,EAAMmc,KAC7CjyD,EAAOI,QAAUJ,EAAOozB,QAAQxI,WAAa,EAAIisB,EAAU55C,OAASg1D,GAAc,CAAAlpE,EAAA7L,KAAA,SAC1C,OAA1C6W,EAAKs+D,mBAAmBtsD,EAAKisD,cAAajpE,EAAAlM,OAAA,kBAIb,OAD/BkX,EAAKu+D,eAAeC,UAAU55D,EAASs5D,EAAgBnc,GACvD/hD,EAAK27D,UAAU3pD,EAAKysD,YAAWzpE,EAAAlM,OAAA,kBAIjCkX,EAAK89D,oBAAoBO,SAASz5D,EAASm9C,EAAM,GACjD/hD,EAAK49D,cAAcS,SAASz5D,GAC5B5E,EAAK27D,UAAU3pD,EAAK4rD,eAAc,yBAAA5oE,EAAAnJ,OAAA,GAAAiJ,EAAA,KACnC,gBAAAjG,EAAA2E,GAAA,OAAAsN,EAAArR,MAAA,KAAAD,UAAA,EAxBoE,IA2BrEwQ,EAAK89D,oBAAsB,IAAIh6B,GAA8B9xB,EAAK0sD,gBAAgB,WAChF1+D,EAAKm+D,oBACP,IAAG,WACDn+D,EAAK+9D,gBAAgB/rD,EAAK0sD,eAC5B,IAGA1+D,EAAK49D,cAAgB,IAAI95B,GACvB9xB,EAAK4rD,eACL,SAAAh5D,GAAO,OAAI5E,EAAK69D,iBAAiBj5D,EAAS5E,EAAK89D,oBAAoB/b,KAAK,IACxE,kBAAM/hD,EAAK+9D,gBAAgB/rD,EAAK4rD,cAAc,IAGhD59D,EAAKu+D,eAAiB,IAAIz6B,GAAqB9xB,EAAKysD,YAAY,WAC9Dz+D,EAAKs+D,mBAAmBtsD,EAAKysD,WAC/B,IAAG,WAAQz+D,EAAK+9D,gBAAgB/rD,EAAKysD,WAAY,IAGjDz+D,EAAKy9D,YAAc,IAAI35B,GAAqB9xB,EAAKyrD,YAAW,eAAAl4D,EAAAjW,EAAAzL,IAAAA,MAAE,SAAAuR,EAAO0sD,EAAcH,GAAgB,OAAA99D,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OACjG6W,EAAKo3F,WAAat1C,EAClB9hD,EAAK89D,oBAAoBjW,YAAY/F,EAAIH,GACzC3hD,EAAKu+D,eAAe1W,YAAY/F,GAChC9hD,EAAKi+D,aAAapW,YAAY/F,EAAIH,GAClC3hD,EAAK+9D,gBAAgB/rD,EAAKyrD,aAAY,wBAAApoE,EAAAxJ,OAAA,GAAAuJ,EAAA,KACvC,gBAAA3B,EAAAkB,GAAA,OAAA4Q,EAAA9V,MAAA,KAAAD,UAAA,EAN2D,IAQ5DkM,GAAI1K,KAAKghB,EAAKqlF,cAAe,SAAS,kBAAMr3F,EAAKs3F,qBAAqBtlF,EAAKulF,2BAA2B,IACtGzzD,GAAW9xB,EAAKulF,2BAA4BvlF,EAAKwlF,+BAA+B,kBAAMx3F,EAAKq3F,eAAe,IAE1G37F,GAAI1K,KAAKghB,EAAKylF,YAAa,SAAS,kBAAMz3F,EAAKkrE,SAASl5D,EAAK0lF,gBAAgB,IAC7E5zD,GAAW9xB,EAAK0lF,gBAAiB1lF,EAAK2lF,aAAa,kBAAM33F,EAAKy3F,aAAa,IAE3Ez3F,EAAKs/D,iBAAmB,IAAIx7B,GAAuB9xB,EAAKqtD,eAAc/vE,EAAAzL,IAAAA,MAAE,SAAA2mB,IAAA,OAAA3mB,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,cAAAshB,EAAAthB,KAAA,EAChE2oB,KAAM2yB,SAAS,SAAQ,OAC7B/oC,GAAI2E,KAAK2R,EAAK8xB,OAAM,wBAAAr5B,EAAA5e,OAAA,GAAA2e,EAAA,MAEtB9O,GAAI1K,KAAKghB,EAAK0lD,WAAY,SAAS,WACjC13D,EAAKs/D,iBAAiBtN,UACtBhyD,EAAKkrE,SAASl5D,EAAKqtD,gBACnBr/D,EAAKs/D,iBAAiB1pD,OACxB,IAEAla,GAAI1K,KAAKghB,EAAK4lF,YAAa,UAAU,kBAAM53F,EAAK63F,qBAAqB,IACrEn8F,GAAI1K,KAAKghB,EAAK8lF,cAAe,SAAS,kBAAM93F,EAAK+3F,kBAAkB,IACnEr8F,GAAI1K,KAAKghB,EAAKgmF,WAAY,SAAS,kBAAMhmF,EAAK4lF,YAAY98E,OAAO,IAEjEpf,GAAI1K,KAAKghB,EAAKimF,WAAY,SAAS,WACjCv8F,GAAI2E,KAAK2R,EAAKkmF,eACdl4F,EAAKkrE,SAASl5D,EAAKmmF,eACrB,IACAr0D,GAAW9xB,EAAKmmF,eAAgBnmF,EAAKomF,kBAAkB,kBAAMp4F,EAAKq4F,qBAAqB,IAEvF38F,GAAI1K,KAAKghB,EAAKsmF,aAAc,SAAS,kBAAMt4F,EAAKkrE,SAASl5D,EAAKumF,aAAa,IAC3E78F,GAAI1K,KAAKghB,EAAKwmF,eAAgB,SAAS,kBAAMx4F,EAAKy4F,gBAAgB,IAElE,IAAM90B,EAAc,WAClBjoE,GAAI2E,KAAK2R,EAAK8xB,OACd9xB,EAAK0mF,aAAah0G,MAAQ,GAC1BstB,EAAK2mF,WAAWzyF,YAAc,GAC9B8L,EAAK4mF,SAAS1yF,YAAc,EAC9B,EAiBgC,OAfhCxK,GAAI1K,KAAKghB,EAAK8xB,MAAO,aAAa,SAACrxC,GAC5BiJ,GAAIk6C,eAAenjD,EAAGuN,EAAKynC,cAAgBk8B,GAClD,IAEA3jE,EAAK61C,MAAQ,SAACpjD,GACE,WAAVA,EAAEjO,KACJm/E,GAEJ,EACAjoE,GAAI1K,KAAKc,SAAU,QAASkO,EAAK61C,OAEjC7jC,EAAK8xB,MAAMxiC,iBAAiB,gBAAgBla,SAAQ,SAAAyU,GAClDH,GAAI1K,KAAK6K,EAAI,SAAS,WAAQ8nE,GAAc,GAC9C,IAEA3jE,EAAK64F,4BAA2B74F,CAClC,CA2SC,OA3SAxP,EAAA8lG,EAAA,EAAA9xG,IAAA,oBAAAE,MAED,SAAmB+N,GACjB,IAAMqmG,EAAWrmG,EAAEpC,OACb0oG,EAAWD,EAASE,aAAa,QACtB,OAAbD,GDvCD,SAA4BA,EAAkBpW,GACnDgT,KACAhC,GAAoBoF,GAAYpW,EAChCrxF,EAAMgE,WAAWo+F,KAA0BC,GAC7C,CCqCIsF,CAAkBF,EADFD,EAASt5C,QAE3B,GAAC,CAAAh7D,IAAA,yBAAAE,MAED,WAEE,OADoBixG,IAEtB,GAAC,CAAAnxG,IAAA,4BAAAE,OAAAmyG,EAAAvnG,EAAAzL,IAAAA,MAED,SAAAopB,IAAA,IAAA+E,EAAAknF,EAAA78E,EAAArV,EAAAmyF,EAAAC,EAAArsF,EAAA,YAAAlpB,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OACQ6oB,EAAOnrB,KAAKmrB,KACZknF,EAAeryG,KAAKwyG,yBACpBh9E,EAASu3E,IACT5sF,EAAOgL,EAAKsnF,6BACbryF,gBAAgB,MACfkyF,EAAYnnF,EAAKunF,6BACvB79F,GAAImD,MAAMmT,EAAKunF,8BAEfr1G,OAAOkH,KAAKixB,GAAQj1B,SAAQ,SAAC2xG,GAC3B,IAAMz8F,EAAO0K,EAAKsL,WAAU,GACtBqwE,EAAUuW,EAAaH,GACvBD,EAAWp9F,GAAIi7C,YAAYr6C,EAAM,YACvCZ,GAAIi7C,YAAYr6C,EAAM,SAAS4J,YAAc9C,GAAUiZ,EAAO08E,IAC9DD,EAAS5b,aAAa,OAAQ6b,GAC1BpW,GAASmW,EAAS5b,aAAa,UAAW,WAC9Cic,EAAUh6F,YAAY7C,GACtBZ,GAAI1K,KAAK8nG,EAAU,QAAS/rF,EAAKksF,kBACnC,IAEMG,EAAkBpnF,EAAKyjF,mBAE7B/5F,GAAI1K,KAAKooG,EAAiB,QAAO,eAAA3vE,EAAAn6B,EAAAzL,IAAAA,MAAE,SAAA6mB,EAAOjY,GAAQ,IAAAqmG,EAAA,OAAAj1G,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,WAC5CosG,GAASjB,uBAAwB,CAAF3pF,EAAAxhB,KAAA,eAAAwhB,EAAA7hB,OAAA,iBACV,KAAnBgwG,EAAWrmG,EAAEpC,QACNmvD,QAAS,CAAF70C,EAAAxhB,KAAA,eAAAwhB,EAAAxhB,KAAA,EACZosG,GAASiE,wBAAuB,OACtCV,EAASt5C,SAAW+1C,GAASjB,uBAAsB,OAErDvnF,EAAKksF,kBAAkBxmG,GACvBqmG,EAASW,cAAc,IAAIC,MAAM,WAAU,wBAAA/uF,EAAA9e,OAAA,GAAA6e,EAAA,KAC5C,gBAAA9V,GAAA,OAAA60B,EAAAh6B,MAAA,KAAAD,UAAA,EATgC,IAWjCkM,GAAI1K,KAAKooG,EAAiB,UAAU,SAAC3mG,GACnC,IAAMqmG,EAAWrmG,EAAEpC,OACbspG,EAAapE,GAASjB,uBAC5B54F,GAAIqf,OAAO+9E,EAASt5C,QAASxtC,EAAKunF,8BAClC79F,GAAIqf,OAAO4+E,EAAY3nF,EAAK4nF,uBAC5Bd,EAAS/sF,SAAW4tF,CACtB,IAEAP,EAAgB55C,QAAW+1C,GAASnB,yBAA2B8E,EAAazD,mBAC5E2D,EAAgBK,cAAc,IAAIC,MAAM,WAAU,yBAAAvsF,EAAAthB,OAAA,GAAAohB,EAAA,UACnD,kBAAA4pF,EAAApnG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,YAAAE,MAIA,SAAWm1G,GACT/1D,GAAgBj9C,KAAK4gD,YAAaoyD,GAClChzG,KAAK4gD,YAAcoyD,CACrB,GAEA,CAAAr1G,IAAA,oBAAAE,OAAA04E,EAAA9tE,EAAAzL,IAAAA,MACA,SAAA+sB,EAAyBhM,EAAiB6oC,GAAiB,IAAAtI,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,OACvB,OAA5Bg8C,EAASrzB,KAAMuzB,QAAQoI,GAAKv8B,EAAA/nB,KAAA,EAChBuL,EAAS,sBAAuB,CAAEkQ,QAAAA,IAAU,OACtD,GADF3U,EAAGihB,EAAAvoB,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFihB,EAAA/nB,KAAA,eAAA+nB,EAAApoB,OAAA,SACpB,GAAC,cAAAooB,EAAApoB,OAAA,SAEHmH,EAAI4uE,WAAS,wBAAA3tD,EAAArlB,OAAA,GAAA+kB,EAAA,KACrB,SAAA1b,EAAAqV,GAAA,OAAA6yD,EAAA3tE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,OAAAu4E,EAAA3tE,EAAAzL,IAAAA,MAED,SAAAmxC,EAAwBpwB,EAAiBm9C,GAAY,IAAApvB,EAAA3gB,EAAAlM,EAAAmG,EAAA+yD,EAAAd,EAAA,OAAAr6E,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,cAAA+rC,EAAA/rC,KAAA,EAChC2oB,KAAMqhD,YAAW,OAA1B,GAAJxgC,EAAIuC,EAAAvsC,KACC,CAAFusC,EAAA/rC,KAAA,eAAA+rC,EAAApsC,OAAA,iBAIsD,OAHzDkpB,EAAOnrB,KAAKmrB,KACZlM,EAAQ6sB,EAAKzK,OAAOtjB,GACpBqH,EAASnG,EAAMmG,OACf+yD,EAAUn4E,KAAKuwG,WAAWj1C,WAAWr8C,EAAMN,QAAQ0D,OAAMgsB,EAAA/rC,KAAA,GAElCtC,KAAKu3E,kBAAkBx5D,EAASoN,EAAK4rD,eAAc,QACvB,GADnDM,EAAchpC,EAAAvsC,KACpB9B,KAAKi3E,oBAAoBg8B,QAAQl1F,EAASs5D,KACtCjyD,EAAOI,QAAUJ,EAAOozB,QAAQxI,WAAa,EAAImoC,EAAUd,GAAc,CAAAhpC,EAAA/rC,KAAA,gBAAA+rC,EAAA/rC,KAAA,GACrEtC,KAAKy3E,mBAAmBtsD,EAAK4rD,eAAc,eAAA1oC,EAAApsC,OAAA,kBAInDjC,KAAK03E,eAAeC,UAAU55D,EAASs5D,EAAgBnc,GACvDl7D,KAAK80E,UAAU3pD,EAAKysD,YAAW,yBAAAvpC,EAAArpC,OAAA,GAAAmpC,EAAA,UAChC,SAAA1nB,EAAAiD,GAAA,OAAA0sD,EAAAxtE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,sBAAAE,OAAAkyG,EAAAtnG,EAAAzL,IAAAA,MAED,SAAAi6C,IAAA,IAAA9rB,EAAA+rC,EAAA,OAAAl6D,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,OAEsC,GAD9B6oB,EAAOnrB,KAAKmrB,MACZ+rC,EAAQ/rC,EAAK4lF,YAAY75C,QAChBA,EAAM3zD,OAAM,CAAA2zC,EAAA50C,KAAA,eAAA40C,EAAAj1C,OAAA,iBAC3BkpB,EAAK+nF,gBAAgB7zF,YAAc63C,EAAM,GAAGnzD,KAC5C8Q,GAAIyE,KAAK6R,EAAK8lF,eACdp8F,GAAI2E,KAAK2R,EAAKgmF,YAAW,wBAAAj6D,EAAAlyC,OAAA,GAAAiyC,EAAA,UAC1B,kBAAA84D,EAAAnnG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,mBAAAE,MACA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBA,EAAK4lF,YAAYlzG,MAAQ,GACzBstB,EAAK+nF,gBAAgB7zF,YAAc9C,GAAUA,GAC7C1H,GAAI2E,KAAK2R,EAAK8lF,eACdp8F,GAAIyE,KAAK6R,EAAKgmF,WAChB,GAAC,CAAAxzG,IAAA,uBAAAE,OAAAiyG,EAAArnG,EAAAzL,IAAAA,MAED,SAAAohD,EAA4BsyD,GAAuC,OAAA1zG,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,OACpDtC,KAAKmrB,KACbgoF,iBAAiB9zF,YAAc,GACpCrf,KAAKqkF,SAASqsB,GAA2B,wBAAAnyD,EAAAv5C,OAAA,GAAAo5C,EAAA,UAC1C,SAAAz0B,GAAA,OAAAmmF,EAAAlnG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,OAAAgyG,EAAApnG,EAAAzL,IAAAA,MACA,SAAA0hD,IAAA,IAAAvzB,EAAAioF,EAAAl8C,EAAAm8C,EAAAC,EAAAC,EAAAC,EAAAC,EAAA72D,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,OAEwB,GADhB6oB,EAAOnrB,KAAKmrB,KACdioF,EAAgB,IAChBjoF,EAAK4lF,YAAYlzG,MAAO,CAAF8gD,EAAAr8C,KAAA,SACY,IAA9B40D,EAAQ/rC,EAAK4lF,YAAY75C,QAChBA,EAAM3zD,OAAM,CAAAo7C,EAAAr8C,KAAA,QACwB,OAAjDqY,QAAQvZ,MAAM,oCAAmCu9C,EAAA18C,OAAA,wBAAA08C,EAAAr8C,KAAA,EAG7B40D,EAAM,GAAGvpD,OAAM,OAArCylG,EAAaz0D,EAAA78C,KAAA,QAAA68C,EAAA95C,KAAG,GAIhBwuG,EAAUhnG,KAAKG,MAAM4mG,GAAcz0D,EAAAr8C,KAAA,iBAGJ,OAHIq8C,EAAA95C,KAAA,GAAA85C,EAAAjxC,GAAAixC,EAAA,UAEnCxzB,EAAKgoF,iBAAiB9zF,YAAcs/B,EAAAjxC,GAAEo3B,QACtCjwB,GAAIyE,KAAK6R,EAAKgoF,kBAAiBx0D,EAAA18C,OAAA,0BAGV,IAAZoxG,EAAuB,CAAA10D,EAAAr8C,KAAA,SAC2C,OAA3EuS,GAAI+4D,cAAcziD,EAAKgoF,iBAAkB52F,GjB5Sd,mBiB4SgDoiC,EAAA18C,OAAA,kBAQtC,OALGsxG,GAHmCD,EAG1CD,GAA3BG,MAAAA,OAAK,IAAAD,EAAG,GAAEA,EAAKE,EAAOtH,GAAAmH,EAAAI,IACxB92D,EAAM,CACVy2D,QAASI,EACTD,MAAOA,GAEHl1D,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAKqxC,EAAAr8C,KAAA,GACrBuL,EAAS,qBAAsB+uC,GAAI,QAC7C,GADFxzC,EAAGu1C,EAAA78C,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFu1C,EAAAr8C,KAAA,SACsB,OAAjDuS,GAAI+4D,cAAcziD,EAAKgoF,iBAAkB/pG,EAAIwE,KAAI+wC,EAAA18C,OAAA,yBAAA08C,EAAAr8C,KAAA,GAG7C2oB,KAAMqhD,YAAW,QACvBz3D,GAAI2E,KAAK2R,EAAK8xB,OAEd/wC,OAAOi+F,SAASmG,SAAQ,yBAAA3xD,EAAA35C,OAAA,GAAA05C,EAAA,oBACzB,kBAAAmxD,EAAAjnG,MAAA,KAAAD,UAAA,KAAAhL,IAAA,sBAAAE,OAAA+xG,EAAAnnG,EAAAzL,IAAAA,MAED,SAAAkiD,IAAA,IAAA/zB,EAAAsiD,EAAAnvB,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,OAGyC,OAFjC6oB,EAAOnrB,KAAKmrB,KACZsiD,EAAKtiD,EAAK0mF,aAAah0G,MACvBygD,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAKqyC,EAAAr9C,KAAA,EACrBuL,EAAS,kBAAmB,CAAEwjD,KAAMoc,IAAK,OACnD,GADFrkE,EAAGu2C,EAAA79C,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFu2C,EAAAr9C,KAAA,SACmB,OAA9CuS,GAAI+4D,cAAcziD,EAAKkmF,cAAejoG,EAAIwE,KAAI+xC,EAAA19C,OAAA,kBAGhDkpB,EAAK0mF,aAAah0G,MAAQ,GACF,MAApBuL,EAAIooE,KAAKjuE,QAAiD,IAA/B6F,EAAIooE,KAAKlmE,MAAM,KAAK/H,OACjD4nB,EAAK2mF,WAAWzyF,YAAcjW,EAAIooE,KAAKhhD,MAAM,YAAY+gC,KAAI,SAACoiD,GAAa,IAAAC,EAAA,OAA2B,QAA3BA,EAAKD,EAAMnjF,MAAM,kBAAU,IAAAojF,OAAA,EAAtBA,EAAwBznD,KAAK,IAAI,IAAEA,KAAK,MACnHhhC,EAAK4mF,SAAS1yF,YAAcjW,EAAIooE,KACvCxxE,KAAKqkF,SAASl5D,EAAK0oF,sBAAqB,yBAAAl0D,EAAA36C,OAAA,GAAAk6C,EAAA,UACzC,kBAAA0wD,EAAAhnG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,WAAAE,OAAA29E,EAAA/yE,EAAAzL,IAAAA,MACA,SAAAkmE,EAAgBtc,GAAiB,IAAAz7B,EAAAoQ,EAAA,OAAAv+B,IAAAA,MAAA,SAAAo/D,GAAA,cAAAA,EAAAv3D,KAAAu3D,EAAA95D,MAAA,OAM8B,OALvD6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK4gD,YAAcgG,EACnB5mD,KAAKi9C,MAAM18C,SAAQ,SAAAqmD,GAAI,OAAI/xC,GAAI2E,KAAKotC,EAAK,IACzCA,EAAKrsC,MAAMvE,MAAQ,UACnBnB,GAAIyE,KAAK6R,EAAK8xB,MAAO2J,GACfrrB,GAASpQ,EAAK8xB,MAAMvmC,YAAckwC,EAAKlwC,aAAe,EAAC0lD,EAAA95D,KAAA,EACvDuS,GAAIyF,QAtWU,KAsWe,SAAA60C,GACjCvI,EAAKrsC,MAAMvE,MAAQ,GAAHjK,QAAO,EAAIojD,GAAY5zB,EAAK,KAC9C,GAAG,eAAc,OACjBqrB,EAAKrsC,MAAMvE,MAAQ,IAAG,wBAAAomD,EAAAp3D,OAAA,GAAAk+D,EAAA,UACvB,SAAAt5C,GAAA,OAAA4xD,EAAA5yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,cAAAE,OAAAy4E,EAAA7tE,EAAAzL,IAAAA,MACA,SAAA0mE,IAAA,IAAAlH,EAAAtF,EAAA,OAAAl6D,IAAAA,MAAA,SAAAomE,GAAA,cAAAA,EAAAv+D,KAAAu+D,EAAA9gE,MAAA,OACe,GAATk6D,EAAO,IACPx8D,KAAK42E,YAAYzrD,KAAK2vC,SAASj9D,MAAO,CAAFulE,EAAA9gE,KAAA,QACY,KAA5C40D,EAAQl3D,KAAK42E,YAAYzrD,KAAK2vC,SAAS5D,SAChCA,EAAM3zD,OAAM,CAAA6/D,EAAA9gE,KAAA,eAAA8gE,EAAA9gE,KAAA,EAAe40D,EAAM,GAAGvpD,OAAM,OAA5B6uD,EAAI4G,EAAAthE,KAAA,cAAAshE,EAAAnhE,OAAA,SAE1Bu6D,GAAI,wBAAA4G,EAAAp+D,OAAA,GAAA0+D,EAAA,UACZ,kBAAA4S,EAAA1tE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,qBAAAE,OAAAw4E,EAAA5tE,EAAAzL,IAAAA,MACA,SAAA+qE,IAAA,OAAA/qE,IAAAA,MAAA,SAAA4mE,GAAA,cAAAA,EAAA/+D,KAAA++D,EAAAthE,MAAA,OACE4J,OAAOi+F,SAASmG,SAAQ,wBAAA1sC,EAAA5+D,OAAA,GAAA+iE,EAAA,KACzB,kBAAAsO,EAAAztE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,cAAAE,OAAA8xG,EAAAlnG,EAAAzL,IAAAA,MACA,SAAA0rE,IAAA,IAAAv9C,EAAA2oF,EAAAx1D,EAAA1B,EAAAxzC,EAAA,OAAApM,IAAAA,MAAA,SAAAgrE,GAAA,cAAAA,EAAAnjE,KAAAmjE,EAAA1lE,MAAA,OASE,GARM6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK4oF,gBAERD,EAAc,WAClB3oF,EAAK6oF,MAAMn2G,MAAQ,GACnBstB,EAAK6lD,SAASnzE,MAAQ,GACtBstB,EAAK8oF,aAAap2G,MAAQ,EAC5B,EAEKstB,EAAK6oF,MAAMn2G,OAAUstB,EAAK6lD,SAASnzE,OAAUstB,EAAK8oF,aAAap2G,MAAK,CAAAmqE,EAAA1lE,KAAA,QAE1D,OADbuS,GAAI+4D,cAAcziD,EAAK4oF,eAAgBx3F,GjBtZL,0BiBuZlCu3F,IAAa9rC,EAAA/lE,OAAA,oBAIXkpB,EAAK6lD,SAASnzE,QAAUstB,EAAK8oF,aAAap2G,MAAK,CAAAmqE,EAAA1lE,KAAA,SAEpC,OADbuS,GAAI+4D,cAAcziD,EAAK4oF,eAAgBx3F,GAAUA,IACjDu3F,IAAa9rC,EAAA/lE,OAAA,kBAQF,OALPq8C,EAASrzB,KAAMuzB,QAAQrzB,EAAKylF,aAC5Bh0D,EAAM,CACVo3D,MAAO7oF,EAAK6oF,MAAMn2G,MAClBmzE,SAAU7lD,EAAK6lD,SAASnzE,OAE1Bi2G,IAAa9rC,EAAA1lE,KAAA,GACKuL,EAAS,qBAAsB+uC,GAAI,QAC7C,GADFxzC,EAAG4+D,EAAAlmE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF4+D,EAAA1lE,KAAA,SACoB,OAA/CuS,GAAI+4D,cAAcziD,EAAK4oF,eAAgB3qG,EAAIwE,KAAIo6D,EAAA/lE,OAAA,kBAGjD4S,GAAI2E,KAAK2R,EAAK8xB,OAAM,yBAAA+qB,EAAAhjE,OAAA,GAAA0jE,EAAA,UACrB,kBAAAinC,EAAA/mG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,SAAAE,MAIA,WACEgX,GAAImU,OAAO/d,SAAU,QAASjL,KAAKgvD,MACrC,GAEA,CAAArxD,IAAA,kBAAAE,OAAA44E,EAAAhuE,EAAAzL,IAAAA,MACA,SAAA6rE,EAAuBkP,GAAoB,IAAAnxB,EAAA,OAAA5pD,IAAAA,MAAA,SAAA2rE,GAAA,cAAAA,EAAA9jE,KAAA8jE,EAAArmE,MAAA,OACzCuS,GAAI2E,KAAKu+D,GACHnxB,EAAO5mD,KAAKmrB,KAAKisD,aACvBp3E,KAAK4gD,YAAcgG,EACnB5mD,KAAKo3E,aAAa98D,UAClBzF,GAAIyE,KAAKstC,GAAK,wBAAA+hB,EAAA3jE,OAAA,GAAA6jE,EAAA,UACf,SAAAh/C,GAAA,OAAA4sD,EAAA7tE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,qBAAAE,OAAA24E,EAAA/tE,EAAAzL,IAAAA,MACA,SAAA4sE,EAA0BmO,GAAoB,IAAAnxB,EAAA,OAAA5pD,IAAAA,MAAA,SAAAisE,GAAA,cAAAA,EAAApkE,KAAAokE,EAAA3mE,MAAA,OAC5CtC,KAAKi3E,oBAAoB38D,UACnBssC,EAAO5mD,KAAKmrB,KAAK0sD,eACvB73E,KAAK4gD,YAAcgG,EACnB/xC,GAAI2E,KAAKu+D,GACTljE,GAAIyE,KAAKstC,GAAK,wBAAAqiB,EAAAjkE,OAAA,GAAA4kE,EAAA,UACf,SAAA7qB,GAAA,OAAAy3B,EAAA5tE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,iBAAAE,OAAA6xG,EAAAjnG,EAAAzL,IAAAA,MAED,SAAA6uE,IAAA,IAAA1gD,EAAAw4C,EAAA/1D,EAAA0wC,EAAAiqC,EAAA9rE,EAAA,OAAAzf,IAAAA,MAAA,SAAA6sE,GAAA,cAAAA,EAAAhlE,KAAAglE,EAAAvnE,MAAA,OAGuC,GAF/B6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK+oF,aACRvwC,EAAOx4C,EAAKgpF,cAAct2G,MACrB,CAAFgsE,EAAAvnE,KAAA,QAEmB,OAD1B6oB,EAAK+oF,YAAY70F,YAAc9C,GjBhRF,oBiBiR7B1H,GAAIyE,KAAK6R,EAAK+oF,aAAYrqC,EAAA5nE,OAAA,iBAImB,OADzC2L,EAAMud,EAAKipF,YAAYv2G,OAAS,GAChCygD,EAASrzB,KAAMuzB,QAAQrzB,EAAKumF,cAAa7nC,EAAAvnE,KAAA,GAC5BuL,EAAS,sBAAuB,CAAE81D,KAAAA,EAAM/1D,IAAAA,IAAM,QACzD,GADF26E,EAAI1e,EAAA/nE,KACVw8C,IACKrzB,KAAM6mC,cAAcy2B,GAAO,CAAF1e,EAAAvnE,KAAA,SAEF,OAD1B6oB,EAAK+oF,YAAY70F,YAAc9C,GAAUA,EAAmB,CAAE3O,IAAK26E,EAAK36E,MACxEiH,GAAIyE,KAAK6R,EAAK+oF,aAAYrqC,EAAA5nE,OAAA,kBAG5B4S,GAAIyE,KAAK6R,EAAKkpF,iBACdlpF,EAAKmpF,aAAa/1F,QAAQ6tB,aAAem8C,EAAKgsB,WAE9C5oE,GADiB,GACKxgB,EAAKmpF,cAC3BnpF,EAAKmpF,aAAaj1F,YAAckpE,EAAKgsB,WAC/B93F,EAAKwO,KAAMvW,SAHA,IAIjByW,EAAKqpF,gBAAgBn1F,YAAcxK,GAAIkc,gBAAgBw3D,EAAKksB,IAAKh4F,GAAG,yBAAAotD,EAAA7kE,OAAA,GAAA6mE,EAAA,UACrE,kBAAA6jC,EAAA9mG,MAAA,KAAAD,UAAA,MAAA8mG,CAAA,CAjd8B,CAAS7kF,mHClBrB8pF,GAAS,WAQ5B,SAAAA,EAAaC,EAA0BrkE,EAAoBS,GAAqBloC,EAAA,KAAA6rG,GAAA5qG,EAAA,oBAAAA,EAAA,0BAAAA,EAAA,qBAAAA,EAAA,2BAAAA,EAAA,oBAAAA,EAAA,qBAC9E9J,KAAKwxB,KAAOmjF,EAAQnjF,KACpBxxB,KAAKswC,WAAaA,EAClBtwC,KAAKw6C,MAAQm6D,EAAQn6D,MACrBx6C,KAAK+wC,YAAcA,EAEnB/wC,KAAK+4B,KAAO47E,EAAQv7E,KAAKL,MAAQ,GACjC/4B,KAAKg5B,MAAQ27E,EAAQv7E,KAAKJ,OAAS,EACrC,CA6GC,OA3GDrvB,EAAA+qG,EAAA,EAAA/2G,IAAA,MAAAE,MACA,SAAKsrB,GACH,GAAsB,IAAlBA,EAAIyrF,UAAR,CAeA,IAAMjkF,EAAOxH,EAAIsG,KAAOzvB,KAAKg5B,MAAQh5B,KAAK+4B,KAC1CpI,EAAKkpC,OA+FT,SAAkBlpC,EAAmBrU,EAAcu4F,GACjD,IAAK,IAAIrxG,EAAI,EAAGA,EAAImtB,EAAKptB,OAAQC,IAC/B,GAAKmtB,EAAKntB,GAAG8Y,KAAOA,IAAUu4F,EAAM,OAAOrxG,EAE7C,OAAOmtB,EAAKptB,MACd,CApGgBuxG,CAAQnkF,EAAMxH,EAAI7M,MAAO6M,EAAIsG,MAAO,EAAGtG,EAFnD,MAFEjd,OAAOsnC,IAAI,UAAW,kCAAmCrqB,EAK7D,GAEA,CAAAxrB,IAAA,SAAAE,MACA,SAAQmuC,GACFhsC,KAAK+0G,eAAe/0G,KAAKg5B,MAAOgT,IACpChsC,KAAK+0G,eAAe/0G,KAAK+4B,KAAMiT,EACjC,GAEA,CAAAruC,IAAA,iBAAAE,MACA,SAAgB8yB,EAAmBqb,GACjC,IAA4CgpE,EAAAptG,EAA3B5H,KAAKi1G,UAAUtkF,EAAMqb,GAAM,GAArC7iB,EAAG6rF,EAAA,GAAExxG,EAACwxG,EAAA,GACb,QAAI7rF,IACFwH,EAAKkpC,OAAOr2D,EAAG,IACR,EAGX,GAEA,CAAA7F,IAAA,YAAAE,MACA,SAAW8yB,EAAmBqb,GAC5B,IAAK,IAAIxoC,EAAI,EAAGA,EAAImtB,EAAKptB,OAAQC,IAC/B,GAAImtB,EAAKntB,GAAGwoC,QAAUA,EACpB,MAAO,CAACrb,EAAKntB,GAAIA,GAGrB,MAAO,CAAC,MAAO,EACjB,GAEA,CAAA7F,IAAA,kBAAAE,MACA,SAAiBmuC,EAAezb,EAAaqkF,GACvC50G,KAAKk1G,oBAAoBl1G,KAAKg5B,MAAOgT,EAAOzb,EAAKqkF,IACrD50G,KAAKk1G,oBAAoBl1G,KAAK+4B,KAAMiT,EAAOzb,EAAKqkF,EAClD,GAEA,CAAAj3G,IAAA,sBAAAE,MAIA,SAAqB8yB,EAAmBqb,EAAezb,EAAaqkF,GAClE,IAAMzrF,EAAMnpB,KAAKi1G,UAAUtkF,EAAMqb,GAAO,GACxC,QAAI7iB,IACFA,EAAIoH,IAAMA,EACVpH,EAAIyrF,UAAYA,GACT,EAGX,GAEA,CAAAj3G,IAAA,WAAAE,MAGA,SAAUs3G,GACR,IAAM3iC,EAAU,SAACrpD,GAAc,YAAmB1nB,IAAd0nB,EAAIkS,OAAqC,IAAdlS,EAAIkS,OAAelS,EAAIkS,QAAU85E,CAAQ,EACxGn1G,KAAKg5B,MAAQh5B,KAAKg5B,MAAM1lB,OAAOk/D,GAC/BxyE,KAAK+4B,KAAO/4B,KAAK+4B,KAAKzlB,OAAOk/D,EAC/B,GAEA,CAAA70E,IAAA,QAAAE,MACA,WACE,OAAQmC,KAAKg5B,MAAMz1B,SAAWvD,KAAK+4B,KAAKx1B,MAC1C,GAEA,CAAA5F,IAAA,QAAAE,MACA,WACE,OAAOmC,KAAKg5B,MAAMz1B,OAASvD,KAAK+4B,KAAKx1B,MACvC,GAEA,CAAA5F,IAAA,eAAAE,MAIA,SAAc8yB,GACZ,IACsBxlB,EADlBqS,EAAO,KAAIpS,+5BAAAC,CACGslB,GAAI,IAAtB,IAAAvlB,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAwB,KAAbynB,EAAGhe,EAAAtN,MACZ,IAAKsrB,EAAIkS,MAAO,OAAOlS,EAClB3L,IACHA,EAAO2L,EAEX,CAAC,OAAAzqB,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACD,OAAO2R,CACT,GAAC,CAAA7f,IAAA,aAAAE,MAED,WACE,OAAOmC,KAAKo1G,aAAap1G,KAAK+4B,KAChC,GAAC,CAAAp7B,IAAA,cAAAE,MAED,WACE,OAAOmC,KAAKo1G,aAAap1G,KAAKg5B,MAChC,KAAC07E,CAAA,CA7H2B,8GCkB9B,SAASW,GAASxJ,EAAe5W,EAAcqgB,GAC7C,GAAKzJ,IAAS5W,EAAQ7zF,OAKtB,QAA+B,IAApBk0G,EAASzJ,GAKpB,IAAK,IAAIroG,EAAI,EAAGA,EAAI8xG,EAASzJ,GAAOtoG,OAAQC,IAC1C8xG,EAASzJ,GAAOroG,GAAGyxF,OAXrB,CACE,IAAMv2F,EAAMu2F,EAAQ7zF,MACpBuZ,QAAQvZ,MAAM,yBAAD2K,OAA0BrN,EAAIilE,KAAI,OAAA53D,OAAMrN,EAAIomC,SAE3D,CASF,CAEA,IAAI7vB,GAAK,EA+GT,SADW,IA1GQ,WAQjB,SAAAsgG,IAAe1sG,EAAA,KAAA0sG,GAAAzrG,EAAA,mBAAAA,EAAA,0BAAAA,EAAA,wBAAAA,EAAA,qBAAAA,EAAA,0BAAAA,EAAA,wBACb9J,KAAKs1G,SAAW,CAAC,EACjBt1G,KAAKw1G,MAAQ,GACbx1G,KAAKy1G,WAAa,CACpB,CA2FC,OA3FA9rG,EAAA4rG,EAAA,EAAA53G,IAAA,gBAAAE,MAED,SAAeguG,EAAe7+E,GAC5BhtB,KAAKs1G,SAASzJ,GAAS7rG,KAAKs1G,SAASzJ,IAAU,GAC/C7rG,KAAKs1G,SAASzJ,GAAO7oG,KAAKgqB,EAC5B,GAAC,CAAArvB,IAAA,kBAAAE,MAED,SAAiBguG,GACf7rG,KAAKs1G,SAASzJ,GAAS,EACzB,GAEA,CAAAluG,IAAA,UAAAE,MACA,SAASguG,EAAe5W,GACtB,GAAKj1F,KAAK01G,YAAc11G,KAAK01G,WAAWC,aAAezpG,OAAO0pG,UAAUC,KAAxE,CAKA5gG,KACA,IAAM6vB,EAAUz4B,KAAKC,UAAU,CAC7Bu/F,MAAOA,EACPnsG,KAvDc,EAwDduV,GAAIA,GACJggF,QAASA,IAGX/oF,OAAOsnC,IAAI,KAAM,UAAW1O,GAC5B9kC,KAAK01G,WAAW53B,KAAKh5C,EAVrB,KAJA,CACE,KAAO9kC,KAAKw1G,MAAMjyG,OAASvD,KAAKy1G,WAAa,GAAGz1G,KAAKw1G,MAAMj6E,QAC3Dv7B,KAAKw1G,MAAMxyG,KAAK,CAAC6oG,EAAO5W,GAE1B,CAWF,GAAC,CAAAt3F,IAAA,QAAAE,MAED,SAAO4uB,GACLvgB,OAAOsnC,IAAI,KAAM,iBAAkB/mB,EAAQzsB,KAAKs1G,UAChDt1G,KAAKs1G,SAAW,CAAC,EACbt1G,KAAK01G,YAAY11G,KAAK01G,WAAWt0D,OACvC,GAAC,CAAAzjD,IAAA,UAAAE,MAED,SAASi4G,EAAaC,GAAsB,IAAA58F,EAAA,KAC1CnZ,KAAK81G,IAAMA,EACX91G,KAAK+1G,SAAWA,EAChB,IAAIC,EAAS,GACF,SAALC,IACJ/pG,OAAOsnC,IAAI,KAAM,iBAAFznC,OAAmB+pG,IAClC,IAAII,EAAyB/8F,EAAKu8F,WAAa,IAAIxpG,OAAO0pG,UAAUE,GACpE,GAAKI,EAAL,CACA,IAAMh9F,EAAUK,YAAW,WAErB28F,GAAMA,EAAK90D,OACjB,GAAG,KAGH80D,EAAKC,UAAY,SAACC,GAChB,IAAMtxE,EAAUz4B,KAAKG,MAAM4pG,EAAIloG,MAC/BmnG,GAAQvwE,EAAQ+mE,MAAO/mE,EAAQmwD,QAAS97E,EAAKm8F,SAC/C,EAGAY,EAAKG,QAAU,SAACD,GACdlqG,OAAOsnC,IAAI,KAAM,WACjB9T,aAAaxmB,GACbg9F,EAAO/8F,EAAKu8F,WAAa,KACzBL,GAAQ,QAAS,KAAMl8F,EAAKm8F,UAC5BU,IAEA,IAAMM,EAAQrjG,KAAKoB,IAAIpB,KAAKsR,IAAI,KAAMyxF,GAAS,IAC/Cr7F,QAAQvZ,MAAM,2BAAD2K,OAA4BqqG,EAAIzyC,KAAI,uBAAA53D,OAAsBuqG,EAAM5wF,QAAQ,GAAE,aACvFnM,YAAW,WACT08F,GACF,GAAW,IAARK,EACL,EAEAJ,EAAKK,OAAS,WACZrqG,OAAOsnC,IAAI,KAAM,UACjB9T,aAAaxmB,GACT88F,EAAS,IACXA,EAAS,EACTD,KAEFV,GAAQ,OAAQ,KAAMl8F,EAAKm8F,UAC3B,IAAME,EAAQr8F,EAAKq8F,MACnBr8F,EAAKq8F,MAAQ,GAAE,IACqBrqG,EADrBC,+5BAAAC,CACgBmqG,GAAK,IAApC,IAAApqG,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAsC,KAAA80G,EAAA5uG,EAAAuD,EAAAtN,MAAA,GAA1BguG,EAAK2K,EAAA,GAAE1xE,EAAO0xE,EAAA,GACxBr9F,EAAKs9F,QAAQ5K,EAAO/mE,EACtB,CAAC,OAAApmC,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACH,EAEAqqG,EAAKQ,QAAU,SAACN,GACdlqG,OAAOsnC,IAAI,KAAM,WAAY4iE,GAC7Bf,GAAQ,QAASe,EAAKj9F,EAAKm8F,SAC7B,CA7CiB,CA8CnB,CACAW,EACF,KAACV,CAAA,CAvGgB,ozDC+BnB,IAAMprG,GAAO0K,GAAI1K,KAEXwsG,GAAY,OACZC,GAAiB,aACjBC,GAAmB,eACnBC,GAAuB,mBACvBC,GAAkB,cAClBC,GAAe,UACfC,GAAoB,gBAOpBC,GAAc,cACdC,GAAe,aAEfC,GAAgB,KAGhBC,GAAmB,IAAI7jG,KAAKC,aAAaoB,GAAIzB,YAAa,CAC9DoB,sBAAuB,EACvBd,sBAAuB,IAGnB4jG,GAAe,WAuDAC,GAAW,SAAAphC,GAAA/rE,EAAAmtG,EAAAphC,GAAA,IA0xF9BqhC,EAnRAxmD,EA5BAymD,EA3NAC,EAVCC,EAnBDz9B,EApFC09B,EAnIDC,EArDAC,EAdAC,EAVCC,EAXDC,EAPAC,EA3IAx8B,EA3WCy8B,EA5hBDj6D,EA5PAk6D,EAzDAC,EA3NCC,MA3Z6B5wF,KAAA6vF,iZAuC9B,SAAAA,EAAagB,EAAmBC,GAA+B,IAAAr/F,EAAAtQ,EAAA,KAAA0uG,GACtDztG,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,gCAAArP,EAAAC,EAAAoP,GAAA,iBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,iBAAArP,EAAAC,EAAAoP,GAAA,kBAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,aAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,8BAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,+BAAArP,EAAAC,EAAAoP,GAAA,qCAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,4BAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,gBAEP,IAAMgS,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAck7D,GAE3C,GADAp/F,EAAKo/F,KAAOA,GACPp/F,EAAKo/F,KAAKh2F,cAAe,OAAAhY,EAAA4O,GAG9BA,EAAKs/F,sBAAwB,EAC7Bt/F,EAAKu/F,WAAa,CAAC,EACnBv/F,EAAKw/F,cAAgB,GACrBx/F,EAAKy/F,cAAgB,CAAC,EACtBz/F,EAAK0/F,WAAa,CAChBh8E,MAAO,GACP5zB,MAAO,IAETkQ,EAAK2/F,OAAS,GAEd3/F,EAAK4/F,qBAAuB,MAC5B5/F,EAAK6/F,4BAA8B,EAEnC7/F,EAAK8/F,QAAUhuG,SAAS0iG,MACxBx0F,EAAK8jC,MAAQ,IAAI2R,GAAMzjC,EAAK8xB,MAAO,CACjC6R,OAAQ,SAACM,GACHA,IAAejkC,EAAK+tF,aACtB//F,EAAKggG,gBAET,IAGF,IAAMC,EAAiB,CACrBnlF,MAAO,SAAChL,GAAgB9P,EAAKkgG,iBAAiBpwF,EAAG,EACjDsV,OAAQ,SAACrkB,GAAsBf,EAAKmgG,kBAAkBp/F,EAAG,EACzDskB,MAAO,SAACtkB,GAAqBf,EAAKogG,iBAAiBr/F,EAAG,EACtDmY,KAAM,SAACmnF,GAAgBrgG,EAAKsgG,gBAAgBD,EAAG,GAEjDrgG,EAAKugG,WAAa,IAAIphF,GAAWnN,EAAKuuF,WAAYN,EAAgB3uG,EAAMuB,WAAWvB,EAAMkvG,cAEzF,IAAMC,EAAmC,CACvCp7E,MAAO,SAAA0B,GAAO/mB,EAAK0gG,kBAAkB35E,EAAG,GAE1C/mB,EAAK2gG,YAAc,IAAIh7E,GAAY3T,EAAK4uF,aAAcH,GAItDzgG,EAAK6gG,oBAAsB,IAAInzC,GAAoB17C,EAAK8uF,gBAFxC,WAAwB,IAIxC9gG,EAAK+gG,iBAAmB,IAAI5nC,GAAkBnnD,EAAK+uF,kBAGnD/gG,EAAKghG,UAAY1vG,EAAMuB,WAAWvB,EAAM2vG,uBAvJxB,KA2JhB,IAAMC,EAAexlG,GAAIi7C,YAAY3kC,EAAKmvF,cAAe,gBACzDnwG,GAAKkwG,EAAc,SAAS,WAC1BpvF,KAAM2yB,SAAS,WAAY,CAAEtW,KAAMnuB,EAAK4nB,OAAOmP,IAAI5I,MACrD,IAIEnc,EAAKovF,eAAen6F,gBAAgB,MACpC,IAAMo6F,EAAUrvF,EAAKovF,eACfE,EAAUtvF,EAAKovF,eAAe9uF,WAAU,GAC9C+uF,EAAQhiD,MAAMiiD,GACd,IAAMC,EAAMvhG,EAAKwhG,WAAa,IAAIC,GAAcJ,EAASC,GACnDI,EAAYH,EAAIlpF,KAAKspF,WAAWn2F,MAChCo2F,EAAaL,EAAIlgE,MAAMsgE,WAAWn2F,MACxCxa,GAAKuwG,EAAIlpF,KAAKrR,KAAK66F,QAAS,SAAS,WAAQ7hG,EAAK8hG,aAAa9hG,EAAK4nB,OAAOvP,KAAKvc,GAAI,IACpF9K,GAAKuwG,EAAIlgE,MAAMr6B,KAAK66F,QAAS,SAAS,WAAQ7hG,EAAK8hG,aAAa9hG,EAAK4nB,OAAOyZ,MAAMvlC,GAAI,IACtF9K,GAAKuwG,EAAIlpF,KAAKrR,KAAK+6F,QAAS,SAAS,WAAQ/hG,EAAK8hG,aAAa9hG,EAAK4nB,OAAOvP,KAAKvc,GAAI,IACpF9K,GAAKuwG,EAAIlgE,MAAMr6B,KAAK+6F,QAAS,SAAS,WAAQ/hG,EAAK8hG,aAAa9hG,EAAK4nB,OAAOyZ,MAAMvlC,GAAI,IACtF9K,GAAK0wG,EAAUj2F,SAAU,SAAS,WAAQzL,EAAK8hG,aAAa9hG,EAAK4nB,OAAOvP,KAAKvc,GAAI,IACjF9K,GAAK4wG,EAAWn2F,SAAU,SAAS,WAAQzL,EAAK8hG,aAAa9hG,EAAK4nB,OAAOyZ,MAAMvlC,GAAI,IACnF9K,GAAK0wG,EAAUh2F,OAAQ,SAAS,WAAQ1L,EAAK8hG,aAAa9hG,EAAK4nB,OAAOvP,KAAKvc,GAAI,IAC/E9K,GAAK4wG,EAAWl2F,OAAQ,SAAS,WAAQ1L,EAAK8hG,aAAa9hG,EAAK4nB,OAAOyZ,MAAMvlC,GAAI,IACjF9K,GAAK0wG,EAAU31F,SAAU,SAAS,WAAQ/L,EAAK6oE,uBAAuB7oE,EAAK4nB,OAAOvP,KAAM,IACxFrnB,GAAK4wG,EAAW71F,SAAU,SAAS,WAAQ/L,EAAK6oE,uBAAuB7oE,EAAK4nB,OAAOyZ,MAAO,IAC1FrwC,GAAKuwG,EAAIlpF,KAAKrR,KAAKg7F,cAAe,SAAS,WAAQhiG,EAAKiiG,WAAWjiG,EAAK4nB,OAAOvP,KAAM,IACrFrnB,GAAKuwG,EAAIlgE,MAAMr6B,KAAKg7F,cAAe,SAAS,WAAQhiG,EAAKiiG,WAAWjiG,EAAK4nB,OAAOyZ,MAAO,IACvFrwC,GAAKuwG,EAAIlpF,KAAKrR,KAAKk7F,WAAY,SAAS,WAAQliG,EAAK8kE,YAAY9kE,EAAK4nB,OAAOvP,KAAKvc,GAAI,IACtF9K,GAAKuwG,EAAIlgE,MAAMr6B,KAAKk7F,WAAY,SAAS,WAAQliG,EAAK8kE,YAAY9kE,EAAK4nB,OAAOyZ,MAAMvlC,GAAI,IACxF9K,GAAKuwG,EAAIlpF,KAAKrR,KAAKm7F,cAAe,SAAS,WAAQniG,EAAKoiG,yBAAyBpiG,EAAK4nB,OAAOvP,KAAKvc,GAAI,IACtG9K,GAAKuwG,EAAIlgE,MAAMr6B,KAAKm7F,cAAe,SAAS,WAAQniG,EAAKoiG,yBAAyBpiG,EAAK4nB,OAAOyZ,MAAMvlC,GAAI,IACxGkE,EAAKorE,gBAAkB,IAAIrW,GAAe/iD,EAAKq5D,SAGjD,IAAMg3B,EAAqD,CACzDp+D,gBAAiBjyB,EAAKiyB,gBACtBE,mBAAoBnyB,EAAKmyB,mBACzBC,iBAAkBpyB,EAAKoyB,iBACvBC,oBAAqBryB,EAAKqyB,qBAE5B3oC,GAAIuyB,eAAejc,EAAKmyB,mBAAoBnyB,EAAKoyB,iBAAkBpyB,EAAKqyB,qBACxErkC,EAAKsiG,GAAK,IAAIz+D,GAA0B7xB,EAAKuwF,UAAWviG,EAAK8jC,MAAOu+D,EAA0B,WAE9FriG,EAAKwiG,gBAAkB,IAAIz0E,GAAgB/b,EAAKwwF,iBAGhDn7B,GAASr1D,EAAK+2D,0BAA2B/2D,EAAKg3D,yBAAwB15E,EAAAzL,IAAAA,MAAE,SAAA8P,IAAA,OAAA9P,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAAc6W,EAAKipE,qBAAoB,wBAAAl1E,EAAAlI,OAAA,GAAA8H,EAAA,MAG/Goe,GAAmBC,GAEnBtW,GAAIuyB,eACFjc,EAAKywF,aAAczwF,EAAK0wF,gBAAiB1wF,EAAKT,eAAgBS,EAAKR,aACnEQ,EAAKV,aAAcU,EAAK2wF,cAAe3wF,EAAK4wF,uBAI9C5xG,GAAKghB,EAAK6wF,gBAAiB,SAAS,WAAQ7iG,EAAK8iG,uBAAsB,EAAM,IAC7E9xG,GAAKghB,EAAK+wF,iBAAkB,SAAS,WAAQ/iG,EAAK8iG,uBAAsB,EAAO,IAE/E,IAAME,EAAoB,SAAC7iG,GACzBzE,GAAIqf,QAAQ5a,EAAM6R,EAAKixF,iBACvBvnG,GAAIqf,OAAO5a,EAAM6R,EAAKkxF,cAAelxF,EAAKmxF,gBAC5C,EACAnyG,GAAKghB,EAAKixF,gBAAiB,SAAS,WAAQD,GAAkB,EAAM,IACpEhyG,GAAKghB,EAAKmxF,gBAAiB,SAAS,WAAQH,GAAkB,EAAO,IAErE,IAAMI,EAA0B,SAACjjG,GAC/BzE,GAAIqf,QAAQ5a,EAAM6R,EAAKqxF,uBACvB3nG,GAAIqf,OAAO5a,EAAM6R,EAAKwwF,gBAAiBxwF,EAAKsxF,sBAC9C,EACAtyG,GAAKghB,EAAKqxF,sBAAuB,SAAS,WAAQD,GAAwB,EAAM,IAChFpyG,GAAKghB,EAAKsxF,sBAAuB,SAAS,WAAQF,GAAwB,EAAO,IAGjFpyG,GAAKghB,EAAKuxF,QAAS,SAAS,WAAQvjG,EAAKwjG,QAAS,IAClDxyG,GAAKghB,EAAKyxF,SAAU,SAAS,WAAQzjG,EAAK0jG,SAAU,IAEpD1yG,GAAKghB,EAAK2xF,UAAW,SAAS,WAC5BC,GAAU5xF,EAAK6xF,WAAY7xF,EAAK2xF,WAChC3jG,EAAK8jG,qBACA9xF,EAAK+xF,UAAUr/G,QACpBsb,EAAK0/F,WAAW5vG,MAAQ,CAAC,CACvBqT,KAAMiL,GAAkB4D,EAAK+xF,UAAUr/G,MAAO,GAC9CuqB,MAAOjP,EAAKgkG,SAAWhkG,EAAKugG,WAAWzmF,MAAMV,SAAWpZ,EAAKugG,WAAWzmF,MAAMT,UAEhFrZ,EAAKikG,iBACP,IACAjzG,GAAKghB,EAAK6xF,WAAY,SAAS,WAC7BD,GAAU5xF,EAAK2xF,UAAW3xF,EAAK6xF,YAC/B7jG,EAAK8jG,qBACL9jG,EAAKkkG,4BACLlkG,EAAK0/F,WAAW5vG,MAAQ,GACxBkQ,EAAKikG,gBACP,IACAjzG,GAAKghB,EAAKmyF,OAAQ,SAAS,WACzB,GAAInkG,EAAKgkG,SAAU,CACjB,IAAMI,EAAUpkG,EAAK4nB,OAAOw8E,QAC5B,IAAKA,EAAS,OACdpyF,EAAKqyF,SAAS3/G,MAAQyL,OAAOi0G,EAAQzwD,KAAKla,KAC5C,KAAO,CACL,IAAM6qE,EAAStkG,EAAK4nB,OAAO28E,QAAQvkG,EAAKwkG,gBACxC,IAAKF,EAAQ,OACbtyF,EAAKqyF,SAAS3/G,MAAQyL,OAAOm0G,EAAO3wD,KAAKla,KAC3C,CACAz5B,EAAKykG,YACP,IAEA/oG,GAAIgpG,kBAAkB1yF,EAAK+xF,UAAW/xF,EAAKqyF,SAAUryF,EAAK2yF,SAAU3yF,EAAK4yF,aAGzEC,GAAGC,cAActH,IAAW,SAACzoG,GAAuBiL,EAAK+kG,gBAAgBhwG,EAAM,IAE/E8vG,GAAGC,cAAcrH,IAAgB,SAAC1oG,GAAuBiL,EAAKglG,qBAAqBjwG,EAAM,IAEzF8vG,GAAGC,cAAcpH,IAAkB,SAAC3oG,GAAuBiL,EAAKilG,uBAAuBlwG,EAAM,IAE7F8vG,GAAGC,cAAcnH,IAAsB,SAAC5oG,GAAuBiL,EAAKklG,2BAA2BnwG,EAAM,IAErG8vG,GAAGC,cAAclH,IAAiB,SAAC7oG,GAAuBiL,EAAKmlG,sBAAsBpwG,EAAM,IAE3F8vG,GAAGC,cAAcjH,IAAc,SAAC9oG,GAAuBiL,EAAKolG,mBAAmBrwG,EAAM,IAErF8vG,GAAGC,cAAchH,IAAmB,SAAC/oG,GAAuBiL,EAAKqlG,wBAAwBtwG,EAAM,IAG/F8vG,GAAGC,cAjSwB,uBAiSc,SAAC/vG,GAAuBiL,EAAKslG,wBAAwBvwG,EAAM,IAEpGiL,EAAK49D,cAAgB,IAAI1nB,GAAclkC,EAAK4rD,cAAatuE,EAAAzL,IAAAA,MAAE,SAAAiR,IAAA,OAAAjR,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAAc6W,EAAK04C,eAAc,wBAAA1jD,EAAAnJ,OAAA,GAAAiJ,EAAA,MAE5FuyE,GAASr1D,EAAKuzF,UAAWvzF,EAAK2qD,WAAUrtE,EAAAzL,IAAAA,MAAE,SAAAuR,IAAA,OAAAvR,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OAAc6W,EAAKwlG,aAAY,wBAAAnwG,EAAAxJ,OAAA,GAAAuJ,EAAA,MAEzEiyE,GAASr1D,EAAKyzF,WAAYzzF,EAAK0zF,QAAOp2G,EAAAzL,IAAAA,MAAE,SAAA2mB,IAAA,OAAA3mB,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAAc6W,EAAK2lG,cAAa,wBAAAl7F,EAAA5e,OAAA,GAAA2e,EAAA,MAExE68D,GAASr1D,EAAK4zF,WAAY5zF,EAAK6zF,aAAYv2G,EAAAzL,IAAAA,MAAE,SAAA6mB,IAAA,OAAA7mB,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAAc6W,EAAK8lG,eAAc,wBAAAn7F,EAAA9e,OAAA,GAAA6e,EAAA,MAE9EhP,GAAI1K,KAAKghB,EAAK+zF,YAAa,SAAS,kBAAM/lG,EAAK8jC,MAAM3jC,KAAK6R,EAAK+tF,YAAY,IAC3ErkG,GAAI1K,KAAKghB,EAAKg0F,gBAAiB,SAAS,kBAAMhmG,EAAKggG,gBAAgB,IAEnEhuF,EAAKi0F,mBAAmB3kG,iBAAiB,mBACtCla,SAAQ,SAAC8+G,GAAe,OAAKl1G,GAC5Bk1G,EAAI,SAAS,kBAAMC,EAAwBD,EAAG9gG,QAAQghG,UAAY,GAAG,GACtE,IAEH,IAAMD,EAA0B,SAAC3hH,GAE/B6hH,IACIrmG,EAAK4/F,uBAAyBp7G,EAChCwb,EAAK6/F,6BAA+B,GAEpC7/F,EAAK4/F,qBAAuBp7G,EAC5Bwb,EAAK6/F,2BAA6B,GAEpC7/F,EAAKsmG,4BACLC,GACF,EAQMF,EAAmC,WACvCr0F,EAAKi0F,mBAAmB3kG,iBAAiB,mBACtCla,SAAQ,SAAA8+G,GAAE,OAAIA,EAAG1mG,UAAUM,OAAO,aAAc,aAAa,GAClE,EAEMymG,EAAiC,WACrC,IAAM/hH,EAAMwb,EAAK4/F,qBACX4G,EAXU,IAWqBxmG,EAAK6/F,2BAXhB,aACnB,aAWPnkG,GAAIyJ,aAAa6M,EAAKi0F,mBAAoB,kBAAFrzG,OAAoBpO,EAAG,MAAKgb,UAAUC,IAAI+mG,EACpF,EAGAD,IAEA,IAAM5iC,EAAc,WAClB3jE,EAAK8jC,MAAMmE,OACb,EAEAjoC,EAAK61C,MAAQ,SAACpjD,GACE,WAAVA,EAAEjO,KACJm/E,GAEJ,EACA3yE,GAAKc,SAAU,QAASkO,EAAK61C,OAE7B7jC,EAAK8xB,MAAMxiC,iBAAiB,gBAAgBla,SAAQ,SAAAyU,GAClDH,GAAI1K,KAAK6K,EAAI,SAAS,WAAQ8nE,GAAc,GAC9C,IAGA3yE,GAAKghB,EAAKqyF,SAAU,CAAC,SAAU,UAAU,WAAQrkG,EAAKykG,YAAa,IACnEzzG,GAAKghB,EAAK2yF,SAAU,UAAU,WAAQ3kG,EAAKymG,iBAAgB,EAAM,IACjEz1G,GAAKghB,EAAK2yF,SAAU,SAAS,WAAQ3kG,EAAKymG,iBAAgB,EAAO,IACjEz1G,GAAKghB,EAAK4yF,YAAa,CAAC,SAAU,UAAU,WAAQ5kG,EAAK0mG,kBAAmB,IAC5E11G,GAAKghB,EAAK+xF,UAAW,UAAU,WAAQ/jG,EAAK2mG,kBAAmB,IAC/D31G,GAAKghB,EAAK+xF,UAAW,SAAS,WAAQ/jG,EAAK4mG,iBAAgB,EAAM,IAGjE51G,GAAKghB,EAAK60F,eAAgB,CAAC,SAAU,UAAU,WAAQ7mG,EAAK8mG,eAAgB,IAG5E,IAAMC,EAAsB,SAACC,GAC3BtrG,GAAIqf,QAAQisF,EAAOh1F,EAAKi1F,WAAYj1F,EAAKk1F,eACzCxrG,GAAIqf,OAAOisF,EAAOh1F,EAAKm1F,eACzB,EACAn2G,GAAKghB,EAAKk1F,cAAe,SAAS,WAChC51G,EAAMgE,WAAWhE,EAAM81G,wBAAwB,GAC/CL,GAAoB,EACtB,IACA/1G,GAAKghB,EAAKm1F,eAAgB,SAAS,WACjC71G,EAAMgE,WAAWhE,EAAM81G,wBAAwB,GAC/CL,GAAoB,EACtB,IACAA,EAAoBz1G,EAAMuB,WAAWvB,EAAM81G,yBAE3C,IAAMC,EAAkB,WACtBrnG,EAAK0/F,WAAWh8E,MAAQ,GACxB1jB,EAAKikG,gBACP,EACAjzG,GAAKghB,EAAKs1F,QAAS,aAAcD,GACjCr2G,GAAKghB,EAAKu1F,SAAU,aAAcF,GAClCr2G,GAAKghB,EAAKw1F,WAAY,cAAc,WAClCxnG,EAAKynG,iBAAmB,KACxBznG,EAAK0nG,iBACP,IAEA,IAAMC,EAAS31F,EAAK41F,YACdC,EAASF,EAAOr1F,WAAU,GAChCu1F,EAAOroG,UAAUC,IAAI,YACrB/D,GAAI2E,KAAKsnG,EAAQE,GACjBA,EAAO5gG,gBAAgB,MACvB6K,KAAMg2F,YAAY3oG,YAAY0oG,GAC9B7nG,EAAK8oC,MAAQ,CAAC,CAAEqF,IAAKw5D,EAAQ3gG,KAAMtL,GAAI6W,cAAco1F,IAAW,CAAEx5D,IAAK05D,EAAQ7gG,KAAMtL,GAAI6W,cAAcs1F,KAEvG,IAAME,EAAmB,WACvBz2G,EAAMgE,WAAWhE,EAAMkE,iBAAkB,KACzCwc,EAAKg2F,eAAexoG,UAAUM,OAAO,WACrCkS,EAAKg2F,eAAexoG,UAAUC,IAAI,WAAU,IAClBzN,EADkBC,EAAAC,GAC5B8N,EAAK8oC,OAAK,IAA1B,IAAA72C,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAYyJ,EAAAtN,MAAkBypD,IAAI3uC,UAAUM,OAAO,WAAW,OAAAva,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CAChE,EACMu1G,EAAkB,WACtB32G,EAAMgE,WAAWhE,EAAMkE,iBAAkB,KACzCwc,EAAKg2F,eAAexoG,UAAUM,OAAO,UAAW,WAAU,IAChC5D,EADgCC,EAAAjK,GAC1C8N,EAAK8oC,OAAK,IAA1B,IAAA3sC,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAY2T,EAAAxX,MAAkBypD,IAAI3uC,UAAUC,IAAI,WAAW,OAAAla,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CAC7D,EACAgJ,GAAI1K,KAAKghB,EAAKk2F,UAAW,SAAS,kBAAMH,GAAkB,IAC1DrsG,GAAI1K,KAAKghB,EAAKm2F,eAAgB,SAAS,kBAAMF,GAAiB,IAAC,IACrCtmG,EADqCC,EAAA1P,GAC/C8N,EAAK8oC,OAAK,IAA1B,IAAAlnC,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAA4B,KAAjB6J,EAACuP,EAAAjd,MACVgX,GAAI1K,KAAKoB,EAAE4U,KAAKohG,aAAc,SAAS,WACG,IAApCp2F,EAAKg2F,eAAez4F,YAAmB04F,IACtCF,GACP,GACF,CAAC,OAAAxiH,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CACDsN,EAAKqoG,WAAa,IAAIC,GAAWt2F,EAAKu2F,cACtC,IACyC9hG,EADzCC,EAAAxU,GACkB8N,EAAKqoG,WAAWvrE,SAAO,QAAAgd,EAAA,WAAE,IAAhC3L,EAAG1nC,EAAA/hB,MACZsM,GAAKm9C,EAAI97B,KAAM,SAAS,WAAM,IAAAm2F,EAAAC,EAAAC,EAAAC,EAE5BC,EAA2Dz6D,EAAIte,IAA9C9X,EAAO6wF,EAAhBxiD,QAA0BtuC,EAAM8wF,EAAdzgF,OAAsBgG,EAAIy6E,EAAV9mD,GAAM3zB,MACjC,QAAXq6E,EAAAxoG,EAAK4nB,cAAM,IAAA4gF,GAAM,QAANC,EAAXD,EAAanwF,YAAI,IAAAowF,OAAN,EAAXA,EAAmB3sG,MAAOgc,IAAqB,QAAX4wF,EAAA1oG,EAAK4nB,cAAM,IAAA8gF,GAAO,QAAPC,EAAXD,EAAarnE,aAAK,IAAAsnE,OAAP,EAAXA,EAAoB7sG,MAAOic,IACnE/X,EAAK6oG,yBACL7oG,EAAK8oG,UAAU36E,EAAMrW,EAAQC,GAC/B,GACF,EARA,IAAArR,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAAuxD,GAQC,OAAAv0D,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CAoDoB,MAnD4B,MAA7CpB,EAAMuB,WAAWvB,EAAMkE,mBACzBuyG,IAIFj2F,KAAMilC,mBAAmB,CACvBlgC,MAAO,SAACogC,GAAsBj3C,EAAK+oG,gBAAgB9xD,EAAM,EACzD5/B,MAAO,SAAC4/B,GAAsBj3C,EAAKgpG,gBAAgB/xD,EAAM,EACzD/0B,MAAO,SAAC+0B,GAAsBj3C,EAAKipG,gBAAgBhyD,EAAM,EACzD8lD,KAAM,SAAC9lD,GAA0Bj3C,EAAKkpG,eAAejyD,EAAM,EAC3D5X,QAAS,SAAC4X,GAAwBj3C,EAAK2sE,kBAAkB11B,EAAM,EAC/DkyD,SAAU,SAAClyD,GAAqBj3C,EAAKopG,iBAAiBnyD,EAAM,EAC5DoyD,MAAO,SAACpyD,GAA0Bj3C,EAAKspG,kBAAkBryD,EAAM,EAC/DD,YAAa,SAACC,GAA4Bj3C,EAAKupG,kBAAkBtyD,EAAM,EACvEuyD,WAAY,WAAQxpG,EAAKypG,kBAAmB,EAC5CC,WAAY,WAAQ1pG,EAAKypG,kBAAmB,EAC5CE,SAAU,SAAC1yD,GACTj3C,EAAKsiG,GAAGl7D,SACJ6P,EAAKn/B,SAAW9X,EAAK4nB,OAAOvP,KAAKvc,IAAMm7C,EAAKl/B,UAAY/X,EAAK4nB,OAAOyZ,MAAMvlC,IAAMm7C,EAAK9oB,OAASnuB,EAAK4nB,OAAOmP,IAAI5I,MAC9GtZ,QAAQ7U,EAAKuiG,aAAe1tF,QAAQoiC,EAAKnO,SAC3C9oC,EAAKuiG,UAAY1tF,QAAQoiC,EAAKnO,OAC9B9oC,EAAK4pG,6BAET,EACAC,YAAa,SAAC5yD,GACRA,EAAKn/B,SAAW9X,EAAK4nB,OAAOvP,KAAKvc,IAAMm7C,EAAKl/B,UAAY/X,EAAK4nB,OAAOyZ,MAAMvlC,IAAMm7C,EAAK9oB,OAASnuB,EAAK4nB,OAAOmP,IAAI5I,MAClHnuB,EAAKsiG,GAAGwH,sBAAsB7yD,EAChC,EACA8yD,YAAa,SAAC9yD,GACRA,EAAKn/B,SAAW9X,EAAK4nB,OAAOvP,KAAKvc,IAAMm7C,EAAKl/B,UAAY/X,EAAK4nB,OAAOyZ,MAAMvlC,IAAMm7C,EAAK9oB,OAASnuB,EAAK4nB,OAAOmP,IAAI5I,MAClHnuB,EAAKsiG,GAAG0H,sBAAsB/yD,EAChC,EACAgzD,SAAU,SAAChzD,GACLA,EAAKn/B,SAAW9X,EAAK4nB,OAAOvP,KAAKvc,IAAMm7C,EAAKl/B,UAAY/X,EAAK4nB,OAAOyZ,MAAMvlC,IAAMm7C,EAAK9oB,OAASnuB,EAAK4nB,OAAOmP,IAAI5I,MAClHnuB,EAAKsiG,GAAGl7D,QACV,IAGFpnC,EAAKkqG,kBAAoB,CAAC,EAC1BlqG,EAAK6oG,yBAGL7oG,EAAKojE,aAAerwE,OAAOo2C,aAAY,WACrC,IAAK,IAALz6C,EAAA,EAAA8lC,EAAmBtwC,OAAO+C,OAAO+Y,EAAKu/F,YAAW7wG,EAAA8lC,EAAApqC,OAAAsE,IAAE,CAA9C,IAAMy7G,EAAI31E,EAAA9lC,GACby7G,EAAK3wD,QAAQ8zB,IAAIpnE,YAAcxK,GAAI2nE,UAAU8mC,EAAKn6F,IAAI62E,WACxD,CAAC,IACgFlgF,EADhFC,EAAA1U,GACgBwJ,GAAImG,cAAcmQ,EAAKo4F,sBAAuB,oBAAkB,IAAjF,IAAAxjG,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,MAAmF,KAAA8hH,EAAxEC,EAAE3jG,EAAAjiB,MACX4lH,EAAGpkG,YAAcxK,GAAI2nE,UAAUhzD,WAAgC,QAAtBg6F,EAACC,EAAGllG,QAAQmlG,kBAAU,IAAAF,EAAAA,EAAI,KACrE,CAAC,OAAA9kH,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CACH,GAAG,KAEHsN,EAAKwqG,KAAKnL,GAAWr/F,CACvB,CA29EC,OA39EAxP,EAAA4tG,EAAA,EAAA55G,IAAA,OAAAE,OAAAy6G,EAAA7vG,EAAAzL,IAAAA,MAED,SAAAopB,EAAYoyF,GAA8B,IAAAtrF,EAAAqT,EAAA,OAAAvjC,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,QAKtC4qB,EADEsrF,SAAAA,EAAYlxE,KACHs8E,GAAWpL,EAAWlxE,KAAMz0B,SAAS2lG,EAAWvnF,QAASpe,SAAS2lG,EAAWtnF,UAE7EzmB,EAAMuB,WAAWvB,EAAMo5G,gBAElB7jH,KAAKwhH,WAAWsC,OAAO52F,EAASoa,KAAMpa,EAASsE,KAAMtE,EAASstB,SACxEja,EAAQvgC,KAAKwhH,WAAWjhF,WACnBrT,EAAW,CAAEoa,KAAM/G,EAAMyI,IAAIiyB,GAAG3zB,KAAM9V,KAAM+O,EAAMyI,IAAI1H,OAAQkZ,MAAOja,EAAMyI,IAAIu2B,UAExFryC,EAAUltB,KAAKiiH,UAAU/0F,EAASoa,KAAMpa,EAASsE,KAAMtE,EAASstB,OAC/Dx6C,KAAK26G,WAAWoJ,sBAAqB,GAG1C/jH,KAAKgkH,kCAAiC,wBAAA19F,EAAAthB,OAAA,GAAAohB,EAAA,UACvC,SAAApe,GAAA,OAAAswG,EAAA1vG,MAAA,KAAAD,UAAA,KAAAhL,IAAA,yBAAAE,MAED,WACE,IAAQstB,EAA2DnrB,KAA3DmrB,KAAyB84F,EAAkCjkH,KAArDqjH,kBAAyB3J,EAA4B15G,KAA5B05G,WAAYI,EAAgB95G,KAAhB85G,YACnDJ,EAAWxmF,OAAOva,UAAUC,IAAI,aAChCkhG,EAAY5mF,OAAOva,UAAUC,IAAI,aAC7BqrG,EAAKpkF,SAASokF,EAAKpkF,QAAQ76B,OAC/Bi/G,EAAKpkF,QAAU,IAAI6D,GAAKvY,EAAK4uF,aAAc,CAAEj1E,QAASvoB,GpB1gBxB,qBoB2gB1B0nG,EAAK9lF,OAAO8lF,EAAK9lF,MAAMn5B,OAC3Bi/G,EAAK9lF,MAAQ,IAAIuF,GAAKvY,EAAKuuF,WAAY,CAAE50E,QAASvoB,GpB3gBtB,kBoB4gB9B,GAEA,CAAA5e,IAAA,SAAAE,MACA,WACE,OAAOmC,KAAKmrB,KAAKyxF,SAASjkG,UAAUhD,SAAS,WAC/C,GAEA,CAAAhY,IAAA,UAAAE,MACA,WACE,OAAOmC,KAAKmrB,KAAK2xF,UAAUnkG,UAAUhD,SAAS,WAChD,GAAC,CAAAhY,IAAA,SAAAE,MAED,WACE,IAAQstB,EAASnrB,KAATmrB,KACR4xF,GAAU5xF,EAAKyxF,SAAUzxF,EAAKuxF,SAC9BvxF,EAAK2qD,WAAWn9D,UAAUM,OAAOk+F,IACjChsF,EAAK2qD,WAAWn9D,UAAUC,IAAIs+F,IAC9B/rF,EAAK+4F,OAAO7kG,YAAc9C,GAAUA,GACpCvc,KAAKmkH,mBACLnkH,KAAKi9G,qBACLj9G,KAAKo9G,iBACAp9G,KAAKokH,WAGRpkH,KAAKqkH,aAAerkH,KAAKskH,aACzBtkH,KAAKukH,wBAHLvkH,KAAK6/G,kBAKT,GAAC,CAAAliH,IAAA,UAAAE,MAED,WACE,IAAQstB,EAASnrB,KAATmrB,KACR4xF,GAAU5xF,EAAKuxF,QAASvxF,EAAKyxF,UAC7BzxF,EAAK2qD,WAAWn9D,UAAUC,IAAIu+F,IAC9BhsF,EAAK2qD,WAAWn9D,UAAUM,OAAOi+F,IACjC/rF,EAAK+4F,OAAO7kG,YAAc9C,GAAUA,GACpCvc,KAAKmkH,mBACLnkH,KAAKi9G,qBACLj9G,KAAKo9G,iBACLp9G,KAAKqkH,aAAerkH,KAAKskH,aACzBtkH,KAAKukH,sBACP,GAEA,CAAA5mH,IAAA,kBAAAE,MACA,WACE,OAAOR,OAAOkH,KAAKvE,KAAK+gC,OAAOmP,IAAIzI,KAAK+kC,cAAgB,IAAIjpE,OAAS,CACvE,GAEA,CAAA5F,IAAA,qBAAAE,MAEA,WACE,IAAMqvB,EAAWltB,KAAK+gC,OACtB,GAAK7T,EAAL,CAEA,IAAM+tC,EAAKhwC,KAAMuc,UAAUta,EAASgjB,IAAI5I,MAClC0B,EAAMiyB,EAAGhlB,QAAQ/oB,EAASZ,IAAIvoB,MACpC,GAAKilC,EAAIG,KAAT,CAAqB,IAEK9oB,EAFLC,EAAAjV,GAELrL,KAAKiiD,OAAK,IAA1B,IAAA3hC,EAAA/U,MAAA8U,EAAAC,EAAA9Z,KAAA9E,MAA4B,KAAjB6J,EAAC8U,EAAAxiB,MACV2mH,EAA4EvpD,EAAG55B,OAAO2H,EAAI1H,QAAlF5sB,SAAYC,aAAkC+I,EAAO8mG,EAAzB5vG,iBAA2BkI,EAAI0nG,EAAJ1nG,KACzDoiD,EAAWj0C,KAAMymB,aAAa1I,EAAI1H,QACpC49B,GACF3zD,EAAE4U,KAAKoe,OAAOlf,YAAcxK,GAAIiJ,kBAAkBkrB,EAAIG,KAAKu0D,MAAQhgF,EAAUwhD,GAC7E3zD,EAAE4U,KAAKskG,QAAQplG,YAAc,QAE7B9T,EAAE4U,KAAKoe,OAAOlf,YAAcxK,GAAIiJ,kBAAkBkrB,EAAIG,KAAKu0D,MAAQhgF,GACnEnS,EAAE4U,KAAKskG,QAAQplG,YAAcvC,GAE/B4nG,GAAkBn5G,EAAE4U,KAAM86C,EAAIjyB,EAChC,CAAC,OAAAtqC,GAAA4hB,EAAA1U,EAAAlN,EAAA,SAAA4hB,EAAAzU,GAAA,CAED7L,KAAKmrB,KAAKw5F,QAAQtlG,YAAcxK,GAAIiJ,kBAAkBkrB,EAAIG,KAAK7sB,KAAOtc,KAAK+gC,OAAOK,sBAClFphC,KAAKmrB,KAAKw5F,QAAQhsG,UAAUM,OAAO,YAAa,YAChDjZ,KAAKmrB,KAAKw5F,QAAQhsG,UAAUC,IAAIowB,EAAIG,KAAKy7E,UAAY,EAAI,WAAa,aACtE/vG,GAAIqf,OAAO8U,EAAIG,KAAKy7E,UAAY,EAAG5kH,KAAKmrB,KAAK05F,MAC7ChwG,GAAIqf,OAAO8U,EAAIG,KAAKy7E,SAAW,EAAG5kH,KAAKmrB,KAAK25F,OAnBvB,CAJA,CAwBvB,GAEA,CAAAnnH,IAAA,mBAAAE,MACA,WACE,GAAKmC,KAAK+gC,OAAV,CAAwB,IACEq4B,EADFC,EAAAhuD,GACRrL,KAAKiiD,OAAK,IAA1B,IAAAoX,EAAA9tD,MAAA6tD,EAAAC,EAAA7yD,KAAA9E,MAA4B,KAAjB6J,EAAC6tD,EAAAv7D,MACVknH,EAAsC/kH,KAAK+gC,OAA1BikF,EAAED,EAAXE,QAAuBC,EAAEH,EAAZI,SACrB55G,EAAE4U,KAAKilG,SAAS3lG,IAAM5K,GAAImK,SAASgmG,EAAGrmG,QACtCpT,EAAE4U,KAAKklG,UAAU5lG,IAAM5K,GAAImK,SAASkmG,EAAGvmG,QACvC9J,GAAImD,MAAMzM,EAAE4U,KAAKmwB,WAAY/kC,EAAE4U,KAAK4wB,aACpCxlC,EAAE4U,KAAKmwB,WAAWh4B,YAAYzD,GAAI2vD,UAAUwgD,GAAI,IAChDz5G,EAAE4U,KAAK4wB,YAAYz4B,YAAYzD,GAAI2vD,UAAU0gD,GAAI,GACnD,CAAC,OAAAxmH,GAAA26D,EAAAztD,EAAAlN,EAAA,SAAA26D,EAAAxtD,GAAA,CARuB,CAS1B,GAEA,CAAAlO,IAAA,aAAAE,MACA,WACE,IAAKw8B,EAAc,EAARC,EAAW,EAChB6O,EAAOnpC,KAAK+gC,OAAOzU,IAAI6c,KAG7B,GAAIA,GAAQA,EAAKm8E,OAASn8E,EAAKo8E,OAC7BlrF,EAAO8O,EAAKo8E,OACZjrF,EAAM6O,EAAKm8E,UACN,KAAAE,EACCh/C,EAAmB,QAAdg/C,EAAGxlH,KAAK+gC,cAAM,IAAAykF,OAAA,EAAXA,EAAaC,aAAarO,IACxC,IAAK5wC,EAAO,CACV,GAAIxmE,KAAKm6G,YAAc/C,GAErB,YADAp3G,KAAK0lH,eAAetO,IAErB,IACyBr9C,EADzBC,EAAA3uD,GACerL,KAAKiiD,OAAK,IAA1B,IAAA+X,EAAAzuD,MAAAwuD,EAAAC,EAAAxzD,KAAA9E,MAA4B,KAAjB6J,EAACwuD,EAAAl8D,MACV0N,EAAE4U,KAAKka,KAAKhb,YAAc,IAC1B9T,EAAE4U,KAAKma,IAAIjb,YAAc,GAC3B,CAAC,OAAA3gB,GAAAs7D,EAAApuD,EAAAlN,EAAA,SAAAs7D,EAAAnuD,GAAA,CACD,MACF,CAIA,IADA,IAAM85G,GAAU,IAAI/6G,MAAOE,UAAY,MAC9BtH,EAAIgjE,EAAM3mC,QAAQt8B,OAAS,EAAGC,GAAK,EAAGA,IAAK,CAClD,IAAM08B,EAAIsmC,EAAM3mC,QAAQr8B,GACxB,GAAI08B,EAAEE,SAAWulF,EAAS,OACd,IAARrrF,GAAc4F,EAAEO,QAAU,GAAKP,EAAEO,QAAUnG,KAAMA,EAAM4F,EAAEO,SACzDP,EAAEM,SAAWnG,IAAMA,EAAO6F,EAAEM,SAClC,CACF,CAEA,IAG0B85B,EAHpBrpC,EAASjxB,KAAK+gC,OAAOvP,KAAKvc,GAC1Bic,EAAUlxB,KAAK+gC,OAAOyZ,MAAMvlC,GAC5Bi7B,EAAMlwC,KAAK+gC,OAAOmP,IAAGqqB,EAAAlvD,GACXrL,KAAKiiD,OAAK,IAA1B,IAAAsY,EAAAhvD,MAAA+uD,EAAAC,EAAA/zD,KAAA9E,MAA4B,KAAjB6J,EAAC+uD,EAAAz8D,MACV0N,EAAE4U,KAAKka,KAAKhb,YAAcgb,EAAO,EAAIxlB,GAAIiJ,kBAAkBmN,KAAM+F,iBAAiBC,EAAQC,EAASmJ,EAAM6V,IAAQ,IACjH3kC,EAAE4U,KAAKma,IAAIjb,YAAcib,EAAM,EAAIzlB,GAAIiJ,kBAAkBmN,KAAM+F,iBAAiBC,EAAQC,EAASoJ,EAAK4V,IAAQ,GAChH,CAAC,OAAAxxC,GAAA67D,EAAA3uD,EAAAlN,EAAA,SAAA67D,EAAA1uD,GAAA,CACH,GAEA,CAAAlO,IAAA,qBAAAE,MAGA,WAGI,IAAA+nH,EAAAC,EAAAC,EAAAC,EACFC,EAAuDhmH,KAA/C+gC,OAAUvP,EAAIw0F,EAAJx0F,KAAMgpB,EAAKwrE,EAALxrE,MAAOyqE,EAAOe,EAAPf,QAASE,EAAQa,EAARb,SACxC,IAAK3zF,IAASgpB,EAEZ,MAAO,CACLyrE,aAAa,EACbt4G,KAAM4O,GpBjtBkB,gBoBitBe,CAAE0C,OAH5BuS,EAAO2zF,EAASxmG,OAASsmG,EAAQtmG,QAGSW,iBAK3D,IAAM4mG,EAAS10F,EAAKwa,MAA8C,QAAzC45E,EAAG36F,KAAMoW,OAAO7P,EAAKwa,MAAMC,UAAU7pC,YAAI,IAAAwjH,OAAA,EAAtCA,EAAwCO,SAAoB,QAAZN,EAAGr0F,EAAKpvB,YAAI,IAAAyjH,OAAA,EAATA,EAAWM,SACpFC,EAAS5rE,EAAMxO,MAA+C,QAA1C85E,EAAG76F,KAAMoW,OAAOmZ,EAAMxO,MAAMC,UAAU7pC,YAAI,IAAA0jH,OAAA,EAAvCA,EAAyCK,SAAqB,QAAbJ,EAAGvrE,EAAMp4C,YAAI,IAAA2jH,OAAA,EAAVA,EAAYI,SAEzFx4G,EAAO,GAMX,OALKu4G,EAAM99D,SAAS68D,EAAQ1xC,SAEhB6yC,EAAMh+D,SAAS+8D,EAAS5xC,WAClC5lE,EAAO4O,GAAUA,EAA+B,CAAE0C,MAAOu7B,EAAM77B,OAAOW,cAAei0D,QAAS4xC,EAAS5xC,QAAU,MAFjH5lE,EAAO4O,GAAUA,EAA+B,CAAE0C,MAAOuS,EAAK7S,OAAOW,cAAei0D,QAAS0xC,EAAQ1xC,QAAU,KAI1G,CACL0yC,YAAaC,EAAM99D,SAAS68D,EAAQ1xC,UAAY6yC,EAAMh+D,SAAS+8D,EAAS5xC,SACxE5lE,KAAAA,EAEJ,GAEA,CAAAhQ,IAAA,qBAAAE,MAIA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACdnrB,KAAKokH,WACPvvG,GAAIyE,KAAK6R,EAAKwzE,SAAUxzE,EAAKk7F,OAAQl7F,EAAKm7F,OAAQn7F,EAAKo7F,QACvD1xG,GAAI2E,KAAK2R,EAAKq7F,WACdxmH,KAAK+/G,iBAAgB,KAErBlrG,GAAI2E,KAAK2R,EAAKk7F,OAAQl7F,EAAKo7F,OAAQp7F,EAAKwzE,UACpC3+F,KAAKm9G,UACPtoG,GAAI2E,KAAK2R,EAAKq7F,WACd3xG,GAAIyE,KAAK6R,EAAKm7F,QACdtmH,KAAK+/G,iBAAgB,KAErBlrG,GAAIyE,KAAK6R,EAAKq7F,WACd3xG,GAAI2E,KAAK2R,EAAKm7F,QACdtmH,KAAK+/G,iBAAgB,KAGzB//G,KAAKukH,sBACP,GAEA,CAAA5mH,IAAA,6BAAAE,OAAAw6G,EAAA5vG,EAAAzL,IAAAA,MAGA,SAAAmxC,IAAA,IAAAhjB,EAAAs7F,EAAAC,EAAA59E,EAAA69E,EAAA/4E,EAAAg5E,EAAA31F,EAAAC,EAAAoW,EAAAwG,EAAA5nB,EAAA,YAAAlpB,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OAkBK,OAjBG6oB,EAAOnrB,KAAKmrB,KAEZs7F,EAAa,eAAAnjF,EAAA76B,EAAAzL,IAAAA,MAAG,SAAA+sB,IAAA,IAAA88F,EAAAC,EAAAC,EAAAC,EAAAx1F,EAAAgpB,EAAA,OAAAx9C,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,UACf4jB,EAAK+gG,qBAAqBhB,YAAa,CAAF57F,EAAA/nB,KAAA,eAAA+nB,EAAApoB,OAAA,UAAS,GAAK,UAEnDikB,EAAK6a,UAAU7a,EAAK6a,OAAOmP,IAAIzI,KAAKqB,cAAgB,GAAC,CAAAze,EAAA/nB,KAAA,eAAA+nB,EAAApoB,OAAA,UAAS,GAAK,OAEf,GAFe4kH,EAEV3gG,EAAKghG,6BAA3DJ,EAAuBD,EAAvBC,wBAAyBC,EAAwBF,EAAxBE,yBAC7BD,IAA4Bh8F,GAAe++D,UAAYk9B,IAA6Bj8F,GAAe++D,SAAQ,CAAAx/D,EAAA/nB,KAAA,eAAA+nB,EAAApoB,OAAA,UAAS,GAAK,OAG5B,GAH4B+kH,EAErG9gG,EAAK6a,OAArBvP,EAAIw1F,EAAJx1F,KAAMgpB,EAAKwsE,EAALxsE,MACKhpB,GAAQvG,KAAMoW,OAAO7P,EAAKvc,IAAImQ,QAAUo1B,GAASvvB,KAAMoW,OAAOmZ,EAAMvlC,IAAImQ,OAC1E,CAAFiF,EAAA/nB,KAAA,gBAAA+nB,EAAApoB,OAAA,UAAS,GAAK,YACzBikB,EAAKw1F,UAAW,CAAFrxF,EAAA/nB,KAAA,gBAAA+nB,EAAApoB,OAAA,UAAS,GAAK,eAAAooB,EAAApoB,OAAA,UACzB,GAAI,yBAAAooB,EAAArlB,OAAA,GAAA+kB,EAAA,KACZ,kBAbkB,OAAAuZ,EAAA16B,MAAA,KAAAD,UAAA,KAAA0lC,EAAA3gC,GAenBmH,GAAGw5B,EAAA/rC,KAAA,EAAcmkH,IAAe,OAAAp4E,EAAAslB,GAAAtlB,EAAAvsC,KAAAusC,EAAA84E,GAAEh8F,EAAKuzF,UAASrwE,EAAA+4E,GAAEj8F,EAAKk8F,eAAch5E,EAAA3gC,GAAjEwmB,OAAMv0B,KAAA0uC,EAAA3gC,GAAA2gC,EAAAslB,GAAAtlB,EAAA84E,GAAA94E,EAAA+4E,IAENpnH,KAAK+gC,SAAQ2lF,EACsC1mH,KAAK+gC,OAAOmP,IAAzDzI,KAAQqB,EAAa49E,EAAb59E,cAAe69E,EAAeD,EAAfC,gBAC/B9xG,GAAIqf,OAAO4U,EAAgB,GAAK69E,EAAkB,EAAGx7F,EAAKm8F,+BAGtD15E,EAAW3iB,KAAM2iB,gBACYnsC,IAAnBzB,KAAK07G,WAA2B17G,KAAK+gC,OAAOvP,MAAQxxB,KAAK+gC,OAAOyZ,QAAOosE,EACb5mH,KAAK+gC,OAAzD9P,EAAM21F,EAAlBp1F,KAAQvc,GAA2Bic,EAAO01F,EAApBpsE,MAASvlC,GAAsBqyB,EAAIs/E,EAAX12E,IAAO5I,KACvDwG,EAAYF,EAASC,KAAK6G,MAAK,SAAA/P,GAAA,IAAWrY,EAAGqY,EAAX8I,OAAM,OAAYnhB,EAAI2E,SAAWA,GAAU3E,EAAI4E,UAAYA,GAAW5E,EAAIgb,OAASA,CAAI,IAC/HtnC,KAAK07G,UAAY1tF,QAAQ8f,aAAS,EAATA,EAAWxoB,UAGtCzQ,GAAIqf,OAAOl0B,KAAK07G,UAAWvwF,EAAKuwF,WAC5B17G,KAAK07G,WAAW7mG,GAAI2E,KAAK2R,EAAKuzF,UAAWvzF,EAAKk8F,gBAAe,yBAAAh5E,EAAArpC,OAAA,GAAAmpC,EAAA,UAClE,kBAAAkqE,EAAAzvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,yBAAAE,MAGA,WACE,IAAQstB,EAASnrB,KAATmrB,KAERo8F,EAA8BvnH,KAAKinH,qBAA3BhB,EAAWsB,EAAXtB,YAAat4G,EAAI45G,EAAJ55G,KACjBs4G,EAEFpxG,GAAI2E,KAAK2R,EAAKq8F,YAGhBr8F,EAAKq8F,UAAUnoG,YAAc1R,EAC7BkH,GAAIyE,KAAK6R,EAAKq8F,WACd3yG,GAAI2E,KAAK2R,EAAKmvF,eACdzlG,GAAI2E,KAAK2R,EAAK8hE,UAChB,GAEA,CAAAtvF,IAAA,wBAAAE,OAAAu6G,EAAA3vG,EAAAzL,IAAAA,MAIA,SAAAi6C,EAA6BwwE,GAAe,IAAA1pG,EAAA,OAAA/gB,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,OACpCyb,EAAU0pG,EAASznH,KAAK+gC,OAAOvP,KAAKvc,GAAKjV,KAAK+gC,OAAOyZ,MAAMvlC,GACjEjV,KAAKk6G,iBAAiB1iC,SAASz5D,EAAS/d,KAAK+gC,OAAOmP,IAAI5I,MACxDtnC,KAAKi9C,MAAM3jC,KAAKtZ,KAAKmrB,KAAK+uF,kBAAiB,wBAAAhjE,EAAAlyC,OAAA,GAAAiyC,EAAA,UAC5C,SAAAtqC,GAAA,OAAAyrG,EAAAxvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,6BAAAE,MAIA,WAIE,IAAA6pH,EAAoC1nH,KAA5B+gC,OAAUvP,EAAIk2F,EAAJl2F,KAAMgpB,EAAKktE,EAALltE,MACpBssE,EAA0Bh8F,GAAe++D,SACzCk9B,EAA2Bj8F,GAAe++D,SAE9C,GAAIr4D,SAAAA,EAAMwa,MAAO,KAAA27E,EACTC,EAAY38F,KAAMoW,OAAO7P,EAAKvc,IAC9B4yG,EAAc7nH,KAAK+gC,OAAOmP,IAAI7O,OAAO7P,EAAKvc,IAAIs+D,QAChDq0C,SAAiB,QAARD,EAATC,EAAWxiG,cAAM,IAAAuiG,GAAjBA,EAAmBp+B,eAAuD9nF,IAA3CmmH,EAAUxiG,OAAOmkE,SAASs+B,KAC3Df,EAA0Bc,EAAUxiG,OAAOmkE,SAASs+B,GAExD,CACA,GAAIrtE,SAAAA,EAAOxO,MAAO,KAAA87E,EACVC,EAAa98F,KAAMoW,OAAOmZ,EAAMvlC,IAChC+yG,EAAehoH,KAAK+gC,OAAOmP,IAAI7O,OAAOmZ,EAAMvlC,IAAIs+D,QAClDw0C,SAAkB,QAARD,EAAVC,EAAY3iG,cAAM,IAAA0iG,GAAlBA,EAAoBv+B,eAAyD9nF,IAA7CsmH,EAAW3iG,OAAOmkE,SAASy+B,KAC7DjB,EAA2BgB,EAAW3iG,OAAOmkE,SAASy+B,GAE1D,CAEA,MAAO,CACLlB,wBAAAA,EACAC,yBAAAA,EAEJ,GAEA,CAAAppH,IAAA,6BAAAE,MAIA,WACE,IAAQstB,EAASnrB,KAATmrB,KAER88F,EAA8DjoH,KAAKknH,6BAA3DJ,EAAuBmB,EAAvBnB,wBAAyBC,EAAwBkB,EAAxBlB,yBAEjC,GAAID,IAA4Bh8F,GAAe++D,UAAYk9B,IAA6Bj8F,GAAe++D,SAIrG,OAHAh1E,GAAI2E,KAAK2R,EAAK+8F,eACd/8F,EAAKyxF,SAASx8F,gBAAgB,iBAC9B+K,EAAKuxF,QAAQt8F,gBAAgB,YAI3B0mG,IAA4Bh8F,GAAe++D,UAAYk9B,IAA6Bj8F,GAAe++D,WACrG1+D,EAAKyxF,SAASvmB,aAAa,WAAY,YACvClrE,EAAKuxF,QAAQt8F,gBAAgB,YAC7BpgB,KAAK28G,SACL9nG,GAAIyE,KAAK6R,EAAKg9F,sBACdtzG,GAAI2E,KAAK2R,EAAKi9F,oBAAqBj9F,EAAKk9F,uBAGtCvB,IAA4Bh8F,GAAe++D,UAAYk9B,IAA6Bj8F,GAAe++D,WACrG1+D,EAAKuxF,QAAQrmB,aAAa,WAAY,YACtClrE,EAAKyxF,SAASx8F,gBAAgB,YAC9BpgB,KAAK68G,UACLhoG,GAAIyE,KAAK6R,EAAKi9F,qBACdvzG,GAAI2E,KAAK2R,EAAKg9F,qBAAsBh9F,EAAKk9F,uBAIvCvB,IAA4Bh8F,GAAe++D,UAAYk9B,IAA6Bj8F,GAAe++D,WACrGh1E,GAAIyE,KAAK6R,EAAKk9F,sBACdxzG,GAAI2E,KAAK2R,EAAKg9F,qBAAsBh9F,EAAKi9F,sBAG3CvzG,GAAIyE,KAAK6R,EAAK+8F,eACd/8F,EAAKm9F,0BAA0BjpG,YAAc8L,EAAKo9F,eAAelpG,YAAcrf,KAAK+gC,OAAOvP,KAAK7S,OAAOW,cACvG6L,EAAKq9F,2BAA2BnpG,YAAc8L,EAAKs9F,gBAAgBppG,YAAcrf,KAAK+gC,OAAOyZ,MAAM77B,OAAOW,cAC1GzK,GAAIqf,OAAO4yF,IAA4Bh8F,GAAe49F,YAAav9F,EAAK6wF,iBACxEnnG,GAAIqf,OAAO6yF,IAA6Bj8F,GAAe49F,YAAav9F,EAAK+wF,kBACzErnG,GAAIqf,OAAO4yF,IAA4Bh8F,GAAe69F,QAASx9F,EAAKy9F,qBACpE/zG,GAAIqf,OAAO6yF,IAA6Bj8F,GAAe69F,QAASx9F,EAAK09F,qBACvE,GAEA,CAAAlrH,IAAA,4BAAAE,MAGA,SAA2BirH,EAAsBC,EAAuBC,GACtE,IAAM79F,EAAOnrB,KAAKmrB,KAClBA,EAAK89F,eAAe5pG,YAAcypG,EAClC39F,EAAK+9F,sBAAsB7pG,YAAc0pG,EACzC59F,EAAKg+F,mBAAmBxwG,UAAUM,OAAO,YAAa,QAAS,WAC/DkS,EAAKg+F,mBAAmBxwG,UAAUC,IAAIowG,EACxC,GAEA,CAAArrH,IAAA,+BAAAE,MAIA,WACE,IAAQstB,EAA0BnrB,KAA1BmrB,KAAgB+kB,EAAUlwC,KAApB+gC,OAAUmP,IAIxB,GAHA/kB,EAAKi+F,aAAa/pG,YAAc6wB,EAAI5I,KACpCnc,EAAKk+F,gBAAgBhqG,YAAc6wB,EAAI5I,KAEnC4I,EAAIzI,KAAKqB,eAAiB,EAC5B9oC,KAAKspH,0BAA0B/sG,GpB14BM,4BoB04BuC,GAAI,iBADlF,CAKA,IAIMwsG,GAJgB74E,EAAIzI,KAAK+kC,cAAgB,IAAIjb,KAAI,SAAA1O,GACrD,IAAM0mE,EAAwBr5E,EAAIorB,WAAWzY,EAAQlkC,QAAQ6qG,MAC7D,MAAO,GAAPz9G,OAAU82C,EAAQ2mE,MAAK,OAAAz9G,OAAMw9G,EAC/B,IACmCp9D,KAAK,MACxCnsD,KAAKspH,0BAA0B/sG,GpBr5BC,qBoBq5BqCwsG,EAAe,UAPpF,CAQF,GAEA,CAAAprH,IAAA,kCAAAE,MAIA,WAAmC,IAAAkpB,EAAA,KACzBoE,EAAiBnrB,KAAjBmrB,KAAM4V,EAAW/gC,KAAX+gC,OACd,GAAKA,GAAWA,EAAOmP,KAInBnP,EAAOmP,IAAIu5E,mBAAqB5+F,GAAiB6+F,UAArD,CAEA1pH,KAAK2pH,+BAEL,IAAMC,EAAc,SAACC,GAEnB,IADA,IACAlyG,EAAA,EAAAmyG,EADiB,CAAC3+F,EAAKg+F,mBAAoBh+F,EAAK4+F,aAAc5+F,EAAK6+F,oBAAqB7+F,EAAKmvF,eACpE3iG,EAAAmyG,EAAAvmH,OAAAoU,IAAE,CAAtB,IAAM3C,EAAE80G,EAAAnyG,GACX9C,GAAIqf,OAAOlf,IAAO60G,EAAS70G,EAC7B,CACF,EAEA,GAAI+rB,EAAOmP,IAAIzI,KAAKqB,eAAiB,EAAG,CACtC,IAAMhjB,EAAM,eAAAguB,EAAArrC,EAAAzL,IAAAA,MAAG,SAAAohD,IAAA,OAAAphD,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,OACbsnH,OAAYnoH,GACZslB,EAAKg8F,6BAA4B,wBAAAxkE,EAAAv5C,OAAA,GAAAo5C,EAAA,KAClC,kBAHW,OAAAtK,EAAAlrC,MAAA,KAAAD,UAAA,KAIZ,GAAIkM,GAAI0wE,SAASp6D,EAAKuzF,WAIpB,YADAnlG,WAAWuM,EAAQ,KAGrBA,GACF,MAAWib,EAAOmP,IAAIqsB,UACpBpxC,EAAK8+F,gBAAgB5qG,YAAc0hB,EAAOmP,IAAI5I,KAC9CsiF,EAAYz+F,EAAKmvF,gBACRt6G,KAAKkqH,kBACdN,EAAYz+F,EAAKg+F,oBACRpoF,EAAOmP,IAAIzI,KAAKoB,WAAa,EACtC+gF,EAAYz+F,EAAK6+F,sBAEjB7+F,EAAKg/F,SAAS9qG,YAAc,GAAHtT,OAAMg1B,EAAOmP,IAAIzI,KAAKqB,eAC/C3d,EAAKi/F,gBAAgBj+E,KAAO,gBAAHpgC,OAAmBg1B,EAAOmP,IAAI5I,MACvDsiF,EAAYz+F,EAAK4+F,cAjCmD,CAmCxE,GAAC,CAAApsH,IAAA,mBAAAE,MAED,WACMmC,KAAKm9G,SACPn9G,KAAKmrB,KAAK2qD,WAAWz2D,YAAc9C,GpB9+BP,kBoB8+B0C,CAAE0C,MAAOpK,GAAIw1G,YAAYrqH,KAAK+gC,OAAOkkF,QAAQvwG,SAASC,aAAamI,QACpI9c,KAAKmrB,KAAK2qD,WAAWz2D,YAAc9C,GpBh/Bb,iBoBg/B+C,CAAE0C,MAAOpK,GAAIw1G,YAAYrqH,KAAK+gC,OAAOkkF,QAAQvwG,SAASC,aAAamI,OACjJ,GAAC,CAAAnf,IAAA,sBAAAE,MAED,SAAqBysH,EAAoBC,GACvC,IAAMC,EAAMxqH,KAAKmrB,KAAK2qD,WAClBw0C,GACFE,EAAIpqG,gBAAgB,YACpBoqG,EAAIpqG,gBAAgB,WAEpBoqG,EAAIn0B,aAAa,WAAY,QACzBk0B,GAAoBC,EAAIn0B,aAAa,QAASk0B,GAEtD,GAAC,CAAA5sH,IAAA,uBAAAE,MAED,WACE,IAAgBmrC,EAAyEhpC,KAAjF+gC,OAAM0pF,EAA2EzqH,KAApEqkH,aAAqBqG,EAAQD,EAAbl6F,IAAqBo6F,EAASF,EAAfnuG,KAAiB8nG,EAAOqG,EAAPrG,QAAS30F,EAAIg7F,EAAJh7F,KACxEwlB,EAAahqB,KAAMoW,OAAOrhC,KAAK+gC,OAAOvP,KAAKvc,IAAImQ,OAC/CuwB,EAAc1qB,KAAMoW,OAAO2H,EAAIwR,MAAMvlC,IAAImQ,OAC/C,GAAK6vB,GAAeU,EAEpB,GAAI+0E,GAAY,GAAKA,EAAW1hF,EAAI1c,IAAI+c,QACtCrpC,KAAK4qH,qBAAoB,EAAOruG,GAAUA,UAK5C,GAAK6nG,EASL,GAAKuG,EAAL,CAMA,GAAIl7F,EACF,OAAIwlB,EAAWuD,QAAQxI,UAAYhH,EAAI1c,IAAI+c,aACzCrpC,KAAK4qH,qBAAoB,EAAOruG,GAAUA,UAGxCysB,EAAIu0E,SACNv9G,KAAK4qH,oBAAoBF,GAAY1hF,EAAIu0E,QAAQzwD,KAAKjvD,MAAO0e,GAAUA,MAM3E,IAAMD,EAAOtc,KAAK29G,eACZkN,EAAO7hF,EAAI1c,IAAI+c,SAAW/sB,EAAOs1B,IACvC,GAAI+D,EAAY6C,QAAQxI,UAAY66E,EAClC7qH,KAAK4qH,qBAAoB,EAAOruG,GAAUA,UAG5C,GAAIysB,EAAI00E,QAAQphG,GAAO,CACrB,IAAM0P,EAAS0+F,GAAY1hF,EAAI00E,QAAQphG,GAAMwwC,KAAKla,KAAO5J,EAAI1c,IAAI+c,QACjErpC,KAAK4qH,oBAAoB5+F,EAAQzP,GAAUA,IAC7C,CAxBA,MAFEvc,KAAK4qH,qBAAoB,EAAOruG,GAAUA,UATtCkT,EACFzvB,KAAK4qH,oBAAoBF,GAAYz1E,EAAWuD,QAAQxI,UAAWzzB,GAAUA,KAE7Evc,KAAK4qH,oBAAoBF,GAAY/0E,EAAY6C,QAAQxI,UAAWzzB,GAAUA,IAiCpF,GAAC,CAAA5e,IAAA,oBAAAE,MAED,WAAqB,IAAA+pB,EAAA,KACXuD,EAAiBnrB,KAAjBmrB,KAAM4V,EAAW/gC,KAAX+gC,OACdlsB,GAAImD,MAAMmT,EAAK2/F,YAAW,IACarwD,EADbC,EAAArvD,GACR01B,EAAOmP,IAAI66E,YAAU,QAAAngD,EAAA,WAAE,IAA9BhqD,EAAG65C,EAAA58D,MACNmyE,EAAO7kD,EAAK0wF,gBAAgBpwF,WAAU,GAC5CukD,EAAK3wD,YAAcuB,EACnB/L,GAAI1K,KAAK6lE,EAAM,SAAS,kBAAMpoD,EAAKojG,uBAAuBpqG,EAAI,IAC9DuK,EAAK2/F,WAAWxyG,YAAY03D,EAC9B,EALA,IAAAtV,EAAAnvD,MAAAkvD,EAAAC,EAAAl0D,KAAA9E,MAAAkpE,GAOA,OAAAlsE,GAAAg8D,EAAA9uD,EAAAlN,EAAA,SAAAg8D,EAAA7uD,GAAA,CACA7L,KAAKirH,aACP,GAEA,CAAAttH,IAAA,YAAAE,OAAAqgD,EAAAz1C,EAAAzL,IAAAA,MACA,SAAAkiD,EAAiB5X,EAAcrW,EAAgBC,GAAe,IAAAgf,EAAA/kB,EAAAmqC,EAAAsF,EAAAD,EAAApvD,EAAA05G,EAAAE,EAAArtE,EAAAt8B,EAAAC,EAAA2lB,EAAA8pF,EAAAtD,EAAAG,EAAA/+E,EAAA,OAAAhsC,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,OA+B5D,GA9BM4tC,EAAMjlB,KAAM6gB,KAAKtE,UAAUF,GAC3Bnc,EAAOnrB,KAAKmrB,KAElBjf,OAAOi/G,QAAO1iH,EAAAzL,IAAAA,MAAG,SAAA0hD,IAAA,IAAAt1C,EAAA,OAAApM,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,cAAAq8C,EAAAr8C,KAAA,EACGuL,EAAS,eAAgB,CAAEy5B,KAAAA,EAAMrW,OAAAA,EAAQC,QAAAA,IAAU,OAA/D9nB,EAAGu1C,EAAA78C,KACT6Y,QAAQ64B,IAAIpqC,EAAIgwB,MAAK,wBAAAulB,EAAA35C,OAAA,GAAA05C,EAAA,KAIvBvzB,EAAKqyF,SAAS3/G,MAAQ,GACtBstB,EAAK2yF,SAASjgH,MAAQ,GACtBstB,EAAK+xF,UAAUr/G,MAAQ,GAGvBmC,KAAK05G,WAAWx/E,QAChBrlB,GAAImD,MAAMhY,KAAKmrB,KAAKs1F,SACpB5rG,GAAImD,MAAMhY,KAAKmrB,KAAKu1F,UAIpB1gH,KAAK24G,cAAgB,GACrB9jG,GAAImD,MAAMmT,EAAKo4F,uBAGfvjH,KAAK26G,WAAWoJ,sBAAqB,GAErClvG,GAAI2E,KAAK2R,EAAKmvF,cAAenvF,EAAK4+F,aAAc5+F,EAAK8hE,UAKhD/8C,GAAQA,EAAI+F,SAAW/F,EAAIu5E,mBAAqB5+F,GAAiB6+F,UAAS,CAAA/pE,EAAAr9C,KAAA,SAInD,OAHtBgzD,EAAS/4C,GpBnlCiB,qBoBolC1B2zB,EAAIhrB,WAAUowC,EAAS/4C,GpBj6BE,qBoBk6B7B4O,EAAKigG,YAAY/rG,YAAci2C,EAC/BzgD,GAAIyE,KAAK6R,EAAKigG,aAAYzrE,EAAA19C,OAAA,kBAAA24D,EAAAvvD,GAIZrL,KAAKiiD,OAAK,IAA1B,IAAA2Y,EAAArvD,MAAAovD,EAAAC,EAAAp0D,KAAA9E,MAAW6J,EAACovD,EAAA98D,MAAgBgX,GAAIyE,KAAK/N,EAAE+7C,IAAI,OAAA5oD,GAAAk8D,EAAAhvD,EAAAlN,EAAA,SAAAk8D,EAAA/uD,GAAA,CAErCo5G,EAAU/0E,EAAI7O,OAAOpQ,GACrBk0F,EAAWj1E,EAAI7O,OAAOnQ,GAAQ4mB,EAEjB,CAAC7sB,KAAMvW,SAASuc,EAAQif,GAAMjlB,KAAMvW,SAASwc,EAASgf,IAA7Dz0B,EAAGq8B,EAAA,GAET1W,EAAuBwQ,IAFtBp2B,EAAGs8B,EAAA,IAEsDnjC,aAAaC,iBAAmB6G,EAAI9G,aAAaC,iBACjHC,GAAI2E,KAAK2R,EAAKmyF,OAAQnyF,EAAKigG,aACvBprH,KAAKqrH,mBACPn/G,OAAOwzB,aAAa1/B,KAAKqrH,kBACzBrrH,KAAKqrH,iBAAmB,MAEpBH,EAAQI,GAASrG,EAAQtmG,OAAQwmG,EAASxmG,QAC1CipG,EAAY38F,KAAMoW,OAAOpQ,GACzB82F,EAAa98F,KAAMoW,OAAOnQ,GAE1B8X,EAAM,CACVkH,IAAKA,EACLq7E,IAAKL,EACL5+F,IAAK4jB,EAAI+F,QAAQi1E,GAGjB15F,KAAMo2F,EACNptE,MAAOutE,EACPvpG,aAAchD,EACdiD,cAAehD,EACf8hG,QAAS,KACTG,QAAS,CAAC,EACV8N,kBAAkB,EAClB/F,aAAc,CAAC,EACfR,QAAAA,EACAE,SAAAA,EACA/jF,qBAAAA,EACAqqF,YAAa,EACbC,WAAY,EACZC,YAAY,GAGd3rH,KAAK+gC,OAASiI,EACdhpC,KAAKy7G,GAAGwG,UAAU36E,EAAMrW,EAAQC,GAChClxB,KAAK07G,eAAYj6G,EACjB0pB,EAAKqO,QAAQna,YAAcxK,GAAIkc,gBAAgBiY,EAAI1c,IAAI+c,QAASL,EAAIxqB,cACpE2M,EAAK2V,SAASzhB,YAAcxK,GAAIkc,gBAAgBiY,EAAI1c,IAAI0U,SAAWI,GAEnEphC,KAAK4rH,gCACL5rH,KAAK26G,WAAWkR,WAAWvkF,EAAMrW,EAAQC,GACzClxB,KAAK8rH,mBACL9rH,KAAK+rH,qBAKL/N,GAAGvH,QAAQ,aAAcmN,GAAWt8E,EAAMrW,EAAQC,IAElDzmB,EAAMgE,WAAWhE,EAAMo5G,aAAc,CACnCv8E,KAAMA,EACN9V,KAAMP,EACNupB,MAAOtpB,IAETjG,KAAM+gG,qBAAqBhsH,KAAKu4G,KAAMtnF,EAAQC,EAASgf,GACvDlwC,KAAKwhH,WAAWyK,OAAO3kF,EAAMrW,EAAQC,GACrClxB,KAAKksH,yBACLlsH,KAAKmsH,6BACLnsH,KAAKgkH,kCACLhkH,KAAK+iH,6BACL/iH,KAAKmkH,mBACLnkH,KAAK4qH,qBAAoB,EAAOruG,GAAUA,KAC1Cvc,KAAKosH,oBACLpsH,KAAK+/G,iBAAgB,GACrB//G,KAAKqsH,cACLrsH,KAAK27G,gBAAgB2Q,QAAQp8E,EAAI5I,MACjCtnC,KAAK4iH,mBACL5iH,KAAKusH,iBAAgB,yBAAA5sE,EAAA36C,OAAA,GAAAk6C,EAAA,UACtB,SAAAtyC,EAAAkB,EAAAC,GAAA,OAAAmwC,EAAAt1C,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gCAAAE,MAIA,WAAiC,IAAA2uH,EAAAC,EAAAC,EAAAC,EACzBxhG,EAAOnrB,KAAKmrB,KACZ6d,EAAMhpC,KAAK+gC,OACX6rF,EAAU5jF,EAAIi8E,QAAQtmG,OAAOooF,oBAC7B8lB,EAAW7jF,EAAIm8E,SAASxmG,OAAOooF,oBACjC+lB,EAAc,GAElB,GADAj4G,GAAI2E,KAAK2R,EAAK8hE,UACD,QAATu/B,EAACxjF,EAAIxX,YAAI,IAAAg7F,GAARA,EAAUpnG,QAAoB,QAAVqnG,EAACzjF,EAAIwR,aAAK,IAAAiyE,GAATA,EAAWrnG,OAChC,GAAa,QAATsnG,EAAC1jF,EAAIxX,YAAI,IAAAk7F,GAARA,EAAUtnG,OACf,IAAc,QAAVunG,EAAC3jF,EAAIwR,aAAK,IAAAmyE,GAATA,EAAWvnG,OAChB,OADwB0nG,EAAcvwG,GAAUA,GAAiC,CAAE0C,MAAO4tG,GACpF,MAFiBC,EAAcvwG,GAAUA,GAAiC,CAAE0C,MAAO2tG,SADjDE,EAAcvwG,GpBviC/B,gBoBuiCgE,CAAEwwG,OAAQH,EAASI,OAAQH,IAKvH1hG,EAAK8hE,SAAS5tE,YAAcytG,EAC5Bj4G,GAAIyE,KAAK6R,EAAK8hE,SAChB,GAEA,CAAAtvF,IAAA,mBAAAE,MAIA,SAAkBqc,GAChBla,KAAKmrB,KAAK+xF,UAAUr/G,MAAQyL,OAAO4Q,GACnCla,KAAK8/G,kBACP,GAEA,CAAAniH,IAAA,oBAAAE,MAIA,SAAmBqc,GACjB,IAAMiR,EAAOnrB,KAAKmrB,KAClB8hG,EAA8CjtH,KAAK+gC,OAA7B3mB,EAAC6yG,EAAfzuG,aAAgC0uG,EAACD,EAAhBxuG,cAGzB0M,EAAKgiG,eAAe9tG,YAAcxK,GAAIkc,gBAAgB7W,EAAE+gB,SAAW7gB,EAAEzF,aAAaC,iBAAkBwF,GACpG+Q,EAAKiiG,gBAAgB/tG,YAAcxK,GAAIkc,gBAAgB7W,EAAEghB,UAAYgyF,EAAEv4G,aAAaC,iBAAkBs4G,GACtG/hG,EAAKkiG,cAAchuG,YAAcxK,GAAIkc,gBAAgB7W,EAAE6gB,QAAU3gB,EAAEzF,aAAaC,iBAAkBwF,GAClG+Q,EAAKmiG,eAAejuG,YAAcxK,GAAIkc,gBAAgB7W,EAAE8gB,SAAWkyF,EAAEv4G,aAAaC,iBAAkBs4G,EACtG,GAEA,CAAAvvH,IAAA,mBAAAE,MAIA,SAAkBqc,GAChB,KAAOla,KAAK84G,OAAOv1G,QAASvD,KAAK84G,OAAOv9E,QAAwB5iB,UAAUM,OAAO,SACjF,IAAMkS,EAAOnrB,KAAKmrB,KAClB,GAAKjR,EAAL,CAIArF,GAAIyE,KAAK6R,EAAKoiG,aAId,IAAK,IAALn1G,EAAA,EAAAwoD,EAA2BvjE,OAAO+C,OAAOJ,KAAK04G,YAAWtgG,EAAAwoD,EAAAr9D,OAAA6U,IAAE,CAAtD,IAAAo1G,EAAA5sD,EAAAxoD,GAAQ+uB,EAAGqmF,EAAHrmF,IAAKhe,EAAGqkG,EAAHrkG,If5tCM,Ie6tClBA,EAAI5b,QACJ2M,EAAE8iB,aAAape,QAAQuK,EAAI7M,OAAS,IACtC6qB,EAAIxuB,UAAUC,IAAI,SAClB5Y,KAAK84G,OAAO91G,KAAKmkC,GAErB,CAEAhc,EAAKsiG,WAAWpuG,YAAcxK,GAAIkc,gBAAgB7W,EAAEoC,MACpD6O,EAAKuiG,YAAYruG,YAAcxK,GAAIkc,gBAAgB7W,EAAEikB,OACrDhT,EAAKuiG,YAAYnzG,MAAM6N,MAAQlO,EAAE6jB,QAfjC,MAFElpB,GAAI2E,KAAK2R,EAAKoiG,YAkBlB,GAEA,CAAA5vH,IAAA,kBAAAE,MAKA,SAAiBw0B,GACf5nB,EAAMgE,WAAWhE,EAAMkvG,YAAatnF,EACtC,GAAC,CAAA10B,IAAA,oBAAAE,MAED,SAAmB8vH,GACjB,IAAMxiG,EAAOnrB,KAAKmrB,KACbwiG,GAIL94G,GAAIyE,KAAK6R,EAAKyiG,eACdziG,EAAK0iG,YAAYxuG,YAAcxK,GAAIkc,gBAAgB48F,EAAOjrF,UAAY1iC,KAAK+gC,OAAOK,sBAClFjW,EAAK2iG,UAAUzuG,YAAcxK,GAAIkc,gBAAgB48F,EAAOhrF,QAAU3iC,KAAK+gC,OAAOK,sBAC9EjW,EAAK4iG,WAAW1uG,YAAcxK,GAAIkc,gBAAgB48F,EAAOntF,SAAWxgC,KAAK+gC,OAAOK,sBAChFjW,EAAK6iG,UAAU3uG,YAAcxK,GAAIkc,gBAAgB48F,EAAOltF,QAAUzgC,KAAK+gC,OAAOK,sBAC9EjW,EAAK8iG,UAAU5uG,YAAcxK,GAAIkc,gBAAgB48F,EAAOjtF,YAAa1gC,KAAK+gC,OAAOviB,eAR/E3J,GAAI2E,KAAK2R,EAAKyiG,cASlB,GAEA,CAAAjwH,IAAA,aAAAE,MAIA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACd2yF,EAAW3yF,EAAK2yF,SACdoQ,EAAQluH,KAAKokH,UACb30F,EAAOzvB,KAAKm9G,SACZp8E,EAAS/gC,KAAK+gC,OAChBotF,EAAUptF,EAAOviB,aAAa7J,aAAaC,iBAK/C,OAJKs5G,GAAUz+F,IACbquF,EAAW3yF,EAAK4yF,YAChBoQ,EAAUptF,EAAOtiB,cAAc9J,aAAaC,kBAEvC,CACL0yB,KAAMvG,EAAOmP,IAAI5I,KACjB88E,QAAS8J,EACTz+F,KAAMA,EACN+B,KAAMuP,EAAOvP,KAAKvc,GAClBulC,MAAOzZ,EAAOyZ,MAAMvlC,GACpBsb,IAAK69F,GAAetQ,EAASjgH,OAAS,GAAIswH,GAC1C7xG,KAAM8xG,GAAejjG,EAAK+xF,UAAUr/G,OAAS,GAAIkjC,EAAOK,sBACxDitF,OAAQljG,EAAKmjG,OAAO31D,UAAW,EAC/B41D,QAAS,CAAC,EAEd,GAEA,CAAA5wH,IAAA,kBAAAE,MAGA,SAAiByb,GACf,IAAM6R,EAAOnrB,KAAKmrB,KAClB,GAAKnrB,KAAK+gC,OAAOvP,MAASxxB,KAAK+gC,OAAOyZ,MAAtC,CACA,IAAMxqB,EAAQhwB,KAAKqkH,aAAerkH,KAAKskH,aACjCkK,EAAWxuH,KAAK29G,eActB,GAbAxyF,EAAKsjG,SAASpvG,YAAc,GACxBmvG,IACEx+F,EAAMP,KAAMzvB,KAAK0uH,UAChB1uH,KAAK2uH,UAEZ3uH,KAAK64G,WAAW5vG,MAAQ,GACpBulH,GAAYxuH,KAAKokH,YACnBpkH,KAAK64G,WAAW5vG,MAAQ,CAAC,CACvBqT,KAAM0T,EAAM1T,KAAOtc,KAAK+gC,OAAOK,qBAC/BhZ,MAAO4H,EAAMP,KAAOzvB,KAAK05G,WAAWzmF,MAAMV,SAAWvyB,KAAK05G,WAAWzmF,MAAMT,WAG/ExyB,KAAKo9G,kBACA9jG,IAASk1G,IAAax+F,EAAMO,IAG/B,OAFApF,EAAKyjG,aAAavvG,YAAc,QAChCrf,KAAKo9G,iBAGP,IAAoCtgG,EAAamO,KAAMoW,OAAOrR,EAAMwqB,OAA5D9lC,SAAYC,aAAgBmI,KAC9B+xG,EAAW7+F,EAAMO,IAAMP,EAAM1T,KAAOs1B,GACpC3B,EAAQp7B,GAAIkc,gBAAgB89F,EAAU7uH,KAAK+gC,OAAOtiB,eAExD0M,EAAKyjG,aAAavvG,YAAc9C,GpB9zCJ,gBoB8zCqC,CAAE0zB,MAAAA,EAAOhxB,MAAOnC,IAC7E9c,KAAKm9G,SAAUn9G,KAAK0uH,UACnB1uH,KAAK2uH,QA3ByC,CA4BrD,GAEA,CAAAhxH,IAAA,UAAAE,MAGA,WAAW,IAAAsqB,EAAA,KACH6gB,EAAMhpC,KAAK+gC,OACXkU,EAAahqB,KAAMoW,OAAO2H,EAAIxX,KAAKvc,IAAImQ,OAC7C,OAAI6vB,EAAWuD,QAAQxI,UAAYhH,EAAI1c,IAAI+c,SACzCrpC,KAAK8uH,YAAY,WACjB9uH,KAAKukH,wBAGHv7E,EAAIu0E,SACNv9G,KAAK8uH,YAAY9lF,EAAIu0E,QAAQzwD,WAC7B9sD,KAAKukH,6BAIHv7E,EAAIwiF,mBACRxiF,EAAIwiF,kBAAmB,EAEvBxrH,KAAK+uH,oBAAoB,eAAgB,CAAC,EAAG,GAAG,SAAC3lH,GAC/C4/B,EAAIwiF,kBAAmB,EACvBxiF,EAAIu0E,QAAUn0G,EAAIm0G,QAClBv0E,EAAIyiF,YAAcx2E,EAAWuD,QAAQxI,UACrC7nB,EAAK2mG,YAAY1lH,EAAIm0G,QAAQzwD,MAC7B3kC,EAAKo8F,sBACP,KACF,GAEA,CAAA5mH,IAAA,SAAAE,MAGA,WAAU,IAAAg5B,EAAA,KACFmS,EAAMhpC,KAAK+gC,OACXzkB,EAAOtc,KAAK29G,eACZhoE,EAAc1qB,KAAMoW,OAAO2H,EAAIwR,MAAMvlC,IAAImQ,OAC/C,GAAKuwB,EAAL,CACA,IAAMk1E,EAAO7hF,EAAI1c,IAAI+c,SAAW/sB,EAAOs1B,IACvC,GAAI+D,EAAY6C,QAAQxI,UAAY66E,EAGlC,OAFA7qH,KAAK8uH,YAAY,WACjB9uH,KAAKukH,uBAGP,GAAIv7E,EAAI00E,QAAQphG,GAGd,OAFAtc,KAAK8uH,YAAY9lF,EAAI00E,QAAQphG,GAAMwwC,WACnC9sD,KAAKukH,uBAKP,IAAMjO,EAAQj5G,OAAOkH,KAAKykC,EAAI00E,SAASn6G,OAAS,IAAM,EACtDvD,KAAK+uH,oBAAoB,cAAe,CAAEzyG,KAAAA,GAAQg6F,GAAO,SAACltG,GACxD4/B,EAAI00E,QAAQphG,GAAQlT,EAAIq0G,OACxBz0E,EAAI0iF,WAAazgG,KAAMoW,OAAO2H,EAAIwR,MAAMvlC,IAAImQ,OAAOozB,QAAQxI,UAC3DnZ,EAAKi4F,YAAY1lH,EAAIq0G,OAAO3wD,MAC5Bj2B,EAAK0tF,sBACP,GApBwB,CAqB1B,GAEA,CAAA5mH,IAAA,sBAAAE,MAKA,SAAqB+oF,EAAcl+E,EAAW4tG,EAAehnD,GAA6B,IAAA/3B,EAAA,KAClFpM,EAAOnrB,KAAKmrB,KACbnrB,KAAKgvH,YAAWhvH,KAAKgvH,UAAY/jG,KAAMuzB,QAAQrzB,EAAKmyF,SACzD,IAAAtlE,EAAmB,CAACh4C,KAAK+gC,OAAOvP,KAAKvc,GAAIjV,KAAK+gC,OAAOyZ,MAAMvlC,IAApDg6G,EAAGj3E,EAAA,GAAEk3E,EAAGl3E,EAAA,GACfsD,EAA2B,CAACrwB,KAAMoW,OAAO4tF,GAAK7pG,OAAQ6F,KAAMoW,OAAO6tF,GAAK9pG,QAAjE+pG,EAAO7zE,EAAA,GAAE8zE,EAAO9zE,EAAA,GACvB,GAAK6zE,GAAYA,EAAQ7pG,SAAY8pG,GAAYA,EAAQ9pG,QAAzD,CACItlB,KAAKqrH,kBAAkBn/G,OAAOwzB,aAAa1/B,KAAKqrH,kBAEpDx2G,GAAIyE,KAAK6R,EAAKmyF,OAAQnyF,EAAKkkG,WAC3Bx6G,GAAI2E,KAAK2R,EAAKmkG,aAAcnkG,EAAKokG,cAAepkG,EAAKqkG,cACrDrkG,EAAKskG,YAAYpwG,YAAc9C,GpB54CL,eoB64C1B4O,EAAKukG,eAAerwG,YAAc,GAClCrf,KAAKy4G,wBACL,IAAMkX,EAAU3vH,KAAKy4G,sBACrBz4G,KAAKqrH,iBAAmBn/G,OAAOqN,WAAU9Q,EAAAzL,IAAAA,MAAC,SAAAkmE,IAAA,IAAA95D,EAAA,OAAApM,IAAAA,MAAA,SAAAo/D,GAAA,cAAAA,EAAAv3D,KAAAu3D,EAAA95D,MAAA,OACZ,GAA5Bi1B,EAAK8zF,iBAAmB,KACpBsE,IAAYp4F,EAAKkhF,sBAAqB,CAAAr8C,EAAA95D,KAAA,eAAA85D,EAAAn6D,OAAA,wBAAAm6D,EAAA95D,KAAA,EACxBuL,EAAS+4E,EAAIj5B,GAAA,CAC7BrmB,KAAM/P,EAAKwJ,OAAOmP,IAAI5I,KACtB9V,KAAMy9F,EACNz0E,MAAO00E,GACJxmH,IACH,OALO,GAAHU,EAAGgzD,EAAAt6D,KAML6tH,IAAYp4F,EAAKkhF,sBAAqB,CAAAr8C,EAAA95D,KAAA,eAAA85D,EAAAn6D,OAAA,oBACrCgpB,KAAM6mC,cAAc1oD,GAAM,CAAFgzD,EAAA95D,KAAA,SAM1B,OALDqY,QAAQC,KAAK,oCAAqCxR,GAClD+hB,EAAKskG,YAAYpwG,YAAc9C,GpB35CA,wBoB45C3Bgb,EAAKy3F,YACPz3F,EAAKy3F,YACLz3F,EAAKy3F,UAAY,MAClB5yD,EAAAn6D,OAAA,kBAGHqtD,EAAQlmD,GAAI,yBAAAgzD,EAAAp3D,OAAA,GAAAk+D,EAAA,KACXozC,EA7BqE,CA8B1E,GAEA,CAAA34G,IAAA,cAAAE,MACA,SAAa+xH,GACX,IAAMzkG,EAAOnrB,KAAKmrB,KACdnrB,KAAKgvH,YACPhvH,KAAKgvH,YACLhvH,KAAKgvH,UAAY,MAEnBn6G,GAAIyE,KAAK6R,EAAKmyF,OAAQnyF,EAAKkkG,WAC3B,IAAM5/F,EAAOzvB,KAAKm9G,SAEdvqE,EAAO,EAMX,GALIg9E,IAAUh9E,EAAOg9E,EAASh9E,MAE9BznB,EAAKskG,YAAYpwG,YAAcuzB,EAAKrrC,WAEpC4jB,EAAKukG,eAAerwG,YAAc9C,GAAmB,IAATq2B,EpBz6C1B,MACC,QoBy6Cdg9E,EAAL,CAEA,IAAMC,EAAYpgG,EAAOzvB,KAAK+gC,OAAOvP,KAAOxxB,KAAK+gC,OAAOyZ,MAExD,GAAa,IAAT5H,EAAY,CAEd,IAAIpZ,EAAUx5B,KAAK+gC,OAAOzU,IAAI+c,QAC9B,IAAK5Z,EAAM,CACT,IAAMqgG,EAAiB9vH,KAAK+vH,UAAU,GACtC,GAAuB,IAAnBD,EAAsB,OAC1Bt2F,GAAoBs2F,CACtB,CAEA,GADgBD,EAAUzqG,OAAOozB,QAAQxI,UAAYxW,EAAU,EAClD,CACX,GAAIq2F,EAAU7jF,MAAO,CACnB,IAAAgkF,EAAmE/kG,KAAMoW,OAAOwuF,EAAU7jF,MAAMC,UAAxDgkF,EAAQD,EAAxC5qG,OAAUozB,QAAWxI,UAAyBt7B,EAAQs7G,EAARt7G,SAQtD,YAPIu7G,EAAWL,EAASM,oBACtBr7G,GAAIyE,KAAK6R,EAAKokG,eACdpkG,EAAKglG,oBAAoB9wG,YAAc3K,EAASC,aAAamI,KAC7DqO,EAAKilG,eAAe/wG,YAAcxK,GAAIkc,gBAAgB6+F,EAASM,kBAAmBx7G,IAKtF,CAGA,GADmBm7G,EAAUzqG,OAAOozB,QAAQxI,WAAaxW,EAAUo2F,EAASM,mBAC3D,EAAG,MACtB,CAGA,OAFAr7G,GAAIyE,KAAK6R,EAAKqkG,mBACdrkG,EAAKklG,mBAAmBhxG,YAAcwwG,EAAUn7G,SAASC,aAAamI,KAExE,CACAjI,GAAIyE,KAAK6R,EAAKmkG,cAEdnkG,EAAKmlG,WAAWjxG,YAAcxK,GAAIkc,gBAAgB6+F,EAAS/xH,OAAS,EAAGgyH,EAAUn7G,UACjFyW,EAAKolG,cAAclxG,YAAcwwG,EAAUn7G,SAASC,aAAamI,IApC5C,CA2CvB,GAEA,CAAAnf,IAAA,gBAAAE,MAIA,SAAemyB,GACb,IAAQ7E,EAAiEnrB,KAAjEmrB,KAAIqlG,EAA6DxwH,KAA3D+gC,OAAiB0vF,EAAWD,EAAlBlkG,IAAOmkG,YAAervF,EAAoBovF,EAApBpvF,qBAC9C,GAAIpR,EAAMo0F,QAAS,CACjB,IAAKp0F,EAAM1T,KAGT,OAFAzH,GAAIyE,KAAK6R,EAAKsjG,UACdtjG,EAAKsjG,SAASpvG,YAAc9C,GpB3+CL,iBoB4+ChB,EAET,GAAIyT,EAAM1T,KAAOm0G,EAAa,CAC5B57G,GAAIyE,KAAK6R,EAAKsjG,UACd,IAAOv0G,EAAe8V,EAAM1T,KAAO8kB,EAAzBsvF,EAA+CD,EAAcrvF,EAEvE,OADAjW,EAAKsjG,SAASpvG,YAAc,iDAAHtT,OAAoDmO,EAAC,OAAAnO,OAAM2kH,IAC7E,CACT,CACF,CACA,QAAK1gG,EAAMO,MACT1b,GAAIyE,KAAK6R,EAAKsjG,UACdtjG,EAAKsjG,SAASpvG,YAAc9C,GpBt/CC,qBoBu/CtB,EAGX,GAEA,CAAA5e,IAAA,aAAAE,MACA,SAAYqQ,GAAuB,IAAAyiH,EACjCC,EAAgE5wH,KAAK+gC,OAA7DzU,EAAGskG,EAAHtkG,IAAK9N,EAAYoyG,EAAZpyG,aAAcC,EAAamyG,EAAbnyG,cAAewmG,EAAO2L,EAAP3L,QAASE,EAAQyL,EAARzL,SACnDnlH,KAAKo5B,KAAO,IAAIs7E,GAAUxmG,EAAM+2G,EAAQtmG,OAAQwmG,EAASxmG,QACzD3e,KAAK6wH,YAAW,IAC0BrxD,EAD1BG,EAAAt0D,GACK6C,EAAKkrB,KAAKiC,OAAS,IAAE,IAA1C,IAAAskC,EAAAp0D,MAAAi0D,EAAAG,EAAAn5D,KAAA9E,MAA6C,KAAlCsuB,EAAKwvC,EAAA3hE,MACVmyB,EAAM1T,KAAO,GAAGtc,KAAKo5B,KAAKxgB,IAAIoX,GAClChwB,KAAK8wH,cAAc9gG,EACrB,CAAC,OAAAtxB,GAAAihE,EAAA/zD,EAAAlN,EAAA,SAAAihE,EAAA9zD,GAAA,CACD,IAAK7L,KAAKo5B,KAIR,OAHAp5B,KAAK05G,WAAWx/E,QAChBrlB,GAAImD,MAAMhY,KAAKmrB,KAAKs1F,cACpB5rG,GAAImD,MAAMhY,KAAKmrB,KAAKu1F,UAGtB7rG,GAAIyE,KAAKtZ,KAAKmrB,KAAK4lG,WACf/wH,KAAKqjH,kBAAkBllF,OAAOn+B,KAAKqjH,kBAAkBllF,MAAMn5B,OAC/DhF,KAAK05G,WAAWxmF,OAAOva,UAAUM,OAAO,aACxCjZ,KAAK05G,WAAWtyF,IAAIpnB,KAAKo5B,KAAM9M,EAAI+c,QAAS/c,EAAI0U,SAAUxiB,EAAcC,GACxEze,KAAK24G,cAAuC,QAA1BgY,EAAGziH,EAAKkrB,KAAKu/E,qBAAa,IAAAgY,EAAAA,EAAI,GAChD3wH,KAAKy/G,2BACP,GAEA,CAAA9hH,IAAA,qBAAAE,MAKA,WACE,IAAMg8B,EAAM75B,KAAK85B,SACjB,IAAKD,EAAK,OAAOA,EACjB,IAAAm3F,EAA8ChxH,KAAK+gC,OAA7B3mB,EAAC42G,EAAfxyG,aAAgC0uG,EAAC8D,EAAhBvyG,cACzB,OAAOob,EAAMzf,EAAEzF,aAAaC,iBAAmBs4G,EAAEv4G,aAAaC,gBAChE,GAEA,CAAAjX,IAAA,SAAAE,MAQA,WACE,IAAMu7B,EAAOp5B,KAAKo5B,KAClB,GAAKA,EACL,OAAIA,EAAKL,MAAQK,EAAKL,KAAKx1B,OACrB61B,EAAKJ,OAASI,EAAKJ,MAAMz1B,QACnB61B,EAAKL,KAAK,GAAGk4F,QAAU73F,EAAKJ,MAAM,GAAGi4F,SAAW,EAAIr/E,GAEvDxY,EAAKL,KAAK,GAAGk4F,QAAUr/E,GAE5BxY,EAAKJ,OAASI,EAAKJ,MAAMz1B,OACpB61B,EAAKJ,MAAM,GAAGi4F,QAAUr/E,GAE1B,IACT,GAEA,CAAAj0C,IAAA,4BAAAE,MAIA,WACE,IAAMkjC,EAAS/gC,KAAK+gC,OACdvH,EAAUuH,EAAOzU,IAAI+c,QAErB6nF,EADKjmG,KAAM6gB,KAAKtE,UAAUzG,EAAOmP,IAAI5I,MACzB2O,QAAQlV,EAAOwqF,KAAK4F,UAChCt3F,EAAM75B,KAAKoxH,qBACbv3F,IACF75B,KAAKmrB,KAAKkmG,UAAUhyG,YAAcxK,GAAIkc,gBAAgByI,EAAU03F,EAASr3F,EAAKkH,EAAOviB,cAEzF,GAAC,CAAA7gB,IAAA,oBAAAE,MAED,WACE,IAAAyzH,EAAgDtxH,KAAK+gC,OAAtCuG,EAAIgqF,EAAXphF,IAAO5I,KAAqByO,EAAKu7E,EAAlBhlG,IAAOvoB,KAC9B,OAAOkP,KAAKqB,IA1gDW,GA0gDa2W,KAAMohC,OAAO/kB,EAAMyO,GAAOxyC,OAChE,GAAC,CAAA5F,IAAA,iBAAAE,OAAAs6G,EAAA1vG,EAAAzL,IAAAA,MAED,SAAA0mE,IAAA,IAAA6tD,EAAAn3G,EAAA8yG,EAAA5lF,EAAAyO,EAAAy7E,EAAAt4D,EAAA5lD,EAAAlK,EAAAijD,EAAAwT,EAAAD,EAAA8P,EAAA,OAAA1yE,IAAAA,MAAA,SAAA4mE,GAAA,cAAAA,EAAA/+D,KAAA++D,EAAAthE,MAAA,OAEE,IAAWkvH,KAFbD,EACqEvxH,KAAK+gC,OAA1D3mB,EAACm3G,EAAP//F,KAAgB07F,EAACqE,EAAR/2E,MAAiBlT,EAAIiqF,EAAXrhF,IAAO5I,KAAqByO,EAAKw7E,EAAlBjlG,IAAOvoB,KAC/B/D,KAAK04G,kBAAmB14G,KAAK04G,WAAW8Y,GAAI,GACzDp3G,GAAM8yG,EAAC,CAAAtpD,EAAAthE,KAAA,eAAAshE,EAAA3hE,OAAA,SAASjC,KAAKyxH,kBAAkB,KAAG,OACD,MAAxCv4D,EAAejuC,KAAMohC,OAAO/kB,EAAMyO,IACvBxyC,QAlhDM,IAkhDsB,CAAAqgE,EAAAthE,KAAA,eAAAshE,EAAA3hE,OAAA,SAASjC,KAAKyxH,kBAAkBv4D,IAAa,OAKzF,OAJK5lD,EAAsB,CAC1BgsF,MAAO,CAACh4D,GACRvG,OAAQ,CAAE9P,OAAQ7W,EAAEnF,GAAIic,QAASg8F,EAAEj4G,IACnCzO,EAAGxG,KAAK0xH,qBACT9tD,EAAAthE,KAAA,GACiBuL,EAAS,cAAeyF,GAAO,QAA3ClK,EAAGw6D,EAAA9hE,KACHuqD,EAASjjD,EAAIijD,QAAU,GAG7BwT,EAAAx0D,GACwB6tD,GAAY0K,EAAA/+D,KAAA,GAAA6qE,EAAA1yE,IAAAA,MAAA,SAAA0yE,IAAA,IAAAiiD,EAAA,OAAA30H,IAAAA,MAAA,SAAAomE,GAAA,cAAAA,EAAAv+D,KAAAu+D,EAAA9gE,MAAA,OAAzBqvH,EAAS/xD,EAAA/hE,MAAuBwuD,EAAOulE,MAAK,SAACC,GAAY,OAAKA,EAAM58G,KAAO08G,EAAU18G,EAAE,KAAGo3C,EAAOrpD,KAAK2uH,GAAU,wBAAAvuD,EAAAp+D,OAAA,GAAA0qE,EAAA,IAAA7P,EAAAt0D,IAAA,YAAAq0D,EAAAC,EAAAr5D,KAAA9E,KAAA,CAAAkiE,EAAAthE,KAAA,gBAAAshE,EAAA/9D,cAAA6pE,IAAA,iBAAA9L,EAAAthE,KAAA,iBAAAshE,EAAAthE,KAAA,iBAAAshE,EAAA/+D,KAAA,GAAA++D,EAAAjQ,GAAAiQ,EAAA,UAAA/D,EAAAj0D,EAAAg4D,EAAAjQ,IAAA,eAAAiQ,EAAA/+D,KAAA,GAAAg7D,EAAAh0D,IAAA+3D,EAAAj+D,OAAA,mBAAAi+D,EAAA3hE,OAAA,SACpHjC,KAAKyxH,kBAAkBroH,EAAIijD,QAAU,KAAG,yBAAAuX,EAAA5+D,OAAA,GAAA0+D,EAAA,0BAChD,kBAAAy0C,EAAAvvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,sBAAAE,MACA,WACE,IAAMwuD,EAASphC,KAAMohC,OAAOrsD,KAAK+gC,OAAOmP,IAAI5I,KAAMgkF,GAAStrH,KAAK+gC,OAAOkkF,QAAQtmG,OAAQ3e,KAAK+gC,OAAOokF,SAASxmG,SAC5G,OAAO3e,KAAKyxH,kBAAkBplE,EAChC,GAAC,CAAA1uD,IAAA,oBAAAE,MAED,SAAmBwuD,GAAiB,IAAAylE,EAAAC,EAMVtwD,EANUjpC,EAAA,KAC1BrN,EAA6BnrB,KAA7BmrB,KAAMutF,EAAuB14G,KAAvB04G,WAAY33E,EAAW/gC,KAAX+gC,OACpBzU,EAAMyU,EAAOzU,IAEb0lG,EAAgB,SAAC7oG,GAAU,OAAKA,EAAI5b,OfvmDhB,GeumDqDqkC,GAA2BzoB,EAAI,EAAAu4C,EAAAr2D,GAE5FghD,GAAM,IAAxB,IAAAqV,EAAAn2D,MAAAk2D,EAAAC,EAAAl7D,KAAA9E,MAA0B,KAAfynB,EAAGs4C,EAAA5jE,MAAY66G,EAAWvvF,EAAIlU,IAAM,CAAEkU,IAAKA,EAAiB,CAAC,OAAAzqB,GAAAgjE,EAAA91D,EAAAlN,EAAA,SAAAgjE,EAAA71D,GAAA,CACxE,IAAIomH,EAAe50H,OAAOkH,KAAKm0G,GAAYnnD,KAAI,SAACigE,GAAW,OAAK9Y,EAAW8Y,EAAI,IAC/ES,EAAax3F,MAAK,SAAC9zB,EAAcyT,GAC/B,IAAAwkC,EAA2B,CAACozE,EAAcrrH,EAAEwiB,KAAM6oG,EAAc53G,EAAE+O,MAA3D+oG,EAAOtzE,EAAA,GAAEuzE,EAAOvzE,EAAA,GACvB,OAAIszE,IAAYC,GAAiB,GACvBD,GAAWC,EAAgB,EAC9B/3G,EAAE+O,IAAI62E,WAAar5F,EAAEwiB,IAAI62E,UAClC,IACA,IAAMx5F,EAAIxG,KAAK0xH,oBAGf,IAAK,IAAMF,KAFPS,EAAa1uH,OAASiD,IAAKyrH,EAAeA,EAAaltH,MAAM,EAAGyB,IAElDkyG,SAAmBA,EAAW8Y,GAEhD38G,GAAImD,MAAMmT,EAAKw1F,YACf9rG,GAAIqf,OAAmB,QAAb49F,EAACG,SAAY,IAAAH,OAAA,EAAZA,EAAcvuH,OAAQ4nB,EAAKw1F,YACtC9rG,GAAIqf,SAAoB,QAAb69F,EAACE,SAAY,IAAAF,GAAZA,EAAcxuH,QAAQ4nB,EAAKinG,cAEvC,IAC+BzwD,EAD3B0wD,GAAgB,EAAKzwD,EAAAv2D,GACN4mH,GAAY,QAAAn5B,EAAA,WAAE,IAAtBwqB,EAAI3hD,EAAA9jE,MACPspC,EAAMhc,EAAK2wF,cAAcrwF,WAAU,GACzCN,EAAKw1F,WAAWroG,YAAY6uB,GAC5B,IAAMhnB,EAAOtL,GAAI6W,cAAcyb,GACzBmrF,EAASz9G,GAAI6W,cAAcvL,EAAKmyG,QAChC3/D,EAAU99C,GAAI6W,cAAcvL,EAAKwyC,SAEvC2wD,EAAKn8E,IAAMA,EACXm8E,EAAKgP,OAASA,EACdhP,EAAK3wD,QAAUA,EACf,IAmBI7hC,EAnBE3H,EAAMm6F,EAAKn6F,IAEX8+C,EAAU9+C,EAAIlU,GACds9G,EAAWP,EAAc7oG,GAI3B8+C,IAASywC,EAAWzwC,GAAWq7C,IAE9Bn6F,EAAIqpG,aAAe5gF,GAA2BzoB,KACjDhJ,EAAKmyG,OAAO35G,UAAUC,IAAI,sBAC1By5G,GAAgB,GAElBC,EAAOG,UAAU95G,UAAUC,IAAIuQ,EAAIsG,KAAO,OAAS,OAC9C8iG,GAAUD,EAAOG,UAAU95G,UAAUC,IAAI,YAC9C+5C,EAAQhiC,KAAKtR,YAAcikG,EAAKgP,OAAO3hG,KAAKtR,YAAcuyB,GAAqBzoB,GAC/EwpC,EAAQhiC,KAAKhY,UAAUC,IAAIuQ,EAAIsG,KAAO,YAAc,YACpD6iG,EAAO3hG,KAAKhY,UAAUC,IAAIuQ,EAAIsG,KAAO,YAAc,YACnDkjC,EAAQpiC,IAAIlR,YAAcikG,EAAKgP,OAAO/hG,IAAIlR,YAAcxK,GAAIkc,gBAAgB5H,EAAIoH,IAAKwQ,EAAOviB,cAEzDsS,EfxqDnB,IewqDZ3H,EAAIzpB,KAAqC84B,EAAKk6F,sBAAsBvpG,EAAK4X,GAC9DlsB,GAAIk2C,wBAAwB5hC,EAAI7M,KAAMykB,EAAOviB,aAAcuiB,EAAOtiB,cAAe6N,EAAI0U,UACpG2xB,EAAQr2C,KAAK+C,YAAcikG,EAAKgP,OAAOh2G,KAAK+C,YAAcyR,EAC1DwhG,EAAOhiF,WAAWjxB,YAAc0hB,EAAOviB,aAAa7J,aAAamI,KACjE61C,EAAQjzD,KAAK2f,Yfj8CZ,SAAwBszG,GAC7B,OAAQA,GACN,KA1O0B,EA2OxB,OAAOp2G,GAAUA,GACnB,KA3O2B,EA4OzB,OAAOA,GAAUA,GACnB,QACE,OAAOA,GLtKkB,gBKwK/B,Cew7CiCq1B,CAAwBzoB,EAAIzpB,MACvD84B,EAAKo6F,gBAAgBtP,GAErBzuG,GAAI1K,KAAKg9B,EAAK,cAAc,WAC1B3O,EAAKooF,iBAAmBz3F,EAAI7M,KAC5Bkc,EAAKqoF,iBACP,IAEA,IA4BIgS,EA5BEC,EAAa,SAAClnH,GAClBA,EAAE2a,kBACFiS,EAAKs6F,WAAW3rF,EAAK8gC,EACvB,EAEM8qD,EAAiB,SAACnnH,GACtBA,EAAE2a,kBACFiS,EAAKu6F,eAAe5pG,EACtB,EAEK8+C,GAKCr2B,GAAwBzoB,KAC1BtU,GAAIyE,KAAKq5C,EAAQqgE,YACjB7oH,GAAKwoD,EAAQqgE,WAAY,SAAS,SAACpnH,GAAeknH,EAAWlnH,EAAG,KAGlEzB,GAAKwoD,EAAQsgE,eAAgB,SAAS,SAACrnH,GAAemnH,EAAennH,EAAG,IACpEqf,KAAMioG,mBAAmB/pG,IAC3BtU,GAAIyE,KAAKq5C,EAAQsgE,gBAGnBtgE,EAAQ/mB,KAAKO,KAAO,SAAHpgC,OAAYk8D,GAC7Bh9C,KAAMg1E,uBAAuB94D,KAf7BtyB,GAAI2E,KAAKm5C,EAAQsgE,gBACjBp+G,GAAI2E,KAAKm5C,EAAQqgE,YACjBn+G,GAAI2E,KAAKm5C,EAAQ/mB,OAgBnB/2B,GAAI1K,KAAKgW,EAAKmyG,OAAQ,SAAS,WAC7B,GAAIz9G,GAAI82D,YAAYxrD,EAAKwyC,SAIvB,OAHA99C,GAAI2E,KAAK2G,EAAKwyC,SACd2/D,EAAOa,SAASx6G,UAAUC,IAAI,sBAC9B05G,EAAOa,SAASx6G,UAAUM,OAAO,eAGnCpE,GAAIyE,KAAK6G,EAAKwyC,SACd2/D,EAAOa,SAASx6G,UAAUM,OAAO,iBACjCq5G,EAAOa,SAASx6G,UAAUC,IAAI,eAC1Bi6G,GAAgBA,EAAe55G,QACrC,IAMApE,GAAI1K,KAAKgW,EAAKmyG,OAAQ,cAAc,WAElC,IAAIz9G,GAAI82D,YAAYxrD,EAAKwyC,SAAzB,CACIkgE,GAAgBA,EAAe55G,SAEnC,IAAMm6G,EAAUnoH,SAAS4P,cAAc,OACvCg4G,EAAiBO,EACjBnoH,SAASqC,KAAKgL,YAAY86G,GAC1BA,EAAQC,UAAY,yBACpB,IAAM3yG,EAAI7L,GAAIyC,cAAc6I,EAAKmyG,QAC3BzxG,EAAIH,EAAE7J,QAAU6J,EAAE1J,OACxBo8G,EAAQ74G,MAAMrE,IAAM,GAAHnK,OAAM8U,EAAI,EAAC,MAC5BuyG,EAAQ74G,MAAMxE,KAAO,GAAHhK,OAAM2U,EAAE5J,SAAQ,MAElC,IACMqS,EADOqP,EAAKkgF,WAAWzwC,GACZ9+C,IAEXmqG,EAAY,SAACC,EAAuBC,GACxC,IAAM3wD,EAAO0wD,EAAS9nG,WAAU,GAChC2nG,EAAQ96G,YAAYuqD,GACpBhuD,GAAIyE,KAAKupD,GACThuD,GAAI1K,KAAK04D,EAAM,SAAS,SAACj3D,GAAe4nH,EAAG5nH,EAAG,GAChD,EAEIgmC,GAAwBzoB,IAAMmqG,EAAU3gE,EAAQqgE,YAAY,SAACpnH,GAAeknH,EAAWlnH,EAAG,IAC1Fqf,KAAMioG,mBAAmB/pG,IAAMmqG,EAAU3gE,EAAQsgE,gBAAgB,SAACrnH,GAAemnH,EAAennH,EAAG,IACvGwnH,EAAQ96G,YAAYq6C,EAAQ/mB,KAAKngB,WAAU,IAE3C,IAAMgoG,EAAYtoG,EAAKuoG,cAAcn9G,UAE/Bo9G,EAAQ,SAARA,EAAS/nH,GAGb,IAAMgoH,EAASzoG,EAAKuoG,cAAcn9G,UAAYk9G,EAC9CL,EAAQ74G,MAAMrE,IAAM,GAAHnK,OAAM8U,EAAI+yG,EAAM,MAC7B/+G,GAAIk6C,eAAenjD,EAAGwnH,IAAYv+G,GAAIk6C,eAAenjD,EAAGu7B,KAC5DisF,EAAQn6G,SACR45G,EAAiB,KACjB5nH,SAASuK,oBAAoB,YAAam+G,GAC1CxoG,EAAKuoG,cAAcl+G,oBAAoB,SAAUm+G,GACnD,EACA1oH,SAASsK,iBAAiB,YAAao+G,GACvCxoG,EAAKuoG,cAAcn+G,iBAAiB,SAAUo+G,EAxCL,CAyC3C,IACA1oG,KAAM2oC,aAAazsB,EACrB,EArIA,IAAAy6B,EAAAr2D,MAAAo2D,EAAAC,EAAAp7D,KAAA9E,MAAAo3F,GAqIC,OAAAp6F,GAAAkjE,EAAAh2D,EAAAlN,EAAA,SAAAkjE,EAAA/1D,GAAA,CACDgJ,GAAIqf,OAAOm+F,EAAelnG,EAAK0oG,kBAC/B7zH,KAAK6gH,iBACP,GAEA,CAAAljH,IAAA,wBAAAE,MAIA,SAAuBsrB,EAAY6f,GAA4B,IAAAnY,EAC7D,GAAgB,QAAZA,EAAC1H,EAAI8G,eAAO,IAAAY,IAAXA,EAAattB,OAAQ,OAAOgZ,GAAUA,GAC3C,IAAIuU,EAAUjc,GAAIk2C,wBAAwBnZ,GAAsBzoB,GAAM6f,EAAIxqB,aAAcwqB,EAAIvqB,cAAeuqB,EAAI1c,IAAI0U,UAEnH,OADI7X,EAAI8G,QAAQ1sB,OAAS,IAAGutB,EAAU,KAAOA,GACtCA,CACT,GAEA,CAAAnzB,IAAA,kBAAAE,MAGA,SAAiBylH,GACf,IAAQgP,EAAyBhP,EAAzBgP,OAAQ3/D,EAAiB2wD,EAAjB3wD,QAASxpC,EAAQm6F,EAARn6F,IACrBA,EAAI5b,QftxDgB,GesxDoBqkC,GAA2BzoB,GAAMmpG,EAAOwB,YAAYn7G,UAAUC,IAAI,UACzG05G,EAAOwB,YAAYn7G,UAAUM,OAAO,UACzC05C,EAAQplD,OAAO8R,YAAcizG,EAAO/kH,OAAO8R,YAAcuyB,GAAuBzoB,GAChFwpC,EAAQ8zB,IAAIpnE,YAAcxK,GAAI2nE,UAAUrzD,EAAI62E,YAC5CrtC,EAAQriC,OAAOjR,YAAc,GAAHtT,QAAO6lC,GAAiBzoB,GAAOA,EAAIoH,IAAM,KAAK7K,QAAQ,GAAE,KAClFitC,EAAQjiC,QAAQrR,YAAc,GAAHtT,QAAO6lC,GAAkBzoB,GAAOA,EAAIoH,IAAM,KAAK7K,QAAQ,GAAE,IACtF,GAEA,CAAA/nB,IAAA,kBAAAE,MACA,WAME,IALA,IAAMi7B,EAAyC,CAC7CC,KAAM,GACNC,MAAO,IAEH+6F,EAAa/zH,KAAK+gC,OAAOK,qBAC/B3oB,EAAA,EAAAspD,EAAsB1kE,OAAO+C,OAAOJ,KAAK04G,YAAWjgG,EAAAspD,EAAAx+D,OAAAkV,IAAE,CAAjD,IAAQ0Q,EAAG44C,EAAAtpD,GAAH0Q,IACPA,EAAI7M,MftyDc,IesyDN6M,EAAI5b,SACd4b,EAAIsG,KACNqJ,EAAQE,MAAMh2B,KAAK,CACjBsZ,KAAM6M,EAAI7M,KAAOy3G,EACjB7jG,OAAQ/G,EAAI7M,OAAStc,KAAK4gH,mBAG5B9nF,EAAQC,KAAK/1B,KAAK,CAChBsZ,KAAM6M,EAAI7M,KAAOy3G,EACjB7jG,OAAQ/G,EAAI7M,OAAStc,KAAK4gH,mBAIlC,CACA5gH,KAAK05G,WAAWsa,WAAWl7F,GACvB94B,KAAKo5B,MAAMp5B,KAAK05G,WAAW/lF,MACjC,GAEA,CAAAh2B,IAAA,cAAAE,MAGA,WAGE,IAAMo2H,EAAcj0H,KAAKoxH,qBACzB8C,EAA8Gl0H,KAAK+gC,OAArEozF,EAAKD,EAA3C11G,aAAgB7J,aAAgBmI,KAAwDs3G,EAAKF,EAA5Cz1G,cAAiB9J,aAAgBmI,KAErF7R,SAAS0iG,MADTsmB,EACiB,GAAHloH,OAAM8I,GAAIkc,gBAAgBkjG,GAAY,OAAAloH,OAAMooH,GAAKpoH,OAAGqoH,EAAK,OAAAroH,OAAM/L,KAAKi5G,SADpD,GAAHltG,OAAMooH,GAAKpoH,OAAGqoH,EAAK,OAAAroH,OAAM/L,KAAKi5G,QAEhE,GAEA,CAAAt7G,IAAA,kBAAAE,MAIA,SAAiBuyD,GACfnlC,KAAMuoB,IAAI,OAAQ,mBAAoB4c,GACtC,IAAMukD,EAAUvkD,EAAK6kC,QACrBo/B,EAAmDr0H,KAAK+gC,OAAvC3mB,EAACi6G,EAAVpP,QAAsBiI,EAACmH,EAAXlP,SAAoB79E,EAAI+sF,EAAXnkF,IAAO5I,KACpCqtE,EAAQnjF,OAASpX,EAAEnF,IAAM0/F,EAAQn6D,QAAU0yE,EAAEj4G,IAAMm7C,EAAK9oB,OAASA,IACrEtnC,KAAKs0H,WAAW3f,GAChB30G,KAAK+gC,OAAO4qF,YAAa,EACzB3rH,KAAKqsH,cACLrsH,KAAKq9G,4BACP,GAEA,CAAA1/G,IAAA,uBAAAE,MACA,SAAsBqQ,GAEpB,GADA+c,KAAMuoB,IAAI,OAAQ,wBAAyBtlC,GACvCA,EAAKo5B,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,MAAQp5B,EAAKo9G,WAAatrH,KAAK+gC,OAAOwqF,IAAxE,CACA,IAAMv7F,EAAQ9hB,EAAK+mF,QACfjlE,EAAM1T,KAAO,GAAGtc,KAAKo5B,KAAKxgB,IAAIoX,GAClChwB,KAAK8wH,cAAc9gG,GACnBhwB,KAAKqsH,cACLrsH,KAAK05G,WAAW/lF,MALmE,CAMrF,GAEA,CAAAh2B,IAAA,yBAAAE,MACA,SAAwBqQ,GAEtB,GADA+c,KAAMuoB,IAAI,OAAQ,0BAA2BtlC,GACzCA,EAAKo5B,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,MAAQp5B,EAAKo9G,WAAatrH,KAAK+gC,OAAOwqF,IAAxE,CACA,IAAMv7F,EAAQ9hB,EAAK+mF,QACnBj1F,KAAKo5B,KAAKngB,OAAO+W,EAAMgc,OACvBhsC,KAAKu0H,iBAAiBvkG,GACtBhwB,KAAKqsH,cACLrsH,KAAK05G,WAAW/lF,MALmE,CAMrF,GAEA,CAAAh2B,IAAA,6BAAAE,MAIA,SAA4BqQ,GAE1B,GADA+c,KAAMuoB,IAAI,OAAQ,8BAA+BtlC,GAC7CA,EAAKo5B,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,MAAQp5B,EAAKo9G,WAAatrH,KAAK+gC,OAAOwqF,IAAxE,CACA,IAAMhrE,EAASryC,EAAK+mF,QACpBj1F,KAAKo5B,KAAKo7F,gBAAgBj0E,EAAOvU,MAAOuU,EAAOhwB,IAAKgwB,EAAOq0D,WAC3D50G,KAAKy0H,iBAAiBl0E,GACtBvgD,KAAK05G,WAAW/lF,MAJmE,CAKrF,GAEA,CAAAh2B,IAAA,wBAAAE,MACA,SAAuBqQ,GAErB,GADA+c,KAAMuoB,IAAI,OAAQ,yBAA0BtlC,GACxCA,EAAKo5B,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,MAAQp5B,EAAKo9G,WAAatrH,KAAK+gC,OAAOwqF,IAAxE,CACA,IAAMv7F,EAAQ9hB,EAAK+mF,QACfjlE,EAAMihG,QAAU,GAAGjxH,KAAKo5B,KAAKxgB,IAAIoX,GACjCA,EAAM4kF,UAAY,GAAG50G,KAAK8wH,cAAc9gG,GAC5ChwB,KAAK05G,WAAW/lF,MAJmE,CAKrF,GAEA,CAAAh2B,IAAA,qBAAAE,MACA,SAAoBqQ,GAMlB,GALIlO,KAAK00H,iBACPh1F,aAAa1/B,KAAK00H,eAAeC,OACjC30H,KAAK00H,eAAep2E,SACpBt+C,KAAK00H,eAAiB,MAEpBxmH,EAAKo5B,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,MAAQp5B,EAAKo9G,WAAatrH,KAAK+gC,OAAOzU,IAAIvoB,KAA5E,CACA,IAAM6c,EAAM1S,EAAK+mF,QAAQr0E,IACzB5gB,KAAK+gC,OAAO0kF,aAAa7kG,GAAO1S,EAAK+mF,QACrCj1F,KAAK40H,aACD50H,KAAKm6G,YAAcv5F,IACnB5gB,KAAKqjH,kBAAkBxjF,SAAS7/B,KAAKqjH,kBAAkBxjF,QAAQ76B,OACnEhF,KAAK85G,YAAY5mF,OAAOva,UAAUM,OAAO,aACzCjZ,KAAK85G,YAAY+a,WAAW3mH,EAAK+mF,QAASj1F,KAAK+gC,OAAOzU,IAAKtsB,KAAK+gC,OAAOviB,aAAcxe,KAAK+gC,OAAOtiB,eAPT,CAQ1F,GAAC,CAAA9gB,IAAA,0BAAAE,MAED,SAAyBqQ,GACvBlO,KAAK80H,iBAAiB5mH,EAAK+mF,QAAQ8/B,gBACnC/0H,KAAKy/G,2BACP,GAEA,CAAA9hH,IAAA,0BAAAE,MACA,SAAyBqQ,GACvB,GAAIA,EAAKo5B,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,KAAlC,CACA,IAAA0tF,EAAwB9mH,EAAK+mF,QAArBr0E,EAAGo0G,EAAHp0G,IAAK+sG,EAAMqH,EAANrH,OACPnnD,EAAQxmE,KAAK+gC,OAAO0kF,aAAa7kG,GACvC,GAAK4lD,EAAL,CACA,IAAM3mC,EAAU2mC,EAAM3mC,QACC,IAAnBA,EAAQt8B,OAAcs8B,EAAQ78B,KAAK2qH,GAExB9tF,EAAQA,EAAQt8B,OAAS,GAC7B0xH,aAAetH,EAAOsH,WAAYp1F,EAAQA,EAAQt8B,OAAS,GAAKoqH,EACpE9tF,EAAQ78B,KAAK2qH,GAEhB3tH,KAAKm6G,YAAcv5F,GACvB5gB,KAAK85G,YAAYnmF,MATC,CAH4B,CAahD,GAEA,CAAAh2B,IAAA,yBAAAE,MAIA,SAAwBohB,GACtB,IAAMkM,EAAOnrB,KAAKmrB,KAClBnrB,KAAKk1H,UAAYj2G,EACjBpK,GAAI2E,KAAK2R,EAAKogE,sBAAuBpgE,EAAKqgE,oBAAqBrgE,EAAKsgE,kBACpE52E,GAAIyE,KAAK6R,EAAKugE,mBAAoBvgE,EAAKwgE,iBACvC3rF,KAAKi9C,MAAM3jC,KAAK6R,EAAK+2D,0BACvB,GAEA,CAAAvkF,IAAA,qBAAAE,OAAA69E,EAAAjzE,EAAAzL,IAAAA,MAGA,SAAA+qE,IAAA,IAAA58C,EAAAyxB,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAgrE,GAAA,cAAAA,EAAAnjE,KAAAmjE,EAAA1lE,MAAA,OAU8D,OATtD6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKogE,uBAGR3uC,EAAM,CACV7+B,QAAS/d,KAAKk1H,UAAUjgH,GACxBgX,SAAS,GAGLqyB,EAASrzB,KAAMuzB,QAAQrzB,EAAK+2D,2BAA0Bla,EAAA1lE,KAAA,EAC1CuL,EAPN,0BAOoB+uC,GAAI,OAC5B,GADFxzC,EAAG4+D,EAAAlmE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF4+D,EAAA1lE,KAAA,SAES,OADpC6oB,EAAKogE,sBAAsBlsE,YAAcjW,EAAIwE,IAC7CiH,GAAIyE,KAAK6R,EAAKogE,uBAAsBvjB,EAAA/lE,OAAA,kBAItC4S,GAAI2E,KAAKxZ,KAAKmrB,KAAK8xB,OACnBj9C,KAAK26G,WAAWwa,YAAYn1H,KAAKk1H,UAAUjgH,IAAG,yBAAA+yD,EAAAhjE,OAAA,GAAA+iE,EAAA,UAC/C,kBAAA2T,EAAA9yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,MAGA,WACEmC,KAAK44G,cAAgB,CAAC,EACtB,IA6BqEr0C,EA7B/Dp5C,EAAOnrB,KAAKmrB,KACZ6E,EAAQhwB,KAAKqkH,aAAerkH,KAAKskH,aACjCnH,EAASntF,EAAMP,KACfm4F,EAAY38F,KAAMoW,OAAOrR,EAAMwB,MAC/Bu2F,EAAa98F,KAAMoW,OAAOrR,EAAMwqB,OAChC46E,EAAUjY,EAAS4K,EAAaH,EAChCiI,EAAY1S,EAASyK,EAAYG,EAEjCsN,EAAU,SAACxyD,GACf,OAAQA,EAAKtkD,QAAQskD,MACnB,IAAK,OACH,GAAIgtD,EAAU7jF,MAAO,CACnB,IAAMylB,EAAcxmC,KAAMoW,OAAOwuF,EAAU7jF,MAAMC,UACjD42B,EAAKpjD,IAAM5K,GAAImK,SAASyyC,EAAY9yC,OACtC,MACEkkD,EAAKpjD,IAAM5K,GAAImK,SAAS6wG,EAAUlxG,QAEpC,MACF,IAAK,KACH,GAAIy2G,EAAQppF,MAAO,CACjB,IAAMylB,EAAcxmC,KAAMoW,OAAO+zF,EAAQppF,MAAMC,UAC/C42B,EAAKpjD,IAAM5K,GAAImK,SAASyyC,EAAY9yC,OACtC,MACEkkD,EAAKpjD,IAAM5K,GAAImK,SAASo2G,EAAQz2G,QAGxC,EAEA8lD,EAAAp5D,GACmBwJ,GAAImG,cAAcmQ,EAAK+tF,YAAa,gBAAc,IAArE,IAAAz0C,EAAAl5D,MAAAg5D,EAAAE,EAAAj+D,KAAA9E,MACE2zH,EADa9wD,EAAA1mE,MAIf,OAAAa,GAAA+lE,EAAA74D,EAAAlN,EAAA,SAAA+lE,EAAA54D,GAAA,KACqE6+D,EADrEC,EAAAt/D,GACmBwJ,GAAImG,cAAcmQ,EAAKmqG,YAAa,gBAAc,IAArE,IAAA3qD,EAAAp/D,MAAAm/D,EAAAC,EAAAnkE,KAAA9E,MACE2zH,EADa3qD,EAAA7sE,MAEd,OAAAa,GAAAisE,EAAA/+D,EAAAlN,EAAA,SAAAisE,EAAA9+D,GAAA,CAEDgJ,GAAI2E,KAAK2R,EAAKoqG,cACd1gH,GAAIyE,KAAK6R,EAAKqqG,WAEdrqG,EAAKsqG,SAASp2G,YAAuB9C,GAAT4gG,EpBv9DN,UACD,UoBu9DrB,IAAMuY,EAAsBn5G,GAAT4gG,EAAmB5gG,EAA0BA,GAGhE,GAFA4O,EAAKwqG,YAAYt2G,YAAcq2G,EAC/BvqG,EAAKyqG,WAAWv2G,YAAc2Q,EAAMsX,KAChCtX,EAAMo0F,QAAS,CACjBvvG,GAAIyE,KAAK6R,EAAK0qG,aACdhhH,GAAI2E,KAAK2R,EAAK2qG,cACd,IAAMC,EAAY,SAAHhqH,OAAY2pH,EAAU,UACrCvqG,EAAK6qG,WAAW32G,YAAc2Q,EAAMq+F,OAAS0H,EAAY,eAAiBA,EAC1E5qG,EAAK8qG,MAAM52G,YAAcxK,GAAIkc,gBAAgBf,EAAM1T,KAAOtc,KAAK+gC,OAAOK,sBACtEjW,EAAK+qG,KAAK72G,YAAcxK,GAAIkc,gBAAgBf,EAAMO,IAAKq3F,EAAUlzG,UACjE,IAAMu7B,EAAQjgB,EAAM1T,KAAOs1B,GAA+B5hB,EAAMO,IAChEpF,EAAKgrG,OAAO92G,YAAcxK,GAAIkc,gBAAgBkf,EAAO83E,EAAWrzG,UAEhE1U,KAAK4kF,cAAcmjC,EAAW9yG,GAAIg7B,EAAO9kB,EAAKirG,WAChD,KAAO,CACLvhH,GAAI2E,KAAK2R,EAAK0qG,aACdhhH,GAAIyE,KAAK6R,EAAK2qG,cACd3qG,EAAK6qG,WAAW32G,YAAc,UAAHtT,OAAa2pH,EAAU,UAClD,IAAMj5G,EAAKuT,EAAMP,KAAOzvB,KAAK+gC,OAAOviB,aAAexe,KAAK+gC,OAAOtiB,cAC/D0M,EAAKkrG,YAAYh3G,YAAcxK,GAAIkc,gBAAgBf,EAAMO,IAAK9T,GAC9D0O,EAAKmrG,YAAYj3G,YAAcwwG,EAAUlxG,OAAOW,cAEhDtf,KAAK4kF,cAAcirC,EAAU56G,GAAI+a,EAAMO,IAAKpF,EAAKorG,iBACjD,IAAM18F,EAAM75B,KAAK85B,SACjB,GAAID,EAAK,CACPhlB,GAAIyE,KAAK6R,EAAKqrG,iBACd,IAAMC,EAAWzmG,EAAMP,KAAOO,EAAMO,IAAMsJ,EAAM7J,EAAMO,IAAMsJ,EAC5D1O,EAAKurG,UAAUr3G,YAAcxK,GAAIkc,gBAAgB0lG,EAAUrB,EAAQ1gH,UACnEyW,EAAKwrG,UAAUt3G,YAAc+1G,EAAQz2G,OAAOW,cAE5Ctf,KAAK4kF,cAAcwwC,EAAQngH,GAAIwhH,EAAUtrG,EAAKyrG,YAChD,MACE/hH,GAAI2E,KAAK2R,EAAKqrG,gBAElB,CAEIrZ,GACFhyF,EAAK0rG,QAAQl+G,UAAUC,IAAIu+F,IAC3BhsF,EAAK0rG,QAAQl+G,UAAUM,OAAOi+F,IAC9B/rF,EAAK0zF,QAAQlmG,UAAUC,IAAIu+F,IAC3BhsF,EAAK0zF,QAAQlmG,UAAUM,OAAOi+F,MAE9B/rF,EAAK0rG,QAAQl+G,UAAUC,IAAIs+F,IAC3B/rF,EAAK0rG,QAAQl+G,UAAUM,OAAOk+F,IAC9BhsF,EAAK0zF,QAAQlmG,UAAUC,IAAIs+F,IAC3B/rF,EAAK0zF,QAAQlmG,UAAUM,OAAOk+F,KAEhCn3G,KAAKm5G,iBAEDyO,EAAUxiG,OAAOQ,MAAQmiG,EAAW3iG,OAAOQ,KAAM5lB,KAAK82H,SAAS9mG,IAEjEnb,GAAI2E,KAAK2R,EAAKqqG,WACdx1H,KAAK+2H,4BAET,GAEA,CAAAp5H,IAAA,gBAAAE,MACA,SAAekgB,EAAiBwS,EAAanO,GAC3C,GAAIA,EAAS,CACX,IAAM9F,EAAO2O,KAAMymB,aAAa3zB,GAChCqE,EAAQ/C,YAAcxK,GAAIyN,qBAAqBiO,EAAKjU,EAAM2O,KAAMvW,SAASqJ,IACrEzB,EAAMzH,GAAIyE,KAAK8I,EAAQG,eACtB1N,GAAI2E,KAAK4I,EAAQG,cACxB,CACF,GAEA,CAAA5kB,IAAA,iBAAAE,OAAAq6G,EAAAzvG,EAAAzL,IAAAA,MACA,SAAA0rE,IAAA,IAAAv9C,EAAA,OAAAnuB,IAAAA,MAAA,SAAA2rE,GAAA,cAAAA,EAAA9jE,KAAA8jE,EAAArmE,MAAA,OACQ6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK6rG,MACdh3H,KAAKi9C,MAAM3jC,KAAK6R,EAAKyzF,YAAW,wBAAAj2C,EAAA3jE,OAAA,GAAA0jE,EAAA,UACjC,kBAAAwvC,EAAAtvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,4BAAAE,OAAAo6G,EAAAxvG,EAAAzL,IAAAA,MAIA,SAAA6rE,IAAA,IAAA19C,EAAAmzB,EAAA,OAAAthD,IAAAA,MAAA,SAAAisE,GAAA,cAAAA,EAAApkE,KAAAokE,EAAA3mE,MAAA,OAE+C,OADvC6oB,EAAOnrB,KAAKmrB,KACZmzB,EAASrzB,KAAMuzB,QAAQrzB,EAAKyzF,YAAW31C,EAAA3mE,KAAA,EACvCtC,KAAKi3H,sBAAqB,OAChC34E,IACAzpC,GAAIyE,KAAK6R,EAAKqqG,WACdx1H,KAAK82H,SAAS92H,KAAKskH,cAAa,wBAAAr7C,EAAAjkE,OAAA,GAAA6jE,EAAA,UACjC,kBAAAovC,EAAArvG,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,OAAAm6G,EAAAvvG,EAAAzL,IAAAA,MAED,SAAA4sE,EAAoB7rD,GAAe,IAAA3U,EAAA,OAAApM,IAAAA,MAAA,SAAA6sE,GAAA,cAAAA,EAAAhlE,KAAAglE,EAAAvnE,MAAA,cAAAunE,EAAAvnE,KAAA,EACfuL,EAAS,kBAAmB,CAAEkQ,QAAAA,IAAU,OAAjD,GAAH3U,EAAGygE,EAAA/nE,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFygE,EAAAvnE,KAAA,cACrBd,MAAM,0BAA4B4H,EAAIwE,KAAI,OAElD5N,KAAK26G,WAAWwa,YAAYp3G,GAAQ,wBAAA8rD,EAAA7kE,OAAA,GAAA4kE,EAAA,UACrC,SAAAv7D,GAAA,OAAA2pG,EAAApvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,sBAAAE,OAAAk6G,EAAAtvG,EAAAzL,IAAAA,MAIA,SAAA6uE,IAAA,IAAAqrD,EAAA1lG,EAAAgpB,EAAA2N,EAAApvC,EAAAyvC,EAAAzqC,EAAA,OAAA/gB,IAAAA,MAAA,SAAA8uE,GAAA,cAAAA,EAAAjnE,KAAAinE,EAAAxpE,MAAA,OAKE,IALF40H,EAC0Bl3H,KAAK+gC,OAArBvP,EAAI0lG,EAAJ1lG,KAAMgpB,EAAK08E,EAAL18E,MACR2N,EAAW,GACZ32B,EAAKpM,OAAOQ,MAAMuiC,EAASnlD,KAAKwuB,EAAKvc,IACrCulC,EAAMp1B,OAAOQ,MAAMuiC,EAASnlD,KAAKw3C,EAAMvlC,IAC5C8D,EAAA,EAAAyvC,EAAsBL,EAAQpvC,EAAAyvC,EAAAjlD,OAAAwV,IAAnBgF,EAAOyqC,EAAAzvC,GAChB/Y,KAAKi7G,aAAal9F,GACnB,wBAAA+tD,EAAA9mE,OAAA,GAAA6mE,EAAA,UACF,kBAAAksC,EAAAnvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,OAAAi6G,EAAArvG,EAAAzL,IAAAA,MACA,SAAA+uE,EAAqB/7C,GAAgB,IAAA7E,EAAAgsG,EAAAC,EAAA94E,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAivE,GAAA,cAAAA,EAAApnE,KAAAonE,EAAA3pE,MAAA,OAGQ,GAFrC6oB,EAAOnrB,KAAKmrB,KACZgsG,EAAW9qH,KAAKC,UAAU0jB,EAAMu+F,WAChC6I,EAASp3H,KAAK44G,cAAcue,IACtB,CAAFlrD,EAAA3pE,KAAA,eAAA2pE,EAAAhqE,OAAA,SAASm1H,GAAM,OAGoB,OAD7CviH,GAAI2E,KAAK2R,EAAKoqG,cACRj3E,EAASrzB,KAAMuzB,QAAQrzB,EAAKyzF,YAAW3yC,EAAA3pE,KAAA,EAC3BuL,EAAS,gBAAiBwpH,GAAUrnG,IAAO,OACrD,GADF5mB,EAAG6iE,EAAAnqE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF6iE,EAAA3pE,KAAA,gBAAA2pE,EAAAhqE,OAAA,SAAS,CAAEvD,IAAK0K,EAAIwE,MAAK,QACX,OAA3C5N,KAAK44G,cAAcue,GAAY/tH,EAAIkuH,SAAQrrD,EAAAhqE,OAAA,SACpCmH,EAAIkuH,UAAQ,yBAAArrD,EAAAjnE,OAAA,GAAA+mE,EAAA,UACpB,SAAAroD,GAAA,OAAAo0F,EAAAlvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,iBAAAE,MAIA,SAAgB+P,GACd,IAAMud,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKqqG,WACd3gH,GAAIyE,KAAK6R,EAAKoqG,cACdpqG,EAAKosG,gBAAgBh5G,QAAQ4G,QAAUvX,CACzC,GAAC,CAAAjQ,IAAA,8BAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKqsG,qBACd3iH,GAAIyE,KAAK6R,EAAKssG,oBAAqBtsG,EAAKusG,gBAC1C,GAAC,CAAA/5H,IAAA,8BAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKssG,oBAAqBtsG,EAAKusG,iBACxC7iH,GAAIyE,KAAK6R,EAAKqsG,oBAChB,GAAC,CAAA75H,IAAA,kBAAAE,MAED,SAAiBmyB,EAAkB88B,EAAeC,EAAmB5lC,GACnE,IAAMgE,EAAOnrB,KAAKmrB,KAClBtW,GAAImD,MAAMmT,EAAKwsG,kBAAmBxsG,EAAKusG,iBACvC,IAKoC7sD,EAL9B+sD,EAAY,SAACtsG,EAAkBusG,GACnC,IAAM7iH,Ef98DL,SAAwBsW,EAAkB0E,EAAkB8nG,EAAoBD,GACrF,IAeuBvwF,EAAcvpB,EAf/Bg6G,EAAeF,GAAU7nG,EAAMP,OAAWooG,IAAW7nG,EAAMP,KAC3D9Q,GAciB2oB,EAdqBtX,EAAMsX,KAcbvpB,EAdtBg6G,EAAyC/nG,EAAMwB,KAAmCxB,EAAMwqB,MAehGvvB,KAAMuc,UAAUF,GAAMjG,OAAOtjB,GAASY,QAb7C,QAAQ,GACN,MAAO2M,EAAG,QACR,OAAO,IAAIY,GAAcZ,EAAK3M,EAAQqR,EAAMu+F,QAASuJ,GAAQtsG,KAC/D,MAAOF,EAAIwB,QACT,OAAO,IAAIH,GAAcrB,EAAK3M,EAAQqR,EAAMu+F,QAASuJ,GAAQtsG,KAC/D,QACE7Q,QAAQvZ,MAAM,2BAA4BkqB,GAG9C,OADA3Q,QAAQvZ,MAAM,sBAAuBkqB,GAC9BrgB,SAAS4P,cAAc,MAChC,Ceg8DiB+2B,CAAwBtmB,EAAK0E,EAAO7I,EAAS0wG,GACpDvsG,EAAI0sG,cAAe7sG,EAAKwsG,kBAAkBr/G,YAAYtD,GACrDmW,EAAKusG,gBAAgBp/G,YAAYtD,EACxC,EAAC81D,EAAAz/D,GACiByhD,EAAKyhE,SAAW,IAAE,IAApC,IAAAzjD,EAAAv/D,MAAAs/D,EAAAC,EAAAtkE,KAAA9E,MAAsCk2H,EAAxB/sD,EAAAhtE,OAAuC,EAAK,OAAAa,GAAAosE,EAAAl/D,EAAAlN,EAAA,SAAAosE,EAAAj/D,GAAA,KACpB4/D,EADoBC,EAAArgE,GACxC0hD,EAAOwhE,SAAW,IAAE,IAAtC,IAAA7iD,EAAAngE,MAAAkgE,EAAAC,EAAAllE,KAAA9E,MAAwCk2H,EAA1BnsD,EAAA5tE,OAAyC,EAAM,OAAAa,GAAAgtE,EAAA9/D,EAAAlN,EAAA,SAAAgtE,EAAA7/D,GAAA,CAC7Dof,KAAM2oC,aAAazoC,EAAKwsG,mBACxB1sG,KAAM2oC,aAAazoC,EAAKusG,gBAC1B,GAEA,CAAA/5H,IAAA,WAAAE,OAAAg6G,EAAApvG,EAAAzL,IAAAA,MACA,SAAA0wE,EAAgB19C,GAAgB,IAAA7E,EAAA8sG,EAAAh+F,EAAA,YAAAj9B,IAAAA,MAAA,SAAA2wE,GAAA,cAAAA,EAAA9oE,KAAA8oE,EAAArrE,MAAA,OACxB6oB,EAAOnrB,KAAKmrB,KAGZ8sG,EAAe,eAAA74E,EAAA32C,EAAAzL,IAAAA,MAAG,SAAA+vE,IAAA,IAAA3jE,EAAA8uH,EAAAprE,EAAAC,EAAA5lC,EAAA,OAAAnqB,IAAAA,MAAA,SAAAgwE,GAAA,cAAAA,EAAAnoE,KAAAmoE,EAAA1qE,MAAA,cAAA0qE,EAAA1qE,KAAA,EACS23B,EAAKk+F,cAAcnoG,GAAM,OAAlC,KAAhB5mB,EAAgB4jE,EAAAlrE,MACdpD,IAAK,CAAFsuE,EAAA1qE,KAAA,eAAA0qE,EAAA/qE,OAAA,SAASg4B,EAAKm+F,eAAehvH,EAAI1K,MAAI,OAC1Cw5H,EAAO9uH,EACbyL,GAAI2E,KAAK2R,EAAKoqG,cACd1gH,GAAIyE,KAAK6R,EAAKqqG,WACN1oE,EAAiBorE,EAAjBprE,KAAMC,EAAWmrE,EAAXnrE,OACdD,EAAKyhE,QAAUzhE,EAAKyhE,SAAW,GAC/BxhE,EAAOwhE,QAAUxhE,EAAOwhE,SAAW,GACnCt0F,EAAKo+F,gBAAgBvrE,EAAMC,EAAQ/8B,GAE7B7I,EAAO,eAAAmxG,EAAA7vH,EAAAzL,IAAAA,MAAG,SAAA6vE,IAAA,OAAA7vE,IAAAA,MAAA,SAAA8vE,GAAA,cAAAA,EAAAjoE,KAAAioE,EAAAxqE,MAAA,cAAAwqE,EAAAxqE,KAAA,EACR21H,IAAiB,OACvBpjH,GAAIyF,QAAQ,KAAK,SAAA60C,GACfhkC,EAAKmqG,YAAY/6G,MAAMgrB,gBAAkB,uBAAHx5B,OAA0B,GAAM,GAAMojD,EAAQ,IACtF,IAAE,wBAAA2d,EAAA9nE,OAAA,GAAA6nE,EAAA,KACH,kBALY,OAAAyrD,EAAA1vH,MAAA,KAAAD,UAAA,KAObkM,GAAI1K,KAAKghB,EAAKqsG,oBAAqB,SAAS,WAAQv9F,EAAKs+F,6BAA8B,IACvF1jH,GAAI1K,KAAKghB,EAAKssG,oBAAqB,SAAS,WAAQx9F,EAAKu+F,6BAA8B,IACvFv+F,EAAKw+F,gBAAgBzoG,EAAO88B,EAAMC,EAAQ5lC,GAAQ,yBAAA6lD,EAAAhoE,OAAA,GAAA+nE,EAAA,KACnD,kBArBoB,OAAA3tB,EAAAx2C,MAAA,KAAAD,UAAA,KAuBrBsvH,IAAiB,wBAAAtqD,EAAA3oE,OAAA,GAAA0oE,EAAA,UAClB,SAAAjnD,GAAA,OAAAoxF,EAAAjvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,kBAAAE,MACA,SAAiBivD,EAAeC,EAAmB/8B,GACjD,IAAQ7E,EAAiBnrB,KAAjBmrB,KAAM4V,EAAW/gC,KAAX+gC,OACd,GAAK+rB,EAAKwqE,UAAavqE,EAAOuqE,SAA9B,CAIAziH,GAAIyE,KAAK6R,EAAKutG,oBACd,IAAQl6G,EAAsDuiB,EAAtDviB,aAAcC,EAAwCsiB,EAAxCtiB,cAAe2iB,EAAyBL,EAAzBK,qBAC/Bu3F,EAAS,SAAC96H,GACd,OAAIA,EAAQ,IAAa,QAClBw5G,GAAiBh8F,OAAOxd,EACjC,EAOI+6H,EAAmB,EACnBC,EAAoB,EACpBC,EAAiBt6G,EACjBu6G,EAAkBt6G,EAEtB,GAAIsiB,EAAOvP,KAAKwa,MAAO,CACrB,IAAM70B,EAAS8T,KAAMoW,OAAON,EAAOvP,KAAKwa,MAAMC,UAC9C6sF,EAAiB3hH,EAAOzC,SACxB,IAAMskH,EAAgB/tG,KAAMymB,aAAa3Q,EAAOvP,KAAKvc,IAC/CgkH,EAAiBhuG,KAAMymB,aAAav6B,EAAOlC,IAG/C2jH,EAFEI,GAAiBC,EACMA,EAAiBD,EACJx6G,EAAa7J,aAAaC,iBAAmBuC,EAAOzC,SAASC,aAAaC,iBAE7F,CAEvB,CAEA,GAAImsB,EAAOyZ,MAAMxO,MAAO,CACtB,IAAM70B,EAAS8T,KAAMoW,OAAON,EAAOyZ,MAAMxO,MAAMC,UAC/C8sF,EAAkB5hH,EAAOzC,SACzB,IAAMskH,EAAgB/tG,KAAMymB,aAAa3Q,EAAOyZ,MAAMvlC,IAChDgkH,EAAiBhuG,KAAMymB,aAAav6B,EAAOlC,IAG/C4jH,EAFEG,GAAiBC,EACMA,EAAiBD,EACHv6G,EAAc9J,aAAaC,iBAAmBuC,EAAOzC,SAASC,aAAaC,iBAE9F,CAExB,CAEA,IAAKskH,EAAiCJ,EAAnBK,EAAmCJ,EACjDK,EAAqCR,EAArBS,EAAuCR,EAC5D,GAAI74H,KAAKqkH,aAAa50F,KAAM,KAAA6pG,EACO,CAACJ,EAAcC,GAA/CA,EAAcG,EAAA,GAAEJ,EAAYI,EAAA,OAAAltC,EACQ,CAACgtC,EAAgBC,GAArDA,EAAgBjtC,EAAA,GAAEgtC,EAAchtC,EAAA,EACnC,CAEA,IAAMmtC,EAAUzsE,EAAKwqE,SAASz5H,OAAS,EACjC27H,EAAuBH,EAAmB,EAAIE,EAAUF,EAAmBE,EAG3EE,EAAc3sE,EAAKwqE,SAASoC,kBAAoBF,EAAuB,IAC7EruG,EAAKwuG,gBAAgBt6G,YAAcg6G,GAAoB,EAAI,GAAK,IAAHttH,OAAO4sH,EAAOc,GAAY,MACvFtuG,EAAKyuG,aAAav6G,YAAcxK,GAAIkc,gBAAgB+7B,EAAKwqE,SAASoC,kBAAmBP,GAErF,IAAMU,EAAe/sE,EAAKwqE,SAASwC,mBAAqBN,EAAuB,IAC/EruG,EAAK4uG,iBAAiB16G,YAAcg6G,GAAoB,EAAI,GAAK,IAAHttH,OAAO4sH,EAAOkB,GAAa,MACzF1uG,EAAK6uG,cAAc36G,YAAcxK,GAAIkc,gBAAgB+7B,EAAKwqE,SAASwC,mBAAoBX,GAEvF,IAAMc,EAAiBntE,EAAKwqE,SAAS4C,QAAUV,EAAuB,IACtEruG,EAAKgvG,gBAAgB96G,YAAcg6G,GAAoB,EAAI,GAAK,IAAHttH,OAAO4sH,EAAOsB,GAAe,MAC1F9uG,EAAKivG,aAAa/6G,YAAcxK,GAAIkc,gBAAgB+7B,EAAKwqE,SAAS4C,QAASf,GAG3E,IACMkB,EADSr6H,KAAK85B,UACM9J,EAAM1T,KAAO8kB,EACjCq1F,EAAWzmG,EAAMP,KAAO8pG,EAAUc,EAAUd,EAAUc,EACtDC,EAAwBlB,EAAiB,EAAI3C,EAAW2C,EAAiB3C,EAEzE8D,EAAgBxtE,EAAOuqE,SAASoC,kBAAoBY,EAAwB,IAClFnvG,EAAKqvG,kBAAkBn7G,YAAc+5G,GAAkB,EAAI,GAAK,IAAHrtH,OAAO4sH,EAAO4B,GAAc,MACzFpvG,EAAKsvG,eAAep7G,YAAcxK,GAAIkc,gBAAgBg8B,EAAOuqE,SAASoC,kBAAmBR,GAEzF,IAAMwB,EAAiB3tE,EAAOuqE,SAASwC,mBAAqBQ,EAAwB,IACpFnvG,EAAKwvG,mBAAmBt7G,YAAc+5G,GAAkB,EAAI,GAAK,IAAHrtH,OAAO4sH,EAAO+B,GAAe,MAC3FvvG,EAAKyvG,gBAAgBv7G,YAAcxK,GAAIkc,gBAAgBg8B,EAAOuqE,SAASwC,mBAAoBZ,GAEvFN,GAAoBC,GACtBhkH,GAAIyE,KAAK6R,EAAK0vG,gBACdhmH,GAAI2E,KAAK2R,EAAKmqG,aACdnqG,EAAK2vG,eAAez7G,YAAcs5G,EAAOc,EAAcc,GACvDpvG,EAAK4vG,gBAAgB17G,YAAcs5G,EAAOkB,EAAea,KAEzD7lH,GAAI2E,KAAK2R,EAAK0vG,gBACdhmH,GAAIyE,KAAK6R,EAAKmqG,aACdnqG,EAAK6vG,mBAAmB37G,YAAc8L,EAAKyuG,aAAav6G,YACxD8L,EAAK8vG,oBAAoB57G,YAAc8L,EAAK6uG,cAAc36G,YAC1D8L,EAAK+vG,qBAAqB77G,YAAc8L,EAAKsvG,eAAep7G,YAC5D8L,EAAKgwG,sBAAsB97G,YAAc8L,EAAKyvG,gBAAgBv7G,YA5FhE,MAFExK,GAAI2E,KAAK2R,EAAKutG,mBAgGlB,GAAC,CAAA/6H,IAAA,eAAAE,OAAA+5G,EAAAnvG,EAAAzL,IAAAA,MAED,SAAAgxE,IAAA,IAAA7iD,EAAAiwG,EAAAprG,EAAA4sB,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAixE,GAAA,cAAAA,EAAAppE,KAAAopE,EAAA3rE,MAAA,OASiD,OAPzC6oB,EAAOnrB,KAAKmrB,KACZiwG,EAAap7H,KAAKo7H,WAClBprG,EAAQorG,EAAWprG,MACnB4sB,EAAM,CACVqrB,QAASj4C,EAAM/a,IAGXqpC,EAASrzB,KAAMuzB,QAAQrzB,EAAK6zF,cAAa/wC,EAAA3rE,KAAA,EAC7BuL,EAAS,cAAe+uC,GAAI,OAE9C,GAFMxzC,EAAG6kE,EAAAnsE,KACTw8C,IAEKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF6kE,EAAA3rE,KAAA,SAEH,OADxB6oB,EAAKkwG,UAAUh8G,YAAcjW,EAAIwE,IACjCiH,GAAIyE,KAAK6R,EAAKkwG,WAAUptD,EAAAhsE,OAAA,kBAI1B4S,GAAI2E,KAAK4hH,EAAWprD,KAAM7kD,EAAK8xB,OAC/BjtB,EAAMK,YAAa,EAAI,yBAAA49C,EAAAjpE,OAAA,GAAAgpE,EAAA,UACxB,kBAAA4pC,EAAAhvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,MACA,SAAYypD,EAAkB2gB,GAC5B,IAAM9+C,EAAMnpB,KAAK04G,WAAWzwC,GAAS9+C,IAC/BgC,EAAOnrB,KAAKmrB,KACZy8B,EAAYz+B,EAAIoH,IAAMpH,EAAImH,OAC1BrR,EAAQ2yB,GAAsBzoB,GAAOnpB,KAAK+gC,OAAOyZ,MAAQx6C,KAAK+gC,OAAOvP,KAC3ErG,EAAKmwG,aAAaj8G,YAAcxK,GAAIkc,gBAAgB62B,EAAW3oC,EAAMvK,UACrEyW,EAAKowG,WAAWl8G,YAAcJ,EAAMN,OAAOW,cAC3CzK,GAAI2E,KAAK2R,EAAKkwG,WACdr7H,KAAKi9C,MAAM3jC,KAAK6R,EAAK4zF,YACrB/+G,KAAKo7H,WAAa,CAChBprD,KAAMn7D,GAAIi7C,YAAYxI,EAAK,cAC3Bt3B,MAAO7G,EAEX,GAEA,CAAAxrB,IAAA,iBAAAE,MACA,SAAgBmyB,GACd,IAAMsuB,EAASrzB,KAAMuzB,QAAQx+C,KAAKu4G,MAClCv4G,KAAKg6G,oBAAoB7uC,QAAQn7C,GACjCsuB,IACAt+C,KAAKi9C,MAAM3jC,KAAKtZ,KAAKmrB,KAAK8uF,eAC5B,GAEA,CAAAt8G,IAAA,aAAAE,MACA,SAAYohB,GACV,IAAMkM,EAAOnrB,KAAKmrB,KAClBnrB,KAAKw7H,cAAgBv8G,EACrBjf,KAAK+2E,cAAcS,SAASv4D,EAAMhK,IAClCjV,KAAKi9C,MAAM3jC,KAAK6R,EAAK4rD,cACvB,GAEA,CAAAp5E,IAAA,aAAAE,MAOA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACZ4V,EAAS/gC,KAAK+gC,OAEpB,GADAlsB,GAAI2E,KAAK2R,EAAKsjG,UACTzuH,KAAKy7H,cAAcz7H,KAAKskH,cAA7B,CACA,IAAMrvE,EAAahqB,KAAM8sB,UAAUhX,EAAOvP,KAAKvc,IACzC0gC,EAAc1qB,KAAM8sB,UAAUhX,EAAOyZ,MAAMvlC,IACjD,OAAKggC,EAKAU,OAKL31C,KAAK07H,cAJHvwG,EAAKsjG,SAASpvG,YAAc9C,GAAUA,EAAyB,CAAE0C,MAAO8hB,EAAOyZ,MAAM77B,cACrF9J,GAAIyE,KAAK6R,EAAKsjG,YANdtjG,EAAKsjG,SAASpvG,YAAc9C,GAAUA,EAAyB,CAAE0C,MAAO8hB,EAAOvP,KAAK7S,cACpF9J,GAAIyE,KAAK6R,EAAKsjG,UALkC,CAcpD,GAEA,CAAA9wH,IAAA,cAAAE,OAAAq8E,EAAAzxE,EAAAzL,IAAAA,MACA,SAAAsxE,EAAmBvwD,GAAe,OAAA/gB,IAAAA,MAAA,SAAAuxE,GAAA,cAAAA,EAAA1pE,KAAA0pE,EAAAjsE,MAAA,OAChCtC,KAAKukF,gBAAgB/M,SAASz5D,GAC9B/d,KAAKi9C,MAAM3jC,KAAKtZ,KAAKmrB,KAAKq5D,SAAQ,wBAAAjW,EAAAvpE,OAAA,GAAAspE,EAAA,UACnC,SAAA5kD,GAAA,OAAAwwD,EAAAtxE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,2BAAAE,MAED,SAA0BkgB,GACxBkN,KAAM2yB,SAAS,UAAW,CAAE+9E,eAAgB59G,EAASyxC,OAAQ,WAC/D,GAEA,CAAA7xD,IAAA,oBAAAE,MAGA,SAAmBuyD,GACZpwD,KAAK+gC,SACNqvB,EAAK9oB,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,MAAQ8oB,EAAKoyD,MAAMxiH,KAAK+gC,OAAOzU,IAAIvoB,OACnE/D,KAAK+rH,qBAEP/rH,KAAKwhH,WAAWoa,YAAYxrE,GAC9B,GAAC,CAAAzyD,IAAA,oBAAAE,OAAA85G,EAAAlvG,EAAAzL,IAAAA,MAED,SAAA8xE,EAAyB1e,GAAqB,IAAAyrE,EAAAC,EAAA,OAAA9+H,IAAAA,MAAA,SAAA+xE,GAAA,cAAAA,EAAAlqE,KAAAkqE,EAAAzsE,MAAA,UACvCtC,KAAK+gC,OAAQ,CAAFguC,EAAAzsE,KAAA,eAAAysE,EAAA9sE,OAAA,oBAEZmuD,EAAKhrC,OAAOrH,WAA4B,QAArB89G,EAAK77H,KAAK+gC,OAAOvP,YAAI,IAAAqqG,OAAA,EAAhBA,EAAkB5mH,KAAMm7C,EAAKhrC,OAAOrH,WAA6B,QAAtB+9G,EAAK97H,KAAK+gC,OAAOyZ,aAAK,IAAAshF,OAAA,EAAjBA,EAAmB7mH,IAAE,CAAA85D,EAAAzsE,KAAA,eAAAysE,EAAA9sE,OAAA,iBACjGjC,KAAKmsH,6BACLnsH,KAAK+iH,6BAA4B,wBAAAh0C,EAAA/pE,OAAA,GAAA8pE,EAAA,UAClC,SAAAnlD,GAAA,OAAAguF,EAAA/uG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,mBAAAE,OAAA65G,EAAAjvG,EAAAzL,IAAAA,MAIA,SAAAqzE,EAAwBjgB,GAAc,IAAA8L,EAAA,OAAAl/D,IAAAA,MAAA,SAAAszE,GAAA,cAAAA,EAAAzrE,KAAAyrE,EAAAhuE,MAAA,OACZ,GAAlB45D,EAAU9L,EAAKlgB,IAChBlwC,KAAK+gC,OAAQ,CAAFuvC,EAAAhuE,KAAA,eAAAguE,EAAAruE,OAAA,oBACZi6D,IAAYl8D,KAAK+gC,OAAOmP,IAAI5I,KAAI,CAAAgpC,EAAAhuE,KAAA,eAAAguE,EAAAruE,OAAA,oBAGjB,sBAAfmuD,EAAKqC,MAA6B,CAAA6d,EAAAhuE,KAAA,eAAAguE,EAAAhuE,KAAA,EAAQ2oB,KAAMqhD,YAAW,OAE/DtsE,KAAK+gC,OAAOmP,IAAMjlB,KAAMuc,UAAU00B,GAClCl8D,KAAKgkH,kCACLhkH,KAAK4iH,mBAAkB,yBAAAtyC,EAAAtrE,OAAA,GAAAqrE,EAAA,UACxB,SAAAzmD,GAAA,OAAA8tF,EAAA9uG,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,MAED,WACE,IAAQstB,EAAuGnrB,KAAvGmrB,KAAI4wG,EAAmG/7H,KAAjG+gC,OAAiBuG,EAAIy0F,EAAX7rF,IAAO5I,KAAa0B,EAAG+yF,EAARzvG,IAA+B9Q,EAAGugH,EAAxB9W,QAAWvwG,SAAuC+G,EAAGsgH,EAAzB5W,SAAYzwG,SACjF+yB,EAASxc,KAAMuc,UAAUF,GAAzBG,KAERtc,EAAK6wG,eAAe38G,YAAc/V,OAAO0/B,EAAIi3B,YAC7C90C,EAAK8wG,gBAAgB58G,YAAcxK,GAAIiJ,kBAAkBkrB,EAAIi3B,WAAaj3B,EAAIK,QAAU7tB,EAAI7G,aAAaC,kBACzGuW,EAAK+wG,oBAAoB78G,YAAc7D,EAAI7G,aAAamI,KACxDqO,EAAKgxG,qBAAqB98G,YAAc5D,EAAI9G,aAAamI,KACzD,IAAMgzG,EAAiB9vH,KAAK+vH,UAAU,GACtC,GAAID,EAAgB,CAClB,IAAM35E,EAAWnN,EAAIK,QAAUymF,EAC/B3kG,EAAKixG,iBAAiB/8G,YAAcxK,GAAIiJ,kBAAkBkrB,EAAIi3B,WAAa9pB,EAAW16B,EAAI9G,aAAaC,iBACzG,MAAOuW,EAAKixG,iBAAiB/8G,YAAc,IAE3C,IAAM67C,EAAOnzB,GAAWN,GACxBtc,EAAKowC,YAAYl8C,YAAc/V,OAAO4xD,GACtC,IAAAmhE,Eb3zEG,SAAwB/0F,GAM7B,IALA,IAAAg1F,EAAoCrxG,KAAMuc,UAAUF,GAA5CG,EAAI60F,EAAJ70F,KAAMC,EAAQ40F,EAAR50F,SAAUuO,EAAOqmF,EAAPrmF,QACTrO,EAAYH,EAAnBI,IAAOD,MACTszB,EAAOnzB,GAAWN,GAEpB80F,EAAc,EAClB10H,EAAA,EAAA8lC,EAAkBtwC,OAAO+C,OAAO61C,GAAQpuC,EAAA8lC,EAAApqC,OAAAsE,IAAE,CAArC,IAEkCiT,EAF5BkuB,EAAG2E,EAAA9lC,GACR20H,EAAY,EAACzhH,EAAA1P,GACE29B,EAAIyzF,UAAY,IAAE,IAArC,IAAA1hH,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAwC86H,GAAalzF,GAAvCxuB,EAAAjd,MAAyDmrC,EAAI,OAAAtqC,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,KACxC+T,EADwCC,EAAAxU,GACxD29B,EAAIqjB,QAAU,IAAE,IAAnC,IAAAxsC,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAsC86H,GAAalzF,GAArC1pB,EAAA/hB,MAAuDmrC,EAAI,OAAAtqC,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CACzE0wH,GAAgBC,GAAaxzF,EAAIi3B,WAAaj3B,EAAIK,QACpD,CAEA,MAAO,CAACkzF,EAxI4B,EAuIS/zF,GAAWZ,EAAOF,GAAYwzB,EAE7E,Ca6yEuCmhD,CAAc/0E,GAAKo1F,EAAA90H,EAAAy0H,EAAA,GAA/CE,EAAWG,EAAA,GAAEC,EAAWD,EAAA,GAC/BvxG,EAAKyxG,aAAav9G,aAAes9G,EAAc3zF,EAAIi3B,YAAYv6C,QAAQ,GACvEyF,EAAK0xG,WAAWx9G,YAAcs9G,EAAc,GAAKJ,EAAcI,EAAc,KAAKj3G,QAAQ,GAAK,IAE/FyF,EAAK2xG,iBAAiBz9G,cAAgBs9G,EAAcJ,GAAevzF,EAAIi3B,YAAYv6C,QAAQ,GAC3FyF,EAAK4xG,iBAAiB19G,YAAc/V,OAAO4xD,GAE3Cl7D,KAAK27G,gBAAgBp7D,QACvB,GAEA,CAAA5iD,IAAA,UAAAE,MAMA,WACE,IAAAm/H,EAAgHh9H,KAAK+gC,OAAtGoI,EAAI6zF,EAAX1wG,IAAO6c,KAAuBlY,EAAM+rG,EAArB/X,QAAWhwG,GAA8Bic,EAAO8rG,EAAvB7X,SAAYlwG,GAAemsB,EAAoB47F,EAApB57F,qBAC3E,GAD2G47F,EAAVrR,WACjF,CACd,IAAM7xF,EAAS95B,KAAK85B,SACpB,GAAIA,EAAQ,MAAO,CAACA,EAAS8X,GAA8B9X,EAAQ95B,KAAKoxH,sBAAwB,EAClG,CACA,GAAIjoF,GAAQA,EAAK7sB,KAAM,MAAO,CAAC6sB,EAAK7sB,KAAM6sB,EAAK7sB,KAAOs1B,GAA8BzI,EAAK7sB,KAAO8kB,GAChG,IAAAurD,EAA4B,CAAC1hE,KAAMymB,aAAazgB,GAAShG,KAAMymB,aAAaxgB,IAArE+rG,EAAOtwC,EAAA,GAAEuwC,EAAQvwC,EAAA,GACxB,GAAIswC,GAAWC,EAAU,CACvB,IAAMlsG,EAAmBisG,EAAUC,EAC7BjM,EAAUjgG,EAAmBoQ,EAEnC,MAAO,CAAC6vF,EADeA,EAAUr/E,GACA5gB,EACnC,CACA,MAAO,CAAC,EAAG,EAAG,EAChB,GAAC,CAAArzB,IAAA,kBAAAE,MAED,SAAiBuyD,GACf,IAAMkzD,EAAOtjH,KAAK04G,WAAWtoD,EAAK6X,SAC5Bz3C,EAAQ4/B,EAAK5/B,MACnB,IAAK8yF,EAAM,OAAOtjH,KAAKm9H,sBAClB,Gfr+Ea,Ieq+ET7Z,EAAKn6F,IAAIzpB,Mfj9EM,Iei9EuB8wB,EAAMjjB,OAAmC,CAEtF,IAAM4b,EAAM8B,KAAM+E,MAAMogC,EAAK6X,SACzB9+C,IAAKm6F,EAAK3wD,QAAQr2C,KAAK+C,YAAcikG,EAAKgP,OAAOh2G,KAAK+C,YAAcrf,KAAK0yH,sBAAsBvpG,EAAKnpB,KAAK+gC,QAC/G,Ef18E0B,Ie48EvBvQ,EAAMG,Mfp9EgB,Ieo9EqBH,EAAMjjB,Qf38E1B,Ie48EvBijB,EAAMG,Mfp9EgB,Ieo9EqBH,EAAMjjB,SAClDvN,KAAK4iH,mBACH33F,KAAMioG,mBAAmB5P,EAAKn6F,KAAMtU,GAAIyE,KAAKgqG,EAAK3wD,QAAQsgE,gBACzDp+G,GAAI2E,KAAK8pG,EAAK3wD,QAAQsgE,eAC7B,GAEA,CAAAt1H,IAAA,kBAAAE,MAIA,SAAiBuyD,GACf,IAAMjnC,EAAMinC,EAAKpgC,MACXszF,EAAOtjH,KAAK04G,WAAWvvF,EAAIlU,IAQ3BmoH,EAA6B,sBAAfhtE,EAAKqC,OAAgD,wBAAfrC,EAAKqC,MAC/D,IAAK6wD,GAAQ8Z,GAA+B,gBAAfhtE,EAAKqC,OAA2BtpC,EAAIqpG,YAC/D,OAAOxyH,KAAKm9H,sBAEd,IAAME,EAAY/Z,EAAKn6F,IAAI5b,OAC3B+1G,EAAKn6F,IAAMA,EACQ,iBAAfinC,EAAKqC,OAA0B59C,GAAIyE,KAAKgqG,EAAK3wD,QAAQqgE,YACrD7pG,EAAImH,SAAWnH,EAAIoH,KAAK1b,GAAI2E,KAAK8pG,EAAK3wD,QAAQqgE,YAC9C/nG,KAAMioG,mBAAmB/pG,GAAMtU,GAAIyE,KAAKgqG,EAAK3wD,QAAQsgE,gBACpDp+G,GAAI2E,KAAK8pG,EAAK3wD,QAAQsgE,gBAC3BjzH,KAAK4yH,gBAAgBtP,If7/EE,IeggFpB+Z,Gf//EqB,Ie+/EkBl0G,EAAI5b,Qf//EtB,IeggFrB8vH,GAAwCl0G,EAAI5b,OfhgFvB,KekgFtBvN,KAAK6gH,kBACL7gH,KAAK4iH,mBACL5iH,KAAKy7G,GAAGj7D,WAEZ,GAEA,CAAA7iD,IAAA,kBAAAE,MAGA,SAAiBuyD,GAEf,GADAnlC,KAAMuoB,IAAI,OAAQ,mBAAoB4c,GACjCpwD,KAAK+gC,QACNqvB,EAAK9oB,OAAStnC,KAAK+gC,OAAOmP,IAAI5I,MAAQ8oB,EAAKk7D,WAAatrH,KAAK+gC,OAAOwqF,IAAxE,CACIvrH,KAAKo5B,OACPp5B,KAAKo5B,KAAKkkG,SAASltE,EAAK/0B,OACxBr7B,KAAK05G,WAAW/lF,QAGlB3zB,KAAKu9H,wBACL,IAAK,IAALlgH,EAAA,EAAAmgH,EAAuCngI,OAAO+C,OAAOJ,KAAK04G,YAAWr7F,EAAAmgH,EAAAj6H,OAAA8Z,IAAE,CAAlE,IAAAogH,EAAAD,EAAAngH,GAAQ8L,EAAGs0G,EAAHt0G,IAAKwpC,EAAO8qE,EAAP9qE,QAAS2/D,EAAMmL,EAANnL,OACnBoL,EAAiBttE,EAAK/0B,MAAQlS,EAAIkS,MACxC,QAAQ,GACN,KfviFa,IeuiFRlS,EAAIzpB,MfzhFU,IeyhFkBypB,EAAI5b,QAAoCmwH,EAC3E,IAAMnwH,Ef/hFY,Ie+hFH4b,EAAI0G,IAAiCtT,GAAUA,GAAoBA,GAAUA,GAC5Fo2C,EAAQplD,OAAO8R,YAAcizG,EAAO/kH,OAAO8R,YAAc9R,EACzD4b,EAAI5b,OfjiFc,IeiiFL4b,EAAI0G,If1hFG,EADF,Ee4hFlB,MAEF,Kf5iFc,Ie4iFT1G,EAAIzpB,Mf/hFU,Ie+hFmBypB,EAAI5b,OAExColD,EAAQplD,OAAO8R,YAAcizG,EAAO/kH,OAAO8R,YAAc9C,GAAUA,GACnE4M,EAAI5b,OfhiFgB,EemiF1B,CAtBmF,CAuBrF,GAEA,CAAA5P,IAAA,2BAAAE,MAIA,WAA4B,IAAAmhC,EAAA,KAC1B,OAAQh/B,KAAK+4G,sBACX,IAAK,OACH,OAAO,SAACpyG,EAAgByT,GAAc,OAAK4kB,EAAKg6E,4BAA8BryG,EAAE2V,KAAOlC,EAAEkC,KAAK,EAChG,IAAK,MACH,OAAO,SAAC3V,EAAgByT,GAAc,OAAK4kB,EAAKg6E,4BAA8BryG,EAAE4pB,IAAMnW,EAAEmW,IAAI,EAC9F,IAAK,MACH,OAAO,SAAC5pB,EAAgByT,GAAa,OAAK4kB,EAAKg6E,4BAA8BryG,EAAEs/C,MAAQ7rC,EAAE6rC,MAAM,EAErG,GAAC,CAAAtoD,IAAA,4BAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACZwtF,EAAgB34G,KAAK24G,cAE3B,GADA9jG,GAAImD,MAAMmT,EAAKo4F,uBACV5K,EAAL,CACA,IAAMglB,EAAU39H,KAAK49H,2BACrBjlB,EAAcl+E,KAAKkjG,GAAQ,IACME,EADNC,EAAAzyH,GACPstG,GAAa,IAAjC,IAAAmlB,EAAAvyH,MAAAsyH,EAAAC,EAAAt3H,KAAA9E,MAAmC,KAAxB8uB,EAAKqtG,EAAAhgI,MACRypD,EAAMn8B,EAAK4wF,sBAAsBtwF,WAAU,GAC3CtL,EAAOtL,GAAI6W,cAAc47B,GAC/Br8B,KAAM2oC,aAAatM,GACnBnnC,EAAK7D,KAAK+C,YAAcxK,GAAIkc,gBAAgBP,EAAMlU,KAAOtc,KAAK+gC,OAAOK,sBACrEjhB,EAAKoQ,IAAIlR,YAAcxK,GAAIkc,gBAAgBP,EAAMD,IAAKvwB,KAAK+gC,OAAOviB,cAClE2B,EAAKsmE,IAAIpnE,YAAcxK,GAAI2nE,UAAUhsD,EAAMy1B,OAC3C9lC,EAAKsmE,IAAIloE,QAAQmlG,WAAap6G,OAAOknB,EAAMy1B,OAC3CqB,EAAI3uC,UAAUC,IAAI4X,EAAMf,KAAO,YAAc,YAC7CtE,EAAKo4F,sBAAsBjsD,OAAOhQ,EACpC,CAAC,OAAA5oD,GAAAo/H,EAAAlyH,EAAAlN,EAAA,SAAAo/H,EAAAjyH,GAAA,CAbyB,CAc5B,GAAC,CAAAlO,IAAA,mBAAAE,MAED,SAAkBoyB,GAChBjwB,KAAK24G,cAAgB,GAAA5sG,OAAArE,EAAIuoB,GAAOvoB,EAAK1H,KAAK24G,gBAAe5zG,MAAM,EAAG,IACpE,GAEA,CAAApH,IAAA,oBAAAE,MACA,SAAmBuyD,GACjBpwD,KAAKk6G,iBAAiBp0B,kBAAkB11B,GACxCpwD,KAAK44G,cAAgB,CAAC,EAGtB,IAAM5vE,EAAMhpC,KAAK+gC,OACjB,GAAKiI,GAAQA,EAAIkH,KAAOlH,EAAIkH,IAAIu5E,mBAAqB5+F,GAAiB6+F,UAAtE,CAEA1pH,KAAKy7G,GAAG31B,kBAAkB11B,GAC1B,IAAMsqD,EAAM16G,KAAK26G,WAEZvqD,EAAKryC,UAAY28F,EAAIlpF,KAAKvc,IAAMm7C,EAAKryC,UAAY28F,EAAIlgE,MAAMvlC,IAAKylG,EAAIqJ,sBAAqB,GAG9F,IAAMh0E,EAAQqgB,EAAK5X,QAAQxI,UAC3B,OAAQogB,EAAKryC,SACX,KAAKirB,EAAIi8E,QAAQhwG,GAEf,IAAK+zB,EAAIu0E,QAAS,MACa,iBAApBv0E,EAAIyiF,aAA4BziF,EAAIyiF,cAAgB17E,IAAO/G,EAAIu0E,QAAU,MAChFv9G,KAAKm9G,UAAUn9G,KAAK0uH,UACxB,MACF,KAAK1lF,EAAIm8E,SAASlwG,GAChB,IAAK5X,OAAOkH,KAAKykC,EAAI00E,SAASn6G,OAAQ,MACR,iBAAnBylC,EAAI0iF,YAA2B1iF,EAAI0iF,aAAe37E,IAAO/G,EAAI00E,QAAU,CAAC,GAC9E19G,KAAKm9G,UAAUn9G,KAAK2uH,SAnB0D,CAqBzF,GAEA,CAAAhxH,IAAA,cAAAE,OAAA45G,EAAAhvG,EAAAzL,IAAAA,MAIA,SAAAuzE,IAAA,IAAAplD,EAAA6E,EAAA4sB,EAAAxzC,EAAA,OAAApM,IAAAA,MAAA,SAAAwzE,GAAA,cAAAA,EAAA3rE,KAAA2rE,EAAAluE,MAAA,OAIyC,GAHjC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKsjG,SAAUtjG,EAAK6rG,MACvBhnG,EAAQhwB,KAAKqkH,aACbznE,EAAM,CAAE5sB,MAAOqnG,GAAUrnG,IAC1BhwB,KAAKy7H,cAAczrG,GAAQ,CAAFwgD,EAAAluE,KAAA,eAAAkuE,EAAAvuE,OAAA,iBAGS,OADvCkpB,EAAK0zF,QAAQlmG,UAAUC,IAAI,UAC3BuS,EAAK4yG,QAAQplH,UAAUM,OAAO,UAASu3D,EAAAluE,KAAA,GACrBuL,EAAS,kBAAmB+uC,GAAI,QAIlD,GAJMxzC,EAAGonE,EAAA1uE,KAETqpB,EAAK0zF,QAAQlmG,UAAUM,OAAO,UAC9BkS,EAAK4yG,QAAQplH,UAAUC,IAAI,UAEtBqS,KAAM6mC,cAAc1oD,GAAM,CAAFonE,EAAAluE,KAAA,SAER,OADnB6oB,EAAK6rG,KAAK33G,YAAcjW,EAAIwE,IAC5BiH,GAAIyE,KAAK6R,EAAK6rG,MAAKxmD,EAAAvuE,OAAA,kBAIrB4S,GAAI2E,KAAK2R,EAAK8xB,OACdj9C,KAAKm9H,sBAAqB,yBAAA3sD,EAAAxrE,OAAA,GAAAurE,EAAA,UAC3B,kBAAAknC,EAAA7uG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,OAAAmzD,EAAAvoD,EAAAzL,IAAAA,MAKA,SAAA+zE,IAAA,IAAAjlC,EAAA7sB,EAAA+pB,EAAA,OAAAhsC,IAAAA,MAAA,SAAAm0E,GAAA,cAAAA,EAAAtsE,KAAAssE,EAAA7uE,MAAA,cAAA6uE,EAAA7uE,KAAA,EACqB2oB,KAAMqhD,YAAW,OAA1B,GAAJxgC,EAAIqlC,EAAArvE,KACC,CAAFqvE,EAAA7uE,KAAA,eAAA6uE,EAAAlvE,OAAA,iBACHgd,EAAQ6sB,EAAKzK,OAAOrhC,KAAKw7H,cAAcvmH,IAC7CJ,GAAI2E,KAAKxZ,KAAKmrB,KAAK8xB,QACbjU,EAAMhpC,KAAK+gC,QACTkkF,QAAQhwG,KAAOgK,EAAMhK,GAAI+zB,EAAIxX,KAAOvS,EACnC+pB,EAAIm8E,SAASlwG,KAAOgK,EAAMhK,KAAI+zB,EAAIwR,MAAQv7B,GACnDjf,KAAK26G,WAAWwa,YAAYl2G,EAAMhK,IAClCjV,KAAK4rH,gCACL5rH,KAAK+iH,6BAA4B,yBAAA5xC,EAAAnsE,OAAA,GAAA+rE,EAAA,UAClC,kBAAA/f,EAAApoD,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,MACA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACZynB,EAAO//B,SAASsY,EAAKqyF,SAAS3/G,OAAS,KAC7C,GAAI+0C,GAAQ,EAKV,OAJAznB,EAAKqyF,SAAS3/G,MAAgC,KAAxBstB,EAAKqyF,SAAS3/G,MAAe,GAAK,IACxDstB,EAAK2yF,SAASjgH,MAAQ,GACtBmC,KAAK+/G,iBAAgB,QACrB//G,KAAK4qH,qBAAoB,EAAOruG,GAAUA,KAG5C,IACMmuG,EAAW93E,EADD5yC,KAAK+gC,OAAOzU,IAAI+c,QAMhC,GAJAle,EAAKqyF,SAAS3/G,MAAQyL,OAAOspC,GAE7BznB,EAAK2yF,SAASjgH,MAAQyL,OAAOohH,EAAW1qH,KAAK+gC,OAAOviB,aAAa7J,aAAaC,mBAEzE5U,KAAKokH,WAAapkH,KAAKm9G,SAAU,CACpC,IAAMloE,EAAahqB,KAAMoW,OAAOrhC,KAAK+gC,OAAOvP,KAAKvc,IAAImQ,OACrDplB,KAAK4qH,oBAAoBF,GAAYz1E,EAAWuD,QAAQxI,UAAWzzB,GAAUA,IAC/E,CACAvc,KAAK+/G,iBAAgB,EACvB,GAEA,CAAApiH,IAAA,kBAAAE,MAIA,SAAiBmgI,GACf,IAAM7yG,EAAOnrB,KAAKmrB,KACZ6E,EAAQhwB,KAAKqkH,aAAerkH,KAAKskH,aACvC,GAAIt0F,EAAMO,IAAM,EAId,OAHApF,EAAKqyF,SAAS3/G,MAAQ,IACtBstB,EAAK2yF,SAASjgH,MAAQ,QACtBmC,KAAK+/G,iBAAgB,GAGvB,IAAMvmF,EAAUx5B,KAAK+gC,OAAOzU,IAAI+c,QAC1BuJ,EAAO3/B,KAAK4I,MAAMmU,EAAMO,IAAMiJ,GAC9Bg1F,EAAWx+F,EAAMO,IAAMvwB,KAAKqkH,aAAa9zF,IAAMqiB,EAAOpZ,EAC5DrO,EAAKqyF,SAAS3/G,MAAQyL,OAAOspC,IAExB5iB,EAAMo0F,SAAYp0F,EAAMP,QAGzBuuG,IAAU7yG,EAAK2yF,SAASjgH,MAAQyL,OAAOklH,EAAWxuH,KAAK+gC,OAAOviB,aAAa7J,aAAaC,mBAC5F5U,KAAK+/G,iBAAgB,GACvB,GAEA,CAAApiH,IAAA,mBAAAE,MAIA,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACZoF,EAAM69F,GAAejjG,EAAK4yF,YAAYlgH,OAAS,GAAImC,KAAK+gC,OAAOtiB,cAAc9J,aAAaC,kBAC1FilB,EAAM75B,KAAK85B,SACjB,GAAIvJ,EAAM,EAAG,CACX,IAAMolB,EAAc1qB,KAAMoW,OAAOrhC,KAAK+gC,OAAOyZ,MAAMvlC,IAAImQ,OACvDplB,KAAK4qH,oBAAoBr6F,GAAOolB,EAAY6C,QAAQxI,UAAWzzB,GAAUA,IAC3E,MACEvc,KAAK4qH,qBAAoB,EAAOruG,GAAUA,KAE5C,IAAKsd,IAAQtJ,EAGX,OAFApF,EAAK8yG,WAAW5+G,YAAc,SAC9B8L,EAAK+yG,YAAY7+G,YAAc,KAGjC,IACMo3G,EAAWlmG,EAAMsJ,EACjB+Y,EAAQ6jF,EAFEz2H,KAAK+gC,OAAOzU,IAAI+c,QAGhCle,EAAK8yG,WAAW5+G,YAAcuzB,EAAKltB,QAAQ,GAC3CyF,EAAK+yG,YAAY7+G,YAAcxK,GAAIkc,gBAAgB0lG,EAAUz2H,KAAK+gC,OAAOviB,aAC3E,GAEA,CAAA7gB,IAAA,mBAAAE,MAIA,WAEE,IAAM2wH,EAAWxuH,KAAK29G,eACtB,GAAI6Q,GAAY,EAMd,OALAxuH,KAAK64G,WAAW5vG,MAAQ,GACxBjJ,KAAKo9G,iBACLp9G,KAAKmrB,KAAK+xF,UAAUr/G,MAAQ,IAC5BmC,KAAK+/G,iBAAgB,QACrB//G,KAAKukH,uBAGP,IAAMv0F,EAAQhwB,KAAKqkH,aAAerkH,KAAKskH,aACjCpqG,EAAIs0G,EAAWxuH,KAAK+gC,OAAOK,qBACjCphC,KAAKmrB,KAAK+xF,UAAUr/G,MAAQyL,OAAO4Q,GACnCla,KAAK64G,WAAW5vG,MAAQ,CAAC,CACvBqT,KAAMpC,EACNkO,MAAO4H,EAAMP,KAAOzvB,KAAK05G,WAAWzmF,MAAMV,SAAWvyB,KAAK05G,WAAWzmF,MAAMT,UAE7ExyB,KAAKo9G,iBACLp9G,KAAK+/G,iBAAgB,GACrB//G,KAAKukH,sBACP,GAEA,CAAA5mH,IAAA,eAAAE,MAIA,WACE,IAAM6N,EAAI1L,KAAKmrB,KAAK+xF,UAAUr/G,MAC9B,IAAK6N,EAAG,OAAOyyH,IACf,IAAM7hH,EAAO8xG,GAAe1iH,EAAG1L,KAAK+gC,OAAOK,sBAE3C,OAAO9kB,EAAQA,EADEtc,KAAK+gC,OAAOzU,IAAI0U,QAEnC,GAEA,CAAArjC,IAAA,YAAAE,MACA,WACEmC,KAAKo+H,eAAc,GACnBp+H,KAAKo+H,eAAc,EACrB,GAEA,CAAAzgI,IAAA,0BAAAE,MAIA,SAAyBwuD,GACvB,IAAKA,IAAWA,EAAO9oD,OAAQ,MAAO,GACtC,IAAM86H,EAAO,GACTC,EAAe,GACfC,EAAkB,GAClBC,EAAWnyE,EAAO,GAAG4kE,QACrB5kE,EAAO,GAAGhxB,MAAOijG,EAAat7H,KAAKqpD,EAAO,IACzCkyE,EAAgBv7H,KAAKqpD,EAAO,IACjC,IAAK,IAAI7oD,EAAI,EAAGA,EAAI6oD,EAAO9oD,OAAQC,IAC7B6oD,EAAO7oD,GAAGytH,UAAYuN,IACxBH,EAAKr7H,KAAKu7H,GACVF,EAAKr7H,KAAKs7H,GACVA,EAAe,GACfC,EAAkB,GAClBC,EAAWnyE,EAAO7oD,GAAGytH,SAEnB5kE,EAAO7oD,GAAG63B,MAAOijG,EAAat7H,KAAKqpD,EAAO7oD,IACzC+6H,EAAgBv7H,KAAKqpD,EAAO7oD,IAInC,OAFA66H,EAAKr7H,KAAKu7H,GACVF,EAAKr7H,KAAKs7H,GACHD,EAAK/qH,QAAO,SAAAmrH,GAAG,OAAIA,EAAIl7H,OAAS,CAAC,GAC1C,GAEA,CAAA5F,IAAA,gBAAAE,MACA,SAAe4xB,GAAe,IAAAyP,EAAA,KACtBw/F,EAAWjvG,EAAOzvB,KAAKo5B,KAAKJ,MAAQh5B,KAAKo5B,KAAKL,KAC9C4lG,EAAQlvG,EAAOzvB,KAAKmrB,KAAKu1F,SAAW1gH,KAAKmrB,KAAKs1F,QACpD5rG,GAAImD,MAAM2mH,GACLD,GAAaA,EAASn7H,QACTvD,KAAK4+H,wBAAwBF,GACrCn+H,SAAQ,SAAAk+H,GAASE,EAAMrmH,YAAY4mB,EAAK2/F,cAAcJ,GAAM,GACxE,GAEA,CAAA9gI,IAAA,gBAAAE,MACA,SAAemyB,GACb,IAAM2uG,EAAQ3uG,EAAMP,KAAOzvB,KAAKmrB,KAAKu1F,SAAW1gH,KAAKmrB,KAAKs1F,QACtDn5D,EAAMq3E,EAAM9mH,WAEhB,GAAmB,IAAfmY,EAAM1T,KAAV,CAaA,IADIgrC,GAAiC,IAA1BA,EAAIw3E,QAAQC,YAAiBz3E,EAAMA,EAAI03E,aAC3C13E,GAAK,CACV,GAAmC,IAA/BA,EAAIw3E,QAAQnB,QAAQ3tG,GAEtB,YADAs3B,EAAIw3E,QAAQG,YAAYjvG,GAEnB,GAAIs3B,EAAIw3E,QAAQnB,QAAQ3tG,GAAS,EAAG,CACzC,IAAM6uC,EAAK7+D,KAAK6+H,cAAc,CAAC7uG,IAE/B,YADA2uG,EAAM37B,aAAankC,EAAIvX,EAEzB,CACAA,EAAMA,EAAI03E,WACZ,CACA,IAAMngE,EAAK7+D,KAAK6+H,cAAc,CAAC7uG,IAC/B2uG,EAAMrmH,YAAYumD,EAflB,KAVA,CACE,GAAwB,IAApB7uC,EAAM4kF,UAAiB,OAEvBttD,GAAiC,IAA1BA,EAAIw3E,QAAQC,UACrBz3E,EAAIw3E,QAAQG,YAAYjvG,IAExBs3B,EAAMtnD,KAAK6+H,cAAc,CAAC7uG,IAC1B2uG,EAAM37B,aAAa17C,EAAKq3E,EAAM9mH,YAGlC,CAgBF,GAEA,CAAAla,IAAA,mBAAAE,MACA,SAAkBmyB,GAEhB,IADA,IAAMgc,EAAQhc,EAAMgc,MACpBhqB,EAAA,EAAA9Z,EAAoB,CAAClI,KAAKmrB,KAAKu1F,SAAU1gH,KAAKmrB,KAAKs1F,SAAQz+F,EAAA9Z,EAAA3E,OAAAye,IACzD,IADG,IAAM28G,EAAKz2H,EAAA8Z,GACdmkC,EAAA,EAAA4pB,EAAkB3oE,MAAMI,KAAKm3H,EAAMjkH,UAASyrC,EAAA4pB,EAAAxsE,OAAA4iD,IAC1C,GADW4pB,EAAA5pB,GACJ24E,QAAQI,YAAYlzF,GACzB,MAIR,GAEA,CAAAruC,IAAA,mBAAAE,MACA,SAAkBu3B,GAChB,IAAK,IAALqtC,EAAA,EAAA04B,EAAoB,CAACn7F,KAAKmrB,KAAKu1F,SAAU1gH,KAAKmrB,KAAKs1F,SAAQh+C,EAAA04B,EAAA53F,OAAAk/D,IACzD,IADG,IAAMk8D,EAAKxjC,EAAA14B,GACdY,EAAA,EAAA07B,EAAkB33F,MAAMI,KAAKm3H,EAAMjkH,UAAS2oD,EAAA07B,EAAAx7F,OAAA8/D,IAC1C,GADW07B,EAAA17B,GACJy7D,QAAQK,eAAe/pG,GAC5B,MAIR,GAEA,CAAAz3B,IAAA,wBAAAE,MAGA,WACEmC,KAAKo/H,yBAAyBp/H,KAAKmrB,KAAKu1F,UACxC1gH,KAAKo/H,yBAAyBp/H,KAAKmrB,KAAKs1F,QAC1C,GAEA,CAAA9iH,IAAA,2BAAAE,MAIA,SAA0B8gI,GACxB,IAAK,IAALhvD,EAAA,EAAA0vD,EAAkBj4H,MAAMI,KAAKm3H,EAAMjkH,UAASi1D,EAAA0vD,EAAA97H,OAAAosE,IAA/B0vD,EAAA1vD,GACRmvD,QAAQQ,mBAEf,GAEA,CAAA3hI,IAAA,gBAAAE,MAIA,SAAe0hI,GAAiC,IAAAx/F,EAAA,KACxC8+B,EAAK7+D,KAAKmrB,KAAKywF,aAAanwF,WAAU,GAC5C+zG,EAA2Fx/H,KAAK+gC,OAAxFviB,EAAYghH,EAAZhhH,aAAcC,EAAa+gH,EAAb/gH,cAAe2iB,EAAoBo+F,EAApBp+F,qBAAuCN,EAAQ0+F,EAAzBlzG,IAAO0U,SAC5D89F,EAAU,IAAIW,GAAqB5gE,EAAI0gE,EAAU/gH,EAAcC,EAAeqiB,GAepF,OAdA+9B,EAAGigE,QAAUA,EACb30H,GAAK00D,EAAI,SAAS,WAChB9+B,EAAKs5E,iBAAiBx6C,EAAGigE,QAAQC,UAAY39F,EAC/C,IAC6B,IAAzBy9B,EAAGigE,QAAQC,WACblqH,GAAI1K,KAAK00D,EAAI,cAAc,WACzB,IAAM6gE,EAAQ3/F,EAAK25E,WACnB35E,EAAK84E,WAAWh8E,MAAQ,CAAC,CACvBvgB,KAAMuiD,EAAGigE,QAAQC,UAAY39F,EAC7BhZ,MAAOy2C,EAAGigE,QAAQ3hB,SAAWuiB,EAAMzsG,MAAMV,SAAWmtG,EAAMzsG,MAAMT,UAElEuN,EAAKq9E,gBACP,IAEKv+C,CACT,GAEA,CAAAlhE,IAAA,iBAAAE,OAAA25G,EAAA/uG,EAAAzL,IAAAA,MAEA,SAAAk1E,EAAsB9hB,GAAmB,OAAApzD,IAAAA,MAAA,SAAAm1E,GAAA,cAAAA,EAAAttE,KAAAstE,EAAA7vE,MAAA,OACE,GAAzCtC,KAAKwhH,WAAWme,oBAAoBvvE,GAChCA,EAAKq5D,mBAAqB5+F,GAAiB6+F,UAAS,CAAAv3C,EAAA7vE,KAAA,eAAA6vE,EAAA7vE,KAAA,EAIhD2oB,KAAMqhD,YAAW,cAAA6F,EAAA7vE,KAAA,EACjB2oB,KAAM2yB,SAAS,WAAU,wBAAAu0B,EAAAntE,OAAA,GAAAktE,EAAA,UAElC,SAAAroD,GAAA,OAAA2tF,EAAA5uG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,MAIA,WAAiB,IAAA+hI,EACTC,EAA0C,QAAjCD,EAAG5/H,KAAKmrB,KAAK60F,eAAeniH,aAAK,IAAA+hI,OAAA,EAA9BA,EAAgClwG,cAC5Cpc,EAASusH,EAAY,SAAC72F,GAAc,OAAKA,EAAIjlC,KAAKqkD,SAASy3E,EAAU,EAAG,kBAAM,CAAI,EACxF7/H,KAAKwhH,WAAWse,UAAUxsH,EAC5B,GAEA,CAAA3V,IAAA,iBAAAE,MACA,WACEmC,KAAK05G,WAAWqmB,SAAS,GAADh0H,OAAArE,EAAK1H,KAAK64G,WAAWh8E,OAAKn1B,EAAK1H,KAAK64G,WAAW5vG,SACvEjJ,KAAK05G,WAAW/lF,MAClB,GAEA,CAAAh2B,IAAA,yBAAAE,MAEA,SAAwB+iB,GAAa,IAAAo/G,EAAAC,EACnB,QAAZD,EAAChgI,KAAK+gC,cAAM,IAAAi/F,GAAK,QAALC,EAAXD,EAAa9vF,WAAG,IAAA+vF,GAAhBA,EAAkBlV,WAAW3iE,SAASxnC,KAAMA,EAx3FjC,MAy3FhB5gB,KAAKm6G,UAAYv5F,EACjB5gB,KAAKirH,cACLxgH,EAAMgE,WAAWhE,EAAM2vG,qBAAsBx5F,EAC/C,GAEA,CAAAjjB,IAAA,cAAAE,MAIA,WAAe,IACoCqiI,EADpCC,EAAA90H,GACMwJ,GAAIqD,KAAKlY,KAAKmrB,KAAK2/F,aAAW,IAAjD,IAAAqV,EAAA50H,MAAA20H,EAAAC,EAAA35H,KAAA9E,MAAmD,KAAxCsuE,EAAIkwD,EAAAriI,MACTmyE,EAAK3wD,cAAgBrf,KAAKm6G,UAAWnqC,EAAKr3D,UAAUC,IAAI,YACvDo3D,EAAKr3D,UAAUM,OAAO,WAC7B,CAAC,OAAAva,GAAAyhI,EAAAv0H,EAAAlN,EAAA,SAAAyhI,EAAAt0H,GAAA,CACD,IAAAu0H,EAA2DpgI,KAAK+gC,OAAxD0kF,EAAY2a,EAAZ3a,aAAcn5F,EAAG8zG,EAAH9zG,IAAK9N,EAAY4hH,EAAZ5hH,aAAcC,EAAa2hH,EAAb3hH,cACnC+nD,EAAQi/C,EAAazlH,KAAKm6G,WAC5B3zC,EAGFxmE,KAAK85G,YAAY+a,WAAWruD,EAAOl6C,EAAK9N,EAAcC,GAGxDze,KAAK0lH,gBACP,GAEA,CAAA/nH,IAAA,iBAAAE,MAGA,SAAgBs8G,GAAoB,IAAAt2E,EAAA,KAClC7jC,KAAK00H,eAAiB,CACpBp2E,OAAQ,WAAkB,EAC1Bq2E,MAAOzoH,OAAOqN,YAAW,WACnBsqB,EAAK6wF,iBACP7wF,EAAK6wF,eAAiB,KACtB/5G,QAAQvZ,MAAM,wBAElB,GAAG,MAEL,IAAAi/H,EAAmCrgI,KAAK+gC,OAAhCmP,EAAGmwF,EAAHnwF,IAAK+0E,EAAOob,EAAPpb,QAASE,EAAQkb,EAARlb,SACtBnH,GAAGvH,QAAQ,cAAe,CAAEnvE,KAAM4I,EAAI5I,KAAM9V,KAAMyzF,EAAQhwG,GAAIulC,MAAO2qE,EAASlwG,GAAI2L,IAAKu5F,GAAan6G,KAAKm6G,WAC3G,GAEA,CAAAx8G,IAAA,SAAAE,MAIA,WACEmgH,GAAGvH,QAl7Fe,WAk7FQ,CAAC,GAC3BuH,GAAGsiB,gBAAgB3pB,IACnBqH,GAAGsiB,gBAAgB1pB,IACnBoH,GAAGsiB,gBAAgBzpB,IACnBmH,GAAGsiB,gBAAgBxpB,IACnBkH,GAAGsiB,gBAAgBvpB,IACnBiH,GAAGsiB,gBAAgBtpB,IACnBgH,GAAGsiB,gBAAgBrpB,IACnBj3G,KAAK05G,WAAW6mB,WAChBvgI,KAAK85G,YAAYymB,WACjB1rH,GAAImU,OAAO/d,SAAU,QAASjL,KAAKgvD,OACnCrI,cAAc3mD,KAAKu8E,aACrB,KAACg7B,CAAA,CAt3F6B,CAAS3sF,IA83FnC62F,GAAU,WAOd,SAAAA,EAAat6E,GAAkBt+B,EAAA,KAAA44G,GAN/B33G,EAAA,mBAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,wBAOE9J,KAAKmnC,IAAMA,EACXnnC,KAAKunD,QAAU1yC,GAAI24D,KAAKrmC,EAAK,gBAC7BtyB,GAAIuyB,eAAepnC,KAAKunD,SACxBvnD,KAAKwgI,mBACP,CAyEC,OAzEA72H,EAAA83G,EAAA,EAAA9jH,IAAA,cAAAE,MAED,SAAauyD,GAAqB,IACFqwE,EADEC,EAAAr1H,GACdrL,KAAKi2C,SAAO,IAA9B,IAAAyqF,EAAAn1H,MAAAk1H,EAAAC,EAAAl6H,KAAA9E,MAAgC,KAArB4lD,EAAGm5E,EAAA5iI,MACZ,GAAIypD,EAAIte,IAAIiyB,GAAG3zB,OAAS8oB,EAAK9oB,KAA7B,CACA,IAAM2zB,EAAKhwC,KAAMuc,UAAU8f,EAAIte,IAAIiyB,GAAG3zB,MAChC0B,EAAMiyB,EAAGhlB,QAAQqR,EAAIte,IAAIjlC,MAC/B2gH,GAAkBp9D,EAAInnC,KAAM86C,EAAIjyB,EAHW,CAI7C,CAAC,OAAAtqC,GAAAgiI,EAAA90H,EAAAlN,EAAA,SAAAgiI,EAAA70H,GAAA,CACH,GAAC,CAAAlO,IAAA,oBAAAE,MAED,WACEgX,GAAImD,MAAMhY,KAAKmnC,KACfnnC,KAAKi2C,QAAU,GAWf,IATA,IAAmBjN,EACXxtB,EACAC,EACA2lB,EACAkmB,EAKRwoB,EAAA,EAAA6wD,EAicJ,WAWE,IAVA,IAAMC,EAAyB,GACzBv/F,EAASpW,KAAMoW,OACfw/F,EAAiB,SAAC5lE,EAAc2lE,GACpC,OAAOA,EAAKrvE,KAAI,SAACvoB,GACf,IAAMriC,EAAI06B,EAAO2H,EAAI1H,QACf+O,EAAW1pC,EAAIA,EAAE5C,KAAOilC,EAAIzH,WAC5B/lB,EAAMyP,KAAMvW,SAASs0B,EAAI1H,OAAQ25B,GACvC,OAAO59D,OAAOyjI,OAAO,CAAE7lE,GAAAA,EAAI5qB,SAAAA,EAAU70B,IAAAA,GAAOwtB,EAC9C,GACF,EACA+3F,EAAA,EAAAC,EAAiB3jI,OAAO+C,OAAO6qB,KAAMuc,WAAUu5F,EAAAC,EAAAz9H,OAAAw9H,IAAA,CAA1C,IAAM9lE,EAAE+lE,EAAAD,GAAoCH,EAAK59H,KAAI4F,MAATg4H,EAAIl5H,EAASm5H,EAAe5lE,EAAI59D,OAAO+C,OAAO66D,EAAGhlB,SAAW,CAAC,KAAI,CAWlH,OAVA2qF,EAAKnmG,MAAK,SAAC9zB,EAAmByT,GAC5B,IAAKzT,EAAEwiC,KACL,OAAI/uB,EAAE+uB,KAAa,EAEfxiC,EAAE5C,OAASqW,EAAErW,KAAa4C,EAAEs0D,GAAG3zB,KAAKolD,cAActyE,EAAE6gD,GAAG3zB,MACpD3gC,EAAE5C,KAAK2oF,cAActyE,EAAErW,MACzB,IAAKqW,EAAE+uB,KAAM,OAAQ,EAC5B,IAAO83F,EAAiBt6H,EAAEwiC,KAAKu0D,MAAQ/2F,EAAE0iC,QACzC,OADkDjvB,EAAE+uB,KAAKu0D,MAAQtjF,EAAEivB,QACpD43F,CACjB,IACOL,CACT,CAxdsBM,GAAepxD,EAAA6wD,EAAAp9H,OAAAusE,IAAA,CAA5B,IAAM9mC,EAAG23F,EAAA7wD,GAAqB9vE,KAAKi2C,QAAQjzC,MAT7BgmC,EAS4CA,OARvDxtB,OACAC,OACA2lB,OACAkmB,EAHA9rC,EAAMyP,KAAMvW,SAASs0B,EAAI1H,OAAQ0H,EAAIiyB,IACrCx/C,EAAMwP,KAAMvW,SAASs0B,EAAIu2B,QAASv2B,EAAIiyB,IACtC75B,EAAuBwQ,GAA+Bp2B,EAAI7G,aAAaC,iBAAmB6G,EAAI9G,aAAaC,iBAC3G0yC,EAAM,IAAI65E,GARO,KAQQ55E,QAASve,EAAK5H,GARtB,KASlB+F,IAAI7uB,YAAYgvC,EAAI97B,MAClB87B,GAG2D,CACpEr8B,KAAM2oC,aAAa5zD,KAAKmnC,IAC1B,GAAC,CAAAxpC,IAAA,OAAAE,MAED,SAAMypC,EAAcrW,EAAgBC,GAAmC,IACvCkwG,EADuCC,EAAAh2H,GACnDrL,KAAKi2C,SAAO,IAA9B,IAAAorF,EAAA91H,MAAA61H,EAAAC,EAAA76H,KAAA9E,MAAgC,KAArB4lD,EAAG85E,EAAAvjI,MACZ,GAAIypD,EAAIte,IAAIiyB,GAAG3zB,OAASA,GAAQggB,EAAIte,IAAI1H,SAAWrQ,GAAUq2B,EAAIte,IAAIu2B,UAAYruC,EAAS,OAAOo2B,CACnG,CAAC,OAAA5oD,GAAA2iI,EAAAz1H,EAAAlN,EAAA,SAAA2iI,EAAAx1H,GAAA,CACD,OAAO,IACT,GAEA,CAAAlO,IAAA,SAAAE,MACA,SAAQypC,EAAcrW,EAAgBC,GACpC,OAA4C,OAArClxB,KAAK00C,KAAKpN,EAAMrW,EAAQC,EACjC,GAEA,CAAAvzB,IAAA,QAAAE,MACA,WACE,OAAOmC,KAAKi2C,QAAQ,EACtB,GAEA,CAAAt4C,IAAA,SAAAE,MACA,SAAQypC,EAAcrW,EAAgBC,GACpC,IAAMo2B,EAAMtnD,KAAK00C,KAAKpN,EAAMrW,EAAQC,GACpC,IAAKo2B,EAAK,OAAO3sC,QAAQvZ,MAAM,6BAAD2K,OAA8Bu7B,EAAI,MAAAv7B,OAAKklB,EAAM,KAAAllB,OAAImlB,IAAU,IAC3DowG,EAD2DC,EAAAl2H,GACvErL,KAAKi2C,SAAO,IAA9B,IAAAsrF,EAAAh2H,MAAA+1H,EAAAC,EAAA/6H,KAAA9E,MAAc4/H,EAAAzjI,MAAsB2tB,KAAK7S,UAAUM,OAAO,WAAW,OAAAva,GAAA6iI,EAAA31H,EAAAlN,EAAA,SAAA6iI,EAAA11H,GAAA,CACrE7L,KAAKktB,SAAWo6B,EAChBtnD,KAAKktB,SAAS1B,KAAK7S,UAAUC,IAAI,WACnC,GAEA,CAAAjb,IAAA,sBAAAE,MAGA,SAAqBuyD,GAAqB,IACVoxE,EADUC,EAAAp2H,GACtBrL,KAAKi2C,SAAO,IAA9B,IAAAwrF,EAAAl2H,MAAAi2H,EAAAC,EAAAj7H,KAAA9E,MAAgC,KAArB4lD,EAAGk6E,EAAA3jI,MACRypD,EAAIte,IAAIiyB,GAAG3zB,OAAS8oB,EAAK9oB,OACzB8oB,EAAKq5D,mBAAqB5+F,GAAiB6+F,UAAW70G,GAAI2E,KAAK8tC,EAAInnC,KAAKuhH,iBACvE7sH,GAAIyE,KAAKguC,EAAInnC,KAAKuhH,iBACzB,CAAC,OAAAhjI,GAAA+iI,EAAA71H,EAAAlN,EAAA,SAAA+iI,EAAA51H,GAAA,CACH,GAEA,CAAAlO,IAAA,YAAAE,MAGA,SAAWyV,GAAqC,IAChBquH,EADgBC,EAAAv2H,GAC5BrL,KAAKi2C,SAAO,IAA9B,IAAA2rF,EAAAr2H,MAAAo2H,EAAAC,EAAAp7H,KAAA9E,MAAgC,KAArB4lD,EAAGq6E,EAAA9jI,MACRyV,EAAOg0C,GAAMzyC,GAAIyE,KAAKguC,EAAI97B,MACzB3W,GAAI2E,KAAK8tC,EAAI97B,KACpB,CAAC,OAAA9sB,GAAAkjI,EAAAh2H,EAAAlN,EAAA,SAAAkjI,EAAA/1H,GAAA,CACH,KAAC41G,CAAA,CArFa,GA4FV0f,GAASx3H,GAUb,SAAAw3H,EAAaU,EAAuB74F,EAAqB5H,GAA8Bv4B,EAAA,KAAAs4H,GAAAr3H,EAAA,oBAAAA,EAAA,mBAAAA,EAAA,oBAAAA,EAAA,sBAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,oBAAAA,EAAA,oCACrF9J,KAAKgpC,IAAMA,EACXhpC,KAAK+D,KAAOilC,EAAIjlC,KAChB/D,KAAKixB,OAAS+X,EAAI1H,OAClBthC,KAAKkxB,QAAU8X,EAAIu2B,QACnBv/D,KAAKw5B,QAAUwP,EAAIK,QACnBrpC,KAAKohC,qBAAuBA,EAC5BphC,KAAKwrB,KAAOq2G,EAASp2G,WAAU,GAC/B,IA2ZkBkU,EACdhpB,EAIY2wB,EACZg4D,EAjaEn/E,EAAOngB,KAAKmgB,KAAOtL,GAAI6W,cAAc1rB,KAAKwrB,MAChDrL,EAAKilG,SAAS3lG,IAAM5K,GAAImK,SAASgqB,EAAIzH,YACrCphB,EAAKklG,UAAU5lG,IAAM5K,GAAImK,SAASgqB,EAAIq1D,aACtCl+E,EAAKmwB,WAAWh4B,YAAYzD,GAAI2vD,UAAUx7B,EAAIiyB,GAAG55B,OAAO2H,EAAI1H,SAAS,IACrEnhB,EAAK4wB,YAAYz4B,YAAYzD,GAAI2vD,UAAUx7B,EAAIiyB,GAAG55B,OAAO2H,EAAIu2B,UAAU,IACvEp/C,EAAKkwB,SAAShxB,YAAc2pB,EAAIqH,SAChClwB,EAAKmnB,KAAKjoB,YAAc2pB,EAAIiyB,GAAG3zB,KAC/BnnB,EAAKmnB,KAAK/sB,MAAM6N,OAyZAkf,EAzZkB0B,EAAIiyB,GAAG3zB,MA0ZrCg4D,EAAQjiG,OAAOkH,KAAK0mB,KAAMuc,YAC1B/M,OAPckF,EAQD2/D,EAAM1gF,QAAQ0oB,GAP3B3wB,EAAImrH,GAAKniG,EAAMmiG,GAAKv+H,QACnB,OAAPwI,OAAkB,IAAJ4K,EAAO,gBArZnBwJ,EAAKmnB,KAAK/oB,QAAQ4G,QAAU6jB,EAAIiyB,GAAG3zB,KACnCo9E,GAAkBvkG,EAAM6oB,EAAIiyB,GAAIjyB,GAC5BhpC,KAAKgpC,IAAIiyB,GAAGwuD,mBAAqB5+F,GAAiB6+F,WAAW70G,GAAIyE,KAAK6G,EAAKuhH,gBACjF,IAqBI9mB,GAAa,WAMjB,SAAAA,EAAappF,EAAmBgpB,GAAoB,IAAAkyB,EAAA,KAAA7jE,EAAA,KAAA+xG,GAAA9wG,EAAA,oBAAAA,EAAA,qBAHpDA,EAAA,mBAIE+K,GAAI2E,KAAKgY,EAAMgpB,GACf,IAAMunF,EAAQltH,GAAI6W,cAAc8F,GAChCxxB,KAAKwxB,KAAO,CACVvc,GAAI,EACJg3B,SAAUqrE,GACVhrF,IAAK,KACLd,KAAMgG,EACNrR,KAAM4hH,EACNC,QAASD,EAAME,YACfnnB,WAAY,IAAIr2F,GAAYs9G,EAAME,cAEpCF,EAAMG,eAAejpH,SAErB,IAAMkpH,EAAQttH,GAAI6W,cAAc8uB,GAChCx6C,KAAKw6C,MAAQ,CACXvlC,GAAI,EACJg3B,SAAUqrE,GACVhrF,IAAK,KACLd,KAAMgvB,EACNr6B,KAAMgiH,EACNH,QAASG,EAAMF,YACfnnB,WAAY,IAAIr2F,GAAY09G,EAAMF,cAEpCE,EAAMD,eAAejpH,SAErBgS,KAAMilC,mBAAmB,CACvB1X,QAAS,SAAC4X,GAAwBsc,EAAKyoD,YAAY/kE,EAAKryC,QAAS,EACjEoyC,YAAa,SAACC,GAA4Bsc,EAAKyoD,YAAY/kE,EAAKhrC,OAAOrH,QAAS,EAChFuyC,WAAY,SAACF,GAA2Bsc,EAAKyoD,YAAY/kE,EAAKryC,QAAS,EACvEyyC,aAAc,SAACJ,GAA+Bsc,EAAKyoD,YAAY/kE,EAAKryC,QAAS,GAEjF,CAiHC,IAAAq9D,EAuBA,OAxIAzxE,EAAAixG,EAAA,EAAAj9G,IAAA,uBAAAE,MAED,SAAsBqtF,GAChBA,EAAWr2E,GAAIyE,KAAKtZ,KAAKwxB,KAAKhG,KAAMxrB,KAAKw6C,MAAMhvB,MAC9C3W,GAAI2E,KAAKxZ,KAAKwxB,KAAKhG,KAAMxrB,KAAKw6C,MAAMhvB,KAC3C,GAEA,CAAA7tB,IAAA,aAAAE,MAIA,SAAYypC,EAAcrW,EAAgBC,GACxC,IAAM+a,EAAW,SAACluB,GAChB,IAAMkB,EAAQgM,KAAMoW,OAAOtjB,GAC3B,OAAIkB,SAAAA,EAAO+sB,MAAc/sB,EAAM+sB,MAAMC,SAC9BqrE,EACT,EACAt3G,KAAKkwC,IAAMjlB,KAAM6gB,KAAKtE,UAAUF,GAChCtnC,KAAKwxB,KAAKvc,GAAKgc,EACfjxB,KAAKwxB,KAAKya,SAAWA,EAAShb,GAC9BjxB,KAAKwxB,KAAKlF,IAAMtsB,KAAKkwC,IAAI7O,OAAOpQ,GAChCjxB,KAAKw6C,MAAMvlC,GAAKic,EAChBlxB,KAAKw6C,MAAMvO,SAAWA,EAAS/a,GAC/BlxB,KAAKw6C,MAAMluB,IAAMtsB,KAAKkwC,IAAI7O,OAAOnQ,GACjClxB,KAAKoiI,aAAapiI,KAAKwxB,MACvBxxB,KAAKoiI,aAAapiI,KAAKw6C,OACvBx6C,KAAK+jH,qBAAqB/jH,KAAKkwC,IAAIu5E,mBAAqB5+F,GAAiB6+F,UAC3E,GAEA,CAAA/rH,IAAA,eAAAE,MAIA,SAAc8yB,GACZ,IAAQrE,EAAgDqE,EAAhDrE,IAAKnM,EAA2CwQ,EAA3CxQ,KAAM6hH,EAAqCrxG,EAArCqxG,QAASlnB,EAA4BnqF,EAA5BmqF,WAAgB/8F,EAAY4S,EAAhB1b,GACxC,GAAKqX,EAAL,CACA,IAAMrN,EAAQgM,KAAMoW,OAAOtjB,GAY3B,GAVAlJ,GAAI2E,KACF2G,EAAKkiH,aAAcliH,EAAK+6F,QAAS/6F,EAAKmiH,YAAaniH,EAAK66F,QAAS76F,EAAKoiH,QACtEpiH,EAAK8hH,YAAa9hH,EAAKqiH,YAAariH,EAAKk7F,WAAYl7F,EAAKsiH,kBAE5DziI,KAAK8uF,mBAAmB/wE,EAASoC,EAAKsiH,kBACtCtiH,EAAK2sB,KAAKrtB,IAAM5K,GAAImK,SAASsN,EAAI3N,QACjCwB,EAAKuiH,gBAAgBrjH,YAAciN,EAAI3N,OAAOW,cAC9CzK,GAAImD,MAAMmI,EAAKxB,QAGVM,EAAL,CAIAkB,EAAKxB,OAAOrG,YAAYzD,GAAI2vD,UAAUvlD,GAAO,IAC7CpK,GAAIyE,KAAK0oH,GACT,IAAM58G,EAASnG,EAAMmG,OAGrB,GAFA01F,EAAW6nB,WAAWv9G,IAEjBA,EACH,OAAInG,EAAM40C,2BACRh/C,GAAIyE,KAAK6G,EAAKoiH,cAGhB1tH,GAAIyE,KAAK6G,EAAKkiH,cAGhBxtH,GAAIyE,KAAK6G,EAAKk7F,YAEd,IAAMh3C,EAAMj/C,EAAOozB,QAEnB,GAAK6rB,GAAQj/C,EAAOE,SAAYF,EAAOF,SAAvC,CAMA,IAAKm/C,EAGH,OAFAp5C,KAAM23G,aAAa7kH,QACnBlJ,GAAIyE,KAAK6G,EAAKoiH,SAKhB1tH,GAAIyE,KAAK6G,EAAKqiH,aACd3tH,GAAImD,MAAMmI,EAAKqiH,aACf,IAAMK,EAAS,SAACl1B,EAAetpC,EAAa5nD,EAAcomD,GACxD,IAAMvb,EAAMnnC,EAAK+hH,eAAez2G,WAAU,GAC1CtL,EAAKqiH,YAAYlqH,YAAYgvC,GAC7B,IAAMw7E,EAAUjuH,GAAI6W,cAAc47B,GAClCw7E,EAAQn1B,MAAMtuF,YAAcsuF,EAC5Bm1B,EAAQz+D,IAAIhlD,YAAcxK,GAAIkc,gBAAgBszC,EAAK5nD,GAC/ComD,IACFigE,EAAQz+D,IAAI/M,OAAOuL,GACnBlyC,EAAKu1C,UAAY48D,EAAQz+D,IAE7B,EAIA,GAHAw+D,EAAOtmH,GpBzuGiB,aoByuGa8nD,EAAIr0B,UAAW/wB,EAAMvK,UAC1DmuH,EAAOtmH,GAAUA,GAAiB8nD,EAAIx/C,OAASw/C,EAAIk4B,eAAiBl4B,EAAIjC,WAAYnjD,EAAMvK,UAC1FmuH,EAAOtmH,GpBzuGgB,YoByuGa8nD,EAAImoB,SAAUvtE,EAAMvK,UACpDuK,EAAM+sB,MAAO,CACf,IAAA+2F,EAAkD93G,KAAMoW,OAAOpiB,EAAM+sB,MAAMC,UAAzDuM,EAAOuqF,EAAjB39G,OAAUozB,QAAW9jC,EAAQquH,EAARruH,SAAUiK,EAAMokH,EAANpkH,OACjCkkD,EAAO53D,SAAS4P,cAAc,OACpCgoD,EAAKpjD,IAAM5K,GAAImK,SAASL,GACxBkkD,EAAKlqD,UAAUC,IAAI,aAAc,QACjCiqH,EAAOtmH,GpB9uGiB,eoB8uGei8B,EAAQxI,UAAWt7B,EAAUmuD,EACtE,EAIgB,IAAIj4D,MAAOE,UAAY,IAAIF,KAAKy5D,EAAIpe,OAAOn7C,UAnuGhD,OAouGKsa,EAAOF,UACrBrQ,GAAIyE,KAAK6G,EAAK+6F,SACV91F,EAAOE,SAAS2F,KAAM23G,aAAa7kH,IAClClJ,GAAI2E,KAAK2G,EAAK+6F,QAxCrB,MAFErmG,GAAIyE,KAAK6G,EAAK66F,QAnBhB,MAFEnmG,GAAIyE,KAAK6G,EAAKmiH,YAdA,CA8ElB,GAAC,CAAA3kI,IAAA,qBAAAE,OAAAu9E,EAAA3yE,EAAAzL,IAAAA,MAED,SAAAo1E,EAA0Br0D,EAAiB/I,GAAe,OAAAhY,IAAAA,MAAA,SAAAq1E,GAAA,cAAAA,EAAAxtE,KAAAwtE,EAAA/vE,MAAA,OACrD,OADqD+vE,EAAA3kE,GACxDmH,GAAGw9D,EAAA/vE,KAAA,EAAc2oB,KAAM2lE,oBAAoB7yE,GAAQ,OAAAs0D,EAAA1e,GAAA0e,EAAAvwE,KAAAuwE,EAAA80C,GAAEnyG,EAAEq9D,EAAA3kE,GAAnDwmB,OAAMv0B,KAAA0yE,EAAA3kE,GAAA2kE,EAAA1e,GAAA0e,EAAA80C,IAAA,wBAAA90C,EAAArtE,OAAA,GAAAotE,EAAA,KACX,SAAArzB,EAAAC,GAAA,OAAAo8B,EAAAxyE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,MACA,SAAc8yB,GAA4B,IAAAqyG,EACxCC,EAA0Ch4G,KAAMoW,OAAO1Q,EAAKsb,UAA1CuM,EAAOyqF,EAAjB79G,OAAUozB,QAAW9jC,EAAQuuH,EAARvuH,SAEX,QAAlBsuH,EAAIryG,EAAKu1C,iBAAS,IAAA88D,GAAdA,EAAgBnrH,aAAY8Y,EAAKu1C,UAAUruD,WAAWwH,YAAcxK,GAAIkc,gBAAgBynB,EAAQxI,UAAWt7B,GACjH,GAEA,CAAA/W,IAAA,cAAAE,MAKA,SAAakgB,GACPA,IAAY/d,KAAKwxB,KAAKvc,GAAIjV,KAAKoiI,aAAapiI,KAAKwxB,MAC5CzT,IAAY/d,KAAKw6C,MAAMvlC,IAAIjV,KAAKoiI,aAAapiI,KAAKw6C,OACvDz8B,IAAY/d,KAAKwxB,KAAKya,UAAUjsC,KAAKkjI,aAAaljI,KAAKwxB,MACvDzT,IAAY/d,KAAKw6C,MAAMvO,UAAUjsC,KAAKkjI,aAAaljI,KAAKw6C,MAC9D,KAACogE,CAAA,CA9KgB,GAkLnB,SAASgJ,GAAYt8E,EAAc9V,EAAegpB,GAChD,MAAO,CACLlT,KAAMA,EACN9V,KAAMA,EACNgpB,MAAOA,EAEX,CAGO,SAAS8wE,GAAUlxG,EAAW8yG,GAAa,MAAO,GAAPnhH,OAAUqO,EAAC,KAAArO,OAAImhH,EAAI,CAGrE,SAASkB,GAAgB7iH,EAAWqJ,GAClC,OAAKrJ,EACE0H,KAAKC,MAAMsW,WAAWje,GAAKqJ,GADnB,CAEjB,CAGA,SAASmoG,GAAWomB,EAAqBjgH,GACvCigH,EAAOxqH,UAAUM,OAAO,YACxBiK,EAAIvK,UAAUC,IAAI,WACpB,CAMA,SAASy+G,GAAWrnG,GAElB,IADA,IAAMozG,EAAyC,CAAC,EAChDC,EAAA,EAAA/lH,EAAqBjgB,OAAOkgB,QAAQyS,EAAMu+F,SAAQ8U,EAAA/lH,EAAA/Z,OAAA8/H,IAAA,CAA7C,IAAAn1E,EAAAtmD,EAAA0V,EAAA+lH,GAAA,GAAO53H,EAACyiD,EAAA,GAAExiD,EAACwiD,EAAA,GAAoCk1E,EAAe33H,GAAKY,KAAKC,UAAUZ,EAAE,CACzF,OAAOrO,OAAOyjI,OAAO,CAAC,EAAG9wG,EAAO,CAAEu+F,QAAS6U,GAC7C,CAIA,IACM3D,GAAoB,WASxB,SAAAA,EAAa6D,EAAuB/D,EAAuB/gH,EAAwBC,EAAyBqiB,GAAkBj4B,EAAA,KAAA42H,GAAA31H,EAAA,wBAAAA,EAAA,oBAAAA,EAAA,wBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,qBAAAA,EAAA,4BAC5H9J,KAAKsjI,SAAWA,EAChB,IAAMn4G,EAAOnrB,KAAKmrB,KAAOtW,GAAI6W,cAAc43G,GAC3CtjI,KAAKu/H,SAAWA,EAChBv/H,KAAKyvB,KAAO8vG,EAAS,GAAG9vG,KACxBzvB,KAAKixH,QAAUsO,EAAS,GAAGtO,QAC3BjxH,KAAKq7B,QAAUkkG,EAAS,GAAGlkG,MAC3Br7B,KAAKwe,aAAeA,EACpB,IAAM+kH,EAAW1uH,GAAIk2C,wBAAwB/qD,KAAKixH,QAASzyG,EAAcC,EAAeqiB,GAExF,GADAjsB,GAAIqf,OAAOl0B,KAAKwjI,UAAWxjI,KAAKmrB,KAAKkQ,OAChB,IAAjBr7B,KAAKixH,QACP9lG,EAAK7O,KAAKggD,UAAY,aACjB,CACL,IAAMmnE,EAAWzjI,KAAKm9G,SAAW,YAAc,WAC/ChyF,EAAK7O,KAAKggD,UAAYinE,EACtBp4G,EAAK7O,KAAK3D,UAAUC,IAAI6qH,EAC1B,CACAzjI,KAAK0jI,sBACP,CA6FC,OAzFD/5H,EAAA81H,EAAA,EAAA9hI,IAAA,uBAAAE,MACA,WACE,IAAQstB,EAAmBnrB,KAAnBmrB,KAAMo0G,EAAav/H,KAAbu/H,SACRhvG,EAAMgvG,EAAS9hH,QAAO,SAACwyB,EAAO0zF,GAAI,OAAK1zF,EAAQ0zF,EAAK/uB,SAAS,GAAE,GAC/DgvB,EAAYrE,EAASh8H,OAC3B4nB,EAAKoF,IAAI+rC,UAAYznD,GAAIizE,oBAAoBv3D,EAAKvwB,KAAKwe,cACnDolH,EAAY,GACdz4G,EAAKy4G,UAAUxjH,gBAAgB,UAC/B+K,EAAKy4G,UAAUtnE,UAAYhzD,OAAOs6H,GAClCz4G,EAAKy4G,UAAUj2B,MAAQ,4BAAH5hG,OAA+B63H,EAAS,YAE5Dz4G,EAAKy4G,UAAUvtC,aAAa,SAAU,OAE1C,GAGA,CAAA14F,IAAA,cAAAE,MACA,SAAamyB,GACXhwB,KAAKu/H,SAASv8H,KAAKgtB,GACnBhwB,KAAK0jI,sBACP,GAIA,CAAA/lI,IAAA,iBAAAE,MACA,SAAgB0iD,GAEd,IADA,IAAQvU,EAA0BuU,EAA1BvU,MAAOzb,EAAmBgwB,EAAnBhwB,IAAKqkF,EAAcr0D,EAAdq0D,UACXpxG,EAAI,EAAGA,EAAIxD,KAAKu/H,SAASh8H,OAAQC,IACxC,GAAIxD,KAAKu/H,SAAS/7H,GAAGwoC,QAAUA,EAI7B,OAHAhsC,KAAKu/H,SAAS/7H,GAAG+sB,IAAMA,EACvBvwB,KAAKu/H,SAAS/7H,GAAGoxG,UAAYA,EAC7B50G,KAAK0jI,wBACE,EAGX,OAAO,CACT,GAKA,CAAA/lI,IAAA,cAAAE,MACA,SAAamuC,GACX,IAAM63F,EAAQ7jI,KAAKu/H,SAASuE,WAAU,SAAA9zG,GAAK,OAAIA,EAAMgc,QAAUA,CAAK,IACpE,QAAI63F,EAAQ,IACZ7jI,KAAKu/H,SAAS1lE,OAAOgqE,EAAO,GACvB7jI,KAAKu/H,SAASh8H,OACdvD,KAAK0jI,uBADiB1jI,KAAKsjI,SAASrqH,SAElC,GACT,GAGA,CAAAtb,IAAA,oBAAAE,MACA,SAAmBkmI,GACjB/jI,KAAKu/H,SAAWv/H,KAAKu/H,SAASjsH,QAAO,SAAC0c,GACpC,QAASA,EAAMqL,OAASrL,EAAMqL,QAAU0oG,EAC1C,IACK/jI,KAAKu/H,SAASh8H,OACdvD,KAAK0jI,uBADiB1jI,KAAKsjI,SAASrqH,QAE3C,GAEA,CAAAtb,IAAA,UAAAE,MACA,WACE,OAAOmC,KAAKixH,OACd,GAEA,CAAAtzH,IAAA,UAAAE,MACA,WACE,OAAOmC,KAAKq7B,KACd,GAEA,CAAA19B,IAAA,SAAAE,MACA,WACE,OAAOmC,KAAKyvB,IACd,GAMA,CAAA9xB,IAAA,UAAAE,MACA,SAASmyB,GACP,OAAIhwB,KAAK++H,YAAc/uG,EAAMihG,SAAWjxH,KAAKwjI,cAAgBxzG,EAAMqL,MAC1D,EACEr7B,KAAK++H,YAAc/uG,EAAMihG,QAC1BjxH,KAAK++H,UAAY/uG,EAAMihG,UAAajhG,EAAMP,KAAO,GAAK,EAEvDzvB,KAAKwjI,UAAY,GAAK,CAEjC,KAAC/D,CAAA,CAxHuB,GA0J1B,SAAS/a,GAAmBvkG,EAAmC86C,EAAcjyB,GAC3E,GAAKA,EAAIG,KAAT,CACAhpB,EAAK61E,MAAM32E,YAAcxK,GAAIiJ,kBAAkBmN,KAAM+F,iBAAiBgY,EAAI1H,OAAQ0H,EAAIu2B,QAASv2B,EAAIG,KAAK7sB,KAAM2+C,IAC9G,IAAMhzC,EAAO+gB,EAAIG,KAAKy7E,SAAW,EAAI,IAAM,GAC3CzkG,EAAK23G,OAAOn/G,UAAUM,OAAO,WAAY,aACzCkH,EAAK23G,OAAOn/G,UAAUC,IAAIowB,EAAIG,KAAKy7E,UAAY,EAAI,WAAa,aAChEzkG,EAAK23G,OAAOz4G,YAAc,GAAHtT,OAAMkc,GAAIlc,QAAwB,IAApBi9B,EAAIG,KAAKy7E,UAAgBl/F,QAAQ,GAAE,IALnD,CAMvB,CAEA,IAAMo8G,GAAO,CAAC,GAAO,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,8gCCphH5D,IAGqBkC,GAAU,SAAA7tD,GAAA/rE,EAAA45H,EAAA7tD,GAAA,IAuS7B8tD,EAjDAC,EA5BAC,EAXAC,EAhFA5oD,MA/H6B9zD,KAAAs8G,iZAS7B,SAAAA,EAAazrB,GAAmB,IAAAp/F,EAAAtQ,EAAA,KAAAm7H,GACvBl6H,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,iBAAArP,EAAAC,EAAAoP,GAAA,kBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,eACPA,EAAKo/F,KAAOA,EAGZp/F,EAAK6iD,OAAS,GACd7iD,EAAKqlC,SAAU,EACf,IAAMrzB,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAck7D,GAC3Cp/F,EAAKkrH,UAAYl5G,EAAKo8B,QACtBpuC,EAAKkrH,UAAUprH,SAIf,IAAMqrH,EAA2BnrH,EAAKmrH,YAAc,CAClDhlC,MAAO,GACPj+D,OAAQ,GACRkT,SAAU,IAGNw1D,EAAS,IAAIE,gBAAgB/9F,OAAOi+F,SAASJ,QAC7Cw6B,EAAa,SAAC39E,EAAmB49E,GACrC,IAAM94H,EAAIq+F,EAAOjjG,IAAI09H,GACrB,GAAK94H,GAAkB,IAAbA,EAAEnI,OAAZ,CACA,IAAMkhI,EAAY/4H,EAAEJ,MAAM,KACtBI,IACD44H,EAAoBE,GAAaC,GAEpC79E,EAAKnsC,iBAAiB,SAASla,SAAQ,SAAAyvE,GACjCy0D,EAAU7lH,QAAQoxD,EAAKnyE,QAAU,IAAGmyE,EAAKrX,SAAU,EACzD,GAPgC,CAQlC,EACA4rE,EAAWp5G,EAAKu5G,WAAY,SAC5BH,EAAWp5G,EAAKw5G,YAAa,UAC7BJ,EAAWp5G,EAAKy5G,aAAc,YAE9B,IAAMC,EAA8B,GAC9BC,EAAgB,SAACl+E,EAAmB49E,GACxC,IAAMO,EAAYn+E,EAAK1xC,cAAc,eACrC2vH,EAAa7hI,KAAK+hI,GAClBlwH,GAAI1K,KAAK46H,EAAW,SAAS,WAC3B5rH,EAAK6rH,eACLH,EAAatkI,SAAQ,SAAAyvE,GAAI,OAAIn7D,GAAI2E,KAAKw2D,EAAK,GAC7C,IACAppB,EAAKnsC,iBAAiB,SAASla,SAAQ,SAAAyvE,GACrCn7D,GAAI1K,KAAK6lE,EAAM,UAAU,YA6QjC,SAA2Bi1D,EAAgBC,GACzC,GAAID,EAAQ1hI,SAAW2hI,EAAQ3hI,OAAQ,OAAO,EAAK,IACxB8R,EADwBC,EAAAjK,GAC/B45H,GAAO,IAA3B,IAAA3vH,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAA6B,KAAlBgB,EAAK2S,EAAAxX,MACd,IAAgC,IAA5BqnI,EAAQtmH,QAAQlc,GAAe,OAAO,CAC5C,CAAC,OAAAhE,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACD,OAAO,CACT,CAjRcs5H,CADcC,GAAex+E,GACA09E,EAAoBE,IAInD3vH,GAAIyE,KAAKyrH,GAFTlwH,GAAI2E,KAAKurH,EAIb,GACF,GACF,EA6DmB,OA3DnBD,EAAc35G,EAAKu5G,WAAY,SAC/BI,EAAc35G,EAAKw5G,YAAa,UAChCG,EAAc35G,EAAKy5G,aAAc,YAEjC/vH,GAAI1K,KAAKgP,EAAKo/F,KAAM,UAAU,WACxBp/F,EAAKqlC,SACWrzB,EAAKk6G,YAAYzuH,aAAeuC,EAAKo/F,KAAK3hG,aAAeuC,EAAKo/F,KAAKhiG,UACrE,GAChB4C,EAAKmsH,UAET,IAEAn6G,EAAK8xB,MAAMxiC,iBAAiB,gBAAgBla,SAAQ,SAAAyU,GAClDH,GAAI1K,KAAK6K,EAAI,SAAS,WACpBH,GAAI2E,KAAK2R,EAAK8xB,MAChB,GACF,IAGApoC,GAAI1K,KAAKghB,EAAK8xB,MAAO,aAAa,SAACrxC,GAC5BiJ,GAAIk6C,eAAenjD,EAAGuN,EAAKynC,cAC9B/rC,GAAI2E,KAAK2R,EAAK8xB,MAElB,IAEApoC,GAAI1K,KAAKghB,EAAKo6G,aAAc,SAAS,WACnCpsH,EAAKosH,cACP,IAEAp6G,EAAKq6G,sBAAsBjwH,iBAAiB,UAAU,WAChD4V,EAAKq6G,sBAAsB7sE,QAAS9jD,GAAIyE,KAAK6R,EAAKs6G,mBACjD5wH,GAAI2E,KAAK2R,EAAKs6G,kBAAmBt6G,EAAKu6G,yBAC7C,IAEA7wH,GAAI1K,KAAKghB,EAAKw6G,sBAAuB,SAAS,WAC5C,IAAMx6G,EAAOhS,EAAKgS,KAClBA,EAAKq6G,sBAAsB7sE,SAAU,EACrCxtC,EAAKy6G,kBAAkBjtE,SAAU,EACjCxtC,EAAK06G,iBAAiBltE,SAAU,EAChCxtC,EAAKu6G,yBAAyBrmH,YAAc,GAC5C8L,EAAK26G,wBAAwBzmH,YAAc,GAC3C8L,EAAK46G,yBAAyB1mH,YAAc,GAC5CxK,GAAI2E,KAAK2R,EAAK66G,qBAAsB76G,EAAKu6G,yBACvCv6G,EAAK46G,yBAA0B56G,EAAK26G,wBAAyB36G,EAAKs6G,mBACpEtsH,EAAKkrE,SAASl5D,EAAK86G,0BACrB,IAEApxH,GAAI1K,KAAKghB,EAAK+6G,4BAA6B,SAAS,WAClD,IAAIntE,EAAO,EACP5tC,EAAKq6G,sBAAsB7sE,UAC7BI,EAAOnuD,KAAK4B,MAAM2e,EAAKg7G,UAAUtoI,OAAS,IACtCyF,MAAMy1D,IAASA,GAAQ,GACzBlkD,GAAI+4D,cAAcziD,EAAKu6G,yBAA0BnpH,GrBvDpB,yBqB2DjCpD,EAAKwsH,sBAAsB5sE,EAC7B,IAEA5/C,EAAK6rH,eAAc7rH,CACrB,CAqLC,OAnLDxP,EAAAq6H,EAAA,EAAArmI,IAAA,WAAAE,OAAA29E,EAAA/yE,EAAAzL,IAAAA,MACA,SAAA8P,EAAgB85C,GAAiB,IAAAz7B,EAAAoQ,EAAA,OAAAv+B,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAM8B,OAL7DtC,KAAK4gD,YAAcgG,EACbz7B,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK86G,2BACdr/E,EAAKrsC,MAAMvE,MAAQ,UACnBnB,GAAIyE,KAAK6R,EAAK8xB,MAAO2J,GACfrrB,GAASpQ,EAAK8xB,MAAMvmC,YAAckwC,EAAKlwC,aAAe,EAACxJ,EAAA5K,KAAA,EACvDuS,GAAIyF,QAzIU,KAyIe,SAAA60C,GACjCvI,EAAKrsC,MAAMvE,MAAQ,GAAHjK,QAAO,EAAIojD,GAAY5zB,EAAK,KAC9C,GAAG,eAAc,OACjBqrB,EAAKrsC,MAAMvE,MAAQ,MAAK,wBAAA9I,EAAAlI,OAAA,GAAA8H,EAAA,UACzB,SAAA9E,GAAA,OAAAwzE,EAAA5yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,YAAAE,MACA,SAAWwuD,GACTx3C,GAAImD,MAAMhY,KAAKmrB,KAAKi7G,WACpBpmI,KAAKqmI,aAAah6E,EACpB,GAEA,CAAA1uD,IAAA,eAAAE,MACA,SAAcwuD,GACZ,IACwBlhD,EADlBwzH,EAAQ3+H,KAAKmrB,KAAKi7G,UAASh7H,EAAAC,GACfghD,GAAM,IAAxB,IAAAjhD,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAA0B,KAAfynB,EAAGhe,EAAAtN,MACNghE,EAAK7+D,KAAKqkI,UAAU54G,WAAU,GAC9BtL,EAAOtL,GAAI6W,cAAcmzC,GAC3BghC,OAAU,EAAEC,OAAQ,EAAEwmC,OAAQ,EAAEC,OAAM,EAAE7mC,OAAO,EAC/CC,EAAQ,GACN1kC,EAAKhwC,KAAMuc,UAAUre,EAAIme,YAAS7lC,EACxC,IAAMwpB,KAAMoW,OAAOlY,EAAI8H,SAAYgqC,EAAG55B,OAAOlY,EAAI8H,WAAchG,KAAMoW,OAAOlY,EAAI+H,UAAa+pC,EAAG55B,OAAOlY,EAAI+H,UAA3G,CACA,IAAAlX,EAAsC,CAACiR,KAAMvW,SAASyU,EAAI8H,OAAQgqC,GAAKhwC,KAAMvW,SAASyU,EAAI+H,QAAS+pC,IAA5Fz8C,EAAYxE,EAAA,GAAEyE,EAAazE,EAAA,GAClC,GAAImP,EAAIsG,KAAM,KAAAxV,EACa,CAACkP,EAAImnB,WAAYnnB,EAAI4nB,aAA7C8uD,EAAU5lF,EAAA,GAAE6lF,EAAQ7lF,EAAA,OAAAyE,EACA,CAACF,EAAa7J,aAAamI,KAAM2B,EAAc9J,aAAamI,MAAhFwpH,EAAQ5nH,EAAA,GAAE6nH,EAAM7nH,EAAA,GACjBghF,EAAU7qF,GAAIkc,gBAAgB5H,EAAIoH,IAAK/R,GhBrK1B,IgBsKT2K,EAAIzpB,OACNigG,EAAQ9qF,GAAIkc,gBAAgB5H,EAAIoH,IAAMqhB,GAA+BzoB,EAAI7M,KAAMmC,GAEnF,KAAO,KAAA0H,EACoB,CAACgD,EAAI4nB,YAAa5nB,EAAImnB,YAA9CuvD,EAAU15E,EAAA,GAAE25E,EAAQ35E,EAAA,OAAAyc,EACA,CAACnkB,EAAc9J,aAAamI,KAAM0B,EAAa7J,aAAamI,MAAhFwpH,EAAQ1jG,EAAA,GAAE2jG,EAAM3jG,EAAA,GhB1KH,IgB2KVzZ,EAAIzpB,KACNggG,EAAU7qF,GAAIkc,gBAAgB5H,EAAIoH,IAAK/R,IAEvCkhF,EAAU7qF,GAAIkc,gBAAgB5H,EAAIoH,IAAMqhB,GAA+BzoB,EAAI7M,KAAMmC,GACjFkhF,EAAQ9qF,GAAIkc,gBAAgB5H,EAAIoH,IAAK/R,GAEzC,CAEA,IAAMu3B,EAAQ,GAAHhqC,OAAMyS,EAAa7J,aAAamI,KAAI,KAAA/Q,OAAI0S,EAAc9J,aAAamI,MAC9EqD,EAAKmnB,KAAKjoB,YAAc,GAAHtT,OAAMgqC,EAAK,OAAAhqC,OAAMod,EAAIme,MAE1CnnB,EAAKu/E,QAAQrgF,YAAcqgF,EAC3Bv/E,EAAKy/E,SAASngF,IAAM5K,GAAImK,SAAS6gF,GACjC1/E,EAAK0/E,WAAWxgF,YAAcinH,EAC9BnmH,EAAKw/E,MAAMtgF,YAAcsgF,EACzBx/E,EAAK4/E,OAAOtgF,IAAM5K,GAAImK,SAAS8gF,GAC/B3/E,EAAK2/E,SAASzgF,YAAcknH,EAC5BpmH,EAAKzgB,KAAK2f,YAAc,GAAHtT,OAAM6lC,GAAqBzoB,GAAI,KAAApd,OAAI6lC,GAAqBzoB,IAC7E,IAAI7M,EAAOzH,GAAIkc,gBAAgB9F,KAAM+F,iBAAiB7H,EAAI8H,OAAQ9H,EAAI+H,QAAS/H,EAAI7M,KAAM2+C,IhB7LzE,IgB8LZ9xC,EAAIzpB,OAA2B4c,EAAOs1B,GAAuCzoB,IACjFhJ,EAAK7D,KAAK+C,YAAc/C,EACxB6D,EAAK5S,OAAO8R,YAAcuyB,GAAuBzoB,GACjDhJ,EAAKmQ,OAAOjR,YAAc,GAAHtT,QAAO6lC,GAAiBzoB,GAAOA,EAAIoH,IAAM,KAAK7K,QAAQ,GAAE,KAC/EvF,EAAKuQ,QAAQrR,YAAc,GAAHtT,QAAO6lC,GAAkBzoB,GAAOA,EAAIoH,IAAM,KAAK7K,QAAQ,GAAE,KACjF,IAAM8gH,EAAW,IAAI57H,KAAKue,EAAI62E,YAAY/8D,iBAC1C9iB,EAAKsmH,QAAQpnH,YAAc,GAAHtT,OAAM8I,GAAI2nE,UAAUrzD,EAAI62E,YAAW,QAC3D7/E,EAAK6lC,KAAK3mC,YAAcmnH,EACX3xH,GAAIi7C,YAAY+O,EAAI,QAC5B1yB,KAAO,SAAHpgC,OAAYod,EAAIlU,IACzBgW,KAAMg1E,uBAAuBphC,GAC7B8/D,EAAMrmH,YAAYumD,EA1C4G,CA2ChI,CAAC,OAAAngE,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CA1MkB,KA2MfwgD,EAAO9oD,OACTvD,KAAKg8D,OAAS3P,EAAOA,EAAO9oD,OAAS,GAAG0R,GAExCjV,KAAKg8D,OAAS,EAElB,GAEA,CAAAr+D,IAAA,eAAAE,OAAAumI,EAAA37H,EAAAzL,IAAAA,MACA,SAAAiR,IAAA,IAAAkd,EAAAm5G,EAAA,OAAAtnI,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAOM,OANE6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAKg8D,OAAS,IACRsoE,EAActkI,KAAKskI,aACbhlC,MAAQ8lC,GAAej6G,EAAKu5G,YACxCJ,EAAYjjG,OAAS+jG,GAAej6G,EAAKw5G,aAAapzE,KAAI,SAAChmD,GAAS,OAAKsH,SAAStH,EAAE,IACpF+4H,EAAY/vF,SAAW6wF,GAAej6G,EAAKy5G,cAAcrzE,KAAI,SAAChmD,GAAS,OAAKsH,SAAStH,EAAE,IAAC4C,EAAAT,GACxF1N,KAAImO,EAAA7L,KAAA,EAAiBtC,KAAK0mI,cAAa,OAAAv4H,EAAAwlD,GAAAxlD,EAAArM,KAAAqM,EAAAT,GAAlCi5H,UAAShnI,KAAAwO,EAAAT,GAAAS,EAAAwlD,IAAA,yBAAAxlD,EAAAnJ,OAAA,GAAAiJ,EAAA,UACf,kBAAAm2H,EAAAx7H,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,cAAAE,OAAAsmI,EAAA17H,EAAAzL,IAAAA,MACA,SAAAuR,IAAA,IAAA+vC,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OACyC,OAAjCg8C,EAASrzB,KAAMuzB,QAAQx+C,KAAKu4G,MAAK/pG,EAAAlM,KAAA,EACrBuL,EAAS,cAAe7N,KAAK4mI,iBAAgB,OACvD,OADFx9H,EAAGoF,EAAA1M,KACTw8C,IAAQ9vC,EAAAvM,OAAA,SACDmH,EAAIijD,QAAM,wBAAA79C,EAAAxJ,OAAA,GAAAuJ,EAAA,UAClB,kBAAA41H,EAAAv7H,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,MACA,WACEmC,KAAKg8D,OAAS,GACd,IAAMsoE,EAActkI,KAAK4mI,gBACnBzqE,EAAM,IAAI+tC,IAAIh+F,OAAOi+F,SAASh+D,MAC9B49D,EAAS,IAAIE,gBAAgB,IAC7B48B,EAAW,SAACp7H,GACG64H,EAAoB74H,GAC7BlL,SAAQ,SAACmL,GACjBq+F,EAAOzyC,OAAO7rD,EAAGC,EACnB,GACF,EACAm7H,EAAS,SACTA,EAAS,UACTA,EAAS,YACT1qE,EAAI4tC,OAASA,EAAOxiG,WACpB40D,EAAIiuC,SAAW,iBACfl+F,OAAO0Z,KAAKu2C,EAAI50D,WAClB,GAEA,CAAA5J,IAAA,wBAAAE,OAAAqmI,EAAAz7H,EAAAzL,IAAAA,MAIA,SAAA2mB,EAA6BmjH,GAAoB,IAAA37G,EAAA47G,EAAAlB,EAAA74H,EAAAsxC,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OASR,OARjC6oB,EAAOnrB,KAAKmrB,KACZ47G,EAAoB57G,EAAKy6G,kBAAkBjtE,UAAW,EACtDktE,EAAmB16G,EAAK06G,iBAAiBltE,UAAW,EACpD3rD,EAAU,CACd85H,YAAaA,EACblB,kBAAmBmB,EACnBlB,iBAAkBA,GAEdvnF,EAASrzB,KAAMuzB,QAAQx+C,KAAKu4G,MAAK30F,EAAAthB,KAAA,EACrBuL,EAAS,6BAA8Bb,GAAQ,OACzD,GADF5D,EAAGwa,EAAA9hB,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFwa,EAAAthB,KAAA,gBAAAshB,EAAA3hB,OAAA,SACpB4S,GAAI+4D,cAAcziD,EAAKu6G,yBAA0Bt8H,EAAIwE,MAAI,QAG9DxE,EAAI49H,uBAAyB,GAC/B77G,EAAK46G,yBAAyB1mH,YAAc9C,GrB3MD,iCqB2MmD,CAAE0qH,SAAU79H,EAAI49H,0BAC1GD,GAAqBlB,KACvB16G,EAAK26G,wBAAwBzmH,YAAc9C,GrB5MX,wBqB4MoD,CAAEqqE,KAAMx9E,EAAI89H,sBAChGryH,GAAIyE,KAAK6R,EAAK26G,0BAGhB9lI,KAAKglI,gBAEL75G,EAAK46G,yBAAyB1mH,YAAc9C,GrBpNZ,uBqBsNlC1H,GAAIyE,KAAK6R,EAAK66G,qBAAsB76G,EAAK46G,0BAAyB,yBAAAniH,EAAA5e,OAAA,GAAA2e,EAAA,UACnE,SAAAhX,GAAA,OAAAu3H,EAAAt7H,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,MAIA,WAA8B,IAAAspI,EAAAC,EACtB9C,EAActkI,KAAKskI,YACzB,MAAO,CACLhlC,MAAOglC,EAAYhlC,MACnBj+D,OAA0B,QAApB8lG,EAAE7C,EAAYjjG,cAAM,IAAA8lG,OAAA,EAAlBA,EAAoB51E,KAAI,SAAChmD,GAAM,OAAKsH,SAAStH,EAAE,IACvDgpC,SAA8B,QAAtB6yF,EAAE9C,EAAY/vF,gBAAQ,IAAA6yF,OAAA,EAApBA,EAAsB71E,KAAI,SAAChmD,GAAM,OAAKsH,SAAStH,EAAE,IAC3D/E,EArSiB,GAsSjBw1D,OAAQh8D,KAAKg8D,OAEjB,GAEA,CAAAr+D,IAAA,WAAAE,OAAAomI,EAAAx7H,EAAAzL,IAAAA,MAGA,SAAA6mB,IAAA,IAAAwoC,EAAA,OAAArvD,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,UACsB,KAAhBtC,KAAKg8D,SAAiBh8D,KAAKw+C,QAAO,CAAA16B,EAAAxhB,KAAA,eAAAwhB,EAAA7hB,OAAA,iBAEP,OAD/BjC,KAAKw+C,SAAU,EACf3pC,GAAIyE,KAAKtZ,KAAKmrB,KAAKk8G,aAAYvjH,EAAAxhB,KAAA,EACVtC,KAAK0mI,cAAa,OAAjCr6E,EAAMvoC,EAAAhiB,KACZ9B,KAAKw+C,SAAU,EACf3pC,GAAI2E,KAAKxZ,KAAKmrB,KAAKk8G,aACnBrnI,KAAKqmI,aAAah6E,GAAO,yBAAAvoC,EAAA9e,OAAA,GAAA6e,EAAA,UAC1B,kBAAAogH,EAAAr7H,MAAA,KAAAD,UAAA,MAAAq7H,CAAA,CAlT4B,CAASp5G,IAyTxC,SAASw6G,GAAgBx+E,GACvB,IAAMrpC,EAAoB,GAI1B,OAHAqpC,EAAKnsC,iBAAiB,SAASla,SAAQ,SAAA6V,GACjCA,EAAIuiD,SAASp7C,EAAQva,KAAKoT,EAAIvY,MACpC,IACO0f,CACT,4gCC1TA,IAGM+pH,GAAkB,MAIHC,GAAS,SAAApxD,GAAA/rE,EAAAm9H,EAAApxD,GAAA,IAsb5BqxD,EA5BA5vB,EAdAp8B,EA/RAisD,EAtBCC,MAvF2BhgH,KAAA6/G,iZAU5B,SAAAA,EAAahvB,GAAmB,IAAAp/F,EAAAtQ,EAAA,KAAA0+H,GACvBz9H,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,kBAAAmK,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,8BAAArP,EAAAC,EAAAoP,GAAA,8BAAArP,EAAAC,EAAAoP,GAAA,mBACP,IAAMgS,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAck7D,GAC3Cp/F,EAAKmjE,SAAWznE,GAAImG,cAAcu9F,EAAM,gBAExCp/F,EAAK8uD,QAAUswC,EAAKh6F,QAAQizG,KAAO,GAEnC38G,GAAIuyB,eAAejc,EAAKw8G,eAExB,IAAMlrD,EAAW,WAAM,IACWtxE,EADXC,EAAAC,GACF8N,EAAKmjE,UAAQ,IAAhC,IAAAlxE,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAkC,KAAvB2c,EAAIlT,EAAAtN,MACbwgB,EAAKgB,YAAcxK,GAAI2nE,UAAU3pE,SAASwL,EAAKE,QAAQ0nC,OAAS,IAClE,CAAC,OAAAvnD,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACH,EA+DY,OA9DZ4wE,IAEAtxD,EAAK8xB,MAAMxiC,iBAAiB,gBAAgBla,SAAQ,SAAAyU,GAClDH,GAAI1K,KAAK6K,EAAI,SAAS,WAChBmE,EAAKyuH,oBACP17H,OAAOi+F,SAASh4F,QAAQjG,OAAOi+F,SAASh+D,MAG1Ct3B,GAAI2E,KAAK2R,EAAK8xB,MAChB,GACF,IAMAs7D,EAAK99F,iBAAiB,sBAAsBla,SAAQ,SAACqrC,GAEnDD,GADgB94B,SAAS+4B,EAAKrtB,QAAQspH,YAAc,IAC/Bj8F,EACvB,IAEIzgB,EAAK6nG,YACPn+G,GAAI1K,KAAKghB,EAAK6nG,WAAY,SAAS,WACjC75G,EAAKkrE,SAASl5D,EAAK4zF,WACrB,IAGFlqG,GAAI1K,KAAKghB,EAAK8nG,eAAgB,SAAS,WACrC95G,EAAK2uH,oBACP,IAMA58G,GAAmBC,GACnBhS,EAAK6gG,oBAAsB,IAAInzC,GAAoB17C,EAAK8uF,gBALxC,WACd9gG,EAAKyuH,qBAAsB,CAC7B,IAIA/yH,GAAIuyB,eAAejc,EAAKT,eAAgBS,EAAKR,aAAcQ,EAAKV,cAGhE5V,GAAI1K,KAAKghB,EAAK8xB,MAAO,aAAa,SAACrxC,GACjC,IAAKiJ,GAAIk6C,eAAenjD,EAAGuN,EAAKynC,aAAc,CAC5C,GAAIznC,EAAKyuH,oBAEP,YADA17H,OAAOi+F,SAASmG,SAGlBz7F,GAAI2E,KAAK2R,EAAK8xB,MAChB,CACF,IAGAujC,GAASr1D,EAAK4zF,WAAY5zF,EAAK6zF,aAAYv2G,EAAAzL,IAAAA,MAAE,SAAA8P,IAAA,OAAA9P,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAAc6W,EAAK8lG,eAAc,wBAAA/xG,EAAAlI,OAAA,GAAA8H,EAAA,MAE9EqM,EAAKojE,aAAerwE,OAAOo2C,aAAY,WACrCm6B,GACF,GAAG,KAEHxxD,KAAMilC,mBAAmB,CACvBlgC,MAAO,SAACogC,GAAsBj3C,EAAK+oG,gBAAgB9xD,EAAM,EACzD5/B,MAAO,SAAC4/B,GAAsBj3C,EAAKgpG,gBAAgB/xD,EAAM,IAG3Dj3C,EAAK2J,QAAO3J,CACd,CA+YC,OA/YAxP,EAAA49H,EAAA,EAAA5pI,IAAA,QAAAE,OAAA6pI,EAAAj/H,EAAAzL,IAAAA,MAED,SAAAiR,IAAA,IAAAkb,EAAA,OAAAnsB,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAGE,KAFI6mB,EAAM8B,KAAM+E,MAAMhwB,KAAKioE,UAGlB,CAAF95D,EAAA7L,KAAA,QAAEtC,KAAKgwB,MAAQ7G,EAAGhb,EAAA7L,KAAA,sBAAA6L,EAAA7L,KAAA,EAEXtC,KAAK+nI,aAAY,OAA7B5+G,EAAGhb,EAAArM,KAAA,OAGL9B,KAAKmrB,KAAK68G,cAAcC,YAAYpzH,GAAI2vD,UAAUv5C,KAAMoW,OAAOlY,EAAI8H,UACnEjxB,KAAKmrB,KAAK+8G,eAAeD,YAAYpzH,GAAI2vD,UAAUv5C,KAAMoW,OAAOlY,EAAI+H,WAEpElxB,KAAKmoI,2BACLnoI,KAAKooI,iBAAgB,yBAAAj6H,EAAAnJ,OAAA,GAAAiJ,EAAA,UACtB,kBAAAy5H,EAAA9+H,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,MAED,WACE8oD,cAAc3mD,KAAKu8E,aACrB,GAEA,CAAA5+E,IAAA,aAAAE,OAAA4pI,EAAAh/H,EAAAzL,IAAAA,MACA,SAAAuR,IAAA,IAAAnF,EAAA,OAAApM,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,cAAAkM,EAAAlM,KAAA,EACoBuL,EAAS,aAAc7N,KAAKioE,SAAQ,OAA7C,GAAH7+D,EAAGoF,EAAA1M,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFoF,EAAAlM,KAAA,cAAQ8G,EAAIwE,IAAG,OACtB,OAAtB5N,KAAKgwB,MAAQ5mB,EAAI4mB,MAAKxhB,EAAAvM,OAAA,SACfjC,KAAKgwB,OAAK,wBAAAxhB,EAAAxJ,OAAA,GAAAuJ,EAAA,UAClB,kBAAAk5H,EAAA7+H,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gCAAAE,MAIA,SAA+BwqI,EAAwB73G,GACrD,IAAMrQ,EAAOtL,GAAI6W,cAAc28G,GAE/BloH,EAAKmoH,QAAQjpH,YAAcmR,EAAM83G,QAEjC,IAAMtiF,EAAO,IAAIp7C,KAAK4lB,EAAMy1B,OAC5B9lC,EAAKooH,UAAUlpH,YAAc2mC,EAAKy7C,mBAAmB5sF,GAAIzB,YAAa,CACpEkvB,KAAM,UACNkmG,MAAO,QACPC,IAAK,YAGPtoH,EAAKuoH,aAAanqH,QAAQ0nC,MAAQz1B,EAAMy1B,MAAM1+C,WAC9C4Y,EAAKuoH,aAAarpH,YAAcxK,GAAI2nE,UAAUhsD,EAAMy1B,OACpDjmD,KAAKs8E,SAASt5E,KAAKmd,EAAKuoH,cAExB,IAAMC,EjBNH,SAAuB34G,EAAcQ,GAC1C,IAAIo4G,EAAWp4G,EAAMD,IAIrB,OAHIT,GAAYE,KACd44G,EAAWr3G,GAAYf,EAAMlU,KAAMkU,EAAMD,OAElCq4G,EAAW54G,EAAMO,IAAO,KAAK7K,QAAQ,GAAK,IACrD,CiBAyBksB,CAAuB5xC,KAAKgwB,MAAOQ,GAClD8f,EAAaz7B,GAAIiK,UAAU9e,KAAKgwB,MAAMiB,QACtC8f,EAAcl8B,GAAIiK,UAAU9e,KAAKgwB,MAAMkB,SACvC1S,EAAeyM,KAAMvW,SAAS1U,KAAKgwB,MAAMiB,QACzCxS,EAAgBwM,KAAMvW,SAAS1U,KAAKgwB,MAAMkB,SAChDjX,EAAuB,CAACuE,EAAa7J,aAAamI,KAAK4S,cAAejR,EAAc9J,aAAamI,KAAK4S,eAA/FykG,EAAKl6G,EAAA,GAAEm6G,EAAKn6G,EAAA,GACb4uH,EAAcj3F,GAAsBphB,EAAMlU,KAAMkU,EAAMD,KAE5D,GAAIC,EAAMC,SAcR,OAbA5b,GAAIyE,KAAK6G,EAAK2oH,eACdj0H,GAAI2E,KAAK2G,EAAK4oH,QAAS5oH,EAAK5S,OAAQ4S,EAAK6oH,WAErChpI,KAAKgwB,MAAMP,MACbtP,EAAK8oH,aAAa5pH,YAAcxK,GAAIkc,gBAAgBP,EAAMD,IAAK/R,GAC/D2B,EAAK+oH,WAAWzpH,IAAM5K,GAAI0jD,eAAev4D,KAAKgwB,MAAMiB,UAEpD9Q,EAAK8oH,aAAa5pH,YAAcxK,GAAIkc,gBAAgB83G,EAAapqH,GACjE0B,EAAK+oH,WAAWzpH,IAAM5K,GAAI0jD,eAAev4D,KAAKgwB,MAAMkB,eAGtD/Q,EAAKgpH,mBAAmB9pH,YAAcspH,GAKxC9zH,GAAIyE,KAAK6G,EAAK4oH,SACdl0H,GAAI2E,KAAK2G,EAAK2oH,eAEd3oH,EAAKwoH,aAAatpH,YAAcspH,EjBxJf,IiB0Jbn4G,EAAMG,MACRxQ,EAAKwQ,KAAKtR,YAAc9C,GtBtFN,SsBuFlB1H,GAAIyE,KACF6G,EAAKipH,aACLjpH,EAAKkpH,eACLlpH,EAAKmpH,cACLnpH,EAAKopH,iBAEP10H,GAAI2E,KACF2G,EAAKqpH,aACLrpH,EAAKspH,eACLtpH,EAAKupH,cACLvpH,EAAKwpH,mBAGPxpH,EAAKwQ,KAAKtR,YAAc9C,GtBrGN,SsBsGlB1H,GAAI2E,KACF2G,EAAKipH,aACLjpH,EAAKkpH,eACLlpH,EAAKmpH,cACLnpH,EAAKopH,iBAEP10H,GAAIyE,KACF6G,EAAKqpH,aACLrpH,EAAKspH,eACLtpH,EAAKupH,cACLvpH,EAAKwpH,kBjBpLQ,IiBwLZn5G,EAAMG,MAA4B3wB,KAAKgwB,MAAMP,MjBvLjC,IiBwLVe,EAAMG,OAA6B3wB,KAAKgwB,MAAMP,MACnDtP,EAAKypH,eAAevqH,YAAc80G,EAClCh0G,EAAK0pH,eAAexqH,YAAc+0G,EAClCj0G,EAAK2pH,iBAAiBzqH,YAAc+0G,EACpCj0G,EAAK4pH,iBAAiB1qH,YAAc80G,IAEpCh0G,EAAKypH,eAAevqH,YAAc+0G,EAClCj0G,EAAK0pH,eAAexqH,YAAc80G,EAClCh0G,EAAK2pH,iBAAiBzqH,YAAc80G,EACpCh0G,EAAK4pH,iBAAiB1qH,YAAc+0G,GAGtC,IAAM93G,EAAO2O,KAAM+F,iBAAiBhxB,KAAKgwB,MAAMiB,OAAQjxB,KAAKgwB,MAAMkB,QAASV,EAAMlU,MACjF6D,EAAK7D,KAAK+C,YAAc,GAAHtT,OAAMuQ,EAAI,KAAAvQ,OAAIooH,EAAK,KAAApoH,OAAIqoH,GAExCp0H,KAAKgwB,MAAMP,MACbtP,EAAK6pH,YAAY3qH,YAAcixB,EAC/BnwB,EAAK8pH,WAAW5qH,YAAcxK,GAAIkc,gBAAgBP,EAAMD,IAAK/R,GAC7D2B,EAAK+pH,SAAS7qH,YAAcxK,GAAIkc,gBAAgB83G,EAAapqH,GAC7D0B,EAAKgqH,SAAS1qH,IAAM5K,GAAI0jD,eAAev4D,KAAKgwB,MAAMiB,QAClD9Q,EAAKiqH,OAAO3qH,IAAM5K,GAAI0jD,eAAev4D,KAAKgwB,MAAMkB,WAEhD/Q,EAAK6pH,YAAY3qH,YAAc0xB,EAC/B5wB,EAAK8pH,WAAW5qH,YAAcxK,GAAIkc,gBAAgB83G,EAAapqH,GAC/D0B,EAAK+pH,SAAS7qH,YAAcxK,GAAIkc,gBAAgBP,EAAMD,IAAK/R,GAC3D2B,EAAKgqH,SAAS1qH,IAAM5K,GAAI0jD,eAAev4D,KAAKgwB,MAAMkB,SAClD/Q,EAAKiqH,OAAO3qH,IAAM5K,GAAI0jD,eAAev4D,KAAKgwB,MAAMiB,QAEpD,GAEA,CAAAtzB,IAAA,8BAAAE,MAIA,SAA6BwqI,EAAwB3nH,GACnD,IAAIA,EAAE+P,SAAN,CAEA,IAAMtQ,EAAOtL,GAAI6W,cAAc28G,GAC/BloH,EAAK5S,OAAO8R,YjB7FT,SAA4BqB,GACjC,GAAIA,EAAE2pH,QAGJ,OAAI3pH,EAAEwP,OACAxP,EAAEqsC,OAAet7B,GAAmBlV,GAvIzB,IA0IXmE,EAAEiQ,KAAuBc,GAAmBlV,GAE5CmE,EAAE4pH,cAAsB74G,GLlFY,+BKmFjCA,GAAmBlV,GAExBmE,EAAEusC,OACGx7B,GLxF2B,yBK0FhC/Q,EAAEqsC,OACGt7B,GAAmBlV,GAErBkV,GL1F6B,yBK6FtC,OAAQ/Q,EAAEnT,QACR,KAjKwB,EAkKtB,OAAOgP,GLzGgC,8BK0GzC,KAlKyB,EAmKvB,OAAOA,GL1GkC,gCK2G3C,KAnKyB,EAoKvB,OAAOA,GL3GkC,gCK4G3C,KApKyB,EAqKvB,OAhKe,IAgKXmE,EAAEiQ,KACGpU,GAAUA,GAEZA,GL/GiC,+BKgH1C,KAxKyB,EAyKvB,OAAOA,GAAUA,GACnB,KAzK0B,EA0KxB,OAAOA,GAAUA,GAErB,OAAOA,GAAUA,EACnB,CiBqD8Bq1B,CAA4BlxB,GAEtD,IAAM6pH,EAAc,SAACC,EAAwB90C,EAAuB+0C,GAClE,IAAKA,EAGH,OAFA51H,GAAI2E,KAAKk8E,QACT7gF,GAAIyE,KAAKkxH,GAGX90C,EAASr2E,YAAcosB,GAAag/F,EAAKC,UACzCh1C,EAASn3E,QAAQ6tB,aAAeq+F,EAAKC,SACrC/+F,GAAY8+F,EAAK1sH,QAAS23E,GAC1B7gF,GAAIyE,KAAKo8E,GACT7gF,GAAI2E,KAAKgxH,EACX,EAMA,GAJAD,EAAYpqH,EAAKwqH,iBAAkBxqH,EAAKyqH,cAAeA,GAAclqH,IACrE6pH,EAAYpqH,EAAK0qH,iBAAkB1qH,EAAK2qH,cAAeA,GAAcpqH,IACrE6pH,EAAYpqH,EAAK4qH,mBAAoB5qH,EAAK6qH,gBAAiBA,GAAgBtqH,IAC3E6pH,EAAYpqH,EAAK8qH,mBAAoB9qH,EAAK+qH,gBAAiBA,GAAgBxqH,IACtEA,EAAEusC,OAiBL9sC,EAAKgrH,WAAW9rH,YAAcosB,GAAa/qB,EAAEusC,OAAOy9E,UACpDvqH,EAAKgrH,WAAW5sH,QAAQ6tB,aAAe1rB,EAAEusC,OAAOy9E,SAChD/+F,GAAYjrB,EAAEusC,OAAOlvC,QAASoC,EAAKgrH,YACnCt2H,GAAIyE,KAAK6G,EAAKgrH,YACdt2H,GAAI2E,KAAK2G,EAAKirH,mBArBD,CAEb,IAAInpC,EAxQc,KjBqBH,IiBoPXvhF,EAAEiQ,OAA0BsxE,EAAWqlC,IAC3C,IAAM+D,EAAc,IAAIzgI,KAAK8V,EAAEulC,MAAQg8C,GACvC,GAAIr3F,KAAKsY,MAAQmoH,EAAYvgI,UAAWqV,EAAKirH,cAAc/rH,YAAc9C,GtB5K7C,uBsB6KvB,CACH,IAAM+uH,EAAiBD,EAAY5pC,mBAAmB5sF,GAAIzB,YAAa,CACrEkvB,KAAM,UACNkmG,MAAO,QACPC,IAAK,YAEPtoH,EAAKirH,cAAc/rH,YAAc9C,GtBlLE,2BsBkL0C,CAAEgvH,gBAAiBD,GAClG,CACAz2H,GAAI2E,KAAK2G,EAAKgrH,YACdt2H,GAAIyE,KAAK6G,EAAKirH,cAChB,CAQA,GjBjRyB,IiBiRrB1qH,EAAEnT,QAAuCmT,EAAE2pH,SAAY3pH,EAAEusC,OAKtD,GjBrRkB,IiBqRdvsC,EAAEnT,QAAuCmT,EAAE2pH,SAAY3pH,EAAEusC,QA8OxE,SAAkCvsC,GAChC,OAAOA,EAAEnT,OjBjgBmB,GAGT,IiB8f2BmT,EAAEiQ,MAA4BjQ,EAAEnT,QjBngBnD,CiBogB7B,CA3Oei+H,CAAwB9qH,IAAOA,EAAE2pH,SAAY3pH,EAAEusC,QAiP9D,SAAkCvsC,GAChC,OAAOA,EAAEnT,OjBzgBmB,GAIT,IiBqgB2BmT,EAAEiQ,MAA4BjQ,EAAEnT,QjB1gBnD,CiB2gB7B,CA/Oek+H,CAAwB/qH,IAAOA,EAAE2pH,SAAY3pH,EAAEusC,OAKxDp4C,GAAI2E,KAAK2G,EAAKurH,aAAcvrH,EAAKwrH,aAAcxrH,EAAKyrH,eAAgBzrH,EAAK0rH,iBAJzE1rH,EAAK0rH,eAAexsH,YAAcysH,GAAmBprH,EAAEqsC,QACvDl4C,GAAI2E,KAAK2G,EAAKurH,aAAcvrH,EAAKwrH,aAAcxrH,EAAKyrH,gBACpD/2H,GAAIyE,KAAK6G,EAAK0rH,kBANd1rH,EAAKyrH,eAAevsH,YAAcysH,GAAmBprH,EAAEqsC,QACvDl4C,GAAI2E,KAAK2G,EAAKurH,aAAcvrH,EAAKwrH,aAAcxrH,EAAK0rH,gBACpDh3H,GAAIyE,KAAK6G,EAAKyrH,qBAR4D,CAC1E,IAAM1rG,EAAI4qG,GAAcpqH,GACxBP,EAAKwrH,aAAatsH,YAAcysH,GAAmB5rG,GACnDrrB,GAAI2E,KAAK2G,EAAKurH,aAAcvrH,EAAKyrH,eAAgBzrH,EAAK0rH,gBACtDh3H,GAAIyE,KAAK6G,EAAKwrH,aAChB,KAVqE,CACnE,IAAMzrG,EAAI0qG,GAAclqH,GACxBP,EAAKurH,aAAarsH,YAAcysH,GAAmB5rG,GACnDrrB,GAAI2E,KAAK2G,EAAKwrH,aAAcxrH,EAAKyrH,eAAgBzrH,EAAK0rH,gBACtDh3H,GAAIyE,KAAK6G,EAAKurH,aAChB,CAiBA,GAAKhrH,EAAE2pH,QAaA,CAOLx1H,GAAIqf,OAAO02G,GAAclqH,GAAIP,EAAK4rH,WAClCl3H,GAAIqf,OAAO42G,GAAcpqH,GAAIP,EAAK6rH,WAClC,IAAMC,EAAoB,IAAIrhI,KAAK8V,EAAEulC,MAAQqhF,IACvC4E,EAAuBthI,KAAKsY,MAAQ+oH,EAAkBnhI,UAW5D+J,GAAIqf,OAAO82G,GAAgBtqH,IAAOoqH,GAAcpqH,IAAMA,EAAEwP,SAAWxP,EAAEusC,SAAWi/E,EAAuB/rH,EAAKgsH,aAG5Gt3H,GAAIqf,OAAOg3G,GAAgBxqH,IAAOsqH,GAAgBtqH,IAAMA,EAAEwP,SAAWxP,EAAEusC,OAAS9sC,EAAKisH,aAIrF,IAAIC,EAAkBr+G,QAAQ88G,GAAcpqH,IjBzU7B,IiB0UXA,EAAEiQ,OAKJ07G,EAAkBr+G,QAAQ48G,GAAclqH,IAKpCoqH,GAAcpqH,KAChB2rH,EAAkBA,GAAmBH,IAGzCr3H,GAAIqf,OAAOxT,EAAEusC,QAAWvsC,EAAEwP,SAAWxP,EAAEqsC,SAAWrsC,EAAE4pH,eAAiB+B,EAAkBlsH,EAAK8sC,OAC9F,MApDEp4C,GAAIqf,OAAO02G,GAAclqH,IAAMA,EAAEwP,OAAQ/P,EAAK4rH,WAC9Cl3H,GAAIqf,OAAO42G,GAAcpqH,IAAMA,EAAEwP,OAAQ/P,EAAK6rH,WAC9Cn3H,GAAIqf,OAAO82G,GAAgBtqH,IAAMA,EAAEwP,OAAQ/P,EAAKgsH,aAGhDt3H,GAAIqf,OAAOg3G,GAAgBxqH,IAAMA,EAAEwP,OAAQ/P,EAAKisH,aAEhDv3H,GAAIqf,OAAOxT,EAAEusC,OAAQ9sC,EAAK8sC,OAhFN,CA8HxB,GAEA,CAAAtvD,IAAA,kBAAAE,MAGA,SAAiB2yB,GACf,IAAMrF,EAAOnrB,KAAKmrB,KACZk9G,EAAYl9G,EAAKw8G,cAAcl8G,WAAU,GAC/CR,KAAM8qE,gBAAgBsyC,GACtBA,EAAU9pH,QAAQ+pH,QAAU93G,EAAM83G,QAClCtoI,KAAKssI,8BAA8BjE,EAAW73G,GAC9CxwB,KAAKusI,4BAA4BlE,EAAW73G,GAC5CrF,EAAKqhH,SAASl0H,YAAY+vH,EAC5B,GAEA,CAAA1qI,IAAA,iBAAAE,MAGA,WAAkB,IAAAqoB,EAAA,KACV8J,EAAQhwB,KAAKgwB,MACdA,GACAA,EAAMC,UACXD,EAAMC,QAAQwK,MAAK,SAAC9zB,EAAGyT,GAAC,OAAKzT,EAAEs/C,MAAQ7rC,EAAE6rC,KAAK,IAC9Cj2B,EAAMC,QAAQ1vB,SAAQ,SAACiwB,GAAK,OAAKtK,EAAKumH,gBAAgBj8G,EAAM,IAC9D,GAEA,CAAA7yB,IAAA,aAAAE,MACA,WACE,IAAMmyB,EAAQhwB,KAAKgwB,MACb7E,EAAOnrB,KAAKmrB,KACZy8B,EAAY53B,EAAMO,IAAMP,EAAMM,OAC9BrR,EAAQ2yB,GAAsB5hB,GAAS/E,KAAMoW,OAAOrR,EAAMkB,SAAWjG,KAAMoW,OAAOrR,EAAMiB,QAC9F9F,EAAKmwG,aAAaj8G,YAAcxK,GAAIkc,gBAAgB62B,EAAW3oC,EAAMvK,UACrEyW,EAAKowG,WAAWl8G,YAAcJ,EAAMvK,SAASC,aAAamI,KAAKwC,cAC/Dtf,KAAKqkF,SAASl5D,EAAK4zF,WACrB,GAEA,CAAAphH,IAAA,WAAAE,OAAA29E,EAAA/yE,EAAAzL,IAAAA,MACA,SAAA2mB,EAAgBijC,GAAiB,IAAAz7B,EAAAoQ,EAAA,OAAAv+B,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAM8B,OAL7DtC,KAAK4gD,YAAcgG,EACbz7B,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK4zF,WAAY5zF,EAAK8uF,gBAC/BrzD,EAAKrsC,MAAMvE,MAAQ,UACnBnB,GAAIyE,KAAK6R,EAAK8xB,MAAO2J,GACfrrB,GAASpQ,EAAK8xB,MAAMvmC,YAAckwC,EAAKlwC,aAAe,EAACkN,EAAAthB,KAAA,EACvDuS,GAAIyF,QAtZU,KAsZe,SAAA60C,GACjCvI,EAAKrsC,MAAMvE,MAAQ,GAAHjK,QAAO,EAAIojD,GAAY5zB,EAAK,KAC9C,GAAG,eAAc,OACjBqrB,EAAKrsC,MAAMvE,MAAQ,MAAK,wBAAA4N,EAAA5e,OAAA,GAAA2e,EAAA,UACzB,SAAA3b,GAAA,OAAAwzE,EAAA5yE,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,OAAA+5G,EAAAnvG,EAAAzL,IAAAA,MACA,SAAA6mB,IAAA,IAAAsH,EAAA6E,EAAA4sB,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAO+C,OALvC6oB,EAAOnrB,KAAKmrB,KACZ6E,EAAQhwB,KAAKgwB,MACb4sB,EAAM,CACVqrB,QAASj4C,EAAM/a,IAEXqpC,EAASrzB,KAAMuzB,QAAQrzB,EAAK4zF,YAAWj7F,EAAAxhB,KAAA,EAC3BuL,EAAS,cAAe+uC,GAAI,OACtC,GADFxzC,EAAG0a,EAAAhiB,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF0a,EAAAxhB,KAAA,gBAAAwhB,EAAA7hB,OAAA,kBAC7BkpB,EAAK5d,OAAO8R,YAAc9C,GAAUA,GACpC1H,GAAI2E,KAAK2R,EAAK8xB,OACdjtB,EAAMK,YAAa,EAAI,yBAAAvM,EAAA9e,OAAA,GAAA6e,EAAA,UACxB,kBAAA+zF,EAAAhvG,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,2BAAAE,MAIA,WACE,IAAMmyB,EAAQhwB,KAAKgwB,MACnB,GAAKA,EAAL,CACA,IAAM7E,EAAOnrB,KAAKmrB,KAClBtW,GAAIqf,OAAOjJ,KAAMioG,mBAAmBljG,GAAQ7E,EAAK8nG,eAAgB9nG,EAAKuhH,aAFpD,CAGpB,GAEA,CAAA/uI,IAAA,qBAAAE,OAAA2pI,EAAA/+H,EAAAzL,IAAAA,MACA,SAAAopB,IAAA,IAAAk4B,EAAA,OAAAthD,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OACQg8C,EAASrzB,KAAMuzB,QAAQx+C,KAAKmrB,KAAK8nG,gBACvCjzH,KAAKg6G,oBAAoB7uC,QAAQnrE,KAAKgwB,OACtCsuB,IACAt+C,KAAKqkF,SAASrkF,KAAKmrB,KAAK8uF,gBAAe,wBAAA3zF,EAAAthB,OAAA,GAAAohB,EAAA,UACxC,kBAAAohH,EAAA5+H,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,kBAAAE,MAIA,SAAiBuyD,GACf,IAAMjlC,EAAOnrB,KAAKmrB,KACZ6E,EAAQogC,EAAKpgC,MACnB,GAAIA,EAAM/a,KAAOjV,KAAKioE,QAAtB,CACAjoE,KAAKgwB,MAAQA,EACb,IAAMggD,EAAO7kD,EAAK6nG,WACdhjD,GAAQhgD,EAAMziB,OjBzcM,GiByc2BsH,GAAI2E,KAAKw2D,GAC5D7kD,EAAK5d,OAAO8R,YAAcuyB,GAAuB5hB,GAAM,IACpB3a,EADoBC,EAAAjK,GACvC2kB,EAAMC,SAAW,IAAE,IAAnC,IAAA3a,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAqC,KAA1Bgf,EAACrL,EAAAxX,MAAyBmC,KAAK2sI,aAAajsH,EAAC,CAAC,OAAAhiB,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACzD7L,KAAKmoI,0BANgC,CAOvC,GAEA,CAAAxqI,IAAA,kBAAAE,MACA,SAAiBuyD,GACXA,EAAK6X,UAAYjoE,KAAKioE,UAC1BjoE,KAAK2sI,aAAav8E,EAAK5/B,OACvBxwB,KAAKmoI,2BACP,GAEA,CAAAxqI,IAAA,eAAAE,MAIA,SAAc6iB,GACZ,IACsE5F,EADlEiwF,EAA2B,KAAIhwF,EAAA1P,GACjBwJ,GAAImG,cAAchb,KAAKmrB,KAAKqhH,SAAU,gBAAc,IAAtE,IAAAzxH,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAwE,KAA7DylC,EAAGrsB,EAAAjd,MACZ,GAAIspC,EAAI5oB,QAAQ+pH,UAAY5nH,EAAE4nH,QAAS,CACrCv9B,EAAO5jE,EACP,KACF,CACF,CAAC,OAAAzoC,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CACGk/F,EACF/qG,KAAKusI,4BAA4BxhC,EAAMrqF,GAEvC1gB,KAAKysI,gBAAgB/rH,EAEzB,KAAC6mH,CAAA,CAte2B,CAAS38G,IA6evC,SAASkhH,GAAoBrB,GAC3B,OAAKA,EAAKjhB,OAAiC,IAAxBihB,EAAKjhB,MAAM9hE,SACvB,GAAP37C,OAAU0+H,EAAKjhB,MAAMxoG,MAAK,OAAAjV,OAAM0+H,EAAKjhB,MAAM9hE,SAAQ,KAAA37C,OAAIwQ,GtB/ZzB,kBsB8ZuB,EAEvD,CAGA,SAASquH,GAAelqH,GACtB,OjBvemB,IiBueXA,EAAEiQ,KAA4BjQ,EAAEosC,KAAOpsC,EAAEksH,WACnD,CAGA,SAAS9B,GAAepqH,GACtB,OjB5emB,IiB4eXA,EAAEiQ,KAA4BjQ,EAAEksH,YAAclsH,EAAEosC,IAC1D,CAGA,SAASk+E,GAAiBtqH,GACxB,OjBjfmB,IiBifXA,EAAEiQ,KAA4BjQ,EAAEqsC,OAASrsC,EAAE4pH,aACrD,CAGA,SAASY,GAAiBxqH,GACxB,OjBtfmB,IiBsfXA,EAAEiQ,KAA4BjQ,EAAE4pH,cAAgB5pH,EAAEqsC,MAC5D,CC9hBe,SAAS8/E,KActB,OAZEA,GADqB,oBAAZC,SAA2BA,QAAQhmI,IACrCgmI,QAAQhmI,IAAIqD,OAEZ,SAAcX,EAAQujI,EAAUC,GACrC,IAAIx7G,ECLK,SAAwB/sB,EAAQsoI,GAC7C,MAAQ1vI,OAAOC,UAAUE,eAAemC,KAAK8E,EAAQsoI,IAEpC,QADftoI,EAAS,EAAeA,MAG1B,OAAOA,CACT,CDDiB,CAAc+E,EAAQujI,GACjC,GAAKv7G,EAAL,CACA,IAAI5zB,EAAOP,OAAO4vI,yBAAyBz7G,EAAMu7G,GACjD,OAAInvI,EAAKkJ,IACAlJ,EAAKkJ,IAAInH,KAAKgJ,UAAUpF,OAAS,EAAIiG,EAASwjI,GAEhDpvI,EAAKC,KALK,CAMnB,EAEKgvI,GAAKjkI,MAAM5I,KAAM2I,UAC1B,spDEoEA,SAASukI,GAAqBrhI,GAC5B,IAIIwiB,EAJJ8+G,EAAuGthI,EAA/FgkC,IAAcu9F,EAAQD,EAAfp9F,MAAsBs9F,EAAMF,EAAXvwF,IAAG0wF,EAAoEzhI,EAAxDqkC,IAAcq9F,EAAQD,EAAfv9F,MAAsBy9F,EAAMF,EAAX1wF,IAAeE,EAAiBjxC,EAAjBixC,aAElF2wF,EAAcx6H,KAAKoB,IAAIk5H,EAAUC,GACjCE,EAAcz6H,KAAKoB,IAAI+4H,EAAUC,GAErC,GAAIxhI,EAAE8wC,qBAGJ,GAAI4wF,EAAWC,EAAQ,CAGrB,IAAMG,EAAWN,EAASD,EAE1B,GADkBG,EAAWC,EACbG,EAEd,MAAMnsI,MAAM,oEAEdisI,GAAeE,EAAW7wF,CAC5B,KAAO,CAGL,IAAM8wF,EAAWJ,EAASD,EAE1B,GADkBH,EAAWC,EACbO,EACd,MAAMpsI,MAAM,oEAEdksI,GAAeE,EAAW9wF,CAC5B,MACK,GAAIjxC,EAAE6wC,mBAGX,GAAII,EAAe,EAAG,CACpB,IAAM+wF,EAAYN,EAAWC,EACvBM,EAAYV,EAAWC,EAE7Bh/G,EArEG,CACLtY,KAAM,CACJ85B,IAAK,EACLK,IAAK,GAEPl6B,MAAO,CACL65B,IAAK,EACLK,IAAK,GAEP69F,SAAU,EACVC,SAAU,GA6DJF,EAAYhxF,GAAgB+wF,EAAY/wF,GAE1CzuB,EAAOtY,KAAK85B,IAAMiN,EAAeuwF,EACjCh/G,EAAOtY,KAAKm6B,IAAMs9F,EAClBn/G,EAAOrY,MAAM65B,IAAMw9F,EACnBh/G,EAAOrY,MAAMk6B,IAAM4M,EAAe0wF,GACzBK,EAAY/wF,GAAgBgxF,EAAYhxF,GAGjDzuB,EAAOtY,KAAK85B,IAAMiN,EAAe+wF,EAAYR,EAC7Ch/G,EAAOtY,KAAKm6B,IAAM29F,EAAYL,EAC9Bn/G,EAAOrY,MAAM65B,IAAMi+F,EAAYT,EAC/Bh/G,EAAOrY,MAAMk6B,IAAM4M,EAAegxF,EAAYN,GACrCK,EAAY/wF,GAGrBzuB,EAAOtY,KAAK85B,IAAMw9F,EAClBh/G,EAAOtY,KAAKm6B,IAAM4M,EAAe0wF,EACjCn/G,EAAOrY,MAAM65B,IAAMi+F,EAAYT,EAC/Bh/G,EAAOrY,MAAMk6B,IAAM4M,EAAegxF,EAAYN,IAI9Cn/G,EAAOtY,KAAK85B,IAAMiN,EAAe+wF,EAAYR,EAC7Ch/G,EAAOtY,KAAKm6B,IAAM29F,EAAYL,EAC9Bn/G,EAAOrY,MAAM65B,IAAMiN,EAAeuwF,EAClCh/G,EAAOrY,MAAMk6B,IAAMs9F,GAGrBn/G,EAAO0/G,SAAW1/G,EAAOrY,MAAM65B,IAAMxhB,EAAOtY,KAAK85B,IACjDxhB,EAAO2/G,SAAW3/G,EAAOrY,MAAMk6B,IAAM7hB,EAAOtY,KAAKm6B,IACjDu9F,EAAcp/G,EAAOtY,KAAKm6B,IAAO7hB,EAAO2/G,SAAW,EACnDN,EAAcr/G,EAAOtY,KAAK85B,IAAOxhB,EAAO0/G,SAAW,CACrD,OAEIX,EAAWC,EACbI,EAAcx6H,KAAKoB,IAAIk5H,EAAUC,EAAS1wF,GAAgBuwF,EAASD,IAC1DG,EAAWC,EACpBE,EAAcz6H,KAAKoB,IAAI+4H,EAAUC,EAASvwF,GAAgB0wF,EAASD,KAEnEE,EAAcx6H,KAAKoB,IAAIk5H,EAAUC,EAAS1wF,GAC1C4wF,EAAcz6H,KAAKoB,IAAI+4H,EAAUI,EAASH,EAASvwF,EAAe2wF,IAGtE,MAAO,CAACA,EAAaC,EAAar/G,EACpC,CAAC,IASoB4/G,GAAe,SAAA93D,GAAA/rE,EAAA6jI,EAAA93D,GAAA,IAuMjC+3D,EA5CAC,EAnCAC,EALAC,EAPAC,EAzCAC,EAnEiC7mH,EAAA0E,GAAA6hH,GAalC,SAAAA,EAAa11B,GAAmB,IAAAp/F,EAAAtQ,EAAA,KAAAolI,GACvBnkI,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,mCAAArP,EAAAC,EAAAoP,GAAA,sBAEPA,EAAK00B,KAAO,CAAC,EACb10B,EAAKq1H,WAAa,GAClBr1H,EAAKk/B,MAAQ,CAAC,EAEd,IAAMltB,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAck7D,GAE3C1jG,GAAIuyB,eAAejc,EAAKsjH,QAAStjH,EAAKujH,WAAYvjH,EAAKwjH,iBAEvDx1H,EAAK8jC,MAAQ,IAAI2R,GAAMzjC,EAAK8xB,OAC5B9jC,EAAKy1H,cAAgB,IAAIh7D,GAAqBzoD,EAAKyjH,eAAe,SAAC5gG,EAAiBshB,GAAgB,OAAKn2C,EAAK01H,cAAc7gG,EAASshB,EAAQ,IAC7In2C,EAAKqiG,yBAA2B,CAC9Bp+D,gBAAiBjyB,EAAKiyB,gBACtBE,mBAAoBnyB,EAAKmyB,mBACzBC,iBAAkBpyB,EAAKoyB,iBACvBC,oBAAqBryB,EAAKqyB,qBAE5B3oC,GAAIuyB,eAAejc,EAAKmyB,mBAAoBnyB,EAAKoyB,iBAAkBpyB,EAAKqyB,qBAExE3oC,GAAI1K,KAAKghB,EAAK2jH,OAAQ,SAAS,WAAQ31H,EAAK21H,QAAS,IACrDj6H,GAAI1K,KAAKghB,EAAK4jH,gBAAiB,SAAS,WAAQ9jH,KAAM2yB,SAAS,aAAc,IAC7E/oC,GAAI1K,KAAKghB,EAAK6jH,wBAAyB,SAAS,WAAQ71H,EAAK81H,WAAY,IAEzE91H,EAAK+1H,UAAYhjI,OAAOijI,YAnLH,IAoLV,IAAIv7G,gBAAe,WAAQza,EAAKsf,SAAU,IAClD3E,QAAQykF,GAEX,IAFgB,IAAAtlD,EAAA,WAEX,IAAA/E,EAAAtmD,EAAA0V,EAAAzV,GAAA,GAAOmmC,EAAOkgB,EAAA,GAAE5c,EAAK4c,EAAA,GAClB2Q,EAAK1zC,EAAKwjH,gBAAgBljH,WAAU,GAC1CN,EAAKikH,QAAQ92H,YAAYumD,GACzB,IAAM1+C,EAAOtL,GAAI6W,cAAcmzC,GACzBwwE,EAAY,WAChBl2H,EAAKy1H,cAAcU,OAAOthG,GAC1B70B,EAAK8jC,MAAM3jC,KAAK6R,EAAKyjH,cACvB,EACA/5H,GAAI1K,KAAKgW,EAAKovH,cAAe,QAASF,GACtCx6H,GAAI1K,KAAKgW,EAAKqvH,aAAc,QAASH,GACrCx6H,GAAI1K,KAAKgW,EAAKsvH,iBAAkB,QAASJ,GACzC,IAAM/nF,EAAMnuC,EAAKk/B,MAAMrK,GAAW,CAAE6wB,GAAAA,EAAI1+C,KAAAA,EAAMmxB,MAAAA,EAAOtD,QAAAA,GACrD70B,EAAKu2H,aAAapoF,EACpB,EAbAz/C,EAAA,EAAAyV,EAA+BjgB,OAAOkgB,QAAQsvB,IAAgBhlC,EAAAyV,EAAA/Z,OAAAsE,IAAAorD,IAelD,OAAZ95C,EAAKw2H,QAAOx2H,CACd,CAgMC,OAhMAxP,EAAAskI,EAAA,EAAAtwI,IAAA,UAAAE,MAED,WACE,IAAM+xI,EAAe1jI,OAAOijI,YAAc,IAC1C,GAAIS,IAAiB5vI,KAAKkvI,UAAW,CACnClvI,KAAKkvI,UAAYU,EACjB5vI,KAAK6vI,gBAAe,IACiB1kI,EADjBC,EAAAC,GACErL,KAAKwuI,YAAU,IAArC,IAAApjI,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAuC,KAA1BylC,EAAGh8B,EAAAtN,MAAHspC,IAA0BnnC,KAAK8vI,aAAa3oG,EAAG,CAAC,OAAAzoC,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CAC/D,CACF,GAAC,CAAAlO,IAAA,QAAAE,OAAA0wI,EAAA9lI,EAAAzL,IAAAA,MAED,SAAA8P,IAAA,IAAAqe,EAAAyiB,EAAAmiG,EAAAC,EAAAxB,EAAAl5H,EAAAD,EAAAy4B,EAAA5nB,EAAA,YAAAlpB,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAwBiC,GAvBzB6oB,EAAOnrB,KAAKmrB,KACZyiB,EAAW3iB,KAAM2iB,SAEjBmiG,EAAaniG,EAASC,KAAK0jB,KAAI,SAAChmD,GAAc,OAAKA,EAAEkiC,MAAM,IACjExiB,KAAMilC,mBAAmB,CACvB4yD,SAAU,SAAC1yD,GAAyBlqC,EAAK+pH,mBAAmB7/E,EAAM,EAClEgzD,SAAU,SAAChzD,GACT,IAAM8/E,EAAMhqH,EAAK2nB,KAAKuG,GAAegc,EAAK9oB,KAAM8oB,EAAKn/B,OAAQm/B,EAAKl/B,UAClE,GAAIg/G,EAAK,OAAOA,EAAIC,gBACtB,EACAntB,YAAa,SAAC5yD,GACZ,IAAM8/E,EAAMhqH,EAAK2nB,KAAKuG,GAAegc,EAAK9oB,KAAM8oB,EAAKn/B,OAAQm/B,EAAKl/B,UAC9Dg/G,GAAKA,EAAIjtB,sBAAsB7yD,EACrC,EACA8yD,YAAa,SAAC9yD,GACZ,IAAM8/E,EAAMhqH,EAAK2nB,KAAKuG,GAAegc,EAAK9oB,KAAM8oB,EAAKn/B,OAAQm/B,EAAKl/B,UAC9Dg/G,GAAKA,EAAI/sB,sBAAsB/yD,EACrC,EACAggF,QAAS,SAAChgF,GAA4BlqC,EAAKmqH,cAAcjgF,EAAM,IAI3D4/E,GAAUD,GAAoC,IAAtBA,EAAWxsI,OACzCsR,GAAIqf,OAAO87G,EAAQ7kH,EAAK6kH,SACpBA,EAAQ,CAAF9iI,EAAA5K,KAAA,eAAA4K,EAAAjL,OAAA,iBACVkpB,EAAK6kH,OAAO/2H,SAENu1H,EAAa9mI,EAAIkmC,EAASC,MAAMpT,MAAK,SAAC9zB,EAAgByT,GAAmB,IAAAk2H,EAAAC,EAAAC,EAAAC,EAC7E,OAAI9pI,EAAE2e,UAAYlL,EAAEkL,SAAiB,EACjClL,EAAEkL,UAAY3e,EAAE2e,QAAgB,EAG/B3e,EAAE2e,SAAYlL,EAAEkL,SAEQ,QAAtBgrH,EAAW,QAAXC,EAACn2H,EAAE2zB,gBAAQ,IAAAwiG,OAAA,EAAVA,EAAY7iG,iBAAS,IAAA4iG,EAAAA,EAAI,IAA2B,QAA1BE,EAAe,QAAfC,EAAK9pI,EAAEonC,gBAAQ,IAAA0iG,OAAA,EAAVA,EAAY/iG,iBAAS,IAAA8iG,EAAAA,EAAI,GAF1B7pI,EAAE8mC,OAAOxc,OAAStqB,EAAE8mC,OAAOvc,SAAY9W,EAAEqzB,OAAOxc,OAAS7W,EAAEqzB,OAAOvc,QAG1G,IAAE5b,EAAAjK,GAEsBmjI,GAAU,IAAlC,IAAAl5H,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAWosC,EAASz4B,EAAAxX,MAAgBmC,KAAK0wI,OAAO5iG,EAAU,OAAApvC,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,0BAAAqB,EAAAlI,OAAA,GAAA8H,EAAA,UAC3D,kBAAAyhI,EAAA3lI,MAAA,KAAAD,UAAA,KAAAhL,IAAA,gBAAAE,OAAAywI,EAAA7lI,EAAAzL,IAAAA,MAED,SAAAiR,EAAqBzH,GAAkB,OAAAxJ,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAAA6L,EAAAT,GAC7BlH,EAAEisD,MAAKtkD,EAAA7L,KACR,kBADQ6L,EAAAT,GACO,wBAAAS,EAAAlM,OAAA,SACXjC,KAAK2wI,uBAAuBnqI,EAAEwnC,UAAuB,wBAAA7/B,EAAAnJ,OAAA,GAAAiJ,EAAA,UAEjE,SAAAjG,GAAA,OAAAsmI,EAAA1lI,MAAA,KAAAD,UAAA,KAAAhL,IAAA,yBAAAE,OAAAwwI,EAAA5lI,EAAAzL,IAAAA,MAED,SAAAuR,EAA8By/B,GAAe,IAAAkU,EAAA,OAAAllD,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,QACrC4/C,EAASliD,KAAKq4C,MAAMrK,KACdhuC,KAAK0vI,aAAaxtF,GAAO,wBAAA1zC,EAAAxJ,OAAA,GAAAuJ,EAAA,UACtC,SAAA5B,GAAA,OAAA0hI,EAAAzlI,MAAA,KAAAD,UAAA,KAAAhL,IAAA,qBAAAE,OAAAuwI,EAAA3lI,EAAAzL,IAAAA,MAED,SAAA2mB,EAA0BysC,GAAkB,IAAAn/B,EAAAC,EAAAoW,EAAA4oG,EAAA,OAAAlzI,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAEkB,GADpD2uB,EAA0Bm/B,EAA1Bn/B,OAAQC,EAAkBk/B,EAAlBl/B,QAASoW,EAAS8oB,EAAT9oB,OACnB4oG,EAAMlwI,KAAK6tC,KAAKuG,GAAe9M,EAAMrW,EAAQC,KAC1C,CAAFtN,EAAAthB,KAAA,eAAAshB,EAAA3hB,OAAA,SAASiuI,EAAIC,kBAAgB,OACpCnwI,KAAK0wI,OAAOzlH,KAAM6iB,UAAUxG,EAAMrW,EAAQC,IAAwB,wBAAAtN,EAAA5e,OAAA,GAAA2e,EAAA,UACnE,SAAA/W,GAAA,OAAAwhI,EAAAxlI,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,MAED,WACEgX,GAAImU,OAAO/d,SAAU,QAASjL,KAAKgvD,MACrC,GAAC,CAAArxD,IAAA,SAAAE,MAED,SAAQiwC,GAAwB,IAAAvG,EACtBpc,EAA2BnrB,KAA3BmrB,KAAM0iB,EAAqB7tC,KAArB6tC,KAAM2gG,EAAexuI,KAAfwuI,WAEpBoC,EAA8C9iG,EAAtCL,OAAUxc,EAAM2/G,EAAN3/G,OAAQC,EAAO0/G,EAAP1/G,QAASoW,EAAIspG,EAAJtpG,KACnCttB,EAAkC,CAACiR,KAAMoW,OAAOpQ,GAAQtS,OAAQsM,KAAMoW,OAAOnQ,GAASvS,QAAnEoyB,EAAW/2B,EAAA,GACxB+7B,EAAQ,GAAHhqC,OADMiO,EAAA,GACU,KAAAjO,OAAIglC,GAC/B,GAA0B,QAAtBxJ,EAACtc,KAAMuc,UAAUF,UAAK,IAAAC,GAArBA,EAAuB0O,QAAQF,GAApC,CACA,IAAMm6F,EAAM,IAAIW,GAAI7wI,KAAMA,KAAKw7G,yBAA0B1tE,GACzD3iB,EAAK2lH,QAAQx4H,YAAY43H,EAAI5oF,IAAIuX,IACjC2vE,EAAWxrI,KAAKktI,GAChBriG,EAAKqiG,EAAIj7H,IAAMi7H,EACflwI,KAAK8vI,aAAaI,EAAI/oG,IAL4B,CAMpD,GAAC,CAAAxpC,IAAA,mBAAAE,MAED,SAAkBkzI,GAChB,IAAM5lH,EAAOnrB,KAAKmrB,KAClBnrB,KAAKgxI,YAAcD,EACnBl8H,GAAI2E,KAAK2R,EAAK8lH,cACd,IAA0Cp8F,EAAmB5pB,KAAMoW,OAAO0vG,EAAI9/G,QAAtEvc,SAAYC,aAAgBmI,KACMy4B,EAAoBtqB,KAAMoW,OAAO0vG,EAAI7/G,SAAvExc,SAAYC,aAAgBmI,KACpCqO,EAAK+lH,oBAAoB7xH,YAAc9C,GzB7Gd,ayB6G4C,CAAE+qB,KAAMypG,EAAIzpG,KAAMuN,WAAAA,EAAYU,YAAAA,IACnGv1C,KAAKi9C,MAAM3jC,KAAKtZ,KAAKmrB,KAAKgmH,kBAC5B,GAAC,CAAAxzI,IAAA,YAAAE,OAAAswI,EAAA1lI,EAAAzL,IAAAA,MAED,SAAA6mB,IAAA,IAAAsH,EAAAo9D,EAAA,OAAAvrF,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OACwB,GAAhB6oB,EAAOnrB,KAAKmrB,KACbnrB,KAAKgxI,YAAa,CAAFltH,EAAAxhB,KAAA,QAAuB,OAAnBtC,KAAKi9C,MAAMmE,QAAQt9B,EAAA7hB,OAAA,wBAAA6hB,EAAAxhB,KAAA,EACzByqC,GAAGqkG,gBAAgBpxI,KAAKgxI,YAAY1pG,KAAMtnC,KAAKgxI,YAAY//G,OAAQjxB,KAAKgxI,YAAY9/G,SAAQ,OAArG,GAAJq3D,EAAIzkE,EAAAhiB,KACLmpB,KAAM6mC,cAAcy2B,GAAO,CAAFzkE,EAAAxhB,KAAA,SAED,OAD3B6oB,EAAK8lH,aAAa5xH,YAAc9C,GAAUA,EAAmB,CAAE3O,IAAK26E,EAAK36E,MACzEiH,GAAIyE,KAAK6R,EAAK8lH,cAAantH,EAAA7hB,OAAA,yBAAA6hB,EAAAxhB,KAAA,GAGvB2oB,KAAMomH,gBAAe,QAC3BpmH,KAAM2yB,SAAS,MAAK,yBAAA95B,EAAA9e,OAAA,GAAA6e,EAAA,UACrB,kBAAAsqH,EAAAvlI,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,MAED,SAAcspC,GACZ,IAAA+5B,EAAiDlhE,KAAzCmrB,KAAQmmH,EAAOpwE,EAAPowE,QAASC,EAAMrwE,EAANqwE,QAAwBvxI,KAAdkvI,YACFoC,EAAQ52H,SAASnX,OAASguI,EAAO72H,SAASnX,QAAU,GAAM,EACzDguI,EAAVD,GACpBh6E,OAAOnwB,EACb,GAAC,CAAAxpC,IAAA,gBAAAE,MAED,WAEE,IADA,IAAA2zI,EAAsCxxI,KAA9BmrB,KAAQomH,EAAMC,EAAND,OAAQD,EAAOE,EAAPF,QACjBA,EAAQ52H,SAASnX,OAAS,GAAG+tI,EAAQx5H,YAAYw5H,EAAQG,WAChE,KAAOF,EAAO72H,SAASnX,OAAS,GAAGguI,EAAOz5H,YAAYy5H,EAAOE,UAC/D,GAAC,CAAA9zI,IAAA,UAAAE,MAED,SAAS6zI,GACP,IAAQlD,EAAexuI,KAAfwuI,WACF7uG,EAAM6uG,EAAW1K,WAAU,SAACoM,GAAQ,OAAKA,EAAIj7H,KAAOy8H,CAAK,IAC/DlD,EAAW30E,OAAOl6B,EAAK,GACvB6uG,EAAWmD,QAAQ3xI,KAAK6tC,KAAK6jG,IAC7B1xI,KAAK6vI,gBAAe,IACY/0H,EADZC,EAAA1P,GACEmjI,GAAU,IAAhC,IAAAzzH,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAkC,KAArBylC,EAAGrsB,EAAAjd,MAAHspC,IAAqBnnC,KAAK8vI,aAAa3oG,EAAG,CAAC,OAAAzoC,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CACxD,IAAMs7B,EAAMnnC,KAAK6tC,KAAK6jG,GAAOvqG,IAC7BtyB,GAAIyF,QAAQ,KAAK,SAACpQ,GAChBi9B,EAAI5sB,MAAMwhD,QAAU,GAAHhwD,OAAM7B,GACvBi9B,EAAI5sB,MAAMuhD,UAAY,SAAH/vD,OAAY,GAAM,GAAM7B,EAAC,IAC9C,GACF,GAAC,CAAAvM,IAAA,SAAAE,MAED,WACEotB,KAAM2yB,SAAS,aACjB,GAAC,CAAAjgD,IAAA,gBAAAE,OAAAqwI,EAAAzlI,EAAAzL,IAAAA,MAED,SAAAopB,EAAqB4nB,EAAiBshB,GAAgB,OAAAtyD,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,cAAAgkB,EAAAhkB,KAAA,EAC9C2oB,KAAMomH,gBAAe,OAC3BrxI,KAAK0vI,aAAa1vI,KAAKq4C,MAAMrK,IACzBshB,GAAStvD,KAAKi9C,MAAMmE,QAAO,wBAAA96B,EAAAthB,OAAA,GAAAohB,EAAA,UAChC,SAAAtY,EAAAC,GAAA,OAAAmgI,EAAAtlI,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,MAED,SAAcypD,GACZ,IAAQnnC,EAAyBmnC,EAAzBnnC,KAAMmxB,EAAmBgW,EAAnBhW,MAAOtD,EAAYsZ,EAAZtZ,QACrB7tB,EAAK2sB,KAAKrtB,IAAM6xB,EAAMxE,KACtB3sB,EAAKpc,KAAKsb,YAAciyB,EAAMvtC,KAC9B,IAAMwJ,EAAS0d,KAAM2iB,SAASyK,MAAMrK,GASpC,GARAn5B,GAAIqf,QAAQ3mB,EAAQ4S,EAAKyxH,cACzB/8H,GAAIqf,OAAO3mB,IAAWA,EAAO+mE,WAAYn0D,EAAK0xH,YAC9Ch9H,GAAIqf,OAAO3mB,aAAM,EAANA,EAAQ+mE,WAAYn0D,EAAK2xH,eAChCvkI,SAAAA,EAAQ+mE,aACVn0D,EAAKm0D,WAAWj1D,YAAc,mBAC9Bc,EAAKm0D,WAAW/1D,QAAQ4G,QAAU5X,EAAO+mE,YAE3Cn0D,EAAK2sB,KAAKn0B,UAAUmN,OAAO,aAAcvY,GACpCA,EAAL,CAGA,IAFA,IAAIwkI,EAAS,EACPC,EAA2C,CAAC,EAClDr6H,EAAA,EAAAy2C,EAAgC/wD,OAAOkgB,QAAQhQ,EAAO+qC,UAAS3gC,EAAAy2C,EAAA7qD,OAAAoU,IAAE,CAA5D,IAAA02C,EAAAzmD,EAAAwmD,EAAAz2C,GAAA,GAAOsqD,EAAU5T,EAAA,GAAEgW,EAAGhW,EAAA,GACnBtwC,EAAUlL,SAASovD,GACnBgwE,EAAYp9H,GAAIq9H,aAAan0H,GACnC,IAAIi0H,EAAeC,GAAnB,CACAD,EAAeC,IAAa,EAC5B,IAAQv9H,EAAauW,KAAMoW,OAAOtjB,GAA1BrJ,SACFwqD,EAAWj0C,KAAMymB,aAAa3zB,GAChCmhD,IAAU6yE,GAAU7yE,GAAYmF,EAAIr0B,UAAYq0B,EAAIx/C,QAAUnQ,EAASC,aAAaC,iBAJjD,CAKzC,CACAuL,EAAKgyH,WAAW9yH,YAAcxK,GAAIiJ,kBAAkBi0H,EAZjC,CAarB,GAAC,CAAAp0I,IAAA,uBAAAE,MAED,SAAsBkgB,EAAiBy6B,EAAiB45F,GACtD,IAAMnzH,EAAQgM,KAAMoW,OAAOtjB,GACrBrJ,EAAWuK,EAAMvK,SACjB29H,EAAax9H,GAAIkc,gBAAiBynB,EAAU45F,EAAc,IAAK19H,GACrE,MAAO,GAAP3I,OAAU8I,GAAIiJ,kBAAkBs0H,GAAW,QAAArmI,OAAOsmI,EAAU,KAAAtmI,OAAIkT,EAAMN,OAAOW,cAC/E,GAEA,CAAA3hB,IAAA,mBAAAE,MAKA,SAAkBkgB,EAAiBq0H,GACjC,IAA6BpiG,EAAkB/kB,KAAMoW,OAAOtjB,GAApDqH,OAAUozB,QAAWxI,UAC7B,OAAOhwC,KAAKsyI,qBAAqBv0H,EAASiyB,EAAWoiG,EACvD,KAACnE,CAAA,CA1PiC,CAASrjH,IAkQvCimH,GAAG,SAAA0B,GAAAnoI,EAAAymI,EAAA0B,GAAA,IAsWN7K,EAzSA1wF,EA7DMnqB,EAAAT,GAAAykH,GAUP,SAAAA,EAAa2B,EAAqBC,EAA6CllI,GAAqB,IAAAwZ,EAAAle,EAAA,KAAAgoI,GAC9E/mI,EAAAC,EAApBgd,EAAA8F,EAAAltB,KAAA,KAAM4N,EAAOkgC,SAAO,aAAA3jC,EAAAC,EAAAgd,GAAA,cAAAjd,EAAAC,EAAAgd,GAAA,eAAAjd,EAAAC,EAAAgd,GAAA,0BAAAjd,EAAAC,EAAAgd,GAAA,0BAAAjd,EAAAC,EAAAgd,GAAA,2BAAAjd,EAAAC,EAAAgd,GAAA,cAAAjd,EAAAC,EAAAgd,GAAA,qBACpBA,EAAKyrH,GAAKA,EACV,IAAAE,EAAA3oI,EAAAgd,GAAQkK,EAAMyhH,EAANzhH,OAAQC,EAAOwhH,EAAPxhH,QAASoW,EAAIorG,EAAJprG,KAAMgL,EAAOogG,EAAPpgG,QAASoE,EAAcg8F,EAAdh8F,eAAgBC,EAAe+7F,EAAf/7F,gBAAiB3I,EAAO0kG,EAAP1kG,QACzEjnB,EAAK9R,GAAKm/B,GAAe9M,EAAMrW,EAAQC,GAEvC,IAAMiW,EAAMpgB,EAAKogB,IAAMqrG,EAAGrnH,KAAKsjH,QAAQhjH,WAAU,GAC3CN,EAAOpE,EAAKoE,KAAOtW,GAAI6W,cAAcyb,GAE3CpgB,EAAK4rH,WAAa,IAAI31F,GAA0B7xB,EAAKynH,MAAOJ,EAAGv1F,MAAOw1F,EAAmB,MAEzFtiG,GAAkBhJ,EAAKlW,EAAQC,EAASoW,GACpC0G,GAASqD,GAAelK,EAAK6G,GAE7BsE,IAAY3F,GACdxhB,EAAK0nH,eAAexzH,YAAc9C,GAAUA,IACnC+1B,IAAY1F,GACrBzhB,EAAK0nH,eAAexzH,YAAc9C,GAAUA,IACnC+1B,IAAY5F,KACrBvhB,EAAK0nH,eAAexzH,YAAc9C,GAAUA,KAG9C1H,GAAIqf,OAAOoe,IAAY1F,GAAiBzhB,EAAK2nH,mBAAoB3nH,EAAK4nH,sBAClEzgG,IAAY1F,KACd7lB,EAAKisH,gBAAkB,IAAInhG,GAAgB1mB,EAAK6nH,iBAChD7nH,EAAK8nH,kBAAkB5zH,YAAc/V,OAAOotC,GAC5CvrB,EAAK+nH,mBAAmB7zH,YAAc/V,OAAOqtC,IAG/C9hC,GAAI1K,KAAKghB,EAAKgoH,UAAW,SAAS,kBAAMpsH,EAAKjE,OAAO,IACpDjO,GAAI1K,KAAKghB,EAAKioH,eAAgB,SAAS,kBAAMrsH,EAAKssH,UAAU,IAC5Dx+H,GAAI1K,KAAKghB,EAAKmzD,gBAAiB,SAAS,kBAAMv3D,EAAKusH,aAAa,IAChEz+H,GAAI1K,KAAKghB,EAAKooH,WAAY,SAAS,kBAAMxsH,EAAKyrH,GAAGgB,iBAAiBjmI,EAAOkgC,OAAO,IAChF54B,GAAI1K,KAAKghB,EAAKsoH,qBAAsB,SAAS,kBAAM1sH,EAAK2sH,sBAAsB,IAC9E7+H,GAAI1K,KAAKghB,EAAKwoH,WAAY,SAAS,kBAAM1oH,KAAM2yB,SAAS,UAAW,CAAEtW,KAAAA,EAAMrW,OAAAA,EAAQC,QAAAA,GAAU,IAE7FnK,EAAK6sH,gBAAkB,IAAI1rH,GAAWiD,EAAKyoH,iBAAiB,WAAgC,IAC5F7sH,EAAK8sH,iBAAmB,IAAI3rH,GAAWiD,EAAK0oH,kBAAkB,WAAgC,IAE9F,IAAMh1E,EAAK2zE,EAAGrnH,KAAKujH,WAAWjjH,WAAU,GACxC0kB,GAAkB0uB,EAAI5tC,EAAQC,EAASoW,GACvC,IAAMnnB,EAAOtL,GAAI6W,cAAcmzC,GASd,OARjB93C,EAAKugC,IAAM,CAAEuX,GAAAA,EAAI1+C,KAAAA,GACjBtL,GAAI1K,KAAKgW,EAAK2zH,aAAc,SAAS,SAACloI,GACpCA,EAAE2a,kBACFQ,EAAKssH,WACLb,EAAGuB,QAAQhtH,EAAK9R,GAClB,IACAJ,GAAI1K,KAAK00D,EAAI,SAAS,kBAAM2zE,EAAGuB,QAAQhtH,EAAK9R,GAAG,IAE/C8R,EAAK83B,aAAY93B,CACnB,CAmYC,OAnYApd,EAAAknI,EAAA,EAAAlzI,IAAA,aAAAE,OAAAm5C,EAAAvuC,EAAAzL,IAAAA,MAED,SAAA+sB,IAAA,IAAAoB,EAAAmc,EAAA0G,EAAAsE,EAAAnL,EAAA6sG,EAAAz9F,EAAAQ,EAAAhB,EAAAjB,EAAAU,EAAAnD,EAAAH,EAAAC,EAAAC,EAAA6hG,EAAAC,EAAAC,EAAAtkG,EAAA7G,EAAAy/F,EAAAt/F,EAAAjJ,EAAA,OAAAljC,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,cAAA+nB,EAAA/nB,KAAA,EAAAuqI,GAAAriI,EAAAqmI,EAAAvzI,WAAA,mBAAAqC,KAAA,aAEEK,KAAK2yI,WAAW7zF,aAAa9+C,MAE3BmrB,EAGEnrB,KAHFmrB,KAAMmc,EAGJtnC,KAHIsnC,KAAM0G,EAGVhuC,KAHUguC,QAASsE,EAGnBtyC,KAHmBsyC,QAASnL,EAG5BnnC,KAH4BmnC,IAAG6sG,EAG/Bh0I,KAFFssB,IAAOiqB,EAAqBy9F,EAArBz9F,sBAAuBQ,EAAuBi9F,EAAvBj9F,wBAA2BhB,EAEvD/1C,KAFuD+1C,MACzDjB,EACE90C,KADF80C,WAAYU,EACVx1C,KADUw1C,YAA6BnD,EACvCryC,KADuBm3C,aAAgB9E,aAGvCC,IAAY1F,KACVsF,EAAkC,GAClCC,EAAmC,GACnCC,EAAS,EACTmE,GACFrE,EAAgBqE,EAAsBrE,cAAcqf,KAAI,SAACrnD,GAAC,MAAM,CAAE0oC,KAAM1oC,EAAE0oC,KAAMK,UAAW/oC,EAAEkqI,WAAY,IACzGjiG,EAAiBoE,EAAsBpE,eAAeof,KAAI,SAACrnD,GAAC,MAAM,CAAE0oC,KAAM1oC,EAAE0oC,KAAMK,UAAW/oC,EAAEkqI,WAAY,IAC3GhiG,EAASmE,EAAsBnE,QACtB2E,IACT7E,EAAgB6E,EAAwB7E,cACxCC,EAAiB4E,EAAwB5E,eAGrCD,EAAc3uC,OAAS,IAAG0wI,EAAU/hG,EAAcz0B,QAAO,SAAC5Y,EAAsB8+H,GAAoB,OAAKA,EAAK1wF,UAAYpuC,EAAKouC,UAAY0wF,EAAO9+H,CAAI,KACtJstC,EAAe5uC,OAAS,IAAG2wI,EAAW/hG,EAAe10B,QAAO,SAAC5Y,EAAsB8+H,GAAoB,OAAKA,EAAK1wF,UAAYpuC,EAAKouC,UAAY0wF,EAAO9+H,CAAI,KACzJovI,GAAWC,EACb9hG,GAAU6hG,EAAQhhG,UAAYihG,EAASjhG,WAAa,EAC3CghG,EACT7hG,EAAS6hG,EAAQhhG,UACRihG,IACT9hG,EAAS8hG,EAASjhG,YAGhBkhG,EAAe,CAAEnmG,QAASA,EAAmBsE,QAAAA,EAASD,aAAcA,EAAchmB,KAAM,CAAE+lB,OAAAA,EAAQF,cAAAA,EAAeC,eAAAA,IACvHnyC,KAAKgzI,gBAAgB/wB,UAAUkyB,IAGjCt/H,GAAIqf,OAAOoe,IAAY5F,GAAgBvhB,EAAKkpH,YACxC/hG,IAAY5F,KACRmD,EAAM5kB,KAAM2iB,SAASyK,MAAMrK,MAEzBhF,EAAM6G,EAAIoG,QAAUpG,EAAIoG,QAAQF,QAASt0C,EAC/CoT,GAAIqf,OAAO8U,aAAG,EAAHA,EAAKy/F,IAAKt9G,EAAKkpH,YACtBrrG,SAAAA,EAAKy/F,MACDA,EAAMz/F,EAAIy/F,IAChBt9G,EAAKmpH,SAASj1H,YAAcxK,GAAIiJ,kBAAkB2qH,EAAI8L,WACtDppH,EAAKqpH,OAAOn1H,YAAcxK,GAAIiJ,kBAAkBu0B,EAAeo2F,EAAIgM,OAIzE5/H,GAAIqf,OAAMtrB,MAAViM,GAAG,CAAQmZ,QAAQggB,IAAQjiC,OAAArE,EAAKmN,GAAImG,cAAcmsB,EAAK,uBAE/CgC,EAASle,KAAMuc,UAAUF,GAAM2O,QAAQF,GAAvC5M,QAENt0B,GAAIyE,KAAK6R,EAAKupH,YACRx0G,EAAI0R,GAA+BkD,EAAaU,EACtDrqB,EAAKwpH,SAASt1H,YAAcxK,GAAIiJ,kBAAkBqrB,EAAK7sB,KAAO4jB,GAC9D/U,EAAKypH,OAAOv1H,YAAcxK,GAAIiJ,kBAAkBqrB,EAAKu0D,MAAQ5oD,EAAazC,IAG5EryC,KAAK60I,gBACL70I,KAAK80I,iBACLjgI,GAAI2E,KAAK2R,EAAK4pH,WAAU,yBAAA1qH,EAAArlB,OAAA,GAAA+kB,EAAA,UACzB,kBAAAitB,EAAApuC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,iBAAAE,MAED,WACE,IAAesiB,EAAWngB,KAAlBsnD,IAAOnnC,KACf60H,EAA8Bh1I,KAAKuN,SAA3B+X,EAAO0vH,EAAP1vH,QAASyoB,EAAQinG,EAARjnG,SACjBl5B,GAAIqf,OAAO5O,EAASnF,EAAK80H,eACzBpgI,GAAIqf,QAAQ5O,EAASnF,EAAK+0H,iBACtBnnG,IACF5tB,EAAKqiC,WAAWnjC,YAAcxK,GAAIiJ,kBAAkBiwB,EAASyU,WAAWpQ,OAAQ,GAEpF,GAAC,CAAAz0C,IAAA,gBAAAE,MAED,WACE,IAAQstB,EAA2FnrB,KAA3FmrB,KAAImuB,EAAuFt5C,KAArFm3C,aACd,GAAI,CADsCmC,EAAZjH,aAA2BiH,EAAbhC,cAAuDt3C,KAAtCq2C,gBAAsCr2C,KAArBs2C,kBACTs7E,MAAK,SAAC13G,GAAS,OAAMA,CAAC,IAGzF,OAFArF,GAAI2E,KAAK2R,EAAKynH,MAAOznH,EAAKgqH,aAC1BtgI,GAAIyE,KAAK6R,EAAKiqH,eAGhB,IAAQ9vH,EAAYtlB,KAAKuN,SAAjB+X,QACRzQ,GAAIqf,OAAO5O,EAAS6F,EAAKynH,OACzB/9H,GAAIqf,QAAQ5O,EAAS6F,EAAKgqH,QACtB7vH,EAAStlB,KAAKq1I,uBACbr1I,KAAKs1I,mBACZ,GAAC,CAAA33I,IAAA,uBAAAE,MAED,WACEmC,KAAK2yI,WAAWpyF,QAClB,GAAC,CAAA5iD,IAAA,oBAAAE,MAED,WACE,IACEstB,EAIEnrB,KAJFmrB,KAAI6vB,EAIFh7C,KAJIu3C,KAAQqD,EAAKI,EAALJ,MAAOL,EAAKS,EAALT,MAAOL,EAAKc,EAALd,MAASjpB,EAInCjxB,KAJmCixB,OAAQC,EAI3ClxB,KAJ2CkxB,QAAS8c,EAIpDhuC,KAJoDguC,QAASxyB,EAI7Dxb,KAJ6Dwb,IAAKC,EAIlEzb,KAJkEyb,IAAKs5B,EAIvE/0C,KAJuE+0C,UACzEU,EAGEz1C,KAHFy1C,WAAYX,EAGV90C,KAHU80C,WAAYU,EAGtBx1C,KAHsBw1C,YAAaH,EAGnCr1C,KAHmCq1C,cAAeS,EAGlD91C,KAHkD81C,eAAcy/F,EAGhEv1I,KAFFm3C,aAAgB9E,EAAYkjG,EAAZljG,aAAciF,EAAai+F,EAAbj+F,cAAamC,EAEzCz5C,KAF6CssB,IAAOuqB,SAAY6C,EAAUD,EAAVC,WAAYC,EAAWF,EAAXE,YAC9EzI,EACElxC,KADFkxC,WAAYR,EACV1wC,KADU0wC,UAEdvlB,EAAKqqH,UAAUn2H,YAAcxK,GAAIizE,oBAAoBltC,EAAM3pB,GAASzV,GACpE,IAAMyhH,EAAUriF,EAAM3pB,GAAU6jB,EAAazC,EACzCojG,EAAWxY,EASf,GARA9xG,EAAKuqH,aAAar2H,YAAcxK,GAAIiJ,kBAAkBm/G,GACtD9xG,EAAKwqH,cAAct2H,YAAcxK,GAAIizE,oBAAoB5tC,EAAM9gB,KAAO0b,EAAYt5B,GAClF2P,EAAKyqH,uBAAuBv2H,YAAcxK,GAAIizE,oBAAoB5tC,EAAMG,cAAgBvF,EAAYt5B,GACpG2P,EAAK0qH,qBAAqBx2H,YAAc/V,OAAO2J,KAAKC,MAAuC,IAAjCwmC,EAAWG,sBACrEhlC,GAAIqf,OAAO8Z,EAAS7iB,EAAK2qH,iBACrB9nG,IAAS7iB,EAAK4qH,aAAa12H,YAAcxK,GAAIizE,oBAAoB5tC,EAAMrK,IAAMiF,EAAYt5B,IAC7F3G,GAAIqf,OAAO6gB,IAAc9jB,EAAQ9F,EAAK6qH,yBACtCnhI,GAAIqf,OAAO6gB,IAAc9jB,EAAQ9F,EAAK8qH,uBAClClhG,IAAc9jB,EAAQ,CACxB,IAAMkpB,EAAclpB,IAAWwkB,EAAayE,EAAMC,YAAcI,EAAMJ,YAAcD,EAAMC,YAC1FhvB,EAAK+qH,qBAAqB72H,YAAcxK,GAAIizE,oBAAoB3tC,EAAc9E,EAAe3E,EAC/F,KAAO,CACL,IAAMylG,EAAWv7F,EAAM7F,GACvB5pB,EAAKirH,kBAAkB/2H,YAAcxK,GAAIizE,oBAAoBquD,EAAUzlG,GACvE,IAAM2lG,EAAaF,EAAW9gG,EAAgBpqB,KAAMymB,aAAaqD,GACjE0gG,GAAYY,EACZlrH,EAAKmrH,kBAAkBj3H,YAAcxK,GAAIiJ,kBAAkBu4H,GAC3D,IAAME,EAAYxhG,IAAcU,EAC1B0E,EAAcD,EAAMC,aAAeo8F,EAAYh8F,EAAMJ,YAAc,GACzEhvB,EAAKqrH,qBAAqBn3H,YAAcxK,GAAIizE,oBAAoB3tC,EAAc9E,EAAe3E,GAC7FvlB,EAAKsrH,kBAAkBp3H,YAAc/V,OAAOowC,EAAWgB,UAAY67F,EAAY58F,EAAYe,SAAW,IACtG,IAAMg8F,EAAex8F,EAAME,iBAAmBm8F,EAAYh8F,EAAMH,gBAAkB,GAClFjvB,EAAKwrH,kBAAkBt3H,YAAcxK,GAAIizE,oBAAoB4uD,EAAerhG,EAAe3E,EAC7F,CAEAvlB,EAAKyrH,WAAWv3H,YAAcxK,GAAIizE,oBAAoBltC,EAAM1pB,GAAUzV,GACtE,IAAMyhH,EAAWtiF,EAAM1pB,GAAWskB,EAAc8B,EAYhD,GAXAm+F,GAAYvY,EACZ/xG,EAAK0rH,cAAcx3H,YAAcxK,GAAIiJ,kBAAkBo/G,GACvD/xG,EAAK2rH,eAAez3H,YAAcxK,GAAIizE,oBAAoBvtC,EAAMnhB,KAAOoc,EAAa/5B,GACpF0P,EAAK4rH,wBAAwB13H,YAAcxK,GAAIizE,oBAAoBvtC,EAAMF,cAAgB7E,EAAa/5B,GACtG0P,EAAK6rH,sBAAsB33H,YAAc/V,OAAO2J,KAAKC,MAAwC,IAAlCymC,EAAYE,sBACvE1uB,EAAK8rH,mBAAmB53H,YAAcxK,GAAIizE,oBAAoBvtC,EAAMD,eAAiB9E,EAAa/5B,GAClG0P,EAAKwvB,qBAAqBt7B,YAAc/V,OAAO2J,KAAKC,MAAyC,IAAnCymC,EAAYgB,uBACtE9lC,GAAIqf,OAAO8Z,EAAS7iB,EAAK+rH,kBACrBlpG,IAAS7iB,EAAKgsH,cAAc93H,YAAcxK,GAAIizE,oBAAoBvtC,EAAM1K,IAAM2F,EAAa/5B,IAC/F5G,GAAIqf,OAAOhD,IAAYukB,EAAYtqB,EAAKisH,0BACxCviI,GAAIqf,OAAOuhB,IAAevkB,GAAWukB,IAAeV,EAAW5pB,EAAKksH,wBAChEnmH,IAAYukB,EAAY,CAC1B,IAAM0E,EAAcjpB,IAAY6jB,EAAYmF,EAAMC,YAAcI,EAAMJ,YAAcI,EAAMJ,YAC1FhvB,EAAKmsH,sBAAsBj4H,YAAcxK,GAAIizE,oBAAoB3tC,EAAcrE,EAAgB5E,EACjG,MAAO,GAAIuE,IAAeV,EAAW,CACnC5pB,EAAKosH,mBAAmBl4H,YAAcxK,GAAIizE,oBAAoBltC,EAAMnF,GAAavE,GACjF,IAAMsmG,EAAc58F,EAAMnF,GAAcK,EAAiB7qB,KAAMymB,aAAa+D,GAC5EggG,GAAY+B,EACZrsH,EAAKssH,mBAAmBp4H,YAAcxK,GAAIiJ,kBAAkB05H,GAC5DrsH,EAAKusH,sBAAsBr4H,YAAcxK,GAAIizE,oBAAoBvtC,EAAMJ,YAAcrE,EAAgB5E,GACrG/lB,EAAKwsH,mBAAmBt4H,YAAc/V,OAAOqwC,EAAYe,UACzDvvB,EAAKysH,mBAAmBv4H,YAAcxK,GAAIizE,oBAAoBvtC,EAAMH,gBAAkBtE,EAAgB5E,EACxG,CACA/lB,EAAK0sH,cAAcx4H,YAAcxK,GAAIiJ,kBAAkB23H,EACzD,GAEA,CAAA93I,IAAA,WAAAE,MAIA,WAAY,IAAAi6I,EAAAC,EAAAC,EAAAC,EAAA3b,EAAA10G,EAAA,KAERuD,EAGEnrB,KAHFmrB,KAAI+sH,EAGFl4I,KAHIm3C,aAAgB9E,EAAY6lG,EAAZ7lG,aAAciF,EAAa4gG,EAAb5gG,cAAiBrmB,EAGnDjxB,KAHmDixB,OAAQC,EAG3DlxB,KAH2DkxB,QAC7D6jB,EAEE/0C,KAFF+0C,UAAWU,EAETz1C,KAFSy1C,WAAYY,EAErBr2C,KAFqBq2C,gBAAiBC,EAEtCt2C,KAFsCs2C,iBAAkBtI,EAExDhuC,KAFwDguC,QAC1D8G,EACE90C,KADF80C,WAAYU,EACVx1C,KADUw1C,YAAaH,EACvBr1C,KADuBq1C,cAAeS,EACtC91C,KADsC81C,eAAgBxO,EACtDtnC,KADsDsnC,KAAMyO,EAC5D/1C,KAD4D+1C,MAGhE,GAAI/H,EAAS,CACX,IAAM6B,EAAM5kB,KAAM2iB,SAASyK,MAAMrK,GACjC,IAAK6B,IAAQA,EAAIq7C,UAGf,OAFA//D,EAAKgtH,SAAS94H,YAAc9C,GAAUA,GAA2B,CAAEyxB,QAAAA,SACnEn5B,GAAIujI,gBAAgB,IAAMjtH,EAAKgtH,SAGnC,CAEA,IAAMtsI,EAAI7L,KAAKq4I,eAEmEC,EAAA1wI,EAA3BslI,GAAoBrhI,EAAE2lB,MAAK,GAA3E+mH,EAAeD,EAAA,GAAEE,EAAeF,EAAA,GAAEG,EAAUH,EAAA,GACmCI,EAAA9wI,EAA5BslI,GAAoBrhI,EAAE2uC,OAAM,GAA/Em+F,EAAgBD,EAAA,GAAEE,EAAgBF,EAAA,GAAEG,EAAWH,EAAA,GAEhD99F,EAAQ56C,KAAK46C,MAAQ,CACzB1K,KAAG4nG,EAAA,GAAAhuI,EAAAguI,EACA7mH,EAASsnH,EAAkBzjG,GAAUhrC,EAAAguI,EACrC5mH,EAAUynH,EAAmBnjG,GAAWsiG,GAE3CjoG,KAAGkoG,EAAA,GAAAjuI,EAAAiuI,EACA9mH,EAASunH,EAAkB1jG,GAAUhrC,EAAAiuI,EACrC7mH,EAAU0nH,EAAmBpjG,GAAWuiG,IAI7Cn9F,EAAM1K,IAAI6E,GAAa9hC,KAAKoB,KAAyB,QAArB2jI,EAACp9F,EAAM1K,IAAI6E,UAAU,IAAAijG,EAAAA,EAAI,GAAMnsI,EAAE2lB,KAAKyoB,KAAK2C,IAAMvH,EAAgBxpC,EAAE2lB,KAAKyoB,KAAKlK,MAAQsF,GACrHuF,EAAM1K,IAAIuF,GAAcxiC,KAAKoB,KAA0B,QAAtB4jI,EAACr9F,EAAM1K,IAAIuF,UAAW,IAAAwiG,EAAAA,EAAI,GAAMpsI,EAAE2uC,MAAMP,KAAK2C,IAAM9G,EAAiBjqC,EAAE2uC,MAAMP,KAAKlK,MAAQ+F,GAE1H,IAAI2/F,EAAY76F,EAAM1K,IAAIjf,GAAU6jB,EAAazC,EAAiBuI,EAAM1K,IAAIhf,GAAWskB,EAAc8B,EACrGm+F,GAAa76F,EAAM/K,IAAI5e,GAAU6jB,EAAazC,EAAiBuI,EAAM/K,IAAI3e,GAAWskB,EAAc8B,EAC9FvC,IAAc9jB,IAAQwkH,GAAY76F,EAAM1K,IAAI6E,GAAaM,EAAgBgB,GACzEZ,IAAevkB,GAAWukB,IAAeV,IAAW0gG,GAAY76F,EAAM1K,IAAIuF,GAAcK,EAAiBQ,GAC7GnrB,EAAK2tH,SAASz5H,YAAcxK,GAAIiJ,kBAAkB23H,GAElD5gI,GAAIqf,OAAMtrB,MAAViM,GAAG,CAAQm5B,GAAOjiC,OAAArE,EAAKmN,GAAImG,cAAcmQ,EAAK4tH,iBAAkB,sBAChElkI,GAAIqf,OAAOroB,EAAE6wC,kBAAmBvxB,EAAK6tH,sBACrCnkI,GAAIqf,OAAOroB,EAAE2lB,KAAKsrB,aAAejxC,EAAE2uC,MAAMsC,aAAe,EAAG3xB,EAAK8tH,iBAChEpkI,GAAIqf,OAAOroB,EAAE8wC,qBAAsBxxB,EAAK+tH,yBACxCrkI,GAAIqf,OAAOroB,EAAEkxC,QAAS5xB,EAAKguH,YAC3BhuH,EAAKgoH,UAAUx6H,UAAUmN,OAAO,KAAMja,EAAE6wC,mBACxCvxB,EAAKgoH,UAAUx6H,UAAUmN,OAAO,WAAYja,EAAE6wC,mBAC9CvxB,EAAKiuH,qBAAqBzgI,UAAUmN,OAAO,iBAAkBja,EAAE2lB,KAAKkrB,mBAAqB7wC,EAAE2lB,KAAKmrB,uBAChGxxB,EAAKkuH,sBAAsB1gI,UAAUmN,OAAO,iBAAkBja,EAAE2uC,MAAMkC,mBAAqB7wC,EAAE2uC,MAAMmC,uBAEnG,IAAM28F,EAAkB,SAACppG,EAAaL,GACpC1kB,EAAKiuH,qBAAqB/5H,YAAcxK,GAAIiJ,kBAAkBoyB,GAC9D/kB,EAAKouH,wBAAwBl6H,YAAcxK,GAAIiJ,kBAAkBoyB,EAAMmC,GACvElnB,EAAKquH,qBAAqBn6H,YAAcxK,GAAIiJ,kBAAkB+xB,GAC9D1kB,EAAKsuH,wBAAwBp6H,YAAcxK,GAAIiJ,kBAAkB+xB,EAAMwC,EACzE,EAIA,GAHAinG,EAAgBf,EAAiBC,GAEjC3jI,GAAIqf,OAAOukH,EAAYttH,EAAKyoH,iBACxB6E,EAAY,CACd,IAAMzK,EAAWyK,EAAWziI,MAAMk6B,IAAMuoG,EAAW1iI,KAAKm6B,IAClD69F,EAAW0K,EAAWziI,MAAM65B,IAAM4oG,EAAW1iI,KAAK85B,IACxD7vC,KAAK4zI,gBAAgBvmH,SAAS,IAC9BrtB,KAAK4zI,gBAAgBzsH,QAAU,SAACjN,GAC9B,IAAMw/H,EAAWjB,EAAW1iI,KAAKm6B,IAAMh2B,EAAI8zH,EACrC2L,EAAWlB,EAAW1iI,KAAK85B,IAAM31B,EAAI6zH,EAC3CnzF,EAAM1K,IAAIjf,GAAUyoH,EAAW5kG,EAC/B8F,EAAM/K,IAAI5e,GAAU0oH,EAAW7kG,EAC/BwkG,EAAgBI,EAAUC,EAC5B,CACF,CAEA,IAAMC,EAAmB,SAAC1pG,EAAaL,GACrC1kB,EAAKkuH,sBAAsBh6H,YAAcxK,GAAIiJ,kBAAkBoyB,GAC/D/kB,EAAK0uH,yBAAyBx6H,YAAcxK,GAAIiJ,kBAAkBoyB,EAAMoH,GACxEnsB,EAAK2uH,sBAAsBz6H,YAAcxK,GAAIiJ,kBAAkB+xB,GAC/D1kB,EAAK4uH,yBAAyB16H,YAAcxK,GAAIiJ,kBAAkB+xB,EAAMyH,EAC1E,EAIA,GAHAsiG,EAAiBjB,EAAkBC,GAEnC/jI,GAAIqf,OAAO2kH,EAAa1tH,EAAK0oH,kBACzBgF,EAAa,CACf,IAAM7K,EAAW6K,EAAY7iI,MAAMk6B,IAAM2oG,EAAY9iI,KAAKm6B,IACpD69F,EAAW8K,EAAY7iI,MAAM65B,IAAMgpG,EAAY9iI,KAAK85B,IAC1D7vC,KAAK6zI,iBAAiBxmH,SAAS,IAC/BrtB,KAAK6zI,iBAAiB1sH,QAAU,SAACjN,GAC/B,IAAMw/H,EAAWb,EAAY9iI,KAAKm6B,IAAMh2B,EAAI8zH,EACtC2L,EAAWd,EAAY9iI,KAAK85B,IAAM31B,EAAI6zH,EAC5CnzF,EAAM1K,IAAIhf,GAAWwoH,EAAWlkG,EAChCoF,EAAM/K,IAAI3e,GAAWyoH,EAAWnkG,EAChCokG,EAAiBF,EAAUC,EAC7B,CACF,CAGA,GADA9kI,GAAIqf,OAAMtrB,MAAViM,GAAG,CAAQkgC,IAAc9jB,GAAMllB,OAAArE,EAAKmN,GAAImG,cAAcmQ,EAAK4tH,iBAAkB,6BACzEhkG,IAAc9jB,EAAQ,CACxB,IAAM+oH,EAAUnuI,EAAE2lB,KAAKyoB,KAAK2C,KAAO7H,IAAcU,EAAa5pC,EAAE2uC,MAAMP,KAAK2C,IAAM,GAC3Eq9F,EAAehnI,KAAKoB,IAAI2lI,EAASnuI,EAAE2lB,KAAKyoB,KAAKlK,OACnD5kB,EAAK+uH,wBAAwB76H,YAAcxK,GAAIiJ,kBAAkBm8H,GACjE9uH,EAAKgvH,2BAA2B96H,YAAcxK,GAAIiJ,kBAAkBm8H,EAAe5jG,GACnFlrB,EAAK+uH,wBAAwBvhI,UAAUmN,OAAO,gBAAiBja,EAAE2lB,KAAKyoB,KAAK4C,OAC7E,CAEA,IAAMu9F,EAAqB3kG,IAAevkB,GAAWukB,IAAeV,EAEpE,GADAlgC,GAAIqf,OAAMtrB,MAAViM,GAAG,CAAQulI,GAAkBruI,OAAArE,EAAKmN,GAAImG,cAAcmQ,EAAK4tH,iBAAkB,8BACvEqB,EAAoB,CACtB,IAAMH,EAAehnI,KAAKoB,IAAIxI,EAAE2uC,MAAMP,KAAK2C,IAAK/wC,EAAE2uC,MAAMP,KAAKlK,OAC7D5kB,EAAKkvH,yBAAyBh7H,YAAcxK,GAAIiJ,kBAAkBm8H,GAClE9uH,EAAKmvH,4BAA4Bj7H,YAAcxK,GAAIiJ,kBAAkBm8H,EAAe3jG,GACpFnrB,EAAKkvH,yBAAyB1hI,UAAUmN,OAAO,gBAAiBja,EAAE2uC,MAAMP,KAAK4C,OAC/E,CAEA,IAAM7T,EAA2B,QAAxBszF,EAAGrxG,KAAMuc,UAAUF,UAAK,IAAAg1F,OAAA,EAArBA,EAAuBrmF,QAAQF,GACvCwkG,GAAiB,EACrB,GAAIvxG,GAAOA,EAAIqjB,OACb,IAAK,IAAI7oD,EAAI,EAAGA,EAAIwlC,EAAIqjB,OAAO9oD,OAAQC,IACrC,GAAIwlC,EAAIqjB,OAAO7oD,GAAG+J,QpB3uBE,EoB2uBsB,CACxCgtI,GAAiB,EACjB,KACF,CAGJ1lI,GAAIqf,OAAOqmH,EAAgBpvH,EAAKqvH,mBAEhC3lI,GAAIyE,KAAK6R,EAAK4tH,kBAMdlkI,GAAI1K,KAAKc,SAAU,SALC,SAAdwvI,EAAe7uI,GACfiJ,GAAIk6C,eAAenjD,EAAGuf,EAAK4tH,oBAC/BnxH,EAAK8rH,uBACL7+H,GAAImU,OAAO/d,SAAU,QAASwvI,GAChC,GAEF,GAAC,CAAA98I,IAAA,uBAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAKmrB,KAAK4tH,iBACrB,GAAC,CAAAp7I,IAAA,QAAAE,OAAA6pI,EAAAj/H,EAAAzL,IAAAA,MAED,SAAAmxC,IAAA,IAAAusG,EAAAvvH,EAAAyvB,EAAA3pB,EAAAC,EAAAoW,EAAA0G,EAAAiN,EAAA7iC,EAAAlQ,EAAAwY,EAAAjI,EAAAotC,EAAAC,EAAA/nC,EAAArS,EAAAivI,EAAAvxI,EAAA,OAAApM,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OAGuB,GAFb6oB,EAAqFnrB,KAArFmrB,KAAMyvB,EAA+E56C,KAA/E46C,MAAO3pB,EAAwEjxB,KAAxEixB,OAAQC,EAAgElxB,KAAhEkxB,QAASoW,EAAuDtnC,KAAvDsnC,KAAM0G,EAAiDhuC,KAAjDguC,QAA4BiN,EAAqBj7C,KAAxCssB,IAAOuqB,SAAYoE,aAExEpmC,GAAI2E,KAAK2R,EAAKmqC,SACVtnB,GAAyC,QAA9B0sG,EAACzvH,KAAM2iB,SAASyK,MAAMrK,UAAQ,IAAA0sG,GAA7BA,EAA+BxvD,UAAS,CAAA78C,EAAA/rC,KAAA,QAEjC,OADrB6oB,EAAKmqC,OAAOj2C,YAAc,GAAHtT,OAAMiiC,EAAO,kBACpCn5B,GAAIyE,KAAK6R,EAAKmqC,QAAOjnB,EAAApsC,OAAA,iBAKvB,IAAAmW,EAAA,EAAAlQ,EAAgB,CAAC0yC,EAAM1K,IAAK0K,EAAM/K,KAAIz3B,EAAAlQ,EAAA3E,OAAA6U,IACpC,IADSsI,EAACxY,EAAAkQ,GACVK,EAAA,EAAAotC,EAA2BxoD,OAAOkgB,QAAQmD,GAAEjI,EAAAotC,EAAAtiD,OAAAkV,IAAAqtC,EAAAl+C,EAAAi+C,EAAAptC,GAAA,GAAhCsF,EAAO+nC,EAAA,GAAEp6C,EAACo6C,EAAA,GAAwBplC,EAAE7N,SAASkL,IAAY9K,KAAKC,MAAMxH,GAYjC,OAT3CivI,EAA2B,CAC/B1pH,OAAQA,EACRC,QAASA,EACToW,KAAMA,EACNsT,MAAOA,GAEL5M,GAAWiN,IAAc0/F,EAAYC,cAAgB56I,KAAK66I,yBAAuBxsG,EAAAxpC,KAAA,EAGnFomB,KAAMuoB,IAAI,KAAM,kBAAmBmnG,GAAYtsG,EAAA/rC,KAAA,GAC7ByqC,GAAG+tG,SAASH,GAAY,QAAjC,GAAHvxI,EAAGilC,EAAAvsC,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAFilC,EAAA/rC,KAAA,eAAQ8G,EAAG,QAAAilC,EAAA/rC,KAAA,iBAGnB,OAHmB+rC,EAAAxpC,KAAA,GAAAwpC,EAAA3gC,GAAA2gC,EAAA,SAExCljB,EAAKmqC,OAAOj2C,YAAc9C,GAAUA,EAAiB8xB,EAAA3gC,IACrDmH,GAAIyE,KAAK6R,EAAKmqC,QAAOjnB,EAAApsC,OAAA,kBAGvBjC,KAAK0zI,uBAAsB,yBAAArlG,EAAArpC,OAAA,GAAAmpC,EAAA,mBAC5B,kBAAAu5F,EAAA9+H,MAAA,KAAAD,UAAA,KAAAhL,IAAA,wBAAAE,MAED,WACE,IAAAk9I,EAGI/6I,KAFFu3C,KAAQ2C,EAAK6gG,EAAL7gG,MAAOK,EAAKwgG,EAALxgG,MAAOK,EAAKmgG,EAALngG,MAAS7F,EAE7B/0C,KAF6B+0C,UAAWU,EAExCz1C,KAFwCy1C,WAAUqE,EAElD95C,KAFoDssB,IAAOuqB,SAAY6C,EAAUI,EAAVJ,WAAYC,EAAWG,EAAXH,YACrF1oB,EACEjxB,KADFixB,OAAQC,EACNlxB,KADMkxB,QAAS8c,EACfhuC,KADeguC,QAAS+H,EACxB/1C,KADwB+1C,MAGtBilG,EAAYpgG,EAAM3pB,GACpBgqH,EAAa/gG,EAAM9gB,KACnBnI,IAAW8jB,IAAWkmG,GAAc/gG,EAAMC,aAC1ClpB,IAAWwkB,IAAYwlG,GAAc1gG,EAAMJ,aAC/C,IAAI+gG,EAAc3gG,EAAMnhB,KACpBlI,IAAYukB,IAAYylG,GAAe3gG,EAAMJ,aAC7CjpB,IAAY6jB,IAAWmmG,GAAehhG,EAAMC,aAChD,IAAMghG,EAAUloI,KAAKqB,IAAI0mI,EAAYC,EAAYD,EAAY9gG,EAAMrK,KAC7DurG,EAAaxgG,EAAM1pB,GACnBmqH,EAAWpoI,KAAKqB,IAAI8mI,EAAaF,EAAaE,EAAa7gG,EAAM1K,KACvE,GAAIsrG,EAAU,GAAKE,EAAW,EAC5B,MAAM75I,MAAM,gCAADuK,OAAiCM,KAAKC,UAAU,CAAE4tC,MAAAA,EAAOK,MAAAA,EAAO4gG,QAAAA,EAASE,SAAAA,MAEtF,IACMryG,EADM/d,KAAM2iB,SAASyK,MAAMrK,GACjBiI,QAAQF,GACxB97B,EAAqB,CAAC+uB,EAAIsyG,gBAAiBroI,KAAKqB,IAA0B,EAAtB00B,EAAIsyG,gBAAqBH,IAAtEI,EAAIthI,EAAA,GAAEuhI,EAAIvhI,EAAA,GACXwhI,EAAkBxoI,KAAKC,MAAMqoI,EAAO7hG,EAAWgiG,gBAAkBF,EAAOD,IAC9E78H,EAAqB,CAACsqB,EAAI2yG,iBAAkB1oI,KAAKqB,IAA2B,EAAvB00B,EAAI2yG,iBAAsBN,IAAxEO,EAAIl9H,EAAA,GAAEm9H,EAAIn9H,EAAA,GAEjB,MAAO,CAAE+8H,gBAAAA,EAAiBK,iBADD7oI,KAAKC,MAAM0oI,EAAOjiG,EAAY+hG,gBAAkBG,EAAOD,IAElF,GAAC,CAAAj+I,IAAA,cAAAE,MAED,WACE,IAAQypC,EAAkDtnC,KAAlDsnC,KAAMrW,EAA4CjxB,KAA5CixB,OAAQC,EAAoClxB,KAApCkxB,QAAS8c,EAA2BhuC,KAA3BguC,QAASsE,EAAkBtyC,KAAlBsyC,QAASnnB,EAASnrB,KAATmrB,KACjD,GAAI6iB,EAAS,CACX,IAAM6B,EAAM5kB,KAAM2iB,SAASyK,MAAMrK,GACjC,IAAK6B,IAAQA,EAAIq7C,UAGf,OAFA//D,EAAKgtH,SAAS94H,YAAc9C,GAAUA,GAA2B,CAAEyxB,QAAAA,SACnEn5B,GAAIujI,gBAAgB,IAAMjtH,EAAKgtH,SAGnC,CACAltH,KAAM2yB,SAAS,aAAc,CAAEtW,KAAAA,EAAMrW,OAAAA,EAAQC,QAAAA,EAAS8c,QAAAA,EAASsE,QAAAA,GACjE,GAAC,CAAA30C,IAAA,wBAAAE,MAED,SAAuBuyD,GACrBpwD,KAAK2yI,WAAW1vB,sBAAsB7yD,EACxC,GAAC,CAAAzyD,IAAA,wBAAAE,MAED,SAAuBuyD,GACrBpwD,KAAK2yI,WAAWxvB,sBAAsB/yD,EACxC,GAAC,CAAAzyD,IAAA,iBAAAE,MAED,WACEmC,KAAK60I,gBACL70I,KAAK80I,iBACL90I,KAAK2yI,WAAWnyF,UAClB,KAACqwF,CAAA,CAhcM,CAASp8F,klDCvXlB,IAAMsnG,GAAS,cACTC,GAAa,WACbC,GAAoB,kBACpBC,GAAmB,QA4CnBC,GAGE,KAHFA,GAKG,KAEHC,GAGE,KAHFA,GAKG,MAyBHC,GAAyC,CAC7C38F,YAAajT,GACb0F,eAAgB,GAChBD,cAAe,GACfoqG,eAtDO,KAuDPlqG,OAAQ,IACRmqG,iBAjDO,GAkDPthG,cAAc,EACdnE,cAAe,GAGX0lG,GAAwC,CAC5C9hG,SA1FG,GA2FHb,oBAnFQ,EAoFRc,qBAvEQ,IAwER+gG,eA9EQ,IAsIWe,GAAuB,SAAAtmE,GAAA/rE,EAAAqyI,EAAAtmE,GAAA,IA2lD1C+3D,EAjDAwO,EA/DCC,EA7CDC,EAhcCC,EArDAC,EATAC,EA7JAC,EA9cAC,EA3BAjmG,MA1TyCtvB,KAAA+0H,iZAwC1C,SAAAA,EAAalkC,EAAmBzmG,GAAiB,IAAAqH,EAAAtQ,EAAA,KAAA4zI,GACxC3yI,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,+BAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,8BAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,qBAAArP,EAAAC,EAAAoP,GAAA,gCAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,+BAAArP,EAAAC,EAAAoP,GAAA,2BAAArP,EAAAC,EAAAoP,GAAA,iCAEPA,EAAK+jI,gBAAkB,CAAC,EACxB/jI,EAAK/D,KAAO,CAAC,EAEb,IAAM+V,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAck7D,GAE3Cp/F,EAAK8jC,MAAQ,IAAI2R,GAAMzjC,EAAK8xB,MAAO,CACjC6R,OAAQ,WAAM,IAAAquF,EAAAC,EACG,QAAXD,EAAChkI,EAAKrH,aAAK,IAAAqrI,GAAVA,EAAY71G,MAAmB,QAAX81G,EAACjkI,EAAKrH,aAAK,IAAAsrI,GAAVA,EAAY9qG,SAASrnB,KAAM2yB,SAAS,KAChE,IAGFzkC,EAAK65H,gBAAkB,IAAInhG,GAAgB1mB,EAAK6nH,iBAChD75H,EAAK+gG,iBAAmB,IAAI5nC,GAAkBnnD,EAAK+uF,kBAAkB,WAAQ/gG,EAAKkkI,eAAgB,IAClGlkI,EAAKmkI,eAAiB,IAAIpvE,GAAe/iD,EAAKmyH,gBAC9CnkI,EAAKy1H,cAAgB,IAAIh7D,GAAqBzoD,EAAKyjH,eAAe,SAAC5gG,GAAe,OAAK70B,EAAK01H,cAAc7gG,EAAQ,IAClH7iB,EAAKoyH,UAAYpyH,EAAKqyH,SAAS/xH,WAAU,GACzCN,EAAKsyH,aAAanlI,YAAY6S,EAAKoyH,WACnCpkI,EAAKqkI,SAAW,IAAIE,GAAS3zI,EAAAoP,GAAOgS,EAAKqyH,UACzCrkI,EAAKokI,UAAY,IAAIG,GAAS3zI,EAAAoP,GAAOgS,EAAKoyH,WAE1CtyH,KAAMg2F,YAAY3oG,YAAY6S,EAAKwyH,SAEnCzyH,GAAmBC,GACnBtW,GAAIuyB,eACFjc,EAAKV,aAAcU,EAAKT,eAAgBS,EAAKR,aAAcQ,EAAKoyB,iBAChEpyB,EAAKyyH,WAAYzyH,EAAK0yH,WAAY1yH,EAAK2yH,YAAa3yH,EAAK4yH,cAAe5yH,EAAK6yH,aAE/E7yH,EAAKqyH,SAASp9H,gBAAgB,MAE9BvL,GAAI1K,KAAKghB,EAAK8yH,YAAa,SAAS,WAAQ9kI,EAAK+kI,mBAAoB,IACrErpI,GAAI1K,KAAKghB,EAAKgzH,aAAc,SAAS,WAAQhlI,EAAKilI,cAAe,IACjEvpI,GAAI1K,KAAKghB,EAAKkzH,aAAc,QAAO51I,EAAAzL,IAAAA,MAAE,SAAA8P,IAAA,OAAA9P,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAAc6W,EAAKilI,eAAc,wBAAAlxI,EAAAlI,OAAA,GAAA8H,EAAA,MACtE+H,GAAI1K,KAAKghB,EAAKmzH,WAAY,SAAS,WAAQnlI,EAAA,QAAc,IACzDqnE,GAASr1D,EAAKozH,YAAapzH,EAAKqzH,eAAe,WAAQrlI,EAAKkkI,eAAgB,IAC5ExoI,GAAI1K,KAAKghB,EAAKszH,aAAc,SAAS,WAAQtlI,EAAKulI,sBAAuB,IACzE7pI,GAAI1K,KAAKghB,EAAKwzH,cAAe,SAAS,WAAQxlI,EAAKylI,mBAAoB,IACvE/pI,GAAI1K,KAAKghB,EAAK0zH,oBAAqB,SAAS,WAAQ1lI,EAAKulI,sBAAuB,IAChF7pI,GAAI1K,KAAKghB,EAAK2zH,aAAc,SAAS,WAAQ3lI,EAAKulI,sBAAuB,IACzE7pI,GAAI1K,KAAKghB,EAAK4zH,kBAAmB,SAAS,WAAQ5lI,EAAK6lI,gBAAiB,IACxEnqI,GAAI1K,KAAKghB,EAAK8zH,qBAAsB,UAAU,WAAQ9lI,EAAK+lI,sBAAuB,IAClFrqI,GAAI1K,KAAKghB,EAAKg0H,iBAAkB,SAAS,WAAQhmI,EAAKimI,oBAAqB,IAC3EvqI,GAAI1K,KAAKghB,EAAKk0H,oBAAqB,SAAS,WAAQlmI,EAAKkmI,qBAAsB,IAC/ExqI,GAAI1K,KAAKghB,EAAKm0H,cAAe,UAAU,WAAQnmI,EAAKomI,oBAAqB,IACzE1qI,GAAI1K,KAAKghB,EAAKq0H,mBAAoB,SAAS,WAAQrmI,EAAKsmI,4BAA6B,IACrF5qI,GAAI1K,KAAKghB,EAAKu0H,qBAAsB,SAAS,WAAQvmI,EAAKsmI,4BAA6B,IAEvF5qI,GAAI1K,KAAKghB,EAAKw0H,kBAAmB,UAAU,WACzC,GAAKx0H,EAAKw0H,kBAAkB9hJ,MAA5B,CACA,IAAM6hD,EAAcv0B,EAAKw0H,kBAAkB9hJ,MAC3Csb,EAAKymI,gBAAgBzmI,EAAK0mI,cAAcngG,aACxCvmC,EAAK2mI,qBAAqBpgG,GAC1BvmC,EAAK0mI,cAAcngG,YAAcA,EACjCvmC,EAAK4mI,mBAAmBrgG,GACxBvmC,EAAK6mI,uBANoC,CAO3C,IAGAnrI,GAAI1K,KAAKghB,EAAK80H,mBAAoB,SAAS,WACzC9mI,EAAK+mI,cAAa,EAAM,MACxB/0H,EAAKg1H,oBAAoBtiJ,MAAQ,GACjCstB,EAAKi1H,yBAAyBviJ,MAAQ,GACtCsb,EAAK6mI,wBACL7mI,EAAK65H,gBAAgBz+G,SACrBpb,EAAKknI,mBACP,IACAxrI,GAAI1K,KAAKghB,EAAKm1H,oBAAqB,SAAS,WAC1CnnI,EAAK+mI,cAAa,EAAO,MACzB/0H,EAAKo1H,qBAAqB1iJ,MAAQ,GAClCstB,EAAKq1H,0BAA0B3iJ,MAAQ,GACvCsb,EAAK6mI,wBACL7mI,EAAK65H,gBAAgBz+G,SACrBpb,EAAKknI,mBACP,IAEAlnI,EAAKmjI,eAAiB,IAAI31H,GAAYwE,EAAKs1H,oBAAqB,CAC9DxsI,KAAMysI,EACN15H,SAAS,EACT3S,IAAK,EACL8S,QAAS,SAACw5H,GACR,IACOj1I,EAAoC9D,EAA/Bqf,GAAc05H,EAAO,IAhPjC,GAgP2C,GAAnC,GACRxnI,EAAKynI,qBAAqBvzH,UAAU3hB,EApPpC,GAEC,KAmPDyN,EAAK0mI,cAAcvD,eAAiB5wI,CACtC,IAGFyN,EAAKynI,qBAAuB,IAAI14H,GAAWiD,EAAKy1H,sBAAsB,SAAC1mI,GACrE,IACOxO,EAA0C9D,EAArCqf,GA3PV,EAEC,IAyP8B/M,EAxP/B,GAwP+C,GAAzC,GACRf,EAAK0mI,cAAcvD,eAAiB5wI,EACpCyN,EAAKmjI,eAAejvH,SAAa,IAAJ3hB,EAC/B,IAEAyN,EAAKojI,iBAAmB,IAAI51H,GAAYwE,EAAKoxH,iBAAkB,CAC7Dp1H,QAAS,SAACzb,GAERyN,EAAK0mI,cAActD,iBAAmB7wI,EACtCyN,EAAK0nI,uBAAuBxzH,UAAU3hB,EA7PtC,GAEC,GA4PH,IAGFyN,EAAK0nI,uBAAyB,IAAI34H,GAAWiD,EAAK01H,wBAAwB,SAAC3mI,GACzE,IAEOxO,EAA4B9D,EAAvBsf,GApQV,EAEC,GAiQiBhN,EAhQlB,GAiQiC,GAA3B,GACRf,EAAK0mI,cAActD,iBAAmB7wI,EACtCyN,EAAKojI,iBAAiBlvH,SAAS3hB,EACjC,IAEAyN,EAAK2nI,SAAW,IAAIn6H,GAAYwE,EAAK21H,SAAU,CAC7C7sI,KAAMkoI,EACNn1H,SAAS,EACT3S,IAAK8nI,GACLh1H,QAAS,SAAC45H,GACR,IACMr1I,EAAIq1I,EAAO,IACjB5nI,EAAK0mI,cAAcztG,OAAS1mC,EAC5Byf,EAAK61H,YAAYnjJ,MAAQsb,EAAK2nI,SAAS73I,MAAMpL,MAC7Csb,EAAK8nI,eAAe5zH,UAAU3hB,EAJNywI,MAAAA,MAKxBhjI,EAAK+nI,oBACP,IAGF/nI,EAAK8nI,eAAiB,IAAI/4H,GAAWiD,EAAK81H,gBAAgB,SAAC/mI,GACzD,IACOxO,EAAkD9D,EAA7Cqf,GAAmC,KADjBk1H,GACIjiI,EADJiiI,IAlR5B,GAmRuD,GAAjD,GACRhjI,EAAK0mI,cAAcztG,OAAS1mC,EAAI,IAChCyN,EAAK2nI,SAASzzH,SAAS3hB,GACvByf,EAAK61H,YAAYnjJ,MAAQsb,EAAK2nI,SAAS73I,MAAMpL,MAC7Csb,EAAK+nI,oBACP,IAEA/nI,EAAKgoI,eAAiB,IAAIx6H,GAAYwE,EAAKg2H,eAAgB,CACzDltI,KAAMmoI,EACNp1H,SAAS,EACT3S,IAAK+nI,GACLj1H,QAAS,SAAC45H,GACR,IAAc/9H,EAAUo5H,GACxBjjI,EAAKioI,qBAAqB/zH,UAAU0zH,EAAO,IADnB3E,MACiCp5H,GACzD7J,EAAK+nI,oBACP,IAGF/nI,EAAKioI,qBAAuB,IAAIl5H,GAAWiD,EAAKi2H,sBAAsB,SAAClnI,GACrE,IAAc8I,EAAUo5H,GACxBjjI,EAAKgoI,eAAe9zH,SADI+uH,KACYliI,EAAI8I,EAAQ,KAChD7J,EAAK+nI,oBACP,IAEA/nI,EAAKmmI,cAAgB,IAAI34H,GAAYwE,EAAKm0H,cAAe,CACvDrrI,KAAMotI,EACNr6H,SAAS,EACT3S,IAAKgtI,EACLl6H,QAAS,SAAC45H,GAER5nI,EAAKmoI,oBAAoBj0H,UAAU0zH,EAAO,IAjS1C,GAEC,GAgSD5nI,EAAK+nI,oBACP,IAGF/nI,EAAKmoI,oBAAsB,IAAIp5H,GAAWiD,EAAKm2H,qBAAqB,SAACpnI,GAEnEf,EAAKmmI,cAAcjyH,SAxSjB,EAEC,EAsSgCnT,EAAY,KAC/Cf,EAAK+nI,oBACP,IAEA/nI,EAAKooI,gBAAkB,IAAI/5H,GAAiB2D,EAAKo2H,gBAAiB,CAChEttI,KAxSE,EAySFI,IAtSE,EAuSFwT,IAzSC,EA0SDV,QAAS,SAACzb,GACRyN,EAAKqoI,aAAan0H,SAASlU,EAAKi+B,aAAe1rC,EAAIyN,EAAKsoI,eAAe5jJ,SACvEsb,EAAK+nI,oBACP,IAGF/nI,EAAKsoI,eAAiB,IAAIj6H,GAAiB2D,EAAKs2H,eAAgB,CAC9DxtI,KA5SE,EA6SFI,IA3SE,EA4SFwT,IAAK,EACLV,QAAS,SAACzb,GACRyN,EAAKqoI,aAAan0H,SAASlU,EAAKi+B,aAAe1rC,EAAIyN,EAAKooI,gBAAgB1jJ,SACxEstB,EAAKu2H,iBAAiBriI,YAAclG,EAAKqoI,aAAav4I,MAAMpL,MAC5Dsb,EAAK+nI,oBACP,EACA95H,IAAK,SAAC1b,GACJ,IAASH,EAA2E3D,EAAtEqf,GAAcvb,EAAIyN,EAAKooI,gBAAgB1jJ,QAAUsb,EAAKi+B,aAAc,GAAE,GAA1E,GACVjsB,EAAKu2H,iBAAiBriI,YAAc9T,EACpC4f,EAAKw2H,mBAAmBtiI,YAAc9T,CACxC,IAGF4N,EAAKqoI,aAAe,IAAIh6H,GAAiB2D,EAAKq2H,aAAc,CAC1DvtI,KAtTE,EAuTFI,IAAK,EACLwT,IAAK,EACLV,QAAS,SAACzb,GACRyN,EAAKsoI,eAAep0H,SAAS3hB,EAAIyN,EAAKooI,gBAAgB1jJ,QAAUsb,EAAKi+B,cACrEjsB,EAAKw2H,mBAAmBtiI,YAAclG,EAAKsoI,eAAex4I,MAAMpL,MAChEsb,EAAK+nI,oBACP,EACA95H,IAAK,SAAC1b,EAAWH,GACf4f,EAAKu2H,iBAAiBriI,YAAc9T,EACpC4f,EAAKw2H,mBAAmBtiI,YAAc/V,OAAO2J,KAAKC,MAAMxH,EAAIyN,EAAKi+B,cACnE,IAGF,IAAMwqG,EAAoB,SAACh2I,GACX,UAAVA,EAAEjO,MAEH2F,MAAMkmB,WAAW2B,EAAKi1H,yBAAyBviJ,OAAS,MACxDyF,MAAMkmB,WAAW2B,EAAKg1H,oBAAoBtiJ,OAAS,MAEpDstB,EAAK80H,mBAAmBhsH,QAE5B,EACApf,GAAI1K,KAAKghB,EAAKi1H,yBAA0B,SAAS,SAACx0I,GAAuBg2I,EAAkBh2I,EAAG,IAC9FiJ,GAAI1K,KAAKghB,EAAKg1H,oBAAqB,SAAS,SAACv0I,GAAuBg2I,EAAkBh2I,EAAG,IAEzF,IAAMi2I,EAAqB,SAACj2I,GACZ,UAAVA,EAAEjO,MAEH2F,MAAMkmB,WAAW2B,EAAKq1H,0BAA0B3iJ,OAAS,MACzDyF,MAAMkmB,WAAW2B,EAAKo1H,qBAAqB1iJ,OAAS,MAErDstB,EAAKm1H,oBAAoBrsH,QAE7B,EACApf,GAAI1K,KAAKghB,EAAKq1H,0BAA2B,SAAS,SAAC50I,GAAuBi2I,EAAmBj2I,EAAG,IAChGiJ,GAAI1K,KAAKghB,EAAKo1H,qBAAsB,SAAS,SAAC30I,GAAuBi2I,EAAmBj2I,EAAG,IAE3FiJ,GAAI1K,KAAKghB,EAAK61H,YAAa,UAAU,WACnCnsI,GAAI2E,KAAK2R,EAAK22H,gBACd,IAAMC,EAAY,SAACC,GACjBntI,GAAIyE,KAAK6R,EAAK22H,gBACd32H,EAAK22H,eAAeziI,YAAc9C,GAAUylI,EAC9C,EACM5vG,EAAS5oB,WAAW2B,EAAK61H,YAAYnjJ,OAAS,IAAM,IAC1D,OAAIyF,MAAM8uC,GAAgB2vG,EAAUxlI,IACrB,IAAX61B,EAAqB2vG,EAAUxlI,KACnCpD,EAAK0mI,cAAcztG,OAASA,OAC5Bj5B,EAAK6mI,wBACP,IAEA7mI,EAAK8oI,iBAAmBptI,GAAImG,cAAcmQ,EAAKozH,YAAa,mBAAkB,IACvCpzI,EADuCC,EAAAC,GAC5D8N,EAAK8oI,kBAAgB,QAAAhvF,EAAA,WAAE,IAA9B9rB,EAAGh8B,EAAAtN,MACZgX,GAAI1K,KAAKg9B,EAAK,SAAS,WACjBA,EAAIxuB,UAAUhD,SAAS,cAC3Bd,GAAI2E,KAAK2R,EAAK+2H,YACd/2H,EAAKg3H,aAAaxpI,UAAUmN,OAAO,WAAYqhB,EAAI5oB,QAAQ+zB,UAAY5F,IACvEvzB,EAAKipI,mBAAmBj7G,EAAI5oB,QAAQ+zB,SACtC,GACF,EAPA,IAAAlnC,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAAuxD,GAOC,OAAAv0D,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CAcqB,OAZtBsN,EAAK49D,cAAgB,IAAI1nB,GACvBlkC,EAAK4rD,cAAatuE,EAAAzL,IAAAA,MAClB,SAAAiR,IAAA,OAAAjR,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,cAAA6L,EAAA7L,KAAA,EACQ2oB,KAAMqhD,YAAW,OACvBnzD,EAAKkkI,gBAAe,wBAAAlvI,EAAAnJ,OAAA,GAAAiJ,EAAA,MAIxBgd,KAAMilC,mBAAmB,CACvB1X,QAAS,SAAC4X,GAAwBj3C,EAAK2sE,kBAAkB11B,EAAM,IAGjEj3C,EAAK0lC,WAAW/sC,GAAMqH,CACxB,CAi5CC,OAj5CAxP,EAAA8yI,EAAA,EAAA9+I,IAAA,SAAAE,MAED,WACEmC,KAAKi9C,MAAMolG,MACb,GAAC,CAAA1kJ,IAAA,aAAAE,OAAAm5C,EAAAvuC,EAAAzL,IAAAA,MAED,SAAAuR,EAAkBuD,GAAgB,IAAAwwI,EAAA7qG,EAAA,OAAAz6C,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OAKe,GAJ/CtC,KAAKuiJ,aACLviJ,KAAKwiJ,uBAEa1wI,GAAuC,IAA9BzU,OAAOkH,KAAKuN,GAAOvO,SAC/BuO,EAAQrH,EAAMuB,WAAW+vI,KACnCjqI,GAAUmZ,KAAM8sB,UAAUjmC,EAAMmf,SAAYhG,KAAM8sB,UAAUjmC,EAAMof,SAAQ,CAAA1iB,EAAAlM,KAAA,QAClD,OAA3BtC,KAAK0+I,uBAAsBlwI,EAAAvM,OAAA,iBAeX,OATd6P,IAAUA,EAAMwgC,UACZmF,EAASpD,GAAcviC,EAAMw1B,KAAMx1B,EAAMmf,OAAQnf,EAAMof,SAC7Dpf,EAAMk8B,QAAyB,QAAlBs0G,EAAG7qG,aAAM,EAANA,EAAQzJ,eAAO,IAAAs0G,EAAAA,EAAI,GACnCxwI,EAAMwgC,QAAU5F,GACZ+K,SAAAA,EAAQlB,sBAAuBzkC,EAAMwgC,QAAU3F,GAC1C8K,SAAAA,EAAQb,kBAAiB9kC,EAAMwgC,QAAU1F,KAIpD5sC,KAAK8R,MAAQA,EAAKtD,EAAAlM,KAAA,GACZtC,KAAKyiJ,iBAAiB3wI,GAAM,QAClC9R,KAAK0iJ,cAAa,yBAAAl0I,EAAAxJ,OAAA,GAAAuJ,EAAA,UACnB,SAAAvG,GAAA,OAAAgvC,EAAApuC,MAAA,KAAAD,UAAA,KAAAhL,IAAA,cAAAE,OAAAo/I,EAAAx0I,EAAAzL,IAAAA,MAED,SAAA2mB,IAAA,IAAAg/H,EAAAC,EAAAC,EAAAC,EAAAC,EAAA53H,EAAArZ,EAAAw1B,EAAArW,EAAAC,EAAA8c,EAAAsE,EAAA5zB,EAAAskI,EAAA1yG,EAAAC,EAAA0yG,EAAAlyG,EAAAC,EAAApD,EAAA2uB,EAAA9kB,EAAAyrG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAroG,EAAAtb,EAAA93B,EAAAyV,EAAA4wC,EAAAq1F,EAAA73I,EAAAwmC,EAAAC,EAAAqxG,EAAApsG,EAAA/E,EAAAoxG,EAAA/jG,EAAA,OAAA1iD,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OASG,GARO6oB,EAAgBnrB,KAAhBmrB,KAAMrZ,EAAU9R,KAAV8R,MACNw1B,EAA4Cx1B,EAA5Cw1B,KAAMrW,EAAsCnf,EAAtCmf,OAAQC,EAA8Bpf,EAA9Bof,QAAS8c,EAAqBl8B,EAArBk8B,QAASsE,EAAYxgC,EAAZwgC,QAAO5zB,EAEgD,CAACuM,KAAMoW,OAAOpQ,GAAShG,KAAMoW,OAAOnQ,IAAlHof,GAA2H0yG,EAAAtkI,EAAA,IAAnIC,OAA2B4xB,EAASyyG,EAAhBh3G,MAA8B+E,GAAzBkyG,EAAAvkI,EAAA,IAAiBC,OAA4BqyB,EAAUiyG,EAAjBj3G,MACxEhsC,KAAK+1C,MAAQ,GAAHhqC,OAAMukC,EAAU,KAAAvkC,OAAIglC,GAC9Bl8B,GAAI2E,KACF2R,EAAKu4H,qBAAsBv4H,EAAKw4H,UAAWx4H,EAAKgzH,aAAchzH,EAAK8yH,YACnE9yH,EAAKkzH,aAAclzH,EAAKy4H,SAAUz4H,EAAK04H,mBAGrC,CAAC5yH,EAAQC,EAA4B,QAArByxH,EAAEpyG,aAAS,EAATA,EAAWtE,gBAAQ,IAAA02G,EAAAA,EAAI1xH,EAA4B,QAAtB2xH,EAAE5xG,aAAU,EAAVA,EAAY/E,gBAAQ,IAAA22G,EAAAA,EAAI1xH,GAAS0gG,MAAK,SAAC7zG,GAAe,OAAMkN,KAAMymB,aAAa3zB,EAAQ,IAAG,CAAF6F,EAAAthB,KAAA,QAC5G,OAA/BuS,GAAIyE,KAAK6R,EAAK04H,kBAAiBjgI,EAAA3hB,OAAA,iBA0BjC,GAtBA4S,GAAIyE,KAAK6R,EAAK24H,eACdr5I,EAAMgE,WAAWstI,GAAQjqI,GAEnB87B,EAAW3iB,KAAM2iB,SACjB2uB,EAAWwnF,GAAWjyI,EAAO87B,IAC/B6J,EAASpD,GAAc/M,EAAMrW,EAAQC,MAEpBumB,EAAOlB,sBAAwB5J,GAAe8K,EAAOV,wBAA0BrK,GAAiBE,MAChG0F,IAASmF,OAASh2C,GAEvCoT,GAAIqf,OAAOujB,EAAQtsB,EAAK64H,eAElBd,EAASljJ,KAAKikJ,eAAiB5mJ,OAAOyjI,OAAO,CAAC,EAAGub,GAA2B,CAChFn3H,SAAUq3C,EACV2nF,YAAalkJ,KAAKmkJ,qBAAqBlzH,GACvCmzH,aAAcpkJ,KAAKmkJ,qBAAqBjzH,GACxCghB,cAAe,GACfC,eAAgB,GAChBuH,WAAYr8C,OAAOyjI,OAAO,CAAC,EAAG0b,IAC9B7iG,YAAat8C,OAAOyjI,OAAO,CAAC,EAAG0b,MAG7B/kG,EAAQ,CAMV,IALiC2rG,GADvBD,EACuH1rG,GAAzHV,wBAAuDssG,EAAQF,EAA/B5sG,sBAAkD+sG,EAAMH,EAAvBvsG,gBAAqCqE,EAAYkoG,EAAxBtsG,SAAYoE,aAC9Gj7C,KAAKqkJ,gBAAiB,EAGhB1kH,EAAMujH,EACZr7I,EAAA,EAAAyV,EAAqBjgB,OAAOkgB,QAAQk6B,GAAO5vC,EAAAyV,EAAA/Z,OAAAsE,IAAAqmD,EAAAtmD,EAAA0V,EAAAzV,GAAA,GAA/B4D,EAACyiD,EAAA,GAAExiD,EAACwiD,EAAA,QAA4CzsD,IAAXk+B,EAAIl0B,KAAkBk0B,EAAIl0B,GAAKC,GAEhFw3I,EAAOxpG,WAAar8C,OAAOyjI,OAAO,CAAC,EAAG0b,GAAuB/kG,EAAOZ,SAAS6C,YAC7EwpG,EAAOvpG,YAAct8C,OAAOyjI,OAAO,CAAC,EAAG0b,GAAuB/kG,EAAOZ,SAAS8C,aAC9EupG,EAAOgB,YAAczsG,EAAO6sG,mBAAqB,CAAC,EAClDpB,EAAOkB,aAAe3sG,EAAO8sG,oBAAsB,CAAC,EACpDrB,EAAOjoG,aAAeA,EAElBmoG,GACFF,EAAOhxG,cAAgBkxG,EAAMlxG,cAC7BgxG,EAAO/wG,eAAiBixG,EAAMjxG,eAC9B+wG,EAAO5G,eAAiB8G,EAAM9G,eAC9B4G,EAAOxjG,YAAc0jG,EAAM1jG,aAClB2jG,GACDnxG,EAAkCmxG,EAAlCnxG,cAAeC,EAAmBkxG,EAAnBlxG,eACvB+wG,EAAOhxG,cAAgB9qC,MAAMI,KAAK0qC,GAAe,SAAChoC,GAAkC,MAAO,CAAE0oC,KAAM1oC,EAAE0oC,KAAMK,UAAW/oC,EAAEkqI,WAAa,IACrI8O,EAAO/wG,eAAiB/qC,MAAMI,KAAK2qC,GAAgB,SAACjoC,GAAkC,MAAO,CAAE0oC,KAAM1oC,EAAE0oC,KAAMK,UAAW/oC,EAAEkqI,WAAa,IACvI8O,EAAO9wG,OAASixG,EAASjxG,OACzB8wG,EAAO5G,eAAiB+G,EAAS/G,eACjC4G,EAAO3G,iBAAmB8G,EAAS9G,kBAC1B+G,IAETJ,EAAO9wG,OAASkxG,EAAOtjG,cACvBkjG,EAAO3G,iBAAmB+G,EAAOkB,mBACjCtB,EAAOpsG,cAA6C,QAAhC0sG,EAAG/rG,EAAOZ,SAASC,qBAAa,IAAA0sG,EAAAA,EAAI,GAE1D3uI,GAAIqf,QAAQqoC,EAAUpxC,EAAKgzH,aAAchzH,EAAK8yH,YAChD,MACEj+I,KAAKqkJ,gBAAiB,EACtBxvI,GAAIqf,QAAQqoC,EAAUpxC,EAAKkzH,cAI7Br+I,KAAK6/I,cAAgBxzI,KAAKG,MAAMH,KAAKC,UAAU42I,IAAQt/H,EAAAlW,GAE/C4kC,EAAO1uB,EAAAthB,KAAAshB,EAAAlW,KACRg/B,GAAc,GAAA9oB,EAAAlW,KAGdi/B,GAAY,GAAA/oB,EAAAlW,KAGZk/B,GAAe,oBALmD,OAArEzhB,EAAK0nH,eAAexzH,YAAc9C,GAAUA,IAAyBqH,EAAA3hB,OAAA,oBAGF,OAAnEkpB,EAAK0nH,eAAexzH,YAAc9C,GAAUA,IAAuBqH,EAAA3hB,OAAA,oBAGnEkpB,EAAK0nH,eAAexzH,YAAc9C,GAAUA,IAA2B,QASxB,OANnD4zB,GAAkBllC,SAASqC,KAAM2jB,EAAQC,EAASoW,GAClDzyB,GAAIqf,OAAOoe,IAAY1F,GAAiBzhB,EAAKs5H,kBAAmBt5H,EAAKg0H,kBACrEtqI,GAAIqf,OAAMtrB,MAAViM,GAAG,CAAQmZ,QAAQggB,IAAQjiC,OAAArE,EAAKmN,GAAImG,cAAc/P,SAASqC,KAAM,sBAEjEuH,GAAIqf,OAAOqoC,EAAUpxC,EAAKu5H,iBAC1B7vI,GAAIqf,OAAO8Z,EAAS7iB,EAAKw5H,sBACrB32G,GAASqD,GAAepmC,SAASqC,KAAM0gC,GAAQpqB,EAAAthB,KAAA,GAE7CtC,KAAK4kJ,oBAAmB,QAExBxtG,EAAap3C,KAAKo3C,aACxBp3C,KAAK6kJ,sBAAwB5xI,KAAKC,MAAMD,KAAKqB,IAAI,EAzgBrC,IAygB2E8iC,IACvFp3C,KAAKyhJ,eAAe55H,IAAM7nB,KAAK6kJ,sBAC/B7kJ,KAAKwhJ,aAAa35H,IAAM7nB,KAAK6kJ,sBAAwBztG,EACrDp3C,KAAKwhJ,aAAantI,IAAM+iC,EAExBp3C,KAAKw9I,SAAShmE,SAASvmD,GAAQ,GAC/BjxB,KAAKu9I,UAAU/lE,SAAStmD,GAAS,GACTmhB,EAAmBryC,KAAnCm3C,aAAgB9E,aACxBryC,KAAKgzI,gBAAgB/wB,UAAU,CAAEj0E,QAASA,EAAmBsE,QAAAA,EAASD,aAAAA,EAAchmB,KAAMrsB,KAAK6/I,gBAGzF4D,GAAqBhsG,GAAUz3C,KAAKyjJ,kBAAkBzjJ,KAAK6/I,cAAc3tG,cAAelyC,KAAK6/I,cAAc1tG,gBAC3GuN,EAA0D,QAA/CmjG,EAAS,QAATC,EAAGrrG,SAAM,IAAAqrG,GAAyB,QAAzBC,EAAND,EAAQ/rG,+BAAuB,IAAAgsG,OAAzB,EAANA,EAAiCrjG,mBAAW,IAAAmjG,EAAAA,EAAIp2G,GACpEthB,EAAKw0H,kBAAkB9hJ,MAAQ6hD,EAC3BpN,IAAY1F,IAAoB62G,GAAqB/jG,IAAgBjT,GAAyBzsC,KAAK8kJ,kBAClG9kJ,KAAKo/I,qBAEVp/I,KAAKk+I,oBAELrpI,GAAI2E,KAAK2R,EAAK24H,eACdjvI,GAAIyE,KAAK6R,EAAKu4H,qBAAsBv4H,EAAKw4H,WAAU,yBAAA//H,EAAA5e,OAAA,GAAA2e,EAAA,UACpD,kBAAAs5H,EAAAr0I,MAAA,KAAAD,UAAA,KAAAhL,IAAA,uBAAAE,MAED,WAAwB,IAAAqoB,EAAA,KACtBlmB,KAAKw+D,WAAa,GAClB3pD,GAAImD,MAAMhY,KAAKmrB,KAAKo2F,cACpB,IADiC,IAAA32C,EAAA,WAC5B,IAAAjK,EAAAhzB,EAAAh2B,GAAQ2vB,EAAIq5B,EAAJr5B,KAAM2O,EAAO0qB,EAAP1qB,QAAS5U,EAAMs/B,EAANt/B,OAAM0jH,EAAApkF,EAAEl5B,KAClC,GADuDs9G,EAAbj8G,cAA8Bi8G,EAAfp+B,kBACjB,EAAG,CACzC,IAAAq+B,EAAoC9+H,EAAKiF,KAAjC6yH,EAAWgH,EAAXhH,YAAaiH,EAAUD,EAAVC,WACfj1E,EAAOguE,EAAYvyH,WAAU,GAC7BtL,EAAOtL,GAAI6W,cAAcskD,GAIX,OAHpBn7D,GAAI1K,KAAK6lE,EAAM,SAAS,WAAQ/kD,KAAM2yB,SAAS,WAAY,CAAEtW,KAAAA,EAAM4wC,OAAQ,cAAgB,IAC3F/3D,EAAKmnB,KAAKjoB,YAAcioB,EACxB29G,EAAW3sI,YAAY03D,GACvBn7D,GAAIyE,KAAK2rI,GAAW,UAEtB,CACA,IADC,IAAAv1E,EAAA,WACI,IAAA89C,EAAA5sD,EAAAxoD,GAAQrU,EAAIypH,EAAJzpH,KAAcktB,EAAMu8F,EAAdlsF,OAAyBpQ,EAAOs8F,EAAhBjuD,QAAkBp2B,EAAIqkF,EAAJrkF,KAAkBmH,EAAUk9E,EAAtBjsF,WAAqCwP,EAAWy8E,EAAxBnvB,YACjF,IAAKpzE,KAAMoW,OAAOpQ,KAAYhG,KAAMoW,OAAOnQ,GAAU,MAAF,WACnD,IAAM2tC,EAAK34C,EAAKiF,KAAK4yH,cAActyH,WAAU,GACvCtL,EAAOtL,GAAI6W,cAAcmzC,GACzBqmF,EAAK,CAAErmF,GAAAA,EAAI1+C,KAAAA,EAAMmnB,KAAMA,EAAMvjC,KAAAA,EAAMktB,OAAAA,EAAQC,QAAAA,EAASiY,KAAMA,EAAMg8G,KAAM,IAC5Ej/H,EAAKs4C,WAAWx7D,KAAKkiJ,GACrBh/H,EAAKiF,KAAKo2F,aAAajpG,YAAYumD,GACnC1+C,EAAKilG,SAAS3lG,IAAM5K,GAAImK,SAASsxB,GACjCnwB,EAAKklG,UAAU5lG,IAAM5K,GAAImK,SAAS+xB,GAClC5wB,EAAKmwB,WAAWh4B,YAAYzD,GAAI2vD,UAAUnjC,EAAOpQ,IAAS,IAC1D9Q,EAAK4wB,YAAYz4B,YAAYzD,GAAI2vD,UAAUnjC,EAAOnQ,IAAU,IAC5D/Q,EAAKmnB,KAAKjoB,YAAcioB,EAExB,IADA,IAAM89G,EAAel/H,EAAKm/H,uBAAuBp0H,EAAQC,GACzDzY,EAAA,EAAA21C,EAA+B/wD,OAAOkgB,QAAQsvB,IAAgBp0B,EAAA21C,EAAA7qD,OAAAkV,IAAE,CAA3D,IAAA41C,EAAAzmD,EAAAwmD,EAAA31C,GAAA,GAAOu1B,EAAOqgB,EAAA,GAAE/c,EAAK+c,EAAA,GACxB,GAAI+2F,EAAap3G,GAAU,CACzB,IAAMuD,EAAMrrB,EAAKiF,KAAK2yH,YAAYryH,WAAU,GAC5C8lB,EAAI9xB,IAAM6xB,EAAMxE,KAChB3sB,EAAKglI,KAAK7sI,YAAYi5B,GACtB2zG,EAAGC,KAAKniJ,KAAKgrC,EACf,CACF,CACAn5B,GAAI1K,KAAK00D,EAAI,SAAS,WAAQ34C,EAAKo/H,gBAAgBh+G,EAAMrW,EAAQC,EAAS,GAC5E,EAtBA9Y,EAAA,EAAAwoD,EAAiHvjE,OAAO+C,OAAO61C,GAAQ79B,EAAAwoD,EAAAr9D,OAAA6U,IAAAs3D,GAuBzI,EAlCA/3D,EAAA,EAAAg2B,EAAkFtwC,OAAO+C,OAAO6qB,KAAMuc,WAAU7vB,EAAAg2B,EAAApqC,OAAAoU,IAAAizD,IAmChH,GAA+B,IAA3B5qE,KAAKw+D,WAAWj7D,OAAc,CAChC,IAAA29D,EAA6DlhE,KAAKmrB,KAA1Do6H,EAAoBrkF,EAApBqkF,qBAAsBC,EAAetkF,EAAfskF,gBAAiBC,EAASvkF,EAATukF,UAC/C5wI,GAAI2E,KAAK+rI,EAAsBC,GAC/B3wI,GAAIyE,KAAKmsI,EACX,MAAO5wI,GAAI2E,KAAKxZ,KAAKmrB,KAAKs6H,WAC1B,IAAM95C,EAAY1gF,KAAMymB,aACxB1xC,KAAKw+D,WAAW/jC,MAAK,SAAC9zB,EAAcyT,GAAiB,IAAAsrI,EAAAC,EAAAC,EAAAC,EAC9CC,EAA4B,QAAxBJ,EAAiB,QAAjBC,EAAWh/I,EAAEwiC,YAAI,IAAAw8G,OAAA,EAANA,EAAQjoD,aAAK,IAAAgoD,EAAAA,EAAI,EAA1BK,EAA0C,QAAtCH,EAA+B,QAA/BC,EAAyBzrI,EAAE+uB,YAAI,IAAA08G,OAAA,EAANA,EAAQnoD,aAAK,IAAAkoD,EAAAA,EAAI,EAKzD,OAJIj6C,EAAUhlG,EAAEsqB,SAAW06E,EAAUvxF,EAAE6W,UACrC60H,GAAQn6C,EAAUhlG,EAAEsqB,QACpB80H,GAAQp6C,EAAUvxF,EAAE6W,SAEf80H,EAAOD,CAChB,GACF,GAAC,CAAAnoJ,IAAA,sBAAAE,MAED,SAAqBkgB,GACnB,OAAOuwB,GAAoBvwB,EAC7B,GAAC,CAAApgB,IAAA,mBAAAE,MAED,SAAkBo3C,EAAyBU,GACzC,IAAQiC,EAAoC53C,KAApC43C,eAAgBC,EAAoB73C,KAApB63C,gBACxB1xB,EAAqB,CAACnmB,KAAKsuC,oBAAoB2G,EAAWl3B,SAAU/d,KAAKsuC,oBAAoBqH,EAAY53B,UAAlGk6B,EAAI9xB,EAAA,GAAE+xB,EAAI/xB,EAAA,GACVgyB,IAAiCP,aAAc,EAAdA,EAAgB5H,YAAa,GAAKiI,EAAKpI,IAAII,MAA9DmI,IAAsEP,aAAe,EAAfA,EAAiB7H,YAAa,GAAKkI,EAAKrI,IAAII,MAChIsI,EAAgCtD,EAAWuD,QAAQxI,UAAYiI,EAAK/H,IAAID,MAA1DwI,EAAiE9C,EAAY6C,QAAQxI,UAAYkI,EAAKhI,IAAID,MAG/H,MAAO,CAAEyI,UAFSH,EAAeJ,EAEbQ,WADDF,EAAgBL,EACHG,aAAAA,EAAcE,cAAAA,EAAeN,aAAAA,EAAcC,cAAAA,EAC7E,GAAC,CAAAz6C,IAAA,aAAAE,MAED,WACE,IAAAmoJ,EAA2EhmJ,KAAnE8R,MAASw1B,EAAI0+G,EAAJ1+G,KAAMrW,EAAM+0H,EAAN/0H,OAAU8kB,EAA0C/1C,KAA1C+1C,MAAuB1D,EAAmBryC,KAAnCm3C,aAAgB9E,aAKxD,OAJWpnB,KAAMuc,UAAUF,GACT2O,QAAQF,GAClB1M,QACiBpe,KAAMoW,OAAOpQ,GAA9Bvc,SACYC,aAAaC,iBAAmBy9B,CACtD,GAEA,CAAA10C,IAAA,cAAAE,MAIA,WACE,IACEstB,EAGEnrB,KAHFmrB,KAAI86H,EAGFjmJ,KAHI8R,MAASw1B,EAAI2+G,EAAJ3+G,KAAMrW,EAAMg1H,EAANh1H,OAAQC,EAAO+0H,EAAP/0H,QAAS8c,EAAOi4G,EAAPj4G,QAASsE,EAAO2zG,EAAP3zG,QAAWkrG,EAGxDx9I,KAHwDw9I,SAAUD,EAGlEv9I,KAHkEu9I,UAASjkG,EAG3Et5C,KAFFm3C,aAAgB9E,EAAYiH,EAAZjH,aAAciF,EAAagC,EAAbhC,cAAeiC,EAAQD,EAARC,SAAUC,EAASF,EAATE,UACvDqrG,EACE7kJ,KADF6kJ,sBAAsCv4H,EACpCtsB,KADqB6/I,cAAoCqD,EACzDljJ,KADyCikJ,eAAwBluG,EACjE/1C,KADiE+1C,MAErE3F,EAA8CnlB,KAAMoW,OAAOpQ,GAA3Cqf,EAAUF,EAAlBzxB,OAA8BnD,EAAG40B,EAAb17B,SAC5Bm8B,EAA+C5lB,KAAMoW,OAAOnQ,GAA5C6f,EAAWF,EAAnBlyB,OAA+BlD,EAAGo1B,EAAbn8B,SACvBumD,EAAKhwC,KAAMuc,UAAUF,GACrBvG,EAASk6B,EAAGhlB,QAAQF,GACTvc,EAAkBuH,EAA3BsI,QAAkBF,EAASpI,EAAToI,KACpBiO,EAAa5d,EAAUhe,EAAI7G,aAAaC,iBAAmBy9B,EAC3D6zG,EAAa,EAAI1qI,EAAI7G,aAAaC,iBAAmBy9B,EAAeiF,EAAgB77B,EAAI9G,aAAaC,iBACrGqyE,EAAS,CACbk/D,KAAM7uG,EAAgBjF,EACtB+zG,OAAQF,EACRt4I,IAAKqF,KAAKC,MAAMgzI,EAAat0G,IAC7BzI,KAAAA,GAGFvG,EAAkC,CAACtW,EAAIwqB,cAAexqB,EAAIwqB,eAArDuvG,EAAWzjH,EAAA,GAAE0jH,EAAY1jH,EAAA,GAC1B0P,IAAY1F,KACdy5G,EAAcrmJ,KAAK6/I,cAAc1tG,eAAe10B,QAAO,SAACm1B,EAAc1oC,GAAiB,OAAK0oC,EAAO1oC,EAAE0oC,IAAI,GAAE,GAC3G0zG,EAAetmJ,KAAK6/I,cAAc3tG,cAAcz0B,QAAO,SAACm1B,EAAc1oC,GAAiB,OAAK0oC,EAAO1oC,EAAE0oC,IAAI,GAAE,IAE7G,IAAMuD,EAAW3E,GAAkBhY,EAASvI,EAAQC,EAASiY,GACvDo9G,EAAcvmJ,KAAKumJ,cAGzBC,EAAyB5sG,GACvB3oB,EAAQC,EAASqoB,EAAUC,EAAWhgB,EAAS6sH,EAAaC,EAHyBC,EAA/EE,eAA+EF,EAA/DG,gBAA+DH,EAA9CrxG,oBAA8CqxG,EAAzB3wG,qBAK5DtpB,EAAIotB,WAAWG,oBAAqBvtB,EAAIqtB,YAAYE,qBAGtD,OAAA8T,GAAA,CACExiC,KAAAA,EAAMmB,IAAAA,EAAK42H,OAAAA,EAAQ57G,KAAAA,EAAM2zB,GAAAA,EAAIhqC,OAAAA,EAAQC,QAAAA,EAASohB,QAAAA,EAAStE,QAAAA,EAASqE,aAAAA,EAAciF,cAAAA,EAC9E2vC,OAAAA,EAAQ32C,WAAAA,EAAYS,YAAAA,EAAagF,MAAAA,EAAOvc,QAAAA,EAAS4d,WAAAA,EAAYytG,sBAAAA,EAC7D1uG,SAAAA,EAAU6D,OATEwsG,EAANxsG,OASYwjG,SAAAA,EAAUD,UAAAA,EAAWtjG,KATrBusG,EAAJvsG,MASkCssG,EAEpD,GAAC,CAAA5oJ,IAAA,cAAAE,MAED,WACE,IAAA8oJ,EAAuC3mJ,KAA/B8R,MAASmf,EAAM01H,EAAN11H,OAAQC,EAAOy1H,EAAPz1H,QACzBoS,EAAkC,CAACrY,KAAM8sB,UAAU9mB,GAAShG,KAAM8sB,UAAU7mB,IAArE+jB,EAAU3R,EAAA,GAAEqS,EAAWrS,EAAA,GAC9BqB,EAAoF,CAAC1Z,KAAMoW,OAAOpQ,GAAShG,KAAMoW,OAAOnQ,IAAS01H,EAAAjiH,EAAA,GAAjH4L,EAASq2G,EAAhB56G,MAA4BxwB,EAAGorI,EAAblyI,SAAQmyI,EAAAliH,EAAA,GAAkBqM,EAAU61G,EAAjB76G,MAA6BvwB,EAAGorI,EAAbnyI,SAC3D+xI,EAAiBl2G,EAAYA,EAAUtE,SAAWhb,EAClDy1H,EAAkB11G,EAAaA,EAAW/E,SAAW/a,EAC3D4iB,EAAgC,CAAC7oB,KAAMoW,OAAOolH,GAAgB/xI,SAAUuW,KAAMoW,OAAOqlH,GAAiBhyI,UAItG,OAAAi5C,GAAA,CACE1Y,WAAAA,EAAYU,YAAAA,EAAajF,UALXoD,EAAA,GAKsB5C,WALV4C,EAAA,GAKsBvD,UAAAA,EAAWS,WAAAA,EAC3Dx1B,IAAAA,EAAKC,IAAAA,EAAKgrI,eAAAA,EAAgBC,gBAAAA,EAAiBxxG,qBALlB,MACED,EAAWE,QAA+B,EAILS,sBALvC,MAEGD,EAAYR,QAA+B,GAIpEn1C,KAAKm7C,iBAAiBlG,EAAYU,GAEzC,GAAC,CAAAh4C,IAAA,qBAAAE,MAED,WACE,IAAQstB,EAASnrB,KAATmrB,KACRtW,GAAIyE,KAAK6R,EAAK27H,gBACdjyI,GAAI2E,KAAK2R,EAAK47H,aACd/mJ,KAAKgzI,gBAAgBz+G,QACvB,GAAC,CAAA52B,IAAA,oBAAAE,MAED,SAAmBq0C,EAAiCC,GAClD,GAA6B,IAAzBD,EAAc3uC,QAAgB2uC,EAAc3uC,SAAW4uC,EAAe5uC,OAAQ,OAAO,EACzF,IAAK,IAAIC,EAAI,EAAGA,EAAI0uC,EAAc3uC,OAAQC,IAAK,CAC7C,GAAI0uC,EAAc1uC,GAAGyvC,YAAcd,EAAe3uC,GAAGyvC,UAAW,OAAO,EACvE,GAAIf,EAAc1uC,GAAGovC,OAAST,EAAe3uC,GAAGovC,KAAM,OAAO,CAC/D,CACA,OAAO,CACT,GAAC,CAAAj1C,IAAA,sBAAAE,MAED,WACE,IAAAmpJ,EAAqChnJ,KAAKinJ,cAAlC36H,EAAG06H,EAAH16H,IAAKgmB,EAAO00G,EAAP10G,QAAS8E,EAAU4vG,EAAV5vG,WACCre,EAAgCzM,EAA/C4lB,cAAqClZ,EAAU1M,EAA1B6lB,eAG7B,GAAIpZ,EAAKx1B,OAAS,GAAKy1B,EAAMz1B,OAAS,EAAG,CACvC,IAAM0wI,EAAUl7G,EAAKtb,QAAO,SAAC5Y,EAAsB8+H,GAAoB,OAAKA,EAAK1wF,UAAYpuC,EAAKouC,UAAY0wF,EAAO9+H,CAAI,IACnHqvI,EAAWl7G,EAAMvb,QAAO,SAAC5Y,EAAsB8+H,GAAoB,OAAKA,EAAK1wF,UAAYpuC,EAAKouC,UAAY0wF,EAAO9+H,CAAI,IACrHqiJ,EAAiBnuH,EAAKx1B,OAASy1B,EAAMz1B,OACrC4jJ,EAAgBl0I,KAAKqB,IAAI,EAAGrB,KAAK4I,MAAOqrI,EAAkB,IAChE,GAAI50G,IAAY5F,GAAgB,CAC9BpgB,EAAI8lB,QAAU6hG,EAAQhhG,UAAYihG,EAASjhG,WAAa,EACxD,IAAMm0G,EAAWruH,EAAKtb,QAAO,SAAC5Y,EAAsB8+H,GAAoB,OAAKA,EAAK1wF,UAAYpuC,EAAKouC,UAAY0wF,EAAO9+H,CAAI,IACpHwiJ,EAAYruH,EAAMvb,QAAO,SAAC5Y,EAAsB8+H,GAAoB,OAAKA,EAAK1wF,UAAYpuC,EAAKouC,UAAY0wF,EAAO9+H,CAAI,IAEtHgjB,GADUu/H,EAASn0G,UAAYghG,EAAQhhG,WAAco0G,EAAUp0G,UAAYihG,EAASjhG,YAAc,GACnFk0G,EAAgB,GACrCnnJ,KAAK8gJ,SAASzzH,SAAsB,IAAbf,EAAI8lB,QAC3BpyC,KAAKihJ,eAAe5zH,UAAUf,EAAI8lB,OAAS+pG,IAAsBA,IACjEn8I,KAAKmhJ,eAAe9zH,SAAe,IAANxF,GAC7B7nB,KAAKohJ,qBAAqB/zH,UAAUxF,EAAMu0H,IAA4BA,GACxE,MAAO,GAAI9pG,IAAY3F,GAAc,CACnC,IACMukF,GADUn4F,EAAKtb,QAAO,SAAC/R,EAAWxB,GAAiB,OAAKwB,EAAIxB,EAAE+oC,SAAS,GAAE,GAAKja,EAAMvb,QAAO,SAAC/R,EAAWxB,GAAiB,OAAKwB,EAAIxB,EAAE+oC,SAAS,GAAE,IACzHi0G,EAAkB,GAluB5C,EAmuBDlnJ,KAAKs/I,cAAcjyH,SAAkB,IAAT6jG,GAC5BlxH,KAAKshJ,oBAAoBj0H,UAAU6jG,EAluBnC,GAEC,EAiuBH,CACA,IAAMt+E,EAAO7Z,EAAKtb,QAAO,SAAC/R,EAAWxB,GAAiB,OAAKwB,EAAIxB,EAAE0oC,IAAI,GAAE,GAAK5Z,EAAMvb,QAAO,SAAC/R,EAAWxB,GAAiB,OAAKwB,EAAIxB,EAAE0oC,IAAI,GAAE,GACjI00G,EAAer0I,KAAKqB,IAAI,EAAGrB,KAAKC,MAAM0/B,EAAO,EAAIu0G,IACvDnnJ,KAAKyhJ,eAAep0H,SAASi6H,GAC7BtnJ,KAAKwhJ,aAAan0H,SAASi6H,EAAeH,EAAgB/vG,GAC1Dp3C,KAAKuhJ,gBAAgBl0H,SAAS85H,EAChC,MAAW70G,IAAY1F,IACrB5sC,KAAKyhJ,eAAep0H,SAASf,EAAIwqB,eAEnC92C,KAAK8kJ,kBACL9kJ,KAAKkhJ,oBACP,GAAC,CAAAvjJ,IAAA,kBAAAE,MAED,WACE,IAAA0pJ,EAA6DvnJ,KAAKinJ,cAA1D97H,EAAIo8H,EAAJp8H,KAAMisB,EAAUmwG,EAAVnwG,WAAY9E,EAAOi1G,EAAPj1G,QAASuyG,EAAqB0C,EAArB1C,sBAE9B7kJ,KAAKuhJ,gBAAgBt4I,MAAMpL,QAC9BmC,KAAKuhJ,gBAAgBl0H,SA7uBlB,GA8uBHrtB,KAAKwhJ,aAAan0H,SA9uBf,GA8uBsDrtB,KAAKyhJ,eAAe5jJ,SAAWgnJ,GAAyBztG,IAE9Gp3C,KAAKyhJ,eAAex4I,MAAMpL,QAC7BmC,KAAKyhJ,eAAep0H,SAASw3H,GAC7B7kJ,KAAKwhJ,aAAan0H,SAAS+pB,EAAaytG,EAAwB7kJ,KAAKuhJ,gBAAgB1jJ,UAElFstB,EAAKg2H,eAAetjJ,QACvBmC,KAAKmhJ,eAAe9zH,SAAS+uH,IAC7Bp8I,KAAKohJ,qBAAqB/zH,SAAS,qBAEhClC,EAAKm0H,cAAczhJ,QAAOstB,EAAKm0H,cAAczhJ,MAAQyL,OAAO+3I,IAEjExsI,GAAI2E,KAAK2R,EAAK27H,gBACdjyI,GAAIyE,KAAK6R,EAAK47H,aAEd/mJ,KAAKwnJ,iBAAiBl1G,EACxB,GAAC,CAAA30C,IAAA,mBAAAE,MAED,SAAkBy0C,GAChB,IAAQnnB,EAAoCnrB,KAApCmrB,KAAcs8H,EAAsBznJ,KAA9BoV,KAAQqyI,gBAOtB,OANA5yI,GAAI2E,KACF2R,EAAKu8H,mBAAoBv8H,EAAK2nH,mBAAoB3nH,EAAKw8H,qBACvDx8H,EAAKy8H,kBAAmBz8H,EAAK08H,gBAAiB18H,EAAK28H,aAAc38H,EAAK48H,mBAExElzI,GAAIqf,OAAOuzH,EAAiBt8H,EAAK68H,iBACjCnzI,GAAIqf,QAAQuzH,EAAiBt8H,EAAK88H,WAC1B31G,GACN,KAAK3F,GACH93B,GAAIyE,KACF6R,EAAK48H,kBAAmB58H,EAAKu8H,mBAAoBv8H,EAAK2nH,mBACtD3nH,EAAKw8H,qBAAsBx8H,EAAKy8H,mBAElC,MACF,KAAKl7G,GACH73B,GAAIyE,KACF6R,EAAK48H,kBAAmB58H,EAAK08H,gBAAiB18H,EAAK2nH,mBACnD3nH,EAAKy8H,mBAEP,MACF,KAAKh7G,GACH/3B,GAAIyE,KAAK6R,EAAK28H,cAEpB,GAAC,CAAAnqJ,IAAA,qBAAAE,MAED,WAAsB,IAAAqqJ,EAAAC,EAAAC,EACpBC,EAAwCroJ,KAAKinJ,cAArC97H,EAAIk9H,EAAJl9H,KAAMmB,EAAG+7H,EAAH/7H,IAAKgmB,EAAO+1G,EAAP/1G,QAAStE,EAAOq6G,EAAPr6G,QAE5Bn5B,GAAI2E,KAAK2R,EAAKm9H,SACd,IAAMv2F,EAAW,SAACnkD,GAChBud,EAAKm9H,QAAQjpI,YAAczR,EAC3BiH,GAAIyE,KAAK6R,EAAKm9H,QAChB,EAEMnB,EAAgB70G,IAAY1F,GAAkB,EAAI5sC,KAAKuhJ,gBAAgB1jJ,QACzEyF,MAAM6jJ,IACRp1F,EAAS,qCAGX,IAAMu1F,EAAetnJ,KAAKyhJ,eAAe5jJ,QACrCyF,MAAMgkJ,IACRv1F,EAAS,oCAGX,IAAM3f,EAAS5oB,WAA8B,QAApB0+H,EAAC/8H,EAAK21H,SAASjjJ,aAAK,IAAAqqJ,EAAAA,EAAI,IAAM,IACnD5kJ,MAAM8uC,IACR2f,EAAS,4BAGX,IAAMw2F,EAAej2G,IAAY5F,GAAiBljB,WAAoC,QAA1B2+H,EAACh9H,EAAKg2H,eAAetjJ,aAAK,IAAAsqJ,EAAAA,EAAI,IAAM,IAAM,EAClG7kJ,MAAMilJ,IACRx2F,EAAS,mCAGX,IAAM3e,EAAcd,IAAY3F,GAAenjB,WAAmC,QAAzB4+H,EAACj9H,EAAKm0H,cAAczhJ,aAAK,IAAAuqJ,EAAAA,EAAI,IAAM,IAAM,EAC9F9kJ,MAAM8vC,IACR2e,EAAS,kCAEX,IAAMqiF,EAAahhG,EAAc,EAE3Bo1G,EAAyC,IAAlBrB,EAK7B,GAJAh8H,EAAK08H,gBAAgBlvI,UAAUmN,OAAO,WAAY0iI,GAClDr9H,EAAKg2H,eAAej8H,SAAWsjI,EAC/Bl8H,EAAIwqB,cAAgBwwG,EAEhBh1G,IAAY1F,GAAiB,CAC/B5sC,KAAK4/I,gBAAgB5xG,EAAUkuG,GAAmB5vH,EAAIozB,aACtD,IAAK,IAAI+oG,EAAS,EAAGA,EAAStB,EAAesB,IAAU,CACrD,IAAM99F,EAAY,CAAE/X,KAAM00G,GAC1B38F,EAAU1X,UAAYX,IAAY5F,GAAiB0F,EAASm2G,EAAeE,EAASrU,EACpF9nH,EAAI4lB,cAAclvC,KAAK2nD,GACvBr+B,EAAI6lB,eAAenvC,KAAK2nD,GAExB3qD,KAAKkgJ,cAAa,EAAMv1F,GACxB3qD,KAAKkgJ,cAAa,EAAOv1F,EAC3B,CAEA3qD,KAAKgzI,gBAAgBz+G,QACvB,CAEAv0B,KAAKqgJ,mBACP,GAAC,CAAA1iJ,IAAA,oBAAAE,MAED,WACEmC,KAAK0oJ,wBACL1oJ,KAAK2oJ,wBACP,GAAC,CAAAhrJ,IAAA,wBAAAE,MAED,WACE,IAAA+qJ,EAA4C5oJ,KAAKinJ,cAAzCjtG,EAAM4uG,EAAN5uG,OAAQxgB,EAAOovH,EAAPpvH,QAASgkH,EAAQoL,EAARpL,SAAUvjG,EAAI2uG,EAAJ3uG,KAEnCujG,EAASqL,gBAAgB7uG,EAAO9J,IAAI1e,KAAKohB,KAAMoH,EAAO9J,IAAIsK,MAAM5H,KAAMpZ,EAASwgB,EAAO9J,IAAI1e,KAAKhtB,IAAKw1C,EAAOnK,IAAIre,KAAKhtB,IAAKy1C,EAAKzoB,MAC9HgsH,EAASsL,mBACX,GAAC,CAAAnrJ,IAAA,yBAAAE,MAED,WACE,IAAAkrJ,EAAuD/oJ,KAAKinJ,cAApDjtG,EAAM+uG,EAAN/uG,OAAkBxgB,EAAOuvH,EAAjB5yG,SAAmBonG,EAASwL,EAATxL,UAAWtjG,EAAI8uG,EAAJ9uG,KAE9CsjG,EAAUsL,gBAAgB7uG,EAAO9J,IAAIsK,MAAM5H,KAAMoH,EAAO9J,IAAI1e,KAAKohB,KAAMpZ,EAASwgB,EAAO9J,IAAIsK,MAAMh2C,IAAKw1C,EAAOnK,IAAI2K,MAAMh2C,IAAKy1C,EAAKO,OACjI+iG,EAAUuL,mBACZ,GAAC,CAAAnrJ,IAAA,qBAAAE,MAED,WAAsB,IAAAmrJ,EACZ79H,EAASnrB,KAATmrB,KACRA,EAAKm0H,cAAczhJ,MAAQoV,KAAKqB,IAAI,EAAGkV,WAAmC,QAAzBw/H,EAAC79H,EAAKm0H,cAAczhJ,aAAK,IAAAmrJ,EAAAA,EAAI,KAAO3H,GAAgC37H,QAAQ,GAC7H1lB,KAAKkhJ,oBACP,GAAC,CAAAvjJ,IAAA,cAAAE,MAED,SAAakgB,GACX/d,KAAKs9I,eAAe9lE,SAASz5D,GAC7B/d,KAAKi9C,MAAM3jC,KAAKtZ,KAAKmrB,KAAKmyH,eAC5B,GAAC,CAAA3/I,IAAA,6BAAAE,MAED,WACE,IAAQstB,EAAenrB,KAAfmrB,KAAM/V,EAASpV,KAAToV,KACdA,EAAKqyI,iBAAmBryI,EAAKqyI,gBAC7B5yI,GAAIqf,OAAO9e,EAAKqyI,gBAAiBt8H,EAAK68H,iBACtCnzI,GAAIqf,QAAQ9e,EAAKqyI,gBAAiBt8H,EAAK88H,UACzC,GAAC,CAAAtqJ,IAAA,kBAAAE,OAAAm/I,EAAAv0I,EAAAzL,IAAAA,MAED,SAAA6mB,EAAuByjB,EAAcrW,EAAgBC,EAAiBohB,EAAkB22G,GAAsB,IAAA99H,EAAAssB,EAAA3lC,EAAA6iC,EAAAv6B,EAAA8yG,EAAA53G,EAAAD,EAAA0D,EAAAgpD,EAAAqjF,EAAA8D,EAAA7rI,EAAAmgH,EAAA3tF,EAAAs5G,EAAAC,EAAAruI,EAAAD,EAAAuuI,EAAAC,EAAAC,EAAAC,EAAAzR,EAAA0R,EAAAC,EAAAC,EAAA/X,EAAA,OAAA50I,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAGjD,GAFnD6oB,EAASnrB,KAATmrB,KACRnrB,KAAK4pJ,UAAY,CAAEtiH,KAAAA,EAAMrW,OAAAA,EAAQC,QAAAA,EAASohB,QAAS,KAClCyxG,GAAW/jJ,KAAK4pJ,UAAW3+H,KAAM2iB,UACpC,CAAF9pB,EAAAxhB,KAAA,SACJm1C,EAASpD,GAAc/M,EAAMrW,EAAQC,GACrCpf,EAAQ9R,KAAK8R,MAAQ9R,KAAK4pJ,UAAS9lI,EAAApW,IACjC,EAAIoW,EAAAxhB,KAAAwhB,EAAApW,KACLsgB,QAAQypB,aAAM,EAANA,EAAQb,iBAAgB,EAAA9yB,EAAApW,KAGhCsgB,QAAQypB,aAAM,EAANA,EAAQlB,uBAAsB,mBAFV,OAA/BzkC,EAAMwgC,QAAU1F,GAAe9oB,EAAA7hB,OAAA,oBAGH,OAA5B6P,EAAMwgC,QAAU3F,GAAY7oB,EAAA7hB,OAAA,oBAG5B6P,EAAMwgC,QAAU5F,GAAc,QAEH,OAA/B56B,EAAMk8B,QAAUyJ,aAAM,EAANA,EAAQzJ,QAAOlqB,EAAAxhB,KAAA,GACzBtC,KAAKyiJ,iBAAiBziJ,KAAK4pJ,WAAU,eAAA9lI,EAAAxhB,KAAA,GACrCtC,KAAK0iJ,cAAa,QACN,OAAlB1iJ,KAAKi9C,MAAMmE,QAAOt9B,EAAA7hB,OAAA,kBAGpBkuC,GAAkBhlB,EAAKozH,YAAattH,EAAQC,EAASoW,GACrDzyB,GAAImD,MAAMmT,EAAK0+H,kBAAmB1+H,EAAK2+H,oBAAmBn1G,EAC3C,CAAC1pB,KAAMoW,OAAOpQ,GAAShG,KAAMoW,OAAOnQ,IAA5C9W,EAACu6B,EAAA,GAAEu4E,EAACv4E,EAAA,GACXxpB,EAAK0+H,kBAAkBvxI,YAAYzD,GAAI2vD,UAAUpqD,GAAG,IACpD+Q,EAAK2+H,mBAAmBxxI,YAAYzD,GAAI2vD,UAAU0oD,GAAG,IAAM53G,EAAAjK,GACzCrL,KAAKiiJ,kBAAgB,IAAvC,IAAA3sI,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAc2T,EAAAxX,MAA+B8a,UAAUM,OAAO,WAAW,OAAAva,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACzE,IAAAkN,EAAA,EAAAgpD,EAAsB1kE,OAAO+C,OAAOJ,KAAK+pJ,WAAUhxI,EAAAgpD,EAAAx+D,OAAAwV,IAAnCgpD,EAAAhpD,GAAHouB,IAA4CxuB,UAAUM,OAAO,YAK1E,IAJAjZ,KAAKgqJ,mBAAmB/4H,EAAQC,GAChCrc,GAAI2E,KAAK2R,EAAK8+H,kBAAmB9+H,EAAK++H,YAAa/+H,EAAKg/H,yBAA0Bh/H,EAAK+2H,YACjFkD,EAAeplJ,KAAKqlJ,uBAAuBp0H,EAAQC,GACnDg4H,EAA6C,CAAC,EACpD7rI,EAAA,EAAAmgH,EAAkBngI,OAAO+C,OAAO6qB,KAAM2iB,SAASyK,OAAMh7B,EAAAmgH,EAAAj6H,OAAA8Z,IAA1CwyB,EAAG2tF,EAAAngH,GACR+nI,EAAav1G,EAAIpC,OAAO1pC,QAAOmlJ,EAAgBr5G,EAAIpC,OAAO1pC,MAAQ8rC,EAAIpC,QAEtE07G,EAAS9rJ,OAAOkH,KAAK2kJ,GAAiB3lJ,OACtC6lJ,EAAaD,EAAS,EAACpuI,EAAA1P,GACXrL,KAAKiiJ,kBAAgB,IAAvC,IAAAlnI,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,OAAWylC,EAAGrsB,EAAAjd,OAA+B8a,UAAUmN,OAAO,WAAYqhB,EAAI5oB,QAAQ+zB,UAAY5F,KAAmB08G,EAAW,OAAA1qJ,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CAC/E,IAA7CxO,OAAOkH,KAAK0mB,KAAM2iB,SAASyK,OAAO90C,QACpCsR,GAAIyE,KAAK6R,EAAK8+H,mBACdjqJ,KAAKoiJ,mBAAmB11G,MAElB68G,EAAY9+I,EAAMuB,WAAWgwI,KAAe,CAAC,EAC7CwN,EAAUD,EAAS,GAADx9I,OAAIklB,EAAM,KAAAllB,OAAImlB,EAAO,KAAAnlB,OAAIu7B,KAEjDgL,EAAiB,QAAVg3G,EAAGh3G,SAAO,IAAAg3G,EAAAA,EAAKE,EAAUA,EAAQl3G,QAAU3F,MAClCD,KAGVu8G,IAAep5G,EAAMq5G,EAAgBD,KAEpCp5G,GAAO25G,IAAS35G,EAAMq5G,EAA+B,QAAhBO,EAACD,EAAQx7G,eAAO,IAAAy7G,EAAAA,EAAI,KAEzD55G,IACG65G,EAAUj/I,EAAMuB,WAAWiwI,OACpBpsG,EAAMq5G,EAAgBQ,KAGhC75G,GAAOs5G,EAAS,IAAGt5G,EAAMxyC,OAAO+C,OAAO8oJ,GAAiB,KAE3Dr5G,GACF1kB,EAAKg3H,aAAaxpI,UAAUM,OAAO,YACnCjZ,KAAKoiJ,mBAA0B,QAARuH,EAACr3G,SAAO,IAAAq3G,EAAAA,EAAKH,EAAUA,EAAQl3G,QAAU3F,IAChE3sC,KAAKoqJ,cAAcv6G,EAAI9rC,QAEvBonB,EAAKg3H,aAAaxpI,UAAUC,IAAI,YAChC/D,GAAIyE,KAAK6R,EAAK++H,aACdlqJ,KAAKoiJ,mBAAmB11G,IAGsB,KADxCklG,EAAev0I,OAAOkH,KAAKsoC,IAAiBv5B,QAAO,SAAC06B,GAAe,OAAM/iB,KAAM2iB,SAASyK,MAAMrK,EAAQ,KACzEzqC,QAAyC,IAAxBquI,EAAaruI,SAAqC,YAApBquI,EAAa,IAAwC,cAApBA,EAAa,KAC5G/8H,GAAIyE,KAAK6R,EAAKg/H,4BAItCt1I,GAAIyE,KAAK6R,EAAKg3H,cAEdniJ,KAAKi9C,MAAM3jC,KAAK6R,EAAKozH,aAAY,yBAAAz6H,EAAA9e,OAAA,GAAA6e,EAAA,UAClC,SAAAlX,EAAAC,EAAAkB,EAAAC,EAAAM,GAAA,OAAA2uI,EAAAp0I,MAAA,KAAAD,UAAA,KAAAhL,IAAA,oBAAAE,MAED,WACMkmJ,GAAW/jJ,KAAK8R,MAAOmZ,KAAM2iB,WAAW5tC,KAAK0+I,uBACjD,IAAA2L,EAAoDrqJ,KAAK8R,MAAjDmf,EAAMo5H,EAANp5H,OAAQC,EAAOm5H,EAAPn5H,QAASoW,EAAI+iH,EAAJ/iH,KAAM0G,EAAOq8G,EAAPr8G,QAASsE,EAAO+3G,EAAP/3G,QACxCtyC,KAAKslJ,gBAAgBh+G,EAAMrW,EAAQC,EAASohB,EAAStE,EACvD,GAAC,CAAArwC,IAAA,qBAAAE,MAED,SAAoBysJ,GAClB,IACkE1qI,EADlE2qI,EAA8EvqJ,KAAtE4pJ,UAAa34H,EAAMs5H,EAANt5H,OAAQC,EAAOq5H,EAAPr5H,QAASoW,EAAIijH,EAAJjjH,KAAQ26G,EAAgCjiJ,KAAhCiiJ,iBAAkB8H,EAAc/pJ,KAAd+pJ,UAAkBlqI,EAAAxU,GAChC42I,GAAgB,IAAlE,IAAApiI,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAoE,KAAA8oJ,EAAA5qI,EAAA/hB,MAAvD8a,EAAS6xI,EAAT7xI,UAAsB25B,EAAOk4G,EAAlBjsI,QAAW+zB,QAAiC35B,EAAUmN,OAAO,WAAYwsB,IAAYg4G,EAAY,CACzH,OAAA5rJ,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CACA,GAAIy+I,IAAiB59G,GAArB,CACA,IAAMkB,EAAW3iB,KAAM2iB,SACvB,GAA2C,IAAvCvwC,OAAOkH,KAAKqpC,EAASyK,OAAO90C,OAAhC,CACA,IAAM6hJ,EAAeplJ,KAAKqlJ,uBAAuBp0H,EAAQC,GAEnDu5H,EAAYptJ,OAAO+C,OAAO2pJ,GAAWz2I,QAAO,SAACu8B,GAAc,OAAKA,EAAI1I,IAAIxuB,UAAUhD,SAAS,WAAW,IAC5G,IAAI80I,EAAUlnJ,SAAU6hJ,EAAaqF,EAAU,GAAG1mJ,MAAlD,CAEA,IACMylJ,GADY/+I,EAAMuB,WAAWgwI,KAAe,CAAC,GAC1B,GAADjwI,OAAIklB,EAAM,KAAAllB,OAAImlB,EAAO,KAAAnlB,OAAIu7B,IACjD,GAAIkiH,EAAS,KAAAkB,EACL76G,EAAMjC,EAASyK,MAAqB,QAAhBqyG,EAAClB,EAAQx7G,eAAO,IAAA08G,EAAAA,EAAI,IAC9C,GAAI76G,GAAOu1G,EAAav1G,EAAIpC,OAAO1pC,MAEjC,YADA/D,KAAKoqJ,cAAcv6G,EAAIpC,OAAO1pC,KAGlC,CAEA,IAAM2lJ,EAAUj/I,EAAMuB,WAAWiwI,IACjC,GAAIyN,EAAS,CACX,IAAM75G,EAAMjC,EAASyK,MAAMqxG,GAC3B,GAAI75G,GAAOu1G,EAAav1G,EAAIpC,OAAO1pC,MAEjC,YADA/D,KAAKoqJ,cAAcv6G,EAAIpC,OAAO1pC,KAGlC,CAEA,IAAMs0C,EAAQh7C,OAAO+C,OAAOwtC,EAASyK,OAAO/kC,QAAO,SAACu8B,GAAgB,OAAKu1G,EAAav1G,EAAIpC,OAAO1pC,KAAK,IAClGs0C,EAAM90C,QAAQvD,KAAKoqJ,cAAc/xG,EAAM,GAAG5K,OAAO1pC,KAtBU,CAJX,CAFT,CA6B7C,GAAC,CAAApG,IAAA,uBAAAE,MAED,WACEmC,KAAKmrB,KAAK4zH,kBAAkBlhJ,MAAQ,GACpCmC,KAAKg/I,iBACLh/I,KAAKi9C,MAAM3jC,KAAKtZ,KAAKmrB,KAAKw/H,iBAC5B,GAAC,CAAAhtJ,IAAA,iBAAAE,MAED,WAAkB,IAAA+sJ,EACVz/H,EAAOnrB,KAAKmrB,KACZ7X,EAAqC,QAA/Bs3I,EAAGz/H,EAAK4zH,kBAAkBlhJ,aAAK,IAAA+sJ,OAAA,EAA5BA,EAA8Bl7H,cAC7C7a,GAAImD,MAAMmT,EAAKo2F,cAAa,IACIzhG,EADJC,EAAA1U,GACXrL,KAAKw+D,YAAU,IAAhC,IAAAz+C,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,MAAkC,KAAvBwjJ,EAAEplI,EAAAjiB,MACXqnJ,EAAGrmF,GAAGlmD,UAAUM,OAAO,YACnB3F,IAAW4xI,EAAGnhJ,KAAKqkD,SAAS90C,IAChC6X,EAAKo2F,aAAajpG,YAAY4sI,EAAGrmF,GACnC,CAAC,OAAAngE,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CACH,GAAC,CAAAlO,IAAA,oBAAAE,MAED,SAAmB2I,GAEjB,GADAxG,KAAKk6G,iBAAiBp0B,kBAAkBt/E,GACnCxG,KAAKm3C,aAAV,CACA,IAAA0zG,EAAmD7qJ,KAAKinJ,cAAhDh2H,EAAM45H,EAAN55H,OAAQC,EAAO25H,EAAP35H,QAAS8f,EAAU65G,EAAV75G,WAAYT,EAASs6G,EAATt6G,UACjC/pC,EAAEuX,UAAYkT,GAAUzqB,EAAEuX,WAAYwyB,aAAS,EAATA,EAAWtE,UACnDjsC,KAAKw9I,SAASsN,iBACLtkJ,EAAEuX,UAAYmT,GAAW1qB,EAAEuX,WAAYizB,aAAU,EAAVA,EAAY/E,WAC5DjsC,KAAKu9I,UAAUuN,gBALa,CAOhC,GAAC,CAAAntJ,IAAA,uBAAAE,MAED,WAAwB,IAAAktJ,EAAAC,EACd7/H,EAA6BnrB,KAA7BmrB,KAA6BnrB,KAAvB6/I,cACV5kG,aAAiD,QAArC8vG,EAA4B,QAA5BC,EAAG7/H,EAAK8zH,4BAAoB,IAAA+L,OAAA,EAAzBA,EAA2BryF,eAAO,IAAAoyF,GAAAA,EACrD/qJ,KAAKqgJ,mBACP,GAAC,CAAA1iJ,IAAA,gBAAAE,OAAAk/I,EAAAt0I,EAAAzL,IAAAA,MAED,SAAAopB,IAAA,IAAAk4B,EAAA,OAAAthD,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OACqD,OAA7Cg8C,EAASrzB,KAAMuzB,QAAQx+C,KAAKmrB,KAAKozH,aAAYj4H,EAAAzhB,KAAA,EAAAyhB,EAAAhkB,KAAA,EAE3CtC,KAAKirJ,0BAAyB,OAE5B,OAF4B3kI,EAAAzhB,KAAA,EAEpCy5C,IAAQh4B,EAAA3gB,OAAA,2BAAA2gB,EAAAthB,OAAA,GAAAohB,EAAA,qBAEX,kBAAA22H,EAAAn0I,MAAA,KAAAD,UAAA,KAAAhL,IAAA,0BAAAE,OAAAi/I,EAAAr0I,EAAAzL,IAAAA,MAED,SAAA+sB,IAAA,IAAAmhI,EAAA//H,EAAA8xB,EAAAkuG,EAAAl6H,EAAAC,EAAAoW,EAAA8jH,EAAAC,EAAAC,EAAAC,EAAAtJ,EAAAwI,EAAAe,EAAAx9G,EAAA,OAAAhxC,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,OAEyD,GAA/C6oB,EAAsDnrB,KAAtDmrB,KAAM8xB,EAAgDj9C,KAAhDi9C,MAAKkuG,EAA2CnrJ,KAAzC4pJ,UAAa34H,EAAMk6H,EAANl6H,OAAQC,EAAOi6H,EAAPj6H,QAASoW,EAAI6jH,EAAJ7jH,KAE9Crc,KAAM8sB,UAAU9mB,GAAS,CAAF5G,EAAA/nB,KAAA,QAES,OADnCtC,KAAK+2E,cAAcS,SAASvmD,GAC5BgsB,EAAM3jC,KAAKtZ,KAAKmrB,KAAK4rD,eAAc1sD,EAAApoB,OAAA,oBAGhCgpB,KAAM8sB,UAAU7mB,GAAU,CAAF7G,EAAA/nB,KAAA,QAEQ,OADnCtC,KAAK+2E,cAAcS,SAAStmD,GAC5B+rB,EAAM3jC,KAAKtZ,KAAKmrB,KAAK4rD,eAAc1sD,EAAApoB,OAAA,iBAIV,GAD3BmpJ,EAC+BlkC,GAA2B5/E,EAAMrc,KAAMoW,OAAOpQ,GAAShG,KAAMoW,OAAOnQ,IAASm6H,EAAAzjJ,EAAAwjJ,EAAA,GAArGE,EAASD,EAAA,GAAEE,EAASF,EAAA,GACvBC,IAAcxgI,GAAe49F,YAAW,CAAAr+F,EAAA/nB,KAAA,SAET,OADjCtC,KAAKk6G,iBAAiB1iC,SAASvmD,EAAQqW,GACvC2V,EAAM3jC,KAAK6R,EAAK+uF,kBAAiB7vF,EAAApoB,OAAA,qBAG/BspJ,IAAczgI,GAAe49F,YAAW,CAAAr+F,EAAA/nB,KAAA,SAET,OADjCtC,KAAKk6G,iBAAiB1iC,SAAStmD,EAASoW,GACxC2V,EAAM3jC,KAAK6R,EAAK+uF,kBAAiB7vF,EAAApoB,OAAA,kBAKgE,GAD3FggJ,EAAqBjiJ,KAArBiiJ,oBACFwI,EAAYxI,EAAiB3uI,QAAO,SAAC6zB,GAAgB,OAAKA,EAAIxuB,UAAUhD,SAAS,WAAW,KACpFpS,OAAS,GAAC,CAAA8mB,EAAA/nB,KAAA,SAEG,OADzB6oB,EAAK+2H,WAAW7iI,YAAc9C,G1BjgCP,c0BkgCvB1H,GAAIyE,KAAK6R,EAAK+2H,YAAW73H,EAAApoB,OAAA,kBAGgD,IAA3DjC,KAAK4pJ,UAAUt3G,QAAsC,QAA/B44G,EAAGT,EAAU,GAAGlsI,QAAQ+zB,eAAO,IAAA44G,EAAAA,EAAI,MACzDx+G,GAAc,CAAAriB,EAAA/nB,KAAA,SACsF,MAA5GmoJ,EAAYptJ,OAAO+C,OAAOJ,KAAK+pJ,WAAWz2I,QAAO,SAACu8B,GAAc,OAAKA,EAAI1I,IAAIxuB,UAAUhD,SAAS,WAAW,KACnGpS,OAAS,GAAC,CAAA8mB,EAAA/nB,KAAA,SAEG,OADzB6oB,EAAK+2H,WAAW7iI,YAAc9C,G1BxgCb,U0BygCjB1H,GAAIyE,KAAK6R,EAAK+2H,YAAW73H,EAAApoB,OAAA,kBAIK,OAD1B+rC,EAAUy8G,EAAU,GAAG1mJ,KAC7B/D,KAAK4pJ,UAAU57G,QAAUA,EAAO3jB,EAAA/nB,KAAA,GAC1BtC,KAAKyiJ,iBAAiBziJ,KAAK4pJ,WAAU,QAG7C5pJ,KAAK8R,MAAQ9R,KAAK4pJ,UAElB5pJ,KAAK0iJ,cACL1iJ,KAAKi9C,MAAMmE,QAAO,yBAAA/2B,EAAArlB,OAAA,GAAA+kB,EAAA,UACnB,kBAAA+yH,EAAAl0I,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,OAAAg/I,EAAAp0I,EAAAzL,IAAAA,MAED,SAAAmxC,EAAwBr8B,GAAe,IAAAqZ,EAAA8F,EAAAC,EAAA8c,EAAA,OAAAhxC,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OAEI,GADjC6oB,EAASnrB,KAATmrB,KACA8F,EAAsCnf,EAAtCmf,OAAQC,EAA8Bpf,EAA9Bof,QAAS8c,EAAqBl8B,EAArBk8B,QAAqBl8B,EAAZwgC,UAClB5F,IAAmBsB,EAAO,CAAAK,EAAA/rC,KAAA,eAAA+rC,EAAApsC,OAAA,wBAAAosC,EAAAxpC,KAAA,EAAAwpC,EAAA/rC,KAAA,EAKZyqC,GAAGqB,WAAWJ,EAAS/c,GAAO,OAA1DjxB,KAAK43C,eAAcvJ,EAAAvsC,KAAAusC,EAAA/rC,KAAG,GAAH,cAGM,MAHN+rC,EAAAxpC,KAAG,GAAHwpC,EAAA3gC,GAAA2gC,EAAA,SAEnBljB,EAAK+2H,WAAW7iI,YAAc9C,GAAUA,GAAwB,CAAEyxB,QAAAA,EAASjwB,QAASzU,OAAO2nB,GAASvyB,IAAK4K,OAAM+kC,EAAA3gC,MAC/GmH,GAAIyE,KAAK6R,EAAK+2H,YAAW7zG,EAAA3gC,GAAA,eAAA2gC,EAAAxpC,KAAA,GAAAwpC,EAAA/rC,KAAA,GAKIyqC,GAAGqB,WAAWJ,EAAS9c,GAAQ,QAA5DlxB,KAAK63C,gBAAexJ,EAAAvsC,KAAAusC,EAAA/rC,KAAG,GAAH,cAGK,MAHL+rC,EAAAxpC,KAAG,GAAHwpC,EAAAslB,GAAAtlB,EAAA,UAEpBljB,EAAK+2H,WAAW7iI,YAAc9C,GAAUA,GAAwB,CAAEyxB,QAAAA,EAASjwB,QAASzU,OAAO4nB,GAAUxyB,IAAK4K,OAAM+kC,EAAAslB,MAChH9+C,GAAIyE,KAAK6R,EAAK+2H,YAAW7zG,EAAAslB,GAAA,yBAAAtlB,EAAArpC,OAAA,GAAAmpC,EAAA,2BAG5B,SAAAzqB,GAAA,OAAAm5H,EAAAj0I,MAAA,KAAAD,UAAA,KAAAhL,IAAA,uBAAAE,MAED,SAAsBkgB,GACpB,IAAM+1C,EAAY7oC,KAAMg7E,wBAAwBloF,GAChD,IAAK+1C,EAAU23F,iBACb,MAAO,CAAC,EAEV,IAC4CprI,EADtCkuG,EAAkC,CAAC,EAACjuG,EAAAjV,GACxByoD,EAAU23F,kBAAgB,IAA5C,IAAAnrI,EAAA/U,MAAA8U,EAAAC,EAAA9Z,KAAA9E,MAA8C,KAAnC4pB,EAAGjL,EAAAxiB,MACRytB,EAAIogI,gBAAkB3tI,IAAY/d,KAAK8R,MAAMof,UAGjDq9F,EAAQjjG,EAAI3tB,KAAO,GAAHoO,OAAMuf,EAAG,SAC3B,CAAC,OAAA5sB,GAAA4hB,EAAA1U,EAAAlN,EAAA,SAAA4hB,EAAAzU,GAAA,CACD,OAAO0iH,CACT,GAEA,CAAA5wH,IAAA,wBAAAE,MAKA,WACE,IAAImC,KAAKqkJ,eAAT,CACA,IAAQl5H,EAAwDnrB,KAAxDmrB,KAAsB+3H,EAAkCljJ,KAAlDikJ,eAAuC0H,EAAW3rJ,KAA1B6/I,cAGhC+L,EAAsB1I,EAAOxjG,cAAgBisG,EAAOjsG,YAC1Dv0B,EAAKw0H,kBAAkBhnI,UAAUmN,OAAO,WAAY8lI,GAEpD,IAAMC,EAAiB3I,EAAO9wG,SAAWu5G,EAAOv5G,OAChDjnB,EAAK61H,YAAYroI,UAAUmN,OAAO,WAAY+lI,GAG9C,IAAIC,GAAwB,EAC5B,GAAI5I,EAAOhxG,cAAc3uC,SAAWooJ,EAAOz5G,cAAc3uC,OACvDuoJ,GAAwB,OAExB,IAAK,IAAItoJ,EAAI,EAAGA,EAAI0/I,EAAOhxG,cAAc3uC,OAAQC,IAC/C,GAAI0/I,EAAOhxG,cAAc1uC,GAAGovC,OAAS+4G,EAAOz5G,cAAc1uC,GAAGovC,MAC3DswG,EAAOhxG,cAAc1uC,GAAGyvC,YAAc04G,EAAOz5G,cAAc1uC,GAAGyvC,UAAW,CACzE64G,GAAwB,EACxB,KACF,CAGJ3gI,EAAK4gI,0BAA0BpzI,UAAUmN,OAAO,WAAYgmI,GAG5D,IAAIE,GAAyB,EAC7B,GAAI9I,EAAO/wG,eAAe5uC,SAAWooJ,EAAOx5G,eAAe5uC,OACzDyoJ,GAAyB,OAEzB,IAAK,IAAIxoJ,EAAI,EAAGA,EAAI0/I,EAAO/wG,eAAe5uC,OAAQC,IAChD,GAAI0/I,EAAO/wG,eAAe3uC,GAAGovC,OAAS+4G,EAAOx5G,eAAe3uC,GAAGovC,MAC7DswG,EAAO/wG,eAAe3uC,GAAGyvC,YAAc04G,EAAOx5G,eAAe3uC,GAAGyvC,UAAW,CAC3E+4G,GAAyB,EACzB,KACF,CAGJ7gI,EAAK8gI,2BAA2BtzI,UAAUmN,OAAO,WAAYkmI,EAtC9B,CAuCjC,GAEA,CAAAruJ,IAAA,sBAAAE,MAIA,SAAqB6hD,GACnB,OAAQA,GACN,KAAKrT,GACH,MAAO,CAAC,aAAc,KACxB,KAAKC,GACL,KAAKC,GAEH,MAAO,CAAC,OADS,GAAHxgC,OAAMkf,KAAMoW,OAAOrhC,KAAK8R,MAAMof,SAASvS,OAAM,KAAA5S,OAAIkf,KAAMoW,OAAOrhC,KAAK8R,MAAMmf,QAAQtS,SAGjG,KAAK6tB,GACL,KAAKC,GACH,MAAO,CAAC,UAAW,KACrB,QACE,MAAM,IAAIjrC,MAAM,wBAADuK,OAAyB2zC,IAE9C,GAEA,CAAA/hD,IAAA,sBAAAE,MAIA,SAAqBo1C,EAAmBp1C,GACtC,OAAQo1C,GACN,KAAK5G,GACH,OAAIxuC,EAAQ,GAAKA,EAAQ,IAChB,uCAEF,KACT,KAAKyuC,GACL,KAAKC,GACH,OAAI1uC,GAAS,EACJ,8BAEF,KACT,KAAK2uC,GACL,KAAKC,GACH,OAAI5uC,GAAS,GAAKA,EAAQ,GACjB,mCAEF,KACT,QACE,MAAM,IAAI2D,MAAM,sBAADuK,OAAuBknC,IAG5C,GAEA,CAAAt1C,IAAA,mBAAAE,MAOA,SAAkBo1C,EAAmByM,EAAqBwsG,GACxD,OAAQxsG,GACN,KAAKrT,GACL,KAAKC,GACL,KAAKC,GACH,OAAO0G,EACT,KAAKzG,GACL,KAAKC,GACH,OAAIy/G,EACiB,IAAZj5G,EAEFA,EAAY,IACrB,QACE,MAAM,IAAIzxC,MAAM,sBAADuK,OAAuB2zC,IAE5C,GAEA,CAAA/hD,IAAA,eAAAE,MAMA,SAAc81C,EAAgBw4G,EAA6CzsG,GAAsB,IAAA34B,EAAA,KACvFoE,EAA6BnrB,KAA7BmrB,KAAqBmB,EAAQtsB,KAAvB6/I,cAEVzZ,EAAyBj7G,EAAKihI,wBAC9BC,EAA+BlhI,EAAKmhI,oBACpCC,EAA2BphI,EAAKo1H,qBAChCiM,EAAgCrhI,EAAKq1H,0BACrCiM,EAA0BthI,EAAKuhI,kBAC/B/4G,IACFyyF,EAAYj7G,EAAKwhI,uBACjBN,EAAkBlhI,EAAKyhI,mBACvBL,EAAcphI,EAAKg1H,oBACnBqM,EAAmBrhI,EAAKi1H,yBACxBqM,EAAathI,EAAK0hI,kBAGpBh4I,GAAI2E,KAAKizI,GAMT,IAAMK,EAAiB,WACrB,IAAK,IAAItpJ,EAAI,EAAGA,EAAI4iI,EAAU1rH,SAASnX,OAAS,EAAGC,IAAK,CACtD,IAAM8jD,EAAMzyC,GAAI6W,cAAc06G,EAAU1rH,SAASlX,IACjDqR,GAAIqf,OAAa,IAAN1wB,EAAS8jD,EAAIylG,OACxBl4I,GAAIqf,OAAO1wB,IAAM4iI,EAAU1rH,SAASnX,OAAS,EAAG+jD,EAAI0lG,QACtD,CACF,EAEAn4I,GAAI2E,KAAKizI,GACT,IAKI75G,EACAq6G,EACAC,EAPEC,EAAS,SAACzuJ,GACd+tJ,EAAWptI,YAAc3gB,EACzBmW,GAAIyE,KAAKmzI,EACX,EAKK/sG,IAAaA,EAAc1/C,KAAK8R,MAAMk8B,QAAU3B,GAAwB/f,EAAIozB,aACjF,IAAM9L,EAAaD,EAAQrnB,EAAI4lB,cAAgB5lB,EAAI6lB,eAC7Cr1B,EAAO9c,KAAKotJ,oBAAoB1tG,GAAa,GACnD,GAAIysG,EACFv5G,EAAOu5G,EAAqBv5G,KAC5Bq6G,EAAkBd,EAAqBl5G,UACvCi6G,EAAqBltJ,KAAKqtJ,iBAAiBJ,EAAiBvtG,GAAa,OACpE,CAIL,GAHA9M,EAAO//B,SAAS05I,EAAY1uJ,OAAS,KACrCqvJ,EAAqB1jI,WAAWgjI,EAAiB3uJ,OAAS,KAC1DovJ,EAAkBjtJ,KAAKqtJ,iBAAiBH,EAAoBxtG,GAAa,GAC5D,IAAT9M,EAEF,YADAu6G,EAAO,+BAIT,IAAMG,EAAettJ,KAAKutJ,oBAAoB7tG,EAAawtG,GAC3D,GAAII,EAEF,YADAH,EAAOG,GAIT,GAAI15G,EAAWc,MAAK,SAACiW,GAAS,OAAKA,EAAU1X,YAAcg6G,CAAe,IAGxE,YADAE,EAAO,uBAITv5G,EAAW5wC,KAAK,CAAE4vC,KAAAA,EAAMK,UAAWg6G,GACrC,CAEA,IAAMO,EAASriI,EAAKoyB,iBAAiB9xB,WAAU,GACzCgiI,EAAa54I,GAAI6W,cAAc8hI,GACrCC,EAAW7iG,SAASvrC,YAAc,GAAHtT,OAAMq6H,EAAU1rH,SAASnX,QACxDkqJ,EAAW76G,KAAKvzB,YAAc,GAAHtT,OAAM6mC,GACjC66G,EAAWx6G,UAAU5zB,YAAc,GAAHtT,OAAMmhJ,EAAkB,KAAAnhJ,OAAI+Q,GAC5DjI,GAAI1K,KAAKsjJ,EAAWC,UAAW,SAAS,WACtC,IAAM7pB,EAAQjwF,EAAWkwF,WAAU,SAACn5E,GAClC,OAAOA,EAAU/X,OAASA,GAAQ+X,EAAU1X,YAAcg6G,CAC5D,KACe,IAAXppB,IACJjwF,EAAWimB,OAAOgqE,EAAO,GACzB2pB,EAAOv0I,SACP6zI,IACA/lI,EAAKi5H,wBACLj5H,EAAKisH,gBAAgBz+G,SACrBxN,EAAKs5H,oBACP,IAEAxrI,GAAI1K,KAAKsjJ,EAAWV,MAAO,SAAS,WAClC,IAAMlpB,EAAQjwF,EAAWkwF,WAAU,SAAC55H,GAAiB,OAAKA,EAAE0oC,OAASA,GAAQ1oC,EAAE+oC,YAAcg6G,CAAe,IAC5G,GAAc,IAAVppB,EAAJ,CACA,IAAM8pB,EAAgB/5G,EAAWiwF,EAAQ,GACzCjwF,EAAWiwF,EAAQ,GAAKjwF,EAAWiwF,GACnCjwF,EAAWiwF,GAAS8pB,EACpBF,EAAW7iG,SAASvrC,YAAc,GAAHtT,OAAM83H,GACrC2pB,EAAOv0I,SACPmtH,EAAUpjC,aAAawqD,EAAQpnB,EAAU1rH,SAASmpH,EAAQ,IACpChvH,GAAI6W,cACxB06G,EAAU1rH,SAASmpH,IAEPj5E,SAASvrC,YAAc,GAAHtT,OAAM83H,EAAQ,GAChDipB,IACA/lI,EAAKi5H,uBAZkB,CAazB,IAEAnrI,GAAI1K,KAAKsjJ,EAAWT,QAAS,SAAS,WACpC,IAAMnpB,EAAQjwF,EAAWkwF,WAAU,SAAC55H,GAAC,OAAKA,EAAE0oC,OAASA,GAAQ1oC,EAAE+oC,YAAcg6G,CAAe,IAC5F,GAAIppB,IAAUjwF,EAAWrwC,OAAS,EAAlC,CACA,IAAMqqJ,EAAgBh6G,EAAWiwF,EAAQ,GACzCjwF,EAAWiwF,EAAQ,GAAKjwF,EAAWiwF,GACnCjwF,EAAWiwF,GAAS+pB,EACpBH,EAAW7iG,SAASvrC,YAAc,GAAHtT,OAAM83H,EAAQ,GAC7C2pB,EAAOv0I,SACPmtH,EAAUpjC,aAAawqD,EAAQpnB,EAAU1rH,SAASmpH,EAAQ,IACtChvH,GAAI6W,cACtB06G,EAAU1rH,SAASmpH,IAETj5E,SAASvrC,YAAc,GAAHtT,OAAM83H,EAAQ,GAC9CipB,IACA/lI,EAAKi5H,uBAZsC,CAa7C,IAEA5Z,EAAUpjC,aAAawqD,EAAQnB,GAC/BS,GACF,GAAC,CAAAnvJ,IAAA,iBAAAE,MAED,WACEmC,KAAKmrB,KAAK0iI,gBAAgBxuI,YAAc9C,GAAUA,IAClDvc,KAAKmrB,KAAK2iI,iBAAiBzuI,YAAc9C,GAAUA,GACrD,GAEA,CAAA5e,IAAA,qBAAAE,MAIA,SAAoB6hD,GAClB,IAAMv0B,EAAOnrB,KAAKmrB,KACZmnG,EAAStyH,KAAKotJ,oBAAoB1tG,GAAa,GAIrD,OAHAv0B,EAAK0iI,gBAAgBxuI,YAAcizG,EACnCnnG,EAAK2iI,iBAAiBzuI,YAAcizG,EACpCz9G,GAAI2E,KAAK2R,EAAK4iI,gBAAiB5iI,EAAK6iI,YAAa7iI,EAAK8iI,iBAAkB9iI,EAAK+iI,aAAc/iI,EAAKgjI,gBACxFzuG,GACN,IAAK,eACH,OAAO7qC,GAAIyE,KAAK6R,EAAK4iI,iBACvB,IAAK,UACH,OAAOl5I,GAAIyE,KAAK6R,EAAK6iI,aACvB,IAAK,gBACH,OAAOn5I,GAAIyE,KAAK6R,EAAK8iI,kBACvB,IAAK,WACH,OAAOp5I,GAAIyE,KAAK6R,EAAK+iI,cACvB,IAAK,aACH,OAAOr5I,GAAIyE,KAAK6R,EAAKgjI,gBAE3B,GAAC,CAAAxwJ,IAAA,kBAAAE,MAED,SAAiBs5H,GAEf,IADA,IAAQhsG,EAA6BnrB,KAA7BmrB,KAAqBmB,EAAQtsB,KAAvB6/I,cACP10H,EAAKwhI,uBAAuBjyI,SAASnX,OAAS,GACnD4nB,EAAKwhI,uBAAuBjyI,SAAS,GAAGzB,SAE1C,KAAOkS,EAAKihI,wBAAwB1xI,SAASnX,OAAS,GACpD4nB,EAAKihI,wBAAwB1xI,SAAS,GAAGzB,SAE3CjZ,KAAKk9I,gBAAgB/lB,GAAY,CAAC7qG,EAAI4lB,cAAe5lB,EAAI6lB,gBACzD7lB,EAAI4lB,cAAc2nB,OAAO,EAAGvtC,EAAI4lB,cAAc3uC,QAC9C+oB,EAAI6lB,eAAe0nB,OAAO,EAAGvtC,EAAI6lB,eAAe5uC,OAClD,GAAC,CAAA5F,IAAA,uBAAAE,MAED,SAAsBs5H,GAAkB,IAAAi3B,EAAAC,EAChCnuH,EAAIlgC,KAAKk9I,gBAAgB/lB,GAC/B,GAAKj3F,EAAL,CACA,IAAuB5T,EAAQtsB,KAAvB6/I,cACRvzH,EAAI4lB,cAAc2nB,OAAO,EAAGvtC,EAAI4lB,cAAc3uC,QAC9C+oB,EAAI6lB,eAAe0nB,OAAO,EAAGvtC,EAAI6lB,eAAe5uC,SAChD6qJ,EAAA9hI,EAAI4lB,eAAclvC,KAAI4F,MAAAwlJ,EAAA1mJ,EAAIw4B,EAAE,MAC5BmuH,EAAA/hI,EAAI6lB,gBAAenvC,KAAI4F,MAAAylJ,EAAA3mJ,EAAIw4B,EAAE,KAC7B,IACiCk5B,EAD3B1Z,EAAcy3E,IAAa+kB,GAAmB7vG,GAAwB8qF,EAAQ99D,EAAAhuD,GACpEihB,EAAI4lB,eAAa,IAAjC,IAAAmnB,EAAA9tD,MAAA6tD,EAAAC,EAAA7yD,KAAA9E,MAAmC,KAAxBwI,EAACkvD,EAAAv7D,MAAuBmC,KAAKkgJ,cAAa,EAAMh2I,EAAGw1C,EAAW,CAAC,OAAAhhD,GAAA26D,EAAAztD,EAAAlN,EAAA,SAAA26D,EAAAxtD,GAAA,KACxCkuD,EADwCC,EAAA3uD,GAC1DihB,EAAI6lB,gBAAc,IAAlC,IAAA6nB,EAAAzuD,MAAAwuD,EAAAC,EAAAxzD,KAAA9E,MAAoC,KAAzBwI,EAAC6vD,EAAAl8D,MAAwBmC,KAAKkgJ,cAAa,EAAOh2I,EAAGw1C,EAAW,CAAC,OAAAhhD,GAAAs7D,EAAApuD,EAAAlN,EAAA,SAAAs7D,EAAAnuD,GAAA,CAR9D,CAShB,GAEA,CAAAlO,IAAA,oBAAAE,MAKA,WAAqB,IAAAywJ,EAAAC,EAAAC,EAAA5mI,EAAA,KAEjBuD,EACEnrB,KADFmrB,KAAsB+3H,EACpBljJ,KADIikJ,eAAuC33H,EAC3CtsB,KAD4B6/I,cAAa4O,EACzCzuJ,KADgD8R,MAASk8B,EAAOygH,EAAPzgH,QAASsE,EAAOm8G,EAAPn8G,QAGtEtyC,KAAK4/I,gBAAgB5xG,EAAUkuG,GAAmB5vH,EAAIozB,aAEvC,SAACs/C,EAASx3F,GACvB,IAAK,IAAL2+C,EAAA,EAAAN,EAAqBxoD,OAAOkgB,QAAQ/V,GAAK2+C,EAAAN,EAAAtiD,OAAA4iD,IAAE,CAAtC,IAAAL,EAAAl+C,EAAAi+C,EAAAM,GAAA,GAAO16C,EAACq6C,EAAA,GAAEp6C,EAACo6C,EAAA,GACd,GAAI1+C,MAAMO,QAAQ+D,GAAI,CACpBszF,EAAGvzF,GAAGouD,OAAO,EAAGmlC,EAAGvzF,GAAGlI,QAAO,IACZ+2D,EADYC,EAAAlvD,GACbK,GAAC,IAAjB,IAAA6uD,EAAAhvD,MAAA+uD,EAAAC,EAAA/zD,KAAA9E,MAAmB,KAAR8B,EAAC82D,EAAAz8D,MAAOmhG,EAAGvzF,GAAGzI,KAAKQ,EAAC,CAAC,OAAA9E,GAAA67D,EAAA3uD,EAAAlN,EAAA,SAAA67D,EAAA1uD,GAAA,CAClC,KAAwB,WAAb9O,EAAO2O,GAAgBrO,OAAOyjI,OAAO9hC,EAAGvzF,GAAIC,GAClDszF,EAAGvzF,GAAKjE,EAAKiE,EACpB,CACF,CACAq1H,CAAOx0G,EAAKjgB,KAAKG,MAAMH,KAAKC,UAAU42I,KAEtC,IAAMwL,EAAwB,QAArBJ,EAAGhiI,EAAIgwH,sBAAc,IAAAgS,EAAAA,EA3+CzB,KA4+CLtuJ,KAAKs8I,eAAejvH,SAAe,IAANqhI,GAC7B1uJ,KAAK4gJ,qBAAqBvzH,SAASqhI,EA3+C/B,KA6+CJ,IAAMC,EAA8B,QAAvBJ,EAAGjiI,EAAIiwH,wBAAgB,IAAAgS,EAAAA,EAx+C/B,GAy+CLvuJ,KAAKu8I,iBAAiBlvH,SAASshI,GAC/B3uJ,KAAK6gJ,uBAAuBxzH,SAASshI,EAx+CjC,IA0+CJ,IAAMv8G,EAAmB,QAAbo8G,EAAGliI,EAAI8lB,cAAM,IAAAo8G,EAAAA,EAp+CpB,IAq+CLrjI,EAAK61H,YAAYnjJ,MAAQyL,OAAgB,IAAT8oC,GAChCpyC,KAAK8gJ,SAASzzH,SAAkB,IAAT+kB,GACvBpyC,KAAKihJ,eAAe5zH,UAAU+kB,EAAS+pG,IAAsBA,IAEzDnuG,IACF7iB,EAAK8zH,qBAAqBtmF,QAAUrsC,EAAI2uB,aACxCj7C,KAAKk/I,wBAIF/zH,EAAKw0H,kBAAkBpxB,UAC5BnnH,MAAMI,KAAK2jB,EAAKw0H,kBAAkBpxB,SAAShuH,SAAQ,SAAC+qB,GAA6BA,EAAI4B,SAAW5B,EAAIztB,QAAUyuB,EAAIozB,WAAY,IAC9H1/C,KAAK+/I,mBAAmBzzH,EAAIozB,aAExBpN,IAAY5F,IACd73B,GAAIyE,KAAK6R,EAAKw5B,gBACd9vC,GAAI2E,KAAK2R,EAAKyjI,kBAAmBzjI,EAAK0jI,qBACtC7uJ,KAAK+/I,mBAAmB50H,EAAKw0H,kBAAkB9hJ,OAAS,KAC/CmwC,GAAW/iB,KAAM2iB,SAASyK,MAAMrK,KACzCn5B,GAAI2E,KAAK2R,EAAKw5B,gBACd9vC,GAAIyE,KAAK6R,EAAKyjI,kBAAmBzjI,EAAK0jI,qBACtC7uJ,KAAK8uJ,kBAIP5L,EAAOhxG,cAAc3xC,SAAQ,SAAC2J,GAAQ0d,EAAKs4H,cAAa,EAAMh2I,EAAG,IACjEg5I,EAAO/wG,eAAe5xC,SAAQ,SAAC2J,GAAQ0d,EAAKs4H,cAAa,EAAOh2I,EAAG,IAEnElK,KAAKw9I,SAASuR,sBACd/uJ,KAAKu9I,UAAUwR,sBAEf/uJ,KAAKggJ,wBACDnrI,GAAI82D,YAAYxgD,EAAK47H,cAAc/mJ,KAAKq/I,sBAC9C,GAEA,CAAA1hJ,IAAA,iBAAAE,MAIA,SAAgBmxJ,GACd,IAAIvnE,GAAK,EAEPt8D,EAEEnrB,KAFFmrB,KAAemnB,EAEbtyC,KAFI8R,MAASwgC,QAAO28G,EAEpBjvJ,KADF6/I,cAAiB1tG,EAAc88G,EAAd98G,eAAgBD,EAAa+8G,EAAb/8G,cAAeE,EAAM68G,EAAN78G,OAE5C2f,EAAW,SAACm9F,EAAoBlN,GACpCv6D,GAAK,EACAunE,IACLE,EAAM7vI,YAAc9C,GAAUylI,GAC9BntI,GAAIyE,KAAK41I,GACX,EAcA,OAbIF,GACFn6I,GAAI2E,KACF2R,EAAK0hI,iBAAkB1hI,EAAKuhI,kBAAmBvhI,EAAK22H,gBAGpDxvG,IAAY1F,IAAmBsF,EAAc3uC,OAAS4uC,EAAe5uC,SAAW,IAClFwuD,EAAS5mC,EAAK0hI,iBAAkBtwI,IAChCw1C,EAAS5mC,EAAKuhI,kBAAmBnwI,KAE/B+1B,IAAY5F,KACVppC,MAAM8uC,GAAS2f,EAAS5mC,EAAK22H,eAAgBvlI,IAC7B,IAAX61B,GAAc2f,EAAS5mC,EAAK22H,eAAgBvlI,KAEhDkrE,CACT,GAEA,CAAA9pF,IAAA,eAAAE,OAAA++I,EAAAn0I,EAAAzL,IAAAA,MAIA,SAAAi6C,IAAA,IAAAk4G,EAAA7iI,EAAA2E,EAAAC,EAAAoW,EAAAgL,EAAAtE,EAAAyJ,EAAA8xG,EAAA,OAAAvsJ,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,UAGOtC,KAAKovJ,gBAAe,GAAO,CAAFl4G,EAAA50C,KAAA,eAAA40C,EAAAj1C,OAAA,iBAAAktJ,EAC2BnvJ,KAAKinJ,cAAtD36H,EAAG6iI,EAAH7iI,IAAK2E,EAAMk+H,EAANl+H,OAAQC,EAAOi+H,EAAPj+H,QAASoW,EAAI6nH,EAAJ7nH,KAAMgL,EAAO68G,EAAP78G,QAAStE,EAAOmhH,EAAPnhH,QAEvCyJ,EAAoB,CACxBnQ,KAAMA,EACNrW,OAAQA,EACRC,QAASA,EACT8c,QAASA,QAAAA,EAAW,GACpB6I,SAAU,CACRC,cAAexqB,EAAIwqB,cACnB4C,WAAYptB,EAAIotB,WAChBC,YAAartB,EAAIqtB,YACjBsB,aAAc3uB,EAAI2uB,cAEpBqpG,kBAAmBh4H,EAAI43H,YACvBK,mBAAoBj4H,EAAI83H,cACzBltG,EAAAxpC,GACO4kC,EAAO4E,EAAA50C,KAAA40C,EAAAxpC,KACRg/B,GAAc,EAAAwK,EAAAxpC,KAGdi/B,GAAY,EAAAuK,EAAAxpC,KAGZk/B,GAAe,mBALmC,OAArD6K,EAAOV,wBAA0B/2C,KAAKqvJ,gBAAen4G,EAAAj1C,OAAA,mBAGJ,OAAjDw1C,EAAOlB,sBAAwBv2C,KAAKsvJ,cAAap4G,EAAAj1C,OAAA,oBAGjDw1C,EAAOb,gBAAkB52C,KAAKuvJ,iBAAgB,QAGN,OAA5CtkI,KAAMuoB,IAAI,KAAM,oBAAqBiE,GAAOP,EAAA50C,KAAA,GACtCyqC,GAAGyiH,gBAAgB/3G,GAAO,eAAAP,EAAA50C,KAAA,GAC1B2oB,KAAMomH,gBAAe,QAC3BrxI,KAAKikJ,eAAiB53I,KAAKG,MAAMH,KAAKC,UAAUggB,IAChDtsB,KAAKggJ,yBACCuJ,EAAW9+I,EAAMuB,WAAWgwI,KAAe,CAAC,GACzC,GAADjwI,OAAIklB,EAAM,KAAAllB,OAAImlB,EAAO,KAAAnlB,OAAIu7B,IAAUtnC,KAAK8R,MAChDrH,EAAMgE,WAAWutI,GAAYuN,GACzBv7G,GAASvjC,EAAMgE,WAAWwtI,GAAmBjuG,GACjD/iB,KAAM2yB,SAAS,MAAK,yBAAA1G,EAAAlyC,OAAA,GAAAiyC,EAAA,UACrB,kBAAA2lG,EAAAh0I,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,OAAA8+I,EAAAl0I,EAAAzL,IAAAA,MAED,SAAAohD,IAAA,IAAAjzB,EAAAskI,EAAAnoH,EAAArW,EAAAC,EAAAotB,EAAAiqC,EAAA,OAAAvrF,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,OAGyD,OAF/C6oB,EAA2CnrB,KAA3CmrB,KAAIskI,EAAuCzvJ,KAArC8R,MAASw1B,EAAImoH,EAAJnoH,KAAMrW,EAAMw+H,EAANx+H,OAAQC,EAAOu+H,EAAPv+H,QACrCrc,GAAI2E,KAAK2R,EAAKukI,WACRpxG,EAASrzB,KAAMuzB,QAAQrzB,EAAKu4H,sBAAqBnlG,EAAAj8C,KAAA,EACpCyqC,GAAGqkG,gBAAgB9pG,EAAMrW,EAAQC,GAAQ,OACpD,GADFq3D,EAAIhqC,EAAAz8C,KACVw8C,IACKrzB,KAAM6mC,cAAcy2B,GAAO,CAAFhqC,EAAAj8C,KAAA,SAEJ,OADxB6oB,EAAKukI,UAAUrwI,YAAc9C,GAAUA,EAAmB,CAAE3O,IAAK26E,EAAK36E,MACtEiH,GAAIyE,KAAK6R,EAAKukI,WAAUnxG,EAAAt8C,OAAA,yBAAAs8C,EAAAj8C,KAAA,GAGpB2oB,KAAMomH,gBAAe,QAC3BpmH,KAAM2yB,SAAS,MAAK,yBAAAW,EAAAv5C,OAAA,GAAAo5C,EAAA,UACrB,kBAAAu+F,EAAA/zI,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,cAAAE,MAMA,WACE,IAQiC48D,EARVnuC,EAAQtsB,KAAvB6/I,cACFyD,EAAgC,CACpCpxG,cAAe,GACfC,eAAgB,GAChBC,OAAQ9lB,EAAI8lB,OACZkqG,eAAgBhwH,EAAIgwH,eACpBC,iBAAkBjwH,EAAIiwH,kBACvB7hF,EAAArvD,GACeihB,EAAI4lB,eAAa,IAAjC,IAAAwoB,EAAAnvD,MAAAkvD,EAAAC,EAAAl0D,KAAA9E,MAAmC,KAAxBwI,EAACuwD,EAAA58D,MAAuBylJ,EAAOpxG,cAAclvC,KAAK,CAAE4vC,KAAM1oC,EAAE0oC,KAAMwhG,WAAYlqI,EAAE+oC,WAAW,CAAC,OAAAv0C,GAAAg8D,EAAA9uD,EAAAlN,EAAA,SAAAg8D,EAAA7uD,GAAA,KACrE8uD,EADqEC,EAAAvvD,GACvFihB,EAAI6lB,gBAAc,IAAlC,IAAAyoB,EAAArvD,MAAAovD,EAAAC,EAAAp0D,KAAA9E,MAAoC,KAAzBwI,EAACywD,EAAA98D,MAAwBylJ,EAAOnxG,eAAenvC,KAAK,CAAE4vC,KAAM1oC,EAAE0oC,KAAMwhG,WAAYlqI,EAAE+oC,WAAW,CAAC,OAAAv0C,GAAAk8D,EAAAhvD,EAAAlN,EAAA,SAAAk8D,EAAA/uD,GAAA,CACzG,OAAOy3I,CACT,GAAC,CAAA3lJ,IAAA,iBAAAE,MAED,WACE,IAAuByuB,EAAQtsB,KAAvB6/I,cAMR,MALgC,CAC9B7/F,cAAe1zB,EAAI8lB,OACnBu9G,cAAe,IACfnL,mBAAoBl4H,EAAIiwH,iBAG5B,GAEA,CAAA5+I,IAAA,gBAAAE,MAKA,WACE,IAAuByuB,EAAQtsB,KAAvB6/I,cAOR,MANuC,CACrCngG,YAAapzB,EAAIozB,YACjBvN,eAAgB7lB,EAAI6lB,eACpBD,cAAe5lB,EAAI4lB,cACnBoqG,eAAgBhwH,EAAIgwH,eAGxB,GAEA,CAAA3+I,IAAA,oBAAAE,OAAA6+I,EAAAj0I,EAAAzL,IAAAA,MAIA,SAAA0hD,IAAA,IAAAvzB,EAAAykI,EAAAtoH,EAAArW,EAAAC,EAAA9nB,EAAA8Q,EAAA21I,EAAAlwF,EAAAH,EAAA34D,EAAAg4D,EAAA1+C,EAAA,OAAAnjB,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,OAC8C,OAApC6oB,EAA2CnrB,KAA3CmrB,KAAIykI,EAAuC5vJ,KAArC8R,MAASw1B,EAAIsoH,EAAJtoH,KAAMrW,EAAM2+H,EAAN3+H,OAAQC,EAAO0+H,EAAP1+H,QAAOytB,EAAAr8C,KAAA,EAE1ByqC,GAAGxhB,OAAO+b,EAAMrW,EAAQC,GAAQ,OACc,GAD1D9nB,EAAGu1C,EAAA78C,KACT+S,GAAI2E,KAAK2R,EAAK2kI,eAAgB3kI,EAAK4kI,aAAc5kI,EAAK6kI,WAEjD/kI,KAAM6mC,cAAc1oD,GAAM,CAAFu1C,EAAAr8C,KAAA,QAEF,OADzB6oB,EAAK8kI,cAAc5wI,YAAcjW,EAAIwE,IACrCiH,GAAIyE,KAAK6R,EAAK+kI,YAAWvxG,EAAA18C,OAAA,iBAK3B,IADMiY,EAAIla,KAAKm3C,aAAe/tC,EAAImiB,QAC3B4kI,SAAgC,IAArBj2I,EAAEi2I,QAAQ5sJ,OAErB,CACLsR,GAAI2E,KAAK2R,EAAK6kI,WACdn7I,GAAImD,MAAMmT,EAAKglI,SAAQxwF,EAAAt0D,GACE,QADFwkJ,EACP31I,EAAEi2I,eAAO,IAAAN,EAAAA,EAAI,IAAE,IAA/B,IAAAlwF,EAAAp0D,MAAAi0D,EAAAG,EAAAn5D,KAAA9E,MAAWmF,EAAC24D,EAAA3hE,MACJghE,EAAK1zC,EAAKyyH,WAAWnyH,WAAU,GACrCN,EAAKglI,QAAQ73I,YAAYumD,IACnB1+C,EAAOtL,GAAI6W,cAAcmzC,IAC1B/xB,KAAKrtB,IAAM,OAAS5Y,EAAEygC,KAAO,OAClCnnB,EAAKmnB,KAAKjoB,YAAc+wI,GAAcvpJ,EAAEygC,MACxCnnB,EAAKoe,OAAOlf,YAAcxK,GAAIiJ,kBAAkBjX,EAAEwpJ,QAClDlwI,EAAK61E,MAAM32E,YAAcxK,GAAIiJ,mBAAmBjX,EAAEotI,QAAUptI,EAAEqtI,UAAY,EAC3E,OAAAx1I,GAAAihE,EAAA/zD,EAAAlN,EAAA,SAAAihE,EAAA9zD,GAAA,CACDsf,EAAKmlI,SAASjxI,YAAcnF,EAAE87E,MAAQnhF,GAAIiJ,kBAAkB5D,EAAE87E,OAAS,IACvEnhF,GAAIyE,KAAK6R,EAAK4kI,aAChB,MAfEl7I,GAAIyE,KAAK6R,EAAK6kI,WAiBZ91I,EAAEm4B,aAAe,EACnBlnB,EAAKknB,aAAahzB,YAAcxK,GAAIiJ,kBAAkB5D,EAAEm4B,cAExDlnB,EAAKknB,aAAahzB,YAAc,MAG9BnF,EAAEo9B,cAAgB,EACpBnsB,EAAKmsB,cAAcj4B,YAAcxK,GAAIiJ,kBAAkB5D,EAAEo9B,eAEzDnsB,EAAKmsB,cAAcj4B,YAAc,MAEnCxK,GAAIyE,KAAK6R,EAAKwgF,WAAU,yBAAAhtD,EAAA35C,OAAA,GAAA05C,EAAA,UACzB,kBAAAg+F,EAAA9zI,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,OAAAqwI,EAAAzlI,EAAAzL,IAAAA,MAGA,SAAAkiD,EAAqBlR,GAAe,IAAA7iB,EAAAolI,EAAAjpH,EAAArW,EAAAC,EAAAogB,EAAAuuB,EAAAD,EAAA4wF,EAAAC,EAAAC,EAAAvwI,EAAAglI,EAAA5zG,EAAA,OAAAv0C,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,OAC1B6oB,EAA+CnrB,KAA/CmrB,KAAIolI,EAA2CvwJ,KAAzC4pJ,UAAatiH,EAAIipH,EAAJjpH,KAAMrW,EAAMs/H,EAANt/H,OAAQC,EAAOq/H,EAAPr/H,QACnCogB,EAAQzE,GAAgBmB,GAAQ6xB,EAAAx0D,GACQrL,KAAKw+D,YAAU7e,EAAA96C,KAAA,EAAAg7D,EAAAt0D,IAAA,WAAAq0D,EAAAC,EAAAr5D,KAAA9E,KAAE,CAAFi+C,EAAAr9C,KAAA,SAArB,GAAqBkuJ,EAAA5wF,EAAA/hE,MAAhDozB,EAAMu/H,EAANv/H,OAAQC,EAAOs/H,EAAPt/H,QAAS/Q,EAAIqwI,EAAJrwI,MACG,KADGglI,EAAIqL,EAAJrL,MACzBvmI,QAAQovB,GAAe,CAAA2R,EAAAr9C,KAAA,eAAAq9C,EAAA19C,OAAA,sBACXjC,KAAKqlJ,uBAAuBp0H,EAAQC,EACrDk0H,CAAap3G,MACTuD,EAAMpmB,EAAK2yH,YAAYryH,WAAU,IACnChM,IAAM6xB,EAAMxE,KAChB3sB,EAAKglI,KAAK7sI,YAAYi5B,GACtB4zG,EAAKniJ,KAAKgrC,IACX,QAAA2R,EAAAr9C,KAAA,gBAAAq9C,EAAAr9C,KAAA,iBAAAq9C,EAAA96C,KAAA,GAAA86C,EAAAjyC,GAAAiyC,EAAA,SAAAkgB,EAAAj0D,EAAA+zC,EAAAjyC,IAAA,eAAAiyC,EAAA96C,KAAA,GAAAg7D,EAAAh0D,IAAA8zC,EAAAh6C,OAAA,YAEH3F,KAAKgqJ,mBAAmB/4H,EAAQC,EAAS8c,GACzChuC,KAAKslJ,gBAAgBh+G,EAAMrW,EAAQC,EAASyb,GAAcqB,GAAQ,yBAAA2R,EAAA36C,OAAA,GAAAk6C,EAAA,yBACnE,SAAAz4B,GAAA,OAAAynH,EAAAtlI,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,aAAAE,MAGA,WACEmC,KAAK+pJ,UAAY,CAAC,EAClB,IAAK,IAALtnF,EAAA,EAAA7vD,EAAmBvV,OAAOkH,KAAKsoC,IAAgB41B,EAAA7vD,EAAArP,OAAAk/D,IAAA,CAA1C,IAAM1+D,EAAI6O,EAAA6vD,GAAkCziE,KAAK2wJ,OAAO5sJ,EAAK,CACpE,GAEA,CAAApG,IAAA,qBAAAE,MAIA,SAAoBozB,EAAgBC,EAAiB0/H,GAEnD,IADA,IAAMxL,EAAeplJ,KAAKqlJ,uBAAuBp0H,EAAQC,GACzDmyC,EAAA,EAAA29D,EAAkC3jI,OAAO+C,OAAOJ,KAAK+pJ,WAAU1mF,EAAA29D,EAAAz9H,OAAA8/D,IAAE,CAA5D,IAAAwtF,EAAA7vB,EAAA39D,GAAQt/D,EAAI8sJ,EAAJ9sJ,KAAMojC,EAAG0pH,EAAH1pH,IAAKhnB,EAAI0wI,EAAJ1wI,KAChB2wI,EAAM1L,EAAarhJ,GACnBswE,EAAYppD,KAAM2iB,SAASyK,MAAMt0C,GACvC8Q,GAAI2E,KAAK2G,EAAK4wI,YAAa5wI,EAAK6wI,YAAa7wI,EAAK8wI,cAClDp8I,GAAIqf,OAAOlG,QAAQqmD,GAAYl0D,EAAK4gE,UACpC5gE,EAAK2sB,KAAKn0B,UAAUM,OAAO,YAC3BkuB,EAAIxuB,UAAUmN,OAAO,aAAckI,QAAQqmD,KAAeA,EAAUC,YAC/DD,EAEMA,EAAUC,WACnBz/D,GAAIyE,KAAK6G,EAAK8wI,cACJH,EAGD/sJ,IAAS6sJ,GAAa5wJ,KAAKoqJ,cAAcrmJ,IAFlD8Q,GAAIyE,KAAK6G,EAAK4wI,aACd5wI,EAAK2sB,KAAKn0B,UAAUC,IAAI,aALxB/D,GAAIyE,KAAK6G,EAAK6wI,YAOlB,CACF,GAAC,CAAArzJ,IAAA,gBAAAE,MAED,SAAemwC,GACb,IAAK,IAAL2hC,EAAA,EAAAuhF,EAA4B7zJ,OAAO+C,OAAOJ,KAAK+pJ,WAAUp6E,EAAAuhF,EAAA3tJ,OAAAosE,IAAE,CAAtD,IAAAwhF,EAAAD,EAAAvhF,GAAQ5rE,EAAIotJ,EAAJptJ,KAASotJ,EAAHhqH,IACbxuB,UAAUmN,OAAO,WAAY/hB,IAASiqC,EAC5C,CACF,GAAC,CAAArwC,IAAA,SAAAE,MAED,SAAQmwC,GAAiB,IAAA7lB,EAAA,KACjBmpB,EAAQzE,GAAgBmB,GACxB7G,EAAMnnC,KAAKmrB,KAAK0yH,WAAWpyH,WAAU,GACrCtL,EAAOtL,GAAI6W,cAAcyb,GAC/BhnB,EAAKpc,KAAKsb,YAAciyB,EAAMvtC,KAC9Boc,EAAK2sB,KAAKrtB,IAAM6xB,EAAMxE,KACtB9sC,KAAKmrB,KAAKg3H,aAAa7pI,YAAY6uB,GACnCnnC,KAAK+pJ,UAAU/7G,GAAW,CAAEjqC,KAAMiqC,EAAS7G,IAAAA,EAAKhnB,KAAAA,GAChDtL,GAAI1K,KAAKg9B,EAAK,SAAS,WACrB,IAAMktC,EAAYppD,KAAM2iB,SAASyK,MAAMrK,GACvC,GAAKqmC,IAAaA,EAAUC,WAK5B,GADYnsD,EAAK4hI,UAAU/7G,GACnB7G,IAAIxuB,UAAUhD,SAAS,YAA/B,CACE,IAAK,IAALm6D,EAAA,EAAAshF,EAAkB/zJ,OAAO+C,OAAO+nB,EAAK4hI,WAAUj6E,EAAAshF,EAAA7tJ,OAAAusE,IAAjCshF,EAAAthF,GAAuC3oC,IAAIxuB,UAAUM,OAAO,YAC1E,IAAAo4I,EAA4BlpI,EAAKyhI,UAAzB34H,EAAMogI,EAANpgI,OAAQC,EAAOmgI,EAAPngI,QAChB/I,EAAK6hI,mBAAmB/4H,EAAQC,EAElC,MACA,IAAK,IAALmyG,EAAA,EAAAiuB,EAAkBj0J,OAAO+C,OAAO+nB,EAAK4hI,WAAU1mB,EAAAiuB,EAAA/tJ,OAAA8/H,IAAA,CAA1C,IAAMxzF,EAAGyhH,EAAAjuB,GAAmCxzF,EAAI1I,IAAIxuB,UAAUmN,OAAO,WAAY+pB,EAAI9rC,OAASiqC,EAAQ,MAVzG7lB,EAAKopI,kBAAkBvjH,EAW3B,IACAn5B,GAAI1K,KAAKgW,EAAK4gE,SAAU,SAAS,SAACn1E,GAChCA,EAAE2a,kBACF4B,EAAKopI,kBAAkBvjH,EACzB,GACF,GAAC,CAAArwC,IAAA,oBAAAE,MAED,SAAmBmwC,GACjB,IAAM7iB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK4uI,cAAcU,OAAOthG,GAC1BhuC,KAAKi9C,MAAM3jC,KAAK6R,EAAKyjH,cACvB,GAEA,CAAAjxI,IAAA,yBAAAE,MAIA,SAAwBozB,EAAgBC,GAEtC,IADA,IAAMmnB,EAAiC,CAAC,EACxC0oF,EAAA,EAAA36E,EAAmC/oD,OAAOkgB,QAAQ0N,KAAM2iB,SAASyK,OAAM0oF,EAAA36E,EAAA7iD,OAAAw9H,IACrE,IADG,IAAA16E,EAAAz+C,EAAAw+C,EAAA26E,GAAA,GAAO/yF,EAAOqY,EAAA,GAAEguB,EAAShuB,EAAA,GAC5BmrG,EAAA,EAAAC,EAAwCp0J,OAAO+C,OAAwB,QAAlBsxJ,EAACr9E,EAAUp+B,eAAO,IAAAy7G,EAAAA,EAAI,IAAGF,EAAAC,EAAAluJ,OAAAiuJ,IAAE,KAAAE,EAA3EC,EAAAF,EAAAD,GAAgBp3I,EAACu3I,EAAT1gI,OAAoBi8F,EAACykC,EAAVzgI,QACtB,GAAI9W,IAAM6W,GAAUi8F,IAAMh8F,EAAS,CACjCmnB,EAAMrK,IAAW,EACjB,KACF,CACF,CAEF,OAAO,SAACA,GAAe,OAAKhgB,QAAQqqB,EAAMrK,GAAS,CACrD,KAACyuG,CAAA,CAvsDyC,CAAS7xH,IA0sDrD,SAASm5H,GAAYjyI,EAAiB87B,GACpC,IAAME,EAAYF,EAASC,KAAK6G,MAAK,SAAAoD,GAAA,IAAWxrB,EAAGwrB,EAAXrK,OAAM,OAAYnhB,EAAIgb,OAASx1B,EAAMw1B,MAAQhb,EAAI2E,SAAWnf,EAAMmf,QAAU3E,EAAI4E,UAAYpf,EAAMof,OAAO,IACjJ,OAAOlD,QAAQ8f,aAAS,EAATA,EAAWxoB,QAC5B,CAEA,IAAM8qI,GAAwC,CAC5C,cAAe,UACf,eAAgB,WAChB,cAAe,UACf,aAAc,SACd,WAAY,QAGd,SAASlpC,GAA4B5/E,EAAcltB,EAAmB8yG,GACpE,IAAIpG,EAA0Bh8F,GAAe++D,SACzCk9B,EAA2Bj8F,GAAe++D,SAE9C,GAAIzvE,SAAAA,EAAG4xB,MAAO,KAAA27E,EACNC,EAAY38F,KAAMoW,OAAOjnB,EAAEnF,IAC3B4yG,EAAc58F,KAAMuc,UAAUF,GAAMjG,OAAOjnB,EAAEnF,IAAIs+D,QACnDq0C,SAAiB,QAARD,EAATC,EAAWxiG,cAAM,IAAAuiG,GAAjBA,EAAmBp+B,eAAuD9nF,IAA3CmmH,EAAUxiG,OAAOmkE,SAASs+B,KAC3Df,EAA0Bc,EAAUxiG,OAAOmkE,SAASs+B,GAExD,CACA,GAAIqF,SAAAA,EAAGlhF,MAAO,KAAA87E,EACNC,EAAa98F,KAAMoW,OAAO6rF,EAAEj4G,IAC5B+yG,EAAe/8F,KAAMuc,UAAUF,GAAMjG,OAAO6rF,EAAEj4G,IAAIs+D,QACpDw0C,SAAkB,QAARD,EAAVC,EAAY3iG,cAAM,IAAA0iG,GAAlBA,EAAoBv+B,eAAyD9nF,IAA7CsmH,EAAW3iG,OAAOmkE,SAASy+B,KAC7DjB,EAA2BgB,EAAW3iG,OAAOmkE,SAASy+B,GAE1D,CAEA,MAAO,CACLlB,EACAC,EAEJ,CAAC,IAEK22B,GAAS,WAwBb,SAAAA,EAAalL,EAA6BrrG,GAAkB,IAAAtQ,EAAA,KAAAhuB,EAAA,KAAA60I,GAAA5zI,EAAA,kBAAAA,EAAA,mBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,kBAAAA,EAAA,4BAAAA,EAAA,0BAAAA,EAAA,qBAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,uBAb5CA,EAAA,2BAAAA,EAAA,mBAAAA,EAAA,mBAAAA,EAAA,yBAAAA,EAAA,+BAAAA,EAAA,6BAAAA,EAAA,mCAAAA,EAAA,8BAAAA,EAAA,oCAAAA,EAAA,2BAAAA,EAAA,iCAcd9J,KAAKwyI,GAAKA,EACVxyI,KAAKmnC,IAAMA,EACX,IAAMhc,EAAOnrB,KAAKmrB,KAAOtW,GAAI6W,cAAcyb,GAE3CnnC,KAAK4xJ,UAAY,IAAIpqI,GAAiB2D,EAAKymI,UAAW,CACpD39I,KAl6DE,EAm6DF4T,IAl6DC,GAm6DDV,QAAS,SAACzb,GAERmrB,EAAKvK,IAAIouB,SAAWhvC,EACpBmrB,EAAKg7H,gBAAgBxkI,UAAU3hB,EAr6D/B,GAEC,KAo6DDmrB,EAAK27G,GAAG6N,mBACV,IAGFrgJ,KAAK6xJ,gBAAkB,IAAI3pI,GAAWiD,EAAK0mI,iBAAiB,SAAC33I,GAC3D,IACOxO,EAAwC9D,EAAnCsf,GA56DV,EAEC,IA06D4BhN,EA96D7B,GA86D6C,GAAvC,GACR2c,EAAKvK,IAAIouB,SAAWhvC,EACpBmrB,EAAK+6H,UAAUvkI,SAAS3hB,GACxBmrB,EAAK27G,GAAG6N,mBACV,IACArgJ,KAAKq6C,cAAgB,IAAI1zB,GAAYwE,EAAK0uB,oBAAqB,CAC7D5lC,KAz6DE,EA06DFI,IAAK,EACL8S,QAAS,SAACzb,GAERmrB,EAAKvK,IAAIutB,oBAAsBnuC,EAC/BmrB,EAAKi7H,oBAAoBzkI,UAAU3hB,EAj7DnC,GAEC,GAg7DDmrB,EAAK27G,GAAG6N,mBACV,IAEFrgJ,KAAK8xJ,oBAAsB,IAAI5pI,GAAWiD,EAAK2mI,qBAAqB,SAAC53I,GACnE,IACOxO,EAAwC9D,EAAnCsf,GAv7DV,EAEC,EAq7D4BhN,EAp7D7B,GAo7D6C,GAAvC,GACR2c,EAAKwjB,cAAchtB,SAAS3hB,GAC5BmrB,EAAKvK,IAAIutB,oBAAsBnuC,EAC/BmrB,EAAK27G,GAAG6N,mBACV,IACArgJ,KAAKs6C,eAAiB,IAAI3zB,GAAYwE,EAAKwvB,qBAAsB,CAC/D1mC,KA76DE,EA86DFI,IAAK,EACL8S,QAAS,SAACzb,GAERmrB,EAAKvK,IAAIquB,qBAAuBjvC,EAChCmrB,EAAKk7H,qBAAqB1kI,UAAU3hB,EAr7DpC,GAEC,IAo7DDmrB,EAAK27G,GAAG6N,mBACV,IAEFrgJ,KAAK+xJ,qBAAuB,IAAI7pI,GAAWiD,EAAK4mI,sBAAsB,SAAC73I,GACrE,IACOxO,EAAwC9D,EAAnCsf,GA37DV,EAEC,GAy7D4BhN,EAx7D7B,GAw7D6C,GAAvC,GACR2c,EAAKyjB,eAAejtB,SA57DlB,EAEC,GA07DiCnT,GACpC2c,EAAKvK,IAAIquB,qBAAuBjvC,EAChCmrB,EAAK27G,GAAG6N,mBACV,IACArgJ,KAAKgyJ,YAAc,IAAIrrI,GAAYwE,EAAK6mI,YAAa,CACnDhrI,SAAS,EACT3S,IAAK,EACL8S,QAAS,SAACzb,GACR,IAAQ4gB,EAAQuK,EAARvK,IACF2lI,EAAiBp7H,EAAKmjB,SAC5BhC,EAAqB,CAACnhB,EAAKm7H,YAAY39I,IAAKpB,KAAKqB,IAA2B,EAAvBuiB,EAAKm7H,YAAY39I,IAAS49I,IAAxEC,EAAIl6G,EAAA,GAAEm6G,EAAIn6G,EAAA,GACjB1rB,EAAIovH,gBAAkBhwI,EAAIwmJ,IAASC,EAAOD,GAC1Cr7H,EAAKu7H,kBAAkB/kI,SAASf,EAAIovH,eACtC,IAEF17I,KAAKoyJ,kBAAoB,IAAIlqI,GAAWiD,EAAKinI,mBAAmB,SAACl4I,GAC/D,IAAQoS,EAAQuK,EAARvK,IACF2lI,EAAiBp7H,EAAKmjB,SAC5BsB,EAAqB,CAACzkB,EAAKm7H,YAAY39I,IAAKpB,KAAKqB,IAAIuiB,EAAKm7H,YAAY39I,IAAK49I,IAApEC,EAAI52G,EAAA,GAAE62G,EAAI72G,EAAA,GACjBhvB,EAAIovH,eAAiBxhI,EACrB2c,EAAKm7H,YAAY3kI,SAAS6kI,EAAOh4I,GAAKi4I,EAAOD,GAC/C,IAEAr9I,GAAI1K,KAAKghB,EAAKknI,YAAa,SAAS,WAAQ7f,EAAG8f,YAAYz7H,EAAK9Y,QAAS,GAC3E,CAsOC,OApODpU,EAAA+zI,EAAA,EAAA//I,IAAA,aAAAE,MACA,SAAY27B,GACV,IAAQ/c,EAAOzc,KAAPyc,GACRzc,KAAKw5B,QAAUA,EACfx5B,KAAKk2C,YAAc1c,EAAU/c,EAAG9H,aAAaC,gBAC/C,GAAC,CAAAjX,IAAA,WAAAE,MAED,SAAUkgB,EAAiBw0I,GAAkB,IAAAC,EAC3CxyJ,KAAK+d,QAAUA,EACf/d,KAAKuyJ,QAAUA,EACf,IAAMjmI,EAAMtsB,KAAKssB,IAAMimI,EAAUvyJ,KAAKwyI,GAAGqN,cAAclmG,YAAc35C,KAAKwyI,GAAGqN,cAAcnmG,WACnFvuB,EAAgHnrB,KAAhHmrB,KAAMgc,EAA0GnnC,KAA1GmnC,IAAGsrH,EAAuGzyJ,KAArGwyI,GAAEkgB,EAAAD,EAAI3gJ,MAASwgC,EAAOogH,EAAPpgH,QAASrhB,EAAMyhI,EAANzhI,OAAQ+c,EAAO0kH,EAAP1kH,QAAW+H,EAAK08G,EAAL18G,MAAK48G,EAAAF,EAAE5S,cAAiBqE,EAAWyO,EAAXzO,YAAaE,EAAYuO,EAAZvO,aACnGhjF,EAA8Cn2C,KAAMoW,OAAOtjB,GAAnDY,EAAMyiD,EAANziD,OAAQ5a,EAAIq9D,EAAJr9D,KAAMioC,EAAKo1B,EAALp1B,MAAiBvvB,EAAE2kD,EAAZ1sD,SAC7B1U,KAAKyc,GAAKA,EACVzc,KAAK4yJ,aAAe70I,IAAYkT,EAASizH,EAAcE,EACvD,IAA8BjlI,EAAa1C,EAAnC9H,aAAgBmI,KACxB9c,KAAK6vF,WAAa7jD,EAAQA,EAAMC,SAAWluB,EAC3C,IAAA80I,EAA8D5nI,KAAMoW,OAAOrhC,KAAK6vF,YAA9D7I,EAAK6rE,EAAfn+I,SAAuBo+I,EAAOD,EAAb9uJ,KAAuBg7D,EAAS8zF,EAAjBl0I,OACxC3e,KAAKgnF,MAAQA,EACbhnF,KAAK+yJ,IAAM,CAAE35H,KAAM,EAAG+gB,YAAa,EAAGC,gBAAiB,EAAGvK,IAAK,EAAGwK,cAAe,EAAGC,eAAgB,GACpGt6C,KAAKgzJ,QAAUhlI,QAAQge,GACvBn3B,GAAIqf,OAAOl0B,KAAKgzJ,QAAS7nI,EAAK8nI,YAAa9nI,EAAK+nI,eAAgB/nI,EAAKgoI,aACrEt+I,GAAIqf,OAAOq+H,EAASpnI,EAAKioI,mBACzBv+I,GAAI27B,OAAOrJ,EAAK,cAAetyB,GAAImK,SAASL,IAC5C9J,GAAIoJ,QAAQkpB,EAAK,cAAepjC,GAChC8Q,GAAIoJ,QAAQkpB,EAAK,gBAAiBhoB,GAClC,IAA8Bk0I,EAAgBrsE,EAAtCryE,aAAgBmI,KAQxB,GAPAjI,GAAIoJ,QAAQkpB,EAAK,oBAAqBksH,GACtCx+I,GAAIoJ,QAAQkpB,EAAK,kBAAmB2rH,GACpCj+I,GAAI27B,OAAOrJ,EAAK,kBAAmBtyB,GAAImK,SAAS+/C,IAChDlqD,GAAIqf,OAAOoe,IAAY5F,GAAgBvhB,EAAKmoI,cAC5Cz+I,GAAIqf,OAAOoe,IAAY1F,GAAiBzhB,EAAKooI,kBAC7CvzJ,KAAK4xJ,UAAUvkI,SAAqB,QAAbmlI,EAAClmI,EAAIouB,gBAAQ,IAAA83G,EAAAA,EA5gEnC,IA6gEDxyJ,KAAK6xJ,gBAAgBxkI,SAASf,EAAIouB,SAzgE9B,KA0gEApI,IAAY1F,GAAiB,KAAA4mH,EACxB9nJ,EAAmG9D,EAA9Fsf,GAAmC,QAAxBssI,EAAClnI,EAAIutB,2BAAmB,IAAA25G,EAAAA,EAvgE3C,EAIF,GAmgEwG,GAAlG,GACRxzJ,KAAKq6C,cAAchtB,SAAS3hB,GAC5B1L,KAAK8xJ,oBAAoBzkI,UAAU3hB,EAxgEjC,GAEC,EAugEL,CACA,GAAI4mC,IAAY5F,GAAgB,CAC9B1sC,KAAKgyJ,YAAY/9I,KAAOhB,KAAKE,MAAMsJ,EAAG9H,aAAaC,kBACnD,IAAMo0B,EAAM/d,KAAM2iB,SAASyK,MAAMrK,GAAmBiI,QAAQF,GAC5D/1C,KAAKgyJ,YAAY39I,KAAQk+I,EAAUvpH,EAAI2yG,iBAAmB3yG,EAAIsyG,iBAAmB7+H,EAAG9H,aAAaC,gBACnG,CACA5U,KAAKs6C,eAAejtB,SAASf,EAAIquB,sBAEjC36C,KAAK+xJ,qBAAqB1kI,UAAUf,EAAIquB,qBApgEpC,GAEC,IAmgEL36C,KAAK+uJ,sBACL/uJ,KAAK8qJ,gBACP,GAAC,CAAAntJ,IAAA,SAAAE,MAED,WACE,IAAQk1J,EAAiB/yJ,KAAjB+yJ,IAAKC,EAAYhzJ,KAAZgzJ,QACTh5G,EAAS+4G,EAAI35H,KAAO25H,EAAIljH,IAAMkjH,EAAI14G,cAAgB04G,EAAIz4G,eAE1D,OADK04G,IAASh5G,GAAU+4G,EAAI54G,YAAc44G,EAAI34G,iBACvCJ,CACT,GAAC,CAAAr8C,IAAA,kBAAAE,MAED,SAAiB+0C,EAAc6gH,EAAqBj6H,EAAiBk6H,EAAmBC,EAAmB15G,GACzGj6C,KAAK4zJ,WAAWp6H,GAChB,IAAQrO,EAAkGnrB,KAAlGmrB,KAAMmB,EAA4FtsB,KAA5FssB,IAAK4pB,EAAuFl2C,KAAvFk2C,YAAa68G,EAA0E/yJ,KAA1E+yJ,IAAKt2I,EAAqEzc,KAArEyc,GAAIuqE,EAAiEhnF,KAAjEgnF,MAAOgsE,EAA0DhzJ,KAA1DgzJ,QAAST,EAAiDvyJ,KAAjDuyJ,QAAOsB,EAA0C7zJ,KAAxCwyI,GAAM1gI,MAASk8B,EAAO6lH,EAAP7lH,QAASsE,EAAOuhH,EAAPvhH,QAC1FnnB,EAAK2oI,SAASz0I,YAAc/V,OAAOspC,GACnCznB,EAAK4oI,YAAY10I,YAAcxK,GAAIiJ,kBAAkBo4B,GACrD68G,EAAI35H,KAAOwZ,EAAOsD,EAClB/qB,EAAK6oI,eAAe30I,YAAcxK,GAAIiJ,kBAAkBi1I,EAAI35H,MAC5D,IAAM66H,EAAiBh6G,EAAK2T,kBAAoBo5B,EAAMryE,aAAaC,iBAUnE,GATAuW,EAAKyiC,kBAAkBvuC,YAAcxK,GAAIiJ,kBAAkBm2I,GAC3D9oI,EAAK2iC,mBAAmBzuC,YAAc46B,EAAK6T,mBAAmBpoC,QAAQ,GACtEyF,EAAK+oI,gBAAgB70I,YAAc/V,OAAOspC,GAC1CmgH,EAAI54G,YAAcF,EAAKE,YAAc6sC,EAAMryE,aAAaC,iBACxDuW,EAAKgvB,YAAY96B,YAAcxK,GAAIiJ,kBAAkBi1I,EAAI54G,aACrDnM,IACF+kH,EAAIljH,IAAM8jH,EAAYl3I,EAAG9H,aAAaC,iBACtCuW,EAAKgpI,UAAU90I,YAAcxK,GAAIiJ,kBAAkBi1I,EAAIljH,MAErDyC,IAAY1F,GAAiB,CAC/B,IAAMqlH,EAAiBh/I,KAAKqB,IAAIq/I,EAAWD,GAAaj3I,EAAG9H,aAAaC,iBACxEuW,EAAKipI,mBAAmB/0I,YAAcxK,GAAIiJ,kBAAkBm0I,GAC5D,IAAM53G,EAAgB43G,EAAiB3lI,EAAIutB,oBAC3Ck5G,EAAI14G,cAAgBA,EACpBlvB,EAAKkvB,cAAch7B,YAAcxK,GAAIiJ,kBAAkBu8B,EACzD,CACA,GAAI24G,EAAS,CACX,IAAMqB,EAAkBp6G,EAAKQ,iBAAmBusC,EAAMryE,aAAaC,iBACnEuW,EAAKmpI,mBAAmBj1I,YAAcxK,GAAIiJ,kBAAkBu2I,GAC5DtB,EAAI34G,gBAAkBi6G,EAAkB/nI,EAAIouB,SAC5CvvB,EAAKywC,YAAYv8C,YAAcxK,GAAIiJ,kBAAkBi1I,EAAI34G,gBAC3D,CACA,GAAIm4G,EAAS,CACX,IAAMx2G,EAAQg3G,EAAI35H,KAAO25H,EAAIljH,IAAMkjH,EAAI14G,cACvClvB,EAAKopI,oBAAoBl1I,YAAcxK,GAAIkc,gBAAgBgrB,EAAQt/B,EAAG9H,aAAaC,iBAAkB6H,GACrGs2I,EAAIz4G,eAAiByB,EAAQzvB,EAAIquB,qBACjCxvB,EAAKmvB,eAAej7B,YAAcxK,GAAIkc,gBAAgBgiI,EAAIz4G,eAAiB79B,EAAG9H,aAAaC,iBAAkB6H,EAC/G,CAEA,GADA5H,GAAIqf,OAAO+lB,EAAK4T,yBAA2B,EAAG1iC,EAAKqpI,mBAC/Cv6G,EAAK4T,yBAA2B,EAAG,CACrC,IAAMomG,EAAiBh6G,EAAK4T,yBAA2Bm5B,EAAMryE,aAAaC,iBAC1EuW,EAAKspI,qBAAqBp1I,YAAcxK,GAAIiJ,kBAAkBm2I,GAC9D9oI,EAAKupI,mBAAmBr1I,YAAc/V,OAAOmqJ,GAC7CtoI,EAAK4iC,qBAAqB1uC,YAAc46B,EAAK8T,qBAAqBroC,QAAQ,EAC5E,CACA1lB,KAAK8oJ,oBACL9oJ,KAAK20J,kBACL30J,KAAK40J,iBACP,GAAC,CAAAj3J,IAAA,oBAAAE,MAED,WACE,IAAQstB,EAAsBnrB,KAAtBmrB,KAAMpN,EAAgB/d,KAAhB+d,QAAStB,EAAOzc,KAAPyc,GACjBu9B,EAASh6C,KAAKg6C,SACpB7uB,EAAK0pI,YAAYx1I,YAAcxK,GAAIkc,gBAAgB9d,KAAKC,MAAM8mC,EAASv9B,EAAG9H,aAAaC,kBAAmB6H,GAC1G0O,EAAK2pI,gBAAgBz1I,YAAcxK,GAAIiJ,kBAAkBk8B,EAAS/uB,KAAMymB,aAAa3zB,GACvF,GAAC,CAAApgB,IAAA,kBAAAE,MAED,WACE,IAAQstB,EAA0CnrB,KAA1CmrB,KAAM4nI,EAAoC/yJ,KAApC+yJ,IAAKljE,EAA+B7vF,KAA/B6vF,WAAY7I,EAAmBhnF,KAAnBgnF,MAC/B,GADkDhnF,KAAZgzJ,QACtC,CACA,IAAMp3F,EAAcm3F,EAAI54G,YAAc44G,EAAI34G,gBAC1CjvB,EAAK4pI,SAAS11I,YAAcxK,GAAIkc,gBAAgB6qC,EAAcorB,EAAMryE,aAAaC,iBAAkBoyE,GACnG77D,EAAK6pI,aAAa31I,YAAcxK,GAAIiJ,kBAAkB89C,EAAc3wC,KAAMymB,aAAam+C,GAHnE,CAItB,GAAC,CAAAlyF,IAAA,kBAAAE,MAED,WACE,IAAQstB,EAA2EnrB,KAA3EmrB,KAAMmB,EAAqEtsB,KAArEssB,IAAG2oI,EAAkEj1J,KAAhEwyI,GAAuBv3F,EAAYg6G,EAA7BpV,cAAiB5kG,aACpCi6G,EADoED,EAAhBnjJ,MAASk8B,SAClCiN,EAEjC,GADApmC,GAAIqf,OAAOghI,EAAe/pI,EAAKgqI,eAC1BD,EAAL,CACA,IAAMjD,EAAiBjyJ,KAAKg6C,SAC5B0B,EAAqB,CAAC17C,KAAKgyJ,YAAY39I,IAAKpB,KAAKqB,IAA2B,EAAvBtU,KAAKgyJ,YAAY39I,IAAS49I,IAAxEC,EAAIx2G,EAAA,GACL05G,EADW15G,EAAA,GACKw2G,EACtBlyJ,KAAKgyJ,YAAY3kI,SAAS6kI,EAAO5lI,EAAIovH,eAAiB0Z,GACtDp1J,KAAKoyJ,kBAAkB/kI,UAAUf,EAAIovH,eA9lEjC,GAEC,EAulEqB,CAM5B,GAAC,CAAA/9I,IAAA,sBAAAE,MAED,WAAuB,IAAA05B,EAAA,KACbpM,EAAgCnrB,KAAhCmrB,KAAMpN,EAA0B/d,KAA1B+d,QAAS60I,EAAiB5yJ,KAAjB4yJ,aACjBhjG,EAAiB3kC,KAAMg7E,wBAAwBloF,GAGrD,GAFAlJ,GAAImD,MAAMmT,EAAKykC,gBACf/6C,GAAIqf,QAAQ07B,EAAe67F,iBAAkBtgI,EAAKkqI,oBAC7CzlG,EAAe67F,iBAApB,CACA,IAAM6J,EAAwC,CAAC,EACzCC,EAA0C,CAAC,EAW3Cx9F,EAAS,SAACzsC,GACd,IAAIA,EAAIogI,gBAAmBn0H,EAAKg7H,QAAhC,CACA,IACIprH,EAbmBquH,EAAgBC,EAAyBC,EAY1DC,EAAU/C,EAAatnI,EAAI3tB,KAEjC,GAAI2tB,EAAIssC,UAAW,CACjBzwB,EAAMhc,EAAKyqI,gBAAgBnqI,WAAU,GACrC,IAAMtL,EAAOtL,GAAI6W,cAAcyb,GAC/BhnB,EAAKpc,KAAKsb,YAAciM,EAAIM,YAC5BzL,EAAKlX,MAAM0vD,QAAsB,SAAZg9F,EACrB9gJ,GAAI1K,KAAKgW,EAAKlX,MAAO,UAAU,WAC7B2pJ,EAAatnI,EAAI3tB,KAAOwiB,EAAKlX,MAAM0vD,QAAU,OAAS,QAfhC,SAACk9F,EAAsBp8I,GACjD,IAAMq8I,EAAUP,EAAcM,GAC9B,GAAKC,EAAL,CAAoB,IACQr0F,EADRC,EAAAr2D,GACCyqJ,GAAO,IAA5B,IAAAp0F,EAAAn2D,MAAAk2D,EAAAC,EAAAl7D,KAAA9E,MAA8B,KAAnB8zJ,EAAM/zF,EAAA5jE,MAAagX,GAAIqf,OAAOza,EAAK67I,EAASE,GAAO,CAAC,OAAA92J,GAAAgjE,EAAA91D,EAAAlN,EAAA,SAAAgjE,EAAA71D,GAAA,CAD3C,CAEtB,CAYMkqJ,CAAoBzqI,EAAI3tB,IAAKqwB,QAAQ7N,EAAKlX,MAAM0vD,SAClD,IACIrtC,EAAIO,cAAa1L,EAAKgF,QAAQ5G,QAAQ4G,QAAUmG,EAAIO,YAC1D,MAAO,GAAIP,EAAIwB,QAAS,CACtB,IAAAkpI,EAA8B1qI,EAAIwB,QAA1BhK,EAAKkzI,EAALlzI,MAAOC,EAAGizI,EAAHjzI,IAAK8K,EAAKmoI,EAALnoI,MACd7K,EAAQD,EAAIkG,EAAInG,EAAMmG,EAC5Bke,EAAMhc,EAAK8qI,iBAAiBxqI,WAAU,GACtC,IAAMtL,EAAOtL,GAAI6W,cAAcyb,GAC/BhnB,EAAKpc,KAAKsb,YAAciM,EAAIM,YACxBN,EAAIO,cAAa1L,EAAKgF,QAAQ5G,QAAQ4G,QAAUmG,EAAIO,aACpDgC,EAAO1N,EAAKrD,KAAKuC,YAAcwO,EAC9BhZ,GAAI2E,KAAK2G,EAAKrD,MAEnB,IAAM7T,EAAQ,IAAI0d,GAAYxG,EAAKtiB,MAAO,CACxCoW,KAAM,EACNkT,QAAS,SAACw5H,GACR,IAAqCuV,EAAAtuJ,EAAtBqf,GAAc05H,EAAM,GAAE,GAA9Bj1I,EAACwqJ,EAAA,GAAE3qJ,EAAC2qJ,EAAA,GACXtD,EAAatnI,EAAI3tB,KAAO4N,EACxB8iB,EAAOhB,UAAU3hB,EAAIoX,EAAMmG,GAAKjG,EAClC,IAEIqL,EAAS,IAAInG,GAAW/H,EAAKkO,QAAQ,SAACnU,GAC1C,IACqCi8I,EAAAvuJ,EAAtBqf,GADFnE,EAAMmG,EAAI/O,EAAI8I,EACQ,GAAE,GAA9BtX,EAACyqJ,EAAA,GAAE5qJ,EAAC4qJ,EAAA,GACXvD,EAAatnI,EAAI3tB,KAAO4N,EACxBtC,EAAMokB,SAAS3hB,EACjB,IAEoE0qJ,EAAAxuJ,EAArDqf,GAAcM,GAAkBouI,EAAS7yI,EAAMmG,GAAI,GAAE,GAA7Dvd,EAAC0qJ,EAAA,GAAE7qJ,EAAC6qJ,EAAA,GACXxD,EAAatnI,EAAI3tB,KAAO4N,EACxB8iB,EAAOhB,UAAU3hB,EAAIoX,EAAMmG,GAAKjG,GAChC/Z,EAAMokB,SAAS3hB,GACfyU,EAAKtiB,MAAMwhB,YAAc9T,CAC3B,CACA,IAAK47B,EAAK,OAAOxsB,QAAQvZ,MAAM,+BAAgCkqB,GAE/D,GADAH,EAAKykC,eAAet3C,YAAY6uB,GAC5B7b,EAAI+qI,UAAW,CAzDIb,EA0DLlqI,EAAI3tB,IA1DiB83J,EA0DZtuH,EA1DqCuuH,EA0DhCpqI,EAAI+qI,UAzD/Bd,EAAcG,KAAcH,EAAcG,GAAe,IAC9DH,EAAcG,GAAa1yJ,KAAKwyJ,GAChCF,EAASE,GAAUC,EAwDjB,IAAMa,EAAe1D,EAAatnI,EAAI+qI,WACtCxhJ,GAAIqf,OAAwB,SAAjBoiI,EAAyBnvH,EACtC,CAlD+C,CAmDjD,EAEA,GAAIyoB,EAAe67F,kBAAoB77F,EAAe67F,iBAAiBloJ,OAAS,EAAG,KAChCo+D,EADgCC,EAAAv2D,GAC/DukD,EAAe67F,kBAAgB,IAAjD,IAAA7pF,EAAAr2D,MAAAo2D,EAAAC,EAAAp7D,KAAA9E,MAAmDq2D,EAArC4J,EAAA9jE,MAAgD,OAAAa,GAAAkjE,EAAAh2D,EAAAlN,EAAA,SAAAkjE,EAAA/1D,GAAA,CAChE,CACAof,KAAM2oC,aAAazoC,EAAKykC,eAtEoB,CAuE9C,GAAC,CAAAjyD,IAAA,iBAAAE,MAED,WACE,IAAQstB,EAA8GnrB,KAA9GmrB,KAAMpN,EAAwG/d,KAAxG+d,QAAStB,EAA+Fzc,KAA/Fyc,GAAIozE,EAA2F7vF,KAA3F6vF,WAAY7I,EAA+EhnF,KAA/EgnF,MAAKuvE,EAA0Ev2J,KAAxEwyI,GAAEgkB,EAAAD,EAAIzkJ,MAASk8B,EAAOwoH,EAAPxoH,QAAS/c,EAAMulI,EAANvlI,OAAU2mB,EAAc2+G,EAAd3+G,eAAgBC,EAAe0+G,EAAf1+G,gBAC7E7H,EAAgB/kB,KAAM8sB,UAAUh6B,GAA3Cy6B,QAAWxI,UACbymH,EAASz2J,KAAKwyI,GAAGlkG,oBAAoBvwB,GACrCwvH,EAAWv9F,EAAYymH,EAAOvmH,IAAID,MACpCm9F,EAAW,EASf,GARAv4H,GAAIqf,OAAO8Z,EAAS7iB,EAAKurI,kBACrB1oH,IACF7iB,EAAKoiH,SAASluH,YAAcxK,GAAIiJ,kBAAkByvH,EAAW9wH,EAAG9H,aAAaC,kBAE7Ew4H,GADmCrvH,IAAYkT,EAAS2mB,EAAiBC,GAAjE7H,UACiBymH,EAAO5mH,IAAII,MACpC9kB,EAAKiiH,SAAS/tH,YAAcxK,GAAIiJ,kBAAkBsvH,EAAW3wH,EAAG9H,aAAaC,mBAE/EuW,EAAK4kB,MAAM1wB,YAAcxK,GAAIiJ,mBAAmByvH,EAAWH,GAAY3wH,EAAG9H,aAAaC,kBACnFmJ,IAAY8xE,EAAhB,CACA,IAA8BogC,EAAehlG,KAAM8sB,UAAU83C,GAArDr3C,QAAWxI,UACnB7kB,EAAK8kG,SAAS5wG,YAAcxK,GAAIiJ,kBAAkBmyG,EAAWjpC,EAAMryE,aAAaC,iBAF9C,CAGpC,KAAC8oI,CAAA,CA3UY,GC56Df,IAEqBiZ,GAAe,SAAAxgF,GAAA/rE,EAAAusJ,EAAAxgF,GAAA,IA8ajCC,EATDwgF,EAbCC,EAlDA5kF,EANA6kF,EATDvgF,EATCwgF,EA/BDC,EAtBAC,EAZCC,EAZAC,EAZD37E,EArCC47E,EAxBAC,MAxLiC3vI,KAAAivI,iZAkBlC,SAAAA,EAAarpJ,GAAmB,IAAA6L,EAAAtQ,EAAA,KAAA8tJ,GACvB7sJ,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,sBAAArP,EAAAC,EAAAoP,GAAA,6BAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,uBAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,8BAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,sBACPA,EAAK7L,KAAOA,EACZ,IAAMg6B,EAAOnuB,EAAKmuB,KAAOh6B,EAAKiR,QAAQ+oB,KAAOh6B,EAAKiR,QAAQ+oB,KAAO,GAC3D2zB,EAAKhwC,KAAMuc,UAAUF,GACrBnc,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAc/vC,GAC3C6L,EAAK8jC,MAAQpoC,GAAImG,cAAcmQ,EAAK8xB,MAAO,iBAE3C9jC,EAAK89D,oBAAsB,IAAIh6B,GAA8B9xB,EAAK0sD,eAAcpvE,EAAAzL,IAAAA,MAAE,SAAA8P,IAAA,OAAA9P,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAEpB,OAD5D6W,EAAKi8D,YAAY74D,GAAUA,KAC3BpD,EAAKm+I,YAAY5wI,SAASvN,EAAK89D,oBAAoB/b,KAAO,GAAEhuD,EAAA5K,KAAA,EACtD2oB,KAAMqhD,YAAW,OACvBrhD,KAAMgtD,yBAAwB,wBAAA/qE,EAAAlI,OAAA,GAAA8H,EAAA,MAC7B,WACDqM,EAAKo+I,aAAap+I,EAAKi+D,aAAcjsD,EAAKisD,aAC5C,IACAj+D,EAAK89D,oBAAoBjW,YAAY/F,EAAI,IAEzC9hD,EAAKu+D,eAAiB,IAAIz6B,GAAqB9xB,EAAKysD,YAAY,WAC9Dz+D,EAAKo+I,aAAap+I,EAAK89D,oBAAqB9rD,EAAK0sD,eACnD,IAAG,WACD1+D,EAAKo+I,aAAap+I,EAAKi+D,aAAcjsD,EAAKisD,aAC5C,IACAj+D,EAAKu+D,eAAe1W,YAAY/F,GAEhC9hD,EAAK49D,cAAgB,IAAI95B,GACvB9xB,EAAK4rD,eACL,SAAAh5D,GAAO,OAAI5E,EAAK69D,iBAAiBj5D,EAAS5E,EAAK89D,oBAAoB/b,KAAK,IACxE,kBAAM/hD,EAAKo+I,aAAap+I,EAAKi+D,aAAcjsD,EAAKisD,aAAa,IAG/Dj+D,EAAKi+D,aAAe,IAAIn6B,GAA4B9xB,EAAKisD,aAAY,eAAAn9D,EAAAxR,EAAAzL,IAAAA,MAAE,SAAAiR,EAAO8P,EAAiBm9C,GAAY,IAAAj8C,EAAAmG,EAAAk5B,EAAA+4B,EAAA,OAAAr6E,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,UACrGyb,IAAYiN,GAAa,CAAA7c,EAAA7L,KAAA,eAAA6L,EAAA7L,KAAA,EACrB2oB,KAAMqhD,YAAW,OAEkC,OADzDnzD,EAAKypG,mBACLzpG,EAAKi8D,YAAY74D,GAAUA,KAA8BpO,EAAAlM,OAAA,iBAIhC,GADrBgd,EAAQgM,KAAMoW,OAAOtjB,KACrBqH,EAASnG,EAAMmG,QACT,CAAFjX,EAAA7L,KAAA,SACuC,OAAzCg8C,EAASrzB,KAAMuzB,QAAQrzB,EAAKisD,cAAajpE,EAAA7L,KAAA,GAClB6W,EAAKo+D,kBAAkBx5D,EAASoN,EAAKisD,cAAa,QAG9B,OAH3CC,EAAclpE,EAAArM,KACpBqX,EAAK89D,oBAAoBO,SAASz5D,EAASm9C,EAAMmc,GACjD/4B,IACAnlC,EAAKq+I,4BAA4Bz5I,EAASqH,GAAOjX,EAAAlM,OAAA,kBAGnDkX,EAAK89D,oBAAoBO,SAASz5D,EAASm9C,EAAM,GACjD/hD,EAAK49D,cAAcS,SAASz5D,GAC5B5E,EAAKkrE,SAASl5D,EAAK4rD,eAAc,yBAAA5oE,EAAAnJ,OAAA,GAAAiJ,EAAA,KAClC,gBAAAjG,EAAA2E,GAAA,OAAAsN,EAAArR,MAAA,KAAAD,UAAA,EApBoE,IAqBrEwQ,EAAKi+D,aAAapW,YAAY/F,EAAI,IAElC9hD,EAAKwiG,gBAAkB,IAAIz0E,GAAgB/b,EAAKssI,UAChDt+I,EAAKwiG,gBAAgB2Q,QAAQhlF,GAE7BzyB,GAAI1K,KAAKghB,EAAKusI,aAAc,SAAS,kBAAMv+I,EAAKw+I,eAAe,IAE/Dx+I,EAAKy+I,gBAA4C,SAA1BtqJ,EAAKiR,QAAQ2G,SACpCrQ,GAAI1K,KAAKghB,EAAK0sI,uBAAwB,SAAS,WACxC1+I,EAAKy+I,gBACLz+I,EAAK2+I,qBAAoB,GADH3+I,EAAK4+I,sBAAsB5sI,EAAK6sI,mBAE7D,IACAnjJ,GAAI1K,KAAKghB,EAAK8sI,cAAe,SAAS,kBAAM9sI,EAAK+sI,cAAcjkI,OAAO,IACtEpf,GAAI1K,KAAKghB,EAAKgtI,cAAe,SAAS,kBAAMh/I,EAAKi/I,mBAAmB,IACpEvjJ,GAAI1K,KAAKghB,EAAK+sI,cAAe,UAAU,kBAAM/+I,EAAK04D,kBAAkB,IACpEh9D,GAAI1K,KAAKghB,EAAKktI,iBAAkB,SAAS,kBAAMptI,KAAM2yB,SAAS,WAAW,IAEzE,IAAM06G,EAAe,WACnBn/I,EAAKi+D,aAAapW,YAAY/1C,KAAMuc,UAAUF,GAAO,IACrDnuB,EAAKkrE,SAASl5D,EAAKisD,aACrB,EACAviE,GAAI1K,KAAKghB,EAAKotI,WAAY,SAAS,WAAQD,GAAe,IAC1D,IAAME,EAAgBv9F,EAAGxzB,KAAKoB,WAAa,EAC3C1vB,EAAKm+I,YAAc,IAAIzxI,GAAUsF,EAAKstI,gBAAiBttI,EAAKutI,SAAUF,EAAa,eAAA95I,EAAAjW,EAAAzL,IAAAA,MAAE,SAAAuR,EAAO8X,GAAiB,OAAArpB,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,WACvG6W,EAAKy+I,gBAAiB,CAAFppJ,EAAAlM,KAAA,eAAAkM,EAAAvM,OAAA,qBACpBokB,EAAU,CAAF7X,EAAAlM,KAAA,QAAEg2J,IAAc9pJ,EAAAlM,KAAA,sBAAAkM,EAAAvM,OAAA,SAChBkX,EAAKw/I,oBAAkB,wBAAAnqJ,EAAAxJ,OAAA,GAAAuJ,EAAA,KACpC,gBAAA3B,GAAA,OAAA8R,EAAA9V,MAAA,KAAAD,UAAA,EAJkF,IAKnFkM,GAAI1K,KAAKghB,EAAKytI,aAAc,SAAS,SAAChtJ,GACpCA,EAAE2a,kBACGpN,EAAKy+I,iBAAiBzsI,EAAKstI,gBAAgBxkI,OAClD,IAEA9I,EAAK0tI,aAAax5I,YAAc/V,OAAO2xD,EAAGxzB,KAAKoxH,cAC/C,IAAMC,EAAgB,WACpBjkJ,GAAI2E,KAAK2R,EAAK4tI,kBACdlkJ,GAAIyE,KAAK6R,EAAK0tI,aAChB,EAwEuB,OAvEvBhkJ,GAAI1K,KAAKghB,EAAK6tI,eAAgB,SAAS,SAACptJ,GACtCA,EAAE2a,kBACF,IAAM00C,EAAKhwC,KAAMuc,UAAUruB,EAAKmuB,MAChCnc,EAAK4tI,iBAAiBl7J,MAAQyL,OAAO2xD,EAAGxzB,KAAKoxH,cAC7ChkJ,GAAI2E,KAAK2R,EAAK0tI,cACdhkJ,GAAIyE,KAAK6R,EAAK4tI,kBACd5tI,EAAK4tI,iBAAiBhqI,QAMtBla,GAAI1K,KAAKc,SAAU,SALA,SAAbguJ,EAAcrtJ,GACdiJ,GAAIk6C,eAAenjD,EAAGuf,EAAK6tI,kBAC/BF,IACAjkJ,GAAImU,OAAO/d,SAAU,QAASguJ,GAChC,GAEF,IAEApkJ,GAAI1K,KAAKghB,EAAK4tI,iBAAkB,QAAO,eAAA5yI,EAAA1d,EAAAzL,IAAAA,MAAE,SAAA2mB,EAAO/X,GAAgB,IAAAitJ,EAAAv6G,EAAA,OAAAthD,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAChC,GAA9BuS,GAAI2E,KAAK2R,EAAK+tI,iBACA,WAAVttJ,EAAEjO,IAAgB,CAAAimB,EAAAthB,KAAA,QACL,OAAfw2J,IAAel1I,EAAA3hB,OAAA,oBAGD,UAAV2J,EAAEjO,IAAe,CAAAimB,EAAAthB,KAAA,eAAAshB,EAAA3hB,OAAA,iBACyC,GAA1D42J,EAAehmJ,SAASsY,EAAK4tI,iBAAiBl7J,OAAS,KACzDyF,MAAMu1J,GAAe,CAAFj1I,EAAAthB,KAAA,SAEoD,OADzEuS,GAAIyE,KAAK6R,EAAK+tI,iBACd/tI,EAAK+tI,gBAAgB75I,YAAc9C,G3BCL,uB2BD2CqH,EAAA3hB,OAAA,kBAGvB,OAA9Cq8C,EAASrzB,KAAMuzB,QAAQrzB,EAAKguI,mBAAkBv1I,EAAA/e,KAAA,GAAA+e,EAAAthB,KAAA,GAE5C6W,EAAKigJ,kBAAkB,CAAEP,aAAAA,IAAe,QAC9Cv6G,IACAnzB,EAAK0tI,aAAax5I,YAAc/V,OAAOuvJ,GAAaj1I,EAAAthB,KAAA,iBAAAshB,EAAA/e,KAAA,GAAA+e,EAAAlW,GAAAkW,EAAA,UAEpD06B,IACAzpC,GAAIyE,KAAK6R,EAAK+tI,iBACd/tI,EAAK+tI,gBAAgB75I,YAAc9C,GAAUA,EAAmB,CAAE3O,IAAKgW,EAAAlW,GAAEE,MAAM,QAEjFkrJ,IAAe,yBAAAl1I,EAAA5e,OAAA,GAAA2e,EAAA,oBAChB,gBAAA7V,GAAA,OAAAqY,EAAAvd,MAAA,KAAAD,UAAA,EAxBsC,IA0BvCwQ,EAAKy9D,YAAc,IAAI35B,GAAqB9xB,EAAKyrD,YAAW,eAAAh0C,EAAAn6B,EAAAzL,IAAAA,MAAE,SAAA6mB,EAAOo3C,GAAY,OAAAj+D,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAC/E2oB,KAAM2yB,SAAS,gBAAD7xC,OAAiBkvD,EAAG3zB,OAAO,wBAAAxjB,EAAA9e,OAAA,GAAA6e,EAAA,KAC1C,gBAAA9V,GAAA,OAAA60B,EAAAh6B,MAAA,KAAAD,UAAA,EAF2D,GAEzDwQ,EAAKmuB,MAGR2V,GAAW9xB,EAAK6sI,mBAAoB7sI,EAAKkuI,uBAAuB,kBAAMlgJ,EAAK2+I,qBAAoB,EAAK,IAEpGjjJ,GAAI1K,KAAKghB,EAAK8xB,MAAO,aAAa,SAACrxC,GAC5BiJ,GAAIk6C,eAAenjD,EAAGuN,EAAKynC,cAAgBznC,EAAK2jE,aACvD,IAEA3jE,EAAK61C,MAAQ,SAACpjD,GACE,WAAVA,EAAEjO,KACJwb,EAAK2jE,aAET,EACAjoE,GAAI1K,KAAKc,SAAU,QAASkO,EAAK61C,OAEjCn6C,GAAImG,cAAcmQ,EAAK8xB,MAAO,gBAAgB18C,SAAQ,SAAAyU,GACpDH,GAAI1K,KAAK6K,EAAI,SAAS,WAAQmE,EAAK2jE,aAAc,GACnD,IAEA7xD,KAAMilC,mBAAmB,CACvBgmD,KAAM,WAAQ/8F,EAAKwmH,qBAAsB,EACzChd,WAAY,WAAQxpG,EAAKypG,kBAAmB,EAC5CC,WAAY,WAAQ1pG,EAAKypG,kBAAmB,EAC5CN,SAAU,WAAQnpG,EAAKypG,kBAAmB,IAG5CzpG,EAAKwmH,sBACLxmH,EAAKypG,mBAAkBzpG,CACzB,CAgRC,OAhRAxP,EAAAgtJ,EAAA,EAAAh5J,IAAA,SAAAE,MAED,WACEgX,GAAImU,OAAO/d,SAAU,QAASjL,KAAKgvD,MACrC,GAAC,CAAArxD,IAAA,8BAAAE,OAAAw5J,EAAA5uJ,EAAAzL,IAAAA,MAED,SAAAopB,EAAmCrI,EAAiBqH,GAAmB,IAAA+F,EAAA8uB,EAAAh7B,EAAAq8C,EAAAW,EAAA3d,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OAI3B,GAHlC6oB,EAAwCnrB,KAAxCmrB,KAA6B8uB,EAAWj6C,KAAlCi3E,oBAAuBh9B,KAC/Bh7B,EAAQgM,KAAMoW,OAAOtjB,GACnBu9C,EAAet7D,KAAKo3E,aAAanc,GAAjCK,WACFW,EAAYX,EAAWr8C,EAAMN,QAC9ByG,EAAOQ,KAAM,CAAFU,EAAAhkB,KAAA,SAC0B,OAAlCg8C,EAASrzB,KAAMuzB,QAAQrzB,EAAK8xB,OAAM32B,EAAAhkB,KAAA,EACtBuL,EAAS,kBAAmB,CAAEkQ,QAASA,IAAU,OAKlE,OALK3U,EAAGkd,EAAAxkB,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,KACvBpJ,KAAKo3E,aAAakiF,cAAc,2BAADvtJ,OAA4B3C,EAAIwE,MAC/D5N,KAAKu3J,aAAav3J,KAAKo3E,aAAcjsD,EAAKisD,eAC3C9wD,EAAArkB,OAAA,uBAGCmjB,EAAOI,QAAUJ,EAAOozB,QAAQxI,WAAa,EAAIisB,EAAU55C,OAAS43B,GAAI,CAAA3zB,EAAAhkB,KAAA,SAEtB,OAApDtC,KAAKu5J,uCAAuCx7I,GAAQuI,EAAArkB,OAAA,kBAGtDjC,KAAK03E,eAAeC,UAAU55D,EAASk8B,EAAMj6C,KAAKi3E,oBAAoB/b,MACtEl7D,KAAKqkF,SAASl5D,EAAKysD,YAAW,yBAAAtxD,EAAAthB,OAAA,GAAAohB,EAAA,UAC/B,SAAA/X,EAAAqV,GAAA,OAAA2zI,EAAAzuJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,yCAAAE,OAAAu5J,EAAA3uJ,EAAAzL,IAAAA,MAED,SAAA+sB,EAA8CqxC,GAAmB,IAAAH,EAAApyB,EAAA1d,EAAA4c,EAAAuW,EAAA,OAAAthD,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,OAIyB,GAHlF24D,EAAKhwC,KAAMuc,UAAUxnC,KAAKsnC,MAC1BuB,EAAa7oC,KAAKi3E,oBAAoB/b,KACtC/vC,EAAOnrB,KAAKmrB,KACZ4c,EAAakzB,EAAGxzB,KAAK+xH,aAAev+F,EAAGxzB,KAAKk/E,gBAAkB1rD,EAAGxzB,KAAKmB,eACxEC,EAAaoyB,EAAGxzB,KAAKoB,YAAcA,EAAad,GAAU,CAAA1d,EAAA/nB,KAAA,QACI,OAAhEtC,KAAKu3J,aAAav3J,KAAKi3E,oBAAqB9rD,EAAK0sD,gBAAextD,EAAApoB,OAAA,iBAI3B,OAAjCq8C,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAK+c,EAAAxlB,KAAA,EAAAwlB,EAAA/nB,KAAA,GAE/BtC,KAAKo5J,kBAAkB,CAAEh+F,YAAAA,EAAavyB,WAAAA,IAAa,QACzDyV,IAAQj0B,EAAA/nB,KAAA,iBAG6B,OAH7B+nB,EAAAxlB,KAAA,GAAAwlB,EAAA3c,GAAA2c,EAAA,SAERi0B,IACAt+C,KAAKo3E,aAAa7V,aAAal3C,EAAA3c,GAAEE,KAAIyc,EAAApoB,OAAA,kBAIvCjC,KAAKo1E,YAAY74D,GAAUA,KAA8B,yBAAA8N,EAAArlB,OAAA,GAAA+kB,EAAA,mBAC1D,SAAAtD,GAAA,OAAA2wI,EAAAxuJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACZsc,EAAOxc,KAAMuc,UAAUxnC,KAAKsnC,MAAMG,KACzBgyH,EAA0ChyH,EAAjDI,IAAO4xH,UAAa5wH,EAA6BpB,EAA7BoB,WAAY6wH,EAAiBjyH,EAAjBiyH,aAClC5xH,EAAcC,GAAWN,GAC/Btc,EAAK0d,WAAWxpB,YAAc/V,OAAOu/B,GACrC1d,EAAK2d,cAAczpB,YAAc/V,OAAOw+B,GACxC3c,EAAKsuI,UAAUp6I,YAAc/V,OAAOmwJ,GACpCtuI,EAAKwuI,mBAAmBt6I,YAAc,GAAHtT,QAAM2tJ,aAAY,EAAZA,EAAcn2J,SAAU,GACjEvD,KAAK27G,gBAAgBp7D,QACvB,GAEA,CAAA5iD,IAAA,WAAAE,OAAA29E,EAAA/yE,EAAAzL,IAAAA,MACA,SAAAmxC,EAAgByY,GAAiB,IAAAz7B,EAAAoQ,EAAA,OAAAv+B,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,OAM8B,OALvD6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK4gD,YAAcgG,EACnB5mD,KAAKi9C,MAAM18C,SAAQ,SAAAqmD,GAAI,OAAI/xC,GAAI2E,KAAKotC,EAAK,IACzCA,EAAKrsC,MAAMvE,MAAQ,UACnBnB,GAAIyE,KAAK6R,EAAK8xB,MAAO2J,GACfrrB,GAASpQ,EAAK8xB,MAAMvmC,YAAckwC,EAAKlwC,aAAe,EAAC23B,EAAA/rC,KAAA,EACvDuS,GAAIyF,QA/PU,KA+Pe,SAAA60C,GACjCvI,EAAKrsC,MAAMvE,MAAQ,GAAHjK,QAAO,EAAIojD,GAAY5zB,EAAK,KAC9C,GAAG,eAAc,OACjBqrB,EAAKrsC,MAAMvE,MAAQ,IAAG,wBAAAq4B,EAAArpC,OAAA,GAAAmpC,EAAA,UACvB,SAAAzkB,GAAA,OAAA8xD,EAAA5yE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,OAAAs5J,EAAA1uJ,EAAAzL,IAAAA,MAED,SAAAi6C,EAAoBxS,EAAemiB,GAAiB,OAAA5pD,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,OACxB,OAA1BuS,GAAI2E,KAAKxZ,KAAK4gD,aAAY1J,EAAA50C,KAAA,EACpBmiC,EAAInqB,UAAS,OACnBta,KAAK4gD,YAAcgG,EACnB/xC,GAAIyE,KAAKstC,GAAK,wBAAA1P,EAAAlyC,OAAA,GAAAiyC,EAAA,UACf,SAAAttB,EAAAC,GAAA,OAAAutI,EAAAvuJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,cAAAE,MAED,WACEgX,GAAI2E,KAAKxZ,KAAKmrB,KAAK8xB,OACfj9C,KAAK2mF,WAAW3mF,KAAK2mF,UAAU3hF,MACrC,GAAC,CAAArH,IAAA,cAAAE,OAAAq5J,EAAAzuJ,EAAAzL,IAAAA,MAED,SAAAohD,EAAmBxwC,GAAW,IAAAsY,EAAA,YAAAlpB,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,OAGsB,OAFlDtC,KAAKi9C,MAAM18C,SAAQ,SAAAqmD,GAAI,OAAI/xC,GAAI2E,KAAKotC,EAAK,IACzC5mD,KAAK4gD,YAAc5gD,KAAKmrB,KAAKmqD,cAC7Bt1E,KAAK2mF,UAAY1pC,GAAkBj9C,KAAKmrB,KAAMvd,GAAI2wC,EAAAj8C,KAAA,EAC5CtC,KAAK2mF,UAAU5sE,OAAM,OAC3B/Z,KAAK2mF,UAAY,IAAI7sE,GAAU,MAAM,WAAkB,GAAI,IAAI,WACzDoM,EAAK06B,cAAgB16B,EAAKiF,KAAKmqD,eAAepvD,EAAK42D,aACzD,IAAE,wBAAAv+B,EAAAv5C,OAAA,GAAAo5C,EAAA,UACH,SAAAv0B,GAAA,OAAAqtI,EAAAtuJ,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,OAAAo5J,EAAAxuJ,EAAAzL,IAAAA,MACA,SAAA0hD,IAAA,IAAAvzB,EAAAmc,EAAAsV,EAAA0B,EAAAl1C,EAAAwwJ,EAAAjzJ,EAAA,OAAA3J,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,OAGyC,OAF/B6oB,EAAenrB,KAAfmrB,KAAMmc,EAAStnC,KAATsnC,KACRsV,EAAM,CAAEtV,KAAAA,GACRgX,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAKqxC,EAAAr8C,KAAA,EACrBuL,EAAS,qBAAsB+uC,GAAI,OAC7C,GADFxzC,EAAGu1C,EAAA78C,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFu1C,EAAAr8C,KAAA,SAEI,OAD/B6oB,EAAK0uI,iBAAiBx6I,YAAcjW,EAAIwE,IACxCiH,GAAIyE,KAAK6R,EAAK0uI,kBAAiBl7G,EAAA18C,OAAA,kBAGjCmH,EAAIiqG,QAAQG,MAAQpqG,EAAIoqG,MAClBomD,EAAmBvtJ,KAAKG,MAAMH,KAAKC,UAAUlD,EAAIiqG,WACjD1sG,EAAIsE,SAAS4P,cAAc,MAC/Bw7E,aAAa,WAAY,cAAgB/uD,EAAO,SAClD3gC,EAAE0vF,aAAa,OAAQ,kBAAoBhqF,KAAKC,UAAUstJ,EAAkB,KAAM,IAClFjzJ,EAAEstB,QACFpf,GAAI2E,KAAK2R,EAAK8xB,OAAM,yBAAA0B,EAAA35C,OAAA,GAAA05C,EAAA,UACrB,kBAAAu4G,EAAAruJ,MAAA,KAAAD,UAAA,IAGD,CAAAhL,IAAA,sBAAAE,OAAAm5J,EAAAvuJ,EAAAzL,IAAAA,MACA,SAAAkiD,EAA2BjzB,GAAe,IAAAd,EAAAmc,EAAAsV,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,OAMD,OALjC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKmqC,QACVhuB,EAAoBtnC,KAAKsnC,KACzBrb,IAASqb,EAAOnc,EAAK2uI,mBAAmBz6I,aACtCu9B,EAAM,CAAEtV,KAAAA,EAAMrb,QAASA,GACvBqyB,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAKqyC,EAAAr9C,KAAA,EACrBuL,EAAS,2BAA4B+uC,GAAI,OACnD,GADFxzC,EAAGu2C,EAAA79C,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFu2C,EAAAr9C,KAAA,SAO1B,OANG2pB,GACFd,EAAK4uI,kBAAkB16I,YAAcjW,EAAIwE,IACzCiH,GAAIyE,KAAK6R,EAAK4uI,qBAEd5uI,EAAKmqC,OAAOj2C,YAAcjW,EAAIwE,IAC9BiH,GAAIyE,KAAK6R,EAAKmqC,SACf3V,EAAA19C,OAAA,kBAWH,OARIgqB,GACFjsB,KAAKmrB,KAAK0sI,uBAAuBx4I,YAAc9C,G3B3JpB,kB2B4J3B1H,GAAI2E,KAAK2R,EAAK8xB,QACTj9C,KAAKmrB,KAAK0sI,uBAAuBx4I,YAAc9C,G3B5JxB,mB2B8J9Bvc,KAAK43J,gBAAkB3rI,EAGvB0zB,EAAAr9C,KAAA,GACM2oB,KAAMqhD,YAAW,QACvBrhD,KAAM2yB,SAAS,eAAD7xC,OAAgBu7B,IAAO,yBAAAqY,EAAA36C,OAAA,GAAAk6C,EAAA,UACtC,SAAAH,GAAA,OAAAi4G,EAAApuJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,wBAAAE,OAAAk5J,EAAAtuJ,EAAAzL,IAAAA,MAED,SAAAkmE,EAA6B80F,GAA+B,IAAA7sI,EAAA,OAAAnuB,IAAAA,MAAA,SAAAo/D,GAAA,cAAAA,EAAAv3D,KAAAu3D,EAAA95D,MAAA,QACpD6oB,EAAOnrB,KAAKmrB,MACb2uI,mBAAmBz6I,YAAcrf,KAAKsnC,KAC3Cnc,EAAK4uI,kBAAkB16I,YAAc,GACrCrf,KAAKqkF,SAAS2zE,GAAmB,wBAAA57F,EAAAp3D,OAAA,GAAAk+D,EAAA,UAClC,SAAAlkB,GAAA,OAAA+3G,EAAAnuJ,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,oBAAAE,OAAA04E,EAAA9tE,EAAAzL,IAAAA,MACA,SAAA0mE,EAAyB3lD,EAAiB6oC,GAAiB,IAAAtI,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAomE,GAAA,cAAAA,EAAAv+D,KAAAu+D,EAAA9gE,MAAA,OACvB,OAA5Bg8C,EAASrzB,KAAMuzB,QAAQoI,GAAKwc,EAAA9gE,KAAA,EAChBuL,EAAS,sBAAuB,CAAEkQ,QAAAA,IAAU,OACtD,GADF3U,EAAGg6D,EAAAthE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAFg6D,EAAA9gE,KAAA,eAAA8gE,EAAAnhE,OAAA,SACpB,GAAC,cAAAmhE,EAAAnhE,OAAA,SAEHmH,EAAI4uE,WAAS,wBAAA5U,EAAAp+D,OAAA,GAAA0+D,EAAA,KACrB,SAAAzkB,EAAAwB,GAAA,OAAA81B,EAAA3tE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,oBAAAE,OAAAi5J,EAAAruJ,EAAAzL,IAAAA,MAED,SAAA+qE,IAAA,IAAA58C,EAAA,OAAAnuB,IAAAA,MAAA,SAAA4mE,GAAA,cAAAA,EAAA/+D,KAAA++D,EAAAthE,MAAA,OACQ6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK42E,YAAYzL,UACjBnrE,KAAKqkF,SAASl5D,EAAKyrD,aAAY,wBAAAhT,EAAA5+D,OAAA,GAAA+iE,EAAA,UAChC,kBAAA+uF,EAAAluJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,OAAAo0E,EAAAxpE,EAAAzL,IAAAA,MAED,SAAA0rE,IAAA,IAAAv9C,EAAA+rC,EAAAsF,EAAA5f,EAAA0B,EAAAl1C,EAAA,OAAApM,IAAAA,MAAA,SAAAgrE,GAAA,cAAAA,EAAAnjE,KAAAmjE,EAAA1lE,MAAA,OAGwC,GAFhC6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKmqC,UACR4B,EAAQ/rC,EAAK+sI,cAAchhG,SAEpBA,EAAM3zD,OAAM,CAAAykE,EAAA1lE,KAAA,eAAA0lE,EAAA1lE,KAAA,EAAe40D,EAAM,GAAGvpD,OAAM,OAA5B6uD,EAAIwL,EAAAlmE,KAAA,UAC1B06D,EAAM,CAAFwL,EAAA1lE,KAAA,eAAA0lE,EAAA/lE,OAAA,iBAE8B,OADjC26C,EAAM,CAAEtV,KAAMtnC,KAAKsnC,KAAMk1B,KAAMA,GAC/Ble,EAASrzB,KAAMuzB,QAAQx+C,KAAKsN,MAAK06D,EAAA1lE,KAAA,GACrBuL,EAAS,kBAAmB+uC,GAAI,QAA5CxzC,EAAG4+D,EAAAlmE,KACTw8C,IACKrzB,KAAM6mC,cAAc1oD,IAIvByL,GAAIyE,KAAK6R,EAAK6uI,eACdzgJ,YAAW,WAAQ1E,GAAI2E,KAAK2R,EAAK6uI,cAAe,GAAG,OAJnD7uI,EAAKmqC,OAAOj2C,YAAcjW,EAAIwE,IAC9BiH,GAAIyE,KAAK6R,EAAKmqC,SAIf,yBAAA0S,EAAAhjE,OAAA,GAAA0jE,EAAA,UACF,kBAAAuJ,EAAArpE,MAAA,KAAAD,UAAA,KAAAhL,IAAA,sBAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KACZw9D,EAAW19D,KAAM6gB,KAAKtE,UAAUxnC,KAAKsnC,MACrC2yH,EAAe,SAAC/uE,GAChBA,GACFr2E,GAAI2E,KAAK2R,EAAK+uI,kBACdrlJ,GAAIyE,KAAK6R,EAAKgvI,iBAEdtlJ,GAAIyE,KAAK6R,EAAK+uI,kBACdrlJ,GAAI2E,KAAK2R,EAAKgvI,eAElB,EACA,GAAIxxE,EACF,OAAQA,EAAS8gC,kBACf,KAAK5+F,GAAiB6+F,UACpBuwC,GAAa,GACb9uI,EAAKs+F,iBAAiBpqG,YAAc9C,G3BhUlB,a2BiUlB,MACF,KAAKsO,GAAiBuvI,aACpBH,GAAa,GACTj6J,KAAK43J,gBAAiBzsI,EAAKs+F,iBAAiBpqG,YAAc9C,G3BrOjC,wB2BsOxB4O,EAAKs+F,iBAAiBpqG,YAAc9C,GAAUA,GACnD,MACF,KAAKsO,GAAiBwvI,YACpBJ,GAAa,GACb9uI,EAAKs+F,iBAAiBpqG,YAAc,GAAHtT,OAAMwQ,GAAUA,GAAqB,OAAAxQ,OAAMwQ,G3BvUhD,wB2B0UpC,GAAC,CAAA5e,IAAA,mBAAAE,OAAAg5J,EAAApuJ,EAAAzL,IAAAA,MAED,SAAA6rE,IAAA,IAAAvqB,EAAA,OAAAthD,IAAAA,MAAA,SAAA2rE,GAAA,cAAAA,EAAA9jE,KAAA8jE,EAAArmE,MAAA,OACQg8C,EAASrzB,KAAMuzB,QAAQx+C,KAAKmrB,KAAKguI,mBAAkBxwF,EAAA9jE,KAAA,EAEvD7E,KAAKo5J,kBAAkB,CAAEvwH,WAAY,IACrCyV,IAAQqqB,EAAArmE,KAAA,gBAEA,MAFAqmE,EAAA9jE,KAAA,EAAA8jE,EAAAj7D,GAAAi7D,EAAA,SAERrqB,IAAQqqB,EAAAj7D,GAAA,yBAAAi7D,EAAA3jE,OAAA,GAAA6jE,EAAA,kBAGX,kBAAAguF,EAAAjuJ,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,oBAAAE,OAAA+4J,EAAAnuJ,EAAAzL,IAAAA,MAIA,SAAA4sE,EAAyB0wF,GAAqB,IAAAC,EAAA1xH,EAAA,OAAA7rC,IAAAA,MAAA,SAAAisE,GAAA,cAAAA,EAAApkE,KAAAokE,EAAA3mE,MAAA,OACvB,OAArBg4J,EAAKhzH,KAAOtnC,KAAKsnC,KAAI2hC,EAAA3mE,KAAA,EACfuL,EAAS,yBAA0BysJ,GAAK,OACxCzxH,EAA4B,QAAlB0xH,EAAGD,EAAKzxH,kBAAU,IAAA0xH,EAAAA,EAAItvI,KAAMuc,UAAUxnC,KAAKsnC,MAAMG,KAAKoB,WACtE7oC,KAAKs3J,YAAY5wI,SAASmiB,EAAa,GAAE,wBAAAogC,EAAAjkE,OAAA,GAAA4kE,EAAA,UAC1C,SAAAquB,GAAA,OAAA2+D,EAAAhuJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,mBAAAE,OAAAu4E,EAAA3tE,EAAAzL,IAAAA,MAED,SAAA6uE,EAAwB9tD,EAAiBm9C,GAAY,IAAApvB,EAAA3gB,EAAAlM,EAAAmG,EAAA61C,EAAAkd,EAAAd,EAAA,OAAAr6E,IAAAA,MAAA,SAAA6sE,GAAA,cAAAA,EAAAhlE,KAAAglE,EAAAvnE,MAAA,OACxB,OAA3BtC,KAAKo3E,aAAajM,UAAStB,EAAAvnE,KAAA,EACR2oB,KAAMqhD,YAAW,OAA1B,GAAJxgC,EAAI+9B,EAAA/nE,KACC,CAAF+nE,EAAAvnE,KAAA,eAAAunE,EAAA5nE,OAAA,iBAKyC,OAJ5CkpB,EAAOnrB,KAAKmrB,KACZlM,EAAQ6sB,EAAKzK,OAAOtjB,GACpBqH,EAASnG,EAAMmG,OACf61C,EAAKhwC,KAAMuc,UAAUxnC,KAAKsnC,MAC1B6wC,EAAUld,EAAGK,WAAWr8C,EAAMN,QAAQ0D,OAAMwnD,EAAAvnE,KAAA,GAErBtC,KAAKu3E,kBAAkBx5D,EAASoN,EAAK4rD,eAAc,QACvB,GADnDM,EAAcxN,EAAA/nE,KACpB9B,KAAKi3E,oBAAoBg8B,QAAQl1F,EAASs5D,KAEtCjyD,EAAOI,QAAUJ,EAAOozB,QAAQxI,WAAa,EAAImoC,EAAUd,GAAc,CAAAxN,EAAAvnE,KAAA,SACvB,OAApDtC,KAAKu5J,uCAAuCx7I,GAAQ8rD,EAAA5nE,OAAA,kBAIM,OAA5DjC,KAAK03E,eAAeC,UAAU55D,EAASs5D,EAAgBnc,GAAK2O,EAAAvnE,KAAA,GACtDtC,KAAKqkF,SAASl5D,EAAKysD,YAAW,yBAAA/N,EAAA7kE,OAAA,GAAA6mE,EAAA,UACrC,SAAA8sB,EAAAC,GAAA,OAAAxiB,EAAAxtE,MAAA,KAAAD,UAAA,MAAAguJ,CAAA,CApciC,CAAS/rI,ICpBD,IAOvB4vI,GAAuB,SAAArkF,GAAA/rE,EAAAowJ,EAAArkF,GAAA,IAYzCo4D,MAZyC7mH,KAAA8yI,iZAM1C,SAAAA,EAAajiD,GAAmB,IAAAp/F,EAAAtQ,EAAA,KAAA2xJ,GACvB1wJ,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,eACP,IAAMgS,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAck7D,GAG/B,OAFZ1jG,GAAIuyB,eAAejc,EAAKsvI,iBACxB5lJ,GAAI1K,KAAKghB,EAAKuvI,WAAY,SAAS,WAAQzvI,KAAM2yB,SAAS,KAAM,IAChEzkC,EAAKw2H,QAAOx2H,CACd,CA6BC,OA7BAxP,EAAA6wJ,EAAA,EAAA78J,IAAA,QAAAE,OAAA0wI,EAAA9lI,EAAAzL,IAAAA,MAED,SAAA8P,IAAA,IAAA1D,EAAAuxJ,EAAA1nG,EAAAzvD,EAAA0iB,EAAA,YAAAlpB,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,cAAA6L,EAAA7L,KAAA,EACoB8L,EAAQ,uBAAsB,OAAvC,GAAHhF,EAAG+E,EAAArM,KACJmpB,KAAM6mC,cAAc1oD,GAAM,CAAF+E,EAAA7L,KAAA,QAE3B,OADAqY,QAAQvZ,MAAM,iCAAkCgI,GAChD+E,EAAAlM,OAAA,iBAII04J,EAA2BvxJ,EAAIuxJ,KAAI1nG,EAAAj2D,IAAAA,MAAA,SAAAi2D,IAAA,IAAA2nG,EAAAltH,EAAAmtH,EAAA5pI,EAAAC,EAAAoW,EAAAggB,EAAAnnC,EAAA,OAAAnjB,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAAAs4J,EAGkBD,EAAKn3J,GAAtDkqC,EAASktH,EAATltH,UAASmtH,EAAAD,EAAE75H,OAAU9P,EAAM4pI,EAAN5pI,OAAQC,EAAO2pI,EAAP3pI,QAASoW,EAAIuzH,EAAJvzH,KACxCggB,EAAMphC,EAAKiF,KAAKsvI,gBAAgBhvI,WAAU,IAC1CtL,EAAOtL,GAAI6W,cAAc47B,IAC1B5Z,UAAUruB,YAAc,IAAIzU,KAAiB,IAAZ8iC,GAAkBzK,iBACxDkN,GAAkBmX,EAAKr2B,EAAQC,EAASoW,GAExCzyB,GAAI1K,KAAKgW,EAAK26I,KAAM,SAAS,WAC3B7vI,KAAM2yB,SAAS,SAAU,CAAE3sB,OAAAA,EAAQC,QAAAA,EAASoW,KAAAA,EAAMoG,UAAAA,EAAWmQ,WAAY,cAC3E,IAEAhpC,GAAI1K,KAAKgW,EAAK46I,SAAU,SAAS,WAC/B9vI,KAAM2yB,SAAS,aAAc,CAAEtW,KAAAA,EAAMrW,OAAAA,EAAQC,QAAAA,GAC/C,IAEAhL,EAAKiF,KAAK6vI,aAAa1iJ,YAAYgvC,GAAI,wBAAAp6C,EAAAlI,OAAA,GAAAiuD,EAAA,IAfhCzvD,EAAI,EAAC,YAAEA,EAAIm3J,EAAKp3J,QAAM,CAAA4K,EAAA7L,KAAA,gBAAA6L,EAAAtI,cAAAotD,IAAA,iBAAEzvD,IAAG2K,EAAA7L,KAAA,iCAAA6L,EAAAnJ,OAAA,GAAA8H,EAAA,KAiBrC,kBAAAyhI,EAAA3lI,MAAA,KAAAD,UAAA,MAAA6xJ,CAAA,CAzCyC,CAAS5vI,8uCCkBrD,IAAIihB,GAAM,EA2BWovH,GAAmB,SAAA9kF,GAAA/rE,EAAA6wJ,EAAA9kF,GAAA,IAyHrCo4D,EAlCA2sB,EAhBAC,EAdAl3B,MAzDqCv8G,KAAAuzI,iZAmBtC,SAAAA,EAAa1iD,EAAmB6iD,GAAwB,IAAAC,EAAAliJ,EAAAtQ,EAAA,KAAAoyJ,GAC/CnxJ,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,cAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,oBAAArP,EAAAC,EAAAoP,GAAA,kBAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,iBAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,iCAAArP,EAAAC,EAAAoP,GAAA,iCAAArP,EAAAC,EAAAoP,GAAA,gCAAArP,EAAAC,EAAAoP,GAAA,mCAAArP,EAAAC,EAAAoP,GAAA,kBAAArP,EAAAC,EAAAoP,GAAA,kBAAArP,EAAAC,EAAAoP,GAAA,gBAAArP,EAAAC,EAAAoP,GAAA,wBAAArP,EAAAC,EAAAoP,GAAA,oBACP,IAAMgS,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAck7D,GAK3C,GAJA1sE,GAAM5gB,KAAM6gB,KAAKD,IACjBh3B,GAAIuyB,eAAejc,EAAKmwI,kBAAmBnwI,EAAKowI,kBAAmBpwI,EAAKqwI,yBACxE3mJ,GAAI1K,KAAKgP,EAAKgS,KAAKuvI,WAAY,SAAS,WAAM,IAAAe,EAAExwI,KAAM2yB,SAA0B,QAAlB69G,EAACL,EAAOv9G,kBAAU,IAAA49G,EAAAA,EAAI,KAAM,IAC1F5mJ,GAAI1K,KAAKgP,EAAKgS,KAAKuwI,aAAc,SAAS,WAAQviJ,EAAKwiJ,cAAe,IAC5D,QAAVN,EAAID,SAAM,IAAAC,GAANA,EAAQ/zH,KAAM,CAChB,IAAM60B,EAAM,IAAI+tC,IAAIh+F,OAAOi+F,SAASh+D,MACpCgwB,EAAIy/F,aAAax0I,IAAI,OAAQg0I,EAAO9zH,MACpC60B,EAAIy/F,aAAax0I,IAAI,SAAU9d,OAAO8xJ,EAAOnqI,SAC7CkrC,EAAIy/F,aAAax0I,IAAI,UAAW9d,OAAO8xJ,EAAOlqI,UAC9CirC,EAAIy/F,aAAax0I,IAAI,YAAa9d,OAAO8xJ,EAAO1tH,YAChDxhC,OAAOklF,QAAQyqE,8WAAYluG,CAAC,CAAExiC,KAAM,cAAiBiwI,GAAU,GAAIj/F,EACrE,KAAO,CACL,IAAM2/F,EAAY,IAAI7xD,gBAAgB/9F,OAAOi+F,SAASJ,QACjDqxD,IAAQA,EAAS,CAAC,GACvBA,EAAO9zH,KAAOw0H,EAAUh1J,IAAI,SAAW,GACvCs0J,EAAOnqI,OAASpe,SAASipJ,EAAUh1J,IAAI,WAAa,KACpDs0J,EAAOlqI,QAAUre,SAASipJ,EAAUh1J,IAAI,YAAc,KACtDs0J,EAAO1tH,UAAY76B,SAASipJ,EAAUh1J,IAAI,cAAgB,IAC5D,CACA,IAAAi1J,EAA6CX,EAArCnqI,EAAM8qI,EAAN9qI,OAAQC,EAAO6qI,EAAP7qI,QAASoW,EAAIy0H,EAAJz0H,KAAMoG,EAASquH,EAATruH,UAeE,OAdjCv0B,EAAKu0B,UAAYA,EACjBv0B,EAAK8jC,MAAQ,IAAI2R,GAAMzjC,EAAK8xB,OAC5B9jC,EAAK6iJ,OAAS,CAAC,EACf7iJ,EAAK8iJ,UAAY,CAAC,EAClB9iJ,EAAK6vB,IAAM,CAAE/X,OAAQA,EAAQC,QAASA,EAASoW,KAAAA,GAC/C6I,GAAkBooE,EAAMtnF,EAAQC,EAASoW,GACzCzyB,GAAI1K,KAAKouG,EAAM,UAAU,WACnBp/F,EAAKqlC,SACLrlC,EAAK+iJ,eACW/wI,EAAKgxI,YAAYvlJ,aAAe2hG,EAAK3hG,aAAe2hG,EAAKhiG,UAC3D,GAChB4C,EAAKmsH,UAET,IACAnsH,EAAKw2H,MAAMroG,EAAMrW,EAAQC,GAAQ/X,CACnC,CA6YC,OA7YAxP,EAAAsxJ,EAAA,EAAAt9J,IAAA,WAAAE,OAAAomI,EAAAx7H,EAAAzL,IAAAA,MAED,SAAA8P,IAAA,IAAAsvJ,EAAAC,EAAAL,EAAAM,EAAAC,EAAAl7H,EAAAj2B,EAAAD,EAAAqxJ,EAAAl1G,EAAA,OAAAtqD,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OACqB,OAAnBtC,KAAKw+C,SAAU,EAAItxC,EAAA5K,KAAA,EAC2BtC,KAAKy8J,aAAY,OAAAL,EAAAlvJ,EAAApL,KAAAu6J,EAAAz0J,EAAAw0J,EAAA,GAAxDJ,EAAMK,EAAA,GAAEC,EAAWD,EAAA,GAAEE,EAAQF,EAAA,GAC9Bh7H,EAASrhC,KAAK08J,YAAWtxJ,EAAAC,GACX2wJ,GAAM9uJ,EAAArI,KAAA,GAAAuG,EAAAG,IAAA,YAAAJ,EAAAC,EAAA5E,KAAA9E,KAAE,CAAFwL,EAAA5K,KAAA,SAAV,GAALk6J,EAAKrxJ,EAAAtN,OACVmC,KAAKg8J,OAAOQ,EAAMvnJ,IAAK,CAAF/H,EAAA5K,KAAA,gBAAA4K,EAAAjL,OAAA,uBACnBqlD,EAAMtnD,KAAK28J,YAAYH,GAAO,EAAOn7H,GAC3CrhC,KAAKg8J,OAAOQ,EAAMvnJ,IAAM,CAACunJ,EAAOl1G,GAAI,QAAAp6C,EAAA5K,KAAA,iBAAA4K,EAAA5K,KAAA,iBAAA4K,EAAArI,KAAA,GAAAqI,EAAAQ,GAAAR,EAAA,UAAA9B,EAAAQ,EAAAsB,EAAAQ,IAAA,eAAAR,EAAArI,KAAA,GAAAuG,EAAAS,IAAAqB,EAAAvH,OAAA,YAEtC3F,KAAK48J,cAAcL,EAAS/5G,WAAY+5G,EAASM,SACjD78J,KAAK88J,mBAAmBR,GACxBt8J,KAAKw+C,SAAU,EAAK,yBAAAtxC,EAAAlI,OAAA,GAAA8H,EAAA,0BACrB,kBAAAm3H,EAAAr7H,MAAA,KAAAD,UAAA,KAAAhL,IAAA,aAAAE,OAAAs9J,EAAA1yJ,EAAAzL,IAAAA,MAED,SAAAiR,IAAA,IAAA+6B,EAAA0E,EAAAkP,EAAAxzC,EAAA,OAAApM,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAEyG,OAD/F0mC,EAAmBhpC,KAAnBgpC,IAAK0E,EAAc1tC,KAAd0tC,UACPkP,EAAW,CAAE7b,OAAQiI,EAAK0E,UAAAA,EAAWlnC,EApGzB,GAoG2Cu2J,QAAS/8J,KAAK+8J,QAASC,MAAOh9J,KAAKg9J,OAAO7uJ,EAAA7L,KAAA,EACrFuL,EAAS,iBAAkB+uC,GAAI,OAShD,OATKxzC,EAAG+E,EAAArM,KACJmpB,KAAM6mC,cAAc1oD,IACvBuR,QAAQvZ,MAAM,yBAA0BgI,GAEtCA,EAAI0xJ,KAAKv3J,QAAU,IACrBvD,KAAKk8J,eAAgB,GAEnB9yJ,EAAI0xJ,KAAKv3J,OAAS,IACpBvD,KAAKg9J,MAAQ5zJ,EAAI0xJ,KAAK1xJ,EAAI0xJ,KAAKv3J,OAAS,GAAG0R,IAC5C9G,EAAAlM,OAAA,SACM,CAACmH,EAAI0xJ,KAAM1xJ,EAAIkzJ,aAAe,GAAIlzJ,EAAImzJ,WAAS,wBAAApuJ,EAAAnJ,OAAA,GAAAiJ,EAAA,UACvD,kBAAAktJ,EAAAvyJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,eAAAE,OAAAq9J,EAAAzyJ,EAAAzL,IAAAA,MAED,SAAAuR,IAAA,IAAA4c,EAAA8xI,EAAAC,EAAAlB,EAAAO,EAAA,OAAAv/J,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OAUwB,OAThB6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAK+8J,QAAU,CACbI,WAAYhyI,EAAKiyI,iBAAiBzkG,QAClC0kG,UAAWlyI,EAAKmyI,gBAAgB3kG,QAChC4kG,WAAYpyI,EAAKqyI,iBAAiB7kG,QAClC8kG,UAAWtyI,EAAKuyI,gBAAgB/kG,QAChCglG,WAAYxyI,EAAKyyI,iBAAiBjlG,QAClCklG,cAAe1yI,EAAK2yI,oBAAoBnlG,SAE1C34D,KAAKg9J,WAAQv7J,EAAS+M,EAAAlM,KAAA,EACatC,KAAKy8J,aAAY,OAAAQ,EAAAzuJ,EAAA1M,KAAAo7J,EAAAt1J,EAAAq1J,EAAA,GAA7CjB,EAAMkB,EAAA,GAAIX,EAAQW,EAAA,GACzBl9J,KAAK+9J,cAAc/B,GACnBh8J,KAAK48J,cAAcL,EAAS/5G,WAAY+5G,EAASM,SAAQ,yBAAAruJ,EAAAxJ,OAAA,GAAAuJ,EAAA,UAC1D,kBAAA2sJ,EAAAtyJ,MAAA,KAAAD,UAAA,KAAAhL,IAAA,aAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBA,EAAKiyI,iBAAiBzkG,SAAU,EAChCxtC,EAAKmyI,gBAAgB3kG,SAAU,EAC/BxtC,EAAKqyI,iBAAiB7kG,SAAU,EAChCxtC,EAAKuyI,gBAAgB/kG,SAAU,EAC/BxtC,EAAKyyI,iBAAiBjlG,SAAU,EAChCxtC,EAAK2yI,oBAAoBnlG,SAAU,EACnC34D,KAAK+8J,QAAU,CACbI,UAAU,EACVE,SAAS,EACTE,UAAU,EACVE,SAAS,EACTE,UAAU,EACVE,aAAa,EAEjB,GAAC,CAAAlgK,IAAA,QAAAE,OAAA0wI,EAAA9lI,EAAAzL,IAAAA,MAED,SAAA2mB,EAAa2jB,EAAcrW,EAAgBC,GAAe,IAAA8sI,EAAA7yI,EAAAuiB,EAAA8U,EAAAq6G,EAAA/uH,EAAAmwH,EAAAC,EAAAlC,EAAAO,EAAAl7H,EAAA88H,EAAA7oJ,EAAAD,EAAA4J,EAAAogG,EAAAn5F,EAAA,YAAAlpB,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAMF,OALhD6oB,EAAOnrB,KAAKmrB,KAClBnrB,KAAKo+J,aACG1wH,EAAc1tC,KAAd0tC,UAEJmvH,EAAU,EACR/uH,EAAYwG,GAAchN,EAAMrW,EAAQC,GAAQtN,EAAAthB,KAAA,EACnBtC,KAAKy8J,aAAY,OAAAwB,EAAAr6I,EAAA9hB,KAAAo8J,EAAAt2J,EAAAq2J,EAAA,GAA7CjC,EAAMkC,EAAA,GAAI3B,EAAQ2B,EAAA,IACrBpwH,SAAmB,QAAVkwH,EAATlwH,EAAWC,gBAAQ,IAAAiwH,OAAV,EAATA,EAAqBtwH,aAAcA,GACrC1tC,KAAKq+J,SAAU,EACfr+J,KAAK2rG,UAAY1gF,KAAMymB,aACvB8Q,EAAa1U,EAAUC,SAASyU,aAEhCxiD,KAAK2rG,UAAY4wD,EAAS+B,WAAW3yD,UACrCnpD,EAAa+5G,EAAS/5G,WACtBq6G,EAAUN,EAASM,SAErB78J,KAAK48J,cAAcp6G,EAAYq6G,GACzBx7H,EAASrhC,KAAK08J,YACdyB,EAAehzI,EAAKozI,aAAah8I,cAAajN,EAAAjK,GAChCg2B,GAAM,IAA1B,IAAA/rB,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAWud,EAAK5J,EAAAxX,OACRwhH,EAAKp0G,SAAS4P,cAAc,OAC/BwE,YAAc,GAAHtT,OAAMkT,EAAMN,OAAOW,cAAa,UAC1C6+I,GACFA,EAAan7D,aAAaqc,EAAIl0F,EAAKozI,aAEtC,OAAA7/J,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACD7L,KAAK+9J,cAAc/B,GAEnB/wI,KAAMilC,mBAAmB,CACvBkzD,SAAU,SAAChzD,GAAyBlqC,EAAKs4I,mBAAmBpuG,EAAM,EAClE0yD,SAAU,SAAC1yD,GAAyBlqC,EAAK+pH,mBAAmB7/E,EAAM,IAClE,yBAAAxsC,EAAA5e,OAAA,GAAA2e,EAAA,UACH,SAAA3b,EAAA2E,EAAAC,GAAA,OAAA2hI,EAAA3lI,MAAA,KAAAD,UAAA,KAAAhL,IAAA,qBAAAE,MAED,SAAoBuyD,GAClB,IAAA/R,EAAkCr+C,KAAKgpC,IAA/B/X,EAAMotB,EAANptB,OAAQC,EAAOmtB,EAAPntB,QAASoW,EAAI+W,EAAJ/W,KACzB,GAAI8oB,EAAK9oB,OAASA,GAAQ8oB,EAAKn/B,SAAWA,GAAUm/B,EAAKl/B,UAAYA,IA9K7CtlB,EA+KDwkD,EAAKosG,MA/KkBO,EA+KX/8J,KAAK+8J,QA9KtCnxJ,EAAE6yJ,cACA7yJ,EAAE6yJ,cAAchvI,KAAastI,EAAQI,SAClCJ,EAAQM,QAEbzxJ,EAAE8yJ,cACA9yJ,EAAE8yJ,cAAcjvI,KAAastI,EAAQQ,SAClCR,EAAQU,QAEb7xJ,EAAE+yJ,aAAqB5B,EAAQY,SAC/B/xJ,EAAEgzJ,iBAAwB7B,EAAQc,aAqKpC,CA/KJ,IAA4BjyJ,EAAsBmxJ,EAgLxCP,EAAQpsG,EAAKosG,MACbqC,EAAc7+J,KAAKg8J,OAAOQ,EAAMvnJ,IACtC,GAAI4pJ,EAGF,OAFA7+J,KAAK8+J,eAAeD,EAAY,GAAIrC,EAAOx8J,KAAK08J,kBAChDmC,EAAY,GAAKrC,GAGnB,IAAMl1G,EAAMtnD,KAAK28J,YAAYH,GAAO,EAAMx8J,KAAK08J,aAC/C18J,KAAKg8J,OAAOQ,EAAMvnJ,IAAM,CAACunJ,EAAOl1G,EATwB,CAU1D,GAAC,CAAA3pD,IAAA,qBAAAE,MAED,SAAoBuyD,GAClB,IAAA5Q,EAAsDx/C,KAA9CgpC,IAAO/X,EAAMuuB,EAANvuB,OAAQC,EAAOsuB,EAAPtuB,QAASoW,EAAIkY,EAAJlY,KAAQoG,EAAc1tC,KAAd0tC,UACpC0iB,EAAK9oB,OAASA,GAChB8oB,EAAKn/B,SAAWA,GAChBm/B,EAAKl/B,UAAYA,GACdk/B,EAAKnO,OAASmO,EAAKnO,MAAMvU,YAAcA,GAC5C1tC,KAAK48J,cAAcxsG,EAAKnO,MAAMO,WAAY,EAC5C,GAAC,CAAA7kD,IAAA,gBAAAE,MAED,SAAekhK,EAAgBlC,GAC7B,IAAM1xI,EAAOnrB,KAAKmrB,KAOlB,IAAK,IAAMpN,KANXoN,EAAKuiB,UAAUruB,YAAc,IAAIzU,KAAsB,IAAjB5K,KAAK0tC,WAAkBzK,iBAC7C,IAAZ45H,EACFhoJ,GAAI2E,KAAK2R,EAAK6zI,YAEd7zI,EAAK0xI,QAAQx9I,YAAc,IAAIzU,KAAe,IAAViyJ,GAAgB55H,iBAEhC87H,EAAGE,MAAO,CAC9B,IAAMhgJ,EAAQgM,KAAMoW,OAAOxuB,SAASkL,IAChCupC,EAAMtnD,KAAKi8J,UAAUl+I,GACzB,IAAKupC,EAAK,CACRA,EAAMn8B,EAAKqwI,wBAAwB/vI,WAAU,GAC7C,IAAMtL,EAAOtL,GAAI6W,cAAc47B,GAC/BnnC,EAAK2sB,KAAKrtB,IAAM5K,GAAImK,SAASC,EAAMN,QACnCwB,EAAKhB,OAAOE,YAAcJ,EAAMN,OAAOW,cACvCtf,KAAKi8J,UAAUl+I,GAAWupC,EAC1Bn8B,EAAK+zI,qBAAqB5mJ,YAAYgvC,EACxC,CACA,IAAM7lB,EAAOs9H,EAAGE,MAAMlhJ,GAChBoC,EAAOtL,GAAI6W,cAAc47B,GAC/BnnC,EAAKshB,KAAKpiB,YAAcoiB,EAAKltB,IAC7B4L,EAAKg/I,QAAQ9/I,YAAcoiB,EAAK29H,OAChCj/I,EAAK++C,SAAS7/C,YAAc,GAAHtT,OAAM8I,GAAIwqJ,gBAAgBr/J,KAAK2rG,UAAU1sF,EAAMhK,KAAI,OAC9E,CACAkW,EAAKq3B,WAAWnjC,YAAc,GAAHtT,OAAM8I,GAAIwqJ,gBAAgBN,EAAG3sH,QAAO,OACjE,GAAC,CAAAz0C,IAAA,YAAAE,MAED,WAAgC,IAAA2qD,EACxBo/D,EAAY38F,KAAMoW,OAAOrhC,KAAKgpC,IAAI/X,QAClC82F,EAAa98F,KAAMoW,OAAOrhC,KAAKgpC,IAAI9X,SAEnCmQ,EAAS,CAACumF,EAAWG,GACrB5/D,GAAQr+C,EAAA0+C,EAAG,CAAC,EAAEo/D,EAAU3yG,IAAK,GAAInL,EAAA0+C,EAAGu/D,EAAW9yG,IAAK,GAAIuzC,GAE9D,GAAIo/D,EAAU57E,QAAUmc,EAASy/D,EAAU57E,MAAMC,UAAW,CAC1D,IAAMs8E,EAAiBt9F,KAAMoW,OAAOumF,EAAU57E,MAAMC,UACpDkc,EAASogE,EAAetzG,KAAM,EAC9BosB,EAAOr+B,KAAKulH,EACd,CAEA,GAAIR,EAAW/7E,QAAUmc,EAAS4/D,EAAW/7E,MAAMC,UAAW,CAC5D,IAAMw8E,EAAkBx9F,KAAMoW,OAAO0mF,EAAW/7E,MAAMC,UACtD5K,EAAOr+B,KAAKylH,EACd,CAEA,OAAOpnF,CACT,GAAC,CAAA1jC,IAAA,qBAAAE,MAED,SAAoBy+J,GAAkC,IACrBxhJ,EADqBC,EAAA1P,GAChCixJ,GAAW,IAA/B,IAAAvhJ,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAAiC,KAAtB86J,EAAK1hJ,EAAAjd,MACRghK,EAAc7+J,KAAKg8J,OAAOQ,EAAMvnJ,IACjC4pJ,IACL7+J,KAAK8+J,eAAeD,EAAY,GAAIrC,EAAOx8J,KAAK08J,aAChDmC,EAAY,GAAKrC,EACnB,CAAC,OAAA99J,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CACH,GAAC,CAAAlO,IAAA,gBAAAE,MAED,SAAem+J,GACb,IAAM7wI,EAAOnrB,KAAKmrB,KAClBtW,GAAImD,MAAMmT,EAAKm0I,iBACft/J,KAAKg8J,OAAS,CAAC,EACfh8J,KAAKk8J,eAAgB,EACrB,IAC0Bt8I,EADpByhB,EAASrhC,KAAK08J,YAAW78I,EAAAxU,GACX2wJ,GAAM,IAA1B,IAAAn8I,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAA4B,KAAjB86J,EAAK58I,EAAA/hB,MACRypD,EAAMtnD,KAAK28J,YAAYH,GAAO,EAAOn7H,GAC3CrhC,KAAKg8J,OAAOQ,EAAMvnJ,IAAM,CAACunJ,EAAOl1G,EAClC,CAAC,OAAA5oD,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CACH,GAAC,CAAAlO,IAAA,iBAAAE,MAED,SAAgBypD,EAAkBk1G,EAA0Bn7H,GAA0B,IAIhFpsB,EAJgF8R,EAAA,KAC9E5G,EAAOtL,GAAI6W,cAAc47B,GAC/BnnC,EAAK6lC,KAAK3mC,YAAe,IAAIzU,KAAuB,IAAlB4xJ,EAAM91E,WAAmBzjD,iBAC3D9iB,EAAKo/I,UAAUlgJ,YAAcrf,KAAKu/J,UAAU/C,GAExCA,EAAMmC,aACR1pJ,EAAKunJ,EAAMmC,aAAa3yD,YAAY/2F,GAC3BunJ,EAAMoC,gBACf3pJ,EAAKunJ,EAAMoC,gBAAgB3pJ,GAClBunJ,EAAMiC,cACfxpJ,EAAKunJ,EAAMiC,cAAcxpJ,GAChBunJ,EAAMkC,gBACfzpJ,EAAKunJ,EAAMkC,cAAczpJ,IAEvBA,IACFkL,EAAKq/I,QAAQngJ,YAAcmhF,GAAuBvrF,EAAI,IACtDkL,EAAKq/I,QAAQnpE,aAAa,QAASphF,IAErC,IAC0B6K,EADtB2/I,EAAM,EAAC1/I,EAAA1U,GACSg2B,GAAM,IAA1B,IAAAthB,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,MAA4B,KAAAsY,EAAjBiF,EAAKa,EAAAjiB,MACR6hK,EAAKlD,EAAMmD,eACXxkI,EAAMykI,GAAkB3gJ,EAAMhK,GAAIyqJ,GAClCG,EAAS,MAAH9zJ,OAASkT,EAAMN,OAAOW,eAC9BtK,OAAgB,EACpB,GAAImL,EAAK0/I,GACP7qJ,EAAKmL,EAAK0/I,OACL,EACL7qJ,EAAK/J,SAAS4P,cAAc,OACzB0D,QAAQ4B,KAAO0/I,EAClB,IAAM1oJ,EAASgJ,EAAK2/I,OAAOv9I,cACvBpL,GACFA,EAAO6rF,aAAahuF,EAAImL,EAAK2/I,OAEjC,CACA9qJ,EAAGqK,YAAcxK,GAAIkc,gBAAgBoK,EAAKlc,EAAMvK,UAEhD+qJ,GAA8C,QAA3CzlJ,EAAImhB,EADQlc,EAAMvK,SAASC,aAAaC,iBACrB5U,KAAK2rG,UAAU1sF,EAAMhK,WAAG,IAAA+E,EAAAA,EAAI,CACpD,CAAC,OAAAtb,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CACDsU,EAAK2/I,OAAOzgJ,YAAcxK,GAAIiJ,kBAAkB2hJ,GAChD5qJ,GAAI1K,KAAKgW,EAAKwyC,QAAS,SAAS,WAAQ5rC,EAAKg5I,iBAAiBvD,EAAMvnJ,GAAI,GAC1E,GAAC,CAAAtX,IAAA,cAAAE,MAED,SAAa2+J,EAA0BlkG,EAAkBj3B,GACvD,IAAMlW,EAAOnrB,KAAKmrB,KACZm8B,EAAMn8B,EAAKmwI,kBAAkB7vI,WAAU,GAQ7C,OAPA67B,EAAIryC,GAAKunJ,EAAMvnJ,GAAG1N,WAClBvH,KAAK8+J,eAAex3G,EAAKk1G,EAAOn7H,GAC5Bi3B,EACFntC,EAAKm0I,gBAAgBt8D,aAAa17C,EAAKn8B,EAAKm0I,gBAAgBznJ,YAE5DsT,EAAKm0I,gBAAgBhnJ,YAAYgvC,GAE5BA,CACT,GAAC,CAAA3pD,IAAA,YAAAE,MAED,SAAW2+J,GACT,OAAIA,EAAMmC,aACD,UACEnC,EAAMoC,gBACR,aACEpC,EAAMiC,cACRjC,EAAMiC,cAAchvI,KAAO,WAAa,UACtC+sI,EAAMkC,cACRlC,EAAMkC,cAAcjvI,KAAO,WAAa,UAG1C,EACT,GAAC,CAAA9xB,IAAA,2BAAAE,MAED,SAA0B2+J,GACxB,IAAQrxI,EAAmCnrB,KAAnCmrB,KAAIu1B,EAA+B1gD,KAA7BgpC,IAAO/X,EAAMyvB,EAANzvB,OAAQC,EAAOwvB,EAAPxvB,QACvB02F,EAAY38F,KAAMoW,OAAOpQ,GACzB82F,EAAa98F,KAAMoW,OAAOnQ,GAChCjX,EAAmB,CAAC2tG,EAAUlzG,SAAUqzG,EAAWrzG,UAA5C8G,EAAGvB,EAAA,GAAEwB,EAAGxB,EAAA,GACfyE,EAAkC,CAAClD,EAAI7G,aAAamI,KAAMrB,EAAI9G,aAAamI,MAApE+3B,EAAUn2B,EAAA,GAAE62B,EAAW72B,EAAA,QACMjd,IAAhCzB,KAAKggK,wBACP70I,EAAK80I,eAAezqJ,oBAAoB,QAASxV,KAAKggK,wBAExDhgK,KAAKggK,uBAAyB,WAAQv2I,GAAa+yI,EAAMvnJ,GAAIkW,EAAK+0I,WAAY/0I,EAAK80I,eAAgB,UAAW,EAC9G90I,EAAK80I,eAAe1qJ,iBAAiB,QAASvV,KAAKggK,wBACnD70I,EAAK+0I,WAAW7gJ,YAAcmhF,GAAuBg8D,EAAMvnJ,GAAI,IAC/DkW,EAAK+0I,WAAW7pE,aAAa,QAASmmE,EAAMvnJ,IAC5C,IAAMqH,EAAO2O,KAAM+F,iBAAiBC,EAAQC,EAASsrI,EAAMlgJ,MAE3D6O,EAAKg1I,aAAa9gJ,YAAc,GAAHtT,OAAMuQ,EAAI,KAAAvQ,OAAI8oC,EAAU,KAAA9oC,OAAIwpC,GACzDpqB,EAAKi1I,YAAY/gJ,YAAc,GAAHtT,OAAMywJ,EAAMjsI,IAAM/U,EAAI7G,aAAaC,iBAAgB,KAAA7I,OAAI8oC,GAC/E2nH,EAAM/sI,KACRtE,EAAKk1I,aAAahhJ,YAAc9C,GAAUA,GAE1C4O,EAAKk1I,aAAahhJ,YAAc9C,GAAUA,GAE5C1H,GAAImD,MAAMmT,EAAKm1I,sBACfzrJ,GAAIqf,OAAOsoI,EAAM+D,cAAgB/D,EAAM+D,aAAah9J,OAAS,EAAG4nB,EAAKq1I,kBAYrE,IAXA,IAAMC,EAAU,SAACxnF,EAAgBxpD,GAC/B,OAAQwpD,GACN,KhBnTkB,EgBoTlB,KhBlToB,EgBmTpB,KhBlTmB,EgBmTjB,OAAOxpD,EAAOm4F,EAAYG,EAC5B,KhBtToB,EgBuTlB,OAAOt4F,EAAOs4F,EAAaH,EAEjC,EAESpkH,EAAI,EAAGg5J,EAAM+D,cAAgB/8J,EAAIg5J,EAAM+D,aAAah9J,OAAQC,IAAK,CACxE,IAAMsyF,EAAK0mE,EAAM+D,aAAa/8J,GACxB8jD,EAAMn8B,EAAKowI,kBAAkB9vI,WAAU,GACvCtL,EAAOtL,GAAI6W,cAAc47B,GAC/BnnC,EAAKlL,GAAGoK,YAAcmhF,GAAuB1K,EAAG7gF,GAAI,IACpDkL,EAAKlL,GAAGohF,aAAa,QAASP,EAAG7gF,IACjCkL,EAAKzgB,KAAK2f,YAAcqhJ,GAAqB5qE,EAAGp2F,MAChD,IAAMuf,EAAQwhJ,EAAQ3qE,EAAGp2F,KAAM88J,EAAM/sI,MACrC,GAAKxQ,EAAL,CAIA,IAAM8sB,EAAgBrB,GAAczrB,EAAMhK,IACtC82B,GAAiBA,EAAcF,MACjC1rB,EAAKi6E,aAAajuD,KAAOJ,EAAcF,IAAKiqD,EAAG7gF,KAEjDkL,EAAK26B,IAAIz7B,YAAc,GAAHtT,OAAM8I,GAAIkc,gBAAgB+kE,EAAGzzE,OAAQpD,EAAMvK,UAAS,KAAA3I,OAAIkT,EAAMvK,SAASC,aAAamI,KAAK4S,eAC7GvP,EAAK85B,KAAK56B,YAAc,GAAHtT,OAAM8I,GAAIkc,gBAAgB+kE,EAAG77C,KAAMh7B,EAAMvK,UAAS,KAAA3I,OAAIkT,EAAMvK,SAASC,aAAamI,KAAK4S,eAC5GvE,EAAKm1I,qBAAqBhoJ,YAAYgvC,EAPtC,MAFE3sC,QAAQvZ,MAAM,wCAAyC00F,EAAGp2F,KAU9D,CACAM,KAAKi9C,MAAM3jC,KAAK6R,EAAKw1I,oBACvB,GAAC,CAAAhjK,IAAA,2BAAAE,MAED,SAA0B2+J,GACxB,IAAQrxI,EAAmCnrB,KAAnCmrB,KAAIw1B,EAA+B3gD,KAA7BgpC,IAAO/X,EAAM0vB,EAAN1vB,OAAQC,EAAOyvB,EAAPzvB,QACvB02F,EAAY38F,KAAMoW,OAAOpQ,GACzB82F,EAAa98F,KAAMoW,OAAOnQ,GAChC/K,EAAmB,CAACyhG,EAAUlzG,SAAUqzG,EAAWrzG,UAA5C8G,EAAG2K,EAAA,GAAE1K,EAAG0K,EAAA,GACfyc,EAAkC,CAACpnB,EAAI7G,aAAamI,KAAMrB,EAAI9G,aAAamI,MAApE+3B,EAAUjS,EAAA,GAAE2S,EAAW3S,EAAA,GAE9BzX,EAAKy1I,WAAWvhJ,YAAcmhF,GAAuBg8D,EAAMvnJ,GAAI,SAC3BxT,IAAhCzB,KAAK6gK,wBACP11I,EAAK21I,eAAetrJ,oBAAoB,QAASxV,KAAK6gK,wBAExD7gK,KAAK6gK,uBAAyB,WAAQp3I,GAAa+yI,EAAMvnJ,GAAIkW,EAAKy1I,WAAYz1I,EAAK21I,eAAgB,UAAW,EAC9G31I,EAAK21I,eAAevrJ,iBAAiB,QAASvV,KAAK6gK,wBACnD11I,EAAKy1I,WAAWvqE,aAAa,QAASmmE,EAAMvnJ,IAC5C,IAAMqH,EAAO2O,KAAM+F,iBAAiBC,EAAQC,EAASsrI,EAAMlgJ,MAC3D6O,EAAK41I,aAAa1hJ,YAAc,GAAHtT,OAAMuQ,EAAI,KAAAvQ,OAAI8oC,EAAU,KAAA9oC,OAAIwpC,GACzDpqB,EAAK61I,YAAY3hJ,YAAc,GAAHtT,OAAMywJ,EAAMjsI,IAAM/U,EAAI7G,aAAaC,iBAAgB,KAAA7I,OAAI8oC,GAC/E2nH,EAAM/sI,KACRtE,EAAK81I,aAAa5hJ,YAAc9C,GAAUA,GAE1C4O,EAAK81I,aAAa5hJ,YAAc9C,GAAUA,GAE5C4O,EAAK+1I,mBAAmB7hJ,YAAc,GAAHtT,OAAMywJ,EAAM2E,WAAa3lJ,EAAI7G,aAAaC,iBAAgB,KAAA7I,OAAI8oC,GACjG1pB,EAAKi2I,oBAAoB/hJ,YAAc,GAAHtT,OAAMywJ,EAAM6E,YAAc5lJ,EAAI9G,aAAaC,iBAAgB,KAAA7I,OAAIwpC,GACnGv1C,KAAKi9C,MAAM3jC,KAAK6R,EAAKm2I,oBACvB,GAAC,CAAA3jK,IAAA,0BAAAE,MAED,SAAyB2+J,EAAqB35G,GAC5C,IAAM13B,EAAOnrB,KAAKmrB,KAClBA,EAAKo2I,UAAUliJ,YAAcmhF,GAAuBg8D,EAAMxwD,YAAY/2F,GAAI,SACvCxT,IAA/BzB,KAAKwhK,uBACPr2I,EAAKs2I,cAAcjsJ,oBAAoB,QAASxV,KAAKwhK,uBAEvDxhK,KAAKwhK,sBAAwB,WAAQ/3I,GAAa+yI,EAAMxwD,YAAY/2F,GAAIkW,EAAKo2I,UAAWp2I,EAAKs2I,cAAe,UAAW,EACvHt2I,EAAKs2I,cAAclsJ,iBAAiB,QAASvV,KAAKwhK,uBAClDr2I,EAAKo2I,UAAUlrE,aAAa,QAASmmE,EAAMxwD,YAAY/2F,IACvD,IAAMP,EAAWuW,KAAMoW,OAAOm7H,EAAMz+I,SAASrJ,SACvCoI,EAAOpI,EAASC,aAAamI,KACnCqO,EAAKu2I,WAAWriJ,YAAc,GAAHtT,OAAM8I,GAAIkc,gBAAgByrI,EAAMxwD,YAAY3pF,OAAQ3N,GAAS,KAAA3I,OAAI+Q,GAC5FqO,EAAKw2I,YAAYtiJ,YAAc,GAAHtT,OAAM8I,GAAIkc,gBAAgByrI,EAAMxwD,YAAY/xD,KAAMvlC,GAAS,KAAA3I,OAAI+Q,GAC3FqO,EAAKy2I,cAAcviJ,YAAwB9C,GAAVsmC,EAAoBtmC,GAA6BA,IAClF1H,GAAIqf,QAAQ2uB,EAAS13B,EAAK02I,sBACrBh/G,IACH13B,EAAK22I,cAAcziJ,YAAc,GAAHtT,OAAM8I,GAAIkc,gBAAgByrI,EAAMuF,UAAWrtJ,GAAS,KAAA3I,OAAI+Q,IAExF9c,KAAKi9C,MAAM3jC,KAAK6R,EAAK62I,mBACvB,GAAC,CAAArkK,IAAA,6BAAAE,MAED,SAA4B2+J,EAAwB35G,GAClD,IAAM13B,EAAOnrB,KAAKmrB,KAClBA,EAAK82I,aAAa5iJ,YAAcmhF,GAAuBg8D,EAAMvnJ,GAAI,SAC3BxT,IAAlCzB,KAAKkiK,0BACP/2I,EAAKg3I,iBAAiB3sJ,oBAAoB,QAASxV,KAAKkiK,0BAE1DliK,KAAKkiK,yBAA2B,WAAQz4I,GAAa+yI,EAAMvnJ,GAAIkW,EAAK82I,aAAc92I,EAAKg3I,iBAAkB,UAAW,EACpHh3I,EAAKg3I,iBAAiB5sJ,iBAAiB,QAASvV,KAAKkiK,0BACrD/2I,EAAK82I,aAAa5rE,aAAa,QAASmmE,EAAMvnJ,IAC9C,IAAMP,EAAWuW,KAAMoW,OAAOm7H,EAAMz+I,SAASrJ,SACvCoI,EAAOpI,EAASC,aAAamI,KACnCqO,EAAKi3I,cAAc/iJ,YAAc,GAAHtT,OAAM8I,GAAIkc,gBAAgByrI,EAAM6F,SAAU3tJ,GAAS,KAAA3I,OAAI+Q,GACrFqO,EAAKm3I,iBAAiBjjJ,YAAwB9C,GAAVsmC,EAAoBtmC,GAA6BA,IACjFigJ,EAAMxwD,cACR7gF,EAAKo3I,eAAeljJ,YAAcmhF,GAAuBg8D,EAAMxwD,YAAY/2F,GAAI,IAC/EkW,EAAKo3I,eAAelsE,aAAa,QAASmmE,EAAMxwD,YAAY/2F,IAC5DkW,EAAKq3I,mBAAmBnjJ,YAAc,GAAHtT,OAAM8I,GAAIkc,gBAAgByrI,EAAMxwD,YAAY3pF,OAAQ3N,GAAS,KAAA3I,OAAI+Q,IAEtG9c,KAAKi9C,MAAM3jC,KAAK6R,EAAKs3I,sBACvB,GAAC,CAAA9kK,IAAA,mBAAAE,MAED,SAAkB2hK,GAChB,IAAOhD,EAAP50J,EAAgB5H,KAAKg8J,OAAOwD,GAAQ,GAAxB,GACRhD,EAAMiC,eAAez+J,KAAK0iK,yBAAyBlG,EAAMiC,eACzDjC,EAAMkC,eAAe1+J,KAAK2iK,yBAAyBnG,EAAMkC,eACzDlC,EAAMmC,cAAc3+J,KAAK4iK,wBAAwBpG,EAAMmC,aAAcnC,EAAM35G,SAC3E25G,EAAMoC,iBAAiB5+J,KAAK6iK,2BAA2BrG,EAAMoC,gBAAiBpC,EAAM35G,QAC1F,KAACo4G,CAAA,CAtcqC,CAASrwI,IAycjD,SAAS41E,GAAwByL,EAAaC,GAC5C,OAAID,EAAI1oG,QAAU2oG,EAAeD,EAC1B,GAAPlgG,OAAUkgG,EAAIptF,UAAU,EAAGqtF,EAAS,GAAE,OAAAngG,OAAMkgG,EAAIptF,UAAUotF,EAAI1oG,OAAS2oG,EAAS,GAClF,CAEA,SAAS0zD,GAAmB7hJ,EAAiB2hJ,GAC3C,IAAIvkI,EAAM,EAKV,OAJIukI,EAAGhvI,QAAQ3S,KAAUod,GAAOukI,EAAGhvI,QAAQ3S,IACvC2hJ,EAAG78G,QAAQ9kC,KAAUod,GAAOukI,EAAG78G,QAAQ9kC,IACvC2hJ,EAAG76I,OAAO9G,KAAUod,GAAOukI,EAAG76I,OAAO9G,IACrC2hJ,EAAG5vH,SAAS/xB,KAAUod,GAAOukI,EAAG5vH,SAAS/xB,IACtCod,CACT,4gCCxfA,OAmBqB2nI,GAAQ,SAAA3sF,GAAA/rE,EAAA04J,EAAA3sF,GAAA,IAe1B4sF,MAf0Br7I,KAAAo7I,iZAQ3B,SAAAA,EAAax1J,GAAmB,IAAA6L,EAAAtQ,EAAA,KAAAi6J,GACvBh5J,EAAAC,EAAPoP,EAAAuO,EAAA/nB,KAAA,OAAO,eAAAmK,EAAAC,EAAAoP,GAAA,eAAArP,EAAAC,EAAAoP,GAAA,mBAAArP,EAAAC,EAAAoP,GAAA,0BAAArP,EAAAC,EAAAoP,GAAA,yBAAArP,EAAAC,EAAAoP,GAAA,mBACPA,EAAK7L,KAAOA,EACZ,IAAM6d,EAAOhS,EAAKgS,KAAOtW,GAAIwoC,cAAc/vC,GAG6C,OAFxF6L,EAAK6pJ,SAAW,IAAIC,GAAY93I,EAAK+3I,WAAW,SAACz1F,EAAY6xB,EAAiByS,GAAwB54F,EAAKgqJ,UAAU11F,EAAI6xB,EAAOyS,EAAU,IAC1I54F,EAAKiqJ,gBAAkB,IAAIC,GAAgBl4I,EAAKi4I,iBAAiB,kBAAMjqJ,EAAKmqJ,iBAAiB,IAC7FnqJ,EAAKoqJ,eAAiB,IAAIC,GAAer4I,EAAKo4I,gBAAgB,kBAAMpqJ,EAAKsqJ,cAAc,IAACtqJ,CAC1F,CAiBC,OAjBAxP,EAAAm5J,EAAA,EAAAnlK,IAAA,YAAAE,OAAAklK,EAAAt6J,EAAAzL,IAAAA,MAED,SAAA8P,EAAiB2gE,EAAY6xB,EAAiByS,GAAiB,IAAA5mF,EAAA,OAAAnuB,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAEvC,OADtBtC,KAAK+xG,SAAWA,EACV5mF,EAAOnrB,KAAKmrB,KAAIje,EAAA5K,KAAA,EAChBtC,KAAKojK,gBAAgB7iH,OAAOktB,EAAI6xB,GAAM,OACxCyS,GAAU/xG,KAAKujK,eAAehjH,OAAOwxD,GACzCj9B,GAAU3pD,EAAK+3I,UAAW/3I,EAAKi4I,iBAAgB,wBAAAl2J,EAAAlI,OAAA,GAAA8H,EAAA,UAChD,SAAA9E,EAAA2E,EAAAC,GAAA,OAAAm2J,EAAAn6J,MAAA,KAAAD,UAAA,KAAAhL,IAAA,kBAAAE,MAED,WACOmC,KAAK+xG,SACLj9B,GAAU90E,KAAKmrB,KAAKi4I,gBAAiBpjK,KAAKmrB,KAAKo4I,gBADhCt4I,KAAM2yB,SAAS,UAErC,GAAC,CAAAjgD,IAAA,eAAAE,MAED,WACEotB,KAAM2yB,SAAS,UACjB,KAACklH,CAAA,CAhC0B,CAASl4I,IAuChCq4I,GAAW,WAKf,SAAAA,EAAar8G,EAAmB0I,GAAmE,IAAAppC,EAAA,KAAArd,EAAA,KAAAo6J,GAAAn5J,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,uBACjG9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EACf,IAAMnkC,EAAOnrB,KAAKmrB,KAAOtW,GAAIwoC,cAAcuJ,GAC3C45B,GAAS55B,EAAMz7B,EAAKu4I,aAAa,kBAAMx9I,EAAKy9I,YAAY,IACxDnjF,GAAS55B,EAAMz7B,EAAKy4I,iBAAiB,WAC/B/uJ,GAAI0wE,SAASp6D,EAAK04I,eACpB14I,EAAK24I,oBAAoBnrJ,UAAUM,OAAO,YAC1CkS,EAAK24I,oBAAoBnrJ,UAAUC,IAAI,aACvC/D,GAAIyE,KAAK6R,EAAK04I,gBAEd14I,EAAK24I,oBAAoBnrJ,UAAUM,OAAO,aAC1CkS,EAAK24I,oBAAoBnrJ,UAAUC,IAAI,YACvC/D,GAAI2E,KAAK2R,EAAK04I,cAElB,GACF,CAEA,IAAAE,EAiCC,OAjCDp6J,EAAAs5J,EAAA,EAAAtlK,IAAA,aAAAE,OAAAkmK,EAAAt7J,EAAAzL,IAAAA,MACA,SAAAiR,IAAA,IAAA+1J,EAAA74I,EAAAsiD,EAAAw2F,EAAA3lH,EAAAkzB,EAAApoE,EAAA,OAAApM,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,OAIuC,GAH/B6oB,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAK+4I,aACRz2F,EAAKtiD,EAAK6oF,MAAMn2G,OAAS,GACzBomK,EAAU94I,EAAKg5I,WAAWtmK,MACrB,KAAP4vE,EAAS,CAAAt/D,EAAA7L,KAAA,QAEe,OAD1B6oB,EAAK+4I,YAAY7kJ,YAAc9C,GAAUA,GACzC1H,GAAIyE,KAAK6R,EAAK+4I,aAAY/1J,EAAAlM,OAAA,oBAGxBwrE,IAAOw2F,EAAO,CAAA91J,EAAA7L,KAAA,SAEU,OAD1B6oB,EAAK+4I,YAAY7kJ,YAAc9C,GAAUA,GACzC1H,GAAIyE,KAAK6R,EAAK+4I,aAAY/1J,EAAAlM,OAAA,kBAQW,OAJvCkpB,EAAK6oF,MAAMn2G,MAAQ,GACnBstB,EAAKg5I,WAAWtmK,MAAQ,GAClBygD,EAASrzB,KAAMuzB,QAAQx+C,KAAK4mD,MAE5B4qB,EAA2B,QAAvBwyF,EAAG74I,EAAKsmD,UAAU5zE,aAAK,IAAAmmK,EAAAA,EAAI,GAAE71J,EAAA7L,KAAA,GACPuL,EAAS,YAAa,CACpDwjD,KAAMoc,EACN+D,KAAMA,IACN,QACM,GAJFpoE,EAAiB+E,EAAArM,KAIvBw8C,IACKrzB,KAAM6mC,cAAc1oD,GAAM,CAAF+E,EAAA7L,KAAA,SAED,OAD1B6oB,EAAK+4I,YAAY7kJ,YAAcjW,EAAIwE,IACnCiH,GAAIyE,KAAK6R,EAAK+4I,aAAY/1J,EAAAlM,OAAA,kBAG5BjC,KAAKsvD,QAAQme,EAAIrkE,EAAIk2F,MAAOl2F,EAAI2oG,UAAS,yBAAA5jG,EAAAnJ,OAAA,GAAAiJ,EAAA,UAC1C,kBAAA81J,EAAAn7J,MAAA,KAAAD,UAAA,MAAAs6J,CAAA,CAxDc,GAwEbmB,GAAe,EAMbf,GAAe,WAQnB,SAAAA,EAAaz8G,EAAmB0I,GAAqB,IAAAvoC,EAAA,KAAAle,EAAA,KAAAw6J,GAAAv5J,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,uBAAAA,EAAA,uBAAAA,EAAA,kBAAAA,EAAA,uBACnD9J,KAAK4mD,KAAOA,EACZ5mD,KAAKsvD,QAAUA,EACf,IAAMnkC,EAAOnrB,KAAKmrB,KAAOtW,GAAIwoC,cAAcuJ,GAC3C/xC,GAAIuyB,eAAejc,EAAKk5I,aAAcl5I,EAAKm5I,cAC3C9jF,GAAS55B,EAAMz7B,EAAKo5I,mBAAmB,WAAQx9I,EAAKipC,QAAS,IAC7DwwB,GAAS55B,EAAMz7B,EAAKq5I,UAAU,WAAQz9I,EAAKuoC,SAAU,GACvD,CA+CC,IAAAyB,EA/CAH,EA+GA,OA/GAjnD,EAAA05J,EAAA,EAAA1lK,IAAA,SAAAE,OAAA+yD,EAAAnoD,EAAAzL,IAAAA,MAED,SAAAuR,EAAck/D,EAAY6xB,GAAe,IAAAn0E,EAAA/f,EAAAD,EAAAm8B,EAAAm9H,EAAAC,EAAAC,EAAAvvI,EAAAvtB,EAAA8lC,EAAAhnC,EAAAmsD,EAAA8xG,EAAAtvJ,EAAAD,EAAAo+C,EAAAnM,EAAAnnC,EAAA0kJ,EAAA,OAAA7nK,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,OACvCtC,KAAKytE,GAAKA,EACJtiD,EAAOnrB,KAAKmrB,KAElBnrB,KAAK8kK,QAAU,GAAE15J,EAAAC,GACEi0F,GAAK,IAAxB,IAAAl0F,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAW4lC,EAAIn8B,EAAAtN,MACPypD,EAAMn8B,EAAKk5I,aAAa54I,WAAU,GACxCN,EAAK45I,aAAazsJ,YAAYgvC,GACxBnnC,EAAOtL,GAAI6W,cAAc47B,GAC/B88G,KACMS,EAAQ,SAAH94J,OAAYq4J,IACvB98G,EAAI+Q,QAAUwsG,EACd1kJ,EAAK8xF,SAASh9F,GAAK4vJ,EACnB1kJ,EAAKmnB,KAAKjoB,YAAcioB,EACxBtnC,KAAK8kK,QAAQ9hK,KAAK,CAAEskC,KAAAA,EAAM2qE,SAAU9xF,EAAK8xF,UAC1C,OAAAvzG,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,QAAA2C,EAAAlM,KAAA,EAEe2oB,KAAMqhD,YAAW,OAA3Bl3C,EAAC5mB,EAAA1M,KACP9B,KAAK0gK,QAAU,GAAE74J,EAAA,EAAA8lC,EACDtwC,OAAO+C,OAAOg1B,EAAEiM,QAAO,aAAAx5B,EAAA8lC,EAAApqC,QAAA,CAAAiL,EAAAlM,KAAA,SAA3B,KAADqE,EAACgnC,EAAA9lC,IACJmkC,MAAO,CAAFx9B,EAAAlM,KAAA,gBAAAkM,EAAAvM,OAAA,uBACL6wD,EAAQnsD,EAAEvE,KACZwiK,EAA4C,KAAItvJ,EAAAjK,GACjCynD,EAAMU,kBAAgBhlD,EAAA3J,KAAA,GAAAyQ,EAAA/J,IAAA,YAAA8J,EAAAC,EAAA9O,KAAA9E,KAAE,CAAF8M,EAAAlM,KAAA,SAA1B,IAAJmxD,EAAIp+C,EAAAxX,OACHk3D,OAAQ,CAAFvmD,EAAAlM,KAAA,gBAAAkM,EAAAvM,OAAA,2BACZwxD,EAAKkB,aAAclB,EAAKkB,WAAWi9D,MAAK,SAACtmG,GAAiB,OAAKA,EAAIo8B,QAAQ,IAAC,CAAAl5C,EAAAlM,KAAA,gBAAAkM,EAAAvM,OAAA,uBACzD,OAAvB2iK,EAAmBnxG,EAAIjlD,EAAAvM,OAAA,oBAAAuM,EAAAlM,KAAA,iBAAAkM,EAAAlM,KAAA,iBAAAkM,EAAA3J,KAAA,GAAA2J,EAAAd,GAAAc,EAAA,UAAA8G,EAAA1J,EAAA4C,EAAAd,IAAA,eAAAc,EAAA3J,KAAA,GAAAyQ,EAAAzJ,IAAA2C,EAAA7I,OAAA,eAGpBi/J,EAAkB,CAAFp2J,EAAAlM,KAAA,gBAAAkM,EAAAvM,OAAA,uBACfqlD,EAAMn8B,EAAKm5I,aAAa74I,WAAU,GACxCN,EAAK65I,aAAa1sJ,YAAYgvC,GACxBnnC,EAAOtL,GAAI6W,cAAc47B,GAC/B88G,KACMS,EAAQ,SAAH94J,OAAYq4J,IACvB98G,EAAI+Q,QAAUwsG,EACd1kJ,EAAK8xF,SAASh9F,GAAK4vJ,EACnB1kJ,EAAK0iD,KAAKpjD,IAAM5K,GAAImK,SAASrY,EAAEgY,QAC/BwB,EAAKpc,KAAKsb,YAAc1Y,EAAE5C,KAC1B/D,KAAK0gK,QAAQ19J,KAAK,CAChBic,MAAOtY,EACPjH,KAAMklK,EAAiBllK,KACvBuyG,SAAU9xF,EAAK8xF,WACf,QAAApqG,IAAA2G,EAAAlM,KAAA,kCAAAkM,EAAAxJ,OAAA,GAAAuJ,EAAA,0BAEL,SAAAT,EAAAC,GAAA,OAAA6iD,EAAAhoD,MAAA,KAAAD,UAAA,KAAAhL,IAAA,SAAAE,OAAAkzD,EAAAtoD,EAAAzL,IAAAA,MAED,SAAAopB,IAAA,IAAA6+I,EAAAC,EAAAzgI,EAAA0gI,EAAAtzG,EAAA1mC,EAAAtL,EAAAD,EAAA0nB,EAAAvnB,EAAAD,EAAA/b,EAAA6jB,EAAA,YAAA5qB,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,OAIqB,OAHZ2iK,EAAqD,GAAxCC,EAA4C,IAC1DzgI,EAAM,IAAIf,GAAK1jC,KAAK4mD,KAAM,CAAErhB,iBAAiB,EAAMT,QAAS,SAC9D1vB,KAAK0vB,QAAUvoB,G9B5FU,iB8B6FvB4oJ,EAAa,eAAAnrJ,EAAAvR,EAAAzL,IAAAA,MAAG,SAAA2mB,EAAOyhJ,GAAqB,IAAAxoH,EAAAxzC,EAAA,OAAApM,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,UAC3C8iK,EAAOnzD,SAASt5C,QAAS,CAAF/0C,EAAAthB,KAAA,eAAAshB,EAAA3hB,OAAA,iBAI3B,OAHK26C,EAAM,CACV7vC,KAAMq4J,EAAO99H,KACb0sE,MAAOpsF,EAAK6lD,IACb7pD,EAAAthB,KAAA,EACiBuL,EAAS,cAAe+uC,GAAI,OAAxCxzC,EAAGwa,EAAA9hB,KACJmpB,KAAM6mC,cAAc1oD,IAAM67J,EAAYjiK,KAAKoiK,EAAO99H,MAAK,wBAAA1jB,EAAA5e,OAAA,GAAA2e,EAAA,KAC7D,gBARkBtV,GAAA,OAAA2L,EAAApR,MAAA,KAAAD,UAAA,KAAA2d,EAAAhkB,KAAG,EAShB+B,QAAQghK,IAAIrlK,KAAK8kK,QAAQvzG,IAAI4zG,IAAe,OAGhC,OADlB1gI,EAAIrvB,KAAK0vB,QAAUvoB,G9BzGY,oB8B0GzBs1C,EAAY,eAAA53C,EAAAxR,EAAAzL,IAAAA,MAAG,SAAA6mB,EAAOyhJ,GAA0B,IAAAC,EAAA5+J,EAAAjH,EAAA+tC,EAAAqmB,EAAA/4C,EAAAD,EAAAwQ,EAAA8lC,EAAAhoD,EAAA,OAAApM,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OACpB,GAAjBqE,EAAsB2+J,EAA7BrmJ,MAAUvf,EAAmB4lK,EAAnB5lK,KAAmB4lK,EAAbrzD,SACVt5C,QAAS,CAAF70C,EAAAxhB,KAAA,eAAAwhB,EAAA7hB,OAAA,iBACfwrC,EAAiC,CAAC,EAClCqmB,EAAY7oC,KAAMikE,iBAAiBvoF,EAAEsO,GAAIvV,GAAKqb,EAAA1P,GACb,QADak6J,EACjCzxG,EAAUa,kBAAU,IAAA4wG,EAAAA,EAAI,IAAEzhJ,EAAAjf,KAAA,EAAAkW,EAAAxP,IAAA,WAAAuP,EAAAC,EAAAvU,KAAA9E,KAAA,CAAAoiB,EAAAxhB,KAAA,SAA/B,IAAHgpB,EAAGxQ,EAAAjd,OACJ,QAAU,CAAFimB,EAAAxhB,KAAA,gBAAAwhB,EAAA7hB,OAAA,2BACZqpB,EAAIssC,UAAW,CAAF9zC,EAAAxhB,KAAA,SAC0B,OAAzCmrC,EAAOniB,EAAI3tB,KAAO2tB,EAAG,QAAW,IAAM,IAAGxH,EAAA7hB,OAAA,uBAGvCqpB,EAAIwsC,YAAcrqB,EAAOniB,EAAI3tB,KAAM8vC,EAAOniB,EAAI3tB,MAAQ2tB,EAAIwsC,WAAaxsC,EAAG,QACzEmiB,EAAOniB,EAAI3tB,KAAO2L,OAAOgiB,EAAG,SAAS,QAAAxH,EAAAxhB,KAAA,gBAAAwhB,EAAAxhB,KAAA,iBAAAwhB,EAAAjf,KAAA,GAAAif,EAAApW,GAAAoW,EAAA,SAAA/I,EAAAnP,EAAAkY,EAAApW,IAAA,eAAAoW,EAAAjf,KAAA,GAAAkW,EAAAlP,IAAAiY,EAAAne,OAAA,YAO3C,OALKyrD,EAAa,CACjBrzC,QAASpX,EAAEsO,GACXuwJ,QAAS59I,EAAK6lD,GACdhgC,OAAQA,EACRyjB,WAAYxxD,GACbokB,EAAAxhB,KAAA,GACiBuL,EAAS,iBAAkBujD,GAAW,QAAlDhoD,EAAG0a,EAAAhiB,KACJmpB,KAAM6mC,cAAc1oD,IAAM87J,EAAcliK,KAAK2D,EAAE5C,MAAK,yBAAA+f,EAAA9e,OAAA,GAAA6e,EAAA,yBAC1D,gBAtBiBH,GAAA,OAAAzJ,EAAArR,MAAA,KAAAD,UAAA,KAAA2d,EAAAhkB,KAAG,GAuBf+B,QAAQghK,IAAIrlK,KAAK0gK,QAAQnvG,IAAIM,IAAc,QAEvC,OAAVptB,EAAIz/B,OAAMshB,EAAAhkB,KAAA,GACJ2oB,KAAMqhD,YAAW,WACnB44F,EAAc3hK,OAAS0hK,EAAY1hK,SAAW,EAAC,CAAA+iB,EAAAhkB,KAAA,gBAAAgkB,EAAArkB,OAAA,SAASjC,KAAKsvD,WAAS,QAM1E,GAJMnkC,EAAOnrB,KAAKmrB,KAClBtW,GAAI2E,KAAK2R,EAAKs6I,WACd5wJ,GAAIyE,KAAK6R,EAAKu6I,UAEVT,EAAY1hK,OAAQ,CAAAsc,EAAAxU,GACH45J,GAAW,IAA9B,IAAAplJ,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAW4lC,EAAI1nB,EAAA/hB,MACbstB,EAAKw6I,kBAAkBrtJ,YAAYrN,SAAS26J,eAAet+H,IAC3Dnc,EAAKw6I,kBAAkBrtJ,YAAYrN,SAAS4P,cAAc,MAC3D,OAAAnc,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CACH,MAAOgJ,GAAI2E,KAAK2R,EAAK06I,gBAErB,GAAIX,EAAc3hK,OAAQ,CAAAwc,EAAA1U,GACL65J,GAAa,IAAhC,IAAAnlJ,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,MAAWqC,EAAI+b,EAAAjiB,MACbstB,EAAK26I,kBAAkBxtJ,YAAYrN,SAAS26J,eAAe7hK,IAC3DonB,EAAK26I,kBAAkBxtJ,YAAYrN,SAAS4P,cAAc,MAC3D,OAAAnc,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CACH,MAAOgJ,GAAI2E,KAAK2R,EAAK46I,gBAAe,yBAAAz/I,EAAAthB,OAAA,GAAAohB,EAAA,UACrC,kBAAA2qC,EAAAnoD,MAAA,KAAAD,UAAA,MAAA06J,CAAA,CA9HkB,GAqIfG,GAAc,WAKlB,SAAAA,EAAa58G,EAAmB0I,GAAqB,IAAAnnC,EAAA,KAAAtf,EAAA,KAAA26J,GAAA15J,EAAA,oBAAAA,EAAA,oBAAAA,EAAA,wBACnD9J,KAAK4mD,KAAOA,EACZ,IAAMz7B,EAAOnrB,KAAKmrB,KAAOtW,GAAIwoC,cAAcuJ,GAC3C45B,GAAS55B,EAAMz7B,EAAK66I,SAAS,kBAAM12G,GAAS,IAC5CkxB,GAAS55B,EAAMz7B,EAAK86I,UAAU,kBAAM99I,EAAK89I,UAAU,GACrD,CAWC,OAXAt8J,EAAA65J,EAAA,EAAA7lK,IAAA,SAAAE,MAED,SAAQk0G,GACN/xG,KAAK+xG,SAAWA,CAClB,GAAC,CAAAp0G,IAAA,WAAAE,MAED,WACE,IAAMstB,EAAOnrB,KAAKmrB,KAClBA,EAAK4mF,SAAS1yF,YAAcrf,KAAK+xG,SACjCl9F,GAAI2E,KAAK2R,EAAK+6I,SACdrxJ,GAAIyE,KAAK6R,EAAKg7I,OAChB,KAAC3C,CAAA,CArBiB,ilDClOpB,IAAMh2F,GAAO34D,GAAI24D,KACXrjE,GAAO0K,GAAI1K,KACX6e,GAASnU,GAAImU,OA0Bbo9I,GAA0C,CAC9Cj5F,MAAOiL,GACPiuF,SAAUnwF,GACVjgC,QAASshE,GACTmpD,QAASrnF,GACT0hF,SAAUtrD,GACVpjD,OAAQ23E,GACRh0G,MAAOu3G,GACP++B,YAAa3P,GACbhzC,KAAMm/C,GACNrnD,GAAIwyB,GACJs4B,WAAY9pB,GACZ+pB,WAAYhM,GACZiM,OAAQxL,IAQJyL,GAAyC,CAC7C,QAAS,CACP3iK,KAAM,UACN4iK,KAAM,QAER,QAAS,CACP5iK,KAAM,YACN4iK,KAAM,QAER,QAAS,CACP5iK,KAAM,UACN4iK,KAAM,QAER,QAAS,CACP5iK,KAAM,SACN4iK,KAAM,QAER,QAAS,CACP5iK,KAAM,SACN4iK,KAAM,QAER,GAAM,CACJ5iK,KAAM,SACN4iK,KAAM,SAaWC,GAAW,WA8B9B,SAAAA,IAAe,IAAAztJ,EAAA,KAAAtQ,EAAA,KAAA+9J,GAAA98J,EAAA,qBAAAA,EAAA,qBAAAA,EAAA,qBAAAA,EAAA,oBAAAA,EAAA,wBAAAA,EAAA,sBAAAA,EAAA,sBAAAA,EAAA,oBAAAA,EAAA,2BAAAA,EAAA,0BAAAA,EAAA,0BAAAA,EAAA,uBAAAA,EAAA,yBAAAA,EAAA,oBAAAA,EAAA,sBAAAA,EAAA,2BAAAA,EAAA,sBAAAA,EAAA,yBAAAA,EAAA,yBAAAA,EAAA,4BAAAA,EAAA,uBAAAA,EAAA,oBAAAA,EAAA,0BAAAA,EAAA,0BAAAA,EAAA,yBAAAA,EAAA,6BAAAA,EAAA,4BAAAA,EAAA,+BACb9J,KAAK6tE,MAAQ,GACb7tE,KAAK8tE,MAAQ,GACb9tE,KAAK60D,YAAc,EACnB70D,KAAK4R,WAAai1J,2CAClB7mK,KAAK8mK,cAAgB,GACrB9mK,KAAK0xC,aAAe,CAAC,EACrB1xC,KAAKowG,WAAkD,MAArC3lG,EAAMuB,WAAWvB,EAAMiE,UACzC1O,KAAK+mK,aAAe,CAAC,EACrB/mK,KAAKgnK,gBAAkB,CAAC,EAExBrsJ,QAAQ64B,IAAI,sBAAuBxzC,KAAK4R,WAAWiN,UAAU,EAAG,IAG5DpU,EAAM4P,UACRpP,SAASqC,KAAKqL,UAAUC,IAAI,QAM9B5Y,KAAKinK,QAAUx8J,EAAMuB,WAAWvB,EAAMy8J,YAAc,CAAC,EACrDh7J,OAAOi7J,aAAe,SAACC,EAAU7lK,GAI/B,OAHIA,EAAO4X,EAAK8tJ,QAAQG,IAAY,SACxBjuJ,EAAK8tJ,QAAQG,GACzB38J,EAAMgE,WAAWhE,EAAMy8J,UAAW/tJ,EAAK8tJ,SAChC,GAAPl7J,OAAUq7J,EAAQ,YAAAr7J,OAAWxK,EAAQ,UAAY,WACnD,EAEA2K,OAAOsnC,IAAM,SAAC4zH,GAAmB,QAAA5vJ,EAAA7O,UAAApF,OAANoD,EAAC,IAAAS,MAAAoQ,EAAA,EAAAA,EAAA,KAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAD/Q,EAAC+Q,EAAA,GAAA/O,UAAA+O,GAAOyB,EAAKq6B,IAAG5qC,MAARuQ,EAAI,CAAKiuJ,GAAQr7J,OAAKpF,GAAG,EAC5DuF,OAAO0hC,SAAW,kBAAMz0B,EAAKy0B,QAAQ,EAGrC,IAAMy5H,EAAe58J,EAAMuB,WAAWvB,EAAM68J,cAAgB,GAC5DtnK,KAAKunK,UAAY,CAAC,EAAC,IACgBp8J,EADhBC,EAAAC,GACIg8J,GAAY,IAAnC,IAAAj8J,EAAAG,MAAAJ,EAAAC,EAAA5E,KAAA9E,MAAqC,KAA1B0lK,EAAQj8J,EAAAtN,MACjB8c,QAAQ64B,IAAI,YAAa4zH,GACzBpnK,KAAKunK,UAAUH,GAAY,EAC7B,CAAC,OAAA1oK,GAAA0M,EAAAQ,EAAAlN,EAAA,SAAA0M,EAAAS,GAAA,CACDK,OAAOs7J,aAAe,SAACJ,EAAUr7I,GAI/B,OAHIA,EAAI5S,EAAKouJ,UAAUH,GAAY,UACvBjuJ,EAAKouJ,UAAUH,GAC3B38J,EAAMgE,WAAWhE,EAAM68J,YAAajqK,OAAOkH,KAAK4U,EAAKouJ,YAC9C,GAAPx7J,OAAUq7J,EAAQ,cAAAr7J,OAAaggB,EAAK,UAAY,WAClD,EACA7f,OAAOu7J,WAAa,SAAAL,GAClB,IAAMrmK,EAASoY,EAAKouJ,UAAUH,GAC9B,IAAKrmK,EAAQ,MAAO,0BAAPgL,OAAiCq7J,GAC9C,IAAMzgK,EAAIsE,SAAS4P,cAAc,KACjClU,EAAEwlC,KAAO,wCAAHpgC,OAA2CG,OAAOw7J,KAAKr7J,KAAKC,UAAUvL,EAAQ,KAAM,KAC1F4F,EAAEghK,SAAW,GAAH57J,OAAMq7J,EAAQ,SACxBn8J,SAASqC,KAAKgL,YAAY3R,GAC1BA,EAAEstB,QACF1a,YAAW,WACTtO,SAASqC,KAAKwK,YAAYnR,EAC5B,GAAG,EACL,EAEAuF,OAAO4/B,KAAO,kBAAM3yB,EAAK2yB,IAAI,CAC/B,CA81CC,IAAA87H,EAjFDC,EAtBAC,EAtBAC,EAlkBCC,EAnGAC,EA1IAC,EArVDC,EANCC,EA5BDC,EAzDA3gC,EA42CC,OA52CD/9H,EAAAi9J,EAAA,EAAAjpK,IAAA,QAAAE,OAAA6pI,EAAAj/H,EAAAzL,IAAAA,MAIA,SAAA8P,IAAA,IAAAkgB,EAAAmvC,EAAAj2C,EAAA,YAAAlpB,IAAAA,MAAA,SAAAkQ,GAAA,cAAAA,EAAArI,KAAAqI,EAAA5K,MAAA,OAYE,OAVA6H,GAAK+B,OAAQ,YAAY,SAACN,GAAqB,IAAA08J,EACvCn9I,EAAc,QAAVm9I,EAAG18J,EAAErK,aAAK,IAAA+mK,OAAA,EAAPA,EAASn9I,MACjBA,GAAiB,KAATA,IACbjF,EAAK03B,SAASzyB,EAAMvf,EAAErK,MAAM2M,MAAM,EACpC,IAIAlO,KAAKu4G,KAAO/qC,GAAKviE,SAAU,QACrB+hB,EAAUhtB,KAAKu4G,KAAKh6F,QAAQyO,QAClC9f,EAAA5K,KAAA,EACMtC,KAAKssE,YAAW,OAC2C,OAAAp/D,EAAA5K,KAAA,EAC3Dia,GAAgBvc,KAAK2R,KAAM3R,KAAK4R,YADXi1J,GAC0C,OAiBrE,GAZI0B,IADEpsG,EAAM,IAAI+tC,IAAIh+F,OAAOi+F,SAASh+D,OACZi+D,YAAcp9E,IACpCmvC,EAAIiuC,SAAW,IAAHr+F,OAAOihB,GACnBmvC,EAAI4tC,OAAS,GACb79F,OAAOklF,QAAQyqE,aAAa,CAAE1wI,KAAM6B,GAAW,GAAImvC,IAGrDn8D,KAAKwoK,eACLxoK,KAAKyoK,gBACLzoK,KAAK0oK,aAAa1oK,KAAKsyH,QACvBtyH,KAAK2oK,OAAO,CAAC,IAIT3oK,KAAK83E,OAAQ,CAAF5qE,EAAA5K,KAAA,gBAAA4K,EAAA5K,KAAA,GAAQtC,KAAK4oK,aAAY,QACxC5oK,KAAKi4E,yBAEL21B,KAEAoQ,GAAGhD,cAu0CC6tD,IAAyC,WAA7B38J,OAAOi+F,SAAS0+D,SAAyB,MAAQ,KAC5D,GAAP98J,OAAU88J,EAAQ,OAAA98J,OAAMG,OAAOi+F,SAAS7iE,KAAI,SAx0Cf,kBAAMphB,EAAK4iJ,aAAa,IACnD9qD,GAAGC,cAvNmB,UAuNc,SAAC7tD,GACnClqC,EAAK6iJ,OAAO34G,EACd,IAAE,yBAAAljD,EAAAlI,OAm0CN,IACQ6jK,CAp0CF,GAAA/7J,EAAA,UACH,kBAAA46H,EAAA9+H,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,cAAAE,MAGA,WAAe,IAAAmrK,EACsB,cAAtB,QAATA,EAAAhpK,KAAKu4G,YAAI,IAAAywD,OAAA,EAATA,EAAWzqJ,QAAQyO,SAAwB9gB,OAAOi+F,SAAS22B,OAAO,KACjE50H,OAAOi+F,SAASmG,QAEvB,GAEA,CAAA3yG,IAAA,YAAAE,OAAAwqK,EAAA5/J,EAAAzL,IAAAA,MAIA,SAAAiR,IAAA,IAAAs6E,EAAAz8C,EAAAjkC,EAAAK,EAAA+gK,EAAAlrJ,EAAAkB,EAAA,OAAAjiB,IAAAA,MAAA,SAAAmR,GAAA,cAAAA,EAAAtJ,KAAAsJ,EAAA7L,MAAA,cAAA6L,EAAA7L,KAAA,EACmC8L,EAAQ,aAAY,OAA7B,GAAlBm6E,EAAkBp6E,EAAArM,KACnB9B,KAAK8xD,cAAcy2B,GAAO,CAAFp6E,EAAA7L,KAAA,eAAA6L,EAAAlM,OAAA,iBAKA,GAJ7BjC,KAAKkpK,OAAS3gF,EAAK2gF,OACnBlpK,KAAK83E,OAAS9pD,QAAQu6D,EAAKz8C,MAC3B9rC,KAAK2R,KAAO42E,EAAK52E,KACjB3R,KAAKmpK,MAAQ5gF,EAAK4gF,MAClBnpK,KAAK4tC,SAAW26C,EAAK36C,SAChB26C,EAAKz8C,KAAM,CAAF39B,EAAA7L,KAAA,gBAAA6L,EAAAlM,OAAA,kBAQd,IAPM6pC,EAAOy8C,EAAKz8C,KAClB9rC,KAAK60D,YAAc/oB,EAAKs9H,YACxBppK,KAAK8rC,KAAOA,EACZ9rC,KAAKqhC,OAASyK,EAAKzK,OACnBrhC,KAAKwnC,UAAYsE,EAAKtE,UACtBxnC,KAAK+3C,UAAY,CAAC,EAClB/3C,KAAK0xC,aAAe5F,EAAK6/D,UACzB9jG,EAAA,EAAAK,EAAgC7K,OAAOkgB,QAAQuuB,EAAKzK,QAAOx5B,EAAAK,EAAA3E,OAAAsE,IAA8BohK,EAAArhK,EAAAM,EAAAL,GAAA,GAA7EkW,EAAOkrJ,EAAA,IAAEhqJ,EAAKgqJ,EAAA,IACd7jJ,SACRplB,KAAK+3C,UAAUh6B,GAAWkB,EAAMmG,QAIP,OAA7BplB,KAAKi4E,yBAAwB9pE,EAAAlM,OAAA,SACtB6pC,GAAI,yBAAA39B,EAAAnJ,OAAA,GAAAiJ,EAAA,UACZ,kBAAAo6J,EAAAz/J,MAAA,KAAAD,UAAA,KAAAhL,IAAA,gBAAAE,OAAAuqK,EAAA3/J,EAAAzL,IAAAA,MAED,SAAAuR,IAAA,OAAAvR,IAAAA,MAAA,SAAAwR,GAAA,cAAAA,EAAA3J,KAAA2J,EAAAlM,MAAA,cAAAkM,EAAAlM,KAAA,EACwByqC,GAAGx/B,SAAQ,OAAjCvN,KAAK4tC,SAAQp/B,EAAA1M,KAAA,wBAAA0M,EAAAxJ,OAAA,GAAAuJ,EAAA,UACd,kBAAA65J,EAAAx/J,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,WAAAE,OAAAsqK,EAAA1/J,EAAAzL,IAAAA,MACA,SAAA2mB,EAAgBwH,EAAcjd,EAAYm7J,GAAkB,IAAAltG,EAAAmtG,EAAAr8J,EAAAwI,EAAA8zJ,EAAAhxD,EAAAixD,EAAA5iF,EAAA,OAAA5pF,IAAAA,MAAA,SAAA4mB,GAAA,cAAAA,EAAA/e,KAAA+e,EAAAthB,MAAA,OAO1D,OALAtC,KAAKmlB,QAAQ5K,MAAMxE,KAAO,WAC1BlB,GAAI2E,KAAKxZ,KAAKmrB,KAAKs+I,QAASzpK,KAAKmrB,KAAKu+I,YAEhCvtG,EAAM,IAAI+tC,IAAI,IAADn+F,OAAKof,GAAQjf,OAAOi+F,SAASw/D,QAC1CL,EAAmBf,GAAgBp9I,GACzCvH,EAAAthB,KAAA,EACuB4J,OAAOiB,MAAMgvD,EAAI50D,YAAW,OAArC,IAAR0F,EAAQ2W,EAAA9hB,MACA2lF,GAAI,CAAF7jE,EAAAthB,KAAA,eAAAshB,EAAA3hB,OAAA,UAAS,GAAK,cAAA2hB,EAAAthB,KAAA,GACX2K,EAASU,OAAM,QAejB,OAfX8H,EAAImO,EAAA9hB,KACJynK,EAAM10J,GAAI06F,SAAS95F,GACnB8iG,EAAO/qC,GAAK+7F,EAAK,QACjBC,EAAYjxD,EAAKh6F,QAAQyO,QAE1Bq8I,IACGziF,EAAO4iF,IAAcF,EAAmBntG,EAAI50D,WAAa,IAAHwE,OAAOy9J,GACnEt9J,OAAOklF,QAAQw4E,UAAU,CAAEz+I,KAAMA,EAAMjd,KAAMA,GAAQ,GAAI04E,IAG3D37E,SAAS0iG,MAAQ47D,EAAI57D,MACrB3tG,KAAKu4G,KAAK0vB,YAAY1vB,GACtBv4G,KAAKu4G,KAAOA,EACZv4G,KAAK8mK,cAAgB,GACrBjyJ,GAAImD,MAAMhY,KAAKihH,aACfjhH,KAAK2oK,OAAOz6J,GAAK0V,EAAA3hB,OAAA,UACV,GAAI,yBAAA2hB,EAAA5e,OAAA,GAAA2e,EAAA,UACZ,SAAA3b,EAAA2E,EAAAC,GAAA,OAAAu7J,EAAAv/J,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,SAAAE,MACA,SAAQqQ,GACN,IAAM27J,EAAY7pK,KAAKu4G,KAAKh6F,QAAQyO,QACpC,GAAK68I,EAAL,CAIA7pK,KAAK0oK,aAAa1oK,KAAKu4G,MACnBv4G,KAAK8pK,YAAY9pK,KAAK8pK,WAAWC,SACrC,IAAMjmK,EAAcsiK,GAAayD,GAChB7pK,KAAK8pK,WAAlBhmK,EAA+B,IAAIA,EAAY9D,KAAKu4G,KAAMrqG,GACvC,KAGvBlO,KAAK4zD,aAAa5zD,KAAKu4G,MAEnBrsG,OAAOqiG,WAETvuG,KAAK+1F,gBAAgB/1F,KAAKu4G,MAG5Bv4G,KAAKgqK,UAAUhqK,KAAKu4G,KAfpB,MAFE59F,QAAQvZ,MAAM,qDAkBlB,GAAC,CAAAzD,IAAA,eAAAE,MAED,SAAcka,GAAuB,IAAAgP,EAAA,KACnChP,EAAS0C,iBAAiB,kBAAkBla,SAAQ,SAACyU,GACnD7K,GAAK6K,EAAI,cAAc,WACrB+R,EAAK5B,QAAQ9F,YAAcrK,EAAGuJ,QAAQ4G,SAAW,GACjD,IAAM8kJ,EAAMp1J,GAAIyC,cAActC,GAC1Be,EAAOk0J,EAAIhzJ,QAAU8P,EAAK5B,QAAQzO,YAAc,EAChDX,EAAO,IAAGA,EAAO,GACjBA,EAAOgR,EAAK5B,QAAQzO,YAAczL,SAASqC,KAAKoJ,cAClDX,EAAO9K,SAASqC,KAAKoJ,YAAcqQ,EAAK5B,QAAQzO,YAAc,GAEhEqQ,EAAK5B,QAAQ5K,MAAMxE,KAAO,GAAHhK,OAAMgK,EAAI,MACjCgR,EAAK5B,QAAQ5K,MAAMrE,IAAM,GAAHnK,OAAMk+J,EAAIpzJ,QAAUkQ,EAAK5B,QAAQvO,aAAe,EAAC,KACzE,IACAzM,GAAK6K,EAAI,cAAc,WACrB+R,EAAK5B,QAAQ5K,MAAMxE,KAAO,UAC5B,GACF,GACF,GAEA,CAAApY,IAAA,YAAAE,MAKA,SAAW06G,GAAmB,IAAA3wF,EAAA,KACtBuf,EAAMl8B,SAAS4P,cAAc,OACnCssB,EAAIxuB,UAAUC,IAAI,oBAAqB,OAEvC,IAAM2vC,EAAOt9C,SAAS4P,cAAc,OACpCssB,EAAI7uB,YAAYiwC,GAChBA,EAAK5vC,UAAUC,IAAI,UAAW,UAC9B,IAYmEvD,EAZ7DwtH,EAAS,SAAC7tH,EAAiB8H,EAAcY,GAC7C,IAAMtH,EAAMvB,GAAIyJ,aAAatJ,EAAI,mBAC3BwH,EAAQ3J,SAASuD,EAAImI,QAAQ/B,OAC7B8qC,EAAMr8C,SAAS4P,cAAc,OACnCysC,EAAIjoC,YAAcvC,EAClByrC,EAAKjwC,YAAYgvC,GACjBA,EAAI3uC,UAAUC,IAAI,MAAO,UAAW,WACpC/D,GAAI1K,KAAKm9C,EAAK,SAAS,WACrBzyC,GAAIoJ,QAAQjJ,EAAI,eAAgBH,GAAIiJ,kBAAkBtB,EAAQkB,EAASzK,KAAKC,MAAMD,KAAKE,MAAMuK,MAC7F7I,GAAIoJ,QAAQjJ,EAAI,cAAe8H,EACjC,GACF,EAACxH,EAAAjK,GACgBwJ,GAAImG,cAAcu9F,EAAM,4BAA0B,QAAAtlD,EAAA,WAAE,IAA1Dj+C,EAAEK,EAAAxX,MACLuY,EAAMvB,GAAIyJ,aAAatJ,EAAI,mBACjCH,GAAI1K,KAAKiM,EAAK,cAAc,WAC1BvB,GAAImD,MAAMuwC,GACVnyC,EAAIkC,YAAY6uB,GAChB,IAAM8iI,EAAMp1J,GAAIyC,cAAclB,GACxB2H,EAAUlL,SAASuD,EAAImI,QAAQR,SACnBtB,EAAOmL,EAAKyZ,OAAOtjB,GAA7BrJ,SACRmuH,EAAO7tH,EAAIyH,EAAG9H,aAAamI,KAAML,EAAG9H,aAAaC,kBAAiB,IACTkG,EADSC,EAAA1P,GACzBoR,EAAGM,eAAa,IAAzD,IAAAhC,EAAAxP,MAAAuP,EAAAC,EAAAvU,KAAA9E,MAA2D,KAAAwoK,EAAApvJ,EAAAjd,MAA9Cif,EAAIotJ,EAAJptJ,KAAMlI,EAAgBs1J,EAAhBt1J,iBAAwCiuH,EAAO7tH,EAAI8H,EAAMlI,EAAgB,CAAC,OAAAlW,GAAAqc,EAAAnP,EAAAlN,EAAA,SAAAqc,EAAAlP,GAAA,CAC7Fg3H,EAAO7tH,EAAIyH,EAAGI,WAAY,GACtBotJ,EAAIpzJ,QAAWswB,EAAIvwB,aAAegR,EAAK0qG,OAAO17G,cAChDuwB,EAAI5sB,MAAMpE,OAAS,oBACnBgxB,EAAI5sB,MAAMrE,IAAM,SAEhBixB,EAAI5sB,MAAMrE,IAAM,oBAChBixB,EAAI5sB,MAAMpE,OAAS,OAEvB,IACAtB,GAAI1K,KAAKiM,EAAK,cAAc,kBAAM+wB,EAAIluB,QAAQ,GAChD,EApBA,IAAA3D,EAAA/J,MAAA8J,EAAAC,EAAA9O,KAAA9E,MAAAuxD,GAoBC,OAAAv0D,GAAA4W,EAAA1J,EAAAlN,EAAA,SAAA4W,EAAAzJ,GAAA,CACH,GAAC,CAAAlO,IAAA,kBAAAE,MAED,SAAiBka,GACf,GAAK7L,OAAOi+J,QAAZ,CAA2B,IACuCvqJ,EADvCC,EAAAxU,GACRwJ,GAAImG,cAAcjD,EAAU,qBAAmB,QAAA6yD,EAAA,WAAE,IAAzDh/B,EAAIhsB,EAAA/hB,MACbgX,GAAI1K,KAAKyhC,EAAM,SAAS,SAAChgC,GAAkB,IAAAw+J,EACzCx+J,EAAE4c,iBACFtc,OAAOi+J,QAAiB,QAAVC,EAACx+H,EAAKO,YAAI,IAAAi+H,EAAAA,EAAI,GAC9B,GACF,EALA,IAAAvqJ,EAAAtU,MAAAqU,EAAAC,EAAArZ,KAAA9E,MAAAkpE,GAKC,OAAAlsE,GAAAmhB,EAAAjU,EAAAlN,EAAA,SAAAmhB,EAAAhU,GAAA,CAN0B,CAO7B,GAEA,CAAAlO,IAAA,eAAAE,MAGA,WAAgB,IAAAsqB,EAAA,KACdnoB,KAAKsyH,OAAS9kD,GAAKviE,SAASqC,KAAM,UAClC,IAAM6d,EAAOnrB,KAAKmrB,KAAOtW,GAAIwoC,cAAcr9C,KAAKsyH,QAChDtyH,KAAKihH,YAAc91F,EAAK81F,YACxBjhH,KAAKqqK,WAAa78F,GAAKviE,SAASqC,KAAM,cACtCtN,KAAKsqK,UAAYz1J,GAAIi7C,YAAY9vD,KAAKqqK,WAAY,QAC9CrqK,KAAKsqK,UAAWtqK,KAAKsqK,UAAUrxJ,SAC9B0B,QAAQvZ,MAAM,+BACnBpB,KAAKmlB,QAAUqoD,GAAKviE,SAASqC,KAAM,WACnC6d,EAAKo/I,SAASnqJ,gBAAgB,MAC9B+K,EAAKo/I,SAAStxJ,SACdkS,EAAKq/I,SAASpqJ,gBAAgB,MAC9B+K,EAAKq/I,SAASvxJ,SACdkS,EAAKs/I,OAAOxxJ,SACZpE,GAAIyE,KAAK6R,EAAKs/I,QAEdtgK,GAAKghB,EAAKu/I,SAAU,QAAOjiK,EAAAzL,IAAAA,MAAE,SAAA6mB,IAAA,IAAA9D,EAAAD,EAAAswC,EAAA,OAAApzD,IAAAA,MAAA,SAAA8mB,GAAA,cAAAA,EAAAjf,KAAAif,EAAAxhB,MAAA,OAC3BuS,GAAI2E,KAAK2R,EAAKw/I,UACd91J,GAAIyE,KAAK6R,EAAKy/I,UACdziJ,EAAK0iJ,WACL1/I,EAAK2/I,QAAQnyJ,UAAUC,IAAI,UAC3BuS,EAAK4/I,QAAQpyJ,UAAUM,OAAO,UAC9BkP,EAAK6iJ,aAAa7/I,EAAKu/I,SAAUv/I,EAAKs+I,SACtC50J,GAAI2E,KAAK2R,EAAK8/I,eAAclrJ,EAAA1U,GACT8c,EAAK0lD,OAAK,IAA7B,IAAA9tD,EAAAxU,MAAAuU,EAAAC,EAAAvZ,KAAA9E,OAAW0uD,EAAItwC,EAAAjiB,OACJsiH,OACP/vD,EAAKp7C,GAAG2D,UAAUM,OAAO,YAE5B,OAAAva,GAAAqhB,EAAAnU,EAAAlN,EAAA,SAAAqhB,EAAAlU,GAAA,CACDsc,EAAK+iJ,aAAa//I,EAAKy/I,UACvBziJ,EAAK+iJ,aAAa//I,EAAKw/I,UAAS,yBAAA7mJ,EAAA9e,OAAA,GAAA6e,EAAA,MAGlC1Z,GAAKghB,EAAKggJ,WAAY,SAAS,WAC7Bt2J,GAAI2E,KAAK2R,EAAKigJ,WACdjjJ,EAAK6iJ,aAAa7/I,EAAKggJ,WAAYhgJ,EAAKu+I,WAC1C,IAEAv/J,GAAKghB,EAAKkgJ,cAAe,SAAS,WAAQx2J,GAAI2E,KAAK2R,EAAKs+I,QAAS,IACjEt/J,GAAKghB,EAAKmgJ,gBAAiB,SAAS,WAAQz2J,GAAI2E,KAAK2R,EAAKu+I,WAAY,IAEtEv/J,GAAKghB,EAAKogJ,eAAgB,QAAO9iK,EAAAzL,IAAAA,MAAE,SAAAopB,IAAA,OAAAppB,IAAAA,MAAA,SAAAspB,GAAA,cAAAA,EAAAzhB,KAAAyhB,EAAAhkB,MAAA,cAAAgkB,EAAAhkB,KAAA,EAAkB6lB,EAAKqjJ,UAAS,cAAAllJ,EAAArkB,OAAA,SAAAqkB,EAAAxkB,MAAA,wBAAAwkB,EAAAthB,OAAA,GAAAohB,EAAA,MAEnEjc,GAAKghB,EAAK4/I,QAAS,SAAS,WAC1B5iJ,EAAK+iJ,aAAa//I,EAAKw/I,UACvBx/I,EAAK4/I,QAAQpyJ,UAAUC,IAAI,UAC3BuS,EAAK2/I,QAAQnyJ,UAAUM,OAAO,UAC9BpE,GAAI2E,KAAK2R,EAAKy/I,UACd/1J,GAAIyE,KAAK6R,EAAKw/I,UACdxiJ,EAAK0iJ,UACP,IAEA1gK,GAAKghB,EAAK2/I,QAAS,SAAS,WAC1B3iJ,EAAK+iJ,aAAa//I,EAAKy/I,UACvBz/I,EAAK2/I,QAAQnyJ,UAAUC,IAAI,UAC3BuS,EAAK4/I,QAAQpyJ,UAAUM,OAAO,UAC9BpE,GAAI2E,KAAK2R,EAAKw/I,UACd91J,GAAIyE,KAAK6R,EAAKy/I,UACdziJ,EAAK0iJ,UACP,IAEAh2J,GAAIuyB,eAAejc,EAAKsgJ,cACxB,IAAAC,EAAuBhF,GAAa1mK,KAAK2R,MAAjC5N,EAAI2nK,EAAJ3nK,KAAM4iK,EAAI+E,EAAJ/E,KACdx7I,EAAKwgJ,SAAStsJ,YAAcsnJ,EAC5Bx7I,EAAKygJ,SAASvsJ,YAActb,EAAI,IAEHsc,EAFGC,EAAAjV,GAEbrL,KAAKmpK,OAAK,QAAAz5F,EAAA,WAAE,IAApB/9D,EAAI0O,EAAAxiB,MACb,GAAI8T,IAASwW,EAAKxW,KAAM,MAAF,WACtB,IAAMw1B,EAAMhc,EAAKsgJ,aAAahgJ,WAAU,GACxCogJ,EAAuBnF,GAAa/0J,GAA5B5N,EAAI8nK,EAAJ9nK,KAAM4iK,EAAIkF,EAAJlF,KACdx/H,EAAI9nB,YAAcsnJ,EAClBx/H,EAAIwmE,MAAQ5pG,EACZ8Q,GAAI1K,KAAKg9B,EAAK,SAAS,kBAAMhf,EAAK2jJ,YAAYn6J,EAAK,IACnDwZ,EAAK4gJ,UAAUzzJ,YAAY6uB,EAC7B,EARA,IAAA7mB,EAAA/U,MAAA8U,EAAAC,EAAA9Z,KAAA9E,MAAAguE,GAQC,OAAAhxE,GAAA4hB,EAAA1U,EAAAlN,EAAA,SAAA4hB,EAAAzU,GAAA,CACH,GAAC,CAAAlO,IAAA,gBAAAE,MAED,WAAiB,IAAAg5B,EAAA,KACP1L,EAASnrB,KAATmrB,KACR9tB,OAAOyjI,OAAO31G,EAAMtW,GAAIwoC,cAAcxoC,GAAI24D,KAAKviE,SAASqC,KAAM,qBAC9DuH,GAAIuyB,eAAejc,EAAK6gJ,kBAAmB7gJ,EAAK8gJ,kBAAmB9gJ,EAAK+gJ,aAAc/gJ,EAAKghJ,eAC3Ft3J,GAAI1K,KAAKghB,EAAKihJ,gBAAiB,SAAS,WACtCv3J,GAAI2E,KAAK2R,EAAKkhJ,cACdx3J,GAAIyE,KAAK6R,EAAKmhJ,sBAChB,IACAz3J,GAAI1K,KAAKghB,EAAKmhJ,sBAAuB,SAAS,WAC5Cz3J,GAAI2E,KAAK2R,EAAKmhJ,uBACdz3J,GAAIyE,KAAK6R,EAAKkhJ,cACmC,IAA7ClhJ,EAAKohJ,oBAAoB7xJ,SAASnX,QAAcszB,EAAK21I,kBAC3D,IACA,IAAMC,EAAqB,SAACC,GAC1B,IAAMx/I,EAAW7vB,OAAO+C,OAAOy2B,EAAKmwI,iBAAiB1zJ,QAAO,SAAC4G,GAAiB,OAAKA,EAAEgT,QAAQ,IAAE,GACzFy/I,EAAU91I,EAAK+1I,gBACfjtI,EAAMgtI,EAAQ/tJ,QAAQsO,GAC5B2J,EAAKg2I,oBAAoBF,EAAQhtI,EAAM+sI,GAAKI,SAC9C,EACAj4J,GAAI1K,KAAKghB,EAAK4hJ,WAAY,SAAS,kBAAMN,GAAoB,EAAE,IAC/D53J,GAAI1K,KAAKghB,EAAK6hJ,WAAY,SAAS,kBAAMP,EAAmB,EAAE,GAChE,GAAC,CAAA9uK,IAAA,qBAAAE,MAED,WACE,IAAgB8uK,EAA+B3sK,KAAvC8rC,KAAQ6gI,QAAW3F,EAAoBhnK,KAApBgnK,gBAC3B,GAAK2F,EAAL,CAAoB,IACGvzG,EADHC,EAAAhuD,GACJshK,GAAO,IAAvB,IAAAtzG,EAAA9tD,MAAA6tD,EAAAC,EAAA7yD,KAAA9E,MAAyB,KAAdiF,EAACyyD,EAAAv7D,MAAamC,KAAKitK,UAAUtmK,EAAC,CAAC,OAAAjI,GAAA26D,EAAAztD,EAAAlN,EAAA,SAAA26D,EAAAxtD,GAAA,CACtCxO,OAAOkH,KAAKyiK,GAAiBzjK,SAC/BvD,KAAKwsK,mBACLxsK,KAAKktK,cAJa,CAMtB,GAAC,CAAAvvK,IAAA,gBAAAE,MAED,WACE,IAAM8uK,EAAUtvK,OAAO+C,OAAOJ,KAAKgnK,iBAEnC,OADA2F,EAAQlyI,MAAK,SAAC9zB,EAAmByT,GAAiB,OAAKzT,EAAEs/C,MAAQ7rC,EAAE6rC,KAAK,IACjE0mH,CACT,GAAC,CAAAhvK,IAAA,mBAAAE,MAED,WACEmC,KAAK6sK,oBAAoB7sK,KAAK4sK,gBAAgB,GAAGE,SACnD,GAAC,CAAAnvK,IAAA,YAAAE,MAED,SAAW++C,GACT,IAAQzxB,EAA0BnrB,KAA1BmrB,KAAM67I,EAAoBhnK,KAApBgnK,gBACRmG,EAAiBnG,EAAgBpqH,EAAIkwH,UAC3C,IAAIK,GAAkBA,EAAeC,WAAaxwH,EAAIwwH,SAAtD,CACA,IAAMjmI,EAAMnnC,KAAKqtK,WAAWzwH,GAC5B,GAAIuwH,EACEA,EAAejgJ,UAAUigJ,EAAehmI,IAAI8gG,YAAY9gG,GAC5DgmI,EAAehmI,IAAMA,MAChB,CACL6/H,EAAgBpqH,EAAIkwH,UAAY,CAC9B3lI,IAAAA,EACA8e,OAAQ,IAAIr7C,MAAQE,UACpBgiK,SAAUlwH,EAAIkwH,SACdM,SAAUxwH,EAAIwwH,SACdlgJ,UAAU,GAEZ,IAAM1mB,EAAInJ,OAAOkH,KAAKyiK,GAAiBzjK,OACvC4nB,EAAKmiJ,kBAAkBjuJ,YAAc/V,OAAO9C,GAC5C2kB,EAAKoiJ,YAAYluJ,YAAc/V,OAAO9C,GAClCqO,GAAI0wE,SAASp6D,EAAKkhJ,eACpBrsK,KAAK6sK,oBAAoBjwH,EAAIkwH,SAEjC,CAnBsE,CAoBxE,GAAC,CAAAnvK,IAAA,cAAAE,MAED,WACEgX,GAAIg8E,MAAM7wF,KAAKmrB,KAAKkhJ,cACpBx3J,GAAIg8E,MAAM7wF,KAAKmrB,KAAKmhJ,sBACtB,GAAC,CAAA3uK,IAAA,gBAAAE,MAED,SAAe++C,GACb58C,KAAKwtK,oBAAoB5wH,EAAIkwH,SAC/B,GAAC,CAAAnvK,IAAA,sBAAAE,MAED,SAAqBivK,GACnB,IAAQ3hJ,EAA0BnrB,KAA1BmrB,KAAM67I,EAAoBhnK,KAApBgnK,gBACRmG,EAAiBnG,EAAgB8F,GACvC,GAAKK,EAAL,QACOnG,EAAgB8F,GACvB,IAAMW,EAAMpwK,OAAOkH,KAAKyiK,GAAiBzjK,OACzC4pK,EAAehmI,IAAIluB,SACP,IAARw0J,GAIJtiJ,EAAKmiJ,kBAAkBjuJ,YAAc/V,OAAOmkK,GAC5CtiJ,EAAKoiJ,YAAYluJ,YAAc/V,OAAOmkK,GAClCN,EAAejgJ,UAAUltB,KAAKwsK,oBALhC33J,GAAI2E,KAAK2R,EAAKkhJ,aAAclhJ,EAAKmhJ,sBALR,CAW7B,GAAC,CAAA3uK,IAAA,aAAAE,MAED,SAAY++C,GACV,OAAQA,EAAIwwH,UACV,IAAK,WACH,OAAOptK,KAAK0tK,eAAe9wH,GAC7B,IAAK,gBACH,OAAO58C,KAAK2tK,oBAAoB/wH,GAClC,IAAK,YACH,OAAO58C,KAAK4tK,gBAAgBhxH,GAC9B,IAAK,iBACH,OAAO58C,KAAK6tK,qBAAqBjxH,GAErC,MAAMp7C,MAAM,8BAAgCo7C,EAAIwwH,SAClD,GAAC,CAAAzvK,IAAA,gBAAAE,MAED,SAAe++C,GACb,IAAQ7+B,EAAqB6+B,EAArB7+B,QACFvX,EADuBo2C,EAAZq4C,QAEjB64E,EAAgC9tK,KAAKqhC,OAAOtjB,GAA1BtB,EAAEqxJ,EAAZp5J,SAAcs3B,EAAK8hI,EAAL9hI,MAChB+hI,EAAQ/tK,KAAKmrB,KAAK8gJ,kBAAkBxgJ,WAAU,GAC9CtL,EAAOtL,GAAI6W,cAAcqiJ,GAC/B5tJ,EAAK6tJ,SAAS3uJ,YAAc7Y,EAAEsvF,GAAG7gF,GACjCkL,EAAK6tJ,SAASzvJ,QAAQ6tB,aAAe5lC,EAAEsvF,GAAG7gF,GAC1C02B,GAAYK,EAAQA,EAAMC,SAAWluB,EAASoC,EAAK6tJ,UACnD7tJ,EAAK8tJ,MAAM5uJ,YAAcxK,GAAIkc,gBAAgBvqB,EAAEsvF,GAAGzzE,OAAQ5F,GAC1D0D,EAAK+tJ,QAAQ7uJ,YAAc5C,EAAG9H,aAAamI,KAC3C,IAAMqxJ,EAAWniI,EAAQhsC,KAAK0U,SAASs3B,EAAMC,UAAYxvB,EAYzD,OAXA0D,EAAKzgB,KAAK2f,YAAc85D,GAAa3yE,EAAEsvF,GAAGp2F,MAC1CygB,EAAKiuJ,UAAU/uJ,YAAcxK,GAAIkc,gBAAgBvqB,EAAEsvF,GAAG77C,KAAMk0H,GAC5DhuJ,EAAKkuJ,QAAQhvJ,YAAc8uJ,EAASx5J,aAAamI,KAE1C,aADC8/B,EAAIwwH,WAERv4J,GAAIyE,KAAK6G,EAAKmuJ,YACdnuJ,EAAKouJ,QAAQlvJ,YAAcxK,GAAIkc,gBAAgBvqB,EAAEsvF,GAAG77C,KAAMk0H,GAC1DhuJ,EAAKquJ,YAAYnvJ,YAAc8uJ,EAASx5J,aAAamI,MAIlDixJ,CACT,GAAC,CAAApwK,IAAA,eAAAE,OAAAqqK,EAAAz/J,EAAAzL,IAAAA,MAED,SAAA+sB,EAAoB6yB,EAAyB6xH,EAAan5G,GAAmB,IAAA9W,EAAAp1C,EAAA,OAAApM,IAAAA,MAAA,SAAAqtB,GAAA,cAAAA,EAAAxlB,KAAAwlB,EAAA/nB,MAAA,OAEvB,OADpDuS,GAAI2E,KAAK87C,GACH9W,EAAUx+C,KAAKw+C,QAAQx+C,KAAKmrB,KAAKkhJ,cAAahiJ,EAAA/nB,KAAA,EAClCuL,EAAS,kBAAmB,CAC5CkQ,QAAS6+B,EAAI7+B,QACbqvJ,SAAUxwH,EAAIwwH,SACdqB,OAAAA,IACA,OACO,GALHrlK,EAAGihB,EAAAvoB,KAKT08C,IACKx+C,KAAK8xD,cAAc1oD,GAAM,CAAFihB,EAAA/nB,KAAA,SAEV,OADhBgzD,EAAOj2C,YAAcjW,EAAIwE,IACzBiH,GAAIyE,KAAKg8C,GAAOjrC,EAAApoB,OAAA,kBAGlBjC,KAAKwtK,oBAAoB5wH,EAAIkwH,UAAS,yBAAAziJ,EAAArlB,OAAA,GAAA+kB,EAAA,UACvC,SAAAjc,EAAAC,EAAAM,GAAA,OAAA65J,EAAAt/J,MAAA,KAAAD,UAAA,KAAAhL,IAAA,sBAAAE,MAED,SAAqB++C,GAAyB,IAAArlB,EAAA,KACpCxZ,EAAY6+B,EAAZ7+B,QACFopB,EAAMnnC,KAAKmrB,KAAK6gJ,kBAAkBvgJ,WAAU,GAC5CtL,EAAOtL,GAAI6W,cAAcyb,GACvBpjC,EAAS/D,KAAKqhC,OAAOtjB,GAArBha,KAQR,OAPAoc,EAAKizC,UAAU/zC,YAActb,EAC7B8Q,GAAI1K,KAAKgW,EAAKuuJ,cAAe,SAAS,WACpCn3I,EAAKo3I,aAAa/xH,EAAK,CAAEgyH,SAAS,GAASzuJ,EAAKm1C,OAClD,IACAzgD,GAAI1K,KAAKgW,EAAK0uJ,YAAa,SAAS,WAClCt3I,EAAKo3I,aAAa/xH,EAAK,CAAEgyH,SAAS,GAAQzuJ,EAAKm1C,OACjD,IACOnuB,CACT,GAAC,CAAAxpC,IAAA,iBAAAE,MAED,SAAgB++C,GAAyB,IAAApkB,EAAA,KAC/Bza,EAAqB6+B,EAArB7+B,QACFvX,EADuBo2C,EAAZq4C,QAEX9tD,EAAMnnC,KAAKmrB,KAAK+gJ,aAAazgJ,WAAU,GACvCtL,EAAOtL,GAAI6W,cAAcyb,GACvBpjC,EAAS/D,KAAKqhC,OAAOtjB,GAArBha,KACRoc,EAAKizC,UAAU/zC,YAActb,EAC7Boc,EAAK2uJ,QAAQx2J,YAAYtY,KAAK+uK,cAAcnyH,IAC5C,IAAMoyH,EAAM,SAACC,GACXz2I,EAAKm2I,aAAa/xH,EAAK,CACrB0rB,KAAM9hE,EAAEsvF,GAAG7gF,GACXg6J,KAAAA,GACC9uJ,EAAKm1C,OACV,EAGA,OAFAzgD,GAAI1K,KAAKgW,EAAK+uJ,gBAAiB,SAAS,kBAAMF,GAAI,EAAM,IACxDn6J,GAAI1K,KAAKgW,EAAKgvJ,YAAa,SAAS,kBAAMH,GAAI,EAAK,IAC5C7nI,CACT,GAAC,CAAAxpC,IAAA,kBAAAE,MAED,SAAiB++C,GAAyB,IAAA3iB,EAAA,KAChClc,EAAqB6+B,EAArB7+B,QACFvX,EADuBo2C,EAAZq4C,QAEX9tD,EAAMnnC,KAAKmrB,KAAKghJ,cAAc1gJ,WAAU,GACxCtL,EAAOtL,GAAI6W,cAAcyb,GACvBpjC,EAAS/D,KAAKqhC,OAAOtjB,GAArBha,KAmBR,OAlBAoc,EAAKizC,UAAU/zC,YAActb,EAC7Boc,EAAKivJ,MAAM/vJ,YAAc/V,OAAO9C,EAAE4oK,OAClCjvJ,EAAK2uJ,QAAQx2J,YAAYtY,KAAK+uK,cAAcnyH,IAC5C/nC,GAAI1K,KAAKgW,EAAKkvJ,YAAa,SAAS,WAClCp1I,EAAK00I,aAAa/xH,EAAK,CAAE0rB,KAAM9hE,EAAEsvF,GAAG7gF,GAAIq6J,SAAS,GAAQnvJ,EAAKm1C,OAChE,IACAzgD,GAAI1K,KAAKgW,EAAK+uJ,gBAAiB,SAAS,WACtCj1I,EAAK00I,aAAa/xH,EAAK,CAAE0rB,KAAM9hE,EAAEsvF,GAAG7gF,GAAIq6J,SAAS,GAASnvJ,EAAKm1C,OACjE,IACAzgD,GAAI1K,KAAKgW,EAAKovJ,YAAa,SAAS,WAClC,IAAMC,EAAgBrvJ,EAAKsvJ,QAAQ5xK,MACnC,IAAK2xK,EAGH,OAFArvJ,EAAKsvJ,QAAQ1gJ,aACbla,GAAIg8E,MAAM1wE,EAAKsvJ,SAGjBx1I,EAAK00I,aAAa/xH,EAAK,CAAE0rB,KAAM9hE,EAAEsvF,GAAG7gF,GAAIq6J,SAAS,EAAOE,cAAAA,GAAiBrvJ,EAAKm1C,OAChF,IACOnuB,CACT,GAAC,CAAAxpC,IAAA,uBAAAE,MAED,SAAsB++C,GAAyB,IAAA5d,EAAA,KAC7CtgB,EAA8Ck+B,EAAIq4C,QAA1ChtB,EAAOvpD,EAAPupD,QAASynG,EAAMhxJ,EAANgxJ,OAAQC,EAAOjxJ,EAAPixJ,QAAS5xJ,EAAOW,EAAPX,QAC5BopB,EAAMnnC,KAAKmrB,KAAKykJ,uBAAuBnkJ,WAAU,GACjDtL,EAAOtL,GAAI6W,cAAcyb,GAC/B0oI,EAAwB7vK,KAAKqhC,OAAOtjB,GAA5Bha,EAAI8rK,EAAJ9rK,KAAMioC,EAAK6jI,EAAL7jI,MAWd,OAVA7rB,EAAKizC,UAAU/zC,YAActb,EAC7Boc,EAAKyqB,KAAKvrB,YAAcswJ,EACxBxvJ,EAAKyqB,KAAKrsB,QAAQ6tB,aAAesjI,EACjC/jI,GAAYK,EAAQA,EAAMC,SAAWluB,EAASoC,EAAKyqB,MACnD/1B,GAAI1K,KAAKgW,EAAKuuJ,cAAe,SAAS,WACpC1vI,EAAK2vI,aAAa/xH,EAAK,CAAEqrB,QAAAA,EAASynG,OAAAA,EAAQI,OAAO,GAAS3vJ,EAAKm1C,OACjE,IACAzgD,GAAI1K,KAAKgW,EAAK4vJ,aAAc,SAAS,WACnC/wI,EAAK2vI,aAAa/xH,EAAK,CAAEqrB,QAAAA,EAASynG,OAAAA,EAAQI,OAAO,GAAQ3vJ,EAAKm1C,OAChE,IACOnuB,CACT,GAAC,CAAAxpC,IAAA,sBAAAE,MAED,SAAqBivK,GACnB,IAAQ3hJ,EAA0BnrB,KAA1BmrB,KAAM67I,EAAoBhnK,KAApBgnK,gBACdnyJ,GAAI2E,KAAK2R,EAAKmhJ,uBACd,IAAK,IAAL30J,EAAA,EAAAg2B,EAAgBtwC,OAAO+C,OAAO4mK,GAAgBrvJ,EAAAg2B,EAAApqC,OAAAoU,IAAA,CAAzC,IAAMuC,EAACyzB,EAAAh2B,GAAoCuC,EAAEgT,SAAWhT,EAAE4yJ,WAAaA,CAAQ,CACpFj4J,GAAImD,MAAMmT,EAAKohJ,qBACf,IAAMkC,EAASzH,EAAgB8F,GAC/B3hJ,EAAKohJ,oBAAoBj0J,YAAYm2J,EAAOtnI,KAC5CtyB,GAAIyE,KAAK6R,EAAKkhJ,cACd,IAAMM,EAAU3sK,KAAK4sK,gBACrB,GAAuB,IAAnBD,EAAQppK,OAAZ,CAIAsR,GAAIyE,KAAK6R,EAAK6kJ,kBACd,IAAMrwI,EAAMgtI,EAAQ/tJ,QAAQ6vJ,GAC5BtjJ,EAAK8kJ,cAAc5wJ,YAAc/V,OAAOq2B,EAAM,GAC9CxU,EAAK4hJ,WAAWp0J,UAAUmN,OAAO,YAAqB,IAAR6Z,GAC9CxU,EAAK6hJ,WAAWr0J,UAAUmN,OAAO,YAAa6Z,IAAQgtI,EAAQppK,OAAS,EALvE,MAFEsR,GAAI2E,KAAK2R,EAAK6kJ,iBAQlB,GAEA,CAAAryK,IAAA,uBAAAE,MAIA,SAAsBka,EAAuBkZ,EAAgBC,EAAiB+pC,GAAe,IAS5BlB,EAT4B76B,EAAA,KACrFgxI,EAAW,SAACnyJ,GAChB,IAAMpX,EAAIu4B,EAAKmC,OAAOtjB,GACtB,GAAIpX,EAAG,OAAOA,EACd,IAAKs0D,EAAI,MAAMz5D,MAAM,+BAADuK,OAAgCgS,IACpD,IAAMoyJ,EAAUl1G,EAAG55B,OAAOtjB,GAC1B,MAAO,CAAErJ,SAAUy7J,EAAQz7J,SAAU3Q,KAAMosK,EAAQxxJ,OAAQA,OAAQwxJ,EAAQxxJ,OAC7E,EACAyxJ,EAA8DF,EAASj/I,GAArDzV,EAAG40J,EAAb17J,SAAqB27B,EAAQ+/H,EAAdrsK,KAAwBusC,EAAU8/H,EAAlBzxJ,OAAuCq7C,EAAA3uD,GAC7DwJ,GAAImG,cAAcjD,EAAU,oBAAkB,IAA/D,IAAAiiD,EAAAzuD,MAAAwuD,EAAAC,EAAAxzD,KAAA9E,MAAaq4D,EAAAl8D,MAAuDwhB,YAAcgxB,CAAQ,OAAA3xC,GAAAs7D,EAAApuD,EAAAlN,EAAA,SAAAs7D,EAAAnuD,GAAA,KACzByuD,EADyBC,EAAAlvD,GACxEwJ,GAAImG,cAAcjD,EAAU,qBAAmB,IAAjE,IAAAwiD,EAAAhvD,MAAA+uD,EAAAC,EAAA/zD,KAAA9E,MAAc44D,EAAAz8D,MAAyD4hB,IAAM5K,GAAImK,SAASsxB,EAAW,OAAA5xC,GAAA67D,EAAA3uD,EAAAlN,EAAA,SAAA67D,EAAA1uD,GAAA,KACnC4uD,EADmCC,EAAArvD,GACpFwJ,GAAImG,cAAcjD,EAAU,uBAAqB,IAAlE,IAAA2iD,EAAAnvD,MAAAkvD,EAAAC,EAAAl0D,KAAA9E,MAAa+4D,EAAA58D,MAA0DwhB,YAAc7D,EAAI7G,aAAamI,IAAI,OAAApe,GAAAg8D,EAAA9uD,EAAAlN,EAAA,SAAAg8D,EAAA7uD,GAAA,CAC1G,IACgE8uD,EADhE01G,EAAgEH,EAASh/I,GAAvDzV,EAAG40J,EAAb37J,SAAqBo8B,EAASu/H,EAAftsK,KAAyBgtC,EAAWs/H,EAAnB1xJ,OAAyCi8C,EAAAvvD,GAChEwJ,GAAImG,cAAcjD,EAAU,qBAAmB,IAAhE,IAAA6iD,EAAArvD,MAAAovD,EAAAC,EAAAp0D,KAAA9E,MAAai5D,EAAA98D,MAAwDwhB,YAAcyxB,CAAS,OAAApyC,GAAAk8D,EAAAhvD,EAAAlN,EAAA,SAAAk8D,EAAA/uD,GAAA,KAC1B2zD,EAD0BG,EAAAt0D,GAC1EwJ,GAAImG,cAAcjD,EAAU,sBAAoB,IAAlE,IAAA4nD,EAAAp0D,MAAAi0D,EAAAG,EAAAn5D,KAAA9E,MAAc89D,EAAA3hE,MAA0D4hB,IAAM5K,GAAImK,SAAS+xB,EAAY,OAAAryC,GAAAihE,EAAA/zD,EAAAlN,EAAA,SAAAihE,EAAA9zD,GAAA,KACpC+zD,EADoCC,EAAAx0D,GACtFwJ,GAAImG,cAAcjD,EAAU,wBAAsB,IAAnE,IAAA8nD,EAAAt0D,MAAAq0D,EAAAC,EAAAr5D,KAAA9E,MAAak+D,EAAA/hE,MAA2DwhB,YAAc5D,EAAI9G,aAAamI,IAAI,OAAApe,GAAAmhE,EAAAj0D,EAAAlN,EAAA,SAAAmhE,EAAAh0D,GAAA,CAC7G,GAAC,CAAAlO,IAAA,cAAAE,OAAAoqK,EAAAx/J,EAAAzL,IAAAA,MAED,SAAAmxC,EAAmBx8B,GAAY,OAAA3U,IAAAA,MAAA,SAAAqxC,GAAA,cAAAA,EAAAxpC,KAAAwpC,EAAA/rC,MAAA,cAAA+rC,EAAA/rC,KAAA,EACvBuL,EAAS,iBAAkB8D,GAAK,OACtCzF,OAAOi+F,SAASmG,SAAQ,wBAAAjiE,EAAArpC,OAAA,GAAAmpC,EAAA,KACzB,SAAAzqB,GAAA,OAAAukJ,EAAAr/J,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,MAIA,SAAcglE,EAAmBytG,GAAqB,IAAAvwI,EAAA,KAGpD,GAFAlrB,GAAI2E,KAAKxZ,KAAKmrB,KAAKs+I,QAASzpK,KAAKmrB,KAAKu+I,YACtC70J,GAAIyE,KAAKg3J,GACLpkK,OAAOijI,WAAa,IAAK9xI,OAAOyjI,OAAOwvC,EAAO/1J,MAAO,CAAExE,KAAM,IAAKC,MAAO,IAAKE,IAAK,UAClF,CACH,IAAMq6J,EAAM1tG,EAAKhtD,wBACXG,EAAQ,GAAHjK,OAAMG,OAAOijI,WAAaohC,EAAIx6J,KAAOw6J,EAAIx5J,MAAQ,EAAC,MAC7D1Z,OAAOyjI,OAAOwvC,EAAO/1J,MAAO,CAAExE,KAAM,OAAQC,MAAAA,EAAOE,IAAK,GAAFnK,OAAKwkK,EAAIr6J,IAAM,EAAC,OACxE,CAWA/L,GAAKc,SAAU,SATF,SAAPuO,EAAQ5N,GACPiJ,GAAIk6C,eAAenjD,EAAG0kK,KACzBz7J,GAAI2E,KAAK82J,GACTtnJ,GAAO/d,SAAU,QAASuO,GACtB82J,IAAWvwI,EAAK5U,KAAKs+I,SAAW50J,GAAI82D,YAAY5rC,EAAK5U,KAAKy/I,WAC5D7qI,EAAK8qI,WAGX,GAEF,GAAC,CAAAltK,IAAA,WAAAE,MAED,WACE,IAC6B4jE,EADvB+uG,EAAO,GAAE9uG,EAAAr2D,GACIrL,KAAK6tE,OAAK,IAA7B,IAAAnM,EAAAn2D,MAAAk2D,EAAAC,EAAAl7D,KAAA9E,MAA+B,KAApB0uD,EAAIqR,EAAA5jE,MACTuyD,EAAK+vD,MACP/vD,EAAKp7C,GAAG2D,UAAUM,OAAO,cAEzBm3C,EAAK+vD,OAAQ,EACT/vD,EAAKn7C,IAAMm7C,EAAKqgH,Sf90BR,Ge80B8BD,EAAKxtK,KAAKotD,EAAKn7C,IAE7D,CAAC,OAAAvW,GAAAgjE,EAAA91D,EAAAlN,EAAA,SAAAgjE,EAAA71D,GAAA,CACG2kK,EAAKjtK,QAAQy6G,GAAGvH,QAAQ,WAAY+5D,GACxC37J,GAAI2E,KAAKxZ,KAAKmrB,KAAK8/I,cACrB,GAAC,CAAAttK,IAAA,eAAAE,MAED,SAAc+sK,GACZ,IAAK,IAALxyJ,EAAA,EAAA23D,EAAkB3oE,MAAMI,KAAKojK,EAASlwJ,UAAStC,EAAA23D,EAAAxsE,OAAA6U,IAAoB,CAA9D,IAAMpD,EAAE+6D,EAAA33D,GACXvD,GAAIyJ,aAAatJ,EAAI,kBAAkBqK,YAAcxK,GAAI2nE,UAAUxnE,EAAGo7C,KAAKnK,MAC7E,CACF,GAEA,CAAAtoD,IAAA,yBAAAE,MAIA,SAAwBka,GAAuB,IAAA8rB,EAAA,KACvC6sI,EAAU,IAAIxmE,IAAIh+F,OAAOi+F,SAASh+D,MACxCp0B,EAAS0C,iBAAiB,KAAKla,SAAQ,SAAAoG,GACrC,GAAKA,EAAEwlC,KAAP,CACA,IAAMgwB,EAAM,IAAI+tC,IAAIvjG,EAAEwlC,MACtB,GAAIgwB,EAAIwtG,SAAW+G,EAAQ/G,OAAQ,CACjC,IAAM39H,EAAQmwB,EAAIiuC,SAASvrF,UAAU,GAC/Bu8I,EAAiC,CAAC,EACpCj/F,EAAI4tC,QACN5tC,EAAIy/F,aAAar7J,SAAQ,SAACmL,EAAGD,GAC3B2vJ,EAAO3vJ,GAAKC,CACd,IAEFmJ,GAAI1K,KAAKxD,EAAG,SAAS,SAACiF,GACpBA,EAAE4c,iBACFqb,EAAK+Z,SAAS5R,EAAOovH,EACvB,GACF,CAdmB,CAerB,GACF,GAEA,CAAAz9J,IAAA,yBAAAE,MAIA,WACE,IAAQstB,EAA2BnrB,KAA3BmrB,KAAM2sD,EAAqB93E,KAArB83E,OAAQlqC,EAAa5tC,KAAb4tC,SACtB,GAAKziB,EAAL,CAKA,IAAK2sD,EAGH,OAFA3sD,EAAKu+I,WAAW/wJ,UAAUM,OAAO,eACjCpE,GAAI2E,KAAK2R,EAAKu/I,SAAUv/I,EAAKwlJ,iBAAkBxlJ,EAAKylJ,kBAGtD/7J,GAAIqf,OAAO72B,OAAOkH,KAAKvE,KAAKwnC,WAAWjkC,OAAS,EAAG4nB,EAAKylJ,iBAAkBzlJ,EAAK0lJ,QAE/E1lJ,EAAKu+I,WAAW/wJ,UAAUC,IAAI,UAC9B/D,GAAIyE,KAAK6R,EAAKu/I,SAAUv/I,EAAKwlJ,iBAAkBxlJ,EAAKylJ,kBACpD/7J,GAAIqf,OAAO0Z,EAAUziB,EAAK0lJ,OAV1B,CAWF,GAAC,CAAAlzK,IAAA,aAAAE,OAAAmqK,EAAAv/J,EAAAzL,IAAAA,MAED,SAAAi6C,IAAA,IAAA7tC,EAAA,OAAApM,IAAAA,MAAA,SAAAk6C,GAAA,cAAAA,EAAAryC,KAAAqyC,EAAA50C,MAAA,cAAA40C,EAAA50C,KAAA,EACoB8L,EAAQ,cAAa,OAA9B,GAAHhF,EAAG8tC,EAAAp1C,KACJ9B,KAAK8xD,cAAc1oD,GAAM,CAAF8tC,EAAA50C,KAAA,eAAA40C,EAAAj1C,OAAA,SAAS0Y,QAAQvZ,MAAM,0BAA0BgI,aAAG,EAAHA,EAAKwE,MAAOtE,OAAOF,KAAK,OACrGA,EAAIykE,MAAMnpE,UACV1E,KAAK8wK,SAAS1nK,EAAIykE,OAClB7tE,KAAK+wK,SAAS3nK,EAAI0kE,OAClB9tE,KAAKgxK,qBAAoB,wBAAA95H,EAAAlyC,OAAA,GAAAiyC,EAAA,UAC1B,kBAAA+wH,EAAAp/J,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,eAAAE,MACA,SAAc2tB,GACZxrB,KAAKigG,uBAAuBz0E,EAC9B,GAEA,CAAA7tB,IAAA,kBAAAE,MAGA,SAAiBq+D,EAAiBwzG,EAAgBlmD,GAChD,IACwC7nD,EADLC,EAAAv2D,GAAvBrL,KAAKwnC,UAAU00B,GACJz0B,KAAK+kC,cAAY,IAAxC,IAAA5K,EAAAr2D,MAAAo2D,EAAAC,EAAAp7D,KAAA9E,MAA0C,KAA/B+6D,EAAIkF,EAAA9jE,MAA+B4+D,EAAKizG,SAAWA,IAAQjzG,EAAK+sD,MAAQA,EAAI,CAAC,OAAA9qH,GAAAkjE,EAAAh2D,EAAAlN,EAAA,SAAAkjE,EAAA/1D,GAAA,CAC1F,GAAC,CAAAlO,IAAA,aAAAE,MAED,SAAYypC,EAAc2pI,GACxBjxK,KAAKwnC,UAAUF,GAAMG,KAAKI,IAAIopI,WAAaA,CAC7C,GAEA,CAAAtzK,IAAA,iBAAAE,MAIA,SAAgBuyD,GAEd,OADIA,EAAK3oB,OAAMznC,KAAKwnC,UAAU4oB,EAAKlgB,KAAKzI,KAAO2oB,EAAK3oB,MAC5C2oB,EAAKqC,OACX,IAAK,YACiB,OAAhBrC,EAAKs/G,QACP1vK,KAAKkxK,gBAAgB9gH,EAAKlgB,IAAKkgB,EAAKs/G,OAAQt/G,EAAK+gH,eAEnD,MACF,IAAK,gBACe,OAAd/gH,EAAK8K,MACPl7D,KAAKoxK,WAAWhhH,EAAKlgB,IAAKkgB,EAAK8K,MAMvC,GAEA,CAAAv9D,IAAA,wBAAAE,MAIA,SAAuBkgB,EAAiBqyC,GACtC,IAAM2zC,EAAY/jG,KAAK+mK,aAAahpJ,GACpC,GAAKgmF,EAEL,GAAI3zC,EAAI,IACN2zC,EAAUtU,IAAIkiD,QAAQvhF,EAAK47C,kBAI7B,IAAK,IAAIxoG,EAAI,EAAGA,EAAIugG,EAAUtU,IAAIlsF,OAAQC,IACxC,GAAIugG,EAAUtU,IAAIjsF,GAAGyR,KAAOm7C,EAAK47C,YAAY/2F,GAAI,CAC/C8uF,EAAUtU,IAAIjsF,GAAK4sD,EAAK47C,YACxB,KACF,CAEJ,GAAC,CAAAruG,IAAA,4BAAAE,MAED,SAA2BkgB,UAClB/d,KAAK+mK,aAAahpJ,EAC3B,GAAC,CAAApgB,IAAA,WAAAE,MAED,SAAUgwE,EAAmBC,GAC3B9tE,KAAK8wK,SAASjjG,GACd7tE,KAAK+wK,SAASjjG,GACd9tE,KAAKgxK,oBACP,GAEA,CAAArzK,IAAA,WAAAE,MAIA,SAAUgwE,GACR7tE,KAAKwzC,IAAI,QAAS,WAAYq6B,GAC9B7tE,KAAK6tE,MAAQ,GACbh5D,GAAImD,MAAMhY,KAAKmrB,KAAKy/I,UACpB,IAAK,IAAIpnK,EAAI,EAAGA,EAAIqqE,EAAMtqE,OAAQC,IAChCxD,KAAKqxK,mBAAmBxjG,EAAMrqE,GAElC,GAEA,CAAA7F,IAAA,WAAAE,MAGA,SAAUiwE,GACR9tE,KAAKwzC,IAAI,QAAS,WAAYs6B,GAC9B9tE,KAAK8tE,MAAQ,GACbj5D,GAAImD,MAAMhY,KAAKmrB,KAAKw/I,UACpB,IAAK,IAAInnK,EAAI,EAAGA,EAAIsqE,EAAMvqE,OAAQC,IAChCxD,KAAKsxK,mBAAmBxjG,EAAMtqE,GAElC,GAAC,CAAA7F,IAAA,YAAAE,MAED,SAAWypC,EAAcrW,EAAgBC,GAA0C,IAAAqgJ,EAAAC,EACrCjtG,EADqCE,EAAAp5D,GAC3C,QAD2CkmK,EACjD,QADiDC,EAC9DxxK,KAAK4tC,gBAAQ,IAAA4jI,OAAA,EAAbA,EAAe3jI,YAAI,IAAA0jI,EAAAA,EAAI,IAAE,IAA5C,IAAA9sG,EAAAl5D,MAAAg5D,EAAAE,EAAAj+D,KAAA9E,MAA+C,KAApCwuI,EAAG3rE,EAAA1mE,MACIqiC,EAAMgwG,EAAdziG,OACR,GAAInG,IAASpH,EAAEoH,MAAQrW,IAAWiP,EAAEjP,QAAUC,IAAYgP,EAAEhP,QAC1D,OAAOg/G,CAEX,CAAC,OAAAxxI,GAAA+lE,EAAA74D,EAAAlN,EAAA,SAAA+lE,EAAA54D,GAAA,CACH,GAAC,CAAAlO,IAAA,aAAAE,MAED,SAAYuyD,GACV,IAAQtkB,EAA4B9rC,KAA5B8rC,KAAMzK,EAAsBrhC,KAAtBqhC,OAAQ0W,EAAc/3C,KAAd+3C,UACtB,GAAkB,mBAAdqY,EAAK1wD,MAKT,GAAKosC,EACL,OAAQskB,EAAK1wD,MACX,IAAK,QACH,IAAM+xK,EAAYrhH,EACZpgC,EAAQyhJ,EAAUzhJ,MAClBgZ,EAAM8C,EAAKtE,UAAUxX,EAAMsX,MAAM2O,QAAQjmB,EAAM+Q,QAC/C2wI,EAASD,EAAUC,OAGzB,GAAmB,wBAAfthH,EAAKqC,MAAiC,CACxC,IAAMk/G,EAAW3hJ,EACjB2hJ,EAASD,OAASA,EACb1oI,EAAIyzF,SACJzzF,EAAIyzF,SAASz5H,KAAK2uK,GADJ3oI,EAAIyzF,SAAW,CAACk1C,GAEnC,KACF,CAAO,GAAmB,sBAAfvhH,EAAKqC,MAA+B,CAC7CzpB,EAAIyzF,SAAWzzF,EAAIyzF,SAASnpH,QAAO,SAAA6V,GAAG,OAAIA,EAAIuoJ,SAAWA,CAAM,IAC/D,KACF,CACE,IAAK,IAAMluK,KAAKwlC,EAAIyzF,UAAY,GAC9B,GAAMzzF,EAAIyzF,SAASj5H,GAAGkuK,SAAWA,EAAjC,CACA1oI,EAAIyzF,SAAWzzF,EAAIyzF,SAASnpH,QAAO,SAAA6V,GAAG,OAAIA,EAAIuoJ,SAAWA,CAAM,IAC/D,KAFkD,CAQtD1oI,EAAIqjB,OAASrjB,EAAIqjB,QAAU,GACP,SAACrjB,EAAa7f,GAChC,IAAM3lB,EAAIwlC,EAAIqjB,OAAOy3E,WAAU,SAACj9H,GAAQ,OAAKA,EAAEoO,KAAOkU,EAAIlU,EAAE,IAC5D,OAAW,IAAPzR,IACe,iBAAf4sD,EAAKqC,MAA0BzpB,EAAIqjB,OAAOwN,OAAOr2D,EAAG,GACnDwlC,EAAIqjB,OAAO7oD,GAAK2lB,GACd,EACT,CAKKyoJ,CAAY5oI,EAAKhZ,IAAQgZ,EAAIqjB,OAAOrpD,KAAKgtB,GAC9C,MAEF,IAAK,UACH,IAAMxpB,EAAiB4pD,EACjBnxC,EAAQ6sB,EAAKzK,OAAO76B,EAAEuX,SAE5B,IAAKkB,EAAO,MACZ,IAAMxI,EAAIwI,EAAMmG,OACZ3O,IAAGA,EAAE+hC,QAAUhyC,EAAEgyC,SACrB,MAEF,IAAK,WACHx4C,KAAK6xK,eAAezhH,GACpB,MACF,IAAK,aACH,IAAM5pD,EAAI4pD,EACVpwD,KAAKwnC,UAAUhhC,EAAE8gC,MAAMG,KAAKI,IAAMrhC,EAAEqhC,IACpC,MAEF,IAAK,cACL,IAAK,eAEH,IAAKxG,EAAQ,OACb,IAAMjc,EAAUgrC,aAAI,EAAJA,EAA2BhrC,OAC3C,IAAKA,EAAQ,OACCic,EAAOjc,EAAOrH,SACtBqH,OAASA,EACf2yB,EAAU3yB,EAAOrH,SAAWqH,EAC5B,MAEF,IAAK,aACH,IAAM5e,EAAI4pD,EACJ35C,EAAIzW,KAAK+3C,UAAUvxC,EAAEuX,SACvBtH,IACFA,EAAE64E,WAAa9oF,EAAE8oF,WACjB74E,EAAE+O,OAAS/O,EAAE64E,WAAW9pE,OACxB/O,EAAEgP,aAAejf,EAAEif,cAErB,MAEF,IAAK,QACH,IAAMjf,EAAI4pD,EACJjnC,EAAMnpB,KAAKgwB,MAAMxpB,EAAEyhE,SACrB9+C,GAyiBZ,SAAsB6G,EAAcQ,GAClC,IAAK,IAAMhtB,KAAKwsB,EAAMC,QAEpB,GADUD,EAAMC,QAAQzsB,GAClB8kI,UAAY93G,EAAM83G,QAEtB,YADAt4G,EAAMC,QAAQzsB,GAAKgtB,GAIvBR,EAAMC,QAAUD,EAAMC,SAAW,GACjCD,EAAMC,QAAQjtB,KAAKwtB,EACrB,CAnjBiBshJ,CAAY3oJ,EAAK3iB,EAAEgqB,OAC5B,MAEF,IAAK,OACH,IAAMhqB,EAAI4pD,EACJ6K,EAAKnvB,EAAKtE,UAAUhhC,EAAE8gC,MACxB2zB,IAAIA,EAAGwuD,iBAAmBjjH,EAAEijH,kBAChC,MAEF,IAAK,QACH,IAAMjjH,EAAI4pD,EACJ6K,EAAKnvB,EAAKtE,UAAUhhC,EAAE8gC,MAG5B,IAAK2zB,IAAOA,EAAGhlB,QAAS,MACxB,IAAK,IAALx9B,EAAA,EAAA6E,EAA8BjgB,OAAOkgB,QAAQ/W,EAAEg8G,OAAM/pG,EAAA6E,EAAA/Z,OAAAkV,IAAA,CAAhD,IAAAy1C,EAAAtmD,EAAA0V,EAAA7E,GAAA,GAAOs5J,EAAO7jH,EAAA,GAAE/kB,EAAI+kB,EAAA,GAA8B+M,EAAGhlB,QAAQ87H,GAAS5oI,KAAOA,CAAI,CACtF,MAEF,IAAK,iBACHnpC,KAAK0xC,aAAgB0e,EAAkBu7C,UACvC,MAEF,IAAK,iBACH,IAAMnlG,EAAI4pD,EACVpwD,KAAKitK,UAAUzmK,EAAEyuF,SACjB,MAEF,IAAK,aACH,IAAMzuF,EAAI4pD,EACV,OAAQ5pD,EAAEyuF,QAAQ4W,OAChB,IAAK,cACH,IAAMmmE,EAASxrK,EAAEyuF,QACjBj1F,KAAKiyK,sBAAsBzrK,EAAEyuF,QAAQl3E,QAASi0J,GAC9C,MAEF,IAAK,iBACH,IAAMp1H,EAAMp2C,EAAEyuF,QACdj1F,KAAKitK,UAAUrwH,GACf58C,KAAKktK,cACL,MAEF,IAAK,iBACHltK,KAAKkyK,cAAc1rK,EAAEyuF,SAGD,6BAApBzuF,EAAEyuF,QAAQ4W,OACZ7rG,KAAKmyK,0BAA0B3rK,EAAEyuF,QAAQl3E,SAE3C,MAEF,IAAK,WACH/d,KAAKwzC,IAAI,KAAM,CAAEsvE,SAAU1yD,IAC3B,IAAM5pD,EAAI4pD,EACJ8/E,EAAMlwI,KAAK8tC,UAAUtnC,EAAE8gC,KAAM9gC,EAAEyqB,OAAQzqB,EAAE0qB,SAC3Cg/G,IACFA,EAAIniG,SAAWvnC,EAAEy7C,MACjBiuF,EAAI5qH,QAAU0I,QAAQxnB,EAAEy7C,OACnBz7C,EAAEy7C,QACLiuF,EAAIx4F,iBAAcj2C,EAClByuI,EAAIv4F,iBAAcl2C,IAGtB,MAEF,IAAK,UACH,IAAM+E,EAAI4pD,EACV,GACO,kBADC5pD,EAAEisD,MACR,CACE,IAAMr9B,EAAI5uB,EAAE4pD,KACZpwD,KAAK4tC,SAASyK,MAAM7xC,EAAEwnC,SAASsK,SAASljB,EAAErX,SAAWqX,EAAEojB,OACzD,CAEF,MAEF,IAAK,cACH,IAAMhyC,EAAI4pD,EACJ8/E,EAAMlwI,KAAK8tC,UAAUtnC,EAAE8gC,KAAM9gC,EAAEyqB,OAAQzqB,EAAE0qB,SAC3Cg/G,IAAKA,EAAIx4F,YAAclxC,EAAE+kB,QAC7B,MAEF,IAAK,cACH,IAAM/kB,EAAI4pD,EACJ8/E,EAAMlwI,KAAK8tC,UAAUtnC,EAAE8gC,KAAM9gC,EAAEyqB,OAAQzqB,EAAE0qB,SAC3Cg/G,IAAKA,EAAIv4F,YAAcnxC,EAAE86C,gBA3K/BthD,KAAK0xC,aAAgB0e,EAAkBu7C,SA+K3C,GAEA,CAAAhuG,IAAA,SAAAE,MAIA,SAAQuyD,GAENpwD,KAAKwzC,IAAI,QAAS,SAAU4c,GAC5BpwD,KAAKoyK,WAAWhiH,GAChB,IACuCsa,EADvCC,EAAAt/D,GACqBrL,KAAK8mK,eAAa,IAAvC,IAAAn8F,EAAAp/D,MAAAm/D,EAAAC,EAAAnkE,KAAA9E,MAAyC,KACjCmK,EADS6+D,EAAA7sE,MACEuyD,EAAK1wD,MACtB,GAAKmM,EACL,IACEA,EAAEukD,EACJ,CAAE,MAAOhvD,GACPuZ,QAAQvZ,MAAM,qBAAsBA,EAAM0jC,QAAU1jC,EAAM0jC,QAAU1jC,GACpEuZ,QAAQ64B,IAAI4c,GACZz1C,QAAQ64B,IAAIpyC,EAAMixK,MACpB,CACF,CACA,OAAA3zK,GAAAisE,EAAA/+D,EAAAlN,EAAA,SAAAisE,EAAA9+D,GAAA,CACA,KAAIukD,EAAKqgH,SfrsCO,GeqsChB,CAEA,IAAQnG,EAAsCtqK,KAAtCsqK,UAAWD,EAA2BrqK,KAA3BqqK,WACnB,GAD8CrqK,KAAfowG,WACf,CACd,IAAM/xF,EAAOisJ,EAAU7+I,WAAU,GACjC5W,GAAIi7C,YAAYzxC,EAAM,QAAQgB,YAAc,GAAHtT,OAAMqkD,EAAKsC,QAAO,MAAA3mD,OAAK6hG,GAAex9C,EAAKuC,UACpF,IAAM2/G,EAAYz9J,GAAIi7C,YAAYzxC,EAAM,aAOxC,IfltCc,Ie4sCV+xC,EAAKqgH,SACP57J,GAAI2E,KAAK84J,GACJC,GAAiBD,EAAWliH,EAAKqgH,UACxCpG,EAAW/xJ,YAAY+F,GACvBxJ,GAAIyE,KAAK+wJ,GAEFA,EAAW3vJ,SAASnX,OAAS,GAAG8mK,EAAWvyJ,YAAYuyJ,EAAWxyJ,YACzE0B,WAAU9Q,EAAAzL,IAAAA,MAAC,SAAAohD,IAAA,OAAAphD,IAAAA,MAAA,SAAAuhD,GAAA,cAAAA,EAAA15C,KAAA05C,EAAAj8C,MAAA,cAAAi8C,EAAAj8C,KAAA,EACHuS,GAAIyF,QAAQ,KAAK,SAAC60C,GACtB9wC,EAAK9D,MAAMwhD,QAAUzyD,OAAO,EAAI6lD,EAClC,IAAE,OACF9wC,EAAKpF,SAC8B,IAA/BoxJ,EAAW3vJ,SAASnX,QAAcsR,GAAI2E,KAAK6wJ,GAAW,wBAAA9rH,EAAAv5C,OAAA,GAAAo5C,EAAA,KACzD,IACL,Cf1tCgB,Ie4tCZgS,EAAKqgH,SAAwBzwK,KAAKsxK,mBAAmBlhH,GACpDpwD,KAAKqxK,mBAAmBjhH,GfxlC1B,SAA4BriD,GAAA4gG,GAAA/lG,MAAA,KAAAD,UAAA,Ce2lC/BilG,CAAmBx9C,EA3BkB,CA4BvC,GAEA,CAAAzyD,IAAA,qBAAAE,MAIA,SAAoB4xE,GAClBzvE,KAAK8mK,cAAc9jK,KAAKysE,EAC1B,GAEA,CAAA9xE,IAAA,MAAAE,MAcA,SAAKupK,GAA+B,QAAAoL,EAAAv6J,EAAAtP,UAAApF,OAAVqK,EAAG,IAAAxG,MAAA6Q,EAAA,EAAAA,EAAA,KAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAHvK,EAAGuK,EAAA,GAAAxP,UAAAwP,GACvBnY,KAAKinK,QAAQG,KAAWoL,EAAA73J,SAAQ64B,IAAG5qC,MAAA4pK,EAAA,IAAAzmK,OAAI0mK,KAAW,KAAA1mK,OAAIq7J,EAAQ,OAAAr7J,OAAS6B,IACvE5N,KAAKunK,UAAUH,IACjBpnK,KAAKunK,UAAUH,GAAUpkK,KAAK,CAC5BgjD,KAAMysH,KACN7kK,IAAKA,GAGX,GAAC,CAAAjQ,IAAA,qBAAAE,MAED,SAAoB60K,GAClB,IAAoCC,EAAA/qK,EAAjB5H,KAAK4yK,SAASF,GAAG,GAA7B19J,EAAE29J,EAAA,GAAEviH,EAAIuiH,EAAA,GAEf,IADA3yK,KAAK8tE,MAAM9qE,KAAKotD,GACTpwD,KAAK8tE,MAAMvqE,OArsCA,KAqsCwBvD,KAAK8tE,MAAMvyC,QACrDv7B,KAAK6yK,mBAAmB7yK,KAAKmrB,KAAKw/I,SAAUv6G,EAAMp7C,EACpD,GAAC,CAAArX,IAAA,qBAAAE,MAED,SAAoB60K,GAClB,IAAoCI,EAAAlrK,EAAjB5H,KAAK+yK,SAASL,GAAG,GAA7B19J,EAAE89J,EAAA,GAAE1iH,EAAI0iH,EAAA,GAEf,IADA9yK,KAAK6tE,MAAM7qE,KAAKotD,GACTpwD,KAAK6tE,MAAMtqE,OA5sCA,KA4sCwBvD,KAAK6tE,MAAMtyC,QACrD,IAAMqvI,EAAW5qK,KAAKmrB,KAAKy/I,SAI3B,GAHA5qK,KAAK6yK,mBAAmBjI,EAAUx6G,EAAMp7C,GACxChV,KAAK+1F,gBAAgB/gF,KAEK,IAAtBhV,KAAK6tE,MAAMtqE,QAAiBsR,GAAI82D,YAAY3rE,KAAKmrB,KAAKs+I,UAAY50J,GAAI82D,YAAYi/F,IAAtF,CACA,IAAIoI,EAAU,EACRvC,EAAWzwK,KAAK6tE,MAAMpwD,QAAO,SAAClS,EAAG6kD,GAErC,OADKA,EAAK+vD,OAAO6yD,KACZ5iH,EAAK+vD,OAAS/vD,EAAKqgH,SAAWllK,EAAU6kD,EAAKqgH,SAC3CllK,CACT,Gf1xCkB,Ge2xCZ0nK,EAAKjzK,KAAKmrB,KAAK8/I,cACrBsH,GAAiBU,EAAIxC,GACjBuC,GACFC,EAAG5zJ,YAAc/V,OAAQ0pK,EAAUE,GAAiB,GAAAnnK,OAAOmnK,GAAiB,KAAMF,GAClFn+J,GAAIyE,KAAK25J,IACJp+J,GAAI2E,KAAKy5J,EAZwF,CAa1G,GAAC,CAAAt1K,IAAA,qBAAAE,MAED,SAAoB+sK,EAAuBx6G,EAAoBp7C,GAG7D,IAFAA,EAAGo7C,KAAOA,EACVw6G,EAAStyG,QAAQtjD,GACV41J,EAASlwJ,SAASnX,OAnuCP,KAmuC+BqnK,EAAS9yJ,YAAY8yJ,EAASn5B,WAC/EzxI,KAAKkrK,aAAaN,EACpB,GAEA,CAAAjtK,IAAA,WAAAE,MAIA,SAAUuyD,GACR,IAAMp7C,EAAKhV,KAAKmrB,KAAKo/I,SAAS9+I,WAAU,GACxC,GAAI2kC,EAAKqgH,Sf9yCO,Ee8yCe,CAC7B,IAAM0C,Ef9yCW,Ie8yCL/iH,EAAKqgH,SAA4B,Of7yC5B,Ie6yCqCrgH,EAAKqgH,SAA4B,OAAS,MAChG57J,GAAIyJ,aAAatJ,EAAI,sBAAsB2D,UAAUC,IAAIu6J,EAC3D,CAKA,OAHAt+J,GAAIyJ,aAAatJ,EAAI,oBAAoBqK,YAAc+wC,EAAKsC,QAC5Dk7C,GAAoB/4F,GAAIyJ,aAAatJ,EAAI,oBAAqBo7C,EAAKuC,SAE5D,CAAC39C,EADc24C,GAAA,CAAK34C,GAAAA,GAAOo7C,GAEpC,GAAC,CAAAzyD,IAAA,WAAAE,MAED,SAAUuyD,GACR,IAAMp7C,EAAKhV,KAAKmrB,KAAKq/I,SAAS/+I,WAAU,GAIxC,OAHA5W,GAAIi7C,YAAY96C,EAAI,WAAWqK,YAAc,GAAHtT,OAAMqkD,EAAKsC,QAAO,KAC5Dk7C,GAAoB/4F,GAAIi7C,YAAY96C,EAAI,WAAYo7C,EAAKuC,SAElD,CAAC39C,EADc24C,GAAA,CAAK34C,GAAAA,GAAOo7C,GAEpC,GAEA,CAAAzyD,IAAA,UAAAE,MAKA,SAASmX,GACP,IAAMy1J,EAASzqK,KAAKmrB,KAAKs/I,OAAOh/I,WAAU,GAE1C,OADAzW,EAAGsD,YAAYmyJ,GACR,WAAQA,EAAOxxJ,QAAS,CACjC,GAEA,CAAAtb,IAAA,SAAAE,MAGA,SAAQypC,EAAcyO,GACpB,IAAIsW,EAAkB,GAChBrjB,EAAMhpC,KAAK8rC,KAAKtE,UAAUF,GAAM2O,QAAQF,GAG9C,OAFI/M,EAAIqjB,SAAQA,EAASA,EAAOtgD,OAAOi9B,EAAIqjB,SACvCrjB,EAAIyzF,WAAUpwE,EAASA,EAAOtgD,OAAOi9B,EAAIyzF,WACtCpwE,CACT,GAEA,CAAA1uD,IAAA,mBAAAE,MAIA,SAAkBkgB,GAChB,IAAK,IAALhF,EAAA,EAAA6nD,EAAiBvjE,OAAO+C,OAAOJ,KAAK8rC,KAAKtE,WAAUzuB,EAAA6nD,EAAAr9D,OAAAwV,IAAE,CAAhD,IAAMkiD,EAAE2F,EAAA7nD,GACX,GAAKkiD,EAAGhlB,QACR,IAAK,IAAL54B,EAAA,EAAA0kD,EAAqB1kE,OAAO+C,OAAO66D,EAAGhlB,SAAQ54B,EAAA0kD,EAAAx+D,OAAA8Z,IAAE,CAA3C,IAAM0jB,EAAMghC,EAAA1kD,GACf,GAAK0jB,EAAOsrB,OAAZ,CAA4B,IACGwe,EADHC,EAAAz/D,GACV01B,EAAOsrB,QAAM,IAA/B,IAAAye,EAAAv/D,MAAAs/D,EAAAC,EAAAtkE,KAAA9E,MAAiC,KAAtBynB,EAAG0hD,EAAAhtE,MACZ,IAAKsrB,EAAI8H,SAAWlT,GAAWoL,EAAI+H,UAAYnT,KAC5CoL,EAAI5b,O1B/0Ca,G0B+0CcwiB,GAAiB5G,IAAO,OAAO,CACnE,CAAC,OAAAzqB,GAAAosE,EAAAl/D,EAAAlN,EAAA,SAAAosE,EAAAj/D,GAAA,CAJ2B,CAK9B,CACF,CACA,OAAO,CACT,GAEA,CAAAlO,IAAA,QAAAE,MACA,SAAO2zH,GACL,IAAK,IAALxvG,EAAA,EAAAw7G,EAAiBngI,OAAO+C,OAAOJ,KAAK8rC,KAAKtE,WAAUxlB,EAAAw7G,EAAAj6H,OAAAye,IAAE,CAAhD,IAAMi5C,EAAEuiE,EAAAx7G,GACX,GAAKi5C,GAAOA,EAAGhlB,QACf,IAAK,IAALkQ,EAAA,EAAA66E,EAAqB3jI,OAAO+C,OAAO66D,EAAGhlB,SAAQkQ,EAAA66E,EAAAz9H,OAAA4iD,IAAE,CAA3C,IAAMplB,EAAMigG,EAAA76E,GACf,GAAKplB,EAAOsrB,OAAZ,CAA4B,IACGof,EADHC,EAAArgE,GACV01B,EAAOsrB,QAAM,IAA/B,IAAAqf,EAAAngE,MAAAkgE,EAAAC,EAAAllE,KAAA9E,MAAiC,KAAtBynB,EAAGsiD,EAAA5tE,MACZ,GAAIsrB,EAAIlU,KAAOu8G,EAAK,OAAOroG,CAC7B,CAAC,OAAAzqB,GAAAgtE,EAAA9/D,EAAAlN,EAAA,SAAAgtE,EAAA7/D,GAAA,CAH2B,CAI9B,CACF,CACA,OAAO,IACT,GAEA,CAAAlO,IAAA,qBAAAE,MAKA,SAAoBmyB,GAClB,IACIojJ,EACYA,EAAZpjJ,EAAMP,KAAoBO,EAAMiB,OACjBjB,EAAMkB,QACzB,IAAM9L,EAASplB,KAAK+3C,UAAUq7H,GAC9B,KAAKhuJ,GAL0B,GAKdA,EAAO+vB,QAAkC,OAAO,EACjE,GAAInlB,EAAMC,QACR,IAAK,IAAIzsB,EAAI,EAAGA,GAAiB,QAAhB6vK,EAAGrjJ,EAAMC,eAAO,IAAAojJ,OAAA,EAAbA,EAAe9vK,QAAQC,IAAK,KAAA6vK,EACxC7iJ,EAAQR,EAAMC,QAAQzsB,GAC5B,GAAIgtB,EAAMs8B,MAAQt8B,EAAMs8B,KAAK08D,OAAoC,IAA3Bh5F,EAAMs8B,KAAK08D,MAAMxoG,QAAgBwP,EAAM65G,QAC3E,OAAO,CAEX,CAEF,OAAO,CACT,GAEA,CAAA1sI,IAAA,WAAAE,MAKA,SAAUkgB,EAAiBk9C,GACzB,IAAMq4G,EAAiBtzK,KAAKqhC,OAAOtjB,GACnC,GAAIu1J,EAAgB,OAAOA,EAAe5+J,SAC1C,IAAKumD,IAAOA,EAAG55B,OACb,MAAM7/B,MAAM+a,G/B30C+B,iC+B20CmB,CAAEwB,QAAS,GAAFhS,OAAKgS,MAE9E,OAAOk9C,EAAG55B,OAAOtjB,GAASrJ,QAC5B,GAAC,CAAA/W,IAAA,cAAAE,MAED,SAAakgB,GACX,IAAMkB,EAAQjf,KAAKqhC,OAAOtjB,GAC1B,OAAKkB,EAAM+sB,MACJhsC,KAAKqhC,OAAOpiB,EAAM+sB,MAAMC,UADNhtB,CAE3B,GAEA,CAAAthB,IAAA,kBAAAE,MAIA,SAAiBkgB,GACf,IAAMkB,EAAQjf,KAAK8rC,KAAKzK,OAAOtjB,GAC/B,OAAOkB,EAAM+sB,MAAQhsC,KAAK8rC,KAAKzK,OAAOpiB,EAAM+sB,MAAMC,UAAUttB,OAASM,EAAMN,MAC7E,GAEA,CAAAhhB,IAAA,kBAAAE,MAIA,SAAiBkgB,GAAiB,IAAAw1J,EAChC,OAAoC,QAApCA,EAAOvzK,KAAK8rC,KAAK8mD,2BAAmB,IAAA2gF,OAAA,EAA7BA,EAA+BC,kBAAkBxzK,KAAKyzK,gBAAgB11J,GAC/E,GAEA,CAAApgB,IAAA,mBAAAE,MACA,SAAkBozB,EAAgBC,EAAiB3V,EAAiB0/C,GAClE,IAAAr4B,EAAe,CAAC5iC,KAAK0U,SAASuc,EAAQgqC,GAAKj7D,KAAK0U,SAASwc,EAAS+pC,IAAxDiyD,EAACtqF,EAAA,GAGX,OAAOrnB,GAHCqnB,EAAA,GAEIjuB,aAAaC,iBAAmBs4G,EAAEv4G,aAAaC,kBACtC7B,EACvB,GAAC,CAAApV,IAAA,mBAAAE,MAED,SAAkBkgB,EAAiBmzC,GACjC,IAAMjyC,EAAQjf,KAAKqhC,OAAOtjB,GAC1B,GAAIkB,EAAM+sB,MAAO,OAAO/sB,EAAM+sB,MAAMplC,WACpC,IAAKqY,EAAM7c,KAAM,MAAMZ,MAAM,4BAC7B,MAAmB,KAAf0vD,EAA0BjyC,EAAM7c,KAAKoxD,iBAAiBv0C,EAAM7c,KAAKsxK,UAC9Dz0J,EAAM7c,KAAKoxD,iBAAiBlgD,QAAO,SAAAqgK,GAAG,OAAIA,EAAIj0K,OAASwxD,CAAU,IAAE,EAC5E,GAAC,CAAAvzD,IAAA,0BAAAE,MAED,SAAyBkgB,GACvB,IAAMkB,EAAQjf,KAAKqhC,OAAOtjB,GAC1B,OAAIkB,EAAM+sB,MACD/sB,EAAM+sB,MAAMplC,WAEd5G,KAAKkvF,iBAAiBnxE,EAAS/d,KAAKqhC,OAAOtjB,GAASqH,OAAO1lB,KACpE,GAEA,CAAA/B,IAAA,eAAAE,OAAAkqK,EAAAt/J,EAAAzL,IAAAA,MAKA,SAAA0hD,EAAoB3gC,GAAe,IAAA3U,EAAA,OAAApM,IAAAA,MAAA,SAAA2hD,GAAA,cAAAA,EAAA95C,KAAA85C,EAAAr8C,MAAA,cAAAq8C,EAAAr8C,KAAA,EACEuL,EAAS,eAAgB,CAAEkQ,QAASA,IAAU,OAAvD,GAApB3U,EAAoBu1C,EAAA78C,KACrB9B,KAAK8xD,cAAc1oD,GAAM,CAAFu1C,EAAAr8C,KAAA,cACpB,IAAId,MAAM,wCAADuK,OAAyCgS,IAAU,cAAA4gC,EAAA18C,OAAA,SAE7DmH,EAAIovC,SAAO,wBAAAmG,EAAA35C,OAAA,GAAA05C,EAAA,UACnB,SAAAj4B,GAAA,OAAAshJ,EAAAn/J,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,gBAAAE,MAKA,SAAe0qF,GACb,OAAQA,EAAK96E,mBAAqB86E,EAAKd,EACzC,GAEA,CAAA9pF,IAAA,UAAAE,OAAAiqK,EAAAr/J,EAAAzL,IAAAA,MAKA,SAAAkiD,IAAA,IAAA91C,EAAA,OAAApM,IAAAA,MAAA,SAAA2iD,GAAA,cAAAA,EAAA96C,KAAA86C,EAAAr9C,MAAA,cAAAq9C,EAAAr9C,KAAA,EACoBuL,EAAS,eAAc,OAAhC,GAAHzE,EAAGu2C,EAAA79C,KACJ9B,KAAK8xD,cAAc1oD,GAAM,CAAFu2C,EAAAr9C,KAAA,QAMG,OALzB8G,EAAIu6D,OAAS90D,EAAOg9E,gBACtB7rF,KAAKmrB,KAAKigJ,UAAU/rJ,YAAc9C,G/Bt6CK,gC+Bw6CvCvc,KAAKmrB,KAAKigJ,UAAU/rJ,YAAcjW,EAAIwE,IAExCiH,GAAIyE,KAAKtZ,KAAKmrB,KAAKigJ,WAAUzrH,EAAA19C,OAAA,iBAG/BwI,EAAMmpK,aAAanpK,EAAMopK,QACzBppK,EAAMmpK,aAAanpK,EAAMqpK,SACzBrpK,EAAM8H,YAAY9H,EAAMspK,iBACxB7nK,OAAOi+F,SAASh+D,KAAO,SAAQ,yBAAAwT,EAAA36C,OAAA,GAAAk6C,EAAA,UAChC,kBAAA4oH,EAAAl/J,MAAA,KAAAD,UAAA,IAED,CAAAhL,IAAA,YAAAE,OAAAgqK,EAAAp/J,EAAAzL,IAAAA,MAOA,SAAAkmE,EAAiBnlD,EAAiBvX,EAAWgyD,GAAc,IAAA2D,EAAA63G,EAAA5qK,EAAA6qK,EAAAxkF,EAAAqU,EAAAowE,EAAAC,EAAA3wK,EAAA4wK,EAAAC,EAAAC,EAAA,OAAAt3K,IAAAA,MAAA,SAAAo/D,GAAA,cAAAA,EAAAv3D,KAAAu3D,EAAA95D,MAAA,OAEP,GAD5C65D,EAAM,iBACN63G,EAAkBh0K,KAAK+mK,aAAahpJ,GACpB,CAAFq+C,EAAA95D,KAAA,gBAAA85D,EAAA95D,KAAA,EACAuL,EAASsuD,EAAK,CAC9B31D,EACAuX,QAASA,IACT,OAHO,GAAH3U,EAAGgzD,EAAAt6D,KAIJ9B,KAAK8xD,cAAc1oD,GAAM,CAAFgzD,EAAA95D,KAAA,cACpB,IAAId,MAAM4H,EAAIwE,KAAI,OASzB,OAPG6hF,EAA+CrmF,EAAIqmF,OAErDA,EAAM,IAERzvF,KAAK+mK,aAAahpJ,GAAW,CAC3B0xE,IAAKA,EACLqU,OAAQrU,EAAIlsF,OAASiD,GACtB41D,EAAAn6D,OAAA,SACMjC,KAAK+mK,aAAahpJ,IAAQ,QAIoD,GAFjF0xE,EAA4B,GAC9BqU,GAAS,EACPowE,EAAa17G,EAAQw7G,EAAgBvkF,IAAIq0C,WAAU,SAAAhuC,GAAE,OAAIA,EAAG7gF,KAAOujD,CAAK,IAAI,EAAI,GAClFA,IAAyB,IAAhB07G,EAAiB,CAAA93G,EAAA95D,KAAA,eACtB,IAAId,MAAM,oBAAsBg3D,GAAM,QAG9C,IADI27G,EAAYD,EACP1wK,EAAI0wK,EAAY1wK,EAAIwwK,EAAgBvkF,IAAIlsF,QAAUksF,EAAIlsF,OAASiD,EAAGhD,IACzEisF,EAAIzsF,KAAKgxK,EAAgBvkF,IAAIjsF,IAC7B2wK,EAAY3wK,EACZg1D,EAAQw7G,EAAgBvkF,IAAIjsF,GAAGyR,GAIhC,GAFG++J,EAAgBlwE,QAAUqwE,IAAcH,EAAgBvkF,IAAIlsF,OAAS,IACvEugG,GAAS,KAEPrU,EAAIlsF,OAASiD,IAAMwtK,EAAgBlwE,OAAM,CAAA1nC,EAAA95D,KAAA,gBAAA85D,EAAA95D,KAAA,GACzBuL,EAASsuD,EAAK,CAC9B31D,EAAGA,EAAIipF,EAAIlsF,OAAS,EACpBwa,QAASA,EACTi/I,MAAOxkG,EACP+7G,MAAM,IACN,QALO,GAAHnrK,EAAGgzD,EAAAt6D,KAMJ9B,KAAK8xD,cAAc1oD,GAAM,CAAFgzD,EAAA95D,KAAA,eACpB,IAAId,MAAM4H,EAAIwE,KAAI,SAEtB0mK,EAAkDlrK,EAAIqmF,OAExD6kF,EAAS,IAEPA,EAAO/wK,OAAS,GAAKi1D,IACnB87G,EAAO,GAAGr/J,KAAOujD,EACnB87G,EAAO/4I,QAGP5gB,QAAQvZ,MAAM,sCAGlB4yK,EAAgBlwE,OAASwwE,EAAO/wK,OAASiD,EAAIipF,EAAIlsF,OACjDugG,EAASkwE,EAAgBlwE,OACzBrU,EAAIzsF,KAAI4F,MAAR6mF,EAAG/nF,EAAS4sK,KACZF,EAAAJ,EAAgBvkF,KAAIzsF,KAAI4F,MAAAwrK,EAAA1sK,EAAI4sK,IAAO,eAAAl4G,EAAAn6D,OAAA,SAE9B,CAAEwtF,IAAAA,EAAKqU,OAAAA,IAAQ,yBAAA1nC,EAAAp3D,OAAA,GAAAk+D,EAAA,UACvB,SAAAx5C,EAAAC,EAAAC,GAAA,OAAAi+I,EAAAj/J,MAAA,KAAAD,UAAA,KAAAhL,IAAA,cAAAE,MAED,SAAakgB,EAAiBuqD,GAC5B,IAAM0rG,EAAkBh0K,KAAK+mK,aAAahpJ,GAC1C,GAAKi2J,EACL,OAAOA,EAAgBvkF,IAAI/6C,MAAK,SAAAohD,GAAE,OAAIA,EAAG7gF,KAAOqzD,CAAI,GACtD,GAAC,CAAA3qE,IAAA,iBAAAE,MAED,SAAgBkgB,UACP/d,KAAK+mK,aAAahpJ,EAC3B,GAAC,CAAApgB,IAAA,sBAAAE,OAAA+pK,EAAAn/J,EAAAzL,IAAAA,MAED,SAAA0mE,EAA2B3lD,GAAe,IAAAy2J,EAAAC,EAAAC,EAAAxoI,EAAAz1B,EAAArN,EAAA2xJ,EAAA,OAAA/9J,IAAAA,MAAA,SAAAomE,GAAA,cAAAA,EAAAv+D,KAAAu+D,EAAA9gE,MAAA,OAC4B,GAA9D4pC,EAAmD,QAAxCsoI,EAAuB,QAAvBC,EAAGz0K,KAAKqhC,OAAOtjB,UAAQ,IAAA02J,GAAO,QAAPC,EAApBD,EAAsBzoI,aAAK,IAAA0oI,OAAP,EAApBA,EAA6BzoI,gBAAQ,IAAAuoI,EAAAA,EAAIz2J,EAC3C,CAAFqlD,EAAA9gE,KAAA,eAAA8gE,EAAAnhE,OAAA,UAAS,GAAK,OACO,GAA/BwU,EAAIzW,KAAK+3C,UAAU7L,GACjB,CAAFk3B,EAAA9gE,KAAA,eAAA8gE,EAAAnhE,OAAA,UAAS,GAAK,OACc,GAAP,MACtBwU,EAAE0+B,OAAkC,CAAAiuB,EAAA9gE,KAAA,eAAA8gE,EAAAnhE,OAAA,UAAS,GAAK,cAAAmhE,EAAA9gE,KAAA,GACrCuL,EAAS,sBAAuB,CAAEkQ,QAASmuB,IAAc,QAAlE,GAAH9iC,EAAGg6D,EAAAthE,KACJ9B,KAAK8xD,cAAc1oD,GAAM,CAAFg6D,EAAA9gE,KAAA,SACJ,OAAtBqY,QAAQvZ,MAAMgI,EAAIwE,KAAIw1D,EAAAnhE,OAAA,UACf,GAAK,QAEU,OAAlB84J,EAAW3xJ,EAAImoD,IAAG6R,EAAAnhE,OAAA,UAChB84J,EAAS4Z,WAAS,yBAAAvxG,EAAAp+D,OAAA,GAAA0+D,EAAA,UAC3B,SAAA75C,GAAA,OAAA+9I,EAAAh/J,MAAA,KAAAD,UAAA,MAAAi+J,CAAA,CAv8C6B,GAo9C1BgO,IAAwC9qK,EAAA+qK,GAAG,CAAC,EfpmD3B,EeqmDL,QAAM/qK,EAAA+qK,GfnmDH,EeomDL,OAAK/qK,EAAA+qK,GfrmDE,EesmDL,QAAMA,IAIxB,SAAStM,GAAiB3hF,GACxB,OAAOA,EAAKz0E,QAAQ,MAAO,IAAI7G,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,EACxE,CAGA,SAASmnK,KACP,IAAMxsH,EAAQ,IAAIr7C,KACZ+L,EAAIsvC,EAAM7jB,WAAW76B,WAAWoZ,SAAS,EAAG,KAC5CD,EAAIulC,EAAM5jB,aAAa96B,WAAWoZ,SAAS,EAAG,KAC9CpV,EAAI06C,EAAM6uH,aAAavtK,WAAWoZ,SAAS,EAAG,KAC9CJ,EAAK0lC,EAAM8uH,kBAAkBxtK,WAAWoZ,SAAS,EAAG,KAC1D,MAAO,GAAP5U,OAAU4K,EAAC,KAAA5K,OAAI2U,EAAC,KAAA3U,OAAIR,EAAC,KAAAQ,OAAIwU,EAC3B,CAEA,SAASgyJ,GAAkBv9J,EAAiBy7J,GAC1Cz7J,EAAG2D,UAAUM,OAAO,MAAO,OAAQ,QACnCjE,EAAG2D,UAAUC,IAAIg8J,GAAiBnE,GACpC,CChoDA,IAAMxlJ,GAAM,IAAI27I,G9B8yCdp8I,G8B7yCkBS,GACpBA,GAAInI","sources":["webpack://bisonw/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/typeof.js","webpack://bisonw/./node_modules/@babel/runtime/regenerator/index.js","webpack://bisonw/webpack/bootstrap","webpack://bisonw/webpack/runtime/compat get default export","webpack://bisonw/webpack/runtime/define property getters","webpack://bisonw/webpack/runtime/hasOwnProperty shorthand","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://bisonw/./src/js/state.ts","webpack://bisonw/./src/js/http.ts","webpack://bisonw/./src/js/locales.ts","webpack://bisonw/./src/js/doc.ts","webpack://bisonw/./src/js/registry.ts","webpack://bisonw/./src/js/opts.ts","webpack://bisonw/./src/js/basepage.ts","webpack://bisonw/./src/js/orderutil.ts","webpack://bisonw/./src/js/charts.ts","webpack://bisonw/./src/js/account.ts","webpack://bisonw/./src/js/coinexplorers.ts","webpack://bisonw/./src/js/mmutil.ts","webpack://bisonw/./src/js/forms.ts","webpack://bisonw/./src/js/register.ts","webpack://bisonw/./src/js/login.ts","webpack://bisonw/./src/js/wallets.ts","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://bisonw/./src/js/notifications.ts","webpack://bisonw/./src/js/settings.ts","webpack://bisonw/./src/js/orderbook.ts","webpack://bisonw/./src/js/ws.ts","webpack://bisonw/./src/js/markets.ts","webpack://bisonw/./src/js/orders.ts","webpack://bisonw/./src/js/order.ts","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/get.js","webpack://bisonw/./node_modules/@babel/runtime/helpers/esm/superPropBase.js","webpack://bisonw/./src/js/mm.ts","webpack://bisonw/./src/js/mmsettings.ts","webpack://bisonw/./src/js/dexsettings.ts","webpack://bisonw/./src/js/mmarchives.ts","webpack://bisonw/./src/js/mmlogs.ts","webpack://bisonw/./src/js/init.ts","webpack://bisonw/./src/js/app.ts","webpack://bisonw/./src/index.ts"],"sourcesContent":["var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method,\n      method = delegate.iterator[methodName];\n    if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel;\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) keys.push(key);\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i[\"return\"] && (_r = _i[\"return\"](), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return assertThisInitialized(self);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","// State is a set of static methods for working with the user state. It has\n// utilities for setting and retrieving cookies and storing user configuration\n// to localStorage.\nexport default class State {\n  // Cookie keys.\n  static darkModeLK = 'darkMode'\n  static authCK = 'dexauth'\n  static pwKeyCK = 'sessionkey'\n  // Local storage keys (for data that we don't need at the server).\n  static popupsLK = 'popups'\n  static loggersLK = 'loggers'\n  static recordersLK = 'recorders'\n  static lastMarketLK = 'selectedMarket'\n  static depthZoomLK = 'depthZoom'\n  static lastMMMarketLK = 'mmMarket'\n  static optionsExpansionLK = 'mmOptsExpand'\n  static leftMarketDockLK = 'leftmarketdock'\n  static selectedAssetLK = 'selectedasset'\n  static notificationsLK = 'notifications' // DEPRECATED before v1\n  static orderDisclaimerAckedLK = 'ordAck'\n  static lastCandleDurationLK = 'lastCandleDuration'\n  static localeSpecsKey = 'localeSpecsLK'\n  static localeKey = 'localeLK'\n\n  static setCookie (cname: string, cvalue: string) {\n    const d = new Date()\n    // Set cookie to expire in ten years.\n    d.setTime(d.getTime() + (86400 * 365 * 10 * 1000))\n    const expires = 'expires=' + d.toUTCString()\n    document.cookie = cname + '=' + cvalue + ';' + expires + ';path=/'\n  }\n\n  /*\n   * getCookie returns the value at the specified cookie name, otherwise null.\n   */\n  static getCookie (cname: string) {\n    for (const cstr of document.cookie.split(';')) {\n      const [k, v] = cstr.split('=')\n      if (k.trim() === cname) return v\n    }\n    return null\n  }\n\n  /*\n   * removeCookie tells the browser to stop using cookie. It's not enough to simply\n   * erase cookie value because browser will still send it to the server (with empty\n   * value), and that's not what server expects.\n   */\n  static removeCookie (cKey: string) {\n    document.cookie = `${cKey}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;`\n  }\n\n  /*\n   * isDark returns true if the dark-mode cookie is currently set to '1' = true.\n   */\n  static isDark (): boolean {\n    return State.fetchLocal(State.darkModeLK) === '1'\n  }\n\n  /* storeLocal puts the key-value pair into Window.localStorage. */\n  static storeLocal (k: string, v: any) {\n    window.localStorage.setItem(k, JSON.stringify(v))\n  }\n\n  /*\n  * fetchLocal the value associated with the key in Window.localStorage, or\n  * null if the no value exists for the key.\n  */\n  static fetchLocal (k: string) {\n    const v = window.localStorage.getItem(k)\n    if (v !== null) {\n      return JSON.parse(v)\n    }\n    return null\n  }\n\n  /* removeLocal removes the key-value pair from Window.localStorage. */\n  static removeLocal (k: string) {\n    window.localStorage.removeItem(k)\n  }\n}\n\n// Setting defaults here, unless specific cookie (or local storage) value was already chosen by the user.\nif (State.fetchLocal(State.darkModeLK) === null) State.storeLocal(State.darkModeLK, '1')\nif (State.fetchLocal(State.popupsLK) === null) State.storeLocal(State.popupsLK, '1')\nif (State.fetchLocal(State.leftMarketDockLK) === null) State.storeLocal(State.leftMarketDockLK, '1')\n","/*\n * requestJSON encodes the object and sends the JSON to the specified address.\n */\nexport async function requestJSON (method: string, addr: string, reqBody?: any): Promise<any> {\n  try {\n    const response = await window.fetch(addr, {\n      method: method,\n      headers: new window.Headers({ 'content-type': 'application/json' }),\n      // credentials: \"same-origin\",\n      body: reqBody\n    })\n    if (response.status !== 200) { throw response }\n    const obj = await response.json()\n    obj.requestSuccessful = true\n    return obj\n  } catch (response) {\n    response.requestSuccessful = false\n    response.msg = await response.text()\n    return response\n  }\n}\n\n/*\n * postJSON sends a POST request with JSON-formatted data and returns the\n * response.\n */\nexport async function postJSON (addr: string, data?: any) {\n  return requestJSON('POST', addr, JSON.stringify(data))\n}\n\n/*\n * getJSON sends a GET request and returns the response.\n */\nexport async function getJSON (addr: string): Promise<any> {\n  return requestJSON('GET', addr)\n}\n\nexport enum Errors {\n  walletErr,\n  walletAuthErr,\n  walletBalanceErr,\n  dupeDEXErr,\n  assetSupportErr,\n  registerErr,\n  signatureErr,\n  zeroFeeErr,\n  feeMismatchErr,\n  feeSendErr,\n  passwordErr,\n  emptyHostErr,\n  connectionErr,\n  acctKeyErr,\n  unknownOrderErr,\n  orderParamsErr,\n  dbErr,\n  authErr,\n  connectWalletErr,\n  missingWalletErr,\n  encryptionErr,\n  decodeErr,\n  accountVerificationErr,\n  accountProofErr,\n  parseKeyErr,\n  marketErr,\n  addressParseErr,\n  addrErr,\n  fileReadErr,\n  unknownDEXErr,\n  accountRetrieveErr,\n  accountDisableErr,\n  suspendedAcctErr,\n  existenceCheckErr,\n  createWalletErr,\n  activeOrdersErr,\n  newAddrErr,\n}\n","import State from './state'\nimport { postJSON } from './http'\n\ntype Locale = Record<string, string>\n\nexport const ID_NO_PASS_ERROR_MSG = 'NO_PASS_ERROR_MSG'\nexport const ID_NO_APP_PASS_ERROR_MSG = 'NO_APP_PASS_ERROR_MSG'\nexport const ID_SET_BUTTON_BUY = 'SET_BUTTON_BUY'\nexport const ID_SET_BUTTON_SELL = 'SET_BUTTON_SELL'\nexport const ID_OFF = 'OFF'\nexport const ID_MAX = 'MAX'\nexport const ID_READY = 'READY'\nexport const ID_NO_WALLET = 'NO_WALLET'\nexport const ID_DISABLED_MSG = 'DISABLED_MSG'\nexport const ID_WALLET_SYNC_PROGRESS = 'WALLET_SYNC_PROGRESS'\nexport const ID_HIDE_ADDITIONAL_SETTINGS = 'HIDE_ADDITIONAL_SETTINGS'\nexport const ID_SHOW_ADDITIONAL_SETTINGS = 'SHOW_ADDITIONAL_SETTINGS'\nexport const ID_BUY = 'BUY'\nexport const ID_SELL = 'SELL'\nexport const ID_NOT_SUPPORTED = 'NOT_SUPPORTED'\nexport const ID_VERSION_NOT_SUPPORTED = 'VERSION_NOT_SUPPORTED'\nexport const ID_CONNECTION_FAILED = 'CONNECTION_FAILED'\nexport const ID_ORDER_PREVIEW = 'ORDER_PREVIEW'\nexport const ID_CALCULATING = 'CALCULATING'\nexport const ID_ESTIMATE_UNAVAILABLE = 'ESTIMATE_UNAVAILABLE'\nexport const ID_NO_ZERO_RATE = 'NO_ZERO_RATE'\nexport const ID_NO_ZERO_QUANTITY = 'NO_ZERO_QUANTITY'\nexport const ID_TRADE = 'TRADE'\nexport const ID_NO_ASSET_WALLET = 'NO_ASSET_WALLET'\nexport const ID_EXECUTED = 'EXECUTED'\nexport const ID_BOOKED = 'BOOKED'\nexport const ID_CANCELING = 'CANCELING'\nexport const ID_PASSWORD_NOT_MATCH = 'PASSWORD_NOT_MATCH'\nexport const ID_ACCT_UNDEFINED = 'ACCT_UNDEFINED'\nexport const ID_KEEP_WALLET_PASS = 'KEEP_WALLET_PASS'\nexport const ID_NEW_WALLET_PASS = 'NEW_WALLET_PASS'\nexport const ID_LOT = 'LOT'\nexport const ID_LOTS = 'LOTS'\nexport const ID_UNKNOWN = 'UNKNOWN'\nexport const ID_EPOCH = 'EPOCH'\nexport const ID_ORDER_SUBMITTING = 'ORDER_SUBMITTING'\nexport const ID_SETTLING = 'SETTLING'\nexport const ID_NO_MATCH = 'NO_MATCH'\nexport const ID_CANCELED = 'CANCELED'\nexport const ID_REVOKED = 'REVOKED'\nexport const ID_WAITING_FOR_CONFS = 'WAITING_FOR_CONFS'\nexport const ID_NONE_SELECTED = 'NONE_SELECTED'\nexport const ID_REGISTRATION_FEE_SUCCESS = 'REGISTRATION_FEE_SUCCESS'\nexport const ID_API_ERROR = 'API_ERROR'\nexport const ID_ADD = 'ADD'\nexport const ID_CREATE = 'CREATE'\nexport const ID_SETUP_WALLET = 'SETUP_WALLET'\nexport const ID_WALLET_READY = 'WALLET_READY'\nexport const ID_CHANGE_WALLET_TYPE = 'CHANGE_WALLET_TYPE'\nexport const ID_KEEP_WALLET_TYPE = 'KEEP_WALLET_TYPE'\nexport const ID_WALLET_PENDING = 'WALLET_PENDING'\nexport const ID_SETUP_NEEDED = 'SETUP_NEEDED'\nexport const ID_SEND_SUCCESS = 'SEND_SUCCESS'\nexport const ID_RECONFIG_SUCCESS = 'RECONFIG_SUCCESS'\nexport const ID_RESCAN_STARTED = 'RESCAN_STARTED'\nexport const ID_NEW_WALLET_SUCCESS = 'NEW_WALLET_SUCCESS'\nexport const ID_WALLET_UNLOCKED = 'WALLET_UNLOCKED'\nexport const ID_SELLING = 'SELLING'\nexport const ID_BUYING = 'BUYING'\nexport const ID_WALLET_DISABLED_MSG = 'WALLET_DISABLED'\nexport const ID_WALLET_ENABLED_MSG = 'WALLET_ENABLED'\nexport const ID_ACTIVE_ORDERS_ERR_MSG = 'ACTIVE_ORDERS_ERR_MSG'\nexport const ID_AVAILABLE = 'AVAILABLE'\nexport const ID_LOCKED = 'LOCKED'\nexport const ID_IMMATURE = 'IMMATURE'\nexport const ID_FEE_BALANCE = 'FEE_BALANCE'\nexport const ID_CANDLES_LOADING = 'CANDLES_LOADING'\nexport const ID_DEPTH_LOADING = 'DEPTH_LOADING'\nexport const ID_INVALID_ADDRESS_MSG = 'INVALID_ADDRESS_MSG'\nexport const ID_TXFEE_UNSUPPORTED = 'TXFEE_UNSUPPORTED'\nexport const ID_TXFEE_ERR_MSG = 'TXFEE_ERR_MSG'\nexport const ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG = 'ACTIVE_ORDERS_LOGOUT_ERR_MSG'\nexport const ID_INVALID_DATE_ERR_MSG = 'INVALID_DATE_ERR_MSG'\nexport const ID_NO_ARCHIVED_RECORDS = 'NO_ARCHIVED_RECORDS'\nexport const ID_DELETE_ARCHIVED_RECORDS_RESULT = 'DELETE_ARCHIVED_RECORDS_RESULT'\nexport const ID_ARCHIVED_RECORDS_PATH = 'ARCHIVED_RECORDS_PATH'\nexport const ID_DEFAULT = 'DEFAULT'\nexport const ID_ADDED = 'ADDED'\nexport const ID_DISCOVERED = 'DISCOVERED'\nexport const ID_UNSUPPORTED_ASSET_INFO_ERR_MSG = 'UNSUPPORTED_ASSET_INFO_ERR_MSG'\nexport const ID_LIMIT_ORDER = 'LIMIT_ORDER'\nexport const ID_LIMIT_ORDER_IMMEDIATE_TIF = 'LIMIT_ORDER_IMMEDIATE_TIF'\nexport const ID_MARKET_ORDER = 'MARKET_ORDER'\nexport const ID_CANCEL_ORDER = 'CANCEL_ORDER'\nexport const ID_MATCH_STATUS_NEWLY_MATCHED = 'MATCH_STATUS_NEWLY_MATCHED'\nexport const ID_MATCH_STATUS_MAKER_SWAP_CAST = 'MATCH_STATUS_MAKER_SWAP_CAST'\nexport const ID_MATCH_STATUS_TAKER_SWAP_CAST = 'MATCH_STATUS_TAKER_SWAP_CAST'\nexport const ID_MATCH_STATUS_MAKER_REDEEMED = 'MATCH_STATUS_MAKER_REDEEMED'\nexport const ID_MATCH_STATUS_REDEMPTION_SENT = 'MATCH_STATUS_REDEMPTION_SENT'\nexport const ID_MATCH_STATUS_REDEMPTION_CONFIRMED = 'MATCH_REDEMPTION_CONFIRMED'\nexport const ID_MATCH_STATUS_REVOKED = 'MATCH_STATUS_REVOKED'\nexport const ID_MATCH_STATUS_REFUNDED = 'MATCH_STATUS_REFUNDED'\nexport const ID_MATCH_STATUS_REFUND_PENDING = 'MATCH_STATUS_REFUND_PENDING'\nexport const ID_MATCH_STATUS_REDEEM_PENDING = 'MATCH_STATUS_REDEEM_PENDING'\nexport const ID_MATCH_STATUS_COMPLETE = 'MATCH_STATUS_COMPLETE'\nexport const ID_TAKER_FOUND_MAKER_REDEMPTION = 'TAKER_FOUND_MAKER_REDEMPTION'\nexport const ID_OPEN_WALLET_ERR_MSG = 'OPEN_WALLET_ERR_MSG'\nexport const ID_ORDER_ACCELERATION_FEE_ERR_MSG = 'ORDER_ACCELERATION_FEE_ERR_MSG'\nexport const ID_ORDER_ACCELERATION_ERR_MSG = 'ORDER_ACCELERATION_ERR_MSG'\nexport const ID_CONNECTED = 'CONNECTED'\nexport const ID_DISCONNECTED = 'DISCONNECTED'\nexport const ID_INVALID_CERTIFICATE = 'INVALID_CERTIFICATE'\nexport const ID_CONFIRMATIONS = 'CONFIRMATIONS'\nexport const ID_TAKER = 'TAKER'\nexport const ID_MAKER = 'MAKER'\nexport const ID_EMPTY_DEX_ADDRESS_MSG = 'EMPTY_DEX_ADDRESS_MSG'\nexport const ID_SELECT_WALLET_FOR_FEE_PAYMENT = 'SELECT_WALLET_FOR_FEE_PAYMENT'\nexport const ID_UNAVAILABLE = 'UNAVAILABLE'\nexport const ID_WALLET_SYNC_FINISHING_UP = 'WALLET_SYNC_FINISHING_UP'\nexport const ID_CONNECT_WALLET_ERR_MSG = 'CONNECTING_WALLET_ERR_MSG'\nexport const ID_REFUND_IMMINENT = 'REFUND_IMMINENT'\nexport const ID_REFUND_WILL_HAPPEN_AFTER = 'REFUND_WILL_HAPPEN_AFTER'\nexport const ID_AVAILABLE_TITLE = 'AVAILABLE_TITLE'\nexport const ID_LOCKED_TITLE = 'LOCKED_TITLE'\nexport const ID_IMMATURE_TITLE = 'IMMATURE_TITLE'\nexport const ID_SWAPPING = 'SWAPPING'\nexport const ID_BONDED = 'BONDED'\nexport const ID_LOCKED_BAL_MSG = 'LOCKED_BAL_MSG'\nexport const ID_IMMATURE_BAL_MSG = 'IMMATURE_BAL_MSG'\nexport const ID_LOCKED_SWAPPING_BAL_MSG = 'LOCKED_SWAPPING_BAL_MSG'\nexport const ID_LOCKED_BOND_BAL_MSG = 'LOCKED_BOND_BAL_MSG'\nexport const ID_RESERVES_DEFICIT = 'RESERVES_DEFICIT'\nexport const ID_RESERVES_DEFICIT_MSG = 'RESERVES_DEFICIT_MSG'\nexport const ID_BOND_RESERVES = 'BOND_RESERVES'\nexport const ID_BOND_RESERVES_MSG = 'BOND_RESERVES_MSG'\nexport const ID_SHIELDED = 'SHIELDED'\nexport const ID_TRANSPARENT = 'TRANSPARENT'\nexport const ID_SHIELDED_MSG = 'SHIELDED_MSG'\nexport const ID_ORDER = 'ORDER'\nexport const ID_LOCKED_ORDER_BAL_MSG = 'LOCKED_ORDER_BAL_MSG'\nexport const ID_CREATING_WALLETS = 'CREATING_WALLETS'\nexport const ID_ADDING_SERVERS = 'ADDING_SERVER'\nexport const ID_WALLET_RECOVERY_SUPPORT_MSG = 'WALLET_RECOVERY_SUPPORT_MSG'\nexport const ID_TICKETS_PURCHASED = 'TICKETS_PURCHASED'\nexport const ID_TICKET_STATUS_UNKNOWN = 'TICKET_STATUS_UNKNOWN'\nexport const ID_TICKET_STATUS_UNMINED = 'TICKET_STATUS_UNMINED'\nexport const ID_TICKET_STATUS_IMMATURE = 'TICKET_STATUS_IMMATURE'\nexport const ID_TICKET_STATUS_LIVE = 'TICKET_STATUS_LIVE'\nexport const ID_TICKET_STATUS_VOTED = 'TICKET_STATUS_VOTED'\nexport const ID_TICKET_STATUS_MISSED = 'TICKET_STATUS_MISSED'\nexport const ID_TICKET_STATUS_EXPIRED = 'TICKET_STATUS_EXPIRED'\nexport const ID_TICKET_STATUS_UNSPENT = 'TICKET_STATUS_UNSPENT'\nexport const ID_TICKET_STATUS_REVOKED = 'TICKET_STATUS_REVOKED'\nexport const ID_PASSWORD_RESET_SUCCESS_MSG = 'PASSWORD_RESET_SUCCESS_MSG'\nexport const ID_BROWSER_NTFN_ENABLED = 'BROWSER_NTFN_ENABLED'\nexport const ID_BROWSER_NTFN_ORDERS = 'BROWSER_NTFN_ORDERS'\nexport const ID_BROWSER_NTFN_MATCHES = 'BROWSER_NTFN_MATCHES'\nexport const ID_BROWSER_NTFN_BONDS = 'BROWSER_NTFN_BONDS'\nexport const ID_BROWSER_NTFN_CONNECTIONS = 'BROWSER_NTFN_CONNECTIONS'\nexport const ID_ORDER_BUTTON_BUY_BALANCE_ERROR = 'ORDER_BUTTON_BUY_BALANCE_ERROR'\nexport const ID_ORDER_BUTTON_SELL_BALANCE_ERROR = 'ORDER_BUTTON_SELL_BALANCE_ERROR'\nexport const ID_ORDER_BUTTON_QTY_ERROR = 'ORDER_BUTTON_QTY_ERROR'\nexport const ID_ORDER_BUTTON_QTY_RATE_ERROR = 'ORDER_BUTTON_QTY_RATE_ERROR'\nexport const ID_CREATE_ASSET_WALLET_MSG = 'CREATE_ASSET_WALLET_MSG'\nexport const ID_NO_WALLET_MSG = 'NO_WALLET_MSG'\nexport const ID_TRADING_TIER_UPDATED = 'TRADING_TIER_UPDATED'\nexport const ID_INVALID_TIER_VALUE = 'INVALID_TIER_VALUE'\nexport const ID_INVALID_COMPS_VALUE = 'INVALID_COMPS_VALUE'\nexport const ID_TX_TYPE_UNKNOWN = 'TX_TYPE_UNKNOWN'\nexport const ID_TX_TYPE_SEND = 'TX_TYPE_SEND'\nexport const ID_TX_TYPE_RECEIVE = 'TX_TYPE_RECEIVE'\nexport const ID_TX_TYPE_SWAP = 'TX_TYPE_SWAP'\nexport const ID_TX_TYPE_REDEEM = 'TX_TYPE_REDEEM'\nexport const ID_TX_TYPE_REFUND = 'TX_TYPE_REFUND'\nexport const ID_TX_TYPE_SPLIT = 'TX_TYPE_SPLIT'\nexport const ID_TX_TYPE_CREATE_BOND = 'TX_TYPE_CREATE_BOND'\nexport const ID_TX_TYPE_REDEEM_BOND = 'TX_TYPE_REDEEM_BOND'\nexport const ID_TX_TYPE_APPROVE_TOKEN = 'TX_TYPE_APPROVE_TOKEN'\nexport const ID_TX_TYPE_ACCELERATION = 'TX_TYPE_ACCELERATION'\nexport const ID_TX_TYPE_SELF_TRANSFER = 'TX_TYPE_SELF_TRANSFER'\nexport const ID_TX_TYPE_REVOKE_TOKEN_APPROVAL = 'TX_TYPE_REVOKE_TOKEN_APPROVAL'\nexport const ID_TX_TYPE_TICKET_PURCHASE = 'TX_TYPE_TICKET_PURCHASE'\nexport const ID_TX_TYPE_TICKET_VOTE = 'TX_TYPE_TICKET_VOTE'\nexport const ID_TX_TYPE_TICKET_REVOCATION = 'TX_TYPE_TICKET_REVOCATION'\nexport const ID_TX_TYPE_SWAP_OR_SEND = 'TX_TYPE_SWAP_OR_SEND'\nexport const ID_TX_TYPE_MIX = 'TX_TYPE_MIX'\nexport const ID_SWAP_OR_SEND_TOOLTIP = 'SWAP_OR_SEND_TOOLTIP'\nexport const ID_MISSING_CEX_CREDS = 'MISSING_CEX_CREDS'\nexport const ID_MATCH_BUFFER = 'MATCH_BUFFER'\nexport const ID_NO_PLACEMENTS = 'NO_PLACEMENTS'\nexport const ID_INVALID_VALUE = 'INVALID_VALUE'\nexport const ID_NO_ZERO = 'NO_ZERO'\nexport const ID_BOTTYPE_BASIC_MM = 'BOTTYPE_BASIC_MM'\nexport const ID_BOTTYPE_ARB_MM = 'BOTTYPE_ARB_MM'\nexport const ID_BOTTYPE_SIMPLE_ARB = 'BOTTYPE_SIMPLE_ARB'\nexport const ID_NO_BOTTYPE = 'NO_BOTTYPE'\nexport const ID_NO_CEX = 'NO_CEX'\nexport const ID_CEXBALANCE_ERR = 'CEXBALANCE_ERR'\nexport const ID_PENDING = 'PENDING'\nexport const ID_COMPLETE = 'COMPLETE'\nexport const ID_ARCHIVED_SETTINGS = 'ARCHIVED_SETTINGS'\nexport const ID_NO_CODE_PROVIDED = 'NO_CODE_PROVIDED'\nexport const ID_ENABLE_ACCOUNT = 'ENABLE_ACCOUNT'\nexport const ID_DISABLE_ACCOUNT = 'DISABLE_ACCOUNT'\nexport const ID_ACCOUNT_DISABLED_MSG = 'ACCOUNT_DISABLED_MSG'\nexport const ID_DEX_DISABLED_MSG = 'DEX_DISABLED_MSG'\nexport const ID_WALLET_NOT_SYNCED = 'WALLET_NOT_SYNCED'\nexport const ID_WALLET_NO_PEERS = 'WALLET_NO_PEERS'\nexport const ID_DEPOSIT_ERROR = 'DEPOSIT_ERROR'\nexport const ID_WITHDRAW_ERROR = 'WITHDRAW_ERROR'\nexport const ID_DEX_UNDERFUNDED = 'DEX_UNDERFUNDED'\nexport const ID_CEX_UNDERFUNDED = 'CEX_UNDERFUNDED'\nexport const ID_CEX_TOO_SHALLOW = 'CEX_TOO_SHALLOW'\nexport const ID_ACCOUNT_SUSPENDED = 'ACCOUNT_SUSPENDED'\nexport const ID_USER_LIMIT_TOO_LOW = 'USER_LIMIT_TOO_LOW'\nexport const ID_NO_PRICE_SOURCE = 'NO_PRICE_SOURCE'\nexport const ID_CEX_ORDERBOOK_UNSYNCED = 'CEX_ORDERBOOK_UNSYNCED'\nexport const ID_DETERMINE_PLACEMENTS_ERROR = 'DETERMINE_PLACEMENTS_ERROR'\nexport const ID_PLACE_BUY_ORDERS_ERROR = 'PLACE_BUY_ORDERS_ERROR'\nexport const ID_PLACE_SELL_ORDERS_ERROR = 'PLACE_SELL_ORDERS_ERROR'\nexport const ID_CEX_TRADE_ERROR = 'CEX_TRADE_ERROR'\nexport const ID_ORDER_REPORT_TITLE = 'ORDER_REPORT_TITLE'\nexport const ID_CEX_BALANCES = 'CEX_BALANCES'\nexport const ID_CAUSES_SELF_MATCH = 'CAUSES_SELF_MATCH'\nexport const ID_CEX_NOT_CONNECTED = 'CEX_NOT_CONNECTED'\nexport const ID_DELETE_BOT = 'DELETE_BOT'\n\nlet locale: Locale\n\nexport async function loadLocale (lang: string, commitHash: string, skipCache: boolean) {\n  if (!skipCache) {\n    const specs = State.fetchLocal(State.localeSpecsKey)\n    if (specs && specs.lang === lang && specs.commitHash === commitHash) {\n      locale = State.fetchLocal(State.localeKey)\n      return\n    }\n  }\n  locale = await postJSON('/api/locale', lang)\n  State.storeLocal(State.localeSpecsKey, { lang, commitHash })\n  State.storeLocal(State.localeKey, locale)\n}\n\n/* prep will format the message to the current locale. */\nexport function prep (k: string, args?: Record<string, string>) {\n  return stringTemplateParser(locale[k], args || {})\n}\n\nwindow.clearLocale = () => {\n  State.removeLocal(State.localeSpecsKey)\n  State.removeLocal(State.localeKey)\n}\n\n/*\n * stringTemplateParser is a template string matcher, where expression is any\n * text. It switches what is inside double brackets (e.g. 'buy {{ asset }}')\n * for the value described into args. args is an object with keys\n * equal to the placeholder keys. (e.g. {\"asset\": \"dcr\"}).\n * So that will be switched for: 'asset dcr'.\n */\nfunction stringTemplateParser (expression: string, args: Record<string, string>) {\n  // templateMatcher matches any text which:\n  // is some {{ text }} between two brackets, and a space between them.\n  // It is global, therefore it will change all occurrences found.\n  // text can be anything, but brackets '{}' and space '\\s'\n  const templateMatcher = /{{\\s?([^{}\\s]*)\\s?}}/g\n  return expression.replace(templateMatcher, (_, value) => args[value])\n}\n","import * as intl from './locales'\nimport {\n  UnitInfo,\n  LayoutMetrics,\n  WalletState,\n  PageElement\n} from './registry'\nimport State from './state'\n\n// Symbolizer is satisfied by both dex.Asset and core.SupportedAsset. Used by\n// Doc.symbolize.\ninterface Symbolizer {\n  symbol: string\n  unitInfo: UnitInfo\n}\n\nconst parser = new window.DOMParser()\n\nconst FPS = 30\n\nconst BipIDs: Record<number, string> = {\n  0: 'btc',\n  42: 'dcr',\n  2: 'ltc',\n  5: 'dash',\n  20: 'dgb',\n  22: 'mona',\n  28: 'vtc',\n  3: 'doge',\n  145: 'bch',\n  60: 'eth',\n  60001: 'usdc.eth',\n  60002: 'usdt.eth',\n  60003: 'matic.eth',\n  136: 'firo',\n  133: 'zec',\n  966: 'polygon',\n  966001: 'usdc.polygon',\n  966002: 'weth.polygon',\n  966003: 'wbtc.polygon',\n  966004: 'usdt.polygon',\n  147: 'zcl'\n}\n\nconst BipSymbolIDs: Record<string, number> = {};\n(function () {\n  for (const k of Object.keys(BipIDs)) {\n    BipSymbolIDs[BipIDs[parseInt(k)]] = parseInt(k)\n  }\n})()\n\nconst BipSymbols = Object.values(BipIDs)\n\nconst RateEncodingFactor = 1e8 // same as value defined in ./orderutil\n\nconst log10RateEncodingFactor = Math.round(Math.log10(RateEncodingFactor))\n\nconst languages = navigator.languages.filter((locale: string) => locale !== 'c')\n\nconst intFormatter = new Intl.NumberFormat(languages, { maximumFractionDigits: 0 })\n\nconst fourSigFigs = new Intl.NumberFormat(languages, {\n  minimumSignificantDigits: 4,\n  maximumSignificantDigits: 4\n})\n\n/* A cache for formatters used for Doc.formatCoinValue. */\nconst decimalFormatters: Record<number, Intl.NumberFormat> = {}\n\n/*\n * decimalFormatter gets the formatCoinValue formatter for the specified decimal\n * precision.\n */\nfunction decimalFormatter (prec: number) {\n  return formatter(decimalFormatters, 2, prec)\n}\n\n/* A cache for formatters used for Doc.formatFullPrecision. */\nconst fullPrecisionFormatters: Record<number, Intl.NumberFormat> = {}\n\n/*\n * fullPrecisionFormatter gets the formatFullPrecision formatter for the\n * specified decimal precision.\n */\nfunction fullPrecisionFormatter (prec: number, locales?: string | string[]) {\n  return formatter(fullPrecisionFormatters, prec, prec, locales)\n}\n\n/*\n * formatter gets the formatter from the supplied cache if it already exists,\n * else creates it.\n */\nfunction formatter (formatters: Record<string, Intl.NumberFormat>, min: number, max: number, locales?: string | string[]): Intl.NumberFormat {\n  const k = `${min}-${max}`\n  let fmt = formatters[k]\n  if (!fmt) {\n    fmt = new Intl.NumberFormat(locales ?? languages, {\n      minimumFractionDigits: min,\n      maximumFractionDigits: max\n    })\n    formatters[k] = fmt\n  }\n  return fmt\n}\n\n/*\n * convertToConventional converts the value in atomic units to conventional\n * units.\n */\nfunction convertToConventional (v: number, unitInfo?: UnitInfo) {\n  let prec = 8\n  if (unitInfo) {\n    const f = unitInfo.conventional.conversionFactor\n    v /= f\n    prec = Math.round(Math.log10(f))\n  }\n  return [v, prec]\n}\n\n/*\n * bestDisplayOrder is used in bestConversion, and is the order of magnitude\n * that is considered the best for display. For example, if bestDisplayOrder is\n * 1, and the choices for display are 1,000 BTC or 0.00001 Sats, the algorithm\n * will look at the orders of the conversions, 1000 => 10^3 => order 3, and\n * 0.00001 => 10^-5 => order 5, and see which is closest to bestDisplayOrder and\n * choose that conversion. In the example, 3 - bestDisplayOrder = 2 and\n * 1 - (-5) = 6, so the conversion that has the order closest to\n * bestDisplayOrder is the first one, 1,000 BTC.\n */\nconst bestDisplayOrder = 1 // 10^1 => 1\n\n/*\n * resolveUnitConversions creates a lookup object mapping unit -> conversion\n * factor. By default, resolveUnitConversions only maps the atomic and\n * conventional units. If a prefs dict is provided, additional units can be\n * included.\n */\nfunction resolveUnitConversions (ui: UnitInfo, prefs?: Record<string, boolean>): Record<string, number> {\n  const unitFactors: Record<string, number> = {\n    [ui.atomicUnit]: 1,\n    [ui.conventional.unit]: ui.conventional.conversionFactor\n  }\n  if (ui.denominations && prefs) {\n    for (const alt of ui.denominations) if (prefs[alt.unit]) unitFactors[alt.unit] = alt.conversionFactor\n  }\n  return unitFactors\n}\n\n// Helpers for working with the DOM.\nexport default class Doc {\n  /*\n   * idel is the element with the specified id that is the descendent of the\n   * specified node.\n   */\n  static idel (el: Document | Element, id: string): HTMLElement {\n    return el.querySelector(`#${id}`) as HTMLElement\n  }\n\n  /* bind binds the function to the event for the element. */\n  static bind (el: EventTarget, ev: string | string[], f: EventListenerOrEventListenerObject, opts?: any /* EventListenerOptions */): void {\n    for (const e of (Array.isArray(ev) ? ev : [ev])) el.addEventListener(e, f, opts)\n  }\n\n  /* unbind removes the handler for the event from the element. */\n  static unbind (el: EventTarget, ev: string, f: (e: Event) => void): void {\n    el.removeEventListener(ev, f)\n  }\n\n  /* noderize creates a Document object from a string of HTML. */\n  static noderize (html: string): Document {\n    return parser.parseFromString(html, 'text/html')\n  }\n\n  /*\n   * mouseInElement returns true if the position of mouse event, e, is within\n   * the bounds of the specified element or any of its descendents.\n   */\n  static mouseInElement (e: MouseEvent, el: HTMLElement): boolean {\n    if (el.contains(e.target as Node)) return true\n    const rect = el.getBoundingClientRect()\n    return e.pageX >= rect.left && e.pageX <= rect.right &&\n      e.pageY >= rect.top && e.pageY <= rect.bottom\n  }\n\n  /*\n   * layoutMetrics gets information about the elements position on the page.\n   */\n  static layoutMetrics (el: HTMLElement): LayoutMetrics {\n    const box = el.getBoundingClientRect()\n    const docEl = document.documentElement\n    const top = box.top + docEl.scrollTop\n    const left = box.left + docEl.scrollLeft\n    const w = el.offsetWidth\n    const h = el.offsetHeight\n    return {\n      bodyTop: top,\n      bodyLeft: left,\n      width: w,\n      height: h,\n      centerX: left + w / 2,\n      centerY: top + h / 2\n    }\n  }\n\n  static descendentMetrics (parent: PageElement, kid: PageElement): LayoutMetrics {\n    const parentMetrics = Doc.layoutMetrics(parent)\n    const kidMetrics = Doc.layoutMetrics(kid)\n    return {\n      bodyTop: kidMetrics.bodyTop - parentMetrics.bodyTop,\n      bodyLeft: kidMetrics.bodyLeft - parentMetrics.bodyLeft,\n      width: kidMetrics.width,\n      height: kidMetrics.height,\n      centerX: kidMetrics.centerX - parentMetrics.bodyLeft,\n      centerY: kidMetrics.centerY - parentMetrics.bodyTop\n    }\n  }\n\n  /* empty removes all child nodes from the specified element. */\n  static empty (...els: Element[]) {\n    for (const el of els) while (el.firstChild) el.removeChild(el.firstChild)\n  }\n\n  /*\n   * setContent removes all child nodes from the specified element and appends\n   * passed elements.\n   */\n  static setContent (ancestor: PageElement, ...kids: PageElement[]) {\n    Doc.empty(ancestor)\n    for (const k of kids) ancestor.appendChild(k)\n  }\n\n  /*\n   * hide hides the specified elements. This is accomplished by adding the\n   * bootstrap d-hide class to the element. Use Doc.show to undo.\n   */\n  static hide (...els: Element[]) {\n    for (const el of els) el.classList.add('d-hide')\n  }\n\n  /*\n   * show shows the specified elements. This is accomplished by removing the\n   * bootstrap d-hide class as added with Doc.hide.\n   */\n  static show (...els: Element[]) {\n    for (const el of els) el.classList.remove('d-hide')\n  }\n\n  /*\n   * showTemporarily shows the specified elements for the specified time, then\n   * hides it again.\n   */\n  static showTemporarily (timeout: number, ...els: Element[]) {\n    this.show(...els)\n    setTimeout(() => {\n      this.hide(...els)\n    }, timeout)\n  }\n\n  /*\n   * show or hide the specified elements, based on value of the truthiness of\n   * vis.\n   */\n  static setVis (vis: any, ...els: Element[]) {\n    if (vis) Doc.show(...els)\n    else Doc.hide(...els)\n  }\n\n  /* isHidden returns true if the specified element is hidden */\n  static isHidden (el: Element): boolean {\n    return el.classList.contains('d-hide')\n  }\n\n  /* isDisplayed returns true if the specified element is not hidden */\n  static isDisplayed (el: Element): boolean {\n    return !el.classList.contains('d-hide')\n  }\n\n  /*\n   * animate runs the supplied function, which should be a \"progress\" function\n   * accepting one argument. The progress function will be called repeatedly\n   * with the argument varying from 0.0 to 1.0. The exact path that animate\n   * takes from 0.0 to 1.0 will vary depending on the choice of easing\n   * algorithm. See the Easing object for the available easing algo choices. The\n   * default easing algorithm is linear.\n   */\n  static async animate (duration: number, f: (progress: number) => void, easingAlgo?: string) {\n    await new Animation(duration, f, easingAlgo).wait()\n  }\n\n  static async blink (el: PageElement) {\n    const [r, g, b] = State.isDark() ? [255, 255, 255] : [0, 0, 0]\n    const cycles = 2\n    Doc.animate(1000, (p: number) => {\n      el.style.outline = `2px solid rgba(${r}, ${g}, ${b}, ${(cycles - p * cycles) % 1})`\n    })\n  }\n\n  static applySelector (ancestor: HTMLElement, k: string): PageElement[] {\n    return Array.from(ancestor.querySelectorAll(k)) as PageElement[]\n  }\n\n  static kids (ancestor: HTMLElement): PageElement[] {\n    return Array.from(ancestor.children) as PageElement[]\n  }\n\n  static safeSelector (ancestor: HTMLElement, k: string): PageElement {\n    const el = ancestor.querySelector(k)\n    if (el) return el as PageElement\n    console.warn(`no element found for selector '${k}' on element ->`, ancestor)\n    return document.createElement('div')\n  }\n\n  /*\n   * idDescendants creates an object mapping to elements which are descendants\n   * of the ancestor and have id attributes. Elements are keyed by their id\n   * value.\n   */\n  static idDescendants (ancestor: HTMLElement): Record<string, PageElement> {\n    const d: Record<string, PageElement> = {}\n    for (const el of Doc.applySelector(ancestor, '[id]')) d[el.id] = el\n    return d\n  }\n\n  /*\n   * formatCoinValue formats the value in atomic units into a string\n   * representation in conventional units. If the value happens to be an\n   * integer, no decimals are displayed. Trailing zeros may be truncated.\n   */\n  static formatCoinValue (vAtomic: number, unitInfo?: UnitInfo): string {\n    const [v, prec] = convertToConventional(vAtomic, unitInfo)\n    if (Number.isInteger(v)) return intFormatter.format(v)\n    return decimalFormatter(prec).format(v)\n  }\n\n  static conventionalCoinValue (vAtomic: number, unitInfo?: UnitInfo): number {\n    const [v] = convertToConventional(vAtomic, unitInfo)\n    return v\n  }\n\n  /*\n   * formatRateFullPrecision formats rate to represent it exactly at rate step\n   * precision, trimming non-effectual zeros if there are any.\n   */\n  static formatRateFullPrecision (encRate: number, bui: UnitInfo, qui: UnitInfo, rateStepEnc: number) {\n    const r = bui.conventional.conversionFactor / qui.conventional.conversionFactor\n    const convRate = encRate * r / RateEncodingFactor\n    const rateStepDigits = log10RateEncodingFactor - Math.floor(Math.log10(rateStepEnc)) -\n      Math.floor(Math.log10(bui.conventional.conversionFactor) - Math.log10(qui.conventional.conversionFactor))\n    if (rateStepDigits <= 0) return intFormatter.format(convRate)\n    return fullPrecisionFormatter(rateStepDigits).format(convRate)\n  }\n\n  static formatFourSigFigs (n: number, maxDecimals?: number): string {\n    return formatSigFigsWithFormatters(intFormatter, fourSigFigs, n, maxDecimals)\n  }\n\n  static formatInt (i: number): string {\n    return intFormatter.format(i)\n  }\n\n  /*\n   * formatFullPrecision formats the value in atomic units into a string\n   * representation in conventional units using the full decimal precision\n   * associated with the conventional unit's conversion factor.\n   */\n  static formatFullPrecision (vAtomic: number, unitInfo?: UnitInfo): string {\n    const [v, prec] = convertToConventional(vAtomic, unitInfo)\n    return fullPrecisionFormatter(prec).format(v)\n  }\n\n  /*\n   * formatFiatConversion formats the value in atomic units to its representation in\n   * conventional units and returns the fiat value as a string.\n   */\n  static formatFiatConversion (vAtomic: number, rate: number, unitInfo?: UnitInfo): string {\n    if (!rate || rate === 0) return intl.prep(intl.ID_UNAVAILABLE)\n    const prec = 2\n    const [v] = convertToConventional(vAtomic, unitInfo)\n    const value = v * rate\n    return fullPrecisionFormatter(prec).format(value)\n  }\n\n  static languages (): string[] {\n    return languages\n  }\n\n  static formatFiatValue (value: number): string {\n    return fullPrecisionFormatter(2).format(value)\n  }\n\n  /*\n   * bestConversion picks the best conversion factor for the atomic value. The\n   * best is the one in which log10(converted_value) is closest to\n   * bestDisplayOrder. Return: [converted_value, precision, unit].\n   */\n  static bestConversion (atoms: number, ui: UnitInfo, prefs?: Record<string, boolean>): [number, number, string] {\n    const unitFactors = resolveUnitConversions(ui, prefs)\n    const logDiffs: [string, number][] = []\n    const entryDiff = (entry: [string, number]) => Math.abs(Math.log10(atoms / entry[1]) - bestDisplayOrder)\n    for (const entry of Object.entries(unitFactors)) logDiffs.push([entry[0], entryDiff(entry)])\n    const best = logDiffs.reduce((best: [string, number], entry: [string, number]) => entry[1] < best[1] ? entry : best)\n    const unit = best[0]\n    const cFactor = unitFactors[unit]\n    const v = atoms / cFactor\n    return [v, Math.round(Math.log10(cFactor)), unit]\n  }\n\n  /*\n   * formatBestUnitsFullPrecision formats the value with the best choice of\n   * units, at full precision.\n   */\n  static formatBestUnitsFullPrecision (atoms: number, ui: UnitInfo, prefs?: Record<string, boolean>): [string, string] {\n    const [v, prec, unit] = this.bestConversion(atoms, ui, prefs)\n    if (Number.isInteger(v)) return [intFormatter.format(v), unit]\n    return [fullPrecisionFormatter(prec).format(v), unit]\n  }\n\n  /*\n   * formatBestUnitsFourSigFigs formats the value with the best choice of\n   * units and rounded to four significant figures.\n   */\n  static formatBestUnitsFourSigFigs (atoms: number, ui: UnitInfo, prefs?: Record<string, boolean>): [string, string] {\n    const [v, prec, unit] = this.bestConversion(atoms, ui, prefs)\n    return [Doc.formatFourSigFigs(v, prec), unit]\n  }\n\n  /*\n   * formatBestRateElement formats a rate using the best available units and\n   * updates the UI element. The ancestor should have descendents with data\n   * attributes [best-value, data-unit, data-unit-box, data-denom].\n   */\n  static formatBestRateElement (ancestor: PageElement, assetID: number, atoms: number, ui: UnitInfo, prefs?: Record<string, boolean>) {\n    Doc.formatBestValueElement(ancestor, assetID, atoms, ui, prefs)\n    Doc.setText(ancestor, '[data-denom]', ui.feeRateDenom)\n  }\n\n  /*\n   * formatBestRateElement formats a value using the best available units and\n   * updates the UI element. The ancestor should have descendents with data\n   * attributes [best-value, data-unit, data-unit-box].\n   */\n  static formatBestValueElement (ancestor: PageElement, assetID: number, atoms: number, ui: UnitInfo, prefs?: Record<string, boolean>) {\n    const [v, unit] = this.formatBestUnitsFourSigFigs(atoms, ui, prefs)\n    Doc.setText(ancestor, '[data-value]', v)\n    Doc.setText(ancestor, '[data-unit]', unit)\n    const span = Doc.safeSelector(ancestor, '[data-unit-box]')\n    span.dataset.atoms = String(atoms)\n    span.dataset.assetID = String(assetID)\n  }\n\n  static conventionalRateStep (rateStepEnc: number, baseUnitInfo: UnitInfo, quoteUnitInfo: UnitInfo) {\n    const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor]\n    return rateStepEnc / RateEncodingFactor * (bFactor / qFactor)\n  }\n\n  /*\n   * logoPath creates a path to a png logo for the specified ticker symbol. If\n   * the symbol is not a supported asset, the generic letter logo will be\n   * requested instead.\n   */\n  static logoPath (symbol: string): string {\n    if (BipSymbols.indexOf(symbol) === -1) symbol = symbol.substring(0, 1)\n    symbol = symbol.split('.')[0] // e.g. usdc.eth => usdc\n    return `/img/coins/${symbol}.png`\n  }\n\n  static bipSymbol (assetID: number): string {\n    return BipIDs[assetID]\n  }\n\n  static bipIDFromSymbol (symbol: string): number {\n    return BipSymbolIDs[symbol]\n  }\n\n  static bipCEXSymbol (assetID: number): string {\n    const bipSymbol = BipIDs[assetID]\n    if (!bipSymbol || bipSymbol === '') return ''\n    const parts = bipSymbol.split('.')\n    if (parts[0] === 'weth') return 'eth'\n    return parts[0]\n  }\n\n  static logoPathFromID (assetID: number): string {\n    return Doc.logoPath(BipIDs[assetID])\n  }\n\n  /*\n   * symbolize creates a token-aware symbol element for the asset's symbol. For\n   * non-token assets, this is simply a <span>SYMBOL</span>. For tokens, it'll\n   * be <span><span>SYMBOL</span><sup>PARENT</sup></span>.\n   */\n  static symbolize (asset: Symbolizer, useLogo?: boolean): PageElement {\n    const ticker = asset.unitInfo.conventional.unit\n    const symbolSpan = document.createElement('span')\n    symbolSpan.textContent = ticker.toUpperCase()\n    const parts = asset.symbol.split('.')\n    const isToken = parts.length === 2\n    if (!isToken) return symbolSpan\n    const parentSymbol = parts[1]\n    const span = document.createElement('span')\n    span.appendChild(symbolSpan)\n    if (useLogo) {\n      const parentLogo = document.createElement('img')\n      parentLogo.src = Doc.logoPath(parentSymbol)\n      parentLogo.classList.add('token-parent')\n      span.appendChild(parentLogo)\n      return span\n    }\n    const parentSup = document.createElement('sup')\n    parentSup.textContent = parentSymbol.toUpperCase()\n    parentSup.classList.add('token-parent')\n    span.appendChild(parentSup)\n    return span\n  }\n\n  /*\n   * shortSymbol removes the short format of a symbol, with any parent chain\n   * identifier removed\n   */\n  static shortSymbol (symbol: string): string {\n    return symbol.split('.')[0].toUpperCase()\n  }\n\n  /*\n   * setText sets the textContent for all descendant elements that match the\n   * specified CSS selector.\n   */\n  static setText (ancestor: PageElement, selector: string, textContent: string) {\n    for (const el of Doc.applySelector(ancestor, selector)) el.textContent = textContent\n  }\n\n  static setSrc (ancestor: PageElement, selector: string, textContent: string) {\n    for (const img of Doc.applySelector(ancestor, selector)) img.src = textContent\n  }\n\n  /*\n  * cleanTemplates removes the elements from the DOM and deletes the id\n  * attribute.\n  */\n  static cleanTemplates (...tmpls: HTMLElement[]) {\n    tmpls.forEach(tmpl => {\n      tmpl.remove()\n      tmpl.removeAttribute('id')\n    })\n  }\n\n  /*\n  * tmplElement is a helper function for grabbing sub-elements of the market list\n  * template.\n  */\n  static tmplElement (ancestor: Document | HTMLElement, s: string): PageElement {\n    return ancestor.querySelector(`[data-tmpl=\"${s}\"]`) || document.createElement('div')\n  }\n\n  /*\n  * parseTemplate returns an object of data-tmpl elements, keyed by their\n  * data-tmpl values.\n  */\n  static parseTemplate (ancestor: HTMLElement): Record<string, PageElement> {\n    const d: Record<string, PageElement> = {}\n    for (const el of Doc.applySelector(ancestor, '[data-tmpl]')) d[el.dataset.tmpl || ''] = el\n    return d\n  }\n\n  /*\n   * timeSince returns a string representation of the duration since the\n   * specified unix timestamp (milliseconds).\n   */\n  static timeSince (ms: number): string {\n    return Doc.formatDuration((new Date().getTime()) - ms)\n  }\n\n  /*\n   * hmsSince returns a time duration since the specified unix timestamp\n   * formatted as HH:MM:SS\n   */\n  static hmsSince (secs: number) {\n    let r = (new Date().getTime() / 1000) - secs\n    const h = String(Math.floor(r / 3600))\n    r = r % 3600\n    const m = String(Math.floor(r / 60))\n    const s = String(Math.floor(r % 60))\n    return `${h.padStart(2, '0')}:${m.padStart(2, '0')}:${s.padStart(2, '0')}`\n  }\n\n  /* formatDuration returns a string representation of the duration */\n  static formatDuration (dur: number): string {\n    let seconds = Math.floor(dur)\n    let result = ''\n    let count = 0\n    const add = (n: number, s: string) => {\n      if (n > 0 || count > 0) count++\n      if (n > 0) result += `${n} ${s} `\n      return count >= 2\n    }\n    let y, mo, d, h, m, s\n    [y, seconds] = timeMod(seconds, aYear)\n    if (add(y, 'y')) { return result }\n    [mo, seconds] = timeMod(seconds, aMonth)\n    if (add(mo, 'mo')) { return result }\n    [d, seconds] = timeMod(seconds, aDay)\n    if (add(d, 'd')) { return result }\n    [h, seconds] = timeMod(seconds, anHour)\n    if (add(h, 'h')) { return result }\n    [m, seconds] = timeMod(seconds, aMinute)\n    if (add(m, 'm')) { return result }\n    [s, seconds] = timeMod(seconds, 1000)\n    add(s, 's')\n    return result || '0 s'\n  }\n\n  /*\n   * disableMouseWheel can be used to disable the mouse wheel for any\n   * input. It is very easy to unknowingly scroll up on a number input\n   * and then submit an unexpected value. This function prevents the\n   * scroll increment/decrement behavior for a wheel action on a\n   * number input.\n   */\n  static disableMouseWheel (...inputFields: Element[]) {\n    for (const inputField of inputFields) {\n      Doc.bind(inputField, 'wheel', () => { /* pass */ }, { passive: true })\n    }\n  }\n\n  // showFormError can be used to set and display error message on forms.\n  static showFormError (el: PageElement, msg: any) {\n    el.textContent = msg\n    Doc.show(el)\n  }\n\n  // showFiatValue displays the fiat equivalent for the provided amount.\n  static showFiatValue (display: PageElement, amount: number, rate: number, ui: UnitInfo): void {\n    if (rate) {\n      display.textContent = Doc.formatFiatConversion(amount, rate, ui)\n      Doc.show(display.parentElement as Element)\n    } else Doc.hide(display.parentElement as Element)\n  }\n}\n\n/*\n * Animation is a handler for starting and stopping animations.\n */\nexport class Animation {\n  done: (() => void) | undefined\n  endAnimation: boolean\n  thread: Promise<void>\n  static Forever: number\n\n  constructor (duration: number, f: (progress: number) => void, easingAlgo?: string, done?: () => void) {\n    this.done = done\n    this.thread = this.run(duration, f, easingAlgo)\n  }\n\n  /*\n   * run runs the animation function, increasing progress from 0 to 1 in a\n   * manner dictated by easingAlgo.\n   */\n  async run (duration: number, f: (progress: number) => void, easingAlgo?: string) {\n    duration = duration >= 0 ? duration : 1000 * 86400 * 365 * 10 // 10 years, in ms\n    const easer = easingAlgo ? Easing[easingAlgo] : Easing.linear\n    const start = new Date().getTime()\n    const end = (duration === Animation.Forever) ? Number.MAX_SAFE_INTEGER : start + duration\n    const range = end - start\n    const frameDuration = 1000 / FPS\n    let now = start\n    this.endAnimation = false\n    while (now < end) {\n      if (this.endAnimation) return this.runCompletionFunction()\n      f(easer((now - start) / range))\n      await sleep(frameDuration)\n      now = new Date().getTime()\n    }\n    f(1)\n    this.runCompletionFunction()\n  }\n\n  /* wait returns a promise that will resolve when the animation completes. */\n  async wait () {\n    await this.thread\n  }\n\n  /* stop schedules the animation to exit at its next frame. */\n  stop () {\n    this.endAnimation = true\n  }\n\n  /*\n   * stopAndWait stops the animations and returns a promise that will resolve\n   * when the animation exits.\n   */\n  async stopAndWait () {\n    this.stop()\n    await this.wait()\n  }\n\n  /* runCompletionFunction runs any registered callback function */\n  runCompletionFunction () {\n    if (this.done) this.done()\n  }\n}\nAnimation.Forever = -1\n\n/* Easing algorithms for animations. */\nexport const Easing: Record<string, (t: number) => number> = {\n  linear: t => t,\n  easeIn: t => t * t,\n  easeOut: t => t * (2 - t),\n  easeInHard: t => t * t * t,\n  easeOutHard: t => (--t) * t * t + 1,\n  easeOutElastic: t => {\n    const c4 = (2 * Math.PI) / 3\n    return t === 0\n      ? 0\n      : t === 1\n        ? 1\n        : Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * c4) + 1\n  }\n}\n\n/* WalletIcons are used for controlling wallets in various places. */\nexport class WalletIcons {\n  icons: Record<string, HTMLElement>\n  status: Element\n\n  constructor (box: HTMLElement) {\n    const stateElement = (name: string) => box.querySelector(`[data-state=${name}]`) as HTMLElement\n    this.icons = {}\n    this.icons.sleeping = stateElement('sleeping')\n    this.icons.locked = stateElement('locked')\n    this.icons.unlocked = stateElement('unlocked')\n    this.icons.nowallet = stateElement('nowallet')\n    this.icons.syncing = stateElement('syncing')\n    this.icons.nopeers = stateElement('nopeers')\n    this.icons.disabled = stateElement('disabled')\n    this.status = stateElement('status')\n  }\n\n  /* sleeping sets the icons to indicate that the wallet is not connected. */\n  sleeping () {\n    const i = this.icons\n    Doc.hide(i.locked, i.unlocked, i.nowallet, i.syncing, i.disabled)\n    Doc.show(i.sleeping)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_OFF)\n  }\n\n  /*\n   * locked sets the icons to indicate that the wallet is connected, but locked.\n   */\n  locked () {\n    const i = this.icons\n    Doc.hide(i.unlocked, i.nowallet, i.sleeping, i.disabled)\n    Doc.show(i.locked)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_LOCKED)\n  }\n\n  /*\n   * unlocked sets the icons to indicate that the wallet is connected and\n   * unlocked.\n   */\n  unlocked () {\n    const i = this.icons\n    Doc.hide(i.locked, i.nowallet, i.sleeping, i.disabled)\n    Doc.show(i.unlocked)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_READY)\n  }\n\n  /* nowallet sets the icons to indicate that no wallet exists. */\n  nowallet () {\n    const i = this.icons\n    Doc.hide(i.locked, i.unlocked, i.sleeping, i.syncing, i.disabled)\n    Doc.show(i.nowallet)\n    if (this.status) this.status.textContent = intl.prep(intl.ID_NO_WALLET)\n  }\n\n  /* set the icons to indicate that the wallet is disabled */\n  disabled () {\n    const i = this.icons\n    Doc.hide(i.locked, i.unlocked, i.sleeping, i.syncing, i.nowallet, i.nopeers)\n    Doc.show(i.disabled)\n    i.disabled.dataset.tooltip = intl.prep(intl.ID_DISABLED_MSG)\n  }\n\n  setSyncing (wallet: WalletState | null) {\n    const syncIcon = this.icons.syncing\n    if (!wallet || !wallet.running || wallet.disabled) {\n      Doc.hide(syncIcon)\n      return\n    }\n\n    if (wallet.peerCount === 0) {\n      Doc.show(this.icons.nopeers)\n      Doc.hide(syncIcon) // potentially misleading with no peers\n      return\n    }\n    Doc.hide(this.icons.nopeers)\n\n    if (!wallet.synced) {\n      Doc.show(syncIcon)\n      syncIcon.dataset.tooltip = intl.prep(intl.ID_WALLET_SYNC_PROGRESS, { syncProgress: (wallet.syncProgress * 100).toFixed(1) })\n      return\n    }\n    Doc.hide(syncIcon)\n  }\n\n  /* reads the core.Wallet state and sets the icon visibility. */\n  readWallet (wallet: WalletState | null) {\n    this.setSyncing(wallet)\n    if (!wallet) return this.nowallet()\n    switch (true) {\n      case (wallet.disabled):\n        this.disabled()\n        break\n      case (!wallet.running):\n        this.sleeping()\n        break\n      case (!wallet.open):\n        this.locked()\n        break\n      case (wallet.open):\n        this.unlocked()\n        break\n      default:\n        console.error('wallet in unknown state', wallet)\n    }\n  }\n}\n\n/*\n * AniToggle is a small toggle switch, defined in HTML with the element\n * <div class=\"anitoggle\"></div>. The animations are defined in the anitoggle\n * CSS class. AniToggle triggers the callback on click events, but does not\n * update toggle appearance, so the caller must call the setState method from\n * the callback or elsewhere if the newState\n * is accepted.\n */\nexport class AniToggle {\n  toggle: PageElement\n  toggling: boolean\n\n  constructor (toggle: PageElement, errorEl: PageElement, initialState: boolean, callback: (newState: boolean) => Promise<any>) {\n    this.toggle = toggle\n    if (toggle.children.length === 0) toggle.appendChild(document.createElement('div'))\n\n    Doc.bind(toggle, 'click', async (e: MouseEvent) => {\n      e.stopPropagation()\n      Doc.hide(errorEl)\n      const newState = !toggle.classList.contains('on')\n      this.toggling = true\n      try {\n        await callback(newState)\n      } catch (e) {\n        this.toggling = false\n        Doc.show(errorEl)\n        errorEl.textContent = intl.prep(intl.ID_API_ERROR, { msg: e.msg || String(e) })\n        return\n      }\n      this.toggling = false\n    })\n    this.setState(initialState)\n  }\n\n  setState (state: boolean) {\n    if (state) this.toggle.classList.add('on')\n    else this.toggle.classList.remove('on')\n  }\n}\n\n/* sleep can be used by async functions to pause for a specified period. */\nfunction sleep (ms: number) {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n\nconst aYear = 31536000000\nconst aMonth = 2592000000\nconst aDay = 86400000\nconst anHour = 3600000\nconst aMinute = 60000\n\n/* timeMod returns the quotient and remainder of t / dur. */\nfunction timeMod (t: number, dur: number) {\n  const n = Math.floor(t / dur)\n  return [n, t - n * dur]\n}\n\nfunction formatSigFigsWithFormatters (intFormatter: Intl.NumberFormat, sigFigFormatter: Intl.NumberFormat, n: number, maxDecimals?: number, locales?: string | string[]): string {\n  if (n >= 1000) return intFormatter.format(n)\n  const s = sigFigFormatter.format(n)\n  if (typeof maxDecimals !== 'number') return s\n  const fractional = sigFigFormatter.formatToParts(n).filter((part: Intl.NumberFormatPart) => part.type === 'fraction')[0]?.value ?? ''\n  if (fractional.length <= maxDecimals) return s\n  return fullPrecisionFormatter(maxDecimals, locales).format(n)\n}\n\nif (process.env.NODE_ENV === 'development') {\n  // Code will only appear in dev build.\n  // https://webpack.js.org/guides/production/\n  window.testFormatFourSigFigs = () => {\n    const tests: [string, string, number | undefined, string][] = [\n      ['en-US', '1.234567', undefined, '1.235'], // sigFigFormatter\n      ['en-US', '1.234567', 2, '1.23'], // decimalFormatter\n      ['en-US', '1234', undefined, '1,234.0'], // oneFractionalDigit\n      ['en-US', '12', undefined, '12.00'], // sigFigFormatter\n      ['fr-FR', '123.45678', undefined, '123,5'], // oneFractionalDigit\n      ['fr-FR', '1234.5', undefined, '1 234,5'], // U+202F for thousands separator\n      // For Arabic, https://www.saitak.com/number is useful, but seems to use\n      // slightly different unicode points and no thousands separator. I think\n      // the Arabic decimal separator is supposed to be more like a point, not\n      // a comma, but Google Chrome uses U+066B (Arabic Decimal Separator),\n      // which looks like a comma to me. ¯\\_(ツ)_/¯\n      ['ar-EG', '123.45678', undefined, '١٢٣٫٥'],\n      ['ar-EG', '1234', undefined, '١٬٢٣٤٫٠'],\n      ['ar-EG', '0.12345', 3, '٠٫١٢٣']\n    ]\n\n    // Reproduce the NumberFormats with ONLY our desired language.\n    for (const [code, unformatted, maxDecimals, expected] of tests) {\n      const intFormatter = new Intl.NumberFormat(code, { // oneFractionalDigit\n        minimumFractionDigits: 1,\n        maximumFractionDigits: 1\n      })\n      const sigFigFormatter = new Intl.NumberFormat(code, {\n        minimumSignificantDigits: 4,\n        maximumSignificantDigits: 4\n      })\n      for (const k in decimalFormatters) delete decimalFormatters[k] // cleanup\n      for (const k in fullPrecisionFormatters) delete fullPrecisionFormatters[k] // cleanup\n      const s = formatSigFigsWithFormatters(intFormatter, sigFigFormatter, parseFloatDefault(unformatted), maxDecimals, code)\n      if (s !== expected) console.log(`TEST FAILED: f('${code}', ${unformatted}, ${maxDecimals}) => '${s}' != '${expected}'}`)\n      else console.log(`✔️ f('${code}', ${unformatted}, ${maxDecimals}) => ${s} ✔️`)\n    }\n  }\n\n  window.testFormatRateFullPrecision = () => {\n    const tests: [number, number, number, number, string][] = [\n      // Two utxo assets with a conventional rate of 0.15. Conventional rate\n      // step is 100 / 1e8 = 1e-6, so there should be 6 decimal digits.\n      [1.5e7, 100, 1e8, 1e8, '0.150000'],\n      // USDC quote -> utxo base with a rate of $10 / 1 XYZ. USDC has an\n      // conversion factor of 1e6, so $10 encodes to 1e7, 1 XYZ encodes to 1e8,\n      // encoded rate is 1e7 / 1e8 * 1e8 = 1e7, bFactor / qFactor is 1e2.\n      // The conventional rate step is 200 / 1e8 * 1e2 = 2e-4, so using\n      // rateStepDigits, we should get 4 decimal digits.\n      [1e7, 200, 1e6, 1e8, '10.0000'],\n      // Set a rate of 1 atom USDC for 0.01 BTC. That atomic rate will be 1 /\n      // 1e6 = 1e-6. The encoded rate will be 1e-6 * 1e8 = 1e2. As long as our\n      // rate step divides evenly into 100, this should work. The conventional\n      // rate is 1e-6 / 1e-2 = 1e-4, so expect 4 decimal digits.\n      [1e2, 100, 1e6, 1e8, '0.0001'],\n      // DCR-ETH, expect 6 decimals.\n      [1.5e7, 1000, 1e9, 1e8, '0.015000'],\n      [1e6, 1000, 1e9, 1e8, '0.001000'],\n      [1e3, 1000, 1e9, 1e8, '0.000001'],\n      [100001000, 1000, 1e9, 1e8, '0.100001'],\n      [1000001000, 1000, 1e9, 1e8, '1.000001'],\n      // DCR-USDC, expect 3 decimals.\n      [1.5e7, 1000, 1e6, 1e8, '15.000'],\n      [1e6, 1000, 1e6, 1e8, '1.000'],\n      [1e3, 1000, 1e6, 1e8, '0.001'],\n      [101000, 1000, 1e6, 1e8, '0.101'],\n      [1001000, 1000, 1e6, 1e8, '1.001'],\n      // UTXO assets but with a rate step that's not a perfect power of 10.\n      // For a rate step of 500, a min rate would be e.g. rate step = 500.\n      // 5e2 / 1e8 = 5e-6 = 0.000005\n      [5e2, 500, 1e8, 1e8, '0.000005']\n    ]\n\n    for (const [encRate, rateStep, qFactor, bFactor, expEncoding] of tests) {\n      for (const k in fullPrecisionFormatters) delete fullPrecisionFormatters[k] // cleanup\n      const bui = { conventional: { conversionFactor: bFactor } } as any as UnitInfo\n      const qui = { conventional: { conversionFactor: qFactor } } as any as UnitInfo\n      const enc = Doc.formatRateFullPrecision(encRate, bui, qui, rateStep)\n      if (enc !== expEncoding) console.log(`TEST FAILED: f(${encRate}, ${bFactor}, ${qFactor}, ${rateStep}) => ${enc} != ${expEncoding}`)\n      else console.log(`✔️ f(${encRate}, ${bFactor}, ${qFactor}, ${rateStep}) => ${enc} ✔️`)\n    }\n  }\n}\n\nexport interface NumberInputOpts {\n  prec?: number\n  sigFigs?: boolean\n  changed?: (v: number) => void\n  min?: number\n  set?: (v: number, s: string) => void // called when setValue is called\n}\n\nexport class NumberInput {\n  input: PageElement\n  prec: number\n  fmt: (v: number, prec: number) => [number, string]\n  changed: (v: number) => void\n  set?: (v: number, s: string) => void\n  min: number\n\n  constructor (input: PageElement, opts: NumberInputOpts) {\n    this.input = input\n    this.prec = opts.prec ?? 0\n    this.fmt = opts.sigFigs ? toFourSigFigs : toPrecision\n    this.changed = opts.changed ?? (() => { /* pass */ })\n    this.set = opts.set\n    this.min = opts.min ?? 0\n\n    Doc.bind(input, 'change', () => { this.inputChanged() })\n  }\n\n  inputChanged () {\n    const { changed } = this\n    if (changed) changed(this.value())\n  }\n\n  setValue (v: number) {\n    this.input.value = String(v)\n    v = this.value()\n    if (this.set) this.set(v, this.input.value)\n  }\n\n  value () {\n    const { input, min, prec, fmt } = this\n    const rawV = Math.max(parseFloatDefault(input.value, min ?? 0), min ?? 0)\n    const [v, s] = fmt(rawV, prec ?? 0)\n    input.value = s\n    return v\n  }\n}\n\nexport interface IncrementalInputOpts extends NumberInputOpts {\n  inc?: number\n}\n\nexport class IncrementalInput extends NumberInput {\n  inc: number\n  opts: IncrementalInputOpts\n\n  constructor (box: PageElement, opts: IncrementalInputOpts) {\n    super(Doc.safeSelector(box, 'input'), opts)\n    this.opts = opts\n    this.inc = opts.inc ?? 1\n\n    const up = Doc.safeSelector(box, '.ico-arrowup')\n    const down = Doc.safeSelector(box, '.ico-arrowdown')\n\n    Doc.bind(up, 'click', () => { this.increment(1) })\n    Doc.bind(down, 'click', () => { this.increment(-1) })\n  }\n\n  setIncrementAndMinimum (inc: number, min: number) {\n    this.inc = inc\n    this.min = min\n  }\n\n  increment (sign: number) {\n    const { inc, min, input } = this\n    input.value = String(Math.max(this.value() + sign * inc, min))\n    this.inputChanged()\n  }\n}\n\nexport class MiniSlider {\n  track: PageElement\n  ball: PageElement\n  r: number\n  changed: (r: number) => void\n\n  constructor (box: PageElement, changed: (r: number) => void) {\n    this.changed = changed\n    this.r = 0\n\n    const color = document.createElement('div')\n    color.dataset.tmpl = 'color'\n    box.appendChild(color)\n    const track = this.track = document.createElement('div')\n    track.dataset.tmpl = 'track'\n    color.appendChild(track)\n    const ball = this.ball = document.createElement('div')\n    ball.dataset.tmpl = 'ball'\n    track.appendChild(ball)\n\n    Doc.bind(box, 'mousedown', (e: MouseEvent) => {\n      if (e.button !== 0) return\n      e.preventDefault()\n      e.stopPropagation()\n      const startX = e.pageX\n      const w = track.clientWidth\n      const startLeft = this.r * w\n      const left = (ee: MouseEvent) => Math.max(Math.min(startLeft + (ee.pageX - startX), w), 0)\n      const trackMouse = (ee: MouseEvent) => {\n        ee.preventDefault()\n        const l = left(ee)\n        this.r = l / w\n        ball.style.left = `${this.r * 100}%`\n        this.changed(this.r)\n      }\n      const mouseUp = (ee: MouseEvent) => {\n        trackMouse(ee)\n        Doc.unbind(document, 'mousemove', trackMouse)\n        Doc.unbind(document, 'mouseup', mouseUp)\n      }\n      Doc.bind(document, 'mousemove', trackMouse)\n      Doc.bind(document, 'mouseup', mouseUp)\n    })\n\n    Doc.bind(box, 'click', (e: MouseEvent) => {\n      if (e.button !== 0) return\n      const x = e.pageX\n      const m = Doc.layoutMetrics(track)\n      this.r = clamp((x - m.bodyLeft) / m.width, 0, 1)\n      ball.style.left = `${this.r * m.width}px`\n      this.changed(this.r)\n    })\n  }\n\n  setValue (r: number) {\n    this.r = clamp(r, 0, 1)\n    this.ball.style.left = `${this.r * 100}%`\n  }\n}\n\nexport function toPrecision (v: number, prec: number): [number, string] {\n  const ord = Math.pow(10, prec ?? 0)\n  v = Math.round(v * ord) / ord\n  let s = v.toFixed(prec)\n  if (prec > 0) {\n    while (s.endsWith('0')) s = s.substring(0, s.length - 1)\n    if (s.endsWith('.')) s = s.substring(0, s.length - 1)\n  }\n  return [v, s]\n}\n\nexport function toFourSigFigs (v: number, maxPrec: number): [number, string] {\n  const ord = Math.floor(Math.log10(Math.abs(v)))\n  if (ord >= 3) return [Math.round(v), v.toFixed(0)]\n  const prec = Math.min(4 - ord, maxPrec)\n  return toPrecision(v, prec)\n}\n\nexport function parseFloatDefault (inputValue: string | undefined, defaultValue?: number) {\n  const v = parseFloat((inputValue ?? '').replace(/,/g, ''))\n  if (!isNaN(v)) return v\n  return defaultValue ?? 0\n}\n\n/* clamp returns v if min <= v <= max, else min or max. */\nexport function clamp (v: number, min: number, max: number): number {\n  if (v < min) return min\n  if (v > max) return max\n  return v\n}\n\nexport async function setupCopyBtn (txt: string, textEl: PageElement, btnEl: PageElement, color: string) {\n  try {\n    await navigator.clipboard.writeText(txt)\n  } catch (err) {\n    console.error('Unable to copy: ', err)\n  }\n  const textOriginalColor = textEl.style.color\n  const btnOriginalColor = btnEl.style.color\n  textEl.style.color = color\n  btnEl.style.color = color\n  setTimeout(() => {\n    textEl.style.color = textOriginalColor\n    btnEl.style.color = btnOriginalColor\n  }, 350)\n}\n","declare global {\n  interface Window {\n    log: (...args: any) => void\n    enableLogger: (loggerID: string, enable: boolean) => void\n    recordLogger: (loggerID: string, enable: boolean) => void\n    dumpLogger: (loggerID: string) => void\n    mmstatus: () => Promise<MarketMakingStatus>\n    testFormatFourSigFigs: () => void\n    testFormatRateFullPrecision: () => void\n    user: () => User\n    cexBook: () => Promise<void>\n    mmStatus: () => MarketMakingStatus\n    isWebview?: () => boolean\n    webkit: any | undefined\n    openUrl: (url: string) => void\n    sendOSNotification (title: string, body?: string): void\n    clearLocale (): void\n  }\n}\n\nexport enum ConnectionStatus {\n  Disconnected = 0,\n  Connected = 1,\n  InvalidCert = 2,\n}\n\nexport interface BondOptions {\n  bondAssetID: number\n  targetTier: number\n  maxBondedAmt: number\n}\n\nexport interface Reputation {\n  bondedTier: number\n  penalties: number\n  legacyTier: boolean\n  score: number\n}\n\nexport interface ExchangeAuth {\n  rep: Reputation\n  bondAssetID: number\n  pendingStrength: number\n  weakStrength: number\n  liveStrength: number\n  targetTier: number\n  effectiveTier: number\n  maxBondedAmt: number\n  penaltyComps: number\n  pendingBonds: PendingBondState[]\n  expiredBonds: any[]\n  compensation: number\n}\n\nexport interface Exchange {\n  host: string\n  acctID: string\n  auth: ExchangeAuth\n  markets: Record<string, Market>\n  assets: Record<number, Asset>\n  connectionStatus: ConnectionStatus\n  viewOnly: boolean\n  bondAssets: Record<string, BondAsset>\n  candleDurs: string[]\n  maxScore: number\n  penaltyThreshold: number\n  disabled:boolean\n}\n\nexport interface Candle {\n  startStamp: number\n  endStamp: number\n  matchVolume: number\n  quoteVolume: number\n  highRate: number\n  lowRate: number\n  startRate: number\n  endRate: number\n}\n\nexport interface CandlesPayload {\n  dur: string\n  ms: number\n  candles: Candle[]\n}\n\nexport interface Market {\n  name: string\n  baseid: number\n  basesymbol: string\n  quoteid: number\n  quotesymbol: string\n  lotsize: number\n  parcelsize: number\n  ratestep: number\n  epochlen: number\n  startepoch: number\n  buybuffer: number\n  orders: Order[]\n  spot: Spot | undefined\n  atomToConv: number\n  inflight: InFlightOrder[]\n  minimumRate: number\n}\n\nexport interface InFlightOrder extends Order {\n  tempID: number\n}\n\nexport interface Order {\n  host: string\n  baseID: number\n  baseSymbol: string\n  quoteID: number\n  quoteSymbol: string\n  market: string\n  type: number\n  id: string\n  stamp: number\n  submitTime: number\n  sig: string\n  status: number\n  epoch: number\n  qty: number\n  sell: boolean\n  filled: number\n  matches: Match[]\n  cancelling: boolean\n  canceled: boolean\n  feesPaid: FeeBreakdown\n  fundingCoins: Coin[]\n  accelerationCoins: Coin[]\n  lockedamt: number\n  rate: number // limit only\n  tif: number // limit only\n  targetOrderID: string // cancel only\n  readyToTick: boolean\n}\n\nexport interface Match {\n  matchID: string\n  status: number\n  active: boolean\n  revoked: boolean\n  rate: number\n  qty: number\n  side: number\n  feeRate: number\n  swap: Coin\n  counterSwap: Coin\n  redeem: Coin\n  counterRedeem: Coin\n  refund: Coin\n  stamp: number\n  isCancel: boolean\n}\n\nexport interface Spot {\n  stamp: number\n  baseID: number\n  quoteID: number\n  rate: number\n  bookVolume: number // Unused?\n  change24: number\n  vol24: number\n  low24: number\n  high24: number\n}\n\nexport interface Asset {\n  id: number\n  symbol: string\n  version: number\n  maxFeeRate: number\n  swapSize: number\n  swapSizeBase: number\n  redeemSize: number\n  swapConf: number\n  unitInfo: UnitInfo\n}\n\nexport interface BondAsset {\n  ver: number\n  id: number\n  confs: number\n  amount: number\n}\n\nexport interface PendingBondState {\n  symbol: string\n  assetID: number\n  coinID: string\n  confs: number\n}\n\nexport interface FeeBreakdown {\n  swap: number\n  redemption: number\n}\n\nexport interface SupportedAsset {\n  id: number\n  symbol: string\n  name: string\n  wallet: WalletState\n  info?: WalletInfo\n  token?: Token\n  unitInfo: UnitInfo\n  walletCreationPending: boolean\n}\n\nexport interface Token {\n  parentID: number\n  name: string\n  unitInfo: UnitInfo\n  contractAddress: string\n  definition: WalletDefinition\n}\n\nexport enum ApprovalStatus {\n  Approved = 0,\n  Pending = 1,\n  NotApproved = 2\n}\n\nexport interface FeeState {\n  rate: number\n  send: number\n  swap: number\n  redeem: number\n  refund: number\n  stampMS: number\n}\n\nexport interface SyncStatus {\n  synced: boolean\n  targetHeight: number\n  startingBlocks: number\n  blocks: number\n  txs: number | undefined\n}\n\nexport interface WalletState {\n  symbol: string\n  assetID: number\n  version: number\n  type: string\n  traits: number\n  open: boolean\n  running: boolean\n  disabled: boolean\n  balance: WalletBalance\n  address: string\n  units: string\n  encrypted: boolean\n  peerCount: number\n  synced: boolean\n  syncProgress: number\n  syncStatus: SyncStatus\n  approved: Record<number, ApprovalStatus>\n  feeState?: FeeState\n}\n\nexport interface WalletInfo {\n  name: string\n  version: number\n  availablewallets: WalletDefinition[]\n  versions: number[]\n  emptyidx: number\n  unitinfo: UnitInfo\n}\n\nexport interface WalletBalance {\n  available: number\n  immature: number\n  locked: number\n  stamp: string // time.Time\n  orderlocked: number\n  contractlocked: number\n  bondlocked: number\n  bondReserves: number\n  reservesDeficit: number\n  other: Record<string, CustomBalance>\n}\n\nexport interface CustomBalance {\n  amt: number\n  locked: boolean\n}\n\nexport interface WalletDefinition {\n  seeded: boolean\n  type: string\n  tab: string\n  description: string\n  configpath: string\n  configopts: ConfigOption[]\n  multifundingopts: OrderOption[]\n  noauth: boolean\n  guidelink: string\n}\n\nexport interface ConfigOption {\n  key: string\n  displayname: string\n  description: string\n  default: any\n  max: any\n  min: any\n  noecho: boolean\n  isboolean: boolean\n  isdate: boolean\n  disablewhenactive: boolean\n  isBirthdayConfig: boolean\n  repeatable?: string\n  repeatN?: number\n  regAsset?: number\n  required?: boolean\n  dependsOn?: string\n}\n\nexport interface Coin {\n  id: string\n  stringID: string\n  assetID: number\n  symbol: string\n  confs: Confirmations\n}\n\nexport interface Confirmations {\n  required: number\n  count: number\n}\n\nexport interface UnitInfo {\n  atomicUnit: string\n  conventional: Denomination\n  denominations: Denomination[]\n  feeRateDenom: string\n}\n\nexport interface Denomination {\n  unit: string\n  conversionFactor: number\n}\n\nexport interface ExtensionConfiguredWallet {\n  hiddenFields: string[]\n  disableWalletType: boolean\n  disablePassword: boolean\n  disableStaking: boolean\n  disablePrivacy: boolean\n}\n\nexport interface ExtensionModeConfig {\n  name: string\n  restrictedWallets: Record<string, ExtensionConfiguredWallet>\n}\n\nexport interface User {\n  exchanges: Record<string, Exchange>\n  inited: boolean\n  seedgentime: number\n  assets: Record<number, SupportedAsset>\n  fiatRates: Record<number, number>\n  bots: BotReport[]\n  net: number\n  extensionModeConfig: ExtensionModeConfig\n  actions: ActionRequiredNote[]\n}\n\nexport interface CoreNote {\n  type: string\n  topic: string\n  subject: string\n  details: string\n  severity: number\n  stamp: number\n  acked: boolean\n  id: string\n}\n\nexport interface BondNote extends CoreNote {\n  asset: number\n  confirmations: number\n  dex: string\n  coinID: string | null\n  tier: number | null\n  auth: ExchangeAuth | null\n}\n\nexport interface ReputationNote extends CoreNote {\n  host: string\n  rep: Reputation\n}\n\nexport interface BalanceNote extends CoreNote {\n  assetID: number\n  balance: WalletBalance\n}\n\nexport interface RateNote extends CoreNote {\n  fiatRates: Record<number, number>\n}\n\nexport interface WalletConfigNote extends CoreNote {\n  wallet: WalletState\n}\n\nexport interface WalletSyncNote extends CoreNote {\n  assetID: number\n  syncStatus: SyncStatus\n  syncProgress: number\n}\n\nexport type WalletStateNote = WalletConfigNote\n\nexport interface WalletCreationNote extends CoreNote {\n  assetID: number\n}\n\nexport interface BaseWalletNote {\n  route: string\n  assetID: number\n}\n\nexport interface TipChangeNote extends BaseWalletNote {\n  tip: number\n  data: any\n}\n\nexport interface CustomWalletNote extends BaseWalletNote {\n  payload: any\n}\n\nexport interface TransactionNote extends BaseWalletNote {\n  transaction: WalletTransaction\n  new: boolean\n}\n\nexport interface ActionRequiredNote extends BaseWalletNote {\n  uniqueID: string\n  actionID: string\n  payload: any\n}\n\nexport interface ActionResolvedNote extends BaseWalletNote {\n  uniqueID: string\n}\n\nexport interface TransactionActionNote {\n  tx: WalletTransaction\n  nonce: number\n  newFees: number\n}\n\nexport interface WalletNote extends CoreNote {\n  payload: BaseWalletNote\n}\n\nexport interface CoreActionRequiredNote extends CoreNote {\n  payload: ActionRequiredNote\n}\n\nexport interface RejectedRedemptionData {\n  assetID: number\n  orderID: string\n  coinID: string\n  coinFmt: string\n}\n\nexport interface SpotPriceNote extends CoreNote {\n  host: string\n  spots: Record<string, Spot>\n}\n\nexport interface RunStatsNote extends CoreNote {\n  host: string\n  baseID: number\n  quoteID: number\n  stats?: RunStats\n}\n\nexport interface RunEventNote extends CoreNote {\n  host: string\n  baseID: number\n  quoteID: number\n  startTime: number\n  event: MarketMakingEvent\n}\n\nexport interface MakerProgram {\n  host: string\n  baseID: number\n  quoteID: number\n  lots: number\n  oracleWeighting: number\n  oracleBias: number\n  driftTolerance: number\n  gapFactor: number\n  gapStrategy: string\n}\n\nexport interface BotOrder {\n  host: string\n  marketID: string\n  orderID: string\n}\n\nexport interface BotReport {\n  programID: number\n  program: MakerProgram\n  running: boolean\n  orders: BotOrder\n}\n\nexport interface LotFees {\n  swap: number\n  redeem: number\n  refund: number\n}\n\nexport interface LotFeeRange {\n  max: LotFees\n  estimated: LotFees\n}\n\nexport interface AssetBookingFees extends LotFeeRange {\n  bookingFeesPerLot: number\n  bookingFeesPerCounterLot: number\n  bookingFees: number\n  swapReservesFactor: number // (1 + orderReservesFactor)\n  redeemReservesFactor: number\n  tokenFeesPerSwap: number\n}\n\nexport interface BookingFees {\n  base: AssetBookingFees\n  quote:AssetBookingFees\n}\n\nexport interface MarketReport {\n  price: number\n  oracles: OracleReport[]\n  baseFiatRate: number\n  quoteFiatRate: number\n  baseFees: LotFeeRange\n  quoteFees: LotFeeRange\n}\n\nexport interface MatchNote extends CoreNote {\n  orderID: string\n  match: Match\n  host: string\n  marketID: string\n}\n\nexport interface ConnEventNote extends CoreNote {\n  host: string\n  connectionStatus: ConnectionStatus\n}\n\nexport interface OrderNote extends CoreNote {\n  order: Order\n  tempID: number\n}\n\nexport interface RecentMatch {\n  rate: number\n  qty: number\n  stamp: number\n  sell: boolean\n}\n\nexport interface EpochNote extends CoreNote {\n  host: string\n  marketID: string\n  epoch: number\n}\n\nexport interface APIResponse {\n  requestSuccessful: boolean\n  ok: boolean\n  msg: string\n  err?: string\n}\n\nexport interface LogMessage {\n  time: string\n  msg: string\n}\n\nexport interface NoteElement extends HTMLElement {\n  note: CoreNote\n}\n\nexport interface BalanceResponse extends APIResponse {\n  balance: WalletBalance\n}\n\nexport interface LayoutMetrics {\n  bodyTop: number\n  bodyLeft: number\n  width: number\n  height: number\n  centerX: number\n  centerY: number\n}\n\nexport interface PageElement extends HTMLElement {\n  value?: string\n  src?: string\n  files?: FileList\n  checked?: boolean\n  href?: string\n  htmlFor?: string\n  name?: string\n  options?: HTMLOptionElement[]\n  selectedIndex?: number\n  disabled?: boolean\n}\n\nexport interface BooleanConfig {\n  reason: string\n}\n\nexport interface XYRangePoint {\n  label: string\n  x: number\n  y: number\n}\n\nexport interface XYRange {\n  start: XYRangePoint\n  end: XYRangePoint\n  xUnit: string\n  yUnit: string\n  roundX?: boolean\n  roundY?: boolean\n}\n\nexport interface OrderOption extends ConfigOption {\n  boolean?: BooleanConfig\n  xyRange?: XYRange\n  showByDefault?: boolean\n  quoteAssetOnly?: boolean\n}\n\nexport interface SwapEstimate {\n  lots: number\n  value: number\n  maxFees: number\n  realisticWorstCase: number\n  realisticBestCase: number\n  feeReservesPerLot: number\n}\n\nexport interface RedeemEstimate {\n  realisticBestCase: number\n  realisticWorstCase: number\n}\n\nexport interface PreSwap {\n  estimate: SwapEstimate\n  options: OrderOption[]\n}\n\nexport interface PreRedeem {\n  estimate: RedeemEstimate\n  options: OrderOption[]\n}\n\nexport interface OrderEstimate {\n  swap: PreSwap\n  redeem: PreRedeem\n}\n\nexport interface MaxOrderEstimate {\n  swap: SwapEstimate\n  redeem: RedeemEstimate\n}\n\nexport interface MaxSell {\n  maxSell: MaxOrderEstimate\n}\n\nexport interface MaxBuy {\n  maxBuy: MaxOrderEstimate\n}\n\nexport interface TradeForm {\n  host: string\n  isLimit: boolean\n  sell: boolean\n  base: number\n  quote: number\n  qty: number\n  rate: number\n  tifnow: boolean\n  options: Record<string, any>\n}\n\nexport interface BookUpdate {\n  action: string\n  host: string\n  marketID: string\n  matchesSummary: RecentMatch[]\n  payload: any\n}\n\nexport interface MiniOrder {\n  qty: number\n  qtyAtomic: number\n  rate: number\n  msgRate: number\n  epoch: number\n  sell: boolean\n  token: string\n}\n\nexport interface CoreOrderBook {\n  sells: MiniOrder[]\n  buys: MiniOrder[]\n  epoch: MiniOrder[]\n  recentMatches: RecentMatch[]\n}\n\nexport interface MarketOrderBook {\n  base: number\n  quote: number\n  book: CoreOrderBook\n}\n\nexport interface RemainderUpdate {\n  token: string\n  qty: number\n  qtyAtomic: number\n}\n\nexport interface OrderFilterMarket {\n  baseID: number\n  quoteID: number\n}\n\nexport interface OrderFilter {\n  n?: number\n  offset?: string\n  hosts?: string[]\n  assets?: number[]\n  market?: OrderFilterMarket\n  statuses?: number[]\n}\n\nexport interface OrderPlacement {\n  lots: number\n  gapFactor: number\n}\n\nexport interface AutoRebalanceConfig {\n  minBaseTransfer: number\n  minQuoteTransfer: number\n}\n\nexport interface BasicMarketMakingConfig {\n  gapStrategy: string\n  sellPlacements: OrderPlacement[]\n  buyPlacements: OrderPlacement[]\n  driftTolerance: number\n}\n\nexport interface ArbMarketMakingPlacement {\n  lots: number\n  multiplier: number\n}\n\nexport interface ArbMarketMakingConfig {\n  buyPlacements: ArbMarketMakingPlacement[]\n  sellPlacements: ArbMarketMakingPlacement[]\n  profit: number\n  driftTolerance: number\n  orderPersistence: number\n}\n\nexport interface SimpleArbConfig {\n  profitTrigger: number\n  maxActiveArbs: number\n  numEpochsLeaveOpen: number\n}\n\nexport interface BotCEXCfg {\n  name: string\n  autoRebalance?: AutoRebalanceConfig\n}\n\nexport interface BotBalanceAllocation {\n  dex: Record<number, number>\n  cex: Record<number, number>\n}\n\nexport interface BotAssetConfig {\n  swapFeeN: number\n  orderReservesFactor: number\n  slippageBufferFactor: number\n  transferFactor: number\n}\n\nexport interface UIConfig {\n  baseConfig: BotAssetConfig\n  quoteConfig: BotAssetConfig\n  simpleArbLots?: number\n  cexRebalance: boolean\n}\n\nexport interface StartConfig extends MarketWithHost {\n  autoRebalance?: AutoRebalanceConfig\n  alloc: BotBalanceAllocation\n}\n\nexport interface BotConfig {\n  host: string\n  baseID: number\n  quoteID: number\n  baseWalletOptions?: Record<string, string>\n  quoteWalletOptions?: Record<string, string>\n  cexName: string\n  uiConfig: UIConfig\n  basicMarketMakingConfig?: BasicMarketMakingConfig\n  arbMarketMakingConfig?: ArbMarketMakingConfig\n  simpleArbConfig?: SimpleArbConfig\n}\n\nexport interface CEXConfig {\n  name: string\n  apiKey: string\n  apiSecret: string\n}\n\nexport interface MarketWithHost {\n  host: string\n  baseID: number\n  quoteID: number\n}\n\nexport interface MMCEXStatus {\n  config: CEXConfig\n  connected: boolean\n  connectErr: string\n  markets: Record<string, CEXMarket>\n  balances: Record<number, ExchangeBalance>\n}\n\nexport interface BotBalance {\n  available: number\n  locked: number\n  pending: number\n  reserved: number\n}\n\nexport interface BotBalances {\n  dex: BotBalance\n  cex: BotBalance\n}\n\nexport interface BotInventory {\n  avail: number\n  locked: number // includes BotBalance.reserved\n  total: number // avail + locked\n}\n\nexport interface RunningBotInventory {\n  avail: number\n  locked: number\n  dex: BotInventory\n  cex: BotInventory\n}\n\nexport interface CEXNotification extends CoreNote {\n  cexName: string\n  note: any\n}\n\nexport interface CEXBalanceUpdate {\n  assetID: number\n  balance: ExchangeBalance\n}\n\nexport interface EpochReportNote extends CoreNote {\n  host: string\n  baseID: number\n  quoteID: number\n  report?: EpochReport\n}\n\nexport interface CEXProblemsNote extends CoreNote {\n  host: string\n  baseID: number\n  quoteID: number\n  problems?: CEXProblems\n}\n\nexport interface FeeEstimates extends LotFeeRange {\n  bookingFeesPerLot: number\n  bookingFees: number\n  tokenFeesPerSwap: number\n}\n\nexport interface ProjectedAlloc {\n  // book is inventory dedicated either to active orders for basicmm and arbmm,\n  // or on reserve for orders in the case of basicarb. book + bookingFees is the\n  // starvation threshold for DEX, meaning it's impossible to start a bot\n  // unstarved if there no way to get book + bookingFees to Bison Wallet. A user\n  // could potentially adjust order reserves or swap fee reserves to free up\n  // more funds, but with possible degradation of bot performance.\n  book: number\n  // booking fees is funding dedicated to covering the fees for funded orders.\n  // bookingFees are in the units of the parent chain for token assets.\n  bookingFees: number\n  // swapFeeReserves is only required for token assets. These are fees\n  // reserved for funding swaps. These fees are only debited, so will definitely\n  // run out eventually, but we'll get a UI that enabled manual and/or auto\n  // refill soon. swapFeeReserves are in the units of the parent chain.\n  swapFeeReserves: number\n  // cex is the inventory dedicated to funding counter-orders on cex for an\n  // arbmm or simplearb bot. cex is the starvation threshold for CEX.\n  cex: number\n  // orderReserves is inventory reserved for facilitating withdraws and\n  // deposits or for replacing matched orders. It's a good idea to have a\n  // little extra around, otherwise a trade sequence gone wrong could put\n  // the bot in a starved or unbalanced state.\n  orderReserves: number\n  // slippageBuffer is only required for the quote asset. This accounts for\n  // variations in rate, because the quote asset's \"lot size\" varies with\n  // rate. If the rate goes down, the quote-converted lot size goes up, so\n  // we'll let the user choose to reserve a little extra for this case.\n  slippageBuffer: number\n}\n\nexport interface FeeGapStats {\n  basisPrice: number\n  feeGap: number\n  remoteGap: number\n  roundTripFees: number\n}\n\nexport interface RunStats {\n  initialBalances: Record<number, number>\n  dexBalances: Record<number, BotBalance>\n  cexBalances: Record<number, BotBalance>\n  profitLoss: ProfitLoss\n  startTime: number\n  pendingDeposits: number\n  pendingWithdrawals: number\n  completedMatches: number\n  tradedUSD: number\n  feeGap: FeeGapStats\n}\n\nexport interface StampedError {\n  stamp: number\n  error: string\n}\n\nexport interface BotProblems {\n  walletNotSynced: Record<number, boolean>\n  noWalletPeers: Record<number, boolean>\n  accountSuspended: boolean\n  userLimitTooLow: boolean\n  noPriceSource: boolean\n  oracleFiatMismatch: boolean\n  cexOrderbookUnsynced: boolean\n  causesSelfMatch: boolean\n  unknownError: string\n}\n\nexport interface TradePlacement {\n  rate: number\n  lots: number\n  standingLots: number\n  orderedLots: number\n  counterTradeRate: number\n  requiredDex: Record<number, number>\n  requiredCex: number\n  usedDex: Record<number, number>\n  usedCex: number\n  error?: BotProblems\n}\n\nexport interface OrderReport {\n  placements: TradePlacement[]\n  fees: LotFeeRange\n  availableDexBals: Record<number, BotBalance>\n  requiredDexBals: Record<number, number>\n  remainingDexBals: Record<number, number>\n  usedDexBals: Record<number, number>\n  availableCexBal: BotBalance\n  requiredCexBal: number\n  remainingCexBal: number\n  usedCexBal: number\n  error?: BotProblems\n}\n\nexport interface EpochReport {\n  epochNum: number\n  preOrderProblems?: BotProblems\n  buysReport?: OrderReport\n  sellsReport?: OrderReport\n}\n\nexport interface CEXProblems {\n  depositErr: Record<number, StampedError>\n  withdrawErr: Record<number, StampedError>\n  tradeErr: StampedError\n}\n\nexport interface MMBotStatus {\n  config: BotConfig\n  running: boolean\n  runStats?: RunStats\n  latestEpoch?: EpochReport\n  cexProblems?: CEXProblems\n}\n\nexport interface MarketMakingStatus {\n  cexes: Record<string, MMCEXStatus>\n  bots: MMBotStatus[]\n}\n\nexport interface DEXOrderEvent {\n  id: string\n  rate: number\n  qty: number\n  sell: boolean\n  transactions: WalletTransaction[]\n}\n\nexport interface CEXOrderEvent {\n  id: string\n  rate: number\n  qty: number\n  sell: boolean\n  baseFilled: number\n  quoteFilled: number\n}\n\nexport interface DepositEvent {\n  assetID: number\n  transaction: WalletTransaction\n  cexCredit: number\n}\n\nexport interface WithdrawalEvent {\n  id: string\n  assetID: number\n  transaction: WalletTransaction\n  cexDebit: number\n}\n\nexport interface BalanceEffects {\n  settled: Record<number, number>\n  pending: Record<number, number>\n  locked: Record<number, number>\n  reserved: Record<number, number>\n}\n\nexport interface MarketMakingEvent {\n  id: number\n  timestamp: number\n  balanceEffects: BalanceEffects\n  pending: boolean\n  dexOrderEvent?: DEXOrderEvent\n  cexOrderEvent?: CEXOrderEvent\n  depositEvent?: DepositEvent\n  withdrawalEvent?: WithdrawalEvent\n}\n\ninterface MarketDay {\n  vol: number\n  quoteVol: number\n  priceChange: number\n  priceChangePct: number\n  avgPrice: number\n  lastPrice: number\n  openPrice: number\n  highPrice: number\n  lowPrice: number\n}\n\nexport interface CEXMarket {\n  baseID: number\n  quoteID: number\n  baseMinWithdraw: number\n  quoteMinWithdraw: number\n  day: MarketDay\n}\n\nexport interface OracleReport {\n  host: string\n  usdVol: number\n  bestBuy: number\n  bestSell: number\n}\n\nexport interface ExchangeBalance {\n  available: number\n  locked: number\n}\n\n// changing the order of the elements in this enum will affect\n// the sorting of the peers table in wallets.ts.\nexport enum PeerSource {\n  WalletDefault,\n  UserAdded,\n  Discovered,\n}\n\nexport interface BalanceState {\n  fiatRates: Record<number, number>\n  balances: Record<number, BotBalance>\n  invMods: Record<number, number>\n}\n\nexport interface Amount {\n  atoms: number\n  conventional: number\n  fmt: string\n  usd: number\n  fmtUSD: string\n}\n\nexport interface ProfitLoss {\n  initial: Record<number, Amount>\n  initialUSD: number\n  mods: Record<number, Amount>\n  modsUSD: number\n  final: Record<number, Amount>\n  finalUSD: number\n  diffs: Record<number, Amount>\n  profit: number\n  profitRatio: number\n}\n\nexport interface StampedBotConfig {\n  timestamp: number\n  cfg: BotConfig\n}\n\nexport interface MarketMakingRunOverview {\n  endTime: number\n  cfgs: StampedBotConfig[]\n  initialBalances: Record<number, number>\n  profitLoss: ProfitLoss\n  finalState: BalanceState\n}\n\nexport interface WalletPeer {\n  addr: string\n  source: PeerSource\n  connected: boolean\n}\n\nexport interface TicketTransaction {\n  hash: string\n  ticketPrice: number\n  fees: number\n  stamp: number\n  blockHeight: number\n}\n\nexport interface Ticket {\n  tx: TicketTransaction\n  status: number\n  spender: string\n}\n\nexport interface TBChoice {\n  id: string\n  description: string\n}\n\nexport interface TBAgenda {\n  id: string\n  description: string\n  currentChoice: string\n  choices: TBChoice[]\n}\n\nexport interface TKeyPolicyResult {\n  key: string\n  policy: string\n  ticket?: string\n}\n\nexport interface TBTreasurySpend {\n  hash: string\n  value: number\n  currentPolicy: string\n}\n\nexport interface Stances {\n  agendas: TBAgenda[]\n  tspends: TBTreasurySpend[]\n  treasuryKeys: TKeyPolicyResult[]\n}\n\nexport interface TicketStats {\n  totalRewards: number\n  ticketCount: number\n  votes: number\n  revokes: number\n  mempool: number\n  queued: number\n}\n\nexport interface TicketStakingStatus {\n  ticketPrice: number\n  votingSubsidy: number\n  vsp: string\n  isRPC: boolean\n  tickets: Ticket[]\n  stances: Stances\n  stats: TicketStats\n}\n\n// VotingServiceProvider is information about a voting service provider.\nexport interface VotingServiceProvider {\n  url: string\n  network: number\n  launched: number\n  lastUpdated: number\n  apiVersions: number[]\n  feePercentage: number\n  closed: boolean\n  voting: number\n  voted: number\n  revoked: number\n  vspdVersion: string\n  blockHeight: number\n  netShare: number\n}\n\nexport interface BondTxInfo {\n  bondID: string\n  lockTime: number\n  accountID: string\n}\n\nexport interface WalletTransaction {\n  type: number\n  id: string\n  amount: number\n  fees: number\n  timestamp: number\n  blockNumber: number\n  tokenID?: number\n  recipient?: string\n  bondInfo?: BondTxInfo\n  additionalData: Record<string, string>\n}\n\nexport interface TxHistoryResult {\n  txs : WalletTransaction[]\n  lastTx: boolean\n}\n\nexport const PrepaidBondID = 2147483647\n\nexport interface Application {\n  assets: Record<number, SupportedAsset>\n  seedGenTime: number\n  user: User\n  mmStatus: MarketMakingStatus\n  header: HTMLElement\n  headerSpace: HTMLElement\n  walletMap: Record<number, WalletState>\n  exchanges: Record<string, Exchange>\n  fiatRatesMap: Record<number, number>\n  showPopups: boolean\n  commitHash: string\n  authed: boolean\n  start (): Promise<void>\n  reconnected (): void\n  fetchUser (): Promise<User | void>\n  fetchMMStatus (): Promise<User | void>\n  loadPage (page: string, data?: any, skipPush?: boolean): Promise<boolean>\n  attach (data: any): void\n  bindTooltips (ancestor: HTMLElement): void\n  bindUrlHandlers (ancestor: HTMLElement): void\n  attachHeader (): void\n  updateMarketElements (ancestor: PageElement, baseID: number, quoteID: number, xc?: Exchange): void\n  showDropdown (icon: HTMLElement, dialog: HTMLElement): void\n  ackNotes (): void\n  setNoteTimes (noteList: HTMLElement): void\n  bindInternalNavigation (ancestor: HTMLElement): void\n  updateMenuItemsDisplay (): void\n  attachCommon (node: HTMLElement): void\n  updateBondConfs (dexAddr: string, coinID: string, confs: number, assetID: number): void\n  handleBondNote (note: BondNote): void\n  loggedIn (notes: CoreNote[], pokes: CoreNote[]): void\n  setPokes(pokes: CoreNote[]): void\n  botStatus (host: string, baseID: number, quoteID: number): MMBotStatus | undefined\n  notify (note: CoreNote): void\n  log (loggerID: string, ...msg: any): void\n  prependPokeElement (note: CoreNote): void\n  prependNoteElement (note: CoreNote, skipSave?: boolean): void\n  prependListElement (noteList: HTMLElement, note: CoreNote, el: NoteElement): void\n  loading (el: HTMLElement): () => void\n  orders (host: string, mktID: string): Order[]\n  haveActiveOrders (assetID: number): boolean\n  order (oid: string): Order | null\n  canAccelerateOrder(order: Order): boolean\n  unitInfo (assetID: number, xc?: Exchange): UnitInfo\n  baseChainSymbol (assetID: number): string\n  extensionWallet (assetID: number): ExtensionConfiguredWallet | undefined\n  conventionalRate (baseID: number, quoteID: number, encRate: number, xc?: Exchange): number\n  walletDefinition (assetID: number, walletType: string): WalletDefinition\n  currentWalletDefinition (assetID: number): WalletDefinition\n  fetchBalance (assetID: number): Promise<WalletBalance>\n  checkResponse (resp: APIResponse): boolean\n  signOut (): Promise<void>\n  registerNoteFeeder (receivers: Record<string, (n: CoreNote) => void>): void\n  txHistory(assetID: number, n: number, after?: string): Promise<TxHistoryResult>\n  getWalletTx(assetID: number, txid: string): WalletTransaction | undefined\n  clearTxHistory(assetID: number): void\n  parentAsset(assetID: number): SupportedAsset\n  needsCustomProvider (assetID: number): Promise<boolean>\n}\n\n// TODO: Define an interface for Application?\nlet application: Application\n\nexport function registerApplication (a: Application) {\n  application = a\n}\n\nexport function app (): Application {\n  return application\n}\n","import Doc from './doc'\nimport {\n  PageElement,\n  XYRange,\n  OrderOption\n} from './registry'\n\ninterface OptionsReporters {\n  enable: () => void\n  disable: () => void\n}\n\n// Having the caller set these vars on load using an exported function makes\n// life easier.\nlet orderOptTmpl: HTMLElement, booleanOptTmpl: HTMLElement, rangeOptTmpl: HTMLElement\n\n// setOptionTemplates sets the package vars for the templates and application.\nexport function setOptionTemplates (page: Record<string, PageElement>): void {\n  [booleanOptTmpl, rangeOptTmpl, orderOptTmpl] = [page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl]\n}\n\nconst threeSigFigs = new Intl.NumberFormat(Doc.languages(), {\n  minimumSignificantDigits: 3,\n  maximumSignificantDigits: 3\n})\n\n/*\n * Option is a base class for option elements. Option stores some common\n * parameters and monitors the toggle switch, calling the child class's\n * enable/disable methods when the user manually turns the option on or off.\n */\nexport class Option {\n  opt: OrderOption\n  node: HTMLElement\n  tmpl: Record<string, PageElement>\n  on: boolean\n\n  constructor (opt: OrderOption, symbol: string, report: OptionsReporters) {\n    this.opt = opt\n    const node = this.node = orderOptTmpl.cloneNode(true) as HTMLElement\n    const tmpl = this.tmpl = Doc.parseTemplate(node)\n\n    tmpl.optName.textContent = opt.displayname\n    tmpl.tooltip.dataset.tooltip = opt.description\n\n    // const isBaseChain = (isSwapOption && order.sell) || (!isSwapOption && !order.sell)\n    // const symbol = isBaseChain ? this.baseSymbol() : this.quoteSymbol()\n    if (symbol) tmpl.chainIcon.src = Doc.logoPath(symbol)\n    else Doc.hide(tmpl.chainIcon)\n\n    this.on = false\n    Doc.bind(node, 'click', () => {\n      if (this.on) return\n      this.on = true\n      node.classList.add('selected')\n      report.enable()\n    })\n    Doc.bind(tmpl.toggle, 'click', e => {\n      if (!this.on) return\n      e.stopPropagation()\n      this.on = false\n      node.classList.remove('selected')\n      report.disable()\n    })\n  }\n}\n\n/*\n * BooleanOption is a simple on/off option with a short summary of it's effects.\n * BooleanOrderOption is the handler for a *BooleanConfig from client/asset.\n */\nexport class BooleanOption extends Option {\n  control: HTMLElement\n  changed: () => void\n  dict: Record<string, any>\n\n  constructor (opt: OrderOption, symbol: string, dict: Record<string, any>, changed: () => void) {\n    super(opt, symbol, {\n      enable: () => this.enable(),\n      disable: () => this.disable()\n    })\n    this.dict = dict\n    this.changed = () => changed()\n    if (opt.boolean === undefined) throw Error('not a boolean opt')\n    const cfg = opt.boolean\n    const control = this.control = booleanOptTmpl.cloneNode(true) as HTMLElement\n    // Append to parent's options div.\n    this.tmpl.controls.appendChild(control)\n    const tmpl = Doc.parseTemplate(control)\n    tmpl.reason.textContent = cfg.reason\n    this.on = typeof dict[opt.key] !== 'undefined' ? dict[opt.key] : opt.default\n    if (this.on) this.node.classList.add('selected')\n  }\n\n  store (): void {\n    if (this.on === this.opt.default) delete this.dict[this.opt.key]\n    else this.dict[this.opt.key] = this.on\n    this.changed()\n  }\n\n  enable (): void {\n    this.store()\n  }\n\n  disable (): void {\n    this.store()\n  }\n}\n\n/*\n * XYRangeOption is an order option that contains an XYRangeHandler. The logic\n * for handling the slider to is defined in XYRangeHandler so that the slider\n * can be used without being contained in an order option.\n */\nexport class XYRangeOption extends Option {\n  handler: XYRangeHandler\n  x: number\n  changed: () => void\n  dict: Record<string, any>\n\n  constructor (opt: OrderOption, symbol: string, dict: Record<string, any>, changed: () => void) {\n    super(opt, symbol, {\n      enable: () => this.enable(),\n      disable: () => this.disable()\n    })\n    this.dict = dict\n    this.changed = changed\n    if (opt.xyRange === undefined) throw Error('not an xy range opt')\n    const cfg = opt.xyRange\n    const setVal = dict[opt.key]\n    this.on = typeof setVal !== 'undefined'\n    if (this.on) {\n      this.node.classList.add('selected')\n      this.x = setVal\n    } else {\n      this.x = opt.default\n    }\n    const selected = () => { this.node.classList.add('selected') }\n    this.handler = new XYRangeHandler(cfg, this.x, { changed, selected, settingsDict: dict, settingsKey: opt.key })\n    this.tmpl.controls.appendChild(this.handler.control)\n  }\n\n  enable (): void {\n    this.dict[this.opt.key] = this.x\n    this.changed()\n  }\n\n  disable (): void {\n    delete this.dict[this.opt.key]\n    this.changed()\n  }\n\n  setValue (x: number): void {\n    this.handler.setValue(x)\n    this.on = true\n    this.node.classList.add('selected')\n  }\n}\n\ninterface AcceptOpts {\n  skipChange?: boolean\n  skipUpdate?: boolean // Implies skipChange\n}\n\ninterface RangeHandlerOpts {\n  roundY?: boolean\n  roundX?: boolean\n  updated?: (x:number, y:number) => void, // fires while dragging.\n  changed?: () => void, // does not fire while dragging but does when dragging ends.\n  selected?: () => void,\n  disabled?: boolean\n  settingsDict?: {[key: string]: any}\n  settingsKey?: string\n  convert?: (x: number, y: number) => any\n}\n\n/*\n * XYRangeHandler is the handler for an *XYRange from client/asset. XYRange\n * has a slider which allows adjusting the x and y, linearly between two limits.\n * The user can also manually enter values for x or y.\n */\nexport class XYRangeHandler {\n  control: HTMLElement\n  range: XYRange\n  tmpl: Record<string, PageElement>\n  initVal: number\n  settingsDict?: {[key: string]: any}\n  settingsKey: string\n  x: number\n  scrollingX: number\n  y: number\n  r: number\n  roundX: boolean\n  roundY: boolean\n  disabled: boolean\n  updated: (x:number, y:number) => void // called while dragging\n  changed: () => void // not called while dragging, but called when done dragging\n  selected: () => void\n  convert: (x: number, y: number) => any\n\n  constructor (\n    range: XYRange,\n    initVal: number,\n    opts: RangeHandlerOpts\n  ) {\n    const control = this.control = rangeOptTmpl.cloneNode(true) as HTMLElement\n    const tmpl = this.tmpl = Doc.parseTemplate(control)\n    tmpl.rangeLblStart.textContent = range.start.label\n    tmpl.rangeLblEnd.textContent = range.end.label\n    tmpl.xUnit.textContent = range.xUnit\n    tmpl.yUnit.textContent = range.yUnit\n    this.range = range\n    this.initVal = initVal\n    this.settingsDict = opts.settingsDict\n    this.settingsKey = opts.settingsKey ?? ''\n    this.roundX = Boolean(opts.roundX)\n    this.roundY = Boolean(opts.roundY)\n\n    this.setDisabled(Boolean(opts.disabled))\n    this.changed = opts.changed ?? (() => { /* pass */ })\n    this.selected = opts.selected ?? (() => { /* pass */ })\n    this.updated = opts.updated ?? (() => { /* pass */ })\n    this.convert = opts.convert || ((x: number) => x)\n\n    const { slider, handle } = tmpl\n    const rangeX = range.end.x - range.start.x\n    const rangeY = range.end.y - range.start.y\n    const normalizeX = (x: number) => (x - range.start.x) / rangeX\n\n    // r, x, and y will be updated by the various input event handlers. r is\n    // x (or y) normalized on its range, e.g. [x_min, x_max] -> [0, 1]\n    this.r = normalizeX(initVal)\n    this.scrollingX = this.x = initVal\n    this.y = this.r * rangeY + range.start.y\n    this.accept(this.scrollingX, { skipUpdate: true })\n\n    // Set up the handlers for the x and y text input fields.\n    const clickOutX = (e: MouseEvent) => {\n      if (this.disabled) return\n      if (e.type !== 'change' && e.target === tmpl.xInput) return\n      const s = tmpl.xInput.value\n      if (s) {\n        const xx = parseFloat(s)\n        if (!isNaN(xx)) {\n          this.scrollingX = clamp(xx, range.start.x, range.end.x)\n          this.r = normalizeX(this.scrollingX)\n          this.y = this.r * rangeY + range.start.y\n          this.accept(this.scrollingX)\n        }\n      }\n      Doc.hide(tmpl.xInput)\n      Doc.show(tmpl.x)\n      Doc.unbind(document, 'click', clickOutX)\n      this.changed()\n    }\n\n    Doc.bind(tmpl.x, 'click', e => {\n      if (this.disabled) return\n      Doc.hide(tmpl.x)\n      Doc.show(tmpl.xInput)\n      tmpl.xInput.focus()\n      tmpl.xInput.value = threeSigFigs.format(this.scrollingX)\n      Doc.bind(document, 'click', clickOutX)\n      e.stopPropagation()\n    })\n\n    Doc.bind(tmpl.xInput, 'change', clickOutX)\n\n    const clickOutY = (e: MouseEvent) => {\n      if (this.disabled) return\n      if (e.type !== 'change' && e.target === tmpl.yInput) return\n      const s = tmpl.yInput.value\n      if (s) {\n        const yy = parseFloat(s)\n        if (!isNaN(yy)) {\n          this.y = clamp(yy, range.start.y, range.end.y)\n          this.r = (this.y - range.start.y) / rangeY\n          this.scrollingX = range.start.x + this.r * rangeX\n          this.accept(this.scrollingX)\n        }\n      }\n      Doc.hide(tmpl.yInput)\n      Doc.show(tmpl.y)\n      Doc.unbind(document, 'click', clickOutY)\n      this.changed()\n    }\n\n    Doc.bind(tmpl.y, 'click', e => {\n      if (this.disabled) return\n      Doc.hide(tmpl.y)\n      Doc.show(tmpl.yInput)\n      tmpl.yInput.focus()\n      tmpl.yInput.value = threeSigFigs.format(this.y)\n      Doc.bind(document, 'click', clickOutY)\n      e.stopPropagation()\n    })\n\n    Doc.bind(tmpl.yInput, 'change', clickOutY)\n\n    // Read the slider.\n    Doc.bind(handle, 'mousedown', (e: MouseEvent) => {\n      if (this.disabled) return\n      if (e.button !== 0) return\n      e.preventDefault()\n      e.stopPropagation()\n      this.selected()\n      const startX = e.pageX\n      const w = slider.clientWidth - handle.offsetWidth\n      const startLeft = normalizeX(this.scrollingX) * w\n      const left = (ee: MouseEvent) => Math.max(Math.min(startLeft + (ee.pageX - startX), w), 0)\n      const trackMouse = (ee: MouseEvent, emit?: boolean) => {\n        ee.preventDefault()\n        this.r = left(ee) / w\n        this.scrollingX = this.r * rangeX + range.start.x\n        this.y = this.r * rangeY + range.start.y\n        this.accept(this.scrollingX, { skipChange: !emit })\n      }\n      const mouseUp = (ee: MouseEvent) => {\n        trackMouse(ee, true)\n        Doc.unbind(document, 'mousemove', trackMouse)\n        Doc.unbind(document, 'mouseup', mouseUp)\n        this.changed()\n      }\n      Doc.bind(document, 'mousemove', trackMouse)\n      Doc.bind(document, 'mouseup', mouseUp)\n    })\n\n    Doc.bind(tmpl.sliderBox, 'click', (e: MouseEvent) => {\n      if (this.disabled) return\n      if (e.button !== 0) return\n      const x = e.pageX\n      const m = Doc.layoutMetrics(tmpl.slider)\n      this.r = clamp((x - m.bodyLeft) / m.width, 0, 1)\n      this.scrollingX = this.r * rangeX + range.start.x\n      this.y = this.r * rangeY + range.start.y\n      this.accept(this.scrollingX)\n    })\n  }\n\n  setDisabled (disabled: boolean) {\n    this.control.classList.toggle('disabled', disabled)\n    this.disabled = disabled\n  }\n\n  setXLabel (s: string) {\n    this.tmpl.x.textContent = s\n  }\n\n  setYLabel (s: string) {\n    this.tmpl.y.textContent = s\n  }\n\n  accept (x: number, cfg?: AcceptOpts): void {\n    const tmpl = this.tmpl\n    if (this.roundX) x = Math.round(x)\n    if (this.roundY) this.y = Math.round(this.y)\n    tmpl.x.textContent = threeSigFigs.format(x)\n    tmpl.y.textContent = threeSigFigs.format(this.y)\n    if (this.roundY) tmpl.y.textContent = `${this.y}`\n    const rEffective = clamp(this.r, 0, 1)\n    tmpl.handle.style.left = `calc(${rEffective * 100}% - ${rEffective * 14}px)`\n    this.x = x\n    this.scrollingX = x\n    cfg = cfg ?? {}\n    if (this.settingsDict) this.settingsDict[this.settingsKey] = this.convert(this.x, this.y)\n    if (!cfg.skipUpdate) {\n      this.updated(x, this.y)\n      if (!cfg.skipChange) this.changed()\n    }\n  }\n\n  setValue (x: number, skipUpdate?: boolean) {\n    const range = this.range\n    this.r = (x - range.start.x) / (range.end.x - range.start.x)\n    this.y = range.start.y + this.r * (range.end.y - range.start.y)\n    this.accept(x, { skipUpdate })\n  }\n\n  modified (): boolean {\n    return this.x !== this.initVal\n  }\n\n  reset () {\n    this.setValue(this.initVal, true)\n  }\n}\n\nconst clamp = (v: number, min: number, max: number): number => v < min ? min : v > max ? max : v\n","export default class BasePage {\n  /* unload is called when the user navigates away from the page. */\n  unload () {\n    // should be implemented by inheriting class.\n  }\n}\n","import * as intl from './locales'\nimport {\n  app,\n  Order,\n  TradeForm,\n  OrderOption,\n  Match\n} from './registry'\nimport { BooleanOption, XYRangeOption } from './opts'\nimport Doc from './doc'\n\nexport const Limit = 1 // TODO: Delete for the versions below\nexport const Market = 2 // TODO: Delete for the versions below\nexport const Cancel = 3 // TODO: Delete for the versions below\n\nexport const OrderTypeLimit = 1\nexport const OrderTypeMarket = 2\nexport const OrderTypeCancel = 3\n\n/* The time-in-force specifiers are a mirror of dex/order.TimeInForce. */\nexport const ImmediateTiF = 0\nexport const StandingTiF = 1\n\n/* The order statuses are a mirror of dex/order.OrderStatus. */\nexport const StatusUnknown = 0\nexport const StatusEpoch = 1\nexport const StatusBooked = 2\nexport const StatusExecuted = 3\nexport const StatusCanceled = 4\nexport const StatusRevoked = 5\n\n/* The match statuses are a mirror of dex/order.MatchStatus. */\nexport const NewlyMatched = 0\nexport const MakerSwapCast = 1\nexport const TakerSwapCast = 2\nexport const MakerRedeemed = 3\nexport const MatchComplete = 4\nexport const MatchConfirmed = 5\n\n/* The match sides are a mirror of dex/order.MatchSide. */\nexport const Maker = 0 // TODO: Delete for the versions below\nexport const Taker = 1 // TODO: Delete for the versions below\n\nexport const MatchSideMaker = 0\nexport const MatchSideTaker = 1\n\n/*\n * RateEncodingFactor is used when encoding an atomic exchange rate as an\n * integer. See docs on message-rate encoding @\n * https://github.com/decred/dcrdex/blob/master/spec/comm.mediawiki#Rate_Encoding\n */\nexport const RateEncodingFactor = 1e8\n\nexport function sellString (ord: Order) {\n  const key = ord.sell ? intl.ID_SELL : intl.ID_BUY\n  const lang = document.documentElement.lang.toLowerCase()\n  return intl.prep(key).toLocaleLowerCase(lang)\n}\n\nexport function typeString (ord: Order) {\n  return ord.type === Limit ? (ord.tif === ImmediateTiF ? intl.prep(intl.ID_LIMIT_ORDER_IMMEDIATE_TIF) : intl.prep(intl.ID_LIMIT_ORDER)) : intl.prep(intl.ID_MARKET_ORDER)\n}\n\n/* isMarketBuy will return true if the order is a market buy order. */\nexport function isMarketBuy (ord: Order) {\n  return ord.type === Market && !ord.sell\n}\n\n/*\n * hasActiveMatches returns true if the order has matches that have not completed\n * settlement yet.\n */\nexport function hasActiveMatches (order: Order) {\n  if (!order.matches) return false\n  for (const match of order.matches) {\n    if (match.active) return true\n  }\n  return false\n}\n\n/**\n * statusString converts the order status to a string.\n *\n * IMPORTANT: we have similar function in Golang, it must match this one exactly,\n * when updating make sure to update both!\n */\nexport function statusString (order: Order): string {\n  if (!order.id) return intl.prep(intl.ID_ORDER_SUBMITTING) // order ID is empty.\n  const isLive = hasActiveMatches(order)\n  switch (order.status) {\n    case StatusUnknown: return intl.prep(intl.ID_UNKNOWN)\n    case StatusEpoch: return intl.prep(intl.ID_EPOCH)\n    case StatusBooked:\n      if (order.cancelling) return intl.prep(intl.ID_CANCELING)\n      return isLive ? `${intl.prep(intl.ID_BOOKED)}/${intl.prep(intl.ID_SETTLING)}` : intl.prep(intl.ID_BOOKED)\n    case StatusExecuted:\n      if (isLive) return intl.prep(intl.ID_SETTLING)\n      if (order.filled === 0 && order.type !== Cancel) return intl.prep(intl.ID_NO_MATCH)\n      return intl.prep(intl.ID_EXECUTED)\n    case StatusCanceled:\n      return isLive ? `${intl.prep(intl.ID_CANCELED)}/${intl.prep(intl.ID_SETTLING)}` : intl.prep(intl.ID_CANCELED)\n    case StatusRevoked:\n      return isLive ? `${intl.prep(intl.ID_REVOKED)}/${intl.prep(intl.ID_SETTLING)}` : intl.prep(intl.ID_REVOKED)\n  }\n  return intl.prep(intl.ID_UNKNOWN)\n}\n\n/* filled sums the quantities of non-cancel matches available. */\nexport function filled (order: Order) {\n  if (!order.matches) return 0\n  const qty = isMarketBuy(order) ? (m: Match) => m.qty * m.rate / RateEncodingFactor : (m: Match) => m.qty\n  return order.matches.reduce((filled, match) => {\n    if (match.isCancel) return filled\n    return filled + qty(match)\n  }, 0)\n}\n\n/* settled sums the quantities of the matches that have completed. */\nexport function settled (order: Order) {\n  if (!order.matches) return 0\n  const qty = isMarketBuy(order) ? (m: Match) => m.qty * m.rate / RateEncodingFactor : (m: Match) => m.qty\n  return order.matches.reduce((settled, match) => {\n    if (match.isCancel) return settled\n    const redeemed = (match.side === Maker && match.status >= MakerRedeemed) ||\n      (match.side === Taker && match.status >= MatchComplete)\n    return redeemed ? settled + qty(match) : settled\n  }, 0)\n}\n\n/* averageRateString returns a formatting string containing the average rate of\nthe matches that have been filled for a market order. */\nexport function averageMarketOrderRateString (ord: Order): string {\n  if (!ord.matches?.length) return intl.prep(intl.ID_MARKET_ORDER)\n  let rateStr = Doc.formatCoinValue(app().conventionalRate(ord.baseID, ord.quoteID, averageRate(ord)))\n  if (ord.matches.length > 1) rateStr = '~ ' + rateStr // \"~\" only makes sense if the order has more than one match.\n  return rateStr\n}\n\n/* averageRate returns a the average rate of the matches that have been filled\nin an order. */\nexport function averageRate (ord: Order): number {\n  if (!ord.matches?.length) return 0\n  let rateProduct = 0\n  let baseQty = 0\n  for (const m of ord.matches) {\n    baseQty += m.qty\n    rateProduct += (m.rate * m.qty) // order ~ 1e16\n  }\n  return rateProduct / baseQty\n}\n\n/* baseToQuote returns the quantity of the quote asset. */\nexport function baseToQuote (rate: number, base: number) : number {\n  return rate * base / RateEncodingFactor\n}\n\n/* orderPortion returns a string stating the percentage of the order a match\n   makes up. */\nexport function orderPortion (order: Order, match: Match) : string {\n  let matchQty = match.qty\n  if (isMarketBuy(order)) {\n    matchQty = baseToQuote(match.rate, match.qty)\n  }\n  return ((matchQty / order.qty) * 100).toFixed(1) + ' %'\n}\n\n/*\n * matchStatusString is a string used to create a displayable string describing\n * describing the match status.\n */\nexport function matchStatusString (m: Match) {\n  if (m.revoked) {\n    // When revoked, match status is less important than pending action if still\n    // active, or the outcome if inactive.\n    if (m.active) {\n      if (m.redeem) return revokedMatchStatus(intl.ID_MATCH_STATUS_REDEMPTION_SENT) // must require confirmation if active\n      // If maker and we have not redeemed, waiting to refund, assuming it's not\n      // revoked while waiting for confs on an unspent/unexpired taker swap.\n      if (m.side === Maker) return revokedMatchStatus(intl.ID_MATCH_STATUS_REFUND_PENDING)\n      // As taker, resolution depends on maker's actions while waiting to refund.\n      if (m.counterRedeem) return revokedMatchStatus(intl.ID_MATCH_STATUS_REDEEM_PENDING) // this should be very brief if we see the maker's redeem\n      return revokedMatchStatus(intl.ID_MATCH_STATUS_REFUND_PENDING) // may switch to redeem if maker redeems on the sly\n    }\n    if (m.refund) {\n      return revokedMatchStatus(intl.ID_MATCH_STATUS_REFUNDED)\n    }\n    if (m.redeem) {\n      return revokedMatchStatus(intl.ID_MATCH_STATUS_REDEMPTION_CONFIRMED)\n    }\n    return revokedMatchStatus(intl.ID_MATCH_STATUS_COMPLETE) // i.e. we sent no swap\n  }\n\n  switch (m.status) {\n    case NewlyMatched:\n      return intl.prep(intl.ID_MATCH_STATUS_NEWLY_MATCHED)\n    case MakerSwapCast:\n      return intl.prep(intl.ID_MATCH_STATUS_MAKER_SWAP_CAST)\n    case TakerSwapCast:\n      return intl.prep(intl.ID_MATCH_STATUS_TAKER_SWAP_CAST)\n    case MakerRedeemed:\n      if (m.side === Maker) {\n        return intl.prep(intl.ID_MATCH_STATUS_REDEMPTION_SENT)\n      }\n      return intl.prep(intl.ID_MATCH_STATUS_MAKER_REDEEMED)\n    case MatchComplete:\n      return intl.prep(intl.ID_MATCH_STATUS_REDEMPTION_SENT)\n    case MatchConfirmed:\n      return intl.prep(intl.ID_MATCH_STATUS_REDEMPTION_CONFIRMED)\n  }\n  return intl.prep(intl.ID_UNKNOWN)\n}\n\n// revokedMatchStatus is a helper function that returns the revoked match status\n// string.\nfunction revokedMatchStatus (matchStatus: string): string {\n  return intl.prep(intl.ID_MATCH_STATUS_REVOKED, { status: intl.prep(matchStatus) })\n}\n\n/*\n * optionElement is a getter for an element matching the *OrderOption from\n * client/asset. change is a function with no arguments that is called when the\n * returned option's value has changed.\n */\nexport function optionElement (opt: OrderOption, order: TradeForm, change: () => void, isSwap: boolean): HTMLElement {\n  const isBaseChain = (isSwap && order.sell) || (!isSwap && !order.sell)\n  const symbol = isBaseChain ? dexAssetSymbol(order.host, order.base) : dexAssetSymbol(order.host, order.quote)\n\n  switch (true) {\n    case !!opt.boolean:\n      return new BooleanOption(opt, symbol, order.options, change).node\n    case !!opt.xyRange:\n      return new XYRangeOption(opt, symbol, order.options, change).node\n    default:\n      console.error('no option type specified', opt)\n  }\n  console.error('unknown option type', opt)\n  return document.createElement('div')\n}\n\nfunction dexAssetSymbol (host: string, assetID: number): string {\n  return app().exchanges[host].assets[assetID].symbol\n}\n\nexport function isCancellable (ord: Order): boolean {\n  return ord.type === Limit && ord.tif === StandingTiF && ord.status < StatusExecuted\n}\n\nexport function orderTypeText (ordType: number): string {\n  switch (ordType) {\n    case OrderTypeLimit:\n      return intl.prep(intl.ID_LIMIT_ORDER)\n    case OrderTypeMarket:\n      return intl.prep(intl.ID_MARKET_ORDER)\n    default: // OrderTypeCancel\n      return intl.prep(intl.ID_CANCEL_ORDER)\n  }\n}\n","import Doc, { Animation, clamp } from './doc'\nimport { RateEncodingFactor } from './orderutil'\nimport OrderBook from './orderbook'\nimport State from './state'\nimport { UnitInfo, Market, Candle, CandlesPayload, app } from './registry'\n\nconst bind = Doc.bind\nconst PIPI = 2 * Math.PI\nconst plusChar = String.fromCharCode(59914)\nconst minusChar = String.fromCharCode(59915)\n\ninterface Point {\n  x: number\n  y: number\n}\n\ninterface MinMax {\n  min: number\n  max: number\n}\n\ninterface Label {\n  val: number\n  txt: string\n}\n\ninterface LabelSet {\n  widest?: number\n  lbls: Label[]\n}\n\nexport interface Translator {\n    x: (x: number) => number\n    y: (y: number) => number\n    unx: (x: number) => number\n    uny: (y: number) => number\n    w: (w: number) => number\n    h: (h: number) => number\n}\n\nexport interface MouseReport {\n  rate: number\n  depth: number\n  dotColor: string\n  hoverMarkers: number[]\n}\n\nexport interface VolumeReport {\n  buyBase: number\n  buyQuote: number\n  sellBase: number\n  sellQuote: number\n}\n\nexport interface DepthReporters {\n  mouse: (r: MouseReport | null) => void\n  click: (x: number) => void\n  volume: (r: VolumeReport) => void\n  zoom: (z: number) => void\n}\n\nexport interface CandleReporters {\n  mouse: (r: Candle | null) => void\n}\n\nexport interface ChartReporters {\n  resize: () => void,\n  click: (e: MouseEvent) => void,\n  zoom: (bigger: boolean) => void\n}\n\nexport interface DepthLine {\n  rate: number\n  color: string\n}\n\nexport interface DepthMarker {\n  rate: number\n  active: boolean\n}\n\ninterface DepthMark extends DepthMarker {\n  qty: number\n  sell: boolean\n}\n\ninterface Theme {\n  body: string\n  axisLabel: string\n  gridBorder: string\n  gridLines: string\n  gapLine: string\n  value: string\n  zoom: string\n  zoomHover: string\n  sellLine: string\n  buyLine: string\n  sellFill: string\n  buyFill: string\n  crosshairs: string\n  legendFill: string\n  legendText: string\n}\n\nconst darkTheme: Theme = {\n  body: '#0b2031',\n  axisLabel: '#b1b1b1',\n  gridBorder: '#383f4b',\n  gridLines: '#383f4b',\n  gapLine: '#6b6b6b',\n  value: '#9a9a9a',\n  zoom: '#5b5b5b',\n  zoomHover: '#aaa',\n  sellLine: '#ae3333',\n  buyLine: '#05a35a',\n  sellFill: '#591a1a',\n  buyFill: '#02572f',\n  crosshairs: '#888',\n  legendFill: 'black',\n  legendText: '#d5d5d5'\n}\n\nconst lightTheme: Theme = {\n  body: '#f4f4f4',\n  axisLabel: '#1b1b1b',\n  gridBorder: '#ddd',\n  gridLines: '#ddd',\n  gapLine: '#595959',\n  value: '#4d4d4d',\n  zoom: '#777',\n  zoomHover: '#333',\n  sellLine: '#99302b',\n  buyLine: '#207a46',\n  sellFill: '#bd5959',\n  buyFill: '#4cad75',\n  crosshairs: '#595959',\n  legendFill: '#e6e6e6',\n  legendText: '#1b1b1b'\n}\n\n// Chart is the base class for charts.\nexport class Chart {\n  parent: HTMLElement\n  report: ChartReporters\n  theme: Theme\n  canvas: HTMLCanvasElement\n  visible: boolean\n  renderScheduled: boolean\n  ctx: CanvasRenderingContext2D\n  mousePos: Point | null\n  rect: DOMRect\n  wheelLimiter: number | null\n  boundResizer: () => void\n  plotRegion: Region\n  xRegion: Region\n  yRegion: Region\n  dataExtents: Extents\n  unattachers: (() => void)[]\n\n  constructor (parent: HTMLElement, reporters: ChartReporters) {\n    this.parent = parent\n    this.report = reporters\n    this.theme = State.isDark() ? darkTheme : lightTheme\n    this.canvas = document.createElement('canvas')\n    this.visible = true\n    parent.appendChild(this.canvas)\n    const ctx = this.canvas.getContext('2d')\n    if (!ctx) {\n      console.error('error getting canvas context')\n      return\n    }\n    this.ctx = ctx\n    this.ctx.textAlign = 'center'\n    this.ctx.textBaseline = 'middle'\n    // Mouse handling\n    this.mousePos = null\n    bind(this.canvas, 'mousemove', (e: MouseEvent) => {\n      // this.rect will be set in resize().\n      if (!this.rect) return\n      this.mousePos = {\n        x: e.clientX - this.rect.left,\n        y: e.clientY - this.rect.y\n      }\n      this.draw()\n    })\n    bind(this.canvas, 'mouseleave', () => {\n      this.mousePos = null\n      this.draw()\n    })\n\n    // Bind resize.\n    const resizeObserver = new ResizeObserver(() => this.resize())\n    resizeObserver.observe(this.parent)\n\n    // Scrolling by wheel is smoother when the rate is slightly limited.\n    this.wheelLimiter = null\n    bind(this.canvas, 'wheel', (e: WheelEvent) => { this.wheel(e) }, { passive: true })\n    bind(this.canvas, 'click', (e: MouseEvent) => { this.click(e) })\n    const setVis = () => {\n      this.visible = document.visibilityState !== 'hidden'\n      if (this.visible && this.renderScheduled) {\n        this.renderScheduled = false\n        this.draw()\n      }\n    }\n    bind(document, 'visibilitychange', setVis)\n    this.unattachers = [() => { Doc.unbind(document, 'visibilitychange', setVis) }]\n  }\n\n  wheeled () {\n    this.wheelLimiter = window.setTimeout(() => { this.wheelLimiter = null }, 100)\n  }\n\n  /* clear the canvas. */\n  clear () {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\n  }\n\n  /* draw calls the child class's render method. */\n  draw () {\n    this.render()\n  }\n\n  /* click is the handler for a click event on the canvas. */\n  click (e: MouseEvent) {\n    this.report.click(e)\n  }\n\n  /* wheel is a mousewheel event handler. */\n  wheel (e: WheelEvent) {\n    this.zoom(e.deltaY < 0)\n  }\n\n  /*\n   * resize updates the chart size. The parentHeight is an argument to support\n   * updating the height programmatically after the caller sets a style.height\n   * but before the clientHeight has been updated.\n   */\n  resize () {\n    this.canvas.width = this.parent.clientWidth\n    this.canvas.height = this.parent.clientHeight\n    const xLblHeight = 30\n    const yGuess = 40 // y label width guess. Will be adjusted when drawn.\n    const plotExtents = new Extents(0, this.canvas.width, 0, this.canvas.height - xLblHeight)\n    const xLblExtents = new Extents(0, this.canvas.width, this.canvas.height - xLblHeight, this.canvas.height)\n    const yLblExtents = new Extents(0, yGuess, 0, this.canvas.height - xLblHeight)\n    this.plotRegion = new Region(this.ctx, plotExtents)\n    this.xRegion = new Region(this.ctx, xLblExtents)\n    this.yRegion = new Region(this.ctx, yLblExtents)\n    // After changing the visibility, this.canvas.getBoundingClientRect will\n    // return nonsense until a render.\n    window.requestAnimationFrame(() => {\n      this.rect = this.canvas.getBoundingClientRect()\n      this.report.resize()\n    })\n  }\n\n  /* zoom is called when the user scrolls the mouse wheel on the canvas. */\n  zoom (bigger: boolean) {\n    if (this.wheelLimiter) return\n    this.report.zoom(bigger)\n  }\n\n  /* The market handler will call unattach when the markets page is unloaded. */\n  unattach () {\n    for (const u of this.unattachers) u()\n    this.unattachers = []\n  }\n\n  /* render must be implemented by the child class. */\n  render () {\n    console.error('child class must override render method')\n  }\n\n  /* applyLabelStyle applies the style used for axis tick labels. */\n  applyLabelStyle (fontSize?: number) {\n    this.ctx.textAlign = 'center'\n    this.ctx.textBaseline = 'middle'\n    this.ctx.font = `${fontSize ?? '14'}px 'sans', sans-serif`\n    this.ctx.fillStyle = this.theme.axisLabel\n  }\n\n  /* plotXLabels applies the provided labels to the x axis and draws the grid. */\n  plotXLabels (labels: LabelSet, minX: number, maxX: number, unitLines: string[]) {\n    const extents = new Extents(minX, maxX, 0, 1)\n    this.xRegion.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      this.applyLabelStyle()\n      const centerX = (maxX + minX) / 2\n      let lastX = minX\n      let unitCenter = centerX\n      const [leftEdge, rightEdge] = [tools.x(minX), tools.x(maxX)]\n      const centerY = tools.y(0.5)\n      labels.lbls.forEach(lbl => {\n        const m = ctx.measureText(lbl.txt)\n        const x = tools.x(lbl.val)\n        if (x - m.width / 2 < leftEdge || x + m.width / 2 > rightEdge) return\n        ctx.fillText(lbl.txt, x, centerY)\n        if (centerX >= lastX && centerX < lbl.val) {\n          unitCenter = (lastX + lbl.val) / 2\n        }\n        lastX = lbl.val\n      })\n      ctx.font = '11px \\'sans\\', sans-serif'\n      if (unitLines.length === 2) {\n        ctx.fillText(unitLines[0], tools.x(unitCenter), tools.y(0.63))\n        ctx.fillText(unitLines[1], tools.x(unitCenter), tools.y(0.23))\n      } else if (unitLines.length === 1) {\n        ctx.fillText(unitLines[0], tools.x(unitCenter), centerY)\n      }\n    }, true)\n  }\n\n  plotXGrid (labels: LabelSet, minX: number, maxX: number) {\n    const extents = new Extents(minX, maxX, 0, 1)\n    this.plotRegion.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      ctx.lineWidth = 1\n      ctx.strokeStyle = this.theme.gridLines\n      labels.lbls.forEach(lbl => {\n        line(ctx, tools.x(lbl.val), tools.y(0), tools.x(lbl.val), tools.y(1))\n      })\n    }, true)\n  }\n\n  /*\n   * plotYLabels applies the y labels based on the provided plot region, and\n   * draws the grid.\n   */\n  plotYLabels (labels: LabelSet, minY: number, maxY: number, unit: string) {\n    const extents = new Extents(0, 1, minY, maxY)\n\n    const fillRect = (ctx: CanvasRenderingContext2D, x: number, y: number, w: number, h: number, r: number) => {\n      ctx.save()\n      ctx.fillStyle = this.theme.body\n      ctx.beginPath()\n      if (ctx.roundRect) ctx.roundRect(x, y, w, h, r) // Safari < 16 doesn't support\n      else ctx.rect(x, y, w, h)\n      ctx.fill()\n      ctx.restore()\n    }\n\n    this.yRegion.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      this.applyLabelStyle()\n      this.ctx.textAlign = 'left'\n      const centerY = maxY / 2\n      let lastY = 0\n      let unitCenter = centerY\n      const x = tools.x(0)\n      const [xPad, yPad] = [3, 3]\n      labels.lbls.forEach(lbl => {\n        const y = tools.y(lbl.val)\n        if (y < tools.y(maxY) + yPad + 7 || y > tools.y(minY) - yPad - 7) return\n        const m = ctx.measureText(lbl.txt)\n        fillRect(ctx, x, y - 7 - yPad, m.width + xPad * 2, 14 + yPad * 3, 3)\n        ctx.fillText(lbl.txt, x + xPad, y + 2)\n        if (centerY >= lastY && centerY < lbl.val) {\n          unitCenter = (lastY + lbl.val) / 2\n        }\n        lastY = lbl.val\n      })\n      const m = ctx.measureText(unit)\n      const y = tools.y(unitCenter)\n      fillRect(ctx, x, y - yPad - 7, m.width + xPad * 2, 14 + yPad * 2, 3)\n      ctx.fillText(unit, x + xPad, tools.y(unitCenter))\n    }, true)\n  }\n\n  plotYGrid (region: Region, labels: LabelSet, minY: number, maxY: number) {\n    const extents = new Extents(0, 1, minY, maxY)\n    region.plot(extents, (ctx: CanvasRenderingContext2D, tools: Translator) => {\n      ctx.lineWidth = 1\n      ctx.strokeStyle = this.theme.gridLines\n      labels.lbls.forEach(lbl => {\n        line(ctx, tools.x(0), tools.y(lbl.val), tools.x(1), tools.y(lbl.val))\n      })\n    }, true)\n  }\n\n  /*\n   * doYLabels generates and applies the y-axis labels, based upon the\n   * provided plot region.\n   */\n  makeYLabels (region: Region, step: number, unit: string, valFmt?: (v: number) => string): LabelSet {\n    this.applyLabelStyle()\n    const yLabels = makeLabels(this.ctx, region.height(), this.dataExtents.y.min,\n      this.dataExtents.y.max, 50, step, unit, valFmt)\n\n    // Reassign the width of the y-label column to accommodate the widest text.\n    const yAxisWidth = (yLabels.widest || 0) + 20 /* x padding */\n    this.yRegion.extents.x.max = yAxisWidth\n    this.yRegion.extents.y.max = region.extents.y.max\n\n    return yLabels\n  }\n\n  line (x0: number, y0: number, x1: number, y1: number, skipStroke?: boolean) {\n    line(this.ctx, x0, y0, x1, y1, skipStroke)\n  }\n\n  /* dot draws a circle with the provided context. */\n  dot (x: number, y: number, color: string, radius: number) {\n    dot(this.ctx, x, y, color, radius)\n  }\n}\n\n/* DepthChart is a javascript Canvas-based depth chart renderer. */\nexport class DepthChart extends Chart {\n  reporters: DepthReporters\n  book: OrderBook\n  zoomLevel: number\n  lotSize: number\n  conventionalRateStep: number\n  lines: DepthLine[]\n  markers: Record<string, DepthMarker[]>\n  zoomInBttn: Region\n  zoomOutBttn: Region\n  baseUnit: string\n  quoteUnit: string\n\n  constructor (parent: HTMLElement, reporters: DepthReporters, zoom: number) {\n    super(parent, {\n      resize: () => this.resized(),\n      click: (e: MouseEvent) => this.clicked(e),\n      zoom: (bigger: boolean) => this.zoomed(bigger)\n    })\n    this.reporters = reporters\n    this.zoomLevel = zoom\n    this.lines = []\n    this.markers = {\n      buys: [],\n      sells: []\n    }\n    this.setZoomBttns() // can't wait for requestAnimationFrame -> resized\n    this.resize()\n  }\n\n  // setZoomBttns creates new regions for zoom in and zoom out buttons. It is\n  // used in initiation of the buttons and resizing.\n  setZoomBttns () {\n    this.zoomInBttn = new Region(this.ctx, new Extents(0, 0, 0, 0))\n    this.zoomOutBttn = new Region(this.ctx, new Extents(0, 0, 0, 0))\n  }\n\n  /* resized is called when the window or parent element are resized. */\n  resized () {\n    // The button region extents are set during drawing.\n    this.setZoomBttns()\n    if (this.book) this.draw()\n  }\n\n  /* zoomed zooms the current view in or out. bigger=true is zoom in. */\n  zoomed (bigger: boolean) {\n    if (!this.zoomLevel) return\n    if (!this.book.buys || !this.book.sells) return\n    this.wheeled()\n    // Zoom in to 66%, but out to 150% = 1 / (2/3) so that the same zoom levels\n    // are hit when reversing direction.\n    this.zoomLevel *= bigger ? 2 / 3 : 3 / 2\n    this.zoomLevel = clamp(this.zoomLevel, 0.005, 2)\n    this.draw()\n    this.reporters.zoom(this.zoomLevel)\n  }\n\n  /* clicked is the canvas 'click' event handler. */\n  clicked (e: MouseEvent) {\n    if (!this.dataExtents) return\n    const x = e.clientX - this.rect.left\n    const y = e.clientY - this.rect.y\n    if (this.zoomInBttn.contains(x, y)) { this.zoom(true); return }\n    if (this.zoomOutBttn.contains(x, y)) { this.zoom(false); return }\n    const translator = this.plotRegion.translator(this.dataExtents)\n    this.reporters.click(translator.unx(x))\n  }\n\n  // set sets the current data set and draws.\n  set (book: OrderBook, lotSize: number, rateStepEnc: number, baseUnitInfo: UnitInfo, quoteUnitInfo: UnitInfo) {\n    this.book = book\n    this.lotSize = lotSize / baseUnitInfo.conventional.conversionFactor\n    this.conventionalRateStep = Doc.conventionalRateStep(rateStepEnc, baseUnitInfo, quoteUnitInfo)\n    this.baseUnit = baseUnitInfo.conventional.unit\n    this.quoteUnit = quoteUnitInfo.conventional.unit\n    if (!this.zoomLevel) {\n      const [midGap, gapWidth] = this.gap()\n      // Default to 5% zoom, but with a minimum of 5 * midGap, but still observing\n      // the hard cap of 200%.\n      const minZoom = Math.max(gapWidth / midGap * 5, 0.05)\n      this.zoomLevel = Math.min(minZoom, 2)\n    }\n    this.draw()\n  }\n\n  /*\n   * render draws the chart.\n   * 1. Calculate the data extents and translate the order book data to a\n   *    cumulative form.\n   * 2. Draw axis ticks and grid, mid-gap line and value, zoom buttons, mouse\n   *    position indicator...\n   * 4. Tick labels.\n   * 5. Data.\n   * 6. Epoch line legend.\n   * 7. Hover legend.\n   */\n  render () {\n    // if connection fails it is not possible to get book.\n    if (!this.book || !this.visible || this.canvas.width === 0) {\n      this.renderScheduled = true\n      return\n    }\n\n    this.clear()\n    // if (!this.book || this.book.empty()) return\n    const ctx = this.ctx\n    const mousePos = this.mousePos\n    const buys = this.book.buys\n    const sells = this.book.sells\n\n    const [midGap, gapWidth] = this.gap()\n\n    const halfWindow = this.zoomLevel * midGap / 2\n    const high = midGap + halfWindow\n    const low = midGap - halfWindow\n\n    // Get a sorted copy of the markers list.\n    const buyMarkers = [...this.markers.buys]\n    const sellMarkers = [...this.markers.sells]\n    buyMarkers.sort((a, b) => b.rate - a.rate)\n    sellMarkers.sort((a, b) => a.rate - b.rate)\n    const markers: DepthMark[] = []\n\n    const buyDepth: [number, number][] = []\n    const buyEpoch: [number, number][] = []\n    const sellDepth: [number, number][] = []\n    const sellEpoch: [number, number][] = []\n    const volumeReport = {\n      buyBase: 0,\n      buyQuote: 0,\n      sellBase: 0,\n      sellQuote: 0\n    }\n    let sum = 0\n    // The epoch line is above the non-epoch region, so the epochSum y value\n    // must account for non-epoch orders too.\n    let epochSum = 0\n\n    for (let i = 0; i < buys.length; i++) {\n      const ord = buys[i]\n      epochSum += ord.qty\n      if (ord.rate >= low) buyEpoch.push([ord.rate, epochSum])\n      if (ord.epoch) continue\n      sum += ord.qty\n      buyDepth.push([ord.rate, sum])\n      volumeReport.buyBase += ord.qty\n      volumeReport.buyQuote += ord.qty * ord.rate\n      while (buyMarkers.length && floatCompare(buyMarkers[0].rate, ord.rate)) {\n        const mark = buyMarkers.shift()\n        if (!mark) continue\n        markers.push({\n          rate: mark.rate,\n          qty: ord.epoch ? epochSum : sum,\n          sell: ord.sell,\n          active: mark.active\n        })\n      }\n    }\n    const buySum = buyDepth.length ? last(buyDepth)[1] : 0\n    buyDepth.push([low, buySum])\n    const epochBuySum = buyEpoch.length ? last(buyEpoch)[1] : 0\n    buyEpoch.push([low, epochBuySum])\n\n    epochSum = sum = 0\n    for (let i = 0; i < sells.length; i++) {\n      const ord = sells[i]\n      epochSum += ord.qty\n      if (ord.rate <= high) sellEpoch.push([ord.rate, epochSum])\n      if (ord.epoch) continue\n      sum += ord.qty\n      sellDepth.push([ord.rate, sum])\n      volumeReport.sellBase += ord.qty\n      volumeReport.sellQuote += ord.qty * ord.rate\n      while (sellMarkers.length && floatCompare(sellMarkers[0].rate, ord.rate)) {\n        const mark = sellMarkers.shift()\n        if (!mark) continue\n        markers.push({\n          rate: mark.rate,\n          qty: ord.epoch ? epochSum : sum,\n          sell: ord.sell,\n          active: mark.active\n        })\n      }\n    }\n    // Add a data point going to the left so that the data doesn't end with a\n    // vertical line.\n    const sellSum = sellDepth.length ? last(sellDepth)[1] : 0\n    sellDepth.push([high, sellSum])\n    const epochSellSum = sellEpoch.length ? last(sellEpoch)[1] : 0\n    sellEpoch.push([high, epochSellSum])\n\n    // Add ~30px padding to the top of the chart.\n    const h = this.xRegion.extents.y.min\n    const growthFactor = (h + 40) / h\n    const maxY = (epochSellSum && epochBuySum ? Math.max(epochBuySum, epochSellSum) : epochSellSum || epochBuySum || 1) * growthFactor\n\n    const dataExtents = new Extents(low, high, 0, maxY)\n    this.dataExtents = dataExtents\n\n    // A function to be run at the end if there is legend data to display.\n    let mouseData: MouseReport | null = null\n\n    // Draw the grid.\n    const xLabels = makeLabels(ctx, this.plotRegion.width(), dataExtents.x.min, dataExtents.x.max, 100, this.conventionalRateStep, '')\n    this.plotXGrid(xLabels, low, high)\n    const yLabels = this.makeYLabels(this.plotRegion, this.lotSize, this.baseUnit)\n    this.plotYGrid(this.plotRegion, yLabels, this.dataExtents.y.min, this.dataExtents.y.max)\n\n    this.plotRegion.plot(dataExtents, (ctx, tools) => {\n      ctx.lineWidth = 1\n      // first, a square around the plot area.\n      ctx.strokeStyle = this.theme.gridBorder\n      // draw a line to indicate mid-gap\n      ctx.lineWidth = 2.5\n      ctx.strokeStyle = this.theme.gapLine\n      line(ctx, tools.x(midGap), tools.y(0), tools.x(midGap), tools.y(0.3 * dataExtents.y.max))\n\n      ctx.font = '30px \\'demi-sans\\', sans-serif'\n      ctx.textAlign = 'center'\n      ctx.textBaseline = 'middle'\n      ctx.fillStyle = this.theme.value\n      const y = 0.5 * dataExtents.y.max\n      ctx.fillText(Doc.formatFourSigFigs(midGap), tools.x(midGap), tools.y(y))\n      ctx.font = '12px \\'sans\\', sans-serif'\n      // ctx.fillText('mid-market price', tools.x(midGap), tools.y(y) + 24)\n      ctx.fillText(`${(gapWidth / midGap * 100).toFixed(2)}% spread`,\n        tools.x(midGap), tools.y(y) + 24)\n\n      // Draw zoom buttons.\n      ctx.textAlign = 'center'\n      ctx.textBaseline = 'middle'\n      const topCenterX = this.plotRegion.extents.midX\n      const topCenterY = tools.y(maxY * 0.9)\n      const zoomPct = dataExtents.xRange / midGap * 100\n      const zoomText = `${zoomPct.toFixed(1)}%`\n      const w = ctx.measureText(zoomText).width\n      ctx.font = '13px \\'sans\\', sans-serif'\n      ctx.fillText(zoomText, topCenterX, topCenterY + 1)\n      // define the region for the zoom button\n      const bttnSize = 20\n      const xPad = 10\n      let bttnLeft = topCenterX - w / 2 - xPad - bttnSize\n      const bttnTop = topCenterY - bttnSize / 2\n      this.zoomOutBttn.setExtents(\n        bttnLeft,\n        bttnLeft + bttnSize,\n        bttnTop,\n        bttnTop + bttnSize\n      )\n      let hover = mousePos && this.zoomOutBttn.contains(mousePos.x, mousePos.y)\n      this.zoomOutBttn.plot(new Extents(0, 1, 0, 1), ctx => {\n        ctx.font = '12px \\'icomoon\\''\n        ctx.fillStyle = this.theme.zoom\n        if (hover) {\n          ctx.fillStyle = this.theme.zoomHover\n          ctx.font = '13px \\'icomoon\\''\n        }\n        ctx.fillText(minusChar, this.zoomOutBttn.extents.midX, this.zoomOutBttn.extents.midY)\n      })\n      bttnLeft = topCenterX + w / 2 + xPad\n      this.zoomInBttn.setExtents(\n        bttnLeft,\n        bttnLeft + bttnSize,\n        bttnTop,\n        bttnTop + bttnSize\n      )\n      hover = mousePos && this.zoomInBttn.contains(mousePos.x, mousePos.y)\n      this.zoomInBttn.plot(new Extents(0, 1, 0, 1), ctx => {\n        ctx.font = '12px \\'icomoon\\''\n        ctx.fillStyle = this.theme.zoom\n        if (hover) {\n          ctx.fillStyle = this.theme.zoomHover\n          ctx.font = '14px \\'icomoon\\''\n        }\n        ctx.fillText(plusChar, this.zoomInBttn.extents.midX, this.zoomInBttn.extents.midY)\n      })\n\n      // Draw a dotted vertical line where the mouse is, and a dot at the level\n      // of the depth line.\n      const drawLine = (x: number, color: string) => {\n        if (x > high || x < low) return\n        ctx.save()\n        ctx.setLineDash([3, 5])\n        ctx.lineWidth = 1.5\n        ctx.strokeStyle = color\n        line(ctx, tools.x(x), tools.y(0), tools.x(x), tools.y(maxY))\n        ctx.restore()\n      }\n\n      // for (const line of this.lines || []) {\n      //   drawLine(line.rate, line.color)\n      // }\n\n      const tolerance = (high - low) * 0.005\n      const hoverMarkers = []\n      for (const marker of markers || []) {\n        const hovered = (mousePos && withinTolerance(marker.rate, tools.unx(mousePos.x), tolerance))\n        if (hovered) hoverMarkers.push(marker.rate)\n        ctx.save()\n        ctx.lineWidth = (hovered || marker.active) ? 5 : 3\n        ctx.strokeStyle = marker.sell ? this.theme.sellLine : this.theme.buyLine\n        ctx.fillStyle = marker.sell ? this.theme.sellFill : this.theme.buyFill\n        const size = (hovered || marker.active) ? 10 : 8\n        ctx.beginPath()\n        const tip = {\n          x: tools.x(marker.rate),\n          y: tools.y(marker.qty) - 8\n        }\n        const top = tip.y - (Math.sqrt(3) * size / 2) // cos(30)\n        ctx.moveTo(tip.x, tip.y)\n        ctx.lineTo(tip.x - size / 2, top)\n        ctx.lineTo(tip.x + size / 2, top)\n        ctx.closePath()\n        ctx.stroke()\n        ctx.fill()\n        ctx.restore()\n      }\n\n      // If the mouse is in the chart area, draw the crosshairs.\n      if (!mousePos) return\n      if (!this.plotRegion.contains(mousePos.x, mousePos.y)) return\n      // The mouse is in the plot region. Get the data coordinates and find the\n      // side and depth for the x value.\n      const dataX = tools.unx(mousePos.x)\n      let evalSide = sellDepth\n      let trigger = (ptX: number) => ptX >= dataX\n      let dotColor = this.theme.sellLine\n      if (dataX < midGap) {\n        evalSide = buyDepth\n        trigger = (ptX) => ptX <= dataX\n        dotColor = this.theme.buyLine\n      }\n      let bestDepth = evalSide[0]\n      for (let i = 0; i < evalSide.length; i++) {\n        const pt = evalSide[i]\n        if (trigger(pt[0])) break\n        bestDepth = pt\n      }\n      drawLine(dataX, this.theme.crosshairs)\n      mouseData = {\n        rate: dataX,\n        depth: bestDepth[1],\n        dotColor: dotColor,\n        hoverMarkers: hoverMarkers\n      }\n    })\n\n    // Draw the epoch lines\n    ctx.lineWidth = 1.5\n    ctx.setLineDash([3, 3])\n    // epoch sells\n    ctx.fillStyle = this.theme.sellFill\n    ctx.strokeStyle = this.theme.sellLine\n    this.drawDepth(sellEpoch)\n    // epoch buys\n    ctx.fillStyle = this.theme.buyFill\n    ctx.strokeStyle = this.theme.buyLine\n    this.drawDepth(buyEpoch)\n\n    // Draw the book depth.\n    ctx.lineWidth = 2.5\n    ctx.setLineDash([])\n    // book sells\n    ctx.fillStyle = this.theme.sellFill\n    ctx.strokeStyle = this.theme.sellLine\n    this.drawDepth(sellDepth)\n    // book buys\n    ctx.fillStyle = this.theme.buyFill\n    ctx.strokeStyle = this.theme.buyLine\n    this.drawDepth(buyDepth)\n\n    this.plotYLabels(yLabels, this.dataExtents.y.min, this.dataExtents.y.max, this.baseUnit)\n    this.plotXLabels(xLabels, low, high, [`${this.quoteUnit}/`, this.baseUnit])\n\n    // Display the dot at the intersection of the mouse hover line and the depth\n    // line. This should be drawn after the depths.\n    if (mouseData) {\n      this.plotRegion.plot(dataExtents, (ctx, tools) => {\n        if (!mouseData) return // For TypeScript. Duh.\n        dot(ctx, tools.x(mouseData.rate), tools.y(mouseData.depth), mouseData.dotColor, 5)\n      })\n    }\n\n    // Report the book volumes.\n    this.reporters.volume(volumeReport)\n    this.reporters.mouse(mouseData)\n  }\n\n  /* drawDepth draws a single side's depth chart data. */\n  drawDepth (depth: [number, number][]) {\n    const firstPt = depth[0]\n    let x: number\n    this.plotRegion.plot(this.dataExtents, (ctx, tools) => {\n      const yZero = tools.y(0)\n      let y = tools.y(firstPt[1])\n      ctx.beginPath()\n      ctx.moveTo(tools.x(firstPt[0]), tools.y(firstPt[1]))\n      for (let i = 0; i < depth.length; i++) {\n        // Set x, but don't set y until we draw the horizontal line.\n        x = tools.x(depth[i][0])\n        ctx.lineTo(x, y)\n        // If this is past the render edge, quit drawing.\n        y = tools.y(depth[i][1])\n        ctx.lineTo(x, y)\n      }\n      ctx.stroke()\n      ctx.lineTo(x, yZero)\n      ctx.lineTo(tools.x(firstPt[0]), yZero)\n      ctx.closePath()\n      ctx.globalAlpha = 0.25\n      ctx.fill()\n    })\n  }\n\n  /* returns the mid-gap rate and gap width as a tuple. */\n  gap () {\n    const [b, s] = [this.book.bestGapBuy(), this.book.bestGapSell()]\n    if (!b) {\n      if (!s) return [1, 0]\n      return [s.rate, 0]\n    } else if (!s) return [b.rate, 0]\n    return [(s.rate + b.rate) / 2, s.rate - b.rate]\n  }\n\n  /* setLines stores the indicator lines to draw. */\n  setLines (lines: DepthLine[]) {\n    this.lines = lines\n  }\n\n  /* setMarkers sets the indicator markers to draw. */\n  setMarkers (markers: Record<string, DepthMarker[]>) {\n    this.markers = markers\n  }\n}\n\n/* CandleChart is a candlestick data renderer. */\nexport class CandleChart extends Chart {\n  reporters: CandleReporters\n  data: CandlesPayload\n  zoomLevel: number\n  numToShow: number\n  candleRegion: Region\n  volumeRegion: Region\n  resizeTimer: number\n  zoomLevels: number[]\n  market: Market\n  rateConversionFactor: number\n\n  constructor (parent: HTMLElement, reporters: CandleReporters) {\n    super(parent, {\n      resize: () => this.resized(),\n      click: (/* e: MouseEvent */) => { this.clicked() },\n      zoom: (bigger: boolean) => this.zoomed(bigger)\n    })\n    this.reporters = reporters\n    this.zoomLevel = 1\n    this.numToShow = 100\n    this.resize()\n  }\n\n  /* resized is called when the window or parent element are resized. */\n  resized () {\n    const ext = this.plotRegion.extents\n    const candleExtents = new Extents(ext.x.min, ext.x.max, ext.y.min, ext.y.min + ext.yRange * 0.85)\n    this.candleRegion = new Region(this.ctx, candleExtents)\n    const volumeExtents = new Extents(ext.x.min, ext.x.max, ext.y.min + 0.85 * ext.yRange, ext.y.max)\n    this.volumeRegion = new Region(this.ctx, volumeExtents)\n    // Set a delay on the render to prevent lag.\n    if (this.resizeTimer) clearTimeout(this.resizeTimer)\n    this.resizeTimer = window.setTimeout(() => this.draw(), 100)\n  }\n\n  clicked (/* e: MouseEvent */) {\n    // handle clicks\n  }\n\n  /* zoomed zooms the current view in or out. bigger=true is zoom in. */\n  zoomed (bigger: boolean) {\n    // bigger actually means fewer candles -> reduce zoomLevels index.\n    const idx = this.zoomLevels.indexOf(this.numToShow)\n    if (bigger) {\n      if (idx === 0) return\n      this.numToShow = this.zoomLevels[idx - 1]\n    } else {\n      if (this.zoomLevels.length <= idx + 1 || this.numToShow > this.data.candles.length) return\n      this.numToShow = this.zoomLevels[idx + 1]\n    }\n    this.draw()\n  }\n\n  /* render draws the chart */\n  render () {\n    const data = this.data\n    if (!data || !this.visible || this.canvas.width === 0) {\n      this.renderScheduled = true\n      return\n    }\n    const candleWidth = data.ms\n    const mousePos = this.mousePos\n    const allCandles = data.candles || []\n\n    const n = Math.min(this.numToShow, allCandles.length)\n    const candles = allCandles.slice(allCandles.length - n)\n\n    this.clear()\n\n    // If there are no candles. just don't draw anything.\n    if (n === 0) return\n\n    // padding definition and some helper functions to parse candles.\n    const candleWidthPadding = 0.2\n    const start = (c: Candle) => truncate(c.endStamp, candleWidth)\n    const end = (c: Candle) => start(c) + candleWidth\n    const paddedStart = (c: Candle) => start(c) + candleWidthPadding * candleWidth\n    const paddedWidth = (1 - 2 * candleWidthPadding) * candleWidth\n\n    const first = candles[0]\n    const last = candles[n - 1]\n\n    let [high, low, highVol] = [first.highRate, first.lowRate, first.matchVolume]\n    for (const c of candles) {\n      if (c.highRate > high) high = c.highRate\n      if (c.lowRate < low) low = c.lowRate\n      if (c.matchVolume > highVol) highVol = c.matchVolume\n    }\n\n    high += (high - low) * 0.1 // a little padding\n    const xStart = start(first)\n    let xEnd = end(last)\n    xEnd += (xEnd - xStart) * 0.05 // a little padding\n\n    // Calculate data extents and store them. They are used to apply labels.\n    const rateStep = this.market.ratestep\n    const dataExtents = new Extents(xStart, xEnd, low, high)\n    if (low === high) {\n      // If there is no price movement at all in the window, show a little more\n      // top and bottom so things render nicely.\n      dataExtents.y.min -= rateStep\n      dataExtents.y.max += rateStep\n    }\n    this.dataExtents = dataExtents\n\n    let mouseCandle: Candle | null = null\n    if (mousePos) {\n      this.plotRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, 0, 1), (ctx, tools) => {\n        const selectedStartStamp = truncate(tools.unx(mousePos.x), candleWidth)\n        for (const c of candles) {\n          if (start(c) === selectedStartStamp) {\n            mouseCandle = c\n            ctx.fillStyle = this.theme.gridLines\n            ctx.fillRect(tools.x(start(c)), tools.y(0), tools.w(candleWidth), tools.h(1))\n            break\n          }\n        }\n      })\n    }\n\n    // Draw the grid\n    const rFactor = this.rateConversionFactor\n    const baseUnit = app().assets[this.market.baseid]?.unitInfo.conventional.unit || this.market.basesymbol.toUpperCase()\n    const xLabels = makeCandleTimeLabels(candles, candleWidth, this.plotRegion.width(), 100)\n    this.plotXGrid(xLabels, xStart, xEnd)\n    const yLabels = this.makeYLabels(this.candleRegion, rateStep, baseUnit, v => Doc.formatFourSigFigs(v / rFactor))\n    this.plotYGrid(this.candleRegion, yLabels, this.dataExtents.y.min, this.dataExtents.y.max)\n\n    // Draw the volume bars.\n    const volDataExtents = new Extents(xStart, xEnd, 0, highVol)\n    this.volumeRegion.plot(volDataExtents, (ctx, tools) => {\n      ctx.fillStyle = this.theme.gridBorder\n      for (const c of candles) {\n        ctx.fillRect(tools.x(paddedStart(c)), tools.y(0), tools.w(paddedWidth), tools.h(c.matchVolume))\n      }\n    })\n\n    // Draw the candles.\n    this.candleRegion.plot(dataExtents, (ctx, tools) => {\n      ctx.lineWidth = 1\n      for (const c of candles) {\n        const desc = c.startRate > c.endRate\n        const [x, y, w, h] = [tools.x(paddedStart(c)), tools.y(c.startRate), tools.w(paddedWidth), tools.h(c.endRate - c.startRate)]\n        const [high, low, cx] = [tools.y(c.highRate), tools.y(c.lowRate), w / 2 + x]\n        ctx.strokeStyle = desc ? this.theme.sellLine : this.theme.buyLine\n        ctx.fillStyle = desc ? this.theme.sellFill : this.theme.buyFill\n\n        ctx.beginPath()\n        ctx.moveTo(cx, high)\n        ctx.lineTo(cx, low)\n        ctx.stroke()\n\n        ctx.fillRect(x, y, w, h)\n        ctx.strokeRect(x, y, w, h)\n      }\n    })\n\n    // Apply labels.\n    this.plotXLabels(xLabels, xStart, xEnd, [])\n    this.plotYLabels(yLabels, this.dataExtents.y.min, this.dataExtents.y.max, baseUnit)\n\n    // Highlight the candle if the user mouse is over the canvas.\n    if (mouseCandle) {\n      const yExt = this.xRegion.extents.y\n      this.xRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, yExt.min, yExt.max), (ctx, tools) => {\n        if (!mouseCandle) return // For TypeScript. Duh.\n        this.applyLabelStyle()\n        const rangeTxt = `${new Date(start(mouseCandle)).toLocaleString()} - ${new Date(end(mouseCandle)).toLocaleString()}`\n        const [xPad, yPad] = [25, 2]\n        const rangeWidth = ctx.measureText(rangeTxt).width + 2 * xPad\n        const rangeHeight = 16\n        let centerX = tools.x((start(mouseCandle) + end(mouseCandle)) / 2)\n        let left = centerX - rangeWidth / 2\n        const xExt = this.xRegion.extents.x\n        if (left < xExt.min) left = xExt.min\n        else if (left + rangeWidth > xExt.max) left = xExt.max - rangeWidth\n        centerX = left + rangeWidth / 2\n        const top = yExt.min + (this.xRegion.height() - rangeHeight) / 2\n        ctx.fillStyle = this.theme.legendFill\n        ctx.strokeStyle = this.theme.gridBorder\n        const rectArgs: [number, number, number, number] = [left - xPad, top - yPad, rangeWidth + 2 * xPad, rangeHeight + 2 * yPad]\n        ctx.fillRect(...rectArgs)\n        ctx.strokeRect(...rectArgs)\n        this.applyLabelStyle()\n        ctx.fillText(rangeTxt, centerX, this.xRegion.extents.midY, rangeWidth)\n      })\n    }\n\n    // Report the mouse candle.\n    this.reporters.mouse(mouseCandle)\n  }\n\n  /* setCandles sets the candle data and redraws the chart. */\n  setCandles (data: CandlesPayload, market: Market, baseUnitInfo: UnitInfo, quoteUnitInfo: UnitInfo) {\n    this.data = data\n    if (!data.candles) return\n    this.market = market\n    const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor]\n    this.rateConversionFactor = RateEncodingFactor * qFactor / bFactor\n    let n = 25\n    this.zoomLevels = []\n    const maxCandles = Math.max(data.candles.length, 1000)\n    while (n < maxCandles) {\n      this.zoomLevels.push(n)\n      n *= 2\n    }\n    this.numToShow = 100\n    this.draw()\n  }\n}\n\ninterface WaveOpts {\n  message?: string\n  backgroundColor?: string | boolean // true for <body> background color\n}\n\n/* Wave is a loading animation that displays a colorful line that oscillates */\nexport class Wave extends Chart {\n  ani: Animation\n  size: [number, number]\n  region: Region\n  colorShift: number\n  opts: WaveOpts\n  msgRegion: Region\n  fontSize: number\n\n  constructor (parent: HTMLElement, opts?: WaveOpts) {\n    super(parent, {\n      resize: () => this.resized(),\n      click: (/* e: MouseEvent */) => { /* pass */ },\n      zoom: (/* bigger: boolean */) => { /* pass */ }\n    })\n    this.canvas.classList.add('fill-abs')\n    this.canvas.style.zIndex = '5'\n\n    this.opts = opts ?? {}\n\n    const period = 1500 // ms\n    const start = Math.random() * period\n    this.colorShift = Math.random() * 360\n\n    // y = A*cos(k*x + theta*t + c)\n    // combine three waves with different periods and speeds and phases.\n    const amplitudes = [1, 0.65, 0.75]\n    const ks = [3, 3, 2]\n    const speeds = [Math.PI, Math.PI * 10 / 9, Math.PI / 2.5]\n    const phases = [0, 0, Math.PI * 1.5]\n    const n = 75\n    const single = (n: number, angularX: number, angularTime: number): number => {\n      return amplitudes[n] * Math.cos(ks[n] * angularX + speeds[n] * angularTime + phases[n])\n    }\n    const value = (x: number, angularTime: number): number => {\n      const angularX = x * Math.PI * 2\n      return (single(0, angularX, angularTime) + single(1, angularX, angularTime) + single(2, angularX, angularTime)) / 3\n    }\n    this.resize()\n    this.ani = new Animation(Animation.Forever, () => {\n      const angularTime = (new Date().getTime() - start) / period * Math.PI * 2\n      const values = []\n      for (let i = 0; i < n; i++) {\n        values.push(value(i / (n - 1), angularTime))\n      }\n      this.drawValues(values)\n    })\n  }\n\n  resized () {\n    const opts = this.opts\n    const [maxW, maxH] = [150, 100]\n    const [cw, ch] = [this.canvas.width, this.canvas.height]\n    let [w, h] = [cw * 0.8, ch * 0.8]\n    if (w > maxW) w = maxW\n    if (h > maxH) h = maxH\n    let [l, t] = [(cw - w) / 2, (ch - h) / 2]\n    if (opts.message) {\n      this.fontSize = clamp(h * 0.15, 10, 14)\n      this.applyLabelStyle(this.fontSize)\n      const ypad = this.fontSize * 0.5\n      const halfH = (this.fontSize / 2) + ypad\n      t -= halfH\n      this.msgRegion = new Region(this.ctx, new Extents(0, cw, t + h, t + h + 2 * halfH))\n    }\n    this.region = new Region(this.ctx, new Extents(l, l + w, t, t + h))\n  }\n\n  drawValues (values: number[]) {\n    if (!this.region) return\n    this.clear()\n    const hsl = (h: number) => `hsl(${h}, 35%, 50%)`\n\n    const { region, msgRegion, canvas: { width: w, height: h }, opts: { backgroundColor: bg, message: msg }, colorShift, ctx } = this\n\n    if (bg) {\n      if (bg === true) ctx.fillStyle = State.isDark() ? '#0a1e34' : '#f0f0f0'\n      else ctx.fillStyle = bg\n      ctx.fillRect(0, 0, w, h)\n    }\n\n    region.plot(new Extents(0, 1, -1, 1), (ctx: CanvasRenderingContext2D, t: Translator) => {\n      ctx.lineWidth = 4\n      ctx.lineCap = 'round'\n\n      const shift = colorShift + (new Date().getTime() % 2000) / 2000 * 360 // colors move with frequency 1 / 2s\n      const grad = ctx.createLinearGradient(t.x(0), 0, t.x(1), 0)\n      grad.addColorStop(0, hsl(shift))\n      ctx.strokeStyle = grad\n\n      ctx.beginPath()\n      ctx.moveTo(t.x(0), t.y(values[0]))\n      for (let i = 1; i < values.length; i++) {\n        const prog = i / (values.length - 1)\n        grad.addColorStop(prog, hsl(prog * 300 + shift))\n        ctx.lineTo(t.x(prog), t.y(values[i]))\n      }\n      ctx.stroke()\n    })\n    if (!msg) return\n    msgRegion.plot(new Extents(0, 1, 0, 1), (ctx: CanvasRenderingContext2D, t: Translator) => {\n      this.applyLabelStyle(this.fontSize)\n      ctx.fillText(msg, t.x(0.5), t.y(0.5), this.msgRegion.width())\n    })\n  }\n\n  render () { /* pass */ }\n\n  stop () {\n    this.ani.stop()\n    this.canvas.remove()\n  }\n}\n\n/*\n * Extents holds a min and max in both the x and y directions, and provides\n * getters for related data.\n */\nexport class Extents {\n  x: MinMax\n  y: MinMax\n\n  constructor (xMin: number, xMax: number, yMin: number, yMax: number) {\n    this.setExtents(xMin, xMax, yMin, yMax)\n  }\n\n  setExtents (xMin: number, xMax: number, yMin: number, yMax: number) {\n    this.x = {\n      min: xMin,\n      max: xMax\n    }\n    this.y = {\n      min: yMin,\n      max: yMax\n    }\n  }\n\n  get xRange (): number {\n    return this.x.max - this.x.min\n  }\n\n  get midX (): number {\n    return (this.x.max + this.x.min) / 2\n  }\n\n  get yRange (): number {\n    return this.y.max - this.y.min\n  }\n\n  get midY (): number {\n    return (this.y.max + this.y.min) / 2\n  }\n}\n\n/*\n * Region applies an Extents to the canvas, providing utilities for coordinate\n * transformations and restricting drawing to a specified region of the canvas.\n */\nexport class Region {\n  context: CanvasRenderingContext2D\n  extents: Extents\n\n  constructor (context: CanvasRenderingContext2D, extents: Extents) {\n    this.context = context\n    this.extents = extents\n  }\n\n  setExtents (xMin: number, xMax: number, yMin: number, yMax: number) {\n    this.extents.setExtents(xMin, xMax, yMin, yMax)\n  }\n\n  width (): number {\n    return this.extents.xRange\n  }\n\n  height (): number {\n    return this.extents.yRange\n  }\n\n  contains (x: number, y: number): boolean {\n    const ext = this.extents\n    return (x < ext.x.max && x > ext.x.min &&\n      y < ext.y.max && y > ext.y.min)\n  }\n\n  /*\n   * A translator provides 4 function for coordinate transformations. x and y\n   * translate data coordinates to canvas coordinates for the specified data\n   * Extents. unx and uny translate canvas coordinates to data coordinates.\n   */\n  translator (dataExtents: Extents): Translator {\n    const region = this.extents\n    const xMin = dataExtents.x.min\n    // const xMax = dataExtents.x.max\n    const yMin = dataExtents.y.min\n    // const yMax = dataExtents.y.max\n    const yRange = dataExtents.yRange\n    const xRange = dataExtents.xRange\n    const screenMinX = region.x.min\n    const screenW = region.x.max - screenMinX\n    const screenMaxY = region.y.max\n    const screenH = screenMaxY - region.y.min\n    const xFactor = screenW / xRange\n    const yFactor = screenH / yRange\n    return {\n      x: (x: number) => (x - xMin) * xFactor + screenMinX,\n      y: (y: number) => screenMaxY - (y - yMin) * yFactor,\n      unx: (x: number) => (x - screenMinX) / xFactor + xMin,\n      uny: (y: number) => yMin - (y - screenMaxY) / yFactor,\n      w: (w: number) => w / xRange * screenW,\n      h: (h: number) => -h / yRange * screenH\n    }\n  }\n\n  /* clear clears the region. */\n  clear () {\n    const ext = this.extents\n    this.context.clearRect(ext.x.min, ext.y.min, ext.xRange, ext.yRange)\n  }\n\n  /* plot prepares tools for drawing using data coordinates. */\n  plot (dataExtents: Extents, drawFunc: (ctx: CanvasRenderingContext2D, tools: Translator) => void, skipMask?: boolean) {\n    const ctx = this.context\n    const region = this.extents\n    ctx.save() // Save the original state\n    if (!skipMask) {\n      ctx.beginPath()\n      ctx.rect(region.x.min, region.y.min, region.xRange, region.yRange)\n      ctx.clip()\n    }\n\n    // The drawFunc will be passed a set of tool that can be used to assist\n    // drawing. The tools start with the transformation functions.\n    const tools = this.translator(dataExtents)\n\n    // Create a transformation that allows drawing in data coordinates. It's\n    // not advisable to stroke or add text with this transform in place, as the\n    // result will be distorted. You can however use ctx.moveTo and ctx.lineTo\n    // with this transform in place using data coordinates, and remove the\n    // transform before stroking. The dataCoords method of the supplied tool\n    // provides this functionality.\n\n    // TODO: Figure out why this doesn't work on WebView.\n    // const yRange = dataExtents.yRange\n    // const xFactor = region.xRange / dataExtents.xRange\n    // const yFactor = region.yRange / yRange\n    // const xMin = dataExtents.x.min\n    // const yMin = dataExtents.y.min\n    // // These translation factors are complicated because the (0, 0) of the\n    // // region is not necessarily the (0, 0) of the canvas.\n    // const tx = (region.x.min + xMin) - xMin * xFactor\n    // const ty = -region.y.min - (yRange - yMin) * yFactor\n    // const setTransform = () => {\n    //   // Data coordinates are flipped about y. Flip the coordinates and\n    //   // translate top left corner to canvas (0, 0).\n    //   ctx.transform(1, 0, 0, -1, -xMin, yMin)\n    //   // Scale to data coordinates and shift into place for the region's offset\n    //   // on the canvas.\n    //   ctx.transform(xFactor, 0, 0, yFactor, tx, ty)\n    // }\n    // // dataCoords allows some drawing to be performed directly in data\n    // // coordinates. Most actual drawing functions like ctx.stroke and\n    // // ctx.fillRect should not be called from inside dataCoords, but\n    // // ctx.moveTo and ctx.LineTo are fine.\n    // tools.dataCoords = f => {\n    //   ctx.save()\n    //   setTransform()\n    //   f()\n    //   ctx.restore()\n    // }\n\n    drawFunc(this.context, tools)\n    ctx.restore()\n  }\n}\n\n/*\n * makeLabels attempts to create the appropriate labels for the specified\n * screen size, context, and label spacing.\n */\nfunction makeLabels (\n  ctx: CanvasRenderingContext2D,\n  screenW: number,\n  min: number,\n  max: number,\n  spacingGuess: number,\n  step: number,\n  unit: string,\n  valFmt?: (v: number) => string\n): LabelSet {\n  valFmt = valFmt || Doc.formatFourSigFigs\n  const n = screenW / spacingGuess\n  const diff = max - min\n  if (n < 1 || diff <= 0) return { lbls: [] }\n  const tickGuess = diff / n\n  // make the tick spacing a multiple of the step\n  const tick = tickGuess + step - (tickGuess % step)\n  let x = min + tick - (min % tick)\n  const absMax = Math.max(Math.abs(max), Math.abs(min))\n  // The Math.round part is the minimum precision required to see the change in the numbers.\n  // The 2 accounts for the precision of the tick.\n  const sigFigs = Math.round(Math.log10(absMax / tick)) + 2\n  const pts: Label[] = []\n  let widest = 0\n  while (x < max) {\n    x = Number(x.toPrecision(sigFigs))\n    const lbl = valFmt(x)\n    widest = Math.max(widest, ctx.measureText(lbl).width)\n    pts.push({\n      val: x,\n      txt: lbl\n    })\n    x += tick\n  }\n  const unitW = ctx.measureText(unit).width\n  if (unitW > widest) widest = unitW\n  return {\n    widest: widest,\n    lbls: pts\n  }\n}\n\nconst months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec']\n\n/* makeCandleTimeLabels prepares labels for candlestick data. */\nfunction makeCandleTimeLabels (candles: Candle[], dur: number, screenW: number, spacingGuess: number): LabelSet {\n  const first = candles[0]\n  const last = candles[candles.length - 1]\n  const start = truncate(first.endStamp, dur)\n  const end = truncate(last.endStamp, dur) + dur\n  const diff = end - start\n  const n = Math.min(candles.length, screenW / spacingGuess)\n  const tick = truncate(diff / n, dur)\n  if (tick === 0) {\n    console.error('zero tick', dur, diff, n) // probably won't happen, but it'd suck if it did\n    return { lbls: [] }\n  }\n  let x = start\n  const zoneOffset = new Date().getTimezoneOffset()\n  const dayStamp = (x: number) => {\n    x = x - zoneOffset * 60000\n    return x - (x % 86400000)\n  }\n  let lastDay = dayStamp(start)\n  let lastYear = 0 // new Date(start).getFullYear()\n  if (dayStamp(first.endStamp) === dayStamp(last.endStamp)) lastDay = 0 // Force at least one day stamp.\n  const pts = []\n  let label\n  if (dur < 86400000) {\n    label = (d: Date, x: number) => {\n      const day = dayStamp(x)\n      if (day !== lastDay) return `${months[d.getMonth()]}${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`\n      else return `${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`\n    }\n  } else {\n    label = (d: Date) => {\n      const year = d.getFullYear()\n      if (year !== lastYear) return `${months[d.getMonth()]}${d.getDate()} '${String(year).slice(2, 4)}`\n      else return `${months[d.getMonth()]}${d.getDate()}`\n    }\n  }\n  while (x <= end) {\n    const d = new Date(x)\n    pts.push({\n      val: x,\n      txt: label(d, x)\n    })\n    lastDay = dayStamp(x)\n    lastYear = d.getFullYear()\n    x += tick\n  }\n  return { lbls: pts }\n}\n\n/* The last element of an array. */\nfunction last (arr: any[]): any {\n  return arr[arr.length - 1]\n}\n\n/* line draws a line with the provided context. */\nfunction line (ctx: CanvasRenderingContext2D, x0: number, y0: number, x1: number, y1: number, skipStroke?: boolean) {\n  ctx.beginPath()\n  ctx.moveTo(x0, y0)\n  ctx.lineTo(x1, y1)\n  if (!skipStroke) ctx.stroke()\n}\n\n/* dot draws a circle with the provided context. */\nfunction dot (ctx: CanvasRenderingContext2D, x: number, y: number, color: string, radius: number) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.arc(x, y, radius, 0, PIPI)\n  ctx.fill()\n}\n\n/* floatCompare compares two floats to within a tolerance of  1e-8. */\nfunction floatCompare (a: number, b: number) {\n  return withinTolerance(a, b, 1e-8)\n}\n\n/*\n * withinTolerance returns true if the difference between a and b are with\n * the specified tolerance.\n */\nfunction withinTolerance (a: number, b: number, tolerance: number) {\n  return Math.abs(a - b) < Math.abs(tolerance)\n}\n\nfunction truncate (v: number, w: number): number {\n  return v - (v % w)\n}\n","import Doc from './doc'\nimport {\n  OrderTypeLimit,\n  OrderTypeMarket,\n  OrderTypeCancel,\n  StatusEpoch,\n  StatusBooked,\n  RateEncodingFactor,\n  MatchSideMaker,\n  MakerRedeemed,\n  TakerSwapCast,\n  ImmediateTiF\n} from './orderutil'\nimport {\n  app,\n  PageElement,\n  ExchangeAuth,\n  Order,\n  Market\n} from './registry'\n\nexport const bondReserveMultiplier = 2 // Reserves for next bond\nexport const perTierBaseParcelLimit = 2\nexport const parcelLimitScoreMultiplier = 3\n\nexport class ReputationMeter {\n  page: Record<string, PageElement>\n  host: string\n\n  constructor (div: PageElement) {\n    this.page = Doc.parseTemplate(div)\n    Doc.cleanTemplates(this.page.penaltyMarkerTmpl)\n  }\n\n  setHost (host: string) {\n    this.host = host\n  }\n\n  update () {\n    const { page, host } = this\n    const { auth, maxScore, penaltyThreshold } = app().exchanges[host]\n    const { rep: { score } } = auth\n\n    const displayTier = strongTier(auth)\n\n    const minScore = displayTier ? displayTier * penaltyThreshold * -1 : penaltyThreshold * -1 // Just for looks\n    const warnPct = 25\n    const scorePct = 100 - warnPct\n    page.scoreWarn.style.width = `${warnPct}%`\n    const pos = score >= 0 ? warnPct + (score / maxScore) * scorePct : warnPct - (Math.min(warnPct, score / minScore * warnPct))\n\n    page.scorePointer.style.left = `${pos}%`\n    page.scoreMin.textContent = String(minScore)\n    page.scoreMax.textContent = String(maxScore)\n    const bonus = limitBonus(score, maxScore)\n    page.limitBonus.textContent = bonus.toFixed(1)\n    for (const m of Doc.applySelector(page.scoreTray, '.penalty-marker')) m.remove()\n    if (displayTier > 1) {\n      const markerPct = warnPct / displayTier\n      for (let i = 1; i < displayTier; i++) {\n        const div = page.penaltyMarkerTmpl.cloneNode(true) as PageElement\n        page.scoreTray.appendChild(div)\n        div.style.left = `${markerPct * i}%`\n      }\n    }\n    page.score.textContent = String(score)\n    page.scoreData.classList.remove('negative', 'positive')\n    if (score > 0) page.scoreData.classList.add('positive')\n    else page.scoreData.classList.add('negative')\n  }\n}\n\n/*\n * strongTier is the effective tier, with some respect for bond overlap, such\n * that we don't count weak bonds that have already had their replacements\n * confirmed.\n */\nexport function strongTier (auth: ExchangeAuth): number {\n  const { weakStrength, targetTier, effectiveTier } = auth\n  if (effectiveTier > targetTier) {\n    const diff = effectiveTier - targetTier\n    if (weakStrength >= diff) return targetTier\n    return targetTier + (diff - weakStrength)\n  }\n  return effectiveTier\n}\n\nexport function likelyTaker (ord: Order, rate: number): boolean {\n  if (ord.type === OrderTypeMarket || ord.tif === ImmediateTiF) return true\n  // Must cross the spread to be a taker (not so conservative).\n  if (rate === 0) return false\n  if (ord.sell) return ord.rate < rate\n  return ord.rate > rate\n}\n\nconst preparcelQuantity = (ord: Order, mkt?: Market, midGap?: number) => {\n  const qty = ord.qty - ord.filled\n  if (ord.type === OrderTypeLimit) return qty\n  if (ord.sell) return qty * ord.rate / RateEncodingFactor\n  const rate = midGap || mkt?.spot?.rate || 0\n  // Caller should not call this for market orders without a mkt arg.\n  if (!mkt) return 0\n  // This is tricky. The server will use the mid-gap rate to convert the\n  // order qty. We don't have a mid-gap rate, only a spot rate.\n  if (rate && (mkt?.spot?.bookVolume || 0) > 0) return qty * RateEncodingFactor / rate\n  return mkt.lotsize // server uses same fallback if book is empty\n}\n\nexport function epochWeight (ord: Order, mkt: Market, midGap?: number) {\n  if (ord.status !== StatusEpoch) return 0\n  const qty = preparcelQuantity(ord, mkt, midGap)\n  const rate = midGap || mkt.spot?.rate || 0\n  if (likelyTaker(ord, rate)) return qty * 2\n  return qty\n}\n\nfunction bookWeight (ord: Order) {\n  if (ord.status !== StatusBooked) return 0\n  return preparcelQuantity(ord)\n}\n\nfunction settlingWeight (ord: Order) {\n  let sum = 0\n  for (const m of (ord.matches || [])) {\n    if (m.side === MatchSideMaker) {\n      if (m.status > MakerRedeemed) continue\n    } else if (m.status > TakerSwapCast) continue\n    sum += m.qty\n  }\n  return sum\n}\n\nfunction parcelWeight (ord: Order, mkt: Market, midGap?: number) {\n  if (ord.type === OrderTypeCancel) return 0\n  return epochWeight(ord, mkt, midGap) + bookWeight(ord) + settlingWeight(ord)\n}\n\n// function roundParcels (p: number): number {\n//   return Math.floor(Math.round((p * 1e8)) / 1e8)\n// }\n\nfunction limitBonus (score: number, maxScore: number): number {\n  return score > 0 ? 1 + score / maxScore * (parcelLimitScoreMultiplier - 1) : 1\n}\n\nexport function tradingLimits (host: string): [number, number] { // [usedParcels, parcelLimit]\n  const { auth, maxScore, markets } = app().exchanges[host]\n  const { rep: { score } } = auth\n  const tier = strongTier(auth)\n\n  let usedParcels = 0\n  for (const mkt of Object.values(markets)) {\n    let mktWeight = 0\n    for (const ord of (mkt.inflight || [])) mktWeight += parcelWeight(ord, mkt)\n    for (const ord of (mkt.orders || [])) mktWeight += parcelWeight(ord, mkt)\n    usedParcels += (mktWeight / (mkt.parcelsize * mkt.lotsize))\n  }\n  const parcelLimit = perTierBaseParcelLimit * limitBonus(score, maxScore) * tier\n  return [usedParcels, parcelLimit]\n}\n","import {\n  app,\n  PageElement\n} from './registry'\nimport * as intl from './locales'\n\nexport const Mainnet = 0\nexport const Testnet = 1\nexport const Simnet = 2\n\nconst coinIDTakerFoundMakerRedemption = 'TakerFoundMakerRedemption:'\n\n/* ethBasedExplorerArg returns the explorer argument for ETH, ERC20 and EVM\nCompatible assets and whether the return value is an address. */\nfunction ethBasedExplorerArg (cid: string): [string, boolean] {\n  if (cid.startsWith(coinIDTakerFoundMakerRedemption)) return [cid.substring(coinIDTakerFoundMakerRedemption.length), true]\n  else if (cid.length === 42) return [cid, true]\n  else return [cid, false]\n}\n\nconst ethExplorers: Record<number, (cid: string) => string> = {\n  [Mainnet]: (cid: string) => {\n    const [arg, isAddr] = ethBasedExplorerArg(cid)\n    return isAddr ? `https://etherscan.io/address/${arg}` : `https://etherscan.io/tx/${arg}`\n  },\n  [Testnet]: (cid: string) => {\n    const [arg, isAddr] = ethBasedExplorerArg(cid)\n    return isAddr ? `https://sepolia.etherscan.io/address/${arg}` : `https://sepolia.etherscan.io/tx/${arg}`\n  },\n  [Simnet]: (cid: string) => {\n    const [arg, isAddr] = ethBasedExplorerArg(cid)\n    return isAddr ? `https://etherscan.io/address/${arg}` : `https://etherscan.io/tx/${arg}`\n  }\n}\n\nconst polygonExplorers: Record<number, (cid: string) => string> = {\n  [Mainnet]: (cid: string) => {\n    const [arg, isAddr] = ethBasedExplorerArg(cid)\n    return isAddr ? `https://polygonscan.com/address/${arg}` : `https://polygonscan.com/tx/${arg}`\n  },\n  [Testnet]: (cid: string) => {\n    const [arg, isAddr] = ethBasedExplorerArg(cid)\n    return isAddr ? `https://amoy.polygonscan.com/address/${arg}` : `https://amoy.polygonscan.com/tx/${arg}`\n  },\n  [Simnet]: (cid: string) => {\n    const [arg, isAddr] = ethBasedExplorerArg(cid)\n    return isAddr ? `https://polygonscan.com/address/${arg}` : `https://polygonscan.com/tx/${arg}`\n  }\n}\n\nexport const CoinExplorers: Record<number, Record<number, (cid: string) => string>> = {\n  42: { // dcr\n    [Mainnet]: (cid: string) => {\n      const [txid, vout] = cid.split(':')\n      if (vout !== undefined) return `https://explorer.dcrdata.org/tx/${txid}/out/${vout}`\n      return `https://explorer.dcrdata.org/tx/${txid}`\n    },\n    [Testnet]: (cid: string) => {\n      const [txid, vout] = cid.split(':')\n      if (vout !== undefined) return `https://testnet.dcrdata.org/tx/${txid}/out/${vout}`\n      return `https://testnet.dcrdata.org/tx/${txid}`\n    },\n    [Simnet]: (cid: string) => {\n      const [txid, vout] = cid.split(':')\n      if (vout !== undefined) return `http://127.0.0.1:17779/tx/${txid}/out/${vout}`\n      return `https://127.0.0.1:17779/tx/${txid}`\n    }\n  },\n  0: { // btc\n    [Mainnet]: (cid: string) => `https://mempool.space/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://mempool.space/testnet/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://mempool.space/tx/${cid.split(':')[0]}`\n  },\n  2: { // ltc\n    [Mainnet]: (cid: string) => `https://ltc.bitaps.com/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://sochain.com/tx/LTCTEST/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://ltc.bitaps.com/${cid.split(':')[0]}`\n  },\n  20: { // dgb\n    [Mainnet]: (cid: string) => `https://digiexplorer.info/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://testnetexplorer.digibyteservers.io/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://digiexplorer.info/tx/${cid.split(':')[0]}`\n  },\n  60: ethExplorers,\n  60001: ethExplorers,\n  60002: ethExplorers,\n  3: { // doge\n    [Mainnet]: (cid: string) => `https://dogeblocks.com/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://blockexplorer.one/dogecoin/testnet/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://dogeblocks.com/tx/${cid.split(':')[0]}`\n  },\n  5: { // dash\n    [Mainnet]: (cid: string) => `https://blockexplorer.one/dash/mainnet/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://blockexplorer.one/dash/testnet/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://blockexplorer.one/dash/mainnet/tx/${cid.split(':')[0]}`\n  },\n  133: { // zec\n    [Mainnet]: (cid: string) => `https://zcashblockexplorer.com/transactions/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://blockexplorer.one/zcash/testnet/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://zcashblockexplorer.com/transactions/${cid.split(':')[0]}`\n  },\n  147: { // zcl\n    [Mainnet]: (cid: string) => `https://explorer.zcl.zelcore.io/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://explorer.zcl.zelcore.io/tx/${cid.split(':')[0]}`\n  },\n  136: { // firo\n    [Mainnet]: (cid: string) => `https://explorer.firo.org/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://testexplorer.firo.org/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://explorer.firo.org/tx/${cid.split(':')[0]}`\n  },\n  145: { // bch\n    [Mainnet]: (cid: string) => `https://bch.loping.net/tx/${cid.split(':')[0]}`,\n    [Testnet]: (cid: string) => `https://tbch4.loping.net/tx/${cid.split(':')[0]}`,\n    [Simnet]: (cid: string) => `https://bch.loping.net/tx/${cid.split(':')[0]}`\n  },\n  966: polygonExplorers,\n  966001: polygonExplorers,\n  966002: polygonExplorers,\n  966003: polygonExplorers,\n  966004: polygonExplorers\n}\n\nexport function formatCoinID (cid: string) {\n  if (cid.startsWith(coinIDTakerFoundMakerRedemption)) {\n    const makerAddr = cid.substring(coinIDTakerFoundMakerRedemption.length)\n    return intl.prep(intl.ID_TAKER_FOUND_MAKER_REDEMPTION, { makerAddr: makerAddr })\n  }\n  return cid\n}\n\n/*\n * baseChainID returns the asset ID for the asset's parent if the asset is a\n * token, otherwise the ID for the asset itself.\n */\nfunction baseChainID (assetID: number) {\n  const asset = app().user.assets[assetID]\n  return asset.token ? asset.token.parentID : assetID\n}\n\n/*\n * setCoinHref sets the hyperlink element's href attribute based on provided\n * assetID and data-explorer-coin value present on supplied link element.\n */\nexport function setCoinHref (assetID: number, link: PageElement) {\n  const net = app().user.net\n  const assetExplorer = CoinExplorers[baseChainID(assetID)]\n  if (!assetExplorer) return\n  const formatter = assetExplorer[net]\n  if (!formatter) return\n  link.classList.remove('plainlink')\n  link.classList.add('subtlelink')\n  link.href = formatter(link.dataset.explorerCoin || '')\n}\n","import {\n  app,\n  PageElement,\n  BotConfig,\n  MMBotStatus,\n  CEXConfig,\n  MarketMakingStatus,\n  ExchangeBalance,\n  RunStats,\n  StartConfig,\n  MarketWithHost,\n  RunningBotInventory,\n  Spot,\n  OrderPlacement,\n  Token,\n  UnitInfo,\n  MarketReport,\n  BotBalanceAllocation,\n  ProjectedAlloc,\n  BalanceNote,\n  BotBalance,\n  Order,\n  LotFeeRange,\n  BookingFees,\n  BotProblems,\n  EpochReportNote,\n  OrderReport,\n  EpochReport,\n  TradePlacement,\n  SupportedAsset,\n  CEXProblemsNote,\n  CEXProblems\n} from './registry'\nimport { getJSON, postJSON } from './http'\nimport Doc, { clamp } from './doc'\nimport * as OrderUtil from './orderutil'\nimport { Chart, Region, Extents, Translator } from './charts'\nimport * as intl from './locales'\nimport { Forms } from './forms'\n\nexport const GapStrategyMultiplier = 'multiplier'\nexport const GapStrategyAbsolute = 'absolute'\nexport const GapStrategyAbsolutePlus = 'absolute-plus'\nexport const GapStrategyPercent = 'percent'\nexport const GapStrategyPercentPlus = 'percent-plus'\n\nexport const botTypeBasicMM = 'basicMM'\nexport const botTypeArbMM = 'arbMM'\nexport const botTypeBasicArb = 'basicArb'\n\nexport interface CEXDisplayInfo {\n  name: string\n  logo: string\n}\n\nexport const CEXDisplayInfos: Record<string, CEXDisplayInfo> = {\n  'Binance': {\n    name: 'Binance',\n    logo: '/img/binance.com.png'\n  },\n  'BinanceUS': {\n    name: 'Binance U.S.',\n    logo: '/img/binance.us.png'\n  }\n}\n\n/*\n * MarketMakerBot is the front end representation of the server's\n * mm.MarketMaker. MarketMakerBot is a singleton assigned to MM below.\n */\nclass MarketMakerBot {\n  cexBalanceCache: Record<string, Record<number, ExchangeBalance>> = {}\n\n  /*\n   * updateBotConfig appends or updates the specified BotConfig.\n   */\n  async updateBotConfig (cfg: BotConfig) {\n    return postJSON('/api/updatebotconfig', cfg)\n  }\n\n  /*\n   * updateCEXConfig appends or updates the specified CEXConfig.\n   */\n  async updateCEXConfig (cfg: CEXConfig) {\n    return postJSON('/api/updatecexconfig', cfg)\n  }\n\n  async removeBotConfig (host: string, baseID: number, quoteID: number) {\n    return postJSON('/api/removebotconfig', { host, baseID, quoteID })\n  }\n\n  async report (host: string, baseID: number, quoteID: number) {\n    return postJSON('/api/marketreport', { host, baseID, quoteID })\n  }\n\n  async startBot (config: StartConfig) {\n    return await postJSON('/api/startmarketmakingbot', { config })\n  }\n\n  async stopBot (market: MarketWithHost) : Promise<void> {\n    await postJSON('/api/stopmarketmakingbot', { market })\n  }\n\n  async status () : Promise<MarketMakingStatus> {\n    return (await getJSON('/api/marketmakingstatus')).status\n  }\n\n  // botStats returns the RunStats for a running bot with the specified parameters.\n  botStats (baseID: number, quoteID: number, host: string, startTime: number): RunStats | undefined {\n    for (const botStatus of Object.values(app().mmStatus.bots)) {\n      if (!botStatus.runStats) continue\n      const runStats = botStatus.runStats\n      const cfg = botStatus.config\n      if (cfg.baseID === baseID && cfg.quoteID === quoteID && cfg.host === host && runStats.startTime === startTime) {\n        return runStats\n      }\n    }\n  }\n\n  cachedCexBalance (cexName: string, assetID: number): ExchangeBalance | undefined {\n    return this.cexBalanceCache[cexName]?.[assetID]\n  }\n\n  async cexBalance (cexName: string, assetID: number): Promise<ExchangeBalance> {\n    if (!this.cexBalanceCache[cexName]) this.cexBalanceCache[cexName] = {}\n    const cexBalance = (await postJSON('/api/cexbalance', { cexName, assetID })).cexBalance\n    this.cexBalanceCache[cexName][assetID] = cexBalance\n    return cexBalance\n  }\n}\n\n// MM is the front end representation of the server's mm.MarketMaker.\nexport const MM = new MarketMakerBot()\n\nexport function runningBotInventory (assetID: number): RunningBotInventory {\n  return app().mmStatus.bots.reduce((v, { runStats, running }) => {\n    if (!running || !runStats) return v\n    const { dexBalances: d, cexBalances: c } = runStats\n    v.cex.locked += c[assetID]?.locked ?? 0\n    v.cex.locked += c[assetID]?.reserved ?? 0\n    v.cex.avail += c[assetID]?.available ?? 0\n    v.cex.total = v.cex.avail + v.cex.locked\n    v.dex.locked += d[assetID]?.locked ?? 0\n    v.dex.locked += d[assetID]?.reserved ?? 0\n    v.dex.avail += d[assetID]?.available ?? 0\n    v.dex.total = v.dex.avail + v.dex.locked\n    v.avail += (d[assetID]?.available ?? 0) + (c[assetID]?.available ?? 0)\n    v.locked += (d[assetID]?.locked ?? 0) + (c[assetID]?.locked ?? 0)\n    return v\n  }, { avail: 0, locked: 0, cex: { avail: 0, locked: 0, total: 0 }, dex: { avail: 0, locked: 0, total: 0 } })\n}\n\nexport function setMarketElements (ancestor: PageElement, baseID: number, quoteID: number, host: string) {\n  Doc.setText(ancestor, '[data-host]', host)\n  const { unitInfo: bui, name: baseName, symbol: baseSymbol, token: baseToken } = app().assets[baseID]\n  Doc.setText(ancestor, '[data-base-name]', baseName)\n  Doc.setSrc(ancestor, '[data-base-logo]', Doc.logoPath(baseSymbol))\n  Doc.setText(ancestor, '[data-base-ticker]', bui.conventional.unit)\n  const { unitInfo: baseFeeUI, name: baseFeeName, symbol: baseFeeSymbol } = app().assets[baseToken ? baseToken.parentID : baseID]\n  Doc.setText(ancestor, '[data-base-fee-name]', baseFeeName)\n  Doc.setSrc(ancestor, '[data-base-fee-logo]', Doc.logoPath(baseFeeSymbol))\n  Doc.setText(ancestor, '[data-base-fee-ticker]', baseFeeUI.conventional.unit)\n  const { unitInfo: qui, name: quoteName, symbol: quoteSymbol, token: quoteToken } = app().assets[quoteID]\n  Doc.setText(ancestor, '[data-quote-name]', quoteName)\n  Doc.setSrc(ancestor, '[data-quote-logo]', Doc.logoPath(quoteSymbol))\n  Doc.setText(ancestor, '[data-quote-ticker]', qui.conventional.unit)\n  const { unitInfo: quoteFeeUI, name: quoteFeeName, symbol: quoteFeeSymbol } = app().assets[quoteToken ? quoteToken.parentID : quoteID]\n  Doc.setText(ancestor, '[data-quote-fee-name]', quoteFeeName)\n  Doc.setSrc(ancestor, '[data-quote-fee-logo]', Doc.logoPath(quoteFeeSymbol))\n  Doc.setText(ancestor, '[data-quote-fee-ticker]', quoteFeeUI.conventional.unit)\n}\n\nexport function setCexElements (ancestor: PageElement, cexName: string) {\n  const dinfo = CEXDisplayInfos[cexName]\n  Doc.setText(ancestor, '[data-cex-name]', dinfo.name)\n  Doc.setSrc(ancestor, '[data-cex-logo]', dinfo.logo)\n  for (const img of Doc.applySelector(ancestor, '[data-cex-logo]')) Doc.show(img)\n}\n\nexport function calculateQuoteLot (lotSize: number, baseID: number, quoteID: number, spot?: Spot) {\n  const baseRate = app().fiatRatesMap[baseID]\n  const quoteRate = app().fiatRatesMap[quoteID]\n  const { unitInfo: { conventional: { conversionFactor: bFactor } } } = app().assets[baseID]\n  const { unitInfo: { conventional: { conversionFactor: qFactor } } } = app().assets[quoteID]\n  if (baseRate && quoteRate) {\n    return lotSize * baseRate / quoteRate * qFactor / bFactor\n  } else if (spot) {\n    return lotSize * spot.rate / OrderUtil.RateEncodingFactor\n  }\n  return qFactor\n}\n\nexport interface PlacementChartConfig {\n  cexName: string\n  botType: string\n  baseFiatRate: number\n  dict: {\n    profit: number\n    buyPlacements: OrderPlacement[]\n    sellPlacements: OrderPlacement[]\n  }\n}\n\nexport class PlacementsChart extends Chart {\n  cfg: PlacementChartConfig\n  loadedCEX: string\n  cexLogo: HTMLImageElement\n\n  constructor (parent: PageElement) {\n    super(parent, {\n      resize: () => this.resized(),\n      click: (/* e: MouseEvent */) => { /* pass */ },\n      zoom: (/* bigger: boolean */) => { /* pass */ }\n    })\n  }\n\n  resized () {\n    this.render()\n  }\n\n  draw () { /* pass */ }\n\n  setMarket (cfg: PlacementChartConfig) {\n    this.cfg = cfg\n    const { loadedCEX, cfg: { cexName } } = this\n    if (cexName && cexName !== loadedCEX) {\n      this.loadedCEX = cexName\n      this.cexLogo = new Image()\n      Doc.bind(this.cexLogo, 'load', () => { this.render() })\n      this.cexLogo.src = CEXDisplayInfos[cexName || ''].logo\n    }\n    this.render()\n  }\n\n  render () {\n    const { ctx, canvas, theme, cfg } = this\n    if (canvas.width === 0 || !cfg) return\n    const { dict: { buyPlacements, sellPlacements, profit }, baseFiatRate, botType } = cfg\n    if (botType === botTypeBasicArb) return\n\n    this.clear()\n\n    const drawDashedLine = (x0: number, y0: number, x1: number, y1: number, color: string) => {\n      ctx.save()\n      ctx.setLineDash([3, 5])\n      ctx.lineWidth = 1.5\n      ctx.strokeStyle = color\n      this.line(x0, y0, x1, y1)\n      ctx.restore()\n    }\n\n    const isBasicMM = botType === botTypeBasicMM\n    const cx = canvas.width / 2\n    const [cexGapL, cexGapR] = isBasicMM ? [cx, cx] : [0.48 * canvas.width, 0.52 * canvas.width]\n\n    const buyLots = buyPlacements.reduce((v: number, p: OrderPlacement) => v + p.lots, 0)\n    const sellLots = sellPlacements.reduce((v: number, p: OrderPlacement) => v + p.lots, 0)\n    const maxLots = Math.max(buyLots, sellLots)\n\n    let widest = 0\n    let fauxSpacer = 0\n    if (isBasicMM) {\n      const leftmost = buyPlacements.reduce((v: number, p: OrderPlacement) => Math.max(v, p.gapFactor), 0)\n      const rightmost = sellPlacements.reduce((v: number, p: OrderPlacement) => Math.max(v, p.gapFactor), 0)\n      widest = Math.max(leftmost, rightmost)\n    } else {\n      // For arb-mm, we don't know how the orders will be spaced because it\n      // depends on the vwap. But we're just trying to capture the general sense\n      // of how the parameters will affect order placement, so we'll fake it.\n      // Higher match buffer values will lead to orders with less favorable\n      // rates, e.g. the spacing will be larger.\n      const ps = [...buyPlacements, ...sellPlacements]\n      const matchBuffer = ps.reduce((sum: number, p: OrderPlacement) => sum + p.gapFactor, 0) / ps.length\n      fauxSpacer = 0.01 * (1 + matchBuffer)\n      widest = Math.min(10, Math.max(buyPlacements.length, sellPlacements.length)) * fauxSpacer // arb-mm\n    }\n\n    // Make the range 15% on each side, which will include profit + placements,\n    // unless they have orders with larger gap factors.\n    const minRange = profit + widest\n    const defaultRange = 0.155\n    const range = Math.max(minRange * 1.05, defaultRange)\n\n    // Increase data height logarithmically up to 1,000,000 USD.\n    const maxCommitUSD = maxLots * baseFiatRate\n    const regionHeight = 0.2 + 0.7 * Math.log(clamp(maxCommitUSD, 0, 1e6)) / Math.log(1e6)\n\n    // Draw a region in the middle representing the cex gap.\n    const plotRegion = new Region(ctx, new Extents(0, canvas.width, 0, canvas.height))\n\n    if (isBasicMM) {\n      drawDashedLine(cx, 0, cx, canvas.height, theme.gapLine)\n    } else { // arb-mm\n      plotRegion.plot(new Extents(0, 1, 0, 1), (ctx: CanvasRenderingContext2D, tools: Translator) => {\n        const [y0, y1] = [tools.y(0), tools.y(1)]\n        drawDashedLine(cexGapL, y0, cexGapL, y1, theme.gapLine)\n        drawDashedLine(cexGapR, y0, cexGapR, y1, theme.gapLine)\n        const y = tools.y(0.95)\n        ctx.drawImage(this.cexLogo, cx - 8, y, 16, 16)\n        this.applyLabelStyle(18)\n        ctx.fillText('δ', cx, y + 29)\n      })\n    }\n\n    const plotSide = (isBuy: boolean, placements: OrderPlacement[]) => {\n      if (!placements?.length) return\n      const [xMin, xMax] = isBuy ? [0, cexGapL] : [cexGapR, canvas.width]\n      const reg = new Region(ctx, new Extents(xMin, xMax, canvas.height * (1 - regionHeight), canvas.height))\n      const [l, r] = isBuy ? [-range, 0] : [0, range]\n      reg.plot(new Extents(l, r, 0, maxLots), (ctx: CanvasRenderingContext2D, tools: Translator) => {\n        ctx.lineWidth = 2.5\n        ctx.strokeStyle = isBuy ? theme.buyLine : theme.sellLine\n        ctx.fillStyle = isBuy ? theme.buyFill : theme.sellFill\n        ctx.beginPath()\n        const sideFactor = isBuy ? -1 : 1\n        const firstPt = placements[0]\n        const y0 = tools.y(0)\n        const firstX = tools.x((isBasicMM ? firstPt.gapFactor : profit + fauxSpacer) * sideFactor)\n        ctx.moveTo(firstX, y0)\n        let cumulativeLots = 0\n        for (let i = 0; i < placements.length; i++) {\n          const p = placements[i]\n          // For arb-mm, we don't know exactly\n          const rawX = isBasicMM ? p.gapFactor : profit + (i + 1) * fauxSpacer\n          const x = tools.x(rawX * sideFactor)\n          ctx.lineTo(x, tools.y(cumulativeLots))\n          cumulativeLots += p.lots\n          ctx.lineTo(x, tools.y(cumulativeLots))\n        }\n        const xInfinity = isBuy ? canvas.width * -0.1 : canvas.width * 1.1\n        ctx.lineTo(xInfinity, tools.y(cumulativeLots))\n        ctx.stroke()\n        ctx.lineTo(xInfinity, y0)\n        ctx.lineTo(firstX, y0)\n        ctx.closePath()\n        ctx.globalAlpha = 0.25\n        ctx.fill()\n      }, true)\n    }\n\n    plotSide(false, sellPlacements)\n    plotSide(true, buyPlacements)\n  }\n}\n\nexport function hostedMarketID (host: string, baseID: number, quoteID: number) {\n  return `${host}-${baseID}-${quoteID}` // same as MarketWithHost.String()\n}\n\nexport function liveBotConfig (host: string, baseID: number, quoteID: number): BotConfig | undefined {\n  const s = liveBotStatus(host, baseID, quoteID)\n  if (s) return s.config\n}\n\nexport function liveBotStatus (host: string, baseID: number, quoteID: number): MMBotStatus | undefined {\n  const statuses = (app().mmStatus.bots || []).filter((s: MMBotStatus) => {\n    return s.config.baseID === baseID && s.config.quoteID === quoteID && s.config.host === host\n  })\n  if (statuses.length) return statuses[0]\n}\n\ninterface Lotter {\n  lots: number\n}\n\nfunction sumLots (lots: number, p: Lotter) {\n  return lots + p.lots\n}\n\ninterface AllocationProjection {\n  bProj: ProjectedAlloc\n  qProj: ProjectedAlloc\n  alloc: Record<number, number>\n}\n\nfunction emptyProjection (): ProjectedAlloc {\n  return { book: 0, bookingFees: 0, swapFeeReserves: 0, cex: 0, orderReserves: 0, slippageBuffer: 0 }\n}\n\nexport class BotMarket {\n  cfg: BotConfig\n  host: string\n  baseID: number\n  baseSymbol: string\n  baseTicker: string\n  baseFeeID: number\n  baseIsAccountLocker: boolean\n  baseFeeSymbol: string\n  baseFeeTicker: string\n  baseToken?: Token\n  quoteID: number\n  quoteSymbol: string\n  quoteTicker: string\n  quoteFeeID: number\n  quoteIsAccountLocker: boolean\n  quoteFeeSymbol: string\n  quoteFeeTicker: string\n  quoteToken?: Token\n  botType: string\n  cexName: string\n  dinfo: CEXDisplayInfo\n  alloc: BotBalanceAllocation\n  proj: AllocationProjection\n  bui: UnitInfo\n  baseFactor: number\n  baseFeeUI: UnitInfo\n  baseFeeFactor: number\n  qui: UnitInfo\n  quoteFactor: number\n  quoteFeeUI: UnitInfo\n  quoteFeeFactor: number\n  id: string // includes host\n  mktID: string\n  lotSize: number\n  lotSizeConv: number\n  lotSizeUSD: number\n  quoteLot: number\n  quoteLotConv: number\n  quoteLotUSD: number\n  rateStep: number\n  baseFeeFiatRate: number\n  quoteFeeFiatRate: number\n  baseLots: number\n  quoteLots: number\n  marketReport: MarketReport\n  nBuyPlacements: number\n  nSellPlacements: number\n\n  constructor (cfg: BotConfig) {\n    const host = this.host = cfg.host\n    const baseID = this.baseID = cfg.baseID\n    const quoteID = this.quoteID = cfg.quoteID\n    this.cexName = cfg.cexName\n    const status = app().mmStatus.bots.find(({ config: c }: MMBotStatus) => c.baseID === baseID && c.quoteID === quoteID && c.host === host)\n    if (!status) throw Error('where\\'s the bot status?')\n    this.cfg = status.config\n\n    const { token: baseToken, symbol: baseSymbol, unitInfo: bui } = app().assets[baseID]\n    this.baseSymbol = baseSymbol\n    this.baseTicker = bui.conventional.unit\n    this.bui = bui\n    this.baseFactor = bui.conventional.conversionFactor\n    this.baseToken = baseToken\n    const baseFeeID = this.baseFeeID = baseToken ? baseToken.parentID : baseID\n    const { unitInfo: baseFeeUI, symbol: baseFeeSymbol, wallet: baseWallet } = app().assets[this.baseFeeID]\n    const traitAccountLocker = 1 << 14\n    this.baseIsAccountLocker = (baseWallet.traits & traitAccountLocker) > 0\n    this.baseFeeUI = baseFeeUI\n    this.baseFeeTicker = baseFeeUI.conventional.unit\n    this.baseFeeSymbol = baseFeeSymbol\n    this.baseFeeFactor = this.baseFeeUI.conventional.conversionFactor\n\n    const { token: quoteToken, symbol: quoteSymbol, unitInfo: qui } = app().assets[quoteID]\n    this.quoteSymbol = quoteSymbol\n    this.quoteTicker = qui.conventional.unit\n    this.qui = qui\n    this.quoteFactor = qui.conventional.conversionFactor\n    this.quoteToken = quoteToken\n    const quoteFeeID = this.quoteFeeID = quoteToken ? quoteToken.parentID : quoteID\n    const { unitInfo: quoteFeeUI, symbol: quoteFeeSymbol, wallet: quoteWallet } = app().assets[this.quoteFeeID]\n    this.quoteIsAccountLocker = (quoteWallet.traits & traitAccountLocker) > 0\n    this.quoteFeeUI = quoteFeeUI\n    this.quoteFeeTicker = quoteFeeUI.conventional.unit\n    this.quoteFeeSymbol = quoteFeeSymbol\n    this.quoteFeeFactor = this.quoteFeeUI.conventional.conversionFactor\n\n    this.id = hostedMarketID(host, baseID, quoteID)\n    this.mktID = `${baseSymbol}_${quoteSymbol}`\n\n    const { markets } = app().exchanges[host]\n    const { lotsize: lotSize, ratestep: rateStep } = markets[this.mktID]\n    this.lotSize = lotSize\n    this.lotSizeConv = lotSize / bui.conventional.conversionFactor\n    this.rateStep = rateStep\n    this.quoteLot = calculateQuoteLot(lotSize, baseID, quoteID)\n    this.quoteLotConv = this.quoteLot / qui.conventional.conversionFactor\n\n    this.baseFeeFiatRate = app().fiatRatesMap[baseFeeID]\n    this.quoteFeeFiatRate = app().fiatRatesMap[quoteFeeID]\n\n    if (cfg.arbMarketMakingConfig) {\n      this.botType = botTypeArbMM\n      this.baseLots = cfg.arbMarketMakingConfig.sellPlacements.reduce(sumLots, 0)\n      this.quoteLots = cfg.arbMarketMakingConfig.buyPlacements.reduce(sumLots, 0)\n      this.nBuyPlacements = cfg.arbMarketMakingConfig.buyPlacements.length\n      this.nSellPlacements = cfg.arbMarketMakingConfig.sellPlacements.length\n    } else if (cfg.simpleArbConfig) {\n      this.botType = botTypeBasicArb\n      this.baseLots = cfg.uiConfig.simpleArbLots as number\n      this.quoteLots = cfg.uiConfig.simpleArbLots as number\n    } else if (cfg.basicMarketMakingConfig) { // basicmm\n      this.botType = botTypeBasicMM\n      this.baseLots = cfg.basicMarketMakingConfig.sellPlacements.reduce(sumLots, 0)\n      this.quoteLots = cfg.basicMarketMakingConfig.buyPlacements.reduce(sumLots, 0)\n      this.nBuyPlacements = cfg.basicMarketMakingConfig.buyPlacements.length\n      this.nSellPlacements = cfg.basicMarketMakingConfig.sellPlacements.length\n    }\n  }\n\n  async initialize () {\n    const { host, baseID, quoteID, lotSizeConv, quoteLotConv } = this\n    const res = await MM.report(host, baseID, quoteID)\n    const r = this.marketReport = res.report as MarketReport\n    this.lotSizeUSD = lotSizeConv * r.baseFiatRate\n    this.quoteLotUSD = quoteLotConv * r.quoteFiatRate\n    this.proj = this.projectedAllocations()\n  }\n\n  status () {\n    const { baseID, quoteID } = this\n    const botStatus = app().mmStatus.bots.find((s: MMBotStatus) => s.config.baseID === baseID && s.config.quoteID === quoteID)\n    if (!botStatus) return { botCfg: {} as BotConfig, running: false, runStats: {} as RunStats }\n    const { config: botCfg, running, runStats, latestEpoch, cexProblems } = botStatus\n    return { botCfg, running, runStats, latestEpoch, cexProblems }\n  }\n\n  /*\n  * adjustedBalances calculates the user's available balances and fee-asset\n  * balances for a market, with consideration for currently running bots.\n  */\n  adjustedBalances () {\n    const {\n      baseID, quoteID, baseFeeID, quoteFeeID, cexName,\n      baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor\n    } = this\n    const [baseWallet, quoteWallet] = [app().walletMap[baseID], app().walletMap[quoteID]]\n    const [bInv, qInv] = [runningBotInventory(baseID), runningBotInventory(quoteID)]\n\n    // In these available balance calcs, only subtract the available balance of\n    // running bots, since the locked/reserved/immature is already subtracted\n    // from the wallet's total available balance.\n    let cexBaseAvail = 0\n    let cexQuoteAvail = 0\n    let cexBaseBalance: ExchangeBalance | undefined\n    let cexQuoteBalance: ExchangeBalance | undefined\n    if (cexName) {\n      const cex = app().mmStatus.cexes[cexName]\n      if (!cex) throw Error('where\\'s the cex status?')\n      cexBaseBalance = cex.balances[baseID]\n      cexQuoteBalance = cex.balances[quoteID]\n    }\n    if (cexBaseBalance) cexBaseAvail = (cexBaseBalance.available || 0) - bInv.cex.avail\n    if (cexQuoteBalance) cexQuoteAvail = (cexQuoteBalance.available || 0) - qInv.cex.avail\n    const [dexBaseAvail, dexQuoteAvail] = [baseWallet.balance.available - bInv.dex.avail, quoteWallet.balance.available - qInv.dex.avail]\n    const baseAvail = dexBaseAvail + cexBaseAvail\n    const quoteAvail = dexQuoteAvail + cexQuoteAvail\n    const baseFeeWallet = baseFeeID === baseID ? baseWallet : app().walletMap[baseFeeID]\n    const quoteFeeWallet = quoteFeeID === quoteID ? quoteWallet : app().walletMap[quoteFeeID]\n\n    let [baseFeeAvail, dexBaseFeeAvail, cexBaseFeeAvail] = [baseAvail, dexBaseAvail, cexBaseAvail]\n    if (baseFeeID !== baseID) {\n      const bFeeInv = runningBotInventory(baseID)\n      dexBaseFeeAvail = baseFeeWallet.balance.available - bFeeInv.dex.total\n      if (cexBaseBalance) cexBaseFeeAvail = (cexBaseBalance.available || 0) - bFeeInv.cex.total\n      baseFeeAvail = dexBaseFeeAvail + cexBaseFeeAvail\n    }\n    let [quoteFeeAvail, dexQuoteFeeAvail, cexQuoteFeeAvail] = [quoteAvail, dexQuoteAvail, cexQuoteAvail]\n    if (quoteFeeID !== quoteID) {\n      const qFeeInv = runningBotInventory(quoteID)\n      dexQuoteFeeAvail = quoteFeeWallet.balance.available - qFeeInv.dex.total\n      if (cexQuoteBalance) cexQuoteFeeAvail = (cexQuoteBalance.available || 0) - qFeeInv.cex.total\n      quoteFeeAvail = dexQuoteFeeAvail + cexQuoteFeeAvail\n    }\n    return { // convert to conventioanl.\n      baseAvail: baseAvail / baseFactor,\n      quoteAvail: quoteAvail / quoteFactor,\n      dexBaseAvail: dexBaseAvail / baseFactor,\n      dexQuoteAvail: dexQuoteAvail / quoteFactor,\n      cexBaseAvail: cexBaseAvail / baseFactor,\n      cexQuoteAvail: cexQuoteAvail / quoteFactor,\n      baseFeeAvail: baseFeeAvail / baseFeeFactor,\n      quoteFeeAvail: quoteFeeAvail / quoteFeeFactor,\n      dexBaseFeeAvail: dexBaseFeeAvail / baseFeeFactor,\n      dexQuoteFeeAvail: dexQuoteFeeAvail / quoteFeeFactor,\n      cexBaseFeeAvail: cexBaseFeeAvail / baseFeeFactor,\n      cexQuoteFeeAvail: cexQuoteFeeAvail / quoteFeeFactor\n    }\n  }\n\n  /*\n   * feesAndCommit generates a snapshot of current market fees, as well as a\n   * \"commit\", which is the funding dedicated to being on order. The commit\n   * values do not include booking fees, order reserves, etc. just the order\n   * quantity.\n   */\n  feesAndCommit () {\n    const {\n      baseID, quoteID, marketReport: { baseFees, quoteFees }, lotSize,\n      baseLots, quoteLots, baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker,\n      cfg: { uiConfig: { baseConfig, quoteConfig } }\n    } = this\n\n    return feesAndCommit(\n      baseID, quoteID, baseFees, quoteFees, lotSize, baseLots, quoteLots,\n      baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker,\n      baseConfig.orderReservesFactor, quoteConfig.orderReservesFactor\n    )\n  }\n\n  /*\n   * projectedAllocations calculates the required asset allocations from the\n   * user's configuration settings and the current market state.\n   */\n  projectedAllocations () {\n    const {\n      cfg: { uiConfig: { quoteConfig, baseConfig } },\n      baseFactor, quoteFactor, baseID, quoteID, lotSizeConv, quoteLotConv,\n      baseFeeFactor, quoteFeeFactor, baseFeeID, quoteFeeID, baseToken,\n      quoteToken, cexName\n    } = this\n    const { commit, fees } = this.feesAndCommit()\n\n    const bProj = emptyProjection()\n    const qProj = emptyProjection()\n\n    bProj.book = commit.dex.base.lots * lotSizeConv\n    qProj.book = commit.cex.base.lots * quoteLotConv\n\n    bProj.orderReserves = Math.max(commit.cex.base.val, commit.dex.base.val) * baseConfig.orderReservesFactor / baseFactor\n    qProj.orderReserves = Math.max(commit.cex.quote.val, commit.dex.quote.val) * quoteConfig.orderReservesFactor / quoteFactor\n\n    if (cexName) {\n      bProj.cex = commit.cex.base.lots * lotSizeConv\n      qProj.cex = commit.cex.quote.lots * quoteLotConv\n    }\n\n    bProj.bookingFees = fees.base.bookingFees / baseFeeFactor\n    qProj.bookingFees = fees.quote.bookingFees / quoteFeeFactor\n\n    if (baseToken) bProj.swapFeeReserves = fees.base.tokenFeesPerSwap * baseConfig.swapFeeN / baseFeeFactor\n    if (quoteToken) qProj.swapFeeReserves = fees.quote.tokenFeesPerSwap * quoteConfig.swapFeeN / quoteFeeFactor\n    qProj.slippageBuffer = (qProj.book + qProj.cex + qProj.orderReserves) * quoteConfig.slippageBufferFactor\n\n    const alloc: Record<number, number> = {}\n    const addAlloc = (assetID: number, amt: number) => { alloc[assetID] = (alloc[assetID] ?? 0) + amt }\n    addAlloc(baseID, Math.round((bProj.book + bProj.cex + bProj.orderReserves) * baseFactor))\n    addAlloc(baseFeeID, Math.round((bProj.bookingFees + bProj.swapFeeReserves) * baseFeeFactor))\n    addAlloc(quoteID, Math.round((qProj.book + qProj.cex + qProj.orderReserves + qProj.slippageBuffer) * quoteFactor))\n    addAlloc(quoteFeeID, Math.round((qProj.bookingFees + qProj.swapFeeReserves) * quoteFeeFactor))\n\n    return { qProj, bProj, alloc }\n  }\n\n  /*\n   * fundingState examines the projected allocations and the user's wallet\n   * balances to determine whether the user can fund the bot fully, unbalanced,\n   * or starved, and what funding source options might be available.\n   */\n  fundingState () {\n    const {\n      proj: { bProj, qProj }, baseID, quoteID, baseFeeID, quoteFeeID,\n      cfg: { uiConfig: { cexRebalance } }, cexName\n    } = this\n    const {\n      baseAvail, quoteAvail, dexBaseAvail, dexQuoteAvail, cexBaseAvail, cexQuoteAvail,\n      dexBaseFeeAvail, dexQuoteFeeAvail\n    } = this.adjustedBalances()\n\n    const canRebalance = Boolean(cexName && cexRebalance)\n\n    // Three possible states.\n    // 1. We have the funding in the projection, and its in the right places.\n    //    Give them some options for which wallet to pull order reserves from,\n    //    but they can start immediately..\n    // 2. We have the funding, but it's in the wrong place or the wrong asset,\n    //    but we have deposits and withdraws enabled. We can offer them the\n    //    option to start in an unbalanced state.\n    // 3. We don't have the funds. We offer them an option to start in a\n    //    starved state.\n    const cexMinBaseAlloc = bProj.cex\n    let [dexMinBaseAlloc, transferableBaseAlloc, dexBaseFeeReq] = [bProj.book, 0, 0]\n    // Only add booking fees if this is the fee asset.\n    if (baseID === baseFeeID) dexMinBaseAlloc += bProj.bookingFees\n    // Base asset is a token.\n    else dexBaseFeeReq += bProj.bookingFees + bProj.swapFeeReserves\n    // If we can rebalance, the order reserves could potentially be withdrawn.\n    if (canRebalance) transferableBaseAlloc += bProj.orderReserves\n    // If we can't rebalance, order reserves are required in dex balance.\n    else dexMinBaseAlloc += bProj.orderReserves\n    // Handle the special case where the base asset it the quote asset's fee\n    // asset.\n    if (baseID === quoteFeeID) {\n      if (canRebalance) transferableBaseAlloc += qProj.bookingFees + qProj.swapFeeReserves\n      else dexMinBaseAlloc += qProj.bookingFees + qProj.swapFeeReserves\n    }\n\n    let [dexMinQuoteAlloc, cexMinQuoteAlloc, transferableQuoteAlloc, dexQuoteFeeReq] = [qProj.book, qProj.cex, 0, 0]\n    if (quoteID === quoteFeeID) dexMinQuoteAlloc += qProj.bookingFees\n    else dexQuoteFeeReq += qProj.bookingFees + qProj.swapFeeReserves\n    if (canRebalance) transferableQuoteAlloc += qProj.orderReserves + qProj.slippageBuffer\n    else {\n      // The slippage reserves reserves should be split between cex and dex.\n      dexMinQuoteAlloc += qProj.orderReserves\n      const basis = qProj.book + qProj.cex + qProj.orderReserves\n      dexMinQuoteAlloc += (qProj.book + qProj.orderReserves) / basis * qProj.slippageBuffer\n      cexMinQuoteAlloc += qProj.cex / basis * qProj.slippageBuffer\n    }\n    if (quoteID === baseFeeID) {\n      if (canRebalance) transferableQuoteAlloc += bProj.bookingFees + bProj.swapFeeReserves\n      else dexMinQuoteAlloc += bProj.bookingFees + bProj.swapFeeReserves\n    }\n\n    const dexBaseFunded = dexBaseAvail >= dexMinBaseAlloc\n    const cexBaseFunded = cexBaseAvail >= cexMinBaseAlloc\n    const dexQuoteFunded = dexQuoteAvail >= dexMinQuoteAlloc\n    const cexQuoteFunded = cexQuoteAvail >= cexMinQuoteAlloc\n    const totalBaseReq = dexMinBaseAlloc + cexMinBaseAlloc + transferableBaseAlloc\n    const totalQuoteReq = dexMinQuoteAlloc + cexMinQuoteAlloc + transferableQuoteAlloc\n    const baseFundedAndBalanced = dexBaseFunded && cexBaseFunded && baseAvail >= totalBaseReq\n    const quoteFundedAndBalanced = dexQuoteFunded && cexQuoteFunded && quoteAvail >= totalQuoteReq\n    const baseFeesFunded = dexBaseFeeAvail >= dexBaseFeeReq\n    const quoteFeesFunded = dexQuoteFeeAvail >= dexQuoteFeeReq\n\n    const fundedAndBalanced = baseFundedAndBalanced && quoteFundedAndBalanced && baseFeesFunded && quoteFeesFunded\n\n    // Are we funded but not balanced, but able to rebalance with a cex?\n    let fundedAndNotBalanced = !fundedAndBalanced\n    if (!fundedAndBalanced) {\n      const ordersFunded = baseAvail >= totalBaseReq && quoteAvail >= totalQuoteReq\n      const feesFunded = baseFeesFunded && quoteFeesFunded\n      fundedAndNotBalanced = ordersFunded && feesFunded && canRebalance\n    }\n\n    return {\n      base: {\n        dex: {\n          avail: dexBaseAvail,\n          req: dexMinBaseAlloc,\n          funded: dexBaseFunded\n        },\n        cex: {\n          avail: cexBaseAvail,\n          req: cexMinBaseAlloc,\n          funded: cexBaseFunded\n        },\n        transferable: transferableBaseAlloc,\n        fees: {\n          avail: dexBaseFeeAvail,\n          req: dexBaseFeeReq,\n          funded: baseFeesFunded\n        },\n        fundedAndBalanced: baseFundedAndBalanced,\n        fundedAndNotBalanced: !baseFundedAndBalanced && baseAvail >= totalBaseReq && canRebalance\n      },\n      quote: {\n        dex: {\n          avail: dexQuoteAvail,\n          req: dexMinQuoteAlloc,\n          funded: dexQuoteFunded\n        },\n        cex: {\n          avail: cexQuoteAvail,\n          req: cexMinQuoteAlloc,\n          funded: cexQuoteFunded\n        },\n        transferable: transferableQuoteAlloc,\n        fees: {\n          avail: dexQuoteFeeAvail,\n          req: dexQuoteFeeReq,\n          funded: quoteFeesFunded\n        },\n        fundedAndBalanced: quoteFundedAndBalanced,\n        fundedAndNotBalanced: !quoteFundedAndBalanced && quoteAvail >= totalQuoteReq && canRebalance\n      },\n      fundedAndBalanced,\n      fundedAndNotBalanced,\n      starved: !fundedAndBalanced && !fundedAndNotBalanced\n    }\n  }\n}\n\nexport type RunningMMDisplayElements = {\n  orderReportForm: PageElement\n  dexBalancesRowTmpl: PageElement\n  placementRowTmpl: PageElement\n  placementAmtRowTmpl: PageElement\n}\n\nexport class RunningMarketMakerDisplay {\n  div: PageElement\n  page: Record<string, PageElement>\n  mkt: BotMarket\n  startTime: number\n  ticker: any\n  currentForm: PageElement\n  forms: Forms\n  latestEpoch?: EpochReport\n  cexProblems?: CEXProblems\n  orderReportFormEl: PageElement\n  orderReportForm: Record<string, PageElement>\n  displayedOrderReportFormSide: 'buys' | 'sells'\n  dexBalancesRowTmpl: PageElement\n  placementRowTmpl: PageElement\n  placementAmtRowTmpl: PageElement\n\n  constructor (div: PageElement, forms: Forms, elements: RunningMMDisplayElements, page: string) {\n    this.div = div\n    this.page = Doc.parseTemplate(div)\n    this.orderReportFormEl = elements.orderReportForm\n    this.orderReportForm = Doc.idDescendants(elements.orderReportForm)\n    this.dexBalancesRowTmpl = elements.dexBalancesRowTmpl\n    this.placementRowTmpl = elements.placementRowTmpl\n    this.placementAmtRowTmpl = elements.placementAmtRowTmpl\n    Doc.cleanTemplates(this.dexBalancesRowTmpl, this.placementRowTmpl, this.placementAmtRowTmpl)\n    this.forms = forms\n    Doc.bind(this.page.stopBttn, 'click', () => this.stop())\n    Doc.bind(this.page.runLogsBttn, 'click', () => {\n      const { mkt: { baseID, quoteID, host }, startTime } = this\n      app().loadPage('mmlogs', { baseID, quoteID, host, startTime, returnPage: page })\n    })\n    Doc.bind(this.page.buyOrdersBttn, 'click', () => this.showOrderReport('buys'))\n    Doc.bind(this.page.sellOrdersBttn, 'click', () => this.showOrderReport('sells'))\n  }\n\n  async stop () {\n    const { page, mkt: { host, baseID, quoteID } } = this\n    const loaded = app().loading(page.stopBttn)\n    await MM.stopBot({ host, baseID: baseID, quoteID: quoteID })\n    loaded()\n  }\n\n  async setMarket (host: string, baseID: number, quoteID: number) {\n    const botStatus = app().mmStatus.bots.find(({ config: c }: MMBotStatus) => c.baseID === baseID && c.quoteID === quoteID && c.host === host)\n    if (!botStatus) return\n    const mkt = new BotMarket(botStatus.config)\n    await mkt.initialize()\n    this.setBotMarket(mkt)\n  }\n\n  async setBotMarket (mkt: BotMarket) {\n    this.mkt = mkt\n    const {\n      page, div, mkt: {\n        host, baseID, quoteID, baseFeeID, quoteFeeID, cexName, baseFeeSymbol,\n        quoteFeeSymbol, baseFeeTicker, quoteFeeTicker, cfg, baseFactor, quoteFactor\n      }\n    } = this\n    setMarketElements(div, baseID, quoteID, host)\n    Doc.setVis(baseFeeID !== baseID, page.baseFeeReservesBox)\n    Doc.setVis(quoteFeeID !== quoteID, page.quoteFeeReservesBox)\n    Doc.setVis(Boolean(cexName), ...Doc.applySelector(div, '[data-cex-show]'))\n    page.baseFeeLogo.src = Doc.logoPath(baseFeeSymbol)\n    page.baseFeeTicker.textContent = baseFeeTicker\n    page.quoteFeeLogo.src = Doc.logoPath(quoteFeeSymbol)\n    page.quoteFeeTicker.textContent = quoteFeeTicker\n\n    const basicCfg = cfg.basicMarketMakingConfig\n    const gapStrategy = basicCfg?.gapStrategy ?? GapStrategyPercent\n    let gapFactor = cfg.arbMarketMakingConfig?.profit ?? cfg.simpleArbConfig?.profitTrigger ?? 0\n    if (basicCfg) {\n      const buys = [...basicCfg.buyPlacements].sort((a: OrderPlacement, b: OrderPlacement) => a.gapFactor - b.gapFactor)\n      const sells = [...basicCfg.sellPlacements].sort((a: OrderPlacement, b: OrderPlacement) => a.gapFactor - b.gapFactor)\n      if (buys.length > 0) {\n        if (sells.length > 0) {\n          gapFactor = (buys[0].gapFactor + sells[0].gapFactor) / 2\n        } else {\n          gapFactor = buys[0].gapFactor\n        }\n      } else gapFactor = sells[0].gapFactor\n    }\n    Doc.hide(page.profitLabel, page.gapLabel, page.multiplierLabel, page.profitUnit, page.gapUnit, page.multiplierUnit)\n    switch (gapStrategy) {\n      case GapStrategyPercent:\n      case GapStrategyPercentPlus:\n        Doc.show(page.profitLabel, page.profitUnit)\n        page.gapFactor.textContent = (gapFactor * 100).toFixed(2)\n        break\n      case GapStrategyMultiplier:\n        Doc.show(page.multiplierLabel, page.multiplierUnit)\n        page.gapFactor.textContent = (gapFactor * 100).toFixed(2)\n        break\n      default:\n        page.gapFactor.textContent = Doc.formatFourSigFigs(gapFactor / OrderUtil.RateEncodingFactor * baseFactor / quoteFactor)\n    }\n\n    this.update()\n    this.readBook()\n  }\n\n  handleBalanceNote (n: BalanceNote) {\n    if (!this.mkt) return\n    const { baseID, quoteID, baseFeeID, quoteFeeID } = this.mkt\n    if (n.assetID !== baseID && n.assetID !== baseFeeID && n.assetID !== quoteID && n.assetID !== quoteFeeID) return\n    this.update()\n  }\n\n  handleEpochReportNote (n: EpochReportNote) {\n    if (!this.mkt) return\n    const { baseID, quoteID, host } = this.mkt\n    if (n.baseID !== baseID || n.quoteID !== quoteID || n.host !== host) return\n    if (!n.report) return\n    this.latestEpoch = n.report\n    if (this.forms.currentForm === this.orderReportFormEl && this.forms.currentFormID === this.mkt.id) {\n      const orderReport = this.displayedOrderReportFormSide === 'buys' ? n.report.buysReport : n.report.sellsReport\n      if (orderReport) this.updateOrderReport(orderReport, this.displayedOrderReportFormSide, n.report.epochNum)\n      else this.forms.close()\n    }\n    this.update()\n  }\n\n  handleCexProblemsNote (n: CEXProblemsNote) {\n    if (!this.mkt) return\n    const { baseID, quoteID, host } = this.mkt\n    if (n.baseID !== baseID || n.quoteID !== quoteID || n.host !== host) return\n    this.cexProblems = n.problems\n    this.update()\n  }\n\n  setTicker () {\n    this.page.runTime.textContent = Doc.hmsSince(this.startTime)\n  }\n\n  update () {\n    const {\n      div, page, mkt: {\n        baseID, quoteID, baseFeeID, quoteFeeID, baseFactor, quoteFactor, baseFeeFactor,\n        quoteFeeFactor, marketReport: { baseFiatRate, quoteFiatRate }\n      }\n    } = this\n    // Get fresh stats\n    const { botCfg: { cexName, basicMarketMakingConfig: bmmCfg }, runStats, latestEpoch, cexProblems } = this.mkt.status()\n    this.latestEpoch = latestEpoch\n    this.cexProblems = cexProblems\n\n    Doc.hide(page.stats, page.cexRow, page.pendingDepositBox, page.pendingWithdrawalBox)\n\n    if (!runStats) {\n      if (this.ticker) {\n        clearInterval(this.ticker)\n        this.ticker = undefined\n      }\n      return\n    } else if (!this.ticker) {\n      this.startTime = runStats.startTime\n      this.setTicker()\n      this.ticker = setInterval(() => this.setTicker(), 1000)\n    }\n\n    Doc.show(page.stats)\n    setSignedValue(runStats.profitLoss.profitRatio * 100, page.profit, page.profitSign, 2)\n    setSignedValue(runStats.profitLoss.profit, page.profitLoss, page.plSign, 2)\n    this.startTime = runStats.startTime\n\n    const summedBalance = (b: BotBalance) => {\n      if (!b) return 0\n      return b.available + b.locked + b.pending + b.reserved\n    }\n\n    const dexBaseInv = summedBalance(runStats.dexBalances[baseID]) / baseFactor\n    page.walletBaseInventory.textContent = Doc.formatFourSigFigs(dexBaseInv)\n    page.walletBaseInvFiat.textContent = Doc.formatFourSigFigs(dexBaseInv * baseFiatRate, 2)\n    const dexQuoteInv = summedBalance(runStats.dexBalances[quoteID]) / quoteFactor\n    page.walletQuoteInventory.textContent = Doc.formatFourSigFigs(dexQuoteInv)\n    page.walletQuoteInvFiat.textContent = Doc.formatFourSigFigs(dexQuoteInv * quoteFiatRate, 2)\n\n    Doc.setVis(cexName, page.cexRow)\n    if (cexName) {\n      Doc.show(page.pendingDepositBox, page.pendingWithdrawalBox)\n      setCexElements(div, cexName)\n      const cexBaseInv = summedBalance(runStats.cexBalances[baseID]) / baseFactor\n      page.cexBaseInventory.textContent = Doc.formatFourSigFigs(cexBaseInv)\n      page.cexBaseInventoryFiat.textContent = Doc.formatFourSigFigs(cexBaseInv * baseFiatRate, 2)\n      const cexQuoteInv = summedBalance(runStats.cexBalances[quoteID]) / quoteFactor\n      page.cexQuoteInventory.textContent = Doc.formatFourSigFigs(cexQuoteInv)\n      page.cexQuoteInventoryFiat.textContent = Doc.formatFourSigFigs(cexQuoteInv * quoteFiatRate, 2)\n    }\n\n    if (baseFeeID !== baseID) {\n      const feeBalance = summedBalance(runStats.dexBalances[baseFeeID]) / baseFeeFactor\n      page.baseFeeReserves.textContent = Doc.formatFourSigFigs(feeBalance)\n    }\n    if (quoteFeeID !== quoteID) {\n      const feeBalance = summedBalance(runStats.dexBalances[quoteFeeID]) / quoteFeeFactor\n      page.quoteFeeReserves.textContent = Doc.formatFourSigFigs(feeBalance)\n    }\n\n    page.pendingDeposits.textContent = String(Math.round(runStats.pendingDeposits))\n    page.pendingWithdrawals.textContent = String(Math.round(runStats.pendingWithdrawals))\n    page.completedMatches.textContent = String(Math.round(runStats.completedMatches))\n    Doc.setVis(runStats.tradedUSD, page.tradedUSDBox)\n    if (runStats.tradedUSD > 0) page.tradedUSD.textContent = Doc.formatFourSigFigs(runStats.tradedUSD)\n    Doc.setVis(baseFiatRate, page.roundTripFeesBox)\n    if (baseFiatRate) page.roundTripFeesUSD.textContent = Doc.formatFourSigFigs((runStats.feeGap?.roundTripFees / baseFactor * baseFiatRate) || 0)\n    const basisPrice = app().conventionalRate(baseID, quoteID, runStats.feeGap?.basisPrice || 0)\n    page.basisPrice.textContent = Doc.formatFourSigFigs(basisPrice)\n\n    const displayFeeGap = !bmmCfg || bmmCfg.gapStrategy === GapStrategyAbsolutePlus || bmmCfg.gapStrategy === GapStrategyPercentPlus\n    Doc.setVis(displayFeeGap, page.feeGapBox)\n    if (displayFeeGap) {\n      const feeGap = app().conventionalRate(baseID, quoteID, runStats.feeGap?.feeGap || 0)\n      page.feeGap.textContent = Doc.formatFourSigFigs(feeGap)\n      page.feeGapPct.textContent = (feeGap / basisPrice * 100 || 0).toFixed(2)\n    }\n    Doc.setVis(bmmCfg, page.gapStrategyBox)\n    if (bmmCfg) page.gapStrategy.textContent = bmmCfg.gapStrategy\n\n    const remoteGap = app().conventionalRate(baseID, quoteID, runStats.feeGap?.remoteGap || 0)\n    Doc.setVis(remoteGap, page.remoteGapBox)\n    if (remoteGap) {\n      page.remoteGap.textContent = Doc.formatFourSigFigs(remoteGap)\n      page.remoteGapPct.textContent = (remoteGap / basisPrice * 100 || 0).toFixed(2)\n    }\n\n    Doc.setVis(latestEpoch?.buysReport, page.buyOrdersReportBox)\n    if (latestEpoch?.buysReport) {\n      const allPlaced = allOrdersPlaced(latestEpoch.buysReport)\n      Doc.setVis(allPlaced, page.buyOrdersSuccess)\n      Doc.setVis(!allPlaced, page.buyOrdersFailed)\n    }\n\n    Doc.setVis(latestEpoch?.sellsReport, page.sellOrdersReportBox)\n    if (latestEpoch?.sellsReport) {\n      const allPlaced = allOrdersPlaced(latestEpoch.sellsReport)\n      Doc.setVis(allPlaced, page.sellOrdersSuccess)\n      Doc.setVis(!allPlaced, page.sellOrdersFailed)\n    }\n\n    const preOrderProblemMessages = botProblemMessages(latestEpoch?.preOrderProblems, this.mkt.cexName, this.mkt.host)\n    const cexErrorMessages = cexProblemMessages(this.cexProblems)\n    const allMessages = [...preOrderProblemMessages, ...cexErrorMessages]\n    Doc.setVis(allMessages.length > 0, page.preOrderProblemsBox)\n    Doc.empty(page.preOrderProblemsBox)\n    for (const msg of allMessages) {\n      const spanEl = document.createElement('span') as PageElement\n      spanEl.textContent = `- ${msg}`\n      page.preOrderProblemsBox.appendChild(spanEl)\n    }\n  }\n\n  updateOrderReport (report: OrderReport, side: 'buys' | 'sells', epochNum: number) {\n    const form = this.orderReportForm\n    const sideTxt = side === 'buys' ? intl.prep(intl.ID_BUY) : intl.prep(intl.ID_SELL)\n    form.orderReportTitle.textContent = intl.prep(intl.ID_ORDER_REPORT_TITLE, { side: sideTxt, epochNum: `${epochNum}` })\n\n    Doc.setVis(report.error, form.orderReportError)\n    Doc.setVis(!report.error, form.orderReportDetails)\n    if (report.error) {\n      const problemMessages = botProblemMessages(report.error, this.mkt.cexName, this.mkt.host)\n      Doc.empty(form.orderReportError)\n      for (const msg of problemMessages) {\n        const spanEl = document.createElement('span') as PageElement\n        spanEl.textContent = `- ${msg}`\n        form.orderReportError.appendChild(spanEl)\n      }\n      return\n    }\n\n    Doc.empty(form.dexBalancesBody, form.placementsBody)\n    const createRow = (assetID: number): [PageElement, number] => {\n      const row = this.dexBalancesRowTmpl.cloneNode(true) as HTMLElement\n      const rowTmpl = Doc.parseTemplate(row)\n      const asset = app().assets[assetID]\n      rowTmpl.asset.textContent = asset.symbol.toUpperCase()\n      rowTmpl.assetLogo.src = Doc.logoPath(asset.symbol)\n      const unitInfo = asset.unitInfo\n      const available = report.availableDexBals[assetID] ? report.availableDexBals[assetID].available : 0\n      const required = report.requiredDexBals[assetID] ? report.requiredDexBals[assetID] : 0\n      const remaining = report.remainingDexBals[assetID] ? report.remainingDexBals[assetID] : 0\n      const pending = report.availableDexBals[assetID] ? report.availableDexBals[assetID].pending : 0\n      const locked = report.availableDexBals[assetID] ? report.availableDexBals[assetID].locked : 0\n      const used = report.usedDexBals[assetID] ? report.usedDexBals[assetID] : 0\n      rowTmpl.available.textContent = Doc.formatCoinValue(available, unitInfo)\n      rowTmpl.locked.textContent = Doc.formatCoinValue(locked, unitInfo)\n      rowTmpl.required.textContent = Doc.formatCoinValue(required, unitInfo)\n      rowTmpl.remaining.textContent = Doc.formatCoinValue(remaining, unitInfo)\n      rowTmpl.pending.textContent = Doc.formatCoinValue(pending, unitInfo)\n      rowTmpl.used.textContent = Doc.formatCoinValue(used, unitInfo)\n      const deficiency = safeSub(required, available)\n      rowTmpl.deficiency.textContent = Doc.formatCoinValue(deficiency, unitInfo)\n      if (deficiency > 0) rowTmpl.deficiency.classList.add('text-warning')\n      const deficiencyWithPending = safeSub(deficiency, pending)\n      rowTmpl.deficiencyWithPending.textContent = Doc.formatCoinValue(deficiencyWithPending, unitInfo)\n      if (deficiencyWithPending > 0) rowTmpl.deficiencyWithPending.classList.add('text-warning')\n      return [row, deficiency]\n    }\n    const setDeficiencyVisibility = (deficiency: boolean, rows: HTMLElement[]) => {\n      Doc.setVis(deficiency, form.dexDeficiencyHeader, form.dexDeficiencyWithPendingHeader)\n      for (const row of rows) {\n        const rowTmpl = Doc.parseTemplate(row)\n        Doc.setVis(deficiency, rowTmpl.deficiency, rowTmpl.deficiencyWithPending)\n      }\n    }\n    const assetIDs = [this.mkt.baseID, this.mkt.quoteID]\n    if (!assetIDs.includes(this.mkt.baseFeeID)) assetIDs.push(this.mkt.baseFeeID)\n    if (!assetIDs.includes(this.mkt.quoteFeeID)) assetIDs.push(this.mkt.quoteFeeID)\n    let totalDeficiency = 0\n    const rows : PageElement[] = []\n    for (const assetID of assetIDs) {\n      const [row, deficiency] = createRow(assetID)\n      totalDeficiency += deficiency\n      form.dexBalancesBody.appendChild(row)\n      rows.push(row)\n    }\n    setDeficiencyVisibility(totalDeficiency > 0, rows)\n\n    Doc.setVis(this.mkt.cexName, form.cexSection, form.counterTradeRateHeader, form.requiredCEXHeader, form.usedCEXHeader)\n    let cexAsset: SupportedAsset\n    if (this.mkt.cexName) {\n      const cexDisplayInfo = CEXDisplayInfos[this.mkt.cexName]\n      if (cexDisplayInfo) {\n        form.cexLogo.src = cexDisplayInfo.logo\n        form.cexBalancesTitle.textContent = intl.prep(intl.ID_CEX_BALANCES, { cexName: cexDisplayInfo.name })\n      } else {\n        console.error(`CEXDisplayInfo not found for ${this.mkt.cexName}`)\n      }\n      const cexAssetID = side === 'buys' ? this.mkt.baseID : this.mkt.quoteID\n      cexAsset = app().assets[cexAssetID]\n      form.cexAsset.textContent = cexAsset.symbol.toUpperCase()\n      form.cexAssetLogo.src = Doc.logoPath(cexAsset.symbol)\n      const availableCexBal = report.availableCexBal ? report.availableCexBal.available : 0\n      const requiredCexBal = report.requiredCexBal ? report.requiredCexBal : 0\n      const remainingCexBal = report.remainingCexBal ? report.remainingCexBal : 0\n      const pendingCexBal = report.availableCexBal ? report.availableCexBal.pending : 0\n      const reservedCexBal = report.availableCexBal ? report.availableCexBal.reserved : 0\n      const usedCexBal = report.usedCexBal ? report.usedCexBal : 0\n      const deficiencyCexBal = safeSub(requiredCexBal, availableCexBal)\n      const deficiencyWithPendingCexBal = safeSub(deficiencyCexBal, pendingCexBal)\n      form.cexAvailable.textContent = Doc.formatCoinValue(availableCexBal, cexAsset.unitInfo)\n      form.cexLocked.textContent = Doc.formatCoinValue(reservedCexBal, cexAsset.unitInfo)\n      form.cexRequired.textContent = Doc.formatCoinValue(requiredCexBal, cexAsset.unitInfo)\n      form.cexRemaining.textContent = Doc.formatCoinValue(remainingCexBal, cexAsset.unitInfo)\n      form.cexPending.textContent = Doc.formatCoinValue(pendingCexBal, cexAsset.unitInfo)\n      form.cexUsed.textContent = Doc.formatCoinValue(usedCexBal, cexAsset.unitInfo)\n      const deficient = deficiencyCexBal > 0\n      Doc.setVis(deficient, form.cexDeficiencyHeader, form.cexDeficiencyWithPendingHeader,\n        form.cexDeficiency, form.cexDeficiencyWithPending)\n      if (deficient) {\n        form.cexDeficiency.textContent = Doc.formatCoinValue(deficiencyCexBal, cexAsset.unitInfo)\n        form.cexDeficiencyWithPending.textContent = Doc.formatCoinValue(deficiencyWithPendingCexBal, cexAsset.unitInfo)\n        if (deficiencyWithPendingCexBal > 0) form.cexDeficiencyWithPending.classList.add('text-warning')\n        else form.cexDeficiencyWithPending.classList.remove('text-warning')\n      }\n    }\n\n    let anyErrors = false\n    for (const placement of report.placements) if (placement.error) { anyErrors = true; break }\n    Doc.setVis(anyErrors, form.errorHeader)\n    const createPlacementRow = (placement: TradePlacement, priority: number): PageElement => {\n      const row = this.placementRowTmpl.cloneNode(true) as HTMLElement\n      const rowTmpl = Doc.parseTemplate(row)\n      const baseUI = app().assets[this.mkt.baseID].unitInfo\n      const quoteUI = app().assets[this.mkt.quoteID].unitInfo\n      rowTmpl.priority.textContent = String(priority)\n      rowTmpl.rate.textContent = Doc.formatRateFullPrecision(placement.rate, baseUI, quoteUI, this.mkt.rateStep)\n      rowTmpl.lots.textContent = String(placement.lots)\n      rowTmpl.standingLots.textContent = String(placement.standingLots)\n      rowTmpl.orderedLots.textContent = String(placement.orderedLots)\n      if (placement.standingLots + placement.orderedLots < placement.lots) {\n        rowTmpl.lots.classList.add('text-warning')\n        rowTmpl.standingLots.classList.add('text-warning')\n        rowTmpl.orderedLots.classList.add('text-warning')\n      }\n      Doc.setVis(placement.counterTradeRate > 0, rowTmpl.counterTradeRate)\n      rowTmpl.counterTradeRate.textContent = Doc.formatRateFullPrecision(placement.counterTradeRate, baseUI, quoteUI, this.mkt.rateStep)\n      for (const assetID of assetIDs) {\n        const asset = app().assets[assetID]\n        const unitInfo = asset.unitInfo\n        const requiredAmt = placement.requiredDex[assetID] ? placement.requiredDex[assetID] : 0\n        const usedAmt = placement.usedDex[assetID] ? placement.usedDex[assetID] : 0\n        const requiredRow = this.placementAmtRowTmpl.cloneNode(true) as HTMLElement\n        const requiredRowTmpl = Doc.parseTemplate(requiredRow)\n        const usedRow = this.placementAmtRowTmpl.cloneNode(true) as HTMLElement\n        const usedRowTmpl = Doc.parseTemplate(usedRow)\n        requiredRowTmpl.amt.textContent = Doc.formatCoinValue(requiredAmt, unitInfo)\n        requiredRowTmpl.assetLogo.src = Doc.logoPath(asset.symbol)\n        requiredRowTmpl.assetSymbol.textContent = asset.symbol.toUpperCase()\n        usedRowTmpl.amt.textContent = Doc.formatCoinValue(usedAmt, unitInfo)\n        usedRowTmpl.assetLogo.src = Doc.logoPath(asset.symbol)\n        usedRowTmpl.assetSymbol.textContent = asset.symbol.toUpperCase()\n        rowTmpl.requiredDEX.appendChild(requiredRow)\n        rowTmpl.usedDEX.appendChild(usedRow)\n      }\n      Doc.setVis(this.mkt.cexName, rowTmpl.requiredCEX, rowTmpl.usedCEX)\n      if (this.mkt.cexName) {\n        const requiredAmt = Doc.formatCoinValue(placement.requiredCex, cexAsset.unitInfo)\n        rowTmpl.requiredCEX.textContent = `${requiredAmt} ${cexAsset.symbol.toUpperCase()}`\n        const usedAmt = Doc.formatCoinValue(placement.usedCex, cexAsset.unitInfo)\n        rowTmpl.usedCEX.textContent = `${usedAmt} ${cexAsset.symbol.toUpperCase()}`\n      }\n      Doc.setVis(anyErrors, rowTmpl.error)\n      if (placement.error) {\n        const errMessages = botProblemMessages(placement.error, this.mkt.cexName, this.mkt.host)\n        rowTmpl.error.textContent = errMessages.join('\\n')\n      }\n      return row\n    }\n    for (let i = 0; i < report.placements.length; i++) {\n      form.placementsBody.appendChild(createPlacementRow(report.placements[i], i + 1))\n    }\n  }\n\n  showOrderReport (side: 'buys' | 'sells') {\n    if (!this.latestEpoch) return\n    const report = side === 'buys' ? this.latestEpoch.buysReport : this.latestEpoch.sellsReport\n    if (!report) return\n    this.updateOrderReport(report, side, this.latestEpoch.epochNum)\n    this.displayedOrderReportFormSide = side\n    this.forms.show(this.orderReportFormEl, this.mkt.id)\n  }\n\n  readBook () {\n    if (!this.mkt) return\n    const { page, mkt: { host, mktID } } = this\n    const orders = app().exchanges[host].markets[mktID].orders || []\n    page.nBookedOrders.textContent = String(orders.filter((ord: Order) => ord.status === OrderUtil.StatusBooked).length)\n  }\n}\n\nfunction allOrdersPlaced (report: OrderReport) {\n  if (report.error) return false\n  for (let i = 0; i < report.placements.length; i++) {\n    const placement = report.placements[i]\n    if (placement.orderedLots + placement.standingLots < placement.lots) return false\n    if (placement.error) return false\n  }\n  return true\n}\n\nfunction setSignedValue (v: number, vEl: PageElement, signEl: PageElement, maxDecimals?: number) {\n  vEl.textContent = Doc.formatFourSigFigs(v, maxDecimals)\n  signEl.classList.toggle('ico-plus', v > 0)\n  signEl.classList.toggle('text-good', v > 0)\n  // signEl.classList.toggle('ico-minus', v < 0)\n}\n\nexport function feesAndCommit (\n  baseID: number, quoteID: number, baseFees: LotFeeRange, quoteFees: LotFeeRange,\n  lotSize: number, baseLots: number, quoteLots: number, baseFeeID: number, quoteFeeID: number,\n  baseIsAccountLocker: boolean, quoteIsAccountLocker: boolean, baseOrderReservesFactor: number,\n  quoteOrderReservesFactor: number\n) {\n  const quoteLot = calculateQuoteLot(lotSize, baseID, quoteID)\n  const [cexBaseLots, cexQuoteLots] = [quoteLots, baseLots]\n  const commit = {\n    dex: {\n      base: {\n        lots: baseLots,\n        val: baseLots * lotSize\n      },\n      quote: {\n        lots: quoteLots,\n        val: quoteLots * quoteLot\n      }\n    },\n    cex: {\n      base: {\n        lots: cexBaseLots,\n        val: cexBaseLots * lotSize\n      },\n      quote: {\n        lots: cexQuoteLots,\n        val: cexQuoteLots * quoteLot\n      }\n    }\n  }\n\n  let baseTokenFeesPerSwap = 0\n  let baseRedeemReservesPerLot = 0\n  if (baseID !== baseFeeID) { // token\n    baseTokenFeesPerSwap += baseFees.estimated.swap\n    if (baseFeeID === quoteFeeID) baseTokenFeesPerSwap += quoteFees.estimated.redeem\n  }\n  let baseBookingFeesPerLot = baseFees.max.swap\n  if (baseID === quoteFeeID) baseBookingFeesPerLot += quoteFees.max.redeem\n  if (baseIsAccountLocker) {\n    baseBookingFeesPerLot += baseFees.max.refund\n    if (!quoteIsAccountLocker && baseFeeID !== quoteFeeID) baseRedeemReservesPerLot = baseFees.max.redeem\n  }\n\n  let quoteTokenFeesPerSwap = 0\n  let quoteRedeemReservesPerLot = 0\n  if (quoteID !== quoteFeeID) {\n    quoteTokenFeesPerSwap += quoteFees.estimated.swap\n    if (quoteFeeID === baseFeeID) quoteTokenFeesPerSwap += baseFees.estimated.redeem\n  }\n  let quoteBookingFeesPerLot = quoteFees.max.swap\n  if (quoteID === baseFeeID) quoteBookingFeesPerLot += baseFees.max.redeem\n  if (quoteIsAccountLocker) {\n    quoteBookingFeesPerLot += quoteFees.max.refund\n    if (!baseIsAccountLocker && quoteFeeID !== baseFeeID) quoteRedeemReservesPerLot = quoteFees.max.redeem\n  }\n\n  const baseReservesFactor = 1 + baseOrderReservesFactor\n  const quoteReservesFactor = 1 + quoteOrderReservesFactor\n\n  const baseBookingFees = (baseBookingFeesPerLot * baseLots) * baseReservesFactor\n  const baseRedeemFees = (baseRedeemReservesPerLot * quoteLots) * quoteReservesFactor\n  const quoteBookingFees = (quoteBookingFeesPerLot * quoteLots) * quoteReservesFactor\n  const quoteRedeemFees = (quoteRedeemReservesPerLot * baseLots) * baseReservesFactor\n\n  const fees: BookingFees = {\n    base: {\n      ...baseFees,\n      bookingFeesPerLot: baseBookingFeesPerLot,\n      bookingFeesPerCounterLot: baseRedeemReservesPerLot,\n      bookingFees: baseBookingFees + baseRedeemFees,\n      swapReservesFactor: baseReservesFactor,\n      redeemReservesFactor: quoteReservesFactor,\n      tokenFeesPerSwap: baseTokenFeesPerSwap\n    },\n    quote: {\n      ...quoteFees,\n      bookingFeesPerLot: quoteBookingFeesPerLot,\n      bookingFeesPerCounterLot: quoteRedeemReservesPerLot,\n      bookingFees: quoteBookingFees + quoteRedeemFees,\n      swapReservesFactor: quoteReservesFactor,\n      redeemReservesFactor: baseReservesFactor,\n      tokenFeesPerSwap: quoteTokenFeesPerSwap\n    }\n  }\n\n  return { commit, fees }\n}\n\nfunction botProblemMessages (problems: BotProblems | undefined, cexName: string, dexHost: string): string[] {\n  if (!problems) return []\n  const msgs: string[] = []\n\n  if (problems.walletNotSynced) {\n    for (const [assetID, notSynced] of Object.entries(problems.walletNotSynced)) {\n      if (notSynced) {\n        msgs.push(intl.prep(intl.ID_WALLET_NOT_SYNCED, { assetSymbol: app().assets[Number(assetID)].symbol.toUpperCase() }))\n      }\n    }\n  }\n\n  if (problems.noWalletPeers) {\n    for (const [assetID, noPeers] of Object.entries(problems.noWalletPeers)) {\n      if (noPeers) {\n        msgs.push(intl.prep(intl.ID_WALLET_NO_PEERS, { assetSymbol: app().assets[Number(assetID)].symbol.toUpperCase() }))\n      }\n    }\n  }\n\n  if (problems.accountSuspended) {\n    msgs.push(intl.prep(intl.ID_ACCOUNT_SUSPENDED, { dexHost: dexHost }))\n  }\n\n  if (problems.userLimitTooLow) {\n    msgs.push(intl.prep(intl.ID_USER_LIMIT_TOO_LOW, { dexHost: dexHost }))\n  }\n\n  if (problems.noPriceSource) {\n    msgs.push(intl.prep(intl.ID_NO_PRICE_SOURCE))\n  }\n\n  if (problems.cexOrderbookUnsynced) {\n    msgs.push(intl.prep(intl.ID_CEX_ORDERBOOK_UNSYNCED, { cexName: cexName }))\n  }\n\n  if (problems.causesSelfMatch) {\n    msgs.push(intl.prep(intl.ID_CAUSES_SELF_MATCH))\n  }\n\n  return msgs\n}\n\nfunction cexProblemMessages (problems: CEXProblems | undefined): string[] {\n  if (!problems) return []\n  const msgs: string[] = []\n  if (problems.depositErr) {\n    for (const [assetID, depositErr] of Object.entries(problems.depositErr)) {\n      msgs.push(intl.prep(intl.ID_DEPOSIT_ERROR,\n        {\n          assetSymbol: app().assets[Number(assetID)].symbol.toUpperCase(),\n          time: new Date(depositErr.stamp * 1000).toLocaleString(),\n          error: depositErr.error\n        }))\n    }\n  }\n  if (problems.withdrawErr) {\n    for (const [assetID, withdrawErr] of Object.entries(problems.withdrawErr)) {\n      msgs.push(intl.prep(intl.ID_WITHDRAW_ERROR,\n        {\n          assetSymbol: app().assets[Number(assetID)].symbol.toUpperCase(),\n          time: new Date(withdrawErr.stamp * 1000).toLocaleString(),\n          error: withdrawErr.error\n        }))\n    }\n  }\n  if (problems.tradeErr) {\n    msgs.push(intl.prep(intl.ID_CEX_TRADE_ERROR,\n      {\n        time: new Date(problems.tradeErr.stamp * 1000).toLocaleString(),\n        error: problems.tradeErr.error\n      }))\n  }\n  return msgs\n}\n\nfunction safeSub (a: number, b: number) {\n  return a - b > 0 ? a - b : 0\n}\n\nwindow.mmstatus = function () : Promise<MarketMakingStatus> {\n  return MM.status()\n}\n","import Doc, { Animation } from './doc'\nimport { postJSON } from './http'\nimport State from './state'\nimport * as intl from './locales'\nimport { Wave } from './charts'\nimport {\n  bondReserveMultiplier,\n  perTierBaseParcelLimit,\n  parcelLimitScoreMultiplier,\n  strongTier\n} from './account'\nimport {\n  app,\n  SupportedAsset,\n  PageElement,\n  WalletDefinition,\n  ConfigOption,\n  Exchange,\n  Market,\n  BondAsset,\n  WalletState,\n  BalanceNote,\n  Order,\n  XYRange,\n  WalletStateNote,\n  WalletSyncNote,\n  WalletInfo,\n  Token,\n  WalletCreationNote,\n  CoreNote,\n  PrepaidBondID\n} from './registry'\nimport { XYRangeHandler } from './opts'\nimport { CoinExplorers } from './coinexplorers'\nimport { MM, setCexElements } from './mmutil'\n\ninterface ConfigOptionInput extends HTMLInputElement {\n  configOpt: ConfigOption\n}\n\ninterface ProgressPoint {\n  stamp: number\n  progress: number\n}\n\ninterface CurrentAsset {\n  asset: SupportedAsset\n  parentAsset?: SupportedAsset\n  winfo: WalletInfo | Token\n  // selectedDef is used in a strange way for tokens. If a token's parent wallet\n  // already exists, then selectedDef is going to be the Token.definition.\n  // BUT, if the token's parent wallet doesn't exist yet, the NewWalletForm\n  // operates in a combined configuration mode, and the selectedDef will be the\n  // currently selected parent asset definition. There is no loss of info\n  // in such a case, because the token wallet only has one definition.\n  selectedDef: WalletDefinition\n}\n\ninterface WalletConfig {\n  assetID: number\n  config: Record<string, string>\n  walletType: string\n}\n\ninterface FormsConfig {\n  closed?: (closedForm: PageElement | undefined) => void\n}\n\nexport class Forms {\n  formsDiv: PageElement\n  currentForm: PageElement | undefined\n  currentFormID: string | undefined\n  keyup: (e: KeyboardEvent) => void\n  closed?: (closedForm: PageElement | undefined) => void\n\n  constructor (formsDiv: PageElement, cfg?: FormsConfig) {\n    this.formsDiv = formsDiv\n    this.closed = cfg?.closed\n\n    formsDiv.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { this.close() })\n    })\n\n    Doc.bind(formsDiv, 'mousedown', (e: MouseEvent) => {\n      if (!this.currentForm) return\n      if (!Doc.mouseInElement(e, this.currentForm)) { this.close() }\n    })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        this.close()\n      }\n    }\n    Doc.bind(document, 'keyup', this.keyup)\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async show (form: HTMLElement, id?: string): Promise<void> {\n    this.currentForm = form\n    this.currentFormID = id\n    Doc.hide(...Array.from(this.formsDiv.children))\n    form.style.right = '10000px'\n    Doc.show(this.formsDiv, form)\n    const shift = (this.formsDiv.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  close (): void {\n    Doc.hide(this.formsDiv)\n    const closedForm = this.currentForm\n    this.currentForm = undefined\n    this.currentFormID = undefined\n    if (this.closed) this.closed(closedForm)\n  }\n\n  exit () {\n    Doc.unbind(document, 'keyup', this.keyup)\n  }\n}\n\n/*\n * NewWalletForm should be used with the \"newWalletForm\" template. The enclosing\n * <form> element should be the first argument of the constructor.\n */\nexport class NewWalletForm {\n  page: Record<string, PageElement>\n  form: HTMLElement\n  success: (assetID: number) => void\n  current: CurrentAsset\n  subform: WalletConfigForm\n  walletCfgGuide: PageElement\n  parentSyncer: null | ((w: WalletState) => void)\n  createUpdater: null | ((note: WalletCreationNote) => void)\n\n  constructor (form: HTMLElement, success: (assetID: number) => void, backFunc?: () => void) {\n    this.form = form\n    this.success = success\n    const page = this.page = Doc.parseTemplate(form)\n\n    if (backFunc) {\n      Doc.show(page.goBack)\n      Doc.bind(page.goBack, 'click', () => { backFunc() })\n    }\n\n    Doc.empty(page.walletTabTmpl)\n    page.walletTabTmpl.removeAttribute('id')\n\n    // WalletConfigForm will set the global app variable.\n    this.subform = new WalletConfigForm(page.walletSettings, true)\n\n    this.walletCfgGuide = Doc.tmplElement(form, 'walletCfgGuide')\n\n    bind(form, page.submitAdd, () => this.submit())\n    bind(form, page.oneBttn, () => this.submit())\n\n    app().registerNoteFeeder({\n      walletstate: (note: WalletStateNote) => { this.reportWalletState(note.wallet) },\n      walletsync: (note: WalletSyncNote) => { if (this.parentSyncer) this.parentSyncer(app().walletMap[note.assetID]) },\n      createwallet: (note: WalletCreationNote) => { this.reportCreationUpdate(note) }\n    })\n  }\n\n  /*\n   * reportWalletState should be called when a 'walletstate' notification is\n   * received.\n   * TODO: Let form classes register for notifications.\n   */\n  reportWalletState (w: WalletState): void {\n    if (this.parentSyncer) this.parentSyncer(w)\n  }\n\n  /*\n   * reportWalletState should be called when a 'createwallet' notification is\n   * received.\n   */\n  reportCreationUpdate (note: WalletCreationNote) {\n    if (this.createUpdater) this.createUpdater(note)\n  }\n\n  async createWallet (assetID: number, walletType: string, parentForm?: WalletConfig) {\n    const createForm = {\n      assetID: assetID,\n      pass: this.page.newWalletPass.value || '',\n      config: this.subform.map(assetID),\n      walletType: walletType,\n      parentForm: parentForm\n    }\n\n    const ani = new Wave(this.form, { backgroundColor: true })\n    const res = await postJSON('/api/newwallet', createForm)\n    ani.stop()\n    return res\n  }\n\n  async submit () {\n    const page = this.page\n    const newWalletPass = page.newWalletPass as HTMLInputElement\n    Doc.hide(page.newWalletErr)\n\n    const { asset, parentAsset } = this.current\n    const selectedDef = this.current.selectedDef\n    let parentForm\n    let walletType = selectedDef.type\n    if (parentAsset) {\n      walletType = (asset.token as Token).definition.type\n      parentForm = {\n        assetID: parentAsset.id,\n        config: this.subform.map(parentAsset.id),\n        walletType: selectedDef.type\n      }\n    }\n    // Register the selected asset.\n    const res = await this.createWallet(asset.id, walletType, parentForm)\n    if (!app().checkResponse(res)) {\n      this.setError(res.msg)\n      return\n    }\n    newWalletPass.value = ''\n    if (parentAsset) await this.runParentSync()\n    else this.success(this.current.asset.id)\n  }\n\n  /*\n   * runParentSync shows a syncing sub-dialog that tracks the parent asset's\n   * syncProgress and informs the user that the token wallet will be created\n   * after sync is complete.\n   */\n  async runParentSync () {\n    const { page, current: { parentAsset, asset } } = this\n    if (!parentAsset) return\n\n    page.parentSyncPct.textContent = '0'\n    page.parentName.textContent = parentAsset.name\n    page.parentLogo.src = Doc.logoPath(parentAsset.symbol)\n    page.childName.textContent = asset.name\n    page.childLogo.src = Doc.logoPath(asset.symbol)\n    Doc.hide(page.mainForm)\n    Doc.show(page.parentSyncing)\n\n    try {\n      await this.syncParent(parentAsset)\n      this.success(this.current.asset.id)\n    } catch (error) {\n      this.setError(error.message || error)\n    }\n    Doc.show(page.mainForm)\n    Doc.hide(page.parentSyncing)\n  }\n\n  /*\n   * syncParent monitors the sync progress of a token's parent asset, generating\n   * an Error if the token wallet creation does not complete successfully.\n   */\n  syncParent (parentAsset: SupportedAsset): Promise<void> {\n    const { page, current: { asset } } = this\n    return new Promise((resolve, reject) => {\n      // First, check if it's already synced.\n      const w = app().assets[parentAsset.id].wallet\n      if (w && w.synced) return resolve()\n      // Not synced, so create a syncer to update the parent sync pane.\n      this.parentSyncer = (w: WalletState) => {\n        if (w.assetID !== parentAsset.id) return\n        page.parentSyncPct.textContent = (w.syncProgress * 100).toFixed(1)\n      }\n      // Handle the async result.\n      this.createUpdater = (note: WalletCreationNote) => {\n        if (note.assetID !== asset.id) return\n        switch (note.topic) {\n          case 'QueuedCreationFailed':\n            reject(new Error(`${note.subject}: ${note.details}`))\n            break\n          case 'QueuedCreationSuccess':\n            resolve()\n            break\n          default:\n            return\n        }\n        this.parentSyncer = null\n        this.createUpdater = null\n      }\n    })\n  }\n\n  /* setAsset sets the current asset of the NewWalletForm */\n  async setAsset (assetID: number) {\n    if (!this.parseAsset(assetID)) return // nothing to change\n    const page = this.page\n    const tabs = page.walletTypeTabs\n    const { winfo, asset, parentAsset } = this.current\n    page.assetName.textContent = winfo.name\n    page.newWalletPass.value = ''\n\n    Doc.empty(tabs)\n    Doc.hide(tabs, page.newWalletErr, page.tokenMsgBox)\n    this.page.assetLogo.src = Doc.logoPath(asset.symbol)\n    if (parentAsset) {\n      page.tokenParentLogo.src = Doc.logoPath(parentAsset.symbol)\n      page.tokenParentName.textContent = parentAsset.name\n      Doc.show(page.tokenMsgBox)\n    }\n\n    const pinfo = parentAsset ? parentAsset.info : null\n    const walletDefs = pinfo ? pinfo.availablewallets : (winfo as WalletInfo).availablewallets ? (winfo as WalletInfo).availablewallets : [(winfo as Token).definition]\n\n    if (walletDefs.length > 1) {\n      Doc.show(tabs)\n      for (const wDef of walletDefs) {\n        const tab = page.walletTabTmpl.cloneNode(true) as HTMLElement\n        tab.dataset.tooltip = wDef.description\n        tab.textContent = wDef.tab\n        tabs.appendChild(tab)\n        Doc.bind(tab, 'click', () => {\n          for (const t of Doc.kids(tabs)) t.classList.remove('selected')\n          tab.classList.add('selected')\n          this.update(wDef)\n        })\n      }\n      app().bindTooltips(tabs)\n      const first = tabs.firstChild as HTMLElement\n      first.classList.add('selected')\n    }\n\n    await this.update(this.current.selectedDef)\n    if (asset.walletCreationPending) await this.runParentSync()\n  }\n\n  /*\n  * parseAsset parses the current data for the asset ID.\n  */\n  parseAsset (assetID: number) {\n    if (this.current && this.current.asset.id === assetID) return false\n    const asset = app().assets[assetID]\n    const token = asset.token\n    if (!token) {\n      if (!asset.info) throw Error('this non-token asset has no wallet info!')\n      this.current = { asset, winfo: asset.info, selectedDef: asset.info.availablewallets[0] }\n      return true\n    }\n    const parentAsset = app().user.assets[token.parentID]\n    if (parentAsset.wallet) {\n      // If the parent asset already has a wallet, there's no need to configure\n      // the parent too. Just configure the token.\n      this.current = { asset, winfo: token, selectedDef: token.definition }\n      return true\n    }\n    if (!parentAsset.info) throw Error('this parent has no wallet info!')\n    this.current = { asset, parentAsset, winfo: token, selectedDef: parentAsset.info.availablewallets[0] }\n    return true\n  }\n\n  async update (walletDef: WalletDefinition) {\n    const page = this.page\n    this.current.selectedDef = walletDef\n    Doc.hide(page.walletPassAndSubmitBttn, page.oneBttnBox, page.newWalletPassBox)\n    const guideLink = walletDef.guidelink\n    const configOpts = walletDef.configopts || []\n    // If a config represents a wallet's birthday, we update the default\n    // selection to the current date if this installation of the client\n    // generated a seed.\n    configOpts.map((opt) => {\n      if (opt.isBirthdayConfig && app().seedGenTime > 0) {\n        opt.default = toUnixDate(new Date())\n      }\n      return opt\n    })\n    // Either this is a walletDef for a token's uncreated parent asset, or this\n    // is the definition for the token.\n    let containsRequired = false\n    for (const opt of configOpts) {\n      if (opt.required) {\n        containsRequired = true\n        break\n      }\n    }\n    const { asset, parentAsset, winfo } = this.current\n    const displayCreateBtn = walletDef.seeded || Boolean(asset.token)\n    if (displayCreateBtn && !containsRequired) {\n      Doc.hide(page.walletSettingsHeader)\n      Doc.show(page.oneBttnBox)\n    } else if (displayCreateBtn) {\n      Doc.show(page.walletPassAndSubmitBttn, page.walletSettingsHeader)\n      page.newWalletPass.value = ''\n      page.submitAdd.textContent = intl.prep(intl.ID_CREATE)\n    } else {\n      Doc.show(page.walletPassAndSubmitBttn, page.walletSettingsHeader)\n      if (!walletDef.noauth) Doc.show(page.newWalletPassBox)\n      page.submitAdd.textContent = intl.prep(intl.ID_ADD)\n    }\n\n    if (parentAsset) {\n      const parentAndTokenOpts = JSON.parse(JSON.stringify(configOpts))\n      // Add the regAsset field to the configurations so proper logos will be displayed\n      // next to them, and map can filter them out. The opts are copied here so the originals\n      // do not have the regAsset field added to them.\n      for (const opt of parentAndTokenOpts) opt.regAsset = parentAsset.id\n      const tokenOpts = (winfo as Token).definition.configopts || []\n      if (tokenOpts.length > 0) {\n        const tokenOptsCopy = JSON.parse(JSON.stringify(tokenOpts))\n        for (const opt of tokenOptsCopy) opt.regAsset = asset.id\n        parentAndTokenOpts.push(...tokenOptsCopy)\n      }\n      this.subform.update(asset.id, parentAndTokenOpts, false)\n    } else this.subform.update(asset.id, configOpts, false)\n    this.setGuideLink(guideLink)\n\n    // A seeded or token wallet is internal to Bison Wallet and as such does\n    // not have an external config file to select.\n    if (walletDef.seeded || Boolean(this.current.asset.token)) Doc.hide(this.subform.fileSelector)\n    else Doc.show(this.subform.fileSelector)\n\n    await this.loadDefaults()\n  }\n\n  setGuideLink (guideLink: string) {\n    Doc.hide(this.walletCfgGuide)\n    if (guideLink !== '') {\n      this.walletCfgGuide.href = guideLink\n      Doc.show(this.walletCfgGuide)\n    }\n  }\n\n  /* setError sets and shows the in-form error message. */\n  async setError (errMsg: string) {\n    this.page.newWalletErr.textContent = errMsg\n    Doc.show(this.page.newWalletErr)\n  }\n\n  /*\n   * loadDefaults attempts to load the ExchangeWallet configuration from the\n   * default wallet config path on the server and will auto-fill the page on\n   * the subform if settings are found.\n   */\n  async loadDefaults () {\n    // No default config files for seeded assets right now.\n    const { asset, parentAsset, selectedDef } = this.current\n    if (!selectedDef.configpath) return\n    let configID = asset.id\n    if (parentAsset) {\n      if (selectedDef.seeded) return\n      configID = parentAsset.id\n    }\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/defaultwalletcfg', {\n      assetID: configID,\n      type: selectedDef.type\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      this.setError(res.msg)\n      return\n    }\n    this.subform.setLoadedConfig(res.config)\n  }\n}\n\nlet dynamicInputCounter = 0\n\n/*\n * WalletConfigForm is a dynamically generated sub-form for setting\n * asset-specific wallet configuration options.\n*/\nexport class WalletConfigForm {\n  page: Record<string, PageElement>\n  form: HTMLElement\n  configElements: [ConfigOption, HTMLElement][]\n  configOpts: ConfigOption[]\n  sectionize: boolean\n  allSettings: PageElement\n  dynamicOpts: PageElement\n  textInputTmpl: PageElement\n  dateInputTmpl: PageElement\n  checkboxTmpl: PageElement\n  repeatableTmpl: PageElement\n  fileSelector: PageElement\n  fileInput: PageElement\n  errMsg: PageElement\n  showOther: PageElement\n  showIcon: PageElement\n  hideIcon: PageElement\n  showHideMsg: PageElement\n  otherSettings: PageElement\n  loadedSettingsMsg: PageElement\n  loadedSettings: PageElement\n  defaultSettingsMsg: PageElement\n  defaultSettings: PageElement\n  assetHasActiveOrders: boolean\n  assetID: number\n\n  constructor (form: HTMLElement, sectionize: boolean) {\n    this.page = Doc.idDescendants(form)\n    this.form = form\n    // A configElement is a div containing an input and its label.\n    this.configElements = []\n    // configOpts is the wallet options provided by core.\n    this.configOpts = []\n    this.sectionize = sectionize\n\n    // Get template elements\n    this.allSettings = Doc.tmplElement(form, 'allSettings')\n    this.dynamicOpts = Doc.tmplElement(form, 'dynamicOpts')\n    this.textInputTmpl = Doc.tmplElement(form, 'textInput')\n    this.textInputTmpl.remove()\n    this.dateInputTmpl = Doc.tmplElement(form, 'dateInput')\n    this.dateInputTmpl.remove()\n    this.checkboxTmpl = Doc.tmplElement(form, 'checkbox')\n    this.checkboxTmpl.remove()\n    this.repeatableTmpl = Doc.tmplElement(form, 'repeatableInput')\n    this.repeatableTmpl.remove()\n    this.fileSelector = Doc.tmplElement(form, 'fileSelector')\n    this.fileInput = Doc.tmplElement(form, 'fileInput')\n    this.errMsg = Doc.tmplElement(form, 'errMsg')\n    this.showOther = Doc.tmplElement(form, 'showOther')\n    this.showIcon = Doc.tmplElement(form, 'showIcon')\n    this.hideIcon = Doc.tmplElement(form, 'hideIcon')\n    this.showHideMsg = Doc.tmplElement(form, 'showHideMsg')\n    this.otherSettings = Doc.tmplElement(form, 'otherSettings')\n    this.loadedSettingsMsg = Doc.tmplElement(form, 'loadedSettingsMsg')\n    this.loadedSettings = Doc.tmplElement(form, 'loadedSettings')\n    this.defaultSettingsMsg = Doc.tmplElement(form, 'defaultSettingsMsg')\n    this.defaultSettings = Doc.tmplElement(form, 'defaultSettings')\n\n    if (!sectionize) Doc.hide(this.showOther)\n\n    Doc.bind(this.fileSelector, 'click', () => this.fileInput.click())\n\n    // config file upload\n    Doc.bind(this.fileInput, 'change', async () => this.fileInputChanged())\n\n    Doc.bind(this.showOther, 'click', () => {\n      this.setOtherSettingsViz(this.hideIcon.classList.contains('d-hide'))\n    })\n  }\n\n  /*\n   * fileInputChanged will read the selected file and attempt to load the\n   * configuration settings. All loaded settings will be made visible for\n   * inspection by the user.\n   */\n  async fileInputChanged () {\n    Doc.hide(this.errMsg)\n    if (!this.fileInput.value) return\n    const files = this.fileInput.files\n    if (!files || files.length === 0) return\n    const loaded = app().loading(this.form)\n    const config = await files[0].text()\n    if (!config) return\n    const res = await postJSON('/api/parseconfig', {\n      configtext: config\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      this.errMsg.textContent = res.msg\n      Doc.show(this.errMsg)\n      return\n    }\n    if (Object.keys(res.map).length === 0) return\n    this.dynamicOpts.append(...this.setConfig(res.map))\n    this.reorder(this.dynamicOpts)\n    const [loadedOpts, defaultOpts] = [this.loadedSettings.children.length, this.defaultSettings.children.length]\n    if (loadedOpts === 0) Doc.hide(this.loadedSettings, this.loadedSettingsMsg)\n    if (defaultOpts === 0) Doc.hide(this.defaultSettings, this.defaultSettingsMsg)\n    if (loadedOpts + defaultOpts === 0) Doc.hide(this.showOther, this.otherSettings)\n  }\n\n  addOpt (box: HTMLElement, opt: ConfigOption, insertAfter?: PageElement, skipRepeatN?: boolean): PageElement {\n    let el: HTMLElement\n    if (opt.isboolean) el = this.checkboxTmpl.cloneNode(true) as HTMLElement\n    else if (opt.isdate) el = this.dateInputTmpl.cloneNode(true) as HTMLElement\n    else if (opt.repeatable) {\n      el = this.repeatableTmpl.cloneNode(true) as HTMLElement\n      el.classList.add('repeatable')\n      Doc.bind(Doc.tmplElement(el, 'add'), 'click', () => {\n        this.addOpt(box, opt, el, true)\n      })\n      if (!skipRepeatN) for (let i = 0; i < (opt.repeatN ? opt.repeatN - 1 : 0); i++) this.addOpt(box, opt, insertAfter, true)\n    } else el = this.textInputTmpl.cloneNode(true) as HTMLElement\n    const hiddenFields = app().extensionWallet(this.assetID)?.hiddenFields || []\n    if (hiddenFields.indexOf(opt.key) !== -1) Doc.hide(el)\n    this.configElements.push([opt, el])\n    const input = el.querySelector('input') as ConfigOptionInput\n    input.dataset.configKey = opt.key\n    // We need to generate a unique ID only for the <input id> => <label for>\n    // matching.\n    dynamicInputCounter++\n    const elID = 'wcfg-' + String(dynamicInputCounter)\n    input.id = elID\n    const label = Doc.safeSelector(el, 'label')\n    label.htmlFor = elID // 'for' attribute, but 'for' is a keyword\n    label.prepend(opt.displayname)\n    if (opt.regAsset !== undefined) {\n      const logo = new window.Image(15, 15)\n      logo.src = Doc.logoPathFromID(opt.regAsset || -1)\n      label.prepend(logo)\n    }\n    if (insertAfter) insertAfter.after(el)\n    else box.appendChild(el)\n    if (opt.noecho) {\n      input.type = 'password'\n      input.autocomplete = 'off'\n    }\n    if (opt.description) label.dataset.tooltip = opt.description\n    if (opt.isboolean) input.checked = opt.default\n    else if (opt.isdate) {\n      const getMinMaxVal = (minMax: string | number) => {\n        if (!minMax) return ''\n        if (minMax === 'now') return dateToString(new Date())\n        return dateToString(new Date((minMax as number) * 1000))\n      }\n      input.max = getMinMaxVal(opt.max)\n      input.min = getMinMaxVal(opt.min)\n      const date = opt.default ? new Date(opt.default * 1000) : new Date()\n      // UI shows Dates in valueAsDate as UTC, but user interprets local. Set a\n      // local date string so the UI displays what the user expects. alt:\n      // input.valueAsDate = dateApplyOffset(date)\n      input.value = dateToString(date)\n    } else input.value = opt.default !== null ? opt.default : ''\n    input.disabled = Boolean(opt.disablewhenactive && this.assetHasActiveOrders)\n    return el\n  }\n\n  /*\n   * update creates the dynamic form.\n   */\n  update (assetID: number, configOpts: ConfigOption[] | null, activeOrders: boolean) {\n    this.assetHasActiveOrders = activeOrders\n    this.configElements = []\n    this.configOpts = configOpts || []\n    this.assetID = assetID\n    Doc.empty(this.dynamicOpts, this.defaultSettings, this.loadedSettings)\n\n    // If there are no options, just hide the entire form.\n    if (this.configOpts.length === 0) return Doc.hide(this.form)\n    Doc.show(this.form)\n\n    this.setOtherSettingsViz(false)\n    Doc.hide(\n      this.loadedSettingsMsg, this.loadedSettings, this.defaultSettingsMsg,\n      this.defaultSettings, this.errMsg\n    )\n    const defaultedOpts = []\n    for (const opt of this.configOpts) {\n      if (this.sectionize && opt.default !== null) defaultedOpts.push(opt)\n      else this.addOpt(this.dynamicOpts, opt)\n    }\n    if (defaultedOpts.length) {\n      for (const opt of defaultedOpts) this.addOpt(this.defaultSettings, opt)\n      Doc.show(this.showOther, this.defaultSettingsMsg, this.defaultSettings)\n    } else {\n      Doc.hide(this.showOther)\n    }\n    app().bindTooltips(this.allSettings)\n    if (this.dynamicOpts.children.length) Doc.show(this.dynamicOpts)\n    else Doc.hide(this.dynamicOpts)\n  }\n\n  /*\n   * setOtherSettingsViz sets the visibility of the additional settings section.\n   */\n  setOtherSettingsViz (visible: boolean) {\n    if (visible) {\n      Doc.hide(this.showIcon)\n      Doc.show(this.hideIcon, this.otherSettings)\n      this.showHideMsg.textContent = intl.prep(intl.ID_HIDE_ADDITIONAL_SETTINGS)\n      return\n    }\n    Doc.hide(this.hideIcon, this.otherSettings)\n    Doc.show(this.showIcon)\n    this.showHideMsg.textContent = intl.prep(intl.ID_SHOW_ADDITIONAL_SETTINGS)\n  }\n\n  /*\n   * setConfig looks for inputs with configOpt keys matching the cfg object, and\n   * sets the inputs value to the corresponding cfg value. A list of matching\n   * configElements is returned.\n   */\n  setConfig (cfg: Record<string, string>): HTMLElement[] {\n    const finds: HTMLElement[] = []\n    const handledRepeatables: Record<string, boolean> = {}\n    const removes: [ConfigOption, PageElement][] = []\n    for (const r of [...this.configElements]) {\n      const [opt, el] = r\n      const v = cfg[opt.key]\n      if (v === undefined) continue\n      if (opt.repeatable) {\n        if (handledRepeatables[opt.key]) {\n          el.remove()\n          removes.push(r)\n          continue\n        }\n        handledRepeatables[opt.key] = true\n        const vals = v.split(opt.repeatable)\n        const firstVal = vals[0]\n        finds.push(el)\n        Doc.safeSelector(el, 'input').value = firstVal\n        // Add repeatN - 1 empty elements to the reconfig form. Add them before\n        // the populated inputs just because of the way we're using the\n        // insertAfter argument to addOpt.\n        for (let i = 1; i < (opt.repeatN || 1); i++) finds.push(this.addOpt(el.parentElement as PageElement, opt, el, true))\n        for (let i = 1; i < vals.length; i++) {\n          const newEl = this.addOpt(el.parentElement as PageElement, opt, el, true)\n          Doc.safeSelector(newEl, 'input').value = vals[i]\n          finds.push(newEl)\n        }\n        continue\n      }\n      finds.push(el)\n      const input = Doc.safeSelector(el, 'input') as HTMLInputElement\n      if (opt.isboolean) input.checked = isTruthyString(v)\n      else if (opt.isdate) {\n        input.value = dateToString(new Date(parseInt(v) * 1000))\n        // alt: input.valueAsDate = dateApplyOffset(...)\n      } else input.value = v\n    }\n    for (const r of removes) {\n      const i = this.configElements.indexOf(r)\n      if (i >= 0) this.configElements.splice(i, 1)\n    }\n\n    return finds\n  }\n\n  /*\n   * setLoadedConfig sets the input values for the entries in cfg, and moves\n   * them to the loadedSettings box.\n   */\n  setLoadedConfig (cfg: Record<string, string>) {\n    const finds = this.setConfig(cfg)\n    if (!this.sectionize || finds.length === 0) return\n    this.loadedSettings.append(...finds)\n    this.reorder(this.loadedSettings)\n    Doc.show(this.loadedSettings, this.loadedSettingsMsg)\n    if (this.defaultSettings.children.length === 0) Doc.hide(this.defaultSettings, this.defaultSettingsMsg)\n  }\n\n  /*\n   * map reads all inputs and constructs an object from the configOpt keys and\n   * values.\n   */\n  map (assetID: number): Record<string, string> {\n    const config: Record<string, string> = {}\n    for (const [opt, el] of this.configElements) {\n      const input = Doc.safeSelector(el, 'input') as HTMLInputElement\n      if (opt.regAsset !== undefined && opt.regAsset !== assetID) continue\n      if (opt.isboolean && opt.key) {\n        config[opt.key] = input.checked ? '1' : '0'\n      } else if (opt.isdate && opt.key) {\n        // Force local time interpretation by appending a time to the date\n        // string, otherwise the Date constructor considers it UTC.\n        const minDate = input.min ? toUnixDate(new Date(input.min + 'T00:00')) : Number.MIN_SAFE_INTEGER\n        const maxDate = input.max ? toUnixDate(new Date(input.max + 'T00:00')) : Number.MAX_SAFE_INTEGER\n        let date = input.value ? toUnixDate(new Date(input.value + 'T00:00')) : 0\n        if (date < minDate) date = minDate\n        else if (date > maxDate) date = maxDate\n        config[opt.key] = String(date)\n      } else if (input.value) {\n        if (opt.repeatable && config[opt.key]) config[opt.key] += opt.repeatable + input.value\n        else config[opt.key] = input.value\n      }\n    }\n    return config\n  }\n\n  /*\n   * reorder sorts the configElements in the box by the order of the\n   * server-provided configOpts array.\n   */\n  reorder (box: HTMLElement) {\n    const inputs: Record<string, HTMLElement[]> = {}\n    box.querySelectorAll('input').forEach((input: ConfigOptionInput) => {\n      const k = input.dataset.configKey\n      if (!k) return // TS2538\n      const els = []\n      for (const [opt, el] of this.configElements) if (opt.key === k) els.push(el)\n      inputs[k] = els\n    })\n    for (const opt of this.configOpts) {\n      const els = inputs[opt.key] || []\n      for (const el of els) box.append(el)\n    }\n  }\n}\n\n/*\n * ConfirmRegistrationForm should be used with the \"confirmRegistrationForm\"\n * template.\n */\nexport class ConfirmRegistrationForm {\n  form: HTMLElement\n  success: () => void\n  page: Record<string, PageElement>\n  xc: Exchange\n  certFile: string\n  bondAssetID: number\n  tier: number\n  fees: number\n\n  constructor (form: HTMLElement, success: () => void, goBack: () => void) {\n    this.form = form\n    this.success = success\n    this.page = Doc.parseTemplate(form)\n    this.certFile = ''\n\n    Doc.bind(this.page.goBack, 'click', () => goBack())\n    bind(form, this.page.submit, () => this.submitForm())\n  }\n\n  setExchange (xc: Exchange, certFile: string) {\n    this.xc = xc\n    this.certFile = certFile\n    this.page.host.textContent = xc.host\n  }\n\n  setAsset (assetID: number, tier: number, fees: number) {\n    const asset = app().assets[assetID]\n    const { conversionFactor, unit } = asset.unitInfo.conventional\n    this.bondAssetID = asset.id\n    this.tier = tier\n    this.fees = fees\n    const page = this.page\n    const bondAsset = this.xc.bondAssets[asset.symbol]\n    const bondLock = bondAsset.amount * tier * bondReserveMultiplier\n    const bondLockConventional = bondLock / conversionFactor\n    page.tradingTier.textContent = String(tier)\n    page.logo.src = Doc.logoPath(asset.symbol)\n    page.bondLock.textContent = Doc.formatFourSigFigs(bondLockConventional)\n    page.bondUnit.textContent = unit\n    const r = app().fiatRatesMap[assetID]\n    Doc.show(page.bondLockUSDBox)\n    if (r) page.bondLockUSD.textContent = Doc.formatFourSigFigs(bondLockConventional * r)\n    else Doc.hide(page.bondLockUSDBox)\n    if (fees) page.feeReserves.textContent = Doc.formatFourSigFigs(fees / conversionFactor)\n    page.reservesUnit.textContent = unit\n  }\n\n  setFees (assetID: number, fees: number) {\n    this.fees = fees\n    const conversionFactor = app().assets[assetID].unitInfo.conventional.conversionFactor\n    this.page.feeReserves.textContent = Doc.formatFourSigFigs(fees / conversionFactor)\n  }\n\n  /* Form expands into its space quickly from the lower-right as it fades in. */\n  async animate () {\n    const form = this.form\n    Doc.animate(400, prog => {\n      form.style.transform = `scale(${prog})`\n      form.style.opacity = String(Math.pow(prog, 4))\n      const offset = `${(1 - prog) * 500}px`\n      form.style.top = offset\n      form.style.left = offset\n    })\n  }\n\n  /*\n   * submitForm is called when the form is submitted.\n   */\n  async submitForm () {\n    const { page, bondAssetID, xc, certFile, tier } = this\n    const asset = app().assets[bondAssetID]\n    if (!asset) {\n      page.regErr.innerText = intl.prep(intl.ID_SELECT_WALLET_FOR_FEE_PAYMENT)\n      Doc.show(page.regErr)\n      return\n    }\n    Doc.hide(page.regErr)\n    const bondAsset = xc.bondAssets[asset.wallet.symbol]\n    const dexAddr = xc.host\n    let form: any\n    let url: string\n    if (!app().exchanges[xc.host] || app().exchanges[xc.host].viewOnly) {\n      form = {\n        addr: dexAddr,\n        cert: certFile,\n        bond: bondAsset.amount * tier,\n        asset: bondAsset.id\n      }\n      url = '/api/postbond'\n    } else {\n      form = {\n        host: dexAddr,\n        targetTier: tier,\n        bondAssetID: bondAssetID\n      }\n      url = '/api/updatebondoptions'\n    }\n    const loaded = app().loading(this.form)\n    const res = await postJSON(url, form)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.regErr.textContent = res.msg\n      Doc.show(page.regErr)\n      return\n    }\n    this.success()\n  }\n}\n\ninterface RegAssetRow {\n  ready: PageElement\n}\n\ninterface MarketLimitsRow {\n  mkt: Market\n  tmpl: Record<string, PageElement>\n  setTier: ((tier: number) => void)\n}\n\n/*\n * FeeAssetSelectionForm should be used with the \"regAssetForm\" template.\n */\nexport class FeeAssetSelectionForm {\n  form: HTMLElement\n  success: (assetID: number, tier: number) => Promise<void>\n  xc: Exchange\n  selectedAssetID: number\n  certFile: string\n  page: Record<string, PageElement>\n  assetRows: Record<string, RegAssetRow>\n  marketRows: MarketLimitsRow[]\n\n  constructor (form: HTMLElement, success: (assetID: number, tier: number) => Promise<void>) {\n    this.form = form\n    this.certFile = ''\n    this.success = success\n    const page = this.page = Doc.parseTemplate(form)\n    Doc.cleanTemplates(page.currentBondTmpl, page.bondAssetTmpl, page.marketTmpl)\n\n    Doc.bind(page.tradingTierInput, 'input', () => { this.setTier() })\n    Doc.bind(page.tradingTierInput, 'keyup', (e: KeyboardEvent) => { if (e.key === 'Enter') this.acceptTier() })\n    Doc.bind(page.submitTradingTier, 'click', () => { this.acceptTier() })\n\n    Doc.bind(page.tierUp, 'click', () => { this.incrementTier(true) })\n    Doc.bind(page.tierDown, 'click', () => { this.incrementTier(false) })\n\n    Doc.bind(page.goBackToAssets, 'click', () => {\n      Doc.hide(page.tradingTierForm)\n      Doc.show(page.assetForm)\n    })\n\n    Doc.bind(page.whatsABond, 'click', () => {\n      Doc.hide(page.assetForm)\n      Doc.show(page.whatsABondPanel)\n    })\n\n    const hideWhatsABond = () => {\n      Doc.show(page.assetForm)\n      Doc.hide(page.whatsABondPanel)\n    }\n\n    Doc.bind(page.bondGotIt, 'click', () => { hideWhatsABond() })\n\n    Doc.bind(page.whatsABondBack, 'click', () => { hideWhatsABond() })\n\n    Doc.bind(page.usePrepaidBond, 'click', () => { this.showPrepaidBondForm() })\n    Doc.bind(page.ppbGoBack, 'click', () => { this.hidePrepaidBondForm() })\n    Doc.bind(page.submitPrepaidBond, 'click', () => { this.submitPrepaidBond() })\n\n    app().registerNoteFeeder({\n      createwallet: (note: WalletCreationNote) => {\n        if (note.topic === 'QueuedCreationSuccess') this.walletCreated(note.assetID)\n      }\n    })\n  }\n\n  setTierError (errMsg: string) {\n    this.page.tradingTierErr.textContent = errMsg\n    Doc.show(this.page.tradingTierErr)\n  }\n\n  setAssetError (errMsg: string) {\n    this.page.regAssetErr.textContent = errMsg\n    Doc.show(this.page.regAssetErr)\n  }\n\n  clearErrors () {\n    Doc.hide(this.page.regAssetErr, this.page.tradingTierErr)\n  }\n\n  setExchange (xc: Exchange, certFile: string) {\n    this.xc = xc\n    this.certFile = certFile\n    this.assetRows = {}\n    this.marketRows = []\n    const page = this.page\n    Doc.hide(page.assetForm, page.tradingTierForm, page.whatsABondPanel, page.prepaidBonds)\n    Doc.empty(page.bondAssets, page.markets)\n    this.clearErrors()\n\n    const addBondRow = (assetID: number, bondAsset: BondAsset) => {\n      const asset = app().assets[assetID]\n      if (!asset) return\n      const { unitInfo: { conventional: { unit, conversionFactor } }, name, symbol } = asset\n      const tr = page.bondAssetTmpl.cloneNode(true) as HTMLElement\n      page.bondAssets.appendChild(tr)\n      const tmpl = Doc.parseTemplate(tr)\n\n      tmpl.logo.src = Doc.logoPath(symbol)\n      tmpl.name.textContent = name\n\n      Doc.bind(tr, 'click', () => { this.assetSelected(assetID) })\n      tmpl.feeSymbol.textContent = unit\n      const bondSizeConventional = bondAsset.amount / conversionFactor\n      tmpl.feeAmt.textContent = Doc.formatFourSigFigs(bondSizeConventional)\n      const fiatRate = app().fiatRatesMap[assetID]\n      Doc.setVis(fiatRate, tmpl.fiatBox)\n      if (fiatRate) tmpl.fiatBondAmount.textContent = Doc.formatFourSigFigs(bondSizeConventional * fiatRate)\n      this.assetRows[assetID] = { ready: tmpl.ready }\n    }\n\n    const addMarketRow = (mkt: Market) => {\n      const { baseid: baseID, quoteid: quoteID } = mkt\n      const [b, q] = [app().assets[baseID], app().assets[quoteID]]\n      if (!b || !q) return\n      const tr = page.marketTmpl.cloneNode(true) as HTMLElement\n      page.markets.appendChild(tr)\n      const { symbol: baseSymbol, unitInfo: bui } = xc.assets[baseID]\n      const { symbol: quoteSymbol, unitInfo: qui } = xc.assets[quoteID]\n      for (const el of Doc.applySelector(tr, '[data-base-ticker]')) el.textContent = bui.conventional.unit\n      for (const el of Doc.applySelector(tr, '[data-quote-ticker]')) el.textContent = qui.conventional.unit\n\n      const tmpl = Doc.parseTemplate(tr)\n      tmpl.baseLogo.src = Doc.logoPath(baseSymbol)\n      tmpl.quoteLogo.src = Doc.logoPath(quoteSymbol)\n\n      const setTier = (tier: number) => {\n        const { parcelsize: parcelSize, lotsize: lotSize } = mkt\n        const conventionalLotSize = lotSize / bui.conventional.conversionFactor\n        const startingLimit = conventionalLotSize * parcelSize * perTierBaseParcelLimit * tier\n        const privilegedLimit = conventionalLotSize * parcelSize * perTierBaseParcelLimit * parcelLimitScoreMultiplier * tier\n        tmpl.tradeLimitLow.textContent = Doc.formatFourSigFigs(startingLimit)\n        tmpl.tradeLimitHigh.textContent = Doc.formatFourSigFigs(privilegedLimit)\n        const baseFiatRate = app().fiatRatesMap[baseID]\n        if (baseFiatRate) {\n          tmpl.fiatTradeLimitLow.textContent = Doc.formatFourSigFigs(startingLimit * baseFiatRate)\n          tmpl.fiatTradeLimitHigh.textContent = Doc.formatFourSigFigs(privilegedLimit * baseFiatRate)\n        }\n        Doc.setVis(baseFiatRate, page.fiatTradeLowBox, page.fiatTradeHighBox)\n      }\n\n      setTier(strongTier(xc.auth) || 1)\n      this.marketRows.push({ mkt, tmpl, setTier })\n    }\n\n    for (const { symbol, id: assetID } of Object.values(xc.assets || {})) {\n      if (!app().assets[assetID]) continue\n      const bondAsset = xc.bondAssets[symbol]\n      if (bondAsset) addBondRow(assetID, bondAsset)\n    }\n\n    for (const mkt of Object.values(xc.markets || {})) addMarketRow(mkt)\n\n    // page.host.textContent = xc.host\n    page.tradingTierInput.value = xc.auth.targetTier ? String(xc.auth.targetTier) : '1'\n\n    if (this.validBondAssetSelected(xc)) this.assetSelected(xc.auth.bondAssetID)\n    else Doc.show(page.assetForm)\n  }\n\n  validBondAssetSelected (xc: Exchange) {\n    if (xc.viewOnly) return false\n    const { targetTier, bondAssetID } = xc.auth\n    if (targetTier < 1) return false\n    const a = app().assets[bondAssetID]\n    return a && Boolean(xc.bondAssets[a.symbol])\n  }\n\n  /*\n   * walletCreated should be called when an asynchronous wallet creation\n   * completes successfully.\n   */\n  walletCreated (assetID: number) {\n    const a = this.assetRows[assetID]\n    const asset = app().assets[assetID]\n    setReadyMessage(a.ready, asset)\n  }\n\n  refresh () {\n    this.setExchange(this.xc, this.certFile)\n  }\n\n  assetSelected (assetID: number) {\n    this.selectedAssetID = assetID\n    this.setTier()\n    const { page: { assetForm, tradingTierForm, tradingTierInput } } = this\n    Doc.hide(assetForm)\n    Doc.show(tradingTierForm)\n    tradingTierInput.focus()\n  }\n\n  setTier () {\n    const { page, xc: { bondAssets }, selectedAssetID: assetID } = this\n    const { symbol, unitInfo: ui } = app().assets[assetID]\n    const { conventional: { conversionFactor, unit } } = ui\n\n    const bondAsset = bondAssets[symbol]\n    const raw = page.tradingTierInput.value ?? ''\n    if (!raw) return\n    const tier = parseInt(raw)\n    if (isNaN(tier)) {\n      this.setTierError(intl.prep(intl.ID_INVALID_TIER_VALUE))\n      return\n    }\n    page.tradingTierInput.value = String(tier)\n    page.bondSizeDisplay.textContent = Doc.formatCoinValue(bondAsset.amount, ui)\n    for (const el of Doc.applySelector(page.tradingTierForm, '[data-tier]')) el.textContent = String(tier)\n    for (const el of Doc.applySelector(page.tradingTierForm, '[data-bond-asset-ticker]')) el.textContent = unit\n    const bondLock = bondAsset.amount * tier * bondReserveMultiplier\n    page.bondLockDisplay.textContent = Doc.formatCoinValue(bondLock, ui)\n    const fiatRate = app().fiatRatesMap[assetID]\n    if (fiatRate) page.fiatLockDisplay.textContent = Doc.formatFourSigFigs(bondLock / conversionFactor * fiatRate)\n    for (const m of Object.values(this.marketRows)) m.setTier(tier)\n    const currentBondAmts: Record<number, number> = {}\n    for (const [assetIDStr, { wallet }] of Object.entries(app().assets)) {\n      if (!wallet) continue\n      const { balance: { bondlocked, bondReserves } } = wallet\n      const bonded = bondlocked + bondReserves\n      if (bonded > 0) currentBondAmts[parseInt(assetIDStr)] = bonded\n    }\n    const haveLock = Object.keys(currentBondAmts).length > 0\n    Doc.setVis(haveLock, page.currentBondBox)\n    if (haveLock) {\n      Doc.empty(page.currentBonds)\n      for (const [assetIDStr, bondLocked] of Object.entries(currentBondAmts)) {\n        const assetID = parseInt(assetIDStr)\n        const { unitInfo: ui, symbol, name } = app().assets[assetID]\n        const { conventional: { conversionFactor, unit } } = ui\n        const tr = page.currentBondTmpl.cloneNode(true) as PageElement\n        page.currentBonds.appendChild(tr)\n        const tmpl = Doc.parseTemplate(tr)\n        tmpl.icon.src = Doc.logoPath(symbol)\n        tmpl.name.textContent = name\n        tmpl.amt.textContent = Doc.formatCoinValue(bondLocked, ui)\n        tmpl.ticker.textContent = unit\n        tmpl.name.textContent = name\n        const fiatRate = app().fiatRatesMap[assetID]\n        Doc.setVis(tmpl.fiatBox)\n        if (fiatRate) tmpl.fiatAmt.textContent = Doc.formatFourSigFigs(bondLocked / conversionFactor * fiatRate)\n      }\n    }\n    Doc.setVis(fiatRate, page.fiatLockBox)\n  }\n\n  acceptTier () {\n    const { page, selectedAssetID: assetID } = this\n    this.clearErrors()\n    const raw = page.tradingTierInput.value ?? ''\n    if (!raw) return\n    const tier = parseInt(raw)\n    if (isNaN(tier)) {\n      this.setTierError(intl.prep(intl.ID_INVALID_TIER_VALUE))\n      return\n    }\n    this.success(assetID, tier)\n  }\n\n  incrementTier (up: boolean) {\n    const { page: { tradingTierInput: input } } = this\n    input.value = String(Math.max(1, (parseInt(input.value ?? '') || 1) + (up ? 1 : -1)))\n    this.setTier()\n  }\n\n  /*\n   * Animation to make the elements sort of expand into their space from the\n   * bottom as they fade in.\n   */\n  async animate () {\n    const { page, form } = this\n    const extraMargin = 75\n    const extraTop = 50\n    const regAssetElements = Array.from(page.bondAssets.children) as PageElement[]\n    form.style.opacity = '0'\n\n    const aniLen = 350\n    await Doc.animate(aniLen, prog => {\n      for (const el of regAssetElements) {\n        el.style.marginTop = `${(1 - prog) * extraMargin}px`\n        el.style.transform = `scale(${prog})`\n      }\n      form.style.opacity = Math.pow(prog, 4).toFixed(1)\n      form.style.top = `${(1 - prog) * extraTop}px`\n    }, 'easeOut')\n  }\n\n  showPrepaidBondForm () {\n    const { page } = this\n    Doc.hide(page.assetForm, page.prepaidBondErr)\n    page.prepaidBondCode.value = ''\n    Doc.show(page.prepaidBonds)\n  }\n\n  hidePrepaidBondForm () {\n    const { page } = this\n    Doc.hide(page.prepaidBonds)\n    Doc.show(page.assetForm)\n  }\n\n  async submitPrepaidBond () {\n    const { page, xc: { host } } = this\n    Doc.hide(page.prepaidBondErr)\n    const code = page.prepaidBondCode.value\n    if (!code) {\n      page.prepaidBondErr.textContent = intl.prep(intl.ID_INVALID_VALUE)\n      Doc.show(page.prepaidBondErr)\n      return\n    }\n    const res = await postJSON('/api/redeemprepaidbond', { host, code, cert: this.certFile })\n    if (!app().checkResponse(res)) {\n      page.prepaidBondErr.textContent = res.msg\n      Doc.show(page.prepaidBondErr)\n      return\n    }\n    this.success(PrepaidBondID, res.tier)\n  }\n}\n\n/*\n * setReadyMessage sets an asset's status message on the FeeAssetSelectionForm.\n */\nfunction setReadyMessage (el: PageElement, asset: SupportedAsset) {\n  if (asset.wallet) el.textContent = intl.prep(intl.ID_WALLET_READY)\n  else if (asset.walletCreationPending) el.textContent = intl.prep(intl.ID_WALLET_PENDING)\n  else el.textContent = intl.prep(intl.ID_SETUP_NEEDED)\n  el.classList.remove('readygreen', 'setuporange')\n  el.classList.add(asset.wallet ? 'readygreen' : 'setuporange')\n}\n\n/*\n * WalletWaitForm is a form used to track the wallet sync status and balance\n * in preparation for posting a bond.\n */\nexport class WalletWaitForm {\n  form: HTMLElement\n  success: () => void\n  goBack: () => void\n  page: Record<string, PageElement>\n  assetID: number\n  parentID?: number\n  xc: Exchange\n  bondAsset: BondAsset\n  progressCache: ProgressPoint[]\n  progressed: boolean\n  funded: boolean\n  // if progressed && funded, stop reporting balance or state; call success()\n  bondFeeBuffer: number // in parent asset\n  parentAssetSynced: boolean\n\n  constructor (form: HTMLElement, success: () => void, goBack: () => void) {\n    this.form = form\n    this.success = success\n    this.page = Doc.parseTemplate(form)\n    this.assetID = -1\n    this.progressCache = []\n    this.progressed = false\n    this.funded = false\n\n    Doc.bind(this.page.goBack, 'click', () => {\n      this.assetID = -1\n      goBack()\n    })\n\n    app().registerNoteFeeder({\n      walletstate: (note: WalletStateNote) => this.reportWalletState(note.wallet),\n      walletsync: (note: WalletSyncNote) => {\n        if (note.assetID !== this.assetID) return\n        const w = app().walletMap[note.assetID]\n        this.reportProgress(w.synced, w.syncProgress)\n      },\n      balance: (note: BalanceNote) => this.reportBalance(note.assetID)\n    })\n  }\n\n  /* setExchange sets the exchange for which the fee is being paid. */\n  setExchange (xc: Exchange) {\n    this.xc = xc\n  }\n\n  /* setWallet must be called before showing the WalletWaitForm. */\n  setWallet (assetID: number, bondFeeBuffer: number, tier: number) {\n    this.assetID = assetID\n    this.progressCache = []\n    this.progressed = false\n    this.funded = false\n    this.bondFeeBuffer = bondFeeBuffer // in case we're a token, parent's balance must cover\n    this.parentAssetSynced = false\n    const page = this.page\n    const asset = app().assets[assetID]\n    const { symbol, unitInfo: ui, wallet: { balance: bal, address, synced, syncProgress }, token } = asset\n    this.parentID = token?.parentID\n    const bondAsset = this.bondAsset = this.xc.bondAssets[symbol]\n\n    const symbolize = (el: PageElement, asset: SupportedAsset) => {\n      Doc.empty(el)\n      el.appendChild(Doc.symbolize(asset))\n    }\n\n    for (const span of Doc.applySelector(this.form, '.unit')) symbolize(span, asset)\n    page.logo.src = Doc.logoPath(symbol)\n    page.depoAddr.textContent = address\n\n    Doc.hide(page.syncUncheck, page.syncCheck, page.balUncheck, page.balCheck, page.syncRemainBox, page.bondCostBreakdown)\n    Doc.show(page.balanceBox)\n\n    let bondLock = 2 * bondAsset.amount * tier\n    if (bondFeeBuffer > 0) {\n      Doc.show(page.bondCostBreakdown)\n      page.bondLockNoFees.textContent = Doc.formatCoinValue(bondLock, ui)\n      page.bondLockFees.textContent = Doc.formatCoinValue(bondFeeBuffer, ui)\n      bondLock += bondFeeBuffer\n      const need = Math.max(bondLock - bal.available + bal.reservesDeficit, 0)\n      page.totalForBond.textContent = Doc.formatCoinValue(need, ui)\n      Doc.hide(page.sendEnough) // generic msg when no fee info available when\n      Doc.hide(page.txFeeBox, page.sendEnoughForToken, page.txFeeBalanceBox) // for tokens\n      Doc.hide(page.sendEnoughWithEst) // non-tokens\n\n      if (token) {\n        Doc.show(page.txFeeBox, page.sendEnoughForToken, page.txFeeBalanceBox)\n        const parentAsset = app().assets[token.parentID]\n        page.txFee.textContent = Doc.formatCoinValue(bondFeeBuffer, parentAsset.unitInfo)\n        page.parentFees.textContent = Doc.formatCoinValue(bondFeeBuffer, parentAsset.unitInfo)\n        page.tokenFees.textContent = Doc.formatCoinValue(need, ui)\n        symbolize(page.txFeeUnit, parentAsset)\n        symbolize(page.parentUnit, parentAsset)\n        symbolize(page.parentBalUnit, parentAsset)\n        page.parentBal.textContent = parentAsset.wallet ? Doc.formatCoinValue(parentAsset.wallet.balance.available, parentAsset.unitInfo) : '0'\n      } else {\n        Doc.show(page.sendEnoughWithEst)\n      }\n      page.fee.textContent = Doc.formatCoinValue(bondLock, ui)\n    } else { // show some generic message with no amounts, this shouldn't happen... show wallet error?\n      Doc.show(page.sendEnough)\n    }\n\n    Doc.show(synced ? page.syncCheck : syncProgress >= 1 ? page.syncSpinner : page.syncUncheck)\n    Doc.show(bal.available >= 2 * bondAsset.amount + bondFeeBuffer ? page.balCheck : page.balUncheck)\n\n    page.progress.textContent = (syncProgress * 100).toFixed(1)\n\n    if (synced) {\n      this.progressed = true\n    }\n    this.reportBalance(assetID)\n  }\n\n  /*\n   * reportWalletState sets the progress and balance, ultimately calling the\n   * success function if conditions are met.\n   */\n  reportWalletState (wallet: WalletState) {\n    if (this.progressed && this.funded) return\n    if (wallet.assetID === this.assetID) this.reportProgress(wallet.synced, wallet.syncProgress)\n    this.reportBalance(wallet.assetID)\n  }\n\n  /*\n   * reportBalance sets the balance display and calls success if we go over the\n   * threshold.\n   */\n  reportBalance (assetID: number) {\n    if (this.funded || this.assetID === -1) return\n    if (assetID !== this.assetID && assetID !== this.parentID) return\n    const page = this.page\n    const asset = app().assets[this.assetID]\n\n    const avail = asset.wallet.balance.available\n    page.balance.textContent = Doc.formatCoinValue(avail, asset.unitInfo)\n\n    if (asset.token) {\n      const parentAsset = app().assets[asset.token.parentID]\n      const parentAvail = parentAsset.wallet.balance.available\n      page.parentBal.textContent = Doc.formatCoinValue(parentAvail, parentAsset.unitInfo)\n      if (parentAvail < this.bondFeeBuffer) return\n    }\n\n    // NOTE: when/if we allow one-time bond post (no maintenance) from the UI we\n    // may allow to proceed as long as they have enough for tx fees. For now,\n    // the balance check box will remain unchecked and we will not proceed.\n    if (avail < 2 * this.bondAsset.amount + this.bondFeeBuffer) return\n\n    Doc.show(page.balCheck)\n    Doc.hide(page.balUncheck, page.balanceBox, page.sendEnough)\n    this.funded = true\n    if (this.progressed) this.success()\n  }\n\n  /*\n   * reportProgress sets the progress display and calls success if we are fully\n   * synced.\n   */\n  reportProgress (synced: boolean, prog: number) {\n    const page = this.page\n    if (synced) {\n      page.progress.textContent = '100'\n      Doc.hide(page.syncUncheck, page.syncRemainBox, page.syncSpinner)\n      Doc.show(page.syncCheck)\n      this.progressed = true\n      if (this.funded) this.success()\n      return\n    } else if (prog === 1) {\n      Doc.hide(page.syncUncheck)\n      Doc.show(page.syncSpinner)\n    } else {\n      Doc.hide(page.syncSpinner)\n      Doc.show(page.syncUncheck)\n    }\n    page.progress.textContent = (prog * 100).toFixed(1)\n\n    if (prog >= 0.999) {\n      Doc.hide(page.syncRemaining)\n      Doc.show(page.syncFinishingUp)\n      Doc.show(page.syncRemainBox)\n      // The final stage of wallet sync process can take a while (it might hang\n      // at 99.9% for many minutes, indexing addresses for example), the simplest\n      // way to handle it is to keep displaying \"finishing up\" message until the\n      // sync is finished, since we can't reasonably show it progressing over time.\n      page.syncFinishingUp.textContent = intl.prep(intl.ID_WALLET_SYNC_FINISHING_UP)\n      return\n    }\n    // Before we get to 99.9% the remaining time estimate must be based on more\n    // than one progress report. We'll cache up to the last 20 and look at the\n    // difference between the first and last to make the estimate.\n    const cacheSize = 20\n    const cache = this.progressCache\n    cache.push({\n      stamp: new Date().getTime(),\n      progress: prog\n    })\n    if (cache.length < 2) {\n      // Can't meaningfully estimate remaining until we have at least 2 data points.\n      return\n    }\n    while (cache.length > cacheSize) cache.shift()\n    const [first, last] = [cache[0], cache[cache.length - 1]]\n    const progDelta = last.progress - first.progress\n    if (progDelta === 0) {\n      // Having no progress for a while likely means we are experiencing network\n      // issues, can't reasonably estimate time remaining in this case.\n      return\n    }\n    Doc.hide(page.syncFinishingUp)\n    Doc.show(page.syncRemaining)\n    Doc.show(page.syncRemainBox)\n    const timeDelta = last.stamp - first.stamp\n    const progRate = progDelta / timeDelta\n    const toGoProg = 1 - last.progress\n    const toGoTime = toGoProg / progRate\n    page.syncRemain.textContent = Doc.formatDuration(toGoTime)\n  }\n}\n\ninterface EarlyAcceleration {\n  timePast: number,\n  wasAcceleration: boolean\n}\n\ninterface PreAccelerate {\n  swapRate: number\n  suggestedRate: number\n  suggestedRange: XYRange\n  earlyAcceleration?: EarlyAcceleration\n}\n\n/*\n * AccelerateOrderForm is used to submit an acceleration request for an order.\n */\nexport class AccelerateOrderForm {\n  form: HTMLElement\n  page: Record<string, PageElement>\n  order: Order\n  acceleratedRate: number\n  earlyAcceleration?: EarlyAcceleration\n  currencyUnit: string\n  success: () => void\n\n  constructor (form: HTMLElement, success: () => void) {\n    this.form = form\n    this.success = success\n    const page = this.page = Doc.idDescendants(form)\n\n    Doc.bind(page.accelerateSubmit, 'click', () => {\n      this.submit()\n    })\n    Doc.bind(page.submitEarlyConfirm, 'click', () => {\n      this.sendAccelerateRequest()\n    })\n  }\n\n  /*\n   * displayEarlyAccelerationMsg displays a message asking for confirmation\n   * when the user tries to submit an acceleration transaction very soon after\n   * the swap transaction was broadcast, or very soon after a previous\n   * acceleration.\n   */\n  displayEarlyAccelerationMsg () {\n    const page = this.page\n    // this is checked in submit, but another check is needed for ts compiler\n    if (!this.earlyAcceleration) return\n    page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    if (this.earlyAcceleration.wasAcceleration) {\n      Doc.show(page.recentAccelerationMsg)\n      Doc.hide(page.recentSwapMsg)\n      page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    } else {\n      Doc.show(page.recentSwapMsg)\n      Doc.hide(page.recentAccelerationMsg)\n      page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`\n    }\n    Doc.hide(page.configureAccelerationDiv, page.accelerateErr)\n    Doc.show(page.earlyAccelerationDiv)\n  }\n\n  // sendAccelerateRequest makes an accelerate order request to the client\n  // backend.\n  async sendAccelerateRequest () {\n    const order = this.order\n    const page = this.page\n    const req = {\n      orderID: order.id,\n      newRate: this.acceleratedRate\n    }\n    const loaded = app().loading(page.accelerateMainDiv)\n    const res = await postJSON('/api/accelerateorder', req)\n    loaded()\n    if (app().checkResponse(res)) {\n      page.accelerateTxID.textContent = res.txID\n      Doc.hide(page.accelerateMainDiv, page.preAccelerateErr, page.accelerateErr)\n      Doc.show(page.accelerateMsgDiv, page.accelerateSuccess)\n      this.success()\n    } else {\n      page.accelerateErr.textContent = intl.prep(intl.ID_ORDER_ACCELERATION_ERR_MSG, { msg: res.msg })\n      Doc.hide(page.earlyAccelerationDiv)\n      Doc.show(page.accelerateErr, page.configureAccelerationDiv)\n    }\n  }\n\n  // submit is called when the submit button is clicked.\n  async submit () {\n    if (this.earlyAcceleration) {\n      this.displayEarlyAccelerationMsg()\n    } else {\n      this.sendAccelerateRequest()\n    }\n  }\n\n  // refresh should be called before the form is displayed. It makes a\n  // preaccelerate request to the client backend and sets up the form\n  // based on the results.\n  async refresh (order: Order) {\n    const page = this.page\n    this.order = order\n    const res = await postJSON('/api/preaccelerate', order.id)\n    if (!app().checkResponse(res)) {\n      page.preAccelerateErr.textContent = intl.prep(intl.ID_ORDER_ACCELERATION_ERR_MSG, { msg: res.msg })\n      Doc.hide(page.accelerateMainDiv, page.accelerateSuccess)\n      Doc.show(page.accelerateMsgDiv, page.preAccelerateErr)\n      return\n    }\n    Doc.hide(page.accelerateMsgDiv, page.preAccelerateErr, page.accelerateErr, page.feeEstimateDiv, page.earlyAccelerationDiv)\n    Doc.show(page.accelerateMainDiv, page.accelerateSuccess, page.configureAccelerationDiv)\n    const preAccelerate: PreAccelerate = res.preAccelerate\n    this.earlyAcceleration = preAccelerate.earlyAcceleration\n    this.currencyUnit = preAccelerate.suggestedRange.yUnit\n    page.accelerateAvgFeeRate.textContent = `${preAccelerate.swapRate} ${preAccelerate.suggestedRange.yUnit}`\n    page.accelerateCurrentFeeRate.textContent = `${preAccelerate.suggestedRate} ${preAccelerate.suggestedRange.yUnit}`\n    this.acceleratedRate = preAccelerate.suggestedRange.start.y\n    const selected = () => { /* do nothing */ }\n    const roundY = true\n    const updateRate = (_: number, newY: number) => { this.acceleratedRate = newY }\n    const rangeHandler = new XYRangeHandler(preAccelerate.suggestedRange, preAccelerate.suggestedRange.start.x, {\n      updated: updateRate, changed: () => this.updateAccelerationEstimate(), selected, roundY\n    })\n    Doc.empty(page.sliderContainer)\n    page.sliderContainer.appendChild(rangeHandler.control)\n    this.updateAccelerationEstimate()\n  }\n\n  // updateAccelerationEstimate makes an accelerate estimate request to the\n  // client backend using the currently selected rate on the slider, and\n  // displays the results.\n  async updateAccelerationEstimate () {\n    const page = this.page\n    const order = this.order\n    const req = {\n      orderID: order.id,\n      newRate: this.acceleratedRate\n    }\n    const loaded = app().loading(page.sliderContainer)\n    const res = await postJSON('/api/accelerationestimate', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.accelerateErr.textContent = intl.prep(intl.ID_ORDER_ACCELERATION_FEE_ERR_MSG, { msg: res.msg })\n      Doc.show(page.accelerateErr)\n      return\n    }\n    page.feeRateEstimate.textContent = `${this.acceleratedRate} ${this.currencyUnit}`\n    let assetID\n    let assetSymbol\n    if (order.sell) {\n      assetID = order.baseID\n      assetSymbol = order.baseSymbol\n    } else {\n      assetID = order.quoteID\n      assetSymbol = order.quoteSymbol\n    }\n    const unitInfo = app().unitInfo(assetID)\n    page.feeEstimate.textContent = `${res.fee / unitInfo.conventional.conversionFactor} ${assetSymbol}`\n    Doc.show(page.feeEstimateDiv)\n  }\n}\n\n/* DEXAddressForm accepts a DEX address and performs account discovery. */\nexport class DEXAddressForm {\n  form: HTMLElement\n  success: (xc: Exchange, cert: string) => void\n  page: Record<string, PageElement>\n  knownExchanges: HTMLElement[]\n  dexToUpdate?: string\n  certPicker: CertificatePicker\n\n  constructor (form: HTMLElement, success: (xc: Exchange, cert: string) => void, dexToUpdate?: string) {\n    this.form = form\n    this.success = success\n\n    const page = this.page = Doc.parseTemplate(form)\n\n    this.certPicker = new CertificatePicker(form)\n\n    Doc.bind(page.skipRegistration, 'change', () => this.showOrHideSubmitBttn())\n    Doc.bind(page.showCustom, 'click', () => {\n      Doc.hide(page.showCustom)\n      Doc.show(page.customBox, page.auth)\n    })\n\n    this.knownExchanges = Array.from(page.knownXCs.querySelectorAll('.known-exchange'))\n    for (const div of this.knownExchanges) {\n      Doc.bind(div, 'click', () => {\n        const host = div.dataset.host\n        for (const d of this.knownExchanges) d.classList.remove('selected')\n        return this.checkDEX(host)\n      })\n    }\n\n    bind(form, page.submit, () => this.checkDEX())\n\n    if (dexToUpdate) {\n      Doc.hide(page.addDexHdr, page.skipRegistrationBox)\n      Doc.show(page.updateDexHdr)\n      this.dexToUpdate = dexToUpdate\n    }\n\n    this.refresh()\n  }\n\n  refresh () {\n    const page = this.page\n    page.addr.value = ''\n    this.certPicker.clearCertFile()\n    Doc.hide(page.err)\n    if (this.knownExchanges.length === 0 || this.dexToUpdate) {\n      Doc.show(page.customBox, page.auth)\n      Doc.hide(page.showCustom, page.knownXCs, page.pickServerMsg, page.addCustomMsg)\n    } else {\n      Doc.hide(page.customBox)\n      Doc.show(page.showCustom)\n    }\n    for (const div of this.knownExchanges) div.classList.remove('selected')\n    this.showOrHideSubmitBttn()\n  }\n\n  /**\n   * Show or hide appPWBox depending on if password is required. Show the\n   * submit button if connecting a custom server or password is required).\n   */\n  showOrHideSubmitBttn () {\n    const page = this.page\n    Doc.setVis(Doc.isDisplayed(page.customBox), page.auth)\n  }\n\n  skipRegistration () : boolean {\n    return this.page.skipRegistration.checked ?? false\n  }\n\n  /* Just a small size tweak and fade-in. */\n  async animate () {\n    const form = this.form\n    Doc.animate(550, prog => {\n      form.style.transform = `scale(${0.9 + 0.1 * prog})`\n      form.style.opacity = String(Math.pow(prog, 4))\n    }, 'easeOut')\n  }\n\n  async checkDEX (addr?: string) {\n    const page = this.page\n    Doc.hide(page.err)\n    addr = addr || page.addr.value\n    if (addr === '') {\n      page.err.textContent = intl.prep(intl.ID_EMPTY_DEX_ADDRESS_MSG)\n      Doc.show(page.err)\n      return\n    }\n    const cert = await this.certPicker.file()\n    const skipRegistration = this.skipRegistration()\n    let endpoint : string, req: any\n    if (this.dexToUpdate) {\n      endpoint = '/api/updatedexhost'\n      req = {\n        newHost: addr,\n        cert: cert,\n        oldHost: this.dexToUpdate\n      }\n    } else {\n      endpoint = skipRegistration ? '/api/adddex' : '/api/discoveracct'\n      req = {\n        addr: addr,\n        cert: cert\n      }\n    }\n\n    const loaded = app().loading(this.form)\n    const res = await postJSON(endpoint, req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      if (String(res.msg).includes('certificate required')) {\n        Doc.show(page.needCert)\n      } else {\n        page.err.textContent = res.msg\n        Doc.show(page.err)\n      }\n      return\n    }\n    await app().fetchUser()\n    if (!this.dexToUpdate && (skipRegistration || res.paid || Object.keys(res.xc.auth.pendingBonds).length > 0)) {\n      await app().loadPage('markets')\n      return\n    }\n    this.success(res.xc, cert)\n  }\n}\n\n/* DiscoverAccountForm performs account discovery for a pre-selected DEX. */\nexport class DiscoverAccountForm {\n  form: HTMLElement\n  addr: string\n  success: (xc: Exchange) => void\n  page: Record<string, PageElement>\n\n  constructor (form: HTMLElement, addr: string, success: (xc: Exchange) => void) {\n    this.form = form\n    this.addr = addr\n    this.success = success\n\n    const page = this.page = Doc.parseTemplate(form)\n    page.dexHost.textContent = addr\n    bind(form, page.submit, () => this.checkDEX())\n  }\n\n  /* Just a small size tweak and fade-in. */\n  async animate () {\n    const form = this.form\n    Doc.animate(550, prog => {\n      form.style.transform = `scale(${0.9 + 0.1 * prog})`\n      form.style.opacity = String(Math.pow(prog, 4))\n    }, 'easeOut')\n  }\n\n  async checkDEX () {\n    const page = this.page\n    Doc.hide(page.err)\n    const req = {\n      addr: this.addr\n    }\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/discoveracct', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.err.textContent = res.msg\n      Doc.show(page.err)\n      return\n    }\n    if (res.paid) {\n      await app().fetchUser()\n      await app().loadPage('markets')\n      return\n    }\n    this.success(res.xc)\n  }\n}\n\n/* LoginForm is used to sign into the app. */\nexport class LoginForm {\n  form: HTMLElement\n  success: () => void\n  page: Record<string, PageElement>\n\n  constructor (form: HTMLElement, success: () => void) {\n    this.success = success\n    this.form = form\n    const page = this.page = Doc.parseTemplate(form)\n    bind(form, page.submit, () => { this.submit() })\n    app().registerNoteFeeder({\n      login: (note: CoreNote) => { this.handleLoginNote(note) }\n    })\n  }\n\n  handleLoginNote (n: CoreNote) {\n    if (n.details === '') return\n    const loginMsg = Doc.idel(this.form, 'loaderMsg')\n    Doc.show(loginMsg)\n    if (loginMsg) loginMsg.textContent = n.details\n  }\n\n  focus () {\n    this.page.pw.focus()\n  }\n\n  refresh () {\n    Doc.hide(this.page.errMsg)\n    this.page.pw.value = ''\n  }\n\n  async submit () {\n    const page = this.page\n    Doc.hide(page.errMsg)\n    const pw = page.pw.value || ''\n    if (pw === '') {\n      Doc.showFormError(page.errMsg, intl.prep(intl.ID_NO_PASS_ERROR_MSG))\n      return\n    }\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/login', { pass: pw })\n    loaded()\n    page.pw.value = ''\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.errMsg, res.msg)\n      return\n    }\n    await app().fetchUser()\n    res.notes = res.notes || []\n    res.notes.reverse()\n    res.pokes = res.pokes || []\n    app().loggedIn(res.notes, res.pokes)\n    this.success()\n  }\n\n  /* Just a small size tweak and fade-in. */\n  async animate () {\n    const form = this.form\n    Doc.animate(550, prog => {\n      form.style.transform = `scale(${0.9 + 0.1 * prog})`\n      form.style.opacity = String(Math.pow(prog, 4))\n    }, 'easeOut')\n  }\n}\n\nconst traitNewAddresser = 1 << 1\n\n/*\n * DepositAddress displays a deposit address, a QR code, and a button to\n * generate a new address (if supported).\n */\nexport class DepositAddress {\n  form: PageElement\n  page: Record<string, PageElement>\n  assetID: number\n\n  constructor (form: PageElement) {\n    this.form = form\n    const page = this.page = Doc.idDescendants(form)\n    Doc.cleanTemplates(page.unifiedReceiverTmpl)\n    Doc.bind(page.newDepAddrBttn, 'click', async () => { this.newDepositAddress() })\n    Doc.bind(page.copyAddressBtn, 'click', () => { this.copyAddress() })\n  }\n\n  /* Display a deposit address. */\n  async setAsset (assetID: number) {\n    this.assetID = assetID\n    const page = this.page\n    Doc.hide(page.depositErr, page.depositTokenMsgBox)\n    const asset = app().assets[assetID]\n    page.depositLogo.src = Doc.logoPath(asset.symbol)\n    const wallet = app().walletMap[assetID]\n    page.depositName.textContent = asset.unitInfo.conventional.unit\n    if (asset.token) {\n      const parentAsset = app().assets[asset.token.parentID]\n      page.depositTokenParentLogo.src = Doc.logoPath(parentAsset.symbol)\n      page.depositTokenParentName.textContent = parentAsset.name\n      Doc.show(page.depositTokenMsgBox)\n    }\n    Doc.setVis((wallet.traits & traitNewAddresser) !== 0, page.newDepAddrBttnBox)\n    this.setAddress(wallet.address)\n  }\n\n  setAddress (addr: string) {\n    const page = this.page\n    Doc.hide(page.unifiedReceivers)\n    if (addr.startsWith('unified:')) {\n      const receivers = JSON.parse(addr.substring('unified:'.length)) as Record<string, string>\n      Doc.empty(page.unifiedReceivers)\n      Doc.show(page.unifiedReceivers)\n      const defaultReceiverType = 'unified'\n      for (const [recvType, recv] of Object.entries(receivers)) {\n        const div = page.unifiedReceiverTmpl.cloneNode(true) as PageElement\n        page.unifiedReceivers.appendChild(div)\n        div.textContent = recvType\n        div.dataset.type = recvType\n        if (recvType === defaultReceiverType) div.classList.add('selected')\n        // tmpl.addr.textContent = recv\n        Doc.bind(div, 'click', () => {\n          for (const bttn of (Array.from(page.unifiedReceivers.children) as PageElement[])) bttn.classList.toggle('selected', bttn.dataset.type === recvType)\n          this.setCentralAddress(recv)\n        })\n      }\n      addr = receivers.unified\n    }\n\n    this.setCentralAddress(addr)\n  }\n\n  setCentralAddress (addr: string) {\n    const page = this.page\n    page.depositAddress.textContent = addr\n    page.qrcode.src = `/generateqrcode?address=${addr}`\n  }\n\n  /* Fetch a new address from the wallet. */\n  async newDepositAddress () {\n    const { page, assetID, form } = this\n    Doc.hide(page.depositErr)\n    const loaded = app().loading(form)\n    const res = await postJSON('/api/depositaddress', {\n      assetID: assetID\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.depositErr.textContent = res.msg\n      Doc.show(page.depositErr)\n      return\n    }\n    app().walletMap[assetID].address = res.address\n    this.setAddress(res.address)\n  }\n\n  async copyAddress () {\n    const page = this.page\n    navigator.clipboard.writeText(page.depositAddress.textContent || '')\n      .then(() => {\n        Doc.show(page.copyAlert)\n        setTimeout(() => {\n          Doc.hide(page.copyAlert)\n        }, 800)\n      })\n      .catch((reason) => {\n        console.error('Unable to copy: ', reason)\n      })\n  }\n}\n\n// AppPassResetForm is used to reset the app apssword using the app seed.\nexport class AppPassResetForm {\n  form: PageElement\n  page: Record<string, PageElement>\n  success: () => void\n\n  constructor (form: PageElement, success: () => void) {\n    this.form = form\n    this.success = success\n    const page = this.page = Doc.idDescendants(form)\n    bind(form, page.resetAppPWSubmitBtn, () => this.resetAppPW())\n  }\n\n  async resetAppPW () {\n    const page = this.page\n    const newAppPW = page.newAppPassword.value || ''\n    const confirmNewAppPW = page.confirmNewAppPassword.value\n    if (newAppPW === '') {\n      Doc.showFormError(page.appPWResetErrMsg, intl.prep(intl.ID_NO_PASS_ERROR_MSG))\n      return\n    }\n    if (newAppPW !== confirmNewAppPW) {\n      Doc.showFormError(page.appPWResetErrMsg, intl.prep(intl.ID_PASSWORD_NOT_MATCH))\n      return\n    }\n\n    const loaded = app().loading(this.form)\n    const res = await postJSON('/api/resetapppassword', {\n      newPass: newAppPW,\n      seed: page.seedInput.value\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.appPWResetErrMsg, res.msg)\n      return\n    }\n\n    if (Doc.isDisplayed(page.appPWResetErrMsg)) Doc.hide(page.appPWResetErrMsg)\n    page.appPWResetSuccessMsg.textContent = intl.prep(intl.ID_PASSWORD_RESET_SUCCESS_MSG)\n    Doc.show(page.appPWResetSuccessMsg)\n    setTimeout(() => this.success(), 3000) // allow time to view the message\n  }\n\n  focus () {\n    this.page.newAppPassword.focus()\n  }\n\n  refresh () {\n    const page = this.page\n    page.newAppPassword.value = ''\n    page.confirmNewAppPassword.value = ''\n    page.seedInput.value = ''\n    Doc.hide(page.appPWResetSuccessMsg, page.appPWResetErrMsg)\n  }\n}\n\nexport class CertificatePicker {\n  page: Record<string, PageElement>\n\n  constructor (parent: PageElement) {\n    const page = this.page = Doc.parseTemplate(parent)\n    page.selectedCert.textContent = intl.prep(intl.ID_NONE_SELECTED)\n    Doc.bind(page.certFile, 'change', () => this.onCertFileChange())\n    Doc.bind(page.removeCert, 'click', () => this.clearCertFile())\n    Doc.bind(page.addCert, 'click', () => page.certFile.click())\n  }\n\n  /**\n   * onCertFileChange when the input certFile changed, read the file\n   * and setting cert name into text of selectedCert to display on the view\n   */\n  async onCertFileChange () {\n    const page = this.page\n    const files = page.certFile.files\n    if (!files || !files.length) return\n    page.selectedCert.textContent = files[0].name\n    Doc.show(page.removeCert)\n    Doc.hide(page.addCert)\n  }\n\n  /* clearCertFile cleanup certFile value and selectedCert text */\n  clearCertFile () {\n    const page = this.page\n    page.certFile.value = ''\n    page.selectedCert.textContent = intl.prep(intl.ID_NONE_SELECTED)\n    Doc.hide(page.removeCert)\n    Doc.show(page.addCert)\n  }\n\n  async file (): Promise<string> {\n    const page = this.page\n    if (page.certFile.value) {\n      const files = page.certFile.files\n      if (files && files.length) {\n        return await files[0].text()\n      }\n    }\n    return ''\n  }\n}\n\nexport class TokenApprovalForm {\n  page: Record<string, PageElement>\n  success?: () => void\n  assetID: number\n  parentID: number\n  txFee: number\n  host: string\n\n  constructor (parent: PageElement, success?: () => void) {\n    this.page = Doc.parseTemplate(parent)\n    this.success = success\n    Doc.bind(this.page.submit, 'click', () => { this.approve() })\n  }\n\n  async setAsset (assetID: number, host: string) {\n    this.assetID = assetID\n    this.host = host\n    const tokenAsset = app().assets[assetID]\n    const parentID = this.parentID = tokenAsset.token?.parentID as number\n    const { page } = this\n\n    Doc.show(page.submissionElements)\n    Doc.hide(page.txMsg, page.errMsg, page.addressBox, page.balanceBox, page.addressBox)\n\n    Doc.empty(page.tokenSymbol)\n    page.tokenSymbol.appendChild(Doc.symbolize(tokenAsset, true))\n    const protocolVersion = app().exchanges[host].assets[assetID].version\n    const res = await postJSON('/api/approvetokenfee', {\n      assetID: tokenAsset.id,\n      version: protocolVersion,\n      approving: true\n    })\n    if (!app().checkResponse(res)) {\n      page.errMsg.textContent = res.msg\n      Doc.show(page.errMsg)\n    } else {\n      const { unitInfo: ui, wallet: { address, balance: { available: avail } }, name: parentName } = app().assets[parentID]\n      const txFee = this.txFee = res.txFee as number\n      let feeText = `${Doc.formatCoinValue(txFee, ui)} ${ui.conventional.unit}`\n      const rate = app().fiatRatesMap[parentID]\n      if (rate) {\n        feeText += ` (${Doc.formatFiatConversion(txFee, rate, ui)} USD)`\n      }\n      page.feeEstimate.textContent = feeText\n      Doc.show(page.balanceBox)\n      page.balance.textContent = Doc.formatCoinValue(avail, ui)\n      page.parentTicker.textContent = ui.conventional.unit\n      page.parentName.textContent = parentName\n      if (avail < txFee) {\n        Doc.show(page.addressBox)\n        page.address.textContent = address\n      }\n    }\n  }\n\n  /*\n   * approve calls the /api/approvetoken endpoint.\n   */\n  async approve () {\n    const { page, assetID, host, success } = this\n    const path = '/api/approvetoken'\n    const tokenAsset = app().assets[assetID]\n    const res = await postJSON(path, {\n      assetID: tokenAsset.id,\n      dexAddr: host\n    })\n    if (!app().checkResponse(res)) {\n      page.errMsg.textContent = res.msg\n      Doc.show(page.errMsg)\n      return\n    }\n    page.txid.innerText = res.txID\n    const assetExplorer = CoinExplorers[tokenAsset.id]\n    if (assetExplorer && assetExplorer[app().user.net]) {\n      page.txid.href = assetExplorer[app().user.net](res.txID)\n    }\n    Doc.hide(page.submissionElements, page.balanceBox, page.addressBox)\n    Doc.show(page.txMsg)\n    if (success) success()\n  }\n\n  handleBalanceNote (n: BalanceNote) {\n    const { page, parentID, txFee } = this\n    if (n.assetID !== parentID) return\n    page.balance.textContent = Doc.formatCoinValue(n.balance.available, app().assets[parentID].unitInfo)\n    if (n.balance.available >= txFee) {\n      Doc.hide(page.addressBox)\n    } else Doc.hide(page.errMsg)\n  }\n}\n\nexport class CEXConfigurationForm {\n  form: PageElement\n  page: Record<string, PageElement>\n  updated: (cexName: string, success: boolean) => void\n  cexName: string\n\n  constructor (form: PageElement, updated: (cexName: string, success: boolean) => void) {\n    this.form = form\n    this.updated = updated\n    this.page = Doc.parseTemplate(form)\n    Doc.bind(this.page.cexSubmit, 'click', () => this.submit())\n  }\n\n  setCEX (cexName: string) {\n    this.cexName = cexName\n    setCexElements(this.form, cexName)\n    const page = this.page\n    Doc.hide(page.cexConfigPrompt, page.cexConnectErrBox, page.cexFormErr)\n    page.cexApiKeyInput.value = ''\n    page.cexSecretInput.value = ''\n    const cexStatus = app().mmStatus.cexes[cexName]\n    const connectErr = cexStatus?.connectErr\n    if (connectErr) {\n      Doc.show(page.cexConnectErrBox)\n      page.cexConnectErr.textContent = connectErr\n      page.cexApiKeyInput.value = cexStatus.config.apiKey\n      page.cexSecretInput.value = cexStatus.config.apiSecret\n    } else {\n      Doc.show(page.cexConfigPrompt)\n    }\n  }\n\n  /*\n  * handleCEXSubmit handles clicks on the CEX configuration submission button.\n  */\n  async submit () {\n    const { page, cexName, form } = this\n    Doc.hide(page.cexFormErr)\n    const apiKey = page.cexApiKeyInput.value\n    const apiSecret = page.cexSecretInput.value\n    if (!apiKey || !apiSecret) {\n      Doc.show(page.cexFormErr)\n      page.cexFormErr.textContent = intl.prep(intl.ID_NO_PASS_ERROR_MSG)\n      return\n    }\n    const loaded = app().loading(form)\n    try {\n      const res = await MM.updateCEXConfig({\n        name: cexName,\n        apiKey: apiKey,\n        apiSecret: apiSecret\n      })\n      if (!app().checkResponse(res)) throw res\n      this.updated(cexName, true)\n    } catch (e) {\n      Doc.show(page.cexFormErr)\n      page.cexFormErr.textContent = intl.prep(intl.ID_API_ERROR, { msg: e.msg ?? String(e) })\n      this.updated(cexName, false)\n    } finally {\n      loaded()\n    }\n  }\n}\n\nconst animationLength = 300\n\n/* Swap form1 for form2 with an animation. */\nexport async function slideSwap (form1: HTMLElement, form2: HTMLElement) {\n  const shift = document.body.offsetWidth / 2\n  await Doc.animate(animationLength, progress => {\n    form1.style.right = `${progress * shift}px`\n  }, 'easeInHard')\n  Doc.hide(form1)\n  form1.style.right = '0'\n  form2.style.right = String(-shift)\n  Doc.show(form2)\n  if (form2.querySelector('input')) {\n    Doc.safeSelector(form2, 'input').focus()\n  }\n  await Doc.animate(animationLength, progress => {\n    form2.style.right = `${-shift + progress * shift}px`\n  }, 'easeOutHard')\n  form2.style.right = '0'\n}\n\nexport function showSuccess (page: Record<string, PageElement>, msg: string) {\n  page.successMessage.textContent = msg\n  Doc.show(page.forms, page.checkmarkForm)\n  page.checkmarkForm.style.right = '0'\n  page.checkmark.style.fontSize = '0px'\n\n  const [startR, startG, startB] = State.isDark() ? [223, 226, 225] : [51, 51, 51]\n  const [endR, endG, endB] = [16, 163, 16]\n  const [diffR, diffG, diffB] = [endR - startR, endG - startG, endB - startB]\n\n  return new Animation(1200, (prog: number) => {\n    page.checkmark.style.fontSize = `${prog * 80}px`\n    page.checkmark.style.color = `rgb(${startR + prog * diffR}, ${startG + prog * diffG}, ${startB + prog * diffB})`\n  }, 'easeOutElastic')\n}\n\n/*\n * bind binds the click and submit events and prevents page reloading on\n * submission.\n */\nexport function bind (form: HTMLElement, submitBttn: HTMLElement, handler: (e: Event) => void) {\n  const wrapper = (e: Event) => {\n    if (e.preventDefault) e.preventDefault()\n    handler(e)\n  }\n  Doc.bind(submitBttn, 'click', wrapper)\n  Doc.bind(form, 'submit', wrapper)\n}\n\n// isTruthyString will be true if the provided string is recognized as a\n// value representing true.\nfunction isTruthyString (s: string) {\n  return s === '1' || s.toLowerCase() === 'true'\n}\n\n// toUnixDate converts a javascript date object to a unix date, which is\n// the number of *seconds* since the start of the epoch.\nfunction toUnixDate (date: Date) {\n  return Math.floor(date.getTime() / 1000)\n}\n\n// dateApplyOffset shifts a date by the timezone offset. This is used to make\n// UTC dates show the local date. This can be used to prepare a Date so\n// toISOString generates a local date string. This is also used to trick an html\n// input element to show the local date when setting the valueAsDate field. When\n// reading the date back to JS, the value field should be interpreted as local\n// using the \"T00:00\" suffix, or the Date in valueAsDate should be shifted in\n// the opposite direction.\nfunction dateApplyOffset (date: Date) {\n  return new Date(date.getTime() - date.getTimezoneOffset() * 60 * 1000)\n}\n\n// dateToString converts a javascript date object to a YYYY-MM-DD format string,\n// in the local time zone.\nfunction dateToString (date: Date) {\n  return dateApplyOffset(date).toISOString().split('T')[0]\n  // Another common hack:\n  // date.toLocaleString(\"sv-SE\", { year: \"numeric\", month: \"2-digit\", day: \"2-digit\" })\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport { postJSON } from './http'\nimport {\n  NewWalletForm,\n  DEXAddressForm,\n  DiscoverAccountForm,\n  ConfirmRegistrationForm,\n  FeeAssetSelectionForm,\n  WalletWaitForm,\n  slideSwap\n} from './forms'\nimport {\n  app,\n  Exchange,\n  PageElement,\n  PrepaidBondID\n} from './registry'\n\ninterface RegistrationPageData {\n  host: string\n  backTo?: string\n}\n\nexport default class RegistrationPage extends BasePage {\n  body: HTMLElement\n  data: RegistrationPageData\n  xc: Exchange\n  page: Record<string, PageElement>\n  dexAddrForm: DEXAddressForm\n  discoverAcctForm: DiscoverAccountForm\n  newWalletForm: NewWalletForm\n  regAssetForm: FeeAssetSelectionForm\n  walletWaitForm: WalletWaitForm\n  confirmRegisterForm: ConfirmRegistrationForm\n\n  constructor (body: HTMLElement, data: RegistrationPageData) {\n    super()\n    this.body = body\n    this.data = data\n    const page = this.page = Doc.idDescendants(body)\n\n    if (data.host && page.dexAddrForm.classList.contains('selected')) {\n      page.dexAddrForm.classList.remove('selected')\n      page.discoverAcctForm.classList.add('selected')\n      page.discoverAcctForm.dataset.host = data.host\n    }\n\n    // Hide the form closers for the registration process except for the\n    // password reset form closer.\n    for (const el of body.querySelectorAll('.form-closer')) if (el !== page.resetPassFormCloser) Doc.hide(el)\n\n    this.newWalletForm = new NewWalletForm(\n      page.newWalletForm,\n      assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier),\n      () => this.animateRegAsset(page.newWalletForm)\n    )\n\n    // ADD DEX\n    this.dexAddrForm = new DEXAddressForm(page.dexAddrForm, async (xc, certFile) => {\n      this.requestFeepayment(page.dexAddrForm, xc, certFile)\n    })\n\n    const addr = page.discoverAcctForm.dataset.host\n    if (addr) {\n      this.discoverAcctForm = new DiscoverAccountForm(page.discoverAcctForm, addr, async (xc) => {\n        this.requestFeepayment(page.discoverAcctForm, xc, '')\n      })\n    }\n\n    // SELECT REG ASSET\n    this.regAssetForm = new FeeAssetSelectionForm(page.regAssetForm, async (assetID: number, tier: number) => {\n      if (assetID === PrepaidBondID) {\n        this.registerDEXSuccess()\n        return\n      }\n      const asset = app().assets[assetID]\n      const wallet = asset.wallet\n      if (wallet) {\n        const bondAsset = this.xc.bondAssets[asset.symbol]\n        const bondsFeeBuffer = await this.getBondsFeeBuffer(assetID, page.regAssetForm)\n        this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer)\n        if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + bondsFeeBuffer) {\n          this.animateConfirmForm(page.regAssetForm)\n          return\n        }\n        this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier)\n        slideSwap(page.regAssetForm, page.walletWait)\n        return\n      }\n      this.confirmRegisterForm.tier = tier\n      this.newWalletForm.setAsset(assetID)\n      slideSwap(page.regAssetForm, page.newWalletForm)\n    })\n\n    this.walletWaitForm = new WalletWaitForm(page.walletWait, () => {\n      this.animateConfirmForm(page.walletWait)\n    }, () => { this.animateRegAsset(page.walletWait) })\n\n    // SUBMIT DEX REGISTRATION\n    this.confirmRegisterForm = new ConfirmRegistrationForm(page.confirmRegForm, () => {\n      this.registerDEXSuccess()\n    }, () => {\n      this.animateRegAsset(page.confirmRegForm)\n    })\n\n    const currentForm = Doc.safeSelector(page.forms, ':scope > form.selected')\n    currentForm.classList.remove('selected')\n    switch (currentForm) {\n      case page.dexAddrForm:\n        this.dexAddrForm.animate()\n        break\n      case page.discoverAcctForm:\n        this.discoverAcctForm.animate()\n    }\n    Doc.show(currentForm)\n\n    // There's nothing on the page.discoverAcctForm except to receive user pass\n    // before attempting to discover user account and there's no need to have\n    // them click another button when we can carry on without user interaction.\n    if (currentForm === page.discoverAcctForm) {\n      this.discoverAcctForm.page.submit.click()\n    }\n\n    if (app().authed) this.auth()\n  }\n\n  // auth should be called once user is known to be authed with the server.\n  async auth () {\n    await app().fetchUser()\n  }\n\n  async requestFeepayment (oldForm: HTMLElement, xc: Exchange, certFile: string) {\n    this.xc = xc\n    this.confirmRegisterForm.setExchange(xc, certFile)\n    this.walletWaitForm.setExchange(xc)\n    this.regAssetForm.setExchange(xc, certFile)\n    this.animateRegAsset(oldForm)\n  }\n\n  /* Swap in the asset selection form and run the animation. */\n  async animateRegAsset (oldForm: HTMLElement) {\n    Doc.hide(oldForm)\n    this.regAssetForm.animate()\n    Doc.show(this.page.regAssetForm)\n  }\n\n  /* Swap in the confirmation form and run the animation. */\n  async animateConfirmForm (oldForm: HTMLElement) {\n    this.confirmRegisterForm.animate()\n    Doc.hide(oldForm)\n    Doc.show(this.page.confirmRegForm)\n  }\n\n  // Retrieve an estimate for the tx fee needed to create new bond reserves.\n  async getBondsFeeBuffer (assetID: number, form: HTMLElement) {\n    const loaded = app().loading(form)\n    const res = await postJSON('/api/bondsfeebuffer', { assetID })\n    loaded()\n    if (!app().checkResponse(res)) {\n      return 0\n    }\n    return res.feeBuffer\n  }\n\n  /* gets the contents of the cert file */\n  async getCertFile () {\n    let cert = ''\n    if (this.dexAddrForm.page.certFile.value) {\n      const files = this.dexAddrForm.page.certFile.files\n      if (files && files.length) cert = await files[0].text()\n    }\n    return cert\n  }\n\n  /* Called after successful registration to a DEX. */\n  async registerDEXSuccess () {\n    await app().fetchUser()\n    app().updateMenuItemsDisplay()\n    await app().loadPage(this.data.backTo || 'markets')\n  }\n\n  async newWalletCreated (assetID: number, tier: number) {\n    this.regAssetForm.refresh()\n    const user = await app().fetchUser()\n    if (!user) return\n    const page = this.page\n    const asset = user.assets[assetID]\n    const wallet = asset.wallet\n    const bondAmt = this.xc.bondAssets[asset.symbol].amount\n\n    const bondsFeeBuffer = await this.getBondsFeeBuffer(assetID, page.newWalletForm)\n    this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier)\n    this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer)\n    if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {\n      await this.animateConfirmForm(page.newWalletForm)\n      return\n    }\n\n    await slideSwap(page.newWalletForm, page.walletWait)\n  }\n}\n","import { PageElement, app } from './registry'\nimport Doc from './doc'\nimport BasePage from './basepage'\nimport { AppPassResetForm, LoginForm, slideSwap } from './forms'\n\n/*\n  LoginPage holds the form for login and password reset.\n*/\nexport default class LoginPage extends BasePage {\n  loginForm: LoginForm\n  page: Record<string, PageElement>\n  appPassResetForm: AppPassResetForm\n\n  constructor (body: HTMLElement) {\n    super()\n    const page = this.page = Doc.idDescendants(body)\n    this.loginForm = new LoginForm(page.loginForm, () => { this.loggedIn() })\n\n    const prepAndDisplayLoginForm = () => {\n      Doc.hide(page.resetAppPWForm)\n      this.loginForm.refresh()\n      Doc.show(page.loginForm)\n      this.loginForm.focus()\n    }\n    prepAndDisplayLoginForm()\n\n    this.appPassResetForm = new AppPassResetForm(page.resetAppPWForm, () => { prepAndDisplayLoginForm() })\n    Doc.bind(page.forgotPassBtn, 'click', () => {\n      this.appPassResetForm.refresh()\n      slideSwap(page.loginForm, page.resetAppPWForm)\n    })\n    Doc.bind(page.resetPassFormCloser, 'click', () => { prepAndDisplayLoginForm() })\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, page.resetAppPWForm) && Doc.isDisplayed(page.resetAppPWForm)) { prepAndDisplayLoginForm() }\n    })\n  }\n\n  /* login submits the sign-in form and parses the result. */\n  async loggedIn () {\n    await app().loadPage('wallets')\n  }\n}\n","import Doc, { Animation, AniToggle, parseFloatDefault, setupCopyBtn } from './doc'\nimport BasePage from './basepage'\nimport { postJSON, Errors } from './http'\nimport {\n  NewWalletForm,\n  WalletConfigForm,\n  DepositAddress,\n  bind as bindForm,\n  showSuccess\n} from './forms'\nimport State from './state'\nimport * as intl from './locales'\nimport * as OrderUtil from './orderutil'\nimport {\n  app,\n  PageElement,\n  SupportedAsset,\n  WalletDefinition,\n  BalanceNote,\n  WalletStateNote,\n  WalletSyncNote,\n  RateNote,\n  Order,\n  OrderFilter,\n  WalletCreationNote,\n  BaseWalletNote,\n  WalletNote,\n  CustomWalletNote,\n  TipChangeNote,\n  Exchange,\n  Market,\n  PeerSource,\n  WalletPeer,\n  ApprovalStatus,\n  WalletState,\n  UnitInfo,\n  TicketStakingStatus,\n  VotingServiceProvider,\n  Ticket,\n  TicketStats,\n  TxHistoryResult,\n  TransactionNote,\n  WalletTransaction,\n  FeeState\n} from './registry'\nimport { CoinExplorers } from './coinexplorers'\n\ninterface DecredTicketTipUpdate {\n  ticketPrice: number\n  votingSubsidy: number\n  stats: TicketStats\n}\n\ninterface TicketPurchaseUpdate extends BaseWalletNote {\n  err?: string\n  remaining:number\n  tickets?: Ticket[]\n  stats?: TicketStats\n}\n\nconst animationLength = 300\nconst traitRescanner = 1\nconst traitLogFiler = 1 << 2\nconst traitRecoverer = 1 << 5\nconst traitWithdrawer = 1 << 6\nconst traitRestorer = 1 << 8\nconst traitTxFeeEstimator = 1 << 9\nconst traitPeerManager = 1 << 10\nconst traitTokenApprover = 1 << 13\nconst traitTicketBuyer = 1 << 15\nconst traitHistorian = 1 << 16\nconst traitFundsMixer = 1 << 17\n\nconst traitsExtraOpts = traitLogFiler | traitRecoverer | traitRestorer | traitRescanner | traitPeerManager | traitTokenApprover\n\nexport const ticketStatusUnknown = 0\nexport const ticketStatusUnmined = 1\nexport const ticketStatusImmature = 2\nexport const ticketStatusLive = 3\nexport const ticketStatusVoted = 4\nexport const ticketStatusMissed = 5\nexport const ticketStatusExpired = 6\nexport const ticketStatusUnspent = 7\nexport const ticketStatusRevoked = 8\n\nexport const ticketStatusTranslationKeys = [\n  intl.ID_TICKET_STATUS_UNKNOWN,\n  intl.ID_TICKET_STATUS_UNMINED,\n  intl.ID_TICKET_STATUS_IMMATURE,\n  intl.ID_TICKET_STATUS_LIVE,\n  intl.ID_TICKET_STATUS_VOTED,\n  intl.ID_TICKET_STATUS_MISSED,\n  intl.ID_TICKET_STATUS_EXPIRED,\n  intl.ID_TICKET_STATUS_UNSPENT,\n  intl.ID_TICKET_STATUS_REVOKED\n]\n\nexport const txTypeUnknown = 0\nexport const txTypeSend = 1\nexport const txTypeReceive = 2\nexport const txTypeSwap = 3\nexport const txTypeRedeem = 4\nexport const txTypeRefund = 5\nexport const txTypeSplit = 6\nexport const txTypeCreateBond = 7\nexport const txTypeRedeemBond = 8\nexport const txTypeApproveToken = 9\nexport const txTypeAcceleration = 10\nexport const txTypeSelfSend = 11\nexport const txTypeRevokeTokenApproval = 12\nexport const txTypeTicketPurchase = 13\nexport const txTypeTicketVote = 14\nexport const txTypeTicketRevocation = 15\nexport const txTypeSwapOrSend = 16\nexport const txTypeMixing = 17\n\nconst positiveTxTypes : number[] = [\n  txTypeReceive,\n  txTypeRedeem,\n  txTypeRefund,\n  txTypeRedeemBond,\n  txTypeTicketVote,\n  txTypeTicketRevocation\n]\n\nconst negativeTxTypes : number[] = [\n  txTypeSend,\n  txTypeSwap,\n  txTypeCreateBond,\n  txTypeTicketPurchase,\n  txTypeSwapOrSend\n]\n\nconst noAmtTxTypes : number[] = [\n  txTypeSplit,\n  txTypeApproveToken,\n  txTypeAcceleration,\n  txTypeRevokeTokenApproval\n]\n\nfunction txTypeSignAndClass (txType: number): [string, string] {\n  if (positiveTxTypes.includes(txType)) return ['+', 'positive-tx']\n  if (negativeTxTypes.includes(txType)) return ['-', 'negative-tx']\n  return ['', '']\n}\n\nconst txTypeTranslationKeys = [\n  intl.ID_TX_TYPE_UNKNOWN,\n  intl.ID_TX_TYPE_SEND,\n  intl.ID_TX_TYPE_RECEIVE,\n  intl.ID_TX_TYPE_SWAP,\n  intl.ID_TX_TYPE_REDEEM,\n  intl.ID_TX_TYPE_REFUND,\n  intl.ID_TX_TYPE_SPLIT,\n  intl.ID_TX_TYPE_CREATE_BOND,\n  intl.ID_TX_TYPE_REDEEM_BOND,\n  intl.ID_TX_TYPE_APPROVE_TOKEN,\n  intl.ID_TX_TYPE_ACCELERATION,\n  intl.ID_TX_TYPE_SELF_TRANSFER,\n  intl.ID_TX_TYPE_REVOKE_TOKEN_APPROVAL,\n  intl.ID_TX_TYPE_TICKET_PURCHASE,\n  intl.ID_TX_TYPE_TICKET_VOTE,\n  intl.ID_TX_TYPE_TICKET_REVOCATION,\n  intl.ID_TX_TYPE_SWAP_OR_SEND,\n  intl.ID_TX_TYPE_MIX\n]\n\nexport function txTypeString (txType: number) : string {\n  return intl.prep(txTypeTranslationKeys[txType])\n}\n\nconst ticketPageSize = 10\nconst scanStartMempool = -1\n\ninterface ReconfigRequest {\n  assetID: number\n  walletType: string\n  config: Record<string, string>\n  newWalletPW?: string\n}\n\ninterface RescanRecoveryRequest {\n  assetID: number\n  appPW?: string\n  force?: boolean\n}\n\ninterface WalletRestoration {\n  target: string\n  seed: string\n  seedName: string\n  instructions: string\n}\n\ninterface AssetButton {\n  tmpl: Record<string, PageElement>\n  bttn: PageElement\n}\n\ninterface TicketPagination {\n  number: number\n  history: Ticket[]\n  scanned: boolean // Reached the end of history. All tickets cached.\n}\n\ninterface WalletsPageData {\n  goBack?: string\n}\n\ninterface reconfigSettings {\n  skipAnimation?: boolean\n  elevateProviders?: boolean\n}\n\nlet net = 0\n\nexport default class WalletsPage extends BasePage {\n  body: HTMLElement\n  data?: WalletsPageData\n  page: Record<string, PageElement>\n  assetButtons: Record<number, AssetButton>\n  newWalletForm: NewWalletForm\n  reconfigForm: WalletConfigForm\n  walletCfgGuide: PageElement\n  depositAddrForm: DepositAddress\n  keyup: (e: KeyboardEvent) => void\n  changeWalletPW: boolean\n  displayed: HTMLElement\n  animation: Animation\n  forms: PageElement[]\n  forceReq: RescanRecoveryRequest\n  forceUrl: string\n  currentForm: PageElement\n  restoreInfoCard: HTMLElement\n  selectedAssetID: number\n  stakeStatus: TicketStakingStatus\n  maxSend: number\n  unapprovingTokenVersion: number\n  ticketPage: TicketPagination\n  oldestTx: WalletTransaction | undefined\n  currTx: WalletTransaction | undefined\n  mixing: boolean\n  mixerToggle: AniToggle\n  stampers: PageElement[]\n  secondTicker: number\n\n  constructor (body: HTMLElement, data?: WalletsPageData) {\n    super()\n    this.body = body\n    this.data = data\n    const page = this.page = Doc.idDescendants(body)\n    this.stampers = []\n    net = app().user.net\n\n    const setStamp = () => {\n      for (const span of this.stampers) {\n        if (span.dataset.stamp) {\n          span.textContent = Doc.timeSince(parseInt(span.dataset.stamp || '') * 1000)\n        }\n      }\n    }\n    this.secondTicker = window.setInterval(() => {\n      setStamp()\n    }, 10000) // update every 10 seconds\n\n    Doc.cleanTemplates(page.restoreInfoCard, page.connectedIconTmpl, page.disconnectedIconTmpl, page.removeIconTmpl)\n    this.restoreInfoCard = page.restoreInfoCard.cloneNode(true) as HTMLElement\n    Doc.show(page.connectedIconTmpl, page.disconnectedIconTmpl, page.removeIconTmpl)\n\n    this.forms = Doc.applySelector(page.forms, ':scope > form')\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { this.closePopups() })\n    })\n    Doc.bind(page.cancelForce, 'click', () => { this.closePopups() })\n\n    this.selectedAssetID = -1\n    Doc.cleanTemplates(\n      page.iconSelectTmpl, page.balanceDetailRow, page.recentOrderTmpl, page.vspRowTmpl,\n      page.ticketHistoryRowTmpl, page.votingChoiceTmpl, page.votingAgendaTmpl, page.tspendTmpl,\n      page.tkeyTmpl, page.txHistoryRowTmpl, page.txHistoryDateRowTmpl\n    )\n\n    Doc.bind(page.createWallet, 'click', () => this.showNewWallet(this.selectedAssetID))\n    Doc.bind(page.connectBttn, 'click', () => this.doConnect(this.selectedAssetID))\n    Doc.bind(page.send, 'click', () => this.showSendForm(this.selectedAssetID))\n    Doc.bind(page.receive, 'click', () => this.showDeposit(this.selectedAssetID))\n    Doc.bind(page.unlockBttn, 'click', () => this.openWallet(this.selectedAssetID))\n    Doc.bind(page.lockBttn, 'click', () => this.lock(this.selectedAssetID))\n    Doc.bind(page.reconfigureBttn, 'click', () => this.showReconfig(this.selectedAssetID))\n    Doc.bind(page.needsProviderBttn, 'click', () => this.showReconfig(this.selectedAssetID))\n    Doc.bind(page.rescanWallet, 'click', () => this.rescanWallet(this.selectedAssetID))\n    Doc.bind(page.earlierTxs, 'click', () => this.loadEarlierTxs())\n\n    Doc.bind(page.copyTxIDBtn, 'click', () => { setupCopyBtn(this.currTx?.id || '', page.txDetailsID, page.copyTxIDBtn, '#1e7d11') })\n    Doc.bind(page.copyRecipientBtn, 'click', () => { setupCopyBtn(this.currTx?.recipient || '', page.txDetailsRecipient, page.copyRecipientBtn, '#1e7d11') })\n    Doc.bind(page.copyBondIDBtn, 'click', () => { setupCopyBtn(this.currTx?.bondInfo?.bondID || '', page.txDetailsBondID, page.copyBondIDBtn, '#1e7d11') })\n    Doc.bind(page.copyBondAccountIDBtn, 'click', () => { setupCopyBtn(this.currTx?.bondInfo?.accountID || '', page.txDetailsBondAccountID, page.copyBondAccountIDBtn, '#1e7d11') })\n    Doc.bind(page.hideMixTxsCheckbox, 'change', () => { this.showTxHistory(this.selectedAssetID) })\n\n    // Bind the new wallet form.\n    this.newWalletForm = new NewWalletForm(page.newWalletForm, (assetID: number) => {\n      const fmtParams = { assetName: app().assets[assetID].name }\n      this.assetUpdated(assetID, page.newWalletForm, intl.prep(intl.ID_NEW_WALLET_SUCCESS, fmtParams))\n      this.sortAssetButtons()\n      this.updateTicketBuyer(assetID)\n      this.updatePrivacy(assetID)\n    })\n\n    // Bind the wallet reconfig form.\n    this.reconfigForm = new WalletConfigForm(page.reconfigInputs, false)\n\n    this.walletCfgGuide = Doc.tmplElement(page.reconfigForm, 'walletCfgGuide')\n\n    // Bind the send form.\n    bindForm(page.sendForm, page.submitSendForm, async () => { this.stepSend() })\n    // Send confirmation form.\n    bindForm(page.vSendForm, page.vSend, async () => { this.send() })\n    // Bind the wallet reconfiguration submission.\n    bindForm(page.reconfigForm, page.submitReconfig, () => this.reconfig())\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => this.closePopups())\n    })\n\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) { this.closePopups() }\n    })\n\n    this.mixerToggle = new AniToggle(page.toggleMixer, page.mixingErr, false, (newState: boolean) => { return this.updateMixerState(newState) })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        if (Doc.isDisplayed(this.page.forms)) this.closePopups()\n      }\n    }\n    Doc.bind(document, 'keyup', this.keyup)\n\n    Doc.bind(page.downloadLogs, 'click', async () => { this.downloadLogs() })\n    Doc.bind(page.exportWallet, 'click', async () => { this.displayExportWalletAuth() })\n    Doc.bind(page.recoverWallet, 'click', async () => { this.showRecoverWallet() })\n    bindForm(page.exportWalletAuth, page.exportWalletAuthSubmit, async () => { this.exportWalletAuthSubmit() })\n    bindForm(page.recoverWalletConfirm, page.recoverWalletSubmit, () => { this.recoverWallet() })\n    bindForm(page.confirmForce, page.confirmForceSubmit, async () => { this.confirmForceSubmit() })\n    Doc.bind(page.disableWallet, 'click', async () => { this.showToggleWalletStatus(true) })\n    Doc.bind(page.enableWallet, 'click', async () => { this.showToggleWalletStatus(false) })\n    bindForm(page.toggleWalletStatusConfirm, page.toggleWalletStatusSubmit, async () => { this.toggleWalletStatus() })\n    Doc.bind(page.managePeers, 'click', async () => { this.showManagePeersForm() })\n    Doc.bind(page.addPeerSubmit, 'click', async () => { this.submitAddPeer() })\n    Doc.bind(page.unapproveTokenAllowance, 'click', async () => { this.showUnapproveTokenAllowanceTableForm() })\n    Doc.bind(page.unapproveTokenSubmit, 'click', async () => { this.submitUnapproveTokenAllowance() })\n    Doc.bind(page.showVSPs, 'click', () => { this.showVSPPicker() })\n    Doc.bind(page.vspDisplay, 'click', () => { this.showVSPPicker() })\n    bindForm(page.vspPicker, page.customVspSubmit, async () => { this.setCustomVSP() })\n    Doc.bind(page.purchaseTicketsBttn, 'click', () => { this.showPurchaseTicketsDialog() })\n    bindForm(page.purchaseTicketsForm, page.purchaserSubmit, () => { this.purchaseTickets() })\n    Doc.bind(page.purchaserInput, 'change', () => { this.purchaserInputChanged() })\n    Doc.bind(page.ticketHistory, 'click', () => { this.showTicketHistory() })\n    Doc.bind(page.ticketHistoryNextPage, 'click', () => { this.nextTicketPage() })\n    Doc.bind(page.ticketHistoryPrevPage, 'click', () => { this.prevTicketPage() })\n    Doc.bind(page.setVotes, 'click', () => { this.showSetVotesDialog() })\n    Doc.bind(page.purchaseTicketsErrCloser, 'click', () => { Doc.hide(page.purchaseTicketsErrBox) })\n    Doc.bind(page.privacyInfoBttn, 'click', () => { this.showForm(page.mixingInfo) })\n\n    // New deposit address button.\n    this.depositAddrForm = new DepositAddress(page.deposit)\n\n    // Clicking on the available amount on the Send form populates the\n    // amount field.\n    Doc.bind(page.walletBal, 'click', () => { this.populateMaxSend() })\n\n    // Display fiat value for current send amount.\n    Doc.bind(page.sendAmt, 'input', () => {\n      const { unitInfo: ui } = app().assets[this.selectedAssetID]\n      const amt = parseFloatDefault(page.sendAmt.value)\n      const conversionFactor = ui.conventional.conversionFactor\n      Doc.showFiatValue(page.sendValue, amt * conversionFactor, app().fiatRatesMap[this.selectedAssetID], ui)\n    })\n\n    // Clicking on maxSend on the send form should populate the amount field.\n    Doc.bind(page.maxSend, 'click', () => { this.populateMaxSend() })\n\n    // Validate send address on input.\n    Doc.bind(page.sendAddr, 'input', async () => {\n      const asset = app().assets[this.selectedAssetID]\n      page.sendAddr.classList.remove('border-danger', 'border-success')\n      const addr = page.sendAddr.value || ''\n      if (!asset || addr === '') return\n      const valid = await this.validateSendAddress(addr, asset.id)\n      if (valid) page.sendAddr.classList.add('border-success')\n      else page.sendAddr.classList.add('border-danger')\n    })\n\n    // A link on the wallet reconfiguration form to show/hide the password field.\n    Doc.bind(page.showChangePW, 'click', () => {\n      this.changeWalletPW = !this.changeWalletPW\n      this.setPWSettingViz(this.changeWalletPW)\n    })\n\n    // Changing the type of wallet.\n    Doc.bind(page.changeWalletTypeSelect, 'change', () => {\n      this.changeWalletType()\n    })\n    Doc.bind(page.showChangeType, 'click', () => {\n      if (Doc.isHidden(page.changeWalletType)) {\n        Doc.show(page.changeWalletType, page.changeTypeHideIcon)\n        Doc.hide(page.changeTypeShowIcon)\n        page.changeTypeMsg.textContent = intl.prep(intl.ID_KEEP_WALLET_TYPE)\n      } else this.showReconfig(this.selectedAssetID, { skipAnimation: true })\n    })\n\n    app().registerNoteFeeder({\n      fiatrateupdate: (note: RateNote) => { this.handleRatesNote(note) },\n      balance: (note: BalanceNote) => { this.handleBalanceNote(note) },\n      walletstate: (note: WalletStateNote) => { this.handleWalletStateNote(note) },\n      walletconfig: (note: WalletStateNote) => { this.handleWalletStateNote(note) },\n      walletsync: (note: WalletSyncNote) => { this.updateSyncAndPeers(note.assetID) },\n      createwallet: (note: WalletCreationNote) => { this.handleCreateWalletNote(note) },\n      walletnote: (note: WalletNote) => { this.handleCustomWalletNote(note) }\n    })\n\n    const firstAsset = this.sortAssetButtons()\n    let selectedAsset = firstAsset.id\n    const assetIDStr = State.fetchLocal(State.selectedAssetLK)\n    if (assetIDStr) selectedAsset = Number(assetIDStr)\n    this.setSelectedAsset(selectedAsset)\n\n    setInterval(() => {\n      for (const row of this.page.txHistoryTableBody.children) {\n        const age = Doc.tmplElement(row as PageElement, 'age')\n        age.textContent = Doc.timeSince(parseInt(age.dataset.timestamp as string))\n      }\n    }, 5000)\n  }\n\n  closePopups () {\n    Doc.hide(this.page.forms)\n    this.currTx = undefined\n    if (this.animation) this.animation.stop()\n  }\n\n  async safePost (path: string, args: any): Promise<any> {\n    const assetID = this.selectedAssetID\n    const res = await postJSON(path, args)\n    if (assetID !== this.selectedAssetID) throw Error('asset changed during request. aborting')\n    return res\n  }\n\n  // stepSend makes a request to get an estimated fee and displays the confirm\n  // send form.\n  async stepSend () {\n    const page = this.page\n    Doc.hide(page.vSendErr, page.sendErr, page.vSendEstimates, page.txFeeNotAvailable)\n    const assetID = parseInt(page.sendForm.dataset.assetID || '')\n    const token = app().assets[assetID].token\n    const subtract = page.subtractCheckBox.checked || false\n    const conversionFactor = app().unitInfo(assetID).conventional.conversionFactor\n    const value = Math.round(parseFloatDefault(page.sendAmt.value, 0) * conversionFactor)\n    const addr = page.sendAddr.value || ''\n    if (addr === '') return Doc.showFormError(page.sendErr, intl.prep(intl.ID_INVALID_ADDRESS_MSG, { address: addr }))\n    const { wallet, unitInfo: ui, symbol } = app().assets[assetID]\n\n    // txfee will not be available if wallet is not a fee estimator or the\n    // request failed.\n    let txfee = 0\n    if ((wallet.traits & traitTxFeeEstimator) !== 0) {\n      const open = {\n        addr: page.sendAddr.value,\n        assetID: assetID,\n        subtract: subtract,\n        value: value\n      }\n\n      const loaded = app().loading(page.sendForm)\n      const res = await postJSON('/api/txfee', open)\n      loaded()\n      if (!app().checkResponse(res)) {\n        page.txFeeNotAvailable.dataset.tooltip = intl.prep(intl.ID_TXFEE_ERR_MSG, { err: res.msg })\n        Doc.show(page.txFeeNotAvailable)\n        // We still want to ensure user address is valid before proceeding to send\n        // confirm form if there's an error while calculating the transaction fee.\n        const valid = await this.validateSendAddress(addr, assetID)\n        if (!valid) return Doc.showFormError(page.sendErr, intl.prep(intl.ID_INVALID_ADDRESS_MSG, { address: addr || '' }))\n      } else if (res.ok) {\n        if (!res.validaddress) return Doc.showFormError(page.sendErr, intl.prep(intl.ID_INVALID_ADDRESS_MSG, { address: page.sendAddr.value || '' }))\n        txfee = res.txfee\n        Doc.show(page.vSendEstimates)\n      }\n    } else {\n      // Validate only the send address for assets that are not fee estimators.\n      const valid = await this.validateSendAddress(addr, assetID)\n      if (!valid) return Doc.showFormError(page.sendErr, intl.prep(intl.ID_INVALID_ADDRESS_MSG, { address: addr || '' }))\n    }\n\n    page.vSendSymbol.textContent = symbol.toUpperCase()\n    page.vSendLogo.src = Doc.logoPath(symbol)\n\n    if (token) {\n      const { unitInfo: feeUI, symbol: feeSymbol } = app().assets[token.parentID]\n      page.vSendFee.textContent = Doc.formatFullPrecision(txfee, feeUI) + ' ' + feeSymbol\n    } else {\n      page.vSendFee.textContent = Doc.formatFullPrecision(txfee, ui)\n    }\n    const xcRate = app().fiatRatesMap[assetID]\n    Doc.showFiatValue(page.vSendFeeFiat, txfee, xcRate, ui)\n    page.vSendDestinationAmt.textContent = Doc.formatFullPrecision(value - txfee, ui)\n    page.vTotalSend.textContent = Doc.formatFullPrecision(value, ui)\n    Doc.showFiatValue(page.vTotalSendFiat, value, xcRate, ui)\n    page.vSendAddr.textContent = page.sendAddr.value || ''\n    const bal = wallet.balance.available - value\n    page.balanceAfterSend.textContent = Doc.formatFullPrecision(bal, ui)\n    Doc.showFiatValue(page.balanceAfterSendFiat, bal, xcRate, ui)\n    Doc.show(page.approxSign)\n    // NOTE: All tokens take this route because they cannot pay the fee.\n    if (!subtract) {\n      Doc.hide(page.approxSign)\n      page.vSendDestinationAmt.textContent = Doc.formatFullPrecision(value, ui)\n      let totalSend = value\n      if (!token) totalSend += txfee\n      page.vTotalSend.textContent = Doc.formatFullPrecision(totalSend, ui)\n      Doc.showFiatValue(page.vTotalSendFiat, totalSend, xcRate, ui)\n      let bal = wallet.balance.available - value\n      if (!token) bal -= txfee\n      // handle edge cases where bal is not enough to cover totalSend.\n      // we don't want a minus display of user bal.\n      if (bal <= 0) {\n        page.balanceAfterSend.textContent = Doc.formatFullPrecision(0, ui)\n        Doc.showFiatValue(page.balanceAfterSendFiat, 0, xcRate, ui)\n      } else {\n        page.balanceAfterSend.textContent = Doc.formatFullPrecision(bal, ui)\n        Doc.showFiatValue(page.balanceAfterSendFiat, bal, xcRate, ui)\n      }\n    }\n    Doc.hide(page.sendForm)\n    await this.showForm(page.vSendForm)\n  }\n\n  // cancelSend displays the send form if user wants to make modification.\n  async cancelSend () {\n    const page = this.page\n    Doc.hide(page.vSendForm, page.sendErr)\n    await this.showForm(page.sendForm)\n  }\n\n  /*\n   * validateSendAddress validates the provided address for an asset.\n   */\n  async validateSendAddress (addr: string, assetID: number): Promise<boolean> {\n    const resp = await postJSON('/api/validateaddress', { addr: addr, assetID: assetID })\n    return app().checkResponse(resp)\n  }\n\n  /*\n   * setPWSettingViz sets the visibility of the password field section.\n   */\n  setPWSettingViz (visible: boolean) {\n    const page = this.page\n    if (visible) {\n      Doc.hide(page.showIcon)\n      Doc.show(page.hideIcon, page.changePW)\n      page.switchPWMsg.textContent = intl.prep(intl.ID_KEEP_WALLET_PASS)\n      return\n    }\n    Doc.hide(page.hideIcon, page.changePW)\n    Doc.show(page.showIcon)\n    page.switchPWMsg.textContent = intl.prep(intl.ID_NEW_WALLET_PASS)\n  }\n\n  /*\n   * assetVersionUsedByDEXes returns a map of the versions of the\n   * currently selected asset to the DEXes that use that version.\n   */\n  assetVersionUsedByDEXes (): Record<number, string[]> {\n    const assetID = this.selectedAssetID\n    const versionToDEXes = {} as Record<number, string[]>\n    const exchanges = app().exchanges\n\n    for (const host in exchanges) {\n      const exchange = exchanges[host]\n      const exchangeAsset = exchange.assets[assetID]\n      if (!exchangeAsset) continue\n      if (!versionToDEXes[exchangeAsset.version]) {\n        versionToDEXes[exchangeAsset.version] = []\n      }\n      versionToDEXes[exchangeAsset.version].push(exchange.host)\n    }\n\n    return versionToDEXes\n  }\n\n  /*\n   * submitUnapproveTokenAllowance submits a request to the server to\n   * unapprove a version of the currently selected token's swap contract.\n   */\n  async submitUnapproveTokenAllowance () {\n    const page = this.page\n    const path = '/api/unapprovetoken'\n    const res = await postJSON(path, {\n      assetID: this.selectedAssetID,\n      version: this.unapprovingTokenVersion\n    })\n    if (!app().checkResponse(res)) {\n      page.unapproveTokenErr.textContent = res.msg\n      Doc.show(page.unapproveTokenErr)\n      return\n    }\n\n    const assetExplorer = CoinExplorers[this.selectedAssetID]\n    if (assetExplorer && assetExplorer[net]) {\n      page.unapproveTokenTxID.href = assetExplorer[net](res.txID)\n    }\n    page.unapproveTokenTxID.textContent = res.txID\n    Doc.hide(page.unapproveTokenSubmissionElements, page.unapproveTokenErr)\n    Doc.show(page.unapproveTokenTxMsg)\n  }\n\n  /*\n   * showUnapproveTokenAllowanceForm displays the form for unapproving\n   * a specific version of the currently selected token's swap contract.\n   */\n  async showUnapproveTokenAllowanceForm (version: number) {\n    const page = this.page\n    this.unapprovingTokenVersion = version\n    Doc.show(page.unapproveTokenSubmissionElements)\n    Doc.hide(page.unapproveTokenTxMsg, page.unapproveTokenErr)\n    const asset = app().assets[this.selectedAssetID]\n    if (!asset || !asset.token) return\n    const parentAsset = app().assets[asset.token.parentID]\n    if (!parentAsset) return\n    Doc.empty(page.tokenAllowanceRemoveSymbol)\n    page.tokenAllowanceRemoveSymbol.appendChild(Doc.symbolize(asset, true))\n    page.tokenAllowanceRemoveVersion.textContent = version.toString()\n\n    const path = '/api/approvetokenfee'\n    const res = await postJSON(path, {\n      assetID: this.selectedAssetID,\n      version: version,\n      approving: false\n    })\n    if (!app().checkResponse(res)) {\n      page.unapproveTokenErr.textContent = res.msg\n      Doc.show(page.unapproveTokenErr)\n    } else {\n      let feeText = `${Doc.formatCoinValue(res.txFee, parentAsset.unitInfo)} ${parentAsset.unitInfo.conventional.unit}`\n      const rate = app().fiatRatesMap[parentAsset.id]\n      if (rate) {\n        feeText += ` (${Doc.formatFiatConversion(res.txFee, rate, parentAsset.unitInfo)} USD)`\n      }\n      page.unapprovalFeeEstimate.textContent = feeText\n    }\n    this.showForm(page.unapproveTokenForm)\n  }\n\n  /*\n   * showUnapproveTokenAllowanceTableForm displays a table showing each of the\n   * versions of a token's swap contract that have been approved and allows the\n   * user to unapprove any of them.\n   */\n  async showUnapproveTokenAllowanceTableForm () {\n    const page = this.page\n    const asset = app().assets[this.selectedAssetID]\n    if (!asset || !asset.wallet || !asset.wallet.approved) return\n    while (page.tokenVersionBody.firstChild) {\n      page.tokenVersionBody.removeChild(page.tokenVersionBody.firstChild)\n    }\n    Doc.empty(page.tokenVersionTableAssetSymbol)\n    page.tokenVersionTableAssetSymbol.appendChild(Doc.symbolize(asset, true))\n    const versionToDEXes = this.assetVersionUsedByDEXes()\n\n    let showTable = false\n    for (let i = 0; i <= asset.wallet.version; i++) {\n      const approvalStatus = asset.wallet.approved[i]\n      if (approvalStatus === undefined || approvalStatus !== ApprovalStatus.Approved) {\n        continue\n      }\n      showTable = true\n      const row = page.tokenVersionRow.cloneNode(true) as PageElement\n      const tmpl = Doc.parseTemplate(row)\n      tmpl.version.textContent = i.toString()\n      if (versionToDEXes[i]) {\n        tmpl.usedBy.textContent = versionToDEXes[i].join(', ')\n      }\n      const removeIcon = this.page.removeIconTmpl.cloneNode(true)\n      Doc.bind(removeIcon, 'click', () => {\n        this.showUnapproveTokenAllowanceForm(i)\n      })\n      tmpl.remove.appendChild(removeIcon)\n      page.tokenVersionBody.appendChild(row)\n    }\n    Doc.setVis(showTable, page.tokenVersionTable)\n    Doc.setVis(!showTable, page.tokenVersionNone)\n    this.showForm(page.unapproveTokenTableForm)\n  }\n\n  /*\n   * updateWalletPeers retrieves the wallet peers and displays them in the\n   * wallet peers table.\n   */\n  async updateWalletPeersTable () {\n    const page = this.page\n\n    Doc.hide(page.peerSpinner)\n\n    const res = await postJSON('/api/getwalletpeers', {\n      assetID: this.selectedAssetID\n    })\n    if (!app().checkResponse(res)) {\n      page.managePeersErr.textContent = res.msg\n      Doc.show(page.managePeersErr)\n      return\n    }\n\n    while (page.peersTableBody.firstChild) {\n      page.peersTableBody.removeChild(page.peersTableBody.firstChild)\n    }\n\n    const peers : WalletPeer[] = res.peers || []\n    peers.sort((a: WalletPeer, b: WalletPeer) : number => {\n      return a.source - b.source\n    })\n\n    const defaultText = intl.prep(intl.ID_DEFAULT)\n    const addedText = intl.prep(intl.ID_ADDED)\n    const discoveredText = intl.prep(intl.ID_DISCOVERED)\n\n    peers.forEach((peer: WalletPeer) => {\n      const row = page.peerTableRow.cloneNode(true) as PageElement\n      const tmpl = Doc.parseTemplate(row)\n\n      tmpl.addr.textContent = peer.addr\n\n      switch (peer.source) {\n        case PeerSource.WalletDefault:\n          tmpl.source.textContent = defaultText\n          break\n        case PeerSource.UserAdded:\n          tmpl.source.textContent = addedText\n          break\n        case PeerSource.Discovered:\n          tmpl.source.textContent = discoveredText\n          break\n      }\n\n      let connectionIcon\n      if (peer.connected) {\n        connectionIcon = this.page.connectedIconTmpl.cloneNode(true)\n      } else {\n        connectionIcon = this.page.disconnectedIconTmpl.cloneNode(true)\n      }\n      tmpl.connected.appendChild(connectionIcon)\n\n      if (peer.source === PeerSource.UserAdded) {\n        const removeIcon = this.page.removeIconTmpl.cloneNode(true)\n        Doc.bind(removeIcon, 'click', async () => {\n          Doc.hide(page.managePeersErr)\n          const res = await postJSON('/api/removewalletpeer', {\n            assetID: this.selectedAssetID,\n            addr: peer.addr\n          })\n          if (!app().checkResponse(res)) {\n            page.managePeersErr.textContent = res.msg\n            Doc.show(page.managePeersErr)\n            return\n          }\n          this.spinUntilPeersUpdate()\n        })\n        tmpl.remove.appendChild(removeIcon)\n      }\n\n      page.peersTableBody.appendChild(row)\n    })\n  }\n\n  // showManagePeersForm displays the manage peers form.\n  async showManagePeersForm () {\n    const page = this.page\n    await this.updateWalletPeersTable()\n    Doc.hide(page.managePeersErr)\n    this.showForm(page.managePeersForm)\n  }\n\n  // submitAddPeers sends a request for the the wallet to connect to a new\n  // peer.\n  async submitAddPeer () {\n    const page = this.page\n    Doc.hide(page.managePeersErr)\n    const res = await postJSON('/api/addwalletpeer', {\n      assetID: this.selectedAssetID,\n      addr: page.addPeerInput.value\n    })\n    if (!app().checkResponse(res)) {\n      page.managePeersErr.textContent = res.msg\n      Doc.show(page.managePeersErr)\n      return\n    }\n    this.spinUntilPeersUpdate()\n    page.addPeerInput.value = ''\n  }\n\n  /*\n   * spinUntilPeersUpdate will show the spinner on the manage peers fork.\n   * If it is still showing after 10 seconds, the peers table will be updated\n   * instead of waiting for a notification.\n   */\n  async spinUntilPeersUpdate () {\n    const page = this.page\n    Doc.show(page.peerSpinner)\n    setTimeout(() => {\n      if (Doc.isDisplayed(page.peerSpinner)) {\n        this.updateWalletPeersTable()\n      }\n    }, 10000)\n  }\n\n  /*\n   * showToggleWalletStatus displays the toggleWalletStatusConfirm form with\n   * relevant help message.\n   */\n  showToggleWalletStatus (disable: boolean) {\n    const page = this.page\n    Doc.hide(page.toggleWalletStatusErr, page.walletStatusDisable, page.disableWalletMsg, page.walletStatusEnable, page.enableWalletMsg)\n    if (disable) Doc.show(page.walletStatusDisable, page.disableWalletMsg)\n    else Doc.show(page.walletStatusEnable, page.enableWalletMsg)\n    this.showForm(page.toggleWalletStatusConfirm)\n  }\n\n  /*\n   * toggleWalletStatus toggles a wallets status to either disabled or enabled.\n   */\n  async toggleWalletStatus () {\n    const page = this.page\n    Doc.hide(page.toggleWalletStatusErr)\n\n    const asset = app().assets[this.selectedAssetID]\n    const disable = !asset.wallet.disabled\n    const url = '/api/togglewalletstatus'\n    const req = {\n      assetID: this.selectedAssetID,\n      disable: disable\n    }\n\n    const fmtParams = { assetName: asset.name }\n    const loaded = app().loading(page.toggleWalletStatusConfirm)\n    const res = await postJSON(url, req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      if (res.code === Errors.activeOrdersErr) page.toggleWalletStatusErr.textContent = intl.prep(intl.ID_ACTIVE_ORDERS_ERR_MSG, fmtParams)\n      else page.toggleWalletStatusErr.textContent = res.msg\n      Doc.show(page.toggleWalletStatusErr)\n      return\n    }\n\n    let successMsg = intl.prep(intl.ID_WALLET_DISABLED_MSG, fmtParams)\n    if (!disable) successMsg = intl.prep(intl.ID_WALLET_ENABLED_MSG, fmtParams)\n    this.assetUpdated(this.selectedAssetID, page.toggleWalletStatusConfirm, successMsg)\n  }\n\n  /*\n   * showBox shows the box with a fade-in animation.\n   */\n  async showBox (box: HTMLElement, focuser?: PageElement) {\n    box.style.opacity = '0'\n    Doc.show(box)\n    if (focuser) focuser.focus()\n    await Doc.animate(animationLength, progress => {\n      box.style.opacity = `${progress}`\n    }, 'easeOut')\n    box.style.opacity = '1'\n    this.displayed = box\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: PageElement) {\n    const page = this.page\n    this.currentForm = form\n    this.forms.forEach(form => Doc.hide(form))\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  async showSuccess (msg: string) {\n    this.forms.forEach(form => Doc.hide(form))\n    this.currentForm = this.page.checkmarkForm\n    this.animation = showSuccess(this.page, msg)\n    await this.animation.wait()\n    this.animation = new Animation(1500, () => { /* pass */ }, '', () => {\n      if (this.currentForm === this.page.checkmarkForm) this.closePopups()\n    })\n  }\n\n  /* Show the new wallet form. */\n  async showNewWallet (assetID: number) {\n    const page = this.page\n    const box = page.newWalletForm\n    this.newWalletForm.setAsset(assetID)\n    const defaultsLoaded = this.newWalletForm.loadDefaults()\n    await this.showForm(box)\n    await defaultsLoaded\n  }\n\n  // sortAssetButtons displays supported assets, sorted. Returns first asset in the\n  // list.\n  sortAssetButtons (): SupportedAsset {\n    const page = this.page\n    this.assetButtons = {}\n    Doc.empty(page.assetSelect)\n    const sortedAssets = [...Object.values(app().assets)]\n    sortedAssets.sort((a: SupportedAsset, b: SupportedAsset) => {\n      if (a.wallet && !b.wallet) return -1\n      if (!a.wallet && b.wallet) return 1\n      if (!a.wallet && !b.wallet) return a.symbol === 'dcr' ? -1 : 1\n      const [aBal, bBal] = [a.wallet.balance, b.wallet.balance]\n      const [aTotal, bTotal] = [aBal.available + aBal.immature + aBal.locked, bBal.available + bBal.immature + bBal.locked]\n      if (aTotal === 0 && bTotal === 0) return a.symbol.localeCompare(b.symbol)\n      else if (aTotal === 0) return 1\n      else if (aTotal === 0) return -1\n      const [aFiat, bFiat] = [app().fiatRatesMap[a.id], app().fiatRatesMap[b.id]]\n      if (aFiat && !bFiat) return -1\n      if (!aFiat && bFiat) return 1\n      return bFiat * bTotal - aFiat * aTotal\n    })\n    for (const a of sortedAssets) {\n      const bttn = page.iconSelectTmpl.cloneNode(true) as HTMLElement\n      page.assetSelect.appendChild(bttn)\n      const tmpl = Doc.parseTemplate(bttn)\n      this.assetButtons[a.id] = { tmpl, bttn }\n      this.updateAssetButton(a.id)\n      Doc.bind(bttn, 'click', () => {\n        this.setSelectedAsset(a.id)\n        State.storeLocal(State.selectedAssetLK, String(a.id))\n      })\n    }\n    page.assetSelect.classList.remove('invisible')\n    return sortedAssets[0]\n  }\n\n  updateAssetButton (assetID: number) {\n    const a = app().assets[assetID]\n    const { bttn, tmpl } = this.assetButtons[assetID]\n    Doc.hide(tmpl.fiatBox, tmpl.noWallet)\n    bttn.classList.add('nowallet')\n    tmpl.img.src ||= Doc.logoPath(a.symbol) // don't initiate GET if already set (e.g. update on some notification)\n    const symbolParts = a.symbol.split('.')\n    if (symbolParts.length === 2) {\n      const parentSymbol = symbolParts[1]\n      tmpl.parentImg.classList.remove('d-hide')\n      tmpl.parentImg.src ||= Doc.logoPath(parentSymbol)\n    }\n    if (this.selectedAssetID === assetID) bttn.classList.add('selected')\n    tmpl.name.textContent = a.name\n    if (a.wallet) {\n      bttn.classList.remove('nowallet')\n      const { wallet: { balance: b }, unitInfo: ui } = a\n      const totalBalance = b.available + b.locked + b.immature\n      const [s, unit] = Doc.formatBestUnitsFourSigFigs(totalBalance, ui)\n      tmpl.balance.textContent = s\n      tmpl.unit.textContent = unit\n      Doc.show(tmpl.balanceBox)\n      const fiatRate = app().fiatRatesMap[a.id]\n      if (fiatRate) {\n        Doc.show(tmpl.fiatBox)\n        tmpl.fiat.textContent = Doc.formatFourSigFigs(totalBalance / ui.conventional.conversionFactor * fiatRate)\n      }\n    } else Doc.show(tmpl.noWallet)\n  }\n\n  async setSelectedAsset (assetID: number) {\n    const { assetSelect } = this.page\n    for (const b of assetSelect.children) b.classList.remove('selected')\n    this.assetButtons[assetID].bttn.classList.add('selected')\n    this.selectedAssetID = assetID\n    this.page.hideMixTxsCheckbox.checked = true\n    this.updateDisplayedAsset(assetID)\n    this.showAvailableMarkets(assetID)\n    const a = this.showRecentActivity(assetID)\n    const b = this.showTxHistory(assetID)\n    const c = this.updateTicketBuyer(assetID)\n    const d = this.updatePrivacy(assetID)\n    for (const p of [a, b, c, d]) await p\n  }\n\n  updateDisplayedAsset (assetID: number) {\n    if (assetID !== this.selectedAssetID) return\n    const { symbol, wallet, name, token, unitInfo } = app().assets[assetID]\n    const { page, body } = this\n    Doc.setText(body, '[data-asset-name]', name)\n    Doc.setText(body, '[data-ticker]', unitInfo.conventional.unit)\n    page.assetLogo.src = Doc.logoPath(symbol)\n    Doc.hide(\n      page.balanceBox, page.fiatBalanceBox, page.createWallet, page.walletDetails,\n      page.sendReceive, page.connectBttnBox, page.statusLocked, page.statusReady,\n      page.statusOff, page.unlockBttnBox, page.lockBttnBox, page.connectBttnBox,\n      page.peerCountBox, page.syncProgressBox, page.statusDisabled, page.tokenInfoBox,\n      page.needsProviderBox, page.feeStateBox, page.txSyncBox, page.txProgress,\n      page.txFindingAddrs\n    )\n    this.checkNeedsProvider(assetID)\n    if (token) {\n      const parentAsset = app().assets[token.parentID]\n      page.tokenParentLogo.src = Doc.logoPath(parentAsset.symbol)\n      page.tokenParentName.textContent = parentAsset.name\n      page.contractAddress.textContent = token.contractAddress\n      Doc.show(page.tokenInfoBox)\n    }\n    if (wallet) {\n      this.updateDisplayedAssetBalance()\n      const { feeState, running, disabled, type: walletType } = wallet\n\n      const walletDef = app().walletDefinition(assetID, walletType)\n      page.walletType.textContent = walletDef.tab\n      if (feeState) this.updateFeeState(feeState)\n      if (disabled) Doc.show(page.statusDisabled) // wallet is disabled\n      else if (running) {\n        this.updateSyncAndPeers(wallet.assetID)\n      } else Doc.show(page.statusOff, page.connectBttnBox) // wallet not running\n    } else Doc.show(page.createWallet) // no wallet\n\n    page.walletDetailsBox.classList.remove('invisible')\n  }\n\n  updateSyncAndPeers (assetID: number) {\n    const { page, selectedAssetID } = this\n    if (assetID !== selectedAssetID) return\n    const { peerCount, syncProgress, syncStatus, encrypted, open, running } = app().walletMap[assetID]\n    if (!running) return\n    Doc.show(page.sendReceive, page.peerCountBox, page.syncProgressBox)\n    page.peerCount.textContent = String(peerCount)\n    page.syncProgress.textContent = `${(syncProgress * 100).toFixed(1)}%`\n    if (open) {\n      Doc.show(page.statusReady)\n      if (!app().haveActiveOrders(assetID) && encrypted) Doc.show(page.lockBttnBox)\n    } else Doc.show(page.statusLocked, page.unlockBttnBox) // wallet not unlocked\n    Doc.setVis(syncStatus.txs !== undefined, page.txSyncBox)\n    if (syncStatus.txs !== undefined) {\n      Doc.hide(page.txProgress, page.txFindingAddrs)\n      if (syncStatus.txs === 0 && syncStatus.blocks >= syncStatus.targetHeight) Doc.show(page.txFindingAddrs)\n      else {\n        Doc.show(page.txProgress)\n        const prog = syncStatus.txs / syncStatus.targetHeight\n        page.txProgress.textContent = `${(prog * 100).toFixed(1)}%`\n      }\n    }\n  }\n\n  updateFeeState (feeState: FeeState) {\n    const { page, selectedAssetID: assetID } = this\n    Doc.hide(page.feeStateBox)\n    const { unitInfo: ui, token } = app().assets[assetID]\n    const fiatRate = app().fiatRatesMap[assetID]\n    if (!fiatRate) return\n    const feeAssetID = token ? token.parentID : assetID\n    const feeFiatRate = app().fiatRatesMap[feeAssetID]\n    if (token && !feeFiatRate) return\n    Doc.show(page.feeStateBox)\n    const feeUI = token ? app().assets[token.parentID].unitInfo : ui\n    Doc.formatBestRateElement(page.feeStateNetRate, feeAssetID, feeState.rate, feeUI)\n    Doc.formatBestValueElement(page.feeStateSendFees, feeAssetID, feeState.send, feeUI)\n    Doc.formatBestValueElement(page.feeStateSwapFees, feeAssetID, feeState.swap, feeUI)\n    Doc.formatBestValueElement(page.feeStateRedeemFees, feeAssetID, feeState.redeem, feeUI)\n    page.feeStateXcRate.textContent = Doc.formatFourSigFigs(fiatRate)\n    const sendFiat = feeState.send / feeUI.conventional.conversionFactor * feeFiatRate\n    page.feeStateSendFiat.textContent = Doc.formatFourSigFigs(sendFiat)\n    const swapFiat = feeState.swap / feeUI.conventional.conversionFactor * feeFiatRate\n    page.feeStateSwapFiat.textContent = Doc.formatFourSigFigs(swapFiat)\n    const redeemFiat = feeState.redeem / feeUI.conventional.conversionFactor * feeFiatRate\n    page.feeStateRedeemFiat.textContent = Doc.formatFourSigFigs(redeemFiat)\n    Doc.show(page.feeStateBox)\n  }\n\n  async checkNeedsProvider (assetID: number) {\n    const needs = await app().needsCustomProvider(assetID)\n    const { page: { needsProviderBox: box, needsProviderBttn: bttn } } = this\n    Doc.setVis(needs, box)\n    if (!needs) return\n    Doc.blink(bttn)\n  }\n\n  async updateTicketBuyer (assetID: number) {\n    this.ticketPage = {\n      number: 0,\n      history: [],\n      scanned: false\n    }\n    const { wallet, unitInfo: ui } = app().assets[assetID]\n    const page = this.page\n    Doc.hide(\n      page.stakingBox, page.pickVSP, page.stakingSummary, page.stakingErr,\n      page.vspDisplayBox, page.ticketPriceBox, page.purchaseTicketsBox,\n      page.stakingRpcSpvMsg, page.ticketsDisabled\n    )\n    if (!wallet?.running || (wallet.traits & traitTicketBuyer) === 0) return\n    Doc.show(page.stakingBox)\n    const loaded = app().loading(page.stakingBox)\n    const res = await this.safePost('/api/stakestatus', assetID)\n    loaded()\n    if (!app().checkResponse(res)) {\n      // Look for common error for RPC + SPV wallet.\n      if (res.msg.includes('disconnected from consensus RPC')) {\n        Doc.show(page.stakingRpcSpvMsg)\n        return\n      }\n      Doc.show(page.stakingErr)\n      page.stakingErr.textContent = res.msg\n      return\n    }\n    Doc.show(page.stakingSummary, page.ticketPriceBox)\n    const stakeStatus = res.status as TicketStakingStatus\n    this.stakeStatus = stakeStatus\n    page.stakingAgendaCount.textContent = String(stakeStatus.stances.agendas.length)\n    page.stakingTspendCount.textContent = String(stakeStatus.stances.tspends.length)\n    page.purchaserCurrentPrice.textContent = Doc.formatFourSigFigs(stakeStatus.ticketPrice / ui.conventional.conversionFactor)\n    page.purchaserBal.textContent = Doc.formatCoinValue(wallet.balance.available, ui)\n    this.updateTicketStats(stakeStatus.stats, ui, stakeStatus.ticketPrice, stakeStatus.votingSubsidy)\n    // If this is an extension wallet, we'll might to disable all controls.\n    const disableStaking = app().extensionWallet(this.selectedAssetID)?.disableStaking\n    if (disableStaking) {\n      Doc.hide(page.setVotes, page.showVSPs)\n      Doc.show(page.ticketsDisabled)\n      page.extensionModeAppName.textContent = app().user.extensionModeConfig.name\n      return\n    }\n\n    this.setVSPViz(stakeStatus.vsp)\n  }\n\n  setVSPViz (vsp: string) {\n    const { page, stakeStatus } = this\n    Doc.hide(page.vspDisplayBox)\n    if (vsp) {\n      Doc.show(page.vspDisplayBox, page.purchaseTicketsBox)\n      Doc.hide(page.pickVSP)\n      page.vspURL.textContent = vsp\n      return\n    }\n    Doc.setVis(!stakeStatus.isRPC, page.pickVSP)\n    Doc.setVis(stakeStatus.isRPC, page.purchaseTicketsBox)\n  }\n\n  updateTicketStats (stats: TicketStats, ui: UnitInfo, ticketPrice?: number, votingSubsidy?: number) {\n    const { page, stakeStatus } = this\n    stakeStatus.stats = stats\n    if (ticketPrice) stakeStatus.ticketPrice = ticketPrice\n    if (votingSubsidy) stakeStatus.votingSubsidy = votingSubsidy\n    const liveTicketCount = stakeStatus.tickets.filter((tkt: Ticket) => tkt.status <= ticketStatusLive && tkt.status >= ticketStatusUnmined).length\n    page.stakingTicketCount.textContent = String(liveTicketCount)\n    page.immatureTicketCount.textContent = String(stats.mempool)\n    Doc.setVis(stats.mempool > 0, page.immatureTicketCountBox)\n    page.queuedTicketCount.textContent = String(stats.queued)\n    page.formQueuedTix.textContent = String(stats.queued)\n    Doc.setVis(stats.queued > 0, page.formQueueTixBox, page.queuedTicketCountBox)\n    page.totalTicketCount.textContent = String(stats.ticketCount)\n    page.totalTicketRewards.textContent = Doc.formatFourSigFigs(stats.totalRewards / ui.conventional.conversionFactor)\n    page.totalTicketVotes.textContent = String(stats.votes)\n    if (ticketPrice) page.ticketPrice.textContent = Doc.formatFourSigFigs(ticketPrice / ui.conventional.conversionFactor)\n    if (votingSubsidy) page.votingSubsidy.textContent = Doc.formatFourSigFigs(votingSubsidy / ui.conventional.conversionFactor)\n  }\n\n  async showVSPPicker () {\n    const assetID = this.selectedAssetID\n    const page = this.page\n    this.showForm(page.vspPicker)\n    Doc.empty(page.vspPickerList)\n    Doc.hide(page.stakingErr)\n    const loaded = app().loading(page.vspPicker)\n    const res = await this.safePost('/api/listvsps', assetID)\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.show(page.stakingErr)\n      page.stakingErr.textContent = res.msg\n      return\n    }\n    const vsps = res.vsps as VotingServiceProvider[]\n    for (const vsp of vsps) {\n      const row = page.vspRowTmpl.cloneNode(true) as PageElement\n      page.vspPickerList.appendChild(row)\n      const tmpl = Doc.parseTemplate(row)\n      tmpl.url.textContent = vsp.url\n      tmpl.feeRate.textContent = vsp.feePercentage.toFixed(2)\n      tmpl.voting.textContent = String(vsp.voting)\n      Doc.bind(row, 'click', () => {\n        Doc.hide(page.stakingErr)\n        this.setVSP(assetID, vsp)\n      })\n    }\n  }\n\n  showPurchaseTicketsDialog () {\n    const page = this.page\n    page.purchaserInput.value = ''\n    Doc.hide(page.purchaserErr)\n    this.showForm(this.page.purchaseTicketsForm)\n    page.purchaserInput.focus()\n  }\n\n  purchaserInputChanged () {\n    const page = this.page\n    const n = parseInt(page.purchaserInput.value || '0')\n    if (n <= 1) {\n      page.purchaserInput.value = '1'\n      return\n    }\n    page.purchaserInput.value = String(n)\n  }\n\n  async purchaseTickets () {\n    const { page, selectedAssetID: assetID } = this\n    // DRAFT NOTE: The user will get an actual ticket count somewhere in the\n    // range 1 <= tickets_purchased <= n. See notes in\n    // (*spvWallet).PurchaseTickets.\n    // How do we handle this at the UI. Or do we handle it all in the backend\n    // somehow?\n    const n = parseInt(page.purchaserInput.value || '0')\n    if (n < 1) return\n    // TODO: Add confirmation dialog.\n    const loaded = app().loading(page.purchaseTicketsForm)\n    const res = await this.safePost('/api/purchasetickets', { assetID, n })\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.purchaserErr.textContent = res.msg\n      Doc.show(page.purchaserErr)\n      return\n    }\n    this.showSuccess(intl.prep(intl.ID_TICKETS_PURCHASED, { n: n.toLocaleString(Doc.languages()) }))\n  }\n\n  processTicketPurchaseUpdate (walletNote: CustomWalletNote) {\n    const { stakeStatus, selectedAssetID, page } = this\n    const { assetID } = walletNote\n    const { err, remaining, tickets, stats } = walletNote.payload as TicketPurchaseUpdate\n    if (assetID !== selectedAssetID) return\n    if (err) {\n      Doc.show(page.purchaseTicketsErrBox)\n      page.purchaseTicketsErr.textContent = err\n      return\n    }\n    if (tickets) stakeStatus.tickets = tickets.concat(stakeStatus.tickets)\n    if (stats) this.updateTicketStats(stats, app().assets[assetID].unitInfo)\n    stakeStatus.stats.queued = remaining\n    page.queuedTicketCount.textContent = String(remaining)\n    page.formQueuedTix.textContent = String(remaining)\n    Doc.setVis(remaining > 0, page.queuedTicketCountBox)\n  }\n\n  async setVSP (assetID: number, vsp: VotingServiceProvider) {\n    this.closePopups()\n    const page = this.page\n    const loaded = app().loading(page.stakingBox)\n    const res = await this.safePost('/api/setvsp', { assetID, url: vsp.url })\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.show(page.stakingErr)\n      page.stakingErr.textContent = res.msg\n      return\n    }\n    this.setVSPViz(vsp.url)\n  }\n\n  setCustomVSP () {\n    const assetID = this.selectedAssetID\n    const vsp = { url: this.page.customVspUrl.value } as VotingServiceProvider\n    this.setVSP(assetID, vsp)\n  }\n\n  pageOfTickets (pgNum: number) {\n    const { stakeStatus, ticketPage } = this\n    let startOffset = pgNum * ticketPageSize\n    const pageOfTickets: Ticket[] = []\n    if (startOffset < stakeStatus.tickets.length) {\n      pageOfTickets.push(...stakeStatus.tickets.slice(startOffset, startOffset + ticketPageSize))\n      if (pageOfTickets.length < ticketPageSize) {\n        const need = ticketPageSize - pageOfTickets.length\n        pageOfTickets.push(...ticketPage.history.slice(0, need))\n      }\n    } else {\n      startOffset -= stakeStatus.tickets.length\n      pageOfTickets.push(...ticketPage.history.slice(startOffset, startOffset + ticketPageSize))\n    }\n    return pageOfTickets\n  }\n\n  displayTicketPage (pageNumber: number, pageOfTickets: Ticket[]) {\n    const { page, selectedAssetID: assetID } = this\n    const ui = app().unitInfo(assetID)\n    const coinLink = CoinExplorers[assetID][app().user.net]\n    Doc.empty(page.ticketHistoryRows)\n    page.ticketHistoryPage.textContent = String(pageNumber)\n    for (const { tx, status } of pageOfTickets) {\n      const tr = page.ticketHistoryRowTmpl.cloneNode(true) as PageElement\n      page.ticketHistoryRows.appendChild(tr)\n      app().bindUrlHandlers(tr)\n      const tmpl = Doc.parseTemplate(tr)\n      tmpl.age.textContent = Doc.timeSince(tx.stamp * 1000)\n      tmpl.price.textContent = Doc.formatFullPrecision(tx.ticketPrice, ui)\n      tmpl.status.textContent = intl.prep(ticketStatusTranslationKeys[status])\n      tmpl.hashStart.textContent = tx.hash.slice(0, 6)\n      tmpl.hashEnd.textContent = tx.hash.slice(-6)\n      tmpl.detailsLinkUrl.setAttribute('href', coinLink(tx.hash))\n    }\n  }\n\n  async ticketPageN (pageNumber: number) {\n    const { page, stakeStatus, ticketPage, selectedAssetID: assetID } = this\n    const pageOfTickets = this.pageOfTickets(pageNumber)\n    if (pageOfTickets.length < ticketPageSize && !ticketPage.scanned) {\n      const n = ticketPageSize - pageOfTickets.length\n      const lastList = ticketPage.history.length > 0 ? ticketPage.history : stakeStatus.tickets\n      const scanStart = lastList.length > 0 ? lastList[lastList.length - 1].tx.blockHeight : scanStartMempool\n      const skipN = lastList.filter((tkt: Ticket) => tkt.tx.blockHeight === scanStart).length\n      const loaded = app().loading(page.ticketHistoryForm)\n      const res = await this.safePost('/api/ticketpage', { assetID, scanStart, n, skipN })\n      loaded()\n      if (!app().checkResponse(res)) {\n        console.error('error fetching ticket page', res.msg)\n        return\n      }\n      this.ticketPage.history.push(...res.tickets)\n      pageOfTickets.push(...res.tickets)\n      if (res.tickets.length < n) this.ticketPage.scanned = true\n    }\n\n    const totalTix = stakeStatus.tickets.length + ticketPage.history.length\n    Doc.setVis(totalTix >= ticketPageSize, page.ticketHistoryPagination)\n    Doc.setVis(totalTix > 0, page.ticketHistoryTable)\n    Doc.setVis(totalTix === 0, page.noTicketsMessage)\n    if (pageOfTickets.length === 0) {\n      // Probably ended with a page of size ticketPageSize, so didn't know we\n      // had hit the end until the user clicked the arrow and we went looking\n      // for the next. Would be good to figure out a way to hide the arrow in\n      // that case.\n      Doc.hide(page.ticketHistoryNextPage)\n      return\n    }\n    this.displayTicketPage(pageNumber, pageOfTickets)\n    ticketPage.number = pageNumber\n    const atEnd = pageNumber * ticketPageSize + pageOfTickets.length === totalTix\n    Doc.setVis(!atEnd || !ticketPage.scanned, page.ticketHistoryNextPage)\n    Doc.setVis(pageNumber > 0, page.ticketHistoryPrevPage)\n  }\n\n  async showTicketHistory () {\n    this.showForm(this.page.ticketHistoryForm)\n    await this.ticketPageN(this.ticketPage.number)\n  }\n\n  async nextTicketPage () {\n    await this.ticketPageN(this.ticketPage.number + 1)\n  }\n\n  async prevTicketPage () {\n    await this.ticketPageN(this.ticketPage.number - 1)\n  }\n\n  showSetVotesDialog () {\n    const { page, stakeStatus, selectedAssetID: assetID } = this\n    const ui = app().unitInfo(assetID)\n    Doc.hide(page.votingFormErr)\n    const coinLink = CoinExplorers[assetID][app().user.net]\n    const upperCase = (s: string) => s.charAt(0).toUpperCase() + s.slice(1)\n\n    const setVotes = async (req: any) => {\n      Doc.hide(page.votingFormErr)\n      const loaded = app().loading(page.votingForm)\n      const res = await this.safePost('/api/setvotes', req)\n      loaded()\n      if (!app().checkResponse(res)) {\n        Doc.show(page.votingFormErr)\n        page.votingFormErr.textContent = res.msg\n        throw Error(res.msg)\n      }\n    }\n\n    const setAgendaChoice = async (agendaID: string, choiceID: string) => {\n      await setVotes({ assetID, choices: { [agendaID]: choiceID } })\n      for (const agenda of stakeStatus.stances.agendas) if (agenda.id === agendaID) agenda.currentChoice = choiceID\n    }\n\n    Doc.empty(page.votingAgendas)\n    for (const agenda of stakeStatus.stances.agendas) {\n      const div = page.votingAgendaTmpl.cloneNode(true) as PageElement\n      page.votingAgendas.appendChild(div)\n      const tmpl = Doc.parseTemplate(div)\n      tmpl.description.textContent = agenda.description\n      for (const choice of agenda.choices) {\n        const div = page.votingChoiceTmpl.cloneNode(true) as PageElement\n        tmpl.choices.appendChild(div)\n        const choiceTmpl = Doc.parseTemplate(div)\n        choiceTmpl.id.textContent = upperCase(choice.id)\n        choiceTmpl.id.dataset.tooltip = choice.description\n        choiceTmpl.radio.value = choice.id\n        choiceTmpl.radio.name = agenda.id\n        Doc.bind(choiceTmpl.radio, 'change', () => {\n          if (!choiceTmpl.radio.checked) return\n          setAgendaChoice(agenda.id, choice.id)\n        })\n        if (choice.id === agenda.currentChoice) choiceTmpl.radio.checked = true\n      }\n      app().bindTooltips(tmpl.choices)\n    }\n\n    const setTspendVote = async (txHash: string, policyID: string) => {\n      await setVotes({ assetID, tSpendPolicy: { [txHash]: policyID } })\n      for (const tspend of stakeStatus.stances.tspends) if (tspend.hash === txHash) tspend.currentPolicy = policyID\n    }\n\n    Doc.empty(page.votingTspends)\n    for (const tspend of stakeStatus.stances.tspends) {\n      const div = page.tspendTmpl.cloneNode(true) as PageElement\n      page.votingTspends.appendChild(div)\n      app().bindUrlHandlers(div)\n      const tmpl = Doc.parseTemplate(div)\n      for (const opt of [tmpl.yes, tmpl.no]) {\n        opt.name = tspend.hash\n        if (tspend.currentPolicy === opt.value) opt.checked = true\n        Doc.bind(opt, 'change', () => {\n          if (!opt.checked) return\n          setTspendVote(tspend.hash, opt.value ?? '')\n        })\n      }\n      if (tspend.value > 0) tmpl.value.textContent = Doc.formatFourSigFigs(tspend.value / ui.conventional.conversionFactor)\n      else Doc.hide(tmpl.value)\n      tmpl.hash.textContent = tspend.hash\n      tmpl.explorerLink.setAttribute('href', coinLink(tspend.hash))\n    }\n\n    const setTKeyPolicy = async (key: string, policy: string) => {\n      await setVotes({ assetID, treasuryPolicy: { [key]: policy } })\n      for (const tkey of stakeStatus.stances.treasuryKeys) if (tkey.key === key) tkey.policy = policy\n    }\n\n    Doc.empty(page.votingTKeys)\n    for (const keyPolicy of (stakeStatus.stances.treasuryKeys ?? [])) {\n      const div = page.tkeyTmpl.cloneNode(true) as PageElement\n      page.votingTKeys.appendChild(div)\n      const tmpl = Doc.parseTemplate(div)\n      for (const opt of [tmpl.yes, tmpl.no]) {\n        opt.name = keyPolicy.key\n        if (keyPolicy.policy === opt.value) opt.checked = true\n        Doc.bind(opt, 'change', () => {\n          if (!opt.checked) return\n          setTKeyPolicy(keyPolicy.key, opt.value ?? '')\n        })\n      }\n      tmpl.key.textContent = keyPolicy.key\n    }\n\n    this.showForm(page.votingForm)\n  }\n\n  async updatePrivacy (assetID: number) {\n    const disablePrivacy = app().extensionWallet(assetID)?.disablePrivacy\n    this.mixing = false\n    const { wallet } = app().assets[assetID]\n    const page = this.page\n    Doc.hide(page.mixingBox, page.mixerOff, page.mixerOn)\n    // TODO: Show special messaging if the asset supports mixing but not this\n    // wallet type.\n    if (disablePrivacy || !wallet?.running || (wallet.traits & traitFundsMixer) === 0) return\n    Doc.show(page.mixingBox, page.mixerLoading)\n    const res = await this.safePost('/api/mixingstats', { assetID })\n    Doc.hide(page.mixerLoading)\n    if (!app().checkResponse(res)) {\n      Doc.show(page.mixingErr)\n      page.mixingErr.textContent = res.msg\n      return\n    }\n\n    this.mixing = res.stats.enabled as boolean\n    if (this.mixing) Doc.show(page.mixerOn)\n    else Doc.show(page.mixerOff)\n    this.mixerToggle.setState(this.mixing)\n  }\n\n  async updateMixerState (on: boolean) {\n    const page = this.page\n    Doc.hide(page.mixingErr)\n    const loaded = app().loading(page.mixingBox)\n    const res = await postJSON('/api/configuremixer', { assetID: this.selectedAssetID, enabled: on })\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.mixingErr.textContent = intl.prep(intl.ID_API_ERROR, { msg: res.msg })\n      Doc.show(page.mixingErr)\n      return\n    }\n    Doc.setVis(on, page.mixerOn)\n    Doc.setVis(!on, page.mixerOff)\n    this.mixerToggle.setState(on)\n  }\n\n  updateDisplayedAssetBalance (): void {\n    const page = this.page\n    const asset = app().assets[this.selectedAssetID]\n    const { wallet, unitInfo: ui, id: assetID } = asset\n    const bal = wallet.balance\n    Doc.show(page.balanceBox, page.walletDetails)\n    const totalLocked = bal.locked + bal.contractlocked + bal.bondlocked\n    const totalBalance = bal.available + totalLocked + bal.immature\n    page.balance.textContent = Doc.formatCoinValue(totalBalance, ui)\n    page.balanceUnit.textContent = ui.conventional.unit\n    const rate = app().fiatRatesMap[assetID]\n    if (rate) {\n      Doc.show(page.fiatBalanceBox)\n      page.fiatBalance.textContent = Doc.formatFiatConversion(totalBalance, rate, ui)\n    }\n    Doc.empty(page.balanceDetailBox)\n\n    const addBalanceRow = (cat: string, bal: number, tooltipMsg?: string) => {\n      const row = page.balanceDetailRow.cloneNode(true) as PageElement\n      page.balanceDetailBox.appendChild(row)\n      const tmpl = Doc.parseTemplate(row)\n      tmpl.name.textContent = cat\n      if (tooltipMsg) {\n        tmpl.tooltipMsg.dataset.tooltip = tooltipMsg\n        Doc.show(tmpl.tooltipMsg)\n      }\n      tmpl.balance.textContent = Doc.formatCoinValue(bal, ui)\n      return row\n    }\n\n    let lastSubLockedRow: PageElement | undefined\n    let lastPrimaryRow: PageElement | undefined\n    const addPrimaryBalance = (cat: string, bal: number, tooltipMsg?: string) => {\n      lastSubLockedRow = undefined\n      lastPrimaryRow = addBalanceRow(cat, bal, tooltipMsg)\n    }\n    const addSubBalance = (cat: string, bal: number, tooltipMsg?: string) => {\n      lastSubLockedRow = addBalanceRow(cat, bal, tooltipMsg)\n      lastSubLockedRow.classList.add('sub')\n    }\n    const setRowClasses = () => {\n      if (!lastSubLockedRow) return\n      (lastPrimaryRow as PageElement).classList.add('itemized')\n      lastSubLockedRow.classList.add('last')\n    }\n\n    addPrimaryBalance(intl.prep(intl.ID_AVAILABLE_TITLE), bal.available, '')\n    if (bal.other?.Shielded !== undefined) {\n      const transparent = bal.available - bal.other.Shielded.amt\n      addSubBalance(intl.prep(intl.ID_TRANSPARENT), transparent)\n      addSubBalance(intl.prep(intl.ID_SHIELDED), bal.other.Shielded.amt)\n    }\n    setRowClasses()\n\n    addPrimaryBalance(intl.prep(intl.ID_LOCKED_TITLE), totalLocked, intl.prep(intl.ID_LOCKED_BAL_MSG))\n    if (bal.orderlocked > 0) addSubBalance(intl.prep(intl.ID_ORDER), bal.orderlocked, intl.prep(intl.ID_LOCKED_ORDER_BAL_MSG))\n    if (bal.contractlocked > 0) addSubBalance(intl.prep(intl.ID_SWAPPING), bal.contractlocked, intl.prep(intl.ID_LOCKED_SWAPPING_BAL_MSG))\n    if (bal.bondlocked > 0) addSubBalance(intl.prep(intl.ID_BONDED), bal.bondlocked, intl.prep(intl.ID_LOCKED_BOND_BAL_MSG))\n    if (bal.bondReserves > 0) addSubBalance(intl.prep(intl.ID_BOND_RESERVES), bal.bondReserves, intl.prep(intl.ID_BOND_RESERVES_MSG))\n    if (bal?.other?.Staked !== undefined) addSubBalance('Staked', bal.other.Staked.amt)\n    setRowClasses()\n\n    if (bal.immature) addPrimaryBalance(intl.prep(intl.ID_IMMATURE_TITLE), bal.immature, intl.prep(intl.ID_IMMATURE_BAL_MSG))\n    if (bal?.other?.Unmixed !== undefined) addSubBalance('Unmixed', bal.other.Unmixed.amt)\n    setRowClasses()\n\n    // TODO: handle reserves deficit with a notification.\n    // if (bal.reservesDeficit > 0) addPrimaryBalance(intl.prep(intl.ID_RESERVES_DEFICIT), bal.reservesDeficit, intl.prep(intl.ID_RESERVES_DEFICIT_MSG))\n\n    page.purchaserBal.textContent = Doc.formatFourSigFigs(bal.available / ui.conventional.conversionFactor)\n    app().bindTooltips(page.balanceDetailBox)\n  }\n\n  showAvailableMarkets (assetID: number) {\n    const page = this.page\n    const exchanges = app().user.exchanges\n    const markets: [string, Exchange, Market][] = []\n    for (const xc of Object.values(exchanges)) {\n      if (!xc.markets) continue\n      for (const mkt of Object.values(xc.markets)) {\n        if (mkt.baseid === assetID || mkt.quoteid === assetID) markets.push([xc.host, xc, mkt])\n      }\n    }\n\n    const spotVolume = (assetID: number, mkt: Market): number => {\n      const spot = mkt.spot\n      if (!spot) return 0\n      const conversionFactor = app().unitInfo(assetID).conventional.conversionFactor\n      const volume = assetID === mkt.baseid ? spot.vol24 : spot.vol24 * spot.rate / OrderUtil.RateEncodingFactor\n      return volume / conversionFactor\n    }\n\n    markets.sort((a: [string, Exchange, Market], b: [string, Exchange, Market]): number => {\n      const [hostA,, mktA] = a\n      const [hostB,, mktB] = b\n      if (!mktA.spot && !mktB.spot) return hostA.localeCompare(hostB)\n      return spotVolume(assetID, mktB) - spotVolume(assetID, mktA)\n    })\n    Doc.empty(page.availableMarkets)\n\n    for (const [host, xc, mkt] of markets) {\n      const { spot, baseid, basesymbol, quoteid, quotesymbol } = mkt\n      const row = page.marketRow.cloneNode(true) as PageElement\n      page.availableMarkets.appendChild(row)\n      const tmpl = Doc.parseTemplate(row)\n      tmpl.host.textContent = host\n      tmpl.baseLogo.src = Doc.logoPath(basesymbol)\n      tmpl.quoteLogo.src = Doc.logoPath(quotesymbol)\n      Doc.empty(tmpl.baseSymbol, tmpl.quoteSymbol)\n      tmpl.baseSymbol.appendChild(Doc.symbolize(xc.assets[baseid], true))\n      tmpl.quoteSymbol.appendChild(Doc.symbolize(xc.assets[quoteid], true))\n\n      if (spot) {\n        const convRate = app().conventionalRate(baseid, quoteid, spot.rate, exchanges[host])\n        tmpl.price.textContent = Doc.formatFourSigFigs(convRate)\n        const fmtSymbol = (s: string) => s.split('.')[0].toUpperCase()\n        tmpl.priceQuoteUnit.textContent = fmtSymbol(quotesymbol)\n        tmpl.priceBaseUnit.textContent = fmtSymbol(basesymbol)\n        tmpl.volume.textContent = Doc.formatFourSigFigs(spotVolume(assetID, mkt))\n        tmpl.volumeUnit.textContent = assetID === baseid ? fmtSymbol(basesymbol) : fmtSymbol(quotesymbol)\n      } else Doc.hide(tmpl.priceBox, tmpl.volumeBox)\n      Doc.bind(row, 'click', () => app().loadPage('markets', { host, baseID: baseid, quoteID: quoteid }))\n    }\n    page.marketsOverviewBox.classList.remove('invisible')\n  }\n\n  async showRecentActivity (assetID: number) {\n    const page = this.page\n    const loaded = app().loading(page.orderActivityBox)\n    const filter: OrderFilter = {\n      n: 20,\n      assets: [assetID],\n      hosts: [],\n      statuses: []\n    }\n    const res = await postJSON('/api/orders', filter)\n    loaded()\n    Doc.hide(page.noActivity, page.orderActivity)\n    if (!res.orders || res.orders.length === 0) {\n      Doc.show(page.noActivity)\n      page.orderActivityBox.classList.remove('invisible')\n      return\n    }\n    Doc.show(page.orderActivity)\n    Doc.empty(page.recentOrders)\n    for (const ord of (res.orders as Order[])) {\n      const row = page.recentOrderTmpl.cloneNode(true) as PageElement\n      page.recentOrders.appendChild(row)\n      const tmpl = Doc.parseTemplate(row)\n      let from: SupportedAsset, to: SupportedAsset\n      const [baseUnitInfo, quoteUnitInfo] = [app().unitInfo(ord.baseID), app().unitInfo(ord.quoteID)]\n      if (ord.sell) {\n        [from, to] = [app().assets[ord.baseID], app().assets[ord.quoteID]]\n        tmpl.fromQty.textContent = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        if (ord.type === OrderUtil.Limit) {\n          tmpl.toQty.textContent = Doc.formatCoinValue(ord.qty / OrderUtil.RateEncodingFactor * ord.rate, quoteUnitInfo)\n        }\n      } else {\n        [from, to] = [app().assets[ord.quoteID], app().assets[ord.baseID]]\n        if (ord.type === OrderUtil.Market) {\n          tmpl.fromQty.textContent = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        } else {\n          tmpl.fromQty.textContent = Doc.formatCoinValue(ord.qty / OrderUtil.RateEncodingFactor * ord.rate, quoteUnitInfo)\n          tmpl.toQty.textContent = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        }\n      }\n\n      tmpl.fromLogo.src = Doc.logoPath(from.symbol)\n      Doc.empty(tmpl.fromSymbol, tmpl.toSymbol)\n      tmpl.fromSymbol.appendChild(Doc.symbolize(from, true))\n      tmpl.toLogo.src = Doc.logoPath(to.symbol)\n      tmpl.toSymbol.appendChild(Doc.symbolize(to, true))\n      tmpl.status.textContent = OrderUtil.statusString(ord)\n      tmpl.filled.textContent = `${(OrderUtil.filled(ord) / ord.qty * 100).toFixed(1)}%`\n      tmpl.age.textContent = Doc.timeSince(ord.submitTime)\n      tmpl.link.href = `order/${ord.id}`\n      app().bindInternalNavigation(row)\n    }\n    page.orderActivityBox.classList.remove('invisible')\n  }\n\n  updateTxHistoryRow (row: PageElement, tx: WalletTransaction, assetID: number) {\n    const tmpl = Doc.parseTemplate(row)\n    let amtAssetID = assetID\n    let feesAssetID = assetID\n    if (tx.tokenID) {\n      amtAssetID = tx.tokenID\n      if (assetID !== tx.tokenID) feesAssetID = assetID\n      else {\n        const asset = app().assets[assetID]\n        if (asset.token) feesAssetID = asset.token.parentID\n        else console.error(`unable to determine fee asset for tx ${tx.id}`)\n      }\n    }\n    const amtAssetUI = app().unitInfo(amtAssetID)\n    const feesAssetUI = app().unitInfo(feesAssetID)\n    tmpl.age.textContent = Doc.timeSince(tx.timestamp * 1000)\n    tmpl.age.dataset.timestamp = String(tx.timestamp * 1000)\n    Doc.setVis(tx.timestamp === 0, tmpl.pending)\n    Doc.setVis(tx.timestamp !== 0, tmpl.age)\n    if (tx.timestamp > 0) tmpl.age.dataset.stamp = String(tx.timestamp)\n    let txType = txTypeString(tx.type)\n    if (tx.tokenID && tx.tokenID !== assetID) {\n      const tokenAsset = app().assets[tx.tokenID]\n      const tokenSymbol = tokenAsset.unitInfo.conventional.unit\n      txType = `${tokenSymbol} ${txType}`\n    }\n    tmpl.type.textContent = txType\n    tmpl.id.textContent = trimStringWithEllipsis(tx.id, 12)\n    tmpl.id.setAttribute('title', tx.id)\n    tmpl.fees.textContent = Doc.formatCoinValue(tx.fees, feesAssetUI)\n    if (noAmtTxTypes.includes(tx.type)) {\n      tmpl.amount.textContent = '-'\n    } else {\n      const [u, c] = txTypeSignAndClass(tx.type)\n      const amt = Doc.formatCoinValue(tx.amount, amtAssetUI)\n      tmpl.amount.textContent = `${u}${amt}`\n      if (c !== '') tmpl.amount.classList.add(c)\n    }\n  }\n\n  txHistoryRow (tx: WalletTransaction, assetID: number) : PageElement {\n    const row = this.page.txHistoryRowTmpl.cloneNode(true) as PageElement\n    row.dataset.txid = tx.id\n    Doc.bind(row, 'click', () => this.showTxDetailsPopup(tx.id))\n    this.updateTxHistoryRow(row, tx, assetID)\n    const tmpl = Doc.parseTemplate(row)\n    this.stampers.push(tmpl.age)\n    return row\n  }\n\n  txHistoryDateRow (date: string) : PageElement {\n    const row = this.page.txHistoryDateRowTmpl.cloneNode(true) as PageElement\n    const tmpl = Doc.parseTemplate(row)\n    tmpl.date.textContent = date\n    return row\n  }\n\n  setTxDetailsPopupElements (tx: WalletTransaction) {\n    const page = this.page\n\n    // Block explorer\n    const assetExplorer = CoinExplorers[this.selectedAssetID]\n    if (assetExplorer && assetExplorer[net]) {\n      page.txViewBlockExplorer.href = assetExplorer[net](tx.id)\n    }\n\n    // Tx type\n    let txType = txTypeString(tx.type)\n    if (tx.tokenID && tx.tokenID !== this.selectedAssetID) {\n      const tokenSymbol = app().assets[tx.tokenID].symbol.split('.')[0].toUpperCase()\n      txType = `${tokenSymbol} ${txType}`\n    }\n    page.txDetailsType.textContent = txType\n    Doc.setVis(tx.type === txTypeSwapOrSend, page.txTypeTooltip)\n    page.txTypeTooltip.dataset.tooltip = intl.prep(intl.ID_SWAP_OR_SEND_TOOLTIP)\n\n    // Amount\n    if (noAmtTxTypes.includes(tx.type)) {\n      Doc.hide(page.txDetailsAmtSection)\n    } else {\n      let assetID = this.selectedAssetID\n      if (tx.tokenID) assetID = tx.tokenID\n      Doc.show(page.txDetailsAmtSection)\n      const ui = app().unitInfo(assetID)\n      const amt = Doc.formatCoinValue(tx.amount, ui)\n      const [s, c] = txTypeSignAndClass(tx.type)\n      page.txDetailsAmount.textContent = `${s}${amt} ${ui.conventional.unit}`\n      if (c !== '') page.txDetailsAmount.classList.add(c)\n    }\n\n    // Fee\n    let feeAsset = this.selectedAssetID\n    if (tx.tokenID !== undefined) {\n      const asset = app().assets[tx.tokenID]\n      if (asset.token) {\n        feeAsset = asset.token.parentID\n      } else {\n        console.error(`wallet transaction ${tx.id} is supposed to be a token tx, but asset ${tx.tokenID} is not a token`)\n      }\n    }\n    const feeUI = app().unitInfo(feeAsset)\n    const fee = Doc.formatCoinValue(tx.fees, feeUI)\n    page.txDetailsFee.textContent = `${fee} ${feeUI.conventional.unit}`\n\n    // Time / block number\n    page.txDetailsBlockNumber.textContent = `${tx.blockNumber}`\n    const date = new Date(tx.timestamp * 1000)\n    const dateStr = date.toLocaleDateString()\n    const timeStr = date.toLocaleTimeString()\n    page.txDetailsTimestamp.textContent = `${dateStr} ${timeStr}`\n    Doc.setVis(tx.blockNumber === 0, page.timestampPending, page.blockNumberPending)\n    Doc.setVis(tx.blockNumber !== 0, page.txDetailsBlockNumber, page.txDetailsTimestamp)\n\n    // Tx ID\n    page.txDetailsID.textContent = trimStringWithEllipsis(tx.id, 20)\n    page.txDetailsID.setAttribute('title', tx.id)\n\n    // Recipient\n    if (tx.recipient) {\n      Doc.show(page.txDetailsRecipientSection)\n      page.txDetailsRecipient.textContent = trimStringWithEllipsis(tx.recipient, 20)\n      page.txDetailsRecipient.setAttribute('title', tx.recipient)\n    } else {\n      Doc.hide(page.txDetailsRecipientSection)\n    }\n\n    // Bond Info\n    if (tx.bondInfo) {\n      Doc.show(page.txDetailsBondIDSection, page.txDetailsBondLocktimeSection)\n      Doc.setVis(tx.bondInfo.accountID !== '', page.txDetailsBondAccountIDSection)\n      page.txDetailsBondID.textContent = trimStringWithEllipsis(tx.bondInfo.bondID, 20)\n      page.txDetailsBondID.setAttribute('title', tx.bondInfo.bondID)\n      const date = new Date(tx.bondInfo.lockTime * 1000)\n      const dateStr = date.toLocaleDateString()\n      const timeStr = date.toLocaleTimeString()\n      page.txDetailsBondLocktime.textContent = `${dateStr} ${timeStr}`\n      page.txDetailsBondAccountID.textContent = trimStringWithEllipsis(tx.bondInfo.accountID, 20)\n      page.txDetailsBondAccountID.setAttribute('title', tx.bondInfo.accountID)\n    } else {\n      Doc.hide(page.txDetailsBondIDSection, page.txDetailsBondLocktimeSection, page.txDetailsBondAccountIDSection)\n    }\n\n    // Nonce\n    if (tx.additionalData && tx.additionalData.Nonce) {\n      Doc.show(page.txDetailsNonceSection)\n      page.txDetailsNonce.textContent = `${tx.additionalData.Nonce}`\n    } else {\n      Doc.hide(page.txDetailsNonceSection)\n    }\n  }\n\n  showTxDetailsPopup (id: string) {\n    const tx = app().getWalletTx(this.selectedAssetID, id)\n    if (!tx) {\n      console.error(`wallet transaction ${id} not found`)\n      return\n    }\n    this.currTx = tx\n    this.setTxDetailsPopupElements(tx)\n    this.showForm(this.page.txDetails)\n  }\n\n  txHistoryTableNewestDate () : string {\n    if (this.page.txHistoryTableBody.children.length >= 1) {\n      const tmpl = Doc.parseTemplate(this.page.txHistoryTableBody.children[0] as PageElement)\n      return tmpl.date.textContent || ''\n    }\n    return ''\n  }\n\n  txDate (tx: WalletTransaction) : string {\n    if (tx.timestamp === 0) {\n      return (new Date()).toLocaleDateString()\n    }\n    return (new Date(tx.timestamp * 1000)).toLocaleDateString()\n  }\n\n  handleTxNote (tx: WalletTransaction, newTx: boolean) {\n    const w = app().assets[this.selectedAssetID].wallet\n    const hideMixing = (w.traits & traitFundsMixer) !== 0 && !!this.page.hideMixTxs.checked\n    if (hideMixing && tx.type === txTypeMixing) return\n    if (newTx) {\n      if (!this.oldestTx) {\n        Doc.show(this.page.txHistoryTable)\n        Doc.hide(this.page.noTxHistory)\n        this.page.txHistoryTableBody.appendChild(this.txHistoryDateRow(this.txDate(tx)))\n        this.page.txHistoryTableBody.appendChild(this.txHistoryRow(tx, this.selectedAssetID))\n        this.oldestTx = tx\n      } else if (this.txDate(tx) !== this.txHistoryTableNewestDate()) {\n        this.page.txHistoryTableBody.insertBefore(this.txHistoryRow(tx, this.selectedAssetID), this.page.txHistoryTableBody.children[0])\n        this.page.txHistoryTableBody.insertBefore(this.txHistoryDateRow(this.txDate(tx)), this.page.txHistoryTableBody.children[0])\n      } else {\n        this.page.txHistoryTableBody.insertBefore(this.txHistoryRow(tx, this.selectedAssetID), this.page.txHistoryTableBody.children[1])\n      }\n      return\n    }\n    for (const row of this.page.txHistoryTableBody.children) {\n      const peRow = row as PageElement\n      if (peRow.dataset.txid === tx.id) {\n        this.updateTxHistoryRow(peRow, tx, this.selectedAssetID)\n        break\n      }\n    }\n    if (tx.id === this.currTx?.id) {\n      this.setTxDetailsPopupElements(tx)\n    }\n  }\n\n  async getTxHistory (assetID: number, hideMixTxs: boolean, after?: string) : Promise<TxHistoryResult> {\n    let numToFetch = 10\n    if (hideMixTxs) numToFetch = 15\n\n    const res : TxHistoryResult = { txs: [], lastTx: false }\n    let ref = after\n\n    for (let i = 0; i < 40; i++) {\n      const currRes = await app().txHistory(assetID, numToFetch, ref)\n      if (currRes.txs.length > 0) {\n        ref = currRes.txs[currRes.txs.length - 1].id\n      }\n      let txs = currRes.txs\n      if (hideMixTxs) {\n        txs = txs.filter((tx) => tx.type !== txTypeMixing)\n      }\n      if (res.txs.length + txs.length > 10) {\n        const numToPush = 10 - res.txs.length\n        res.txs.push(...txs.slice(0, numToPush))\n      } else {\n        if (currRes.lastTx) res.lastTx = true\n        res.txs.push(...txs)\n      }\n      if (res.txs.length >= 10 || currRes.lastTx) break\n    }\n    return res\n  }\n\n  async showTxHistory (assetID: number) {\n    const page = this.page\n    let txRes : TxHistoryResult\n    Doc.hide(page.txHistoryTable, page.txHistoryBox, page.noTxHistory, page.earlierTxs, page.txHistoryNotAvailable, page.hideMixTxs)\n    Doc.empty(page.txHistoryTableBody)\n    const w = app().assets[assetID].wallet\n    if (!w || w.disabled || (w.traits & traitHistorian) === 0) {\n      Doc.show(page.txHistoryNotAvailable)\n      return\n    }\n\n    this.oldestTx = undefined\n\n    const isMixing = (w.traits & traitFundsMixer) !== 0\n    Doc.setVis(isMixing, page.hideMixTxs)\n    Doc.show(page.txHistoryBox)\n\n    try {\n      const hideMixing = isMixing && !!page.hideMixTxsCheckbox.checked\n      txRes = await this.getTxHistory(assetID, hideMixing)\n    } catch (err) {\n      Doc.show(page.noTxHistory)\n      return\n    }\n    if (txRes.txs.length === 0) {\n      Doc.show(page.noTxHistory)\n      return\n    }\n\n    let oldestDate = this.txDate(txRes.txs[0])\n    page.txHistoryTableBody.appendChild(this.txHistoryDateRow(oldestDate))\n    for (const tx of txRes.txs) {\n      const date = this.txDate(tx)\n      if (date !== oldestDate) {\n        oldestDate = date\n        page.txHistoryTableBody.appendChild(this.txHistoryDateRow(date))\n      }\n      const row = this.txHistoryRow(tx, assetID)\n      page.txHistoryTableBody.appendChild(row)\n    }\n    this.oldestTx = txRes.txs[txRes.txs.length - 1]\n    Doc.show(page.txHistoryTable)\n    Doc.setVis(!txRes.lastTx, page.earlierTxs)\n  }\n\n  async loadEarlierTxs () {\n    if (!this.oldestTx) return\n    const page = this.page\n    let txRes : TxHistoryResult\n    const w = app().assets[this.selectedAssetID].wallet\n    const hideMixing = (w.traits & traitFundsMixer) !== 0 && !!page.hideMixTxsCheckbox.checked\n    try {\n      txRes = await this.getTxHistory(this.selectedAssetID, hideMixing, this.oldestTx.id)\n    } catch (err) {\n      console.error(err)\n      return\n    }\n    let oldestDate = this.txDate(this.oldestTx)\n    for (const tx of txRes.txs) {\n      const date = this.txDate(tx)\n      if (date !== oldestDate) {\n        oldestDate = date\n        page.txHistoryTableBody.appendChild(this.txHistoryDateRow(date))\n      }\n      const row = this.txHistoryRow(tx, this.selectedAssetID)\n      page.txHistoryTableBody.appendChild(row)\n    }\n    Doc.setVis(!txRes.lastTx, page.earlierTxs)\n    if (txRes.txs.length > 0) {\n      this.oldestTx = txRes.txs[txRes.txs.length - 1]\n    }\n  }\n\n  async rescanWallet (assetID: number) {\n    const page = this.page\n    Doc.hide(page.reconfigErr)\n\n    const url = '/api/rescanwallet'\n    const req = { assetID: assetID }\n\n    const loaded = app().loading(this.body)\n    const res = await postJSON(url, req)\n    loaded()\n    if (res.code === Errors.activeOrdersErr) {\n      this.forceUrl = url\n      this.forceReq = req\n      this.showConfirmForce()\n      return\n    }\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.reconfigErr, res.msg)\n      return\n    }\n    this.assetUpdated(assetID, page.reconfigForm, intl.prep(intl.ID_RESCAN_STARTED))\n  }\n\n  showConfirmForce () {\n    Doc.hide(this.page.confirmForceErr)\n    this.showForm(this.page.confirmForce)\n  }\n\n  showRecoverWallet () {\n    Doc.hide(this.page.recoverWalletErr)\n    this.showForm(this.page.recoverWalletConfirm)\n  }\n\n  /* Show the open wallet form if the password is not cached, and otherwise\n   * attempt to open the wallet.\n   */\n  async openWallet (assetID: number) {\n    const open = {\n      assetID: assetID\n    }\n    const res = await postJSON('/api/openwallet', open)\n    if (!app().checkResponse(res)) {\n      console.error('openwallet error', res)\n      return\n    }\n    this.assetUpdated(assetID, undefined, intl.prep(intl.ID_WALLET_UNLOCKED))\n  }\n\n  /* Show the form used to change wallet configuration settings. */\n  async showReconfig (assetID: number, cfg?: reconfigSettings) {\n    const page = this.page\n    Doc.hide(\n      page.changeWalletType, page.changeTypeHideIcon, page.reconfigErr,\n      page.showChangeType, page.changeTypeHideIcon, page.reconfigErr,\n      page.enableWallet, page.disableWallet\n    )\n    // Hide update password section by default\n    this.changeWalletPW = false\n    this.setPWSettingViz(this.changeWalletPW)\n    const asset = app().assets[assetID]\n\n    const currentDef = app().currentWalletDefinition(assetID)\n    const walletDefs = asset.token ? [asset.token.definition] : asset.info ? asset.info.availablewallets : []\n    const disableWalletType = app().extensionWallet(assetID)?.disableWalletType\n    if (walletDefs.length > 1 && !disableWalletType) {\n      Doc.empty(page.changeWalletTypeSelect)\n      Doc.show(page.showChangeType, page.changeTypeShowIcon)\n      page.changeTypeMsg.textContent = intl.prep(intl.ID_CHANGE_WALLET_TYPE)\n      for (const wDef of walletDefs) {\n        const option = document.createElement('option') as HTMLOptionElement\n        if (wDef.type === currentDef.type) option.selected = true\n        option.value = option.textContent = wDef.type\n        page.changeWalletTypeSelect.appendChild(option)\n      }\n    }\n\n    if (cfg?.elevateProviders) {\n      for (const opt of (currentDef.configopts)) if (opt.key === 'providers') opt.required = true\n    }\n\n    const wallet = app().walletMap[assetID]\n    Doc.setVis(wallet.traits & traitLogFiler, page.downloadLogs)\n    Doc.setVis(wallet.traits & traitRecoverer, page.recoverWallet)\n    Doc.setVis(wallet.traits & traitRestorer, page.exportWallet)\n    Doc.setVis(wallet.traits & traitRescanner, page.rescanWallet)\n    Doc.setVis(wallet.traits & traitPeerManager && !wallet.disabled, page.managePeers)\n    Doc.setVis(wallet.traits & traitTokenApprover && !wallet.disabled, page.unapproveTokenAllowance)\n\n    Doc.setVis(wallet.traits & traitsExtraOpts, page.otherActionsLabel)\n\n    if (wallet.disabled) Doc.show(page.enableWallet)\n    else Doc.show(page.disableWallet)\n\n    this.showOrHideRecoverySupportMsg(wallet, currentDef.seeded)\n\n    page.recfgAssetLogo.src = Doc.logoPath(asset.symbol)\n    page.recfgAssetName.textContent = asset.name\n    if (!cfg?.skipAnimation) this.showForm(page.reconfigForm)\n    const loaded = app().loading(page.reconfigForm)\n    const res = await postJSON('/api/walletsettings', { assetID })\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.reconfigErr, res.msg)\n      return\n    }\n    const assetHasActiveOrders = app().haveActiveOrders(assetID)\n    this.reconfigForm.update(asset.id, currentDef.configopts || [], assetHasActiveOrders)\n    this.setGuideLink(currentDef.guidelink)\n    this.reconfigForm.setConfig(res.map)\n    this.updateDisplayedReconfigFields(currentDef)\n  }\n\n  showOrHideRecoverySupportMsg (wallet: WalletState, seeded: boolean) {\n    this.setRecoverySupportMsgViz(seeded && !wallet.running && !wallet.disabled && Boolean(wallet.traits & traitRecoverer), wallet.symbol)\n  }\n\n  setRecoverySupportMsgViz (viz: boolean, symbol: string) {\n    const page = this.page\n    if (viz) {\n      page.reconfigSupportMsg.textContent = intl.prep(intl.ID_WALLET_RECOVERY_SUPPORT_MSG, { walletSymbol: symbol.toLocaleUpperCase() })\n      Doc.show(page.reconfigSupportMsg)\n      page.submitReconfig.setAttribute('disabled', '')\n      page.submitReconfig.classList.add('grey')\n      return\n    }\n    page.submitReconfig.removeAttribute('disabled')\n    page.submitReconfig.classList.remove('grey')\n    Doc.empty(page.reconfigSupportMsg)\n    Doc.hide(page.reconfigSupportMsg)\n  }\n\n  changeWalletType () {\n    const page = this.page\n    const walletType = page.changeWalletTypeSelect.value || ''\n    const walletDef = app().walletDefinition(this.selectedAssetID, walletType)\n    this.reconfigForm.update(this.selectedAssetID, walletDef.configopts || [], false)\n    const wallet = app().walletMap[this.selectedAssetID]\n    const currentDef = app().currentWalletDefinition(this.selectedAssetID)\n    if (walletDef.type !== currentDef.type) this.setRecoverySupportMsgViz(false, wallet.symbol)\n    else this.showOrHideRecoverySupportMsg(wallet, walletDef.seeded)\n    this.setGuideLink(walletDef.guidelink)\n    this.updateDisplayedReconfigFields(walletDef)\n  }\n\n  setGuideLink (guideLink: string) {\n    Doc.hide(this.walletCfgGuide)\n    if (guideLink !== '') {\n      this.walletCfgGuide.href = guideLink\n      Doc.show(this.walletCfgGuide)\n    }\n  }\n\n  updateDisplayedReconfigFields (walletDef: WalletDefinition) {\n    const disablePassword = app().extensionWallet(this.selectedAssetID)?.disablePassword\n    if (walletDef.seeded || walletDef.type === 'token' || disablePassword) {\n      Doc.hide(this.page.showChangePW, this.reconfigForm.fileSelector)\n      this.changeWalletPW = false\n      this.setPWSettingViz(false)\n    } else Doc.show(this.page.showChangePW, this.reconfigForm.fileSelector)\n  }\n\n  /* Display a deposit address. */\n  async showDeposit (assetID: number) {\n    this.depositAddrForm.setAsset(assetID)\n    this.showForm(this.page.deposit)\n  }\n\n  /* Show the form to either send or withdraw funds. */\n  async showSendForm (assetID: number) {\n    const page = this.page\n    const box = page.sendForm\n    const { wallet, unitInfo: ui, symbol, token } = app().assets[assetID]\n    Doc.hide(page.toggleSubtract)\n    page.subtractCheckBox.checked = false\n\n    const isWithdrawer = (wallet.traits & traitWithdrawer) !== 0\n    if (isWithdrawer) {\n      Doc.show(page.toggleSubtract)\n    }\n\n    Doc.hide(page.sendErr, page.maxSendDisplay, page.sendTokenMsgBox)\n    page.sendAddr.classList.remove('border-danger', 'border-success')\n    page.sendAddr.value = ''\n    page.sendAmt.value = ''\n    const xcRate = app().fiatRatesMap[assetID]\n    Doc.showFiatValue(page.sendValue, 0, xcRate, ui)\n    page.walletBal.textContent = Doc.formatFullPrecision(wallet.balance.available, ui)\n    page.sendLogo.src = Doc.logoPath(symbol)\n    page.sendName.textContent = ui.conventional.unit\n    if (token) {\n      const parentAsset = app().assets[token.parentID]\n      page.sendTokenParentLogo.src = Doc.logoPath(parentAsset.symbol)\n      page.sendTokenParentName.textContent = parentAsset.name\n      Doc.show(page.sendTokenMsgBox)\n    }\n    // page.sendFee.textContent = wallet.feerate\n    // page.sendUnit.textContent = wallet.units\n\n    if (wallet.balance.available > 0 && (wallet.traits & traitTxFeeEstimator) !== 0) {\n      const feeReq = {\n        assetID: assetID,\n        subtract: isWithdrawer,\n        maxWithdraw: true,\n        value: wallet.balance.available\n      }\n\n      const loaded = app().loading(this.body)\n      const res = await postJSON('/api/txfee', feeReq)\n      loaded()\n      if (app().checkResponse(res)) {\n        let canSend = wallet.balance.available\n        if (!token) {\n          canSend -= res.txfee\n          if (canSend < 0) canSend = 0\n        }\n\n        this.maxSend = canSend\n        page.maxSend.textContent = Doc.formatFullPrecision(canSend, ui)\n        Doc.showFiatValue(page.maxSendFiat, canSend, xcRate, ui)\n        if (token) {\n          const feeUI = app().assets[token.parentID].unitInfo\n          page.maxSendFee.textContent = Doc.formatFullPrecision(res.txfee, feeUI) + ' ' + feeUI.conventional.unit\n          Doc.showFiatValue(page.maxSendFeeFiat, res.txfee, app().fiatRatesMap[token.parentID], feeUI)\n        } else {\n          page.maxSendFee.textContent = Doc.formatFullPrecision(res.txfee, ui)\n          Doc.showFiatValue(page.maxSendFeeFiat, res.txfee, xcRate, ui)\n        }\n        Doc.show(page.maxSendDisplay)\n      }\n    }\n\n    Doc.showFiatValue(page.sendValue, 0, xcRate, ui)\n    page.walletBal.textContent = Doc.formatFullPrecision(wallet.balance.available, ui)\n    box.dataset.assetID = String(assetID)\n    this.showForm(box)\n  }\n\n  /* doConnect connects to a wallet via the connectwallet API route. */\n  async doConnect (assetID: number) {\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/connectwallet', { assetID })\n    loaded()\n    if (!app().checkResponse(res)) {\n      const { symbol } = app().assets[assetID]\n      const page = this.page\n      page.errorModalMsg.textContent = intl.prep(intl.ID_CONNECT_WALLET_ERR_MSG, { assetName: symbol, errMsg: res.msg })\n      this.showForm(page.errorModal)\n    }\n    this.updateDisplayedAsset(assetID)\n  }\n\n  assetUpdated (assetID: number, oldForm?: PageElement, successMsg?: string) {\n    if (assetID !== this.selectedAssetID) return\n    this.updateDisplayedAsset(assetID)\n    if (oldForm && Object.is(this.currentForm, oldForm)) {\n      if (successMsg) this.showSuccess(successMsg)\n      else this.closePopups()\n    }\n  }\n\n  /* populateMaxSend populates the amount field with the max amount the wallet\n     can send. The max send amount can be the maximum amount based on our\n     pre-estimation or the asset's wallet balance.\n  */\n  async populateMaxSend () {\n    const page = this.page\n    const { id: assetID, unitInfo: ui, wallet } = app().assets[this.selectedAssetID]\n    // Populate send amount with max send value and ensure we don't check\n    // subtract checkbox for assets that don't have a withdraw method.\n    const xcRate = app().fiatRatesMap[assetID]\n    if ((wallet.traits & traitWithdrawer) === 0) {\n      page.sendAmt.value = String(this.maxSend / ui.conventional.conversionFactor)\n      Doc.showFiatValue(page.sendValue, this.maxSend, xcRate, ui)\n      page.subtractCheckBox.checked = false\n    } else {\n      const amt = wallet.balance.available\n      page.sendAmt.value = String(amt / ui.conventional.conversionFactor)\n      Doc.showFiatValue(page.sendValue, amt, xcRate, ui)\n      page.subtractCheckBox.checked = true\n    }\n  }\n\n  /* send submits the send form to the API. */\n  async send (): Promise<void> {\n    const page = this.page\n    const assetID = parseInt(page.sendForm.dataset.assetID ?? '')\n    const subtract = page.subtractCheckBox.checked ?? false\n    const conversionFactor = app().unitInfo(assetID).conventional.conversionFactor\n    const pw = page.vSendPw.value || ''\n    page.vSendPw.value = ''\n    if (pw === '') {\n      Doc.showFormError(page.vSendErr, intl.prep(intl.ID_NO_PASS_ERROR_MSG))\n      return\n    }\n    const open = {\n      assetID: assetID,\n      address: page.sendAddr.value,\n      subtract: subtract,\n      value: Math.round(parseFloatDefault(page.sendAmt.value) * conversionFactor),\n      pw: pw\n    }\n    const loaded = app().loading(page.vSendForm)\n    const res = await postJSON('/api/send', open)\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.vSendErr, res.msg)\n      return\n    }\n    const name = app().assets[assetID].name\n    this.assetUpdated(assetID, page.vSendForm, intl.prep(intl.ID_SEND_SUCCESS, { assetName: name }))\n  }\n\n  /* update wallet configuration */\n  async reconfig (): Promise<void> {\n    const page = this.page\n    const assetID = this.selectedAssetID\n    Doc.hide(page.reconfigErr)\n    let walletType = app().currentWalletDefinition(assetID).type\n    if (!Doc.isHidden(page.changeWalletType)) {\n      walletType = page.changeWalletTypeSelect.value || ''\n    }\n\n    const loaded = app().loading(page.reconfigForm)\n    const req: ReconfigRequest = {\n      assetID: assetID,\n      config: this.reconfigForm.map(assetID),\n      walletType: walletType\n    }\n    if (this.changeWalletPW) req.newWalletPW = page.newPW.value\n    const res = await this.safePost('/api/reconfigurewallet', req)\n    page.newPW.value = ''\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.reconfigErr, res.msg)\n      return\n    }\n    if (this.data?.goBack) {\n      app().loadPage(this.data.goBack)\n      return\n    }\n    this.assetUpdated(assetID, page.reconfigForm, intl.prep(intl.ID_RECONFIG_SUCCESS))\n    this.updateTicketBuyer(assetID)\n    app().clearTxHistory(assetID)\n    this.showTxHistory(assetID)\n    this.updatePrivacy(assetID)\n    this.checkNeedsProvider(assetID)\n  }\n\n  /* lock instructs the API to lock the wallet. */\n  async lock (assetID: number): Promise<void> {\n    const page = this.page\n    const loaded = app().loading(page.newWalletForm)\n    const res = await postJSON('/api/closewallet', { assetID: assetID })\n    loaded()\n    if (!app().checkResponse(res)) return\n    this.updateDisplayedAsset(assetID)\n    this.updatePrivacy(assetID)\n  }\n\n  async downloadLogs (): Promise<void> {\n    const search = new URLSearchParams('')\n    search.append('assetid', `${this.selectedAssetID}`)\n    const url = new URL(window.location.href)\n    url.search = search.toString()\n    url.pathname = '/wallets/logfile'\n    window.open(url.toString())\n  }\n\n  // displayExportWalletAuth displays a form to warn the user about the\n  // dangers of exporting a wallet, and asks them to enter their password.\n  async displayExportWalletAuth (): Promise<void> {\n    const page = this.page\n    Doc.hide(page.exportWalletErr)\n    page.exportWalletPW.value = ''\n    this.showForm(page.exportWalletAuth)\n  }\n\n  // exportWalletAuthSubmit is called after the user enters their password to\n  // authorize looking up the information to restore their wallet in an\n  // external wallet.\n  async exportWalletAuthSubmit (): Promise<void> {\n    const page = this.page\n    const req = {\n      assetID: this.selectedAssetID,\n      pass: page.exportWalletPW.value\n    }\n    const url = '/api/restorewalletinfo'\n    const loaded = app().loading(page.forms)\n    const res = await postJSON(url, req)\n    loaded()\n    if (app().checkResponse(res)) {\n      page.exportWalletPW.value = ''\n      this.displayRestoreWalletInfo(res.restorationinfo)\n    } else {\n      Doc.showFormError(page.exportWalletErr, res.msg)\n    }\n  }\n\n  // displayRestoreWalletInfo displays the information needed to restore a\n  // wallet in external wallets.\n  async displayRestoreWalletInfo (info: WalletRestoration[]): Promise<void> {\n    const page = this.page\n    Doc.empty(page.restoreInfoCardsList)\n    for (const wr of info) {\n      const card = this.restoreInfoCard.cloneNode(true) as HTMLElement\n      const tmpl = Doc.parseTemplate(card)\n      tmpl.name.textContent = wr.target\n      tmpl.seed.textContent = wr.seed\n      tmpl.seedName.textContent = `${wr.seedName}:`\n      tmpl.instructions.textContent = wr.instructions\n      page.restoreInfoCardsList.appendChild(card)\n    }\n    this.showForm(page.restoreWalletInfo)\n  }\n\n  async recoverWallet (): Promise<void> {\n    const page = this.page\n    Doc.hide(page.recoverWalletErr)\n    const req = {\n      assetID: this.selectedAssetID\n    }\n    const url = '/api/recoverwallet'\n    const loaded = app().loading(page.forms)\n    const res = await postJSON(url, req)\n    loaded()\n    if (res.code === Errors.activeOrdersErr) {\n      this.forceUrl = url\n      this.forceReq = req\n      this.showConfirmForce()\n    } else if (app().checkResponse(res)) {\n      this.closePopups()\n    } else {\n      Doc.showFormError(page.recoverWalletErr, res.msg)\n    }\n  }\n\n  /*\n   * confirmForceSubmit resubmits either the recover or rescan requests with\n   * force set to true. These two requests require force to be set to true if\n   * they are called while the wallet is managing active orders.\n   */\n  async confirmForceSubmit (): Promise<void> {\n    const page = this.page\n    this.forceReq.force = true\n    const loaded = app().loading(page.forms)\n    const res = await postJSON(this.forceUrl, this.forceReq)\n    loaded()\n    if (app().checkResponse(res)) this.closePopups()\n    else {\n      Doc.showFormError(page.confirmForceErr, res.msg)\n    }\n  }\n\n  /* handleBalance handles notifications updating a wallet's balance and assets'\n     value in default fiat rate.\n  . */\n  handleBalanceNote (note: BalanceNote): void {\n    this.updateAssetButton(note.assetID)\n    if (note.assetID === this.selectedAssetID) this.updateDisplayedAssetBalance()\n  }\n\n  /* handleRatesNote handles fiat rate notifications, updating the fiat value of\n   *  all supported assets.\n   */\n  handleRatesNote (note: RateNote): void {\n    this.updateAssetButton(this.selectedAssetID)\n    if (!note.fiatRates[this.selectedAssetID]) return\n    this.updateDisplayedAssetBalance()\n    const { feeState } = app().walletMap[this.selectedAssetID]\n    if (feeState) this.updateFeeState(feeState)\n  }\n\n  /*\n   * handleWalletStateNote is a handler for both the 'walletstate' and\n   * 'walletconfig' notifications.\n   */\n  handleWalletStateNote (note: WalletStateNote): void {\n    const { assetID, feeState } = note.wallet\n    this.updateAssetButton(assetID)\n    this.assetUpdated(assetID)\n    if (note.topic === 'WalletPeersUpdate' &&\n        assetID === this.selectedAssetID &&\n        Doc.isDisplayed(this.page.managePeersForm)) {\n      this.updateWalletPeersTable()\n    }\n    if (feeState && assetID === this.selectedAssetID) this.updateFeeState(feeState)\n  }\n\n  /*\n   * handleCreateWalletNote is a handler for 'createwallet' notifications.\n   */\n  handleCreateWalletNote (note: WalletCreationNote) {\n    this.updateAssetButton(note.assetID)\n    this.assetUpdated(note.assetID)\n    this.showTxHistory(note.assetID)\n  }\n\n  handleCustomWalletNote (note: WalletNote) {\n    const walletNote = note.payload as BaseWalletNote\n    switch (walletNote.route) {\n      case 'tipChange': {\n        const n = walletNote as TipChangeNote\n        switch (n.assetID) {\n          case 42: { // dcr\n            if (!this.stakeStatus) return\n            const data = n.data as DecredTicketTipUpdate\n            const synced = app().walletMap[n.assetID].synced\n            if (synced) {\n              const ui = app().unitInfo(n.assetID)\n              this.updateTicketStats(data.stats, ui, data.ticketPrice, data.votingSubsidy)\n            }\n          }\n        }\n        break\n      }\n      case 'ticketPurchaseUpdate': {\n        this.processTicketPurchaseUpdate(walletNote as CustomWalletNote)\n        break\n      }\n      case 'transaction': {\n        const n = walletNote as TransactionNote\n        if (n.assetID === this.selectedAssetID) this.handleTxNote(n.transaction, n.new)\n        break\n      }\n      case 'transactionHistorySynced' : {\n        const n = walletNote\n        if (n.assetID === this.selectedAssetID) this.showTxHistory(n.assetID)\n        break\n      }\n    }\n  }\n\n  /*\n   * unload is called by the Application when the user navigates away from\n   * the /wallets page.\n   */\n  unload (): void {\n    clearInterval(this.secondTicker)\n    Doc.unbind(document, 'keyup', this.keyup)\n  }\n}\n\nfunction trimStringWithEllipsis (str: string, maxLen: number): string {\n  if (str.length <= maxLen) return str\n  return `${str.substring(0, maxLen / 2)}...${str.substring(str.length - maxLen / 2)}`\n}\n","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","import { CoreNote, PageElement } from './registry'\nimport * as intl from './locales'\nimport State from './state'\nimport { setCoinHref } from './coinexplorers'\nimport Doc from './doc'\n\nexport const IGNORE = 0\nexport const DATA = 1\nexport const POKE = 2\nexport const SUCCESS = 3\nexport const WARNING = 4\nexport const ERROR = 5\n\n/*\n * make constructs a new notification. The notification structure is a mirror of\n * the structure of notifications sent from the web server.\n * NOTE: I'm hoping to make this function obsolete, since errors generated in\n * javascript should usually be displayed/cached somewhere better. For example,\n * if the error is generated during submission of a form, the error should be\n * displayed on or near the form itself, not in the notifications.\n */\nexport function make (subject: string, details: string, severity: number): CoreNote {\n  return {\n    subject: subject,\n    details: details,\n    severity: severity,\n    stamp: new Date().getTime(),\n    acked: false,\n    type: 'internal',\n    topic: 'internal',\n    id: ''\n  }\n}\n\nconst NoteTypeOrder = 'order'\nconst NoteTypeMatch = 'match'\nconst NoteTypeBondPost = 'bondpost'\nconst NoteTypeConnEvent = 'conn'\n\ntype DesktopNtfnSettingLabel = {\n  [x: string]: string\n}\n\nexport type DesktopNtfnSetting = {\n  [x: string]: boolean\n}\n\nfunction desktopNtfnSettingsKey (): string {\n  return `desktop_notifications-${window.location.host}`\n}\n\nexport const desktopNtfnLabels: DesktopNtfnSettingLabel = {\n  [NoteTypeOrder]: intl.ID_BROWSER_NTFN_ORDERS,\n  [NoteTypeMatch]: intl.ID_BROWSER_NTFN_MATCHES,\n  [NoteTypeBondPost]: intl.ID_BROWSER_NTFN_BONDS,\n  [NoteTypeConnEvent]: intl.ID_BROWSER_NTFN_CONNECTIONS\n}\n\nexport const defaultDesktopNtfnSettings: DesktopNtfnSetting = {\n  [NoteTypeOrder]: true,\n  [NoteTypeMatch]: true,\n  [NoteTypeBondPost]: true,\n  [NoteTypeConnEvent]: true\n}\n\nlet desktopNtfnSettings: DesktopNtfnSetting\n\n// BrowserNotifier is a wrapper around the browser's notification API.\nclass BrowserNotifier {\n  static ntfnPermissionGranted (): boolean {\n    return window.Notification.permission === 'granted'\n  }\n\n  static ntfnPermissionDenied (): boolean {\n    return window.Notification.permission === 'denied'\n  }\n\n  static async requestNtfnPermission (): Promise<void> {\n    if (!('Notification' in window)) {\n      return\n    }\n    if (BrowserNotifier.ntfnPermissionGranted()) {\n      BrowserNotifier.sendDesktopNotification(intl.prep(intl.ID_BROWSER_NTFN_ENABLED))\n    } else if (!BrowserNotifier.ntfnPermissionDenied()) {\n      await Notification.requestPermission()\n      BrowserNotifier.sendDesktopNotification(intl.prep(intl.ID_BROWSER_NTFN_ENABLED))\n    }\n  }\n\n  static async sendDesktopNotification (title: string, body?: string) {\n    if (!BrowserNotifier.ntfnPermissionGranted()) return\n    const ntfn = new window.Notification(title, {\n      body: body,\n      icon: '/img/softened-icon.png'\n    })\n    return ntfn\n  }\n}\n\n// OSDesktopNotifier manages OS desktop notifications via the same interface\n// as BrowserNotifier, but sends notifications using an underlying Go\n// notification library exposed to the webview.\nclass OSDesktopNotifier {\n  static ntfnPermissionGranted (): boolean {\n    return true\n  }\n\n  static ntfnPermissionDenied (): boolean {\n    return false\n  }\n\n  static async requestNtfnPermission (): Promise<void> {\n    await OSDesktopNotifier.sendDesktopNotification(intl.prep(intl.ID_BROWSER_NTFN_ENABLED))\n    return Promise.resolve()\n  }\n\n  static async sendDesktopNotification (title: string, body?: string): Promise<void> {\n    // webview/linux or webview/windows\n    if (isDesktopWebview()) await window.sendOSNotification(title, body)\n    // webkit/darwin\n    // See: client/cmd/bisonw-desktop/app_darwin.go#L673-#L697\n    else if (isDesktopWebkit()) await window.webkit.messageHandlers.bwHandler.postMessage(['sendOSNotification', title, body])\n    else console.error('sendDesktopNotification: unknown environment')\n  }\n}\n\n// isDesktopWebview checks if we are running in webview\nfunction isDesktopWebview (): boolean {\n  return window.isWebview !== undefined\n}\n\n// isDesktopDarwin returns true if we are running in a webview on darwin\n// It tests for the existence of the bwHandler webkit message handler.\nfunction isDesktopWebkit (): boolean {\n  return window.webkit?.messageHandlers?.bwHandler !== undefined\n}\n\n// determine whether we're running in a webview or in browser, and export\n// the appropriate notifier accordingly.\nexport const Notifier = isDesktopWebview() || isDesktopWebkit() ? OSDesktopNotifier : BrowserNotifier\n\nexport async function desktopNotify (note: CoreNote) {\n  if (!desktopNtfnSettings.browserNtfnEnabled || !desktopNtfnSettings[note.type]) return\n  await Notifier.sendDesktopNotification(note.subject, plainNote(note.details))\n}\n\nexport function fetchDesktopNtfnSettings (): DesktopNtfnSetting {\n  if (desktopNtfnSettings !== undefined) {\n    return desktopNtfnSettings\n  }\n  const k = desktopNtfnSettingsKey()\n  desktopNtfnSettings = (State.fetchLocal(k) ?? {}) as DesktopNtfnSetting\n  return desktopNtfnSettings\n}\n\nexport function updateNtfnSetting (noteType: string, enabled: boolean) {\n  fetchDesktopNtfnSettings()\n  desktopNtfnSettings[noteType] = enabled\n  State.storeLocal(desktopNtfnSettingsKey(), desktopNtfnSettings)\n}\n\nconst coinExplorerTokenRe = /\\{\\{\\{([^|]+)\\|([^}]+)\\}\\}\\}/g\nconst orderTokenRe = /\\{\\{\\{order\\|([^}]+)\\}\\}\\}/g\n\n/*\n * insertRichNote replaces tx and order hash tokens in the input string with\n * <a> elements that link to the asset's chain explorer and order details\n * view, and inserts the resulting HTML into the supplied parent element.\n */\nexport function insertRichNote (parent: PageElement, inputString: string) {\n  const s = inputString.replace(orderTokenRe, (_match, orderToken) => {\n    const link = document.createElement('a')\n    link.setAttribute('href', '/order/' + orderToken)\n    link.setAttribute('class', 'subtlelink')\n    link.textContent = orderToken.slice(0, 8)\n    return link.outerHTML\n  }).replace(coinExplorerTokenRe, (_match, assetID, hash) => {\n    const link = document.createElement('a')\n    link.setAttribute('data-explorer-coin', hash)\n    link.setAttribute('target', '_blank')\n    link.textContent = hash.slice(0, 8)\n    setCoinHref(assetID, link)\n    return link.outerHTML\n  })\n  const els = Doc.noderize(s).body\n  while (els.firstChild) parent.appendChild(els.firstChild)\n}\n\n/*\n * plainNote replaces tx and order hash tokens tokens in the input string with\n * shortened hashes, for rendering in browser notifications and popups.\n */\nexport function plainNote (inputString: string): string {\n  const replacedString = inputString.replace(coinExplorerTokenRe, (_match, _assetID, hash) => {\n    return hash.slice(0, 8)\n  })\n  return replacedString\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport State from './state'\nimport { postJSON } from './http'\nimport * as forms from './forms'\nimport * as intl from './locales'\nimport { setCoinHref } from './coinexplorers'\nimport {\n  updateNtfnSetting,\n  DesktopNtfnSetting,\n  fetchDesktopNtfnSettings,\n  desktopNtfnLabels,\n  Notifier\n} from './notifications'\nimport {\n  app,\n  Exchange,\n  PageElement,\n  PrepaidBondID\n} from './registry'\n\nconst animationLength = 300\n\nexport default class SettingsPage extends BasePage {\n  body: HTMLElement\n  currentDEX: Exchange\n  page: Record<string, PageElement>\n  forms: PageElement[]\n  fiatRateSources: PageElement[]\n  regAssetForm: forms.FeeAssetSelectionForm\n  confirmRegisterForm: forms.ConfirmRegistrationForm\n  newWalletForm: forms.NewWalletForm\n  walletWaitForm: forms.WalletWaitForm\n  dexAddrForm: forms.DEXAddressForm\n  appPassResetForm: forms.AppPassResetForm\n  currentForm: PageElement\n  keyup: (e: KeyboardEvent) => void\n\n  constructor (body: HTMLElement) {\n    super()\n    this.body = body\n    const page = this.page = Doc.idDescendants(body)\n\n    this.forms = Doc.applySelector(page.forms, ':scope > form')\n    this.fiatRateSources = Doc.applySelector(page.fiatRateSources, 'input[type=checkbox]')\n\n    page.darkMode.checked = State.fetchLocal(State.darkModeLK) === '1'\n    Doc.bind(page.darkMode, 'click', () => {\n      State.storeLocal(State.darkModeLK, page.darkMode.checked || false ? '1' : '0')\n      if (page.darkMode.checked) {\n        document.body.classList.add('dark')\n      } else {\n        document.body.classList.remove('dark')\n      }\n    })\n\n    page.showPokes.checked = State.fetchLocal(State.popupsLK) === '1'\n    Doc.bind(page.showPokes, 'click', () => {\n      const show = page.showPokes.checked || false\n      State.storeLocal(State.popupsLK, show ? '1' : '0')\n      app().showPopups = show\n    })\n\n    page.commitHash.textContent = app().commitHash.substring(0, 7)\n    Doc.bind(page.addADex, 'click', () => {\n      this.dexAddrForm.refresh()\n      this.showForm(page.dexAddrForm)\n    })\n\n    this.fiatRateSources.forEach(src => {\n      Doc.bind(src, 'change', async () => {\n        const res = await postJSON('/api/toggleratesource', {\n          disable: !src.checked,\n          source: src.value\n        })\n        if (!app().checkResponse(res)) {\n          src.checked = !src.checked\n        }\n        // Update asset rate values and disable conversion status.\n        await app().fetchUser()\n      })\n    })\n\n    // Asset selection\n    this.regAssetForm = new forms.FeeAssetSelectionForm(page.regAssetForm, async (assetID: number, tier: number) => {\n      if (assetID === PrepaidBondID) {\n        await app().fetchUser()\n        window.location.reload()\n        return\n      }\n      const asset = app().assets[assetID]\n      const wallet = asset.wallet\n      if (wallet) {\n        const bondAsset = this.currentDEX.bondAssets[asset.symbol]\n        const bondsFeeBuffer = await this.getBondsFeeBuffer(assetID, page.regAssetForm)\n        this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer)\n        if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + bondsFeeBuffer) {\n          this.animateConfirmForm(page.regAssetForm)\n          return\n        }\n        this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier)\n        this.slideSwap(page.walletWait)\n        return\n      }\n\n      this.confirmRegisterForm.setAsset(assetID, tier, 0)\n      this.newWalletForm.setAsset(assetID)\n      this.slideSwap(page.newWalletForm)\n    })\n\n    // Approve fee payment\n    this.confirmRegisterForm = new forms.ConfirmRegistrationForm(page.confirmRegForm, () => {\n      this.registerDEXSuccess()\n    }, () => {\n      this.animateRegAsset(page.confirmRegForm)\n    })\n\n    // Create a new wallet\n    this.newWalletForm = new forms.NewWalletForm(\n      page.newWalletForm,\n      assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier),\n      () => this.animateRegAsset(page.newWalletForm)\n    )\n\n    this.walletWaitForm = new forms.WalletWaitForm(page.walletWait, () => {\n      this.animateConfirmForm(page.walletWait)\n    }, () => { this.animateRegAsset(page.walletWait) })\n\n    // Enter an address for a new DEX\n    this.dexAddrForm = new forms.DEXAddressForm(page.dexAddrForm, async (xc: Exchange, certFile: string) => {\n      this.currentDEX = xc\n      this.confirmRegisterForm.setExchange(xc, certFile)\n      this.walletWaitForm.setExchange(xc)\n      this.regAssetForm.setExchange(xc, certFile)\n      this.animateRegAsset(page.dexAddrForm)\n    })\n\n    Doc.bind(page.importAccount, 'click', () => this.prepareAccountImport(page.authorizeAccountImportForm))\n    forms.bind(page.authorizeAccountImportForm, page.authorizeImportAccountConfirm, () => this.importAccount())\n\n    Doc.bind(page.changeAppPW, 'click', () => this.showForm(page.changeAppPWForm))\n    forms.bind(page.changeAppPWForm, page.submitNewPW, () => this.changeAppPW())\n\n    this.appPassResetForm = new forms.AppPassResetForm(page.resetAppPWForm, async () => {\n      await app().loadPage('login')\n      Doc.hide(page.forms)\n    })\n    Doc.bind(page.resetAppPW, 'click', () => {\n      this.appPassResetForm.refresh()\n      this.showForm(page.resetAppPWForm)\n      this.appPassResetForm.focus()\n    })\n\n    Doc.bind(page.accountFile, 'change', () => this.onAccountFileChange())\n    Doc.bind(page.removeAccount, 'click', () => this.clearAccountFile())\n    Doc.bind(page.addAccount, 'click', () => page.accountFile.click())\n\n    Doc.bind(page.exportSeed, 'click', () => {\n      Doc.hide(page.exportSeedErr)\n      this.showForm(page.exportSeedAuth)\n    })\n    forms.bind(page.exportSeedAuth, page.exportSeedSubmit, () => this.submitExportSeedReq())\n\n    Doc.bind(page.gameCodeLink, 'click', () => this.showForm(page.gameCodeForm))\n    Doc.bind(page.gameCodeSubmit, 'click', () => this.submitGameCode())\n\n    const closePopups = () => {\n      Doc.hide(page.forms)\n      page.exportSeedPW.value = ''\n      page.legacySeed.textContent = ''\n      page.mnemonic.textContent = ''\n    }\n\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) { closePopups() }\n    })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        closePopups()\n      }\n    }\n    Doc.bind(document, 'keyup', this.keyup)\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { closePopups() })\n    })\n\n    this.renderDesktopNtfnSettings()\n  }\n\n  updateNtfnSetting (e: Event) {\n    const checkbox = e.target as HTMLInputElement\n    const noteType = checkbox.getAttribute('name')\n    if (noteType === null) return\n    const enabled = checkbox.checked\n    updateNtfnSetting(noteType, enabled)\n  }\n\n  getBrowserNtfnSettings (): DesktopNtfnSetting {\n    const permissions = fetchDesktopNtfnSettings()\n    return permissions\n  }\n\n  async renderDesktopNtfnSettings () {\n    const page = this.page\n    const ntfnSettings = this.getBrowserNtfnSettings()\n    const labels = desktopNtfnLabels\n    const tmpl = page.browserNtfnCheckboxTemplate\n    tmpl.removeAttribute('id')\n    const container = page.browserNtfnCheckboxContainer\n    Doc.empty(page.browserNtfnCheckboxContainer)\n\n    Object.keys(labels).forEach((noteType) => {\n      const html = tmpl.cloneNode(true) as PageElement\n      const enabled = ntfnSettings[noteType]\n      const checkbox = Doc.tmplElement(html, 'checkbox')\n      Doc.tmplElement(html, 'label').textContent = intl.prep(labels[noteType])\n      checkbox.setAttribute('name', noteType)\n      if (enabled) checkbox.setAttribute('checked', 'checked')\n      container.appendChild(html)\n      Doc.bind(checkbox, 'click', this.updateNtfnSetting)\n    })\n\n    const enabledCheckbox = page.browserNtfnEnabled\n\n    Doc.bind(enabledCheckbox, 'click', async (e: Event) => {\n      if (Notifier.ntfnPermissionDenied()) return\n      const checkbox = e.target as HTMLInputElement\n      if (checkbox.checked) {\n        await Notifier.requestNtfnPermission()\n        checkbox.checked = !Notifier.ntfnPermissionDenied()\n      }\n      this.updateNtfnSetting(e)\n      checkbox.dispatchEvent(new Event('change'))\n    })\n\n    Doc.bind(enabledCheckbox, 'change', (e: Event) => {\n      const checkbox = e.target as HTMLInputElement\n      const permDenied = Notifier.ntfnPermissionDenied()\n      Doc.setVis(checkbox.checked, page.browserNtfnCheckboxContainer)\n      Doc.setVis(permDenied, page.browserNtfnBlockedMsg)\n      checkbox.disabled = permDenied\n    })\n\n    enabledCheckbox.checked = (Notifier.ntfnPermissionGranted() && ntfnSettings.browserNtfnEnabled)\n    enabledCheckbox.dispatchEvent(new Event('change'))\n  }\n\n  /*\n   * slideSwap animates the replacement of the currently shown form with the\n   * newForm and sets this.currentForm.\n   */\n  slideSwap (newForm: PageElement) {\n    forms.slideSwap(this.currentForm, newForm)\n    this.currentForm = newForm\n  }\n\n  // Retrieve an estimate for the tx fee needed to create new bond reserves.\n  async getBondsFeeBuffer (assetID: number, form: HTMLElement) {\n    const loaded = app().loading(form)\n    const res = await postJSON('/api/bondsfeebuffer', { assetID })\n    loaded()\n    if (!app().checkResponse(res)) {\n      return 0\n    }\n    return res.feeBuffer\n  }\n\n  async newWalletCreated (assetID: number, tier: number) {\n    const user = await app().fetchUser()\n    if (!user) return\n    const page = this.page\n    const asset = user.assets[assetID]\n    const wallet = asset.wallet\n    const bondAmt = this.currentDEX.bondAssets[asset.symbol].amount\n\n    const bondsFeeBuffer = await this.getBondsFeeBuffer(assetID, page.newWalletForm)\n    this.confirmRegisterForm.setFees(assetID, bondsFeeBuffer)\n    if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {\n      await this.animateConfirmForm(page.newWalletForm)\n      return\n    }\n\n    this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier)\n    this.slideSwap(page.walletWait)\n  }\n\n  async onAccountFileChange () {\n    const page = this.page\n    const files = page.accountFile.files\n    if (!files || !files.length) return\n    page.selectedAccount.textContent = files[0].name\n    Doc.show(page.removeAccount)\n    Doc.hide(page.addAccount)\n  }\n\n  /* clearAccountFile cleanup accountFile value and selectedAccount text */\n  clearAccountFile () {\n    const page = this.page\n    page.accountFile.value = ''\n    page.selectedAccount.textContent = intl.prep(intl.ID_NONE_SELECTED)\n    Doc.hide(page.removeAccount)\n    Doc.show(page.addAccount)\n  }\n\n  async prepareAccountImport (authorizeAccountImportForm: HTMLElement) {\n    const page = this.page\n    page.importAccountErr.textContent = ''\n    this.showForm(authorizeAccountImportForm)\n  }\n\n  // importAccount imports the account\n  async importAccount () {\n    const page = this.page\n    let accountString = ''\n    if (page.accountFile.value) {\n      const files = page.accountFile.files\n      if (!files || !files.length) {\n        console.error('importAccount: no file specified')\n        return\n      }\n      accountString = await files[0].text()\n    }\n    let account\n    try {\n      account = JSON.parse(accountString)\n    } catch (e) {\n      page.importAccountErr.textContent = e.message\n      Doc.show(page.importAccountErr)\n      return\n    }\n    if (typeof account === 'undefined') {\n      Doc.showFormError(page.importAccountErr, intl.prep(intl.ID_ACCT_UNDEFINED))\n      return\n    }\n    const { bonds = [], ...acctInf } = account\n    const req = {\n      account: acctInf,\n      bonds: bonds\n    }\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/importaccount', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.importAccountErr, res.msg)\n      return\n    }\n    await app().fetchUser()\n    Doc.hide(page.forms)\n    // Initial method of displaying imported account.\n    window.location.reload()\n  }\n\n  async submitExportSeedReq () {\n    const page = this.page\n    const pw = page.exportSeedPW.value\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/exportseed', { pass: pw })\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.exportSeedErr, res.msg)\n      return\n    }\n    page.exportSeedPW.value = ''\n    if (res.seed.length === 128 && res.seed.split(' ').length === 1) {\n      page.legacySeed.textContent = res.seed.match(/.{1,32}/g).map((chunk: string) => chunk.match(/.{1,8}/g)?.join(' ')).join('\\n')\n    } else page.mnemonic.textContent = res.seed\n    this.showForm(page.authorizeSeedDisplay)\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    const page = this.page\n    this.currentForm = form\n    this.forms.forEach(form => Doc.hide(form))\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  /* gets the contents of the cert file */\n  async getCertFile () {\n    let cert = ''\n    if (this.dexAddrForm.page.certFile.value) {\n      const files = this.dexAddrForm.page.certFile.files\n      if (files && files.length) cert = await files[0].text()\n    }\n    return cert\n  }\n\n  /* Called after successful registration to a DEX. */\n  async registerDEXSuccess () {\n    window.location.reload()\n  }\n\n  /* Change application password  */\n  async changeAppPW () {\n    const page = this.page\n    Doc.hide(page.changePWErrMsg)\n\n    const clearValues = () => {\n      page.appPW.value = ''\n      page.newAppPW.value = ''\n      page.confirmNewPW.value = ''\n    }\n    // Ensure password fields are nonempty.\n    if (!page.appPW.value || !page.newAppPW.value || !page.confirmNewPW.value) {\n      Doc.showFormError(page.changePWErrMsg, intl.prep(intl.ID_NO_APP_PASS_ERROR_MSG))\n      clearValues()\n      return\n    }\n    // Ensure password confirmation matches.\n    if (page.newAppPW.value !== page.confirmNewPW.value) {\n      Doc.showFormError(page.changePWErrMsg, intl.prep(intl.ID_PASSWORD_NOT_MATCH))\n      clearValues()\n      return\n    }\n    const loaded = app().loading(page.changeAppPW)\n    const req = {\n      appPW: page.appPW.value,\n      newAppPW: page.newAppPW.value\n    }\n    clearValues()\n    const res = await postJSON('/api/changeapppass', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      Doc.showFormError(page.changePWErrMsg, res.msg)\n      return\n    }\n    Doc.hide(page.forms)\n  }\n\n  /*\n   * unload is called by the Application when the user navigates away from\n   * the /settings page.\n   */\n  unload () {\n    Doc.unbind(document, 'keyup', this.keyup)\n  }\n\n  /* Swap in the asset selection form and run the animation. */\n  async animateRegAsset (oldForm: HTMLElement) {\n    Doc.hide(oldForm)\n    const form = this.page.regAssetForm\n    this.currentForm = form\n    this.regAssetForm.animate()\n    Doc.show(form)\n  }\n\n  /* Swap in the confirmation form and run the animation. */\n  async animateConfirmForm (oldForm: HTMLElement) {\n    this.confirmRegisterForm.animate()\n    const form = this.page.confirmRegForm\n    this.currentForm = form\n    Doc.hide(oldForm)\n    Doc.show(form)\n  }\n\n  async submitGameCode () {\n    const page = this.page\n    Doc.hide(page.gameCodeErr)\n    const code = page.gameCodeInput.value\n    if (!code) {\n      page.gameCodeErr.textContent = intl.prep(intl.ID_NO_CODE_PROVIDED)\n      Doc.show(page.gameCodeErr)\n      return\n    }\n    const msg = page.gameCodeMsg.value || ''\n    const loaded = app().loading(page.gameCodeForm)\n    const resp = await postJSON('/api/redeemgamecode', { code, msg })\n    loaded()\n    if (!app().checkResponse(resp)) {\n      page.gameCodeErr.textContent = intl.prep(intl.ID_API_ERROR, { msg: resp.msg })\n      Doc.show(page.gameCodeErr)\n      return\n    }\n    Doc.show(page.gameCodeSuccess)\n    page.gameRedeemTx.dataset.explorerCoin = resp.coinString\n    const dcrBipID = 42\n    setCoinHref(dcrBipID, page.gameRedeemTx)\n    page.gameRedeemTx.textContent = resp.coinString\n    const ui = app().unitInfo(dcrBipID)\n    page.gameRedeemValue.textContent = Doc.formatCoinValue(resp.win, ui)\n  }\n}\n","import {\n  MarketOrderBook,\n  MiniOrder\n} from './registry'\n\nexport default class OrderBook {\n  base: number\n  baseSymbol: string\n  quote: number\n  quoteSymbol: string\n  buys: MiniOrder[]\n  sells: MiniOrder[]\n\n  constructor (mktBook: MarketOrderBook, baseSymbol: string, quoteSymbol: string) {\n    this.base = mktBook.base\n    this.baseSymbol = baseSymbol\n    this.quote = mktBook.quote\n    this.quoteSymbol = quoteSymbol\n    // Books are sorted mid-gap first.\n    this.buys = mktBook.book.buys || []\n    this.sells = mktBook.book.sells || []\n  }\n\n  /* add adds an order to the order book. */\n  add (ord: MiniOrder) {\n    if (ord.qtyAtomic === 0) {\n      // TODO: Somebody, for the love of god, figure out why the hell this helps\n      // with the ghost orders problem. As far as I know, this order is a booked\n      // order that had more than one match in an epoch and completely filled.\n      // Because the first match didn't exhaust the order, there would be a\n      // 'update_remaining' notification scheduled for the order. But by the\n      // time OrderRouter generates the notification long after matching, the\n      // order has zero qty left to fill. It's all good though, kinda, because\n      // the notification is quickly followed with an 'unbook_order'\n      // notification. I have tried my damnedest to catch an update_remaining\n      // note without an accompanying unbook_order note, and have thus failed.\n      // Yet, this fix somehow seems to work. It's infuriating, tbh.\n      window.log('zeroqty', 'zero quantity order encountered', ord)\n      return\n    }\n    const side = ord.sell ? this.sells : this.buys\n    side.splice(findIdx(side, ord.rate, !ord.sell), 0, ord)\n  }\n\n  /* remove removes an order from the order book. */\n  remove (token: string) {\n    if (this.removeFromSide(this.sells, token)) return\n    this.removeFromSide(this.buys, token)\n  }\n\n  /* removeFromSide removes an order from the list of orders. */\n  removeFromSide (side: MiniOrder[], token: string) {\n    const [ord, i] = this.findOrder(side, token)\n    if (ord) {\n      side.splice(i, 1)\n      return true\n    }\n    return false\n  }\n\n  /* findOrder finds an order in a specified side */\n  findOrder (side: MiniOrder[], token: string): [MiniOrder | null, number] {\n    for (let i = 0; i < side.length; i++) {\n      if (side[i].token === token) {\n        return [side[i], i]\n      }\n    }\n    return [null, -1]\n  }\n\n  /* updates the remaining quantity of an order. */\n  updateRemaining (token: string, qty: number, qtyAtomic: number) {\n    if (this.updateRemainingSide(this.sells, token, qty, qtyAtomic)) return\n    this.updateRemainingSide(this.buys, token, qty, qtyAtomic)\n  }\n\n  /*\n   * updateRemainingSide looks for the order in the side and updates the\n   * quantity, returning true on success, false if order not found.\n   */\n  updateRemainingSide (side: MiniOrder[], token: string, qty: number, qtyAtomic: number) {\n    const ord = this.findOrder(side, token)[0]\n    if (ord) {\n      ord.qty = qty\n      ord.qtyAtomic = qtyAtomic\n      return true\n    }\n    return false\n  }\n\n  /*\n   * setEpoch sets the current epoch and clear any orders from previous epochs.\n   */\n  setEpoch (epochIdx: number) {\n    const approve = (ord: MiniOrder) => ord.epoch === undefined || ord.epoch === 0 || ord.epoch === epochIdx\n    this.sells = this.sells.filter(approve)\n    this.buys = this.buys.filter(approve)\n  }\n\n  /* empty will return true if both the buys and sells lists are empty. */\n  empty () {\n    return !this.sells.length && !this.buys.length\n  }\n\n  /* count is the total count of both buy and sell orders. */\n  count () {\n    return this.sells.length + this.buys.length\n  }\n\n  /* bestGapOrder will return the best non-epoch order if one exists, or the\n   * best epoch order if there are only epoch orders, or null if there are no\n   * orders.\n   */\n  bestGapOrder (side: MiniOrder[]) {\n    let best = null\n    for (const ord of side) {\n      if (!ord.epoch) return ord\n      if (!best) {\n        best = ord\n      }\n    }\n    return best\n  }\n\n  bestGapBuy () {\n    return this.bestGapOrder(this.buys)\n  }\n\n  bestGapSell () {\n    return this.bestGapOrder(this.sells)\n  }\n}\n\n/*\n * findIdx find the index at which to insert the order into the list of orders.\n */\nfunction findIdx (side: MiniOrder[], rate: number, less: boolean): number {\n  for (let i = 0; i < side.length; i++) {\n    if ((side[i].rate < rate) === less) return i\n  }\n  return side.length\n}\n","// MessageSocket is a WebSocket manager that uses the Decred DEX Message format\n// for communications.\n//\n// Message request format:\n// {\n//   route: 'name',\n//   id: int,\n//   payload: anything or nothing\n// }\n//\n// Message response payload will be a result object with either a valid 'result'\n// field or an 'error' field\n//\n// Functions for external use:\n// registerRoute (route, handler) -- register a function to handle events\n// of the given type\n// request (route, payload) -- create a JSON message in the above format and\n// send it\n//\n// Based on messagesocket_service.js by Jonathan Chappelow @ dcrdata, which is\n// based on ws_events_dispatcher.js by Ismael Celis\nconst typeRequest = 1\n\nfunction forward (route: string, payload: any, handlers: Record<string, ((payload: any) => void)[]>) {\n  if (!route && payload.error) {\n    const err = payload.error\n    console.error(`websocket error (code ${err.code}): ${err.message}`)\n    return\n  }\n  if (typeof handlers[route] === 'undefined') {\n    // console.log(`unhandled message for ${route}: ${payload}`)\n    return\n  }\n  // call each handler\n  for (let i = 0; i < handlers[route].length; i++) {\n    handlers[route][i](payload)\n  }\n}\n\nlet id = 0\n\ntype NoteReceiver = (payload: any) => void\n\nclass MessageSocket {\n  uri: string\n  connection: WebSocket | null\n  handlers: Record<string, NoteReceiver[]>\n  queue: [string, any][]\n  maxQlength: number\n  reloader: () => void // appears unused\n\n  constructor () {\n    this.handlers = {}\n    this.queue = []\n    this.maxQlength = 5\n  }\n\n  registerRoute (route: string, handler: NoteReceiver) {\n    this.handlers[route] = this.handlers[route] || []\n    this.handlers[route].push(handler)\n  }\n\n  deregisterRoute (route: string) {\n    this.handlers[route] = []\n  }\n\n  // request sends a request-type message to the server\n  request (route: string, payload: any) {\n    if (!this.connection || this.connection.readyState !== window.WebSocket.OPEN) {\n      while (this.queue.length > this.maxQlength - 1) this.queue.shift()\n      this.queue.push([route, payload])\n      return\n    }\n    id++\n    const message = JSON.stringify({\n      route: route,\n      type: typeRequest,\n      id: id,\n      payload: payload\n    })\n\n    window.log('ws', 'sending', message)\n    this.connection.send(message)\n  }\n\n  close (reason: string) {\n    window.log('ws', 'close, reason:', reason, this.handlers)\n    this.handlers = {}\n    if (this.connection) this.connection.close()\n  }\n\n  connect (uri: string, reloader: () => void) {\n    this.uri = uri\n    this.reloader = reloader\n    let retrys = 0\n    const go = () => {\n      window.log('ws', `connecting to ${uri}`)\n      let conn: WebSocket | null = this.connection = new window.WebSocket(uri)\n      if (!conn) return\n      const timeout = setTimeout(() => {\n        // readyState is still WebSocket.CONNECTING. Cancel and trigger onclose.\n        if (conn) conn.close()\n      }, 500)\n\n      // unmarshal message, and forward the message to registered handlers\n      conn.onmessage = (evt: MessageEvent) => {\n        const message = JSON.parse(evt.data)\n        forward(message.route, message.payload, this.handlers)\n      }\n\n      // Stub out standard functions\n      conn.onclose = (evt: CloseEvent) => {\n        window.log('ws', 'onclose')\n        clearTimeout(timeout)\n        conn = this.connection = null\n        forward('close', null, this.handlers)\n        retrys++\n        // 1.2, 1.6, 2.0, 2.4, 3.1, 3.8, 4.8, 6.0, 7.5, 9.3, ...\n        const delay = Math.min(Math.pow(1.25, retrys), 10)\n        console.error(`websocket disconnected (${evt.code}), trying again in ${delay.toFixed(1)} seconds`)\n        setTimeout(() => {\n          go()\n        }, delay * 1000)\n      }\n\n      conn.onopen = () => {\n        window.log('ws', 'onopen')\n        clearTimeout(timeout)\n        if (retrys > 0) {\n          retrys = 0\n          reloader()\n        }\n        forward('open', null, this.handlers)\n        const queue = this.queue\n        this.queue = []\n        for (const [route, message] of queue) {\n          this.request(route, message)\n        }\n      }\n\n      conn.onerror = (evt: Event) => {\n        window.log('ws', 'onerror:', evt)\n        forward('error', evt, this.handlers)\n      }\n    }\n    go()\n  }\n}\n\nconst ws = new MessageSocket()\nexport default ws\n","import Doc, { WalletIcons, parseFloatDefault } from './doc'\nimport State from './state'\nimport BasePage from './basepage'\nimport OrderBook from './orderbook'\nimport { ReputationMeter, tradingLimits, strongTier } from './account'\nimport {\n  CandleChart,\n  DepthChart,\n  DepthLine,\n  CandleReporters,\n  MouseReport,\n  VolumeReport,\n  DepthMarker,\n  Wave\n} from './charts'\nimport { postJSON } from './http'\nimport {\n  NewWalletForm,\n  AccelerateOrderForm,\n  DepositAddress,\n  TokenApprovalForm,\n  bind as bindForm,\n  Forms\n} from './forms'\nimport * as OrderUtil from './orderutil'\nimport ws from './ws'\nimport * as intl from './locales'\nimport {\n  app,\n  SupportedAsset,\n  PageElement,\n  Order,\n  Market,\n  OrderEstimate,\n  MaxOrderEstimate,\n  Exchange,\n  UnitInfo,\n  Asset,\n  Candle,\n  CandlesPayload,\n  TradeForm,\n  BookUpdate,\n  MaxSell,\n  MaxBuy,\n  SwapEstimate,\n  MarketOrderBook,\n  APIResponse,\n  PreSwap,\n  PreRedeem,\n  WalletStateNote,\n  WalletSyncNote,\n  WalletCreationNote,\n  SpotPriceNote,\n  BondNote,\n  OrderNote,\n  EpochNote,\n  BalanceNote,\n  MiniOrder,\n  RemainderUpdate,\n  ConnEventNote,\n  OrderOption,\n  ConnectionStatus,\n  RecentMatch,\n  MatchNote,\n  ApprovalStatus,\n  OrderFilter,\n  RunStatsNote,\n  RunEventNote,\n  EpochReportNote,\n  CEXProblemsNote\n} from './registry'\nimport { setOptionTemplates } from './opts'\nimport { RunningMarketMakerDisplay, RunningMMDisplayElements } from './mmutil'\n\nconst bind = Doc.bind\n\nconst bookRoute = 'book'\nconst bookOrderRoute = 'book_order'\nconst unbookOrderRoute = 'unbook_order'\nconst updateRemainingRoute = 'update_remaining'\nconst epochOrderRoute = 'epoch_order'\nconst candlesRoute = 'candles'\nconst candleUpdateRoute = 'candle_update'\nconst unmarketRoute = 'unmarket'\nconst epochMatchSummaryRoute = 'epoch_match_summary'\n\nconst anHour = 60 * 60 * 1000 // milliseconds\nconst maxUserOrdersShown = 10\n\nconst buyBtnClass = 'buygreen-bg'\nconst sellBtnClass = 'sellred-bg'\n\nconst fiveMinBinKey = '5m'\nconst oneHrBinKey = '1h'\n\nconst percentFormatter = new Intl.NumberFormat(Doc.languages(), {\n  minimumFractionDigits: 1,\n  maximumFractionDigits: 2\n})\n\nconst parentIDNone = 0xFFFFFFFF\n\ninterface MetaOrder {\n  div: HTMLElement\n  header: Record<string, PageElement>\n  details: Record<string, PageElement>\n  ord: Order\n  cancelling?: boolean\n}\n\ninterface CancelData {\n  bttn: PageElement\n  order: Order\n}\n\ninterface CurrentMarket {\n  dex: Exchange\n  sid: string // A string market identifier used by the DEX.\n  cfg: Market\n  base: SupportedAsset\n  quote: SupportedAsset\n  baseUnitInfo: UnitInfo\n  quoteUnitInfo: UnitInfo\n  maxSellRequested: boolean\n  maxSell: MaxOrderEstimate | null\n  sellBalance: number\n  buyBalance: number\n  maxBuys: Record<number, MaxOrderEstimate>\n  candleCaches: Record<string, CandlesPayload>\n  baseCfg: Asset\n  quoteCfg: Asset\n  rateConversionFactor: number\n  bookLoaded: boolean\n}\n\ninterface LoadTracker {\n  loaded: () => void\n  timer: number\n}\n\ninterface OrderRow extends HTMLElement {\n  manager: OrderTableRowManager\n}\n\ninterface StatsDisplay {\n  row: PageElement\n  tmpl: Record<string, PageElement>\n}\n\ninterface MarketsPageParams {\n  host: string\n  baseID: string\n  quoteID: string\n}\n\nexport default class MarketsPage extends BasePage {\n  page: Record<string, PageElement>\n  main: HTMLElement\n  maxLoaded: (() => void) | null\n  maxOrderUpdateCounter: number\n  market: CurrentMarket\n  openAsset: SupportedAsset\n  currentCreate: SupportedAsset\n  maxEstimateTimer: number | null\n  book: OrderBook\n  cancelData: CancelData\n  metaOrders: Record<string, MetaOrder>\n  preorderCache: Record<string, OrderEstimate>\n  currentOrder: TradeForm\n  depthLines: Record<string, DepthLine[]>\n  activeMarkerRate: number | null\n  hovers: HTMLElement[]\n  ogTitle: string\n  depthChart: DepthChart\n  candleChart: CandleChart\n  candleDur: string\n  balanceWgt: BalanceWidget\n  mm: RunningMarketMakerDisplay\n  marketList: MarketList\n  newWalletForm: NewWalletForm\n  depositAddrForm: DepositAddress\n  approveTokenForm: TokenApprovalForm\n  reputationMeter: ReputationMeter\n  keyup: (e: KeyboardEvent) => void\n  secondTicker: number\n  candlesLoading: LoadTracker | null\n  accelerateOrderForm: AccelerateOrderForm\n  recentMatches: RecentMatch[]\n  recentMatchesSortKey: string\n  recentMatchesSortDirection: 1 | -1\n  stats: [StatsDisplay, StatsDisplay]\n  loadingAnimations: { candles?: Wave, depth?: Wave }\n  mmRunning: boolean | undefined\n  forms: Forms\n  constructor (main: HTMLElement, pageParams: MarketsPageParams) {\n    super()\n\n    const page = this.page = Doc.idDescendants(main)\n    this.main = main\n    if (!this.main.parentElement) return // Not gonna happen, but TypeScript cares.\n    // There may be multiple pending updates to the max order. This makes sure\n    // that the screen is updated with the most recent one.\n    this.maxOrderUpdateCounter = 0\n    this.metaOrders = {}\n    this.recentMatches = []\n    this.preorderCache = {}\n    this.depthLines = {\n      hover: [],\n      input: []\n    }\n    this.hovers = []\n    // 'Recent Matches' list sort key and direction.\n    this.recentMatchesSortKey = 'age'\n    this.recentMatchesSortDirection = -1\n    // store original title so we can re-append it when updating market value.\n    this.ogTitle = document.title\n    this.forms = new Forms(page.forms, {\n      closed: (closedForm: PageElement | undefined) => {\n        if (closedForm === page.vDetailPane) {\n          this.showVerifyForm()\n        }\n      }\n    })\n\n    const depthReporters = {\n      click: (x: number) => { this.reportDepthClick(x) },\n      volume: (r: VolumeReport) => { this.reportDepthVolume(r) },\n      mouse: (r: MouseReport) => { this.reportDepthMouse(r) },\n      zoom: (z: number) => { this.reportDepthZoom(z) }\n    }\n    this.depthChart = new DepthChart(page.depthChart, depthReporters, State.fetchLocal(State.depthZoomLK))\n\n    const candleReporters: CandleReporters = {\n      mouse: c => { this.reportMouseCandle(c) }\n    }\n    this.candleChart = new CandleChart(page.candlesChart, candleReporters)\n\n    const success = () => { /* do nothing */ }\n    // Do not call cleanTemplates before creating the AccelerateOrderForm\n    this.accelerateOrderForm = new AccelerateOrderForm(page.accelerateForm, success)\n\n    this.approveTokenForm = new TokenApprovalForm(page.approveTokenForm)\n\n    // Set user's last known candle duration.\n    this.candleDur = State.fetchLocal(State.lastCandleDurationLK) || oneHrBinKey\n\n    // Setup the register to trade button.\n    // TODO: Use dexsettings page?\n    const registerBttn = Doc.tmplElement(page.notRegistered, 'registerBttn')\n    bind(registerBttn, 'click', () => {\n      app().loadPage('register', { host: this.market.dex.host })\n    })\n\n    // Set up the BalanceWidget.\n    {\n      page.walletInfoTmpl.removeAttribute('id')\n      const bWidget = page.walletInfoTmpl\n      const qWidget = page.walletInfoTmpl.cloneNode(true) as PageElement\n      bWidget.after(qWidget)\n      const wgt = this.balanceWgt = new BalanceWidget(bWidget, qWidget)\n      const baseIcons = wgt.base.stateIcons.icons\n      const quoteIcons = wgt.quote.stateIcons.icons\n      bind(wgt.base.tmpl.connect, 'click', () => { this.unlockWallet(this.market.base.id) })\n      bind(wgt.quote.tmpl.connect, 'click', () => { this.unlockWallet(this.market.quote.id) })\n      bind(wgt.base.tmpl.expired, 'click', () => { this.unlockWallet(this.market.base.id) })\n      bind(wgt.quote.tmpl.expired, 'click', () => { this.unlockWallet(this.market.quote.id) })\n      bind(baseIcons.sleeping, 'click', () => { this.unlockWallet(this.market.base.id) })\n      bind(quoteIcons.sleeping, 'click', () => { this.unlockWallet(this.market.quote.id) })\n      bind(baseIcons.locked, 'click', () => { this.unlockWallet(this.market.base.id) })\n      bind(quoteIcons.locked, 'click', () => { this.unlockWallet(this.market.quote.id) })\n      bind(baseIcons.disabled, 'click', () => { this.showToggleWalletStatus(this.market.base) })\n      bind(quoteIcons.disabled, 'click', () => { this.showToggleWalletStatus(this.market.quote) })\n      bind(wgt.base.tmpl.newWalletBttn, 'click', () => { this.showCreate(this.market.base) })\n      bind(wgt.quote.tmpl.newWalletBttn, 'click', () => { this.showCreate(this.market.quote) })\n      bind(wgt.base.tmpl.walletAddr, 'click', () => { this.showDeposit(this.market.base.id) })\n      bind(wgt.quote.tmpl.walletAddr, 'click', () => { this.showDeposit(this.market.quote.id) })\n      bind(wgt.base.tmpl.wantProviders, 'click', () => { this.showCustomProviderDialog(this.market.base.id) })\n      bind(wgt.quote.tmpl.wantProviders, 'click', () => { this.showCustomProviderDialog(this.market.quote.id) })\n      this.depositAddrForm = new DepositAddress(page.deposit)\n    }\n\n    const runningMMDisplayElements: RunningMMDisplayElements = {\n      orderReportForm: page.orderReportForm,\n      dexBalancesRowTmpl: page.dexBalancesRowTmpl,\n      placementRowTmpl: page.placementRowTmpl,\n      placementAmtRowTmpl: page.placementAmtRowTmpl\n    }\n    Doc.cleanTemplates(page.dexBalancesRowTmpl, page.placementRowTmpl, page.placementAmtRowTmpl)\n    this.mm = new RunningMarketMakerDisplay(page.mmRunning, this.forms, runningMMDisplayElements, 'markets')\n\n    this.reputationMeter = new ReputationMeter(page.reputationMeter)\n\n    // Bind toggle wallet status form.\n    bindForm(page.toggleWalletStatusConfirm, page.toggleWalletStatusSubmit, async () => { this.toggleWalletStatus() })\n\n    // Prepare templates for the buy and sell tables and the user's order table.\n    setOptionTemplates(page)\n\n    Doc.cleanTemplates(\n      page.orderRowTmpl, page.durBttnTemplate, page.booleanOptTmpl, page.rangeOptTmpl,\n      page.orderOptTmpl, page.userOrderTmpl, page.recentMatchesTemplate\n    )\n\n    // Buttons to show token approval form\n    bind(page.approveBaseBttn, 'click', () => { this.showTokenApprovalForm(true) })\n    bind(page.approveQuoteBttn, 'click', () => { this.showTokenApprovalForm(false) })\n\n    const toggleTradingTier = (show: boolean) => {\n      Doc.setVis(!show, page.showTradingTier)\n      Doc.setVis(show, page.tradingLimits, page.hideTradingTier)\n    }\n    bind(page.showTradingTier, 'click', () => { toggleTradingTier(true) })\n    bind(page.hideTradingTier, 'click', () => { toggleTradingTier(false) })\n\n    const toggleTradingReputation = (show: boolean) => {\n      Doc.setVis(!show, page.showTradingReputation)\n      Doc.setVis(show, page.reputationMeter, page.hideTradingReputation)\n    }\n    bind(page.showTradingReputation, 'click', () => { toggleTradingReputation(true) })\n    bind(page.hideTradingReputation, 'click', () => { toggleTradingReputation(false) })\n\n    // Buttons to set order type and side.\n    bind(page.buyBttn, 'click', () => { this.setBuy() })\n    bind(page.sellBttn, 'click', () => { this.setSell() })\n\n    bind(page.limitBttn, 'click', () => {\n      swapBttns(page.marketBttn, page.limitBttn)\n      this.setOrderVisibility()\n      if (!page.rateField.value) return\n      this.depthLines.input = [{\n        rate: parseFloatDefault(page.rateField.value, 0),\n        color: this.isSell() ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine\n      }]\n      this.drawChartLines()\n    })\n    bind(page.marketBttn, 'click', () => {\n      swapBttns(page.limitBttn, page.marketBttn)\n      this.setOrderVisibility()\n      this.setMarketBuyOrderEstimate()\n      this.depthLines.input = []\n      this.drawChartLines()\n    })\n    bind(page.maxOrd, 'click', () => {\n      if (this.isSell()) {\n        const maxSell = this.market.maxSell\n        if (!maxSell) return\n        page.lotField.value = String(maxSell.swap.lots)\n      } else {\n        const maxBuy = this.market.maxBuys[this.adjustedRate()]\n        if (!maxBuy) return\n        page.lotField.value = String(maxBuy.swap.lots)\n      }\n      this.lotChanged()\n    })\n\n    Doc.disableMouseWheel(page.rateField, page.lotField, page.qtyField, page.mktBuyField)\n\n    // Handle the full orderbook sent on the 'book' route.\n    ws.registerRoute(bookRoute, (data: BookUpdate) => { this.handleBookRoute(data) })\n    // Handle the new order for the order book on the 'book_order' route.\n    ws.registerRoute(bookOrderRoute, (data: BookUpdate) => { this.handleBookOrderRoute(data) })\n    // Remove the order sent on the 'unbook_order' route from the orderbook.\n    ws.registerRoute(unbookOrderRoute, (data: BookUpdate) => { this.handleUnbookOrderRoute(data) })\n    // Update the remaining quantity on a booked order.\n    ws.registerRoute(updateRemainingRoute, (data: BookUpdate) => { this.handleUpdateRemainingRoute(data) })\n    // Handle the new order for the order book on the 'epoch_order' route.\n    ws.registerRoute(epochOrderRoute, (data: BookUpdate) => { this.handleEpochOrderRoute(data) })\n    // Handle the initial candlestick data on the 'candles' route.\n    ws.registerRoute(candlesRoute, (data: BookUpdate) => { this.handleCandlesRoute(data) })\n    // Handle the candles update on the 'candles' route.\n    ws.registerRoute(candleUpdateRoute, (data: BookUpdate) => { this.handleCandleUpdateRoute(data) })\n\n    // Handle the recent matches update on the 'epoch_report' route.\n    ws.registerRoute(epochMatchSummaryRoute, (data: BookUpdate) => { this.handleEpochMatchSummary(data) })\n    // Create a wallet\n    this.newWalletForm = new NewWalletForm(page.newWalletForm, async () => { this.createWallet() })\n    // Main order form.\n    bindForm(page.orderForm, page.submitBttn, async () => { this.stepSubmit() })\n    // Order verification form.\n    bindForm(page.verifyForm, page.vSubmit, async () => { this.submitOrder() })\n    // Cancel order form.\n    bindForm(page.cancelForm, page.cancelSubmit, async () => { this.submitCancel() })\n    // Order detail view.\n    Doc.bind(page.vFeeDetails, 'click', () => this.forms.show(page.vDetailPane))\n    Doc.bind(page.closeDetailPane, 'click', () => this.showVerifyForm())\n    // // Bind active orders list's header sort events.\n    page.recentMatchesTable.querySelectorAll('[data-ordercol]')\n      .forEach((th: HTMLElement) => bind(\n        th, 'click', () => setRecentMatchesSortCol(th.dataset.ordercol || '')\n      ))\n\n    const setRecentMatchesSortCol = (key: string) => {\n      // First unset header's current sorted col classes.\n      unsetRecentMatchesSortColClasses()\n      if (this.recentMatchesSortKey === key) {\n        this.recentMatchesSortDirection *= -1\n      } else {\n        this.recentMatchesSortKey = key\n        this.recentMatchesSortDirection = 1\n      }\n      this.refreshRecentMatchesTable()\n      setRecentMatchesSortColClasses()\n    }\n\n    // sortClassByDirection receives a sort direction and return a class based on it.\n    const sortClassByDirection = (element: 1 | -1) => {\n      if (element === 1) return 'sorted-asc'\n      return 'sorted-dsc'\n    }\n\n    const unsetRecentMatchesSortColClasses = () => {\n      page.recentMatchesTable.querySelectorAll('[data-ordercol]')\n        .forEach(th => th.classList.remove('sorted-asc', 'sorted-dsc'))\n    }\n\n    const setRecentMatchesSortColClasses = () => {\n      const key = this.recentMatchesSortKey\n      const sortCls = sortClassByDirection(this.recentMatchesSortDirection)\n      Doc.safeSelector(page.recentMatchesTable, `[data-ordercol=${key}]`).classList.add(sortCls)\n    }\n\n    // Set default's sorted col header classes.\n    setRecentMatchesSortColClasses()\n\n    const closePopups = () => {\n      this.forms.close()\n    }\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        closePopups()\n      }\n    }\n    bind(document, 'keyup', this.keyup)\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { closePopups() })\n    })\n\n    // Event listeners for interactions with the various input fields.\n    bind(page.lotField, ['change', 'keyup'], () => { this.lotChanged() })\n    bind(page.qtyField, 'change', () => { this.quantityChanged(true) })\n    bind(page.qtyField, 'keyup', () => { this.quantityChanged(false) })\n    bind(page.mktBuyField, ['change', 'keyup'], () => { this.marketBuyChanged() })\n    bind(page.rateField, 'change', () => { this.rateFieldChanged() })\n    bind(page.rateField, 'keyup', () => { this.previewQuoteAmt(true) })\n\n    // Market search input bindings.\n    bind(page.marketSearchV1, ['change', 'keyup'], () => { this.filterMarkets() })\n\n    // Acknowledge the order disclaimer.\n    const setDisclaimerAckViz = (acked: boolean) => {\n      Doc.setVis(!acked, page.disclaimer, page.disclaimerAck)\n      Doc.setVis(acked, page.showDisclaimer)\n    }\n    bind(page.disclaimerAck, 'click', () => {\n      State.storeLocal(State.orderDisclaimerAckedLK, true)\n      setDisclaimerAckViz(true)\n    })\n    bind(page.showDisclaimer, 'click', () => {\n      State.storeLocal(State.orderDisclaimerAckedLK, false)\n      setDisclaimerAckViz(false)\n    })\n    setDisclaimerAckViz(State.fetchLocal(State.orderDisclaimerAckedLK))\n\n    const clearChartLines = () => {\n      this.depthLines.hover = []\n      this.drawChartLines()\n    }\n    bind(page.buyRows, 'mouseleave', clearChartLines)\n    bind(page.sellRows, 'mouseleave', clearChartLines)\n    bind(page.userOrders, 'mouseleave', () => {\n      this.activeMarkerRate = null\n      this.setDepthMarkers()\n    })\n\n    const stats0 = page.marketStats\n    const stats1 = stats0.cloneNode(true) as PageElement\n    stats1.classList.add('listopen')\n    Doc.hide(stats0, stats1)\n    stats1.removeAttribute('id')\n    app().headerSpace.appendChild(stats1)\n    this.stats = [{ row: stats0, tmpl: Doc.parseTemplate(stats0) }, { row: stats1, tmpl: Doc.parseTemplate(stats1) }]\n\n    const closeMarketsList = () => {\n      State.storeLocal(State.leftMarketDockLK, '0')\n      page.leftMarketDock.classList.remove('default')\n      page.leftMarketDock.classList.add('stashed')\n      for (const s of this.stats) s.row.classList.remove('listopen')\n    }\n    const openMarketsList = () => {\n      State.storeLocal(State.leftMarketDockLK, '1')\n      page.leftMarketDock.classList.remove('default', 'stashed')\n      for (const s of this.stats) s.row.classList.add('listopen')\n    }\n    Doc.bind(page.leftHider, 'click', () => closeMarketsList())\n    Doc.bind(page.marketReopener, 'click', () => openMarketsList())\n    for (const s of this.stats) {\n      Doc.bind(s.tmpl.marketSelect, 'click', () => {\n        if (page.leftMarketDock.clientWidth === 0) openMarketsList()\n        else closeMarketsList()\n      })\n    }\n    this.marketList = new MarketList(page.marketListV1)\n    // Prepare the list of markets.\n    for (const row of this.marketList.markets) {\n      bind(row.node, 'click', () => {\n        // return early if the market is already set\n        const { quoteid: quoteID, baseid: baseID, xc: { host } } = row.mkt\n        if (this.market?.base?.id === baseID && this.market?.quote?.id === quoteID) return\n        this.startLoadingAnimations()\n        this.setMarket(host, baseID, quoteID)\n      })\n    }\n    if (State.fetchLocal(State.leftMarketDockLK) !== '1') { // It is shown by default, hiding if necessary.\n      closeMarketsList()\n    }\n\n    // Notification filters.\n    app().registerNoteFeeder({\n      order: (note: OrderNote) => { this.handleOrderNote(note) },\n      match: (note: MatchNote) => { this.handleMatchNote(note) },\n      epoch: (note: EpochNote) => { this.handleEpochNote(note) },\n      conn: (note: ConnEventNote) => { this.handleConnNote(note) },\n      balance: (note: BalanceNote) => { this.handleBalanceNote(note) },\n      bondpost: (note: BondNote) => { this.handleBondUpdate(note) },\n      spots: (note: SpotPriceNote) => { this.handlePriceUpdate(note) },\n      walletstate: (note: WalletStateNote) => { this.handleWalletState(note) },\n      reputation: () => { this.updateReputation() },\n      feepayment: () => { this.updateReputation() },\n      runstats: (note: RunStatsNote) => {\n        this.mm.update()\n        if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host) return\n        if (Boolean(this.mmRunning) !== Boolean(note.stats)) {\n          this.mmRunning = Boolean(note.stats)\n          this.resolveOrderFormVisibility()\n        }\n      },\n      epochreport: (note: EpochReportNote) => {\n        if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host) return\n        this.mm.handleEpochReportNote(note)\n      },\n      cexproblems: (note: CEXProblemsNote) => {\n        if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host) return\n        this.mm.handleCexProblemsNote(note)\n      },\n      runevent: (note: RunEventNote) => {\n        if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host) return\n        this.mm.update()\n      }\n    })\n\n    this.loadingAnimations = {}\n    this.startLoadingAnimations()\n\n    // Start a ticker to update time-since values.\n    this.secondTicker = window.setInterval(() => {\n      for (const mord of Object.values(this.metaOrders)) {\n        mord.details.age.textContent = Doc.timeSince(mord.ord.submitTime)\n      }\n      for (const td of Doc.applySelector(page.recentMatchesLiveList, '[data-tmpl=age]')) {\n        td.textContent = Doc.timeSince(parseFloat(td.dataset.sinceStamp ?? '0'))\n      }\n    }, 1000)\n\n    this.init(pageParams)\n  }\n\n  async init (pageParams?: MarketsPageParams) {\n    // Fetch the first market in the list, or the users last selected market, if\n    // it exists.\n    let selected\n    if (pageParams?.host) {\n      selected = makeMarket(pageParams.host, parseInt(pageParams.baseID), parseInt(pageParams.quoteID))\n    } else {\n      selected = State.fetchLocal(State.lastMarketLK)\n    }\n    if (!selected || !this.marketList.exists(selected.host, selected.base, selected.quote)) {\n      const first = this.marketList.first()\n      if (first) selected = { host: first.mkt.xc.host, base: first.mkt.baseid, quote: first.mkt.quoteid }\n    }\n    if (selected) this.setMarket(selected.host, selected.base, selected.quote)\n    else this.balanceWgt.setBalanceVisibility(false) // no market to display balance widget for.\n\n    // set the initial state for the registration status\n    this.setRegistrationStatusVisibility()\n  }\n\n  startLoadingAnimations () {\n    const { page, loadingAnimations: anis, depthChart, candleChart } = this\n    depthChart.canvas.classList.add('invisible')\n    candleChart.canvas.classList.add('invisible')\n    if (anis.candles) anis.candles.stop()\n    anis.candles = new Wave(page.candlesChart, { message: intl.prep(intl.ID_CANDLES_LOADING) })\n    if (anis.depth) anis.depth.stop()\n    anis.depth = new Wave(page.depthChart, { message: intl.prep(intl.ID_DEPTH_LOADING) })\n  }\n\n  /* isSell is true if the user has selected sell in the order options. */\n  isSell () {\n    return this.page.sellBttn.classList.contains('selected')\n  }\n\n  /* isLimit is true if the user has selected the \"limit order\" tab. */\n  isLimit () {\n    return this.page.limitBttn.classList.contains('selected')\n  }\n\n  setBuy () {\n    const { page } = this\n    swapBttns(page.sellBttn, page.buyBttn)\n    page.submitBttn.classList.remove(sellBtnClass)\n    page.submitBttn.classList.add(buyBtnClass)\n    page.maxLbl.textContent = intl.prep(intl.ID_BUY)\n    this.setOrderBttnText()\n    this.setOrderVisibility()\n    this.drawChartLines()\n    if (!this.isLimit()) {\n      this.marketBuyChanged()\n    } else {\n      this.currentOrder = this.parseOrder()\n      this.updateOrderBttnState()\n    }\n  }\n\n  setSell () {\n    const { page } = this\n    swapBttns(page.buyBttn, page.sellBttn)\n    page.submitBttn.classList.add(sellBtnClass)\n    page.submitBttn.classList.remove(buyBtnClass)\n    page.maxLbl.textContent = intl.prep(intl.ID_SELL)\n    this.setOrderBttnText()\n    this.setOrderVisibility()\n    this.drawChartLines()\n    this.currentOrder = this.parseOrder()\n    this.updateOrderBttnState()\n  }\n\n  /* hasPendingBonds is true if there are pending bonds */\n  hasPendingBonds (): boolean {\n    return Object.keys(this.market.dex.auth.pendingBonds || []).length > 0\n  }\n\n  /* setCurrMarketPrice updates the current market price on the stats displays\n     and the orderbook display. */\n  setCurrMarketPrice (): void {\n    const selected = this.market\n    if (!selected) return\n    // Get an up-to-date Market.\n    const xc = app().exchanges[selected.dex.host]\n    const mkt = xc.markets[selected.cfg.name]\n    if (!mkt.spot) return\n\n    for (const s of this.stats) {\n      const { unitInfo: { conventional: { conversionFactor: cFactor, unit } } } = xc.assets[mkt.baseid]\n      const fiatRate = app().fiatRatesMap[mkt.baseid]\n      if (fiatRate) {\n        s.tmpl.volume.textContent = Doc.formatFourSigFigs(mkt.spot.vol24 / cFactor * fiatRate)\n        s.tmpl.volUnit.textContent = 'USD'\n      } else {\n        s.tmpl.volume.textContent = Doc.formatFourSigFigs(mkt.spot.vol24 / cFactor)\n        s.tmpl.volUnit.textContent = unit\n      }\n      setPriceAndChange(s.tmpl, xc, mkt)\n    }\n\n    this.page.obPrice.textContent = Doc.formatFourSigFigs(mkt.spot.rate / this.market.rateConversionFactor)\n    this.page.obPrice.classList.remove('sellcolor', 'buycolor')\n    this.page.obPrice.classList.add(mkt.spot.change24 >= 0 ? 'buycolor' : 'sellcolor')\n    Doc.setVis(mkt.spot.change24 >= 0, this.page.obUp)\n    Doc.setVis(mkt.spot.change24 < 0, this.page.obDown)\n  }\n\n  /* setMarketDetails updates the currency names on the stats displays. */\n  setMarketDetails () {\n    if (!this.market) return\n    for (const s of this.stats) {\n      const { baseCfg: ba, quoteCfg: qa } = this.market\n      s.tmpl.baseIcon.src = Doc.logoPath(ba.symbol)\n      s.tmpl.quoteIcon.src = Doc.logoPath(qa.symbol)\n      Doc.empty(s.tmpl.baseSymbol, s.tmpl.quoteSymbol)\n      s.tmpl.baseSymbol.appendChild(Doc.symbolize(ba, true))\n      s.tmpl.quoteSymbol.appendChild(Doc.symbolize(qa, true))\n    }\n  }\n\n  /* setHighLow calculates the high and low rates over the last 24 hours. */\n  setHighLow () {\n    let [high, low] = [0, 0]\n    const spot = this.market.cfg.spot\n    // Use spot values for 24 hours high and low rates if it is available. We\n    // will default to setting it from candles if it's not.\n    if (spot && spot.low24 && spot.high24) {\n      high = spot.high24\n      low = spot.low24\n    } else {\n      const cache = this.market?.candleCaches[fiveMinBinKey]\n      if (!cache) {\n        if (this.candleDur !== fiveMinBinKey) {\n          this.requestCandles(fiveMinBinKey)\n          return\n        }\n        for (const s of this.stats) {\n          s.tmpl.high.textContent = '-'\n          s.tmpl.low.textContent = '-'\n        }\n        return\n      }\n\n      // Set high and low rates from candles.\n      const aDayAgo = new Date().getTime() - 86400000\n      for (let i = cache.candles.length - 1; i >= 0; i--) {\n        const c = cache.candles[i]\n        if (c.endStamp < aDayAgo) break\n        if (low === 0 || (c.lowRate > 0 && c.lowRate < low)) low = c.lowRate\n        if (c.highRate > high) high = c.highRate\n      }\n    }\n\n    const baseID = this.market.base.id\n    const quoteID = this.market.quote.id\n    const dex = this.market.dex\n    for (const s of this.stats) {\n      s.tmpl.high.textContent = high > 0 ? Doc.formatFourSigFigs(app().conventionalRate(baseID, quoteID, high, dex)) : '-'\n      s.tmpl.low.textContent = low > 0 ? Doc.formatFourSigFigs(app().conventionalRate(baseID, quoteID, low, dex)) : '-'\n    }\n  }\n\n  /* assetsAreSupported is true if all the assets of the current market are\n   * supported\n   */\n  assetsAreSupported (): {\n    isSupported: boolean;\n    text: string;\n    } {\n    const { market: { base, quote, baseCfg, quoteCfg } } = this\n    if (!base || !quote) {\n      const symbol = base ? quoteCfg.symbol : baseCfg.symbol\n      return {\n        isSupported: false,\n        text: intl.prep(intl.ID_NOT_SUPPORTED, { asset: symbol.toUpperCase() })\n      }\n    }\n    // check if versions are supported. If asset is a token, we check if its\n    // parent supports the version.\n    const bVers = (base.token ? app().assets[base.token.parentID].info?.versions : base.info?.versions) as number[]\n    const qVers = (quote.token ? app().assets[quote.token.parentID].info?.versions : quote.info?.versions) as number[]\n    // if none them are token, just check if own asset is supported.\n    let text = ''\n    if (!bVers.includes(baseCfg.version)) {\n      text = intl.prep(intl.ID_VERSION_NOT_SUPPORTED, { asset: base.symbol.toUpperCase(), version: baseCfg.version + '' })\n    } else if (!qVers.includes(quoteCfg.version)) {\n      text = intl.prep(intl.ID_VERSION_NOT_SUPPORTED, { asset: quote.symbol.toUpperCase(), version: quoteCfg.version + '' })\n    }\n    return {\n      isSupported: bVers.includes(baseCfg.version) && qVers.includes(quoteCfg.version),\n      text\n    }\n  }\n\n  /*\n   * setOrderVisibility sets which form is visible based on the specified\n   * options.\n   */\n  setOrderVisibility () {\n    const page = this.page\n    if (this.isLimit()) {\n      Doc.show(page.priceBox, page.tifBox, page.qtyBox, page.maxBox)\n      Doc.hide(page.mktBuyBox)\n      this.previewQuoteAmt(true)\n    } else {\n      Doc.hide(page.tifBox, page.maxBox, page.priceBox)\n      if (this.isSell()) {\n        Doc.hide(page.mktBuyBox)\n        Doc.show(page.qtyBox)\n        this.previewQuoteAmt(true)\n      } else {\n        Doc.show(page.mktBuyBox)\n        Doc.hide(page.qtyBox)\n        this.previewQuoteAmt(false)\n      }\n    }\n    this.updateOrderBttnState()\n  }\n\n  /* resolveOrderFormVisibility displays or hides the 'orderForm' based on\n   * a set of conditions to be met.\n   */\n  async resolveOrderFormVisibility () {\n    const page = this.page\n\n    const showOrderForm = async () : Promise<boolean> => {\n      if (!this.assetsAreSupported().isSupported) return false // assets not supported\n\n      if (!this.market || this.market.dex.auth.effectiveTier < 1) return false// acct suspended or not registered\n\n      const { baseAssetApprovalStatus, quoteAssetApprovalStatus } = this.tokenAssetApprovalStatuses()\n      if (baseAssetApprovalStatus !== ApprovalStatus.Approved || quoteAssetApprovalStatus !== ApprovalStatus.Approved) return false\n\n      const { base, quote } = this.market\n      const hasWallets = base && app().assets[base.id].wallet && quote && app().assets[quote.id].wallet\n      if (!hasWallets) return false\n      if (this.mmRunning) return false\n      return true\n    }\n\n    Doc.setVis(await showOrderForm(), page.orderForm, page.orderTypeBttns)\n\n    if (this.market) {\n      const { auth: { effectiveTier, pendingStrength } } = this.market.dex\n      Doc.setVis(effectiveTier > 0 || pendingStrength > 0, page.reputationAndTradingTierBox)\n    }\n\n    const mmStatus = app().mmStatus\n    if (mmStatus && this.mmRunning === undefined && this.market.base && this.market.quote) {\n      const { base: { id: baseID }, quote: { id: quoteID }, dex: { host } } = this.market\n      const botStatus = mmStatus.bots.find(({ config: cfg }) => cfg.baseID === baseID && cfg.quoteID === quoteID && cfg.host === host)\n      this.mmRunning = Boolean(botStatus?.running)\n    }\n\n    Doc.setVis(this.mmRunning, page.mmRunning)\n    if (this.mmRunning) Doc.hide(page.orderForm, page.orderTypeBttns)\n  }\n\n  /* setLoaderMsgVisibility displays a message in case a dex asset is not\n   * supported\n   */\n  setLoaderMsgVisibility () {\n    const { page } = this\n\n    const { isSupported, text } = this.assetsAreSupported()\n    if (isSupported) {\n      // make sure to hide the loader msg\n      Doc.hide(page.loaderMsg)\n      return\n    }\n    page.loaderMsg.textContent = text\n    Doc.show(page.loaderMsg)\n    Doc.hide(page.notRegistered)\n    Doc.hide(page.noWallet)\n  }\n\n  /*\n   * showTokenApprovalForm displays the form used to give allowance to the\n   * swap contract of a token.\n   */\n  async showTokenApprovalForm (isBase: boolean) {\n    const assetID = isBase ? this.market.base.id : this.market.quote.id\n    this.approveTokenForm.setAsset(assetID, this.market.dex.host)\n    this.forms.show(this.page.approveTokenForm)\n  }\n\n  /*\n   * tokenAssetApprovalStatuses returns the approval status of the base and\n   * quote assets. If the asset is not a token, it is considered approved.\n   */\n  tokenAssetApprovalStatuses (): {\n    baseAssetApprovalStatus: ApprovalStatus;\n    quoteAssetApprovalStatus: ApprovalStatus;\n    } {\n    const { market: { base, quote } } = this\n    let baseAssetApprovalStatus = ApprovalStatus.Approved\n    let quoteAssetApprovalStatus = ApprovalStatus.Approved\n\n    if (base?.token) {\n      const baseAsset = app().assets[base.id]\n      const baseVersion = this.market.dex.assets[base.id].version\n      if (baseAsset?.wallet?.approved && baseAsset.wallet.approved[baseVersion] !== undefined) {\n        baseAssetApprovalStatus = baseAsset.wallet.approved[baseVersion]\n      }\n    }\n    if (quote?.token) {\n      const quoteAsset = app().assets[quote.id]\n      const quoteVersion = this.market.dex.assets[quote.id].version\n      if (quoteAsset?.wallet?.approved && quoteAsset.wallet.approved[quoteVersion] !== undefined) {\n        quoteAssetApprovalStatus = quoteAsset.wallet.approved[quoteVersion]\n      }\n    }\n\n    return {\n      baseAssetApprovalStatus,\n      quoteAssetApprovalStatus\n    }\n  }\n\n  /*\n   * setTokenApprovalVisibility sets the visibility of the token approval\n   * panel elements.\n   */\n  setTokenApprovalVisibility () {\n    const { page } = this\n\n    const { baseAssetApprovalStatus, quoteAssetApprovalStatus } = this.tokenAssetApprovalStatuses()\n\n    if (baseAssetApprovalStatus === ApprovalStatus.Approved && quoteAssetApprovalStatus === ApprovalStatus.Approved) {\n      Doc.hide(page.tokenApproval)\n      page.sellBttn.removeAttribute('disabled')\n      page.buyBttn.removeAttribute('disabled')\n      return\n    }\n\n    if (baseAssetApprovalStatus !== ApprovalStatus.Approved && quoteAssetApprovalStatus === ApprovalStatus.Approved) {\n      page.sellBttn.setAttribute('disabled', 'disabled')\n      page.buyBttn.removeAttribute('disabled')\n      this.setBuy()\n      Doc.show(page.approvalRequiredSell)\n      Doc.hide(page.approvalRequiredBuy, page.approvalRequiredBoth)\n    }\n\n    if (baseAssetApprovalStatus === ApprovalStatus.Approved && quoteAssetApprovalStatus !== ApprovalStatus.Approved) {\n      page.buyBttn.setAttribute('disabled', 'disabled')\n      page.sellBttn.removeAttribute('disabled')\n      this.setSell()\n      Doc.show(page.approvalRequiredBuy)\n      Doc.hide(page.approvalRequiredSell, page.approvalRequiredBoth)\n    }\n\n    // If they are both unapproved tokens, the order form will not be shown.\n    if (baseAssetApprovalStatus !== ApprovalStatus.Approved && quoteAssetApprovalStatus !== ApprovalStatus.Approved) {\n      Doc.show(page.approvalRequiredBoth)\n      Doc.hide(page.approvalRequiredSell, page.approvalRequiredBuy)\n    }\n\n    Doc.show(page.tokenApproval)\n    page.approvalPendingBaseSymbol.textContent = page.baseTokenAsset.textContent = this.market.base.symbol.toUpperCase()\n    page.approvalPendingQuoteSymbol.textContent = page.quoteTokenAsset.textContent = this.market.quote.symbol.toUpperCase()\n    Doc.setVis(baseAssetApprovalStatus === ApprovalStatus.NotApproved, page.approveBaseBttn)\n    Doc.setVis(quoteAssetApprovalStatus === ApprovalStatus.NotApproved, page.approveQuoteBttn)\n    Doc.setVis(baseAssetApprovalStatus === ApprovalStatus.Pending, page.approvalPendingBase)\n    Doc.setVis(quoteAssetApprovalStatus === ApprovalStatus.Pending, page.approvalPendingQuote)\n  }\n\n  /* setRegistrationStatusView sets the text content and class for the\n   * registration status view\n   */\n  setRegistrationStatusView (titleContent: string, confStatusMsg: string, titleClass: string) {\n    const page = this.page\n    page.regStatusTitle.textContent = titleContent\n    page.regStatusConfsDisplay.textContent = confStatusMsg\n    page.registrationStatus.classList.remove('completed', 'error', 'waiting')\n    page.registrationStatus.classList.add(titleClass)\n  }\n\n  /*\n   * updateRegistrationStatusView updates the view based on the current\n   * registration status\n   */\n  updateRegistrationStatusView () {\n    const { page, market: { dex } } = this\n    page.regStatusDex.textContent = dex.host\n    page.postingBondsDex.textContent = dex.host\n\n    if (dex.auth.effectiveTier >= 1) {\n      this.setRegistrationStatusView(intl.prep(intl.ID_REGISTRATION_FEE_SUCCESS), '', 'completed')\n      return\n    }\n\n    const confStatuses = (dex.auth.pendingBonds || []).map(pending => {\n      const confirmationsRequired = dex.bondAssets[pending.symbol].confs\n      return `${pending.confs} / ${confirmationsRequired}`\n    })\n    const confStatusMsg = confStatuses.join(', ')\n    this.setRegistrationStatusView(intl.prep(intl.ID_WAITING_FOR_CONFS), confStatusMsg, 'waiting')\n  }\n\n  /*\n   * setRegistrationStatusVisibility toggles the registration status view based\n   * on the dex data.\n   */\n  setRegistrationStatusVisibility () {\n    const { page, market } = this\n    if (!market || !market.dex) return\n\n    // If dex is not connected to server, is not possible to know the\n    // registration status.\n    if (market.dex.connectionStatus !== ConnectionStatus.Connected) return\n\n    this.updateRegistrationStatusView()\n\n    const showSection = (section: PageElement | undefined) => {\n      const elements = [page.registrationStatus, page.bondRequired, page.bondCreationPending, page.notRegistered]\n      for (const el of elements) {\n        Doc.setVis(el === section, el)\n      }\n    }\n\n    if (market.dex.auth.effectiveTier >= 1) {\n      const toggle = async () => {\n        showSection(undefined)\n        this.resolveOrderFormVisibility()\n      }\n      if (Doc.isHidden(page.orderForm)) {\n        // wait a couple of seconds before showing the form so the success\n        // message is shown to the user\n        setTimeout(toggle, 5000)\n        return\n      }\n      toggle()\n    } else if (market.dex.viewOnly) {\n      page.unregisteredDex.textContent = market.dex.host\n      showSection(page.notRegistered)\n    } else if (this.hasPendingBonds()) {\n      showSection(page.registrationStatus)\n    } else if (market.dex.auth.targetTier > 0) {\n      showSection(page.bondCreationPending)\n    } else {\n      page.acctTier.textContent = `${market.dex.auth.effectiveTier}`\n      page.dexSettingsLink.href = `/dexsettings/${market.dex.host}`\n      showSection(page.bondRequired)\n    }\n  }\n\n  setOrderBttnText () {\n    if (this.isSell()) {\n      this.page.submitBttn.textContent = intl.prep(intl.ID_SET_BUTTON_SELL, { asset: Doc.shortSymbol(this.market.baseCfg.unitInfo.conventional.unit) })\n    } else this.page.submitBttn.textContent = intl.prep(intl.ID_SET_BUTTON_BUY, { asset: Doc.shortSymbol(this.market.baseCfg.unitInfo.conventional.unit) })\n  }\n\n  setOrderBttnEnabled (isEnabled: boolean, disabledTooltipMsg?: string) {\n    const btn = this.page.submitBttn\n    if (isEnabled) {\n      btn.removeAttribute('disabled')\n      btn.removeAttribute('title')\n    } else {\n      btn.setAttribute('disabled', 'true')\n      if (disabledTooltipMsg) btn.setAttribute('title', disabledTooltipMsg)\n    }\n  }\n\n  updateOrderBttnState () {\n    const { market: mkt, currentOrder: { qty: orderQty, rate: orderRate, isLimit, sell } } = this\n    const baseWallet = app().assets[this.market.base.id].wallet\n    const quoteWallet = app().assets[mkt.quote.id].wallet\n    if (!baseWallet || !quoteWallet) return\n\n    if (orderQty <= 0 || orderQty < mkt.cfg.lotsize) {\n      this.setOrderBttnEnabled(false, intl.prep(intl.ID_ORDER_BUTTON_QTY_ERROR))\n      return\n    }\n\n    // Market orders\n    if (!isLimit) {\n      if (sell) {\n        this.setOrderBttnEnabled(orderQty <= baseWallet.balance.available, intl.prep(intl.ID_ORDER_BUTTON_SELL_BALANCE_ERROR))\n      } else {\n        this.setOrderBttnEnabled(orderQty <= quoteWallet.balance.available, intl.prep(intl.ID_ORDER_BUTTON_BUY_BALANCE_ERROR))\n      }\n      return\n    }\n\n    if (!orderRate) {\n      this.setOrderBttnEnabled(false, intl.prep(intl.ID_ORDER_BUTTON_QTY_RATE_ERROR))\n      return\n    }\n\n    // Limit sell\n    if (sell) {\n      if (baseWallet.balance.available < mkt.cfg.lotsize) {\n        this.setOrderBttnEnabled(false, intl.prep(intl.ID_ORDER_BUTTON_SELL_BALANCE_ERROR))\n        return\n      }\n      if (mkt.maxSell) {\n        this.setOrderBttnEnabled(orderQty <= mkt.maxSell.swap.value, intl.prep(intl.ID_ORDER_BUTTON_SELL_BALANCE_ERROR))\n      }\n      return\n    }\n\n    // Limit buy\n    const rate = this.adjustedRate()\n    const aLot = mkt.cfg.lotsize * (rate / OrderUtil.RateEncodingFactor)\n    if (quoteWallet.balance.available < aLot) {\n      this.setOrderBttnEnabled(false, intl.prep(intl.ID_ORDER_BUTTON_BUY_BALANCE_ERROR))\n      return\n    }\n    if (mkt.maxBuys[rate]) {\n      const enable = orderQty <= mkt.maxBuys[rate].swap.lots * mkt.cfg.lotsize\n      this.setOrderBttnEnabled(enable, intl.prep(intl.ID_ORDER_BUTTON_BUY_BALANCE_ERROR))\n    }\n  }\n\n  setCandleDurBttns () {\n    const { page, market } = this\n    Doc.empty(page.durBttnBox)\n    for (const dur of market.dex.candleDurs) {\n      const bttn = page.durBttnTemplate.cloneNode(true)\n      bttn.textContent = dur\n      Doc.bind(bttn, 'click', () => this.candleDurationSelected(dur))\n      page.durBttnBox.appendChild(bttn)\n    }\n\n    // load candlesticks here since we are resetting page.durBttnBox above.\n    this.loadCandles()\n  }\n\n  /* setMarket sets the currently displayed market. */\n  async setMarket (host: string, baseID: number, quoteID: number) {\n    const dex = app().user.exchanges[host]\n    const page = this.page\n\n    window.cexBook = async () => {\n      const res = await postJSON('/api/cexbook', { host, baseID, quoteID })\n      console.log(res.book)\n    }\n\n    // reset form inputs\n    page.lotField.value = ''\n    page.qtyField.value = ''\n    page.rateField.value = ''\n\n    // clear depth chart and orderbook.\n    this.depthChart.clear()\n    Doc.empty(this.page.buyRows)\n    Doc.empty(this.page.sellRows)\n\n    // Clear recent matches for the previous market. This will be set when we\n    // receive the order book subscription response.\n    this.recentMatches = []\n    Doc.empty(page.recentMatchesLiveList)\n\n    // Hide the balance widget\n    this.balanceWgt.setBalanceVisibility(false)\n\n    Doc.hide(page.notRegistered, page.bondRequired, page.noWallet)\n\n    // If we have not yet connected, there is no dex.assets or any other\n    // exchange data, so just put up a message and wait for the connection to be\n    // established, at which time handleConnNote will refresh and reload.\n    if (!dex || !dex.markets || dex.connectionStatus !== ConnectionStatus.Connected) {\n      let errMsg = intl.prep(intl.ID_CONNECTION_FAILED)\n      if (dex.disabled) errMsg = intl.prep(intl.ID_DEX_DISABLED_MSG)\n      page.chartErrMsg.textContent = errMsg\n      Doc.show(page.chartErrMsg)\n      return\n    }\n\n    for (const s of this.stats) Doc.show(s.row)\n\n    const baseCfg = dex.assets[baseID]\n    const quoteCfg = dex.assets[quoteID]\n\n    const [bui, qui] = [app().unitInfo(baseID, dex), app().unitInfo(quoteID, dex)]\n\n    const rateConversionFactor = OrderUtil.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor\n    Doc.hide(page.maxOrd, page.chartErrMsg)\n    if (this.maxEstimateTimer) {\n      window.clearTimeout(this.maxEstimateTimer)\n      this.maxEstimateTimer = null\n    }\n    const mktId = marketID(baseCfg.symbol, quoteCfg.symbol)\n    const baseAsset = app().assets[baseID]\n    const quoteAsset = app().assets[quoteID]\n\n    const mkt = {\n      dex: dex,\n      sid: mktId, // A string market identifier used by the DEX.\n      cfg: dex.markets[mktId],\n      // app().assets is a map of core.SupportedAsset type, which can be found at\n      // client/core/types.go.\n      base: baseAsset,\n      quote: quoteAsset,\n      baseUnitInfo: bui,\n      quoteUnitInfo: qui,\n      maxSell: null,\n      maxBuys: {},\n      maxSellRequested: false,\n      candleCaches: {},\n      baseCfg,\n      quoteCfg,\n      rateConversionFactor,\n      sellBalance: 0,\n      buyBalance: 0,\n      bookLoaded: false\n    }\n\n    this.market = mkt\n    this.mm.setMarket(host, baseID, quoteID)\n    this.mmRunning = undefined\n    page.lotSize.textContent = Doc.formatCoinValue(mkt.cfg.lotsize, mkt.baseUnitInfo)\n    page.rateStep.textContent = Doc.formatCoinValue(mkt.cfg.ratestep / rateConversionFactor)\n\n    this.displayMessageIfMissingWallet()\n    this.balanceWgt.setWallets(host, baseID, quoteID)\n    this.setMarketDetails()\n    this.setCurrMarketPrice()\n\n    // if (!dex.candleDurs || dex.candleDurs.length === 0) this.currentChart = depthChart\n\n    // depth chart\n    ws.request('loadmarket', makeMarket(host, baseID, quoteID))\n\n    State.storeLocal(State.lastMarketLK, {\n      host: host,\n      base: baseID,\n      quote: quoteID\n    })\n    app().updateMarketElements(this.main, baseID, quoteID, dex)\n    this.marketList.select(host, baseID, quoteID)\n    this.setLoaderMsgVisibility()\n    this.setTokenApprovalVisibility()\n    this.setRegistrationStatusVisibility()\n    this.resolveOrderFormVisibility()\n    this.setOrderBttnText()\n    this.setOrderBttnEnabled(false, intl.prep(intl.ID_ORDER_BUTTON_QTY_RATE_ERROR))\n    this.setCandleDurBttns()\n    this.previewQuoteAmt(false)\n    this.updateTitle()\n    this.reputationMeter.setHost(dex.host)\n    this.updateReputation()\n    this.loadUserOrders()\n  }\n\n  /*\n    displayMessageForMissingWallet displays a custom message on the market's\n    view if one or more of the selected market's wallet is missing.\n  */\n  displayMessageIfMissingWallet () {\n    const page = this.page\n    const mkt = this.market\n    const baseSym = mkt.baseCfg.symbol.toLocaleUpperCase()\n    const quoteSym = mkt.quoteCfg.symbol.toLocaleUpperCase()\n    let noWalletMsg = ''\n    Doc.hide(page.noWallet)\n    if (!mkt.base?.wallet && !mkt.quote?.wallet) noWalletMsg = intl.prep(intl.ID_NO_WALLET_MSG, { asset1: baseSym, asset2: quoteSym })\n    else if (!mkt.base?.wallet) noWalletMsg = intl.prep(intl.ID_CREATE_ASSET_WALLET_MSG, { asset: baseSym })\n    else if (!mkt.quote?.wallet) noWalletMsg = intl.prep(intl.ID_CREATE_ASSET_WALLET_MSG, { asset: quoteSym })\n    else return\n\n    page.noWallet.textContent = noWalletMsg\n    Doc.show(page.noWallet)\n  }\n\n  /*\n   * reportDepthClick is a callback used by the DepthChart when the user clicks\n   * on the chart area. The rate field is set to the x-value of the click.\n   */\n  reportDepthClick (r: number) {\n    this.page.rateField.value = String(r)\n    this.rateFieldChanged()\n  }\n\n  /*\n   * reportDepthVolume accepts a volume report from the DepthChart and sets the\n   * values in the chart legend.\n   */\n  reportDepthVolume (r: VolumeReport) {\n    const page = this.page\n    const { baseUnitInfo: b, quoteUnitInfo: q } = this.market\n    // DepthChart reports volumes in conventional units. We'll still use\n    // formatCoinValue for formatting though.\n    page.sellBookedBase.textContent = Doc.formatCoinValue(r.sellBase * b.conventional.conversionFactor, b)\n    page.sellBookedQuote.textContent = Doc.formatCoinValue(r.sellQuote * q.conventional.conversionFactor, q)\n    page.buyBookedBase.textContent = Doc.formatCoinValue(r.buyBase * b.conventional.conversionFactor, b)\n    page.buyBookedQuote.textContent = Doc.formatCoinValue(r.buyQuote * q.conventional.conversionFactor, q)\n  }\n\n  /*\n   * reportDepthMouse accepts information about the mouse position on the chart\n   * area.\n   */\n  reportDepthMouse (r: MouseReport) {\n    while (this.hovers.length) (this.hovers.shift() as HTMLElement).classList.remove('hover')\n    const page = this.page\n    if (!r) {\n      Doc.hide(page.depthLegend)\n      return\n    }\n    Doc.show(page.depthLegend)\n\n    // If the user is hovered to within a small percent (based on chart width)\n    // of a user order, highlight that order's row.\n    for (const { div, ord } of Object.values(this.metaOrders)) {\n      if (ord.status !== OrderUtil.StatusBooked) continue\n      if (r.hoverMarkers.indexOf(ord.rate) > -1) {\n        div.classList.add('hover')\n        this.hovers.push(div)\n      }\n    }\n\n    page.hoverPrice.textContent = Doc.formatCoinValue(r.rate)\n    page.hoverVolume.textContent = Doc.formatCoinValue(r.depth)\n    page.hoverVolume.style.color = r.dotColor\n  }\n\n  /*\n   * reportDepthZoom accepts information about the current depth chart zoom\n   * level. This information is saved to disk so that the zoom level can be\n   * maintained across reloads.\n   */\n  reportDepthZoom (zoom: number) {\n    State.storeLocal(State.depthZoomLK, zoom)\n  }\n\n  reportMouseCandle (candle: Candle | null) {\n    const page = this.page\n    if (!candle) {\n      Doc.hide(page.candlesLegend)\n      return\n    }\n    Doc.show(page.candlesLegend)\n    page.candleStart.textContent = Doc.formatCoinValue(candle.startRate / this.market.rateConversionFactor)\n    page.candleEnd.textContent = Doc.formatCoinValue(candle.endRate / this.market.rateConversionFactor)\n    page.candleHigh.textContent = Doc.formatCoinValue(candle.highRate / this.market.rateConversionFactor)\n    page.candleLow.textContent = Doc.formatCoinValue(candle.lowRate / this.market.rateConversionFactor)\n    page.candleVol.textContent = Doc.formatCoinValue(candle.matchVolume, this.market.baseUnitInfo)\n  }\n\n  /*\n   * parseOrder pulls the order information from the form fields. Data is not\n   * validated in any way.\n   */\n  parseOrder (): TradeForm {\n    const page = this.page\n    let qtyField = page.qtyField\n    const limit = this.isLimit()\n    const sell = this.isSell()\n    const market = this.market\n    let qtyConv = market.baseUnitInfo.conventional.conversionFactor\n    if (!limit && !sell) {\n      qtyField = page.mktBuyField\n      qtyConv = market.quoteUnitInfo.conventional.conversionFactor\n    }\n    return {\n      host: market.dex.host,\n      isLimit: limit,\n      sell: sell,\n      base: market.base.id,\n      quote: market.quote.id,\n      qty: convertToAtoms(qtyField.value || '', qtyConv),\n      rate: convertToAtoms(page.rateField.value || '', market.rateConversionFactor), // message-rate\n      tifnow: page.tifNow.checked || false,\n      options: {}\n    }\n  }\n\n  /**\n   * previewQuoteAmt shows quote amount when rate or quantity input are changed\n   */\n  previewQuoteAmt (show: boolean) {\n    const page = this.page\n    if (!this.market.base || !this.market.quote) return // Not a supported asset\n    const order = this.currentOrder = this.parseOrder()\n    const adjusted = this.adjustedRate()\n    page.orderErr.textContent = ''\n    if (adjusted) {\n      if (order.sell) this.preSell()\n      else this.preBuy()\n    }\n    this.depthLines.input = []\n    if (adjusted && this.isLimit()) {\n      this.depthLines.input = [{\n        rate: order.rate / this.market.rateConversionFactor,\n        color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine\n      }]\n    }\n    this.drawChartLines()\n    if (!show || !adjusted || !order.qty) {\n      page.orderPreview.textContent = ''\n      this.drawChartLines()\n      return\n    }\n    const { unitInfo: { conventional: { unit } } } = app().assets[order.quote]\n    const quoteQty = order.qty * order.rate / OrderUtil.RateEncodingFactor\n    const total = Doc.formatCoinValue(quoteQty, this.market.quoteUnitInfo)\n\n    page.orderPreview.textContent = intl.prep(intl.ID_ORDER_PREVIEW, { total, asset: unit })\n    if (this.isSell()) this.preSell()\n    else this.preBuy()\n  }\n\n  /**\n   * preSell populates the max order message for the largest available sell.\n   */\n  preSell () {\n    const mkt = this.market\n    const baseWallet = app().assets[mkt.base.id].wallet\n    if (baseWallet.balance.available < mkt.cfg.lotsize) {\n      this.setMaxOrder(null)\n      this.updateOrderBttnState()\n      return\n    }\n    if (mkt.maxSell) {\n      this.setMaxOrder(mkt.maxSell.swap)\n      this.updateOrderBttnState()\n      return\n    }\n\n    if (mkt.maxSellRequested) return\n    mkt.maxSellRequested = true\n    // We only fetch pre-sell once per balance update, so don't delay.\n    this.scheduleMaxEstimate('/api/maxsell', {}, 0, (res: MaxSell) => {\n      mkt.maxSellRequested = false\n      mkt.maxSell = res.maxSell\n      mkt.sellBalance = baseWallet.balance.available\n      this.setMaxOrder(res.maxSell.swap)\n      this.updateOrderBttnState()\n    })\n  }\n\n  /**\n   * preBuy populates the max order message for the largest available buy.\n   */\n  preBuy () {\n    const mkt = this.market\n    const rate = this.adjustedRate()\n    const quoteWallet = app().assets[mkt.quote.id].wallet\n    if (!quoteWallet) return\n    const aLot = mkt.cfg.lotsize * (rate / OrderUtil.RateEncodingFactor)\n    if (quoteWallet.balance.available < aLot) {\n      this.setMaxOrder(null)\n      this.updateOrderBttnState()\n      return\n    }\n    if (mkt.maxBuys[rate]) {\n      this.setMaxOrder(mkt.maxBuys[rate].swap)\n      this.updateOrderBttnState()\n      return\n    }\n    // 0 delay for first fetch after balance update or market change, otherwise\n    // meter these at 1 / sec.\n    const delay = Object.keys(mkt.maxBuys).length ? 350 : 0\n    this.scheduleMaxEstimate('/api/maxbuy', { rate }, delay, (res: MaxBuy) => {\n      mkt.maxBuys[rate] = res.maxBuy\n      mkt.buyBalance = app().assets[mkt.quote.id].wallet.balance.available\n      this.setMaxOrder(res.maxBuy.swap)\n      this.updateOrderBttnState()\n    })\n  }\n\n  /**\n   * scheduleMaxEstimate shows the loading icon and schedules a call to an order\n   * estimate api endpoint. If another call to scheduleMaxEstimate is made before\n   * this one is fired (after delay), this call will be canceled.\n   */\n  scheduleMaxEstimate (path: string, args: any, delay: number, success: (res: any) => void) {\n    const page = this.page\n    if (!this.maxLoaded) this.maxLoaded = app().loading(page.maxOrd)\n    const [bid, qid] = [this.market.base.id, this.market.quote.id]\n    const [bWallet, qWallet] = [app().assets[bid].wallet, app().assets[qid].wallet]\n    if (!bWallet || !bWallet.running || !qWallet || !qWallet.running) return\n    if (this.maxEstimateTimer) window.clearTimeout(this.maxEstimateTimer)\n\n    Doc.show(page.maxOrd, page.maxLotBox)\n    Doc.hide(page.maxAboveZero, page.maxZeroNoFees, page.maxZeroNoBal)\n    page.maxFromLots.textContent = intl.prep(intl.ID_CALCULATING)\n    page.maxFromLotsLbl.textContent = ''\n    this.maxOrderUpdateCounter++\n    const counter = this.maxOrderUpdateCounter\n    this.maxEstimateTimer = window.setTimeout(async () => {\n      this.maxEstimateTimer = null\n      if (counter !== this.maxOrderUpdateCounter) return\n      const res = await postJSON(path, {\n        host: this.market.dex.host,\n        base: bid,\n        quote: qid,\n        ...args\n      })\n      if (counter !== this.maxOrderUpdateCounter) return\n      if (!app().checkResponse(res)) {\n        console.warn('max order estimate not available:', res)\n        page.maxFromLots.textContent = intl.prep(intl.ID_ESTIMATE_UNAVAILABLE)\n        if (this.maxLoaded) {\n          this.maxLoaded()\n          this.maxLoaded = null\n        }\n        return\n      }\n      success(res)\n    }, delay)\n  }\n\n  /* setMaxOrder sets the max order text. */\n  setMaxOrder (maxOrder: SwapEstimate | null) {\n    const page = this.page\n    if (this.maxLoaded) {\n      this.maxLoaded()\n      this.maxLoaded = null\n    }\n    Doc.show(page.maxOrd, page.maxLotBox)\n    const sell = this.isSell()\n\n    let lots = 0\n    if (maxOrder) lots = maxOrder.lots\n\n    page.maxFromLots.textContent = lots.toString()\n    // XXX add plural into format details, so we don't need this\n    page.maxFromLotsLbl.textContent = intl.prep(lots === 1 ? intl.ID_LOT : intl.ID_LOTS)\n    if (!maxOrder) return\n\n    const fromAsset = sell ? this.market.base : this.market.quote\n\n    if (lots === 0) {\n      // If we have a maxOrder, see if we can guess why we have no lots.\n      let lotSize = this.market.cfg.lotsize\n      if (!sell) {\n        const conversionRate = this.anyRate()[1]\n        if (conversionRate === 0) return\n        lotSize = lotSize * conversionRate\n      }\n      const haveQty = fromAsset.wallet.balance.available / lotSize > 0\n      if (haveQty) {\n        if (fromAsset.token) {\n          const { wallet: { balance: { available: feeAvail } }, unitInfo } = app().assets[fromAsset.token.parentID]\n          if (feeAvail < maxOrder.feeReservesPerLot) {\n            Doc.show(page.maxZeroNoFees)\n            page.maxZeroNoFeesTicker.textContent = unitInfo.conventional.unit\n            page.maxZeroMinFees.textContent = Doc.formatCoinValue(maxOrder.feeReservesPerLot, unitInfo)\n          }\n          // It looks like we should be able to afford it, but maybe some fees we're not seeing.\n          // Show nothing.\n          return\n        }\n        // Not a token. Maybe we have enough for the swap but not for fees.\n        const fundedLots = fromAsset.wallet.balance.available / (lotSize + maxOrder.feeReservesPerLot)\n        if (fundedLots > 0) return // Not sure why. Could be split txs or utxos. Just show nothing.\n      }\n      Doc.show(page.maxZeroNoBal)\n      page.maxZeroNoBalTicker.textContent = fromAsset.unitInfo.conventional.unit\n      return\n    }\n    Doc.show(page.maxAboveZero)\n\n    page.maxFromAmt.textContent = Doc.formatCoinValue(maxOrder.value || 0, fromAsset.unitInfo)\n    page.maxFromTicker.textContent = fromAsset.unitInfo.conventional.unit\n    // Could subtract the maxOrder.redemptionFees here.\n    // The qty conversion doesn't fit well with the new design.\n    // TODO: Make this work somehow?\n    // const toConversion = sell ? this.adjustedRate() / OrderUtil.RateEncodingFactor : OrderUtil.RateEncodingFactor / this.adjustedRate()\n    // page.maxToAmt.textContent = Doc.formatCoinValue((maxOrder.value || 0) * toConversion, toAsset.unitInfo)\n    // page.maxToTicker.textContent = toAsset.symbol.toUpperCase()\n  }\n\n  /*\n   * validateOrder performs some basic order sanity checks, returning boolean\n   * true if the order appears valid.\n   */\n  validateOrder (order: TradeForm) {\n    const { page, market: { cfg: { minimumRate }, rateConversionFactor } } = this\n    if (order.isLimit) {\n      if (!order.rate) {\n        Doc.show(page.orderErr)\n        page.orderErr.textContent = intl.prep(intl.ID_NO_ZERO_RATE)\n        return false\n      }\n      if (order.rate < minimumRate) {\n        Doc.show(page.orderErr)\n        const [r, minRate] = [order.rate / rateConversionFactor, minimumRate / rateConversionFactor]\n        page.orderErr.textContent = `rate is lower than the market's minimum rate. ${r} < ${minRate}`\n        return false\n      }\n    }\n    if (!order.qty) {\n      Doc.show(page.orderErr)\n      page.orderErr.textContent = intl.prep(intl.ID_NO_ZERO_QUANTITY)\n      return false\n    }\n    return true\n  }\n\n  /* handleBook accepts the data sent in the 'book' notification. */\n  handleBook (data: MarketOrderBook) {\n    const { cfg, baseUnitInfo, quoteUnitInfo, baseCfg, quoteCfg } = this.market\n    this.book = new OrderBook(data, baseCfg.symbol, quoteCfg.symbol)\n    this.loadTable()\n    for (const order of (data.book.epoch || [])) {\n      if (order.rate > 0) this.book.add(order)\n      this.addTableOrder(order)\n    }\n    if (!this.book) {\n      this.depthChart.clear()\n      Doc.empty(this.page.buyRows)\n      Doc.empty(this.page.sellRows)\n      return\n    }\n    Doc.show(this.page.epochLine)\n    if (this.loadingAnimations.depth) this.loadingAnimations.depth.stop()\n    this.depthChart.canvas.classList.remove('invisible')\n    this.depthChart.set(this.book, cfg.lotsize, cfg.ratestep, baseUnitInfo, quoteUnitInfo)\n    this.recentMatches = data.book.recentMatches ?? []\n    this.refreshRecentMatchesTable()\n  }\n\n  /*\n   * midGapConventional is the same as midGap, but returns the mid-gap rate as\n   * the conventional ratio. This is used to convert from a conventional\n   * quantity from base to quote or vice-versa, or for display purposes.\n   */\n  midGapConventional () {\n    const gap = this.midGap()\n    if (!gap) return gap\n    const { baseUnitInfo: b, quoteUnitInfo: q } = this.market\n    return gap * b.conventional.conversionFactor / q.conventional.conversionFactor\n  }\n\n  /*\n   * midGap returns the value in the middle of the best buy and best sell. If\n   * either one of the buy or sell sides are empty, midGap returns the best rate\n   * from the other side. If both sides are empty, midGap returns the value\n   * null. The rate returned is the atomic ratio, used for conversion. For a\n   * conventional rate for display or to convert conventional units, use\n   * midGapConventional\n   */\n  midGap () {\n    const book = this.book\n    if (!book) return\n    if (book.buys && book.buys.length) {\n      if (book.sells && book.sells.length) {\n        return (book.buys[0].msgRate + book.sells[0].msgRate) / 2 / OrderUtil.RateEncodingFactor\n      }\n      return book.buys[0].msgRate / OrderUtil.RateEncodingFactor\n    }\n    if (book.sells && book.sells.length) {\n      return book.sells[0].msgRate / OrderUtil.RateEncodingFactor\n    }\n    return null\n  }\n\n  /*\n   * setMarketBuyOrderEstimate sets the \"min. buy\" display for the current\n   * market.\n   */\n  setMarketBuyOrderEstimate () {\n    const market = this.market\n    const lotSize = market.cfg.lotsize\n    const xc = app().user.exchanges[market.dex.host]\n    const buffer = xc.markets[market.sid].buybuffer\n    const gap = this.midGapConventional()\n    if (gap) {\n      this.page.minMktBuy.textContent = Doc.formatCoinValue(lotSize * buffer * gap, market.baseUnitInfo)\n    }\n  }\n\n  maxUserOrderCount (): number {\n    const { dex: { host }, cfg: { name: mktID } } = this.market\n    return Math.max(maxUserOrdersShown, app().orders(host, mktID).length)\n  }\n\n  async loadUserOrders () {\n    const { base: b, quote: q, dex: { host }, cfg: { name: mktID } } = this.market\n    for (const oid in this.metaOrders) delete this.metaOrders[oid]\n    if (!b || !q) return this.resolveUserOrders([]) // unsupported asset\n    const activeOrders = app().orders(host, mktID)\n    if (activeOrders.length >= maxUserOrdersShown) return this.resolveUserOrders(activeOrders)\n    const filter: OrderFilter = {\n      hosts: [host],\n      market: { baseID: b.id, quoteID: q.id },\n      n: this.maxUserOrderCount()\n    }\n    const res = await postJSON('/api/orders', filter)\n    const orders = res.orders || []\n    // Make sure all active orders are in there. The /orders API sorts by time,\n    // so if there is are 10 cancelled/executed orders newer than an old active\n    // order, the active order wouldn't be included in the result.\n    for (const activeOrd of activeOrders) if (!orders.some((dbOrd: Order) => dbOrd.id === activeOrd.id)) orders.push(activeOrd)\n    return this.resolveUserOrders(res.orders || [])\n  }\n\n  /* refreshActiveOrders refreshes the user's active order list. */\n  refreshActiveOrders () {\n    const orders = app().orders(this.market.dex.host, marketID(this.market.baseCfg.symbol, this.market.quoteCfg.symbol))\n    return this.resolveUserOrders(orders)\n  }\n\n  resolveUserOrders (orders: Order[]) {\n    const { page, metaOrders, market } = this\n    const cfg = market.cfg\n\n    const orderIsActive = (ord: Order) => ord.status < OrderUtil.StatusExecuted || OrderUtil.hasActiveMatches(ord)\n\n    for (const ord of orders) metaOrders[ord.id] = { ord: ord } as MetaOrder\n    let sortedOrders = Object.keys(metaOrders).map((oid: string) => metaOrders[oid])\n    sortedOrders.sort((a: MetaOrder, b: MetaOrder) => {\n      const [aActive, bActive] = [orderIsActive(a.ord), orderIsActive(b.ord)]\n      if (aActive && !bActive) return -1\n      else if (!aActive && bActive) return 1\n      return b.ord.submitTime - a.ord.submitTime\n    })\n    const n = this.maxUserOrderCount()\n    if (sortedOrders.length > n) { sortedOrders = sortedOrders.slice(0, n) }\n\n    for (const oid in metaOrders) delete metaOrders[oid]\n\n    Doc.empty(page.userOrders)\n    Doc.setVis(sortedOrders?.length, page.userOrders)\n    Doc.setVis(!sortedOrders?.length, page.userNoOrders)\n\n    let unreadyOrders = false\n    for (const mord of sortedOrders) {\n      const div = page.userOrderTmpl.cloneNode(true) as HTMLElement\n      page.userOrders.appendChild(div)\n      const tmpl = Doc.parseTemplate(div)\n      const header = Doc.parseTemplate(tmpl.header)\n      const details = Doc.parseTemplate(tmpl.details)\n\n      mord.div = div\n      mord.header = header\n      mord.details = details\n      const ord = mord.ord\n\n      const orderID = ord.id\n      const isActive = orderIsActive(ord)\n\n      // No need to track in-flight orders here. We've already added it to\n      // display.\n      if (orderID) metaOrders[orderID] = mord\n\n      if (!ord.readyToTick && OrderUtil.hasActiveMatches(ord)) {\n        tmpl.header.classList.add('unready-user-order')\n        unreadyOrders = true\n      }\n      header.sideLight.classList.add(ord.sell ? 'sell' : 'buy')\n      if (!isActive) header.sideLight.classList.add('inactive')\n      details.side.textContent = mord.header.side.textContent = OrderUtil.sellString(ord)\n      details.side.classList.add(ord.sell ? 'sellcolor' : 'buycolor')\n      header.side.classList.add(ord.sell ? 'sellcolor' : 'buycolor')\n      details.qty.textContent = mord.header.qty.textContent = Doc.formatCoinValue(ord.qty, market.baseUnitInfo)\n      let rateStr: string\n      if (ord.type === OrderUtil.Market) rateStr = this.marketOrderRateString(ord, market)\n      else rateStr = Doc.formatRateFullPrecision(ord.rate, market.baseUnitInfo, market.quoteUnitInfo, cfg.ratestep)\n      details.rate.textContent = mord.header.rate.textContent = rateStr\n      header.baseSymbol.textContent = market.baseUnitInfo.conventional.unit\n      details.type.textContent = OrderUtil.orderTypeText(ord.type)\n      this.updateMetaOrder(mord)\n\n      Doc.bind(div, 'mouseenter', () => {\n        this.activeMarkerRate = ord.rate\n        this.setDepthMarkers()\n      })\n\n      const showCancel = (e: Event) => {\n        e.stopPropagation()\n        this.showCancel(div, orderID)\n      }\n\n      const showAccelerate = (e: Event) => {\n        e.stopPropagation()\n        this.showAccelerate(ord)\n      }\n\n      if (!orderID) {\n        Doc.hide(details.accelerateBttn)\n        Doc.hide(details.cancelBttn)\n        Doc.hide(details.link)\n      } else {\n        if (OrderUtil.isCancellable(ord)) {\n          Doc.show(details.cancelBttn)\n          bind(details.cancelBttn, 'click', (e: Event) => { showCancel(e) })\n        }\n\n        bind(details.accelerateBttn, 'click', (e: Event) => { showAccelerate(e) })\n        if (app().canAccelerateOrder(ord)) {\n          Doc.show(details.accelerateBttn)\n        }\n\n        details.link.href = `order/${orderID}`\n        app().bindInternalNavigation(div)\n      }\n      let currentFloater: (PageElement | null)\n      Doc.bind(tmpl.header, 'click', () => {\n        if (Doc.isDisplayed(tmpl.details)) {\n          Doc.hide(tmpl.details)\n          header.expander.classList.add('ico-arrowdown')\n          header.expander.classList.remove('ico-arrowup')\n          return\n        }\n        Doc.show(tmpl.details)\n        header.expander.classList.remove('ico-arrowdown')\n        header.expander.classList.add('ico-arrowup')\n        if (currentFloater) currentFloater.remove()\n      })\n      /**\n       * We'll show the button menu when they hover over the header. To avoid\n       * pushing the layout around, we'll show the buttons as an absolutely\n       * positioned copy of the button menu.\n       */\n      Doc.bind(tmpl.header, 'mouseenter', () => {\n        // Don't show the copy if the details are already displayed.\n        if (Doc.isDisplayed(tmpl.details)) return\n        if (currentFloater) currentFloater.remove()\n        // Create and position the element based on the position of the header.\n        const floater = document.createElement('div')\n        currentFloater = floater\n        document.body.appendChild(floater)\n        floater.className = 'user-order-floaty-menu'\n        const m = Doc.layoutMetrics(tmpl.header)\n        const y = m.bodyTop + m.height\n        floater.style.top = `${y - 1}px` // - 1 to hide border on header div\n        floater.style.left = `${m.bodyLeft}px`\n        // Get the updated version of the order\n        const mord = this.metaOrders[orderID]\n        const ord = mord.ord\n\n        const addButton = (baseBttn: PageElement, cb: ((e: Event) => void)) => {\n          const icon = baseBttn.cloneNode(true) as PageElement\n          floater.appendChild(icon)\n          Doc.show(icon)\n          Doc.bind(icon, 'click', (e: Event) => { cb(e) })\n        }\n\n        if (OrderUtil.isCancellable(ord)) addButton(details.cancelBttn, (e: Event) => { showCancel(e) })\n        if (app().canAccelerateOrder(ord)) addButton(details.accelerateBttn, (e: Event) => { showAccelerate(e) })\n        floater.appendChild(details.link.cloneNode(true))\n\n        const ogScrollY = page.orderScroller.scrollTop\n        // Set up the hover interactions.\n        const moved = (e: MouseEvent) => {\n          // If the user scrolled, reposition the float menu. This keeps the\n          // menu from following us around, which can prevent removal below.\n          const yShift = page.orderScroller.scrollTop - ogScrollY\n          floater.style.top = `${y + yShift}px`\n          if (Doc.mouseInElement(e, floater) || Doc.mouseInElement(e, div)) return\n          floater.remove()\n          currentFloater = null\n          document.removeEventListener('mousemove', moved)\n          page.orderScroller.removeEventListener('scroll', moved)\n        }\n        document.addEventListener('mousemove', moved)\n        page.orderScroller.addEventListener('scroll', moved)\n      })\n      app().bindTooltips(div)\n    }\n    Doc.setVis(unreadyOrders, page.unreadyOrdersMsg)\n    this.setDepthMarkers()\n  }\n\n  /*\n   marketOrderRateString uses the market config rate step to format the average\n   market order rate.\n  */\n  marketOrderRateString (ord: Order, mkt: CurrentMarket) :string {\n    if (!ord.matches?.length) return intl.prep(intl.ID_MARKET_ORDER)\n    let rateStr = Doc.formatRateFullPrecision(OrderUtil.averageRate(ord), mkt.baseUnitInfo, mkt.quoteUnitInfo, mkt.cfg.ratestep)\n    if (ord.matches.length > 1) rateStr = '~ ' + rateStr // ~ only makes sense if the order has more than one match\n    return rateStr\n  }\n\n  /*\n  * updateMetaOrder sets the td contents of the user's order table row.\n  */\n  updateMetaOrder (mord: MetaOrder) {\n    const { header, details, ord } = mord\n    if (ord.status <= OrderUtil.StatusBooked || OrderUtil.hasActiveMatches(ord)) header.activeLight.classList.add('active')\n    else header.activeLight.classList.remove('active')\n    details.status.textContent = header.status.textContent = OrderUtil.statusString(ord)\n    details.age.textContent = Doc.timeSince(ord.submitTime)\n    details.filled.textContent = `${(OrderUtil.filled(ord) / ord.qty * 100).toFixed(1)}%`\n    details.settled.textContent = `${(OrderUtil.settled(ord) / ord.qty * 100).toFixed(1)}%`\n  }\n\n  /* setMarkers sets the depth chart markers for booked orders. */\n  setDepthMarkers () {\n    const markers: Record<string, DepthMarker[]> = {\n      buys: [],\n      sells: []\n    }\n    const rateFactor = this.market.rateConversionFactor\n    for (const { ord } of Object.values(this.metaOrders)) {\n      if (ord.rate && ord.status === OrderUtil.StatusBooked) {\n        if (ord.sell) {\n          markers.sells.push({\n            rate: ord.rate / rateFactor,\n            active: ord.rate === this.activeMarkerRate\n          })\n        } else {\n          markers.buys.push({\n            rate: ord.rate / rateFactor,\n            active: ord.rate === this.activeMarkerRate\n          })\n        }\n      }\n    }\n    this.depthChart.setMarkers(markers)\n    if (this.book) this.depthChart.draw()\n  }\n\n  /* updateTitle update the browser title based on the midgap value and the\n   * selected assets.\n   */\n  updateTitle () {\n    // gets first price value from buy or from sell, so we can show it on\n    // title.\n    const midGapValue = this.midGapConventional()\n    const { baseUnitInfo: { conventional: { unit: bUnit } }, quoteUnitInfo: { conventional: { unit: qUnit } } } = this.market\n    if (!midGapValue) document.title = `${bUnit}${qUnit} | ${this.ogTitle}`\n    else document.title = `${Doc.formatCoinValue(midGapValue)} | ${bUnit}${qUnit} | ${this.ogTitle}` // more than 6 numbers it gets too big for the title.\n  }\n\n  /* handleBookRoute is the handler for the 'book' notification, which is sent\n   * in response to a new market subscription. The data received will contain\n   * the entire order book.\n   */\n  handleBookRoute (note: BookUpdate) {\n    app().log('book', 'handleBookRoute:', note)\n    const mktBook = note.payload\n    const { baseCfg: b, quoteCfg: q, dex: { host } } = this.market\n    if (mktBook.base !== b.id || mktBook.quote !== q.id || note.host !== host) return // user already changed markets\n    this.handleBook(mktBook)\n    this.market.bookLoaded = true\n    this.updateTitle()\n    this.setMarketBuyOrderEstimate()\n  }\n\n  /* handleBookOrderRoute is the handler for 'book_order' notifications. */\n  handleBookOrderRoute (data: BookUpdate) {\n    app().log('book', 'handleBookOrderRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const order = data.payload as MiniOrder\n    if (order.rate > 0) this.book.add(order)\n    this.addTableOrder(order)\n    this.updateTitle()\n    this.depthChart.draw()\n  }\n\n  /* handleUnbookOrderRoute is the handler for 'unbook_order' notifications. */\n  handleUnbookOrderRoute (data: BookUpdate) {\n    app().log('book', 'handleUnbookOrderRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const order = data.payload\n    this.book.remove(order.token)\n    this.removeTableOrder(order)\n    this.updateTitle()\n    this.depthChart.draw()\n  }\n\n  /*\n   * handleUpdateRemainingRoute is the handler for 'update_remaining'\n   * notifications.\n   */\n  handleUpdateRemainingRoute (data: BookUpdate) {\n    app().log('book', 'handleUpdateRemainingRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const update = data.payload\n    this.book.updateRemaining(update.token, update.qty, update.qtyAtomic)\n    this.updateTableOrder(update)\n    this.depthChart.draw()\n  }\n\n  /* handleEpochOrderRoute is the handler for 'epoch_order' notifications. */\n  handleEpochOrderRoute (data: BookUpdate) {\n    app().log('book', 'handleEpochOrderRoute:', data)\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.sid) return\n    const order = data.payload\n    if (order.msgRate > 0) this.book.add(order) // No cancels or market orders\n    if (order.qtyAtomic > 0) this.addTableOrder(order) // No cancel orders\n    this.depthChart.draw()\n  }\n\n  /* handleCandlesRoute is the handler for 'candles' notifications. */\n  handleCandlesRoute (data: BookUpdate) {\n    if (this.candlesLoading) {\n      clearTimeout(this.candlesLoading.timer)\n      this.candlesLoading.loaded()\n      this.candlesLoading = null\n    }\n    if (data.host !== this.market.dex.host || data.marketID !== this.market.cfg.name) return\n    const dur = data.payload.dur\n    this.market.candleCaches[dur] = data.payload\n    this.setHighLow()\n    if (this.candleDur !== dur) return\n    if (this.loadingAnimations.candles) this.loadingAnimations.candles.stop()\n    this.candleChart.canvas.classList.remove('invisible')\n    this.candleChart.setCandles(data.payload, this.market.cfg, this.market.baseUnitInfo, this.market.quoteUnitInfo)\n  }\n\n  handleEpochMatchSummary (data: BookUpdate) {\n    this.addRecentMatches(data.payload.matchSummaries)\n    this.refreshRecentMatchesTable()\n  }\n\n  /* handleCandleUpdateRoute is the handler for 'candle_update' notifications. */\n  handleCandleUpdateRoute (data: BookUpdate) {\n    if (data.host !== this.market.dex.host) return\n    const { dur, candle } = data.payload\n    const cache = this.market.candleCaches[dur]\n    if (!cache) return // must not have seen the 'candles' notification yet?\n    const candles = cache.candles\n    if (candles.length === 0) candles.push(candle)\n    else {\n      const last = candles[candles.length - 1]\n      if (last.startStamp === candle.startStamp) candles[candles.length - 1] = candle\n      else candles.push(candle)\n    }\n    if (this.candleDur !== dur) return\n    this.candleChart.draw()\n  }\n\n  /*\n   * showToggleWalletStatus displays the toggleWalletStatusConfirm form to\n   * enable a wallet.\n   */\n  showToggleWalletStatus (asset: SupportedAsset) {\n    const page = this.page\n    this.openAsset = asset\n    Doc.hide(page.toggleWalletStatusErr, page.walletStatusDisable, page.disableWalletMsg)\n    Doc.show(page.walletStatusEnable, page.enableWalletMsg)\n    this.forms.show(page.toggleWalletStatusConfirm)\n  }\n\n  /*\n   * toggleWalletStatus toggle wallets status to enabled.\n   */\n  async toggleWalletStatus () {\n    const page = this.page\n    Doc.hide(page.toggleWalletStatusErr)\n\n    const url = '/api/togglewalletstatus'\n    const req = {\n      assetID: this.openAsset.id,\n      disable: false\n    }\n\n    const loaded = app().loading(page.toggleWalletStatusConfirm)\n    const res = await postJSON(url, req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.toggleWalletStatusErr.textContent = res.msg\n      Doc.show(page.toggleWalletStatusErr)\n      return\n    }\n\n    Doc.hide(this.page.forms)\n    this.balanceWgt.updateAsset(this.openAsset.id)\n  }\n\n  /* showVerify shows the form to accept the currently parsed order information\n   * and confirm submission of the order to the dex.\n   */\n  showVerify () {\n    this.preorderCache = {}\n    const page = this.page\n    const order = this.currentOrder = this.parseOrder()\n    const isSell = order.sell\n    const baseAsset = app().assets[order.base]\n    const quoteAsset = app().assets[order.quote]\n    const toAsset = isSell ? quoteAsset : baseAsset\n    const fromAsset = isSell ? baseAsset : quoteAsset\n\n    const setIcon = (icon: PageElement) => {\n      switch (icon.dataset.icon) {\n        case 'from':\n          if (fromAsset.token) {\n            const parentAsset = app().assets[fromAsset.token.parentID]\n            icon.src = Doc.logoPath(parentAsset.symbol)\n          } else {\n            icon.src = Doc.logoPath(fromAsset.symbol)\n          }\n          break\n        case 'to':\n          if (toAsset.token) {\n            const parentAsset = app().assets[toAsset.token.parentID]\n            icon.src = Doc.logoPath(parentAsset.symbol)\n          } else {\n            icon.src = Doc.logoPath(toAsset.symbol)\n          }\n      }\n    }\n\n    // Set the to and from icons in the fee details pane.\n    for (const icon of Doc.applySelector(page.vDetailPane, '[data-icon]')) {\n      setIcon(icon)\n    }\n\n    // Set the to and from icons in the fee summary pane.\n    for (const icon of Doc.applySelector(page.vFeeSummary, '[data-icon]')) {\n      setIcon(icon)\n    }\n\n    Doc.hide(page.vPreorderErr)\n    Doc.show(page.vPreorder)\n\n    page.vBuySell.textContent = isSell ? intl.prep(intl.ID_SELLING) : intl.prep(intl.ID_BUYING)\n    const buySellStr = isSell ? intl.prep(intl.ID_SELL) : intl.prep(intl.ID_BUY)\n    page.vSideSubmit.textContent = buySellStr\n    page.vOrderHost.textContent = order.host\n    if (order.isLimit) {\n      Doc.show(page.verifyLimit)\n      Doc.hide(page.verifyMarket)\n      const orderDesc = `Limit ${buySellStr} Order`\n      page.vOrderType.textContent = order.tifnow ? orderDesc + ' (immediate)' : orderDesc\n      page.vRate.textContent = Doc.formatCoinValue(order.rate / this.market.rateConversionFactor)\n      page.vQty.textContent = Doc.formatCoinValue(order.qty, baseAsset.unitInfo)\n      const total = order.rate / OrderUtil.RateEncodingFactor * order.qty\n      page.vTotal.textContent = Doc.formatCoinValue(total, quoteAsset.unitInfo)\n      // Format total fiat value.\n      this.showFiatValue(quoteAsset.id, total, page.vFiatTotal)\n    } else {\n      Doc.hide(page.verifyLimit)\n      Doc.show(page.verifyMarket)\n      page.vOrderType.textContent = `Market ${buySellStr} Order`\n      const ui = order.sell ? this.market.baseUnitInfo : this.market.quoteUnitInfo\n      page.vmFromTotal.textContent = Doc.formatCoinValue(order.qty, ui)\n      page.vmFromAsset.textContent = fromAsset.symbol.toUpperCase()\n      // Format fromAsset fiat value.\n      this.showFiatValue(fromAsset.id, order.qty, page.vmFromTotalFiat)\n      const gap = this.midGap()\n      if (gap) {\n        Doc.show(page.vMarketEstimate)\n        const received = order.sell ? order.qty * gap : order.qty / gap\n        page.vmToTotal.textContent = Doc.formatCoinValue(received, toAsset.unitInfo)\n        page.vmToAsset.textContent = toAsset.symbol.toUpperCase()\n        // Format received value to fiat equivalent.\n        this.showFiatValue(toAsset.id, received, page.vmTotalFiat)\n      } else {\n        Doc.hide(page.vMarketEstimate)\n      }\n    }\n    // Visually differentiate between buy/sell orders.\n    if (isSell) {\n      page.vHeader.classList.add(sellBtnClass)\n      page.vHeader.classList.remove(buyBtnClass)\n      page.vSubmit.classList.add(sellBtnClass)\n      page.vSubmit.classList.remove(buyBtnClass)\n    } else {\n      page.vHeader.classList.add(buyBtnClass)\n      page.vHeader.classList.remove(sellBtnClass)\n      page.vSubmit.classList.add(buyBtnClass)\n      page.vSubmit.classList.remove(sellBtnClass)\n    }\n    this.showVerifyForm()\n\n    if (baseAsset.wallet.open && quoteAsset.wallet.open) this.preOrder(order)\n    else {\n      Doc.hide(page.vPreorder)\n      this.unlockWalletsForEstimates()\n    }\n  }\n\n  // showFiatValue displays the fiat equivalent for an order quantity.\n  showFiatValue (assetID: number, qty: number, display: PageElement) {\n    if (display) {\n      const rate = app().fiatRatesMap[assetID]\n      display.textContent = Doc.formatFiatConversion(qty, rate, app().unitInfo(assetID))\n      if (rate) Doc.show(display.parentElement as Element)\n      else Doc.hide(display.parentElement as Element)\n    }\n  }\n\n  /* showVerifyForm displays form to verify an order */\n  async showVerifyForm () {\n    const page = this.page\n    Doc.hide(page.vErr)\n    this.forms.show(page.verifyForm)\n  }\n\n  /*\n   * unlockWalletsForEstimates unlocks any locked wallets with the provided\n   * password.\n   */\n  async unlockWalletsForEstimates () {\n    const page = this.page\n    const loaded = app().loading(page.verifyForm)\n    await this.unlockMarketWallets()\n    loaded()\n    Doc.show(page.vPreorder)\n    this.preOrder(this.parseOrder())\n  }\n\n  async unlockWallet (assetID: number) {\n    const res = await postJSON('/api/openwallet', { assetID })\n    if (!app().checkResponse(res)) {\n      throw Error('error unlocking wallet ' + res.msg)\n    }\n    this.balanceWgt.updateAsset(assetID)\n  }\n\n  /*\n   * unlockMarketWallets unlocks both the base and quote wallets for the current\n   * market, if locked.\n   */\n  async unlockMarketWallets () {\n    const { base, quote } = this.market\n    const assetIDs = []\n    if (!base.wallet.open) assetIDs.push(base.id)\n    if (!quote.wallet.open) assetIDs.push(quote.id)\n    for (const assetID of assetIDs) {\n      this.unlockWallet(assetID)\n    }\n  }\n\n  /* fetchPreorder fetches the pre-order estimates and options. */\n  async fetchPreorder (order: TradeForm) {\n    const page = this.page\n    const cacheKey = JSON.stringify(order.options)\n    const cached = this.preorderCache[cacheKey]\n    if (cached) return cached\n\n    Doc.hide(page.vPreorderErr)\n    const loaded = app().loading(page.verifyForm)\n    const res = await postJSON('/api/preorder', wireOrder(order))\n    loaded()\n    if (!app().checkResponse(res)) return { err: res.msg }\n    this.preorderCache[cacheKey] = res.estimate\n    return res.estimate\n  }\n\n  /*\n   * setPreorderErr sets and displays the pre-order error message and hides the\n   * pre-order details box.\n   */\n  setPreorderErr (msg: string) {\n    const page = this.page\n    Doc.hide(page.vPreorder)\n    Doc.show(page.vPreorderErr)\n    page.vPreorderErrTip.dataset.tooltip = msg\n  }\n\n  showPreOrderAdvancedOptions () {\n    const page = this.page\n    Doc.hide(page.showAdvancedOptions)\n    Doc.show(page.hideAdvancedOptions, page.vOtherOrderOpts)\n  }\n\n  hidePreOrderAdvancedOptions () {\n    const page = this.page\n    Doc.hide(page.hideAdvancedOptions, page.vOtherOrderOpts)\n    Doc.show(page.showAdvancedOptions)\n  }\n\n  reloadOrderOpts (order: TradeForm, swap: PreSwap, redeem: PreRedeem, changed: ()=>void) {\n    const page = this.page\n    Doc.empty(page.vDefaultOrderOpts, page.vOtherOrderOpts)\n    const addOption = (opt: OrderOption, isSwap: boolean) => {\n      const el = OrderUtil.optionElement(opt, order, changed, isSwap)\n      if (opt.showByDefault) page.vDefaultOrderOpts.appendChild(el)\n      else page.vOtherOrderOpts.appendChild(el)\n    }\n    for (const opt of swap.options || []) addOption(opt, true)\n    for (const opt of redeem.options || []) addOption(opt, false)\n    app().bindTooltips(page.vDefaultOrderOpts)\n    app().bindTooltips(page.vOtherOrderOpts)\n  }\n\n  /* preOrder loads the options and fetches pre-order estimates */\n  async preOrder (order: TradeForm) {\n    const page = this.page\n\n    // Add swap options.\n    const refreshPreorder = async () => {\n      const res: APIResponse = await this.fetchPreorder(order)\n      if (res.err) return this.setPreorderErr(res.err)\n      const est = (res as any) as OrderEstimate\n      Doc.hide(page.vPreorderErr)\n      Doc.show(page.vPreorder)\n      const { swap, redeem } = est\n      swap.options = swap.options || []\n      redeem.options = redeem.options || []\n      this.setFeeEstimates(swap, redeem, order)\n\n      const changed = async () => {\n        await refreshPreorder()\n        Doc.animate(400, progress => {\n          page.vFeeSummary.style.backgroundColor = `rgba(128, 128, 128, ${0.5 - 0.5 * progress})`\n        })\n      }\n      // bind show or hide advanced pre order options.\n      Doc.bind(page.showAdvancedOptions, 'click', () => { this.showPreOrderAdvancedOptions() })\n      Doc.bind(page.hideAdvancedOptions, 'click', () => { this.hidePreOrderAdvancedOptions() })\n      this.reloadOrderOpts(order, swap, redeem, changed)\n    }\n\n    refreshPreorder()\n  }\n\n  /* setFeeEstimates sets all of the pre-order estimate fields */\n  setFeeEstimates (swap: PreSwap, redeem: PreRedeem, order: TradeForm) {\n    const { page, market } = this\n    if (!swap.estimate || !redeem.estimate) {\n      Doc.hide(page.vPreorderEstimates)\n      return // preOrder may return just options, no fee estimates\n    }\n    Doc.show(page.vPreorderEstimates)\n    const { baseUnitInfo, quoteUnitInfo, rateConversionFactor } = market\n    const fmtPct = (value: number) => {\n      if (value < 0.05) return '< 0.1'\n      return percentFormatter.format(value)\n    }\n\n    // If the asset is a token, in order to calculate the fee as a percentage\n    // of the total order, we try to  use the fiat rates to find out the\n    // exchange rate between the token and parent assets.\n    // Initially these are set to 1, which we would use if the asset is not a\n    // token and no conversion is needed.\n    let baseExchangeRate = 1\n    let quoteExchangeRate = 1\n    let baseFeeAssetUI = baseUnitInfo\n    let quoteFeeAssetUI = quoteUnitInfo\n\n    if (market.base.token) {\n      const parent = app().assets[market.base.token.parentID]\n      baseFeeAssetUI = parent.unitInfo\n      const tokenFiatRate = app().fiatRatesMap[market.base.id]\n      const parentFiatRate = app().fiatRatesMap[parent.id]\n      if (tokenFiatRate && parentFiatRate) {\n        const conventionalRate = parentFiatRate / tokenFiatRate\n        baseExchangeRate = conventionalRate * baseUnitInfo.conventional.conversionFactor / parent.unitInfo.conventional.conversionFactor\n      } else {\n        baseExchangeRate = 0\n      }\n    }\n\n    if (market.quote.token) {\n      const parent = app().assets[market.quote.token.parentID]\n      quoteFeeAssetUI = parent.unitInfo\n      const tokenFiatRate = app().fiatRatesMap[market.quote.id]\n      const parentFiatRate = app().fiatRatesMap[parent.id]\n      if (tokenFiatRate && parentFiatRate) {\n        const conventionalRate = parentFiatRate / tokenFiatRate\n        quoteExchangeRate = conventionalRate * quoteUnitInfo.conventional.conversionFactor / parent.unitInfo.conventional.conversionFactor\n      } else {\n        quoteExchangeRate = 0\n      }\n    }\n\n    let [toFeeAssetUI, fromFeeAssetUI] = [baseFeeAssetUI, quoteFeeAssetUI]\n    let [toExchangeRate, fromExchangeRate] = [baseExchangeRate, quoteExchangeRate]\n    if (this.currentOrder.sell) {\n      [fromFeeAssetUI, toFeeAssetUI] = [toFeeAssetUI, fromFeeAssetUI];\n      [fromExchangeRate, toExchangeRate] = [toExchangeRate, fromExchangeRate]\n    }\n\n    const swapped = swap.estimate.value || 0\n    const swappedInParentUnits = fromExchangeRate > 0 ? swapped / fromExchangeRate : swapped\n\n    // Set swap fee estimates in the details pane.\n    const bestSwapPct = swap.estimate.realisticBestCase / swappedInParentUnits * 100\n    page.vSwapFeesLowPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(bestSwapPct)}%)`\n    page.vSwapFeesLow.textContent = Doc.formatCoinValue(swap.estimate.realisticBestCase, fromFeeAssetUI)\n\n    const worstSwapPct = swap.estimate.realisticWorstCase / swappedInParentUnits * 100\n    page.vSwapFeesHighPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(worstSwapPct)}%)`\n    page.vSwapFeesHigh.textContent = Doc.formatCoinValue(swap.estimate.realisticWorstCase, fromFeeAssetUI)\n\n    const swapFeesMaxPct = swap.estimate.maxFees / swappedInParentUnits * 100\n    page.vSwapFeesMaxPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(swapFeesMaxPct)}%)`\n    page.vSwapFeesMax.textContent = Doc.formatCoinValue(swap.estimate.maxFees, fromFeeAssetUI)\n\n    // Set redemption fee estimates in the details pane.\n    const midGap = this.midGap()\n    const estRate = midGap || order.rate / rateConversionFactor\n    const received = order.sell ? swapped * estRate : swapped / estRate\n    const receivedInParentUnits = toExchangeRate > 0 ? received / toExchangeRate : received\n\n    const bestRedeemPct = redeem.estimate.realisticBestCase / receivedInParentUnits * 100\n    page.vRedeemFeesLowPct.textContent = toExchangeRate <= 0 ? '' : `(${fmtPct(bestRedeemPct)}%)`\n    page.vRedeemFeesLow.textContent = Doc.formatCoinValue(redeem.estimate.realisticBestCase, toFeeAssetUI)\n\n    const worstRedeemPct = redeem.estimate.realisticWorstCase / receivedInParentUnits * 100\n    page.vRedeemFeesHighPct.textContent = toExchangeRate <= 0 ? '' : `(${fmtPct(worstRedeemPct)}%)`\n    page.vRedeemFeesHigh.textContent = Doc.formatCoinValue(redeem.estimate.realisticWorstCase, toFeeAssetUI)\n\n    if (baseExchangeRate && quoteExchangeRate) {\n      Doc.show(page.vFeeSummaryPct)\n      Doc.hide(page.vFeeSummary)\n      page.vFeeSummaryLow.textContent = fmtPct(bestSwapPct + bestRedeemPct)\n      page.vFeeSummaryHigh.textContent = fmtPct(worstSwapPct + worstRedeemPct)\n    } else {\n      Doc.hide(page.vFeeSummaryPct)\n      Doc.show(page.vFeeSummary)\n      page.summarySwapFeesLow.textContent = page.vSwapFeesLow.textContent\n      page.summarySwapFeesHigh.textContent = page.vSwapFeesHigh.textContent\n      page.summaryRedeemFeesLow.textContent = page.vRedeemFeesLow.textContent\n      page.summaryRedeemFeesHigh.textContent = page.vRedeemFeesHigh.textContent\n    }\n  }\n\n  async submitCancel () {\n    // this will be the page.cancelSubmit button (evt.currentTarget)\n    const page = this.page\n    const cancelData = this.cancelData\n    const order = cancelData.order\n    const req = {\n      orderID: order.id\n    }\n    // Toggle the loader and submit button.\n    const loaded = app().loading(page.cancelSubmit)\n    const res = await postJSON('/api/cancel', req)\n    loaded()\n    // Display error on confirmation modal.\n    if (!app().checkResponse(res)) {\n      page.cancelErr.textContent = res.msg\n      Doc.show(page.cancelErr)\n      return\n    }\n    // Hide confirmation modal only on success.\n    Doc.hide(cancelData.bttn, page.forms)\n    order.cancelling = true\n  }\n\n  /* showCancel shows a form to confirm submission of a cancel order. */\n  showCancel (row: HTMLElement, orderID: string) {\n    const ord = this.metaOrders[orderID].ord\n    const page = this.page\n    const remaining = ord.qty - ord.filled\n    const asset = OrderUtil.isMarketBuy(ord) ? this.market.quote : this.market.base\n    page.cancelRemain.textContent = Doc.formatCoinValue(remaining, asset.unitInfo)\n    page.cancelUnit.textContent = asset.symbol.toUpperCase()\n    Doc.hide(page.cancelErr)\n    this.forms.show(page.cancelForm)\n    this.cancelData = {\n      bttn: Doc.tmplElement(row, 'cancelBttn'),\n      order: ord\n    }\n  }\n\n  /* showAccelerate shows the accelerate order form. */\n  showAccelerate (order: Order) {\n    const loaded = app().loading(this.main)\n    this.accelerateOrderForm.refresh(order)\n    loaded()\n    this.forms.show(this.page.accelerateForm)\n  }\n\n  /* showCreate shows the new wallet creation form. */\n  showCreate (asset: SupportedAsset) {\n    const page = this.page\n    this.currentCreate = asset\n    this.newWalletForm.setAsset(asset.id)\n    this.forms.show(page.newWalletForm)\n  }\n\n  /*\n   * stepSubmit will examine the current state of wallets and step the user\n   * through the process of order submission.\n   * NOTE: I expect this process will be streamlined soon such that the wallets\n   * will attempt to be unlocked in the order submission process, negating the\n   * need to unlock ahead of time.\n   */\n  stepSubmit () {\n    const page = this.page\n    const market = this.market\n    Doc.hide(page.orderErr)\n    if (!this.validateOrder(this.parseOrder())) return\n    const baseWallet = app().walletMap[market.base.id]\n    const quoteWallet = app().walletMap[market.quote.id]\n    if (!baseWallet) {\n      page.orderErr.textContent = intl.prep(intl.ID_NO_ASSET_WALLET, { asset: market.base.symbol })\n      Doc.show(page.orderErr)\n      return\n    }\n    if (!quoteWallet) {\n      page.orderErr.textContent = intl.prep(intl.ID_NO_ASSET_WALLET, { asset: market.quote.symbol })\n      Doc.show(page.orderErr)\n      return\n    }\n    this.showVerify()\n  }\n\n  /* Display a deposit address. */\n  async showDeposit (assetID: number) {\n    this.depositAddrForm.setAsset(assetID)\n    this.forms.show(this.page.deposit)\n  }\n\n  showCustomProviderDialog (assetID: number) {\n    app().loadPage('wallets', { promptProvider: assetID, goBack: 'markets' })\n  }\n\n  /*\n   * handlePriceUpdate is the handler for the 'spots' notification.\n   */\n  handlePriceUpdate (note: SpotPriceNote) {\n    if (!this.market) return // This note can arrive before the market is set.\n    if (note.host === this.market.dex.host && note.spots[this.market.cfg.name]) {\n      this.setCurrMarketPrice()\n    }\n    this.marketList.updateSpots(note)\n  }\n\n  async handleWalletState (note: WalletStateNote) {\n    if (!this.market) return // This note can arrive before the market is set.\n    // if (note.topic !== 'TokenApproval') return\n    if (note.wallet.assetID !== this.market.base?.id && note.wallet.assetID !== this.market.quote?.id) return\n    this.setTokenApprovalVisibility()\n    this.resolveOrderFormVisibility()\n  }\n\n  /*\n   * handleBondUpdate is the handler for the 'bondpost' notification type.\n   * This is used to update the registration status of the current exchange.\n   */\n  async handleBondUpdate (note: BondNote) {\n    const dexAddr = note.dex\n    if (!this.market) return // This note can arrive before the market is set.\n    if (dexAddr !== this.market.dex.host) return\n    // If we just finished legacy registration, we need to update the Exchange.\n    // TODO: Use tier change notification once available.\n    if (note.topic === 'AccountRegistered') await app().fetchUser()\n    // Update local copy of Exchange.\n    this.market.dex = app().exchanges[dexAddr]\n    this.setRegistrationStatusVisibility()\n    this.updateReputation()\n  }\n\n  updateReputation () {\n    const { page, market: { dex: { host }, cfg: mkt, baseCfg: { unitInfo: bui }, quoteCfg: { unitInfo: qui } } } = this\n    const { auth } = app().exchanges[host]\n\n    page.parcelSizeLots.textContent = String(mkt.parcelsize)\n    page.marketLimitBase.textContent = Doc.formatFourSigFigs(mkt.parcelsize * mkt.lotsize / bui.conventional.conversionFactor)\n    page.marketLimitBaseUnit.textContent = bui.conventional.unit\n    page.marketLimitQuoteUnit.textContent = qui.conventional.unit\n    const conversionRate = this.anyRate()[1]\n    if (conversionRate) {\n      const quoteLot = mkt.lotsize * conversionRate\n      page.marketLimitQuote.textContent = Doc.formatFourSigFigs(mkt.parcelsize * quoteLot / qui.conventional.conversionFactor)\n    } else page.marketLimitQuote.textContent = '-'\n\n    const tier = strongTier(auth)\n    page.tradingTier.textContent = String(tier)\n    const [usedParcels, parcelLimit] = tradingLimits(host)\n    page.tradingLimit.textContent = (parcelLimit * mkt.parcelsize).toFixed(2)\n    page.limitUsage.textContent = parcelLimit > 0 ? (usedParcels / parcelLimit * 100).toFixed(1) : '0'\n\n    page.orderLimitRemain.textContent = ((parcelLimit - usedParcels) * mkt.parcelsize).toFixed(1)\n    page.orderTradingTier.textContent = String(tier)\n\n    this.reputationMeter.update()\n  }\n\n  /*\n   * anyRate finds the best rate from any of, in order of priority, the order\n   * book, the server's reported spot rate, or the fiat exchange rates. A\n   * 3-tuple of message-rate encoding, a conversion rate, and a conventional\n   * rate is generated.\n   */\n  anyRate (): [number, number, number] {\n    const { cfg: { spot }, baseCfg: { id: baseID }, quoteCfg: { id: quoteID }, rateConversionFactor, bookLoaded } = this.market\n    if (bookLoaded) {\n      const midGap = this.midGap()\n      if (midGap) return [midGap * OrderUtil.RateEncodingFactor, midGap, this.midGapConventional() || 0]\n    }\n    if (spot && spot.rate) return [spot.rate, spot.rate / OrderUtil.RateEncodingFactor, spot.rate / rateConversionFactor]\n    const [baseUSD, quoteUSD] = [app().fiatRatesMap[baseID], app().fiatRatesMap[quoteID]]\n    if (baseUSD && quoteUSD) {\n      const conventionalRate = baseUSD / quoteUSD\n      const msgRate = conventionalRate * rateConversionFactor\n      const conversionRate = msgRate / OrderUtil.RateEncodingFactor\n      return [msgRate, conversionRate, conventionalRate]\n    }\n    return [0, 0, 0]\n  }\n\n  handleMatchNote (note: MatchNote) {\n    const mord = this.metaOrders[note.orderID]\n    const match = note.match\n    if (!mord) return this.refreshActiveOrders()\n    else if (mord.ord.type === OrderUtil.Market && match.status === OrderUtil.NewlyMatched) { // Update the average market rate display.\n      // Fetch and use the updated order.\n      const ord = app().order(note.orderID)\n      if (ord) mord.details.rate.textContent = mord.header.rate.textContent = this.marketOrderRateString(ord, this.market)\n    }\n    if (\n      (match.side === OrderUtil.MatchSideMaker && match.status === OrderUtil.MakerRedeemed) ||\n      (match.side === OrderUtil.MatchSideTaker && match.status === OrderUtil.MatchComplete)\n    ) this.updateReputation()\n    if (app().canAccelerateOrder(mord.ord)) Doc.show(mord.details.accelerateBttn)\n    else Doc.hide(mord.details.accelerateBttn)\n  }\n\n  /*\n   * handleOrderNote is the handler for the 'order'-type notification, which are\n   * used to update a user's order's status.\n   */\n  handleOrderNote (note: OrderNote) {\n    const ord = note.order\n    const mord = this.metaOrders[ord.id]\n    // - If metaOrder doesn't exist for the given order it means it was created\n    //  via bwctl and the GUI isn't aware of it or it was an inflight order.\n    //  refreshActiveOrders must be called to grab this order.\n    // - If an OrderLoaded notification is recieved, it means an order that was\n    //   previously not \"ready to tick\" (due to its wallets not being connected\n    //   and unlocked) has now become ready to tick. The active orders section\n    //   needs to be refreshed.\n    const wasInflight = note.topic === 'AsyncOrderFailure' || note.topic === 'AsyncOrderSubmitted'\n    if (!mord || wasInflight || (note.topic === 'OrderLoaded' && ord.readyToTick)) {\n      return this.refreshActiveOrders()\n    }\n    const oldStatus = mord.ord.status\n    mord.ord = ord\n    if (note.topic === 'MissedCancel') Doc.show(mord.details.cancelBttn)\n    if (ord.filled === ord.qty) Doc.hide(mord.details.cancelBttn)\n    if (app().canAccelerateOrder(ord)) Doc.show(mord.details.accelerateBttn)\n    else Doc.hide(mord.details.accelerateBttn)\n    this.updateMetaOrder(mord)\n    // Only reset markers if there is a change, since the chart is redrawn.\n    if (\n      (oldStatus === OrderUtil.StatusEpoch && ord.status === OrderUtil.StatusBooked) ||\n      (oldStatus === OrderUtil.StatusBooked && ord.status > OrderUtil.StatusBooked)\n    ) {\n      this.setDepthMarkers()\n      this.updateReputation()\n      this.mm.readBook()\n    }\n  }\n\n  /*\n   * handleEpochNote handles notifications signalling the start of a new epoch.\n   */\n  handleEpochNote (note: EpochNote) {\n    app().log('book', 'handleEpochNote:', note)\n    if (!this.market) return // This note can arrive before the market is set.\n    if (note.host !== this.market.dex.host || note.marketID !== this.market.sid) return\n    if (this.book) {\n      this.book.setEpoch(note.epoch)\n      this.depthChart.draw()\n    }\n\n    this.clearOrderTableEpochs()\n    for (const { ord, details, header } of Object.values(this.metaOrders)) {\n      const alreadyMatched = note.epoch > ord.epoch\n      switch (true) {\n        case ord.type === OrderUtil.Limit && ord.status === OrderUtil.StatusEpoch && alreadyMatched: {\n          const status = ord.tif === OrderUtil.ImmediateTiF ? intl.prep(intl.ID_EXECUTED) : intl.prep(intl.ID_BOOKED)\n          details.status.textContent = header.status.textContent = status\n          ord.status = ord.tif === OrderUtil.ImmediateTiF ? OrderUtil.StatusExecuted : OrderUtil.StatusBooked\n          break\n        }\n        case ord.type === OrderUtil.Market && ord.status === OrderUtil.StatusEpoch:\n          // Technically don't know if this should be 'executed' or 'settling'.\n          details.status.textContent = header.status.textContent = intl.prep(intl.ID_EXECUTED)\n          ord.status = OrderUtil.StatusExecuted\n          break\n      }\n    }\n  }\n\n  /*\n   * recentMatchesSortCompare returns sort compare function according to the active\n   * sort key and direction.\n   */\n  recentMatchesSortCompare () {\n    switch (this.recentMatchesSortKey) {\n      case 'rate':\n        return (a: RecentMatch, b: RecentMatch) => this.recentMatchesSortDirection * (a.rate - b.rate)\n      case 'qty':\n        return (a: RecentMatch, b: RecentMatch) => this.recentMatchesSortDirection * (a.qty - b.qty)\n      case 'age':\n        return (a: RecentMatch, b:RecentMatch) => this.recentMatchesSortDirection * (a.stamp - b.stamp)\n    }\n  }\n\n  refreshRecentMatchesTable () {\n    const page = this.page\n    const recentMatches = this.recentMatches\n    Doc.empty(page.recentMatchesLiveList)\n    if (!recentMatches) return\n    const compare = this.recentMatchesSortCompare()\n    recentMatches.sort(compare)\n    for (const match of recentMatches) {\n      const row = page.recentMatchesTemplate.cloneNode(true) as HTMLElement\n      const tmpl = Doc.parseTemplate(row)\n      app().bindTooltips(row)\n      tmpl.rate.textContent = Doc.formatCoinValue(match.rate / this.market.rateConversionFactor)\n      tmpl.qty.textContent = Doc.formatCoinValue(match.qty, this.market.baseUnitInfo)\n      tmpl.age.textContent = Doc.timeSince(match.stamp)\n      tmpl.age.dataset.sinceStamp = String(match.stamp)\n      row.classList.add(match.sell ? 'sellcolor' : 'buycolor')\n      page.recentMatchesLiveList.append(row)\n    }\n  }\n\n  addRecentMatches (matches: RecentMatch[]) {\n    this.recentMatches = [...matches, ...this.recentMatches].slice(0, 100)\n  }\n\n  /* handleBalanceNote handles notifications updating a wallet's balance. */\n  handleBalanceNote (note: BalanceNote) {\n    this.approveTokenForm.handleBalanceNote(note)\n    this.preorderCache = {} // invalidate previous preorder results\n    // if connection to dex server fails, it is not possible to retrieve\n    // markets.\n    const mkt = this.market\n    if (!mkt || !mkt.dex || mkt.dex.connectionStatus !== ConnectionStatus.Connected) return\n\n    this.mm.handleBalanceNote(note)\n    const wgt = this.balanceWgt\n    // Display the widget if the balance note is for its base or quote wallet.\n    if ((note.assetID === wgt.base.id || note.assetID === wgt.quote.id)) wgt.setBalanceVisibility(true)\n\n    // If there's a balance update, refresh the max order section.\n    const avail = note.balance.available\n    switch (note.assetID) {\n      case mkt.baseCfg.id:\n        // If we're not showing the max order panel yet, don't do anything.\n        if (!mkt.maxSell) break\n        if (typeof mkt.sellBalance === 'number' && mkt.sellBalance !== avail) mkt.maxSell = null\n        if (this.isSell()) this.preSell()\n        break\n      case mkt.quoteCfg.id:\n        if (!Object.keys(mkt.maxBuys).length) break\n        if (typeof mkt.buyBalance === 'number' && mkt.buyBalance !== avail) mkt.maxBuys = {}\n        if (!this.isSell()) this.preBuy()\n    }\n  }\n\n  /*\n   * submitOrder is attached to the affirmative button on the order validation\n   * form. Clicking the button is the last step in the order submission process.\n   */\n  async submitOrder () {\n    const page = this.page\n    Doc.hide(page.orderErr, page.vErr)\n    const order = this.currentOrder\n    const req = { order: wireOrder(order) }\n    if (!this.validateOrder(order)) return\n    // Show loader and hide submit button.\n    page.vSubmit.classList.add('d-hide')\n    page.vLoader.classList.remove('d-hide')\n    const res = await postJSON('/api/tradeasync', req)\n    // Hide loader and show submit button.\n    page.vSubmit.classList.remove('d-hide')\n    page.vLoader.classList.add('d-hide')\n    // If error, display error on confirmation modal.\n    if (!app().checkResponse(res)) {\n      page.vErr.textContent = res.msg\n      Doc.show(page.vErr)\n      return\n    }\n    // Hide confirmation modal only on success.\n    Doc.hide(page.forms)\n    this.refreshActiveOrders()\n  }\n\n  /*\n   * createWallet is attached to successful submission of the wallet creation\n   * form. createWallet is only called once the form is submitted and a success\n   * response is received from the client.\n   */\n  async createWallet () {\n    const user = await app().fetchUser()\n    if (!user) return\n    const asset = user.assets[this.currentCreate.id]\n    Doc.hide(this.page.forms)\n    const mkt = this.market\n    if (mkt.baseCfg.id === asset.id) mkt.base = asset\n    else if (mkt.quoteCfg.id === asset.id) mkt.quote = asset\n    this.balanceWgt.updateAsset(asset.id)\n    this.displayMessageIfMissingWallet()\n    this.resolveOrderFormVisibility()\n  }\n\n  /* lotChanged is attached to the keyup and change events of the lots input. */\n  lotChanged () {\n    const page = this.page\n    const lots = parseInt(page.lotField.value || '0')\n    if (lots <= 0) {\n      page.lotField.value = page.lotField.value === '' ? '' : '0'\n      page.qtyField.value = ''\n      this.previewQuoteAmt(false)\n      this.setOrderBttnEnabled(false, intl.prep(intl.ID_ORDER_BUTTON_QTY_ERROR))\n      return\n    }\n    const lotSize = this.market.cfg.lotsize\n    const orderQty = lots * lotSize\n    page.lotField.value = String(lots)\n    // Conversion factor must be a multiple of 10.\n    page.qtyField.value = String(orderQty / this.market.baseUnitInfo.conventional.conversionFactor)\n\n    if (!this.isLimit() && this.isSell()) {\n      const baseWallet = app().assets[this.market.base.id].wallet\n      this.setOrderBttnEnabled(orderQty <= baseWallet.balance.available, intl.prep(intl.ID_ORDER_BUTTON_SELL_BALANCE_ERROR))\n    }\n    this.previewQuoteAmt(true)\n  }\n\n  /*\n   * quantityChanged is attached to the keyup and change events of the quantity\n   * input.\n   */\n  quantityChanged (finalize: boolean) {\n    const page = this.page\n    const order = this.currentOrder = this.parseOrder()\n    if (order.qty < 0) {\n      page.lotField.value = '0'\n      page.qtyField.value = ''\n      this.previewQuoteAmt(false)\n      return\n    }\n    const lotSize = this.market.cfg.lotsize\n    const lots = Math.floor(order.qty / lotSize)\n    const adjusted = order.qty = this.currentOrder.qty = lots * lotSize\n    page.lotField.value = String(lots)\n\n    if (!order.isLimit && !order.sell) return\n\n    // Conversion factor must be a multiple of 10.\n    if (finalize) page.qtyField.value = String(adjusted / this.market.baseUnitInfo.conventional.conversionFactor)\n    this.previewQuoteAmt(true)\n  }\n\n  /*\n   * marketBuyChanged is attached to the keyup and change events of the quantity\n   * input for the market-buy form.\n   */\n  marketBuyChanged () {\n    const page = this.page\n    const qty = convertToAtoms(page.mktBuyField.value || '', this.market.quoteUnitInfo.conventional.conversionFactor)\n    const gap = this.midGap()\n    if (qty > 0) {\n      const quoteWallet = app().assets[this.market.quote.id].wallet\n      this.setOrderBttnEnabled(qty <= quoteWallet.balance.available, intl.prep(intl.ID_ORDER_BUTTON_BUY_BALANCE_ERROR))\n    } else {\n      this.setOrderBttnEnabled(false, intl.prep(intl.ID_ORDER_BUTTON_QTY_ERROR))\n    }\n    if (!gap || !qty) {\n      page.mktBuyLots.textContent = '0'\n      page.mktBuyScore.textContent = '0'\n      return\n    }\n    const lotSize = this.market.cfg.lotsize\n    const received = qty / gap\n    const lots = (received / lotSize)\n    page.mktBuyLots.textContent = lots.toFixed(1)\n    page.mktBuyScore.textContent = Doc.formatCoinValue(received, this.market.baseUnitInfo)\n  }\n\n  /*\n   * rateFieldChanged is attached to the keyup and change events of the rate\n   * input.\n   */\n  rateFieldChanged () {\n    // Truncate to rate step. If it is a market buy order, do not adjust.\n    const adjusted = this.adjustedRate()\n    if (adjusted <= 0) {\n      this.depthLines.input = []\n      this.drawChartLines()\n      this.page.rateField.value = '0'\n      this.previewQuoteAmt(true)\n      this.updateOrderBttnState()\n      return\n    }\n    const order = this.currentOrder = this.parseOrder()\n    const r = adjusted / this.market.rateConversionFactor\n    this.page.rateField.value = String(r)\n    this.depthLines.input = [{\n      rate: r,\n      color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine\n    }]\n    this.drawChartLines()\n    this.previewQuoteAmt(true)\n    this.updateOrderBttnState()\n  }\n\n  /*\n   * adjustedRate is the current rate field rate, rounded down to a\n   * multiple of rateStep.\n   */\n  adjustedRate (): number {\n    const v = this.page.rateField.value\n    if (!v) return NaN\n    const rate = convertToAtoms(v, this.market.rateConversionFactor)\n    const rateStep = this.market.cfg.ratestep\n    return rate - (rate % rateStep)\n  }\n\n  /* loadTable reloads the table from the current order book information. */\n  loadTable () {\n    this.loadTableSide(true)\n    this.loadTableSide(false)\n  }\n\n  /* binOrdersByRateAndEpoch takes a list of sorted orders and returns the\n     same orders grouped into arrays. The orders are grouped by their rate\n     and whether or not they are epoch queue orders. Epoch queue orders\n     will come after non epoch queue orders with the same rate. */\n  binOrdersByRateAndEpoch (orders: MiniOrder[]) {\n    if (!orders || !orders.length) return []\n    const bins = []\n    let currEpochBin = []\n    let currNonEpochBin = []\n    let currRate = orders[0].msgRate\n    if (orders[0].epoch) currEpochBin.push(orders[0])\n    else currNonEpochBin.push(orders[0])\n    for (let i = 1; i < orders.length; i++) {\n      if (orders[i].msgRate !== currRate) {\n        bins.push(currNonEpochBin)\n        bins.push(currEpochBin)\n        currEpochBin = []\n        currNonEpochBin = []\n        currRate = orders[i].msgRate\n      }\n      if (orders[i].epoch) currEpochBin.push(orders[i])\n      else currNonEpochBin.push(orders[i])\n    }\n    bins.push(currNonEpochBin)\n    bins.push(currEpochBin)\n    return bins.filter(bin => bin.length > 0)\n  }\n\n  /* loadTables loads the order book side into its table. */\n  loadTableSide (sell: boolean) {\n    const bookSide = sell ? this.book.sells : this.book.buys\n    const tbody = sell ? this.page.sellRows : this.page.buyRows\n    Doc.empty(tbody)\n    if (!bookSide || !bookSide.length) return\n    const orderBins = this.binOrdersByRateAndEpoch(bookSide)\n    orderBins.forEach(bin => { tbody.appendChild(this.orderTableRow(bin)) })\n  }\n\n  /* addTableOrder adds a single order to the appropriate table. */\n  addTableOrder (order: MiniOrder) {\n    const tbody = order.sell ? this.page.sellRows : this.page.buyRows\n    let row = tbody.firstChild as OrderRow\n    // Handle market order differently.\n    if (order.rate === 0) {\n      if (order.qtyAtomic === 0) return // a cancel order. TODO: maybe make an indicator on the target order, maybe gray out\n      // This is a market order.\n      if (row && row.manager.getRate() === 0) {\n        row.manager.insertOrder(order)\n      } else {\n        row = this.orderTableRow([order])\n        tbody.insertBefore(row, tbody.firstChild)\n      }\n      return\n    }\n    // Must be a limit order. Sort by rate. Skip the market order row.\n    if (row && row.manager.getRate() === 0) row = row.nextSibling as OrderRow\n    while (row) {\n      if (row.manager.compare(order) === 0) {\n        row.manager.insertOrder(order)\n        return\n      } else if (row.manager.compare(order) > 0) {\n        const tr = this.orderTableRow([order])\n        tbody.insertBefore(tr, row)\n        return\n      }\n      row = row.nextSibling as OrderRow\n    }\n    const tr = this.orderTableRow([order])\n    tbody.appendChild(tr)\n  }\n\n  /* removeTableOrder removes a single order from its table. */\n  removeTableOrder (order: MiniOrder) {\n    const token = order.token\n    for (const tbody of [this.page.sellRows, this.page.buyRows]) {\n      for (const tr of (Array.from(tbody.children) as OrderRow[])) {\n        if (tr.manager.removeOrder(token)) {\n          return\n        }\n      }\n    }\n  }\n\n  /* updateTableOrder looks for the order in the table and updates the qty */\n  updateTableOrder (u: RemainderUpdate) {\n    for (const tbody of [this.page.sellRows, this.page.buyRows]) {\n      for (const tr of (Array.from(tbody.children) as OrderRow[])) {\n        if (tr.manager.updateOrderQty(u)) {\n          return\n        }\n      }\n    }\n  }\n\n  /*\n   * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired.\n   */\n  clearOrderTableEpochs () {\n    this.clearOrderTableEpochSide(this.page.sellRows)\n    this.clearOrderTableEpochSide(this.page.buyRows)\n  }\n\n  /*\n   * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired\n   * for a single side.\n   */\n  clearOrderTableEpochSide (tbody: HTMLElement) {\n    for (const tr of (Array.from(tbody.children)) as OrderRow[]) {\n      tr.manager.removeEpochOrders()\n    }\n  }\n\n  /*\n   * orderTableRow creates a new <tr> element to insert into an order table.\n     Takes a bin of orders with the same rate, and displays the total quantity.\n   */\n  orderTableRow (orderBin: MiniOrder[]): OrderRow {\n    const tr = this.page.orderRowTmpl.cloneNode(true) as OrderRow\n    const { baseUnitInfo, quoteUnitInfo, rateConversionFactor, cfg: { ratestep: rateStep } } = this.market\n    const manager = new OrderTableRowManager(tr, orderBin, baseUnitInfo, quoteUnitInfo, rateStep)\n    tr.manager = manager\n    bind(tr, 'click', () => {\n      this.reportDepthClick(tr.manager.getRate() / rateConversionFactor)\n    })\n    if (tr.manager.getRate() !== 0) {\n      Doc.bind(tr, 'mouseenter', () => {\n        const chart = this.depthChart\n        this.depthLines.hover = [{\n          rate: tr.manager.getRate() / rateConversionFactor,\n          color: tr.manager.isSell() ? chart.theme.sellLine : chart.theme.buyLine\n        }]\n        this.drawChartLines()\n      })\n    }\n    return tr\n  }\n\n  /* handleConnNote handles the 'conn' notification.\n   */\n  async handleConnNote (note: ConnEventNote) {\n    this.marketList.setConnectionStatus(note)\n    if (note.connectionStatus === ConnectionStatus.Connected) {\n      // Having been disconnected from a DEX server, anything may have changed,\n      // or this may be the first opportunity to get the server's config, so\n      // fetch it all before reloading the markets page.\n      await app().fetchUser()\n      await app().loadPage('markets')\n    }\n  }\n\n  /*\n   * filterMarkets sets the display of markets in the markets list based on the\n   * value of the search input.\n   */\n  filterMarkets () {\n    const filterTxt = this.page.marketSearchV1.value?.toLowerCase()\n    const filter = filterTxt ? (mkt: MarketRow) => mkt.name.includes(filterTxt) : () => true\n    this.marketList.setFilter(filter)\n  }\n\n  /* drawChartLines draws the hover and input lines on the chart. */\n  drawChartLines () {\n    this.depthChart.setLines([...this.depthLines.hover, ...this.depthLines.input])\n    this.depthChart.draw()\n  }\n\n  /* candleDurationSelected sets the candleDur and loads the candles. It will\n  default to the oneHrBinKey if dur is not valid. */\n  candleDurationSelected (dur: string) {\n    if (!this.market?.dex?.candleDurs.includes(dur)) dur = oneHrBinKey\n    this.candleDur = dur\n    this.loadCandles()\n    State.storeLocal(State.lastCandleDurationLK, dur)\n  }\n\n  /*\n   * loadCandles loads the candles for the current candleDur. If a cache is already\n   * active, the cache will be used without a loadcandles request.\n   */\n  loadCandles () {\n    for (const bttn of Doc.kids(this.page.durBttnBox)) {\n      if (bttn.textContent === this.candleDur) bttn.classList.add('selected')\n      else bttn.classList.remove('selected')\n    }\n    const { candleCaches, cfg, baseUnitInfo, quoteUnitInfo } = this.market\n    const cache = candleCaches[this.candleDur]\n    if (cache) {\n      // this.depthChart.hide()\n      // this.candleChart.show()\n      this.candleChart.setCandles(cache, cfg, baseUnitInfo, quoteUnitInfo)\n      return\n    }\n    this.requestCandles()\n  }\n\n  /* requestCandles sends the loadcandles request. It accepts an optional candle\n   * duration which will be requested if it is provided.\n   */\n  requestCandles (candleDur?: string) {\n    this.candlesLoading = {\n      loaded: () => { /* pass */ },\n      timer: window.setTimeout(() => {\n        if (this.candlesLoading) {\n          this.candlesLoading = null\n          console.error('candles not received')\n        }\n      }, 10000)\n    }\n    const { dex, baseCfg, quoteCfg } = this.market\n    ws.request('loadcandles', { host: dex.host, base: baseCfg.id, quote: quoteCfg.id, dur: candleDur || this.candleDur })\n  }\n\n  /*\n   * unload is called by the Application when the user navigates away from\n   * the /markets page.\n   */\n  unload () {\n    ws.request(unmarketRoute, {})\n    ws.deregisterRoute(bookRoute)\n    ws.deregisterRoute(bookOrderRoute)\n    ws.deregisterRoute(unbookOrderRoute)\n    ws.deregisterRoute(updateRemainingRoute)\n    ws.deregisterRoute(epochOrderRoute)\n    ws.deregisterRoute(candlesRoute)\n    ws.deregisterRoute(candleUpdateRoute)\n    this.depthChart.unattach()\n    this.candleChart.unattach()\n    Doc.unbind(document, 'keyup', this.keyup)\n    clearInterval(this.secondTicker)\n  }\n}\n\n/*\n *  MarketList represents the list of exchanges and markets on the left side of\n * markets view. The MarketList provides utilities for adjusting the visibility\n * and sort order of markets.\n */\nclass MarketList {\n  // xcSections: ExchangeSection[]\n  div: PageElement\n  rowTmpl: PageElement\n  markets: MarketRow[]\n  selected: MarketRow\n\n  constructor (div: HTMLElement) {\n    this.div = div\n    this.rowTmpl = Doc.idel(div, 'marketTmplV1')\n    Doc.cleanTemplates(this.rowTmpl)\n    this.reloadMarketsPane()\n  }\n\n  updateSpots (note: SpotPriceNote) {\n    for (const row of this.markets) {\n      if (row.mkt.xc.host !== note.host) continue\n      const xc = app().exchanges[row.mkt.xc.host]\n      const mkt = xc.markets[row.mkt.name]\n      setPriceAndChange(row.tmpl, xc, mkt)\n    }\n  }\n\n  reloadMarketsPane (): void {\n    Doc.empty(this.div)\n    this.markets = []\n\n    const addMarket = (mkt: ExchangeMarket) => {\n      const bui = app().unitInfo(mkt.baseid, mkt.xc)\n      const qui = app().unitInfo(mkt.quoteid, mkt.xc)\n      const rateConversionFactor = OrderUtil.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor\n      const row = new MarketRow(this.rowTmpl, mkt, rateConversionFactor)\n      this.div.appendChild(row.node)\n      return row\n    }\n\n    for (const mkt of sortedMarkets()) this.markets.push(addMarket(mkt))\n    app().bindTooltips(this.div)\n  }\n\n  find (host: string, baseID: number, quoteID: number): MarketRow | null {\n    for (const row of this.markets) {\n      if (row.mkt.xc.host === host && row.mkt.baseid === baseID && row.mkt.quoteid === quoteID) return row\n    }\n    return null\n  }\n\n  /* exists will be true if the specified market exists. */\n  exists (host: string, baseID: number, quoteID: number): boolean {\n    return this.find(host, baseID, quoteID) !== null\n  }\n\n  /* first gets the first market from the first exchange, alphabetically. */\n  first (): MarketRow {\n    return this.markets[0]\n  }\n\n  /* select sets the specified market as selected. */\n  select (host: string, baseID: number, quoteID: number) {\n    const row = this.find(host, baseID, quoteID)\n    if (!row) return console.error(`select: no market row for ${host}, ${baseID}-${quoteID}`)\n    for (const mkt of this.markets) mkt.node.classList.remove('selected')\n    this.selected = row\n    this.selected.node.classList.add('selected')\n  }\n\n  /* setConnectionStatus sets the visibility of the disconnected icon based\n   * on the core.ConnEventNote.\n   */\n  setConnectionStatus (note: ConnEventNote) {\n    for (const row of this.markets) {\n      if (row.mkt.xc.host !== note.host) continue\n      if (note.connectionStatus === ConnectionStatus.Connected) Doc.hide(row.tmpl.disconnectedIco)\n      else Doc.show(row.tmpl.disconnectedIco)\n    }\n  }\n\n  /*\n   * setFilter sets the visibility of market rows based on the provided filter.\n   */\n  setFilter (filter: (mkt: MarketRow) => boolean) {\n    for (const row of this.markets) {\n      if (filter(row)) Doc.show(row.node)\n      else Doc.hide(row.node)\n    }\n  }\n}\n\n/*\n * MarketRow represents one row in the MarketList. A MarketRow is a subsection\n * of the ExchangeSection.\n */\nclass MarketRow {\n  node: HTMLElement\n  mkt: ExchangeMarket\n  name: string\n  baseID: number\n  quoteID: number\n  lotSize: number\n  tmpl: Record<string, PageElement>\n  rateConversionFactor: number\n\n  constructor (template: HTMLElement, mkt: ExchangeMarket, rateConversionFactor: number) {\n    this.mkt = mkt\n    this.name = mkt.name\n    this.baseID = mkt.baseid\n    this.quoteID = mkt.quoteid\n    this.lotSize = mkt.lotsize\n    this.rateConversionFactor = rateConversionFactor\n    this.node = template.cloneNode(true) as HTMLElement\n    const tmpl = this.tmpl = Doc.parseTemplate(this.node)\n    tmpl.baseIcon.src = Doc.logoPath(mkt.basesymbol)\n    tmpl.quoteIcon.src = Doc.logoPath(mkt.quotesymbol)\n    tmpl.baseSymbol.appendChild(Doc.symbolize(mkt.xc.assets[mkt.baseid], true))\n    tmpl.quoteSymbol.appendChild(Doc.symbolize(mkt.xc.assets[mkt.quoteid], true))\n    tmpl.baseName.textContent = mkt.baseName\n    tmpl.host.textContent = mkt.xc.host\n    tmpl.host.style.color = hostColor(mkt.xc.host)\n    tmpl.host.dataset.tooltip = mkt.xc.host\n    setPriceAndChange(tmpl, mkt.xc, mkt)\n    if (this.mkt.xc.connectionStatus !== ConnectionStatus.Connected) Doc.show(tmpl.disconnectedIco)\n  }\n}\n\ninterface BalanceWidgetElement {\n  id: number\n  parentID: number\n  cfg: Asset | null\n  node: PageElement\n  tmpl: Record<string, PageElement>\n  iconBox: PageElement\n  stateIcons: WalletIcons\n  parentBal?: PageElement\n}\n\n/*\n * BalanceWidget is a display of balance information. Because the wallet can be\n * in any number of states, and because every exchange has different funding\n * coin confirmation requirements, the BalanceWidget displays a number of state\n * indicators and buttons, as well as tabulated balance data with rows for\n * locked and immature balance.\n */\nclass BalanceWidget {\n  base: BalanceWidgetElement\n  quote: BalanceWidgetElement\n  // parentRow: PageElement\n  dex: Exchange\n\n  constructor (base: HTMLElement, quote: HTMLElement) {\n    Doc.hide(base, quote)\n    const btmpl = Doc.parseTemplate(base)\n    this.base = {\n      id: 0,\n      parentID: parentIDNone,\n      cfg: null,\n      node: base,\n      tmpl: btmpl,\n      iconBox: btmpl.walletState,\n      stateIcons: new WalletIcons(btmpl.walletState)\n    }\n    btmpl.balanceRowTmpl.remove()\n\n    const qtmpl = Doc.parseTemplate(quote)\n    this.quote = {\n      id: 0,\n      parentID: parentIDNone,\n      cfg: null,\n      node: quote,\n      tmpl: qtmpl,\n      iconBox: qtmpl.walletState,\n      stateIcons: new WalletIcons(qtmpl.walletState)\n    }\n    qtmpl.balanceRowTmpl.remove()\n\n    app().registerNoteFeeder({\n      balance: (note: BalanceNote) => { this.updateAsset(note.assetID) },\n      walletstate: (note: WalletStateNote) => { this.updateAsset(note.wallet.assetID) },\n      walletsync: (note: WalletSyncNote) => { this.updateAsset(note.assetID) },\n      createwallet: (note: WalletCreationNote) => { this.updateAsset(note.assetID) }\n    })\n  }\n\n  setBalanceVisibility (connected: boolean) {\n    if (connected) Doc.show(this.base.node, this.quote.node)\n    else Doc.hide(this.base.node, this.quote.node)\n  }\n\n  /*\n   * setWallet sets the balance widget to display data for specified market and\n   * will display the widget.\n   */\n  setWallets (host: string, baseID: number, quoteID: number) {\n    const parentID = (assetID: number) => {\n      const asset = app().assets[assetID]\n      if (asset?.token) return asset.token.parentID\n      return parentIDNone\n    }\n    this.dex = app().user.exchanges[host]\n    this.base.id = baseID\n    this.base.parentID = parentID(baseID)\n    this.base.cfg = this.dex.assets[baseID]\n    this.quote.id = quoteID\n    this.quote.parentID = parentID(quoteID)\n    this.quote.cfg = this.dex.assets[quoteID]\n    this.updateWallet(this.base)\n    this.updateWallet(this.quote)\n    this.setBalanceVisibility(this.dex.connectionStatus === ConnectionStatus.Connected)\n  }\n\n  /*\n   * updateWallet updates the displayed wallet information based on the\n   * core.Wallet state.\n   */\n  updateWallet (side: BalanceWidgetElement) {\n    const { cfg, tmpl, iconBox, stateIcons, id: assetID } = side\n    if (!cfg) return // no wallet set yet\n    const asset = app().assets[assetID]\n    // Just hide everything to start.\n    Doc.hide(\n      tmpl.newWalletRow, tmpl.expired, tmpl.unsupported, tmpl.connect, tmpl.spinner,\n      tmpl.walletState, tmpl.balanceRows, tmpl.walletAddr, tmpl.wantProvidersBox\n    )\n    this.checkNeedsProvider(assetID, tmpl.wantProvidersBox)\n    tmpl.logo.src = Doc.logoPath(cfg.symbol)\n    tmpl.addWalletSymbol.textContent = cfg.symbol.toUpperCase()\n    Doc.empty(tmpl.symbol)\n\n    // Handle an unsupported asset.\n    if (!asset) {\n      Doc.show(tmpl.unsupported)\n      return\n    }\n    tmpl.symbol.appendChild(Doc.symbolize(asset, true))\n    Doc.show(iconBox)\n    const wallet = asset.wallet\n    stateIcons.readWallet(wallet)\n    // Handle no wallet configured.\n    if (!wallet) {\n      if (asset.walletCreationPending) {\n        Doc.show(tmpl.spinner)\n        return\n      }\n      Doc.show(tmpl.newWalletRow)\n      return\n    }\n    Doc.show(tmpl.walletAddr)\n    // Parent asset\n    const bal = wallet.balance\n    // Handle not connected and no balance known for the DEX.\n    if (!bal && !wallet.running && !wallet.disabled) {\n      Doc.show(tmpl.connect)\n      return\n    }\n    // If there is no balance, but the wallet is connected, show the loading\n    // icon while we fetch an update.\n    if (!bal) {\n      app().fetchBalance(assetID)\n      Doc.show(tmpl.spinner)\n      return\n    }\n\n    // We have a wallet and a DEX-specific balance. Set all of the fields.\n    Doc.show(tmpl.balanceRows)\n    Doc.empty(tmpl.balanceRows)\n    const addRow = (title: string, bal: number, ui: UnitInfo, icon?: PageElement) => {\n      const row = tmpl.balanceRowTmpl.cloneNode(true) as PageElement\n      tmpl.balanceRows.appendChild(row)\n      const balTmpl = Doc.parseTemplate(row)\n      balTmpl.title.textContent = title\n      balTmpl.bal.textContent = Doc.formatCoinValue(bal, ui)\n      if (icon) {\n        balTmpl.bal.append(icon)\n        side.parentBal = balTmpl.bal\n      }\n    }\n    addRow(intl.prep(intl.ID_AVAILABLE), bal.available, asset.unitInfo)\n    addRow(intl.prep(intl.ID_LOCKED), bal.locked + bal.contractlocked + bal.bondlocked, asset.unitInfo)\n    addRow(intl.prep(intl.ID_IMMATURE), bal.immature, asset.unitInfo)\n    if (asset.token) {\n      const { wallet: { balance }, unitInfo, symbol } = app().assets[asset.token.parentID]\n      const icon = document.createElement('img')\n      icon.src = Doc.logoPath(symbol)\n      icon.classList.add('micro-icon', 'ms-1')\n      addRow(intl.prep(intl.ID_FEE_BALANCE), balance.available, unitInfo, icon)\n    }\n\n    // If the current balance update time is older than an hour, show the\n    // expiration icon. Request a balance update, if possible.\n    const expired = new Date().getTime() - new Date(bal.stamp).getTime() > anHour\n    if (expired && !wallet.disabled) {\n      Doc.show(tmpl.expired)\n      if (wallet.running) app().fetchBalance(assetID)\n    } else Doc.hide(tmpl.expired)\n  }\n\n  async checkNeedsProvider (assetID: number, el: PageElement) {\n    Doc.setVis(await app().needsCustomProvider(assetID), el)\n  }\n\n  /* updateParent updates the side's parent asset balance. */\n  updateParent (side: BalanceWidgetElement) {\n    const { wallet: { balance }, unitInfo } = app().assets[side.parentID]\n    // firstChild is the text node set before the img child node in addRow.\n    if (side.parentBal?.firstChild) side.parentBal.firstChild.textContent = Doc.formatCoinValue(balance.available, unitInfo)\n  }\n\n  /*\n   * updateAsset updates the info for one side of the existing market. If the\n   * specified asset ID is not one of the current market's base or quote assets,\n   * it is silently ignored.\n   */\n  updateAsset (assetID: number) {\n    if (assetID === this.base.id) this.updateWallet(this.base)\n    else if (assetID === this.quote.id) this.updateWallet(this.quote)\n    if (assetID === this.base.parentID) this.updateParent(this.base)\n    if (assetID === this.quote.parentID) this.updateParent(this.quote)\n  }\n}\n\n/* makeMarket creates a market object that specifies basic market details. */\nfunction makeMarket (host: string, base?: number, quote?: number) {\n  return {\n    host: host,\n    base: base,\n    quote: quote\n  }\n}\n\n/* marketID creates a DEX-compatible market name from the ticker symbols. */\nexport function marketID (b: string, q: string) { return `${b}_${q}` }\n\n/* convertToAtoms converts the float string to the basic unit of a coin. */\nfunction convertToAtoms (s: string, conversionFactor: number) {\n  if (!s) return 0\n  return Math.round(parseFloat(s) * conversionFactor)\n}\n\n/* swapBttns changes the 'selected' class of the buttons. */\nfunction swapBttns (before: HTMLElement, now: HTMLElement) {\n  before.classList.remove('selected')\n  now.classList.add('selected')\n}\n\n/*\n * wireOrder prepares a copy of the order with the options field converted to a\n * string -> string map.\n */\nfunction wireOrder (order: TradeForm) {\n  const stringyOptions: Record<string, string> = {}\n  for (const [k, v] of Object.entries(order.options)) stringyOptions[k] = JSON.stringify(v)\n  return Object.assign({}, order, { options: stringyOptions })\n}\n\n// OrderTableRowManager manages the data within a row in an order table. Each row\n// represents all the orders in the order book with the same rate, but orders that\n// are booked or still in the epoch queue are displayed in separate rows.\nclass OrderTableRowManager {\n  tableRow: HTMLElement\n  page: Record<string, PageElement>\n  orderBin: MiniOrder[]\n  sell: boolean\n  msgRate: number\n  epoch: boolean\n  baseUnitInfo: UnitInfo\n\n  constructor (tableRow: HTMLElement, orderBin: MiniOrder[], baseUnitInfo: UnitInfo, quoteUnitInfo: UnitInfo, rateStep: number) {\n    this.tableRow = tableRow\n    const page = this.page = Doc.parseTemplate(tableRow)\n    this.orderBin = orderBin\n    this.sell = orderBin[0].sell\n    this.msgRate = orderBin[0].msgRate\n    this.epoch = !!orderBin[0].epoch\n    this.baseUnitInfo = baseUnitInfo\n    const rateText = Doc.formatRateFullPrecision(this.msgRate, baseUnitInfo, quoteUnitInfo, rateStep)\n    Doc.setVis(this.isEpoch(), this.page.epoch)\n    if (this.msgRate === 0) {\n      page.rate.innerText = 'market'\n    } else {\n      const cssClass = this.isSell() ? 'sellcolor' : 'buycolor'\n      page.rate.innerText = rateText\n      page.rate.classList.add(cssClass)\n    }\n    this.updateQtyNumOrdersEl()\n  }\n\n  // updateQtyNumOrdersEl populates the quantity element in the row, and also\n  // displays the number of orders if there is more than one order in the order\n  // bin.\n  updateQtyNumOrdersEl () {\n    const { page, orderBin } = this\n    const qty = orderBin.reduce((total, curr) => total + curr.qtyAtomic, 0)\n    const numOrders = orderBin.length\n    page.qty.innerText = Doc.formatFullPrecision(qty, this.baseUnitInfo)\n    if (numOrders > 1) {\n      page.numOrders.removeAttribute('hidden')\n      page.numOrders.innerText = String(numOrders)\n      page.numOrders.title = `quantity is comprised of ${numOrders} orders`\n    } else {\n      page.numOrders.setAttribute('hidden', 'true')\n    }\n  }\n\n  // insertOrder adds an order to the order bin and updates the row elements\n  // accordingly.\n  insertOrder (order: MiniOrder) {\n    this.orderBin.push(order)\n    this.updateQtyNumOrdersEl()\n  }\n\n  // updateOrderQuantity updates the quantity of the order identified by a token,\n  // if it exists in the row, and updates the row elements accordingly. The function\n  // returns true if the order is in the bin, and false otherwise.\n  updateOrderQty (update: RemainderUpdate) {\n    const { token, qty, qtyAtomic } = update\n    for (let i = 0; i < this.orderBin.length; i++) {\n      if (this.orderBin[i].token === token) {\n        this.orderBin[i].qty = qty\n        this.orderBin[i].qtyAtomic = qtyAtomic\n        this.updateQtyNumOrdersEl()\n        return true\n      }\n    }\n    return false\n  }\n\n  // removeOrder removes the order identified by the token, if it exists in the row,\n  // and updates the row elements accordingly. If the order bin is empty, the row is\n  // removed from the screen. The function returns true if an order was removed, and\n  // false otherwise.\n  removeOrder (token: string) {\n    const index = this.orderBin.findIndex(order => order.token === token)\n    if (index < 0) return false\n    this.orderBin.splice(index, 1)\n    if (!this.orderBin.length) this.tableRow.remove()\n    else this.updateQtyNumOrdersEl()\n    return true\n  }\n\n  // removeEpochOrders removes all the orders from the row that are not in the\n  // new epoch's epoch queue and updates the elements accordingly.\n  removeEpochOrders (newEpoch?: number) {\n    this.orderBin = this.orderBin.filter((order) => {\n      return !(order.epoch && order.epoch !== newEpoch)\n    })\n    if (!this.orderBin.length) this.tableRow.remove()\n    else this.updateQtyNumOrdersEl()\n  }\n\n  // getRate returns the rate of the orders in the row.\n  getRate () {\n    return this.msgRate\n  }\n\n  // isEpoch returns whether the orders in this row are in the epoch queue.\n  isEpoch () {\n    return this.epoch\n  }\n\n  // isSell returns whether the orders in this row are sell orders.\n  isSell () {\n    return this.sell\n  }\n\n  // compare takes an order and returns 0 if the order belongs in this row,\n  // 1 if the order should go after this row in the table, and -1 if it should\n  // be before this row in the table. Sell orders are displayed in ascending order,\n  // buy orders are displayed in descending order, and epoch orders always come\n  // after booked orders.\n  compare (order: MiniOrder) {\n    if (this.getRate() === order.msgRate && this.isEpoch() === !!order.epoch) {\n      return 0\n    } else if (this.getRate() !== order.msgRate) {\n      return (this.getRate() > order.msgRate) === order.sell ? 1 : -1\n    } else {\n      return this.isEpoch() ? 1 : -1\n    }\n  }\n}\n\ninterface ExchangeMarket extends Market {\n  xc: Exchange\n  baseName: string\n  bui: UnitInfo\n}\n\nfunction sortedMarkets (): ExchangeMarket[] {\n  const mkts: ExchangeMarket[] = []\n  const assets = app().assets\n  const convertMarkets = (xc: Exchange, mkts: Market[]) => {\n    return mkts.map((mkt: Market) => {\n      const a = assets[mkt.baseid]\n      const baseName = a ? a.name : mkt.basesymbol\n      const bui = app().unitInfo(mkt.baseid, xc)\n      return Object.assign({ xc, baseName, bui }, mkt)\n    })\n  }\n  for (const xc of Object.values(app().exchanges)) mkts.push(...convertMarkets(xc, Object.values(xc.markets || {})))\n  mkts.sort((a: ExchangeMarket, b: ExchangeMarket): number => {\n    if (!a.spot) {\n      if (b.spot) return 1 // put b first, since we have the spot\n      // no spots. compare market name then host name\n      if (a.name === b.name) return a.xc.host.localeCompare(b.xc.host)\n      return a.name.localeCompare(b.name)\n    } else if (!b.spot) return -1 // put a first, since we have the spot\n    const [aLots, bLots] = [a.spot.vol24 / a.lotsize, b.spot.vol24 / b.lotsize]\n    return bLots - aLots // whoever has more volume by lot count\n  })\n  return mkts\n}\n\nfunction setPriceAndChange (tmpl: Record<string, PageElement>, xc: Exchange, mkt: Market) {\n  if (!mkt.spot) return\n  tmpl.price.textContent = Doc.formatFourSigFigs(app().conventionalRate(mkt.baseid, mkt.quoteid, mkt.spot.rate, xc))\n  const sign = mkt.spot.change24 > 0 ? '+' : ''\n  tmpl.change.classList.remove('buycolor', 'sellcolor')\n  tmpl.change.classList.add(mkt.spot.change24 >= 0 ? 'buycolor' : 'sellcolor')\n  tmpl.change.textContent = `${sign}${(mkt.spot.change24 * 100).toFixed(1)}%`\n}\n\nconst hues = [1 / 2, 1 / 4, 3 / 4, 1 / 8, 5 / 8, 3 / 8, 7 / 8]\n\nfunction generateHue (idx: number): string {\n  const h = hues[idx % hues.length]\n  return `hsl(${h * 360}, 35%, 50%)`\n}\n\nfunction hostColor (host: string): string {\n  const hosts = Object.keys(app().exchanges)\n  hosts.sort()\n  return generateHue(hosts.indexOf(host))\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport * as OrderUtil from './orderutil'\nimport * as intl from './locales'\nimport { postJSON } from './http'\nimport {\n  app,\n  PageElement,\n  OrderFilter,\n  Order\n} from './registry'\n\nconst orderBatchSize = 50\nconst animationLength = 500\n\nexport default class OrdersPage extends BasePage {\n  main: HTMLElement\n  offset: string\n  loading: boolean\n  currentForm: PageElement\n  orderTmpl: PageElement\n  filterState: OrderFilter\n  page: Record<string, PageElement>\n\n  constructor (main: HTMLElement) {\n    super()\n    this.main = main\n    // if offset is '', there are no more orders available to auto-load for\n    // never-ending scrolling.\n    this.offset = ''\n    this.loading = false\n    const page = this.page = Doc.idDescendants(main)\n    this.orderTmpl = page.rowTmpl\n    this.orderTmpl.remove()\n\n    // filterState will store arrays of strings. The assets and statuses\n    // sub-filters will need to be converted to ints for JSON encoding.\n    const filterState: OrderFilter = this.filterState = {\n      hosts: [],\n      assets: [],\n      statuses: []\n    }\n\n    const search = new URLSearchParams(window.location.search)\n    const readFilter = (form: HTMLElement, filterKey: string) => {\n      const v = search.get(filterKey)\n      if (!v || v.length === 0) return\n      const subFilter = v.split(',')\n      if (v) {\n        (filterState as any)[filterKey] = subFilter // Kinda janky\n      }\n      form.querySelectorAll('input').forEach(bttn => {\n        if (subFilter.indexOf(bttn.value) >= 0) bttn.checked = true\n      })\n    }\n    readFilter(page.hostFilter, 'hosts')\n    readFilter(page.assetFilter, 'assets')\n    readFilter(page.statusFilter, 'statuses')\n\n    const applyButtons: HTMLElement[] = []\n    const monitorFilter = (form: HTMLElement, filterKey: string) => {\n      const applyBttn = form.querySelector('.apply-bttn') as HTMLElement\n      applyButtons.push(applyBttn)\n      Doc.bind(applyBttn, 'click', () => {\n        this.submitFilter()\n        applyButtons.forEach(bttn => Doc.hide(bttn))\n      })\n      form.querySelectorAll('input').forEach(bttn => {\n        Doc.bind(bttn, 'change', () => {\n          const subFilter = parseSubFilter(form)\n          if (compareSubFilter(subFilter, (filterState as any)[filterKey])) {\n            // Same as currently loaded. Hide the apply button.\n            Doc.hide(applyBttn)\n          } else {\n            Doc.show(applyBttn)\n          }\n        })\n      })\n    }\n\n    monitorFilter(page.hostFilter, 'hosts')\n    monitorFilter(page.assetFilter, 'assets')\n    monitorFilter(page.statusFilter, 'statuses')\n\n    Doc.bind(this.main, 'scroll', () => {\n      if (this.loading) return\n      const belowBottom = page.ordersTable.offsetHeight - this.main.offsetHeight - this.main.scrollTop\n      if (belowBottom < 0) {\n        this.nextPage()\n      }\n    })\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => {\n        Doc.hide(page.forms)\n      })\n    })\n\n    // If the user clicks outside of a form, it should close the page overlay.\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) {\n        Doc.hide(page.forms)\n      }\n    })\n\n    Doc.bind(page.exportOrders, 'click', () => {\n      this.exportOrders()\n    })\n\n    page.showArchivedDateField.addEventListener('change', () => {\n      if (page.showArchivedDateField.checked) Doc.show(page.archivedDateField)\n      else Doc.hide(page.archivedDateField, page.deleteArchivedRecordsErr)\n    })\n\n    Doc.bind(page.deleteArchivedRecords, 'click', () => {\n      const page = this.page\n      page.showArchivedDateField.checked = false\n      page.saveMatchesToFile.checked = false\n      page.saveOrdersToFile.checked = false\n      page.deleteArchivedRecordsErr.textContent = ''\n      page.archivedRecordsLocation.textContent = ''\n      page.deleteArchivedRecordsMsg.textContent = ''\n      Doc.hide(page.deleteArchivedResult, page.deleteArchivedRecordsErr,\n        page.deleteArchivedRecordsMsg, page.archivedRecordsLocation, page.archivedDateField)\n      this.showForm(page.deleteArchivedRecordsForm)\n    })\n\n    Doc.bind(page.deleteArchivedRecordsSubmit, 'click', () => {\n      let date = 0\n      if (page.showArchivedDateField.checked) {\n        date = Date.parse(page.olderThan.value || '')\n        if (isNaN(date) || date <= 0) {\n          Doc.showFormError(page.deleteArchivedRecordsErr, intl.prep(intl.ID_INVALID_DATE_ERR_MSG))\n          return\n        }\n      }\n      this.deleteArchivedRecords(date)\n    })\n\n    this.submitFilter()\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    this.currentForm = form\n    const page = this.page\n    Doc.hide(page.deleteArchivedRecordsForm)\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0px'\n  }\n\n  /* setOrders empties the order table and appends the specified orders. */\n  setOrders (orders: Order[]) {\n    Doc.empty(this.page.tableBody)\n    this.appendOrders(orders)\n  }\n\n  /* appendOrders appends orders to the orders table. */\n  appendOrders (orders: Order[]) {\n    const tbody = this.page.tableBody\n    for (const ord of orders) {\n      const tr = this.orderTmpl.cloneNode(true) as HTMLElement\n      const tmpl = Doc.parseTemplate(tr)\n      let fromSymbol, toSymbol, fromUnit, toUnit, fromQty\n      let toQty = ''\n      const xc = app().exchanges[ord.host] || undefined\n      if ((!app().assets[ord.baseID] && !xc.assets[ord.baseID]) || (!app().assets[ord.quoteID] && !xc.assets[ord.quoteID])) continue\n      const [baseUnitInfo, quoteUnitInfo] = [app().unitInfo(ord.baseID, xc), app().unitInfo(ord.quoteID, xc)]\n      if (ord.sell) {\n        [fromSymbol, toSymbol] = [ord.baseSymbol, ord.quoteSymbol];\n        [fromUnit, toUnit] = [baseUnitInfo.conventional.unit, quoteUnitInfo.conventional.unit]\n        fromQty = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        if (ord.type === OrderUtil.Limit) {\n          toQty = Doc.formatCoinValue(ord.qty / OrderUtil.RateEncodingFactor * ord.rate, quoteUnitInfo)\n        }\n      } else {\n        [fromSymbol, toSymbol] = [ord.quoteSymbol, ord.baseSymbol];\n        [fromUnit, toUnit] = [quoteUnitInfo.conventional.unit, baseUnitInfo.conventional.unit]\n        if (ord.type === OrderUtil.Market) {\n          fromQty = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        } else {\n          fromQty = Doc.formatCoinValue(ord.qty / OrderUtil.RateEncodingFactor * ord.rate, quoteUnitInfo)\n          toQty = Doc.formatCoinValue(ord.qty, baseUnitInfo)\n        }\n      }\n\n      const mktID = `${baseUnitInfo.conventional.unit}-${quoteUnitInfo.conventional.unit}`\n      tmpl.host.textContent = `${mktID} @ ${ord.host}`\n\n      tmpl.fromQty.textContent = fromQty\n      tmpl.fromLogo.src = Doc.logoPath(fromSymbol)\n      tmpl.fromSymbol.textContent = fromUnit\n      tmpl.toQty.textContent = toQty\n      tmpl.toLogo.src = Doc.logoPath(toSymbol)\n      tmpl.toSymbol.textContent = toUnit\n      tmpl.type.textContent = `${OrderUtil.typeString(ord)} ${OrderUtil.sellString(ord)}`\n      let rate = Doc.formatCoinValue(app().conventionalRate(ord.baseID, ord.quoteID, ord.rate, xc))\n      if (ord.type === OrderUtil.Market) rate = OrderUtil.averageMarketOrderRateString(ord)\n      tmpl.rate.textContent = rate\n      tmpl.status.textContent = OrderUtil.statusString(ord)\n      tmpl.filled.textContent = `${(OrderUtil.filled(ord) / ord.qty * 100).toFixed(1)}%`\n      tmpl.settled.textContent = `${(OrderUtil.settled(ord) / ord.qty * 100).toFixed(1)}%`\n      const dateTime = new Date(ord.submitTime).toLocaleString()\n      tmpl.timeAgo.textContent = `${Doc.timeSince(ord.submitTime)} ago`\n      tmpl.time.textContent = dateTime\n      const link = Doc.tmplElement(tr, 'link')\n      link.href = `order/${ord.id}`\n      app().bindInternalNavigation(tr)\n      tbody.appendChild(tr)\n    }\n    if (orders.length === orderBatchSize) {\n      this.offset = orders[orders.length - 1].id\n    } else {\n      this.offset = ''\n    }\n  }\n\n  /* submitFilter submits the current filter and reloads the order table. */\n  async submitFilter () {\n    const page = this.page\n    this.offset = ''\n    const filterState = this.filterState\n    filterState.hosts = parseSubFilter(page.hostFilter)\n    filterState.assets = parseSubFilter(page.assetFilter).map((s: string) => parseInt(s))\n    filterState.statuses = parseSubFilter(page.statusFilter).map((s: string) => parseInt(s))\n    this.setOrders(await this.fetchOrders())\n  }\n\n  /* fetchOrders fetches orders using the current filter. */\n  async fetchOrders () {\n    const loaded = app().loading(this.main)\n    const res = await postJSON('/api/orders', this.currentFilter())\n    loaded()\n    return res.orders\n  }\n\n  /* exportOrders downloads a csv of the user's orders based on the current filter. */\n  exportOrders () {\n    this.offset = ''\n    const filterState = this.currentFilter()\n    const url = new URL(window.location.href)\n    const search = new URLSearchParams('')\n    const setQuery = (k: string) => {\n      const subFilter = (filterState as any)[k]\n      subFilter.forEach((v: any) => {\n        search.append(k, v)\n      })\n    }\n    setQuery('hosts')\n    setQuery('assets')\n    setQuery('statuses')\n    url.search = search.toString()\n    url.pathname = '/orders/export'\n    window.open(url.toString())\n  }\n\n  /* deleteArchivedRecords removes the user's archived orders and matches\n   * created before user specified date time in millisecond. Deleted archived\n   * records are saved to a CSV file if the user specify so.\n   */\n  async deleteArchivedRecords (olderThanMs?: number) {\n    const page = this.page\n    const saveMatchesToFIle = page.saveMatchesToFile.checked || false\n    const saveOrdersToFile = page.saveOrdersToFile.checked || false\n    const reqBody = {\n      olderThanMs: olderThanMs,\n      saveMatchesToFile: saveMatchesToFIle,\n      saveOrdersToFile: saveOrdersToFile\n    }\n    const loaded = app().loading(this.main)\n    const res = await postJSON('/api/deletearchivedrecords', reqBody)\n    loaded()\n    if (!app().checkResponse(res)) {\n      return Doc.showFormError(page.deleteArchivedRecordsErr, res.msg)\n    }\n\n    if (res.archivedRecordsDeleted > 0) {\n      page.deleteArchivedRecordsMsg.textContent = intl.prep(intl.ID_DELETE_ARCHIVED_RECORDS_RESULT, { nRecords: res.archivedRecordsDeleted })\n      if (saveMatchesToFIle || saveOrdersToFile) {\n        page.archivedRecordsLocation.textContent = intl.prep(intl.ID_ARCHIVED_RECORDS_PATH, { path: res.archivedRecordsPath })\n        Doc.show(page.archivedRecordsLocation)\n      }\n      // Update the order page.\n      this.submitFilter()\n    } else {\n      page.deleteArchivedRecordsMsg.textContent = intl.prep(intl.ID_NO_ARCHIVED_RECORDS)\n    }\n    Doc.show(page.deleteArchivedResult, page.deleteArchivedRecordsMsg)\n  }\n\n  /*\n   * currentFilter converts the local filter type (which is all strings) to the\n   * server's filter type.\n   */\n  currentFilter (): OrderFilter {\n    const filterState = this.filterState as OrderFilter\n    return {\n      hosts: filterState.hosts,\n      assets: filterState.assets?.map((s: any) => parseInt(s)),\n      statuses: filterState.statuses?.map((s: any) => parseInt(s)),\n      n: orderBatchSize,\n      offset: this.offset\n    }\n  }\n\n  /*\n   * nextPage resubmits the filter with the offset set to the last loaded order.\n   */\n  async nextPage () {\n    if (this.offset === '' || this.loading) return\n    this.loading = true\n    Doc.show(this.page.orderLoader)\n    const orders = await this.fetchOrders()\n    this.loading = false\n    Doc.hide(this.page.orderLoader)\n    this.appendOrders(orders)\n  }\n}\n\n/*\n * parseSubFilter parses a bool-map from the checkbox inputs in the specified\n * ancestor element.\n */\nfunction parseSubFilter (form: HTMLElement): string[] {\n  const entries: string[] = []\n  form.querySelectorAll('input').forEach(box => {\n    if (box.checked) entries.push(box.value)\n  })\n  return entries\n}\n\n/* compareSubFilter compares the two filter arrays for unordered equivalence. */\nfunction compareSubFilter (filter1: any[], filter2: any[]): boolean {\n  if (filter1.length !== filter2.length) return false\n  for (const entry of filter1) {\n    if (filter2.indexOf(entry) === -1) return false\n  }\n  return true\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport * as OrderUtil from './orderutil'\nimport { bind as bindForm, AccelerateOrderForm } from './forms'\nimport { postJSON } from './http'\nimport * as intl from './locales'\nimport {\n  app,\n  Order,\n  PageElement,\n  OrderNote,\n  MatchNote,\n  Match,\n  Coin\n} from './registry'\nimport { setOptionTemplates } from './opts'\nimport { formatCoinID, setCoinHref } from './coinexplorers'\n\n// lockTimeMakerMs must match the value returned from LockTimeMaker func in\n// bisonw.\nconst lockTimeMakerMs = 20 * 60 * 60 * 1000\n// lockTimeTakerMs must match the value returned from LockTimeTaker func in\n// bisonw.\nconst lockTimeTakerMs = 8 * 60 * 60 * 1000\n\nconst animationLength = 500\n\nexport default class OrderPage extends BasePage {\n  orderID: string\n  order: Order\n  page: Record<string, PageElement>\n  currentForm: HTMLElement\n  secondTicker: number\n  refreshOnPopupClose: boolean\n  accelerateOrderForm: AccelerateOrderForm\n  stampers: PageElement[]\n\n  constructor (main: HTMLElement) {\n    super()\n    const page = this.page = Doc.idDescendants(main)\n    this.stampers = Doc.applySelector(main, '[data-stamp]')\n    // Find the order\n    this.orderID = main.dataset.oid || ''\n\n    Doc.cleanTemplates(page.matchCardTmpl)\n\n    const setStamp = () => {\n      for (const span of this.stampers) {\n        span.textContent = Doc.timeSince(parseInt(span.dataset.stamp || ''))\n      }\n    }\n    setStamp()\n\n    page.forms.querySelectorAll('.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => {\n        if (this.refreshOnPopupClose) {\n          window.location.replace(window.location.href)\n          return\n        }\n        Doc.hide(page.forms)\n      })\n    })\n\n    // Some static elements on this page contain assets that can be linked\n    // to blockchain explorers (such as Etherscan) so users can easily\n    // examine funding/acceleration coins data there. We'd need to set up\n    // such hyperlinks here.\n    main.querySelectorAll('[data-explorer-id]').forEach((link: PageElement) => {\n      const assetID = parseInt(link.dataset.explorerId || '')\n      setCoinHref(assetID, link)\n    })\n\n    if (page.cancelBttn) {\n      Doc.bind(page.cancelBttn, 'click', () => {\n        this.showForm(page.cancelForm)\n      })\n    }\n\n    Doc.bind(page.accelerateBttn, 'click', () => {\n      this.showAccelerateForm()\n    })\n\n    const success = () => {\n      this.refreshOnPopupClose = true\n    }\n    // Do not call cleanTemplates before creating the AccelerateOrderForm\n    setOptionTemplates(page)\n    this.accelerateOrderForm = new AccelerateOrderForm(page.accelerateForm, success)\n    Doc.cleanTemplates(page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl)\n\n    // If the user clicks outside of a form, it should close the page overlay.\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) {\n        if (this.refreshOnPopupClose) {\n          window.location.reload()\n          return\n        }\n        Doc.hide(page.forms)\n      }\n    })\n\n    // Cancel order form\n    bindForm(page.cancelForm, page.cancelSubmit, async () => { this.submitCancel() })\n\n    this.secondTicker = window.setInterval(() => {\n      setStamp()\n    }, 10000) // update every 10 seconds\n\n    app().registerNoteFeeder({\n      order: (note: OrderNote) => { this.handleOrderNote(note) },\n      match: (note: MatchNote) => { this.handleMatchNote(note) }\n    })\n\n    this.start()\n  }\n\n  async start () {\n    let ord = app().order(this.orderID)\n    // app().order can only access active orders. If the order is not active,\n    // we'll need to get the data from the database.\n    if (ord) this.order = ord\n    else {\n      ord = await this.fetchOrder()\n    }\n    // Swap out the dot-notation symbols with token-aware symbols.\n    this.page.mktBaseSymbol.replaceWith(Doc.symbolize(app().assets[ord.baseID]))\n    this.page.mktQuoteSymbol.replaceWith(Doc.symbolize(app().assets[ord.quoteID]))\n\n    this.setAccelerationButtonVis()\n    this.showMatchCards()\n  }\n\n  unload () {\n    clearInterval(this.secondTicker)\n  }\n\n  /* fetchOrder fetches the order from the client. */\n  async fetchOrder (): Promise<Order> {\n    const res = await postJSON('/api/order', this.orderID)\n    if (!app().checkResponse(res)) throw res.msg\n    this.order = res.order\n    return this.order\n  }\n\n  /*\n   * setImmutableMatchCardElements sets the match card elements that are never\n   * changed.\n   */\n  setImmutableMatchCardElements (matchCard: HTMLElement, match: Match) {\n    const tmpl = Doc.parseTemplate(matchCard)\n\n    tmpl.matchID.textContent = match.matchID\n\n    const time = new Date(match.stamp)\n    tmpl.matchTime.textContent = time.toLocaleTimeString(Doc.languages(), {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric'\n    })\n\n    tmpl.matchTimeAgo.dataset.stamp = match.stamp.toString()\n    tmpl.matchTimeAgo.textContent = Doc.timeSince(match.stamp)\n    this.stampers.push(tmpl.matchTimeAgo)\n\n    const orderPortion = OrderUtil.orderPortion(this.order, match)\n    const baseSymbol = Doc.bipSymbol(this.order.baseID)\n    const quoteSymbol = Doc.bipSymbol(this.order.quoteID)\n    const baseUnitInfo = app().unitInfo(this.order.baseID)\n    const quoteUnitInfo = app().unitInfo(this.order.quoteID)\n    const [bUnit, qUnit] = [baseUnitInfo.conventional.unit.toLowerCase(), quoteUnitInfo.conventional.unit.toLowerCase()]\n    const quoteAmount = OrderUtil.baseToQuote(match.rate, match.qty)\n\n    if (match.isCancel) {\n      Doc.show(tmpl.cancelInfoDiv)\n      Doc.hide(tmpl.infoDiv, tmpl.status, tmpl.statusHdr)\n\n      if (this.order.sell) {\n        tmpl.cancelAmount.textContent = Doc.formatCoinValue(match.qty, baseUnitInfo)\n        tmpl.cancelIcon.src = Doc.logoPathFromID(this.order.baseID)\n      } else {\n        tmpl.cancelAmount.textContent = Doc.formatCoinValue(quoteAmount, quoteUnitInfo)\n        tmpl.cancelIcon.src = Doc.logoPathFromID(this.order.quoteID)\n      }\n\n      tmpl.cancelOrderPortion.textContent = orderPortion\n\n      return\n    }\n\n    Doc.show(tmpl.infoDiv)\n    Doc.hide(tmpl.cancelInfoDiv)\n\n    tmpl.orderPortion.textContent = orderPortion\n\n    if (match.side === OrderUtil.Maker) {\n      tmpl.side.textContent = intl.prep(intl.ID_MAKER)\n      Doc.show(\n        tmpl.makerSwapYou,\n        tmpl.makerRedeemYou,\n        tmpl.takerSwapThem,\n        tmpl.takerRedeemThem\n      )\n      Doc.hide(\n        tmpl.takerSwapYou,\n        tmpl.takerRedeemYou,\n        tmpl.makerSwapThem,\n        tmpl.makerRedeemThem\n      )\n    } else {\n      tmpl.side.textContent = intl.prep(intl.ID_TAKER)\n      Doc.hide(\n        tmpl.makerSwapYou,\n        tmpl.makerRedeemYou,\n        tmpl.takerSwapThem,\n        tmpl.takerRedeemThem\n      )\n      Doc.show(\n        tmpl.takerSwapYou,\n        tmpl.takerRedeemYou,\n        tmpl.makerSwapThem,\n        tmpl.makerRedeemThem\n      )\n    }\n\n    if ((match.side === OrderUtil.Maker && this.order.sell) ||\n          (match.side === OrderUtil.Taker && !this.order.sell)) {\n      tmpl.makerSwapAsset.textContent = bUnit\n      tmpl.takerSwapAsset.textContent = qUnit\n      tmpl.makerRedeemAsset.textContent = qUnit\n      tmpl.takerRedeemAsset.textContent = bUnit\n    } else {\n      tmpl.makerSwapAsset.textContent = qUnit\n      tmpl.takerSwapAsset.textContent = bUnit\n      tmpl.makerRedeemAsset.textContent = bUnit\n      tmpl.takerRedeemAsset.textContent = qUnit\n    }\n\n    const rate = app().conventionalRate(this.order.baseID, this.order.quoteID, match.rate)\n    tmpl.rate.textContent = `${rate} ${bUnit}/${qUnit}`\n\n    if (this.order.sell) {\n      tmpl.refundAsset.textContent = baseSymbol\n      tmpl.fromAmount.textContent = Doc.formatCoinValue(match.qty, baseUnitInfo)\n      tmpl.toAmount.textContent = Doc.formatCoinValue(quoteAmount, quoteUnitInfo)\n      tmpl.fromIcon.src = Doc.logoPathFromID(this.order.baseID)\n      tmpl.toIcon.src = Doc.logoPathFromID(this.order.quoteID)\n    } else {\n      tmpl.refundAsset.textContent = quoteSymbol\n      tmpl.fromAmount.textContent = Doc.formatCoinValue(quoteAmount, quoteUnitInfo)\n      tmpl.toAmount.textContent = Doc.formatCoinValue(match.qty, baseUnitInfo)\n      tmpl.fromIcon.src = Doc.logoPathFromID(this.order.quoteID)\n      tmpl.toIcon.src = Doc.logoPathFromID(this.order.baseID)\n    }\n  }\n\n  /*\n   * setMutableMatchCardElements sets the match card elements which may get\n   * updated on each update to the match.\n   */\n  setMutableMatchCardElements (matchCard: HTMLElement, m: Match) {\n    if (m.isCancel) return\n\n    const tmpl = Doc.parseTemplate(matchCard)\n    tmpl.status.textContent = OrderUtil.matchStatusString(m)\n\n    const tryShowCoin = (pendingEl: PageElement, coinLink: PageElement, coin: Coin) => {\n      if (!coin) {\n        Doc.hide(coinLink)\n        Doc.show(pendingEl)\n        return\n      }\n      coinLink.textContent = formatCoinID(coin.stringID)\n      coinLink.dataset.explorerCoin = coin.stringID\n      setCoinHref(coin.assetID, coinLink)\n      Doc.show(coinLink)\n      Doc.hide(pendingEl)\n    }\n\n    tryShowCoin(tmpl.makerSwapPending, tmpl.makerSwapCoin, makerSwapCoin(m))\n    tryShowCoin(tmpl.takerSwapPending, tmpl.takerSwapCoin, takerSwapCoin(m))\n    tryShowCoin(tmpl.makerRedeemPending, tmpl.makerRedeemCoin, makerRedeemCoin(m))\n    tryShowCoin(tmpl.takerRedeemPending, tmpl.takerRedeemCoin, takerRedeemCoin(m))\n    if (!m.refund) {\n      // Special messaging for pending refunds.\n      let lockTime = lockTimeMakerMs\n      if (m.side === OrderUtil.Taker) lockTime = lockTimeTakerMs\n      const refundAfter = new Date(m.stamp + lockTime)\n      if (Date.now() > refundAfter.getTime()) tmpl.refundPending.textContent = intl.prep(intl.ID_REFUND_IMMINENT)\n      else {\n        const refundAfterStr = refundAfter.toLocaleTimeString(Doc.languages(), {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric'\n        })\n        tmpl.refundPending.textContent = intl.prep(intl.ID_REFUND_WILL_HAPPEN_AFTER, { refundAfterTime: refundAfterStr })\n      }\n      Doc.hide(tmpl.refundCoin)\n      Doc.show(tmpl.refundPending)\n    } else {\n      tmpl.refundCoin.textContent = formatCoinID(m.refund.stringID)\n      tmpl.refundCoin.dataset.explorerCoin = m.refund.stringID\n      setCoinHref(m.refund.assetID, tmpl.refundCoin)\n      Doc.show(tmpl.refundCoin)\n      Doc.hide(tmpl.refundPending)\n    }\n\n    if (m.status === OrderUtil.MakerSwapCast && !m.revoked && !m.refund) {\n      const c = makerSwapCoin(m)\n      tmpl.makerSwapMsg.textContent = confirmationString(c)\n      Doc.hide(tmpl.takerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg)\n      Doc.show(tmpl.makerSwapMsg)\n    } else if (m.status === OrderUtil.TakerSwapCast && !m.revoked && !m.refund) {\n      const c = takerSwapCoin(m)\n      tmpl.takerSwapMsg.textContent = confirmationString(c)\n      Doc.hide(tmpl.makerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg)\n      Doc.show(tmpl.takerSwapMsg)\n    } else if (inConfirmingMakerRedeem(m) && !m.revoked && !m.refund) {\n      tmpl.makerRedeemMsg.textContent = confirmationString(m.redeem)\n      Doc.hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.takerRedeemMsg)\n      Doc.show(tmpl.makerRedeemMsg)\n    } else if (inConfirmingTakerRedeem(m) && !m.revoked && !m.refund) {\n      tmpl.takerRedeemMsg.textContent = confirmationString(m.redeem)\n      Doc.hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.makerRedeemMsg)\n      Doc.show(tmpl.takerRedeemMsg)\n    } else {\n      Doc.hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg)\n    }\n\n    if (!m.revoked) {\n      // Match is still following the usual success-path, it is desirable for the\n      // user to see it in full (even if to learn how atomic swap is supposed to\n      // work).\n\n      Doc.setVis(makerSwapCoin(m) || m.active, tmpl.makerSwap)\n      Doc.setVis(takerSwapCoin(m) || m.active, tmpl.takerSwap)\n      Doc.setVis(makerRedeemCoin(m) || m.active, tmpl.makerRedeem)\n      // When maker isn't aware of taker redeem coin, once the match becomes inactive\n      // (nothing else maker is expected to do in this match) just hide taker redeem.\n      Doc.setVis(takerRedeemCoin(m) || m.active, tmpl.takerRedeem)\n      // Refunding isn't a usual part of success-path, but don't rule it out.\n      Doc.setVis(m.refund, tmpl.refund)\n    } else {\n      // Match diverged from the usual success-path, since this could have happened\n      // at any step it is hard (maybe impossible) to predict the final state this\n      // match will end up in, so show only steps that already happened plus all\n      // the possibilities on the next step ahead.\n\n      // If we don't have swap coins after revocation, we won't show the pending message.\n      Doc.setVis(makerSwapCoin(m), tmpl.makerSwap)\n      Doc.setVis(takerSwapCoin(m), tmpl.takerSwap)\n      const takerRefundsAfter = new Date(m.stamp + lockTimeTakerMs)\n      const takerLockTimeExpired = Date.now() > takerRefundsAfter.getTime()\n      // When match is revoked and both swaps are present, maker redeem might still show up:\n      // - as maker, we'll try to redeem until taker locktime expires (if taker refunds\n      //   we won't be able to redeem; even if taker hasn't refunded just yet - it\n      //   becomes too dangerous to redeem after taker locktime expired because maker\n      //   reveals his secret when redeeming, and taker might be able to submit both\n      //   redeem and refund transactions before maker's redeem gets mined), so we'll\n      //   have to show redeem pending element until maker redeem shows up, or until\n      //   we give up on redeeming due to taker locktime expiry.\n      // - as taker, we should expect maker redeeming any time, so we'll have to show\n      //   redeem pending element until maker redeem shows up, or until we refund.\n      Doc.setVis(makerRedeemCoin(m) || (takerSwapCoin(m) && m.active && !m.refund && !takerLockTimeExpired), tmpl.makerRedeem)\n      // When maker isn't aware of taker redeem coin, once the match becomes inactive\n      // (nothing else maker is expected to do in this match) just hide taker redeem.\n      Doc.setVis(takerRedeemCoin(m) || (makerRedeemCoin(m) && m.active && !m.refund), tmpl.takerRedeem)\n      // As taker, show refund placeholder only if we have outstanding swap to refund.\n      // There is no need to wait for anything else, we can show refund placeholder\n      // (to inform the user that it is likely to happen) right after match revocation.\n      let expectingRefund = Boolean(takerSwapCoin(m)) // as taker\n      if (m.side === OrderUtil.Maker) {\n        // As maker, show refund placeholder only if we have outstanding swap to refund.\n        // If we don't have taker swap there is no need to wait for anything else, we\n        // can show refund placeholder (to inform the user that it is likely to happen)\n        // right after match revocation.\n        expectingRefund = Boolean(makerSwapCoin(m))\n        // If we discover taker swap we'll be trying to redeem it (instead of trying\n        // to refund our own swap) until taker refunds, so start showing refund\n        // placeholder only after taker is expected to start his refund process in\n        // this case.\n        if (takerSwapCoin(m)) {\n          expectingRefund = expectingRefund && takerLockTimeExpired\n        }\n      }\n      Doc.setVis(m.refund || (m.active && !m.redeem && !m.counterRedeem && expectingRefund), tmpl.refund)\n    }\n  }\n\n  /*\n   * addNewMatchCard adds a new card to the list of match cards.\n   */\n  addNewMatchCard (match: Match) {\n    const page = this.page\n    const matchCard = page.matchCardTmpl.cloneNode(true) as HTMLElement\n    app().bindUrlHandlers(matchCard)\n    matchCard.dataset.matchID = match.matchID\n    this.setImmutableMatchCardElements(matchCard, match)\n    this.setMutableMatchCardElements(matchCard, match)\n    page.matchBox.appendChild(matchCard)\n  }\n\n  /*\n   * showMatchCards creates cards for each match in the order.\n   */\n  showMatchCards () {\n    const order = this.order\n    if (!order) return\n    if (!order.matches) return\n    order.matches.sort((a, b) => a.stamp - b.stamp)\n    order.matches.forEach((match) => this.addNewMatchCard(match))\n  }\n\n  /* showCancel shows a form to confirm submission of a cancel order. */\n  showCancel () {\n    const order = this.order\n    const page = this.page\n    const remaining = order.qty - order.filled\n    const asset = OrderUtil.isMarketBuy(order) ? app().assets[order.quoteID] : app().assets[order.baseID]\n    page.cancelRemain.textContent = Doc.formatCoinValue(remaining, asset.unitInfo)\n    page.cancelUnit.textContent = asset.unitInfo.conventional.unit.toUpperCase()\n    this.showForm(page.cancelForm)\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    this.currentForm = form\n    const page = this.page\n    Doc.hide(page.cancelForm, page.accelerateForm)\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0px'\n  }\n\n  /* submitCancel submits a cancellation for the order. */\n  async submitCancel () {\n    // this will be the page.cancelSubmit button (evt.currentTarget)\n    const page = this.page\n    const order = this.order\n    const req = {\n      orderID: order.id\n    }\n    const loaded = app().loading(page.cancelForm)\n    const res = await postJSON('/api/cancel', req)\n    loaded()\n    if (!app().checkResponse(res)) return\n    page.status.textContent = intl.prep(intl.ID_CANCELING)\n    Doc.hide(page.forms)\n    order.cancelling = true\n  }\n\n  /*\n   * setAccelerationButtonVis shows the acceleration button if the order can\n   * be accelerated.\n   */\n  setAccelerationButtonVis () {\n    const order = this.order\n    if (!order) return\n    const page = this.page\n    Doc.setVis(app().canAccelerateOrder(order), page.accelerateBttn, page.actionsLabel)\n  }\n\n  /* showAccelerateForm shows a form to accelerate an order */\n  async showAccelerateForm () {\n    const loaded = app().loading(this.page.accelerateBttn)\n    this.accelerateOrderForm.refresh(this.order)\n    loaded()\n    this.showForm(this.page.accelerateForm)\n  }\n\n  /*\n   * handleOrderNote is the handler for the 'order'-type notification, which are\n   * used to update an order's status.\n   */\n  handleOrderNote (note: OrderNote) {\n    const page = this.page\n    const order = note.order\n    if (order.id !== this.orderID) return\n    this.order = order\n    const bttn = page.cancelBttn\n    if (bttn && order.status > OrderUtil.StatusBooked) Doc.hide(bttn)\n    page.status.textContent = OrderUtil.statusString(order)\n    for (const m of order.matches || []) this.processMatch(m)\n    this.setAccelerationButtonVis()\n  }\n\n  /* handleMatchNote handles a 'match' notification. */\n  handleMatchNote (note: MatchNote) {\n    if (note.orderID !== this.orderID) return\n    this.processMatch(note.match)\n    this.setAccelerationButtonVis()\n  }\n\n  /*\n   * processMatch synchronizes a match's card with a match received in a\n   * 'order' or 'match' notification.\n   */\n  processMatch (m: Match) {\n    let card: HTMLElement | null = null\n    for (const div of Doc.applySelector(this.page.matchBox, '.match-card')) {\n      if (div.dataset.matchID === m.matchID) {\n        card = div\n        break\n      }\n    }\n    if (card) {\n      this.setMutableMatchCardElements(card, m)\n    } else {\n      this.addNewMatchCard(m)\n    }\n  }\n}\n\n/*\n * confirmationString is a string describing the state of confirmations for a\n * coin.\n * */\nfunction confirmationString (coin: Coin) {\n  if (!coin.confs || coin.confs.required === 0) return ''\n  return `${coin.confs.count} / ${coin.confs.required} ${intl.prep(intl.ID_CONFIRMATIONS)}`\n}\n\n// makerSwapCoin return's the maker's swap coin.\nfunction makerSwapCoin (m: Match) : Coin {\n  return (m.side === OrderUtil.Maker) ? m.swap : m.counterSwap\n}\n\n// takerSwapCoin return's the taker's swap coin.\nfunction takerSwapCoin (m: Match) {\n  return (m.side === OrderUtil.Maker) ? m.counterSwap : m.swap\n}\n\n// makerRedeemCoin return's the maker's redeem coin.\nfunction makerRedeemCoin (m: Match) {\n  return (m.side === OrderUtil.Maker) ? m.redeem : m.counterRedeem\n}\n\n// takerRedeemCoin return's the taker's redeem coin.\nfunction takerRedeemCoin (m: Match) {\n  return (m.side === OrderUtil.Maker) ? m.counterRedeem : m.redeem\n}\n\n/*\n* inConfirmingMakerRedeem will be true if we are the maker, and we are waiting\n* on confirmations for our own redeem.\n*/\nfunction inConfirmingMakerRedeem (m: Match) {\n  return m.status < OrderUtil.MatchConfirmed && m.side === OrderUtil.Maker && m.status >= OrderUtil.MakerRedeemed\n}\n\n/*\n* inConfirmingTakerRedeem will be true if we are the taker, and we are waiting\n* on confirmations for our own redeem.\n*/\nfunction inConfirmingTakerRedeem (m: Match) {\n  return m.status < OrderUtil.MatchConfirmed && m.side === OrderUtil.Taker && m.status >= OrderUtil.MatchComplete\n}\n","import superPropBase from \"./superPropBase.js\";\nexport default function _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get.bind();\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get.apply(this, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nexport default function _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}","import {\n  app,\n  PageElement,\n  MMBotStatus,\n  RunStatsNote,\n  RunEventNote,\n  StartConfig,\n  OrderPlacement,\n  AutoRebalanceConfig,\n  CEXNotification,\n  EpochReportNote,\n  CEXProblemsNote,\n  MarketWithHost\n} from './registry'\nimport {\n  MM,\n  CEXDisplayInfo,\n  CEXDisplayInfos,\n  botTypeBasicArb,\n  botTypeArbMM,\n  botTypeBasicMM,\n  setMarketElements,\n  setCexElements,\n  PlacementsChart,\n  BotMarket,\n  hostedMarketID,\n  RunningMarketMakerDisplay,\n  RunningMMDisplayElements\n} from './mmutil'\nimport Doc, { MiniSlider } from './doc'\nimport BasePage from './basepage'\nimport * as OrderUtil from './orderutil'\nimport { Forms, CEXConfigurationForm } from './forms'\nimport * as intl from './locales'\nimport { StatusBooked } from './orderutil'\nconst mediumBreakpoint = 768\n\ninterface FundingSlider {\n  left: {\n    cex: number\n    dex: number\n  }\n  right: {\n    cex: number\n    dex: number\n  }\n  cexRange: number\n  dexRange: number\n}\n\nconst newSlider = () => {\n  return {\n    left: {\n      cex: 0,\n      dex: 0\n    },\n    right: {\n      cex: 0,\n      dex: 0\n    },\n    cexRange: 0,\n    dexRange: 0\n  }\n}\n\ninterface FundingSource {\n  avail: number\n  req: number\n  funded: boolean\n}\n\ninterface FundingOutlook {\n  dex: FundingSource\n  cex: FundingSource\n  transferable: number\n  fees: {\n    avail: number\n    req: number\n    funded: boolean\n  },\n  fundedAndBalanced: boolean\n  fundedAndNotBalanced: boolean\n}\n\nfunction parseFundingOptions (f: FundingOutlook): [number, number, FundingSlider | undefined] {\n  const { cex: { avail: cexAvail, req: cexReq }, dex: { avail: dexAvail, req: dexReq }, transferable } = f\n\n  let proposedDex = Math.min(dexAvail, dexReq)\n  let proposedCex = Math.min(cexAvail, cexReq)\n  let slider: FundingSlider | undefined\n  if (f.fundedAndNotBalanced) {\n    // We have everything we need, but not where we need it, and we can\n    // deposit and withdraw.\n    if (dexAvail > dexReq) {\n      // We have too much dex-side, so we'll have to draw on dex to balance\n      // cex's shortcomings.\n      const cexShort = cexReq - cexAvail\n      const dexRemain = dexAvail - dexReq\n      if (dexRemain < cexShort) {\n        // We did something really bad with math to get here.\n        throw Error('bad math has us with dex surplus + cex underfund invalid remains')\n      }\n      proposedDex += cexShort + transferable\n    } else {\n      // We don't have enough on dex, but we have enough on cex to cover the\n      // short.\n      const dexShort = dexReq - dexAvail\n      const cexRemain = cexAvail - cexReq\n      if (cexRemain < dexShort) {\n        throw Error('bad math got us with cex surplus + dex underfund invalid remains')\n      }\n      proposedCex += dexShort + transferable\n    }\n  } else if (f.fundedAndBalanced) {\n    // This asset is fully funded, but the user may choose to fund order\n    // reserves either cex or dex.\n    if (transferable > 0) {\n      const dexRemain = dexAvail - dexReq\n      const cexRemain = cexAvail - cexReq\n\n      slider = newSlider()\n\n      if (cexRemain > transferable && dexRemain > transferable) {\n        // Either one could fully fund order reserves. Let the user choose.\n        slider.left.cex = transferable + cexReq\n        slider.left.dex = dexReq\n        slider.right.cex = cexReq\n        slider.right.dex = transferable + dexReq\n      } else if (dexRemain < transferable && cexRemain < transferable) {\n        // => implied that cexRemain + dexRemain > transferable.\n        // CEX can contribute SOME and DEX can contribute SOME.\n        slider.left.cex = transferable - dexRemain + cexReq\n        slider.left.dex = dexRemain + dexReq\n        slider.right.cex = cexRemain + cexReq\n        slider.right.dex = transferable - cexRemain + dexReq\n      } else if (dexRemain > transferable) {\n        // So DEX has enough to cover reserves, but CEX could potentially\n        // constribute SOME. NOT ALL.\n        slider.left.cex = cexReq\n        slider.left.dex = transferable + dexReq\n        slider.right.cex = cexRemain + cexReq\n        slider.right.dex = transferable - cexRemain + dexReq\n      } else {\n        // CEX has enough to cover reserves, but DEX could contribute SOME,\n        // NOT ALL.\n        slider.left.cex = transferable - dexRemain + cexReq\n        slider.left.dex = dexRemain + dexReq\n        slider.right.cex = transferable + cexReq\n        slider.right.dex = dexReq\n      }\n      // We prefer the slider right in the center.\n      slider.cexRange = slider.right.cex - slider.left.cex\n      slider.dexRange = slider.right.dex - slider.left.dex\n      proposedDex = slider.left.dex + (slider.dexRange / 2)\n      proposedCex = slider.left.cex + (slider.cexRange / 2)\n    }\n  } else { // starved\n    if (cexAvail < cexReq) {\n      proposedDex = Math.min(dexAvail, dexReq + transferable + (cexReq - cexAvail))\n    } else if (dexAvail < dexReq) {\n      proposedCex = Math.min(cexAvail, cexReq + transferable + (dexReq - dexAvail))\n    } else { // just transferable wasn't covered\n      proposedDex = Math.min(dexAvail, dexReq + transferable)\n      proposedCex = Math.min(cexAvail, dexReq + cexReq + transferable - proposedDex)\n    }\n  }\n  return [proposedDex, proposedCex, slider]\n}\n\ninterface CEXRow {\n  cexName: string\n  tr: PageElement\n  tmpl: Record<string, PageElement>\n  dinfo: CEXDisplayInfo\n}\n\nexport default class MarketMakerPage extends BasePage {\n  page: Record<string, PageElement>\n  forms: Forms\n  currentForm: HTMLElement\n  keyup: (e: KeyboardEvent) => void\n  cexConfigForm: CEXConfigurationForm\n  bots: Record<string, Bot>\n  sortedBots: Bot[]\n  cexes: Record<string, CEXRow>\n  twoColumn: boolean\n  runningMMDisplayElements: RunningMMDisplayElements\n  removingCfg: MarketWithHost | undefined\n\n  constructor (main: HTMLElement) {\n    super()\n\n    this.bots = {}\n    this.sortedBots = []\n    this.cexes = {}\n\n    const page = this.page = Doc.idDescendants(main)\n\n    Doc.cleanTemplates(page.botTmpl, page.botRowTmpl, page.exchangeRowTmpl)\n\n    this.forms = new Forms(page.forms)\n    this.cexConfigForm = new CEXConfigurationForm(page.cexConfigForm, (cexName: string, success: boolean) => this.cexConfigured(cexName, success))\n    this.runningMMDisplayElements = {\n      orderReportForm: page.orderReportForm,\n      dexBalancesRowTmpl: page.dexBalancesRowTmpl,\n      placementRowTmpl: page.placementRowTmpl,\n      placementAmtRowTmpl: page.placementAmtRowTmpl\n    }\n    Doc.cleanTemplates(page.dexBalancesRowTmpl, page.placementRowTmpl, page.placementAmtRowTmpl)\n\n    Doc.bind(page.newBot, 'click', () => { this.newBot() })\n    Doc.bind(page.archivedLogsBtn, 'click', () => { app().loadPage('mmarchives') })\n    Doc.bind(page.confirmRemoveConfigBttn, 'click', () => { this.removeCfg() })\n\n    this.twoColumn = window.innerWidth >= mediumBreakpoint\n    const ro = new ResizeObserver(() => { this.resized() })\n    ro.observe(main)\n\n    for (const [cexName, dinfo] of Object.entries(CEXDisplayInfos)) {\n      const tr = page.exchangeRowTmpl.cloneNode(true) as PageElement\n      page.cexRows.appendChild(tr)\n      const tmpl = Doc.parseTemplate(tr)\n      const configure = () => {\n        this.cexConfigForm.setCEX(cexName)\n        this.forms.show(page.cexConfigForm)\n      }\n      Doc.bind(tmpl.configureBttn, 'click', configure)\n      Doc.bind(tmpl.reconfigBttn, 'click', configure)\n      Doc.bind(tmpl.errConfigureBttn, 'click', configure)\n      const row = this.cexes[cexName] = { tr, tmpl, dinfo, cexName }\n      this.updateCexRow(row)\n    }\n\n    this.setup()\n  }\n\n  resized () {\n    const useTwoColumn = window.innerWidth >= 768\n    if (useTwoColumn !== this.twoColumn) {\n      this.twoColumn = useTwoColumn\n      this.clearBotBoxes()\n      for (const { div } of this.sortedBots) this.appendBotBox(div)\n    }\n  }\n\n  async setup () {\n    const page = this.page\n    const mmStatus = app().mmStatus\n\n    const botConfigs = mmStatus.bots.map((s: MMBotStatus) => s.config)\n    app().registerNoteFeeder({\n      runstats: (note: RunStatsNote) => { this.handleRunStatsNote(note) },\n      runevent: (note: RunEventNote) => {\n        const bot = this.bots[hostedMarketID(note.host, note.baseID, note.quoteID)]\n        if (bot) return bot.handleRunStats()\n      },\n      epochreport: (note: EpochReportNote) => {\n        const bot = this.bots[hostedMarketID(note.host, note.baseID, note.quoteID)]\n        if (bot) bot.handleEpochReportNote(note)\n      },\n      cexproblems: (note: CEXProblemsNote) => {\n        const bot = this.bots[hostedMarketID(note.host, note.baseID, note.quoteID)]\n        if (bot) bot.handleCexProblemsNote(note)\n      },\n      cexnote: (note: CEXNotification) => { this.handleCEXNote(note) }\n      // TODO bot start-stop notification\n    })\n\n    const noBots = !botConfigs || botConfigs.length === 0\n    Doc.setVis(noBots, page.noBots)\n    if (noBots) return\n    page.noBots.remove()\n\n    const sortedBots = [...mmStatus.bots].sort((a: MMBotStatus, b: MMBotStatus) => {\n      if (a.running && !b.running) return -1\n      if (b.running && !a.running) return 1\n      // If none are running, just do something to get a resonably reproducible\n      // sort.\n      if (!a.running && !b.running) return (a.config.baseID + a.config.quoteID) - (b.config.baseID + b.config.quoteID)\n      // Both are running. Sort by run time.\n      return (b.runStats?.startTime ?? 0) - (a.runStats?.startTime ?? 0)\n    })\n\n    for (const botStatus of sortedBots) this.addBot(botStatus)\n  }\n\n  async handleCEXNote (n: CEXNotification) {\n    switch (n.topic) {\n      case 'BalanceUpdate':\n        return this.handleCEXBalanceUpdate(n.cexName /* , n.note */)\n    }\n  }\n\n  async handleCEXBalanceUpdate (cexName: string /* , note: CEXBalanceUpdate */) {\n    const cexRow = this.cexes[cexName]\n    if (cexRow) this.updateCexRow(cexRow)\n  }\n\n  async handleRunStatsNote (note: RunStatsNote) {\n    const { baseID, quoteID, host } = note\n    const bot = this.bots[hostedMarketID(host, baseID, quoteID)]\n    if (bot) return bot.handleRunStats()\n    this.addBot(app().botStatus(host, baseID, quoteID) as MMBotStatus)\n  }\n\n  unload (): void {\n    Doc.unbind(document, 'keyup', this.keyup)\n  }\n\n  addBot (botStatus: MMBotStatus) {\n    const { page, bots, sortedBots } = this\n    // Make sure the market still exists.\n    const { config: { baseID, quoteID, host } } = botStatus\n    const [baseSymbol, quoteSymbol] = [app().assets[baseID].symbol, app().assets[quoteID].symbol]\n    const mktID = `${baseSymbol}_${quoteSymbol}`\n    if (!app().exchanges[host]?.markets[mktID]) return\n    const bot = new Bot(this, this.runningMMDisplayElements, botStatus)\n    page.botRows.appendChild(bot.row.tr)\n    sortedBots.push(bot)\n    bots[bot.id] = bot\n    this.appendBotBox(bot.div)\n  }\n\n  confirmRemoveCfg (mwh: MarketWithHost) {\n    const page = this.page\n    this.removingCfg = mwh\n    Doc.hide(page.removeCfgErr)\n    const { unitInfo: { conventional: { unit: baseTicker } } } = app().assets[mwh.baseID]\n    const { unitInfo: { conventional: { unit: quoteTicker } } } = app().assets[mwh.quoteID]\n    page.confirmRemoveCfgMsg.textContent = intl.prep(intl.ID_DELETE_BOT, { host: mwh.host, baseTicker, quoteTicker })\n    this.forms.show(this.page.confirmRemoveForm)\n  }\n\n  async removeCfg () {\n    const page = this.page\n    if (!this.removingCfg) { this.forms.close(); return }\n    const resp = await MM.removeBotConfig(this.removingCfg.host, this.removingCfg.baseID, this.removingCfg.quoteID)\n    if (!app().checkResponse(resp)) {\n      page.removeCfgErr.textContent = intl.prep(intl.ID_API_ERROR, { msg: resp.msg })\n      Doc.show(page.removeCfgErr)\n      return\n    }\n    await app().fetchMMStatus()\n    app().loadPage('mm')\n  }\n\n  appendBotBox (div: PageElement) {\n    const { page: { boxZero, boxOne }, twoColumn } = this\n    const useZeroth = !twoColumn || (boxZero.children.length + boxOne.children.length) % 2 === 0\n    const box = useZeroth ? boxZero : boxOne\n    box.append(div)\n  }\n\n  clearBotBoxes () {\n    const { page: { boxOne, boxZero } } = this\n    while (boxZero.children.length > 1) boxZero.removeChild(boxZero.lastChild as Element)\n    while (boxOne.children.length > 0) boxOne.removeChild(boxOne.lastChild as Element)\n  }\n\n  showBot (botID: string) {\n    const { sortedBots } = this\n    const idx = sortedBots.findIndex((bot: Bot) => bot.id === botID)\n    sortedBots.splice(idx, 1)\n    sortedBots.unshift(this.bots[botID])\n    this.clearBotBoxes()\n    for (const { div } of sortedBots) this.appendBotBox(div)\n    const div = this.bots[botID].div\n    Doc.animate(250, (p: number) => {\n      div.style.opacity = `${p}`\n      div.style.transform = `scale(${0.8 + 0.2 * p})`\n    })\n  }\n\n  newBot () {\n    app().loadPage('mmsettings')\n  }\n\n  async cexConfigured (cexName: string, success: boolean) {\n    await app().fetchMMStatus()\n    this.updateCexRow(this.cexes[cexName])\n    if (success) this.forms.close()\n  }\n\n  updateCexRow (row: CEXRow) {\n    const { tmpl, dinfo, cexName } = row\n    tmpl.logo.src = dinfo.logo\n    tmpl.name.textContent = dinfo.name\n    const status = app().mmStatus.cexes[cexName]\n    Doc.setVis(!status, tmpl.unconfigured)\n    Doc.setVis(status && !status.connectErr, tmpl.configured)\n    Doc.setVis(status?.connectErr, tmpl.connectErrBox)\n    if (status?.connectErr) {\n      tmpl.connectErr.textContent = 'connection error'\n      tmpl.connectErr.dataset.tooltip = status.connectErr\n    }\n    tmpl.logo.classList.toggle('greyscale', !status)\n    if (!status) return\n    let usdBal = 0\n    const cexSymbolAdded : Record<string, boolean> = {} // avoid double counting tokens or counting both eth and weth\n    for (const [assetIDStr, bal] of Object.entries(status.balances)) {\n      const assetID = parseInt(assetIDStr)\n      const cexSymbol = Doc.bipCEXSymbol(assetID)\n      if (cexSymbolAdded[cexSymbol]) continue\n      cexSymbolAdded[cexSymbol] = true\n      const { unitInfo } = app().assets[assetID]\n      const fiatRate = app().fiatRatesMap[assetID]\n      if (fiatRate) usdBal += fiatRate * (bal.available + bal.locked) / unitInfo.conventional.conversionFactor\n    }\n    tmpl.usdBalance.textContent = Doc.formatFourSigFigs(usdBal)\n  }\n\n  percentageBalanceStr (assetID: number, balance: number, percentage: number): string {\n    const asset = app().assets[assetID]\n    const unitInfo = asset.unitInfo\n    const assetValue = Doc.formatCoinValue((balance * percentage) / 100, unitInfo)\n    return `${Doc.formatFourSigFigs(percentage)}% - ${assetValue} ${asset.symbol.toUpperCase()}`\n  }\n\n  /*\n   * walletBalanceStr returns a string like \"50% - 0.0001 BTC\" representing\n   * the percentage of a wallet's balance selected in the market maker setting,\n   * and the amount of that asset in the wallet.\n   */\n  walletBalanceStr (assetID: number, percentage: number): string {\n    const { wallet: { balance: { available } } } = app().assets[assetID]\n    return this.percentageBalanceStr(assetID, available, percentage)\n  }\n}\n\ninterface BotRow {\n  tr: PageElement\n  tmpl: Record<string, PageElement>\n}\n\nclass Bot extends BotMarket {\n  pg: MarketMakerPage\n  div: PageElement\n  page: Record<string, PageElement>\n  placementsChart: PlacementsChart\n  baseAllocSlider: MiniSlider\n  quoteAllocSlider: MiniSlider\n  row: BotRow\n  runDisplay: RunningMarketMakerDisplay\n\n  constructor (pg: MarketMakerPage, runningMMElements: RunningMMDisplayElements, status: MMBotStatus) {\n    super(status.config)\n    this.pg = pg\n    const { baseID, quoteID, host, botType, nBuyPlacements, nSellPlacements, cexName } = this\n    this.id = hostedMarketID(host, baseID, quoteID)\n\n    const div = this.div = pg.page.botTmpl.cloneNode(true) as PageElement\n    const page = this.page = Doc.parseTemplate(div)\n\n    this.runDisplay = new RunningMarketMakerDisplay(page.onBox, pg.forms, runningMMElements, 'mm')\n\n    setMarketElements(div, baseID, quoteID, host)\n    if (cexName) setCexElements(div, cexName)\n\n    if (botType === botTypeArbMM) {\n      page.botTypeDisplay.textContent = intl.prep(intl.ID_BOTTYPE_ARB_MM)\n    } else if (botType === botTypeBasicArb) {\n      page.botTypeDisplay.textContent = intl.prep(intl.ID_BOTTYPE_SIMPLE_ARB)\n    } else if (botType === botTypeBasicMM) {\n      page.botTypeDisplay.textContent = intl.prep(intl.ID_BOTTYPE_BASIC_MM)\n    }\n\n    Doc.setVis(botType !== botTypeBasicArb, page.placementsChartBox, page.baseTokenSwapFeesBox)\n    if (botType !== botTypeBasicArb) {\n      this.placementsChart = new PlacementsChart(page.placementsChart)\n      page.buyPlacementCount.textContent = String(nBuyPlacements)\n      page.sellPlacementCount.textContent = String(nSellPlacements)\n    }\n\n    Doc.bind(page.startBttn, 'click', () => this.start())\n    Doc.bind(page.allocationBttn, 'click', () => this.allocate())\n    Doc.bind(page.reconfigureBttn, 'click', () => this.reconfigure())\n    Doc.bind(page.removeBttn, 'click', () => this.pg.confirmRemoveCfg(status.config))\n    Doc.bind(page.goBackFromAllocation, 'click', () => this.hideAllocationDialog())\n    Doc.bind(page.marketLink, 'click', () => app().loadPage('markets', { host, baseID, quoteID }))\n\n    this.baseAllocSlider = new MiniSlider(page.baseAllocSlider, () => { /* callback set later */ })\n    this.quoteAllocSlider = new MiniSlider(page.quoteAllocSlider, () => { /* callback set later */ })\n\n    const tr = pg.page.botRowTmpl.cloneNode(true) as PageElement\n    setMarketElements(tr, baseID, quoteID, host)\n    const tmpl = Doc.parseTemplate(tr)\n    this.row = { tr, tmpl }\n    Doc.bind(tmpl.allocateBttn, 'click', (e: MouseEvent) => {\n      e.stopPropagation()\n      this.allocate()\n      pg.showBot(this.id)\n    })\n    Doc.bind(tr, 'click', () => pg.showBot(this.id))\n\n    this.initialize()\n  }\n\n  async initialize () {\n    await super.initialize()\n    this.runDisplay.setBotMarket(this)\n    const {\n      page, host, cexName, botType, div,\n      cfg: { arbMarketMakingConfig, basicMarketMakingConfig }, mktID,\n      baseFactor, quoteFactor, marketReport: { baseFiatRate }\n    } = this\n\n    if (botType !== botTypeBasicArb) {\n      let buyPlacements: OrderPlacement[] = []\n      let sellPlacements: OrderPlacement[] = []\n      let profit = 0\n      if (arbMarketMakingConfig) {\n        buyPlacements = arbMarketMakingConfig.buyPlacements.map((p) => ({ lots: p.lots, gapFactor: p.multiplier }))\n        sellPlacements = arbMarketMakingConfig.sellPlacements.map((p) => ({ lots: p.lots, gapFactor: p.multiplier }))\n        profit = arbMarketMakingConfig.profit\n      } else if (basicMarketMakingConfig) {\n        buyPlacements = basicMarketMakingConfig.buyPlacements\n        sellPlacements = basicMarketMakingConfig.sellPlacements\n        let bestBuy: OrderPlacement | undefined\n        let bestSell : OrderPlacement | undefined\n        if (buyPlacements.length > 0) bestBuy = buyPlacements.reduce((prev: OrderPlacement, curr: OrderPlacement) => curr.gapFactor < prev.gapFactor ? curr : prev)\n        if (sellPlacements.length > 0) bestSell = sellPlacements.reduce((prev: OrderPlacement, curr: OrderPlacement) => curr.gapFactor < prev.gapFactor ? curr : prev)\n        if (bestBuy && bestSell) {\n          profit = (bestBuy.gapFactor + bestSell.gapFactor) / 2\n        } else if (bestBuy) {\n          profit = bestBuy.gapFactor\n        } else if (bestSell) {\n          profit = bestSell.gapFactor\n        }\n      }\n      const marketConfig = { cexName: cexName as string, botType, baseFiatRate: baseFiatRate, dict: { profit, buyPlacements, sellPlacements } }\n      this.placementsChart.setMarket(marketConfig)\n    }\n\n    Doc.setVis(botType !== botTypeBasicMM, page.cexDataBox)\n    if (botType !== botTypeBasicMM) {\n      const cex = app().mmStatus.cexes[cexName]\n      if (cex) {\n        const mkt = cex.markets ? cex.markets[mktID] : undefined\n        Doc.setVis(mkt?.day, page.cexDataBox)\n        if (mkt?.day) {\n          const day = mkt.day\n          page.cexPrice.textContent = Doc.formatFourSigFigs(day.lastPrice)\n          page.cexVol.textContent = Doc.formatFourSigFigs(baseFiatRate * day.vol)\n        }\n      }\n    }\n    Doc.setVis(Boolean(cexName), ...Doc.applySelector(div, '[data-cex-show]'))\n\n    const { spot } = app().exchanges[host].markets[mktID]\n    if (spot) {\n      Doc.show(page.dexDataBox)\n      const c = OrderUtil.RateEncodingFactor / baseFactor * quoteFactor\n      page.dexPrice.textContent = Doc.formatFourSigFigs(spot.rate / c)\n      page.dexVol.textContent = Doc.formatFourSigFigs(spot.vol24 / baseFactor * baseFiatRate)\n    }\n\n    this.updateDisplay()\n    this.updateTableRow()\n    Doc.hide(page.loadingBg)\n  }\n\n  updateTableRow () {\n    const { row: { tmpl } } = this\n    const { running, runStats } = this.status()\n    Doc.setVis(running, tmpl.profitLossBox)\n    Doc.setVis(!running, tmpl.allocateBttnBox)\n    if (runStats) {\n      tmpl.profitLoss.textContent = Doc.formatFourSigFigs(runStats.profitLoss.profit, 2)\n    }\n  }\n\n  updateDisplay () {\n    const { page, marketReport: { baseFiatRate, quoteFiatRate }, baseFeeFiatRate, quoteFeeFiatRate } = this\n    if ([baseFiatRate, quoteFiatRate, baseFeeFiatRate, quoteFeeFiatRate].some((r: number) => !r)) {\n      Doc.hide(page.onBox, page.offBox)\n      Doc.show(page.noFiatDisplay)\n      return\n    }\n    const { running } = this.status()\n    Doc.setVis(running, page.onBox)\n    Doc.setVis(!running, page.offBox)\n    if (running) this.updateRunningDisplay()\n    else this.updateIdleDisplay()\n  }\n\n  updateRunningDisplay () {\n    this.runDisplay.update()\n  }\n\n  updateIdleDisplay () {\n    const {\n      page, proj: { alloc, qProj, bProj }, baseID, quoteID, cexName, bui, qui, baseFeeID,\n      quoteFeeID, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor,\n      marketReport: { baseFiatRate, quoteFiatRate }, cfg: { uiConfig: { baseConfig, quoteConfig } },\n      quoteFeeUI, baseFeeUI\n    } = this\n    page.baseAlloc.textContent = Doc.formatFullPrecision(alloc[baseID], bui)\n    const baseUSD = alloc[baseID] / baseFactor * baseFiatRate\n    let totalUSD = baseUSD\n    page.baseAllocUSD.textContent = Doc.formatFourSigFigs(baseUSD)\n    page.baseBookAlloc.textContent = Doc.formatFullPrecision(bProj.book * baseFactor, bui)\n    page.baseOrderReservesAlloc.textContent = Doc.formatFullPrecision(bProj.orderReserves * baseFactor, bui)\n    page.baseOrderReservesPct.textContent = String(Math.round(baseConfig.orderReservesFactor * 100))\n    Doc.setVis(cexName, page.baseCexAllocBox)\n    if (cexName) page.baseCexAlloc.textContent = Doc.formatFullPrecision(bProj.cex * baseFactor, bui)\n    Doc.setVis(baseFeeID === baseID, page.baseBookingFeesAllocBox)\n    Doc.setVis(baseFeeID !== baseID, page.baseTokenFeesAllocBox)\n    if (baseFeeID === baseID) {\n      const bookingFees = baseID === quoteFeeID ? bProj.bookingFees + qProj.bookingFees : bProj.bookingFees\n      page.baseBookingFeesAlloc.textContent = Doc.formatFullPrecision(bookingFees * baseFeeFactor, baseFeeUI)\n    } else {\n      const feeAlloc = alloc[baseFeeID]\n      page.baseTokenFeeAlloc.textContent = Doc.formatFullPrecision(feeAlloc, baseFeeUI)\n      const baseFeeUSD = feeAlloc / baseFeeFactor * app().fiatRatesMap[baseFeeID]\n      totalUSD += baseFeeUSD\n      page.baseTokenAllocUSD.textContent = Doc.formatFourSigFigs(baseFeeUSD)\n      const withQuote = baseFeeID === quoteFeeID\n      const bookingFees = bProj.bookingFees + (withQuote ? qProj.bookingFees : 0)\n      page.baseTokenBookingFees.textContent = Doc.formatFullPrecision(bookingFees * baseFeeFactor, baseFeeUI)\n      page.baseTokenSwapFeeN.textContent = String(baseConfig.swapFeeN + (withQuote ? quoteConfig.swapFeeN : 0))\n      const swapReserves = bProj.swapFeeReserves + (withQuote ? qProj.swapFeeReserves : 0)\n      page.baseTokenSwapFees.textContent = Doc.formatFullPrecision(swapReserves * baseFeeFactor, baseFeeUI)\n    }\n\n    page.quoteAlloc.textContent = Doc.formatFullPrecision(alloc[quoteID], qui)\n    const quoteUSD = alloc[quoteID] / quoteFactor * quoteFiatRate\n    totalUSD += quoteUSD\n    page.quoteAllocUSD.textContent = Doc.formatFourSigFigs(quoteUSD)\n    page.quoteBookAlloc.textContent = Doc.formatFullPrecision(qProj.book * quoteFactor, qui)\n    page.quoteOrderReservesAlloc.textContent = Doc.formatFullPrecision(qProj.orderReserves * quoteFactor, qui)\n    page.quoteOrderReservesPct.textContent = String(Math.round(quoteConfig.orderReservesFactor * 100))\n    page.quoteSlippageAlloc.textContent = Doc.formatFullPrecision(qProj.slippageBuffer * quoteFactor, qui)\n    page.slippageBufferFactor.textContent = String(Math.round(quoteConfig.slippageBufferFactor * 100))\n    Doc.setVis(cexName, page.quoteCexAllocBox)\n    if (cexName) page.quoteCexAlloc.textContent = Doc.formatFullPrecision(qProj.cex * quoteFactor, qui)\n    Doc.setVis(quoteID === quoteFeeID, page.quoteBookingFeesAllocBox)\n    Doc.setVis(quoteFeeID !== quoteID && quoteFeeID !== baseFeeID, page.quoteTokenFeesAllocBox)\n    if (quoteID === quoteFeeID) {\n      const bookingFees = quoteID === baseFeeID ? bProj.bookingFees + qProj.bookingFees : qProj.bookingFees\n      page.quoteBookingFeesAlloc.textContent = Doc.formatFullPrecision(bookingFees * quoteFeeFactor, quoteFeeUI)\n    } else if (quoteFeeID !== baseFeeID) {\n      page.quoteTokenFeeAlloc.textContent = Doc.formatFullPrecision(alloc[quoteFeeID], quoteFeeUI)\n      const quoteFeeUSD = alloc[quoteFeeID] / quoteFeeFactor * app().fiatRatesMap[quoteFeeID]\n      totalUSD += quoteFeeUSD\n      page.quoteTokenAllocUSD.textContent = Doc.formatFourSigFigs(quoteFeeUSD)\n      page.quoteTokenBookingFees.textContent = Doc.formatFullPrecision(qProj.bookingFees * quoteFeeFactor, quoteFeeUI)\n      page.quoteTokenSwapFeeN.textContent = String(quoteConfig.swapFeeN)\n      page.quoteTokenSwapFees.textContent = Doc.formatFullPrecision(qProj.swapFeeReserves * quoteFeeFactor, quoteFeeUI)\n    }\n    page.totalAllocUSD.textContent = Doc.formatFourSigFigs(totalUSD)\n  }\n\n  /*\n   * allocate opens a dialog to choose funding sources (if applicable) and\n   * confirm allocations and start the bot.\n   */\n  allocate () {\n    const {\n      page, marketReport: { baseFiatRate, quoteFiatRate }, baseID, quoteID,\n      baseFeeID, quoteFeeID, baseFeeFiatRate, quoteFeeFiatRate, cexName,\n      baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor, host, mktID\n    } = this\n\n    if (cexName) {\n      const cex = app().mmStatus.cexes[cexName]\n      if (!cex || !cex.connected) {\n        page.offError.textContent = intl.prep(intl.ID_CEX_NOT_CONNECTED, { cexName })\n        Doc.showTemporarily(3000, page.offError)\n        return\n      }\n    }\n\n    const f = this.fundingState()\n\n    const [proposedDexBase, proposedCexBase, baseSlider] = parseFundingOptions(f.base)\n    const [proposedDexQuote, proposedCexQuote, quoteSlider] = parseFundingOptions(f.quote)\n\n    const alloc = this.alloc = {\n      dex: {\n        [baseID]: proposedDexBase * baseFactor,\n        [quoteID]: proposedDexQuote * quoteFactor\n      },\n      cex: {\n        [baseID]: proposedCexBase * baseFactor,\n        [quoteID]: proposedCexQuote * quoteFactor\n      }\n    }\n\n    alloc.dex[baseFeeID] = Math.min((alloc.dex[baseFeeID] ?? 0) + (f.base.fees.req * baseFeeFactor), f.base.fees.avail * baseFeeFactor)\n    alloc.dex[quoteFeeID] = Math.min((alloc.dex[quoteFeeID] ?? 0) + (f.quote.fees.req * quoteFeeFactor), f.quote.fees.avail * quoteFeeFactor)\n\n    let totalUSD = (alloc.dex[baseID] / baseFactor * baseFiatRate) + (alloc.dex[quoteID] / quoteFactor * quoteFiatRate)\n    totalUSD += (alloc.cex[baseID] / baseFactor * baseFiatRate) + (alloc.cex[quoteID] / quoteFactor * quoteFiatRate)\n    if (baseFeeID !== baseID) totalUSD += alloc.dex[baseFeeID] / baseFeeFactor * baseFeeFiatRate\n    if (quoteFeeID !== quoteID && quoteFeeID !== baseFeeID) totalUSD += alloc.dex[quoteFeeID] / quoteFeeFactor * quoteFeeFiatRate\n    page.allocUSD.textContent = Doc.formatFourSigFigs(totalUSD)\n\n    Doc.setVis(cexName, ...Doc.applySelector(page.allocationDialog, '[data-cex-only]'))\n    Doc.setVis(f.fundedAndBalanced, page.fundedAndBalancedBox)\n    Doc.setVis(f.base.transferable + f.quote.transferable > 0, page.hasTransferable)\n    Doc.setVis(f.fundedAndNotBalanced, page.fundedAndNotBalancedBox)\n    Doc.setVis(f.starved, page.starvedBox)\n    page.startBttn.classList.toggle('go', f.fundedAndBalanced)\n    page.startBttn.classList.toggle('warning', !f.fundedAndBalanced)\n    page.proposedDexBaseAlloc.classList.toggle('text-warning', !(f.base.fundedAndBalanced || f.base.fundedAndNotBalanced))\n    page.proposedDexQuoteAlloc.classList.toggle('text-warning', !(f.quote.fundedAndBalanced || f.quote.fundedAndNotBalanced))\n\n    const setBaseProposal = (dex: number, cex: number) => {\n      page.proposedDexBaseAlloc.textContent = Doc.formatFourSigFigs(dex)\n      page.proposedDexBaseAllocUSD.textContent = Doc.formatFourSigFigs(dex * baseFiatRate)\n      page.proposedCexBaseAlloc.textContent = Doc.formatFourSigFigs(cex)\n      page.proposedCexBaseAllocUSD.textContent = Doc.formatFourSigFigs(cex * baseFiatRate)\n    }\n    setBaseProposal(proposedDexBase, proposedCexBase)\n\n    Doc.setVis(baseSlider, page.baseAllocSlider)\n    if (baseSlider) {\n      const dexRange = baseSlider.right.dex - baseSlider.left.dex\n      const cexRange = baseSlider.right.cex - baseSlider.left.cex\n      this.baseAllocSlider.setValue(0.5)\n      this.baseAllocSlider.changed = (r: number) => {\n        const dexAlloc = baseSlider.left.dex + r * dexRange\n        const cexAlloc = baseSlider.left.cex + r * cexRange\n        alloc.dex[baseID] = dexAlloc * baseFactor\n        alloc.cex[baseID] = cexAlloc * baseFactor\n        setBaseProposal(dexAlloc, cexAlloc)\n      }\n    }\n\n    const setQuoteProposal = (dex: number, cex: number) => {\n      page.proposedDexQuoteAlloc.textContent = Doc.formatFourSigFigs(dex)\n      page.proposedDexQuoteAllocUSD.textContent = Doc.formatFourSigFigs(dex * quoteFiatRate)\n      page.proposedCexQuoteAlloc.textContent = Doc.formatFourSigFigs(cex)\n      page.proposedCexQuoteAllocUSD.textContent = Doc.formatFourSigFigs(cex * quoteFiatRate)\n    }\n    setQuoteProposal(proposedDexQuote, proposedCexQuote)\n\n    Doc.setVis(quoteSlider, page.quoteAllocSlider)\n    if (quoteSlider) {\n      const dexRange = quoteSlider.right.dex - quoteSlider.left.dex\n      const cexRange = quoteSlider.right.cex - quoteSlider.left.cex\n      this.quoteAllocSlider.setValue(0.5)\n      this.quoteAllocSlider.changed = (r: number) => {\n        const dexAlloc = quoteSlider.left.dex + r * dexRange\n        const cexAlloc = quoteSlider.left.cex + r * cexRange\n        alloc.dex[quoteID] = dexAlloc * quoteFactor\n        alloc.cex[quoteID] = cexAlloc * quoteFactor\n        setQuoteProposal(dexAlloc, cexAlloc)\n      }\n    }\n\n    Doc.setVis(baseFeeID !== baseID, ...Doc.applySelector(page.allocationDialog, '[data-base-token-fees]'))\n    if (baseFeeID !== baseID) {\n      const reqFees = f.base.fees.req + (baseFeeID === quoteFeeID ? f.quote.fees.req : 0)\n      const proposedFees = Math.min(reqFees, f.base.fees.avail)\n      page.proposedDexBaseFeeAlloc.textContent = Doc.formatFourSigFigs(proposedFees)\n      page.proposedDexBaseFeeAllocUSD.textContent = Doc.formatFourSigFigs(proposedFees * baseFeeFiatRate)\n      page.proposedDexBaseFeeAlloc.classList.toggle('text-warning', !f.base.fees.funded)\n    }\n\n    const needQuoteTokenFees = quoteFeeID !== quoteID && quoteFeeID !== baseFeeID\n    Doc.setVis(needQuoteTokenFees, ...Doc.applySelector(page.allocationDialog, '[data-quote-token-fees]'))\n    if (needQuoteTokenFees) {\n      const proposedFees = Math.min(f.quote.fees.req, f.quote.fees.avail)\n      page.proposedDexQuoteFeeAlloc.textContent = Doc.formatFourSigFigs(proposedFees)\n      page.proposedDexQuoteFeeAllocUSD.textContent = Doc.formatFourSigFigs(proposedFees * quoteFeeFiatRate)\n      page.proposedDexQuoteFeeAlloc.classList.toggle('text-warning', !f.quote.fees.funded)\n    }\n\n    const mkt = app().exchanges[host]?.markets[mktID]\n    let existingOrders = false\n    if (mkt && mkt.orders) {\n      for (let i = 0; i < mkt.orders.length; i++) {\n        if (mkt.orders[i].status <= StatusBooked) {\n          existingOrders = true\n          break\n        }\n      }\n    }\n    Doc.setVis(existingOrders, page.existingOrdersBox)\n\n    Doc.show(page.allocationDialog)\n    const closeDialog = (e: MouseEvent) => {\n      if (Doc.mouseInElement(e, page.allocationDialog)) return\n      this.hideAllocationDialog()\n      Doc.unbind(document, 'click', closeDialog)\n    }\n    Doc.bind(document, 'click', closeDialog)\n  }\n\n  hideAllocationDialog () {\n    Doc.hide(this.page.allocationDialog)\n  }\n\n  async start () {\n    const { page, alloc, baseID, quoteID, host, cexName, cfg: { uiConfig: { cexRebalance } } } = this\n\n    Doc.hide(page.errMsg)\n    if (cexName && !app().mmStatus.cexes[cexName]?.connected) {\n      page.errMsg.textContent = `${cexName} not connected`\n      Doc.show(page.errMsg)\n      return\n    }\n\n    // round allocations values.\n    for (const m of [alloc.dex, alloc.cex]) {\n      for (const [assetID, v] of Object.entries(m)) m[parseInt(assetID)] = Math.round(v)\n    }\n\n    const startConfig: StartConfig = {\n      baseID: baseID,\n      quoteID: quoteID,\n      host: host,\n      alloc: alloc\n    }\n    if (cexName && cexRebalance) startConfig.autoRebalance = this.autoRebalanceSettings()\n\n    try {\n      app().log('mm', 'starting mm bot', startConfig)\n      const res = await MM.startBot(startConfig)\n      if (!app().checkResponse(res)) throw res\n    } catch (e) {\n      page.errMsg.textContent = intl.prep(intl.ID_API_ERROR, e)\n      Doc.show(page.errMsg)\n      return\n    }\n    this.hideAllocationDialog()\n  }\n\n  autoRebalanceSettings (): AutoRebalanceConfig {\n    const {\n      proj: { bProj, qProj, alloc }, baseFeeID, quoteFeeID, cfg: { uiConfig: { baseConfig, quoteConfig } },\n      baseID, quoteID, cexName, mktID\n    } = this\n\n    const totalBase = alloc[baseID]\n    let dexMinBase = bProj.book\n    if (baseID === baseFeeID) dexMinBase += bProj.bookingFees\n    if (baseID === quoteFeeID) dexMinBase += qProj.bookingFees\n    let dexMinQuote = qProj.book\n    if (quoteID === quoteFeeID) dexMinQuote += qProj.bookingFees\n    if (quoteID === baseFeeID) dexMinQuote += bProj.bookingFees\n    const maxBase = Math.max(totalBase - dexMinBase, totalBase - bProj.cex)\n    const totalQuote = alloc[quoteID]\n    const maxQuote = Math.max(totalQuote - dexMinQuote, totalQuote - qProj.cex)\n    if (maxBase < 0 || maxQuote < 0) {\n      throw Error(`rebalance math doesn't work: ${JSON.stringify({ bProj, qProj, maxBase, maxQuote })}`)\n    }\n    const cex = app().mmStatus.cexes[cexName]\n    const mkt = cex.markets[mktID]\n    const [minB, maxB] = [mkt.baseMinWithdraw, Math.max(mkt.baseMinWithdraw * 2, maxBase)]\n    const minBaseTransfer = Math.round(minB + baseConfig.transferFactor * (maxB - minB))\n    const [minQ, maxQ] = [mkt.quoteMinWithdraw, Math.max(mkt.quoteMinWithdraw * 2, maxQuote)]\n    const minQuoteTransfer = Math.round(minQ + quoteConfig.transferFactor * (maxQ - minQ))\n    return { minBaseTransfer, minQuoteTransfer }\n  }\n\n  reconfigure () {\n    const { host, baseID, quoteID, cexName, botType, page } = this\n    if (cexName) {\n      const cex = app().mmStatus.cexes[cexName]\n      if (!cex || !cex.connected) {\n        page.offError.textContent = intl.prep(intl.ID_CEX_NOT_CONNECTED, { cexName })\n        Doc.showTemporarily(3000, page.offError)\n        return\n      }\n    }\n    app().loadPage('mmsettings', { host, baseID, quoteID, cexName, botType })\n  }\n\n  handleEpochReportNote (note: EpochReportNote) {\n    this.runDisplay.handleEpochReportNote(note)\n  }\n\n  handleCexProblemsNote (note: CEXProblemsNote) {\n    this.runDisplay.handleCexProblemsNote(note)\n  }\n\n  handleRunStats () {\n    this.updateDisplay()\n    this.updateTableRow()\n    this.runDisplay.readBook()\n  }\n}\n","import {\n  PageElement,\n  BotConfig,\n  OrderPlacement,\n  app,\n  Spot,\n  MarketReport,\n  OrderOption,\n  CEXConfig,\n  BasicMarketMakingConfig,\n  ArbMarketMakingConfig,\n  SimpleArbConfig,\n  ArbMarketMakingPlacement,\n  ExchangeBalance,\n  MarketMakingStatus,\n  MMCEXStatus,\n  BalanceNote,\n  BotAssetConfig,\n  ApprovalStatus,\n  SupportedAsset,\n  WalletState,\n  UnitInfo,\n  ProjectedAlloc,\n  AssetBookingFees\n} from './registry'\nimport Doc, {\n  NumberInput,\n  MiniSlider,\n  IncrementalInput,\n  toFourSigFigs,\n  toPrecision,\n  parseFloatDefault\n} from './doc'\nimport State from './state'\nimport BasePage from './basepage'\nimport { setOptionTemplates } from './opts'\nimport {\n  MM,\n  CEXDisplayInfos,\n  botTypeBasicArb,\n  botTypeArbMM,\n  botTypeBasicMM,\n  runningBotInventory,\n  setMarketElements,\n  setCexElements,\n  calculateQuoteLot,\n  PlacementsChart,\n  liveBotConfig,\n  GapStrategyMultiplier,\n  GapStrategyAbsolute,\n  GapStrategyAbsolutePlus,\n  GapStrategyPercent,\n  GapStrategyPercentPlus,\n  feesAndCommit\n} from './mmutil'\nimport { Forms, bind as bindForm, NewWalletForm, TokenApprovalForm, DepositAddress, CEXConfigurationForm } from './forms'\nimport * as intl from './locales'\nimport * as OrderUtil from './orderutil'\n\nconst specLK = 'lastMMSpecs'\nconst lastBotsLK = 'lastBots'\nconst lastArbExchangeLK = 'lastArbExchange'\nconst arbMMRowCacheKey = 'arbmm'\n\nconst defaultSwapReserves = {\n  n: 50,\n  prec: 0,\n  inc: 10,\n  minR: 0,\n  maxR: 1000,\n  range: 1000\n}\nconst defaultOrderReserves = {\n  factor: 1.0,\n  minR: 0,\n  maxR: 3,\n  range: 3,\n  prec: 3\n}\nconst defaultTransfer = {\n  factor: 0.1,\n  minR: 0,\n  maxR: 1,\n  range: 1\n}\nconst defaultSlippage = {\n  factor: 0.05,\n  minR: 0,\n  maxR: 0.3,\n  range: 0.3,\n  prec: 3\n}\nconst defaultDriftTolerance = {\n  value: 0.002,\n  minV: 0,\n  maxV: 0.02,\n  range: 0.02,\n  prec: 5\n}\nconst defaultOrderPersistence = {\n  value: 20,\n  minV: 0,\n  maxV: 40, // 10 minutes @ 15 second epochs\n  range: 40,\n  prec: 0\n}\nconst defaultProfit = {\n  prec: 3,\n  value: 0.01,\n  minV: 0.001,\n  maxV: 0.1,\n  range: 0.1 - 0.001\n}\nconst defaultLevelSpacing = {\n  prec: 3,\n  value: 0.005,\n  minV: 0.001,\n  maxV: 0.02,\n  range: 0.02 - 0.0001\n}\nconst defaultMatchBuffer = {\n  value: 0,\n  prec: 3,\n  minV: 0,\n  maxV: 1,\n  range: 1\n}\nconst defaultLevelsPerSide = {\n  prec: 0,\n  inc: 1,\n  value: 1,\n  minV: 1\n}\nconst defaultLotsPerLevel = {\n  prec: 0,\n  value: 1,\n  minV: 1,\n  usdIncrement: 100\n}\nconst defaultUSDPerSide = {\n  prec: 2\n}\n\nconst defaultMarketMakingConfig: ConfigState = {\n  gapStrategy: GapStrategyPercentPlus,\n  sellPlacements: [],\n  buyPlacements: [],\n  driftTolerance: defaultDriftTolerance.value,\n  profit: 0.02,\n  orderPersistence: defaultOrderPersistence.value,\n  cexRebalance: true,\n  simpleArbLots: 1\n} as any as ConfigState\n\nconst defaultBotAssetConfig: BotAssetConfig = {\n  swapFeeN: defaultSwapReserves.n,\n  orderReservesFactor: defaultOrderReserves.factor,\n  slippageBufferFactor: defaultSlippage.factor,\n  transferFactor: defaultTransfer.factor\n}\n\n// cexButton stores parts of a CEX selection button.\ninterface cexButton {\n  name: string\n  div: PageElement\n  tmpl: Record<string, PageElement>\n}\n\n/*\n * ConfigState is an amalgamation of BotConfig, ArbMarketMakingCfg, and\n * BasicMarketMakingCfg. ConfigState tracks the global state of the options\n * presented on the page, with a single field for each option / control element.\n * ConfigState is necessary because there are duplicate fields in the various\n * config structs, and the placement types are not identical.\n */\ninterface ConfigState {\n  gapStrategy: string\n  profit: number\n  driftTolerance: number\n  orderPersistence: number // epochs\n  cexRebalance: boolean\n  disabled: boolean\n  buyPlacements: OrderPlacement[]\n  sellPlacements: OrderPlacement[]\n  baseOptions: Record<string, string>\n  quoteOptions: Record<string, string>\n  baseConfig: BotAssetConfig\n  quoteConfig: BotAssetConfig\n  simpleArbLots: number\n}\n\ninterface BotSpecs {\n  host: string\n  baseID: number\n  quoteID: number\n  botType: string\n  cexName?: string\n}\n\ninterface MarketRow {\n  tr: PageElement\n  tmpl: Record<string, PageElement>\n  host: string\n  name: string\n  baseID: number\n  quoteID: number\n  arbs: string[]\n  spot: Spot\n}\n\ninterface UIOpts {\n  usingUSDPerSide?: boolean\n}\n\nexport default class MarketMakerSettingsPage extends BasePage {\n  page: Record<string, PageElement>\n  forms: Forms\n  opts: UIOpts\n  newWalletForm: NewWalletForm\n  approveTokenForm: TokenApprovalForm\n  walletAddrForm: DepositAddress\n  cexConfigForm: CEXConfigurationForm\n  currentMarket: string\n  originalConfig: ConfigState\n  updatedConfig: ConfigState\n  creatingNewBot: boolean\n  marketReport: MarketReport\n  qcProfit: NumberInput\n  qcProfitSlider: MiniSlider\n  qcLevelSpacing: NumberInput\n  qcLevelSpacingSlider: MiniSlider\n  qcMatchBuffer: NumberInput\n  qcMatchBufferSlider: MiniSlider\n  qcLevelsPerSide: IncrementalInput\n  qcLotsPerLevel: IncrementalInput\n  qcUSDPerSide: IncrementalInput\n  cexBaseBalance: ExchangeBalance\n  cexQuoteBalance: ExchangeBalance\n  specs: BotSpecs\n  mktID: string\n  formSpecs: BotSpecs\n  formCexes: Record<string, cexButton>\n  placementsCache: Record<string, [OrderPlacement[], OrderPlacement[]]>\n  botTypeSelectors: PageElement[]\n  marketRows: MarketRow[]\n  lotsPerLevelIncrement: number\n  placementsChart: PlacementsChart\n  basePane: AssetPane\n  quotePane: AssetPane\n  driftTolerance: NumberInput\n  driftToleranceSlider: MiniSlider\n  orderPersistence: NumberInput\n  orderPersistenceSlider: MiniSlider\n\n  constructor (main: HTMLElement, specs: BotSpecs) {\n    super()\n\n    this.placementsCache = {}\n    this.opts = {}\n\n    const page = this.page = Doc.idDescendants(main)\n\n    this.forms = new Forms(page.forms, {\n      closed: () => {\n        if (!this.specs?.host || !this.specs?.botType) app().loadPage('mm')\n      }\n    })\n\n    this.placementsChart = new PlacementsChart(page.placementsChart)\n    this.approveTokenForm = new TokenApprovalForm(page.approveTokenForm, () => { this.submitBotType() })\n    this.walletAddrForm = new DepositAddress(page.walletAddrForm)\n    this.cexConfigForm = new CEXConfigurationForm(page.cexConfigForm, (cexName: string) => this.cexConfigured(cexName))\n    page.quotePane = page.basePane.cloneNode(true) as PageElement\n    page.assetPaneBox.appendChild(page.quotePane)\n    this.basePane = new AssetPane(this, page.basePane)\n    this.quotePane = new AssetPane(this, page.quotePane)\n\n    app().headerSpace.appendChild(page.mmTitle)\n\n    setOptionTemplates(page)\n    Doc.cleanTemplates(\n      page.orderOptTmpl, page.booleanOptTmpl, page.rangeOptTmpl, page.placementRowTmpl,\n      page.oracleTmpl, page.cexOptTmpl, page.arbBttnTmpl, page.marketRowTmpl, page.needRegTmpl\n    )\n    page.basePane.removeAttribute('id') // don't remove from layout\n\n    Doc.bind(page.resetButton, 'click', () => { this.setOriginalValues() })\n    Doc.bind(page.updateButton, 'click', () => { this.saveSettings() })\n    Doc.bind(page.createButton, 'click', async () => { this.saveSettings() })\n    Doc.bind(page.deleteBttn, 'click', () => { this.delete() })\n    bindForm(page.botTypeForm, page.botTypeSubmit, () => { this.submitBotType() })\n    Doc.bind(page.noMarketBttn, 'click', () => { this.showMarketSelectForm() })\n    Doc.bind(page.botTypeHeader, 'click', () => { this.reshowBotTypeForm() })\n    Doc.bind(page.botTypeChangeMarket, 'click', () => { this.showMarketSelectForm() })\n    Doc.bind(page.marketHeader, 'click', () => { this.showMarketSelectForm() })\n    Doc.bind(page.marketFilterInput, 'input', () => { this.sortMarketRows() })\n    Doc.bind(page.cexRebalanceCheckbox, 'change', () => { this.autoRebalanceChanged() })\n    Doc.bind(page.switchToAdvanced, 'click', () => { this.showAdvancedConfig() })\n    Doc.bind(page.switchToQuickConfig, 'click', () => { this.switchToQuickConfig() })\n    Doc.bind(page.qcMatchBuffer, 'change', () => { this.matchBufferChanged() })\n    Doc.bind(page.switchToUSDPerSide, 'click', () => { this.changeSideCommitmentDialog() })\n    Doc.bind(page.switchToLotsPerLevel, 'click', () => { this.changeSideCommitmentDialog() })\n    // Gap Strategy\n    Doc.bind(page.gapStrategySelect, 'change', () => {\n      if (!page.gapStrategySelect.value) return\n      const gapStrategy = page.gapStrategySelect.value\n      this.clearPlacements(this.updatedConfig.gapStrategy)\n      this.loadCachedPlacements(gapStrategy)\n      this.updatedConfig.gapStrategy = gapStrategy\n      this.setGapFactorLabels(gapStrategy)\n      this.updateModifiedMarkers()\n    })\n\n    // Buy/Sell placements\n    Doc.bind(page.addBuyPlacementBtn, 'click', () => {\n      this.addPlacement(true, null)\n      page.addBuyPlacementLots.value = ''\n      page.addBuyPlacementGapFactor.value = ''\n      this.updateModifiedMarkers()\n      this.placementsChart.render()\n      this.updateAllocations()\n    })\n    Doc.bind(page.addSellPlacementBtn, 'click', () => {\n      this.addPlacement(false, null)\n      page.addSellPlacementLots.value = ''\n      page.addSellPlacementGapFactor.value = ''\n      this.updateModifiedMarkers()\n      this.placementsChart.render()\n      this.updateAllocations()\n    })\n\n    this.driftTolerance = new NumberInput(page.driftToleranceInput, {\n      prec: defaultDriftTolerance.prec - 2, // converting to percent for display\n      sigFigs: true,\n      min: 0,\n      changed: (rawV: number) => {\n        const { minV, range, prec } = defaultDriftTolerance\n        const [v] = toFourSigFigs(rawV / 100, prec)\n        this.driftToleranceSlider.setValue((v - minV) / range)\n        this.updatedConfig.driftTolerance = v\n      }\n    })\n\n    this.driftToleranceSlider = new MiniSlider(page.driftToleranceSlider, (r: number) => {\n      const { minV, range, prec } = defaultDriftTolerance\n      const [v] = toFourSigFigs(minV + r * range, prec)\n      this.updatedConfig.driftTolerance = v\n      this.driftTolerance.setValue(v * 100)\n    })\n\n    this.orderPersistence = new NumberInput(page.orderPersistence, {\n      changed: (v: number) => {\n        const { minV, range } = defaultOrderPersistence\n        this.updatedConfig.orderPersistence = v\n        this.orderPersistenceSlider.setValue((v - minV) / range)\n      }\n    })\n\n    this.orderPersistenceSlider = new MiniSlider(page.orderPersistenceSlider, (r: number) => {\n      const { minV, range, prec } = defaultOrderPersistence\n      const rawV = minV + r * range\n      const [v] = toPrecision(rawV, prec)\n      this.updatedConfig.orderPersistence = v\n      this.orderPersistence.setValue(v)\n    })\n\n    this.qcProfit = new NumberInput(page.qcProfit, {\n      prec: defaultProfit.prec - 2, // converting to percent\n      sigFigs: true,\n      min: defaultProfit.minV * 100,\n      changed: (vPct: number) => {\n        const { minV, range } = defaultProfit\n        const v = vPct / 100\n        this.updatedConfig.profit = v\n        page.profitInput.value = this.qcProfit.input.value\n        this.qcProfitSlider.setValue((v - minV) / range)\n        this.quickConfigUpdated()\n      }\n    })\n\n    this.qcProfitSlider = new MiniSlider(page.qcProfitSlider, (r: number) => {\n      const { minV, range, prec } = defaultProfit\n      const [v] = toFourSigFigs((minV + r * range) * 100, prec)\n      this.updatedConfig.profit = v / 100\n      this.qcProfit.setValue(v)\n      page.profitInput.value = this.qcProfit.input.value\n      this.quickConfigUpdated()\n    })\n\n    this.qcLevelSpacing = new NumberInput(page.qcLevelSpacing, {\n      prec: defaultLevelSpacing.prec - 2, // converting to percent\n      sigFigs: true,\n      min: defaultLevelSpacing.minV * 100,\n      changed: (vPct: number) => {\n        const { minV, range } = defaultLevelSpacing\n        this.qcLevelSpacingSlider.setValue((vPct / 100 - minV) / range)\n        this.quickConfigUpdated()\n      }\n    })\n\n    this.qcLevelSpacingSlider = new MiniSlider(page.qcLevelSpacingSlider, (r: number) => {\n      const { minV, range } = defaultLevelSpacing\n      this.qcLevelSpacing.setValue(minV + r * range * 100)\n      this.quickConfigUpdated()\n    })\n\n    this.qcMatchBuffer = new NumberInput(page.qcMatchBuffer, {\n      prec: defaultMatchBuffer.prec - 2, // converting to percent\n      sigFigs: true,\n      min: defaultMatchBuffer.minV * 100,\n      changed: (vPct: number) => {\n        const { minV, range } = defaultMatchBuffer\n        this.qcMatchBufferSlider.setValue((vPct / 100 - minV) / range)\n        this.quickConfigUpdated()\n      }\n    })\n\n    this.qcMatchBufferSlider = new MiniSlider(page.qcMatchBufferSlider, (r: number) => {\n      const { minV, range } = defaultMatchBuffer\n      this.qcMatchBuffer.setValue(minV + r * range * 100)\n      this.quickConfigUpdated()\n    })\n\n    this.qcLevelsPerSide = new IncrementalInput(page.qcLevelsPerSide, {\n      prec: defaultLevelsPerSide.prec,\n      min: defaultLevelsPerSide.minV,\n      inc: defaultLevelsPerSide.inc,\n      changed: (v: number) => {\n        this.qcUSDPerSide.setValue(this.lotSizeUSD() * v * this.qcLotsPerLevel.value())\n        this.quickConfigUpdated()\n      }\n    })\n\n    this.qcLotsPerLevel = new IncrementalInput(page.qcLotsPerLevel, {\n      prec: defaultLotsPerLevel.prec,\n      min: defaultLotsPerLevel.minV,\n      inc: 1, // set showQuickConfig\n      changed: (v: number) => {\n        this.qcUSDPerSide.setValue(this.lotSizeUSD() * v * this.qcLevelsPerSide.value())\n        page.qcUSDPerSideEcho.textContent = this.qcUSDPerSide.input.value as string\n        this.quickConfigUpdated()\n      },\n      set: (v: number) => {\n        const [, s] = toFourSigFigs(v * this.qcLevelsPerSide.value() * this.lotSizeUSD(), 2)\n        page.qcUSDPerSideEcho.textContent = s\n        page.qcLotsPerLevelEcho.textContent = s\n      }\n    })\n\n    this.qcUSDPerSide = new IncrementalInput(page.qcUSDPerSide, {\n      prec: defaultUSDPerSide.prec,\n      min: 1, // changed by showQuickConfig\n      inc: 1, // changed by showQuickConfig\n      changed: (v: number) => {\n        this.qcLotsPerLevel.setValue(v / this.qcLevelsPerSide.value() / this.lotSizeUSD())\n        page.qcLotsPerLevelEcho.textContent = this.qcLotsPerLevel.input.value as string\n        this.quickConfigUpdated()\n      },\n      set: (v: number, s: string) => {\n        page.qcUSDPerSideEcho.textContent = s\n        page.qcLotsPerLevelEcho.textContent = String(Math.round(v / this.lotSizeUSD()))\n      }\n    })\n\n    const maybeSubmitBuyRow = (e: KeyboardEvent) => {\n      if (e.key !== 'Enter') return\n      if (\n        !isNaN(parseFloat(page.addBuyPlacementGapFactor.value || '')) &&\n        !isNaN(parseFloat(page.addBuyPlacementLots.value || ''))\n      ) {\n        page.addBuyPlacementBtn.click()\n      }\n    }\n    Doc.bind(page.addBuyPlacementGapFactor, 'keyup', (e: KeyboardEvent) => { maybeSubmitBuyRow(e) })\n    Doc.bind(page.addBuyPlacementLots, 'keyup', (e: KeyboardEvent) => { maybeSubmitBuyRow(e) })\n\n    const maybeSubmitSellRow = (e: KeyboardEvent) => {\n      if (e.key !== 'Enter') return\n      if (\n        !isNaN(parseFloat(page.addSellPlacementGapFactor.value || '')) &&\n        !isNaN(parseFloat(page.addSellPlacementLots.value || ''))\n      ) {\n        page.addSellPlacementBtn.click()\n      }\n    }\n    Doc.bind(page.addSellPlacementGapFactor, 'keyup', (e: KeyboardEvent) => { maybeSubmitSellRow(e) })\n    Doc.bind(page.addSellPlacementLots, 'keyup', (e: KeyboardEvent) => { maybeSubmitSellRow(e) })\n\n    Doc.bind(page.profitInput, 'change', () => {\n      Doc.hide(page.profitInputErr)\n      const showError = (errID: string) => {\n        Doc.show(page.profitInputErr)\n        page.profitInputErr.textContent = intl.prep(errID)\n      }\n      const profit = parseFloat(page.profitInput.value || '') / 100\n      if (isNaN(profit)) return showError(intl.ID_INVALID_VALUE)\n      if (profit === 0) return showError(intl.ID_NO_ZERO)\n      this.updatedConfig.profit = profit\n      this.updateModifiedMarkers()\n    })\n\n    this.botTypeSelectors = Doc.applySelector(page.botTypeForm, '[data-bot-type]')\n    for (const div of this.botTypeSelectors) {\n      Doc.bind(div, 'click', () => {\n        if (div.classList.contains('disabled')) return\n        Doc.hide(page.botTypeErr)\n        page.cexSelection.classList.toggle('disabled', div.dataset.botType === botTypeBasicMM)\n        this.setBotTypeSelected(div.dataset.botType as string)\n      })\n    }\n\n    this.newWalletForm = new NewWalletForm(\n      page.newWalletForm,\n      async () => {\n        await app().fetchUser()\n        this.submitBotType()\n      }\n    )\n\n    app().registerNoteFeeder({\n      balance: (note: BalanceNote) => { this.handleBalanceNote(note) }\n    })\n\n    this.initialize(specs)\n  }\n\n  unload () {\n    this.forms.exit()\n  }\n\n  async initialize (specs?: BotSpecs) {\n    this.setupCEXes()\n    this.initializeMarketRows()\n\n    const isRefresh = specs && Object.keys(specs).length === 0\n    if (isRefresh) specs = State.fetchLocal(specLK)\n    if (!specs || !app().walletMap[specs.baseID] || !app().walletMap[specs.quoteID]) {\n      this.showMarketSelectForm()\n      return\n    }\n\n    // If we have specs specifying only a market, make sure the cex name and\n    // bot type are set.\n    if (specs && !specs.botType) {\n      const botCfg = liveBotConfig(specs.host, specs.baseID, specs.quoteID)\n      specs.cexName = botCfg?.cexName ?? ''\n      specs.botType = botTypeBasicMM\n      if (botCfg?.arbMarketMakingConfig) specs.botType = botTypeArbMM\n      else if (botCfg?.simpleArbConfig) specs.botType = botTypeBasicArb\n    }\n\n    // Must be a reconfig.\n    this.specs = specs\n    await this.fetchCEXBalances(specs)\n    this.configureUI()\n  }\n\n  async configureUI () {\n    const { page, specs } = this\n    const { host, baseID, quoteID, cexName, botType } = specs\n\n    const [{ symbol: baseSymbol, token: baseToken }, { symbol: quoteSymbol, token: quoteToken }] = [app().assets[baseID], app().assets[quoteID]]\n    this.mktID = `${baseSymbol}_${quoteSymbol}`\n    Doc.hide(\n      page.botSettingsContainer, page.marketBox, page.updateButton, page.resetButton,\n      page.createButton, page.noMarket, page.missingFiatRates\n    )\n\n    if ([baseID, quoteID, baseToken?.parentID ?? baseID, quoteToken?.parentID ?? quoteID].some((assetID: number) => !app().fiatRatesMap[assetID])) {\n      Doc.show(page.missingFiatRates)\n      return\n    }\n\n    Doc.show(page.marketLoading)\n    State.storeLocal(specLK, specs)\n\n    const mmStatus = app().mmStatus\n    const viewOnly = isViewOnly(specs, mmStatus)\n    let botCfg = liveBotConfig(host, baseID, quoteID)\n    if (botCfg) {\n      const oldBotType = botCfg.arbMarketMakingConfig ? botTypeArbMM : botCfg.basicMarketMakingConfig ? botTypeBasicMM : botTypeBasicArb\n      if (oldBotType !== botType) botCfg = undefined\n    }\n    Doc.setVis(botCfg, page.deleteBttnBox)\n\n    const oldCfg = this.originalConfig = Object.assign({}, defaultMarketMakingConfig, {\n      disabled: viewOnly,\n      baseOptions: this.defaultWalletOptions(baseID),\n      quoteOptions: this.defaultWalletOptions(quoteID),\n      buyPlacements: [],\n      sellPlacements: [],\n      baseConfig: Object.assign({}, defaultBotAssetConfig),\n      quoteConfig: Object.assign({}, defaultBotAssetConfig)\n    }) as ConfigState\n\n    if (botCfg) {\n      const { basicMarketMakingConfig: mmCfg, arbMarketMakingConfig: arbMMCfg, simpleArbConfig: arbCfg, uiConfig: { cexRebalance } } = botCfg\n      this.creatingNewBot = false\n      // This is kinda sloppy, but we'll copy any relevant issues from the\n      // old config into the originalConfig.\n      const idx = oldCfg as { [k: string]: any } // typescript\n      for (const [k, v] of Object.entries(botCfg)) if (idx[k] !== undefined) idx[k] = v\n\n      oldCfg.baseConfig = Object.assign({}, defaultBotAssetConfig, botCfg.uiConfig.baseConfig)\n      oldCfg.quoteConfig = Object.assign({}, defaultBotAssetConfig, botCfg.uiConfig.quoteConfig)\n      oldCfg.baseOptions = botCfg.baseWalletOptions || {}\n      oldCfg.quoteOptions = botCfg.quoteWalletOptions || {}\n      oldCfg.cexRebalance = cexRebalance\n\n      if (mmCfg) {\n        oldCfg.buyPlacements = mmCfg.buyPlacements\n        oldCfg.sellPlacements = mmCfg.sellPlacements\n        oldCfg.driftTolerance = mmCfg.driftTolerance\n        oldCfg.gapStrategy = mmCfg.gapStrategy\n      } else if (arbMMCfg) {\n        const { buyPlacements, sellPlacements } = arbMMCfg\n        oldCfg.buyPlacements = Array.from(buyPlacements, (p: ArbMarketMakingPlacement) => { return { lots: p.lots, gapFactor: p.multiplier } })\n        oldCfg.sellPlacements = Array.from(sellPlacements, (p: ArbMarketMakingPlacement) => { return { lots: p.lots, gapFactor: p.multiplier } })\n        oldCfg.profit = arbMMCfg.profit\n        oldCfg.driftTolerance = arbMMCfg.driftTolerance\n        oldCfg.orderPersistence = arbMMCfg.orderPersistence\n      } else if (arbCfg) {\n        // TODO: expose maxActiveArbs\n        oldCfg.profit = arbCfg.profitTrigger\n        oldCfg.orderPersistence = arbCfg.numEpochsLeaveOpen\n        oldCfg.simpleArbLots = botCfg.uiConfig.simpleArbLots ?? 1\n      }\n      Doc.setVis(!viewOnly, page.updateButton, page.resetButton)\n    } else {\n      this.creatingNewBot = true\n      Doc.setVis(!viewOnly, page.createButton)\n    }\n\n    // Now that we've updated the originalConfig, we'll copy it.\n    this.updatedConfig = JSON.parse(JSON.stringify(oldCfg))\n\n    switch (botType) {\n      case botTypeBasicMM:\n        page.botTypeDisplay.textContent = intl.prep(intl.ID_BOTTYPE_BASIC_MM)\n        break\n      case botTypeArbMM:\n        page.botTypeDisplay.textContent = intl.prep(intl.ID_BOTTYPE_ARB_MM)\n        break\n      case botTypeBasicArb:\n        page.botTypeDisplay.textContent = intl.prep(intl.ID_BOTTYPE_SIMPLE_ARB)\n    }\n\n    setMarketElements(document.body, baseID, quoteID, host)\n    Doc.setVis(botType !== botTypeBasicArb, page.driftToleranceBox, page.switchToAdvanced)\n    Doc.setVis(Boolean(cexName), ...Doc.applySelector(document.body, '[data-cex-show]'))\n\n    Doc.setVis(viewOnly, page.viewOnlyRunning)\n    Doc.setVis(cexName, page.cexRebalanceSettings)\n    if (cexName) setCexElements(document.body, cexName)\n\n    await this.fetchMarketReport()\n\n    const lotSizeUSD = this.lotSizeUSD()\n    this.lotsPerLevelIncrement = Math.round(Math.max(1, defaultLotsPerLevel.usdIncrement / lotSizeUSD))\n    this.qcLotsPerLevel.inc = this.lotsPerLevelIncrement\n    this.qcUSDPerSide.inc = this.lotsPerLevelIncrement * lotSizeUSD\n    this.qcUSDPerSide.min = lotSizeUSD\n\n    this.basePane.setAsset(baseID, false)\n    this.quotePane.setAsset(quoteID, true)\n    const { marketReport: { baseFiatRate } } = this\n    this.placementsChart.setMarket({ cexName: cexName as string, botType, baseFiatRate, dict: this.updatedConfig })\n\n    // If this is a new bot, show the quick config form.\n    const isQuickPlacements = !botCfg || this.isQuickPlacements(this.updatedConfig.buyPlacements, this.updatedConfig.sellPlacements)\n    const gapStrategy = botCfg?.basicMarketMakingConfig?.gapStrategy ?? GapStrategyPercentPlus\n    page.gapStrategySelect.value = gapStrategy\n    if (botType === botTypeBasicArb || (isQuickPlacements && gapStrategy === GapStrategyPercentPlus)) this.showQuickConfig()\n    else this.showAdvancedConfig()\n\n    this.setOriginalValues()\n\n    Doc.hide(page.marketLoading)\n    Doc.show(page.botSettingsContainer, page.marketBox)\n  }\n\n  initializeMarketRows () {\n    this.marketRows = []\n    Doc.empty(this.page.marketSelect)\n    for (const { host, markets, assets, auth: { effectiveTier, pendingStrength } } of Object.values(app().exchanges)) {\n      if (effectiveTier + pendingStrength === 0) {\n        const { needRegTmpl, needRegBox } = this.page\n        const bttn = needRegTmpl.cloneNode(true) as PageElement\n        const tmpl = Doc.parseTemplate(bttn)\n        Doc.bind(bttn, 'click', () => { app().loadPage('register', { host, backTo: 'mmsettings' }) })\n        tmpl.host.textContent = host\n        needRegBox.appendChild(bttn)\n        Doc.show(needRegBox)\n        continue\n      }\n      for (const { name, baseid: baseID, quoteid: quoteID, spot, basesymbol: baseSymbol, quotesymbol: quoteSymbol } of Object.values(markets)) {\n        if (!app().assets[baseID] || !app().assets[quoteID]) continue\n        const tr = this.page.marketRowTmpl.cloneNode(true) as PageElement\n        const tmpl = Doc.parseTemplate(tr)\n        const mr = { tr, tmpl, host: host, name, baseID, quoteID, spot: spot, arbs: [] } as MarketRow\n        this.marketRows.push(mr)\n        this.page.marketSelect.appendChild(tr)\n        tmpl.baseIcon.src = Doc.logoPath(baseSymbol)\n        tmpl.quoteIcon.src = Doc.logoPath(quoteSymbol)\n        tmpl.baseSymbol.appendChild(Doc.symbolize(assets[baseID], true))\n        tmpl.quoteSymbol.appendChild(Doc.symbolize(assets[quoteID], true))\n        tmpl.host.textContent = host\n        const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID)\n        for (const [cexName, dinfo] of Object.entries(CEXDisplayInfos)) {\n          if (cexHasMarket(cexName)) {\n            const img = this.page.arbBttnTmpl.cloneNode(true) as PageElement\n            img.src = dinfo.logo\n            tmpl.arbs.appendChild(img)\n            mr.arbs.push(cexName)\n          }\n        }\n        Doc.bind(tr, 'click', () => { this.showBotTypeForm(host, baseID, quoteID) })\n      }\n    }\n    if (this.marketRows.length === 0) {\n      const { marketSelectionTable, marketFilterBox, noMarkets } = this.page\n      Doc.hide(marketSelectionTable, marketFilterBox)\n      Doc.show(noMarkets)\n    } else Doc.hide(this.page.noMarkets)\n    const fiatRates = app().fiatRatesMap\n    this.marketRows.sort((a: MarketRow, b: MarketRow) => {\n      let [volA, volB] = [a.spot?.vol24 ?? 0, b.spot?.vol24 ?? 0]\n      if (fiatRates[a.baseID] && fiatRates[b.baseID]) {\n        volA *= fiatRates[a.baseID]\n        volB *= fiatRates[b.baseID]\n      }\n      return volB - volA\n    })\n  }\n\n  runningBotInventory (assetID: number) {\n    return runningBotInventory(assetID)\n  }\n\n  adjustedBalances (baseWallet: WalletState, quoteWallet: WalletState) {\n    const { cexBaseBalance, cexQuoteBalance } = this\n    const [bInv, qInv] = [this.runningBotInventory(baseWallet.assetID), this.runningBotInventory(quoteWallet.assetID)]\n    const [cexBaseAvail, cexQuoteAvail] = [(cexBaseBalance?.available || 0) - bInv.cex.total, (cexQuoteBalance?.available || 0) - qInv.cex.total]\n    const [dexBaseAvail, dexQuoteAvail] = [baseWallet.balance.available - bInv.dex.total, quoteWallet.balance.available - qInv.dex.total]\n    const baseAvail = dexBaseAvail + cexBaseAvail\n    const quoteAvail = dexQuoteAvail + cexQuoteAvail\n    return { baseAvail, quoteAvail, dexBaseAvail, dexQuoteAvail, cexBaseAvail, cexQuoteAvail }\n  }\n\n  lotSizeUSD () {\n    const { specs: { host, baseID }, mktID, marketReport: { baseFiatRate } } = this\n    const xc = app().exchanges[host]\n    const market = xc.markets[mktID]\n    const { lotsize: lotSize } = market\n    const { unitInfo: ui } = app().assets[baseID]\n    return lotSize / ui.conventional.conversionFactor * baseFiatRate\n  }\n\n  /*\n    * marketStuff is just a bunch of useful properties for the current specs\n    * gathered in one place and with preferable names.\n    */\n  marketStuff () {\n    const {\n      page, specs: { host, baseID, quoteID, cexName, botType }, basePane, quotePane,\n      marketReport: { baseFiatRate, quoteFiatRate, baseFees, quoteFees },\n      lotsPerLevelIncrement, updatedConfig: cfg, originalConfig: oldCfg, mktID\n    } = this\n    const { symbol: baseSymbol, unitInfo: bui } = app().assets[baseID]\n    const { symbol: quoteSymbol, unitInfo: qui } = app().assets[quoteID]\n    const xc = app().exchanges[host]\n    const market = xc.markets[mktID]\n    const { lotsize: lotSize, spot } = market\n    const lotSizeUSD = lotSize / bui.conventional.conversionFactor * baseFiatRate\n    const atomicRate = 1 / bui.conventional.conversionFactor * baseFiatRate / quoteFiatRate * qui.conventional.conversionFactor\n    const xcRate = {\n      conv: quoteFiatRate / baseFiatRate,\n      atomic: atomicRate,\n      msg: Math.round(atomicRate * OrderUtil.RateEncodingFactor), // unadjusted\n      spot\n    }\n\n    let [dexBaseLots, dexQuoteLots] = [cfg.simpleArbLots, cfg.simpleArbLots]\n    if (botType !== botTypeBasicArb) {\n      dexBaseLots = this.updatedConfig.sellPlacements.reduce((lots: number, p: OrderPlacement) => lots + p.lots, 0)\n      dexQuoteLots = this.updatedConfig.buyPlacements.reduce((lots: number, p: OrderPlacement) => lots + p.lots, 0)\n    }\n    const quoteLot = calculateQuoteLot(lotSize, baseID, quoteID, spot)\n    const walletStuff = this.walletStuff()\n    const { baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker } = walletStuff\n\n    const { commit, fees } = feesAndCommit(\n      baseID, quoteID, baseFees, quoteFees, lotSize, dexBaseLots, dexQuoteLots,\n      baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker,\n      cfg.baseConfig.orderReservesFactor, cfg.quoteConfig.orderReservesFactor\n    )\n\n    return {\n      page, cfg, oldCfg, host, xc, baseID, quoteID, botType, cexName, baseFiatRate, quoteFiatRate,\n      xcRate, baseSymbol, quoteSymbol, mktID, lotSize, lotSizeUSD, lotsPerLevelIncrement,\n      quoteLot, commit, basePane, quotePane, fees, ...walletStuff\n    }\n  }\n\n  walletStuff () {\n    const { specs: { baseID, quoteID } } = this\n    const [baseWallet, quoteWallet] = [app().walletMap[baseID], app().walletMap[quoteID]]\n    const [{ token: baseToken, unitInfo: bui }, { token: quoteToken, unitInfo: qui }] = [app().assets[baseID], app().assets[quoteID]]\n    const baseFeeAssetID = baseToken ? baseToken.parentID : baseID\n    const quoteFeeAssetID = quoteToken ? quoteToken.parentID : quoteID\n    const [baseFeeUI, quoteFeeUI] = [app().assets[baseFeeAssetID].unitInfo, app().assets[quoteFeeAssetID].unitInfo]\n    const traitAccountLocker = 1 << 14\n    const baseIsAccountLocker = (baseWallet.traits & traitAccountLocker) > 0\n    const quoteIsAccountLocker = (quoteWallet.traits & traitAccountLocker) > 0\n    return {\n      baseWallet, quoteWallet, baseFeeUI, quoteFeeUI, baseToken, quoteToken,\n      bui, qui, baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker,\n      ...this.adjustedBalances(baseWallet, quoteWallet)\n    }\n  }\n\n  showAdvancedConfig () {\n    const { page } = this\n    Doc.show(page.advancedConfig)\n    Doc.hide(page.quickConfig)\n    this.placementsChart.render()\n  }\n\n  isQuickPlacements (buyPlacements: OrderPlacement[], sellPlacements: OrderPlacement[]) {\n    if (buyPlacements.length === 0 || buyPlacements.length !== sellPlacements.length) return false\n    for (let i = 0; i < buyPlacements.length; i++) {\n      if (buyPlacements[i].gapFactor !== sellPlacements[i].gapFactor) return false\n      if (buyPlacements[i].lots !== sellPlacements[i].lots) return false\n    }\n    return true\n  }\n\n  switchToQuickConfig () {\n    const { cfg, botType, lotSizeUSD } = this.marketStuff()\n    const { buyPlacements: buys, sellPlacements: sells } = cfg\n    // If we have both buys and sells, get the best approximation quick config\n    // approximation.\n    if (buys.length > 0 && sells.length > 0) {\n      const bestBuy = buys.reduce((prev: OrderPlacement, curr: OrderPlacement) => curr.gapFactor < prev.gapFactor ? curr : prev)\n      const bestSell = sells.reduce((prev: OrderPlacement, curr: OrderPlacement) => curr.gapFactor < prev.gapFactor ? curr : prev)\n      const placementCount = buys.length + sells.length\n      const levelsPerSide = Math.max(1, Math.floor((placementCount) / 2))\n      if (botType === botTypeBasicMM) {\n        cfg.profit = (bestBuy.gapFactor + bestSell.gapFactor) / 2\n        const worstBuy = buys.reduce((prev: OrderPlacement, curr: OrderPlacement) => curr.gapFactor > prev.gapFactor ? curr : prev)\n        const worstSell = sells.reduce((prev: OrderPlacement, curr: OrderPlacement) => curr.gapFactor > prev.gapFactor ? curr : prev)\n        const range = ((worstBuy.gapFactor - bestBuy.gapFactor) + (worstSell.gapFactor - bestSell.gapFactor)) / 2\n        const inc = range / (levelsPerSide - 1)\n        this.qcProfit.setValue(cfg.profit * 100)\n        this.qcProfitSlider.setValue((cfg.profit - defaultProfit.minV) / defaultProfit.range)\n        this.qcLevelSpacing.setValue(inc * 100)\n        this.qcLevelSpacingSlider.setValue((inc - defaultLevelSpacing.minV) / defaultLevelSpacing.range)\n      } else if (botType === botTypeArbMM) {\n        const multSum = buys.reduce((v: number, p: OrderPlacement) => v + p.gapFactor, 0) + sells.reduce((v: number, p: OrderPlacement) => v + p.gapFactor, 0)\n        const buffer = ((multSum / placementCount) - 1) || defaultMatchBuffer.value\n        this.qcMatchBuffer.setValue(buffer * 100)\n        this.qcMatchBufferSlider.setValue((buffer - defaultMatchBuffer.minV) / defaultMatchBuffer.range)\n      }\n      const lots = buys.reduce((v: number, p: OrderPlacement) => v + p.lots, 0) + sells.reduce((v: number, p: OrderPlacement) => v + p.lots, 0)\n      const lotsPerLevel = Math.max(1, Math.round(lots / 2 / levelsPerSide))\n      this.qcLotsPerLevel.setValue(lotsPerLevel)\n      this.qcUSDPerSide.setValue(lotsPerLevel * levelsPerSide * lotSizeUSD)\n      this.qcLevelsPerSide.setValue(levelsPerSide)\n    } else if (botType === botTypeBasicArb) {\n      this.qcLotsPerLevel.setValue(cfg.simpleArbLots)\n    }\n    this.showQuickConfig()\n    this.quickConfigUpdated()\n  }\n\n  showQuickConfig () {\n    const { page, lotSizeUSD, botType, lotsPerLevelIncrement } = this.marketStuff()\n\n    if (!this.qcLevelsPerSide.input.value) {\n      this.qcLevelsPerSide.setValue(defaultLevelsPerSide.value)\n      this.qcUSDPerSide.setValue(defaultLevelsPerSide.value * (this.qcLotsPerLevel.value() || lotsPerLevelIncrement) * lotSizeUSD)\n    }\n    if (!this.qcLotsPerLevel.input.value) {\n      this.qcLotsPerLevel.setValue(lotsPerLevelIncrement)\n      this.qcUSDPerSide.setValue(lotSizeUSD * lotsPerLevelIncrement * this.qcLevelsPerSide.value())\n    }\n    if (!page.qcLevelSpacing.value) {\n      this.qcLevelSpacing.setValue(defaultLevelSpacing.value * 100)\n      this.qcLevelSpacingSlider.setValue((defaultLevelSpacing.value - defaultLevelSpacing.minV) / defaultLevelSpacing.range)\n    }\n    if (!page.qcMatchBuffer.value) page.qcMatchBuffer.value = String(defaultMatchBuffer.value * 100)\n\n    Doc.hide(page.advancedConfig)\n    Doc.show(page.quickConfig)\n\n    this.showInputsForBot(botType)\n  }\n\n  showInputsForBot (botType: string) {\n    const { page, opts: { usingUSDPerSide } } = this\n    Doc.hide(\n      page.matchMultiplierBox, page.placementsChartBox, page.placementChartLegend,\n      page.lotsPerLevelLabel, page.levelSpacingBox, page.arbLotsLabel, page.qcLevelPerSideBox\n    )\n    Doc.setVis(usingUSDPerSide, page.qcUSDPerSideBox)\n    Doc.setVis(!usingUSDPerSide, page.qcLotsBox)\n    switch (botType) {\n      case botTypeArbMM:\n        Doc.show(\n          page.qcLevelPerSideBox, page.matchMultiplierBox, page.placementsChartBox,\n          page.placementChartLegend, page.lotsPerLevelLabel\n        )\n        break\n      case botTypeBasicMM:\n        Doc.show(\n          page.qcLevelPerSideBox, page.levelSpacingBox, page.placementsChartBox,\n          page.lotsPerLevelLabel\n        )\n        break\n      case botTypeBasicArb:\n        Doc.show(page.arbLotsLabel)\n    }\n  }\n\n  quickConfigUpdated () {\n    const { page, cfg, botType, cexName } = this.marketStuff()\n\n    Doc.hide(page.qcError)\n    const setError = (msg: string) => {\n      page.qcError.textContent = msg\n      Doc.show(page.qcError)\n    }\n\n    const levelsPerSide = botType === botTypeBasicArb ? 1 : this.qcLevelsPerSide.value()\n    if (isNaN(levelsPerSide)) {\n      setError('invalid value for levels per side')\n    }\n\n    const lotsPerLevel = this.qcLotsPerLevel.value()\n    if (isNaN(lotsPerLevel)) {\n      setError('invalid value for lots per level')\n    }\n\n    const profit = parseFloat(page.qcProfit.value ?? '') / 100\n    if (isNaN(profit)) {\n      setError('invalid value for profit')\n    }\n\n    const levelSpacing = botType === botTypeBasicMM ? parseFloat(page.qcLevelSpacing.value ?? '') / 100 : 0\n    if (isNaN(levelSpacing)) {\n      setError('invalid value for level spacing')\n    }\n\n    const matchBuffer = botType === botTypeArbMM ? parseFloat(page.qcMatchBuffer.value ?? '') / 100 : 0\n    if (isNaN(matchBuffer)) {\n      setError('invalid value for match buffer')\n    }\n    const multiplier = matchBuffer + 1\n\n    const levelSpacingDisabled = levelsPerSide === 1\n    page.levelSpacingBox.classList.toggle('disabled', levelSpacingDisabled)\n    page.qcLevelSpacing.disabled = levelSpacingDisabled\n    cfg.simpleArbLots = lotsPerLevel\n\n    if (botType !== botTypeBasicArb) {\n      this.clearPlacements(cexName ? arbMMRowCacheKey : cfg.gapStrategy)\n      for (let levelN = 0; levelN < levelsPerSide; levelN++) {\n        const placement = { lots: lotsPerLevel } as OrderPlacement\n        placement.gapFactor = botType === botTypeBasicMM ? profit + levelSpacing * levelN : multiplier\n        cfg.buyPlacements.push(placement)\n        cfg.sellPlacements.push(placement)\n        // Add rows in the advanced config table.\n        this.addPlacement(true, placement)\n        this.addPlacement(false, placement)\n      }\n\n      this.placementsChart.render()\n    }\n\n    this.updateAllocations()\n  }\n\n  updateAllocations () {\n    this.updateBaseAllocations()\n    this.updateQuoteAllocations()\n  }\n\n  updateBaseAllocations () {\n    const { commit, lotSize, basePane, fees } = this.marketStuff()\n\n    basePane.updateInventory(commit.dex.base.lots, commit.dex.quote.lots, lotSize, commit.dex.base.val, commit.cex.base.val, fees.base)\n    basePane.updateCommitTotal()\n  }\n\n  updateQuoteAllocations () {\n    const { commit, quoteLot: lotSize, quotePane, fees } = this.marketStuff()\n\n    quotePane.updateInventory(commit.dex.quote.lots, commit.dex.base.lots, lotSize, commit.dex.quote.val, commit.cex.quote.val, fees.quote)\n    quotePane.updateCommitTotal()\n  }\n\n  matchBufferChanged () {\n    const { page } = this\n    page.qcMatchBuffer.value = Math.max(0, parseFloat(page.qcMatchBuffer.value ?? '') || defaultMatchBuffer.value * 100).toFixed(2)\n    this.quickConfigUpdated()\n  }\n\n  showAddress (assetID: number) {\n    this.walletAddrForm.setAsset(assetID)\n    this.forms.show(this.page.walletAddrForm)\n  }\n\n  changeSideCommitmentDialog () {\n    const { page, opts } = this\n    opts.usingUSDPerSide = !opts.usingUSDPerSide\n    Doc.setVis(opts.usingUSDPerSide, page.qcUSDPerSideBox)\n    Doc.setVis(!opts.usingUSDPerSide, page.qcLotsBox)\n  }\n\n  async showBotTypeForm (host: string, baseID: number, quoteID: number, botType?: string, configuredCEX?: string) {\n    const { page } = this\n    this.formSpecs = { host, baseID, quoteID, botType: '' }\n    const viewOnly = isViewOnly(this.formSpecs, app().mmStatus)\n    if (viewOnly) {\n      const botCfg = liveBotConfig(host, baseID, quoteID)\n      const specs = this.specs = this.formSpecs\n      switch (true) {\n        case Boolean(botCfg?.simpleArbConfig):\n          specs.botType = botTypeBasicArb\n          break\n        case Boolean(botCfg?.arbMarketMakingConfig):\n          specs.botType = botTypeArbMM\n          break\n        default:\n          specs.botType = botTypeBasicMM\n      }\n      specs.cexName = botCfg?.cexName\n      await this.fetchCEXBalances(this.formSpecs)\n      await this.configureUI()\n      this.forms.close()\n      return\n    }\n    setMarketElements(page.botTypeForm, baseID, quoteID, host)\n    Doc.empty(page.botTypeBaseSymbol, page.botTypeQuoteSymbol)\n    const [b, q] = [app().assets[baseID], app().assets[quoteID]]\n    page.botTypeBaseSymbol.appendChild(Doc.symbolize(b, true))\n    page.botTypeQuoteSymbol.appendChild(Doc.symbolize(q, true))\n    for (const div of this.botTypeSelectors) div.classList.remove('selected')\n    for (const { div } of Object.values(this.formCexes)) div.classList.remove('selected')\n    this.setCEXAvailability(baseID, quoteID)\n    Doc.hide(page.noCexesConfigured, page.noCexMarket, page.noCexMarketConfigureMore, page.botTypeErr)\n    const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID)\n    const supportingCexes: Record<string, CEXConfig> = {}\n    for (const cex of Object.values(app().mmStatus.cexes)) {\n      if (cexHasMarket(cex.config.name)) supportingCexes[cex.config.name] = cex.config\n    }\n    const nCexes = Object.keys(supportingCexes).length\n    const arbEnabled = nCexes > 0\n    for (const div of this.botTypeSelectors) div.classList.toggle('disabled', div.dataset.botType !== botTypeBasicMM && !arbEnabled)\n    if (Object.keys(app().mmStatus.cexes).length === 0) {\n      Doc.show(page.noCexesConfigured)\n      this.setBotTypeSelected(botTypeBasicMM)\n    } else {\n      const lastBots = (State.fetchLocal(lastBotsLK) || {}) as Record<string, BotSpecs>\n      const lastBot = lastBots[`${baseID}_${quoteID}_${host}`]\n      let cex: CEXConfig | undefined\n      botType = botType ?? (lastBot ? lastBot.botType : botTypeArbMM)\n      if (botType !== botTypeBasicMM) {\n        // Four ways to auto-select a cex.\n        // 1. Coming back from the cex configuration form.\n        if (configuredCEX) cex = supportingCexes[configuredCEX]\n        // 2. We have a saved configuration.\n        if (!cex && lastBot) cex = supportingCexes[lastBot.cexName ?? '']\n        // 3. The last exchange that the user selected.\n        if (!cex) {\n          const lastCEX = State.fetchLocal(lastArbExchangeLK)\n          if (lastCEX) cex = supportingCexes[lastCEX]\n        }\n        // 4. Any supporting cex.\n        if (!cex && nCexes > 0) cex = Object.values(supportingCexes)[0]\n      }\n      if (cex) {\n        page.cexSelection.classList.remove('disabled')\n        this.setBotTypeSelected(botType ?? (lastBot ? lastBot.botType : botTypeArbMM))\n        this.selectFormCEX(cex.name)\n      } else {\n        page.cexSelection.classList.add('disabled')\n        Doc.show(page.noCexMarket)\n        this.setBotTypeSelected(botTypeBasicMM)\n        // If there are unconfigured cexes, show configureMore message.\n        const unconfigured = Object.keys(CEXDisplayInfos).filter((cexName: string) => !app().mmStatus.cexes[cexName])\n        const allConfigured = unconfigured.length === 0 || (unconfigured.length === 1 && (unconfigured[0] === 'Binance' || unconfigured[0] === 'BinanceUS'))\n        if (!allConfigured) Doc.show(page.noCexMarketConfigureMore)\n      }\n    }\n\n    Doc.show(page.cexSelection)\n    // Check if we have any cexes configured.\n    this.forms.show(page.botTypeForm)\n  }\n\n  reshowBotTypeForm () {\n    if (isViewOnly(this.specs, app().mmStatus)) this.showMarketSelectForm()\n    const { baseID, quoteID, host, cexName, botType } = this.specs\n    this.showBotTypeForm(host, baseID, quoteID, botType, cexName)\n  }\n\n  setBotTypeSelected (selectedType: string) {\n    const { formSpecs: { baseID, quoteID, host }, botTypeSelectors, formCexes } = this\n    for (const { classList, dataset: { botType } } of botTypeSelectors) classList.toggle('selected', botType === selectedType)\n    // If we don't have a cex selected, attempt to select one\n    if (selectedType === botTypeBasicMM) return\n    const mmStatus = app().mmStatus\n    if (Object.keys(mmStatus.cexes).length === 0) return\n    const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID)\n    // If there is one currently selected and it supports this market, leave it.\n    const selecteds = Object.values(formCexes).filter((cex: cexButton) => cex.div.classList.contains('selected'))\n    if (selecteds.length && cexHasMarket(selecteds[0].name)) return\n    // See if we have a saved configuration.\n    const lastBots = (State.fetchLocal(lastBotsLK) || {}) as Record<string, BotSpecs>\n    const lastBot = lastBots[`${baseID}_${quoteID}_${host}`]\n    if (lastBot) {\n      const cex = mmStatus.cexes[lastBot.cexName ?? '']\n      if (cex && cexHasMarket(cex.config.name)) {\n        this.selectFormCEX(cex.config.name)\n        return\n      }\n    }\n    // 2. The last exchange that the user selected.\n    const lastCEX = State.fetchLocal(lastArbExchangeLK)\n    if (lastCEX) {\n      const cex = mmStatus.cexes[lastCEX]\n      if (cex && cexHasMarket(cex.config.name)) {\n        this.selectFormCEX(cex.config.name)\n        return\n      }\n    }\n    // 3. Any supporting cex.\n    const cexes = Object.values(mmStatus.cexes).filter((cex: MMCEXStatus) => cexHasMarket(cex.config.name))\n    if (cexes.length) this.selectFormCEX(cexes[0].config.name)\n  }\n\n  showMarketSelectForm () {\n    this.page.marketFilterInput.value = ''\n    this.sortMarketRows()\n    this.forms.show(this.page.marketSelectForm)\n  }\n\n  sortMarketRows () {\n    const page = this.page\n    const filter = page.marketFilterInput.value?.toLowerCase()\n    Doc.empty(page.marketSelect)\n    for (const mr of this.marketRows) {\n      mr.tr.classList.remove('selected')\n      if (filter && !mr.name.includes(filter)) continue\n      page.marketSelect.appendChild(mr.tr)\n    }\n  }\n\n  handleBalanceNote (n: BalanceNote) {\n    this.approveTokenForm.handleBalanceNote(n)\n    if (!this.marketReport) return\n    const { baseID, quoteID, quoteToken, baseToken } = this.marketStuff()\n    if (n.assetID === baseID || n.assetID === baseToken?.parentID) {\n      this.basePane.updateBalances()\n    } else if (n.assetID === quoteID || n.assetID === quoteToken?.parentID) {\n      this.quotePane.updateBalances()\n    }\n  }\n\n  autoRebalanceChanged () {\n    const { page, updatedConfig: cfg } = this\n    cfg.cexRebalance = page.cexRebalanceCheckbox?.checked ?? false\n    this.updateAllocations()\n  }\n\n  async submitBotType () {\n    const loaded = app().loading(this.page.botTypeForm)\n    try {\n      await this.submitBotWithValidation()\n    } finally {\n      loaded()\n    }\n  }\n\n  async submitBotWithValidation () {\n    // check for wallets\n    const { page, forms, formSpecs: { baseID, quoteID, host } } = this\n\n    if (!app().walletMap[baseID]) {\n      this.newWalletForm.setAsset(baseID)\n      forms.show(this.page.newWalletForm)\n      return\n    }\n    if (!app().walletMap[quoteID]) {\n      this.newWalletForm.setAsset(quoteID)\n      forms.show(this.page.newWalletForm)\n      return\n    }\n    // Are tokens approved?\n    const [bApproval, qApproval] = tokenAssetApprovalStatuses(host, app().assets[baseID], app().assets[quoteID])\n    if (bApproval === ApprovalStatus.NotApproved) {\n      this.approveTokenForm.setAsset(baseID, host)\n      forms.show(page.approveTokenForm)\n      return\n    }\n    if (qApproval === ApprovalStatus.NotApproved) {\n      this.approveTokenForm.setAsset(quoteID, host)\n      forms.show(page.approveTokenForm)\n      return\n    }\n\n    const { botTypeSelectors } = this\n    const selecteds = botTypeSelectors.filter((div: PageElement) => div.classList.contains('selected'))\n    if (selecteds.length < 1) {\n      page.botTypeErr.textContent = intl.prep(intl.ID_NO_BOTTYPE)\n      Doc.show(page.botTypeErr)\n      return\n    }\n    const botType = this.formSpecs.botType = selecteds[0].dataset.botType ?? ''\n    if (botType !== botTypeBasicMM) {\n      const selecteds = Object.values(this.formCexes).filter((cex: cexButton) => cex.div.classList.contains('selected'))\n      if (selecteds.length < 1) {\n        page.botTypeErr.textContent = intl.prep(intl.ID_NO_CEX)\n        Doc.show(page.botTypeErr)\n        return\n      }\n      const cexName = selecteds[0].name\n      this.formSpecs.cexName = cexName\n      await this.fetchCEXBalances(this.formSpecs)\n    }\n\n    this.specs = this.formSpecs\n\n    this.configureUI()\n    this.forms.close()\n  }\n\n  async fetchCEXBalances (specs: BotSpecs) {\n    const { page } = this\n    const { baseID, quoteID, cexName, botType } = specs\n    if (botType === botTypeBasicMM || !cexName) return\n\n    try {\n      // This won't work if we implement live reconfiguration, because locked\n      // funds would need to be considered.\n      this.cexBaseBalance = await MM.cexBalance(cexName, baseID)\n    } catch (e) {\n      page.botTypeErr.textContent = intl.prep(intl.ID_CEXBALANCE_ERR, { cexName, assetID: String(baseID), err: String(e) })\n      Doc.show(page.botTypeErr)\n      throw e\n    }\n\n    try {\n      this.cexQuoteBalance = await MM.cexBalance(cexName, quoteID)\n    } catch (e) {\n      page.botTypeErr.textContent = intl.prep(intl.ID_CEXBALANCE_ERR, { cexName, assetID: String(quoteID), err: String(e) })\n      Doc.show(page.botTypeErr)\n      throw e\n    }\n  }\n\n  defaultWalletOptions (assetID: number): Record<string, string> {\n    const walletDef = app().currentWalletDefinition(assetID)\n    if (!walletDef.multifundingopts) {\n      return {}\n    }\n    const options: Record<string, string> = {}\n    for (const opt of walletDef.multifundingopts) {\n      if (opt.quoteAssetOnly && assetID !== this.specs.quoteID) {\n        continue\n      }\n      options[opt.key] = `${opt.default}`\n    }\n    return options\n  }\n\n  /*\n   * updateModifiedMarkers checks each of the input elements on the page and\n   * if the current value does not match the original value (since the last\n   * save), then the input will have a colored border.\n   */\n  updateModifiedMarkers () {\n    if (this.creatingNewBot) return\n    const { page, originalConfig: oldCfg, updatedConfig: newCfg } = this\n\n    // Gap strategy input\n    const gapStrategyModified = oldCfg.gapStrategy !== newCfg.gapStrategy\n    page.gapStrategySelect.classList.toggle('modified', gapStrategyModified)\n\n    const profitModified = oldCfg.profit !== newCfg.profit\n    page.profitInput.classList.toggle('modified', profitModified)\n\n    // Buy placements Input\n    let buyPlacementsModified = false\n    if (oldCfg.buyPlacements.length !== newCfg.buyPlacements.length) {\n      buyPlacementsModified = true\n    } else {\n      for (let i = 0; i < oldCfg.buyPlacements.length; i++) {\n        if (oldCfg.buyPlacements[i].lots !== newCfg.buyPlacements[i].lots ||\n          oldCfg.buyPlacements[i].gapFactor !== newCfg.buyPlacements[i].gapFactor) {\n          buyPlacementsModified = true\n          break\n        }\n      }\n    }\n    page.buyPlacementsTableWrapper.classList.toggle('modified', buyPlacementsModified)\n\n    // Sell placements input\n    let sellPlacementsModified = false\n    if (oldCfg.sellPlacements.length !== newCfg.sellPlacements.length) {\n      sellPlacementsModified = true\n    } else {\n      for (let i = 0; i < oldCfg.sellPlacements.length; i++) {\n        if (oldCfg.sellPlacements[i].lots !== newCfg.sellPlacements[i].lots ||\n          oldCfg.sellPlacements[i].gapFactor !== newCfg.sellPlacements[i].gapFactor) {\n          sellPlacementsModified = true\n          break\n        }\n      }\n    }\n    page.sellPlacementsTableWrapper.classList.toggle('modified', sellPlacementsModified)\n  }\n\n  /*\n   * gapFactorHeaderUnit returns the header on the placements table and the\n   * units in the gap factor rows needed for each gap strategy.\n   */\n  gapFactorHeaderUnit (gapStrategy: string): [string, string] {\n    switch (gapStrategy) {\n      case GapStrategyMultiplier:\n        return ['Multiplier', 'x']\n      case GapStrategyAbsolute:\n      case GapStrategyAbsolutePlus: {\n        const rateUnit = `${app().assets[this.specs.quoteID].symbol}/${app().assets[this.specs.baseID].symbol}`\n        return ['Rate', rateUnit]\n      }\n      case GapStrategyPercent:\n      case GapStrategyPercentPlus:\n        return ['Percent', '%']\n      default:\n        throw new Error(`Unknown gap strategy ${gapStrategy}`)\n    }\n  }\n\n  /*\n   * checkGapFactorRange returns an error string if the value input for a\n   * gap factor is valid for the currently selected gap strategy.\n   */\n  checkGapFactorRange (gapFactor: string, value: number): (string | null) {\n    switch (gapFactor) {\n      case GapStrategyMultiplier:\n        if (value < 1 || value > 100) {\n          return 'Multiplier must be between 1 and 100'\n        }\n        return null\n      case GapStrategyAbsolute:\n      case GapStrategyAbsolutePlus:\n        if (value <= 0) {\n          return 'Rate must be greater than 0'\n        }\n        return null\n      case GapStrategyPercent:\n      case GapStrategyPercentPlus:\n        if (value <= 0 || value > 10) {\n          return 'Percent must be between 0 and 10'\n        }\n        return null\n      default: {\n        throw new Error(`Unknown gap factor ${gapFactor}`)\n      }\n    }\n  }\n\n  /*\n   * convertGapFactor converts between the displayed gap factor in the\n   * placement tables and the number that is passed to the market maker.\n   * For gap strategies that involve a percentage it converts between the\n   * decimal value required by the backend and a percentage displayed to\n   * the user.\n   */\n  convertGapFactor (gapFactor: number, gapStrategy: string, toDisplay: boolean): number {\n    switch (gapStrategy) {\n      case GapStrategyMultiplier:\n      case GapStrategyAbsolute:\n      case GapStrategyAbsolutePlus:\n        return gapFactor\n      case GapStrategyPercent:\n      case GapStrategyPercentPlus:\n        if (toDisplay) {\n          return gapFactor * 100\n        }\n        return gapFactor / 100\n      default:\n        throw new Error(`Unknown gap factor ${gapStrategy}`)\n    }\n  }\n\n  /*\n   * addPlacement adds a row to a placement table. This is called both when\n   * the page is initially loaded, and when the \"add\" button is pressed on\n   * the placement table. initialLoadPlacement is non-nil if this is being\n   * called on the initial load.\n   */\n  addPlacement (isBuy: boolean, initialLoadPlacement: OrderPlacement | null, gapStrategy?: string) {\n    const { page, updatedConfig: cfg } = this\n\n    let tableBody: PageElement = page.sellPlacementsTableBody\n    let addPlacementRow: PageElement = page.addSellPlacementRow\n    let lotsElement: PageElement = page.addSellPlacementLots\n    let gapFactorElement: PageElement = page.addSellPlacementGapFactor\n    let errElement: PageElement = page.sellPlacementsErr\n    if (isBuy) {\n      tableBody = page.buyPlacementsTableBody\n      addPlacementRow = page.addBuyPlacementRow\n      lotsElement = page.addBuyPlacementLots\n      gapFactorElement = page.addBuyPlacementGapFactor\n      errElement = page.buyPlacementsErr\n    }\n\n    Doc.hide(errElement)\n\n    // updateArrowVis updates the visibility of the move up/down arrows in\n    // each row of the placement table. The up arrow is not shown on the\n    // top row, and the down arrow is not shown on the bottom row. They\n    // are all hidden if market making is running.\n    const updateArrowVis = () => {\n      for (let i = 0; i < tableBody.children.length - 1; i++) {\n        const row = Doc.parseTemplate(tableBody.children[i] as HTMLElement)\n        Doc.setVis(i !== 0, row.upBtn)\n        Doc.setVis(i !== tableBody.children.length - 2, row.downBtn)\n      }\n    }\n\n    Doc.hide(errElement)\n    const setErr = (err: string) => {\n      errElement.textContent = err\n      Doc.show(errElement)\n    }\n\n    let lots: number\n    let actualGapFactor: number\n    let displayedGapFactor: number\n    if (!gapStrategy) gapStrategy = this.specs.cexName ? GapStrategyMultiplier : cfg.gapStrategy\n    const placements = isBuy ? cfg.buyPlacements : cfg.sellPlacements\n    const unit = this.gapFactorHeaderUnit(gapStrategy)[1]\n    if (initialLoadPlacement) {\n      lots = initialLoadPlacement.lots\n      actualGapFactor = initialLoadPlacement.gapFactor\n      displayedGapFactor = this.convertGapFactor(actualGapFactor, gapStrategy, true)\n    } else {\n      lots = parseInt(lotsElement.value || '0')\n      displayedGapFactor = parseFloat(gapFactorElement.value || '0')\n      actualGapFactor = this.convertGapFactor(displayedGapFactor, gapStrategy, false)\n      if (lots === 0) {\n        setErr('Lots must be greater than 0')\n        return\n      }\n\n      const gapFactorErr = this.checkGapFactorRange(gapStrategy, displayedGapFactor)\n      if (gapFactorErr) {\n        setErr(gapFactorErr)\n        return\n      }\n\n      if (placements.find((placement) => placement.gapFactor === actualGapFactor)\n      ) {\n        setErr('Duplicate placement')\n        return\n      }\n\n      placements.push({ lots, gapFactor: actualGapFactor })\n    }\n\n    const newRow = page.placementRowTmpl.cloneNode(true) as PageElement\n    const newRowTmpl = Doc.parseTemplate(newRow)\n    newRowTmpl.priority.textContent = `${tableBody.children.length}`\n    newRowTmpl.lots.textContent = `${lots}`\n    newRowTmpl.gapFactor.textContent = `${displayedGapFactor} ${unit}`\n    Doc.bind(newRowTmpl.removeBtn, 'click', () => {\n      const index = placements.findIndex((placement) => {\n        return placement.lots === lots && placement.gapFactor === actualGapFactor\n      })\n      if (index === -1) return\n      placements.splice(index, 1)\n      newRow.remove()\n      updateArrowVis()\n      this.updateModifiedMarkers()\n      this.placementsChart.render()\n      this.updateAllocations()\n    })\n\n    Doc.bind(newRowTmpl.upBtn, 'click', () => {\n      const index = placements.findIndex((p: OrderPlacement) => p.lots === lots && p.gapFactor === actualGapFactor)\n      if (index === 0) return\n      const prevPlacement = placements[index - 1]\n      placements[index - 1] = placements[index]\n      placements[index] = prevPlacement\n      newRowTmpl.priority.textContent = `${index}`\n      newRow.remove()\n      tableBody.insertBefore(newRow, tableBody.children[index - 1])\n      const movedDownTmpl = Doc.parseTemplate(\n        tableBody.children[index] as HTMLElement\n      )\n      movedDownTmpl.priority.textContent = `${index + 1}`\n      updateArrowVis()\n      this.updateModifiedMarkers()\n    })\n\n    Doc.bind(newRowTmpl.downBtn, 'click', () => {\n      const index = placements.findIndex((p) => p.lots === lots && p.gapFactor === actualGapFactor)\n      if (index === placements.length - 1) return\n      const nextPlacement = placements[index + 1]\n      placements[index + 1] = placements[index]\n      placements[index] = nextPlacement\n      newRowTmpl.priority.textContent = `${index + 2}`\n      newRow.remove()\n      tableBody.insertBefore(newRow, tableBody.children[index + 1])\n      const movedUpTmpl = Doc.parseTemplate(\n        tableBody.children[index] as HTMLElement\n      )\n      movedUpTmpl.priority.textContent = `${index + 1}`\n      updateArrowVis()\n      this.updateModifiedMarkers()\n    })\n\n    tableBody.insertBefore(newRow, addPlacementRow)\n    updateArrowVis()\n  }\n\n  setArbMMLabels () {\n    this.page.buyGapFactorHdr.textContent = intl.prep(intl.ID_MATCH_BUFFER)\n    this.page.sellGapFactorHdr.textContent = intl.prep(intl.ID_MATCH_BUFFER)\n  }\n\n  /*\n   * setGapFactorLabels sets the headers on the gap factor column of each\n   * placement table.\n   */\n  setGapFactorLabels (gapStrategy: string) {\n    const page = this.page\n    const header = this.gapFactorHeaderUnit(gapStrategy)[0]\n    page.buyGapFactorHdr.textContent = header\n    page.sellGapFactorHdr.textContent = header\n    Doc.hide(page.percentPlusInfo, page.percentInfo, page.absolutePlusInfo, page.absoluteInfo, page.multiplierInfo)\n    switch (gapStrategy) {\n      case 'percent-plus':\n        return Doc.show(page.percentPlusInfo)\n      case 'percent':\n        return Doc.show(page.percentInfo)\n      case 'absolute-plus':\n        return Doc.show(page.absolutePlusInfo)\n      case 'absolute':\n        return Doc.show(page.absoluteInfo)\n      case 'multiplier':\n        return Doc.show(page.multiplierInfo)\n    }\n  }\n\n  clearPlacements (cacheKey: string) {\n    const { page, updatedConfig: cfg } = this\n    while (page.buyPlacementsTableBody.children.length > 1) {\n      page.buyPlacementsTableBody.children[0].remove()\n    }\n    while (page.sellPlacementsTableBody.children.length > 1) {\n      page.sellPlacementsTableBody.children[0].remove()\n    }\n    this.placementsCache[cacheKey] = [cfg.buyPlacements, cfg.sellPlacements]\n    cfg.buyPlacements.splice(0, cfg.buyPlacements.length)\n    cfg.sellPlacements.splice(0, cfg.sellPlacements.length)\n  }\n\n  loadCachedPlacements (cacheKey: string) {\n    const c = this.placementsCache[cacheKey]\n    if (!c) return\n    const { updatedConfig: cfg } = this\n    cfg.buyPlacements.splice(0, cfg.buyPlacements.length)\n    cfg.sellPlacements.splice(0, cfg.sellPlacements.length)\n    cfg.buyPlacements.push(...c[0])\n    cfg.sellPlacements.push(...c[1])\n    const gapStrategy = cacheKey === arbMMRowCacheKey ? GapStrategyMultiplier : cacheKey\n    for (const p of cfg.buyPlacements) this.addPlacement(true, p, gapStrategy)\n    for (const p of cfg.sellPlacements) this.addPlacement(false, p, gapStrategy)\n  }\n\n  /*\n   * setOriginalValues sets the updatedConfig field to be equal to the\n   * and sets the values displayed buy each field input to be equal\n   * to the values since the last save.\n   */\n  setOriginalValues () {\n    const {\n      page, originalConfig: oldCfg, updatedConfig: cfg, specs: { cexName, botType }\n    } = this\n\n    this.clearPlacements(cexName ? arbMMRowCacheKey : cfg.gapStrategy)\n\n    const assign = (to: any, from: any) => { // not recursive\n      for (const [k, v] of Object.entries(from)) {\n        if (Array.isArray(v)) {\n          to[k].splice(0, to[k].length)\n          for (const i of v) to[k].push(i)\n        } else if (typeof v === 'object') Object.assign(to[k], v)\n        else to[k] = from[k]\n      }\n    }\n    assign(cfg, JSON.parse(JSON.stringify(oldCfg)))\n\n    const tol = cfg.driftTolerance ?? defaultDriftTolerance.value\n    this.driftTolerance.setValue(tol * 100)\n    this.driftToleranceSlider.setValue(tol / defaultDriftTolerance.maxV)\n\n    const persist = cfg.orderPersistence ?? defaultOrderPersistence.value\n    this.orderPersistence.setValue(persist)\n    this.orderPersistenceSlider.setValue(persist / defaultOrderPersistence.maxV)\n\n    const profit = cfg.profit ?? defaultProfit.value\n    page.profitInput.value = String(profit * 100)\n    this.qcProfit.setValue(profit * 100)\n    this.qcProfitSlider.setValue((profit - defaultProfit.minV) / defaultProfit.range)\n\n    if (cexName) {\n      page.cexRebalanceCheckbox.checked = cfg.cexRebalance\n      this.autoRebalanceChanged()\n    }\n\n    // Gap strategy\n    if (!page.gapStrategySelect.options) return\n    Array.from(page.gapStrategySelect.options).forEach((opt: HTMLOptionElement) => { opt.selected = opt.value === cfg.gapStrategy })\n    this.setGapFactorLabels(cfg.gapStrategy)\n\n    if (botType === botTypeBasicMM) {\n      Doc.show(page.gapStrategyBox)\n      Doc.hide(page.profitSelectorBox, page.orderPersistenceBox)\n      this.setGapFactorLabels(page.gapStrategySelect.value || '')\n    } else if (cexName && app().mmStatus.cexes[cexName]) {\n      Doc.hide(page.gapStrategyBox)\n      Doc.show(page.profitSelectorBox, page.orderPersistenceBox)\n      this.setArbMMLabels()\n    }\n\n    // Buy/Sell placements\n    oldCfg.buyPlacements.forEach((p) => { this.addPlacement(true, p) })\n    oldCfg.sellPlacements.forEach((p) => { this.addPlacement(false, p) })\n\n    this.basePane.setupWalletSettings()\n    this.quotePane.setupWalletSettings()\n\n    this.updateModifiedMarkers()\n    if (Doc.isDisplayed(page.quickConfig)) this.switchToQuickConfig()\n  }\n\n  /*\n   * validateFields validates configuration values and optionally shows error\n   * messages.\n   */\n  validateFields (showErrors: boolean): boolean {\n    let ok = true\n    const {\n      page, specs: { botType },\n      updatedConfig: { sellPlacements, buyPlacements, profit }\n    } = this\n    const setError = (errEl: PageElement, errID: string) => {\n      ok = false\n      if (!showErrors) return\n      errEl.textContent = intl.prep(errID)\n      Doc.show(errEl)\n    }\n    if (showErrors) {\n      Doc.hide(\n        page.buyPlacementsErr, page.sellPlacementsErr, page.profitInputErr\n      )\n    }\n    if (botType !== botTypeBasicArb && buyPlacements.length + sellPlacements.length === 0) {\n      setError(page.buyPlacementsErr, intl.ID_NO_PLACEMENTS)\n      setError(page.sellPlacementsErr, intl.ID_NO_PLACEMENTS)\n    }\n    if (botType !== botTypeBasicMM) {\n      if (isNaN(profit)) setError(page.profitInputErr, intl.ID_INVALID_VALUE)\n      else if (profit === 0) setError(page.profitInputErr, intl.ID_NO_ZERO)\n    }\n    return ok\n  }\n\n  /*\n   * saveSettings updates the settings in the backend, and sets the originalConfig\n   * to be equal to the updatedConfig.\n   */\n  async saveSettings () {\n    // Make a copy and delete either the basic mm config or the arb-mm config,\n    // depending on whether a cex is selected.\n    if (!this.validateFields(true)) return\n    const { cfg, baseID, quoteID, host, botType, cexName } = this.marketStuff()\n\n    const botCfg: BotConfig = {\n      host: host,\n      baseID: baseID,\n      quoteID: quoteID,\n      cexName: cexName ?? '',\n      uiConfig: {\n        simpleArbLots: cfg.simpleArbLots,\n        baseConfig: cfg.baseConfig,\n        quoteConfig: cfg.quoteConfig,\n        cexRebalance: cfg.cexRebalance\n      },\n      baseWalletOptions: cfg.baseOptions,\n      quoteWalletOptions: cfg.quoteOptions\n    }\n    switch (botType) {\n      case botTypeBasicMM:\n        botCfg.basicMarketMakingConfig = this.basicMMConfig()\n        break\n      case botTypeArbMM:\n        botCfg.arbMarketMakingConfig = this.arbMMConfig()\n        break\n      case botTypeBasicArb:\n        botCfg.simpleArbConfig = this.basicArbConfig()\n    }\n\n    app().log('mm', 'saving bot config', botCfg)\n    await MM.updateBotConfig(botCfg)\n    await app().fetchMMStatus()\n    this.originalConfig = JSON.parse(JSON.stringify(cfg))\n    this.updateModifiedMarkers()\n    const lastBots = State.fetchLocal(lastBotsLK) || {}\n    lastBots[`${baseID}_${quoteID}_${host}`] = this.specs\n    State.storeLocal(lastBotsLK, lastBots)\n    if (cexName) State.storeLocal(lastArbExchangeLK, cexName)\n    app().loadPage('mm')\n  }\n\n  async delete () {\n    const { page, specs: { host, baseID, quoteID } } = this\n    Doc.hide(page.deleteErr)\n    const loaded = app().loading(page.botSettingsContainer)\n    const resp = await MM.removeBotConfig(host, baseID, quoteID)\n    loaded()\n    if (!app().checkResponse(resp)) {\n      page.deleteErr.textContent = intl.prep(intl.ID_API_ERROR, { msg: resp.msg })\n      Doc.show(page.deleteErr)\n      return\n    }\n    await app().fetchMMStatus()\n    app().loadPage('mm')\n  }\n\n  /*\n   * arbMMConfig parses the configuration for the arb-mm bot. Only one of\n   * arbMMConfig or basicMMConfig should be used when updating the bot\n   * configuration. Which is used depends on if the user has configured and\n   * selected a CEX or not.\n   */\n  arbMMConfig (): ArbMarketMakingConfig {\n    const { updatedConfig: cfg } = this\n    const arbCfg: ArbMarketMakingConfig = {\n      buyPlacements: [],\n      sellPlacements: [],\n      profit: cfg.profit,\n      driftTolerance: cfg.driftTolerance,\n      orderPersistence: cfg.orderPersistence\n    }\n    for (const p of cfg.buyPlacements) arbCfg.buyPlacements.push({ lots: p.lots, multiplier: p.gapFactor })\n    for (const p of cfg.sellPlacements) arbCfg.sellPlacements.push({ lots: p.lots, multiplier: p.gapFactor })\n    return arbCfg\n  }\n\n  basicArbConfig (): SimpleArbConfig {\n    const { updatedConfig: cfg } = this\n    const arbCfg: SimpleArbConfig = {\n      profitTrigger: cfg.profit,\n      maxActiveArbs: 100, // TODO\n      numEpochsLeaveOpen: cfg.orderPersistence\n    }\n    return arbCfg\n  }\n\n  /*\n   * basicMMConfig parses the configuration for the basic marketmaker. Only of\n   * of basidMMConfig or arbMMConfig should be used when updating the bot\n   * configuration.\n   */\n  basicMMConfig (): BasicMarketMakingConfig {\n    const { updatedConfig: cfg } = this\n    const mmCfg: BasicMarketMakingConfig = {\n      gapStrategy: cfg.gapStrategy,\n      sellPlacements: cfg.sellPlacements,\n      buyPlacements: cfg.buyPlacements,\n      driftTolerance: cfg.driftTolerance\n    }\n    return mmCfg\n  }\n\n  /*\n   * fetchOracles fetches the current oracle rates and fiat rates, and displays\n   * them on the screen.\n   */\n  async fetchMarketReport (): Promise<void> {\n    const { page, specs: { host, baseID, quoteID } } = this\n\n    const res = await MM.report(host, baseID, quoteID)\n    Doc.hide(page.oraclesLoading, page.oraclesTable, page.noOracles)\n\n    if (!app().checkResponse(res)) {\n      page.oraclesErrMsg.textContent = res.msg\n      Doc.show(page.oraclesErr)\n      return\n    }\n\n    const r = this.marketReport = res.report as MarketReport\n    if (!r.oracles || r.oracles.length === 0) {\n      Doc.show(page.noOracles)\n    } else {\n      Doc.hide(page.noOracles)\n      Doc.empty(page.oracles)\n      for (const o of r.oracles ?? []) {\n        const tr = page.oracleTmpl.cloneNode(true) as PageElement\n        page.oracles.appendChild(tr)\n        const tmpl = Doc.parseTemplate(tr)\n        tmpl.logo.src = 'img/' + o.host + '.png'\n        tmpl.host.textContent = ExchangeNames[o.host]\n        tmpl.volume.textContent = Doc.formatFourSigFigs(o.usdVol)\n        tmpl.price.textContent = Doc.formatFourSigFigs((o.bestBuy + o.bestSell) / 2)\n      }\n      page.avgPrice.textContent = r.price ? Doc.formatFourSigFigs(r.price) : '0'\n      Doc.show(page.oraclesTable)\n    }\n\n    if (r.baseFiatRate > 0) {\n      page.baseFiatRate.textContent = Doc.formatFourSigFigs(r.baseFiatRate)\n    } else {\n      page.baseFiatRate.textContent = 'N/A'\n    }\n\n    if (r.quoteFiatRate > 0) {\n      page.quoteFiatRate.textContent = Doc.formatFourSigFigs(r.quoteFiatRate)\n    } else {\n      page.quoteFiatRate.textContent = 'N/A'\n    }\n    Doc.show(page.fiatRates)\n  }\n\n  /*\n   * handleCEXSubmit handles clicks on the CEX configuration submission button.\n   */\n  async cexConfigured (cexName: string) {\n    const { page, formSpecs: { host, baseID, quoteID } } = this\n    const dinfo = CEXDisplayInfos[cexName]\n    for (const { baseID, quoteID, tmpl, arbs } of this.marketRows) {\n      if (arbs.indexOf(cexName) !== -1) continue\n      const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID)\n      if (cexHasMarket(cexName)) {\n        const img = page.arbBttnTmpl.cloneNode(true) as PageElement\n        img.src = dinfo.logo\n        tmpl.arbs.appendChild(img)\n        arbs.push(cexName)\n      }\n    }\n    this.setCEXAvailability(baseID, quoteID, cexName)\n    this.showBotTypeForm(host, baseID, quoteID, botTypeArbMM, cexName)\n  }\n\n  /*\n   * setupCEXes should be called during initialization.\n   */\n  setupCEXes () {\n    this.formCexes = {}\n    for (const name of Object.keys(CEXDisplayInfos)) this.addCEX(name)\n  }\n\n  /*\n   * setCEXAvailability sets the coloring and messaging of the CEX selection\n   * buttons.\n   */\n  setCEXAvailability (baseID: number, quoteID: number, selectedCEX?: string) {\n    const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID)\n    for (const { name, div, tmpl } of Object.values(this.formCexes)) {\n      const has = cexHasMarket(name)\n      const cexStatus = app().mmStatus.cexes[name]\n      Doc.hide(tmpl.unavailable, tmpl.needsconfig, tmpl.disconnected)\n      Doc.setVis(Boolean(cexStatus), tmpl.reconfig)\n      tmpl.logo.classList.remove('greyscal')\n      div.classList.toggle('configured', Boolean(cexStatus) && !cexStatus.connectErr)\n      if (!cexStatus) {\n        Doc.show(tmpl.needsconfig)\n      } else if (cexStatus.connectErr) {\n        Doc.show(tmpl.disconnected)\n      } else if (!has) {\n        Doc.show(tmpl.unavailable)\n        tmpl.logo.classList.add('greyscal')\n      } else if (name === selectedCEX) this.selectFormCEX(name)\n    }\n  }\n\n  selectFormCEX (cexName: string) {\n    for (const { name, div } of Object.values(this.formCexes)) {\n      div.classList.toggle('selected', name === cexName)\n    }\n  }\n\n  addCEX (cexName: string) {\n    const dinfo = CEXDisplayInfos[cexName]\n    const div = this.page.cexOptTmpl.cloneNode(true) as PageElement\n    const tmpl = Doc.parseTemplate(div)\n    tmpl.name.textContent = dinfo.name\n    tmpl.logo.src = dinfo.logo\n    this.page.cexSelection.appendChild(div)\n    this.formCexes[cexName] = { name: cexName, div, tmpl }\n    Doc.bind(div, 'click', () => {\n      const cexStatus = app().mmStatus.cexes[cexName]\n      if (!cexStatus || cexStatus.connectErr) {\n        this.showCEXConfigForm(cexName)\n        return\n      }\n      const cex = this.formCexes[cexName]\n      if (cex.div.classList.contains('selected')) { // unselect\n        for (const cex of Object.values(this.formCexes)) cex.div.classList.remove('selected')\n        const { baseID, quoteID } = this.formSpecs\n        this.setCEXAvailability(baseID, quoteID)\n        return\n      }\n      for (const cex of Object.values(this.formCexes)) cex.div.classList.toggle('selected', cex.name === cexName)\n    })\n    Doc.bind(tmpl.reconfig, 'click', (e: MouseEvent) => {\n      e.stopPropagation()\n      this.showCEXConfigForm(cexName)\n    })\n  }\n\n  showCEXConfigForm (cexName: string) {\n    const page = this.page\n    this.cexConfigForm.setCEX(cexName)\n    this.forms.show(page.cexConfigForm)\n  }\n\n  /*\n   * cexMarketSupportFilter returns a lookup CEXes that have a matching market\n   * for the currently selected base and quote assets.\n   */\n  cexMarketSupportFilter (baseID: number, quoteID: number) {\n    const cexes: Record<string, boolean> = {}\n    for (const [cexName, cexStatus] of Object.entries(app().mmStatus.cexes)) {\n      for (const { baseID: b, quoteID: q } of Object.values(cexStatus.markets ?? [])) {\n        if (b === baseID && q === quoteID) {\n          cexes[cexName] = true\n          break\n        }\n      }\n    }\n    return (cexName: string) => Boolean(cexes[cexName])\n  }\n}\n\nfunction isViewOnly (specs: BotSpecs, mmStatus: MarketMakingStatus): boolean {\n  const botStatus = mmStatus.bots.find(({ config: cfg }) => cfg.host === specs.host && cfg.baseID === specs.baseID && cfg.quoteID === specs.quoteID)\n  return Boolean(botStatus?.running)\n}\n\nconst ExchangeNames: Record<string, string> = {\n  'binance.com': 'Binance',\n  'coinbase.com': 'Coinbase',\n  'bittrex.com': 'Bittrex',\n  'hitbtc.com': 'HitBTC',\n  'exmo.com': 'EXMO'\n}\n\nfunction tokenAssetApprovalStatuses (host: string, b: SupportedAsset, q: SupportedAsset) {\n  let baseAssetApprovalStatus = ApprovalStatus.Approved\n  let quoteAssetApprovalStatus = ApprovalStatus.Approved\n\n  if (b?.token) {\n    const baseAsset = app().assets[b.id]\n    const baseVersion = app().exchanges[host].assets[b.id].version\n    if (baseAsset?.wallet?.approved && baseAsset.wallet.approved[baseVersion] !== undefined) {\n      baseAssetApprovalStatus = baseAsset.wallet.approved[baseVersion]\n    }\n  }\n  if (q?.token) {\n    const quoteAsset = app().assets[q.id]\n    const quoteVersion = app().exchanges[host].assets[q.id].version\n    if (quoteAsset?.wallet?.approved && quoteAsset.wallet.approved[quoteVersion] !== undefined) {\n      quoteAssetApprovalStatus = quoteAsset.wallet.approved[quoteVersion]\n    }\n  }\n\n  return [\n    baseAssetApprovalStatus,\n    quoteAssetApprovalStatus\n  ]\n}\n\nclass AssetPane {\n  pg: MarketMakerSettingsPage\n  div: PageElement\n  page: Record<string, PageElement>\n  assetID: number\n  ui: UnitInfo\n  walletConfig: Record<string, string>\n  feeAssetID: number\n  feeUI: UnitInfo\n  isQuote: boolean\n  isToken: boolean\n  lotSize: number // might be quote converted\n  lotSizeConv: number\n  cfg: BotAssetConfig\n  inv: ProjectedAlloc\n  nSwapFees: IncrementalInput\n  nSwapFeesSlider: MiniSlider\n  orderReserves: NumberInput\n  orderReservesSlider: MiniSlider\n  slippageBuffer: NumberInput\n  slippageBufferSlider: MiniSlider\n  minTransfer: NumberInput\n  minTransferSlider: MiniSlider\n\n  constructor (pg: MarketMakerSettingsPage, div: PageElement) {\n    this.pg = pg\n    this.div = div\n    const page = this.page = Doc.parseTemplate(div)\n\n    this.nSwapFees = new IncrementalInput(page.nSwapFees, {\n      prec: defaultSwapReserves.prec,\n      inc: defaultSwapReserves.inc,\n      changed: (v: number) => {\n        const { minR, range } = defaultSwapReserves\n        this.cfg.swapFeeN = v\n        this.nSwapFeesSlider.setValue((v - minR) / range)\n        this.pg.updateAllocations()\n      }\n    })\n\n    this.nSwapFeesSlider = new MiniSlider(page.nSwapFeesSlider, (r: number) => {\n      const { minR, range, prec } = defaultSwapReserves\n      const [v] = toPrecision(minR + r * range, prec)\n      this.cfg.swapFeeN = v\n      this.nSwapFees.setValue(v)\n      this.pg.updateAllocations()\n    })\n    this.orderReserves = new NumberInput(page.orderReservesFactor, {\n      prec: defaultOrderReserves.prec,\n      min: 0,\n      changed: (v: number) => {\n        const { minR, range } = defaultOrderReserves\n        this.cfg.orderReservesFactor = v\n        this.orderReservesSlider.setValue((v - minR) / range)\n        this.pg.updateAllocations()\n      }\n    })\n    this.orderReservesSlider = new MiniSlider(page.orderReservesSlider, (r: number) => {\n      const { minR, range, prec } = defaultOrderReserves\n      const [v] = toPrecision(minR + r * range, prec)\n      this.orderReserves.setValue(v)\n      this.cfg.orderReservesFactor = v\n      this.pg.updateAllocations()\n    })\n    this.slippageBuffer = new NumberInput(page.slippageBufferFactor, {\n      prec: defaultSlippage.prec,\n      min: 0,\n      changed: (v: number) => {\n        const { minR, range } = defaultSlippage\n        this.cfg.slippageBufferFactor = v\n        this.slippageBufferSlider.setValue((v - minR) / range)\n        this.pg.updateAllocations()\n      }\n    })\n    this.slippageBufferSlider = new MiniSlider(page.slippageBufferSlider, (r: number) => {\n      const { minR, range, prec } = defaultSlippage\n      const [v] = toPrecision(minR + r * range, prec)\n      this.slippageBuffer.setValue(minR + r * range)\n      this.cfg.slippageBufferFactor = v\n      this.pg.updateAllocations()\n    })\n    this.minTransfer = new NumberInput(page.minTransfer, {\n      sigFigs: true,\n      min: 0,\n      changed: (v: number) => {\n        const { cfg } = this\n        const totalInventory = this.commit()\n        const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min * 2, totalInventory)]\n        cfg.transferFactor = (v - minV) / (maxV - minV)\n        this.minTransferSlider.setValue(cfg.transferFactor)\n      }\n    })\n    this.minTransferSlider = new MiniSlider(page.minTransferSlider, (r: number) => {\n      const { cfg } = this\n      const totalInventory = this.commit()\n      const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min, totalInventory)]\n      cfg.transferFactor = r\n      this.minTransfer.setValue(minV + r * (maxV - minV))\n    })\n\n    Doc.bind(page.showBalance, 'click', () => { pg.showAddress(this.assetID) })\n  }\n\n  // lot size can change if this is the quote asset, keep it updated.\n  setLotSize (lotSize: number) {\n    const { ui } = this\n    this.lotSize = lotSize\n    this.lotSizeConv = lotSize / ui.conventional.conversionFactor\n  }\n\n  setAsset (assetID: number, isQuote: boolean) {\n    this.assetID = assetID\n    this.isQuote = isQuote\n    const cfg = this.cfg = isQuote ? this.pg.updatedConfig.quoteConfig : this.pg.updatedConfig.baseConfig\n    const { page, div, pg: { specs: { botType, baseID, cexName }, mktID, updatedConfig: { baseOptions, quoteOptions } } } = this\n    const { symbol, name, token, unitInfo: ui } = app().assets[assetID]\n    this.ui = ui\n    this.walletConfig = assetID === baseID ? baseOptions : quoteOptions\n    const { conventional: { unit: ticker } } = ui\n    this.feeAssetID = token ? token.parentID : assetID\n    const { unitInfo: feeUI, name: feeName, symbol: feeSymbol } = app().assets[this.feeAssetID]\n    this.feeUI = feeUI\n    this.inv = { book: 0, bookingFees: 0, swapFeeReserves: 0, cex: 0, orderReserves: 0, slippageBuffer: 0 }\n    this.isToken = Boolean(token)\n    Doc.setVis(this.isToken, page.feeTotalBox, page.feeReservesBox, page.feeBalances)\n    Doc.setVis(isQuote, page.slippageBufferBox)\n    Doc.setSrc(div, '[data-logo]', Doc.logoPath(symbol))\n    Doc.setText(div, '[data-name]', name)\n    Doc.setText(div, '[data-ticker]', ticker)\n    const { conventional: { unit: feeTicker } } = feeUI\n    Doc.setText(div, '[data-fee-ticker]', feeTicker)\n    Doc.setText(div, '[data-fee-name]', feeName)\n    Doc.setSrc(div, '[data-fee-logo]', Doc.logoPath(feeSymbol))\n    Doc.setVis(botType !== botTypeBasicMM, page.cexMinInvBox)\n    Doc.setVis(botType !== botTypeBasicArb, page.orderReservesBox)\n    this.nSwapFees.setValue(cfg.swapFeeN ?? defaultSwapReserves.n)\n    this.nSwapFeesSlider.setValue(cfg.swapFeeN / defaultSwapReserves.maxR)\n    if (botType !== botTypeBasicArb) {\n      const [v] = toPrecision(cfg.orderReservesFactor ?? defaultOrderReserves.factor, defaultOrderReserves.prec)\n      this.orderReserves.setValue(v)\n      this.orderReservesSlider.setValue((v - defaultOrderReserves.minR) / defaultOrderReserves.range)\n    }\n    if (botType !== botTypeBasicMM) {\n      this.minTransfer.prec = Math.log10(ui.conventional.conversionFactor)\n      const mkt = app().mmStatus.cexes[cexName as string].markets[mktID]\n      this.minTransfer.min = ((isQuote ? mkt.quoteMinWithdraw : mkt.baseMinWithdraw) / ui.conventional.conversionFactor)\n    }\n    this.slippageBuffer.setValue(cfg.slippageBufferFactor)\n    const { minR, range } = defaultSlippage\n    this.slippageBufferSlider.setValue((cfg.slippageBufferFactor - minR) / range)\n    this.setupWalletSettings()\n    this.updateBalances()\n  }\n\n  commit () {\n    const { inv, isToken } = this\n    let commit = inv.book + inv.cex + inv.orderReserves + inv.slippageBuffer\n    if (!isToken) commit += inv.bookingFees + inv.swapFeeReserves\n    return commit\n  }\n\n  updateInventory (lots: number, counterLots: number, lotSize: number, dexCommit: number, cexCommit: number, fees: AssetBookingFees) {\n    this.setLotSize(lotSize)\n    const { page, cfg, lotSizeConv, inv, ui, feeUI, isToken, isQuote, pg: { specs: { cexName, botType } } } = this\n    page.bookLots.textContent = String(lots)\n    page.bookLotSize.textContent = Doc.formatFourSigFigs(lotSizeConv)\n    inv.book = lots * lotSizeConv\n    page.bookCommitment.textContent = Doc.formatFourSigFigs(inv.book)\n    const feesPerLotConv = fees.bookingFeesPerLot / feeUI.conventional.conversionFactor\n    page.bookingFeesPerLot.textContent = Doc.formatFourSigFigs(feesPerLotConv)\n    page.swapReservesFactor.textContent = fees.swapReservesFactor.toFixed(2)\n    page.bookingFeesLots.textContent = String(lots)\n    inv.bookingFees = fees.bookingFees / feeUI.conventional.conversionFactor\n    page.bookingFees.textContent = Doc.formatFourSigFigs(inv.bookingFees)\n    if (cexName) {\n      inv.cex = cexCommit / ui.conventional.conversionFactor\n      page.cexMinInv.textContent = Doc.formatFourSigFigs(inv.cex)\n    }\n    if (botType !== botTypeBasicArb) {\n      const totalInventory = Math.max(cexCommit, dexCommit) / ui.conventional.conversionFactor\n      page.orderReservesBasis.textContent = Doc.formatFourSigFigs(totalInventory)\n      const orderReserves = totalInventory * cfg.orderReservesFactor\n      inv.orderReserves = orderReserves\n      page.orderReserves.textContent = Doc.formatFourSigFigs(orderReserves)\n    }\n    if (isToken) {\n      const feesPerSwapConv = fees.tokenFeesPerSwap / feeUI.conventional.conversionFactor\n      page.feeReservesPerSwap.textContent = Doc.formatFourSigFigs(feesPerSwapConv)\n      inv.swapFeeReserves = feesPerSwapConv * cfg.swapFeeN\n      page.feeReserves.textContent = Doc.formatFourSigFigs(inv.swapFeeReserves)\n    }\n    if (isQuote) {\n      const basis = inv.book + inv.cex + inv.orderReserves\n      page.slippageBufferBasis.textContent = Doc.formatCoinValue(basis * ui.conventional.conversionFactor, ui)\n      inv.slippageBuffer = basis * cfg.slippageBufferFactor\n      page.slippageBuffer.textContent = Doc.formatCoinValue(inv.slippageBuffer * ui.conventional.conversionFactor, ui)\n    }\n    Doc.setVis(fees.bookingFeesPerCounterLot > 0, page.redemptionFeesBox)\n    if (fees.bookingFeesPerCounterLot > 0) {\n      const feesPerLotConv = fees.bookingFeesPerCounterLot / feeUI.conventional.conversionFactor\n      page.redemptionFeesPerLot.textContent = Doc.formatFourSigFigs(feesPerLotConv)\n      page.redemptionFeesLots.textContent = String(counterLots)\n      page.redeemReservesFactor.textContent = fees.redeemReservesFactor.toFixed(2)\n    }\n    this.updateCommitTotal()\n    this.updateTokenFees()\n    this.updateRebalance()\n  }\n\n  updateCommitTotal () {\n    const { page, assetID, ui } = this\n    const commit = this.commit()\n    page.commitTotal.textContent = Doc.formatCoinValue(Math.round(commit * ui.conventional.conversionFactor), ui)\n    page.commitTotalFiat.textContent = Doc.formatFourSigFigs(commit * app().fiatRatesMap[assetID])\n  }\n\n  updateTokenFees () {\n    const { page, inv, feeAssetID, feeUI, isToken } = this\n    if (!isToken) return\n    const feeReserves = inv.bookingFees + inv.swapFeeReserves\n    page.feeTotal.textContent = Doc.formatCoinValue(feeReserves * feeUI.conventional.conversionFactor, feeUI)\n    page.feeTotalFiat.textContent = Doc.formatFourSigFigs(feeReserves * app().fiatRatesMap[feeAssetID])\n  }\n\n  updateRebalance () {\n    const { page, cfg, pg: { updatedConfig: { cexRebalance }, specs: { cexName } } } = this\n    const showRebalance = cexName && cexRebalance\n    Doc.setVis(showRebalance, page.rebalanceOpts)\n    if (!showRebalance) return\n    const totalInventory = this.commit()\n    const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min * 2, totalInventory)]\n    const rangeV = maxV - minV\n    this.minTransfer.setValue(minV + cfg.transferFactor * rangeV)\n    this.minTransferSlider.setValue((cfg.transferFactor - defaultTransfer.minR) / defaultTransfer.range)\n  }\n\n  setupWalletSettings () {\n    const { page, assetID, walletConfig } = this\n    const walletSettings = app().currentWalletDefinition(assetID)\n    Doc.empty(page.walletSettings)\n    Doc.setVis(!walletSettings.multifundingopts, page.walletSettingsNone)\n    if (!walletSettings.multifundingopts) return\n    const optToDiv: Record<string, PageElement> = {}\n    const dependentOpts: Record<string, string[]> = {}\n    const addDependentOpt = (optKey: string, optSetting: PageElement, dependentOn: string) => {\n      if (!dependentOpts[dependentOn]) dependentOpts[dependentOn] = []\n      dependentOpts[dependentOn].push(optKey)\n      optToDiv[optKey] = optSetting\n    }\n    const setDependentOptsVis = (parentOptKey: string, vis: boolean) => {\n      const optKeys = dependentOpts[parentOptKey]\n      if (!optKeys) return\n      for (const optKey of optKeys) Doc.setVis(vis, optToDiv[optKey])\n    }\n    const addOpt = (opt: OrderOption) => {\n      if (opt.quoteAssetOnly && !this.isQuote) return\n      const currVal = walletConfig[opt.key]\n      let div: PageElement | undefined\n      if (opt.isboolean) {\n        div = page.boolSettingTmpl.cloneNode(true) as PageElement\n        const tmpl = Doc.parseTemplate(div)\n        tmpl.name.textContent = opt.displayname\n        tmpl.input.checked = currVal === 'true'\n        Doc.bind(tmpl.input, 'change', () => {\n          walletConfig[opt.key] = tmpl.input.checked ? 'true' : 'false'\n          setDependentOptsVis(opt.key, Boolean(tmpl.input.checked))\n        })\n        if (opt.description) tmpl.tooltip.dataset.tooltip = opt.description\n      } else if (opt.xyRange) {\n        const { start, end, xUnit } = opt.xyRange\n        const range = end.x - start.x\n        div = page.rangeSettingTmpl.cloneNode(true) as PageElement\n        const tmpl = Doc.parseTemplate(div)\n        tmpl.name.textContent = opt.displayname\n        if (opt.description) tmpl.tooltip.dataset.tooltip = opt.description\n        if (xUnit) tmpl.unit.textContent = xUnit\n        else Doc.hide(tmpl.unit)\n\n        const input = new NumberInput(tmpl.value, {\n          prec: 1,\n          changed: (rawV: number) => {\n            const [v, s] = toFourSigFigs(rawV, 1)\n            walletConfig[opt.key] = s\n            slider.setValue((v - start.x) / range)\n          }\n        })\n        const slider = new MiniSlider(tmpl.slider, (r: number) => {\n          const rawV = start.x + r * range\n          const [v, s] = toFourSigFigs(rawV, 1)\n          walletConfig[opt.key] = s\n          input.setValue(v)\n        })\n        // TODO: default value should be smaller or none for base asset.\n        const [v, s] = toFourSigFigs(parseFloatDefault(currVal, start.x), 3)\n        walletConfig[opt.key] = s\n        slider.setValue((v - start.x) / range)\n        input.setValue(v)\n        tmpl.value.textContent = s\n      }\n      if (!div) return console.error(\"don't know how to handle opt\", opt)\n      page.walletSettings.appendChild(div)\n      if (opt.dependsOn) {\n        addDependentOpt(opt.key, div, opt.dependsOn)\n        const parentOptVal = walletConfig[opt.dependsOn]\n        Doc.setVis(parentOptVal === 'true', div)\n      }\n    }\n\n    if (walletSettings.multifundingopts && walletSettings.multifundingopts.length > 0) {\n      for (const opt of walletSettings.multifundingopts) addOpt(opt)\n    }\n    app().bindTooltips(page.walletSettings)\n  }\n\n  updateBalances () {\n    const { page, assetID, ui, feeAssetID, feeUI, pg: { specs: { cexName, baseID }, cexBaseBalance, cexQuoteBalance } } = this\n    const { balance: { available } } = app().walletMap[assetID]\n    const botInv = this.pg.runningBotInventory(assetID)\n    const dexAvail = available - botInv.dex.total\n    let cexAvail = 0\n    Doc.setVis(cexName, page.balanceBreakdown)\n    if (cexName) {\n      page.dexAvail.textContent = Doc.formatFourSigFigs(dexAvail / ui.conventional.conversionFactor)\n      const { available: cexRawAvail } = assetID === baseID ? cexBaseBalance : cexQuoteBalance\n      cexAvail = cexRawAvail - botInv.cex.total\n      page.cexAvail.textContent = Doc.formatFourSigFigs(cexAvail / ui.conventional.conversionFactor)\n    }\n    page.avail.textContent = Doc.formatFourSigFigs((dexAvail + cexAvail) / ui.conventional.conversionFactor)\n    if (assetID === feeAssetID) return\n    const { balance: { available: feeAvail } } = app().walletMap[feeAssetID]\n    page.feeAvail.textContent = Doc.formatFourSigFigs(feeAvail / feeUI.conventional.conversionFactor)\n  }\n}\n","import Doc, { Animation, AniToggle } from './doc'\nimport BasePage from './basepage'\nimport { postJSON } from './http'\nimport * as forms from './forms'\nimport * as intl from './locales'\nimport { ReputationMeter, strongTier } from './account'\nimport {\n  app,\n  PageElement,\n  ConnectionStatus,\n  Exchange,\n  WalletState,\n  PrepaidBondID\n} from './registry'\n\ninterface Animator {\n  animate: (() => Promise<void>)\n}\n\ninterface BondOptionsForm {\n  host?: string // Required, but set by updateBondOptions\n  bondAssetID?: number\n  targetTier?: number\n  penaltyComps?: number\n}\n\nconst animationLength = 300\n\nexport default class DexSettingsPage extends BasePage {\n  body: HTMLElement\n  forms: PageElement[]\n  currentForm: PageElement\n  page: Record<string, PageElement>\n  host: string\n  accountDisabled:boolean\n  keyup: (e: KeyboardEvent) => void\n  dexAddrForm: forms.DEXAddressForm\n  bondFeeBufferCache: Record<string, number>\n  newWalletForm: forms.NewWalletForm\n  regAssetForm: forms.FeeAssetSelectionForm\n  walletWaitForm: forms.WalletWaitForm\n  confirmRegisterForm: forms.ConfirmRegistrationForm\n  reputationMeter: ReputationMeter\n  animation: Animation\n  renewToggle: AniToggle\n\n  constructor (body: HTMLElement) {\n    super()\n    this.body = body\n    const host = this.host = body.dataset.host ? body.dataset.host : ''\n    const xc = app().exchanges[host]\n    const page = this.page = Doc.idDescendants(body)\n    this.forms = Doc.applySelector(page.forms, ':scope > form')\n\n    this.confirmRegisterForm = new forms.ConfirmRegistrationForm(page.confirmRegForm, async () => {\n      this.showSuccess(intl.prep(intl.ID_TRADING_TIER_UPDATED))\n      this.renewToggle.setState(this.confirmRegisterForm.tier > 0)\n      await app().fetchUser()\n      app().updateMenuItemsDisplay()\n    }, () => {\n      this.runAnimation(this.regAssetForm, page.regAssetForm)\n    })\n    this.confirmRegisterForm.setExchange(xc, '')\n\n    this.walletWaitForm = new forms.WalletWaitForm(page.walletWait, () => {\n      this.runAnimation(this.confirmRegisterForm, page.confirmRegForm)\n    }, () => {\n      this.runAnimation(this.regAssetForm, page.regAssetForm)\n    })\n    this.walletWaitForm.setExchange(xc)\n\n    this.newWalletForm = new forms.NewWalletForm(\n      page.newWalletForm,\n      assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier),\n      () => this.runAnimation(this.regAssetForm, page.regAssetForm)\n    )\n\n    this.regAssetForm = new forms.FeeAssetSelectionForm(page.regAssetForm, async (assetID: number, tier: number) => {\n      if (assetID === PrepaidBondID) {\n        await app().fetchUser()\n        this.updateReputation()\n        this.showSuccess(intl.prep(intl.ID_TRADING_TIER_UPDATED))\n        return\n      }\n      const asset = app().assets[assetID]\n      const wallet = asset.wallet\n      if (wallet) {\n        const loaded = app().loading(page.regAssetForm)\n        const bondsFeeBuffer = await this.getBondsFeeBuffer(assetID, page.regAssetForm)\n        this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer)\n        loaded()\n        this.progressTierFormsWithWallet(assetID, wallet)\n        return\n      }\n      this.confirmRegisterForm.setAsset(assetID, tier, 0)\n      this.newWalletForm.setAsset(assetID)\n      this.showForm(page.newWalletForm)\n    })\n    this.regAssetForm.setExchange(xc, '')\n\n    this.reputationMeter = new ReputationMeter(page.repMeter)\n    this.reputationMeter.setHost(host)\n\n    Doc.bind(page.exportDexBtn, 'click', () => this.exportAccount())\n\n    this.accountDisabled = body.dataset.disabled === 'true'\n    Doc.bind(page.toggleAccountStatusBtn, 'click', () => {\n      if (!this.accountDisabled) this.prepareAccountDisable(page.disableAccountForm)\n      else this.toggleAccountStatus(false)\n    })\n    Doc.bind(page.updateCertBtn, 'click', () => page.certFileInput.click())\n    Doc.bind(page.updateHostBtn, 'click', () => this.prepareUpdateHost())\n    Doc.bind(page.certFileInput, 'change', () => this.onCertFileChange())\n    Doc.bind(page.goBackToSettings, 'click', () => app().loadPage('settings'))\n\n    const showTierForm = () => {\n      this.regAssetForm.setExchange(app().exchanges[host], '') // reset form\n      this.showForm(page.regAssetForm)\n    }\n    Doc.bind(page.changeTier, 'click', () => { showTierForm() })\n    const willAutoRenew = xc.auth.targetTier > 0\n    this.renewToggle = new AniToggle(page.toggleAutoRenew, page.renewErr, willAutoRenew, async (newState: boolean) => {\n      if (this.accountDisabled) return\n      if (newState) showTierForm()\n      else return this.disableAutoRenew()\n    })\n    Doc.bind(page.autoRenewBox, 'click', (e: MouseEvent) => {\n      e.stopPropagation()\n      if (!this.accountDisabled) page.toggleAutoRenew.click()\n    })\n\n    page.penaltyComps.textContent = String(xc.auth.penaltyComps)\n    const hideCompInput = () => {\n      Doc.hide(page.penaltyCompInput)\n      Doc.show(page.penaltyComps)\n    }\n    Doc.bind(page.penaltyCompBox, 'click', (e: MouseEvent) => {\n      e.stopPropagation()\n      const xc = app().exchanges[this.host]\n      page.penaltyCompInput.value = String(xc.auth.penaltyComps)\n      Doc.hide(page.penaltyComps)\n      Doc.show(page.penaltyCompInput)\n      page.penaltyCompInput.focus()\n      const checkClick = (e: MouseEvent) => {\n        if (Doc.mouseInElement(e, page.penaltyCompBox)) return\n        hideCompInput()\n        Doc.unbind(document, 'click', checkClick)\n      }\n      Doc.bind(document, 'click', checkClick)\n    })\n\n    Doc.bind(page.penaltyCompInput, 'keyup', async (e: KeyboardEvent) => {\n      Doc.hide(page.penaltyCompsErr)\n      if (e.key === 'Escape') {\n        hideCompInput()\n        return\n      }\n      if (!(e.key === 'Enter')) return\n      const penaltyComps = parseInt(page.penaltyCompInput.value || '')\n      if (isNaN(penaltyComps)) {\n        Doc.show(page.penaltyCompsErr)\n        page.penaltyCompsErr.textContent = intl.prep(intl.ID_INVALID_COMPS_VALUE)\n        return\n      }\n      const loaded = app().loading(page.otherBondSettings)\n      try {\n        await this.updateBondOptions({ penaltyComps })\n        loaded()\n        page.penaltyComps.textContent = String(penaltyComps)\n      } catch (e) {\n        loaded()\n        Doc.show(page.penaltyCompsErr)\n        page.penaltyCompsErr.textContent = intl.prep(intl.ID_API_ERROR, { msg: e.msg })\n      }\n      hideCompInput()\n    })\n\n    this.dexAddrForm = new forms.DEXAddressForm(page.dexAddrForm, async (xc: Exchange) => {\n      app().loadPage(`/dexsettings/${xc.host}`)\n    }, this.host)\n\n    // forms.bind(page.bondDetailsForm, page.updateBondOptionsConfirm, () => this.updateBondOptions())\n    forms.bind(page.disableAccountForm, page.disableAccountConfirm, () => this.toggleAccountStatus(true))\n\n    Doc.bind(page.forms, 'mousedown', (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, this.currentForm)) { this.closePopups() }\n    })\n\n    this.keyup = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        this.closePopups()\n      }\n    }\n    Doc.bind(document, 'keyup', this.keyup)\n\n    Doc.applySelector(page.forms, '.form-closer').forEach(el => {\n      Doc.bind(el, 'click', () => { this.closePopups() })\n    })\n\n    app().registerNoteFeeder({\n      conn: () => { this.setConnectionStatus() },\n      reputation: () => { this.updateReputation() },\n      feepayment: () => { this.updateReputation() },\n      bondpost: () => { this.updateReputation() }\n    })\n\n    this.setConnectionStatus()\n    this.updateReputation()\n  }\n\n  unload () {\n    Doc.unbind(document, 'keyup', this.keyup)\n  }\n\n  async progressTierFormsWithWallet (assetID: number, wallet: WalletState) {\n    const { page, confirmRegisterForm: { fees } } = this\n    const asset = app().assets[assetID]\n    const { bondAssets } = this.regAssetForm.xc\n    const bondAsset = bondAssets[asset.symbol]\n    if (!wallet.open) {\n      const loaded = app().loading(page.forms)\n      const res = await postJSON('/api/openwallet', { assetID: assetID })\n      loaded()\n      if (!app().checkResponse(res)) {\n        this.regAssetForm.setAssetError(`error unlocking wallet: ${res.msg}`)\n        this.runAnimation(this.regAssetForm, page.regAssetForm)\n      }\n      return\n    }\n    if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + fees) {\n      // If we are raising our tier, we'll show a confirmation form\n      this.progressTierFormWithSyncedFundedWallet(assetID)\n      return\n    }\n    this.walletWaitForm.setWallet(assetID, fees, this.confirmRegisterForm.tier)\n    this.showForm(page.walletWait)\n  }\n\n  async progressTierFormWithSyncedFundedWallet (bondAssetID: number) {\n    const xc = app().exchanges[this.host]\n    const targetTier = this.confirmRegisterForm.tier\n    const page = this.page\n    const strongTier = xc.auth.liveStrength + xc.auth.pendingStrength - xc.auth.weakStrength\n    if (targetTier > xc.auth.targetTier && targetTier > strongTier) {\n      this.runAnimation(this.confirmRegisterForm, page.confirmRegForm)\n      return\n    }\n    // Lowering tier\n    const loaded = app().loading(this.body)\n    try {\n      await this.updateBondOptions({ bondAssetID, targetTier })\n      loaded()\n    } catch (e) {\n      loaded()\n      this.regAssetForm.setTierError(e.msg)\n      return\n    }\n    // this.animateConfirmForm(page.regAssetForm)\n    this.showSuccess(intl.prep(intl.ID_TRADING_TIER_UPDATED))\n  }\n\n  updateReputation () {\n    const page = this.page\n    const auth = app().exchanges[this.host].auth\n    const { rep: { penalties }, targetTier, expiredBonds } = auth\n    const displayTier = strongTier(auth)\n    page.targetTier.textContent = String(targetTier)\n    page.effectiveTier.textContent = String(displayTier)\n    page.penalties.textContent = String(penalties)\n    page.bondsPendingRefund.textContent = `${expiredBonds?.length || 0}`\n    this.reputationMeter.update()\n  }\n\n  /* showForm shows a modal form with a little animation. */\n  async showForm (form: HTMLElement) {\n    const page = this.page\n    this.currentForm = form\n    this.forms.forEach(form => Doc.hide(form))\n    form.style.right = '10000px'\n    Doc.show(page.forms, form)\n    const shift = (page.forms.offsetWidth + form.offsetWidth) / 2\n    await Doc.animate(animationLength, progress => {\n      form.style.right = `${(1 - progress) * shift}px`\n    }, 'easeOutHard')\n    form.style.right = '0'\n  }\n\n  async runAnimation (ani: Animator, form: PageElement) {\n    Doc.hide(this.currentForm)\n    await ani.animate()\n    this.currentForm = form\n    Doc.show(form)\n  }\n\n  closePopups () {\n    Doc.hide(this.page.forms)\n    if (this.animation) this.animation.stop()\n  }\n\n  async showSuccess (msg: string) {\n    this.forms.forEach(form => Doc.hide(form))\n    this.currentForm = this.page.checkmarkForm\n    this.animation = forms.showSuccess(this.page, msg)\n    await this.animation.wait()\n    this.animation = new Animation(1500, () => { /* pass */ }, '', () => {\n      if (this.currentForm === this.page.checkmarkForm) this.closePopups()\n    })\n  }\n\n  // exportAccount exports and downloads the account info.\n  async exportAccount () {\n    const { page, host } = this\n    const req = { host }\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/exportaccount', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.exportAccountErr.textContent = res.msg\n      Doc.show(page.exportAccountErr)\n      return\n    }\n    res.account.bonds = res.bonds // maintain backward compat of JSON file\n    const accountForExport = JSON.parse(JSON.stringify(res.account))\n    const a = document.createElement('a')\n    a.setAttribute('download', 'dcrAccount-' + host + '.json')\n    a.setAttribute('href', 'data:text/json,' + JSON.stringify(accountForExport, null, 2))\n    a.click()\n    Doc.hide(page.forms)\n  }\n\n  // toggleAccountStatus enables or disables the account associated with the\n  // provided host.\n  async toggleAccountStatus (disable:boolean) {\n    const page = this.page\n    Doc.hide(page.errMsg)\n    let host: string|null = this.host\n    if (disable) host = page.disableAccountHost.textContent\n    const req = { host, disable: disable }\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/toggleaccountstatus', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      if (disable) {\n        page.disableAccountErr.textContent = res.msg\n        Doc.show(page.disableAccountErr)\n      } else {\n        page.errMsg.textContent = res.msg\n        Doc.show(page.errMsg)\n      }\n      return\n    }\n    if (disable) {\n      this.page.toggleAccountStatusBtn.textContent = intl.prep(intl.ID_ENABLE_ACCOUNT)\n      Doc.hide(page.forms)\n    } else this.page.toggleAccountStatusBtn.textContent = intl.prep(intl.ID_DISABLE_ACCOUNT)\n\n    this.accountDisabled = disable\n\n    // Refresh exchange information since we've just enabled/disabled the\n    // exchange.\n    await app().fetchUser()\n    app().loadPage(`dexsettings/${host}`)\n  }\n\n  async prepareAccountDisable (disableAccountForm: HTMLElement) {\n    const page = this.page\n    page.disableAccountHost.textContent = this.host\n    page.disableAccountErr.textContent = ''\n    this.showForm(disableAccountForm)\n  }\n\n  // Retrieve an estimate for the tx fee needed to create new bond reserves.\n  async getBondsFeeBuffer (assetID: number, form: HTMLElement) {\n    const loaded = app().loading(form)\n    const res = await postJSON('/api/bondsfeebuffer', { assetID })\n    loaded()\n    if (!app().checkResponse(res)) {\n      return 0\n    }\n    return res.feeBuffer\n  }\n\n  async prepareUpdateHost () {\n    const page = this.page\n    this.dexAddrForm.refresh()\n    this.showForm(page.dexAddrForm)\n  }\n\n  async onCertFileChange () {\n    const page = this.page\n    Doc.hide(page.errMsg)\n    const files = page.certFileInput.files\n    let cert\n    if (files && files.length) cert = await files[0].text()\n    if (!cert) return\n    const req = { host: this.host, cert: cert }\n    const loaded = app().loading(this.body)\n    const res = await postJSON('/api/updatecert', req)\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.errMsg.textContent = res.msg\n      Doc.show(page.errMsg)\n    } else {\n      Doc.show(page.updateCertMsg)\n      setTimeout(() => { Doc.hide(page.updateCertMsg) }, 5000)\n    }\n  }\n\n  setConnectionStatus () {\n    const page = this.page\n    const exchange = app().user.exchanges[this.host]\n    const displayIcons = (connected: boolean) => {\n      if (connected) {\n        Doc.hide(page.disconnectedIcon)\n        Doc.show(page.connectedIcon)\n      } else {\n        Doc.show(page.disconnectedIcon)\n        Doc.hide(page.connectedIcon)\n      }\n    }\n    if (exchange) {\n      switch (exchange.connectionStatus) {\n        case ConnectionStatus.Connected:\n          displayIcons(true)\n          page.connectionStatus.textContent = intl.prep(intl.ID_CONNECTED)\n          break\n        case ConnectionStatus.Disconnected:\n          displayIcons(false)\n          if (this.accountDisabled) page.connectionStatus.textContent = intl.prep(intl.ID_ACCOUNT_DISABLED_MSG)\n          else page.connectionStatus.textContent = intl.prep(intl.ID_DISCONNECTED)\n          break\n        case ConnectionStatus.InvalidCert:\n          displayIcons(false)\n          page.connectionStatus.textContent = `${intl.prep(intl.ID_DISCONNECTED)} - ${intl.prep(intl.ID_INVALID_CERTIFICATE)}`\n      }\n    }\n  }\n\n  async disableAutoRenew () {\n    const loaded = app().loading(this.page.otherBondSettings)\n    try {\n      this.updateBondOptions({ targetTier: 0 })\n      loaded()\n    } catch (e) {\n      loaded()\n      throw e\n    }\n  }\n\n  /*\n   * updateBondOptions is called when the form to update bond options is\n   * submitted.\n   */\n  async updateBondOptions (conf: BondOptionsForm): Promise<any> {\n    conf.host = this.host\n    await postJSON('/api/updatebondoptions', conf)\n    const targetTier = conf.targetTier ?? app().exchanges[this.host].auth.targetTier\n    this.renewToggle.setState(targetTier > 0)\n  }\n\n  async newWalletCreated (assetID: number, tier: number) {\n    this.regAssetForm.refresh()\n    const user = await app().fetchUser()\n    if (!user) return\n    const page = this.page\n    const asset = user.assets[assetID]\n    const wallet = asset.wallet\n    const xc = app().exchanges[this.host]\n    const bondAmt = xc.bondAssets[asset.symbol].amount\n\n    const bondsFeeBuffer = await this.getBondsFeeBuffer(assetID, page.newWalletForm)\n    this.confirmRegisterForm.setFees(assetID, bondsFeeBuffer)\n\n    if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {\n      this.progressTierFormWithSyncedFundedWallet(assetID)\n      return\n    }\n\n    this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier)\n    await this.showForm(page.walletWait)\n  }\n}\n","import {\n  app,\n  PageElement,\n  MarketWithHost\n} from './registry'\nimport { getJSON } from './http'\nimport Doc from './doc'\nimport BasePage from './basepage'\nimport { setMarketElements } from './mmutil'\n\ninterface MarketMakingRun {\n  startTime: number\n  market: MarketWithHost\n}\n\nexport default class MarketMakerArchivesPage extends BasePage {\n  page: Record<string, PageElement>\n  base: number\n  quote: number\n  host: string\n\n  constructor (main: HTMLElement) {\n    super()\n    const page = this.page = Doc.idDescendants(main)\n    Doc.cleanTemplates(page.runTableRowTmpl)\n    Doc.bind(page.backButton, 'click', () => { app().loadPage('mm') })\n    this.setup()\n  }\n\n  async setup () {\n    const res = await getJSON('/api/archivedmmruns')\n    if (!app().checkResponse(res)) {\n      console.error('failed to get archived mm runs', res)\n      // TODO: show error\n      return\n    }\n\n    const runs : MarketMakingRun[] = res.runs\n\n    for (let i = 0; i < runs.length; i++) {\n      const { startTime, market: { baseID, quoteID, host } } = runs[i]\n      const row = this.page.runTableRowTmpl.cloneNode(true) as HTMLElement\n      const tmpl = Doc.parseTemplate(row)\n      tmpl.startTime.textContent = new Date(startTime * 1000).toLocaleString()\n      setMarketElements(row, baseID, quoteID, host)\n\n      Doc.bind(tmpl.logs, 'click', () => {\n        app().loadPage('mmlogs', { baseID, quoteID, host, startTime, returnPage: 'mmarchives' })\n      })\n\n      Doc.bind(tmpl.settings, 'click', () => {\n        app().loadPage('mmsettings', { host, baseID, quoteID })\n      })\n\n      this.page.runTableBody.appendChild(row)\n    }\n  }\n}\n","import {\n  app,\n  PageElement,\n  MarketMakingEvent,\n  DEXOrderEvent,\n  CEXOrderEvent,\n  RunEventNote,\n  RunStatsNote,\n  DepositEvent,\n  WithdrawalEvent,\n  MarketMakingRunOverview,\n  SupportedAsset,\n  BalanceEffects,\n  MarketWithHost,\n  ProfitLoss\n} from './registry'\nimport { Forms } from './forms'\nimport { postJSON } from './http'\nimport Doc, { setupCopyBtn } from './doc'\nimport BasePage from './basepage'\nimport { setMarketElements, liveBotStatus } from './mmutil'\nimport * as intl from './locales'\nimport * as wallets from './wallets'\nimport { CoinExplorers } from './coinexplorers'\n\ninterface LogsPageParams {\n  host: string\n  quoteID: number\n  baseID: number\n  startTime: number\n  returnPage: string\n}\n\nlet net = 0\n\nconst logsBatchSize = 50\n\ninterface logFilters {\n  dexSells: boolean\n  dexBuys: boolean\n  cexSells: boolean\n  cexBuys: boolean\n  deposits: boolean\n  withdrawals: boolean\n}\n\nfunction eventPassesFilter (e: MarketMakingEvent, filters: logFilters): boolean {\n  if (e.dexOrderEvent) {\n    if (e.dexOrderEvent.sell) return filters.dexSells\n    return filters.dexBuys\n  }\n  if (e.cexOrderEvent) {\n    if (e.cexOrderEvent.sell) return filters.cexSells\n    return filters.cexBuys\n  }\n  if (e.depositEvent) return filters.deposits\n  if (e.withdrawalEvent) return filters.withdrawals\n  return false\n}\n\nexport default class MarketMakerLogsPage extends BasePage {\n  page: Record<string, PageElement>\n  mkt: MarketWithHost\n  startTime: number\n  fiatRates: Record<number, number>\n  liveBot: boolean\n  overview: MarketMakingRunOverview\n  events: Record<number, [MarketMakingEvent, HTMLElement]>\n  forms: Forms\n  dexOrderIDCopyListener: () => void | undefined\n  cexOrderIDCopyListener: () => void | undefined\n  depositIDCopyListener: () => void | undefined\n  withdrawalIDCopyListener: () => void | undefined\n  filters: logFilters\n  loading: boolean\n  refID: number | undefined\n  doneScrolling: boolean\n  statsRows: Record<number, HTMLElement>\n\n  constructor (main: HTMLElement, params: LogsPageParams) {\n    super()\n    const page = this.page = Doc.idDescendants(main)\n    net = app().user.net\n    Doc.cleanTemplates(page.eventTableRowTmpl, page.dexOrderTxRowTmpl, page.performanceTableRowTmpl)\n    Doc.bind(this.page.backButton, 'click', () => { app().loadPage(params.returnPage ?? 'mm') })\n    Doc.bind(this.page.filterButton, 'click', () => { this.applyFilters() })\n    if (params?.host) {\n      const url = new URL(window.location.href)\n      url.searchParams.set('host', params.host)\n      url.searchParams.set('baseID', String(params.baseID))\n      url.searchParams.set('quoteID', String(params.quoteID))\n      url.searchParams.set('startTime', String(params.startTime))\n      window.history.replaceState({ page: 'mmsettings', ...params }, '', url)\n    } else {\n      const urlParams = new URLSearchParams(window.location.search)\n      if (!params) params = {} as LogsPageParams\n      params.host = urlParams.get('host') || ''\n      params.baseID = parseInt(urlParams.get('baseID') || '0')\n      params.quoteID = parseInt(urlParams.get('quoteID') || '0')\n      params.startTime = parseInt(urlParams.get('startTime') || '0')\n    }\n    const { baseID, quoteID, host, startTime } = params\n    this.startTime = startTime\n    this.forms = new Forms(page.forms)\n    this.events = {}\n    this.statsRows = {}\n    this.mkt = { baseID: baseID, quoteID: quoteID, host }\n    setMarketElements(main, baseID, quoteID, host)\n    Doc.bind(main, 'scroll', () => {\n      if (this.loading) return\n      if (this.doneScrolling) return\n      const belowBottom = page.eventsTable.offsetHeight - main.offsetHeight - main.scrollTop\n      if (belowBottom < 0) {\n        this.nextPage()\n      }\n    })\n    this.setup(host, baseID, quoteID)\n  }\n\n  async nextPage () {\n    this.loading = true\n    const [events, updatedLogs, overview] = await this.getRunLogs()\n    const assets = this.mktAssets()\n    for (const event of events) {\n      if (this.events[event.id]) continue\n      const row = this.newEventRow(event, false, assets)\n      this.events[event.id] = [event, row]\n    }\n    this.populateStats(overview.profitLoss, overview.endTime)\n    this.updateExistingRows(updatedLogs)\n    this.loading = false\n  }\n\n  async getRunLogs (): Promise<[MarketMakingEvent[], MarketMakingEvent[], MarketMakingRunOverview]> {\n    const { mkt, startTime } = this\n    const req: any = { market: mkt, startTime, n: logsBatchSize, filters: this.filters, refID: this.refID }\n    const res = await postJSON('/api/mmrunlogs', req)\n    if (!app().checkResponse(res)) {\n      console.error('failed to get bot logs', res)\n    }\n    if (res.logs.length <= 1) {\n      this.doneScrolling = true\n    }\n    if (res.logs.length > 0) {\n      this.refID = res.logs[res.logs.length - 1].id\n    }\n    return [res.logs, res.updatedLogs || [], res.overview]\n  }\n\n  async applyFilters () {\n    const page = this.page\n    this.filters = {\n      dexSells: !!page.dexSellsCheckbox.checked,\n      dexBuys: !!page.dexBuysCheckbox.checked,\n      cexSells: !!page.cexSellsCheckbox.checked,\n      cexBuys: !!page.cexBuysCheckbox.checked,\n      deposits: !!page.depositsCheckbox.checked,\n      withdrawals: !!page.withdrawalsCheckbox.checked\n    }\n    this.refID = undefined\n    const [events, , overview] = await this.getRunLogs()\n    this.populateTable(events)\n    this.populateStats(overview.profitLoss, overview.endTime)\n  }\n\n  setFilters () {\n    const page = this.page\n    page.dexSellsCheckbox.checked = true\n    page.dexBuysCheckbox.checked = true\n    page.cexSellsCheckbox.checked = true\n    page.cexBuysCheckbox.checked = true\n    page.depositsCheckbox.checked = true\n    page.withdrawalsCheckbox.checked = true\n    this.filters = {\n      dexSells: true,\n      dexBuys: true,\n      cexSells: true,\n      cexBuys: true,\n      deposits: true,\n      withdrawals: true\n    }\n  }\n\n  async setup (host: string, baseID: number, quoteID: number) {\n    const page = this.page\n    this.setFilters()\n    const { startTime } = this\n    let profitLoss: ProfitLoss\n    let endTime = 0\n    const botStatus = liveBotStatus(host, baseID, quoteID)\n    const [events, , overview] = await this.getRunLogs()\n    if (botStatus?.runStats?.startTime === startTime) {\n      this.liveBot = true\n      this.fiatRates = app().fiatRatesMap\n      profitLoss = botStatus.runStats.profitLoss\n    } else {\n      this.fiatRates = overview.finalState.fiatRates\n      profitLoss = overview.profitLoss\n      endTime = overview.endTime\n    }\n    this.populateStats(profitLoss, endTime)\n    const assets = this.mktAssets()\n    const parentHeader = page.sumUSDHeader.parentElement\n    for (const asset of assets) {\n      const th = document.createElement('th') as PageElement\n      th.textContent = `${asset.symbol.toUpperCase()} Delta`\n      if (parentHeader) {\n        parentHeader.insertBefore(th, page.sumUSDHeader)\n      }\n    }\n    this.populateTable(events)\n\n    app().registerNoteFeeder({\n      runevent: (note: RunEventNote) => { this.handleRunEventNote(note) },\n      runstats: (note: RunStatsNote) => { this.handleRunStatsNote(note) }\n    })\n  }\n\n  handleRunEventNote (note: RunEventNote) {\n    const { baseID, quoteID, host } = this.mkt\n    if (note.host !== host || note.baseID !== baseID || note.quoteID !== quoteID) return\n    if (!eventPassesFilter(note.event, this.filters)) return\n    const event = note.event\n    const cachedEvent = this.events[event.id]\n    if (cachedEvent) {\n      this.setRowContents(cachedEvent[1], event, this.mktAssets())\n      cachedEvent[0] = event\n      return\n    }\n    const row = this.newEventRow(event, true, this.mktAssets())\n    this.events[event.id] = [event, row]\n  }\n\n  handleRunStatsNote (note: RunStatsNote) {\n    const { mkt: { baseID, quoteID, host }, startTime } = this\n    if (note.host !== host ||\n      note.baseID !== baseID ||\n      note.quoteID !== quoteID) return\n    if (!note.stats || note.stats.startTime !== startTime) return\n    this.populateStats(note.stats.profitLoss, 0)\n  }\n\n  populateStats (pl: ProfitLoss, endTime: number) {\n    const page = this.page\n    page.startTime.textContent = new Date(this.startTime * 1000).toLocaleString()\n    if (endTime === 0) {\n      Doc.hide(page.endTimeRow)\n    } else {\n      page.endTime.textContent = new Date(endTime * 1000).toLocaleString()\n    }\n    for (const assetID in pl.diffs) {\n      const asset = app().assets[parseInt(assetID)]\n      let row = this.statsRows[assetID]\n      if (!row) {\n        row = page.performanceTableRowTmpl.cloneNode(true) as HTMLElement\n        const tmpl = Doc.parseTemplate(row)\n        tmpl.logo.src = Doc.logoPath(asset.symbol)\n        tmpl.ticker.textContent = asset.symbol.toUpperCase()\n        this.statsRows[assetID] = row\n        page.performanceTableBody.appendChild(row)\n      }\n      const diff = pl.diffs[assetID]\n      const tmpl = Doc.parseTemplate(row)\n      tmpl.diff.textContent = diff.fmt\n      tmpl.usdDiff.textContent = diff.fmtUSD\n      tmpl.fiatRate.textContent = `${Doc.formatFiatValue(this.fiatRates[asset.id])} USD`\n    }\n    page.profitLoss.textContent = `${Doc.formatFiatValue(pl.profit)} USD`\n  }\n\n  mktAssets () : SupportedAsset[] {\n    const baseAsset = app().assets[this.mkt.baseID]\n    const quoteAsset = app().assets[this.mkt.quoteID]\n\n    const assets = [baseAsset, quoteAsset]\n    const assetIDs = { [baseAsset.id]: true, [quoteAsset.id]: true }\n\n    if (baseAsset.token && !assetIDs[baseAsset.token.parentID]) {\n      const baseTokenAsset = app().assets[baseAsset.token.parentID]\n      assetIDs[baseTokenAsset.id] = true\n      assets.push(baseTokenAsset)\n    }\n\n    if (quoteAsset.token && !assetIDs[quoteAsset.token.parentID]) {\n      const quoteTokenAsset = app().assets[quoteAsset.token.parentID]\n      assets.push(quoteTokenAsset)\n    }\n\n    return assets\n  }\n\n  updateExistingRows (updatedLogs: MarketMakingEvent[]) {\n    for (const event of updatedLogs) {\n      const cachedEvent = this.events[event.id]\n      if (!cachedEvent) continue\n      this.setRowContents(cachedEvent[1], event, this.mktAssets())\n      cachedEvent[0] = event\n    }\n  }\n\n  populateTable (events: MarketMakingEvent[]) {\n    const page = this.page\n    Doc.empty(page.eventsTableBody)\n    this.events = {}\n    this.doneScrolling = false\n    const assets = this.mktAssets()\n    for (const event of events) {\n      const row = this.newEventRow(event, false, assets)\n      this.events[event.id] = [event, row]\n    }\n  }\n\n  setRowContents (row: HTMLElement, event: MarketMakingEvent, assets: SupportedAsset[]) {\n    const tmpl = Doc.parseTemplate(row)\n    tmpl.time.textContent = (new Date(event.timestamp * 1000)).toLocaleString()\n    tmpl.eventType.textContent = this.eventType(event)\n    let id\n    if (event.depositEvent) {\n      id = event.depositEvent.transaction.id\n    } else if (event.withdrawalEvent) {\n      id = event.withdrawalEvent.id\n    } else if (event.dexOrderEvent) {\n      id = event.dexOrderEvent.id\n    } else if (event.cexOrderEvent) {\n      id = event.cexOrderEvent.id\n    }\n    if (id) {\n      tmpl.eventID.textContent = trimStringWithEllipsis(id, 30)\n      tmpl.eventID.setAttribute('title', id)\n    }\n    let usd = 0\n    for (const asset of assets) {\n      const be = event.balanceEffects\n      const sum = sumBalanceEffects(asset.id, be)\n      const tmplID = `sum${asset.symbol.toUpperCase()}`\n      let el : PageElement\n      if (tmpl[tmplID]) {\n        el = tmpl[tmplID]\n      } else {\n        el = document.createElement('td')\n        el.dataset.tmpl = tmplID\n        const parent = tmpl.sumUSD.parentElement\n        if (parent) {\n          parent.insertBefore(el, tmpl.sumUSD)\n        }\n      }\n      el.textContent = Doc.formatCoinValue(sum, asset.unitInfo)\n      const factor = asset.unitInfo.conventional.conversionFactor\n      usd += sum / factor * this.fiatRates[asset.id] ?? 0\n    }\n    tmpl.sumUSD.textContent = Doc.formatFourSigFigs(usd)\n    Doc.bind(tmpl.details, 'click', () => { this.showEventDetails(event.id) })\n  }\n\n  newEventRow (event: MarketMakingEvent, prepend: boolean, assets: SupportedAsset[]) : HTMLElement {\n    const page = this.page\n    const row = page.eventTableRowTmpl.cloneNode(true) as HTMLElement\n    row.id = event.id.toString()\n    this.setRowContents(row, event, assets)\n    if (prepend) {\n      page.eventsTableBody.insertBefore(row, page.eventsTableBody.firstChild)\n    } else {\n      page.eventsTableBody.appendChild(row)\n    }\n    return row\n  }\n\n  eventType (event: MarketMakingEvent) : string {\n    if (event.depositEvent) {\n      return 'Deposit'\n    } else if (event.withdrawalEvent) {\n      return 'Withdrawal'\n    } else if (event.dexOrderEvent) {\n      return event.dexOrderEvent.sell ? 'DEX Sell' : 'DEX Buy'\n    } else if (event.cexOrderEvent) {\n      return event.cexOrderEvent.sell ? 'CEX Sell' : 'CEX Buy'\n    }\n\n    return ''\n  }\n\n  showDexOrderEventDetails (event: DEXOrderEvent) {\n    const { page, mkt: { baseID, quoteID } } = this\n    const baseAsset = app().assets[baseID]\n    const quoteAsset = app().assets[quoteID]\n    const [bui, qui] = [baseAsset.unitInfo, quoteAsset.unitInfo]\n    const [baseTicker, quoteTicker] = [bui.conventional.unit, qui.conventional.unit]\n    if (this.dexOrderIDCopyListener !== undefined) {\n      page.copyDexOrderID.removeEventListener('click', this.dexOrderIDCopyListener)\n    }\n    this.dexOrderIDCopyListener = () => { setupCopyBtn(event.id, page.dexOrderID, page.copyDexOrderID, '#1e7d11') }\n    page.copyDexOrderID.addEventListener('click', this.dexOrderIDCopyListener)\n    page.dexOrderID.textContent = trimStringWithEllipsis(event.id, 20)\n    page.dexOrderID.setAttribute('title', event.id)\n    const rate = app().conventionalRate(baseID, quoteID, event.rate)\n\n    page.dexOrderRate.textContent = `${rate} ${baseTicker}/${quoteTicker}`\n    page.dexOrderQty.textContent = `${event.qty / bui.conventional.conversionFactor} ${baseTicker}`\n    if (event.sell) {\n      page.dexOrderSide.textContent = intl.prep(intl.ID_SELL)\n    } else {\n      page.dexOrderSide.textContent = intl.prep(intl.ID_BUY)\n    }\n    Doc.empty(page.dexOrderTxsTableBody)\n    Doc.setVis(event.transactions && event.transactions.length > 0, page.dexOrderTxsTable)\n    const txAsset = (txType: number, sell: boolean) : SupportedAsset | undefined => {\n      switch (txType) {\n        case wallets.txTypeSwap:\n        case wallets.txTypeRefund:\n        case wallets.txTypeSplit:\n          return sell ? baseAsset : quoteAsset\n        case wallets.txTypeRedeem:\n          return sell ? quoteAsset : baseAsset\n      }\n    }\n\n    for (let i = 0; event.transactions && i < event.transactions.length; i++) {\n      const tx = event.transactions[i]\n      const row = page.dexOrderTxRowTmpl.cloneNode(true) as HTMLElement\n      const tmpl = Doc.parseTemplate(row)\n      tmpl.id.textContent = trimStringWithEllipsis(tx.id, 20)\n      tmpl.id.setAttribute('title', tx.id)\n      tmpl.type.textContent = wallets.txTypeString(tx.type)\n      const asset = txAsset(tx.type, event.sell)\n      if (!asset) {\n        console.error('unexpected tx type in dex order event', tx.type)\n        continue\n      }\n      const assetExplorer = CoinExplorers[asset.id]\n      if (assetExplorer && assetExplorer[net]) {\n        tmpl.explorerLink.href = assetExplorer[net](tx.id)\n      }\n      tmpl.amt.textContent = `${Doc.formatCoinValue(tx.amount, asset.unitInfo)} ${asset.unitInfo.conventional.unit.toLowerCase()}`\n      tmpl.fees.textContent = `${Doc.formatCoinValue(tx.fees, asset.unitInfo)} ${asset.unitInfo.conventional.unit.toLowerCase()}`\n      page.dexOrderTxsTableBody.appendChild(row)\n    }\n    this.forms.show(page.dexOrderDetailsForm)\n  }\n\n  showCexOrderEventDetails (event: CEXOrderEvent) {\n    const { page, mkt: { baseID, quoteID } } = this\n    const baseAsset = app().assets[baseID]\n    const quoteAsset = app().assets[quoteID]\n    const [bui, qui] = [baseAsset.unitInfo, quoteAsset.unitInfo]\n    const [baseTicker, quoteTicker] = [bui.conventional.unit, qui.conventional.unit]\n\n    page.cexOrderID.textContent = trimStringWithEllipsis(event.id, 20)\n    if (this.cexOrderIDCopyListener !== undefined) {\n      page.copyCexOrderID.removeEventListener('click', this.cexOrderIDCopyListener)\n    }\n    this.cexOrderIDCopyListener = () => { setupCopyBtn(event.id, page.cexOrderID, page.copyCexOrderID, '#1e7d11') }\n    page.copyCexOrderID.addEventListener('click', this.cexOrderIDCopyListener)\n    page.cexOrderID.setAttribute('title', event.id)\n    const rate = app().conventionalRate(baseID, quoteID, event.rate)\n    page.cexOrderRate.textContent = `${rate} ${baseTicker}/${quoteTicker}`\n    page.cexOrderQty.textContent = `${event.qty / bui.conventional.conversionFactor} ${baseTicker}`\n    if (event.sell) {\n      page.cexOrderSide.textContent = intl.prep(intl.ID_SELL)\n    } else {\n      page.cexOrderSide.textContent = intl.prep(intl.ID_BUY)\n    }\n    page.cexOrderBaseFilled.textContent = `${event.baseFilled / bui.conventional.conversionFactor} ${baseTicker}`\n    page.cexOrderQuoteFilled.textContent = `${event.quoteFilled / qui.conventional.conversionFactor} ${quoteTicker}`\n    this.forms.show(page.cexOrderDetailsForm)\n  }\n\n  showDepositEventDetails (event: DepositEvent, pending: boolean) {\n    const page = this.page\n    page.depositID.textContent = trimStringWithEllipsis(event.transaction.id, 20)\n    if (this.depositIDCopyListener !== undefined) {\n      page.copyDepositID.removeEventListener('click', this.depositIDCopyListener)\n    }\n    this.depositIDCopyListener = () => { setupCopyBtn(event.transaction.id, page.depositID, page.copyDepositID, '#1e7d11') }\n    page.copyDepositID.addEventListener('click', this.depositIDCopyListener)\n    page.depositID.setAttribute('title', event.transaction.id)\n    const unitInfo = app().assets[event.assetID].unitInfo\n    const unit = unitInfo.conventional.unit\n    page.depositAmt.textContent = `${Doc.formatCoinValue(event.transaction.amount, unitInfo)} ${unit}`\n    page.depositFees.textContent = `${Doc.formatCoinValue(event.transaction.fees, unitInfo)} ${unit}`\n    page.depositStatus.textContent = pending ? intl.prep(intl.ID_PENDING) : intl.prep(intl.ID_COMPLETE)\n    Doc.setVis(!pending, page.depositCreditSection)\n    if (!pending) {\n      page.depositCredit.textContent = `${Doc.formatCoinValue(event.cexCredit, unitInfo)} ${unit}`\n    }\n    this.forms.show(page.depositDetailsForm)\n  }\n\n  showWithdrawalEventDetails (event: WithdrawalEvent, pending: boolean) {\n    const page = this.page\n    page.withdrawalID.textContent = trimStringWithEllipsis(event.id, 20)\n    if (this.withdrawalIDCopyListener !== undefined) {\n      page.copyWithdrawalID.removeEventListener('click', this.withdrawalIDCopyListener)\n    }\n    this.withdrawalIDCopyListener = () => { setupCopyBtn(event.id, page.withdrawalID, page.copyWithdrawalID, '#1e7d11') }\n    page.copyWithdrawalID.addEventListener('click', this.withdrawalIDCopyListener)\n    page.withdrawalID.setAttribute('title', event.id)\n    const unitInfo = app().assets[event.assetID].unitInfo\n    const unit = unitInfo.conventional.unit\n    page.withdrawalAmt.textContent = `${Doc.formatCoinValue(event.cexDebit, unitInfo)} ${unit}`\n    page.withdrawalStatus.textContent = pending ? intl.prep(intl.ID_PENDING) : intl.prep(intl.ID_COMPLETE)\n    if (event.transaction) {\n      page.withdrawalTxID.textContent = trimStringWithEllipsis(event.transaction.id, 20)\n      page.withdrawalTxID.setAttribute('title', event.transaction.id)\n      page.withdrawalReceived.textContent = `${Doc.formatCoinValue(event.transaction.amount, unitInfo)} ${unit}`\n    }\n    this.forms.show(page.withdrawalDetailsForm)\n  }\n\n  showEventDetails (eventID: number) {\n    const [event] = this.events[eventID]\n    if (event.dexOrderEvent) this.showDexOrderEventDetails(event.dexOrderEvent)\n    if (event.cexOrderEvent) this.showCexOrderEventDetails(event.cexOrderEvent)\n    if (event.depositEvent) this.showDepositEventDetails(event.depositEvent, event.pending)\n    if (event.withdrawalEvent) this.showWithdrawalEventDetails(event.withdrawalEvent, event.pending)\n  }\n}\n\nfunction trimStringWithEllipsis (str: string, maxLen: number): string {\n  if (str.length <= maxLen) return str\n  return `${str.substring(0, maxLen / 2)}...${str.substring(str.length - maxLen / 2)}`\n}\n\nfunction sumBalanceEffects (assetID: number, be: BalanceEffects): number {\n  let sum = 0\n  if (be.settled[assetID]) sum += be.settled[assetID]\n  if (be.pending[assetID]) sum += be.pending[assetID]\n  if (be.locked[assetID]) sum += be.locked[assetID]\n  if (be.reserved[assetID]) sum += be.reserved[assetID]\n  return sum\n}\n","import Doc from './doc'\nimport BasePage from './basepage'\nimport { postJSON } from './http'\nimport * as intl from './locales'\nimport {\n  bind as bindForm,\n  slideSwap\n} from './forms'\nimport { Wave } from './charts'\nimport {\n  app,\n  PageElement,\n  SupportedAsset,\n  User,\n  WalletInfo,\n  WalletDefinition,\n  ConfigOption,\n  APIResponse\n} from './registry'\n\ninterface InitResponse extends APIResponse {\n  hosts: string[]\n  mnemonic?: string\n}\n\n/*\n * InitPage is the page handler for the /init view. InitPage is essentially a\n * form handler. There are no non-form elements on /init. InitPage additionally\n * has a role caching the initialization password. A couple of notes about\n * InitPage.\n *   1) There is no going backwards. Once you set a password, you can't go back\n *      to the password form. If you refresh, you won't end up on /init, so\n *      won't have access to the QuickConfigForm or SeedBackupForm . Once you\n *      submit your auto-config choices, you can't change them. This has\n *      implications for coding and UI. There are no \"go back\" or \"close form\"\n *      elements.\n *   2) The user can preclude auto-config and seed backup by clicking an\n *      available header link after password init, e.g. Wallets, in the page\n *      header. NOTE: Regardless of what the user does after setting the app\n *      pass, they will receive a notification reminding them to back up their\n *      seed. Perhaps it would be better to somehow delay that message until\n *      they choose to ignore the seed backup dialog, but having more reminders\n *      is also okay.\n */\nexport default class InitPage extends BasePage {\n  body: HTMLElement\n  page: Record<string, PageElement>\n  initForm: AppInitForm\n  quickConfigForm: QuickConfigForm\n  seedBackupForm: SeedBackupForm\n  mnemonic?: string\n\n  constructor (body: HTMLElement) {\n    super()\n    this.body = body\n    const page = this.page = Doc.idDescendants(body)\n    this.initForm = new AppInitForm(page.appPWForm, (pw: string, hosts: string[], mnemonic?: string) => { this.appInited(pw, hosts, mnemonic) })\n    this.quickConfigForm = new QuickConfigForm(page.quickConfigForm, () => this.quickConfigDone())\n    this.seedBackupForm = new SeedBackupForm(page.seedBackupForm, () => this.seedBackedUp())\n  }\n\n  async appInited (pw: string, hosts: string[], mnemonic?: string) {\n    this.mnemonic = mnemonic\n    const page = this.page\n    await this.quickConfigForm.update(pw, hosts)\n    if (mnemonic) this.seedBackupForm.update(mnemonic)\n    slideSwap(page.appPWForm, page.quickConfigForm)\n  }\n\n  quickConfigDone () {\n    if (!this.mnemonic) app().loadPage('wallets')\n    else slideSwap(this.page.quickConfigForm, this.page.seedBackupForm)\n  }\n\n  seedBackedUp () {\n    app().loadPage('wallets')\n  }\n}\n\n/*\n * The AppInitForm handles the form that sets the app password, accepts an\n * optional seed, and initializes the app.\n */\nclass AppInitForm {\n  form: PageElement\n  page: Record<string, PageElement>\n  success: (pw: string, hosts: string[], mnemonic?: string) => void\n\n  constructor (form: PageElement, success: (pw: string, hosts: string[], mnemonic?: string) => void) {\n    this.form = form\n    this.success = success\n    const page = this.page = Doc.idDescendants(form)\n    bindForm(form, page.appPWSubmit, () => this.setAppPass())\n    bindForm(form, page.toggleSeedInput, () => {\n      if (Doc.isHidden(page.seedInputBox)) {\n        page.toggleSeedInputIcon.classList.remove('ico-plus')\n        page.toggleSeedInputIcon.classList.add('ico-minus')\n        Doc.show(page.seedInputBox)\n      } else {\n        page.toggleSeedInputIcon.classList.remove('ico-minus')\n        page.toggleSeedInputIcon.classList.add('ico-plus')\n        Doc.hide(page.seedInputBox)\n      }\n    })\n  }\n\n  /* Set the application password. Attached to form submission. */\n  async setAppPass () {\n    const page = this.page\n    Doc.hide(page.appPWErrMsg)\n    const pw = page.appPW.value || ''\n    const pwAgain = page.appPWAgain.value\n    if (pw === '') {\n      page.appPWErrMsg.textContent = intl.prep(intl.ID_NO_PASS_ERROR_MSG)\n      Doc.show(page.appPWErrMsg)\n      return\n    }\n    if (pw !== pwAgain) {\n      page.appPWErrMsg.textContent = intl.prep(intl.ID_PASSWORD_NOT_MATCH)\n      Doc.show(page.appPWErrMsg)\n      return\n    }\n\n    page.appPW.value = ''\n    page.appPWAgain.value = ''\n    const loaded = app().loading(this.form)\n    // const seed = page.seedInput.value?.replace(/\\s+/g, '') // strip whitespace\n    const seed = page.seedInput.value ?? ''\n    const res: InitResponse = await postJSON('/api/init', {\n      pass: pw,\n      seed: seed\n    })\n    loaded()\n    if (!app().checkResponse(res)) {\n      page.appPWErrMsg.textContent = res.msg\n      Doc.show(page.appPWErrMsg)\n      return\n    }\n    this.success(pw, res.hosts, res.mnemonic)\n  }\n}\n\n// HostConfigRow is used by the QuickConfigForm to track the user's choices.\ninterface HostConfigRow {\n  host: string\n  checkbox: HTMLInputElement\n}\n\n// WalletConfigRow is used by the QuickConfigForm to track the user's choices.\ninterface WalletConfigRow {\n  asset: SupportedAsset\n  type: string\n  checkbox: HTMLInputElement\n}\n\nlet rowIDCounter = 0\n\n/*\n * QuickConfigForm handles the form that allows users to quickly configure\n * view-only servers and native wallets (that don't require any configuration).\n */\nclass QuickConfigForm {\n  page: Record<string, PageElement>\n  form: PageElement\n  servers: HostConfigRow[]\n  wallets: WalletConfigRow[]\n  pw: string\n  success: () => void\n\n  constructor (form: PageElement, success: () => void) {\n    this.form = form\n    this.success = success\n    const page = this.page = Doc.idDescendants(form)\n    Doc.cleanTemplates(page.qcServerTmpl, page.qcWalletTmpl)\n    bindForm(form, page.quickConfigSubmit, () => { this.submit() })\n    bindForm(form, page.qcErrAck, () => { this.success() })\n  }\n\n  async update (pw: string, hosts: string[]) {\n    this.pw = pw\n    const page = this.page\n\n    this.servers = []\n    for (const host of hosts) {\n      const row = page.qcServerTmpl.cloneNode(true) as PageElement\n      page.qcServersBox.appendChild(row)\n      const tmpl = Doc.parseTemplate(row)\n      rowIDCounter++\n      const rowID = `qcsrow${rowIDCounter}`\n      row.htmlFor = rowID\n      tmpl.checkbox.id = rowID\n      tmpl.host.textContent = host\n      this.servers.push({ host, checkbox: tmpl.checkbox as HTMLInputElement })\n    }\n\n    const u = await app().fetchUser() as User\n    this.wallets = []\n    for (const a of Object.values(u.assets)) {\n      if (a.token) continue\n      const winfo = a.info as WalletInfo\n      let autoConfigurable: WalletDefinition | null = null\n      for (const wDef of winfo.availablewallets) {\n        if (!wDef.seeded) continue\n        if (wDef.configopts && wDef.configopts.some((opt: ConfigOption) => opt.required)) continue\n        autoConfigurable = wDef\n        break\n      }\n      if (!autoConfigurable) continue\n      const row = page.qcWalletTmpl.cloneNode(true) as PageElement\n      page.qcWalletsBox.appendChild(row)\n      const tmpl = Doc.parseTemplate(row)\n      rowIDCounter++\n      const rowID = `qcwrow${rowIDCounter}`\n      row.htmlFor = rowID\n      tmpl.checkbox.id = rowID\n      tmpl.icon.src = Doc.logoPath(a.symbol)\n      tmpl.name.textContent = a.name\n      this.wallets.push({\n        asset: a,\n        type: autoConfigurable.type,\n        checkbox: tmpl.checkbox as HTMLInputElement\n      })\n    }\n  }\n\n  async submit () {\n    const [failedHosts, failedWallets]: [string[], string[]] = [[], []]\n    const ani = new Wave(this.form, { backgroundColor: true, message: '...' })\n    ani.opts.message = intl.prep(intl.ID_ADDING_SERVERS)\n    const connectServer = async (srvRow: HostConfigRow) => {\n      if (!srvRow.checkbox.checked) return\n      const req = {\n        addr: srvRow.host,\n        appPW: this.pw\n      }\n      const res = await postJSON('/api/adddex', req) // DRAFT NOTE: ignore errors ok?\n      if (!app().checkResponse(res)) failedHosts.push(srvRow.host)\n    }\n    await Promise.all(this.servers.map(connectServer))\n\n    ani.opts.message = intl.prep(intl.ID_CREATING_WALLETS)\n    const createWallet = async (walletRow: WalletConfigRow) => {\n      const { asset: a, type, checkbox } = walletRow\n      if (!checkbox.checked) return\n      const config: Record<string, string> = {}\n      const walletDef = app().walletDefinition(a.id, type)\n      for (const opt of (walletDef.configopts ?? [])) {\n        if (!opt.default) continue\n        if (opt.isboolean) {\n          config[opt.key] = opt.default ? '1' : '0'\n          continue\n        }\n        if (opt.repeatable && config[opt.key]) config[opt.key] += opt.repeatable + opt.default\n        else config[opt.key] = String(opt.default)\n      }\n      const createForm = {\n        assetID: a.id,\n        appPass: this.pw,\n        config: config,\n        walletType: type\n      }\n      const res = await postJSON('/api/newwallet', createForm)\n      if (!app().checkResponse(res)) failedWallets.push(a.name)\n    }\n    await Promise.all(this.wallets.map(createWallet))\n\n    ani.stop()\n    await app().fetchUser() // Calls updateMenuItemsDisplay internally\n    if (failedWallets.length + failedHosts.length === 0) return this.success()\n\n    const page = this.page\n    Doc.hide(page.qcChoices)\n    Doc.show(page.qcErrors)\n\n    if (failedHosts.length) {\n      for (const host of failedHosts) {\n        page.qcServerErrorList.appendChild(document.createTextNode(host))\n        page.qcServerErrorList.appendChild(document.createElement('br'))\n      }\n    } else Doc.hide(page.qcServerErrors)\n\n    if (failedWallets.length) {\n      for (const name of failedWallets) {\n        page.qcWalletErrorList.appendChild(document.createTextNode(name))\n        page.qcWalletErrorList.appendChild(document.createElement('br'))\n      }\n    } else Doc.hide(page.qcWalletErrors)\n  }\n}\n\n/*\n * SeedBackupForm handles the form that allows the user to back up their seed\n * during initialization.\n */\nclass SeedBackupForm {\n  form: PageElement\n  page: Record<string, PageElement>\n  mnemonic: string\n\n  constructor (form: PageElement, success: () => void) {\n    this.form = form\n    const page = this.page = Doc.idDescendants(form)\n    bindForm(form, page.seedAck, () => success())\n    bindForm(form, page.showSeed, () => this.showSeed())\n  }\n\n  update (mnemonic: string) {\n    this.mnemonic = mnemonic\n  }\n\n  showSeed () {\n    const page = this.page\n    page.mnemonic.textContent = this.mnemonic // `${words.slice(0, 5).join(' ')}\\n${words.slice(5, 10).join(' ')}\\n${words.slice(10,15).join(' ')}`\n    Doc.hide(page.sbWanna)\n    Doc.show(page.sbSeed)\n  }\n}\n","import Doc from './doc'\nimport State from './state'\nimport RegistrationPage from './register'\nimport LoginPage from './login'\nimport WalletsPage, { txTypeString } from './wallets'\nimport SettingsPage from './settings'\nimport MarketsPage from './markets'\nimport OrdersPage from './orders'\nimport OrderPage from './order'\nimport MarketMakerPage from './mm'\nimport MarketMakerSettingsPage from './mmsettings'\nimport DexSettingsPage from './dexsettings'\nimport MarketMakerArchivesPage from './mmarchives'\nimport MarketMakerLogsPage from './mmlogs'\nimport InitPage from './init'\nimport { MM } from './mmutil'\nimport { RateEncodingFactor, StatusExecuted, hasActiveMatches } from './orderutil'\nimport { getJSON, postJSON, Errors } from './http'\nimport * as ntfn from './notifications'\nimport ws from './ws'\nimport * as intl from './locales'\nimport {\n  User,\n  SupportedAsset,\n  Exchange,\n  WalletState,\n  BondNote,\n  ReputationNote,\n  CoreNote,\n  OrderNote,\n  Market,\n  Order,\n  Match,\n  BalanceNote,\n  WalletConfigNote,\n  WalletSyncNote,\n  MatchNote,\n  ConnEventNote,\n  SpotPriceNote,\n  UnitInfo,\n  WalletDefinition,\n  WalletBalance,\n  LogMessage,\n  NoteElement,\n  BalanceResponse,\n  APIResponse,\n  RateNote,\n  InFlightOrder,\n  WalletTransaction,\n  TxHistoryResult,\n  WalletNote,\n  TransactionNote,\n  PageElement,\n  ActionRequiredNote,\n  ActionResolvedNote,\n  TransactionActionNote,\n  CoreActionRequiredNote,\n  RejectedRedemptionData,\n  MarketMakingStatus,\n  RunStatsNote,\n  MMBotStatus,\n  CEXNotification,\n  CEXBalanceUpdate,\n  EpochReportNote,\n  CEXProblemsNote\n} from './registry'\nimport { setCoinHref } from './coinexplorers'\n\nconst idel = Doc.idel // = element by id\nconst bind = Doc.bind\nconst unbind = Doc.unbind\n\nconst notificationRoute = 'notify'\nconst noteCacheSize = 100\n\ninterface Page {\n  unload (): void\n}\n\ninterface PageClass {\n  new (main: HTMLElement, data: any): Page;\n}\n\ninterface CoreNotePlus extends CoreNote {\n  el: HTMLElement // Added in app\n}\n\ninterface UserResponse extends APIResponse {\n  user?: User\n  lang: string\n  langs: string[]\n  inited: boolean\n  mmStatus: MarketMakingStatus\n}\n\n/* constructors is a map to page constructors. */\nconst constructors: Record<string, PageClass> = {\n  login: LoginPage,\n  register: RegistrationPage,\n  markets: MarketsPage,\n  wallets: WalletsPage,\n  settings: SettingsPage,\n  orders: OrdersPage,\n  order: OrderPage,\n  dexsettings: DexSettingsPage,\n  init: InitPage,\n  mm: MarketMakerPage,\n  mmsettings: MarketMakerSettingsPage,\n  mmarchives: MarketMakerArchivesPage,\n  mmlogs: MarketMakerLogsPage\n}\n\ninterface LangData {\n  name: string\n  flag: string\n}\n\nconst languageData: Record<string, LangData> = {\n  'en-US': {\n    name: 'English',\n    flag: '🇺🇸' // Not 🇬🇧. MURICA!\n  },\n  'pt-BR': {\n    name: 'Portugese',\n    flag: '🇧🇷'\n  },\n  'zh-CN': {\n    name: 'Chinese',\n    flag: '🇨🇳'\n  },\n  'pl-PL': {\n    name: 'Polish',\n    flag: '🇵🇱'\n  },\n  'de-DE': {\n    name: 'German',\n    flag: '🇩🇪'\n  },\n  'ar': {\n    name: 'Arabic',\n    flag: '🇪🇬' // Egypt I guess\n  }\n}\n\ninterface requiredAction {\n  div: PageElement\n  stamp: number\n  uniqueID: string\n  actionID: string\n  selected: boolean\n}\n\n// Application is the main javascript web application for Bison Wallet.\nexport default class Application {\n  notes: CoreNotePlus[]\n  pokes: CoreNotePlus[]\n  langs: string[]\n  lang: string\n  mmStatus: MarketMakingStatus\n  inited: boolean\n  authed: boolean\n  user: User\n  seedGenTime: number\n  commitHash: string\n  showPopups: boolean\n  loggers: Record<string, boolean>\n  recorders: Record<string, LogMessage[]>\n  main: HTMLElement\n  header: HTMLElement\n  headerSpace: HTMLElement\n  assets: Record<number, SupportedAsset>\n  exchanges: Record<string, Exchange>\n  walletMap: Record<number, WalletState>\n  fiatRatesMap: Record<number, number>\n  tooltip: HTMLElement\n  page: Record<string, HTMLElement>\n  loadedPage: Page | null\n  popupNotes: HTMLElement\n  popupTmpl: HTMLElement\n  noteReceivers: Record<string, (n: CoreNote) => void>[]\n  txHistoryMap: Record<number, TxHistoryResult>\n  requiredActions: Record<string, requiredAction>\n\n  constructor () {\n    this.notes = []\n    this.pokes = []\n    this.seedGenTime = 0\n    this.commitHash = process.env.COMMITHASH || ''\n    this.noteReceivers = []\n    this.fiatRatesMap = {}\n    this.showPopups = State.fetchLocal(State.popupsLK) === '1'\n    this.txHistoryMap = {}\n    this.requiredActions = {}\n\n    console.log('Bison Wallet, Build', this.commitHash.substring(0, 7))\n\n    // Set Bootstrap dark theme attribute if dark mode is enabled.\n    if (State.isDark()) {\n      document.body.classList.add('dark')\n    }\n\n    // Loggers can be enabled by setting a truthy value to the loggerID using\n    // enableLogger. Settings are stored across sessions. See docstring for the\n    // log method for more info.\n    this.loggers = State.fetchLocal(State.loggersLK) || {}\n    window.enableLogger = (loggerID, state) => {\n      if (state) this.loggers[loggerID] = true\n      else delete this.loggers[loggerID]\n      State.storeLocal(State.loggersLK, this.loggers)\n      return `${loggerID} logger ${state ? 'enabled' : 'disabled'}`\n    }\n    // Enable logging from anywhere.\n    window.log = (loggerID, ...a) => { this.log(loggerID, ...a) }\n    window.mmStatus = () => this.mmStatus\n\n    // Recorders can record log messages, and then save them to file on request.\n    const recorderKeys = State.fetchLocal(State.recordersLK) || []\n    this.recorders = {}\n    for (const loggerID of recorderKeys) {\n      console.log('recording', loggerID)\n      this.recorders[loggerID] = []\n    }\n    window.recordLogger = (loggerID, on) => {\n      if (on) this.recorders[loggerID] = []\n      else delete this.recorders[loggerID]\n      State.storeLocal(State.recordersLK, Object.keys(this.recorders))\n      return `${loggerID} recorder ${on ? 'enabled' : 'disabled'}`\n    }\n    window.dumpLogger = loggerID => {\n      const record = this.recorders[loggerID]\n      if (!record) return `no recorder for logger ${loggerID}`\n      const a = document.createElement('a')\n      a.href = `data:application/octet-stream;base64,${window.btoa(JSON.stringify(record, null, 4))}`\n      a.download = `${loggerID}.json`\n      document.body.appendChild(a)\n      a.click()\n      setTimeout(() => {\n        document.body.removeChild(a)\n      }, 0)\n    }\n\n    window.user = () => this.user\n  }\n\n  /**\n   * Start the application. This is the only thing done from the index.js entry\n   * point. Read the id = main element and attach handlers.\n   */\n  async start () {\n    // Handle back navigation from the browser.\n    bind(window, 'popstate', (e: PopStateEvent) => {\n      const page = e.state?.page\n      if (!page && page !== '') return\n      this.loadPage(page, e.state.data, true)\n    })\n    // The main element is the interchangeable part of the page that doesn't\n    // include the header. Main should define a data-handler attribute\n    // associated with one of the available constructors.\n    this.main = idel(document, 'main')\n    const handler = this.main.dataset.handler\n    // Don't fetch the user until we know what page we're on.\n    await this.fetchUser()\n    const ignoreCachedLocale = process.env.NODE_ENV === 'development'\n    await intl.loadLocale(this.lang, this.commitHash, ignoreCachedLocale)\n    // The application is free to respond with a page that differs from the\n    // one requested in the omnibox, e.g. routing though a login page. Set the\n    // current URL state based on the actual page.\n    const url = new URL(window.location.href)\n    if (handlerFromPath(url.pathname) !== handler) {\n      url.pathname = `/${handler}`\n      url.search = ''\n      window.history.replaceState({ page: handler }, '', url)\n    }\n    // Attach stuff.\n    this.attachHeader()\n    this.attachActions()\n    this.attachCommon(this.header)\n    this.attach({})\n\n    // If we are authed, populate notes, otherwise get we'll them from the login\n    // response.\n    if (this.authed) await this.fetchNotes()\n    this.updateMenuItemsDisplay()\n    // initialize desktop notifications\n    ntfn.fetchDesktopNtfnSettings()\n    // Connect the websocket and register the notification route.\n    ws.connect(getSocketURI(), () => this.reconnected())\n    ws.registerRoute(notificationRoute, (note: CoreNote) => {\n      this.notify(note)\n    })\n  }\n\n  /*\n   * reconnected is called by the websocket client when a reconnection is made.\n   */\n  reconnected () {\n    if (this.main?.dataset.handler === 'settings') window.location.assign('/')\n    else window.location.reload() // This triggers another websocket disconnect/connect (!)\n    // a fetchUser() and loadPage(window.history.state.page) might work\n  }\n\n  /*\n   * Fetch and save the user, which is the primary core state that must be\n   * maintained by the Application.\n   */\n  async fetchUser (): Promise<User | void> {\n    const resp: UserResponse = await getJSON('/api/user')\n    if (!this.checkResponse(resp)) return\n    this.inited = resp.inited\n    this.authed = Boolean(resp.user)\n    this.lang = resp.lang\n    this.langs = resp.langs\n    this.mmStatus = resp.mmStatus\n    if (!resp.user) return\n    const user = resp.user\n    this.seedGenTime = user.seedgentime\n    this.user = user\n    this.assets = user.assets\n    this.exchanges = user.exchanges\n    this.walletMap = {}\n    this.fiatRatesMap = user.fiatRates\n    for (const [assetID, asset] of (Object.entries(user.assets) as [any, SupportedAsset][])) {\n      if (asset.wallet) {\n        this.walletMap[assetID] = asset.wallet\n      }\n    }\n\n    this.updateMenuItemsDisplay()\n    return user\n  }\n\n  async fetchMMStatus () {\n    this.mmStatus = await MM.status()\n  }\n\n  /* Load the page from the server. Insert and bind the DOM. */\n  async loadPage (page: string, data?: any, skipPush?: boolean): Promise<boolean> {\n    // Close some menus and tooltips.\n    this.tooltip.style.left = '-10000px'\n    Doc.hide(this.page.noteBox, this.page.profileBox)\n    // Parse the request.\n    const url = new URL(`/${page}`, window.location.origin)\n    const requestedHandler = handlerFromPath(page)\n    // Fetch and parse the page.\n    const response = await window.fetch(url.toString())\n    if (!response.ok) return false\n    const html = await response.text()\n    const doc = Doc.noderize(html)\n    const main = idel(doc, 'main')\n    const delivered = main.dataset.handler\n    // Append the request to the page history.\n    if (!skipPush) {\n      const path = delivered === requestedHandler ? url.toString() : `/${delivered}`\n      window.history.pushState({ page: page, data: data }, '', path)\n    }\n    // Insert page and attach handlers.\n    document.title = doc.title\n    this.main.replaceWith(main)\n    this.main = main\n    this.noteReceivers = []\n    Doc.empty(this.headerSpace)\n    this.attach(data)\n    return true\n  }\n\n  /* attach binds the common handlers and calls the page constructor. */\n  attach (data: any) {\n    const handlerID = this.main.dataset.handler\n    if (!handlerID) {\n      console.error('cannot attach to content with no specified handler')\n      return\n    }\n    this.attachCommon(this.main)\n    if (this.loadedPage) this.loadedPage.unload()\n    const constructor = constructors[handlerID]\n    if (constructor) this.loadedPage = new constructor(this.main, data)\n    else this.loadedPage = null\n\n    // Bind the tooltips.\n    this.bindTooltips(this.main)\n\n    if (window.isWebview) {\n      // Bind webview URL handlers\n      this.bindUrlHandlers(this.main)\n    }\n\n    this.bindUnits(this.main)\n  }\n\n  bindTooltips (ancestor: HTMLElement) {\n    ancestor.querySelectorAll('[data-tooltip]').forEach((el: HTMLElement) => {\n      bind(el, 'mouseenter', () => {\n        this.tooltip.textContent = el.dataset.tooltip || ''\n        const lyt = Doc.layoutMetrics(el)\n        let left = lyt.centerX - this.tooltip.offsetWidth / 2\n        if (left < 0) left = 5\n        if (left + this.tooltip.offsetWidth > document.body.offsetWidth) {\n          left = document.body.offsetWidth - this.tooltip.offsetWidth - 5\n        }\n        this.tooltip.style.left = `${left}px`\n        this.tooltip.style.top = `${lyt.bodyTop - this.tooltip.offsetHeight - 5}px`\n      })\n      bind(el, 'mouseleave', () => {\n        this.tooltip.style.left = '-10000px'\n      })\n    })\n  }\n\n  /*\n   * bindUnits binds a hovering unit selection menu to the value or rate\n   * display elements. The menu gives users an option to convert the value\n   * to their preferred units.\n   */\n  bindUnits (main: PageElement) {\n    const div = document.createElement('div') as PageElement\n    div.classList.add('position-absolute', 'p-3')\n    // div.style.backgroundColor = 'yellow'\n    const rows = document.createElement('div') as PageElement\n    div.appendChild(rows)\n    rows.classList.add('body-bg', 'border')\n    const addRow = (el: PageElement, unit: string, cFactor: number) => {\n      const box = Doc.safeSelector(el, '[data-unit-box]')\n      const atoms = parseInt(box.dataset.atoms as string)\n      const row = document.createElement('div')\n      row.textContent = unit\n      rows.appendChild(row)\n      row.classList.add('p-2', 'hoverbg', 'pointer')\n      Doc.bind(row, 'click', () => {\n        Doc.setText(el, '[data-value]', Doc.formatFourSigFigs(atoms / cFactor, Math.round(Math.log10(cFactor))))\n        Doc.setText(el, '[data-unit]', unit)\n      })\n    }\n    for (const el of Doc.applySelector(main, '[data-conversion-value]')) {\n      const box = Doc.safeSelector(el, '[data-unit-box]')\n      Doc.bind(box, 'mouseenter', () => {\n        Doc.empty(rows)\n        box.appendChild(div)\n        const lyt = Doc.layoutMetrics(box)\n        const assetID = parseInt(box.dataset.assetID as string)\n        const { unitInfo: ui } = this.assets[assetID]\n        addRow(el, ui.conventional.unit, ui.conventional.conversionFactor)\n        for (const { unit, conversionFactor } of ui.denominations) addRow(el, unit, conversionFactor)\n        addRow(el, ui.atomicUnit, 1)\n        if (lyt.bodyTop > (div.offsetHeight + this.header.offsetHeight)) {\n          div.style.bottom = 'calc(100% - 1rem)'\n          div.style.top = 'auto'\n        } else {\n          div.style.top = 'calc(100% - 1rem)'\n          div.style.bottom = 'auto'\n        }\n      })\n      Doc.bind(box, 'mouseleave', () => div.remove())\n    }\n  }\n\n  bindUrlHandlers (ancestor: HTMLElement) {\n    if (!window.openUrl) return\n    for (const link of Doc.applySelector(ancestor, 'a[target=_blank]')) {\n      Doc.bind(link, 'click', (e: MouseEvent) => {\n        e.preventDefault()\n        window.openUrl(link.href ?? '')\n      })\n    }\n  }\n\n  /* attachHeader attaches the header element, which unlike the main element,\n   * isn't replaced during page navigation.\n   */\n  attachHeader () {\n    this.header = idel(document.body, 'header')\n    const page = this.page = Doc.idDescendants(this.header)\n    this.headerSpace = page.headerSpace\n    this.popupNotes = idel(document.body, 'popupNotes')\n    this.popupTmpl = Doc.tmplElement(this.popupNotes, 'note')\n    if (this.popupTmpl) this.popupTmpl.remove()\n    else console.error('popupTmpl element not found')\n    this.tooltip = idel(document.body, 'tooltip')\n    page.noteTmpl.removeAttribute('id')\n    page.noteTmpl.remove()\n    page.pokeTmpl.removeAttribute('id')\n    page.pokeTmpl.remove()\n    page.loader.remove()\n    Doc.show(page.loader)\n\n    bind(page.noteBell, 'click', async () => {\n      Doc.hide(page.pokeList)\n      Doc.show(page.noteList)\n      this.ackNotes()\n      page.noteCat.classList.add('active')\n      page.pokeCat.classList.remove('active')\n      this.showDropdown(page.noteBell, page.noteBox)\n      Doc.hide(page.noteIndicator)\n      for (const note of this.notes) {\n        if (note.acked) {\n          note.el.classList.remove('firstview')\n        }\n      }\n      this.setNoteTimes(page.noteList)\n      this.setNoteTimes(page.pokeList)\n    })\n\n    bind(page.burgerIcon, 'click', () => {\n      Doc.hide(page.logoutErr)\n      this.showDropdown(page.burgerIcon, page.profileBox)\n    })\n\n    bind(page.innerNoteIcon, 'click', () => { Doc.hide(page.noteBox) })\n    bind(page.innerBurgerIcon, 'click', () => { Doc.hide(page.profileBox) })\n\n    bind(page.profileSignout, 'click', async () => await this.signOut())\n\n    bind(page.pokeCat, 'click', () => {\n      this.setNoteTimes(page.pokeList)\n      page.pokeCat.classList.add('active')\n      page.noteCat.classList.remove('active')\n      Doc.hide(page.noteList)\n      Doc.show(page.pokeList)\n      this.ackNotes()\n    })\n\n    bind(page.noteCat, 'click', () => {\n      this.setNoteTimes(page.noteList)\n      page.noteCat.classList.add('active')\n      page.pokeCat.classList.remove('active')\n      Doc.hide(page.pokeList)\n      Doc.show(page.noteList)\n      this.ackNotes()\n    })\n\n    Doc.cleanTemplates(page.langBttnTmpl)\n    const { name, flag } = languageData[this.lang]\n    page.langFlag.textContent = flag\n    page.langName.textContent = name\n\n    for (const lang of this.langs) {\n      if (lang === this.lang) continue\n      const div = page.langBttnTmpl.cloneNode(true) as PageElement\n      const { name, flag } = languageData[lang]\n      div.textContent = flag\n      div.title = name\n      Doc.bind(div, 'click', () => this.setLanguage(lang))\n      page.langBttns.appendChild(div)\n    }\n  }\n\n  attachActions () {\n    const { page } = this\n    Object.assign(page, Doc.idDescendants(Doc.idel(document.body, 'requiredActions')))\n    Doc.cleanTemplates(page.missingNoncesTmpl, page.actionTxTableTmpl, page.tooCheapTmpl, page.lostNonceTmpl)\n    Doc.bind(page.actionsCollapse, 'click', () => {\n      Doc.hide(page.actionDialog)\n      Doc.show(page.actionDialogCollapsed)\n    })\n    Doc.bind(page.actionDialogCollapsed, 'click', () => {\n      Doc.hide(page.actionDialogCollapsed)\n      Doc.show(page.actionDialog)\n      if (page.actionDialogContent.children.length === 0) this.showOldestAction()\n    })\n    const showAdjacentAction = (dir: number) => {\n      const selected = Object.values(this.requiredActions).filter((r: requiredAction) => r.selected)[0]\n      const actions = this.sortedActions()\n      const idx = actions.indexOf(selected)\n      this.showRequestedAction(actions[idx + dir].uniqueID)\n    }\n    Doc.bind(page.prevAction, 'click', () => showAdjacentAction(-1))\n    Doc.bind(page.nextAction, 'click', () => showAdjacentAction(1))\n  }\n\n  setRequiredActions () {\n    const { user: { actions }, requiredActions } = this\n    if (!actions) return\n    for (const a of actions) this.addAction(a)\n    if (Object.keys(requiredActions).length) {\n      this.showOldestAction()\n      this.blinkAction()\n    }\n  }\n\n  sortedActions () {\n    const actions = Object.values(this.requiredActions)\n    actions.sort((a: requiredAction, b: requiredAction) => a.stamp - b.stamp)\n    return actions\n  }\n\n  showOldestAction () {\n    this.showRequestedAction(this.sortedActions()[0].uniqueID)\n  }\n\n  addAction (req: ActionRequiredNote) {\n    const { page, requiredActions } = this\n    const existingAction = requiredActions[req.uniqueID]\n    if (existingAction && existingAction.actionID === req.actionID) return\n    const div = this.actionForm(req)\n    if (existingAction) {\n      if (existingAction.selected) existingAction.div.replaceWith(div)\n      existingAction.div = div\n    } else {\n      requiredActions[req.uniqueID] = {\n        div,\n        stamp: (new Date()).getTime(),\n        uniqueID: req.uniqueID,\n        actionID: req.actionID,\n        selected: false\n      }\n      const n = Object.keys(requiredActions).length\n      page.actionDialogCount.textContent = String(n)\n      page.actionCount.textContent = String(n)\n      if (Doc.isHidden(page.actionDialog)) {\n        this.showRequestedAction(req.uniqueID)\n      }\n    }\n  }\n\n  blinkAction () {\n    Doc.blink(this.page.actionDialog)\n    Doc.blink(this.page.actionDialogCollapsed)\n  }\n\n  resolveAction (req: ActionResolvedNote) {\n    this.resolveActionWithID(req.uniqueID)\n  }\n\n  resolveActionWithID (uniqueID: string) {\n    const { page, requiredActions } = this\n    const existingAction = requiredActions[uniqueID]\n    if (!existingAction) return\n    delete requiredActions[uniqueID]\n    const rem = Object.keys(requiredActions).length\n    existingAction.div.remove()\n    if (rem === 0) {\n      Doc.hide(page.actionDialog, page.actionDialogCollapsed)\n      return\n    }\n    page.actionDialogCount.textContent = String(rem)\n    page.actionCount.textContent = String(rem)\n    if (existingAction.selected) this.showOldestAction()\n  }\n\n  actionForm (req: ActionRequiredNote) {\n    switch (req.actionID) {\n      case 'tooCheap':\n        return this.tooCheapAction(req)\n      case 'missingNonces':\n        return this.missingNoncesAction(req)\n      case 'lostNonce':\n        return this.lostNonceAction(req)\n      case 'redeemRejected':\n        return this.redeemRejectedAction(req)\n    }\n    throw Error('unknown required action ID ' + req.actionID)\n  }\n\n  actionTxTable (req: ActionRequiredNote) {\n    const { assetID, payload } = req\n    const n = payload as TransactionActionNote\n    const { unitInfo: ui, token } = this.assets[assetID]\n    const table = this.page.actionTxTableTmpl.cloneNode(true) as PageElement\n    const tmpl = Doc.parseTemplate(table)\n    tmpl.lostTxID.textContent = n.tx.id\n    tmpl.lostTxID.dataset.explorerCoin = n.tx.id\n    setCoinHref(token ? token.parentID : assetID, tmpl.lostTxID)\n    tmpl.txAmt.textContent = Doc.formatCoinValue(n.tx.amount, ui)\n    tmpl.amtUnit.textContent = ui.conventional.unit\n    const parentUI = token ? this.unitInfo(token.parentID) : ui\n    tmpl.type.textContent = txTypeString(n.tx.type)\n    tmpl.feeAmount.textContent = Doc.formatCoinValue(n.tx.fees, parentUI)\n    tmpl.feeUnit.textContent = parentUI.conventional.unit\n    switch (req.actionID) {\n      case 'tooCheap': {\n        Doc.show(tmpl.newFeesRow)\n        tmpl.newFees.textContent = Doc.formatCoinValue(n.tx.fees, parentUI)\n        tmpl.newFeesUnit.textContent = parentUI.conventional.unit\n        break\n      }\n    }\n    return table\n  }\n\n  async submitAction (req: ActionRequiredNote, action: any, errMsg: PageElement) {\n    Doc.hide(errMsg)\n    const loading = this.loading(this.page.actionDialog)\n    const res = await postJSON('/api/takeaction', {\n      assetID: req.assetID,\n      actionID: req.actionID,\n      action\n    })\n    loading()\n    if (!this.checkResponse(res)) {\n      errMsg.textContent = res.msg\n      Doc.show(errMsg)\n      return\n    }\n    this.resolveActionWithID(req.uniqueID)\n  }\n\n  missingNoncesAction (req: ActionRequiredNote) {\n    const { assetID } = req\n    const div = this.page.missingNoncesTmpl.cloneNode(true) as PageElement\n    const tmpl = Doc.parseTemplate(div)\n    const { name } = this.assets[assetID]\n    tmpl.assetName.textContent = name\n    Doc.bind(tmpl.doNothingBttn, 'click', () => {\n      this.submitAction(req, { recover: false }, tmpl.errMsg)\n    })\n    Doc.bind(tmpl.recoverBttn, 'click', () => {\n      this.submitAction(req, { recover: true }, tmpl.errMsg)\n    })\n    return div\n  }\n\n  tooCheapAction (req: ActionRequiredNote) {\n    const { assetID, payload } = req\n    const n = payload as TransactionActionNote\n    const div = this.page.tooCheapTmpl.cloneNode(true) as PageElement\n    const tmpl = Doc.parseTemplate(div)\n    const { name } = this.assets[assetID]\n    tmpl.assetName.textContent = name\n    tmpl.txTable.appendChild(this.actionTxTable(req))\n    const act = (bump: boolean) => {\n      this.submitAction(req, {\n        txID: n.tx.id,\n        bump\n      }, tmpl.errMsg)\n    }\n    Doc.bind(tmpl.keepWaitingBttn, 'click', () => act(false))\n    Doc.bind(tmpl.addFeesBttn, 'click', () => act(true))\n    return div\n  }\n\n  lostNonceAction (req: ActionRequiredNote) {\n    const { assetID, payload } = req\n    const n = payload as TransactionActionNote\n    const div = this.page.lostNonceTmpl.cloneNode(true) as PageElement\n    const tmpl = Doc.parseTemplate(div)\n    const { name } = this.assets[assetID]\n    tmpl.assetName.textContent = name\n    tmpl.nonce.textContent = String(n.nonce)\n    tmpl.txTable.appendChild(this.actionTxTable(req))\n    Doc.bind(tmpl.abandonBttn, 'click', () => {\n      this.submitAction(req, { txID: n.tx.id, abandon: true }, tmpl.errMsg)\n    })\n    Doc.bind(tmpl.keepWaitingBttn, 'click', () => {\n      this.submitAction(req, { txID: n.tx.id, abandon: false }, tmpl.errMsg)\n    })\n    Doc.bind(tmpl.replaceBttn, 'click', () => {\n      const replacementID = tmpl.idInput.value\n      if (!replacementID) {\n        tmpl.idInput.focus()\n        Doc.blink(tmpl.idInput)\n        return\n      }\n      this.submitAction(req, { txID: n.tx.id, abandon: false, replacementID }, tmpl.errMsg)\n    })\n    return div\n  }\n\n  redeemRejectedAction (req: ActionRequiredNote) {\n    const { orderID, coinID, coinFmt, assetID } = req.payload as RejectedRedemptionData\n    const div = this.page.rejectedRedemptionTmpl.cloneNode(true) as PageElement\n    const tmpl = Doc.parseTemplate(div)\n    const { name, token } = this.assets[assetID]\n    tmpl.assetName.textContent = name\n    tmpl.txid.textContent = coinFmt\n    tmpl.txid.dataset.explorerCoin = coinID\n    setCoinHref(token ? token.parentID : assetID, tmpl.txid)\n    Doc.bind(tmpl.doNothingBttn, 'click', () => {\n      this.submitAction(req, { orderID, coinID, retry: false }, tmpl.errMsg)\n    })\n    Doc.bind(tmpl.tryAgainBttn, 'click', () => {\n      this.submitAction(req, { orderID, coinID, retry: true }, tmpl.errMsg)\n    })\n    return div\n  }\n\n  showRequestedAction (uniqueID: string) {\n    const { page, requiredActions } = this\n    Doc.hide(page.actionDialogCollapsed)\n    for (const r of Object.values(requiredActions)) r.selected = r.uniqueID === uniqueID\n    Doc.empty(page.actionDialogContent)\n    const action = requiredActions[uniqueID]\n    page.actionDialogContent.appendChild(action.div)\n    Doc.show(page.actionDialog)\n    const actions = this.sortedActions()\n    if (actions.length === 1) {\n      Doc.hide(page.actionsNavigator)\n      return\n    }\n    Doc.show(page.actionsNavigator)\n    const idx = actions.indexOf(action)\n    page.currentAction.textContent = String(idx + 1)\n    page.prevAction.classList.toggle('invisible', idx === 0)\n    page.nextAction.classList.toggle('invisible', idx === actions.length - 1)\n  }\n\n  /*\n   * updateMarketElements sets the textContent for any ticker or asset name\n   * elements or any asset logo src attributes for descendents of ancestor.\n   */\n  updateMarketElements (ancestor: PageElement, baseID: number, quoteID: number, xc?: Exchange) {\n    const getAsset = (assetID: number) => {\n      const a = this.assets[assetID]\n      if (a) return a\n      if (!xc) throw Error(`no asset found for asset ID ${assetID}`)\n      const xcAsset = xc.assets[assetID]\n      return { unitInfo: xcAsset.unitInfo, name: xcAsset.symbol, symbol: xcAsset.symbol }\n    }\n    const { unitInfo: bui, name: baseName, symbol: baseSymbol } = getAsset(baseID)\n    for (const el of Doc.applySelector(ancestor, '[data-base-name')) el.textContent = baseName\n    for (const img of Doc.applySelector(ancestor, '[data-base-logo]')) img.src = Doc.logoPath(baseSymbol)\n    for (const el of Doc.applySelector(ancestor, '[data-base-ticker]')) el.textContent = bui.conventional.unit\n    const { unitInfo: qui, name: quoteName, symbol: quoteSymbol } = getAsset(quoteID)\n    for (const el of Doc.applySelector(ancestor, '[data-quote-name')) el.textContent = quoteName\n    for (const img of Doc.applySelector(ancestor, '[data-quote-logo]')) img.src = Doc.logoPath(quoteSymbol)\n    for (const el of Doc.applySelector(ancestor, '[data-quote-ticker]')) el.textContent = qui.conventional.unit\n  }\n\n  async setLanguage (lang: string) {\n    await postJSON('/api/setlocale', lang)\n    window.location.reload()\n  }\n\n  /*\n   * showDropdown sets the position and visibility of the specified dropdown\n   * dialog according to the position of its icon button.\n   */\n  showDropdown (icon: HTMLElement, dialog: HTMLElement) {\n    Doc.hide(this.page.noteBox, this.page.profileBox)\n    Doc.show(dialog)\n    if (window.innerWidth < 500) Object.assign(dialog.style, { left: '0', right: '0', top: '0' })\n    else {\n      const ico = icon.getBoundingClientRect()\n      const right = `${window.innerWidth - ico.left - ico.width + 5}px`\n      Object.assign(dialog.style, { left: 'auto', right, top: `${ico.top - 4}px` })\n    }\n\n    const hide = (e: MouseEvent) => {\n      if (!Doc.mouseInElement(e, dialog)) {\n        Doc.hide(dialog)\n        unbind(document, 'click', hide)\n        if (dialog === this.page.noteBox && Doc.isDisplayed(this.page.noteList)) {\n          this.ackNotes()\n        }\n      }\n    }\n    bind(document, 'click', hide)\n  }\n\n  ackNotes () {\n    const acks = []\n    for (const note of this.notes) {\n      if (note.acked) {\n        note.el.classList.remove('firstview')\n      } else {\n        note.acked = true\n        if (note.id && note.severity > ntfn.POKE) acks.push(note.id)\n      }\n    }\n    if (acks.length) ws.request('acknotes', acks)\n    Doc.hide(this.page.noteIndicator)\n  }\n\n  setNoteTimes (noteList: HTMLElement) {\n    for (const el of (Array.from(noteList.children) as NoteElement[])) {\n      Doc.safeSelector(el, 'span.note-time').textContent = Doc.timeSince(el.note.stamp)\n    }\n  }\n\n  /*\n   * bindInternalNavigation hijacks navigation by click on any local links that\n   * are descendants of ancestor.\n   */\n  bindInternalNavigation (ancestor: HTMLElement) {\n    const pageURL = new URL(window.location.href)\n    ancestor.querySelectorAll('a').forEach(a => {\n      if (!a.href) return\n      const url = new URL(a.href)\n      if (url.origin === pageURL.origin) {\n        const token = url.pathname.substring(1)\n        const params: Record<string, string> = {}\n        if (url.search) {\n          url.searchParams.forEach((v, k) => {\n            params[k] = v\n          })\n        }\n        Doc.bind(a, 'click', (e: Event) => {\n          e.preventDefault()\n          this.loadPage(token, params)\n        })\n      }\n    })\n  }\n\n  /*\n   * updateMenuItemsDisplay should be called when the user has signed in or out,\n   * and when the user registers a DEX.\n   */\n  updateMenuItemsDisplay () {\n    const { page, authed, mmStatus } = this\n    if (!page) {\n      // initial page load, header elements not yet attached but menu items\n      // would already be hidden/displayed as appropriate.\n      return\n    }\n    if (!authed) {\n      page.profileBox.classList.remove('authed')\n      Doc.hide(page.noteBell, page.walletsMenuEntry, page.marketsMenuEntry)\n      return\n    }\n    Doc.setVis(Object.keys(this.exchanges).length > 0, page.marketsMenuEntry, page.mmLink)\n\n    page.profileBox.classList.add('authed')\n    Doc.show(page.noteBell, page.walletsMenuEntry, page.marketsMenuEntry)\n    Doc.setVis(mmStatus, page.mmLink)\n  }\n\n  async fetchNotes () {\n    const res = await getJSON('/api/notes')\n    if (!this.checkResponse(res)) return console.error('failed to fetch notes:', res?.msg || String(res))\n    res.notes.reverse()\n    this.setNotes(res.notes)\n    this.setPokes(res.pokes)\n    this.setRequiredActions()\n  }\n\n  /* attachCommon scans the provided node and handles some common bindings. */\n  attachCommon (node: HTMLElement) {\n    this.bindInternalNavigation(node)\n  }\n\n  /*\n   * updateBondConfs updates the information for a pending bond.\n   */\n  updateBondConfs (dexAddr: string, coinID: string, confs: number) {\n    const dex = this.exchanges[dexAddr]\n    for (const bond of dex.auth.pendingBonds) if (bond.coinID === coinID) bond.confs = confs\n  }\n\n  updateTier (host: string, bondedTier: number) {\n    this.exchanges[host].auth.rep.bondedTier = bondedTier\n  }\n\n  /*\n   * handleBondNote is the handler for the 'bondpost'-type notification, which\n   * is used to update the dex tier and registration status.\n   */\n  handleBondNote (note: BondNote) {\n    if (note.auth) this.exchanges[note.dex].auth = note.auth\n    switch (note.topic) {\n      case 'RegUpdate':\n        if (note.coinID !== null) { // should never be null for RegUpdate\n          this.updateBondConfs(note.dex, note.coinID, note.confirmations)\n        }\n        break\n      case 'BondConfirmed':\n        if (note.tier !== null) { // should never be null for BondConfirmed\n          this.updateTier(note.dex, note.tier)\n        }\n        break\n      default:\n        break\n    }\n  }\n\n  /*\n   * handleTransaction either adds a new transaction to the transaction history\n   * or updates an existing transaction.\n   */\n  handleTransactionNote (assetID: number, note: TransactionNote) {\n    const txHistory = this.txHistoryMap[assetID]\n    if (!txHistory) return\n\n    if (note.new) {\n      txHistory.txs.unshift(note.transaction)\n      return\n    }\n\n    for (let i = 0; i < txHistory.txs.length; i++) {\n      if (txHistory.txs[i].id === note.transaction.id) {\n        txHistory.txs[i] = note.transaction\n        break\n      }\n    }\n  }\n\n  handleTxHistorySyncedNote (assetID: number) {\n    delete this.txHistoryMap[assetID]\n  }\n\n  loggedIn (notes: CoreNote[], pokes: CoreNote[]) {\n    this.setNotes(notes)\n    this.setPokes(pokes)\n    this.setRequiredActions()\n  }\n\n  /*\n   * setNotes sets the current notification cache and populates the notification\n   * display.\n   */\n  setNotes (notes: CoreNote[]) {\n    this.log('notes', 'setNotes', notes)\n    this.notes = []\n    Doc.empty(this.page.noteList)\n    for (let i = 0; i < notes.length; i++) {\n      this.prependNoteElement(notes[i])\n    }\n  }\n\n  /*\n   * setPokes sets the current poke cache and populates the pokes display.\n   */\n  setPokes (pokes: CoreNote[]) {\n    this.log('pokes', 'setPokes', pokes)\n    this.pokes = []\n    Doc.empty(this.page.pokeList)\n    for (let i = 0; i < pokes.length; i++) {\n      this.prependPokeElement(pokes[i])\n    }\n  }\n\n  botStatus (host: string, baseID: number, quoteID: number): MMBotStatus | undefined {\n    for (const bot of (this.mmStatus?.bots ?? [])) {\n      const { config: c } = bot\n      if (host === c.host && baseID === c.baseID && quoteID === c.quoteID) {\n        return bot\n      }\n    }\n  }\n\n  updateUser (note: CoreNote) {\n    const { user, assets, walletMap } = this\n    if (note.type === 'fiatrateupdate') {\n      this.fiatRatesMap = (note as RateNote).fiatRates\n      return\n    }\n    // Some notes can be received before we get a User during login.\n    if (!user) return\n    switch (note.type) {\n      case 'order': {\n        const orderNote = note as OrderNote\n        const order = orderNote.order\n        const mkt = user.exchanges[order.host].markets[order.market]\n        const tempID = orderNote.tempID\n\n        // Ensure market's inflight orders list is updated.\n        if (note.topic === 'AsyncOrderSubmitted') {\n          const inFlight = order as InFlightOrder\n          inFlight.tempID = tempID\n          if (!mkt.inflight) mkt.inflight = [inFlight]\n          else mkt.inflight.push(inFlight)\n          break\n        } else if (note.topic === 'AsyncOrderFailure') {\n          mkt.inflight = mkt.inflight.filter(ord => ord.tempID !== tempID)\n          break\n        } else {\n          for (const i in mkt.inflight || []) {\n            if (!(mkt.inflight[i].tempID === tempID)) continue\n            mkt.inflight = mkt.inflight.filter(ord => ord.tempID !== tempID)\n            break\n          }\n        }\n\n        // Updates given order in market's orders list if it finds it.\n        // Returns a bool which indicates if order was found.\n        mkt.orders = mkt.orders || []\n        const updateOrder = (mkt: Market, ord: Order) => {\n          const i = mkt.orders.findIndex((o: Order) => o.id === ord.id)\n          if (i === -1) return false\n          if (note.topic === 'OrderRetired') mkt.orders.splice(i, 1)\n          else mkt.orders[i] = ord\n          return true\n        }\n        // If the notification order already exists we update it.\n        // In case market's orders list is empty or the notification order isn't\n        // part of it we add it manually as this means the order was\n        // just placed.\n        if (!updateOrder(mkt, order)) mkt.orders.push(order)\n        break\n      }\n      case 'balance': {\n        const n: BalanceNote = note as BalanceNote\n        const asset = user.assets[n.assetID]\n        // Balance updates can come before the user is fetched after login.\n        if (!asset) break\n        const w = asset.wallet\n        if (w) w.balance = n.balance\n        break\n      }\n      case 'bondpost':\n        this.handleBondNote(note as BondNote)\n        break\n      case 'reputation': {\n        const n = note as ReputationNote\n        this.exchanges[n.host].auth.rep = n.rep\n        break\n      }\n      case 'walletstate':\n      case 'walletconfig': {\n        // assets can be null if failed to connect to dex server.\n        if (!assets) return\n        const wallet = (note as WalletConfigNote)?.wallet\n        if (!wallet) return\n        const asset = assets[wallet.assetID]\n        asset.wallet = wallet\n        walletMap[wallet.assetID] = wallet\n        break\n      }\n      case 'walletsync': {\n        const n = note as WalletSyncNote\n        const w = this.walletMap[n.assetID]\n        if (w) {\n          w.syncStatus = n.syncStatus\n          w.synced = w.syncStatus.synced\n          w.syncProgress = n.syncProgress\n        }\n        break\n      }\n      case 'match': {\n        const n = note as MatchNote\n        const ord = this.order(n.orderID)\n        if (ord) updateMatch(ord, n.match)\n        break\n      }\n      case 'conn': {\n        const n = note as ConnEventNote\n        const xc = user.exchanges[n.host]\n        if (xc) xc.connectionStatus = n.connectionStatus\n        break\n      }\n      case 'spots': {\n        const n = note as SpotPriceNote\n        const xc = user.exchanges[n.host]\n        // Spots can come before the user is fetched after login and before/while the\n        // markets page reload when it receives a dex conn note.\n        if (!xc || !xc.markets) break\n        for (const [mktName, spot] of Object.entries(n.spots)) xc.markets[mktName].spot = spot\n        break\n      }\n      case 'fiatrateupdate': {\n        this.fiatRatesMap = (note as RateNote).fiatRates\n        break\n      }\n      case 'actionrequired': {\n        const n = note as CoreActionRequiredNote\n        this.addAction(n.payload)\n        break\n      }\n      case 'walletnote': {\n        const n = note as WalletNote\n        switch (n.payload.route) {\n          case 'transaction': {\n            const txNote = n.payload as TransactionNote\n            this.handleTransactionNote(n.payload.assetID, txNote)\n            break\n          }\n          case 'actionRequired': {\n            const req = n.payload as ActionRequiredNote\n            this.addAction(req)\n            this.blinkAction()\n            break\n          }\n          case 'actionResolved': {\n            this.resolveAction(n.payload as ActionResolvedNote)\n          }\n        }\n        if (n.payload.route === 'transactionHistorySynced') {\n          this.handleTxHistorySyncedNote(n.payload.assetID)\n        }\n        break\n      }\n      case 'runstats': {\n        this.log('mm', { runstats: note })\n        const n = note as RunStatsNote\n        const bot = this.botStatus(n.host, n.baseID, n.quoteID)\n        if (bot) {\n          bot.runStats = n.stats\n          bot.running = Boolean(n.stats)\n          if (!n.stats) {\n            bot.latestEpoch = undefined\n            bot.cexProblems = undefined\n          }\n        }\n        break\n      }\n      case 'cexnote': {\n        const n = note as CEXNotification\n        switch (n.topic) {\n          case 'BalanceUpdate': {\n            const u = n.note as CEXBalanceUpdate\n            this.mmStatus.cexes[n.cexName].balances[u.assetID] = u.balance\n          }\n        }\n        break\n      }\n      case 'epochreport': {\n        const n = note as EpochReportNote\n        const bot = this.botStatus(n.host, n.baseID, n.quoteID)\n        if (bot) bot.latestEpoch = n.report\n        break\n      }\n      case 'cexproblems': {\n        const n = note as CEXProblemsNote\n        const bot = this.botStatus(n.host, n.baseID, n.quoteID)\n        if (bot) bot.cexProblems = n.problems\n        break\n      }\n    }\n  }\n\n  /*\n   * notify is the top-level handler for notifications received from the client.\n   * Notifications are propagated to the loadedPage.\n   */\n  notify (note: CoreNote) {\n    // Handle type-specific updates.\n    this.log('notes', 'notify', note)\n    this.updateUser(note)\n    // Inform the page.\n    for (const feeder of this.noteReceivers) {\n      const f = feeder[note.type]\n      if (!f) continue\n      try {\n        f(note)\n      } catch (error) {\n        console.error('note feeder error:', error.message ? error.message : error)\n        console.log(note)\n        console.log(error.stack)\n      }\n    }\n    // Discard data notifications.\n    if (note.severity < ntfn.POKE) return\n    // Poke notifications have their own display.\n    const { popupTmpl, popupNotes, showPopups } = this\n    if (showPopups) {\n      const span = popupTmpl.cloneNode(true) as HTMLElement\n      Doc.tmplElement(span, 'text').textContent = `${note.subject}: ${ntfn.plainNote(note.details)}`\n      const indicator = Doc.tmplElement(span, 'indicator')\n      if (note.severity === ntfn.POKE) {\n        Doc.hide(indicator)\n      } else setSeverityClass(indicator, note.severity)\n      popupNotes.appendChild(span)\n      Doc.show(popupNotes)\n      // These take up screen space. Only show max 5 at a time.\n      while (popupNotes.children.length > 5) popupNotes.removeChild(popupNotes.firstChild as Node)\n      setTimeout(async () => {\n        await Doc.animate(500, (progress: number) => {\n          span.style.opacity = String(1 - progress)\n        })\n        span.remove()\n        if (popupNotes.children.length === 0) Doc.hide(popupNotes)\n      }, 6000)\n    }\n    // Success and higher severity go to the bell dropdown.\n    if (note.severity === ntfn.POKE) this.prependPokeElement(note)\n    else this.prependNoteElement(note)\n\n    // show desktop notification\n    ntfn.desktopNotify(note)\n  }\n\n  /*\n   * registerNoteFeeder registers a feeder for core notifications. The feeder\n   * will be de-registered when a new page is loaded.\n   */\n  registerNoteFeeder (receivers: Record<string, (n: CoreNote) => void>) {\n    this.noteReceivers.push(receivers)\n  }\n\n  /*\n   * log prints to the console if a logger has been enabled. Loggers are created\n   * implicitly by passing a loggerID to log. i.e. you don't create a logger,\n   * you just log to it. Loggers are enabled by invoking a global function,\n   * enableLogger(loggerID, onOffBoolean), from the browser's js console. Your\n   * choices are stored across sessions. Some common and useful loggers are\n   * listed below, but this list is not meant to be comprehensive.\n   *\n   * LoggerID   Description\n   * --------   -----------\n   * notes      Notifications of all levels.\n   * book       Order book feed.\n   * ws.........Websocket connection status changes.\n   */\n  log (loggerID: string, ...msg: any) {\n    if (this.loggers[loggerID]) console.log(`${nowString()}[${loggerID}]:`, ...msg)\n    if (this.recorders[loggerID]) {\n      this.recorders[loggerID].push({\n        time: nowString(),\n        msg: msg\n      })\n    }\n  }\n\n  prependPokeElement (cn: CoreNote) {\n    const [el, note] = this.makePoke(cn)\n    this.pokes.push(note)\n    while (this.pokes.length > noteCacheSize) this.pokes.shift()\n    this.prependListElement(this.page.pokeList, note, el)\n  }\n\n  prependNoteElement (cn: CoreNote) {\n    const [el, note] = this.makeNote(cn)\n    this.notes.push(note)\n    while (this.notes.length > noteCacheSize) this.notes.shift()\n    const noteList = this.page.noteList\n    this.prependListElement(noteList, note, el)\n    this.bindUrlHandlers(el)\n    // Set the indicator color.\n    if (this.notes.length === 0 || (Doc.isDisplayed(this.page.noteBox) && Doc.isDisplayed(noteList))) return\n    let unacked = 0\n    const severity = this.notes.reduce((s, note) => {\n      if (!note.acked) unacked++\n      if (!note.acked && note.severity > s) return note.severity\n      return s\n    }, ntfn.IGNORE)\n    const ni = this.page.noteIndicator\n    setSeverityClass(ni, severity)\n    if (unacked) {\n      ni.textContent = String((unacked > noteCacheSize - 1) ? `${noteCacheSize - 1}+` : unacked)\n      Doc.show(ni)\n    } else Doc.hide(ni)\n  }\n\n  prependListElement (noteList: HTMLElement, note: CoreNotePlus, el: NoteElement) {\n    el.note = note\n    noteList.prepend(el)\n    while (noteList.children.length > noteCacheSize) noteList.removeChild(noteList.lastChild as Node)\n    this.setNoteTimes(noteList)\n  }\n\n  /*\n   * makeNote constructs a single notification element for the drop-down\n   * notification list.\n   */\n  makeNote (note: CoreNote): [NoteElement, CoreNotePlus] {\n    const el = this.page.noteTmpl.cloneNode(true) as NoteElement\n    if (note.severity > ntfn.POKE) {\n      const cls = note.severity === ntfn.SUCCESS ? 'good' : note.severity === ntfn.WARNING ? 'warn' : 'bad'\n      Doc.safeSelector(el, 'div.note-indicator').classList.add(cls)\n    }\n\n    Doc.safeSelector(el, 'div.note-subject').textContent = note.subject\n    ntfn.insertRichNote(Doc.safeSelector(el, 'div.note-details'), note.details)\n    const np: CoreNotePlus = { el, ...note }\n    return [el, np]\n  }\n\n  makePoke (note: CoreNote): [NoteElement, CoreNotePlus] {\n    const el = this.page.pokeTmpl.cloneNode(true) as NoteElement\n    Doc.tmplElement(el, 'subject').textContent = `${note.subject}:`\n    ntfn.insertRichNote(Doc.tmplElement(el, 'details'), note.details)\n    const np: CoreNotePlus = { el, ...note }\n    return [el, np]\n  }\n\n  /*\n   * loading appends the loader to the specified element and displays the\n   * loading icon. The loader will block all interaction with the specified\n   * element until Application.loaded is called.\n   */\n  loading (el: HTMLElement): () => void {\n    const loader = this.page.loader.cloneNode(true) as HTMLElement\n    el.appendChild(loader)\n    return () => { loader.remove() }\n  }\n\n  /* orders retrieves a list of orders for the specified dex and market\n   * including inflight orders.\n   */\n  orders (host: string, mktID: string): Order[] {\n    let orders: Order[] = []\n    const mkt = this.user.exchanges[host].markets[mktID]\n    if (mkt.orders) orders = orders.concat(mkt.orders)\n    if (mkt.inflight) orders = orders.concat(mkt.inflight)\n    return orders\n  }\n\n  /*\n   * haveActiveOrders returns whether or not there are active orders involving a\n   * certain asset.\n   */\n  haveActiveOrders (assetID: number): boolean {\n    for (const xc of Object.values(this.user.exchanges)) {\n      if (!xc.markets) continue\n      for (const market of Object.values(xc.markets)) {\n        if (!market.orders) continue\n        for (const ord of market.orders) {\n          if ((ord.baseID === assetID || ord.quoteID === assetID) &&\n            (ord.status < StatusExecuted || hasActiveMatches(ord))) return true\n        }\n      }\n    }\n    return false\n  }\n\n  /* order attempts to locate an order by order ID. */\n  order (oid: string): Order | null {\n    for (const xc of Object.values(this.user.exchanges)) {\n      if (!xc || !xc.markets) continue\n      for (const market of Object.values(xc.markets)) {\n        if (!market.orders) continue\n        for (const ord of market.orders) {\n          if (ord.id === oid) return ord\n        }\n      }\n    }\n    return null\n  }\n\n  /*\n   * canAccelerateOrder returns true if the \"from\" wallet of the order\n   * supports acceleration, and if the order has unconfirmed swap\n   * transactions.\n   */\n  canAccelerateOrder (order: Order): boolean {\n    const walletTraitAccelerator = 1 << 4\n    let fromAssetID\n    if (order.sell) fromAssetID = order.baseID\n    else fromAssetID = order.quoteID\n    const wallet = this.walletMap[fromAssetID]\n    if (!wallet || !(wallet.traits & walletTraitAccelerator)) return false\n    if (order.matches) {\n      for (let i = 0; i < order.matches?.length; i++) {\n        const match = order.matches[i]\n        if (match.swap && match.swap.confs && match.swap.confs.count === 0 && !match.revoked) {\n          return true\n        }\n      }\n    }\n    return false\n  }\n\n  /*\n   * unitInfo fetches unit info [dex.UnitInfo] for the asset. If xc\n   * [core.Exchange] is provided, and this is not a SupportedAsset, the UnitInfo\n   * sent from the exchange's assets map [dex.Asset] will be used.\n   */\n  unitInfo (assetID: number, xc?: Exchange): UnitInfo {\n    const supportedAsset = this.assets[assetID]\n    if (supportedAsset) return supportedAsset.unitInfo\n    if (!xc || !xc.assets) {\n      throw Error(intl.prep(intl.ID_UNSUPPORTED_ASSET_INFO_ERR_MSG, { assetID: `${assetID}` }))\n    }\n    return xc.assets[assetID].unitInfo\n  }\n\n  parentAsset (assetID: number) : SupportedAsset {\n    const asset = this.assets[assetID]\n    if (!asset.token) return asset\n    return this.assets[asset.token.parentID]\n  }\n\n  /*\n  * baseChainSymbol returns the symbol for the asset's parent if the asset is a\n  * token, otherwise the symbol for the asset itself.\n  */\n  baseChainSymbol (assetID: number) {\n    const asset = this.user.assets[assetID]\n    return asset.token ? this.user.assets[asset.token.parentID].symbol : asset.symbol\n  }\n\n  /*\n   * extensionWallet returns the ExtensionConfiguredWallet for the asset, if\n   * it exists.\n   */\n  extensionWallet (assetID: number) {\n    return this.user.extensionModeConfig?.restrictedWallets[this.baseChainSymbol(assetID)]\n  }\n\n  /* conventionalRate converts the encoded atomic rate to a conventional rate */\n  conventionalRate (baseID: number, quoteID: number, encRate: number, xc?: Exchange): number {\n    const [b, q] = [this.unitInfo(baseID, xc), this.unitInfo(quoteID, xc)]\n\n    const r = b.conventional.conversionFactor / q.conventional.conversionFactor\n    return encRate * r / RateEncodingFactor\n  }\n\n  walletDefinition (assetID: number, walletType: string): WalletDefinition {\n    const asset = this.assets[assetID]\n    if (asset.token) return asset.token.definition\n    if (!asset.info) throw Error('where\\'s the wallet info?')\n    if (walletType === '') return asset.info.availablewallets[asset.info.emptyidx]\n    return asset.info.availablewallets.filter(def => def.type === walletType)[0]\n  }\n\n  currentWalletDefinition (assetID: number): WalletDefinition {\n    const asset = this.assets[assetID]\n    if (asset.token) {\n      return asset.token.definition\n    }\n    return this.walletDefinition(assetID, this.assets[assetID].wallet.type)\n  }\n\n  /*\n   * fetchBalance requests a balance update from the API. The API response does\n   * include the balance, but we're ignoring it, since a balance update\n   * notification is received via the Application anyways.\n   */\n  async fetchBalance (assetID: number): Promise<WalletBalance> {\n    const res: BalanceResponse = await postJSON('/api/balance', { assetID: assetID })\n    if (!this.checkResponse(res)) {\n      throw new Error(`failed to fetch balance for asset ID ${assetID}`)\n    }\n    return res.balance\n  }\n\n  /*\n   * checkResponse checks the response object as returned from the functions in\n   * the http module. If the response indicates that the request failed, it\n   * returns false, otherwise, true.\n   */\n  checkResponse (resp: APIResponse): boolean {\n    return (resp.requestSuccessful && resp.ok)\n  }\n\n  /**\n   * signOut call to /api/logout, if response with no errors occurred remove auth\n   * and other privacy-critical cookies/locals and reload the page, otherwise\n   * show a notification.\n   */\n  async signOut () {\n    const res = await postJSON('/api/logout')\n    if (!this.checkResponse(res)) {\n      if (res.code === Errors.activeOrdersErr) {\n        this.page.logoutErr.textContent = intl.prep(intl.ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG)\n      } else {\n        this.page.logoutErr.textContent = res.msg\n      }\n      Doc.show(this.page.logoutErr)\n      return\n    }\n    State.removeCookie(State.authCK)\n    State.removeCookie(State.pwKeyCK)\n    State.removeLocal(State.notificationsLK) // Notification storage was DEPRECATED pre-v1.\n    window.location.href = '/login'\n  }\n\n  /*\n   * txHistory loads the tx history for an asset. If the results are not\n   * already cached, they are cached. If we have reached the oldest tx,\n   * this fact is also cached. If the exact amount of transactions as have been\n   * made are requested, we will not know if we have reached the last tx until\n   * a subsequent call.\n  */\n  async txHistory (assetID: number, n: number, after?: string): Promise<TxHistoryResult> {\n    const url = '/api/txhistory'\n    const cachedTxHistory = this.txHistoryMap[assetID]\n    if (!cachedTxHistory) {\n      const res = await postJSON(url, {\n        n: n,\n        assetID: assetID\n      })\n      if (!this.checkResponse(res)) {\n        throw new Error(res.msg)\n      }\n      let txs : WalletTransaction[] | null | undefined = res.txs\n      if (!txs) {\n        txs = []\n      }\n      this.txHistoryMap[assetID] = {\n        txs: txs,\n        lastTx: txs.length < n\n      }\n      return this.txHistoryMap[assetID]\n    }\n    const txs : WalletTransaction[] = []\n    let lastTx = false\n    const startIndex = after ? cachedTxHistory.txs.findIndex(tx => tx.id === after) + 1 : 0\n    if (after && startIndex === -1) {\n      throw new Error('invalid after tx ' + after)\n    }\n    let lastIndex = startIndex\n    for (let i = startIndex; i < cachedTxHistory.txs.length && txs.length < n; i++) {\n      txs.push(cachedTxHistory.txs[i])\n      lastIndex = i\n      after = cachedTxHistory.txs[i].id\n    }\n    if (cachedTxHistory.lastTx && lastIndex === cachedTxHistory.txs.length - 1) {\n      lastTx = true\n    }\n    if (txs.length < n && !cachedTxHistory.lastTx) {\n      const res = await postJSON(url, {\n        n: n - txs.length + 1, // + 1 because first result will be refID\n        assetID: assetID,\n        refID: after,\n        past: true\n      })\n      if (!this.checkResponse(res)) {\n        throw new Error(res.msg)\n      }\n      let resTxs : WalletTransaction[] | null | undefined = res.txs\n      if (!resTxs) {\n        resTxs = []\n      }\n      if (resTxs.length > 0 && after) {\n        if (resTxs[0].id === after) {\n          resTxs.shift()\n        } else {\n          // Implies a bug in the client\n          console.error('First tx history element != refID')\n        }\n      }\n      cachedTxHistory.lastTx = resTxs.length < n - txs.length\n      lastTx = cachedTxHistory.lastTx\n      txs.push(...resTxs)\n      cachedTxHistory.txs.push(...resTxs)\n    }\n    return { txs, lastTx }\n  }\n\n  getWalletTx (assetID: number, txID: string): WalletTransaction | undefined {\n    const cachedTxHistory = this.txHistoryMap[assetID]\n    if (!cachedTxHistory) return undefined\n    return cachedTxHistory.txs.find(tx => tx.id === txID)\n  }\n\n  clearTxHistory (assetID: number) {\n    delete this.txHistoryMap[assetID]\n  }\n\n  async needsCustomProvider (assetID: number): Promise<boolean> {\n    const baseChainID = this.assets[assetID]?.token?.parentID ?? assetID\n    if (!baseChainID) return false\n    const w = this.walletMap[baseChainID]\n    if (!w) return false\n    const traitAccountLocker = 1 << 14\n    if ((w.traits & traitAccountLocker) === 0) return false\n    const res = await postJSON('/api/walletsettings', { assetID: baseChainID })\n    if (!this.checkResponse(res)) {\n      console.error(res.msg)\n      return false\n    }\n    const settings = res.map as Record<string, string>\n    return !settings.providers\n  }\n}\n\n/* getSocketURI returns the websocket URI for the client. */\nfunction getSocketURI (): string {\n  const protocol = (window.location.protocol === 'https:') ? 'wss' : 'ws'\n  return `${protocol}://${window.location.host}/ws`\n}\n\n/*\n * severityClassMap maps a notification severity level to a CSS class that\n * assigns a background color.\n */\nconst severityClassMap: Record<number, string> = {\n  [ntfn.SUCCESS]: 'good',\n  [ntfn.ERROR]: 'bad',\n  [ntfn.WARNING]: 'warn'\n}\n\n/* handlerFromPath parses the handler name from the path. */\nfunction handlerFromPath (path: string): string {\n  return path.replace(/^\\//, '').split('/')[0].split('?')[0].split('#')[0]\n}\n\n/* nowString creates a string formatted like HH:MM:SS.xxx */\nfunction nowString (): string {\n  const stamp = new Date()\n  const h = stamp.getHours().toString().padStart(2, '0')\n  const m = stamp.getMinutes().toString().padStart(2, '0')\n  const s = stamp.getSeconds().toString().padStart(2, '0')\n  const ms = stamp.getMilliseconds().toString().padStart(3, '0')\n  return `${h}:${m}:${s}.${ms}`\n}\n\nfunction setSeverityClass (el: HTMLElement, severity: number) {\n  el.classList.remove('bad', 'warn', 'good')\n  el.classList.add(severityClassMap[severity])\n}\n\n/* updateMatch updates the match in or adds the match to the order. */\nfunction updateMatch (order: Order, match: Match) {\n  for (const i in order.matches) {\n    const m = order.matches[i]\n    if (m.matchID === match.matchID) {\n      order.matches[i] = match\n      return\n    }\n  }\n  order.matches = order.matches || []\n  order.matches.push(match)\n}\n","import Application from './js/app'\nimport { registerApplication } from './js/registry'\nimport './css/bootstrap.scss'\nimport './css/application.scss'\n\nconst app = new Application()\nregisterApplication(app)\napp.start()\n"],"names":["_typeof","_regeneratorRuntime","module","exports","__esModule","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","undefined","done","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","get","prop","_arrayLikeToArray","arr","len","arr2","Array","_unsupportedIterableToArray","minLen","toString","from","test","_toConsumableArray","isArray","_slicedToArray","_i","_s","_e","_x","_r","_arr","_n","_d","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","_classCallCheck","instance","Constructor","_toPropertyKey","input","prim","toPrimitive","res","hint","String","_defineProperties","target","props","descriptor","_createClass","protoProps","staticProps","_defineProperty","_assertThisInitialized","ReferenceError","_setPrototypeOf","p","bind","_inherits","subClass","superClass","_possibleConstructorReturn","_getPrototypeOf","State","cname","cvalue","Date","setTime","getTime","expires","toUTCString","document","cookie","_step","_iterator","_createForOfIteratorHelper","split","s","_cstr$split2","k","v","trim","e","f","cKey","concat","fetchLocal","darkModeLK","window","localStorage","setItem","JSON","stringify","getItem","parse","removeItem","requestJSON","_x2","_x3","_requestJSON","_callee","addr","reqBody","response","_context","fetch","headers","Headers","body","status","json","requestSuccessful","t0","text","msg","postJSON","_x4","_x5","_postJSON","_callee2","data","_context2","getJSON","_x6","_getJSON","_callee3","_context3","storeLocal","popupsLK","leftMarketDockLK","locale","Errors","ID_NO_PASS_ERROR_MSG","ID_BUY","ID_SELL","ID_VERSION_NOT_SUPPORTED","ID_NO_ASSET_WALLET","ID_EXECUTED","ID_BOOKED","ID_CANCELING","ID_PASSWORD_NOT_MATCH","ID_UNKNOWN","ID_SETTLING","ID_CANCELED","ID_REVOKED","ID_NONE_SELECTED","ID_API_ERROR","ID_LOCKED","ID_INVALID_ADDRESS_MSG","ID_LIMIT_ORDER","ID_MARKET_ORDER","ID_MATCH_STATUS_REDEMPTION_SENT","ID_MATCH_STATUS_REDEMPTION_CONFIRMED","ID_MATCH_STATUS_REFUND_PENDING","ID_ORDER_ACCELERATION_ERR_MSG","ID_DISCONNECTED","ID_BROWSER_NTFN_ENABLED","ID_ORDER_BUTTON_BUY_BALANCE_ERROR","ID_ORDER_BUTTON_SELL_BALANCE_ERROR","ID_ORDER_BUTTON_QTY_ERROR","ID_ORDER_BUTTON_QTY_RATE_ERROR","ID_CREATE_ASSET_WALLET_MSG","ID_TRADING_TIER_UPDATED","ID_INVALID_TIER_VALUE","ID_MATCH_BUFFER","ID_NO_PLACEMENTS","ID_INVALID_VALUE","ID_NO_ZERO","ID_BOTTYPE_BASIC_MM","ID_BOTTYPE_ARB_MM","ID_BOTTYPE_SIMPLE_ARB","ID_CEXBALANCE_ERR","ID_PENDING","ID_COMPLETE","ID_CEX_NOT_CONNECTED","loadLocale","_loadLocale","lang","commitHash","skipCache","specs","localeSpecsKey","localeKey","prep","expression","replace","_","stringTemplateParser","clearLocale","removeLocal","parser","DOMParser","BipIDs","BipSymbolIDs","_Object$keys","parseInt","BipSymbols","RateEncodingFactor","log10RateEncodingFactor","Math","round","log10","languages","navigator","filter","intFormatter","Intl","NumberFormat","maximumFractionDigits","fourSigFigs","minimumSignificantDigits","maximumSignificantDigits","decimalFormatters","fullPrecisionFormatters","fullPrecisionFormatter","prec","locales","formatter","formatters","min","max","fmt","minimumFractionDigits","convertToConventional","unitInfo","conventional","conversionFactor","Doc","_blink","_animate","el","id","querySelector","ev","opts","_step2","_iterator2","addEventListener","removeEventListener","html","parseFromString","contains","rect","getBoundingClientRect","pageX","left","right","pageY","top","bottom","box","docEl","documentElement","scrollTop","scrollLeft","w","offsetWidth","h","offsetHeight","bodyTop","bodyLeft","width","height","centerX","centerY","parent","kid","parentMetrics","layoutMetrics","kidMetrics","_len","els","_key","_i2","_els","firstChild","removeChild","ancestor","empty","_len2","kids","_key2","_i3","_kids","appendChild","_len3","_key3","_i4","_els2","classList","add","_len4","_key4","_i5","_els3","remove","timeout","_this","_len5","_key5","show","setTimeout","hide","vis","_len6","_key6","duration","easingAlgo","Animation","wait","_ref","_ref2","r","g","b","isDark","animate","style","outline","querySelectorAll","children","console","warn","createElement","_step3","_iterator3","applySelector","vAtomic","_convertToConventiona2","Number","isInteger","format","decimalFormatter","encRate","bui","qui","rateStepEnc","convRate","rateStepDigits","floor","maxDecimals","sigFigFormatter","_sigFigFormatter$form","_sigFigFormatter$form2","formatToParts","part","formatSigFigsWithFormatters","_convertToConventiona6","rate","intl","atoms","ui","prefs","unitFactors","_unitFactors","atomicUnit","unit","denominations","alt","resolveUnitConversions","logDiffs","entryDiff","abs","_i6","_Object$entries","entries","best","reduce","cFactor","_this$bestConversion2","bestConversion","_this$bestConversion4","formatFourSigFigs","assetID","formatBestValueElement","setText","feeRateDenom","_this$formatBestUnits2","formatBestUnitsFourSigFigs","span","safeSelector","dataset","baseUnitInfo","quoteUnitInfo","_ref3","symbol","indexOf","substring","bipSymbol","parts","logoPath","asset","useLogo","ticker","symbolSpan","textContent","toUpperCase","parentSymbol","parentLogo","src","parentSup","selector","_step4","_iterator4","_step5","_iterator5","_len7","tmpls","_key7","tmpl","removeAttribute","_step6","_iterator6","ms","formatDuration","secs","m","padStart","dur","y","mo","seconds","count","_timeMod2","timeMod","aYear","_timeMod4","aMonth","_timeMod6","aDay","_timeMod8","anHour","_timeMod10","aMinute","_timeMod12","_len8","inputFields","_key8","_i7","_inputFields","inputField","passive","display","amount","formatFiatConversion","parentElement","thread","run","_stopAndWait","_wait","_run","easer","start","end","range","frameDuration","now","Easing","linear","Forever","MAX_SAFE_INTEGER","endAnimation","runCompletionFunction","sleep","_x7","_callee4","_context4","_callee5","_context5","t","easeIn","easeOut","easeInHard","easeOutHard","easeOutElastic","c4","PI","pow","sin","WalletIcons","stateElement","icons","sleeping","locked","unlocked","nowallet","syncing","nopeers","disabled","tooltip","wallet","syncIcon","running","peerCount","synced","syncProgress","toFixed","setSyncing","open","AniToggle","toggle","errorEl","initialState","callback","_this2","_ref4","_callee6","newState","_context6","stopPropagation","toggling","_x8","setState","NumberInput","_opts$prec","_opts$changed","_opts$min","_this3","sigFigs","toFourSigFigs","toPrecision","changed","set","inputChanged","_fmt2","parseFloatDefault","IncrementalInput","_NumberInput","_super","_opts$inc","_this4","inc","up","down","increment","sign","MiniSlider","_this5","color","track","ball","button","preventDefault","startX","clientWidth","startLeft","trackMouse","ee","l","mouseUp","unbind","x","clamp","ord","endsWith","maxPrec","inputValue","defaultValue","parseFloat","setupCopyBtn","_x9","_x10","_x11","_x12","_setupCopyBtn","_callee7","txt","textEl","btnEl","textOriginalColor","btnOriginalColor","_context7","clipboard","writeText","application","orderOptTmpl","booleanOptTmpl","rangeOptTmpl","BasePage","ConnectionStatus","ApprovalStatus","PeerSource","PrepaidBondID","app","setOptionTemplates","page","threeSigFigs","Option","opt","report","node","cloneNode","parseTemplate","optName","displayname","description","chainIcon","on","enable","disable","BooleanOption","_Option","_createSuper","dict","cfg","control","controls","reason","store","XYRangeOption","_Option2","_super2","xyRange","setVal","handler","XYRangeHandler","selected","settingsDict","settingsKey","setValue","initVal","_opts$settingsKey","_opts$selected","_opts$updated","rangeLblStart","label","rangeLblEnd","xUnit","yUnit","roundX","Boolean","roundY","setDisabled","updated","convert","slider","rangeX","rangeY","normalizeX","scrollingX","accept","skipUpdate","clickOutX","xInput","xx","focus","clickOutY","yInput","yy","emit","skipChange","sliderBox","_cfg","rEffective","sellString","sell","toLowerCase","toLocaleLowerCase","typeString","tif","isMarketBuy","hasActiveMatches","order","matches","active","statusString","isLive","cancelling","filled","qty","match","isCancel","settled","side","averageMarketOrderRateString","_ord$matches","rateStr","formatCoinValue","conventionalRate","baseID","quoteID","averageRate","_ord$matches2","rateProduct","baseQty","baseToQuote","base","revokedMatchStatus","matchStatus","isCancellable","PIPI","plusChar","fromCharCode","minusChar","darkTheme","axisLabel","gridBorder","gridLines","gapLine","zoom","zoomHover","sellLine","buyLine","sellFill","buyFill","crosshairs","legendFill","legendText","lightTheme","Chart","reporters","theme","canvas","visible","ctx","getContext","textAlign","textBaseline","mousePos","clientX","clientY","draw","ResizeObserver","resize","observe","wheelLimiter","wheel","click","setVis","visibilityState","renderScheduled","unattachers","clearRect","render","deltaY","clientHeight","plotExtents","Extents","xLblExtents","yLblExtents","plotRegion","Region","xRegion","yRegion","requestAnimationFrame","bigger","u","fontSize","font","fillStyle","labels","minX","maxX","unitLines","extents","plot","tools","applyLabelStyle","lastX","unitCenter","leftEdge","rightEdge","lbls","lbl","measureText","fillText","lineWidth","strokeStyle","line","minY","maxY","_this6","fillRect","save","beginPath","roundRect","fill","restore","lastY","xPad","region","_this7","step","valFmt","yLabels","makeLabels","dataExtents","yAxisWidth","widest","x0","y0","x1","y1","skipStroke","radius","dot","DepthChart","_Chart","_this8","resized","clicked","zoomed","zoomLevel","lines","markers","buys","sells","setZoomBttns","zoomInBttn","zoomOutBttn","book","wheeled","translator","unx","lotSize","conventionalRateStep","baseUnit","quoteUnit","_this$gap2","gap","midGap","gapWidth","minZoom","_this9","clear","_this$gap4","halfWindow","high","low","buyMarkers","sellMarkers","sort","buyDepth","buyEpoch","sellDepth","sellEpoch","volumeReport","buyBase","buyQuote","sellBase","sellQuote","sum","epochSum","epoch","floatCompare","shift","buySum","last","epochBuySum","sellSum","epochSellSum","growthFactor","mouseData","xLabels","plotXGrid","makeYLabels","plotYGrid","topCenterX","midX","topCenterY","zoomPct","xRange","zoomText","bttnLeft","bttnTop","bttnSize","setExtents","hover","midY","tolerance","hoverMarkers","marker","hovered","withinTolerance","size","tip","sqrt","moveTo","lineTo","closePath","stroke","dataX","evalSide","trigger","ptX","dotColor","bestDepth","pt","setLineDash","depth","drawDepth","plotYLabels","plotXLabels","volume","mouse","firstPt","yZero","globalAlpha","bestGapBuy","bestGapSell","CandleChart","_Chart2","_this10","numToShow","_this11","ext","candleExtents","yRange","candleRegion","volumeExtents","volumeRegion","resizeTimer","clearTimeout","idx","zoomLevels","candles","_app$assets$this$mark","_this12","candleWidth","allCandles","c","truncate","endStamp","paddedStart","paddedWidth","first","highRate","lowRate","matchVolume","highVol","xStart","xEnd","rateStep","market","ratestep","mouseCandle","selectedStartStamp","rFactor","rateConversionFactor","assets","baseid","basesymbol","screenW","diff","tick","zoneOffset","getTimezoneOffset","dayStamp","lastDay","lastYear","pts","months","getMonth","getDate","getHours","getMinutes","year","getFullYear","makeCandleTimeLabels","volDataExtents","startRate","endRate","_ref5","cx","strokeRect","yExt","rangeTxt","toLocaleString","rangeWidth","xExt","rectArgs","rangeHeight","_ref6","qFactor","bFactor","maxCandles","Wave","_Chart3","_super3","_this13","zIndex","random","colorShift","amplitudes","ks","speeds","phases","single","angularX","angularTime","cos","ani","drawValues","_ref7","cw","ch","message","ypad","halfH","msgRegion","_this14","hsl","_this$canvas","_this$opts","bg","backgroundColor","lineCap","grad","createLinearGradient","addColorStop","prog","xMin","xMax","yMin","yMax","screenMinX","screenMaxY","screenH","xFactor","yFactor","_y2","uny","_w2","_h2","drawFunc","skipMask","clip","spacingGuess","tickGuess","absMax","unitW","arc","ReputationMeter","div","cleanTemplates","penaltyMarkerTmpl","host","_app$exchanges$host","exchanges","auth","maxScore","penaltyThreshold","score","rep","displayTier","strongTier","minScore","warnPct","scoreWarn","pos","scorePointer","scoreMin","scoreMax","bonus","limitBonus","scoreTray","markerPct","scoreData","weakStrength","targetTier","effectiveTier","preparcelQuantity","mkt","_mkt$spot","_mkt$spot2","spot","bookVolume","lotsize","parcelWeight","_mkt$spot3","likelyTaker","epochWeight","bookWeight","settlingWeight","coinIDTakerFoundMakerRedemption","ethBasedExplorerArg","cid","startsWith","ethExplorers","_ethExplorers","_ethBasedExplorerArg2","_ethBasedExplorerArg4","_ethBasedExplorerArg6","polygonExplorers","_polygonExplorers","_ethBasedExplorerArg8","_ethBasedExplorerArg10","_ethBasedExplorerArg12","CoinExplorers","_cid$split2","txid","vout","_cid$split4","_cid$split6","_2","_3","_4","_5","_6","_7","_8","_9","_10","formatCoinID","makerAddr","setCoinHref","link","net","user","assetExplorer","token","parentID","baseChainID","href","explorerCoin","GapStrategyMultiplier","GapStrategyAbsolute","GapStrategyAbsolutePlus","GapStrategyPercent","GapStrategyPercentPlus","botTypeBasicMM","botTypeArbMM","botTypeBasicArb","CEXDisplayInfos","logo","MM","MarketMakerBot","_cexBalance","_status","_stopBot","_startBot","_report","_removeBotConfig","_updateCEXConfig","_updateBotConfig","config","startTime","_Object$values","mmStatus","bots","botStatus","runStats","cexName","_this$cexBalanceCache","cexBalanceCache","_callee8","cexBalance","_context8","runningBotInventory","_c$assetID$locked","_c$assetID","_c$assetID$reserved","_c$assetID2","_c$assetID$available","_c$assetID3","_d$assetID$locked","_d$assetID","_d$assetID$reserved","_d$assetID2","_d$assetID$available","_d$assetID3","_d$assetID$available2","_d$assetID4","_c$assetID$available2","_c$assetID4","_d$assetID$locked2","_d$assetID5","_c$assetID$locked2","_c$assetID5","dexBalances","cexBalances","cex","reserved","avail","available","total","dex","setMarketElements","_app$assets$baseID","baseName","baseSymbol","baseToken","setSrc","_app$assets","baseFeeUI","baseFeeName","baseFeeSymbol","_app$assets$quoteID","quoteName","quoteSymbol","quoteToken","_app$assets2","quoteFeeUI","quoteFeeName","quoteFeeSymbol","setCexElements","dinfo","img","calculateQuoteLot","baseRate","fiatRatesMap","quoteRate","OrderUtil","PlacementsChart","loadedCEX","cexLogo","Image","_cfg$dict","buyPlacements","sellPlacements","profit","baseFiatRate","botType","drawDashedLine","isBasicMM","cexGapL","cexGapR","buyLots","lots","sellLots","maxLots","fauxSpacer","leftmost","gapFactor","rightmost","ps","matchBuffer","minRange","maxCommitUSD","regionHeight","log","drawImage","plotSide","isBuy","placements","reg","_ref8","sideFactor","firstX","cumulativeLots","rawX","xInfinity","hostedMarketID","liveBotConfig","liveBotStatus","statuses","sumLots","BotMarket","find","_ref9","_app$assets$baseID2","baseTicker","baseFactor","baseFeeID","_app$assets$this$base","baseWallet","baseIsAccountLocker","traits","baseFeeTicker","baseFeeFactor","_app$assets$quoteID2","quoteTicker","quoteFactor","quoteFeeID","_app$assets$this$quot","quoteWallet","quoteIsAccountLocker","quoteFeeTicker","quoteFeeFactor","mktID","_markets$this$mktID","markets","lotSizeConv","quoteLot","quoteLotConv","baseFeeFiatRate","quoteFeeFiatRate","arbMarketMakingConfig","baseLots","quoteLots","nBuyPlacements","nSellPlacements","simpleArbConfig","uiConfig","simpleArbLots","basicMarketMakingConfig","_initialize","_callee9","_context9","marketReport","lotSizeUSD","quoteLotUSD","quoteFiatRate","proj","projectedAllocations","botCfg","latestEpoch","cexProblems","cexBaseBalance","cexQuoteBalance","_ref10","walletMap","_ref11","bInv","qInv","cexBaseAvail","cexQuoteAvail","cexes","balances","dexBaseAvail","balance","dexQuoteAvail","baseAvail","quoteAvail","baseFeeWallet","quoteFeeWallet","baseFeeAvail","dexBaseFeeAvail","cexBaseFeeAvail","bFeeInv","quoteFeeAvail","dexQuoteFeeAvail","cexQuoteFeeAvail","qFeeInv","_this$marketReport","baseFees","quoteFees","_this$cfg$uiConfig","baseConfig","quoteConfig","feesAndCommit","orderReservesFactor","_this$cfg$uiConfig2","_this$feesAndCommit","commit","fees","bProj","bookingFees","swapFeeReserves","orderReserves","slippageBuffer","qProj","quote","tokenFeesPerSwap","swapFeeN","slippageBufferFactor","alloc","addAlloc","amt","_alloc$assetID","_this$proj","cexRebalance","_this$adjustedBalance","adjustedBalances","canRebalance","cexMinBaseAlloc","_ref12","dexMinBaseAlloc","transferableBaseAlloc","dexBaseFeeReq","_ref13","dexMinQuoteAlloc","cexMinQuoteAlloc","transferableQuoteAlloc","dexQuoteFeeReq","basis","dexBaseFunded","cexBaseFunded","dexQuoteFunded","cexQuoteFunded","totalBaseReq","totalQuoteReq","baseFundedAndBalanced","quoteFundedAndBalanced","baseFeesFunded","quoteFeesFunded","fundedAndBalanced","fundedAndNotBalanced","req","funded","transferable","starved","RunningMarketMakerDisplay","forms","elements","orderReportFormEl","orderReportForm","idDescendants","dexBalancesRowTmpl","placementRowTmpl","placementAmtRowTmpl","stopBttn","runLogsBttn","_this4$mkt","loadPage","returnPage","buyOrdersBttn","showOrderReport","sellOrdersBttn","_setBotMarket","_setMarket","_stop","_callee10","_this$mkt","loaded","_context10","loading","stopBot","_callee11","_context11","_ref14","initialize","setBotMarket","_x13","_x14","_x15","_callee12","_basicCfg$gapStrategy","_ref15","_cfg$arbMarketMakingC","_cfg$arbMarketMakingC2","_cfg$simpleArbConfig","_this$mkt2","basicCfg","gapStrategy","_context12","baseFeeReservesBox","quoteFeeReservesBox","baseFeeLogo","quoteFeeLogo","profitTrigger","profitLabel","gapLabel","multiplierLabel","profitUnit","gapUnit","multiplierUnit","update","readBook","_x16","_this$mkt3","_this$mkt4","currentForm","currentFormID","orderReport","displayedOrderReportFormSide","buysReport","sellsReport","updateOrderReport","epochNum","close","_this$mkt5","problems","runTime","hmsSince","_runStats$feeGap","_runStats$feeGap2","_runStats$feeGap4","_this$mkt6","_this$mkt6$marketRepo","_this$mkt$status","_this$mkt$status$botC","bmmCfg","stats","cexRow","pendingDepositBox","pendingWithdrawalBox","setTicker","setInterval","setSignedValue","profitLoss","profitRatio","profitSign","plSign","summedBalance","pending","dexBaseInv","walletBaseInventory","walletBaseInvFiat","dexQuoteInv","walletQuoteInventory","walletQuoteInvFiat","cexBaseInv","cexBaseInventory","cexBaseInventoryFiat","cexQuoteInv","cexQuoteInventory","cexQuoteInventoryFiat","feeBalance","baseFeeReserves","quoteFeeReserves","pendingDeposits","pendingWithdrawals","completedMatches","tradedUSD","tradedUSDBox","roundTripFeesBox","roundTripFeesUSD","feeGap","roundTripFees","basisPrice","displayFeeGap","feeGapBox","_runStats$feeGap3","feeGapPct","gapStrategyBox","remoteGap","remoteGapBox","remoteGapPct","buyOrdersReportBox","allPlaced","allOrdersPlaced","buyOrdersSuccess","buyOrdersFailed","sellOrdersReportBox","sellOrdersSuccess","sellOrdersFailed","preOrderProblemMessages","botProblemMessages","preOrderProblems","cexErrorMessages","msgs","depositErr","_Object$entries3","_Object$entries3$_i","assetSymbol","time","stamp","withdrawErr","_i8","_Object$entries4","_Object$entries4$_i","tradeErr","cexProblemMessages","allMessages","preOrderProblemsBox","spanEl","clearInterval","form","sideTxt","orderReportTitle","orderReportError","orderReportDetails","problemMessages","_problemMessages","dexBalancesBody","placementsBody","createRow","row","rowTmpl","assetLogo","availableDexBals","required","requiredDexBals","remaining","remainingDexBals","used","usedDexBals","deficiency","safeSub","deficiencyWithPending","assetIDs","includes","cexAsset","totalDeficiency","rows","_assetIDs","_createRow2","dexDeficiencyHeader","dexDeficiencyWithPendingHeader","setDeficiencyVisibility","cexSection","counterTradeRateHeader","requiredCEXHeader","usedCEXHeader","cexDisplayInfo","cexBalancesTitle","cexAssetID","cexAssetLogo","availableCexBal","requiredCexBal","remainingCexBal","pendingCexBal","reservedCexBal","usedCexBal","deficiencyCexBal","deficiencyWithPendingCexBal","cexAvailable","cexLocked","cexRequired","cexRemaining","cexPending","cexUsed","deficient","cexDeficiencyHeader","cexDeficiencyWithPendingHeader","cexDeficiency","cexDeficiencyWithPending","anyErrors","errorHeader","createPlacementRow","placement","priority","baseUI","quoteUI","formatRateFullPrecision","standingLots","orderedLots","counterTradeRate","_assetIDs2","requiredAmt","requiredDex","usedAmt","usedDex","requiredRow","requiredRowTmpl","usedRow","usedRowTmpl","requiredDEX","usedDEX","requiredCEX","usedCEX","requiredCex","usedCex","errMessages","join","_this$mkt7","orders","nBookedOrders","vEl","signEl","baseOrderReservesFactor","quoteOrderReservesFactor","baseTokenFeesPerSwap","baseRedeemReservesPerLot","estimated","swap","redeem","baseBookingFeesPerLot","refund","quoteTokenFeesPerSwap","quoteRedeemReservesPerLot","quoteBookingFeesPerLot","baseReservesFactor","quoteReservesFactor","baseBookingFees","baseRedeemFees","quoteBookingFees","quoteRedeemFees","_objectSpread","bookingFeesPerLot","bookingFeesPerCounterLot","swapReservesFactor","redeemReservesFactor","dexHost","walletNotSynced","_Object$entries$_i","noWalletPeers","_Object$entries2","_Object$entries2$_i","accountSuspended","userLimitTooLow","noPriceSource","cexOrderbookUnsynced","causesSelfMatch","mmstatus","Forms","formsDiv","closed","mouseInElement","keyup","_show","animationLength","progress","closedForm","NewWalletForm","success","backFunc","goBack","walletTabTmpl","subform","WalletConfigForm","walletSettings","walletCfgGuide","tmplElement","submitAdd","submit","oneBttn","registerNoteFeeder","walletstate","note","reportWalletState","walletsync","parentSyncer","createwallet","reportCreationUpdate","_loadDefaults","_setError","_update","_setAsset","_runParentSync","_submit","_createWallet","createUpdater","walletType","parentForm","createForm","pass","newWalletPass","map","_this$current","parentAsset","selectedDef","newWalletErr","current","createWallet","checkResponse","setError","runParentSync","_this$current2","parentSyncPct","parentName","childName","childLogo","mainForm","parentSyncing","syncParent","topic","subject","details","tabs","_this$current3","winfo","pinfo","walletDefs","_loop","parseAsset","walletTypeTabs","assetName","tokenMsgBox","tokenParentLogo","tokenParentName","availablewallets","wDef","tab","t1","bindTooltips","walletCreationPending","walletDef","guideLink","configOpts","containsRequired","_this$current4","displayCreateBtn","parentAndTokenOpts","tokenOpts","tokenOptsCopy","walletPassAndSubmitBttn","oneBttnBox","newWalletPassBox","guidelink","configopts","isBirthdayConfig","seedGenTime","toUnixDate","seeded","walletSettingsHeader","noauth","regAsset","setGuideLink","fileSelector","loadDefaults","errMsg","_this$current5","configID","configpath","setLoadedConfig","dynamicInputCounter","sectionize","configElements","allSettings","dynamicOpts","textInputTmpl","dateInputTmpl","checkboxTmpl","repeatableTmpl","fileInput","showOther","showIcon","hideIcon","showHideMsg","otherSettings","loadedSettingsMsg","loadedSettings","defaultSettingsMsg","defaultSettings","fileInputChanged","setOtherSettingsViz","_fileInputChanged","_this$dynamicOpts","files","loadedOpts","defaultOpts","configtext","append","setConfig","reorder","insertAfter","skipRepeatN","_app$extensionWallet","isboolean","isdate","repeatable","addOpt","repeatN","extensionWallet","hiddenFields","configKey","elID","htmlFor","prepend","logoPathFromID","after","noecho","autocomplete","checked","getMinMaxVal","minMax","dateToString","date","disablewhenactive","assetHasActiveOrders","activeOrders","defaultedOpts","_step7","_iterator7","finds","handledRepeatables","removes","vals","firstVal","newEl","_removes","splice","_this$loadedSettings","_step8","_iterator8","_step8$value","minDate","MIN_SAFE_INTEGER","maxDate","inputs","_step9","_iterator9","_step9$value","_step10","_iterator10","_step11","_iterator11","ConfirmRegistrationForm","certFile","submitForm","_submitForm","xc","tier","_asset$unitInfo$conve","bondAssetID","bondLockConventional","bondAssets","tradingTier","bondLock","bondUnit","bondLockUSDBox","bondLockUSD","feeReserves","reservesUnit","transform","opacity","offset","bondAsset","dexAddr","url","_context13","regErr","innerText","viewOnly","cert","bond","FeeAssetSelectionForm","currentBondTmpl","bondAssetTmpl","marketTmpl","tradingTierInput","setTier","acceptTier","submitTradingTier","tierUp","incrementTier","tierDown","goBackToAssets","tradingTierForm","assetForm","whatsABond","whatsABondPanel","hideWhatsABond","bondGotIt","whatsABondBack","usePrepaidBond","showPrepaidBondForm","ppbGoBack","hidePrepaidBondForm","submitPrepaidBond","walletCreated","_submitPrepaidBond","_animate2","tradingTierErr","regAssetErr","assetRows","marketRows","prepaidBonds","clearErrors","addBondRow","_asset$unitInfo$conve2","tr","assetSelected","feeSymbol","bondSizeConventional","feeAmt","fiatRate","fiatBox","fiatBondAmount","ready","addMarketRow","quoteid","_step12","_xc$assets$baseID","_xc$assets$quoteID","_iterator12","_step13","_iterator13","baseLogo","quoteLogo","parcelSize","parcelsize","conventionalLotSize","startingLimit","privilegedLimit","tradeLimitLow","tradeLimitHigh","fiatTradeLimitLow","fiatTradeLimitHigh","fiatTradeLowBox","fiatTradeHighBox","_Object$values$_i","_Object$values2","validBondAssetSelected","_xc$auth","setReadyMessage","setExchange","selectedAssetID","_this$page","_page$tradingTierInpu","_app$assets$assetID","_ui$conventional","raw","setTierError","bondSizeDisplay","_step14","_iterator14","_step15","_iterator15","bondLockDisplay","fiatLockDisplay","_Object$values3","currentBondAmts","assetIDStr","_wallet$balance","bonded","bondlocked","bondReserves","haveLock","currentBondBox","currentBonds","_i9","bondLocked","_app$assets$_assetID","_ui$conventional2","icon","fiatAmt","fiatLockBox","_page$tradingTierInpu2","_input$value","_callee13","regAssetElements","_context14","_i10","_regAssetElements","marginTop","prepaidBondErr","prepaidBondCode","_callee14","code","_context15","WalletWaitForm","progressCache","progressed","reportProgress","reportBalance","bondFeeBuffer","parentAssetSynced","_asset$wallet","bal","address","_step16","symbolize","_iterator16","depoAddr","syncUncheck","syncCheck","balUncheck","balCheck","syncRemainBox","bondCostBreakdown","balanceBox","bondLockNoFees","bondLockFees","need","reservesDeficit","totalForBond","sendEnough","txFeeBox","sendEnoughForToken","txFeeBalanceBox","sendEnoughWithEst","txFee","parentFees","tokenFees","txFeeUnit","parentUnit","parentBalUnit","parentBal","fee","syncSpinner","parentAvail","syncRemaining","syncFinishingUp","cache","progDelta","progRate","toGoTime","syncRemain","AccelerateOrderForm","accelerateSubmit","submitEarlyConfirm","sendAccelerateRequest","_updateAccelerationEstimate","_refresh","_submit2","_sendAccelerateRequest","earlyAcceleration","recentAccelerationTime","timePast","recentSwapTime","wasAcceleration","recentAccelerationMsg","recentSwapMsg","configureAccelerationDiv","accelerateErr","earlyAccelerationDiv","_callee15","_context16","orderID","newRate","acceleratedRate","accelerateMainDiv","accelerateTxID","txID","preAccelerateErr","accelerateMsgDiv","accelerateSuccess","_callee16","_context17","displayEarlyAccelerationMsg","_callee17","preAccelerate","updateRate","rangeHandler","_context18","feeEstimateDiv","currencyUnit","suggestedRange","accelerateAvgFeeRate","swapRate","accelerateCurrentFeeRate","suggestedRate","newY","updateAccelerationEstimate","sliderContainer","_callee18","_context19","feeRateEstimate","feeEstimate","DEXAddressForm","dexToUpdate","certPicker","CertificatePicker","skipRegistration","showOrHideSubmitBttn","showCustom","customBox","knownExchanges","knownXCs","_step17","_iterator17","_loop2","_step18","_iterator18","checkDEX","addDexHdr","skipRegistrationBox","updateDexHdr","refresh","_checkDEX","_animate3","clearCertFile","pickServerMsg","addCustomMsg","_step19","_iterator19","isDisplayed","_this$page$skipRegist","_callee19","_context20","_callee20","endpoint","_context21","file","newHost","oldHost","needCert","fetchUser","paid","pendingBonds","DiscoverAccountForm","_this15","_checkDEX2","_animate4","_callee21","_context22","_callee22","_context23","LoginForm","_this16","login","handleLoginNote","_animate5","_submit3","loginMsg","idel","pw","_callee23","_context24","showFormError","notes","pokes","loggedIn","_callee24","_context25","DepositAddress","_this17","unifiedReceiverTmpl","newDepAddrBttn","_callee25","_context26","newDepositAddress","copyAddressBtn","copyAddress","_copyAddress","_newDepositAddress","_setAsset2","_callee26","_context27","depositTokenMsgBox","depositLogo","depositName","depositTokenParentLogo","depositTokenParentName","newDepAddrBttnBox","setAddress","_this18","unifiedReceivers","receivers","_loop3","_i11","recvType","recv","_i12","_arr2","bttn","setCentralAddress","unified","depositAddress","qrcode","_callee27","_context28","_callee28","_context29","copyAlert","AppPassResetForm","_this19","resetAppPWSubmitBtn","resetAppPW","_resetAppPW","_callee29","newAppPW","confirmNewAppPW","_this20","_context30","newAppPassword","confirmNewAppPassword","appPWResetErrMsg","newPass","seed","seedInput","appPWResetSuccessMsg","_this21","selectedCert","onCertFileChange","removeCert","addCert","_file","_onCertFileChange","_callee30","_context31","_callee31","_context32","TokenApprovalForm","_this22","approve","_approve","_setAsset3","_callee32","_tokenAsset$token","tokenAsset","protocolVersion","_app$assets$parentID","_app$assets$parentID$","feeText","_context33","submissionElements","txMsg","addressBox","tokenSymbol","version","approving","parentTicker","_callee33","_context34","CEXConfigurationForm","_this23","cexSubmit","_submit4","cexConfigPrompt","cexConnectErrBox","cexFormErr","cexApiKeyInput","cexSecretInput","cexStatus","connectErr","cexConnectErr","apiKey","apiSecret","_callee34","_e$msg","_context35","updateCEXConfig","slideSwap","_slideSwap","_callee35","form1","form2","_context36","showSuccess","successMessage","checkmarkForm","checkmark","startR","startG","startB","diffR","diffG","diffB","submitBttn","wrapper","dateApplyOffset","toISOString","RegistrationPage","_BasePage","_newWalletCreated","_registerDEXSuccess","_getCertFile","_getBondsFeeBuffer","_animateConfirmForm","_animateRegAsset","_requestFeepayment","_auth","dexAddrForm","discoverAcctForm","resetPassFormCloser","newWalletForm","newWalletCreated","confirmRegisterForm","animateRegAsset","requestFeepayment","regAssetForm","bondsFeeBuffer","registerDEXSuccess","getBondsFeeBuffer","setAsset","animateConfirmForm","walletWaitForm","setWallet","walletWait","confirmRegForm","authed","oldForm","feeBuffer","updateMenuItemsDisplay","backTo","bondAmt","LoginPage","_loggedIn","loginForm","prepAndDisplayLoginForm","resetAppPWForm","appPassResetForm","forgotPassBtn","traitFundsMixer","ticketStatusTranslationKeys","positiveTxTypes","negativeTxTypes","noAmtTxTypes","txTypeSignAndClass","txType","txTypeTranslationKeys","txTypeString","ticketPageSize","WalletsPage","_confirmForceSubmit","_recoverWallet","_displayRestoreWalletInfo","_exportWalletAuthSubmit","_displayExportWalletAuth","_downloadLogs","_lock","_reconfig","_send","_populateMaxSend","_doConnect","_showSendForm","_showDeposit","_showReconfig","_openWallet","_rescanWallet","_loadEarlierTxs","_showTxHistory","_getTxHistory","_showRecentActivity","_updateMixerState","_updatePrivacy","_prevTicketPage","_nextTicketPage","_showTicketHistory","_ticketPageN","_setVSP","_purchaseTickets","_showVSPPicker","_updateTicketBuyer","_checkNeedsProvider","_setSelectedAsset","_showNewWallet","_showSuccess2","_showForm","_showBox","_toggleWalletStatus","_spinUntilPeersUpdate","_submitAddPeer","_showManagePeersForm","_updateWalletPeersTable","_showUnapproveTokenAllowanceTableForm","_showUnapproveTokenAllowanceForm","_submitUnapproveTokenAllowance","_validateSendAddress","_cancelSend","_stepSend","_safePost","stampers","secondTicker","timeSince","setStamp","restoreInfoCard","connectedIconTmpl","disconnectedIconTmpl","removeIconTmpl","closePopups","cancelForce","iconSelectTmpl","balanceDetailRow","recentOrderTmpl","vspRowTmpl","ticketHistoryRowTmpl","votingChoiceTmpl","votingAgendaTmpl","tspendTmpl","tkeyTmpl","txHistoryRowTmpl","txHistoryDateRowTmpl","showNewWallet","connectBttn","doConnect","send","showSendForm","receive","showDeposit","unlockBttn","openWallet","lockBttn","lock","reconfigureBttn","showReconfig","needsProviderBttn","rescanWallet","earlierTxs","loadEarlierTxs","copyTxIDBtn","_this$currTx","currTx","txDetailsID","copyRecipientBtn","_this$currTx2","recipient","txDetailsRecipient","copyBondIDBtn","_this$currTx3","_this$currTx3$bondInf","bondInfo","bondID","txDetailsBondID","copyBondAccountIDBtn","_this$currTx4","_this$currTx4$bondInf","accountID","txDetailsBondAccountID","hideMixTxsCheckbox","showTxHistory","fmtParams","assetUpdated","sortAssetButtons","updateTicketBuyer","updatePrivacy","reconfigForm","reconfigInputs","bindForm","sendForm","submitSendForm","stepSend","vSendForm","vSend","submitReconfig","reconfig","mixerToggle","toggleMixer","mixingErr","updateMixerState","downloadLogs","exportWallet","displayExportWalletAuth","recoverWallet","showRecoverWallet","exportWalletAuth","exportWalletAuthSubmit","recoverWalletConfirm","recoverWalletSubmit","confirmForce","confirmForceSubmit","disableWallet","showToggleWalletStatus","enableWallet","toggleWalletStatusConfirm","toggleWalletStatusSubmit","toggleWalletStatus","managePeers","showManagePeersForm","addPeerSubmit","submitAddPeer","unapproveTokenAllowance","showUnapproveTokenAllowanceTableForm","unapproveTokenSubmit","submitUnapproveTokenAllowance","showVSPs","showVSPPicker","vspDisplay","vspPicker","customVspSubmit","setCustomVSP","purchaseTicketsBttn","showPurchaseTicketsDialog","purchaseTicketsForm","purchaserSubmit","purchaseTickets","purchaserInput","purchaserInputChanged","ticketHistory","showTicketHistory","ticketHistoryNextPage","nextTicketPage","ticketHistoryPrevPage","prevTicketPage","setVotes","showSetVotesDialog","purchaseTicketsErrCloser","purchaseTicketsErrBox","privacyInfoBttn","showForm","mixingInfo","depositAddrForm","deposit","walletBal","populateMaxSend","sendAmt","showFiatValue","sendValue","maxSend","sendAddr","validateSendAddress","showChangePW","changeWalletPW","setPWSettingViz","changeWalletTypeSelect","changeWalletType","showChangeType","isHidden","changeTypeHideIcon","changeTypeShowIcon","changeTypeMsg","skipAnimation","fiatrateupdate","handleRatesNote","handleBalanceNote","handleWalletStateNote","walletconfig","updateSyncAndPeers","handleCreateWalletNote","walletnote","handleCustomWalletNote","selectedAsset","selectedAssetLK","setSelectedAsset","txHistoryTableBody","age","timestamp","animation","path","subtract","txfee","_app$assets$token$par","feeUI","xcRate","totalSend","_bal","vSendErr","sendErr","vSendEstimates","txFeeNotAvailable","subtractCheckBox","ok","validaddress","vSendSymbol","vSendLogo","vSendFee","formatFullPrecision","vSendFeeFiat","vSendDestinationAmt","vTotalSend","vTotalSendFiat","vSendAddr","balanceAfterSend","balanceAfterSendFiat","approxSign","resp","changePW","switchPWMsg","versionToDEXes","exchange","exchangeAsset","unapprovingTokenVersion","unapproveTokenErr","unapproveTokenTxID","unapproveTokenSubmissionElements","unapproveTokenTxMsg","tokenAllowanceRemoveSymbol","tokenAllowanceRemoveVersion","unapprovalFeeEstimate","unapproveTokenForm","showTable","approved","tokenVersionBody","tokenVersionTableAssetSymbol","assetVersionUsedByDEXes","approvalStatus","removeIcon","Approved","tokenVersionRow","usedBy","showUnapproveTokenAllowanceForm","tokenVersionTable","tokenVersionNone","unapproveTokenTableForm","peers","defaultText","addedText","discoveredText","peerSpinner","managePeersErr","peersTableBody","source","peer","connectionIcon","peerTableRow","WalletDefault","UserAdded","Discovered","connected","spinUntilPeersUpdate","updateWalletPeersTable","managePeersForm","addPeerInput","toggleWalletStatusErr","walletStatusDisable","disableWalletMsg","walletStatusEnable","enableWalletMsg","successMsg","activeOrdersErr","focuser","displayed","defaultsLoaded","assetButtons","assetSelect","sortedAssets","_ref18","aBal","bBal","aTotal","immature","bTotal","localeCompare","_ref19","aFiat","bFiat","updateAssetButton","_tmpl$img","_this$assetButtons$as","noWallet","symbolParts","_tmpl$parentImg","parentImg","totalBalance","_Doc$formatBestUnitsF2","fiat","updateDisplayedAsset","showAvailableMarkets","showRecentActivity","_app$assets$assetID2","fiatBalanceBox","walletDetails","sendReceive","connectBttnBox","statusLocked","statusReady","statusOff","unlockBttnBox","lockBttnBox","peerCountBox","syncProgressBox","statusDisabled","tokenInfoBox","needsProviderBox","feeStateBox","txSyncBox","txProgress","txFindingAddrs","checkNeedsProvider","contractAddress","updateDisplayedAssetBalance","feeState","walletDefinition","updateFeeState","walletDetailsBox","_app$walletMap$assetI","syncStatus","encrypted","haveActiveOrders","txs","blocks","targetHeight","_app$assets$assetID3","feeAssetID","feeFiatRate","formatBestRateElement","feeStateNetRate","feeStateSendFees","feeStateSwapFees","feeStateRedeemFees","feeStateXcRate","sendFiat","feeStateSendFiat","swapFiat","feeStateSwapFiat","redeemFiat","feeStateRedeemFiat","needs","needsCustomProvider","blink","_callee36","_app$assets$assetID4","stakeStatus","_context37","ticketPage","number","history","scanned","stakingBox","pickVSP","stakingSummary","stakingErr","vspDisplayBox","ticketPriceBox","purchaseTicketsBox","stakingRpcSpvMsg","ticketsDisabled","safePost","stakingAgendaCount","stances","agendas","stakingTspendCount","tspends","purchaserCurrentPrice","ticketPrice","purchaserBal","updateTicketStats","votingSubsidy","disableStaking","extensionModeAppName","extensionModeConfig","setVSPViz","vsp","vspURL","isRPC","liveTicketCount","tickets","tkt","stakingTicketCount","immatureTicketCount","mempool","immatureTicketCountBox","queuedTicketCount","queued","formQueuedTix","formQueueTixBox","queuedTicketCountBox","totalTicketCount","ticketCount","totalTicketRewards","totalRewards","totalTicketVotes","votes","_callee37","vsps","_context39","vspPickerList","_context38","feeRate","feePercentage","voting","setVSP","purchaserErr","_callee38","_context40","walletNote","_ref20","payload","purchaseTicketsErr","_callee39","_context41","customVspUrl","pgNum","startOffset","pageOfTickets","pageNumber","coinLink","ticketHistoryRows","ticketHistoryPage","_step6$value","tx","bindUrlHandlers","price","hashStart","hash","hashEnd","detailsLinkUrl","setAttribute","_callee40","_this$ticketPage$hist","lastList","scanStart","skipN","totalTix","atEnd","_context42","blockHeight","ticketHistoryForm","ticketHistoryPagination","ticketHistoryTable","noTicketsMessage","displayTicketPage","_callee41","_context43","ticketPageN","_callee42","_context44","_callee43","_context45","_stakeStatus$stances$","votingFormErr","_ref21","_callee44","_context46","votingForm","_x17","setAgendaChoice","_ref22","_callee45","agendaID","choiceID","agenda","_context47","choices","currentChoice","_x18","_x19","votingAgendas","_loop4","_loop5","choice","choiceTmpl","radio","setTspendVote","_ref23","_callee46","txHash","policyID","tspend","_context48","tSpendPolicy","currentPolicy","_x20","_x21","votingTspends","_loop6","_loop7","_opt$value","yes","no","explorerLink","setTKeyPolicy","_ref24","_callee47","policy","tkey","_context49","treasuryPolicy","treasuryKeys","_x22","_x23","votingTKeys","_loop8","keyPolicy","_loop9","_arr3","_opt$value2","_callee48","_app$extensionWallet2","disablePrivacy","_context50","mixing","mixingBox","mixerOff","mixerOn","mixerLoading","enabled","_x24","_callee49","_context51","_x25","_bal$other","_bal$other2","_bal$other3","totalLocked","contractlocked","balanceUnit","fiatBalance","balanceDetailBox","lastSubLockedRow","lastPrimaryRow","addBalanceRow","cat","tooltipMsg","addPrimaryBalance","addSubBalance","setRowClasses","other","Shielded","transparent","orderlocked","Staked","Unmixed","spotVolume","vol24","_a","hostA","mktA","_b2","hostB","mktB","availableMarkets","_loop10","_markets$_i","_markets","quotesymbol","marketRow","fmtSymbol","priceQuoteUnit","priceBaseUnit","volumeUnit","priceBox","volumeBox","marketsOverviewBox","_callee50","_arr4","to","_ref25","_ref26","_ref27","_context52","orderActivityBox","hosts","noActivity","orderActivity","recentOrders","fromQty","toQty","fromLogo","fromSymbol","toSymbol","toLogo","submitTime","bindInternalNavigation","_x26","amtAssetID","feesAssetID","tokenID","amtAssetUI","feesAssetUI","trimStringWithEllipsis","_txTypeSignAndClass2","showTxDetailsPopup","updateTxHistoryRow","txViewBlockExplorer","txDetailsType","txTypeTooltip","txDetailsAmtSection","_txTypeSignAndClass4","txDetailsAmount","feeAsset","txDetailsFee","txDetailsBlockNumber","blockNumber","dateStr","toLocaleDateString","timeStr","toLocaleTimeString","txDetailsTimestamp","timestampPending","blockNumberPending","txDetailsRecipientSection","txDetailsBondIDSection","txDetailsBondLocktimeSection","txDetailsBondAccountIDSection","lockTime","txDetailsBondLocktime","additionalData","Nonce","txDetailsNonceSection","txDetailsNonce","getWalletTx","setTxDetailsPopupElements","txDetails","newTx","_this$currTx5","hideMixTxs","oldestTx","txDate","txHistoryTableNewestDate","insertBefore","txHistoryRow","txHistoryDateRow","txHistoryTable","noTxHistory","peRow","_callee51","numToFetch","ref","currRes","_res$txs","numToPush","_res$txs2","_context53","lastTx","txHistory","_x27","_x28","_x29","_callee52","txRes","isMixing","hideMixing","oldestDate","_context54","txHistoryBox","txHistoryNotAvailable","getTxHistory","_x30","_callee53","_context55","_callee54","_context56","reconfigErr","forceUrl","forceReq","showConfirmForce","_x31","confirmForceErr","recoverWalletErr","_callee55","_context57","_x32","_callee56","_app$extensionWallet3","currentDef","disableWalletType","option","_context58","currentWalletDefinition","elevateProviders","traitLogFiler","otherActionsLabel","showOrHideRecoverySupportMsg","recfgAssetLogo","recfgAssetName","updateDisplayedReconfigFields","_x33","_x34","setRecoverySupportMsgViz","viz","reconfigSupportMsg","walletSymbol","toLocaleUpperCase","_app$extensionWallet4","disablePassword","_callee57","_context59","_x35","_callee58","_app$assets$assetID5","isWithdrawer","feeReq","canSend","_context60","toggleSubtract","maxSendDisplay","sendTokenMsgBox","sendLogo","sendName","sendTokenParentLogo","sendTokenParentName","maxWithdraw","maxSendFiat","maxSendFee","maxSendFeeFiat","_x36","_callee59","_context61","errorModalMsg","errorModal","_x37","is","_callee60","_app$assets$this$sele","_context62","_callee61","_page$sendForm$datase","_page$subtractCheckBo","_context63","vSendPw","_callee62","_this$data","_context64","newWalletPW","newPW","clearTxHistory","_callee63","_context65","_x38","_callee64","search","_context66","URLSearchParams","URL","location","pathname","_callee65","_context67","exportWalletErr","exportWalletPW","_callee66","_context68","displayRestoreWalletInfo","restorationinfo","_callee67","wr","card","_context69","restoreInfoCardsList","seedName","instructions","restoreWalletInfo","_x39","_callee68","_context70","_callee69","_context71","force","fiatRates","_note$wallet","route","processTicketPurchaseUpdate","handleTxNote","transaction","str","maxLen","_objectWithoutProperties","excluded","sourceKeys","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","NoteTypeOrder","NoteTypeMatch","NoteTypeBondPost","NoteTypeConnEvent","desktopNtfnSettingsKey","desktopNtfnSettings","desktopNtfnLabels","_desktopNtfnLabels","BrowserNotifier","_defaultDesktopNtfnSe","_sendDesktopNotification","_requestNtfnPermission","Notification","permission","ntfnPermissionGranted","sendDesktopNotification","ntfnPermissionDenied","requestPermission","title","ntfn","OSDesktopNotifier","_sendDesktopNotification2","_requestNtfnPermission2","isDesktopWebview","sendOSNotification","isDesktopWebkit","webkit","messageHandlers","bwHandler","postMessage","isWebview","_window$webkit","_window$webkit$messag","Notifier","_desktopNotify","browserNtfnEnabled","plainNote","fetchDesktopNtfnSettings","_State$fetchLocal","coinExplorerTokenRe","orderTokenRe","insertRichNote","inputString","_match","orderToken","outerHTML","noderize","_assetID","SettingsPage","_submitGameCode","_changeAppPW","_submitExportSeedReq","_importAccount","_prepareAccountImport","_onAccountFileChange","_renderDesktopNtfnSettings","fiatRateSources","darkMode","showPokes","showPopups","addADex","reload","currentDEX","importAccount","prepareAccountImport","authorizeAccountImportForm","authorizeImportAccountConfirm","changeAppPW","changeAppPWForm","submitNewPW","accountFile","onAccountFileChange","removeAccount","clearAccountFile","addAccount","exportSeed","exportSeedErr","exportSeedAuth","exportSeedSubmit","submitExportSeedReq","gameCodeLink","gameCodeForm","gameCodeSubmit","submitGameCode","exportSeedPW","legacySeed","mnemonic","renderDesktopNtfnSettings","checkbox","noteType","getAttribute","updateNtfnSetting","ntfnSettings","container","enabledCheckbox","getBrowserNtfnSettings","browserNtfnCheckboxTemplate","browserNtfnCheckboxContainer","requestNtfnPermission","dispatchEvent","Event","permDenied","browserNtfnBlockedMsg","newForm","setFees","selectedAccount","importAccountErr","accountString","account","_account","_account$bonds","bonds","acctInf","_excluded","chunk","_chunk$match","authorizeSeedDisplay","clearValues","changePWErrMsg","appPW","confirmNewPW","gameCodeErr","gameCodeInput","gameCodeMsg","gameCodeSuccess","gameRedeemTx","coinString","gameRedeemValue","win","OrderBook","mktBook","qtyAtomic","less","findIdx","removeFromSide","_this$findOrder2","findOrder","updateRemainingSide","epochIdx","bestGapOrder","forward","handlers","MessageSocket","queue","maxQlength","connection","readyState","WebSocket","OPEN","uri","reloader","retrys","go","conn","onmessage","evt","onclose","delay","onopen","_step$value","request","onerror","bookRoute","bookOrderRoute","unbookOrderRoute","updateRemainingRoute","epochOrderRoute","candlesRoute","candleUpdateRoute","buyBtnClass","sellBtnClass","fiveMinBinKey","percentFormatter","parentIDNone","MarketsPage","_handleConnNote","_submitOrder","_handleBondUpdate","_handleWalletState","_submitCancel","_preOrder","_fetchPreorder","_unlockMarketWallets","_unlockWallet","_unlockWalletsForEstimates","_showVerifyForm","_loadUserOrders","_showTokenApprovalForm","_resolveOrderFormVisibility","_init","main","pageParams","maxOrderUpdateCounter","metaOrders","recentMatches","preorderCache","depthLines","hovers","recentMatchesSortKey","recentMatchesSortDirection","ogTitle","vDetailPane","showVerifyForm","depthReporters","reportDepthClick","reportDepthVolume","reportDepthMouse","z","reportDepthZoom","depthChart","depthZoomLK","candleReporters","reportMouseCandle","candleChart","candlesChart","accelerateOrderForm","accelerateForm","approveTokenForm","candleDur","lastCandleDurationLK","registerBttn","notRegistered","walletInfoTmpl","bWidget","qWidget","wgt","balanceWgt","BalanceWidget","baseIcons","stateIcons","quoteIcons","connect","unlockWallet","expired","newWalletBttn","showCreate","walletAddr","wantProviders","showCustomProviderDialog","runningMMDisplayElements","mm","mmRunning","reputationMeter","orderRowTmpl","durBttnTemplate","userOrderTmpl","recentMatchesTemplate","approveBaseBttn","showTokenApprovalForm","approveQuoteBttn","toggleTradingTier","showTradingTier","tradingLimits","hideTradingTier","toggleTradingReputation","showTradingReputation","hideTradingReputation","buyBttn","setBuy","sellBttn","setSell","limitBttn","swapBttns","marketBttn","setOrderVisibility","rateField","isSell","drawChartLines","setMarketBuyOrderEstimate","maxOrd","maxSell","lotField","maxBuy","maxBuys","adjustedRate","lotChanged","disableMouseWheel","qtyField","mktBuyField","ws","registerRoute","handleBookRoute","handleBookOrderRoute","handleUnbookOrderRoute","handleUpdateRemainingRoute","handleEpochOrderRoute","handleCandlesRoute","handleCandleUpdateRoute","handleEpochMatchSummary","orderForm","stepSubmit","verifyForm","vSubmit","submitOrder","cancelForm","cancelSubmit","submitCancel","vFeeDetails","closeDetailPane","recentMatchesTable","th","setRecentMatchesSortCol","ordercol","unsetRecentMatchesSortColClasses","refreshRecentMatchesTable","setRecentMatchesSortColClasses","sortCls","quantityChanged","marketBuyChanged","rateFieldChanged","previewQuoteAmt","marketSearchV1","filterMarkets","setDisclaimerAckViz","acked","disclaimer","disclaimerAck","showDisclaimer","orderDisclaimerAckedLK","clearChartLines","buyRows","sellRows","userOrders","activeMarkerRate","setDepthMarkers","stats0","marketStats","stats1","headerSpace","closeMarketsList","leftMarketDock","openMarketsList","leftHider","marketReopener","marketSelect","marketList","MarketList","marketListV1","_this$market","_this$market$base","_this$market2","_this$market2$quote","_row$mkt","startLoadingAnimations","setMarket","handleOrderNote","handleMatchNote","handleEpochNote","handleConnNote","bondpost","handleBondUpdate","spots","handlePriceUpdate","handleWalletState","reputation","updateReputation","feepayment","runstats","resolveOrderFormVisibility","epochreport","handleEpochReportNote","cexproblems","handleCexProblemsNote","runevent","loadingAnimations","mord","recentMatchesLiveList","_td$dataset$sinceStam","td","sinceStamp","init","makeMarket","lastMarketLK","exists","setBalanceVisibility","setRegistrationStatusVisibility","anis","maxLbl","setOrderBttnText","isLimit","currentOrder","parseOrder","updateOrderBttnState","_xc$assets$mkt$baseid","volUnit","setPriceAndChange","obPrice","change24","obUp","obDown","_this$market3","ba","baseCfg","qa","quoteCfg","baseIcon","quoteIcon","low24","high24","_this$market4","candleCaches","requestCandles","aDayAgo","_app$assets$base$toke","_base$info","_app$assets$quote$tok","_quote$info","_this$market5","isSupported","bVers","versions","qVers","tifBox","qtyBox","maxBox","mktBuyBox","showOrderForm","_this$market$dex$auth","pendingStrength","_this$market6","_this2$tokenAssetAppr","baseAssetApprovalStatus","quoteAssetApprovalStatus","_this2$market","assetsAreSupported","tokenAssetApprovalStatuses","t2","t3","orderTypeBttns","reputationAndTradingTierBox","_this$assetsAreSuppor","loaderMsg","isBase","_this$market7","_baseAsset$wallet","baseAsset","baseVersion","_quoteAsset$wallet","quoteAsset","quoteVersion","_this$tokenAssetAppro","tokenApproval","approvalRequiredSell","approvalRequiredBuy","approvalRequiredBoth","approvalPendingBaseSymbol","baseTokenAsset","approvalPendingQuoteSymbol","quoteTokenAsset","NotApproved","Pending","approvalPendingBase","approvalPendingQuote","titleContent","confStatusMsg","titleClass","regStatusTitle","regStatusConfsDisplay","registrationStatus","regStatusDex","postingBondsDex","setRegistrationStatusView","confirmationsRequired","confs","connectionStatus","Connected","updateRegistrationStatusView","showSection","section","_elements","bondRequired","bondCreationPending","unregisteredDex","hasPendingBonds","acctTier","dexSettingsLink","shortSymbol","isEnabled","disabledTooltipMsg","btn","_this$currentOrder","orderQty","orderRate","setOrderBttnEnabled","aLot","durBttnBox","candleDurs","candleDurationSelected","loadCandles","mktId","cexBook","chartErrMsg","maxEstimateTimer","marketID","sid","maxSellRequested","sellBalance","buyBalance","bookLoaded","displayMessageIfMissingWallet","setWallets","setMarketDetails","setCurrMarketPrice","updateMarketElements","select","setLoaderMsgVisibility","setTokenApprovalVisibility","setCandleDurBttns","updateTitle","setHost","loadUserOrders","_mkt$base","_mkt$quote","_mkt$base2","_mkt$quote2","baseSym","quoteSym","noWalletMsg","asset1","asset2","_this$market8","q","sellBookedBase","sellBookedQuote","buyBookedBase","buyBookedQuote","depthLegend","_Object$values2$_i","hoverPrice","hoverVolume","candle","candlesLegend","candleStart","candleEnd","candleHigh","candleLow","candleVol","limit","qtyConv","convertToAtoms","tifnow","tifNow","options","adjusted","orderErr","preSell","preBuy","orderPreview","quoteQty","setMaxOrder","scheduleMaxEstimate","maxLoaded","bid","qid","bWallet","qWallet","maxLotBox","maxAboveZero","maxZeroNoFees","maxZeroNoBal","maxFromLots","maxFromLotsLbl","counter","maxOrder","fromAsset","conversionRate","anyRate","_app$assets$fromAsset","feeAvail","feeReservesPerLot","maxZeroNoFeesTicker","maxZeroMinFees","maxZeroNoBalTicker","maxFromAmt","maxFromTicker","_this$market9","minimumRate","minRate","_data$book$recentMatc","_this$market10","loadTable","addTableOrder","epochLine","_this$market11","msgRate","buffer","buybuffer","midGapConventional","minMktBuy","_this$market12","_this$market13","oid","resolveUserOrders","maxUserOrderCount","activeOrd","some","dbOrd","_sortedOrders","_sortedOrders2","orderIsActive","sortedOrders","aActive","bActive","userNoOrders","unreadyOrders","header","isActive","readyToTick","sideLight","marketOrderRateString","ordType","updateMetaOrder","currentFloater","showCancel","showAccelerate","cancelBttn","accelerateBttn","canAccelerateOrder","expander","floater","className","addButton","baseBttn","cb","ogScrollY","orderScroller","moved","yShift","unreadyOrdersMsg","activeLight","rateFactor","setMarkers","midGapValue","_this$market14","bUnit","qUnit","_this$market15","handleBook","removeTableOrder","updateRemaining","updateTableOrder","candlesLoading","timer","setHighLow","setCandles","addRecentMatches","matchSummaries","_data$payload","startStamp","openAsset","updateAsset","toAsset","setIcon","vFeeSummary","vPreorderErr","vPreorder","vBuySell","buySellStr","vSideSubmit","vOrderHost","verifyLimit","verifyMarket","orderDesc","vOrderType","vRate","vQty","vTotal","vFiatTotal","vmFromTotal","vmFromAsset","vmFromTotalFiat","vMarketEstimate","received","vmToTotal","vmToAsset","vmTotalFiat","vHeader","preOrder","unlockWalletsForEstimates","vErr","unlockMarketWallets","_this$market16","cacheKey","cached","wireOrder","estimate","vPreorderErrTip","showAdvancedOptions","hideAdvancedOptions","vOtherOrderOpts","vDefaultOrderOpts","addOption","isSwap","change","isBaseChain","showByDefault","refreshPreorder","est","fetchPreorder","setPreorderErr","setFeeEstimates","_ref16","showPreOrderAdvancedOptions","hidePreOrderAdvancedOptions","reloadOrderOpts","vPreorderEstimates","fmtPct","baseExchangeRate","quoteExchangeRate","baseFeeAssetUI","quoteFeeAssetUI","tokenFiatRate","parentFiatRate","toFeeAssetUI","fromFeeAssetUI","toExchangeRate","fromExchangeRate","_ref17","swapped","swappedInParentUnits","bestSwapPct","realisticBestCase","vSwapFeesLowPct","vSwapFeesLow","worstSwapPct","realisticWorstCase","vSwapFeesHighPct","vSwapFeesHigh","swapFeesMaxPct","maxFees","vSwapFeesMaxPct","vSwapFeesMax","estRate","receivedInParentUnits","bestRedeemPct","vRedeemFeesLowPct","vRedeemFeesLow","worstRedeemPct","vRedeemFeesHighPct","vRedeemFeesHigh","vFeeSummaryPct","vFeeSummaryLow","vFeeSummaryHigh","summarySwapFeesLow","summarySwapFeesHigh","summaryRedeemFeesLow","summaryRedeemFeesHigh","cancelData","cancelErr","cancelRemain","cancelUnit","currentCreate","validateOrder","showVerify","promptProvider","updateSpots","_this$market$base2","_this$market$quote","_this$market17","parcelSizeLots","marketLimitBase","marketLimitBaseUnit","marketLimitQuoteUnit","marketLimitQuote","_tradingLimits","_app$exchanges$host2","usedParcels","mktWeight","inflight","_tradingLimits2","parcelLimit","tradingLimit","limitUsage","orderLimitRemain","orderTradingTier","_this$market18","baseUSD","quoteUSD","refreshActiveOrders","wasInflight","oldStatus","setEpoch","clearOrderTableEpochs","_Object$values4","_Object$values4$_i","alreadyMatched","compare","recentMatchesSortCompare","_step20","_iterator20","vLoader","finalize","mktBuyLots","mktBuyScore","NaN","loadTableSide","bins","currEpochBin","currNonEpochBin","currRate","bin","bookSide","tbody","binOrdersByRateAndEpoch","orderTableRow","manager","getRate","nextSibling","insertOrder","removeOrder","updateOrderQty","clearOrderTableEpochSide","_arr5","removeEpochOrders","orderBin","_this$market19","OrderTableRowManager","chart","setConnectionStatus","_this$page$marketSear","filterTxt","setFilter","setLines","_this$market20","_this$market20$dex","_step21","_iterator21","_this$market21","_this$market22","deregisterRoute","unattach","reloadMarketsPane","_step22","_iterator22","_sortedMarkets","mkts","convertMarkets","assign","_i14","_Object$values5","aLots","sortedMarkets","MarketRow","_step23","_iterator23","_step24","_iterator24","_step25","_iterator25","disconnectedIco","_step26","_iterator26","template","hues","btmpl","iconBox","walletState","balanceRowTmpl","qtmpl","updateWallet","newWalletRow","unsupported","spinner","balanceRows","wantProvidersBox","addWalletSymbol","readWallet","fetchBalance","addRow","balTmpl","_app$assets$asset$tok","_side$parentBal","_app$assets$side$pare","updateParent","before","stringyOptions","_i13","tableRow","rateText","isEpoch","cssClass","updateQtyNumOrdersEl","curr","numOrders","index","findIndex","newEpoch","OrdersPage","_nextPage","_deleteArchivedRecords","_fetchOrders","_submitFilter","orderTmpl","filterState","readFilter","filterKey","subFilter","hostFilter","assetFilter","statusFilter","applyButtons","monitorFilter","applyBttn","submitFilter","filter1","filter2","compareSubFilter","parseSubFilter","ordersTable","nextPage","exportOrders","showArchivedDateField","archivedDateField","deleteArchivedRecordsErr","deleteArchivedRecords","saveMatchesToFile","saveOrdersToFile","archivedRecordsLocation","deleteArchivedRecordsMsg","deleteArchivedResult","deleteArchivedRecordsForm","deleteArchivedRecordsSubmit","olderThan","tableBody","appendOrders","fromUnit","toUnit","dateTime","timeAgo","fetchOrders","setOrders","currentFilter","setQuery","olderThanMs","saveMatchesToFIle","archivedRecordsDeleted","nRecords","archivedRecordsPath","_filterState$assets","_filterState$statuses","orderLoader","lockTimeTakerMs","OrderPage","_showAccelerateForm","_fetchOrder","_start","matchCardTmpl","refreshOnPopupClose","explorerId","showAccelerateForm","fetchOrder","mktBaseSymbol","replaceWith","mktQuoteSymbol","setAccelerationButtonVis","showMatchCards","matchCard","matchID","matchTime","month","day","matchTimeAgo","orderPortion","matchQty","quoteAmount","cancelInfoDiv","infoDiv","statusHdr","cancelAmount","cancelIcon","cancelOrderPortion","makerSwapYou","makerRedeemYou","takerSwapThem","takerRedeemThem","takerSwapYou","takerRedeemYou","makerSwapThem","makerRedeemThem","makerSwapAsset","takerSwapAsset","makerRedeemAsset","takerRedeemAsset","refundAsset","fromAmount","toAmount","fromIcon","toIcon","revoked","counterRedeem","tryShowCoin","pendingEl","coin","stringID","makerSwapPending","makerSwapCoin","takerSwapPending","takerSwapCoin","makerRedeemPending","makerRedeemCoin","takerRedeemPending","takerRedeemCoin","refundCoin","refundPending","refundAfter","refundAfterStr","refundAfterTime","inConfirmingMakerRedeem","inConfirmingTakerRedeem","makerSwapMsg","takerSwapMsg","makerRedeemMsg","takerRedeemMsg","confirmationString","makerSwap","takerSwap","takerRefundsAfter","takerLockTimeExpired","makerRedeem","takerRedeem","expectingRefund","setImmutableMatchCardElements","setMutableMatchCardElements","matchBox","addNewMatchCard","actionsLabel","processMatch","counterSwap","_get","Reflect","property","receiver","getOwnPropertyDescriptor","parseFundingOptions","_f$cex","cexAvail","cexReq","_f$dex","dexAvail","dexReq","proposedDex","proposedCex","cexShort","dexShort","dexRemain","cexRemain","cexRange","dexRange","MarketMakerPage","_cexConfigured","_removeCfg","_handleRunStatsNote","_handleCEXBalanceUpdate","_handleCEXNote","_setup","sortedBots","botTmpl","botRowTmpl","exchangeRowTmpl","cexConfigForm","cexConfigured","newBot","archivedLogsBtn","confirmRemoveConfigBttn","removeCfg","twoColumn","innerWidth","cexRows","configure","setCEX","configureBttn","reconfigBttn","errConfigureBttn","updateCexRow","setup","useTwoColumn","clearBotBoxes","appendBotBox","botConfigs","noBots","handleRunStatsNote","bot","handleRunStats","cexnote","handleCEXNote","_b$runStats$startTime","_b$runStats","_a$runStats$startTime","_a$runStats","addBot","handleCEXBalanceUpdate","_botStatus$config","Bot","botRows","mwh","removingCfg","removeCfgErr","confirmRemoveCfgMsg","confirmRemoveForm","removeBotConfig","fetchMMStatus","boxZero","boxOne","_this$page2","lastChild","botID","unshift","unconfigured","configured","connectErrBox","usdBal","cexSymbolAdded","cexSymbol","bipCEXSymbol","usdBalance","percentage","assetValue","percentageBalanceStr","_BotMarket","pg","runningMMElements","_assertThisInitialize","runDisplay","onBox","botTypeDisplay","placementsChartBox","baseTokenSwapFeesBox","placementsChart","buyPlacementCount","sellPlacementCount","startBttn","allocationBttn","allocate","reconfigure","removeBttn","confirmRemoveCfg","goBackFromAllocation","hideAllocationDialog","marketLink","baseAllocSlider","quoteAllocSlider","allocateBttn","showBot","_this$cfg","bestBuy","bestSell","marketConfig","multiplier","cexDataBox","cexPrice","lastPrice","cexVol","vol","dexDataBox","dexPrice","dexVol","updateDisplay","updateTableRow","loadingBg","_this$status","profitLossBox","allocateBttnBox","offBox","noFiatDisplay","updateRunningDisplay","updateIdleDisplay","_this$marketReport2","baseAlloc","totalUSD","baseAllocUSD","baseBookAlloc","baseOrderReservesAlloc","baseOrderReservesPct","baseCexAllocBox","baseCexAlloc","baseBookingFeesAllocBox","baseTokenFeesAllocBox","baseBookingFeesAlloc","feeAlloc","baseTokenFeeAlloc","baseFeeUSD","baseTokenAllocUSD","withQuote","baseTokenBookingFees","baseTokenSwapFeeN","swapReserves","baseTokenSwapFees","quoteAlloc","quoteAllocUSD","quoteBookAlloc","quoteOrderReservesAlloc","quoteOrderReservesPct","quoteSlippageAlloc","quoteCexAllocBox","quoteCexAlloc","quoteBookingFeesAllocBox","quoteTokenFeesAllocBox","quoteBookingFeesAlloc","quoteTokenFeeAlloc","quoteFeeUSD","quoteTokenAllocUSD","quoteTokenBookingFees","quoteTokenSwapFeeN","quoteTokenSwapFees","totalAllocUSD","_dex","_cex","_alloc$dex$baseFeeID","_alloc$dex$quoteFeeID","_this$marketReport3","offError","showTemporarily","fundingState","_parseFundingOptions2","proposedDexBase","proposedCexBase","baseSlider","_parseFundingOptions4","proposedDexQuote","proposedCexQuote","quoteSlider","allocUSD","allocationDialog","fundedAndBalancedBox","hasTransferable","fundedAndNotBalancedBox","starvedBox","proposedDexBaseAlloc","proposedDexQuoteAlloc","setBaseProposal","proposedDexBaseAllocUSD","proposedCexBaseAlloc","proposedCexBaseAllocUSD","dexAlloc","cexAlloc","setQuoteProposal","proposedDexQuoteAllocUSD","proposedCexQuoteAlloc","proposedCexQuoteAllocUSD","reqFees","proposedFees","proposedDexBaseFeeAlloc","proposedDexBaseFeeAllocUSD","needQuoteTokenFees","proposedDexQuoteFeeAlloc","proposedDexQuoteFeeAllocUSD","existingOrders","existingOrdersBox","closeDialog","_app$mmStatus$cexes$c","startConfig","autoRebalance","autoRebalanceSettings","startBot","_this$proj2","totalBase","dexMinBase","dexMinQuote","maxBase","totalQuote","maxQuote","baseMinWithdraw","minB","maxB","minBaseTransfer","transferFactor","quoteMinWithdraw","minQ","maxQ","minQuoteTransfer","specLK","lastBotsLK","lastArbExchangeLK","arbMMRowCacheKey","defaultProfit","defaultLevelSpacing","defaultMarketMakingConfig","driftTolerance","orderPersistence","defaultBotAssetConfig","MarketMakerSettingsPage","_fetchMarketReport","_delete2","_saveSettings","_fetchCEXBalances","_submitBotWithValidation","_submitBotType","_showBotTypeForm","_configureUI","placementsCache","_this$specs","_this$specs2","submitBotType","walletAddrForm","quotePane","basePane","assetPaneBox","AssetPane","mmTitle","oracleTmpl","cexOptTmpl","arbBttnTmpl","marketRowTmpl","needRegTmpl","resetButton","setOriginalValues","updateButton","saveSettings","createButton","deleteBttn","botTypeForm","botTypeSubmit","noMarketBttn","showMarketSelectForm","botTypeHeader","reshowBotTypeForm","botTypeChangeMarket","marketHeader","marketFilterInput","sortMarketRows","cexRebalanceCheckbox","autoRebalanceChanged","switchToAdvanced","showAdvancedConfig","switchToQuickConfig","qcMatchBuffer","matchBufferChanged","switchToUSDPerSide","changeSideCommitmentDialog","switchToLotsPerLevel","gapStrategySelect","clearPlacements","updatedConfig","loadCachedPlacements","setGapFactorLabels","updateModifiedMarkers","addBuyPlacementBtn","addPlacement","addBuyPlacementLots","addBuyPlacementGapFactor","updateAllocations","addSellPlacementBtn","addSellPlacementLots","addSellPlacementGapFactor","driftToleranceInput","defaultDriftTolerance","rawV","driftToleranceSlider","orderPersistenceSlider","qcProfit","vPct","profitInput","qcProfitSlider","quickConfigUpdated","qcLevelSpacing","qcLevelSpacingSlider","defaultMatchBuffer","qcMatchBufferSlider","qcLevelsPerSide","qcUSDPerSide","qcLotsPerLevel","qcUSDPerSideEcho","qcLotsPerLevelEcho","maybeSubmitBuyRow","maybeSubmitSellRow","profitInputErr","showError","errID","botTypeSelectors","botTypeErr","cexSelection","setBotTypeSelected","exit","_botCfg$cexName","setupCEXes","initializeMarketRows","fetchCEXBalances","configureUI","_baseToken$parentID","_quoteToken$parentID","_botCfg$basicMarketMa","_botCfg2","_botCfg2$basicMarketM","_ref3$","_ref3$2","oldCfg","_botCfg","mmCfg","arbMMCfg","arbCfg","_k","_botCfg$uiConfig$simp","isQuickPlacements","botSettingsContainer","marketBox","noMarket","missingFiatRates","marketLoading","isViewOnly","deleteBttnBox","originalConfig","baseOptions","defaultWalletOptions","quoteOptions","creatingNewBot","baseWalletOptions","quoteWalletOptions","numEpochsLeaveOpen","driftToleranceBox","viewOnlyRunning","cexRebalanceSettings","fetchMarketReport","lotsPerLevelIncrement","showQuickConfig","_Object$values$_i$aut","_this2$page","needRegBox","mr","arbs","cexHasMarket","cexMarketSupportFilter","showBotTypeForm","marketSelectionTable","marketFilterBox","noMarkets","_a$spot$vol","_a$spot","_b$spot$vol","_b$spot","volA","volB","_this$specs3","_this$specs4","atomicRate","conv","atomic","dexBaseLots","dexQuoteLots","walletStuff","_feesAndCommit","baseFeeAssetID","quoteFeeAssetID","_this$specs5","_ref7$","_ref7$2","advancedConfig","quickConfig","_this$marketStuff","marketStuff","placementCount","levelsPerSide","worstBuy","worstSell","lotsPerLevel","_this$marketStuff2","showInputsForBot","usingUSDPerSide","matchMultiplierBox","placementChartLegend","lotsPerLevelLabel","levelSpacingBox","arbLotsLabel","qcLevelPerSideBox","qcUSDPerSideBox","qcLotsBox","_page$qcProfit$value","_page$qcLevelSpacing$","_page$qcMatchBuffer$v","_this$marketStuff3","qcError","levelSpacing","levelSpacingDisabled","levelN","updateBaseAllocations","updateQuoteAllocations","_this$marketStuff4","updateInventory","updateCommitTotal","_this$marketStuff5","_page$qcMatchBuffer$v2","configuredCEX","supportingCexes","nCexes","arbEnabled","_div2","_botType","lastBots","lastBot","_lastBot$cexName","lastCEX","_botType2","formSpecs","botTypeBaseSymbol","botTypeQuoteSymbol","formCexes","setCEXAvailability","noCexesConfigured","noCexMarket","noCexMarketConfigureMore","selectFormCEX","_this$specs6","selectedType","_this$formSpecs","_step4$value","selecteds","_lastBot$cexName2","marketSelectForm","_page$marketFilterInp","_this$marketStuff6","updateBalances","_page$cexRebalanceChe","_page$cexRebalanceChe2","submitBotWithValidation","_selecteds$0$dataset$","_this$formSpecs2","_tokenAssetApprovalSt","_tokenAssetApprovalSt2","bApproval","qApproval","_selecteds","multifundingopts","quoteAssetOnly","newCfg","gapStrategyModified","profitModified","buyPlacementsModified","buyPlacementsTableWrapper","sellPlacementsModified","sellPlacementsTableWrapper","toDisplay","initialLoadPlacement","sellPlacementsTableBody","addPlacementRow","addSellPlacementRow","lotsElement","gapFactorElement","errElement","sellPlacementsErr","buyPlacementsTableBody","addBuyPlacementRow","buyPlacementsErr","updateArrowVis","upBtn","downBtn","actualGapFactor","displayedGapFactor","setErr","gapFactorHeaderUnit","convertGapFactor","gapFactorErr","checkGapFactorRange","newRow","newRowTmpl","removeBtn","prevPlacement","nextPlacement","buyGapFactorHdr","sellGapFactorHdr","percentPlusInfo","percentInfo","absolutePlusInfo","absoluteInfo","multiplierInfo","_cfg$buyPlacements","_cfg$sellPlacements","_cfg$driftTolerance","_cfg$orderPersistence","_cfg$profit","_this$specs7","tol","persist","profitSelectorBox","orderPersistenceBox","setArbMMLabels","setupWalletSettings","showErrors","_this$updatedConfig","errEl","_this$marketStuff7","validateFields","basicMMConfig","arbMMConfig","basicArbConfig","updateBotConfig","_this$specs8","deleteErr","maxActiveArbs","_this$specs9","_r$oracles","oraclesLoading","oraclesTable","noOracles","oraclesErrMsg","oraclesErr","oracles","ExchangeNames","usdVol","avgPrice","_this$formSpecs3","_step13$value","_baseID","_quoteID","addCEX","selectedCEX","_Object$values5$_i","has","unavailable","needsconfig","disconnected","_Object$values6","_Object$values6$_i","_Object$values7","_this5$formSpecs","_Object$values8","showCEXConfigForm","_i15","_Object$values9","_cexStatus$markets","_Object$values9$_i","nSwapFees","nSwapFeesSlider","orderReservesSlider","slippageBufferSlider","minTransfer","totalInventory","minV","maxV","minTransferSlider","showBalance","showAddress","isQuote","_cfg$swapFeeN","_this$pg","_this$pg$specs","_this$pg$updatedConfi","walletConfig","_app$assets$this$feeA","feeName","inv","isToken","feeTotalBox","feeReservesBox","feeBalances","slippageBufferBox","feeTicker","cexMinInvBox","orderReservesBox","_cfg$orderReservesFac","counterLots","dexCommit","cexCommit","setLotSize","_this$pg$specs2","bookLots","bookLotSize","bookCommitment","feesPerLotConv","bookingFeesLots","cexMinInv","orderReservesBasis","feesPerSwapConv","feeReservesPerSwap","slippageBufferBasis","redemptionFeesBox","redemptionFeesPerLot","redemptionFeesLots","updateTokenFees","updateRebalance","commitTotal","commitTotalFiat","feeTotal","feeTotalFiat","_this$pg2","showRebalance","rebalanceOpts","rangeV","walletSettingsNone","optToDiv","dependentOpts","optKey","optSetting","dependentOn","currVal","boolSettingTmpl","parentOptKey","optKeys","setDependentOptsVis","_opt$xyRange","rangeSettingTmpl","_toFourSigFigs10","_toFourSigFigs12","_toFourSigFigs14","dependsOn","parentOptVal","_this$pg3","_this$pg3$specs","botInv","balanceBreakdown","DexSettingsPage","_updateBondOptions","_disableAutoRenew","_prepareUpdateHost","_prepareAccountDisable","_toggleAccountStatus","_exportAccount","_showSuccess","_runAnimation","_progressTierFormWithSyncedFundedWallet","_progressTierFormsWithWallet","renewToggle","runAnimation","progressTierFormsWithWallet","repMeter","exportDexBtn","exportAccount","accountDisabled","toggleAccountStatusBtn","toggleAccountStatus","prepareAccountDisable","disableAccountForm","updateCertBtn","certFileInput","updateHostBtn","prepareUpdateHost","goBackToSettings","showTierForm","changeTier","willAutoRenew","toggleAutoRenew","renewErr","disableAutoRenew","autoRenewBox","penaltyComps","hideCompInput","penaltyCompInput","penaltyCompBox","checkClick","penaltyCompsErr","otherBondSettings","updateBondOptions","disableAccountConfirm","setAssetError","progressTierFormWithSyncedFundedWallet","liveStrength","penalties","expiredBonds","bondsPendingRefund","accountForExport","exportAccountErr","disableAccountHost","disableAccountErr","updateCertMsg","displayIcons","disconnectedIcon","connectedIcon","Disconnected","InvalidCert","conf","_conf$targetTier","MarketMakerArchivesPage","runTableRowTmpl","backButton","runs","_runs$i","_runs$i$market","logs","settings","runTableBody","MarketMakerLogsPage","_applyFilters","_getRunLogs","params","_params","eventTableRowTmpl","dexOrderTxRowTmpl","performanceTableRowTmpl","_params$returnPage","filterButton","applyFilters","searchParams","replaceState","urlParams","_params2","events","statsRows","doneScrolling","eventsTable","_yield$this$getRunLog","_yield$this$getRunLog2","updatedLogs","overview","event","getRunLogs","mktAssets","newEventRow","populateStats","endTime","updateExistingRows","filters","refID","_yield$this$getRunLog3","_yield$this$getRunLog4","dexSells","dexSellsCheckbox","dexBuys","dexBuysCheckbox","cexSells","cexSellsCheckbox","cexBuys","cexBuysCheckbox","deposits","depositsCheckbox","withdrawals","withdrawalsCheckbox","populateTable","_botStatus$runStats","_yield$this$getRunLog5","_yield$this$getRunLog6","parentHeader","setFilters","liveBot","finalState","sumUSDHeader","handleRunEventNote","dexOrderEvent","cexOrderEvent","depositEvent","withdrawalEvent","cachedEvent","setRowContents","pl","endTimeRow","diffs","performanceTableBody","usdDiff","fmtUSD","formatFiatValue","eventsTableBody","eventType","eventID","usd","be","balanceEffects","sumBalanceEffects","tmplID","sumUSD","showEventDetails","dexOrderIDCopyListener","copyDexOrderID","dexOrderID","dexOrderRate","dexOrderQty","dexOrderSide","dexOrderTxsTableBody","transactions","dexOrderTxsTable","txAsset","wallets","dexOrderDetailsForm","cexOrderID","cexOrderIDCopyListener","copyCexOrderID","cexOrderRate","cexOrderQty","cexOrderSide","cexOrderBaseFilled","baseFilled","cexOrderQuoteFilled","quoteFilled","cexOrderDetailsForm","depositID","depositIDCopyListener","copyDepositID","depositAmt","depositFees","depositStatus","depositCreditSection","depositCredit","cexCredit","depositDetailsForm","withdrawalID","withdrawalIDCopyListener","copyWithdrawalID","withdrawalAmt","cexDebit","withdrawalStatus","withdrawalTxID","withdrawalReceived","withdrawalDetailsForm","showDexOrderEventDetails","showCexOrderEventDetails","showDepositEventDetails","showWithdrawalEventDetails","InitPage","_appInited","initForm","AppInitForm","appPWForm","appInited","quickConfigForm","QuickConfigForm","quickConfigDone","seedBackupForm","SeedBackupForm","seedBackedUp","appPWSubmit","setAppPass","toggleSeedInput","seedInputBox","toggleSeedInputIcon","_setAppPass","_page$seedInput$value","pwAgain","appPWErrMsg","appPWAgain","rowIDCounter","qcServerTmpl","qcWalletTmpl","quickConfigSubmit","qcErrAck","_row","_tmpl","_rowID","autoConfigurable","rowID","servers","qcServersBox","qcWalletsBox","failedHosts","failedWallets","connectServer","srvRow","all","walletRow","_walletDef$configopts","appPass","qcChoices","qcErrors","qcServerErrorList","createTextNode","qcServerErrors","qcWalletErrorList","qcWalletErrors","seedAck","showSeed","sbWanna","sbSeed","constructors","register","dexsettings","mmsettings","mmarchives","mmlogs","languageData","flag","Application","process","noteReceivers","txHistoryMap","requiredActions","loggers","loggersLK","enableLogger","loggerID","recorderKeys","recordersLK","recorders","recordLogger","dumpLogger","btoa","download","_needsCustomProvider","_txHistory","_signOut","_fetchBalance","_fetchNotes","_setLanguage","_submitAction","_loadPage","_fetchMMStatus","_fetchUser","_e$state","handlerFromPath","attachHeader","attachActions","attachCommon","attach","fetchNotes","protocol","reconnected","notify","_this$main","_arr$_i","inited","langs","seedgentime","skipPush","requestedHandler","doc","delivered","noteBox","profileBox","origin","pushState","handlerID","loadedPage","unload","bindUnits","lyt","_step3$value","openUrl","_link$href","popupNotes","popupTmpl","noteTmpl","pokeTmpl","loader","noteBell","pokeList","noteList","ackNotes","noteCat","pokeCat","showDropdown","noteIndicator","setNoteTimes","burgerIcon","logoutErr","innerNoteIcon","innerBurgerIcon","profileSignout","signOut","langBttnTmpl","_languageData$this$la","langFlag","langName","_languageData$lang","setLanguage","langBttns","missingNoncesTmpl","actionTxTableTmpl","tooCheapTmpl","lostNonceTmpl","actionsCollapse","actionDialog","actionDialogCollapsed","actionDialogContent","showOldestAction","showAdjacentAction","dir","actions","sortedActions","showRequestedAction","uniqueID","prevAction","nextAction","addAction","blinkAction","existingAction","actionID","actionForm","actionDialogCount","actionCount","resolveActionWithID","rem","tooCheapAction","missingNoncesAction","lostNonceAction","redeemRejectedAction","_this$assets$assetID","table","lostTxID","txAmt","amtUnit","parentUI","feeAmount","feeUnit","newFeesRow","newFees","newFeesUnit","action","doNothingBttn","submitAction","recover","recoverBttn","txTable","actionTxTable","act","bump","keepWaitingBttn","addFeesBttn","nonce","abandonBttn","abandon","replaceBttn","replacementID","idInput","coinID","coinFmt","rejectedRedemptionTmpl","_this$assets$assetID2","retry","tryAgainBttn","actionsNavigator","currentAction","getAsset","xcAsset","_getAsset","_getAsset2","dialog","ico","acks","severity","pageURL","walletsMenuEntry","marketsMenuEntry","mmLink","setNotes","setPokes","setRequiredActions","bondedTier","updateBondConfs","confirmations","updateTier","prependNoteElement","prependPokeElement","_this$mmStatus$bots","_this$mmStatus","orderNote","tempID","inFlight","updateOrder","handleBondNote","updateMatch","mktName","txNote","handleTransactionNote","resolveAction","handleTxHistorySyncedNote","updateUser","stack","indicator","setSeverityClass","_console","nowString","cn","_this$makePoke2","makePoke","prependListElement","_this$makeNote2","makeNote","unacked","ni","noteCacheSize","cls","fromAssetID","_order$matches","supportedAsset","_this$user$extensionM","restrictedWallets","baseChainSymbol","emptyidx","def","removeCookie","authCK","pwKeyCK","notificationsLK","cachedTxHistory","_txs","startIndex","lastIndex","_cachedTxHistory$txs","_res","resTxs","past","_this$assets$assetID$","_this$assets$assetID3","_this$assets$assetID4","providers","severityClassMap","_severityClassMap","getSeconds","getMilliseconds"],"sourceRoot":""}