/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/css/application.scss":
/*!**********************************!*\
  !*** ./src/css/application.scss ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/css/bootstrap.scss":
/*!********************************!*\
  !*** ./src/css/bootstrap.scss ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ }),

/***/ "./src/js/account.ts":
/*!***************************!*\
  !*** ./src/js/account.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ReputationMeter": () => (/* binding */ ReputationMeter),
/* harmony export */   "bondReserveMultiplier": () => (/* binding */ bondReserveMultiplier),
/* harmony export */   "epochWeight": () => (/* binding */ epochWeight),
/* harmony export */   "likelyTaker": () => (/* binding */ likelyTaker),
/* harmony export */   "parcelLimitScoreMultiplier": () => (/* binding */ parcelLimitScoreMultiplier),
/* harmony export */   "perTierBaseParcelLimit": () => (/* binding */ perTierBaseParcelLimit),
/* harmony export */   "strongTier": () => (/* binding */ strongTier),
/* harmony export */   "tradingLimits": () => (/* binding */ tradingLimits)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");



const bondReserveMultiplier = 2; // Reserves for next bond
const perTierBaseParcelLimit = 2;
const parcelLimitScoreMultiplier = 3;
class ReputationMeter {
    constructor(div) {
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(this.page.penaltyMarkerTmpl);
    }
    setHost(host) {
        this.host = host;
    }
    update() {
        const { page, host } = this;
        const { auth, maxScore, penaltyThreshold } = (0,_registry__WEBPACK_IMPORTED_MODULE_2__.app)().exchanges[host];
        const { rep: { score } } = auth;
        const displayTier = strongTier(auth);
        const minScore = displayTier ? displayTier * penaltyThreshold * -1 : penaltyThreshold * -1; // Just for looks
        const warnPct = 25;
        const scorePct = 100 - warnPct;
        page.scoreWarn.style.width = `${warnPct}%`;
        const pos = score >= 0 ? warnPct + (score / maxScore) * scorePct : warnPct - (Math.min(warnPct, score / minScore * warnPct));
        page.scorePointer.style.left = `${pos}%`;
        page.scoreMin.textContent = String(minScore);
        page.scoreMax.textContent = String(maxScore);
        const bonus = limitBonus(score, maxScore);
        page.limitBonus.textContent = bonus.toFixed(1);
        for (const m of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.scoreTray, '.penalty-marker'))
            m.remove();
        if (displayTier > 1) {
            const markerPct = warnPct / displayTier;
            for (let i = 1; i < displayTier; i++) {
                const div = page.penaltyMarkerTmpl.cloneNode(true);
                page.scoreTray.appendChild(div);
                div.style.left = `${markerPct * i}%`;
            }
        }
        page.score.textContent = String(score);
        page.scoreData.classList.remove('negative', 'positive');
        if (score > 0)
            page.scoreData.classList.add('positive');
        else
            page.scoreData.classList.add('negative');
    }
}
/*
 * strongTier is the effective tier, with some respect for bond overlap, such
 * that we don't count weak bonds that have already had their replacements
 * confirmed.
 */
function strongTier(auth) {
    const { weakStrength, targetTier, effectiveTier } = auth;
    if (effectiveTier > targetTier) {
        const diff = effectiveTier - targetTier;
        if (weakStrength >= diff)
            return targetTier;
        return targetTier + (diff - weakStrength);
    }
    return effectiveTier;
}
function likelyTaker(ord, rate) {
    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_1__.OrderTypeMarket || ord.tif === _orderutil__WEBPACK_IMPORTED_MODULE_1__.ImmediateTiF)
        return true;
    // Must cross the spread to be a taker (not so conservative).
    if (rate === 0)
        return false;
    if (ord.sell)
        return ord.rate < rate;
    return ord.rate > rate;
}
const preparcelQuantity = (ord, mkt, midGap) => {
    var _a, _b;
    const qty = ord.qty - ord.filled;
    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_1__.OrderTypeLimit)
        return qty;
    if (ord.sell)
        return qty * ord.rate / _orderutil__WEBPACK_IMPORTED_MODULE_1__.RateEncodingFactor;
    const rate = midGap || ((_a = mkt === null || mkt === void 0 ? void 0 : mkt.spot) === null || _a === void 0 ? void 0 : _a.rate) || 0;
    // Caller should not call this for market orders without a mkt arg.
    if (!mkt)
        return 0;
    // This is tricky. The server will use the mid-gap rate to convert the
    // order qty. We don't have a mid-gap rate, only a spot rate.
    if (rate && (((_b = mkt === null || mkt === void 0 ? void 0 : mkt.spot) === null || _b === void 0 ? void 0 : _b.bookVolume) || 0) > 0)
        return qty * _orderutil__WEBPACK_IMPORTED_MODULE_1__.RateEncodingFactor / rate;
    return mkt.lotsize; // server uses same fallback if book is empty
};
function epochWeight(ord, mkt, midGap) {
    var _a;
    if (ord.status !== _orderutil__WEBPACK_IMPORTED_MODULE_1__.StatusEpoch)
        return 0;
    const qty = preparcelQuantity(ord, mkt, midGap);
    const rate = midGap || ((_a = mkt.spot) === null || _a === void 0 ? void 0 : _a.rate) || 0;
    if (likelyTaker(ord, rate))
        return qty * 2;
    return qty;
}
function bookWeight(ord) {
    if (ord.status !== _orderutil__WEBPACK_IMPORTED_MODULE_1__.StatusBooked)
        return 0;
    return preparcelQuantity(ord);
}
function settlingWeight(ord) {
    let sum = 0;
    for (const m of (ord.matches || [])) {
        if (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_1__.MatchSideMaker) {
            if (m.status > _orderutil__WEBPACK_IMPORTED_MODULE_1__.MakerRedeemed)
                continue;
        }
        else if (m.status > _orderutil__WEBPACK_IMPORTED_MODULE_1__.TakerSwapCast)
            continue;
        sum += m.qty;
    }
    return sum;
}
function parcelWeight(ord, mkt, midGap) {
    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_1__.OrderTypeCancel)
        return 0;
    return epochWeight(ord, mkt, midGap) + bookWeight(ord) + settlingWeight(ord);
}
// function roundParcels (p: number): number {
//   return Math.floor(Math.round((p * 1e8)) / 1e8)
// }
function limitBonus(score, maxScore) {
    return score > 0 ? 1 + score / maxScore * (parcelLimitScoreMultiplier - 1) : 1;
}
function tradingLimits(host) {
    const { auth, maxScore, markets } = (0,_registry__WEBPACK_IMPORTED_MODULE_2__.app)().exchanges[host];
    const { rep: { score } } = auth;
    const tier = strongTier(auth);
    let usedParcels = 0;
    for (const mkt of Object.values(markets)) {
        let mktWeight = 0;
        for (const ord of (mkt.inflight || []))
            mktWeight += parcelWeight(ord, mkt);
        for (const ord of (mkt.orders || []))
            mktWeight += parcelWeight(ord, mkt);
        usedParcels += (mktWeight / (mkt.parcelsize * mkt.lotsize));
    }
    const parcelLimit = perTierBaseParcelLimit * limitBonus(score, maxScore) * tier;
    return [usedParcels, parcelLimit];
}


/***/ }),

/***/ "./src/js/app.ts":
/*!***********************!*\
  !*** ./src/js/app.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ Application)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _register__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./register */ "./src/js/register.ts");
/* harmony import */ var _login__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./login */ "./src/js/login.ts");
/* harmony import */ var _wallets__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./wallets */ "./src/js/wallets.ts");
/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./settings */ "./src/js/settings.ts");
/* harmony import */ var _markets__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./markets */ "./src/js/markets.ts");
/* harmony import */ var _orders__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./orders */ "./src/js/orders.ts");
/* harmony import */ var _order__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./order */ "./src/js/order.ts");
/* harmony import */ var _mm__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./mm */ "./src/js/mm.ts");
/* harmony import */ var _mmsettings__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./mmsettings */ "./src/js/mmsettings.ts");
/* harmony import */ var _dexsettings__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./dexsettings */ "./src/js/dexsettings.ts");
/* harmony import */ var _mmarchives__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./mmarchives */ "./src/js/mmarchives.ts");
/* harmony import */ var _mmlogs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./mmlogs */ "./src/js/mmlogs.ts");
/* harmony import */ var _init__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./init */ "./src/js/init.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _notifications__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./notifications */ "./src/js/notifications.ts");
/* harmony import */ var _ws__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./ws */ "./src/js/ws.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






















const idel = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel; // = element by id
const bind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind;
const unbind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind;
const notificationRoute = 'notify';
const noteCacheSize = 100;
/* constructors is a map to page constructors. */
const constructors = {
    login: _login__WEBPACK_IMPORTED_MODULE_3__["default"],
    register: _register__WEBPACK_IMPORTED_MODULE_2__["default"],
    markets: _markets__WEBPACK_IMPORTED_MODULE_6__["default"],
    wallets: _wallets__WEBPACK_IMPORTED_MODULE_4__["default"],
    settings: _settings__WEBPACK_IMPORTED_MODULE_5__["default"],
    orders: _orders__WEBPACK_IMPORTED_MODULE_7__["default"],
    order: _order__WEBPACK_IMPORTED_MODULE_8__["default"],
    dexsettings: _dexsettings__WEBPACK_IMPORTED_MODULE_11__["default"],
    init: _init__WEBPACK_IMPORTED_MODULE_14__["default"],
    mm: _mm__WEBPACK_IMPORTED_MODULE_9__["default"],
    mmsettings: _mmsettings__WEBPACK_IMPORTED_MODULE_10__["default"],
    mmarchives: _mmarchives__WEBPACK_IMPORTED_MODULE_12__["default"],
    mmlogs: _mmlogs__WEBPACK_IMPORTED_MODULE_13__["default"]
};
const languageData = {
    'en-US': {
        name: 'English',
        flag: '🇺🇸' // Not 🇬🇧. MURICA!
    },
    'pt-BR': {
        name: 'Portugese',
        flag: '🇧🇷'
    },
    'zh-CN': {
        name: 'Chinese',
        flag: '🇨🇳'
    },
    'pl-PL': {
        name: 'Polish',
        flag: '🇵🇱'
    },
    'de-DE': {
        name: 'German',
        flag: '🇩🇪'
    },
    'ar': {
        name: 'Arabic',
        flag: '🇪🇬' // Egypt I guess
    }
};
// Application is the main javascript web application for Bison Wallet.
class Application {
    constructor() {
        this.notes = [];
        this.pokes = [];
        this.seedGenTime = 0;
        this.commitHash = "e9b6f8aaf74ed2a53867b9f8183cd06da9877708" || 0;
        this.noteReceivers = [];
        this.fiatRatesMap = {};
        this.showPopups = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].popupsLK) === '1';
        this.txHistoryMap = {};
        this.requiredActions = {};
        console.log('Bison Wallet, Build', this.commitHash.substring(0, 7));
        // Set Bootstrap dark theme attribute if dark mode is enabled.
        if (_state__WEBPACK_IMPORTED_MODULE_1__["default"].isDark()) {
            document.body.classList.add('dark');
        }
        // Loggers can be enabled by setting a truthy value to the loggerID using
        // enableLogger. Settings are stored across sessions. See docstring for the
        // log method for more info.
        this.loggers = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].loggersLK) || {};
        window.enableLogger = (loggerID, state) => {
            if (state)
                this.loggers[loggerID] = true;
            else
                delete this.loggers[loggerID];
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].loggersLK, this.loggers);
            return `${loggerID} logger ${state ? 'enabled' : 'disabled'}`;
        };
        // Enable logging from anywhere.
        window.log = (loggerID, ...a) => { this.log(loggerID, ...a); };
        window.mmStatus = () => this.mmStatus;
        // Recorders can record log messages, and then save them to file on request.
        const recorderKeys = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].recordersLK) || [];
        this.recorders = {};
        for (const loggerID of recorderKeys) {
            console.log('recording', loggerID);
            this.recorders[loggerID] = [];
        }
        window.recordLogger = (loggerID, on) => {
            if (on)
                this.recorders[loggerID] = [];
            else
                delete this.recorders[loggerID];
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].recordersLK, Object.keys(this.recorders));
            return `${loggerID} recorder ${on ? 'enabled' : 'disabled'}`;
        };
        window.dumpLogger = loggerID => {
            const record = this.recorders[loggerID];
            if (!record)
                return `no recorder for logger ${loggerID}`;
            const a = document.createElement('a');
            a.href = `data:application/octet-stream;base64,${window.btoa(JSON.stringify(record, null, 4))}`;
            a.download = `${loggerID}.json`;
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                document.body.removeChild(a);
            }, 0);
        };
        window.user = () => this.user;
    }
    /**
     * Start the application. This is the only thing done from the index.js entry
     * point. Read the id = main element and attach handlers.
     */
    start() {
        return __awaiter(this, void 0, void 0, function* () {
            // Handle back navigation from the browser.
            bind(window, 'popstate', (e) => {
                var _a;
                const page = (_a = e.state) === null || _a === void 0 ? void 0 : _a.page;
                if (!page && page !== '')
                    return;
                this.loadPage(page, e.state.data, true);
            });
            // The main element is the interchangeable part of the page that doesn't
            // include the header. Main should define a data-handler attribute
            // associated with one of the available constructors.
            this.main = idel(document, 'main');
            const handler = this.main.dataset.handler;
            // Don't fetch the user until we know what page we're on.
            yield this.fetchUser();
            const ignoreCachedLocale = "development" === 'development';
            yield _locales__WEBPACK_IMPORTED_MODULE_20__.loadLocale(this.lang, this.commitHash, ignoreCachedLocale);
            // The application is free to respond with a page that differs from the
            // one requested in the omnibox, e.g. routing though a login page. Set the
            // current URL state based on the actual page.
            const url = new URL(window.location.href);
            if (handlerFromPath(url.pathname) !== handler) {
                url.pathname = `/${handler}`;
                url.search = '';
                window.history.replaceState({ page: handler }, '', url);
            }
            // Attach stuff.
            this.attachHeader();
            this.attachActions();
            this.attachCommon(this.header);
            this.attach({});
            // If we are authed, populate notes, otherwise get we'll them from the login
            // response.
            if (this.authed)
                yield this.fetchNotes();
            this.updateMenuItemsDisplay();
            // initialize desktop notifications
            _notifications__WEBPACK_IMPORTED_MODULE_18__.fetchDesktopNtfnSettings();
            // Connect the websocket and register the notification route.
            _ws__WEBPACK_IMPORTED_MODULE_19__["default"].connect(getSocketURI(), () => this.reconnected());
            _ws__WEBPACK_IMPORTED_MODULE_19__["default"].registerRoute(notificationRoute, (note) => {
                this.notify(note);
            });
        });
    }
    /*
     * reconnected is called by the websocket client when a reconnection is made.
     */
    reconnected() {
        var _a;
        if (((_a = this.main) === null || _a === void 0 ? void 0 : _a.dataset.handler) === 'settings')
            window.location.assign('/');
        else
            window.location.reload(); // This triggers another websocket disconnect/connect (!)
        // a fetchUser() and loadPage(window.history.state.page) might work
    }
    /*
     * Fetch and save the user, which is the primary core state that must be
     * maintained by the Application.
     */
    fetchUser() {
        return __awaiter(this, void 0, void 0, function* () {
            const resp = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.getJSON)('/api/user');
            if (!this.checkResponse(resp))
                return;
            this.inited = resp.inited;
            this.authed = Boolean(resp.user);
            this.lang = resp.lang;
            this.langs = resp.langs;
            this.mmStatus = resp.mmStatus;
            if (!resp.user)
                return;
            const user = resp.user;
            this.seedGenTime = user.seedgentime;
            this.user = user;
            this.assets = user.assets;
            this.exchanges = user.exchanges;
            this.walletMap = {};
            this.fiatRatesMap = user.fiatRates;
            for (const [assetID, asset] of Object.entries(user.assets)) {
                if (asset.wallet) {
                    this.walletMap[assetID] = asset.wallet;
                }
            }
            this.updateMenuItemsDisplay();
            return user;
        });
    }
    fetchMMStatus() {
        return __awaiter(this, void 0, void 0, function* () {
            this.mmStatus = yield _mmutil__WEBPACK_IMPORTED_MODULE_15__.MM.status();
        });
    }
    /* Load the page from the server. Insert and bind the DOM. */
    loadPage(page, data, skipPush) {
        return __awaiter(this, void 0, void 0, function* () {
            // Close some menus and tooltips.
            this.tooltip.style.left = '-10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noteBox, this.page.profileBox);
            // Parse the request.
            const url = new URL(`/${page}`, window.location.origin);
            const requestedHandler = handlerFromPath(page);
            // Fetch and parse the page.
            const response = yield window.fetch(url.toString());
            if (!response.ok)
                return false;
            const html = yield response.text();
            const doc = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].noderize(html);
            const main = idel(doc, 'main');
            const delivered = main.dataset.handler;
            // Append the request to the page history.
            if (!skipPush) {
                const path = delivered === requestedHandler ? url.toString() : `/${delivered}`;
                window.history.pushState({ page: page, data: data }, '', path);
            }
            // Insert page and attach handlers.
            document.title = doc.title;
            this.main.replaceWith(main);
            this.main = main;
            this.noteReceivers = [];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.headerSpace);
            this.attach(data);
            return true;
        });
    }
    /* attach binds the common handlers and calls the page constructor. */
    attach(data) {
        const handlerID = this.main.dataset.handler;
        if (!handlerID) {
            console.error('cannot attach to content with no specified handler');
            return;
        }
        this.attachCommon(this.main);
        if (this.loadedPage)
            this.loadedPage.unload();
        const constructor = constructors[handlerID];
        if (constructor)
            this.loadedPage = new constructor(this.main, data);
        else
            this.loadedPage = null;
        // Bind the tooltips.
        this.bindTooltips(this.main);
        if (window.isWebview) {
            // Bind webview URL handlers
            this.bindUrlHandlers(this.main);
        }
        this.bindUnits(this.main);
    }
    bindTooltips(ancestor) {
        ancestor.querySelectorAll('[data-tooltip]').forEach((el) => {
            bind(el, 'mouseenter', () => {
                this.tooltip.textContent = el.dataset.tooltip || '';
                const lyt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(el);
                let left = lyt.centerX - this.tooltip.offsetWidth / 2;
                if (left < 0)
                    left = 5;
                if (left + this.tooltip.offsetWidth > document.body.offsetWidth) {
                    left = document.body.offsetWidth - this.tooltip.offsetWidth - 5;
                }
                this.tooltip.style.left = `${left}px`;
                this.tooltip.style.top = `${lyt.bodyTop - this.tooltip.offsetHeight - 5}px`;
            });
            bind(el, 'mouseleave', () => {
                this.tooltip.style.left = '-10000px';
            });
        });
    }
    /*
     * bindUnits binds a hovering unit selection menu to the value or rate
     * display elements. The menu gives users an option to convert the value
     * to their preferred units.
     */
    bindUnits(main) {
        const div = document.createElement('div');
        div.classList.add('position-absolute', 'p-3');
        // div.style.backgroundColor = 'yellow'
        const rows = document.createElement('div');
        div.appendChild(rows);
        rows.classList.add('body-bg', 'border');
        const addRow = (el, unit, cFactor) => {
            const box = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, '[data-unit-box]');
            const atoms = parseInt(box.dataset.atoms);
            const row = document.createElement('div');
            row.textContent = unit;
            rows.appendChild(row);
            row.classList.add('p-2', 'hoverbg', 'pointer');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(el, '[data-value]', _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(atoms / cFactor, Math.round(Math.log10(cFactor))));
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(el, '[data-unit]', unit);
            });
        };
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(main, '[data-conversion-value]')) {
            const box = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, '[data-unit-box]');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(box, 'mouseenter', () => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(rows);
                box.appendChild(div);
                const lyt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(box);
                const assetID = parseInt(box.dataset.assetID);
                const { unitInfo: ui } = this.assets[assetID];
                addRow(el, ui.conventional.unit, ui.conventional.conversionFactor);
                for (const { unit, conversionFactor } of ui.denominations)
                    addRow(el, unit, conversionFactor);
                addRow(el, ui.atomicUnit, 1);
                if (lyt.bodyTop > (div.offsetHeight + this.header.offsetHeight)) {
                    div.style.bottom = 'calc(100% - 1rem)';
                    div.style.top = 'auto';
                }
                else {
                    div.style.top = 'calc(100% - 1rem)';
                    div.style.bottom = 'auto';
                }
            });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(box, 'mouseleave', () => div.remove());
        }
    }
    bindUrlHandlers(ancestor) {
        if (!window.openUrl)
            return;
        for (const link of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, 'a[target=_blank]')) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(link, 'click', (e) => {
                var _a;
                e.preventDefault();
                window.openUrl((_a = link.href) !== null && _a !== void 0 ? _a : '');
            });
        }
    }
    /* attachHeader attaches the header element, which unlike the main element,
     * isn't replaced during page navigation.
     */
    attachHeader() {
        this.header = idel(document.body, 'header');
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(this.header);
        this.headerSpace = page.headerSpace;
        this.popupNotes = idel(document.body, 'popupNotes');
        this.popupTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(this.popupNotes, 'note');
        if (this.popupTmpl)
            this.popupTmpl.remove();
        else
            console.error('popupTmpl element not found');
        this.tooltip = idel(document.body, 'tooltip');
        page.noteTmpl.removeAttribute('id');
        page.noteTmpl.remove();
        page.pokeTmpl.removeAttribute('id');
        page.pokeTmpl.remove();
        page.loader.remove();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.loader);
        bind(page.noteBell, 'click', () => __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.pokeList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noteList);
            this.ackNotes();
            page.noteCat.classList.add('active');
            page.pokeCat.classList.remove('active');
            this.showDropdown(page.noteBell, page.noteBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteIndicator);
            for (const note of this.notes) {
                if (note.acked) {
                    note.el.classList.remove('firstview');
                }
            }
            this.setNoteTimes(page.noteList);
            this.setNoteTimes(page.pokeList);
        }));
        bind(page.burgerIcon, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.logoutErr);
            this.showDropdown(page.burgerIcon, page.profileBox);
        });
        bind(page.innerNoteIcon, 'click', () => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteBox); });
        bind(page.innerBurgerIcon, 'click', () => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.profileBox); });
        bind(page.profileSignout, 'click', () => __awaiter(this, void 0, void 0, function* () { return yield this.signOut(); }));
        bind(page.pokeCat, 'click', () => {
            this.setNoteTimes(page.pokeList);
            page.pokeCat.classList.add('active');
            page.noteCat.classList.remove('active');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.pokeList);
            this.ackNotes();
        });
        bind(page.noteCat, 'click', () => {
            this.setNoteTimes(page.noteList);
            page.noteCat.classList.add('active');
            page.pokeCat.classList.remove('active');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.pokeList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noteList);
            this.ackNotes();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.langBttnTmpl);
        const { name, flag } = languageData[this.lang];
        page.langFlag.textContent = flag;
        page.langName.textContent = name;
        for (const lang of this.langs) {
            if (lang === this.lang)
                continue;
            const div = page.langBttnTmpl.cloneNode(true);
            const { name, flag } = languageData[lang];
            div.textContent = flag;
            div.title = name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'click', () => this.setLanguage(lang));
            page.langBttns.appendChild(div);
        }
    }
    attachActions() {
        const { page } = this;
        Object.assign(page, _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel(document.body, 'requiredActions')));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.missingNoncesTmpl, page.actionTxTableTmpl, page.tooCheapTmpl, page.lostNonceTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.actionsCollapse, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialog);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionDialogCollapsed);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.actionDialogCollapsed, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialogCollapsed);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionDialog);
            if (page.actionDialogContent.children.length === 0)
                this.showOldestAction();
        });
        const showAdjacentAction = (dir) => {
            const selected = Object.values(this.requiredActions).filter((r) => r.selected)[0];
            const actions = this.sortedActions();
            const idx = actions.indexOf(selected);
            this.showRequestedAction(actions[idx + dir].uniqueID);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.prevAction, 'click', () => showAdjacentAction(-1));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.nextAction, 'click', () => showAdjacentAction(1));
    }
    setRequiredActions() {
        const { user: { actions }, requiredActions } = this;
        if (!actions)
            return;
        for (const a of actions)
            this.addAction(a);
        if (Object.keys(requiredActions).length) {
            this.showOldestAction();
            this.blinkAction();
        }
    }
    sortedActions() {
        const actions = Object.values(this.requiredActions);
        actions.sort((a, b) => a.stamp - b.stamp);
        return actions;
    }
    showOldestAction() {
        this.showRequestedAction(this.sortedActions()[0].uniqueID);
    }
    addAction(req) {
        const { page, requiredActions } = this;
        const existingAction = requiredActions[req.uniqueID];
        if (existingAction && existingAction.actionID === req.actionID)
            return;
        const div = this.actionForm(req);
        if (existingAction) {
            if (existingAction.selected)
                existingAction.div.replaceWith(div);
            existingAction.div = div;
        }
        else {
            requiredActions[req.uniqueID] = {
                div,
                stamp: (new Date()).getTime(),
                uniqueID: req.uniqueID,
                actionID: req.actionID,
                selected: false
            };
            const n = Object.keys(requiredActions).length;
            page.actionDialogCount.textContent = String(n);
            page.actionCount.textContent = String(n);
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.actionDialog)) {
                this.showRequestedAction(req.uniqueID);
            }
        }
    }
    blinkAction() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(this.page.actionDialog);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(this.page.actionDialogCollapsed);
    }
    resolveAction(req) {
        this.resolveActionWithID(req.uniqueID);
    }
    resolveActionWithID(uniqueID) {
        const { page, requiredActions } = this;
        const existingAction = requiredActions[uniqueID];
        if (!existingAction)
            return;
        delete requiredActions[uniqueID];
        const rem = Object.keys(requiredActions).length;
        existingAction.div.remove();
        if (rem === 0) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialog, page.actionDialogCollapsed);
            return;
        }
        page.actionDialogCount.textContent = String(rem);
        page.actionCount.textContent = String(rem);
        if (existingAction.selected)
            this.showOldestAction();
    }
    actionForm(req) {
        switch (req.actionID) {
            case 'tooCheap':
                return this.tooCheapAction(req);
            case 'missingNonces':
                return this.missingNoncesAction(req);
            case 'lostNonce':
                return this.lostNonceAction(req);
            case 'redeemRejected':
                return this.redeemRejectedAction(req);
        }
        throw Error('unknown required action ID ' + req.actionID);
    }
    actionTxTable(req) {
        const { assetID, payload } = req;
        const n = payload;
        const { unitInfo: ui, token } = this.assets[assetID];
        const table = this.page.actionTxTableTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(table);
        tmpl.lostTxID.textContent = n.tx.id;
        tmpl.lostTxID.dataset.explorerCoin = n.tx.id;
        (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_21__.setCoinHref)(token ? token.parentID : assetID, tmpl.lostTxID);
        tmpl.txAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.tx.amount, ui);
        tmpl.amtUnit.textContent = ui.conventional.unit;
        const parentUI = token ? this.unitInfo(token.parentID) : ui;
        tmpl.type.textContent = (0,_wallets__WEBPACK_IMPORTED_MODULE_4__.txTypeString)(n.tx.type);
        tmpl.feeAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.tx.fees, parentUI);
        tmpl.feeUnit.textContent = parentUI.conventional.unit;
        switch (req.actionID) {
            case 'tooCheap': {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.newFeesRow);
                tmpl.newFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.tx.fees, parentUI);
                tmpl.newFeesUnit.textContent = parentUI.conventional.unit;
                break;
            }
        }
        return table;
    }
    submitAction(req, action, errMsg) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(errMsg);
            const loading = this.loading(this.page.actionDialog);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/takeaction', {
                assetID: req.assetID,
                actionID: req.actionID,
                action
            });
            loading();
            if (!this.checkResponse(res)) {
                errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(errMsg);
                return;
            }
            this.resolveActionWithID(req.uniqueID);
        });
    }
    missingNoncesAction(req) {
        const { assetID } = req;
        const div = this.page.missingNoncesTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.doNothingBttn, 'click', () => {
            this.submitAction(req, { recover: false }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.recoverBttn, 'click', () => {
            this.submitAction(req, { recover: true }, tmpl.errMsg);
        });
        return div;
    }
    tooCheapAction(req) {
        const { assetID, payload } = req;
        const n = payload;
        const div = this.page.tooCheapTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        tmpl.txTable.appendChild(this.actionTxTable(req));
        const act = (bump) => {
            this.submitAction(req, {
                txID: n.tx.id,
                bump
            }, tmpl.errMsg);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.keepWaitingBttn, 'click', () => act(false));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.addFeesBttn, 'click', () => act(true));
        return div;
    }
    lostNonceAction(req) {
        const { assetID, payload } = req;
        const n = payload;
        const div = this.page.lostNonceTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        tmpl.nonce.textContent = String(n.nonce);
        tmpl.txTable.appendChild(this.actionTxTable(req));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.abandonBttn, 'click', () => {
            this.submitAction(req, { txID: n.tx.id, abandon: true }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.keepWaitingBttn, 'click', () => {
            this.submitAction(req, { txID: n.tx.id, abandon: false }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.replaceBttn, 'click', () => {
            const replacementID = tmpl.idInput.value;
            if (!replacementID) {
                tmpl.idInput.focus();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(tmpl.idInput);
                return;
            }
            this.submitAction(req, { txID: n.tx.id, abandon: false, replacementID }, tmpl.errMsg);
        });
        return div;
    }
    redeemRejectedAction(req) {
        const { orderID, coinID, coinFmt, assetID } = req.payload;
        const div = this.page.rejectedRedemptionTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
        const { name, token } = this.assets[assetID];
        tmpl.assetName.textContent = name;
        tmpl.txid.textContent = coinFmt;
        tmpl.txid.dataset.explorerCoin = coinID;
        (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_21__.setCoinHref)(token ? token.parentID : assetID, tmpl.txid);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.doNothingBttn, 'click', () => {
            this.submitAction(req, { orderID, coinID, retry: false }, tmpl.errMsg);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.tryAgainBttn, 'click', () => {
            this.submitAction(req, { orderID, coinID, retry: true }, tmpl.errMsg);
        });
        return div;
    }
    showRequestedAction(uniqueID) {
        const { page, requiredActions } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionDialogCollapsed);
        for (const r of Object.values(requiredActions))
            r.selected = r.uniqueID === uniqueID;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.actionDialogContent);
        const action = requiredActions[uniqueID];
        page.actionDialogContent.appendChild(action.div);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionDialog);
        const actions = this.sortedActions();
        if (actions.length === 1) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.actionsNavigator);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.actionsNavigator);
        const idx = actions.indexOf(action);
        page.currentAction.textContent = String(idx + 1);
        page.prevAction.classList.toggle('invisible', idx === 0);
        page.nextAction.classList.toggle('invisible', idx === actions.length - 1);
    }
    /*
     * updateMarketElements sets the textContent for any ticker or asset name
     * elements or any asset logo src attributes for descendents of ancestor.
     */
    updateMarketElements(ancestor, baseID, quoteID, xc) {
        const getAsset = (assetID) => {
            const a = this.assets[assetID];
            if (a)
                return a;
            if (!xc)
                throw Error(`no asset found for asset ID ${assetID}`);
            const xcAsset = xc.assets[assetID];
            return { unitInfo: xcAsset.unitInfo, name: xcAsset.symbol, symbol: xcAsset.symbol };
        };
        const { unitInfo: bui, name: baseName, symbol: baseSymbol } = getAsset(baseID);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-base-name'))
            el.textContent = baseName;
        for (const img of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-base-logo]'))
            img.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(baseSymbol);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-base-ticker]'))
            el.textContent = bui.conventional.unit;
        const { unitInfo: qui, name: quoteName, symbol: quoteSymbol } = getAsset(quoteID);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-quote-name'))
            el.textContent = quoteName;
        for (const img of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-quote-logo]'))
            img.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(quoteSymbol);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(ancestor, '[data-quote-ticker]'))
            el.textContent = qui.conventional.unit;
    }
    setLanguage(lang) {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/setlocale', lang);
            window.location.reload();
        });
    }
    /*
     * showDropdown sets the position and visibility of the specified dropdown
     * dialog according to the position of its icon button.
     */
    showDropdown(icon, dialog) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noteBox, this.page.profileBox);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(dialog);
        if (window.innerWidth < 500)
            Object.assign(dialog.style, { left: '0', right: '0', top: '0' });
        else {
            const ico = icon.getBoundingClientRect();
            const right = `${window.innerWidth - ico.left - ico.width + 5}px`;
            Object.assign(dialog.style, { left: 'auto', right, top: `${ico.top - 4}px` });
        }
        const hide = (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, dialog)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(dialog);
                unbind(document, 'click', hide);
                if (dialog === this.page.noteBox && _doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.noteList)) {
                    this.ackNotes();
                }
            }
        };
        bind(document, 'click', hide);
    }
    ackNotes() {
        const acks = [];
        for (const note of this.notes) {
            if (note.acked) {
                note.el.classList.remove('firstview');
            }
            else {
                note.acked = true;
                if (note.id && note.severity > _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE)
                    acks.push(note.id);
            }
        }
        if (acks.length)
            _ws__WEBPACK_IMPORTED_MODULE_19__["default"].request('acknotes', acks);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noteIndicator);
    }
    setNoteTimes(noteList) {
        for (const el of Array.from(noteList.children)) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'span.note-time').textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(el.note.stamp);
        }
    }
    /*
     * bindInternalNavigation hijacks navigation by click on any local links that
     * are descendants of ancestor.
     */
    bindInternalNavigation(ancestor) {
        const pageURL = new URL(window.location.href);
        ancestor.querySelectorAll('a').forEach(a => {
            if (!a.href)
                return;
            const url = new URL(a.href);
            if (url.origin === pageURL.origin) {
                const token = url.pathname.substring(1);
                const params = {};
                if (url.search) {
                    url.searchParams.forEach((v, k) => {
                        params[k] = v;
                    });
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(a, 'click', (e) => {
                    e.preventDefault();
                    this.loadPage(token, params);
                });
            }
        });
    }
    /*
     * updateMenuItemsDisplay should be called when the user has signed in or out,
     * and when the user registers a DEX.
     */
    updateMenuItemsDisplay() {
        const { page, authed, mmStatus } = this;
        if (!page) {
            // initial page load, header elements not yet attached but menu items
            // would already be hidden/displayed as appropriate.
            return;
        }
        if (!authed) {
            page.profileBox.classList.remove('authed');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noteBell, page.walletsMenuEntry, page.marketsMenuEntry);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(Object.keys(this.exchanges).length > 0, page.marketsMenuEntry, page.mmLink);
        page.profileBox.classList.add('authed');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noteBell, page.walletsMenuEntry, page.marketsMenuEntry);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(mmStatus, page.mmLink);
    }
    fetchNotes() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.getJSON)('/api/notes');
            if (!this.checkResponse(res))
                return console.error('failed to fetch notes:', (res === null || res === void 0 ? void 0 : res.msg) || String(res));
            res.notes.reverse();
            this.setNotes(res.notes);
            this.setPokes(res.pokes);
            this.setRequiredActions();
        });
    }
    /* attachCommon scans the provided node and handles some common bindings. */
    attachCommon(node) {
        this.bindInternalNavigation(node);
    }
    /*
     * updateBondConfs updates the information for a pending bond.
     */
    updateBondConfs(dexAddr, coinID, confs) {
        const dex = this.exchanges[dexAddr];
        for (const bond of dex.auth.pendingBonds)
            if (bond.coinID === coinID)
                bond.confs = confs;
    }
    updateTier(host, bondedTier) {
        this.exchanges[host].auth.rep.bondedTier = bondedTier;
    }
    /*
     * handleBondNote is the handler for the 'bondpost'-type notification, which
     * is used to update the dex tier and registration status.
     */
    handleBondNote(note) {
        if (note.auth)
            this.exchanges[note.dex].auth = note.auth;
        switch (note.topic) {
            case 'RegUpdate':
                if (note.coinID !== null) { // should never be null for RegUpdate
                    this.updateBondConfs(note.dex, note.coinID, note.confirmations);
                }
                break;
            case 'BondConfirmed':
                if (note.tier !== null) { // should never be null for BondConfirmed
                    this.updateTier(note.dex, note.tier);
                }
                break;
            default:
                break;
        }
    }
    /*
     * handleTransaction either adds a new transaction to the transaction history
     * or updates an existing transaction.
     */
    handleTransactionNote(assetID, note) {
        const txHistory = this.txHistoryMap[assetID];
        if (!txHistory)
            return;
        if (note.new) {
            txHistory.txs.unshift(note.transaction);
            return;
        }
        for (let i = 0; i < txHistory.txs.length; i++) {
            if (txHistory.txs[i].id === note.transaction.id) {
                txHistory.txs[i] = note.transaction;
                break;
            }
        }
    }
    handleTxHistorySyncedNote(assetID) {
        delete this.txHistoryMap[assetID];
    }
    loggedIn(notes, pokes) {
        this.setNotes(notes);
        this.setPokes(pokes);
        this.setRequiredActions();
    }
    /*
     * setNotes sets the current notification cache and populates the notification
     * display.
     */
    setNotes(notes) {
        this.log('notes', 'setNotes', notes);
        this.notes = [];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.noteList);
        for (let i = 0; i < notes.length; i++) {
            this.prependNoteElement(notes[i]);
        }
    }
    /*
     * setPokes sets the current poke cache and populates the pokes display.
     */
    setPokes(pokes) {
        this.log('pokes', 'setPokes', pokes);
        this.pokes = [];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.pokeList);
        for (let i = 0; i < pokes.length; i++) {
            this.prependPokeElement(pokes[i]);
        }
    }
    botStatus(host, baseID, quoteID) {
        var _a, _b;
        for (const bot of ((_b = (_a = this.mmStatus) === null || _a === void 0 ? void 0 : _a.bots) !== null && _b !== void 0 ? _b : [])) {
            const { config: c } = bot;
            if (host === c.host && baseID === c.baseID && quoteID === c.quoteID) {
                return bot;
            }
        }
    }
    updateUser(note) {
        const { user, assets, walletMap } = this;
        if (note.type === 'fiatrateupdate') {
            this.fiatRatesMap = note.fiatRates;
            return;
        }
        // Some notes can be received before we get a User during login.
        if (!user)
            return;
        switch (note.type) {
            case 'order': {
                const orderNote = note;
                const order = orderNote.order;
                const mkt = user.exchanges[order.host].markets[order.market];
                const tempID = orderNote.tempID;
                // Ensure market's inflight orders list is updated.
                if (note.topic === 'AsyncOrderSubmitted') {
                    const inFlight = order;
                    inFlight.tempID = tempID;
                    if (!mkt.inflight)
                        mkt.inflight = [inFlight];
                    else
                        mkt.inflight.push(inFlight);
                    break;
                }
                else if (note.topic === 'AsyncOrderFailure') {
                    mkt.inflight = mkt.inflight.filter(ord => ord.tempID !== tempID);
                    break;
                }
                else {
                    for (const i in mkt.inflight || []) {
                        if (!(mkt.inflight[i].tempID === tempID))
                            continue;
                        mkt.inflight = mkt.inflight.filter(ord => ord.tempID !== tempID);
                        break;
                    }
                }
                // Updates given order in market's orders list if it finds it.
                // Returns a bool which indicates if order was found.
                mkt.orders = mkt.orders || [];
                const updateOrder = (mkt, ord) => {
                    const i = mkt.orders.findIndex((o) => o.id === ord.id);
                    if (i === -1)
                        return false;
                    if (note.topic === 'OrderRetired')
                        mkt.orders.splice(i, 1);
                    else
                        mkt.orders[i] = ord;
                    return true;
                };
                // If the notification order already exists we update it.
                // In case market's orders list is empty or the notification order isn't
                // part of it we add it manually as this means the order was
                // just placed.
                if (!updateOrder(mkt, order))
                    mkt.orders.push(order);
                break;
            }
            case 'balance': {
                const n = note;
                const asset = user.assets[n.assetID];
                // Balance updates can come before the user is fetched after login.
                if (!asset)
                    break;
                const w = asset.wallet;
                if (w)
                    w.balance = n.balance;
                break;
            }
            case 'bondpost':
                this.handleBondNote(note);
                break;
            case 'reputation': {
                const n = note;
                this.exchanges[n.host].auth.rep = n.rep;
                break;
            }
            case 'walletstate':
            case 'walletconfig': {
                // assets can be null if failed to connect to dex server.
                if (!assets)
                    return;
                const wallet = note === null || note === void 0 ? void 0 : note.wallet;
                if (!wallet)
                    return;
                const asset = assets[wallet.assetID];
                asset.wallet = wallet;
                walletMap[wallet.assetID] = wallet;
                break;
            }
            case 'walletsync': {
                const n = note;
                const w = this.walletMap[n.assetID];
                if (w) {
                    w.syncStatus = n.syncStatus;
                    w.synced = w.syncStatus.synced;
                    w.syncProgress = n.syncProgress;
                }
                break;
            }
            case 'match': {
                const n = note;
                const ord = this.order(n.orderID);
                if (ord)
                    updateMatch(ord, n.match);
                break;
            }
            case 'conn': {
                const n = note;
                const xc = user.exchanges[n.host];
                if (xc)
                    xc.connectionStatus = n.connectionStatus;
                break;
            }
            case 'spots': {
                const n = note;
                const xc = user.exchanges[n.host];
                // Spots can come before the user is fetched after login and before/while the
                // markets page reload when it receives a dex conn note.
                if (!xc || !xc.markets)
                    break;
                for (const [mktName, spot] of Object.entries(n.spots))
                    xc.markets[mktName].spot = spot;
                break;
            }
            case 'fiatrateupdate': {
                this.fiatRatesMap = note.fiatRates;
                break;
            }
            case 'actionrequired': {
                const n = note;
                this.addAction(n.payload);
                break;
            }
            case 'walletnote': {
                const n = note;
                switch (n.payload.route) {
                    case 'transaction': {
                        const txNote = n.payload;
                        this.handleTransactionNote(n.payload.assetID, txNote);
                        break;
                    }
                    case 'actionRequired': {
                        const req = n.payload;
                        this.addAction(req);
                        this.blinkAction();
                        break;
                    }
                    case 'actionResolved': {
                        this.resolveAction(n.payload);
                    }
                }
                if (n.payload.route === 'transactionHistorySynced') {
                    this.handleTxHistorySyncedNote(n.payload.assetID);
                }
                break;
            }
            case 'runstats': {
                this.log('mm', { runstats: note });
                const n = note;
                const bot = this.botStatus(n.host, n.baseID, n.quoteID);
                if (bot) {
                    bot.runStats = n.stats;
                    bot.running = Boolean(n.stats);
                }
                break;
            }
            case 'cexnote': {
                const n = note;
                switch (n.topic) {
                    case 'BalanceUpdate': {
                        const u = n.note;
                        this.mmStatus.cexes[n.cexName].balances[u.assetID] = u.balance;
                    }
                }
                break;
            }
        }
    }
    /*
     * notify is the top-level handler for notifications received from the client.
     * Notifications are propagated to the loadedPage.
     */
    notify(note) {
        // Handle type-specific updates.
        this.log('notes', 'notify', note);
        this.updateUser(note);
        // Inform the page.
        for (const feeder of this.noteReceivers) {
            const f = feeder[note.type];
            if (!f)
                continue;
            try {
                f(note);
            }
            catch (error) {
                console.error('note feeder error:', error.message ? error.message : error);
                console.log(note);
                console.log(error.stack);
            }
        }
        // Discard data notifications.
        if (note.severity < _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE)
            return;
        // Poke notifications have their own display.
        const { popupTmpl, popupNotes, showPopups } = this;
        if (showPopups) {
            const span = popupTmpl.cloneNode(true);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(span, 'text').textContent = `${note.subject}: ${_notifications__WEBPACK_IMPORTED_MODULE_18__.plainNote(note.details)}`;
            const indicator = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(span, 'indicator');
            if (note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(indicator);
            }
            else
                setSeverityClass(indicator, note.severity);
            popupNotes.appendChild(span);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(popupNotes);
            // These take up screen space. Only show max 5 at a time.
            while (popupNotes.children.length > 5)
                popupNotes.removeChild(popupNotes.firstChild);
            setTimeout(() => __awaiter(this, void 0, void 0, function* () {
                yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(500, (progress) => {
                    span.style.opacity = String(1 - progress);
                });
                span.remove();
                if (popupNotes.children.length === 0)
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(popupNotes);
            }), 6000);
        }
        // Success and higher severity go to the bell dropdown.
        if (note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE)
            this.prependPokeElement(note);
        else
            this.prependNoteElement(note);
        // show desktop notification
        _notifications__WEBPACK_IMPORTED_MODULE_18__.desktopNotify(note);
    }
    /*
     * registerNoteFeeder registers a feeder for core notifications. The feeder
     * will be de-registered when a new page is loaded.
     */
    registerNoteFeeder(receivers) {
        this.noteReceivers.push(receivers);
    }
    /*
     * log prints to the console if a logger has been enabled. Loggers are created
     * implicitly by passing a loggerID to log. i.e. you don't create a logger,
     * you just log to it. Loggers are enabled by invoking a global function,
     * enableLogger(loggerID, onOffBoolean), from the browser's js console. Your
     * choices are stored across sessions. Some common and useful loggers are
     * listed below, but this list is not meant to be comprehensive.
     *
     * LoggerID   Description
     * --------   -----------
     * notes      Notifications of all levels.
     * book       Order book feed.
     * ws.........Websocket connection status changes.
     */
    log(loggerID, ...msg) {
        if (this.loggers[loggerID])
            console.log(`${nowString()}[${loggerID}]:`, ...msg);
        if (this.recorders[loggerID]) {
            this.recorders[loggerID].push({
                time: nowString(),
                msg: msg
            });
        }
    }
    prependPokeElement(cn) {
        const [el, note] = this.makePoke(cn);
        this.pokes.push(note);
        while (this.pokes.length > noteCacheSize)
            this.pokes.shift();
        this.prependListElement(this.page.pokeList, note, el);
    }
    prependNoteElement(cn) {
        const [el, note] = this.makeNote(cn);
        this.notes.push(note);
        while (this.notes.length > noteCacheSize)
            this.notes.shift();
        const noteList = this.page.noteList;
        this.prependListElement(noteList, note, el);
        this.bindUrlHandlers(el);
        // Set the indicator color.
        if (this.notes.length === 0 || (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.noteBox) && _doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(noteList)))
            return;
        let unacked = 0;
        const severity = this.notes.reduce((s, note) => {
            if (!note.acked)
                unacked++;
            if (!note.acked && note.severity > s)
                return note.severity;
            return s;
        }, _notifications__WEBPACK_IMPORTED_MODULE_18__.IGNORE);
        const ni = this.page.noteIndicator;
        setSeverityClass(ni, severity);
        if (unacked) {
            ni.textContent = String((unacked > noteCacheSize - 1) ? `${noteCacheSize - 1}+` : unacked);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(ni);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(ni);
    }
    prependListElement(noteList, note, el) {
        el.note = note;
        noteList.prepend(el);
        while (noteList.children.length > noteCacheSize)
            noteList.removeChild(noteList.lastChild);
        this.setNoteTimes(noteList);
    }
    /*
     * makeNote constructs a single notification element for the drop-down
     * notification list.
     */
    makeNote(note) {
        const el = this.page.noteTmpl.cloneNode(true);
        if (note.severity > _notifications__WEBPACK_IMPORTED_MODULE_18__.POKE) {
            const cls = note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.SUCCESS ? 'good' : note.severity === _notifications__WEBPACK_IMPORTED_MODULE_18__.WARNING ? 'warn' : 'bad';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'div.note-indicator').classList.add(cls);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'div.note-subject').textContent = note.subject;
        _notifications__WEBPACK_IMPORTED_MODULE_18__.insertRichNote(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'div.note-details'), note.details);
        const np = Object.assign({ el }, note);
        return [el, np];
    }
    makePoke(note) {
        const el = this.page.pokeTmpl.cloneNode(true);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(el, 'subject').textContent = `${note.subject}:`;
        _notifications__WEBPACK_IMPORTED_MODULE_18__.insertRichNote(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(el, 'details'), note.details);
        const np = Object.assign({ el }, note);
        return [el, np];
    }
    /*
     * loading appends the loader to the specified element and displays the
     * loading icon. The loader will block all interaction with the specified
     * element until Application.loaded is called.
     */
    loading(el) {
        const loader = this.page.loader.cloneNode(true);
        el.appendChild(loader);
        return () => { loader.remove(); };
    }
    /* orders retrieves a list of orders for the specified dex and market
     * including inflight orders.
     */
    orders(host, mktID) {
        let orders = [];
        const mkt = this.user.exchanges[host].markets[mktID];
        if (mkt.orders)
            orders = orders.concat(mkt.orders);
        if (mkt.inflight)
            orders = orders.concat(mkt.inflight);
        return orders;
    }
    /*
     * haveActiveOrders returns whether or not there are active orders involving a
     * certain asset.
     */
    haveActiveOrders(assetID) {
        for (const xc of Object.values(this.user.exchanges)) {
            if (!xc.markets)
                continue;
            for (const market of Object.values(xc.markets)) {
                if (!market.orders)
                    continue;
                for (const ord of market.orders) {
                    if ((ord.baseID === assetID || ord.quoteID === assetID) &&
                        (ord.status < _orderutil__WEBPACK_IMPORTED_MODULE_16__.StatusExecuted || (0,_orderutil__WEBPACK_IMPORTED_MODULE_16__.hasActiveMatches)(ord)))
                        return true;
                }
            }
        }
        return false;
    }
    /* order attempts to locate an order by order ID. */
    order(oid) {
        for (const xc of Object.values(this.user.exchanges)) {
            if (!xc || !xc.markets)
                continue;
            for (const market of Object.values(xc.markets)) {
                if (!market.orders)
                    continue;
                for (const ord of market.orders) {
                    if (ord.id === oid)
                        return ord;
                }
            }
        }
        return null;
    }
    /*
     * canAccelerateOrder returns true if the "from" wallet of the order
     * supports acceleration, and if the order has unconfirmed swap
     * transactions.
     */
    canAccelerateOrder(order) {
        var _a;
        const walletTraitAccelerator = 1 << 4;
        let fromAssetID;
        if (order.sell)
            fromAssetID = order.baseID;
        else
            fromAssetID = order.quoteID;
        const wallet = this.walletMap[fromAssetID];
        if (!wallet || !(wallet.traits & walletTraitAccelerator))
            return false;
        if (order.matches) {
            for (let i = 0; i < ((_a = order.matches) === null || _a === void 0 ? void 0 : _a.length); i++) {
                const match = order.matches[i];
                if (match.swap && match.swap.confs && match.swap.confs.count === 0 && !match.revoked) {
                    return true;
                }
            }
        }
        return false;
    }
    /*
     * unitInfo fetches unit info [dex.UnitInfo] for the asset. If xc
     * [core.Exchange] is provided, and this is not a SupportedAsset, the UnitInfo
     * sent from the exchange's assets map [dex.Asset] will be used.
     */
    unitInfo(assetID, xc) {
        const supportedAsset = this.assets[assetID];
        if (supportedAsset)
            return supportedAsset.unitInfo;
        if (!xc || !xc.assets) {
            throw Error(_locales__WEBPACK_IMPORTED_MODULE_20__.prep(_locales__WEBPACK_IMPORTED_MODULE_20__.ID_UNSUPPORTED_ASSET_INFO_ERR_MSG, { assetID: `${assetID}` }));
        }
        return xc.assets[assetID].unitInfo;
    }
    parentAsset(assetID) {
        const asset = this.assets[assetID];
        if (!asset.token)
            return asset;
        return this.assets[asset.token.parentID];
    }
    /*
    * baseChainSymbol returns the symbol for the asset's parent if the asset is a
    * token, otherwise the symbol for the asset itself.
    */
    baseChainSymbol(assetID) {
        const asset = this.user.assets[assetID];
        return asset.token ? this.user.assets[asset.token.parentID].symbol : asset.symbol;
    }
    /*
     * extensionWallet returns the ExtensionConfiguredWallet for the asset, if
     * it exists.
     */
    extensionWallet(assetID) {
        var _a;
        return (_a = this.user.extensionModeConfig) === null || _a === void 0 ? void 0 : _a.restrictedWallets[this.baseChainSymbol(assetID)];
    }
    /* conventionalRate converts the encoded atomic rate to a conventional rate */
    conventionalRate(baseID, quoteID, encRate, xc) {
        const [b, q] = [this.unitInfo(baseID, xc), this.unitInfo(quoteID, xc)];
        const r = b.conventional.conversionFactor / q.conventional.conversionFactor;
        return encRate * r / _orderutil__WEBPACK_IMPORTED_MODULE_16__.RateEncodingFactor;
    }
    walletDefinition(assetID, walletType) {
        const asset = this.assets[assetID];
        if (asset.token)
            return asset.token.definition;
        if (!asset.info)
            throw Error('where\'s the wallet info?');
        if (walletType === '')
            return asset.info.availablewallets[asset.info.emptyidx];
        return asset.info.availablewallets.filter(def => def.type === walletType)[0];
    }
    currentWalletDefinition(assetID) {
        const asset = this.assets[assetID];
        if (asset.token) {
            return asset.token.definition;
        }
        return this.walletDefinition(assetID, this.assets[assetID].wallet.type);
    }
    /*
     * fetchBalance requests a balance update from the API. The API response does
     * include the balance, but we're ignoring it, since a balance update
     * notification is received via the Application anyways.
     */
    fetchBalance(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/balance', { assetID: assetID });
            if (!this.checkResponse(res)) {
                throw new Error(`failed to fetch balance for asset ID ${assetID}`);
            }
            return res.balance;
        });
    }
    /*
     * checkResponse checks the response object as returned from the functions in
     * the http module. If the response indicates that the request failed, it
     * returns false, otherwise, true.
     */
    checkResponse(resp) {
        return (resp.requestSuccessful && resp.ok);
    }
    /**
     * signOut call to /api/logout, if response with no errors occurred remove auth
     * and other privacy-critical cookies/locals and reload the page, otherwise
     * show a notification.
     */
    signOut() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/logout');
            if (!this.checkResponse(res)) {
                if (res.code === _http__WEBPACK_IMPORTED_MODULE_17__.Errors.activeOrdersErr) {
                    this.page.logoutErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_20__.prep(_locales__WEBPACK_IMPORTED_MODULE_20__.ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG);
                }
                else {
                    this.page.logoutErr.textContent = res.msg;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.logoutErr);
                return;
            }
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].removeCookie(_state__WEBPACK_IMPORTED_MODULE_1__["default"].authCK);
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].removeCookie(_state__WEBPACK_IMPORTED_MODULE_1__["default"].pwKeyCK);
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].removeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].notificationsLK); // Notification storage was DEPRECATED pre-v1.
            window.location.href = '/login';
        });
    }
    /*
     * txHistory loads the tx history for an asset. If the results are not
     * already cached, they are cached. If we have reached the oldest tx,
     * this fact is also cached. If the exact amount of transactions as have been
     * made are requested, we will not know if we have reached the last tx until
     * a subsequent call.
    */
    txHistory(assetID, n, after) {
        return __awaiter(this, void 0, void 0, function* () {
            const url = '/api/txhistory';
            const cachedTxHistory = this.txHistoryMap[assetID];
            if (!cachedTxHistory) {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)(url, {
                    n: n,
                    assetID: assetID
                });
                if (!this.checkResponse(res)) {
                    throw new Error(res.msg);
                }
                let txs = res.txs;
                if (!txs) {
                    txs = [];
                }
                this.txHistoryMap[assetID] = {
                    txs: txs,
                    lastTx: txs.length < n
                };
                return this.txHistoryMap[assetID];
            }
            const txs = [];
            let lastTx = false;
            const startIndex = after ? cachedTxHistory.txs.findIndex(tx => tx.id === after) + 1 : 0;
            if (after && startIndex === -1) {
                throw new Error('invalid after tx ' + after);
            }
            let lastIndex = startIndex;
            for (let i = startIndex; i < cachedTxHistory.txs.length && txs.length < n; i++) {
                txs.push(cachedTxHistory.txs[i]);
                lastIndex = i;
                after = cachedTxHistory.txs[i].id;
            }
            if (cachedTxHistory.lastTx && lastIndex === cachedTxHistory.txs.length - 1) {
                lastTx = true;
            }
            if (txs.length < n && !cachedTxHistory.lastTx) {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)(url, {
                    n: n - txs.length + 1,
                    assetID: assetID,
                    refID: after,
                    past: true
                });
                if (!this.checkResponse(res)) {
                    throw new Error(res.msg);
                }
                let resTxs = res.txs;
                if (!resTxs) {
                    resTxs = [];
                }
                if (resTxs.length > 0 && after) {
                    if (resTxs[0].id === after) {
                        resTxs.shift();
                    }
                    else {
                        // Implies a bug in the client
                        console.error('First tx history element != refID');
                    }
                }
                cachedTxHistory.lastTx = resTxs.length < n - txs.length;
                lastTx = cachedTxHistory.lastTx;
                txs.push(...resTxs);
                cachedTxHistory.txs.push(...resTxs);
            }
            return { txs, lastTx };
        });
    }
    getWalletTx(assetID, txID) {
        const cachedTxHistory = this.txHistoryMap[assetID];
        if (!cachedTxHistory)
            return undefined;
        return cachedTxHistory.txs.find(tx => tx.id === txID);
    }
    clearTxHistory(assetID) {
        delete this.txHistoryMap[assetID];
    }
    needsCustomProvider(assetID) {
        var _a, _b, _c;
        return __awaiter(this, void 0, void 0, function* () {
            const baseChainID = (_c = (_b = (_a = this.assets[assetID]) === null || _a === void 0 ? void 0 : _a.token) === null || _b === void 0 ? void 0 : _b.parentID) !== null && _c !== void 0 ? _c : assetID;
            if (!baseChainID)
                return false;
            const w = this.walletMap[baseChainID];
            if (!w)
                return false;
            const traitAccountLocker = 1 << 14;
            if ((w.traits & traitAccountLocker) === 0)
                return false;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_17__.postJSON)('/api/walletsettings', { assetID: baseChainID });
            if (!this.checkResponse(res)) {
                console.error(res.msg);
                return false;
            }
            const settings = res.map;
            return !settings.providers;
        });
    }
}
/* getSocketURI returns the websocket URI for the client. */
function getSocketURI() {
    const protocol = (window.location.protocol === 'https:') ? 'wss' : 'ws';
    return `${protocol}://${window.location.host}/ws`;
}
/*
 * severityClassMap maps a notification severity level to a CSS class that
 * assigns a background color.
 */
const severityClassMap = {
    [_notifications__WEBPACK_IMPORTED_MODULE_18__.SUCCESS]: 'good',
    [_notifications__WEBPACK_IMPORTED_MODULE_18__.ERROR]: 'bad',
    [_notifications__WEBPACK_IMPORTED_MODULE_18__.WARNING]: 'warn'
};
/* handlerFromPath parses the handler name from the path. */
function handlerFromPath(path) {
    return path.replace(/^\//, '').split('/')[0].split('?')[0].split('#')[0];
}
/* nowString creates a string formatted like HH:MM:SS.xxx */
function nowString() {
    const stamp = new Date();
    const h = stamp.getHours().toString().padStart(2, '0');
    const m = stamp.getMinutes().toString().padStart(2, '0');
    const s = stamp.getSeconds().toString().padStart(2, '0');
    const ms = stamp.getMilliseconds().toString().padStart(3, '0');
    return `${h}:${m}:${s}.${ms}`;
}
function setSeverityClass(el, severity) {
    el.classList.remove('bad', 'warn', 'good');
    el.classList.add(severityClassMap[severity]);
}
/* updateMatch updates the match in or adds the match to the order. */
function updateMatch(order, match) {
    for (const i in order.matches) {
        const m = order.matches[i];
        if (m.matchID === match.matchID) {
            order.matches[i] = match;
            return;
        }
    }
    order.matches = order.matches || [];
    order.matches.push(match);
}


/***/ }),

/***/ "./src/js/basepage.ts":
/*!****************************!*\
  !*** ./src/js/basepage.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ BasePage)
/* harmony export */ });
class BasePage {
    /* unload is called when the user navigates away from the page. */
    unload() {
        // should be implemented by inheriting class.
    }
}


/***/ }),

/***/ "./src/js/charts.ts":
/*!**************************!*\
  !*** ./src/js/charts.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CandleChart": () => (/* binding */ CandleChart),
/* harmony export */   "Chart": () => (/* binding */ Chart),
/* harmony export */   "DepthChart": () => (/* binding */ DepthChart),
/* harmony export */   "Extents": () => (/* binding */ Extents),
/* harmony export */   "Region": () => (/* binding */ Region),
/* harmony export */   "Wave": () => (/* binding */ Wave)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");




const bind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind;
const PIPI = 2 * Math.PI;
const plusChar = String.fromCharCode(59914);
const minusChar = String.fromCharCode(59915);
const darkTheme = {
    body: '#0b2031',
    axisLabel: '#b1b1b1',
    gridBorder: '#383f4b',
    gridLines: '#383f4b',
    gapLine: '#6b6b6b',
    value: '#9a9a9a',
    zoom: '#5b5b5b',
    zoomHover: '#aaa',
    sellLine: '#ae3333',
    buyLine: '#05a35a',
    sellFill: '#591a1a',
    buyFill: '#02572f',
    crosshairs: '#888',
    legendFill: 'black',
    legendText: '#d5d5d5'
};
const lightTheme = {
    body: '#f4f4f4',
    axisLabel: '#1b1b1b',
    gridBorder: '#ddd',
    gridLines: '#ddd',
    gapLine: '#595959',
    value: '#4d4d4d',
    zoom: '#777',
    zoomHover: '#333',
    sellLine: '#99302b',
    buyLine: '#207a46',
    sellFill: '#bd5959',
    buyFill: '#4cad75',
    crosshairs: '#595959',
    legendFill: '#e6e6e6',
    legendText: '#1b1b1b'
};
// Chart is the base class for charts.
class Chart {
    constructor(parent, reporters) {
        this.parent = parent;
        this.report = reporters;
        this.theme = _state__WEBPACK_IMPORTED_MODULE_2__["default"].isDark() ? darkTheme : lightTheme;
        this.canvas = document.createElement('canvas');
        this.visible = true;
        parent.appendChild(this.canvas);
        const ctx = this.canvas.getContext('2d');
        if (!ctx) {
            console.error('error getting canvas context');
            return;
        }
        this.ctx = ctx;
        this.ctx.textAlign = 'center';
        this.ctx.textBaseline = 'middle';
        // Mouse handling
        this.mousePos = null;
        bind(this.canvas, 'mousemove', (e) => {
            // this.rect will be set in resize().
            if (!this.rect)
                return;
            this.mousePos = {
                x: e.clientX - this.rect.left,
                y: e.clientY - this.rect.y
            };
            this.draw();
        });
        bind(this.canvas, 'mouseleave', () => {
            this.mousePos = null;
            this.draw();
        });
        // Bind resize.
        const resizeObserver = new ResizeObserver(() => this.resize());
        resizeObserver.observe(this.parent);
        // Scrolling by wheel is smoother when the rate is slightly limited.
        this.wheelLimiter = null;
        bind(this.canvas, 'wheel', (e) => { this.wheel(e); }, { passive: true });
        bind(this.canvas, 'click', (e) => { this.click(e); });
        const setVis = () => {
            this.visible = document.visibilityState !== 'hidden';
            if (this.visible && this.renderScheduled) {
                this.renderScheduled = false;
                this.draw();
            }
        };
        bind(document, 'visibilitychange', setVis);
        this.unattachers = [() => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'visibilitychange', setVis); }];
    }
    wheeled() {
        this.wheelLimiter = window.setTimeout(() => { this.wheelLimiter = null; }, 100);
    }
    /* clear the canvas. */
    clear() {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
    /* draw calls the child class's render method. */
    draw() {
        this.render();
    }
    /* click is the handler for a click event on the canvas. */
    click(e) {
        this.report.click(e);
    }
    /* wheel is a mousewheel event handler. */
    wheel(e) {
        this.zoom(e.deltaY < 0);
    }
    /*
     * resize updates the chart size. The parentHeight is an argument to support
     * updating the height programmatically after the caller sets a style.height
     * but before the clientHeight has been updated.
     */
    resize() {
        this.canvas.width = this.parent.clientWidth;
        this.canvas.height = this.parent.clientHeight;
        const xLblHeight = 30;
        const yGuess = 40; // y label width guess. Will be adjusted when drawn.
        const plotExtents = new Extents(0, this.canvas.width, 0, this.canvas.height - xLblHeight);
        const xLblExtents = new Extents(0, this.canvas.width, this.canvas.height - xLblHeight, this.canvas.height);
        const yLblExtents = new Extents(0, yGuess, 0, this.canvas.height - xLblHeight);
        this.plotRegion = new Region(this.ctx, plotExtents);
        this.xRegion = new Region(this.ctx, xLblExtents);
        this.yRegion = new Region(this.ctx, yLblExtents);
        // After changing the visibility, this.canvas.getBoundingClientRect will
        // return nonsense until a render.
        window.requestAnimationFrame(() => {
            this.rect = this.canvas.getBoundingClientRect();
            this.report.resize();
        });
    }
    /* zoom is called when the user scrolls the mouse wheel on the canvas. */
    zoom(bigger) {
        if (this.wheelLimiter)
            return;
        this.report.zoom(bigger);
    }
    /* The market handler will call unattach when the markets page is unloaded. */
    unattach() {
        for (const u of this.unattachers)
            u();
        this.unattachers = [];
    }
    /* render must be implemented by the child class. */
    render() {
        console.error('child class must override render method');
    }
    /* applyLabelStyle applies the style used for axis tick labels. */
    applyLabelStyle(fontSize) {
        this.ctx.textAlign = 'center';
        this.ctx.textBaseline = 'middle';
        this.ctx.font = `${fontSize !== null && fontSize !== void 0 ? fontSize : '14'}px 'sans', sans-serif`;
        this.ctx.fillStyle = this.theme.axisLabel;
    }
    /* plotXLabels applies the provided labels to the x axis and draws the grid. */
    plotXLabels(labels, minX, maxX, unitLines) {
        const extents = new Extents(minX, maxX, 0, 1);
        this.xRegion.plot(extents, (ctx, tools) => {
            this.applyLabelStyle();
            const centerX = (maxX + minX) / 2;
            let lastX = minX;
            let unitCenter = centerX;
            const [leftEdge, rightEdge] = [tools.x(minX), tools.x(maxX)];
            const centerY = tools.y(0.5);
            labels.lbls.forEach(lbl => {
                const m = ctx.measureText(lbl.txt);
                const x = tools.x(lbl.val);
                if (x - m.width / 2 < leftEdge || x + m.width / 2 > rightEdge)
                    return;
                ctx.fillText(lbl.txt, x, centerY);
                if (centerX >= lastX && centerX < lbl.val) {
                    unitCenter = (lastX + lbl.val) / 2;
                }
                lastX = lbl.val;
            });
            ctx.font = '11px \'sans\', sans-serif';
            if (unitLines.length === 2) {
                ctx.fillText(unitLines[0], tools.x(unitCenter), tools.y(0.63));
                ctx.fillText(unitLines[1], tools.x(unitCenter), tools.y(0.23));
            }
            else if (unitLines.length === 1) {
                ctx.fillText(unitLines[0], tools.x(unitCenter), centerY);
            }
        }, true);
    }
    plotXGrid(labels, minX, maxX) {
        const extents = new Extents(minX, maxX, 0, 1);
        this.plotRegion.plot(extents, (ctx, tools) => {
            ctx.lineWidth = 1;
            ctx.strokeStyle = this.theme.gridLines;
            labels.lbls.forEach(lbl => {
                line(ctx, tools.x(lbl.val), tools.y(0), tools.x(lbl.val), tools.y(1));
            });
        }, true);
    }
    /*
     * plotYLabels applies the y labels based on the provided plot region, and
     * draws the grid.
     */
    plotYLabels(labels, minY, maxY, unit) {
        const extents = new Extents(0, 1, minY, maxY);
        const fillRect = (ctx, x, y, w, h, r) => {
            ctx.save();
            ctx.fillStyle = this.theme.body;
            ctx.beginPath();
            if (ctx.roundRect)
                ctx.roundRect(x, y, w, h, r); // Safari < 16 doesn't support
            else
                ctx.rect(x, y, w, h);
            ctx.fill();
            ctx.restore();
        };
        this.yRegion.plot(extents, (ctx, tools) => {
            this.applyLabelStyle();
            this.ctx.textAlign = 'left';
            const centerY = maxY / 2;
            let lastY = 0;
            let unitCenter = centerY;
            const x = tools.x(0);
            const [xPad, yPad] = [3, 3];
            labels.lbls.forEach(lbl => {
                const y = tools.y(lbl.val);
                if (y < tools.y(maxY) + yPad + 7 || y > tools.y(minY) - yPad - 7)
                    return;
                const m = ctx.measureText(lbl.txt);
                fillRect(ctx, x, y - 7 - yPad, m.width + xPad * 2, 14 + yPad * 3, 3);
                ctx.fillText(lbl.txt, x + xPad, y + 2);
                if (centerY >= lastY && centerY < lbl.val) {
                    unitCenter = (lastY + lbl.val) / 2;
                }
                lastY = lbl.val;
            });
            const m = ctx.measureText(unit);
            const y = tools.y(unitCenter);
            fillRect(ctx, x, y - yPad - 7, m.width + xPad * 2, 14 + yPad * 2, 3);
            ctx.fillText(unit, x + xPad, tools.y(unitCenter));
        }, true);
    }
    plotYGrid(region, labels, minY, maxY) {
        const extents = new Extents(0, 1, minY, maxY);
        region.plot(extents, (ctx, tools) => {
            ctx.lineWidth = 1;
            ctx.strokeStyle = this.theme.gridLines;
            labels.lbls.forEach(lbl => {
                line(ctx, tools.x(0), tools.y(lbl.val), tools.x(1), tools.y(lbl.val));
            });
        }, true);
    }
    /*
     * doYLabels generates and applies the y-axis labels, based upon the
     * provided plot region.
     */
    makeYLabels(region, step, unit, valFmt) {
        this.applyLabelStyle();
        const yLabels = makeLabels(this.ctx, region.height(), this.dataExtents.y.min, this.dataExtents.y.max, 50, step, unit, valFmt);
        // Reassign the width of the y-label column to accommodate the widest text.
        const yAxisWidth = (yLabels.widest || 0) + 20; /* x padding */
        this.yRegion.extents.x.max = yAxisWidth;
        this.yRegion.extents.y.max = region.extents.y.max;
        return yLabels;
    }
    line(x0, y0, x1, y1, skipStroke) {
        line(this.ctx, x0, y0, x1, y1, skipStroke);
    }
    /* dot draws a circle with the provided context. */
    dot(x, y, color, radius) {
        dot(this.ctx, x, y, color, radius);
    }
}
/* DepthChart is a javascript Canvas-based depth chart renderer. */
class DepthChart extends Chart {
    constructor(parent, reporters, zoom) {
        super(parent, {
            resize: () => this.resized(),
            click: (e) => this.clicked(e),
            zoom: (bigger) => this.zoomed(bigger)
        });
        this.reporters = reporters;
        this.zoomLevel = zoom;
        this.lines = [];
        this.markers = {
            buys: [],
            sells: []
        };
        this.setZoomBttns(); // can't wait for requestAnimationFrame -> resized
        this.resize();
    }
    // setZoomBttns creates new regions for zoom in and zoom out buttons. It is
    // used in initiation of the buttons and resizing.
    setZoomBttns() {
        this.zoomInBttn = new Region(this.ctx, new Extents(0, 0, 0, 0));
        this.zoomOutBttn = new Region(this.ctx, new Extents(0, 0, 0, 0));
    }
    /* resized is called when the window or parent element are resized. */
    resized() {
        // The button region extents are set during drawing.
        this.setZoomBttns();
        if (this.book)
            this.draw();
    }
    /* zoomed zooms the current view in or out. bigger=true is zoom in. */
    zoomed(bigger) {
        if (!this.zoomLevel)
            return;
        if (!this.book.buys || !this.book.sells)
            return;
        this.wheeled();
        // Zoom in to 66%, but out to 150% = 1 / (2/3) so that the same zoom levels
        // are hit when reversing direction.
        this.zoomLevel *= bigger ? 2 / 3 : 3 / 2;
        this.zoomLevel = (0,_doc__WEBPACK_IMPORTED_MODULE_0__.clamp)(this.zoomLevel, 0.005, 2);
        this.draw();
        this.reporters.zoom(this.zoomLevel);
    }
    /* clicked is the canvas 'click' event handler. */
    clicked(e) {
        if (!this.dataExtents)
            return;
        const x = e.clientX - this.rect.left;
        const y = e.clientY - this.rect.y;
        if (this.zoomInBttn.contains(x, y)) {
            this.zoom(true);
            return;
        }
        if (this.zoomOutBttn.contains(x, y)) {
            this.zoom(false);
            return;
        }
        const translator = this.plotRegion.translator(this.dataExtents);
        this.reporters.click(translator.unx(x));
    }
    // set sets the current data set and draws.
    set(book, lotSize, rateStepEnc, baseUnitInfo, quoteUnitInfo) {
        this.book = book;
        this.lotSize = lotSize / baseUnitInfo.conventional.conversionFactor;
        this.conventionalRateStep = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].conventionalRateStep(rateStepEnc, baseUnitInfo, quoteUnitInfo);
        this.baseUnit = baseUnitInfo.conventional.unit;
        this.quoteUnit = quoteUnitInfo.conventional.unit;
        if (!this.zoomLevel) {
            const [midGap, gapWidth] = this.gap();
            // Default to 5% zoom, but with a minimum of 5 * midGap, but still observing
            // the hard cap of 200%.
            const minZoom = Math.max(gapWidth / midGap * 5, 0.05);
            this.zoomLevel = Math.min(minZoom, 2);
        }
        this.draw();
    }
    /*
     * render draws the chart.
     * 1. Calculate the data extents and translate the order book data to a
     *    cumulative form.
     * 2. Draw axis ticks and grid, mid-gap line and value, zoom buttons, mouse
     *    position indicator...
     * 4. Tick labels.
     * 5. Data.
     * 6. Epoch line legend.
     * 7. Hover legend.
     */
    render() {
        // if connection fails it is not possible to get book.
        if (!this.book || !this.visible || this.canvas.width === 0) {
            this.renderScheduled = true;
            return;
        }
        this.clear();
        // if (!this.book || this.book.empty()) return
        const ctx = this.ctx;
        const mousePos = this.mousePos;
        const buys = this.book.buys;
        const sells = this.book.sells;
        const [midGap, gapWidth] = this.gap();
        const halfWindow = this.zoomLevel * midGap / 2;
        const high = midGap + halfWindow;
        const low = midGap - halfWindow;
        // Get a sorted copy of the markers list.
        const buyMarkers = [...this.markers.buys];
        const sellMarkers = [...this.markers.sells];
        buyMarkers.sort((a, b) => b.rate - a.rate);
        sellMarkers.sort((a, b) => a.rate - b.rate);
        const markers = [];
        const buyDepth = [];
        const buyEpoch = [];
        const sellDepth = [];
        const sellEpoch = [];
        const volumeReport = {
            buyBase: 0,
            buyQuote: 0,
            sellBase: 0,
            sellQuote: 0
        };
        let sum = 0;
        // The epoch line is above the non-epoch region, so the epochSum y value
        // must account for non-epoch orders too.
        let epochSum = 0;
        for (let i = 0; i < buys.length; i++) {
            const ord = buys[i];
            epochSum += ord.qty;
            if (ord.rate >= low)
                buyEpoch.push([ord.rate, epochSum]);
            if (ord.epoch)
                continue;
            sum += ord.qty;
            buyDepth.push([ord.rate, sum]);
            volumeReport.buyBase += ord.qty;
            volumeReport.buyQuote += ord.qty * ord.rate;
            while (buyMarkers.length && floatCompare(buyMarkers[0].rate, ord.rate)) {
                const mark = buyMarkers.shift();
                if (!mark)
                    continue;
                markers.push({
                    rate: mark.rate,
                    qty: ord.epoch ? epochSum : sum,
                    sell: ord.sell,
                    active: mark.active
                });
            }
        }
        const buySum = buyDepth.length ? last(buyDepth)[1] : 0;
        buyDepth.push([low, buySum]);
        const epochBuySum = buyEpoch.length ? last(buyEpoch)[1] : 0;
        buyEpoch.push([low, epochBuySum]);
        epochSum = sum = 0;
        for (let i = 0; i < sells.length; i++) {
            const ord = sells[i];
            epochSum += ord.qty;
            if (ord.rate <= high)
                sellEpoch.push([ord.rate, epochSum]);
            if (ord.epoch)
                continue;
            sum += ord.qty;
            sellDepth.push([ord.rate, sum]);
            volumeReport.sellBase += ord.qty;
            volumeReport.sellQuote += ord.qty * ord.rate;
            while (sellMarkers.length && floatCompare(sellMarkers[0].rate, ord.rate)) {
                const mark = sellMarkers.shift();
                if (!mark)
                    continue;
                markers.push({
                    rate: mark.rate,
                    qty: ord.epoch ? epochSum : sum,
                    sell: ord.sell,
                    active: mark.active
                });
            }
        }
        // Add a data point going to the left so that the data doesn't end with a
        // vertical line.
        const sellSum = sellDepth.length ? last(sellDepth)[1] : 0;
        sellDepth.push([high, sellSum]);
        const epochSellSum = sellEpoch.length ? last(sellEpoch)[1] : 0;
        sellEpoch.push([high, epochSellSum]);
        // Add ~30px padding to the top of the chart.
        const h = this.xRegion.extents.y.min;
        const growthFactor = (h + 40) / h;
        const maxY = (epochSellSum && epochBuySum ? Math.max(epochBuySum, epochSellSum) : epochSellSum || epochBuySum || 1) * growthFactor;
        const dataExtents = new Extents(low, high, 0, maxY);
        this.dataExtents = dataExtents;
        // A function to be run at the end if there is legend data to display.
        let mouseData = null;
        // Draw the grid.
        const xLabels = makeLabels(ctx, this.plotRegion.width(), dataExtents.x.min, dataExtents.x.max, 100, this.conventionalRateStep, '');
        this.plotXGrid(xLabels, low, high);
        const yLabels = this.makeYLabels(this.plotRegion, this.lotSize, this.baseUnit);
        this.plotYGrid(this.plotRegion, yLabels, this.dataExtents.y.min, this.dataExtents.y.max);
        this.plotRegion.plot(dataExtents, (ctx, tools) => {
            ctx.lineWidth = 1;
            // first, a square around the plot area.
            ctx.strokeStyle = this.theme.gridBorder;
            // draw a line to indicate mid-gap
            ctx.lineWidth = 2.5;
            ctx.strokeStyle = this.theme.gapLine;
            line(ctx, tools.x(midGap), tools.y(0), tools.x(midGap), tools.y(0.3 * dataExtents.y.max));
            ctx.font = '30px \'demi-sans\', sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = this.theme.value;
            const y = 0.5 * dataExtents.y.max;
            ctx.fillText(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(midGap), tools.x(midGap), tools.y(y));
            ctx.font = '12px \'sans\', sans-serif';
            // ctx.fillText('mid-market price', tools.x(midGap), tools.y(y) + 24)
            ctx.fillText(`${(gapWidth / midGap * 100).toFixed(2)}% spread`, tools.x(midGap), tools.y(y) + 24);
            // Draw zoom buttons.
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            const topCenterX = this.plotRegion.extents.midX;
            const topCenterY = tools.y(maxY * 0.9);
            const zoomPct = dataExtents.xRange / midGap * 100;
            const zoomText = `${zoomPct.toFixed(1)}%`;
            const w = ctx.measureText(zoomText).width;
            ctx.font = '13px \'sans\', sans-serif';
            ctx.fillText(zoomText, topCenterX, topCenterY + 1);
            // define the region for the zoom button
            const bttnSize = 20;
            const xPad = 10;
            let bttnLeft = topCenterX - w / 2 - xPad - bttnSize;
            const bttnTop = topCenterY - bttnSize / 2;
            this.zoomOutBttn.setExtents(bttnLeft, bttnLeft + bttnSize, bttnTop, bttnTop + bttnSize);
            let hover = mousePos && this.zoomOutBttn.contains(mousePos.x, mousePos.y);
            this.zoomOutBttn.plot(new Extents(0, 1, 0, 1), ctx => {
                ctx.font = '12px \'icomoon\'';
                ctx.fillStyle = this.theme.zoom;
                if (hover) {
                    ctx.fillStyle = this.theme.zoomHover;
                    ctx.font = '13px \'icomoon\'';
                }
                ctx.fillText(minusChar, this.zoomOutBttn.extents.midX, this.zoomOutBttn.extents.midY);
            });
            bttnLeft = topCenterX + w / 2 + xPad;
            this.zoomInBttn.setExtents(bttnLeft, bttnLeft + bttnSize, bttnTop, bttnTop + bttnSize);
            hover = mousePos && this.zoomInBttn.contains(mousePos.x, mousePos.y);
            this.zoomInBttn.plot(new Extents(0, 1, 0, 1), ctx => {
                ctx.font = '12px \'icomoon\'';
                ctx.fillStyle = this.theme.zoom;
                if (hover) {
                    ctx.fillStyle = this.theme.zoomHover;
                    ctx.font = '14px \'icomoon\'';
                }
                ctx.fillText(plusChar, this.zoomInBttn.extents.midX, this.zoomInBttn.extents.midY);
            });
            // Draw a dotted vertical line where the mouse is, and a dot at the level
            // of the depth line.
            const drawLine = (x, color) => {
                if (x > high || x < low)
                    return;
                ctx.save();
                ctx.setLineDash([3, 5]);
                ctx.lineWidth = 1.5;
                ctx.strokeStyle = color;
                line(ctx, tools.x(x), tools.y(0), tools.x(x), tools.y(maxY));
                ctx.restore();
            };
            // for (const line of this.lines || []) {
            //   drawLine(line.rate, line.color)
            // }
            const tolerance = (high - low) * 0.005;
            const hoverMarkers = [];
            for (const marker of markers || []) {
                const hovered = (mousePos && withinTolerance(marker.rate, tools.unx(mousePos.x), tolerance));
                if (hovered)
                    hoverMarkers.push(marker.rate);
                ctx.save();
                ctx.lineWidth = (hovered || marker.active) ? 5 : 3;
                ctx.strokeStyle = marker.sell ? this.theme.sellLine : this.theme.buyLine;
                ctx.fillStyle = marker.sell ? this.theme.sellFill : this.theme.buyFill;
                const size = (hovered || marker.active) ? 10 : 8;
                ctx.beginPath();
                const tip = {
                    x: tools.x(marker.rate),
                    y: tools.y(marker.qty) - 8
                };
                const top = tip.y - (Math.sqrt(3) * size / 2); // cos(30)
                ctx.moveTo(tip.x, tip.y);
                ctx.lineTo(tip.x - size / 2, top);
                ctx.lineTo(tip.x + size / 2, top);
                ctx.closePath();
                ctx.stroke();
                ctx.fill();
                ctx.restore();
            }
            // If the mouse is in the chart area, draw the crosshairs.
            if (!mousePos)
                return;
            if (!this.plotRegion.contains(mousePos.x, mousePos.y))
                return;
            // The mouse is in the plot region. Get the data coordinates and find the
            // side and depth for the x value.
            const dataX = tools.unx(mousePos.x);
            let evalSide = sellDepth;
            let trigger = (ptX) => ptX >= dataX;
            let dotColor = this.theme.sellLine;
            if (dataX < midGap) {
                evalSide = buyDepth;
                trigger = (ptX) => ptX <= dataX;
                dotColor = this.theme.buyLine;
            }
            let bestDepth = evalSide[0];
            for (let i = 0; i < evalSide.length; i++) {
                const pt = evalSide[i];
                if (trigger(pt[0]))
                    break;
                bestDepth = pt;
            }
            drawLine(dataX, this.theme.crosshairs);
            mouseData = {
                rate: dataX,
                depth: bestDepth[1],
                dotColor: dotColor,
                hoverMarkers: hoverMarkers
            };
        });
        // Draw the epoch lines
        ctx.lineWidth = 1.5;
        ctx.setLineDash([3, 3]);
        // epoch sells
        ctx.fillStyle = this.theme.sellFill;
        ctx.strokeStyle = this.theme.sellLine;
        this.drawDepth(sellEpoch);
        // epoch buys
        ctx.fillStyle = this.theme.buyFill;
        ctx.strokeStyle = this.theme.buyLine;
        this.drawDepth(buyEpoch);
        // Draw the book depth.
        ctx.lineWidth = 2.5;
        ctx.setLineDash([]);
        // book sells
        ctx.fillStyle = this.theme.sellFill;
        ctx.strokeStyle = this.theme.sellLine;
        this.drawDepth(sellDepth);
        // book buys
        ctx.fillStyle = this.theme.buyFill;
        ctx.strokeStyle = this.theme.buyLine;
        this.drawDepth(buyDepth);
        this.plotYLabels(yLabels, this.dataExtents.y.min, this.dataExtents.y.max, this.baseUnit);
        this.plotXLabels(xLabels, low, high, [`${this.quoteUnit}/`, this.baseUnit]);
        // Display the dot at the intersection of the mouse hover line and the depth
        // line. This should be drawn after the depths.
        if (mouseData) {
            this.plotRegion.plot(dataExtents, (ctx, tools) => {
                if (!mouseData)
                    return; // For TypeScript. Duh.
                dot(ctx, tools.x(mouseData.rate), tools.y(mouseData.depth), mouseData.dotColor, 5);
            });
        }
        // Report the book volumes.
        this.reporters.volume(volumeReport);
        this.reporters.mouse(mouseData);
    }
    /* drawDepth draws a single side's depth chart data. */
    drawDepth(depth) {
        const firstPt = depth[0];
        let x;
        this.plotRegion.plot(this.dataExtents, (ctx, tools) => {
            const yZero = tools.y(0);
            let y = tools.y(firstPt[1]);
            ctx.beginPath();
            ctx.moveTo(tools.x(firstPt[0]), tools.y(firstPt[1]));
            for (let i = 0; i < depth.length; i++) {
                // Set x, but don't set y until we draw the horizontal line.
                x = tools.x(depth[i][0]);
                ctx.lineTo(x, y);
                // If this is past the render edge, quit drawing.
                y = tools.y(depth[i][1]);
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            ctx.lineTo(x, yZero);
            ctx.lineTo(tools.x(firstPt[0]), yZero);
            ctx.closePath();
            ctx.globalAlpha = 0.25;
            ctx.fill();
        });
    }
    /* returns the mid-gap rate and gap width as a tuple. */
    gap() {
        const [b, s] = [this.book.bestGapBuy(), this.book.bestGapSell()];
        if (!b) {
            if (!s)
                return [1, 0];
            return [s.rate, 0];
        }
        else if (!s)
            return [b.rate, 0];
        return [(s.rate + b.rate) / 2, s.rate - b.rate];
    }
    /* setLines stores the indicator lines to draw. */
    setLines(lines) {
        this.lines = lines;
    }
    /* setMarkers sets the indicator markers to draw. */
    setMarkers(markers) {
        this.markers = markers;
    }
}
/* CandleChart is a candlestick data renderer. */
class CandleChart extends Chart {
    constructor(parent, reporters) {
        super(parent, {
            resize: () => this.resized(),
            click: ( /* e: MouseEvent */) => { this.clicked(); },
            zoom: (bigger) => this.zoomed(bigger)
        });
        this.reporters = reporters;
        this.zoomLevel = 1;
        this.numToShow = 100;
        this.resize();
    }
    /* resized is called when the window or parent element are resized. */
    resized() {
        const ext = this.plotRegion.extents;
        const candleExtents = new Extents(ext.x.min, ext.x.max, ext.y.min, ext.y.min + ext.yRange * 0.85);
        this.candleRegion = new Region(this.ctx, candleExtents);
        const volumeExtents = new Extents(ext.x.min, ext.x.max, ext.y.min + 0.85 * ext.yRange, ext.y.max);
        this.volumeRegion = new Region(this.ctx, volumeExtents);
        // Set a delay on the render to prevent lag.
        if (this.resizeTimer)
            clearTimeout(this.resizeTimer);
        this.resizeTimer = window.setTimeout(() => this.draw(), 100);
    }
    clicked( /* e: MouseEvent */) {
        // handle clicks
    }
    /* zoomed zooms the current view in or out. bigger=true is zoom in. */
    zoomed(bigger) {
        // bigger actually means fewer candles -> reduce zoomLevels index.
        const idx = this.zoomLevels.indexOf(this.numToShow);
        if (bigger) {
            if (idx === 0)
                return;
            this.numToShow = this.zoomLevels[idx - 1];
        }
        else {
            if (this.zoomLevels.length <= idx + 1 || this.numToShow > this.data.candles.length)
                return;
            this.numToShow = this.zoomLevels[idx + 1];
        }
        this.draw();
    }
    /* render draws the chart */
    render() {
        var _a;
        const data = this.data;
        if (!data || !this.visible || this.canvas.width === 0) {
            this.renderScheduled = true;
            return;
        }
        const candleWidth = data.ms;
        const mousePos = this.mousePos;
        const allCandles = data.candles || [];
        const n = Math.min(this.numToShow, allCandles.length);
        const candles = allCandles.slice(allCandles.length - n);
        this.clear();
        // If there are no candles. just don't draw anything.
        if (n === 0)
            return;
        // padding definition and some helper functions to parse candles.
        const candleWidthPadding = 0.2;
        const start = (c) => truncate(c.endStamp, candleWidth);
        const end = (c) => start(c) + candleWidth;
        const paddedStart = (c) => start(c) + candleWidthPadding * candleWidth;
        const paddedWidth = (1 - 2 * candleWidthPadding) * candleWidth;
        const first = candles[0];
        const last = candles[n - 1];
        let [high, low, highVol] = [first.highRate, first.lowRate, first.matchVolume];
        for (const c of candles) {
            if (c.highRate > high)
                high = c.highRate;
            if (c.lowRate < low)
                low = c.lowRate;
            if (c.matchVolume > highVol)
                highVol = c.matchVolume;
        }
        high += (high - low) * 0.1; // a little padding
        const xStart = start(first);
        let xEnd = end(last);
        xEnd += (xEnd - xStart) * 0.05; // a little padding
        // Calculate data extents and store them. They are used to apply labels.
        const rateStep = this.market.ratestep;
        const dataExtents = new Extents(xStart, xEnd, low, high);
        if (low === high) {
            // If there is no price movement at all in the window, show a little more
            // top and bottom so things render nicely.
            dataExtents.y.min -= rateStep;
            dataExtents.y.max += rateStep;
        }
        this.dataExtents = dataExtents;
        let mouseCandle = null;
        if (mousePos) {
            this.plotRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, 0, 1), (ctx, tools) => {
                const selectedStartStamp = truncate(tools.unx(mousePos.x), candleWidth);
                for (const c of candles) {
                    if (start(c) === selectedStartStamp) {
                        mouseCandle = c;
                        ctx.fillStyle = this.theme.gridLines;
                        ctx.fillRect(tools.x(start(c)), tools.y(0), tools.w(candleWidth), tools.h(1));
                        break;
                    }
                }
            });
        }
        // Draw the grid
        const rFactor = this.rateConversionFactor;
        const baseUnit = ((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_3__.app)().assets[this.market.baseid]) === null || _a === void 0 ? void 0 : _a.unitInfo.conventional.unit) || this.market.basesymbol.toUpperCase();
        const xLabels = makeCandleTimeLabels(candles, candleWidth, this.plotRegion.width(), 100);
        this.plotXGrid(xLabels, xStart, xEnd);
        const yLabels = this.makeYLabels(this.candleRegion, rateStep, baseUnit, v => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(v / rFactor));
        this.plotYGrid(this.candleRegion, yLabels, this.dataExtents.y.min, this.dataExtents.y.max);
        // Draw the volume bars.
        const volDataExtents = new Extents(xStart, xEnd, 0, highVol);
        this.volumeRegion.plot(volDataExtents, (ctx, tools) => {
            ctx.fillStyle = this.theme.gridBorder;
            for (const c of candles) {
                ctx.fillRect(tools.x(paddedStart(c)), tools.y(0), tools.w(paddedWidth), tools.h(c.matchVolume));
            }
        });
        // Draw the candles.
        this.candleRegion.plot(dataExtents, (ctx, tools) => {
            ctx.lineWidth = 1;
            for (const c of candles) {
                const desc = c.startRate > c.endRate;
                const [x, y, w, h] = [tools.x(paddedStart(c)), tools.y(c.startRate), tools.w(paddedWidth), tools.h(c.endRate - c.startRate)];
                const [high, low, cx] = [tools.y(c.highRate), tools.y(c.lowRate), w / 2 + x];
                ctx.strokeStyle = desc ? this.theme.sellLine : this.theme.buyLine;
                ctx.fillStyle = desc ? this.theme.sellFill : this.theme.buyFill;
                ctx.beginPath();
                ctx.moveTo(cx, high);
                ctx.lineTo(cx, low);
                ctx.stroke();
                ctx.fillRect(x, y, w, h);
                ctx.strokeRect(x, y, w, h);
            }
        });
        // Apply labels.
        this.plotXLabels(xLabels, xStart, xEnd, []);
        this.plotYLabels(yLabels, this.dataExtents.y.min, this.dataExtents.y.max, baseUnit);
        // Highlight the candle if the user mouse is over the canvas.
        if (mouseCandle) {
            const yExt = this.xRegion.extents.y;
            this.xRegion.plot(new Extents(dataExtents.x.min, dataExtents.x.max, yExt.min, yExt.max), (ctx, tools) => {
                if (!mouseCandle)
                    return; // For TypeScript. Duh.
                this.applyLabelStyle();
                const rangeTxt = `${new Date(start(mouseCandle)).toLocaleString()} - ${new Date(end(mouseCandle)).toLocaleString()}`;
                const [xPad, yPad] = [25, 2];
                const rangeWidth = ctx.measureText(rangeTxt).width + 2 * xPad;
                const rangeHeight = 16;
                let centerX = tools.x((start(mouseCandle) + end(mouseCandle)) / 2);
                let left = centerX - rangeWidth / 2;
                const xExt = this.xRegion.extents.x;
                if (left < xExt.min)
                    left = xExt.min;
                else if (left + rangeWidth > xExt.max)
                    left = xExt.max - rangeWidth;
                centerX = left + rangeWidth / 2;
                const top = yExt.min + (this.xRegion.height() - rangeHeight) / 2;
                ctx.fillStyle = this.theme.legendFill;
                ctx.strokeStyle = this.theme.gridBorder;
                const rectArgs = [left - xPad, top - yPad, rangeWidth + 2 * xPad, rangeHeight + 2 * yPad];
                ctx.fillRect(...rectArgs);
                ctx.strokeRect(...rectArgs);
                this.applyLabelStyle();
                ctx.fillText(rangeTxt, centerX, this.xRegion.extents.midY, rangeWidth);
            });
        }
        // Report the mouse candle.
        this.reporters.mouse(mouseCandle);
    }
    /* setCandles sets the candle data and redraws the chart. */
    setCandles(data, market, baseUnitInfo, quoteUnitInfo) {
        this.data = data;
        if (!data.candles)
            return;
        this.market = market;
        const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor];
        this.rateConversionFactor = _orderutil__WEBPACK_IMPORTED_MODULE_1__.RateEncodingFactor * qFactor / bFactor;
        let n = 25;
        this.zoomLevels = [];
        const maxCandles = Math.max(data.candles.length, 1000);
        while (n < maxCandles) {
            this.zoomLevels.push(n);
            n *= 2;
        }
        this.numToShow = 100;
        this.draw();
    }
}
/* Wave is a loading animation that displays a colorful line that oscillates */
class Wave extends Chart {
    constructor(parent, opts) {
        super(parent, {
            resize: () => this.resized(),
            click: ( /* e: MouseEvent */) => { },
            zoom: ( /* bigger: boolean */) => { }
        });
        this.canvas.classList.add('fill-abs');
        this.canvas.style.zIndex = '5';
        this.opts = opts !== null && opts !== void 0 ? opts : {};
        const period = 1500; // ms
        const start = Math.random() * period;
        this.colorShift = Math.random() * 360;
        // y = A*cos(k*x + theta*t + c)
        // combine three waves with different periods and speeds and phases.
        const amplitudes = [1, 0.65, 0.75];
        const ks = [3, 3, 2];
        const speeds = [Math.PI, Math.PI * 10 / 9, Math.PI / 2.5];
        const phases = [0, 0, Math.PI * 1.5];
        const n = 75;
        const single = (n, angularX, angularTime) => {
            return amplitudes[n] * Math.cos(ks[n] * angularX + speeds[n] * angularTime + phases[n]);
        };
        const value = (x, angularTime) => {
            const angularX = x * Math.PI * 2;
            return (single(0, angularX, angularTime) + single(1, angularX, angularTime) + single(2, angularX, angularTime)) / 3;
        };
        this.resize();
        this.ani = new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(_doc__WEBPACK_IMPORTED_MODULE_0__.Animation.Forever, () => {
            const angularTime = (new Date().getTime() - start) / period * Math.PI * 2;
            const values = [];
            for (let i = 0; i < n; i++) {
                values.push(value(i / (n - 1), angularTime));
            }
            this.drawValues(values);
        });
    }
    resized() {
        const opts = this.opts;
        const [maxW, maxH] = [150, 100];
        const [cw, ch] = [this.canvas.width, this.canvas.height];
        let [w, h] = [cw * 0.8, ch * 0.8];
        if (w > maxW)
            w = maxW;
        if (h > maxH)
            h = maxH;
        let [l, t] = [(cw - w) / 2, (ch - h) / 2];
        if (opts.message) {
            this.fontSize = (0,_doc__WEBPACK_IMPORTED_MODULE_0__.clamp)(h * 0.15, 10, 14);
            this.applyLabelStyle(this.fontSize);
            const ypad = this.fontSize * 0.5;
            const halfH = (this.fontSize / 2) + ypad;
            t -= halfH;
            this.msgRegion = new Region(this.ctx, new Extents(0, cw, t + h, t + h + 2 * halfH));
        }
        this.region = new Region(this.ctx, new Extents(l, l + w, t, t + h));
    }
    drawValues(values) {
        if (!this.region)
            return;
        this.clear();
        const hsl = (h) => `hsl(${h}, 35%, 50%)`;
        const { region, msgRegion, canvas: { width: w, height: h }, opts: { backgroundColor: bg, message: msg }, colorShift, ctx } = this;
        if (bg) {
            if (bg === true)
                ctx.fillStyle = _state__WEBPACK_IMPORTED_MODULE_2__["default"].isDark() ? '#0a1e34' : '#f0f0f0';
            else
                ctx.fillStyle = bg;
            ctx.fillRect(0, 0, w, h);
        }
        region.plot(new Extents(0, 1, -1, 1), (ctx, t) => {
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            const shift = colorShift + (new Date().getTime() % 2000) / 2000 * 360; // colors move with frequency 1 / 2s
            const grad = ctx.createLinearGradient(t.x(0), 0, t.x(1), 0);
            grad.addColorStop(0, hsl(shift));
            ctx.strokeStyle = grad;
            ctx.beginPath();
            ctx.moveTo(t.x(0), t.y(values[0]));
            for (let i = 1; i < values.length; i++) {
                const prog = i / (values.length - 1);
                grad.addColorStop(prog, hsl(prog * 300 + shift));
                ctx.lineTo(t.x(prog), t.y(values[i]));
            }
            ctx.stroke();
        });
        if (!msg)
            return;
        msgRegion.plot(new Extents(0, 1, 0, 1), (ctx, t) => {
            this.applyLabelStyle(this.fontSize);
            ctx.fillText(msg, t.x(0.5), t.y(0.5), this.msgRegion.width());
        });
    }
    render() { }
    stop() {
        this.ani.stop();
        this.canvas.remove();
    }
}
/*
 * Extents holds a min and max in both the x and y directions, and provides
 * getters for related data.
 */
class Extents {
    constructor(xMin, xMax, yMin, yMax) {
        this.setExtents(xMin, xMax, yMin, yMax);
    }
    setExtents(xMin, xMax, yMin, yMax) {
        this.x = {
            min: xMin,
            max: xMax
        };
        this.y = {
            min: yMin,
            max: yMax
        };
    }
    get xRange() {
        return this.x.max - this.x.min;
    }
    get midX() {
        return (this.x.max + this.x.min) / 2;
    }
    get yRange() {
        return this.y.max - this.y.min;
    }
    get midY() {
        return (this.y.max + this.y.min) / 2;
    }
}
/*
 * Region applies an Extents to the canvas, providing utilities for coordinate
 * transformations and restricting drawing to a specified region of the canvas.
 */
class Region {
    constructor(context, extents) {
        this.context = context;
        this.extents = extents;
    }
    setExtents(xMin, xMax, yMin, yMax) {
        this.extents.setExtents(xMin, xMax, yMin, yMax);
    }
    width() {
        return this.extents.xRange;
    }
    height() {
        return this.extents.yRange;
    }
    contains(x, y) {
        const ext = this.extents;
        return (x < ext.x.max && x > ext.x.min &&
            y < ext.y.max && y > ext.y.min);
    }
    /*
     * A translator provides 4 function for coordinate transformations. x and y
     * translate data coordinates to canvas coordinates for the specified data
     * Extents. unx and uny translate canvas coordinates to data coordinates.
     */
    translator(dataExtents) {
        const region = this.extents;
        const xMin = dataExtents.x.min;
        // const xMax = dataExtents.x.max
        const yMin = dataExtents.y.min;
        // const yMax = dataExtents.y.max
        const yRange = dataExtents.yRange;
        const xRange = dataExtents.xRange;
        const screenMinX = region.x.min;
        const screenW = region.x.max - screenMinX;
        const screenMaxY = region.y.max;
        const screenH = screenMaxY - region.y.min;
        const xFactor = screenW / xRange;
        const yFactor = screenH / yRange;
        return {
            x: (x) => (x - xMin) * xFactor + screenMinX,
            y: (y) => screenMaxY - (y - yMin) * yFactor,
            unx: (x) => (x - screenMinX) / xFactor + xMin,
            uny: (y) => yMin - (y - screenMaxY) / yFactor,
            w: (w) => w / xRange * screenW,
            h: (h) => -h / yRange * screenH
        };
    }
    /* clear clears the region. */
    clear() {
        const ext = this.extents;
        this.context.clearRect(ext.x.min, ext.y.min, ext.xRange, ext.yRange);
    }
    /* plot prepares tools for drawing using data coordinates. */
    plot(dataExtents, drawFunc, skipMask) {
        const ctx = this.context;
        const region = this.extents;
        ctx.save(); // Save the original state
        if (!skipMask) {
            ctx.beginPath();
            ctx.rect(region.x.min, region.y.min, region.xRange, region.yRange);
            ctx.clip();
        }
        // The drawFunc will be passed a set of tool that can be used to assist
        // drawing. The tools start with the transformation functions.
        const tools = this.translator(dataExtents);
        // Create a transformation that allows drawing in data coordinates. It's
        // not advisable to stroke or add text with this transform in place, as the
        // result will be distorted. You can however use ctx.moveTo and ctx.lineTo
        // with this transform in place using data coordinates, and remove the
        // transform before stroking. The dataCoords method of the supplied tool
        // provides this functionality.
        // TODO: Figure out why this doesn't work on WebView.
        // const yRange = dataExtents.yRange
        // const xFactor = region.xRange / dataExtents.xRange
        // const yFactor = region.yRange / yRange
        // const xMin = dataExtents.x.min
        // const yMin = dataExtents.y.min
        // // These translation factors are complicated because the (0, 0) of the
        // // region is not necessarily the (0, 0) of the canvas.
        // const tx = (region.x.min + xMin) - xMin * xFactor
        // const ty = -region.y.min - (yRange - yMin) * yFactor
        // const setTransform = () => {
        //   // Data coordinates are flipped about y. Flip the coordinates and
        //   // translate top left corner to canvas (0, 0).
        //   ctx.transform(1, 0, 0, -1, -xMin, yMin)
        //   // Scale to data coordinates and shift into place for the region's offset
        //   // on the canvas.
        //   ctx.transform(xFactor, 0, 0, yFactor, tx, ty)
        // }
        // // dataCoords allows some drawing to be performed directly in data
        // // coordinates. Most actual drawing functions like ctx.stroke and
        // // ctx.fillRect should not be called from inside dataCoords, but
        // // ctx.moveTo and ctx.LineTo are fine.
        // tools.dataCoords = f => {
        //   ctx.save()
        //   setTransform()
        //   f()
        //   ctx.restore()
        // }
        drawFunc(this.context, tools);
        ctx.restore();
    }
}
/*
 * makeLabels attempts to create the appropriate labels for the specified
 * screen size, context, and label spacing.
 */
function makeLabels(ctx, screenW, min, max, spacingGuess, step, unit, valFmt) {
    valFmt = valFmt || _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs;
    const n = screenW / spacingGuess;
    const diff = max - min;
    if (n < 1 || diff <= 0)
        return { lbls: [] };
    const tickGuess = diff / n;
    // make the tick spacing a multiple of the step
    const tick = tickGuess + step - (tickGuess % step);
    let x = min + tick - (min % tick);
    const absMax = Math.max(Math.abs(max), Math.abs(min));
    // The Math.round part is the minimum precision required to see the change in the numbers.
    // The 2 accounts for the precision of the tick.
    const sigFigs = Math.round(Math.log10(absMax / tick)) + 2;
    const pts = [];
    let widest = 0;
    while (x < max) {
        x = Number(x.toPrecision(sigFigs));
        const lbl = valFmt(x);
        widest = Math.max(widest, ctx.measureText(lbl).width);
        pts.push({
            val: x,
            txt: lbl
        });
        x += tick;
    }
    const unitW = ctx.measureText(unit).width;
    if (unitW > widest)
        widest = unitW;
    return {
        widest: widest,
        lbls: pts
    };
}
const months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec'];
/* makeCandleTimeLabels prepares labels for candlestick data. */
function makeCandleTimeLabels(candles, dur, screenW, spacingGuess) {
    const first = candles[0];
    const last = candles[candles.length - 1];
    const start = truncate(first.endStamp, dur);
    const end = truncate(last.endStamp, dur) + dur;
    const diff = end - start;
    const n = Math.min(candles.length, screenW / spacingGuess);
    const tick = truncate(diff / n, dur);
    if (tick === 0) {
        console.error('zero tick', dur, diff, n); // probably won't happen, but it'd suck if it did
        return { lbls: [] };
    }
    let x = start;
    const zoneOffset = new Date().getTimezoneOffset();
    const dayStamp = (x) => {
        x = x - zoneOffset * 60000;
        return x - (x % 86400000);
    };
    let lastDay = dayStamp(start);
    let lastYear = 0; // new Date(start).getFullYear()
    if (dayStamp(first.endStamp) === dayStamp(last.endStamp))
        lastDay = 0; // Force at least one day stamp.
    const pts = [];
    let label;
    if (dur < 86400000) {
        label = (d, x) => {
            const day = dayStamp(x);
            if (day !== lastDay)
                return `${months[d.getMonth()]}${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`;
            else
                return `${d.getHours()}:${String(d.getMinutes()).padStart(2, '0')}`;
        };
    }
    else {
        label = (d) => {
            const year = d.getFullYear();
            if (year !== lastYear)
                return `${months[d.getMonth()]}${d.getDate()} '${String(year).slice(2, 4)}`;
            else
                return `${months[d.getMonth()]}${d.getDate()}`;
        };
    }
    while (x <= end) {
        const d = new Date(x);
        pts.push({
            val: x,
            txt: label(d, x)
        });
        lastDay = dayStamp(x);
        lastYear = d.getFullYear();
        x += tick;
    }
    return { lbls: pts };
}
/* The last element of an array. */
function last(arr) {
    return arr[arr.length - 1];
}
/* line draws a line with the provided context. */
function line(ctx, x0, y0, x1, y1, skipStroke) {
    ctx.beginPath();
    ctx.moveTo(x0, y0);
    ctx.lineTo(x1, y1);
    if (!skipStroke)
        ctx.stroke();
}
/* dot draws a circle with the provided context. */
function dot(ctx, x, y, color, radius) {
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, PIPI);
    ctx.fill();
}
/* floatCompare compares two floats to within a tolerance of  1e-8. */
function floatCompare(a, b) {
    return withinTolerance(a, b, 1e-8);
}
/*
 * withinTolerance returns true if the difference between a and b are with
 * the specified tolerance.
 */
function withinTolerance(a, b, tolerance) {
    return Math.abs(a - b) < Math.abs(tolerance);
}
function truncate(v, w) {
    return v - (v % w);
}


/***/ }),

/***/ "./src/js/coinexplorers.ts":
/*!*********************************!*\
  !*** ./src/js/coinexplorers.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CoinExplorers": () => (/* binding */ CoinExplorers),
/* harmony export */   "Mainnet": () => (/* binding */ Mainnet),
/* harmony export */   "Simnet": () => (/* binding */ Simnet),
/* harmony export */   "Testnet": () => (/* binding */ Testnet),
/* harmony export */   "formatCoinID": () => (/* binding */ formatCoinID),
/* harmony export */   "setCoinHref": () => (/* binding */ setCoinHref)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");


const Mainnet = 0;
const Testnet = 1;
const Simnet = 2;
const coinIDTakerFoundMakerRedemption = 'TakerFoundMakerRedemption:';
/* ethBasedExplorerArg returns the explorer argument for ETH, ERC20 and EVM
Compatible assets and whether the return value is an address. */
function ethBasedExplorerArg(cid) {
    if (cid.startsWith(coinIDTakerFoundMakerRedemption))
        return [cid.substring(coinIDTakerFoundMakerRedemption.length), true];
    else if (cid.length === 42)
        return [cid, true];
    else
        return [cid, false];
}
const ethExplorers = {
    [Mainnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://etherscan.io/address/${arg}` : `https://etherscan.io/tx/${arg}`;
    },
    [Testnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://sepolia.etherscan.io/address/${arg}` : `https://sepolia.etherscan.io/tx/${arg}`;
    },
    [Simnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://etherscan.io/address/${arg}` : `https://etherscan.io/tx/${arg}`;
    }
};
const polygonExplorers = {
    [Mainnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://polygonscan.com/address/${arg}` : `https://polygonscan.com/tx/${arg}`;
    },
    [Testnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://amoy.polygonscan.com/address/${arg}` : `https://amoy.polygonscan.com/tx/${arg}`;
    },
    [Simnet]: (cid) => {
        const [arg, isAddr] = ethBasedExplorerArg(cid);
        return isAddr ? `https://polygonscan.com/address/${arg}` : `https://polygonscan.com/tx/${arg}`;
    }
};
const CoinExplorers = {
    42: {
        [Mainnet]: (cid) => {
            const [txid, vout] = cid.split(':');
            if (vout !== undefined)
                return `https://explorer.dcrdata.org/tx/${txid}/out/${vout}`;
            return `https://explorer.dcrdata.org/tx/${txid}`;
        },
        [Testnet]: (cid) => {
            const [txid, vout] = cid.split(':');
            if (vout !== undefined)
                return `https://testnet.dcrdata.org/tx/${txid}/out/${vout}`;
            return `https://testnet.dcrdata.org/tx/${txid}`;
        },
        [Simnet]: (cid) => {
            const [txid, vout] = cid.split(':');
            if (vout !== undefined)
                return `http://127.0.0.1:17779/tx/${txid}/out/${vout}`;
            return `https://127.0.0.1:17779/tx/${txid}`;
        }
    },
    0: {
        [Mainnet]: (cid) => `https://mempool.space/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://mempool.space/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://mempool.space/tx/${cid.split(':')[0]}`
    },
    2: {
        [Mainnet]: (cid) => `https://ltc.bitaps.com/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://sochain.com/tx/LTCTEST/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://ltc.bitaps.com/${cid.split(':')[0]}`
    },
    20: {
        [Mainnet]: (cid) => `https://digiexplorer.info/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://testnetexplorer.digibyteservers.io/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://digiexplorer.info/tx/${cid.split(':')[0]}`
    },
    60: ethExplorers,
    60001: ethExplorers,
    60002: ethExplorers,
    3: {
        [Mainnet]: (cid) => `https://dogeblocks.com/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://blockexplorer.one/dogecoin/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://dogeblocks.com/tx/${cid.split(':')[0]}`
    },
    5: {
        [Mainnet]: (cid) => `https://blockexplorer.one/dash/mainnet/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://blockexplorer.one/dash/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://blockexplorer.one/dash/mainnet/tx/${cid.split(':')[0]}`
    },
    133: {
        [Mainnet]: (cid) => `https://zcashblockexplorer.com/transactions/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://blockexplorer.one/zcash/testnet/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://zcashblockexplorer.com/transactions/${cid.split(':')[0]}`
    },
    147: {
        [Mainnet]: (cid) => `https://explorer.zcl.zelcore.io/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://explorer.zcl.zelcore.io/tx/${cid.split(':')[0]}`
    },
    136: {
        [Mainnet]: (cid) => `https://explorer.firo.org/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://testexplorer.firo.org/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://explorer.firo.org/tx/${cid.split(':')[0]}`
    },
    145: {
        [Mainnet]: (cid) => `https://bch.loping.net/tx/${cid.split(':')[0]}`,
        [Testnet]: (cid) => `https://tbch4.loping.net/tx/${cid.split(':')[0]}`,
        [Simnet]: (cid) => `https://bch.loping.net/tx/${cid.split(':')[0]}`
    },
    966: polygonExplorers,
    966001: polygonExplorers,
    966002: polygonExplorers,
    966003: polygonExplorers,
    966004: polygonExplorers
};
function formatCoinID(cid) {
    if (cid.startsWith(coinIDTakerFoundMakerRedemption)) {
        const makerAddr = cid.substring(coinIDTakerFoundMakerRedemption.length);
        return _locales__WEBPACK_IMPORTED_MODULE_1__.prep(_locales__WEBPACK_IMPORTED_MODULE_1__.ID_TAKER_FOUND_MAKER_REDEMPTION, { makerAddr: makerAddr });
    }
    return cid;
}
/*
 * baseChainID returns the asset ID for the asset's parent if the asset is a
 * token, otherwise the ID for the asset itself.
 */
function baseChainID(assetID) {
    const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().user.assets[assetID];
    return asset.token ? asset.token.parentID : assetID;
}
/*
 * setCoinHref sets the hyperlink element's href attribute based on provided
 * assetID and data-explorer-coin value present on supplied link element.
 */
function setCoinHref(assetID, link) {
    const net = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().user.net;
    const assetExplorer = CoinExplorers[baseChainID(assetID)];
    if (!assetExplorer)
        return;
    const formatter = assetExplorer[net];
    if (!formatter)
        return;
    link.classList.remove('plainlink');
    link.classList.add('subtlelink');
    link.href = formatter(link.dataset.explorerCoin || '');
}


/***/ }),

/***/ "./src/js/dexsettings.ts":
/*!*******************************!*\
  !*** ./src/js/dexsettings.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ DexSettingsPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./account */ "./src/js/account.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







const animationLength = 300;
class DexSettingsPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body) {
        super();
        this.body = body;
        const host = this.host = body.dataset.host ? body.dataset.host : '';
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[host];
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.forms = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, ':scope > form');
        this.confirmRegisterForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.ConfirmRegistrationForm(page.confirmRegForm, () => __awaiter(this, void 0, void 0, function* () {
            this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_TRADING_TIER_UPDATED));
            this.renewToggle.setState(this.confirmRegisterForm.tier > 0);
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().updateMenuItemsDisplay();
        }), () => {
            this.runAnimation(this.regAssetForm, page.regAssetForm);
        });
        this.confirmRegisterForm.setExchange(xc, '');
        this.walletWaitForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.WalletWaitForm(page.walletWait, () => {
            this.runAnimation(this.confirmRegisterForm, page.confirmRegForm);
        }, () => {
            this.runAnimation(this.regAssetForm, page.regAssetForm);
        });
        this.walletWaitForm.setExchange(xc);
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.NewWalletForm(page.newWalletForm, assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier), () => this.runAnimation(this.regAssetForm, page.regAssetForm));
        this.regAssetForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.FeeAssetSelectionForm(page.regAssetForm, (assetID, tier) => __awaiter(this, void 0, void 0, function* () {
            if (assetID === _registry__WEBPACK_IMPORTED_MODULE_6__.PrepaidBondID) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
                this.updateReputation();
                this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_TRADING_TIER_UPDATED));
                return;
            }
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const wallet = asset.wallet;
            if (wallet) {
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.regAssetForm);
                const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.regAssetForm);
                this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
                loaded();
                this.progressTierFormsWithWallet(assetID, wallet);
                return;
            }
            this.confirmRegisterForm.setAsset(assetID, tier, 0);
            this.newWalletForm.setAsset(assetID);
            this.showForm(page.newWalletForm);
        }));
        this.regAssetForm.setExchange(xc, '');
        this.reputationMeter = new _account__WEBPACK_IMPORTED_MODULE_5__.ReputationMeter(page.repMeter);
        this.reputationMeter.setHost(host);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportDexBtn, 'click', () => this.exportAccount());
        this.accountDisabled = body.dataset.disabled === 'true';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.toggleAccountStatusBtn, 'click', () => {
            if (!this.accountDisabled)
                this.prepareAccountDisable(page.disableAccountForm);
            else
                this.toggleAccountStatus(false);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.updateCertBtn, 'click', () => page.certFileInput.click());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.updateHostBtn, 'click', () => this.prepareUpdateHost());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.certFileInput, 'change', () => this.onCertFileChange());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.goBackToSettings, 'click', () => (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('settings'));
        const showTierForm = () => {
            this.regAssetForm.setExchange((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[host], ''); // reset form
            this.showForm(page.regAssetForm);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.changeTier, 'click', () => { showTierForm(); });
        const willAutoRenew = xc.auth.targetTier > 0;
        this.renewToggle = new _doc__WEBPACK_IMPORTED_MODULE_0__.AniToggle(page.toggleAutoRenew, page.renewErr, willAutoRenew, (newState) => __awaiter(this, void 0, void 0, function* () {
            if (this.accountDisabled)
                return;
            if (newState)
                showTierForm();
            else
                return this.disableAutoRenew();
        }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.autoRenewBox, 'click', (e) => {
            e.stopPropagation();
            if (!this.accountDisabled)
                page.toggleAutoRenew.click();
        });
        page.penaltyComps.textContent = String(xc.auth.penaltyComps);
        const hideCompInput = () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.penaltyCompInput);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyComps);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.penaltyCompBox, 'click', (e) => {
            e.stopPropagation();
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host];
            page.penaltyCompInput.value = String(xc.auth.penaltyComps);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.penaltyComps);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyCompInput);
            page.penaltyCompInput.focus();
            const checkClick = (e) => {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, page.penaltyCompBox))
                    return;
                hideCompInput();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'click', checkClick);
            };
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'click', checkClick);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.penaltyCompInput, 'keyup', (e) => __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.penaltyCompsErr);
            if (e.key === 'Escape') {
                hideCompInput();
                return;
            }
            if (!(e.key === 'Enter'))
                return;
            const penaltyComps = parseInt(page.penaltyCompInput.value || '');
            if (isNaN(penaltyComps)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyCompsErr);
                page.penaltyCompsErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_INVALID_COMPS_VALUE);
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.otherBondSettings);
            try {
                yield this.updateBondOptions({ penaltyComps });
                loaded();
                page.penaltyComps.textContent = String(penaltyComps);
            }
            catch (e) {
                loaded();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.penaltyCompsErr);
                page.penaltyCompsErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_API_ERROR, { msg: e.msg });
            }
            hideCompInput();
        }));
        this.dexAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DEXAddressForm(page.dexAddrForm, (xc) => __awaiter(this, void 0, void 0, function* () {
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage(`/dexsettings/${xc.host}`);
        }), this.host);
        // forms.bind(page.bondDetailsForm, page.updateBondOptionsConfirm, () => this.updateBondOptions())
        _forms__WEBPACK_IMPORTED_MODULE_3__.bind(page.disableAccountForm, page.disableAccountConfirm, () => this.toggleAccountStatus(true));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                this.closePopups();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                this.closePopups();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, '.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { this.closePopups(); });
        });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            conn: () => { this.setConnectionStatus(); },
            reputation: () => { this.updateReputation(); },
            feepayment: () => { this.updateReputation(); },
            bondpost: () => { this.updateReputation(); }
        });
        this.setConnectionStatus();
        this.updateReputation();
    }
    unload() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
    progressTierFormsWithWallet(assetID, wallet) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, confirmRegisterForm: { fees } } = this;
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const { bondAssets } = this.regAssetForm.xc;
            const bondAsset = bondAssets[asset.symbol];
            if (!wallet.open) {
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.forms);
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/openwallet', { assetID: assetID });
                loaded();
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                    this.regAssetForm.setAssetError(`error unlocking wallet: ${res.msg}`);
                    this.runAnimation(this.regAssetForm, page.regAssetForm);
                }
                return;
            }
            if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + fees) {
                // If we are raising our tier, we'll show a confirmation form
                this.progressTierFormWithSyncedFundedWallet(assetID);
                return;
            }
            this.walletWaitForm.setWallet(assetID, fees, this.confirmRegisterForm.tier);
            this.showForm(page.walletWait);
        });
    }
    progressTierFormWithSyncedFundedWallet(bondAssetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host];
            const targetTier = this.confirmRegisterForm.tier;
            const page = this.page;
            const strongTier = xc.auth.liveStrength + xc.auth.pendingStrength - xc.auth.weakStrength;
            if (targetTier > xc.auth.targetTier && targetTier > strongTier) {
                this.runAnimation(this.confirmRegisterForm, page.confirmRegForm);
                return;
            }
            // Lowering tier
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            try {
                yield this.updateBondOptions({ bondAssetID, targetTier });
                loaded();
            }
            catch (e) {
                loaded();
                this.regAssetForm.setTierError(e.msg);
                return;
            }
            // this.animateConfirmForm(page.regAssetForm)
            this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_TRADING_TIER_UPDATED));
        });
    }
    updateReputation() {
        const page = this.page;
        const auth = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host].auth;
        const { rep: { penalties }, targetTier, expiredBonds } = auth;
        const displayTier = (0,_account__WEBPACK_IMPORTED_MODULE_5__.strongTier)(auth);
        page.targetTier.textContent = String(targetTier);
        page.effectiveTier.textContent = String(displayTier);
        page.penalties.textContent = String(penalties);
        page.bondsPendingRefund.textContent = `${(expiredBonds === null || expiredBonds === void 0 ? void 0 : expiredBonds.length) || 0}`;
        this.reputationMeter.update();
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.currentForm = form;
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    runAnimation(ani, form) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.currentForm);
            yield ani.animate();
            this.currentForm = form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form);
        });
    }
    closePopups() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
        if (this.animation)
            this.animation.stop();
    }
    showSuccess(msg) {
        return __awaiter(this, void 0, void 0, function* () {
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            this.currentForm = this.page.checkmarkForm;
            this.animation = _forms__WEBPACK_IMPORTED_MODULE_3__.showSuccess(this.page, msg);
            yield this.animation.wait();
            this.animation = new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(1500, () => { }, '', () => {
                if (this.currentForm === this.page.checkmarkForm)
                    this.closePopups();
            });
        });
    }
    // exportAccount exports and downloads the account info.
    exportAccount() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, host } = this;
            const req = { host };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/exportaccount', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.exportAccountErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.exportAccountErr);
                return;
            }
            res.account.bonds = res.bonds; // maintain backward compat of JSON file
            const accountForExport = JSON.parse(JSON.stringify(res.account));
            const a = document.createElement('a');
            a.setAttribute('download', 'dcrAccount-' + host + '.json');
            a.setAttribute('href', 'data:text/json,' + JSON.stringify(accountForExport, null, 2));
            a.click();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
        });
    }
    // toggleAccountStatus enables or disables the account associated with the
    // provided host.
    toggleAccountStatus(disable) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
            let host = this.host;
            if (disable)
                host = page.disableAccountHost.textContent;
            const req = { host, disable: disable };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/toggleaccountstatus', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                if (disable) {
                    page.disableAccountErr.textContent = res.msg;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.disableAccountErr);
                }
                else {
                    page.errMsg.textContent = res.msg;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
                }
                return;
            }
            if (disable) {
                this.page.toggleAccountStatusBtn.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_ENABLE_ACCOUNT);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            }
            else
                this.page.toggleAccountStatusBtn.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_DISABLE_ACCOUNT);
            this.accountDisabled = disable;
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage(`dexsettings/${host}`);
        });
    }
    prepareAccountDisable(disableAccountForm) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            page.disableAccountHost.textContent = this.host;
            page.disableAccountErr.textContent = '';
            this.showForm(disableAccountForm);
        });
    }
    // Retrieve an estimate for the tx fee needed to create new bond reserves.
    getBondsFeeBuffer(assetID, form) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/bondsfeebuffer', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                return 0;
            }
            return res.feeBuffer;
        });
    }
    prepareUpdateHost() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.dexAddrForm.refresh();
            this.showForm(page.dexAddrForm);
        });
    }
    onCertFileChange() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
            const files = page.certFileInput.files;
            let cert;
            if (files && files.length)
                cert = yield files[0].text();
            if (!cert)
                return;
            const req = { host: this.host, cert: cert };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/updatecert', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.updateCertMsg);
                setTimeout(() => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.updateCertMsg); }, 5000);
            }
        });
    }
    setConnectionStatus() {
        const page = this.page;
        const exchange = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.exchanges[this.host];
        const displayIcons = (connected) => {
            if (connected) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.disconnectedIcon);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.connectedIcon);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.disconnectedIcon);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.connectedIcon);
            }
        };
        if (exchange) {
            switch (exchange.connectionStatus) {
                case _registry__WEBPACK_IMPORTED_MODULE_6__.ConnectionStatus.Connected:
                    displayIcons(true);
                    page.connectionStatus.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_CONNECTED);
                    break;
                case _registry__WEBPACK_IMPORTED_MODULE_6__.ConnectionStatus.Disconnected:
                    displayIcons(false);
                    if (this.accountDisabled)
                        page.connectionStatus.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_ACCOUNT_DISABLED_MSG);
                    else
                        page.connectionStatus.textContent = _locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_DISCONNECTED);
                    break;
                case _registry__WEBPACK_IMPORTED_MODULE_6__.ConnectionStatus.InvalidCert:
                    displayIcons(false);
                    page.connectionStatus.textContent = `${_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_DISCONNECTED)} - ${_locales__WEBPACK_IMPORTED_MODULE_4__.prep(_locales__WEBPACK_IMPORTED_MODULE_4__.ID_INVALID_CERTIFICATE)}`;
            }
        }
    }
    disableAutoRenew() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.page.otherBondSettings);
            try {
                this.updateBondOptions({ targetTier: 0 });
                loaded();
            }
            catch (e) {
                loaded();
                throw e;
            }
        });
    }
    /*
     * updateBondOptions is called when the form to update bond options is
     * submitted.
     */
    updateBondOptions(conf) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            conf.host = this.host;
            yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/updatebondoptions', conf);
            const targetTier = (_a = conf.targetTier) !== null && _a !== void 0 ? _a : (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host].auth.targetTier;
            this.renewToggle.setState(targetTier > 0);
        });
    }
    newWalletCreated(assetID, tier) {
        return __awaiter(this, void 0, void 0, function* () {
            this.regAssetForm.refresh();
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            if (!user)
                return;
            const page = this.page;
            const asset = user.assets[assetID];
            const wallet = asset.wallet;
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[this.host];
            const bondAmt = xc.bondAssets[asset.symbol].amount;
            const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.newWalletForm);
            this.confirmRegisterForm.setFees(assetID, bondsFeeBuffer);
            if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {
                this.progressTierFormWithSyncedFundedWallet(assetID);
                return;
            }
            this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
            yield this.showForm(page.walletWait);
        });
    }
}


/***/ }),

/***/ "./src/js/doc.ts":
/*!***********************!*\
  !*** ./src/js/doc.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AniToggle": () => (/* binding */ AniToggle),
/* harmony export */   "Animation": () => (/* binding */ Animation),
/* harmony export */   "Easing": () => (/* binding */ Easing),
/* harmony export */   "IncrementalInput": () => (/* binding */ IncrementalInput),
/* harmony export */   "MiniSlider": () => (/* binding */ MiniSlider),
/* harmony export */   "NumberInput": () => (/* binding */ NumberInput),
/* harmony export */   "WalletIcons": () => (/* binding */ WalletIcons),
/* harmony export */   "clamp": () => (/* binding */ clamp),
/* harmony export */   "default": () => (/* binding */ Doc),
/* harmony export */   "parseFloatDefault": () => (/* binding */ parseFloatDefault),
/* harmony export */   "setupCopyBtn": () => (/* binding */ setupCopyBtn),
/* harmony export */   "toFourSigFigs": () => (/* binding */ toFourSigFigs),
/* harmony export */   "toPrecision": () => (/* binding */ toPrecision)
/* harmony export */ });
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


const parser = new window.DOMParser();
const FPS = 30;
const BipIDs = {
    0: 'btc',
    42: 'dcr',
    2: 'ltc',
    5: 'dash',
    20: 'dgb',
    22: 'mona',
    28: 'vtc',
    3: 'doge',
    145: 'bch',
    60: 'eth',
    60001: 'usdc.eth',
    60002: 'usdt.eth',
    60003: 'matic.eth',
    136: 'firo',
    133: 'zec',
    966: 'polygon',
    966001: 'usdc.polygon',
    966002: 'weth.polygon',
    966003: 'wbtc.polygon',
    966004: 'usdt.polygon',
    147: 'zcl'
};
const BipSymbolIDs = {};
(function () {
    for (const k of Object.keys(BipIDs)) {
        BipSymbolIDs[BipIDs[parseInt(k)]] = parseInt(k);
    }
})();
const BipSymbols = Object.values(BipIDs);
const RateEncodingFactor = 1e8; // same as value defined in ./orderutil
const log10RateEncodingFactor = Math.round(Math.log10(RateEncodingFactor));
const languages = navigator.languages.filter((locale) => locale !== 'c');
const intFormatter = new Intl.NumberFormat(languages, { maximumFractionDigits: 0 });
const fourSigFigs = new Intl.NumberFormat(languages, {
    minimumSignificantDigits: 4,
    maximumSignificantDigits: 4
});
/* A cache for formatters used for Doc.formatCoinValue. */
const decimalFormatters = {};
/*
 * decimalFormatter gets the formatCoinValue formatter for the specified decimal
 * precision.
 */
function decimalFormatter(prec) {
    return formatter(decimalFormatters, 2, prec);
}
/* A cache for formatters used for Doc.formatFullPrecision. */
const fullPrecisionFormatters = {};
/*
 * fullPrecisionFormatter gets the formatFullPrecision formatter for the
 * specified decimal precision.
 */
function fullPrecisionFormatter(prec, locales) {
    return formatter(fullPrecisionFormatters, prec, prec, locales);
}
/*
 * formatter gets the formatter from the supplied cache if it already exists,
 * else creates it.
 */
function formatter(formatters, min, max, locales) {
    const k = `${min}-${max}`;
    let fmt = formatters[k];
    if (!fmt) {
        fmt = new Intl.NumberFormat(locales !== null && locales !== void 0 ? locales : languages, {
            minimumFractionDigits: min,
            maximumFractionDigits: max
        });
        formatters[k] = fmt;
    }
    return fmt;
}
/*
 * convertToConventional converts the value in atomic units to conventional
 * units.
 */
function convertToConventional(v, unitInfo) {
    let prec = 8;
    if (unitInfo) {
        const f = unitInfo.conventional.conversionFactor;
        v /= f;
        prec = Math.round(Math.log10(f));
    }
    return [v, prec];
}
/*
 * bestDisplayOrder is used in bestConversion, and is the order of magnitude
 * that is considered the best for display. For example, if bestDisplayOrder is
 * 1, and the choices for display are 1,000 BTC or 0.00001 Sats, the algorithm
 * will look at the orders of the conversions, 1000 => 10^3 => order 3, and
 * 0.00001 => 10^-5 => order 5, and see which is closest to bestDisplayOrder and
 * choose that conversion. In the example, 3 - bestDisplayOrder = 2 and
 * 1 - (-5) = 6, so the conversion that has the order closest to
 * bestDisplayOrder is the first one, 1,000 BTC.
 */
const bestDisplayOrder = 1; // 10^1 => 1
/*
 * resolveUnitConversions creates a lookup object mapping unit -> conversion
 * factor. By default, resolveUnitConversions only maps the atomic and
 * conventional units. If a prefs dict is provided, additional units can be
 * included.
 */
function resolveUnitConversions(ui, prefs) {
    const unitFactors = {
        [ui.atomicUnit]: 1,
        [ui.conventional.unit]: ui.conventional.conversionFactor
    };
    if (ui.denominations && prefs) {
        for (const alt of ui.denominations)
            if (prefs[alt.unit])
                unitFactors[alt.unit] = alt.conversionFactor;
    }
    return unitFactors;
}
// Helpers for working with the DOM.
class Doc {
    /*
     * idel is the element with the specified id that is the descendent of the
     * specified node.
     */
    static idel(el, id) {
        return el.querySelector(`#${id}`);
    }
    /* bind binds the function to the event for the element. */
    static bind(el, ev, f, opts /* EventListenerOptions */) {
        for (const e of (Array.isArray(ev) ? ev : [ev]))
            el.addEventListener(e, f, opts);
    }
    /* unbind removes the handler for the event from the element. */
    static unbind(el, ev, f) {
        el.removeEventListener(ev, f);
    }
    /* noderize creates a Document object from a string of HTML. */
    static noderize(html) {
        return parser.parseFromString(html, 'text/html');
    }
    /*
     * mouseInElement returns true if the position of mouse event, e, is within
     * the bounds of the specified element or any of its descendents.
     */
    static mouseInElement(e, el) {
        if (el.contains(e.target))
            return true;
        const rect = el.getBoundingClientRect();
        return e.pageX >= rect.left && e.pageX <= rect.right &&
            e.pageY >= rect.top && e.pageY <= rect.bottom;
    }
    /*
     * layoutMetrics gets information about the elements position on the page.
     */
    static layoutMetrics(el) {
        const box = el.getBoundingClientRect();
        const docEl = document.documentElement;
        const top = box.top + docEl.scrollTop;
        const left = box.left + docEl.scrollLeft;
        const w = el.offsetWidth;
        const h = el.offsetHeight;
        return {
            bodyTop: top,
            bodyLeft: left,
            width: w,
            height: h,
            centerX: left + w / 2,
            centerY: top + h / 2
        };
    }
    static descendentMetrics(parent, kid) {
        const parentMetrics = Doc.layoutMetrics(parent);
        const kidMetrics = Doc.layoutMetrics(kid);
        return {
            bodyTop: kidMetrics.bodyTop - parentMetrics.bodyTop,
            bodyLeft: kidMetrics.bodyLeft - parentMetrics.bodyLeft,
            width: kidMetrics.width,
            height: kidMetrics.height,
            centerX: kidMetrics.centerX - parentMetrics.bodyLeft,
            centerY: kidMetrics.centerY - parentMetrics.bodyTop
        };
    }
    /* empty removes all child nodes from the specified element. */
    static empty(...els) {
        for (const el of els)
            while (el.firstChild)
                el.removeChild(el.firstChild);
    }
    /*
     * setContent removes all child nodes from the specified element and appends
     * passed elements.
     */
    static setContent(ancestor, ...kids) {
        Doc.empty(ancestor);
        for (const k of kids)
            ancestor.appendChild(k);
    }
    /*
     * hide hides the specified elements. This is accomplished by adding the
     * bootstrap d-hide class to the element. Use Doc.show to undo.
     */
    static hide(...els) {
        for (const el of els)
            el.classList.add('d-hide');
    }
    /*
     * show shows the specified elements. This is accomplished by removing the
     * bootstrap d-hide class as added with Doc.hide.
     */
    static show(...els) {
        for (const el of els)
            el.classList.remove('d-hide');
    }
    /*
     * show or hide the specified elements, based on value of the truthiness of
     * vis.
     */
    static setVis(vis, ...els) {
        if (vis)
            Doc.show(...els);
        else
            Doc.hide(...els);
    }
    /* isHidden returns true if the specified element is hidden */
    static isHidden(el) {
        return el.classList.contains('d-hide');
    }
    /* isDisplayed returns true if the specified element is not hidden */
    static isDisplayed(el) {
        return !el.classList.contains('d-hide');
    }
    /*
     * animate runs the supplied function, which should be a "progress" function
     * accepting one argument. The progress function will be called repeatedly
     * with the argument varying from 0.0 to 1.0. The exact path that animate
     * takes from 0.0 to 1.0 will vary depending on the choice of easing
     * algorithm. See the Easing object for the available easing algo choices. The
     * default easing algorithm is linear.
     */
    static animate(duration, f, easingAlgo) {
        return __awaiter(this, void 0, void 0, function* () {
            yield new Animation(duration, f, easingAlgo).wait();
        });
    }
    static blink(el) {
        return __awaiter(this, void 0, void 0, function* () {
            const [r, g, b] = _state__WEBPACK_IMPORTED_MODULE_1__["default"].isDark() ? [255, 255, 255] : [0, 0, 0];
            const cycles = 2;
            Doc.animate(1000, (p) => {
                el.style.outline = `2px solid rgba(${r}, ${g}, ${b}, ${(cycles - p * cycles) % 1})`;
            });
        });
    }
    static applySelector(ancestor, k) {
        return Array.from(ancestor.querySelectorAll(k));
    }
    static kids(ancestor) {
        return Array.from(ancestor.children);
    }
    static safeSelector(ancestor, k) {
        const el = ancestor.querySelector(k);
        if (el)
            return el;
        console.warn(`no element found for selector '${k}' on element ->`, ancestor);
        return document.createElement('div');
    }
    /*
     * idDescendants creates an object mapping to elements which are descendants
     * of the ancestor and have id attributes. Elements are keyed by their id
     * value.
     */
    static idDescendants(ancestor) {
        const d = {};
        for (const el of Doc.applySelector(ancestor, '[id]'))
            d[el.id] = el;
        return d;
    }
    /*
     * formatCoinValue formats the value in atomic units into a string
     * representation in conventional units. If the value happens to be an
     * integer, no decimals are displayed. Trailing zeros may be truncated.
     */
    static formatCoinValue(vAtomic, unitInfo) {
        const [v, prec] = convertToConventional(vAtomic, unitInfo);
        if (Number.isInteger(v))
            return intFormatter.format(v);
        return decimalFormatter(prec).format(v);
    }
    static conventionalCoinValue(vAtomic, unitInfo) {
        const [v] = convertToConventional(vAtomic, unitInfo);
        return v;
    }
    /*
     * formatRateFullPrecision formats rate to represent it exactly at rate step
     * precision, trimming non-effectual zeros if there are any.
     */
    static formatRateFullPrecision(encRate, bui, qui, rateStepEnc) {
        const r = bui.conventional.conversionFactor / qui.conventional.conversionFactor;
        const convRate = encRate * r / RateEncodingFactor;
        const rateStepDigits = log10RateEncodingFactor - Math.floor(Math.log10(rateStepEnc)) -
            Math.floor(Math.log10(bui.conventional.conversionFactor) - Math.log10(qui.conventional.conversionFactor));
        if (rateStepDigits <= 0)
            return intFormatter.format(convRate);
        return fullPrecisionFormatter(rateStepDigits).format(convRate);
    }
    static formatFourSigFigs(n, maxDecimals) {
        return formatSigFigsWithFormatters(intFormatter, fourSigFigs, n, maxDecimals);
    }
    static formatInt(i) {
        return intFormatter.format(i);
    }
    /*
     * formatFullPrecision formats the value in atomic units into a string
     * representation in conventional units using the full decimal precision
     * associated with the conventional unit's conversion factor.
     */
    static formatFullPrecision(vAtomic, unitInfo) {
        const [v, prec] = convertToConventional(vAtomic, unitInfo);
        return fullPrecisionFormatter(prec).format(v);
    }
    /*
     * formatFiatConversion formats the value in atomic units to its representation in
     * conventional units and returns the fiat value as a string.
     */
    static formatFiatConversion(vAtomic, rate, unitInfo) {
        if (!rate || rate === 0)
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNAVAILABLE);
        const prec = 2;
        const [v] = convertToConventional(vAtomic, unitInfo);
        const value = v * rate;
        return fullPrecisionFormatter(prec).format(value);
    }
    static languages() {
        return languages;
    }
    static formatFiatValue(value) {
        return fullPrecisionFormatter(2).format(value);
    }
    /*
     * bestConversion picks the best conversion factor for the atomic value. The
     * best is the one in which log10(converted_value) is closest to
     * bestDisplayOrder. Return: [converted_value, precision, unit].
     */
    static bestConversion(atoms, ui, prefs) {
        const unitFactors = resolveUnitConversions(ui, prefs);
        const logDiffs = [];
        const entryDiff = (entry) => Math.abs(Math.log10(atoms / entry[1]) - bestDisplayOrder);
        for (const entry of Object.entries(unitFactors))
            logDiffs.push([entry[0], entryDiff(entry)]);
        const best = logDiffs.reduce((best, entry) => entry[1] < best[1] ? entry : best);
        const unit = best[0];
        const cFactor = unitFactors[unit];
        const v = atoms / cFactor;
        return [v, Math.round(Math.log10(cFactor)), unit];
    }
    /*
     * formatBestUnitsFullPrecision formats the value with the best choice of
     * units, at full precision.
     */
    static formatBestUnitsFullPrecision(atoms, ui, prefs) {
        const [v, prec, unit] = this.bestConversion(atoms, ui, prefs);
        if (Number.isInteger(v))
            return [intFormatter.format(v), unit];
        return [fullPrecisionFormatter(prec).format(v), unit];
    }
    /*
     * formatBestUnitsFourSigFigs formats the value with the best choice of
     * units and rounded to four significant figures.
     */
    static formatBestUnitsFourSigFigs(atoms, ui, prefs) {
        const [v, prec, unit] = this.bestConversion(atoms, ui, prefs);
        return [Doc.formatFourSigFigs(v, prec), unit];
    }
    /*
     * formatBestRateElement formats a rate using the best available units and
     * updates the UI element. The ancestor should have descendents with data
     * attributes [best-value, data-unit, data-unit-box, data-denom].
     */
    static formatBestRateElement(ancestor, assetID, atoms, ui, prefs) {
        Doc.formatBestValueElement(ancestor, assetID, atoms, ui, prefs);
        Doc.setText(ancestor, '[data-denom]', ui.feeRateDenom);
    }
    /*
     * formatBestRateElement formats a value using the best available units and
     * updates the UI element. The ancestor should have descendents with data
     * attributes [best-value, data-unit, data-unit-box].
     */
    static formatBestValueElement(ancestor, assetID, atoms, ui, prefs) {
        const [v, unit] = this.formatBestUnitsFourSigFigs(atoms, ui, prefs);
        Doc.setText(ancestor, '[data-value]', v);
        Doc.setText(ancestor, '[data-unit]', unit);
        const span = Doc.safeSelector(ancestor, '[data-unit-box]');
        span.dataset.atoms = String(atoms);
        span.dataset.assetID = String(assetID);
    }
    static conventionalRateStep(rateStepEnc, baseUnitInfo, quoteUnitInfo) {
        const [qFactor, bFactor] = [quoteUnitInfo.conventional.conversionFactor, baseUnitInfo.conventional.conversionFactor];
        return rateStepEnc / RateEncodingFactor * (bFactor / qFactor);
    }
    /*
     * logoPath creates a path to a png logo for the specified ticker symbol. If
     * the symbol is not a supported asset, the generic letter logo will be
     * requested instead.
     */
    static logoPath(symbol) {
        if (BipSymbols.indexOf(symbol) === -1)
            symbol = symbol.substring(0, 1);
        symbol = symbol.split('.')[0]; // e.g. usdc.eth => usdc
        return `/img/coins/${symbol}.png`;
    }
    static bipSymbol(assetID) {
        return BipIDs[assetID];
    }
    static bipIDFromSymbol(symbol) {
        return BipSymbolIDs[symbol];
    }
    static bipCEXSymbol(assetID) {
        const bipSymbol = BipIDs[assetID];
        if (!bipSymbol || bipSymbol === '')
            return '';
        const parts = bipSymbol.split('.');
        if (parts[0] === 'weth')
            return 'eth';
        return parts[0];
    }
    static logoPathFromID(assetID) {
        return Doc.logoPath(BipIDs[assetID]);
    }
    /*
     * symbolize creates a token-aware symbol element for the asset's symbol. For
     * non-token assets, this is simply a <span>SYMBOL</span>. For tokens, it'll
     * be <span><span>SYMBOL</span><sup>PARENT</sup></span>.
     */
    static symbolize(asset, useLogo) {
        const ticker = asset.unitInfo.conventional.unit;
        const symbolSpan = document.createElement('span');
        symbolSpan.textContent = ticker.toUpperCase();
        const parts = asset.symbol.split('.');
        const isToken = parts.length === 2;
        if (!isToken)
            return symbolSpan;
        const parentSymbol = parts[1];
        const span = document.createElement('span');
        span.appendChild(symbolSpan);
        if (useLogo) {
            const parentLogo = document.createElement('img');
            parentLogo.src = Doc.logoPath(parentSymbol);
            parentLogo.classList.add('token-parent');
            span.appendChild(parentLogo);
            return span;
        }
        const parentSup = document.createElement('sup');
        parentSup.textContent = parentSymbol.toUpperCase();
        parentSup.classList.add('token-parent');
        span.appendChild(parentSup);
        return span;
    }
    /*
     * shortSymbol removes the short format of a symbol, with any parent chain
     * identifier removed
     */
    static shortSymbol(symbol) {
        return symbol.split('.')[0].toUpperCase();
    }
    /*
     * setText sets the textContent for all descendant elements that match the
     * specified CSS selector.
     */
    static setText(ancestor, selector, textContent) {
        for (const el of Doc.applySelector(ancestor, selector))
            el.textContent = textContent;
    }
    static setSrc(ancestor, selector, textContent) {
        for (const img of Doc.applySelector(ancestor, selector))
            img.src = textContent;
    }
    /*
    * cleanTemplates removes the elements from the DOM and deletes the id
    * attribute.
    */
    static cleanTemplates(...tmpls) {
        tmpls.forEach(tmpl => {
            tmpl.remove();
            tmpl.removeAttribute('id');
        });
    }
    /*
    * tmplElement is a helper function for grabbing sub-elements of the market list
    * template.
    */
    static tmplElement(ancestor, s) {
        return ancestor.querySelector(`[data-tmpl="${s}"]`) || document.createElement('div');
    }
    /*
    * parseTemplate returns an object of data-tmpl elements, keyed by their
    * data-tmpl values.
    */
    static parseTemplate(ancestor) {
        const d = {};
        for (const el of Doc.applySelector(ancestor, '[data-tmpl]'))
            d[el.dataset.tmpl || ''] = el;
        return d;
    }
    /*
     * timeSince returns a string representation of the duration since the
     * specified unix timestamp (milliseconds).
     */
    static timeSince(ms) {
        return Doc.formatDuration((new Date().getTime()) - ms);
    }
    /*
     * hmsSince returns a time duration since the specified unix timestamp
     * formatted as HH:MM:SS
     */
    static hmsSince(secs) {
        let r = (new Date().getTime() / 1000) - secs;
        const h = String(Math.floor(r / 3600));
        r = r % 3600;
        const m = String(Math.floor(r / 60));
        const s = String(Math.floor(r % 60));
        return `${h.padStart(2, '0')}:${m.padStart(2, '0')}:${s.padStart(2, '0')}`;
    }
    /* formatDuration returns a string representation of the duration */
    static formatDuration(dur) {
        let seconds = Math.floor(dur);
        let result = '';
        let count = 0;
        const add = (n, s) => {
            if (n > 0 || count > 0)
                count++;
            if (n > 0)
                result += `${n} ${s} `;
            return count >= 2;
        };
        let y, mo, d, h, m, s;
        [y, seconds] = timeMod(seconds, aYear);
        if (add(y, 'y')) {
            return result;
        }
        [mo, seconds] = timeMod(seconds, aMonth);
        if (add(mo, 'mo')) {
            return result;
        }
        [d, seconds] = timeMod(seconds, aDay);
        if (add(d, 'd')) {
            return result;
        }
        [h, seconds] = timeMod(seconds, anHour);
        if (add(h, 'h')) {
            return result;
        }
        [m, seconds] = timeMod(seconds, aMinute);
        if (add(m, 'm')) {
            return result;
        }
        [s, seconds] = timeMod(seconds, 1000);
        add(s, 's');
        return result || '0 s';
    }
    /*
     * disableMouseWheel can be used to disable the mouse wheel for any
     * input. It is very easy to unknowingly scroll up on a number input
     * and then submit an unexpected value. This function prevents the
     * scroll increment/decrement behavior for a wheel action on a
     * number input.
     */
    static disableMouseWheel(...inputFields) {
        for (const inputField of inputFields) {
            Doc.bind(inputField, 'wheel', () => { }, { passive: true });
        }
    }
    // showFormError can be used to set and display error message on forms.
    static showFormError(el, msg) {
        el.textContent = msg;
        Doc.show(el);
    }
    // showFiatValue displays the fiat equivalent for the provided amount.
    static showFiatValue(display, amount, rate, ui) {
        if (rate) {
            display.textContent = Doc.formatFiatConversion(amount, rate, ui);
            Doc.show(display.parentElement);
        }
        else
            Doc.hide(display.parentElement);
    }
}
/*
 * Animation is a handler for starting and stopping animations.
 */
class Animation {
    constructor(duration, f, easingAlgo, done) {
        this.done = done;
        this.thread = this.run(duration, f, easingAlgo);
    }
    /*
     * run runs the animation function, increasing progress from 0 to 1 in a
     * manner dictated by easingAlgo.
     */
    run(duration, f, easingAlgo) {
        return __awaiter(this, void 0, void 0, function* () {
            duration = duration >= 0 ? duration : 1000 * 86400 * 365 * 10; // 10 years, in ms
            const easer = easingAlgo ? Easing[easingAlgo] : Easing.linear;
            const start = new Date().getTime();
            const end = (duration === Animation.Forever) ? Number.MAX_SAFE_INTEGER : start + duration;
            const range = end - start;
            const frameDuration = 1000 / FPS;
            let now = start;
            this.endAnimation = false;
            while (now < end) {
                if (this.endAnimation)
                    return this.runCompletionFunction();
                f(easer((now - start) / range));
                yield sleep(frameDuration);
                now = new Date().getTime();
            }
            f(1);
            this.runCompletionFunction();
        });
    }
    /* wait returns a promise that will resolve when the animation completes. */
    wait() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.thread;
        });
    }
    /* stop schedules the animation to exit at its next frame. */
    stop() {
        this.endAnimation = true;
    }
    /*
     * stopAndWait stops the animations and returns a promise that will resolve
     * when the animation exits.
     */
    stopAndWait() {
        return __awaiter(this, void 0, void 0, function* () {
            this.stop();
            yield this.wait();
        });
    }
    /* runCompletionFunction runs any registered callback function */
    runCompletionFunction() {
        if (this.done)
            this.done();
    }
}
Animation.Forever = -1;
/* Easing algorithms for animations. */
const Easing = {
    linear: t => t,
    easeIn: t => t * t,
    easeOut: t => t * (2 - t),
    easeInHard: t => t * t * t,
    easeOutHard: t => (--t) * t * t + 1,
    easeOutElastic: t => {
        const c4 = (2 * Math.PI) / 3;
        return t === 0
            ? 0
            : t === 1
                ? 1
                : Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * c4) + 1;
    }
};
/* WalletIcons are used for controlling wallets in various places. */
class WalletIcons {
    constructor(box) {
        const stateElement = (name) => box.querySelector(`[data-state=${name}]`);
        this.icons = {};
        this.icons.sleeping = stateElement('sleeping');
        this.icons.locked = stateElement('locked');
        this.icons.unlocked = stateElement('unlocked');
        this.icons.nowallet = stateElement('nowallet');
        this.icons.syncing = stateElement('syncing');
        this.icons.nopeers = stateElement('nopeers');
        this.icons.disabled = stateElement('disabled');
        this.status = stateElement('status');
    }
    /* sleeping sets the icons to indicate that the wallet is not connected. */
    sleeping() {
        const i = this.icons;
        Doc.hide(i.locked, i.unlocked, i.nowallet, i.syncing, i.disabled);
        Doc.show(i.sleeping);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_OFF);
    }
    /*
     * locked sets the icons to indicate that the wallet is connected, but locked.
     */
    locked() {
        const i = this.icons;
        Doc.hide(i.unlocked, i.nowallet, i.sleeping, i.disabled);
        Doc.show(i.locked);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_LOCKED);
    }
    /*
     * unlocked sets the icons to indicate that the wallet is connected and
     * unlocked.
     */
    unlocked() {
        const i = this.icons;
        Doc.hide(i.locked, i.nowallet, i.sleeping, i.disabled);
        Doc.show(i.unlocked);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_READY);
    }
    /* nowallet sets the icons to indicate that no wallet exists. */
    nowallet() {
        const i = this.icons;
        Doc.hide(i.locked, i.unlocked, i.sleeping, i.syncing, i.disabled);
        Doc.show(i.nowallet);
        if (this.status)
            this.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_NO_WALLET);
    }
    /* set the icons to indicate that the wallet is disabled */
    disabled() {
        const i = this.icons;
        Doc.hide(i.locked, i.unlocked, i.sleeping, i.syncing, i.nowallet, i.nopeers);
        Doc.show(i.disabled);
        i.disabled.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_DISABLED_MSG);
    }
    setSyncing(wallet) {
        const syncIcon = this.icons.syncing;
        if (!wallet || !wallet.running || wallet.disabled) {
            Doc.hide(syncIcon);
            return;
        }
        if (wallet.peerCount === 0) {
            Doc.show(this.icons.nopeers);
            Doc.hide(syncIcon); // potentially misleading with no peers
            return;
        }
        Doc.hide(this.icons.nopeers);
        if (!wallet.synced) {
            Doc.show(syncIcon);
            syncIcon.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_WALLET_SYNC_PROGRESS, { syncProgress: (wallet.syncProgress * 100).toFixed(1) });
            return;
        }
        Doc.hide(syncIcon);
    }
    /* reads the core.Wallet state and sets the icon visibility. */
    readWallet(wallet) {
        this.setSyncing(wallet);
        if (!wallet)
            return this.nowallet();
        switch (true) {
            case (wallet.disabled):
                this.disabled();
                break;
            case (!wallet.running):
                this.sleeping();
                break;
            case (!wallet.open):
                this.locked();
                break;
            case (wallet.open):
                this.unlocked();
                break;
            default:
                console.error('wallet in unknown state', wallet);
        }
    }
}
/*
 * AniToggle is a small toggle switch, defined in HTML with the element
 * <div class="anitoggle"></div>. The animations are defined in the anitoggle
 * CSS class. AniToggle triggers the callback on click events, but does not
 * update toggle appearance, so the caller must call the setState method from
 * the callback or elsewhere if the newState
 * is accepted.
 */
class AniToggle {
    constructor(toggle, errorEl, initialState, callback) {
        this.toggle = toggle;
        if (toggle.children.length === 0)
            toggle.appendChild(document.createElement('div'));
        Doc.bind(toggle, 'click', (e) => __awaiter(this, void 0, void 0, function* () {
            e.stopPropagation();
            Doc.hide(errorEl);
            const newState = !toggle.classList.contains('on');
            this.toggling = true;
            try {
                yield callback(newState);
            }
            catch (e) {
                this.toggling = false;
                Doc.show(errorEl);
                errorEl.textContent = _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_API_ERROR, { msg: e.msg || String(e) });
                return;
            }
            this.toggling = false;
        }));
        this.setState(initialState);
    }
    setState(state) {
        if (state)
            this.toggle.classList.add('on');
        else
            this.toggle.classList.remove('on');
    }
}
/* sleep can be used by async functions to pause for a specified period. */
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}
const aYear = 31536000000;
const aMonth = 2592000000;
const aDay = 86400000;
const anHour = 3600000;
const aMinute = 60000;
/* timeMod returns the quotient and remainder of t / dur. */
function timeMod(t, dur) {
    const n = Math.floor(t / dur);
    return [n, t - n * dur];
}
function formatSigFigsWithFormatters(intFormatter, sigFigFormatter, n, maxDecimals, locales) {
    var _a, _b;
    if (n >= 1000)
        return intFormatter.format(n);
    const s = sigFigFormatter.format(n);
    if (typeof maxDecimals !== 'number')
        return s;
    const fractional = (_b = (_a = sigFigFormatter.formatToParts(n).filter((part) => part.type === 'fraction')[0]) === null || _a === void 0 ? void 0 : _a.value) !== null && _b !== void 0 ? _b : '';
    if (fractional.length <= maxDecimals)
        return s;
    return fullPrecisionFormatter(maxDecimals, locales).format(n);
}
if (true) {
    // Code will only appear in dev build.
    // https://webpack.js.org/guides/production/
    window.testFormatFourSigFigs = () => {
        const tests = [
            ['en-US', '1.234567', undefined, '1.235'],
            ['en-US', '1.234567', 2, '1.23'],
            ['en-US', '1234', undefined, '1,234.0'],
            ['en-US', '12', undefined, '12.00'],
            ['fr-FR', '123.45678', undefined, '123,5'],
            ['fr-FR', '1234.5', undefined, '1 234,5'],
            // For Arabic, https://www.saitak.com/number is useful, but seems to use
            // slightly different unicode points and no thousands separator. I think
            // the Arabic decimal separator is supposed to be more like a point, not
            // a comma, but Google Chrome uses U+066B (Arabic Decimal Separator),
            // which looks like a comma to me. ¯\_(ツ)_/¯
            ['ar-EG', '123.45678', undefined, '١٢٣٫٥'],
            ['ar-EG', '1234', undefined, '١٬٢٣٤٫٠'],
            ['ar-EG', '0.12345', 3, '٠٫١٢٣']
        ];
        // Reproduce the NumberFormats with ONLY our desired language.
        for (const [code, unformatted, maxDecimals, expected] of tests) {
            const intFormatter = new Intl.NumberFormat(code, {
                minimumFractionDigits: 1,
                maximumFractionDigits: 1
            });
            const sigFigFormatter = new Intl.NumberFormat(code, {
                minimumSignificantDigits: 4,
                maximumSignificantDigits: 4
            });
            for (const k in decimalFormatters)
                delete decimalFormatters[k]; // cleanup
            for (const k in fullPrecisionFormatters)
                delete fullPrecisionFormatters[k]; // cleanup
            const s = formatSigFigsWithFormatters(intFormatter, sigFigFormatter, parseFloatDefault(unformatted), maxDecimals, code);
            if (s !== expected)
                console.log(`TEST FAILED: f('${code}', ${unformatted}, ${maxDecimals}) => '${s}' != '${expected}'}`);
            else
                console.log(`✔️ f('${code}', ${unformatted}, ${maxDecimals}) => ${s} ✔️`);
        }
    };
    window.testFormatRateFullPrecision = () => {
        const tests = [
            // Two utxo assets with a conventional rate of 0.15. Conventional rate
            // step is 100 / 1e8 = 1e-6, so there should be 6 decimal digits.
            [1.5e7, 100, 1e8, 1e8, '0.150000'],
            // USDC quote -> utxo base with a rate of $10 / 1 XYZ. USDC has an
            // conversion factor of 1e6, so $10 encodes to 1e7, 1 XYZ encodes to 1e8,
            // encoded rate is 1e7 / 1e8 * 1e8 = 1e7, bFactor / qFactor is 1e2.
            // The conventional rate step is 200 / 1e8 * 1e2 = 2e-4, so using
            // rateStepDigits, we should get 4 decimal digits.
            [1e7, 200, 1e6, 1e8, '10.0000'],
            // Set a rate of 1 atom USDC for 0.01 BTC. That atomic rate will be 1 /
            // 1e6 = 1e-6. The encoded rate will be 1e-6 * 1e8 = 1e2. As long as our
            // rate step divides evenly into 100, this should work. The conventional
            // rate is 1e-6 / 1e-2 = 1e-4, so expect 4 decimal digits.
            [1e2, 100, 1e6, 1e8, '0.0001'],
            // DCR-ETH, expect 6 decimals.
            [1.5e7, 1000, 1e9, 1e8, '0.015000'],
            [1e6, 1000, 1e9, 1e8, '0.001000'],
            [1e3, 1000, 1e9, 1e8, '0.000001'],
            [100001000, 1000, 1e9, 1e8, '0.100001'],
            [1000001000, 1000, 1e9, 1e8, '1.000001'],
            // DCR-USDC, expect 3 decimals.
            [1.5e7, 1000, 1e6, 1e8, '15.000'],
            [1e6, 1000, 1e6, 1e8, '1.000'],
            [1e3, 1000, 1e6, 1e8, '0.001'],
            [101000, 1000, 1e6, 1e8, '0.101'],
            [1001000, 1000, 1e6, 1e8, '1.001'],
            // UTXO assets but with a rate step that's not a perfect power of 10.
            // For a rate step of 500, a min rate would be e.g. rate step = 500.
            // 5e2 / 1e8 = 5e-6 = 0.000005
            [5e2, 500, 1e8, 1e8, '0.000005']
        ];
        for (const [encRate, rateStep, qFactor, bFactor, expEncoding] of tests) {
            for (const k in fullPrecisionFormatters)
                delete fullPrecisionFormatters[k]; // cleanup
            const bui = { conventional: { conversionFactor: bFactor } };
            const qui = { conventional: { conversionFactor: qFactor } };
            const enc = Doc.formatRateFullPrecision(encRate, bui, qui, rateStep);
            if (enc !== expEncoding)
                console.log(`TEST FAILED: f(${encRate}, ${bFactor}, ${qFactor}, ${rateStep}) => ${enc} != ${expEncoding}`);
            else
                console.log(`✔️ f(${encRate}, ${bFactor}, ${qFactor}, ${rateStep}) => ${enc} ✔️`);
        }
    };
}
class NumberInput {
    constructor(input, opts) {
        var _a, _b, _c;
        this.input = input;
        this.prec = (_a = opts.prec) !== null && _a !== void 0 ? _a : 0;
        this.fmt = opts.sigFigs ? toFourSigFigs : toPrecision;
        this.changed = (_b = opts.changed) !== null && _b !== void 0 ? _b : (() => { });
        this.set = opts.set;
        this.min = (_c = opts.min) !== null && _c !== void 0 ? _c : 0;
        Doc.bind(input, 'change', () => { this.inputChanged(); });
    }
    inputChanged() {
        const { changed } = this;
        if (changed)
            changed(this.value());
    }
    setValue(v) {
        this.input.value = String(v);
        v = this.value();
        if (this.set)
            this.set(v, this.input.value);
    }
    value() {
        const { input, min, prec, fmt } = this;
        const rawV = Math.max(parseFloatDefault(input.value, min !== null && min !== void 0 ? min : 0), min !== null && min !== void 0 ? min : 0);
        const [v, s] = fmt(rawV, prec !== null && prec !== void 0 ? prec : 0);
        input.value = s;
        return v;
    }
}
class IncrementalInput extends NumberInput {
    constructor(box, opts) {
        var _a;
        super(Doc.safeSelector(box, 'input'), opts);
        this.opts = opts;
        this.inc = (_a = opts.inc) !== null && _a !== void 0 ? _a : 1;
        const up = Doc.safeSelector(box, '.ico-arrowup');
        const down = Doc.safeSelector(box, '.ico-arrowdown');
        Doc.bind(up, 'click', () => { this.increment(1); });
        Doc.bind(down, 'click', () => { this.increment(-1); });
    }
    setIncrementAndMinimum(inc, min) {
        this.inc = inc;
        this.min = min;
    }
    increment(sign) {
        const { inc, min, input } = this;
        input.value = String(Math.max(this.value() + sign * inc, min));
        this.inputChanged();
    }
}
class MiniSlider {
    constructor(box, changed) {
        this.changed = changed;
        this.r = 0;
        const color = document.createElement('div');
        color.dataset.tmpl = 'color';
        box.appendChild(color);
        const track = this.track = document.createElement('div');
        track.dataset.tmpl = 'track';
        color.appendChild(track);
        const ball = this.ball = document.createElement('div');
        ball.dataset.tmpl = 'ball';
        track.appendChild(ball);
        Doc.bind(box, 'mousedown', (e) => {
            if (e.button !== 0)
                return;
            e.preventDefault();
            e.stopPropagation();
            const startX = e.pageX;
            const w = track.clientWidth;
            const startLeft = this.r * w;
            const left = (ee) => Math.max(Math.min(startLeft + (ee.pageX - startX), w), 0);
            const trackMouse = (ee) => {
                ee.preventDefault();
                const l = left(ee);
                this.r = l / w;
                ball.style.left = `${this.r * 100}%`;
                this.changed(this.r);
            };
            const mouseUp = (ee) => {
                trackMouse(ee);
                Doc.unbind(document, 'mousemove', trackMouse);
                Doc.unbind(document, 'mouseup', mouseUp);
            };
            Doc.bind(document, 'mousemove', trackMouse);
            Doc.bind(document, 'mouseup', mouseUp);
        });
        Doc.bind(box, 'click', (e) => {
            if (e.button !== 0)
                return;
            const x = e.pageX;
            const m = Doc.layoutMetrics(track);
            this.r = clamp((x - m.bodyLeft) / m.width, 0, 1);
            ball.style.left = `${this.r * m.width}px`;
            this.changed(this.r);
        });
    }
    setValue(r) {
        this.r = clamp(r, 0, 1);
        this.ball.style.left = `${this.r * 100}%`;
    }
}
function toPrecision(v, prec) {
    const ord = Math.pow(10, prec !== null && prec !== void 0 ? prec : 0);
    v = Math.round(v * ord) / ord;
    let s = v.toFixed(prec);
    if (prec > 0) {
        while (s.endsWith('0'))
            s = s.substring(0, s.length - 1);
        if (s.endsWith('.'))
            s = s.substring(0, s.length - 1);
    }
    return [v, s];
}
function toFourSigFigs(v, maxPrec) {
    const ord = Math.floor(Math.log10(Math.abs(v)));
    if (ord >= 3)
        return [Math.round(v), v.toFixed(0)];
    const prec = Math.min(4 - ord, maxPrec);
    return toPrecision(v, prec);
}
function parseFloatDefault(inputValue, defaultValue) {
    const v = parseFloat((inputValue !== null && inputValue !== void 0 ? inputValue : '').replace(/,/g, ''));
    if (!isNaN(v))
        return v;
    return defaultValue !== null && defaultValue !== void 0 ? defaultValue : 0;
}
/* clamp returns v if min <= v <= max, else min or max. */
function clamp(v, min, max) {
    if (v < min)
        return min;
    if (v > max)
        return max;
    return v;
}
function setupCopyBtn(txt, textEl, btnEl, color) {
    return __awaiter(this, void 0, void 0, function* () {
        try {
            yield navigator.clipboard.writeText(txt);
        }
        catch (err) {
            console.error('Unable to copy: ', err);
        }
        const textOriginalColor = textEl.style.color;
        const btnOriginalColor = btnEl.style.color;
        textEl.style.color = color;
        btnEl.style.color = color;
        setTimeout(() => {
            textEl.style.color = textOriginalColor;
            btnEl.style.color = btnOriginalColor;
        }, 350);
    });
}


/***/ }),

/***/ "./src/js/forms.ts":
/*!*************************!*\
  !*** ./src/js/forms.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AccelerateOrderForm": () => (/* binding */ AccelerateOrderForm),
/* harmony export */   "AppPassResetForm": () => (/* binding */ AppPassResetForm),
/* harmony export */   "CEXConfigurationForm": () => (/* binding */ CEXConfigurationForm),
/* harmony export */   "CertificatePicker": () => (/* binding */ CertificatePicker),
/* harmony export */   "ConfirmRegistrationForm": () => (/* binding */ ConfirmRegistrationForm),
/* harmony export */   "DEXAddressForm": () => (/* binding */ DEXAddressForm),
/* harmony export */   "DepositAddress": () => (/* binding */ DepositAddress),
/* harmony export */   "DiscoverAccountForm": () => (/* binding */ DiscoverAccountForm),
/* harmony export */   "FeeAssetSelectionForm": () => (/* binding */ FeeAssetSelectionForm),
/* harmony export */   "Forms": () => (/* binding */ Forms),
/* harmony export */   "LoginForm": () => (/* binding */ LoginForm),
/* harmony export */   "NewWalletForm": () => (/* binding */ NewWalletForm),
/* harmony export */   "TokenApprovalForm": () => (/* binding */ TokenApprovalForm),
/* harmony export */   "WalletConfigForm": () => (/* binding */ WalletConfigForm),
/* harmony export */   "WalletWaitForm": () => (/* binding */ WalletWaitForm),
/* harmony export */   "bind": () => (/* binding */ bind),
/* harmony export */   "showSuccess": () => (/* binding */ showSuccess),
/* harmony export */   "slideSwap": () => (/* binding */ slideSwap)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./account */ "./src/js/account.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};










class Forms {
    constructor(formsDiv, cfg) {
        this.formsDiv = formsDiv;
        this.closed = cfg === null || cfg === void 0 ? void 0 : cfg.closed;
        formsDiv.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { this.close(); });
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(formsDiv, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                this.close();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                this.close();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
    }
    /* showForm shows a modal form with a little animation. */
    show(form) {
        return __awaiter(this, void 0, void 0, function* () {
            this.currentForm = form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(...Array.from(this.formsDiv.children));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.formsDiv, form);
            const shift = (this.formsDiv.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    close() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.formsDiv);
        if (this.closed)
            this.closed();
    }
    exit() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
}
/*
 * NewWalletForm should be used with the "newWalletForm" template. The enclosing
 * <form> element should be the first argument of the constructor.
 */
class NewWalletForm {
    constructor(form, success, backFunc) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        if (backFunc) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.goBack);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.goBack, 'click', () => { backFunc(); });
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.walletTabTmpl);
        page.walletTabTmpl.removeAttribute('id');
        // WalletConfigForm will set the global app variable.
        this.subform = new WalletConfigForm(page.walletSettings, true);
        this.walletCfgGuide = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'walletCfgGuide');
        bind(form, page.submitAdd, () => this.submit());
        bind(form, page.oneBttn, () => this.submit());
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            walletstate: (note) => { this.reportWalletState(note.wallet); },
            walletsync: (note) => { if (this.parentSyncer)
                this.parentSyncer((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[note.assetID]); },
            createwallet: (note) => { this.reportCreationUpdate(note); }
        });
    }
    /*
     * reportWalletState should be called when a 'walletstate' notification is
     * received.
     * TODO: Let form classes register for notifications.
     */
    reportWalletState(w) {
        if (this.parentSyncer)
            this.parentSyncer(w);
    }
    /*
     * reportWalletState should be called when a 'createwallet' notification is
     * received.
     */
    reportCreationUpdate(note) {
        if (this.createUpdater)
            this.createUpdater(note);
    }
    createWallet(assetID, walletType, parentForm) {
        return __awaiter(this, void 0, void 0, function* () {
            const createForm = {
                assetID: assetID,
                pass: this.page.newWalletPass.value || '',
                config: this.subform.map(assetID),
                walletType: walletType,
                parentForm: parentForm
            };
            const ani = new _charts__WEBPACK_IMPORTED_MODULE_4__.Wave(this.form, { backgroundColor: true });
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/newwallet', createForm);
            ani.stop();
            return res;
        });
    }
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const newWalletPass = page.newWalletPass;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.newWalletErr);
            const { asset, parentAsset } = this.current;
            const selectedDef = this.current.selectedDef;
            let parentForm;
            let walletType = selectedDef.type;
            if (parentAsset) {
                walletType = asset.token.definition.type;
                parentForm = {
                    assetID: parentAsset.id,
                    config: this.subform.map(parentAsset.id),
                    walletType: selectedDef.type
                };
            }
            // Register the selected asset.
            const res = yield this.createWallet(asset.id, walletType, parentForm);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                this.setError(res.msg);
                return;
            }
            newWalletPass.value = '';
            if (parentAsset)
                yield this.runParentSync();
            else
                this.success(this.current.asset.id);
        });
    }
    /*
     * runParentSync shows a syncing sub-dialog that tracks the parent asset's
     * syncProgress and informs the user that the token wallet will be created
     * after sync is complete.
     */
    runParentSync() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, current: { parentAsset, asset } } = this;
            if (!parentAsset)
                return;
            page.parentSyncPct.textContent = '0';
            page.parentName.textContent = parentAsset.name;
            page.parentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
            page.childName.textContent = asset.name;
            page.childLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mainForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.parentSyncing);
            try {
                yield this.syncParent(parentAsset);
                this.success(this.current.asset.id);
            }
            catch (error) {
                this.setError(error.message || error);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mainForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.parentSyncing);
        });
    }
    /*
     * syncParent monitors the sync progress of a token's parent asset, generating
     * an Error if the token wallet creation does not complete successfully.
     */
    syncParent(parentAsset) {
        const { page, current: { asset } } = this;
        return new Promise((resolve, reject) => {
            // First, check if it's already synced.
            const w = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[parentAsset.id].wallet;
            if (w && w.synced)
                return resolve();
            // Not synced, so create a syncer to update the parent sync pane.
            this.parentSyncer = (w) => {
                if (w.assetID !== parentAsset.id)
                    return;
                page.parentSyncPct.textContent = (w.syncProgress * 100).toFixed(1);
            };
            // Handle the async result.
            this.createUpdater = (note) => {
                if (note.assetID !== asset.id)
                    return;
                switch (note.topic) {
                    case 'QueuedCreationFailed':
                        reject(new Error(`${note.subject}: ${note.details}`));
                        break;
                    case 'QueuedCreationSuccess':
                        resolve();
                        break;
                    default:
                        return;
                }
                this.parentSyncer = null;
                this.createUpdater = null;
            };
        });
    }
    /* setAsset sets the current asset of the NewWalletForm */
    setAsset(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.parseAsset(assetID))
                return; // nothing to change
            const page = this.page;
            const tabs = page.walletTypeTabs;
            const { winfo, asset, parentAsset } = this.current;
            page.assetName.textContent = winfo.name;
            page.newWalletPass.value = '';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tabs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tabs, page.newWalletErr, page.tokenMsgBox);
            this.page.assetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            if (parentAsset) {
                page.tokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                page.tokenParentName.textContent = parentAsset.name;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.tokenMsgBox);
            }
            const pinfo = parentAsset ? parentAsset.info : null;
            const walletDefs = pinfo ? pinfo.availablewallets : winfo.availablewallets ? winfo.availablewallets : [winfo.definition];
            if (walletDefs.length > 1) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tabs);
                for (const wDef of walletDefs) {
                    const tab = page.walletTabTmpl.cloneNode(true);
                    tab.dataset.tooltip = wDef.description;
                    tab.textContent = wDef.tab;
                    tabs.appendChild(tab);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tab, 'click', () => {
                        for (const t of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].kids(tabs))
                            t.classList.remove('selected');
                        tab.classList.add('selected');
                        this.update(wDef);
                    });
                }
                (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().bindTooltips(tabs);
                const first = tabs.firstChild;
                first.classList.add('selected');
            }
            yield this.update(this.current.selectedDef);
            if (asset.walletCreationPending)
                yield this.runParentSync();
        });
    }
    /*
    * parseAsset parses the current data for the asset ID.
    */
    parseAsset(assetID) {
        if (this.current && this.current.asset.id === assetID)
            return false;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const token = asset.token;
        if (!token) {
            if (!asset.info)
                throw Error('this non-token asset has no wallet info!');
            this.current = { asset, winfo: asset.info, selectedDef: asset.info.availablewallets[0] };
            return true;
        }
        const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.assets[token.parentID];
        if (parentAsset.wallet) {
            // If the parent asset already has a wallet, there's no need to configure
            // the parent too. Just configure the token.
            this.current = { asset, winfo: token, selectedDef: token.definition };
            return true;
        }
        if (!parentAsset.info)
            throw Error('this parent has no wallet info!');
        this.current = { asset, parentAsset, winfo: token, selectedDef: parentAsset.info.availablewallets[0] };
        return true;
    }
    update(walletDef) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.current.selectedDef = walletDef;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.walletPassAndSubmitBttn, page.oneBttnBox, page.newWalletPassBox);
            const guideLink = walletDef.guidelink;
            const configOpts = walletDef.configopts || [];
            // If a config represents a wallet's birthday, we update the default
            // selection to the current date if this installation of the client
            // generated a seed.
            configOpts.map((opt) => {
                if (opt.isBirthdayConfig && (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().seedGenTime > 0) {
                    opt.default = toUnixDate(new Date());
                }
                return opt;
            });
            // Either this is a walletDef for a token's uncreated parent asset, or this
            // is the definition for the token.
            let containsRequired = false;
            for (const opt of configOpts) {
                if (opt.required) {
                    containsRequired = true;
                    break;
                }
            }
            const { asset, parentAsset, winfo } = this.current;
            const displayCreateBtn = walletDef.seeded || Boolean(asset.token);
            if (displayCreateBtn && !containsRequired) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.walletSettingsHeader);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.oneBttnBox);
            }
            else if (displayCreateBtn) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletPassAndSubmitBttn, page.walletSettingsHeader);
                page.newWalletPass.value = '';
                page.submitAdd.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_CREATE);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletPassAndSubmitBttn, page.walletSettingsHeader);
                if (!walletDef.noauth)
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.newWalletPassBox);
                page.submitAdd.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ADD);
            }
            if (parentAsset) {
                const parentAndTokenOpts = JSON.parse(JSON.stringify(configOpts));
                // Add the regAsset field to the configurations so proper logos will be displayed
                // next to them, and map can filter them out. The opts are copied here so the originals
                // do not have the regAsset field added to them.
                for (const opt of parentAndTokenOpts)
                    opt.regAsset = parentAsset.id;
                const tokenOpts = winfo.definition.configopts || [];
                if (tokenOpts.length > 0) {
                    const tokenOptsCopy = JSON.parse(JSON.stringify(tokenOpts));
                    for (const opt of tokenOptsCopy)
                        opt.regAsset = asset.id;
                    parentAndTokenOpts.push(...tokenOptsCopy);
                }
                this.subform.update(asset.id, parentAndTokenOpts, false);
            }
            else
                this.subform.update(asset.id, configOpts, false);
            this.setGuideLink(guideLink);
            // A seeded or token wallet is internal to Bison Wallet and as such does
            // not have an external config file to select.
            if (walletDef.seeded || Boolean(this.current.asset.token))
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.subform.fileSelector);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.subform.fileSelector);
            yield this.loadDefaults();
        });
    }
    setGuideLink(guideLink) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.walletCfgGuide);
        if (guideLink !== '') {
            this.walletCfgGuide.href = guideLink;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.walletCfgGuide);
        }
    }
    /* setError sets and shows the in-form error message. */
    setError(errMsg) {
        return __awaiter(this, void 0, void 0, function* () {
            this.page.newWalletErr.textContent = errMsg;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.newWalletErr);
        });
    }
    /*
     * loadDefaults attempts to load the ExchangeWallet configuration from the
     * default wallet config path on the server and will auto-fill the page on
     * the subform if settings are found.
     */
    loadDefaults() {
        return __awaiter(this, void 0, void 0, function* () {
            // No default config files for seeded assets right now.
            const { asset, parentAsset, selectedDef } = this.current;
            if (!selectedDef.configpath)
                return;
            let configID = asset.id;
            if (parentAsset) {
                if (selectedDef.seeded)
                    return;
                configID = parentAsset.id;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/defaultwalletcfg', {
                assetID: configID,
                type: selectedDef.type
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                this.setError(res.msg);
                return;
            }
            this.subform.setLoadedConfig(res.config);
        });
    }
}
let dynamicInputCounter = 0;
/*
 * WalletConfigForm is a dynamically generated sub-form for setting
 * asset-specific wallet configuration options.
*/
class WalletConfigForm {
    constructor(form, sectionize) {
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        this.form = form;
        // A configElement is a div containing an input and its label.
        this.configElements = [];
        // configOpts is the wallet options provided by core.
        this.configOpts = [];
        this.sectionize = sectionize;
        // Get template elements
        this.allSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'allSettings');
        this.dynamicOpts = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'dynamicOpts');
        this.textInputTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'textInput');
        this.textInputTmpl.remove();
        this.dateInputTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'dateInput');
        this.dateInputTmpl.remove();
        this.checkboxTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'checkbox');
        this.checkboxTmpl.remove();
        this.repeatableTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'repeatableInput');
        this.repeatableTmpl.remove();
        this.fileSelector = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'fileSelector');
        this.fileInput = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'fileInput');
        this.errMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'errMsg');
        this.showOther = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'showOther');
        this.showIcon = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'showIcon');
        this.hideIcon = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'hideIcon');
        this.showHideMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'showHideMsg');
        this.otherSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'otherSettings');
        this.loadedSettingsMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'loadedSettingsMsg');
        this.loadedSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'loadedSettings');
        this.defaultSettingsMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'defaultSettingsMsg');
        this.defaultSettings = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(form, 'defaultSettings');
        if (!sectionize)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showOther);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.fileSelector, 'click', () => this.fileInput.click());
        // config file upload
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.fileInput, 'change', () => __awaiter(this, void 0, void 0, function* () { return this.fileInputChanged(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.showOther, 'click', () => {
            this.setOtherSettingsViz(this.hideIcon.classList.contains('d-hide'));
        });
    }
    /*
     * fileInputChanged will read the selected file and attempt to load the
     * configuration settings. All loaded settings will be made visible for
     * inspection by the user.
     */
    fileInputChanged() {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.errMsg);
            if (!this.fileInput.value)
                return;
            const files = this.fileInput.files;
            if (!files || files.length === 0)
                return;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const config = yield files[0].text();
            if (!config)
                return;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/parseconfig', {
                configtext: config
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                this.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.errMsg);
                return;
            }
            if (Object.keys(res.map).length === 0)
                return;
            this.dynamicOpts.append(...this.setConfig(res.map));
            this.reorder(this.dynamicOpts);
            const [loadedOpts, defaultOpts] = [this.loadedSettings.children.length, this.defaultSettings.children.length];
            if (loadedOpts === 0)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.loadedSettings, this.loadedSettingsMsg);
            if (defaultOpts === 0)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.defaultSettings, this.defaultSettingsMsg);
            if (loadedOpts + defaultOpts === 0)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showOther, this.otherSettings);
        });
    }
    addOpt(box, opt, insertAfter, skipRepeatN) {
        var _a;
        let el;
        if (opt.isboolean)
            el = this.checkboxTmpl.cloneNode(true);
        else if (opt.isdate)
            el = this.dateInputTmpl.cloneNode(true);
        else if (opt.repeatable) {
            el = this.repeatableTmpl.cloneNode(true);
            el.classList.add('repeatable');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(el, 'add'), 'click', () => {
                this.addOpt(box, opt, el, true);
            });
            if (!skipRepeatN)
                for (let i = 0; i < (opt.repeatN ? opt.repeatN - 1 : 0); i++)
                    this.addOpt(box, opt, insertAfter, true);
        }
        else
            el = this.textInputTmpl.cloneNode(true);
        const hiddenFields = ((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().extensionWallet(this.assetID)) === null || _a === void 0 ? void 0 : _a.hiddenFields) || [];
        if (hiddenFields.indexOf(opt.key) !== -1)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(el);
        this.configElements.push([opt, el]);
        const input = el.querySelector('input');
        input.dataset.configKey = opt.key;
        // We need to generate a unique ID only for the <input id> => <label for>
        // matching.
        dynamicInputCounter++;
        const elID = 'wcfg-' + String(dynamicInputCounter);
        input.id = elID;
        const label = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'label');
        label.htmlFor = elID; // 'for' attribute, but 'for' is a keyword
        label.prepend(opt.displayname);
        if (opt.regAsset !== undefined) {
            const logo = new window.Image(15, 15);
            logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(opt.regAsset || -1);
            label.prepend(logo);
        }
        if (insertAfter)
            insertAfter.after(el);
        else
            box.appendChild(el);
        if (opt.noecho) {
            input.type = 'password';
            input.autocomplete = 'off';
        }
        if (opt.description)
            label.dataset.tooltip = opt.description;
        if (opt.isboolean)
            input.checked = opt.default;
        else if (opt.isdate) {
            const getMinMaxVal = (minMax) => {
                if (!minMax)
                    return '';
                if (minMax === 'now')
                    return dateToString(new Date());
                return dateToString(new Date(minMax * 1000));
            };
            input.max = getMinMaxVal(opt.max);
            input.min = getMinMaxVal(opt.min);
            const date = opt.default ? new Date(opt.default * 1000) : new Date();
            // UI shows Dates in valueAsDate as UTC, but user interprets local. Set a
            // local date string so the UI displays what the user expects. alt:
            // input.valueAsDate = dateApplyOffset(date)
            input.value = dateToString(date);
        }
        else
            input.value = opt.default !== null ? opt.default : '';
        input.disabled = Boolean(opt.disablewhenactive && this.assetHasActiveOrders);
        return el;
    }
    /*
     * update creates the dynamic form.
     */
    update(assetID, configOpts, activeOrders) {
        this.assetHasActiveOrders = activeOrders;
        this.configElements = [];
        this.configOpts = configOpts || [];
        this.assetID = assetID;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.dynamicOpts, this.defaultSettings, this.loadedSettings);
        // If there are no options, just hide the entire form.
        if (this.configOpts.length === 0)
            return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.form);
        this.setOtherSettingsViz(false);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.loadedSettingsMsg, this.loadedSettings, this.defaultSettingsMsg, this.defaultSettings, this.errMsg);
        const defaultedOpts = [];
        for (const opt of this.configOpts) {
            if (this.sectionize && opt.default !== null)
                defaultedOpts.push(opt);
            else
                this.addOpt(this.dynamicOpts, opt);
        }
        if (defaultedOpts.length) {
            for (const opt of defaultedOpts)
                this.addOpt(this.defaultSettings, opt);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.showOther, this.defaultSettingsMsg, this.defaultSettings);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showOther);
        }
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().bindTooltips(this.allSettings);
        if (this.dynamicOpts.children.length)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.dynamicOpts);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.dynamicOpts);
    }
    /*
     * setOtherSettingsViz sets the visibility of the additional settings section.
     */
    setOtherSettingsViz(visible) {
        if (visible) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.showIcon);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.hideIcon, this.otherSettings);
            this.showHideMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_HIDE_ADDITIONAL_SETTINGS);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.hideIcon, this.otherSettings);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.showIcon);
        this.showHideMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_SHOW_ADDITIONAL_SETTINGS);
    }
    /*
     * setConfig looks for inputs with configOpt keys matching the cfg object, and
     * sets the inputs value to the corresponding cfg value. A list of matching
     * configElements is returned.
     */
    setConfig(cfg) {
        const finds = [];
        const handledRepeatables = {};
        const removes = [];
        for (const r of [...this.configElements]) {
            const [opt, el] = r;
            const v = cfg[opt.key];
            if (v === undefined)
                continue;
            if (opt.repeatable) {
                if (handledRepeatables[opt.key]) {
                    el.remove();
                    removes.push(r);
                    continue;
                }
                handledRepeatables[opt.key] = true;
                const vals = v.split(opt.repeatable);
                const firstVal = vals[0];
                finds.push(el);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'input').value = firstVal;
                // Add repeatN - 1 empty elements to the reconfig form. Add them before
                // the populated inputs just because of the way we're using the
                // insertAfter argument to addOpt.
                for (let i = 1; i < (opt.repeatN || 1); i++)
                    finds.push(this.addOpt(el.parentElement, opt, el, true));
                for (let i = 1; i < vals.length; i++) {
                    const newEl = this.addOpt(el.parentElement, opt, el, true);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(newEl, 'input').value = vals[i];
                    finds.push(newEl);
                }
                continue;
            }
            finds.push(el);
            const input = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'input');
            if (opt.isboolean)
                input.checked = isTruthyString(v);
            else if (opt.isdate) {
                input.value = dateToString(new Date(parseInt(v) * 1000));
                // alt: input.valueAsDate = dateApplyOffset(...)
            }
            else
                input.value = v;
        }
        for (const r of removes) {
            const i = this.configElements.indexOf(r);
            if (i >= 0)
                this.configElements.splice(i, 1);
        }
        return finds;
    }
    /*
     * setLoadedConfig sets the input values for the entries in cfg, and moves
     * them to the loadedSettings box.
     */
    setLoadedConfig(cfg) {
        const finds = this.setConfig(cfg);
        if (!this.sectionize || finds.length === 0)
            return;
        this.loadedSettings.append(...finds);
        this.reorder(this.loadedSettings);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.loadedSettings, this.loadedSettingsMsg);
        if (this.defaultSettings.children.length === 0)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.defaultSettings, this.defaultSettingsMsg);
    }
    /*
     * map reads all inputs and constructs an object from the configOpt keys and
     * values.
     */
    map(assetID) {
        const config = {};
        for (const [opt, el] of this.configElements) {
            const input = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(el, 'input');
            if (opt.regAsset !== undefined && opt.regAsset !== assetID)
                continue;
            if (opt.isboolean && opt.key) {
                config[opt.key] = input.checked ? '1' : '0';
            }
            else if (opt.isdate && opt.key) {
                // Force local time interpretation by appending a time to the date
                // string, otherwise the Date constructor considers it UTC.
                const minDate = input.min ? toUnixDate(new Date(input.min + 'T00:00')) : Number.MIN_SAFE_INTEGER;
                const maxDate = input.max ? toUnixDate(new Date(input.max + 'T00:00')) : Number.MAX_SAFE_INTEGER;
                let date = input.value ? toUnixDate(new Date(input.value + 'T00:00')) : 0;
                if (date < minDate)
                    date = minDate;
                else if (date > maxDate)
                    date = maxDate;
                config[opt.key] = String(date);
            }
            else if (input.value) {
                if (opt.repeatable && config[opt.key])
                    config[opt.key] += opt.repeatable + input.value;
                else
                    config[opt.key] = input.value;
            }
        }
        return config;
    }
    /*
     * reorder sorts the configElements in the box by the order of the
     * server-provided configOpts array.
     */
    reorder(box) {
        const inputs = {};
        box.querySelectorAll('input').forEach((input) => {
            const k = input.dataset.configKey;
            if (!k)
                return; // TS2538
            const els = [];
            for (const [opt, el] of this.configElements)
                if (opt.key === k)
                    els.push(el);
            inputs[k] = els;
        });
        for (const opt of this.configOpts) {
            const els = inputs[opt.key] || [];
            for (const el of els)
                box.append(el);
        }
    }
}
/*
 * ConfirmRegistrationForm should be used with the "confirmRegistrationForm"
 * template.
 */
class ConfirmRegistrationForm {
    constructor(form, success, goBack) {
        this.form = form;
        this.success = success;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        this.certFile = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.goBack, 'click', () => goBack());
        bind(form, this.page.submit, () => this.submitForm());
    }
    setExchange(xc, certFile) {
        this.xc = xc;
        this.certFile = certFile;
        this.page.host.textContent = xc.host;
    }
    setAsset(assetID, tier, fees) {
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const { conversionFactor, unit } = asset.unitInfo.conventional;
        this.bondAssetID = asset.id;
        this.tier = tier;
        this.fees = fees;
        const page = this.page;
        const bondAsset = this.xc.bondAssets[asset.symbol];
        const bondLock = bondAsset.amount * tier * _account__WEBPACK_IMPORTED_MODULE_5__.bondReserveMultiplier;
        const bondLockConventional = bondLock / conversionFactor;
        page.tradingTier.textContent = String(tier);
        page.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
        page.bondLock.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLockConventional);
        page.bondUnit.textContent = unit;
        const r = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.bondLockUSDBox);
        if (r)
            page.bondLockUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLockConventional * r);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.bondLockUSDBox);
        if (fees)
            page.feeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(fees / conversionFactor);
        page.reservesUnit.textContent = unit;
    }
    setFees(assetID, fees) {
        this.fees = fees;
        const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID].unitInfo.conventional.conversionFactor;
        this.page.feeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(fees / conversionFactor);
    }
    /* Form expands into its space quickly from the lower-right as it fades in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(400, prog => {
                form.style.transform = `scale(${prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
                const offset = `${(1 - prog) * 500}px`;
                form.style.top = offset;
                form.style.left = offset;
            });
        });
    }
    /*
     * submitForm is called when the form is submitted.
     */
    submitForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, bondAssetID, xc, certFile, tier } = this;
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[bondAssetID];
            if (!asset) {
                page.regErr.innerText = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_SELECT_WALLET_FOR_FEE_PAYMENT);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.regErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.regErr);
            const bondAsset = xc.bondAssets[asset.wallet.symbol];
            const dexAddr = xc.host;
            let form;
            let url;
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[xc.host] || (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[xc.host].viewOnly) {
                form = {
                    addr: dexAddr,
                    cert: certFile,
                    bond: bondAsset.amount * tier,
                    asset: bondAsset.id
                };
                url = '/api/postbond';
            }
            else {
                form = {
                    host: dexAddr,
                    targetTier: tier,
                    bondAssetID: bondAssetID
                };
                url = '/api/updatebondoptions';
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)(url, form);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.regErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.regErr);
                return;
            }
            this.success();
        });
    }
}
/*
 * FeeAssetSelectionForm should be used with the "regAssetForm" template.
 */
class FeeAssetSelectionForm {
    constructor(form, success) {
        this.form = form;
        this.certFile = '';
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.currentBondTmpl, page.bondAssetTmpl, page.marketTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tradingTierInput, 'input', () => { this.setTier(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tradingTierInput, 'keyup', (e) => { if (e.key === 'Enter')
            this.acceptTier(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.submitTradingTier, 'click', () => { this.acceptTier(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tierUp, 'click', () => { this.incrementTier(true); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.tierDown, 'click', () => { this.incrementTier(false); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.goBackToAssets, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.tradingTierForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.whatsABond, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.assetForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.whatsABondPanel);
        });
        const hideWhatsABond = () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.whatsABondPanel);
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.bondGotIt, 'click', () => { hideWhatsABond(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.whatsABondBack, 'click', () => { hideWhatsABond(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.usePrepaidBond, 'click', () => { this.showPrepaidBondForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ppbGoBack, 'click', () => { this.hidePrepaidBondForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.submitPrepaidBond, 'click', () => { this.submitPrepaidBond(); });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            createwallet: (note) => {
                if (note.topic === 'QueuedCreationSuccess')
                    this.walletCreated(note.assetID);
            }
        });
    }
    setTierError(errMsg) {
        this.page.tradingTierErr.textContent = errMsg;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.tradingTierErr);
    }
    setAssetError(errMsg) {
        this.page.regAssetErr.textContent = errMsg;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.regAssetErr);
    }
    clearErrors() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.regAssetErr, this.page.tradingTierErr);
    }
    setExchange(xc, certFile) {
        this.xc = xc;
        this.certFile = certFile;
        this.assetRows = {};
        this.marketRows = [];
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.assetForm, page.tradingTierForm, page.whatsABondPanel, page.prepaidBonds);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.bondAssets, page.markets);
        this.clearErrors();
        const addBondRow = (assetID, bondAsset) => {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            if (!asset)
                return;
            const { unitInfo: { conventional: { unit, conversionFactor } }, name, symbol } = asset;
            const tr = page.bondAssetTmpl.cloneNode(true);
            page.bondAssets.appendChild(tr);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            tmpl.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            tmpl.name.textContent = name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tr, 'click', () => { this.assetSelected(assetID); });
            tmpl.feeSymbol.textContent = unit;
            const bondSizeConventional = bondAsset.amount / conversionFactor;
            tmpl.feeAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondSizeConventional);
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(fiatRate, tmpl.fiatBox);
            if (fiatRate)
                tmpl.fiatBondAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondSizeConventional * fiatRate);
            this.assetRows[assetID] = { ready: tmpl.ready };
        };
        const addMarketRow = (mkt) => {
            const { baseid: baseID, quoteid: quoteID } = mkt;
            const [b, q] = [(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[quoteID]];
            if (!b || !q)
                return;
            const tr = page.marketTmpl.cloneNode(true);
            page.markets.appendChild(tr);
            const { symbol: baseSymbol, unitInfo: bui } = xc.assets[baseID];
            const { symbol: quoteSymbol, unitInfo: qui } = xc.assets[quoteID];
            for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(tr, '[data-base-ticker]'))
                el.textContent = bui.conventional.unit;
            for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(tr, '[data-quote-ticker]'))
                el.textContent = qui.conventional.unit;
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            tmpl.baseLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(baseSymbol);
            tmpl.quoteLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(quoteSymbol);
            const setTier = (tier) => {
                const { parcelsize: parcelSize, lotsize: lotSize } = mkt;
                const conventionalLotSize = lotSize / bui.conventional.conversionFactor;
                const startingLimit = conventionalLotSize * parcelSize * _account__WEBPACK_IMPORTED_MODULE_5__.perTierBaseParcelLimit * tier;
                const privilegedLimit = conventionalLotSize * parcelSize * _account__WEBPACK_IMPORTED_MODULE_5__.perTierBaseParcelLimit * _account__WEBPACK_IMPORTED_MODULE_5__.parcelLimitScoreMultiplier * tier;
                tmpl.tradeLimitLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(startingLimit);
                tmpl.tradeLimitHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(privilegedLimit);
                const baseFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[baseID];
                if (baseFiatRate) {
                    tmpl.fiatTradeLimitLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(startingLimit * baseFiatRate);
                    tmpl.fiatTradeLimitHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(privilegedLimit * baseFiatRate);
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(baseFiatRate, page.fiatTradeLowBox, page.fiatTradeHighBox);
            };
            setTier((0,_account__WEBPACK_IMPORTED_MODULE_5__.strongTier)(xc.auth) || 1);
            this.marketRows.push({ mkt, tmpl, setTier });
        };
        for (const { symbol, id: assetID } of Object.values(xc.assets || {})) {
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID])
                continue;
            const bondAsset = xc.bondAssets[symbol];
            if (bondAsset)
                addBondRow(assetID, bondAsset);
        }
        for (const mkt of Object.values(xc.markets || {}))
            addMarketRow(mkt);
        // page.host.textContent = xc.host
        page.tradingTierInput.value = xc.auth.targetTier ? String(xc.auth.targetTier) : '1';
        if (this.validBondAssetSelected(xc))
            this.assetSelected(xc.auth.bondAssetID);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
    }
    validBondAssetSelected(xc) {
        if (xc.viewOnly)
            return false;
        const { targetTier, bondAssetID } = xc.auth;
        if (targetTier < 1)
            return false;
        const a = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[bondAssetID];
        return a && Boolean(xc.bondAssets[a.symbol]);
    }
    /*
     * walletCreated should be called when an asynchronous wallet creation
     * completes successfully.
     */
    walletCreated(assetID) {
        const a = this.assetRows[assetID];
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        setReadyMessage(a.ready, asset);
    }
    refresh() {
        this.setExchange(this.xc, this.certFile);
    }
    assetSelected(assetID) {
        this.selectedAssetID = assetID;
        this.setTier();
        const { page: { assetForm, tradingTierForm, tradingTierInput } } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(assetForm);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tradingTierForm);
        tradingTierInput.focus();
    }
    setTier() {
        var _a;
        const { page, xc: { bondAssets }, selectedAssetID: assetID } = this;
        const { symbol, unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const { conventional: { conversionFactor, unit } } = ui;
        const bondAsset = bondAssets[symbol];
        const raw = (_a = page.tradingTierInput.value) !== null && _a !== void 0 ? _a : '';
        if (!raw)
            return;
        const tier = parseInt(raw);
        if (isNaN(tier)) {
            this.setTierError(_locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_TIER_VALUE));
            return;
        }
        page.tradingTierInput.value = String(tier);
        page.bondSizeDisplay.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondAsset.amount, ui);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.tradingTierForm, '[data-tier]'))
            el.textContent = String(tier);
        for (const el of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.tradingTierForm, '[data-bond-asset-ticker]'))
            el.textContent = unit;
        const bondLock = bondAsset.amount * tier * _account__WEBPACK_IMPORTED_MODULE_5__.bondReserveMultiplier;
        page.bondLockDisplay.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLock, ui);
        const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
        if (fiatRate)
            page.fiatLockDisplay.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLock / conversionFactor * fiatRate);
        for (const m of Object.values(this.marketRows))
            m.setTier(tier);
        const currentBondAmts = {};
        for (const [assetIDStr, { wallet }] of Object.entries((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets)) {
            if (!wallet)
                continue;
            const { balance: { bondlocked, bondReserves } } = wallet;
            const bonded = bondlocked + bondReserves;
            if (bonded > 0)
                currentBondAmts[parseInt(assetIDStr)] = bonded;
        }
        const haveLock = Object.keys(currentBondAmts).length > 0;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(haveLock, page.currentBondBox);
        if (haveLock) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.currentBonds);
            for (const [assetIDStr, bondLocked] of Object.entries(currentBondAmts)) {
                const assetID = parseInt(assetIDStr);
                const { unitInfo: ui, symbol, name } = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
                const { conventional: { conversionFactor, unit } } = ui;
                const tr = page.currentBondTmpl.cloneNode(true);
                page.currentBonds.appendChild(tr);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
                tmpl.icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
                tmpl.name.textContent = name;
                tmpl.amt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLocked, ui);
                tmpl.ticker.textContent = unit;
                tmpl.name.textContent = name;
                const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[assetID];
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tmpl.fiatBox);
                if (fiatRate)
                    tmpl.fiatAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bondLocked / conversionFactor * fiatRate);
            }
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(fiatRate, page.fiatLockBox);
    }
    acceptTier() {
        var _a;
        const { page, selectedAssetID: assetID } = this;
        this.clearErrors();
        const raw = (_a = page.tradingTierInput.value) !== null && _a !== void 0 ? _a : '';
        if (!raw)
            return;
        const tier = parseInt(raw);
        if (isNaN(tier)) {
            this.setTierError(_locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_TIER_VALUE));
            return;
        }
        this.success(assetID, tier);
    }
    incrementTier(up) {
        var _a;
        const { page: { tradingTierInput: input } } = this;
        input.value = String(Math.max(1, (parseInt((_a = input.value) !== null && _a !== void 0 ? _a : '') || 1) + (up ? 1 : -1)));
        this.setTier();
    }
    /*
     * Animation to make the elements sort of expand into their space from the
     * bottom as they fade in.
     */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, form } = this;
            const extraMargin = 75;
            const extraTop = 50;
            const regAssetElements = Array.from(page.bondAssets.children);
            form.style.opacity = '0';
            const aniLen = 350;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(aniLen, prog => {
                for (const el of regAssetElements) {
                    el.style.marginTop = `${(1 - prog) * extraMargin}px`;
                    el.style.transform = `scale(${prog})`;
                }
                form.style.opacity = Math.pow(prog, 4).toFixed(1);
                form.style.top = `${(1 - prog) * extraTop}px`;
            }, 'easeOut');
        });
    }
    showPrepaidBondForm() {
        const { page } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.assetForm, page.prepaidBondErr);
        page.prepaidBondCode.value = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.prepaidBonds);
    }
    hidePrepaidBondForm() {
        const { page } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.prepaidBonds);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.assetForm);
    }
    submitPrepaidBond() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, xc: { host } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.prepaidBondErr);
            const code = page.prepaidBondCode.value;
            if (!code) {
                page.prepaidBondErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_VALUE);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.prepaidBondErr);
                return;
            }
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/redeemprepaidbond', { host, code, cert: this.certFile });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.prepaidBondErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.prepaidBondErr);
                return;
            }
            this.success(_registry__WEBPACK_IMPORTED_MODULE_6__.PrepaidBondID, res.tier);
        });
    }
}
/*
 * setReadyMessage sets an asset's status message on the FeeAssetSelectionForm.
 */
function setReadyMessage(el, asset) {
    if (asset.wallet)
        el.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_WALLET_READY);
    else if (asset.walletCreationPending)
        el.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_WALLET_PENDING);
    else
        el.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_SETUP_NEEDED);
    el.classList.remove('readygreen', 'setuporange');
    el.classList.add(asset.wallet ? 'readygreen' : 'setuporange');
}
/*
 * WalletWaitForm is a form used to track the wallet sync status and balance
 * in preparation for posting a bond.
 */
class WalletWaitForm {
    constructor(form, success, goBack) {
        this.form = form;
        this.success = success;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        this.assetID = -1;
        this.progressCache = [];
        this.progressed = false;
        this.funded = false;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.goBack, 'click', () => {
            this.assetID = -1;
            goBack();
        });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            walletstate: (note) => this.reportWalletState(note.wallet),
            walletsync: (note) => {
                if (note.assetID !== this.assetID)
                    return;
                const w = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[note.assetID];
                this.reportProgress(w.synced, w.syncProgress);
            },
            balance: (note) => this.reportBalance(note.assetID)
        });
    }
    /* setExchange sets the exchange for which the fee is being paid. */
    setExchange(xc) {
        this.xc = xc;
    }
    /* setWallet must be called before showing the WalletWaitForm. */
    setWallet(assetID, bondFeeBuffer, tier) {
        this.assetID = assetID;
        this.progressCache = [];
        this.progressed = false;
        this.funded = false;
        this.bondFeeBuffer = bondFeeBuffer; // in case we're a token, parent's balance must cover
        this.parentAssetSynced = false;
        const page = this.page;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
        const { symbol, unitInfo: ui, wallet: { balance: bal, address, synced, syncProgress }, token } = asset;
        this.parentID = token === null || token === void 0 ? void 0 : token.parentID;
        const bondAsset = this.bondAsset = this.xc.bondAssets[symbol];
        const symbolize = (el, asset) => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(el);
            el.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset));
        };
        for (const span of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(this.form, '.unit'))
            symbolize(span, asset);
        page.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
        page.depoAddr.textContent = address;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncUncheck, page.syncCheck, page.balUncheck, page.balCheck, page.syncRemainBox, page.bondCostBreakdown);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balanceBox);
        let bondLock = 2 * bondAsset.amount * tier;
        if (bondFeeBuffer > 0) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.bondCostBreakdown);
            page.bondLockNoFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLock, ui);
            page.bondLockFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondFeeBuffer, ui);
            bondLock += bondFeeBuffer;
            const need = Math.max(bondLock - bal.available + bal.reservesDeficit, 0);
            page.totalForBond.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(need, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sendEnough); // generic msg when no fee info available when
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txFeeBox, page.sendEnoughForToken, page.txFeeBalanceBox); // for tokens
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sendEnoughWithEst); // non-tokens
            if (token) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txFeeBox, page.sendEnoughForToken, page.txFeeBalanceBox);
                const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[token.parentID];
                page.txFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondFeeBuffer, parentAsset.unitInfo);
                page.parentFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondFeeBuffer, parentAsset.unitInfo);
                page.tokenFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(need, ui);
                symbolize(page.txFeeUnit, parentAsset);
                symbolize(page.parentUnit, parentAsset);
                symbolize(page.parentBalUnit, parentAsset);
                page.parentBal.textContent = parentAsset.wallet ? _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(parentAsset.wallet.balance.available, parentAsset.unitInfo) : '0';
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendEnoughWithEst);
            }
            page.fee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bondLock, ui);
        }
        else { // show some generic message with no amounts, this shouldn't happen... show wallet error?
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendEnough);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(synced ? page.syncCheck : syncProgress >= 1 ? page.syncSpinner : page.syncUncheck);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(bal.available >= 2 * bondAsset.amount + bondFeeBuffer ? page.balCheck : page.balUncheck);
        page.progress.textContent = (syncProgress * 100).toFixed(1);
        if (synced) {
            this.progressed = true;
        }
        this.reportBalance(assetID);
    }
    /*
     * reportWalletState sets the progress and balance, ultimately calling the
     * success function if conditions are met.
     */
    reportWalletState(wallet) {
        if (this.progressed && this.funded)
            return;
        if (wallet.assetID === this.assetID)
            this.reportProgress(wallet.synced, wallet.syncProgress);
        this.reportBalance(wallet.assetID);
    }
    /*
     * reportBalance sets the balance display and calls success if we go over the
     * threshold.
     */
    reportBalance(assetID) {
        if (this.funded || this.assetID === -1)
            return;
        if (assetID !== this.assetID && assetID !== this.parentID)
            return;
        const page = this.page;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[this.assetID];
        const avail = asset.wallet.balance.available;
        page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(avail, asset.unitInfo);
        if (asset.token) {
            const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[asset.token.parentID];
            const parentAvail = parentAsset.wallet.balance.available;
            page.parentBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(parentAvail, parentAsset.unitInfo);
            if (parentAvail < this.bondFeeBuffer)
                return;
        }
        // NOTE: when/if we allow one-time bond post (no maintenance) from the UI we
        // may allow to proceed as long as they have enough for tx fees. For now,
        // the balance check box will remain unchecked and we will not proceed.
        if (avail < 2 * this.bondAsset.amount + this.bondFeeBuffer)
            return;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balCheck);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.balUncheck, page.balanceBox, page.sendEnough);
        this.funded = true;
        if (this.progressed)
            this.success();
    }
    /*
     * reportProgress sets the progress display and calls success if we are fully
     * synced.
     */
    reportProgress(synced, prog) {
        const page = this.page;
        if (synced) {
            page.progress.textContent = '100';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncUncheck, page.syncRemainBox, page.syncSpinner);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncCheck);
            this.progressed = true;
            if (this.funded)
                this.success();
            return;
        }
        else if (prog === 1) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncUncheck);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncSpinner);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncSpinner);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncUncheck);
        }
        page.progress.textContent = (prog * 100).toFixed(1);
        if (prog >= 0.999) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncRemaining);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncFinishingUp);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncRemainBox);
            // The final stage of wallet sync process can take a while (it might hang
            // at 99.9% for many minutes, indexing addresses for example), the simplest
            // way to handle it is to keep displaying "finishing up" message until the
            // sync is finished, since we can't reasonably show it progressing over time.
            page.syncFinishingUp.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_WALLET_SYNC_FINISHING_UP);
            return;
        }
        // Before we get to 99.9% the remaining time estimate must be based on more
        // than one progress report. We'll cache up to the last 20 and look at the
        // difference between the first and last to make the estimate.
        const cacheSize = 20;
        const cache = this.progressCache;
        cache.push({
            stamp: new Date().getTime(),
            progress: prog
        });
        if (cache.length < 2) {
            // Can't meaningfully estimate remaining until we have at least 2 data points.
            return;
        }
        while (cache.length > cacheSize)
            cache.shift();
        const [first, last] = [cache[0], cache[cache.length - 1]];
        const progDelta = last.progress - first.progress;
        if (progDelta === 0) {
            // Having no progress for a while likely means we are experiencing network
            // issues, can't reasonably estimate time remaining in this case.
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.syncFinishingUp);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncRemaining);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.syncRemainBox);
        const timeDelta = last.stamp - first.stamp;
        const progRate = progDelta / timeDelta;
        const toGoProg = 1 - last.progress;
        const toGoTime = toGoProg / progRate;
        page.syncRemain.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatDuration(toGoTime);
    }
}
/*
 * AccelerateOrderForm is used to submit an acceleration request for an order.
 */
class AccelerateOrderForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.accelerateSubmit, 'click', () => {
            this.submit();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.submitEarlyConfirm, 'click', () => {
            this.sendAccelerateRequest();
        });
    }
    /*
     * displayEarlyAccelerationMsg displays a message asking for confirmation
     * when the user tries to submit an acceleration transaction very soon after
     * the swap transaction was broadcast, or very soon after a previous
     * acceleration.
     */
    displayEarlyAccelerationMsg() {
        const page = this.page;
        // this is checked in submit, but another check is needed for ts compiler
        if (!this.earlyAcceleration)
            return;
        page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        if (this.earlyAcceleration.wasAcceleration) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.recentAccelerationMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.recentSwapMsg);
            page.recentAccelerationTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.recentSwapMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.recentAccelerationMsg);
            page.recentSwapTime.textContent = `${Math.floor(this.earlyAcceleration.timePast / 60)}`;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.configureAccelerationDiv, page.accelerateErr);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.earlyAccelerationDiv);
    }
    // sendAccelerateRequest makes an accelerate order request to the client
    // backend.
    sendAccelerateRequest() {
        return __awaiter(this, void 0, void 0, function* () {
            const order = this.order;
            const page = this.page;
            const req = {
                orderID: order.id,
                newRate: this.acceleratedRate
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.accelerateMainDiv);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/accelerateorder', req);
            loaded();
            if ((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.accelerateTxID.textContent = res.txID;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.accelerateMainDiv, page.preAccelerateErr, page.accelerateErr);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateMsgDiv, page.accelerateSuccess);
                this.success();
            }
            else {
                page.accelerateErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ORDER_ACCELERATION_ERR_MSG, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.earlyAccelerationDiv);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateErr, page.configureAccelerationDiv);
            }
        });
    }
    // submit is called when the submit button is clicked.
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.earlyAcceleration) {
                this.displayEarlyAccelerationMsg();
            }
            else {
                this.sendAccelerateRequest();
            }
        });
    }
    // refresh should be called before the form is displayed. It makes a
    // preaccelerate request to the client backend and sets up the form
    // based on the results.
    refresh(order) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.order = order;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/preaccelerate', order.id);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.preAccelerateErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ORDER_ACCELERATION_ERR_MSG, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.accelerateMainDiv, page.accelerateSuccess);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateMsgDiv, page.preAccelerateErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.accelerateMsgDiv, page.preAccelerateErr, page.accelerateErr, page.feeEstimateDiv, page.earlyAccelerationDiv);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateMainDiv, page.accelerateSuccess, page.configureAccelerationDiv);
            const preAccelerate = res.preAccelerate;
            this.earlyAcceleration = preAccelerate.earlyAcceleration;
            this.currencyUnit = preAccelerate.suggestedRange.yUnit;
            page.accelerateAvgFeeRate.textContent = `${preAccelerate.swapRate} ${preAccelerate.suggestedRange.yUnit}`;
            page.accelerateCurrentFeeRate.textContent = `${preAccelerate.suggestedRate} ${preAccelerate.suggestedRange.yUnit}`;
            this.acceleratedRate = preAccelerate.suggestedRange.start.y;
            const selected = () => { };
            const roundY = true;
            const updateRate = (_, newY) => { this.acceleratedRate = newY; };
            const rangeHandler = new _opts__WEBPACK_IMPORTED_MODULE_7__.XYRangeHandler(preAccelerate.suggestedRange, preAccelerate.suggestedRange.start.x, {
                updated: updateRate, changed: () => this.updateAccelerationEstimate(), selected, roundY
            });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.sliderContainer);
            page.sliderContainer.appendChild(rangeHandler.control);
            this.updateAccelerationEstimate();
        });
    }
    // updateAccelerationEstimate makes an accelerate estimate request to the
    // client backend using the currently selected rate on the slider, and
    // displays the results.
    updateAccelerationEstimate() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const order = this.order;
            const req = {
                orderID: order.id,
                newRate: this.acceleratedRate
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.sliderContainer);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/accelerationestimate', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.accelerateErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ORDER_ACCELERATION_FEE_ERR_MSG, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.accelerateErr);
                return;
            }
            page.feeRateEstimate.textContent = `${this.acceleratedRate} ${this.currencyUnit}`;
            let assetID;
            let assetSymbol;
            if (order.sell) {
                assetID = order.baseID;
                assetSymbol = order.baseSymbol;
            }
            else {
                assetID = order.quoteID;
                assetSymbol = order.quoteSymbol;
            }
            const unitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().unitInfo(assetID);
            page.feeEstimate.textContent = `${res.fee / unitInfo.conventional.conversionFactor} ${assetSymbol}`;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.feeEstimateDiv);
        });
    }
}
/* DEXAddressForm accepts a DEX address and performs account discovery. */
class DEXAddressForm {
    constructor(form, success, dexToUpdate) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        this.certPicker = new CertificatePicker(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.skipRegistration, 'change', () => this.showOrHideSubmitBttn());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showCustom, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showCustom);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.customBox, page.auth);
        });
        this.knownExchanges = Array.from(page.knownXCs.querySelectorAll('.known-exchange'));
        for (const div of this.knownExchanges) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'click', () => {
                const host = div.dataset.host;
                for (const d of this.knownExchanges)
                    d.classList.remove('selected');
                return this.checkDEX(host);
            });
        }
        bind(form, page.submit, () => this.checkDEX());
        if (dexToUpdate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addDexHdr, page.skipRegistrationBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.updateDexHdr);
            this.dexToUpdate = dexToUpdate;
        }
        this.refresh();
    }
    refresh() {
        const page = this.page;
        page.addr.value = '';
        this.certPicker.clearCertFile();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.err);
        if (this.knownExchanges.length === 0 || this.dexToUpdate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.customBox, page.auth);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showCustom, page.knownXCs, page.pickServerMsg, page.addCustomMsg);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.customBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showCustom);
        }
        for (const div of this.knownExchanges)
            div.classList.remove('selected');
        this.showOrHideSubmitBttn();
    }
    /**
     * Show or hide appPWBox depending on if password is required. Show the
     * submit button if connecting a custom server or password is required).
     */
    showOrHideSubmitBttn() {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.customBox), page.auth);
    }
    skipRegistration() {
        var _a;
        return (_a = this.page.skipRegistration.checked) !== null && _a !== void 0 ? _a : false;
    }
    /* Just a small size tweak and fade-in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(550, prog => {
                form.style.transform = `scale(${0.9 + 0.1 * prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
            }, 'easeOut');
        });
    }
    checkDEX(addr) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.err);
            addr = addr || page.addr.value;
            if (addr === '') {
                page.err.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_EMPTY_DEX_ADDRESS_MSG);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.err);
                return;
            }
            const cert = yield this.certPicker.file();
            const skipRegistration = this.skipRegistration();
            let endpoint, req;
            if (this.dexToUpdate) {
                endpoint = '/api/updatedexhost';
                req = {
                    newHost: addr,
                    cert: cert,
                    oldHost: this.dexToUpdate
                };
            }
            else {
                endpoint = skipRegistration ? '/api/adddex' : '/api/discoveracct';
                req = {
                    addr: addr,
                    cert: cert
                };
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)(endpoint, req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                if (String(res.msg).includes('certificate required')) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.needCert);
                }
                else {
                    page.err.textContent = res.msg;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.err);
                }
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            if (!this.dexToUpdate && (skipRegistration || res.paid || Object.keys(res.xc.auth.pendingBonds).length > 0)) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('markets');
                return;
            }
            this.success(res.xc, cert);
        });
    }
}
/* DiscoverAccountForm performs account discovery for a pre-selected DEX. */
class DiscoverAccountForm {
    constructor(form, addr, success) {
        this.form = form;
        this.addr = addr;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        page.dexHost.textContent = addr;
        bind(form, page.submit, () => this.checkDEX());
    }
    /* Just a small size tweak and fade-in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(550, prog => {
                form.style.transform = `scale(${0.9 + 0.1 * prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
            }, 'easeOut');
        });
    }
    checkDEX() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.err);
            const req = {
                addr: this.addr
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/discoveracct', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.err.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.err);
                return;
            }
            if (res.paid) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('markets');
                return;
            }
            this.success(res.xc);
        });
    }
}
/* LoginForm is used to sign into the app. */
class LoginForm {
    constructor(form, success) {
        this.success = success;
        this.form = form;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        bind(form, page.submit, () => { this.submit(); });
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            login: (note) => { this.handleLoginNote(note); }
        });
    }
    handleLoginNote(n) {
        if (n.details === '')
            return;
        const loginMsg = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel(this.form, 'loaderMsg');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(loginMsg);
        if (loginMsg)
            loginMsg.textContent = n.details;
    }
    focus() {
        this.page.pw.focus();
    }
    refresh() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.errMsg);
        this.page.pw.value = '';
    }
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
            const pw = page.pw.value || '';
            if (pw === '') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.errMsg, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG));
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/login', { pass: pw });
            loaded();
            page.pw.value = '';
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.errMsg, res.msg);
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            res.notes = res.notes || [];
            res.notes.reverse();
            res.pokes = res.pokes || [];
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loggedIn(res.notes, res.pokes);
            this.success();
        });
    }
    /* Just a small size tweak and fade-in. */
    animate() {
        return __awaiter(this, void 0, void 0, function* () {
            const form = this.form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(550, prog => {
                form.style.transform = `scale(${0.9 + 0.1 * prog})`;
                form.style.opacity = String(Math.pow(prog, 4));
            }, 'easeOut');
        });
    }
}
const traitNewAddresser = 1 << 1;
/*
 * DepositAddress displays a deposit address, a QR code, and a button to
 * generate a new address (if supported).
 */
class DepositAddress {
    constructor(form) {
        this.form = form;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.unifiedReceiverTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.newDepAddrBttn, 'click', () => __awaiter(this, void 0, void 0, function* () { this.newDepositAddress(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyAddressBtn, 'click', () => { this.copyAddress(); });
    }
    /* Display a deposit address. */
    setAsset(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            this.assetID = assetID;
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.depositErr, page.depositTokenMsgBox);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            page.depositLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            const wallet = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[assetID];
            page.depositName.textContent = asset.unitInfo.conventional.unit;
            if (asset.token) {
                const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[asset.token.parentID];
                page.depositTokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                page.depositTokenParentName.textContent = parentAsset.name;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.depositTokenMsgBox);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis((wallet.traits & traitNewAddresser) !== 0, page.newDepAddrBttnBox);
            this.setAddress(wallet.address);
        });
    }
    setAddress(addr) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.unifiedReceivers);
        if (addr.startsWith('unified:')) {
            const receivers = JSON.parse(addr.substring('unified:'.length));
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.unifiedReceivers);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unifiedReceivers);
            const defaultReceiverType = 'unified';
            for (const [recvType, recv] of Object.entries(receivers)) {
                const div = page.unifiedReceiverTmpl.cloneNode(true);
                page.unifiedReceivers.appendChild(div);
                div.textContent = recvType;
                div.dataset.type = recvType;
                if (recvType === defaultReceiverType)
                    div.classList.add('selected');
                // tmpl.addr.textContent = recv
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'click', () => {
                    for (const bttn of Array.from(page.unifiedReceivers.children))
                        bttn.classList.toggle('selected', bttn.dataset.type === recvType);
                    this.setCentralAddress(recv);
                });
            }
            addr = receivers.unified;
        }
        this.setCentralAddress(addr);
    }
    setCentralAddress(addr) {
        const page = this.page;
        page.depositAddress.textContent = addr;
        page.qrcode.src = `/generateqrcode?address=${addr}`;
    }
    /* Fetch a new address from the wallet. */
    newDepositAddress() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, assetID, form } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.depositErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/depositaddress', {
                assetID: assetID
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.depositErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.depositErr);
                return;
            }
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletMap[assetID].address = res.address;
            this.setAddress(res.address);
        });
    }
    copyAddress() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            navigator.clipboard.writeText(page.depositAddress.textContent || '')
                .then(() => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.copyAlert);
                setTimeout(() => {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.copyAlert);
                }, 800);
            })
                .catch((reason) => {
                console.error('Unable to copy: ', reason);
            });
        });
    }
}
// AppPassResetForm is used to reset the app apssword using the app seed.
class AppPassResetForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        bind(form, page.resetAppPWSubmitBtn, () => this.resetAppPW());
    }
    resetAppPW() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const newAppPW = page.newAppPassword.value || '';
            const confirmNewAppPW = page.confirmNewAppPassword.value;
            if (newAppPW === '') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.appPWResetErrMsg, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG));
                return;
            }
            if (newAppPW !== confirmNewAppPW) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.appPWResetErrMsg, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_PASSWORD_NOT_MATCH));
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/resetapppassword', {
                newPass: newAppPW,
                seed: page.seedInput.value
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.appPWResetErrMsg, res.msg);
                return;
            }
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.appPWResetErrMsg))
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.appPWResetErrMsg);
            page.appPWResetSuccessMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_PASSWORD_RESET_SUCCESS_MSG);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWResetSuccessMsg);
            setTimeout(() => this.success(), 3000); // allow time to view the message
        });
    }
    focus() {
        this.page.newAppPassword.focus();
    }
    refresh() {
        const page = this.page;
        page.newAppPassword.value = '';
        page.confirmNewAppPassword.value = '';
        page.seedInput.value = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.appPWResetSuccessMsg, page.appPWResetErrMsg);
    }
}
class CertificatePicker {
    constructor(parent) {
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(parent);
        page.selectedCert.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NONE_SELECTED);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.certFile, 'change', () => this.onCertFileChange());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.removeCert, 'click', () => this.clearCertFile());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addCert, 'click', () => page.certFile.click());
    }
    /**
     * onCertFileChange when the input certFile changed, read the file
     * and setting cert name into text of selectedCert to display on the view
     */
    onCertFileChange() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const files = page.certFile.files;
            if (!files || !files.length)
                return;
            page.selectedCert.textContent = files[0].name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.removeCert);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addCert);
        });
    }
    /* clearCertFile cleanup certFile value and selectedCert text */
    clearCertFile() {
        const page = this.page;
        page.certFile.value = '';
        page.selectedCert.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NONE_SELECTED);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.removeCert);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.addCert);
    }
    file() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            if (page.certFile.value) {
                const files = page.certFile.files;
                if (files && files.length) {
                    return yield files[0].text();
                }
            }
            return '';
        });
    }
}
class TokenApprovalForm {
    constructor(parent, success) {
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(parent);
        this.success = success;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.submit, 'click', () => { this.approve(); });
    }
    setAsset(assetID, host) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            this.assetID = assetID;
            this.host = host;
            const tokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const parentID = this.parentID = (_a = tokenAsset.token) === null || _a === void 0 ? void 0 : _a.parentID;
            const { page } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.submissionElements);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txMsg, page.errMsg, page.addressBox, page.balanceBox, page.addressBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.tokenSymbol);
            page.tokenSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(tokenAsset, true));
            const protocolVersion = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().exchanges[host].assets[assetID].version;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/approvetokenfee', {
                assetID: tokenAsset.id,
                version: protocolVersion,
                approving: true
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
            }
            else {
                const { unitInfo: ui, wallet: { address, balance: { available: avail } }, name: parentName } = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[parentID];
                const txFee = this.txFee = res.txFee;
                let feeText = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(txFee, ui)} ${ui.conventional.unit}`;
                const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fiatRatesMap[parentID];
                if (rate) {
                    feeText += ` (${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(txFee, rate, ui)} USD)`;
                }
                page.feeEstimate.textContent = feeText;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balanceBox);
                page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(avail, ui);
                page.parentTicker.textContent = ui.conventional.unit;
                page.parentName.textContent = parentName;
                if (avail < txFee) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.addressBox);
                    page.address.textContent = address;
                }
            }
        });
    }
    /*
     * approve calls the /api/approvetoken endpoint.
     */
    approve() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, assetID, host, success } = this;
            const path = '/api/approvetoken';
            const tokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[assetID];
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)(path, {
                assetID: tokenAsset.id,
                dexAddr: host
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.errMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.errMsg);
                return;
            }
            page.txid.innerText = res.txID;
            const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[tokenAsset.id];
            if (assetExplorer && assetExplorer[(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.net]) {
                page.txid.href = assetExplorer[(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().user.net](res.txID);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.submissionElements, page.balanceBox, page.addressBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txMsg);
            if (success)
                success();
        });
    }
    handleBalanceNote(n) {
        const { page, parentID, txFee } = this;
        if (n.assetID !== parentID)
            return;
        page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(n.balance.available, (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[parentID].unitInfo);
        if (n.balance.available >= txFee) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addressBox);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.errMsg);
    }
}
class CEXConfigurationForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.page.cexSubmit, 'click', () => this.submit());
    }
    setCEX(cexName) {
        this.cexName = cexName;
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_9__.setCexElements)(this.form, cexName);
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cexConfigPrompt, page.cexConnectErrBox, page.cexFormErr);
        page.cexApiKeyInput.value = '';
        page.cexSecretInput.value = '';
        const cexStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().mmStatus.cexes[cexName];
        const connectErr = cexStatus === null || cexStatus === void 0 ? void 0 : cexStatus.connectErr;
        if (connectErr) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexConnectErrBox);
            page.cexConnectErr.textContent = connectErr;
            page.cexApiKeyInput.value = cexStatus.config.apiKey;
            page.cexSecretInput.value = cexStatus.config.apiSecret;
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexConfigPrompt);
        }
    }
    /*
    * handleCEXSubmit handles clicks on the CEX configuration submission button.
    */
    submit() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, cexName, form } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cexFormErr);
            const apiKey = page.cexApiKeyInput.value;
            const apiSecret = page.cexSecretInput.value;
            if (!apiKey || !apiSecret) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexFormErr);
                page.cexFormErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG);
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(form);
            try {
                const res = yield _mmutil__WEBPACK_IMPORTED_MODULE_9__.MM.updateCEXConfig({
                    name: cexName,
                    apiKey: apiKey,
                    apiSecret: apiSecret
                });
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                    throw res;
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchMMStatus();
                this.success(cexName);
            }
            catch (e) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cexFormErr);
                page.cexFormErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_API_ERROR, { msg: (_a = e.msg) !== null && _a !== void 0 ? _a : String(e) });
                return;
            }
            finally {
                loaded();
            }
        });
    }
}
const animationLength = 300;
/* Swap form1 for form2 with an animation. */
function slideSwap(form1, form2) {
    return __awaiter(this, void 0, void 0, function* () {
        const shift = document.body.offsetWidth / 2;
        yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
            form1.style.right = `${progress * shift}px`;
        }, 'easeInHard');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form1);
        form1.style.right = '0';
        form2.style.right = String(-shift);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form2);
        if (form2.querySelector('input')) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(form2, 'input').focus();
        }
        yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
            form2.style.right = `${-shift + progress * shift}px`;
        }, 'easeOutHard');
        form2.style.right = '0';
    });
}
function showSuccess(page, msg) {
    page.successMessage.textContent = msg;
    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, page.checkmarkForm);
    page.checkmarkForm.style.right = '0';
    page.checkmark.style.fontSize = '0px';
    const [startR, startG, startB] = _state__WEBPACK_IMPORTED_MODULE_2__["default"].isDark() ? [223, 226, 225] : [51, 51, 51];
    const [endR, endG, endB] = [16, 163, 16];
    const [diffR, diffG, diffB] = [endR - startR, endG - startG, endB - startB];
    return new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(1200, (prog) => {
        page.checkmark.style.fontSize = `${prog * 80}px`;
        page.checkmark.style.color = `rgb(${startR + prog * diffR}, ${startG + prog * diffG}, ${startB + prog * diffB})`;
    }, 'easeOutElastic');
}
/*
 * bind binds the click and submit events and prevents page reloading on
 * submission.
 */
function bind(form, submitBttn, handler) {
    const wrapper = (e) => {
        if (e.preventDefault)
            e.preventDefault();
        handler(e);
    };
    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(submitBttn, 'click', wrapper);
    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(form, 'submit', wrapper);
}
// isTruthyString will be true if the provided string is recognized as a
// value representing true.
function isTruthyString(s) {
    return s === '1' || s.toLowerCase() === 'true';
}
// toUnixDate converts a javascript date object to a unix date, which is
// the number of *seconds* since the start of the epoch.
function toUnixDate(date) {
    return Math.floor(date.getTime() / 1000);
}
// dateApplyOffset shifts a date by the timezone offset. This is used to make
// UTC dates show the local date. This can be used to prepare a Date so
// toISOString generates a local date string. This is also used to trick an html
// input element to show the local date when setting the valueAsDate field. When
// reading the date back to JS, the value field should be interpreted as local
// using the "T00:00" suffix, or the Date in valueAsDate should be shifted in
// the opposite direction.
function dateApplyOffset(date) {
    return new Date(date.getTime() - date.getTimezoneOffset() * 60 * 1000);
}
// dateToString converts a javascript date object to a YYYY-MM-DD format string,
// in the local time zone.
function dateToString(date) {
    return dateApplyOffset(date).toISOString().split('T')[0];
    // Another common hack:
    // date.toLocaleString("sv-SE", { year: "numeric", month: "2-digit", day: "2-digit" })
}


/***/ }),

/***/ "./src/js/http.ts":
/*!************************!*\
  !*** ./src/js/http.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Errors": () => (/* binding */ Errors),
/* harmony export */   "getJSON": () => (/* binding */ getJSON),
/* harmony export */   "postJSON": () => (/* binding */ postJSON),
/* harmony export */   "requestJSON": () => (/* binding */ requestJSON)
/* harmony export */ });
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/*
 * requestJSON encodes the object and sends the JSON to the specified address.
 */
function requestJSON(method, addr, reqBody) {
    return __awaiter(this, void 0, void 0, function* () {
        try {
            const response = yield window.fetch(addr, {
                method: method,
                headers: new window.Headers({ 'content-type': 'application/json' }),
                // credentials: "same-origin",
                body: reqBody
            });
            if (response.status !== 200) {
                throw response;
            }
            const obj = yield response.json();
            obj.requestSuccessful = true;
            return obj;
        }
        catch (response) {
            response.requestSuccessful = false;
            response.msg = yield response.text();
            return response;
        }
    });
}
/*
 * postJSON sends a POST request with JSON-formatted data and returns the
 * response.
 */
function postJSON(addr, data) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestJSON('POST', addr, JSON.stringify(data));
    });
}
/*
 * getJSON sends a GET request and returns the response.
 */
function getJSON(addr) {
    return __awaiter(this, void 0, void 0, function* () {
        return requestJSON('GET', addr);
    });
}
var Errors;
(function (Errors) {
    Errors[Errors["walletErr"] = 0] = "walletErr";
    Errors[Errors["walletAuthErr"] = 1] = "walletAuthErr";
    Errors[Errors["walletBalanceErr"] = 2] = "walletBalanceErr";
    Errors[Errors["dupeDEXErr"] = 3] = "dupeDEXErr";
    Errors[Errors["assetSupportErr"] = 4] = "assetSupportErr";
    Errors[Errors["registerErr"] = 5] = "registerErr";
    Errors[Errors["signatureErr"] = 6] = "signatureErr";
    Errors[Errors["zeroFeeErr"] = 7] = "zeroFeeErr";
    Errors[Errors["feeMismatchErr"] = 8] = "feeMismatchErr";
    Errors[Errors["feeSendErr"] = 9] = "feeSendErr";
    Errors[Errors["passwordErr"] = 10] = "passwordErr";
    Errors[Errors["emptyHostErr"] = 11] = "emptyHostErr";
    Errors[Errors["connectionErr"] = 12] = "connectionErr";
    Errors[Errors["acctKeyErr"] = 13] = "acctKeyErr";
    Errors[Errors["unknownOrderErr"] = 14] = "unknownOrderErr";
    Errors[Errors["orderParamsErr"] = 15] = "orderParamsErr";
    Errors[Errors["dbErr"] = 16] = "dbErr";
    Errors[Errors["authErr"] = 17] = "authErr";
    Errors[Errors["connectWalletErr"] = 18] = "connectWalletErr";
    Errors[Errors["missingWalletErr"] = 19] = "missingWalletErr";
    Errors[Errors["encryptionErr"] = 20] = "encryptionErr";
    Errors[Errors["decodeErr"] = 21] = "decodeErr";
    Errors[Errors["accountVerificationErr"] = 22] = "accountVerificationErr";
    Errors[Errors["accountProofErr"] = 23] = "accountProofErr";
    Errors[Errors["parseKeyErr"] = 24] = "parseKeyErr";
    Errors[Errors["marketErr"] = 25] = "marketErr";
    Errors[Errors["addressParseErr"] = 26] = "addressParseErr";
    Errors[Errors["addrErr"] = 27] = "addrErr";
    Errors[Errors["fileReadErr"] = 28] = "fileReadErr";
    Errors[Errors["unknownDEXErr"] = 29] = "unknownDEXErr";
    Errors[Errors["accountRetrieveErr"] = 30] = "accountRetrieveErr";
    Errors[Errors["accountDisableErr"] = 31] = "accountDisableErr";
    Errors[Errors["suspendedAcctErr"] = 32] = "suspendedAcctErr";
    Errors[Errors["existenceCheckErr"] = 33] = "existenceCheckErr";
    Errors[Errors["createWalletErr"] = 34] = "createWalletErr";
    Errors[Errors["activeOrdersErr"] = 35] = "activeOrdersErr";
    Errors[Errors["newAddrErr"] = 36] = "newAddrErr";
})(Errors || (Errors = {}));


/***/ }),

/***/ "./src/js/init.ts":
/*!************************!*\
  !*** ./src/js/init.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ InitPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};







/*
 * InitPage is the page handler for the /init view. InitPage is essentially a
 * form handler. There are no non-form elements on /init. InitPage additionally
 * has a role caching the initialization password. A couple of notes about
 * InitPage.
 *   1) There is no going backwards. Once you set a password, you can't go back
 *      to the password form. If you refresh, you won't end up on /init, so
 *      won't have access to the QuickConfigForm or SeedBackupForm . Once you
 *      submit your auto-config choices, you can't change them. This has
 *      implications for coding and UI. There are no "go back" or "close form"
 *      elements.
 *   2) The user can preclude auto-config and seed backup by clicking an
 *      available header link after password init, e.g. Wallets, in the page
 *      header. NOTE: Regardless of what the user does after setting the app
 *      pass, they will receive a notification reminding them to back up their
 *      seed. Perhaps it would be better to somehow delay that message until
 *      they choose to ignore the seed backup dialog, but having more reminders
 *      is also okay.
 */
class InitPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body) {
        super();
        this.body = body;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.initForm = new AppInitForm(page.appPWForm, (pw, hosts, mnemonic) => { this.appInited(pw, hosts, mnemonic); });
        this.quickConfigForm = new QuickConfigForm(page.quickConfigForm, () => this.quickConfigDone());
        this.seedBackupForm = new SeedBackupForm(page.seedBackupForm, () => this.seedBackedUp());
    }
    appInited(pw, hosts, mnemonic) {
        return __awaiter(this, void 0, void 0, function* () {
            this.mnemonic = mnemonic;
            const page = this.page;
            yield this.quickConfigForm.update(pw, hosts);
            if (mnemonic)
                this.seedBackupForm.update(mnemonic);
            (0,_forms__WEBPACK_IMPORTED_MODULE_4__.slideSwap)(page.appPWForm, page.quickConfigForm);
        });
    }
    quickConfigDone() {
        if (!this.mnemonic)
            (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('wallets');
        else
            (0,_forms__WEBPACK_IMPORTED_MODULE_4__.slideSwap)(this.page.quickConfigForm, this.page.seedBackupForm);
    }
    seedBackedUp() {
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loadPage('wallets');
    }
}
/*
 * The AppInitForm handles the form that sets the app password, accepts an
 * optional seed, and initializes the app.
 */
class AppInitForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.appPWSubmit, () => this.setAppPass());
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.toggleSeedInput, () => {
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.seedInputBox)) {
                page.toggleSeedInputIcon.classList.remove('ico-plus');
                page.toggleSeedInputIcon.classList.add('ico-minus');
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.seedInputBox);
            }
            else {
                page.toggleSeedInputIcon.classList.remove('ico-minus');
                page.toggleSeedInputIcon.classList.add('ico-plus');
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.seedInputBox);
            }
        });
    }
    /* Set the application password. Attached to form submission. */
    setAppPass() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.appPWErrMsg);
            const pw = page.appPW.value || '';
            const pwAgain = page.appPWAgain.value;
            if (pw === '') {
                page.appPWErrMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_PASS_ERROR_MSG);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWErrMsg);
                return;
            }
            if (pw !== pwAgain) {
                page.appPWErrMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_PASSWORD_NOT_MATCH);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWErrMsg);
                return;
            }
            page.appPW.value = '';
            page.appPWAgain.value = '';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.form);
            // const seed = page.seedInput.value?.replace(/\s+/g, '') // strip whitespace
            const seed = (_a = page.seedInput.value) !== null && _a !== void 0 ? _a : '';
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/init', {
                pass: pw,
                seed: seed
            });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res)) {
                page.appPWErrMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.appPWErrMsg);
                return;
            }
            this.success(pw, res.hosts, res.mnemonic);
        });
    }
}
let rowIDCounter = 0;
/*
 * QuickConfigForm handles the form that allows users to quickly configure
 * view-only servers and native wallets (that don't require any configuration).
 */
class QuickConfigForm {
    constructor(form, success) {
        this.form = form;
        this.success = success;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.qcServerTmpl, page.qcWalletTmpl);
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.quickConfigSubmit, () => { this.submit(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.qcErrAck, () => { this.success(); });
    }
    update(pw, hosts) {
        return __awaiter(this, void 0, void 0, function* () {
            this.pw = pw;
            const page = this.page;
            this.servers = [];
            for (const host of hosts) {
                const row = page.qcServerTmpl.cloneNode(true);
                page.qcServersBox.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                rowIDCounter++;
                const rowID = `qcsrow${rowIDCounter}`;
                row.htmlFor = rowID;
                tmpl.checkbox.id = rowID;
                tmpl.host.textContent = host;
                this.servers.push({ host, checkbox: tmpl.checkbox });
            }
            const u = yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser();
            this.wallets = [];
            for (const a of Object.values(u.assets)) {
                if (a.token)
                    continue;
                const winfo = a.info;
                let autoConfigurable = null;
                for (const wDef of winfo.availablewallets) {
                    if (!wDef.seeded)
                        continue;
                    if (wDef.configopts && wDef.configopts.some((opt) => opt.required))
                        continue;
                    autoConfigurable = wDef;
                    break;
                }
                if (!autoConfigurable)
                    continue;
                const row = page.qcWalletTmpl.cloneNode(true);
                page.qcWalletsBox.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                rowIDCounter++;
                const rowID = `qcwrow${rowIDCounter}`;
                row.htmlFor = rowID;
                tmpl.checkbox.id = rowID;
                tmpl.icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(a.symbol);
                tmpl.name.textContent = a.name;
                this.wallets.push({
                    asset: a,
                    type: autoConfigurable.type,
                    checkbox: tmpl.checkbox
                });
            }
        });
    }
    submit() {
        return __awaiter(this, void 0, void 0, function* () {
            const [failedHosts, failedWallets] = [[], []];
            const ani = new _charts__WEBPACK_IMPORTED_MODULE_5__.Wave(this.form, { backgroundColor: true, message: '...' });
            ani.opts.message = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ADDING_SERVERS);
            const connectServer = (srvRow) => __awaiter(this, void 0, void 0, function* () {
                if (!srvRow.checkbox.checked)
                    return;
                const req = {
                    addr: srvRow.host,
                    appPW: this.pw
                };
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/adddex', req); // DRAFT NOTE: ignore errors ok?
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                    failedHosts.push(srvRow.host);
            });
            yield Promise.all(this.servers.map(connectServer));
            ani.opts.message = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_CREATING_WALLETS);
            const createWallet = (walletRow) => __awaiter(this, void 0, void 0, function* () {
                var _a;
                const { asset: a, type, checkbox } = walletRow;
                if (!checkbox.checked)
                    return;
                const config = {};
                const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().walletDefinition(a.id, type);
                for (const opt of ((_a = walletDef.configopts) !== null && _a !== void 0 ? _a : [])) {
                    if (!opt.default)
                        continue;
                    if (opt.isboolean) {
                        config[opt.key] = opt.default ? '1' : '0';
                        continue;
                    }
                    if (opt.repeatable && config[opt.key])
                        config[opt.key] += opt.repeatable + opt.default;
                    else
                        config[opt.key] = String(opt.default);
                }
                const createForm = {
                    assetID: a.id,
                    appPass: this.pw,
                    config: config,
                    walletType: type
                };
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/newwallet', createForm);
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                    failedWallets.push(a.name);
            });
            yield Promise.all(this.wallets.map(createWallet));
            ani.stop();
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().fetchUser(); // Calls updateMenuItemsDisplay internally
            if (failedWallets.length + failedHosts.length === 0)
                return this.success();
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qcChoices);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.qcErrors);
            if (failedHosts.length) {
                for (const host of failedHosts) {
                    page.qcServerErrorList.appendChild(document.createTextNode(host));
                    page.qcServerErrorList.appendChild(document.createElement('br'));
                }
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qcServerErrors);
            if (failedWallets.length) {
                for (const name of failedWallets) {
                    page.qcWalletErrorList.appendChild(document.createTextNode(name));
                    page.qcWalletErrorList.appendChild(document.createElement('br'));
                }
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qcWalletErrors);
        });
    }
}
/*
 * SeedBackupForm handles the form that allows the user to back up their seed
 * during initialization.
 */
class SeedBackupForm {
    constructor(form, success) {
        this.form = form;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(form);
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.seedAck, () => success());
        (0,_forms__WEBPACK_IMPORTED_MODULE_4__.bind)(form, page.showSeed, () => this.showSeed());
    }
    update(mnemonic) {
        this.mnemonic = mnemonic;
    }
    showSeed() {
        const page = this.page;
        page.mnemonic.textContent = this.mnemonic; // `${words.slice(0, 5).join(' ')}\n${words.slice(5, 10).join(' ')}\n${words.slice(10,15).join(' ')}`
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sbWanna);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sbSeed);
    }
}


/***/ }),

/***/ "./src/js/locales.ts":
/*!***************************!*\
  !*** ./src/js/locales.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ID_ACCOUNT_DISABLED_MSG": () => (/* binding */ ID_ACCOUNT_DISABLED_MSG),
/* harmony export */   "ID_ACCT_UNDEFINED": () => (/* binding */ ID_ACCT_UNDEFINED),
/* harmony export */   "ID_ACTIVE_ORDERS_ERR_MSG": () => (/* binding */ ID_ACTIVE_ORDERS_ERR_MSG),
/* harmony export */   "ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG": () => (/* binding */ ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG),
/* harmony export */   "ID_ADD": () => (/* binding */ ID_ADD),
/* harmony export */   "ID_ADDED": () => (/* binding */ ID_ADDED),
/* harmony export */   "ID_ADDING_SERVERS": () => (/* binding */ ID_ADDING_SERVERS),
/* harmony export */   "ID_API_ERROR": () => (/* binding */ ID_API_ERROR),
/* harmony export */   "ID_ARCHIVED_RECORDS_PATH": () => (/* binding */ ID_ARCHIVED_RECORDS_PATH),
/* harmony export */   "ID_ARCHIVED_SETTINGS": () => (/* binding */ ID_ARCHIVED_SETTINGS),
/* harmony export */   "ID_AVAILABLE": () => (/* binding */ ID_AVAILABLE),
/* harmony export */   "ID_AVAILABLE_TITLE": () => (/* binding */ ID_AVAILABLE_TITLE),
/* harmony export */   "ID_BONDED": () => (/* binding */ ID_BONDED),
/* harmony export */   "ID_BOND_RESERVES": () => (/* binding */ ID_BOND_RESERVES),
/* harmony export */   "ID_BOND_RESERVES_MSG": () => (/* binding */ ID_BOND_RESERVES_MSG),
/* harmony export */   "ID_BOOKED": () => (/* binding */ ID_BOOKED),
/* harmony export */   "ID_BOTTYPE_ARB_MM": () => (/* binding */ ID_BOTTYPE_ARB_MM),
/* harmony export */   "ID_BOTTYPE_BASIC_MM": () => (/* binding */ ID_BOTTYPE_BASIC_MM),
/* harmony export */   "ID_BOTTYPE_SIMPLE_ARB": () => (/* binding */ ID_BOTTYPE_SIMPLE_ARB),
/* harmony export */   "ID_BROWSER_NTFN_BONDS": () => (/* binding */ ID_BROWSER_NTFN_BONDS),
/* harmony export */   "ID_BROWSER_NTFN_CONNECTIONS": () => (/* binding */ ID_BROWSER_NTFN_CONNECTIONS),
/* harmony export */   "ID_BROWSER_NTFN_ENABLED": () => (/* binding */ ID_BROWSER_NTFN_ENABLED),
/* harmony export */   "ID_BROWSER_NTFN_MATCHES": () => (/* binding */ ID_BROWSER_NTFN_MATCHES),
/* harmony export */   "ID_BROWSER_NTFN_ORDERS": () => (/* binding */ ID_BROWSER_NTFN_ORDERS),
/* harmony export */   "ID_BUY": () => (/* binding */ ID_BUY),
/* harmony export */   "ID_BUYING": () => (/* binding */ ID_BUYING),
/* harmony export */   "ID_CALCULATING": () => (/* binding */ ID_CALCULATING),
/* harmony export */   "ID_CANCELED": () => (/* binding */ ID_CANCELED),
/* harmony export */   "ID_CANCELING": () => (/* binding */ ID_CANCELING),
/* harmony export */   "ID_CANDLES_LOADING": () => (/* binding */ ID_CANDLES_LOADING),
/* harmony export */   "ID_CEXBALANCE_ERR": () => (/* binding */ ID_CEXBALANCE_ERR),
/* harmony export */   "ID_CHANGE_WALLET_TYPE": () => (/* binding */ ID_CHANGE_WALLET_TYPE),
/* harmony export */   "ID_COMPLETE": () => (/* binding */ ID_COMPLETE),
/* harmony export */   "ID_CONFIRMATIONS": () => (/* binding */ ID_CONFIRMATIONS),
/* harmony export */   "ID_CONNECTED": () => (/* binding */ ID_CONNECTED),
/* harmony export */   "ID_CONNECTION_FAILED": () => (/* binding */ ID_CONNECTION_FAILED),
/* harmony export */   "ID_CONNECT_WALLET_ERR_MSG": () => (/* binding */ ID_CONNECT_WALLET_ERR_MSG),
/* harmony export */   "ID_CREATE": () => (/* binding */ ID_CREATE),
/* harmony export */   "ID_CREATE_ASSET_WALLET_MSG": () => (/* binding */ ID_CREATE_ASSET_WALLET_MSG),
/* harmony export */   "ID_CREATING_WALLETS": () => (/* binding */ ID_CREATING_WALLETS),
/* harmony export */   "ID_DEFAULT": () => (/* binding */ ID_DEFAULT),
/* harmony export */   "ID_DELETE_ARCHIVED_RECORDS_RESULT": () => (/* binding */ ID_DELETE_ARCHIVED_RECORDS_RESULT),
/* harmony export */   "ID_DEPTH_LOADING": () => (/* binding */ ID_DEPTH_LOADING),
/* harmony export */   "ID_DEX_DISABLED_MSG": () => (/* binding */ ID_DEX_DISABLED_MSG),
/* harmony export */   "ID_DISABLED_MSG": () => (/* binding */ ID_DISABLED_MSG),
/* harmony export */   "ID_DISABLE_ACCOUNT": () => (/* binding */ ID_DISABLE_ACCOUNT),
/* harmony export */   "ID_DISCONNECTED": () => (/* binding */ ID_DISCONNECTED),
/* harmony export */   "ID_DISCOVERED": () => (/* binding */ ID_DISCOVERED),
/* harmony export */   "ID_EMPTY_DEX_ADDRESS_MSG": () => (/* binding */ ID_EMPTY_DEX_ADDRESS_MSG),
/* harmony export */   "ID_ENABLE_ACCOUNT": () => (/* binding */ ID_ENABLE_ACCOUNT),
/* harmony export */   "ID_EPOCH": () => (/* binding */ ID_EPOCH),
/* harmony export */   "ID_ESTIMATE_UNAVAILABLE": () => (/* binding */ ID_ESTIMATE_UNAVAILABLE),
/* harmony export */   "ID_EXECUTED": () => (/* binding */ ID_EXECUTED),
/* harmony export */   "ID_FEE_BALANCE": () => (/* binding */ ID_FEE_BALANCE),
/* harmony export */   "ID_HIDE_ADDITIONAL_SETTINGS": () => (/* binding */ ID_HIDE_ADDITIONAL_SETTINGS),
/* harmony export */   "ID_IMMATURE": () => (/* binding */ ID_IMMATURE),
/* harmony export */   "ID_IMMATURE_BAL_MSG": () => (/* binding */ ID_IMMATURE_BAL_MSG),
/* harmony export */   "ID_IMMATURE_TITLE": () => (/* binding */ ID_IMMATURE_TITLE),
/* harmony export */   "ID_INVALID_ADDRESS_MSG": () => (/* binding */ ID_INVALID_ADDRESS_MSG),
/* harmony export */   "ID_INVALID_CERTIFICATE": () => (/* binding */ ID_INVALID_CERTIFICATE),
/* harmony export */   "ID_INVALID_COMPS_VALUE": () => (/* binding */ ID_INVALID_COMPS_VALUE),
/* harmony export */   "ID_INVALID_DATE_ERR_MSG": () => (/* binding */ ID_INVALID_DATE_ERR_MSG),
/* harmony export */   "ID_INVALID_TIER_VALUE": () => (/* binding */ ID_INVALID_TIER_VALUE),
/* harmony export */   "ID_INVALID_VALUE": () => (/* binding */ ID_INVALID_VALUE),
/* harmony export */   "ID_KEEP_WALLET_PASS": () => (/* binding */ ID_KEEP_WALLET_PASS),
/* harmony export */   "ID_KEEP_WALLET_TYPE": () => (/* binding */ ID_KEEP_WALLET_TYPE),
/* harmony export */   "ID_LIMIT_ORDER": () => (/* binding */ ID_LIMIT_ORDER),
/* harmony export */   "ID_LIMIT_ORDER_IMMEDIATE_TIF": () => (/* binding */ ID_LIMIT_ORDER_IMMEDIATE_TIF),
/* harmony export */   "ID_LOCKED": () => (/* binding */ ID_LOCKED),
/* harmony export */   "ID_LOCKED_BAL_MSG": () => (/* binding */ ID_LOCKED_BAL_MSG),
/* harmony export */   "ID_LOCKED_BOND_BAL_MSG": () => (/* binding */ ID_LOCKED_BOND_BAL_MSG),
/* harmony export */   "ID_LOCKED_ORDER_BAL_MSG": () => (/* binding */ ID_LOCKED_ORDER_BAL_MSG),
/* harmony export */   "ID_LOCKED_SWAPPING_BAL_MSG": () => (/* binding */ ID_LOCKED_SWAPPING_BAL_MSG),
/* harmony export */   "ID_LOCKED_TITLE": () => (/* binding */ ID_LOCKED_TITLE),
/* harmony export */   "ID_LOT": () => (/* binding */ ID_LOT),
/* harmony export */   "ID_LOTS": () => (/* binding */ ID_LOTS),
/* harmony export */   "ID_MAKER": () => (/* binding */ ID_MAKER),
/* harmony export */   "ID_MARKET_ORDER": () => (/* binding */ ID_MARKET_ORDER),
/* harmony export */   "ID_MATCH_BUFFER": () => (/* binding */ ID_MATCH_BUFFER),
/* harmony export */   "ID_MATCH_STATUS_COMPLETE": () => (/* binding */ ID_MATCH_STATUS_COMPLETE),
/* harmony export */   "ID_MATCH_STATUS_MAKER_REDEEMED": () => (/* binding */ ID_MATCH_STATUS_MAKER_REDEEMED),
/* harmony export */   "ID_MATCH_STATUS_MAKER_SWAP_CAST": () => (/* binding */ ID_MATCH_STATUS_MAKER_SWAP_CAST),
/* harmony export */   "ID_MATCH_STATUS_NEWLY_MATCHED": () => (/* binding */ ID_MATCH_STATUS_NEWLY_MATCHED),
/* harmony export */   "ID_MATCH_STATUS_REDEEM_PENDING": () => (/* binding */ ID_MATCH_STATUS_REDEEM_PENDING),
/* harmony export */   "ID_MATCH_STATUS_REDEMPTION_CONFIRMED": () => (/* binding */ ID_MATCH_STATUS_REDEMPTION_CONFIRMED),
/* harmony export */   "ID_MATCH_STATUS_REDEMPTION_SENT": () => (/* binding */ ID_MATCH_STATUS_REDEMPTION_SENT),
/* harmony export */   "ID_MATCH_STATUS_REFUNDED": () => (/* binding */ ID_MATCH_STATUS_REFUNDED),
/* harmony export */   "ID_MATCH_STATUS_REFUND_PENDING": () => (/* binding */ ID_MATCH_STATUS_REFUND_PENDING),
/* harmony export */   "ID_MATCH_STATUS_REVOKED": () => (/* binding */ ID_MATCH_STATUS_REVOKED),
/* harmony export */   "ID_MATCH_STATUS_TAKER_SWAP_CAST": () => (/* binding */ ID_MATCH_STATUS_TAKER_SWAP_CAST),
/* harmony export */   "ID_MAX": () => (/* binding */ ID_MAX),
/* harmony export */   "ID_MISSING_CEX_CREDS": () => (/* binding */ ID_MISSING_CEX_CREDS),
/* harmony export */   "ID_NEW_WALLET_PASS": () => (/* binding */ ID_NEW_WALLET_PASS),
/* harmony export */   "ID_NEW_WALLET_SUCCESS": () => (/* binding */ ID_NEW_WALLET_SUCCESS),
/* harmony export */   "ID_NONE_SELECTED": () => (/* binding */ ID_NONE_SELECTED),
/* harmony export */   "ID_NOT_SUPPORTED": () => (/* binding */ ID_NOT_SUPPORTED),
/* harmony export */   "ID_NO_APP_PASS_ERROR_MSG": () => (/* binding */ ID_NO_APP_PASS_ERROR_MSG),
/* harmony export */   "ID_NO_ARCHIVED_RECORDS": () => (/* binding */ ID_NO_ARCHIVED_RECORDS),
/* harmony export */   "ID_NO_ASSET_WALLET": () => (/* binding */ ID_NO_ASSET_WALLET),
/* harmony export */   "ID_NO_BOTTYPE": () => (/* binding */ ID_NO_BOTTYPE),
/* harmony export */   "ID_NO_CEX": () => (/* binding */ ID_NO_CEX),
/* harmony export */   "ID_NO_CODE_PROVIDED": () => (/* binding */ ID_NO_CODE_PROVIDED),
/* harmony export */   "ID_NO_MATCH": () => (/* binding */ ID_NO_MATCH),
/* harmony export */   "ID_NO_PASS_ERROR_MSG": () => (/* binding */ ID_NO_PASS_ERROR_MSG),
/* harmony export */   "ID_NO_PLACEMENTS": () => (/* binding */ ID_NO_PLACEMENTS),
/* harmony export */   "ID_NO_WALLET": () => (/* binding */ ID_NO_WALLET),
/* harmony export */   "ID_NO_WALLET_MSG": () => (/* binding */ ID_NO_WALLET_MSG),
/* harmony export */   "ID_NO_ZERO": () => (/* binding */ ID_NO_ZERO),
/* harmony export */   "ID_NO_ZERO_QUANTITY": () => (/* binding */ ID_NO_ZERO_QUANTITY),
/* harmony export */   "ID_NO_ZERO_RATE": () => (/* binding */ ID_NO_ZERO_RATE),
/* harmony export */   "ID_OFF": () => (/* binding */ ID_OFF),
/* harmony export */   "ID_OPEN_WALLET_ERR_MSG": () => (/* binding */ ID_OPEN_WALLET_ERR_MSG),
/* harmony export */   "ID_ORDER": () => (/* binding */ ID_ORDER),
/* harmony export */   "ID_ORDER_ACCELERATION_ERR_MSG": () => (/* binding */ ID_ORDER_ACCELERATION_ERR_MSG),
/* harmony export */   "ID_ORDER_ACCELERATION_FEE_ERR_MSG": () => (/* binding */ ID_ORDER_ACCELERATION_FEE_ERR_MSG),
/* harmony export */   "ID_ORDER_BUTTON_BUY_BALANCE_ERROR": () => (/* binding */ ID_ORDER_BUTTON_BUY_BALANCE_ERROR),
/* harmony export */   "ID_ORDER_BUTTON_QTY_ERROR": () => (/* binding */ ID_ORDER_BUTTON_QTY_ERROR),
/* harmony export */   "ID_ORDER_BUTTON_QTY_RATE_ERROR": () => (/* binding */ ID_ORDER_BUTTON_QTY_RATE_ERROR),
/* harmony export */   "ID_ORDER_BUTTON_SELL_BALANCE_ERROR": () => (/* binding */ ID_ORDER_BUTTON_SELL_BALANCE_ERROR),
/* harmony export */   "ID_ORDER_PREVIEW": () => (/* binding */ ID_ORDER_PREVIEW),
/* harmony export */   "ID_ORDER_SUBMITTING": () => (/* binding */ ID_ORDER_SUBMITTING),
/* harmony export */   "ID_PASSWORD_NOT_MATCH": () => (/* binding */ ID_PASSWORD_NOT_MATCH),
/* harmony export */   "ID_PASSWORD_RESET_SUCCESS_MSG": () => (/* binding */ ID_PASSWORD_RESET_SUCCESS_MSG),
/* harmony export */   "ID_PENDING": () => (/* binding */ ID_PENDING),
/* harmony export */   "ID_READY": () => (/* binding */ ID_READY),
/* harmony export */   "ID_RECONFIG_SUCCESS": () => (/* binding */ ID_RECONFIG_SUCCESS),
/* harmony export */   "ID_REFUND_IMMINENT": () => (/* binding */ ID_REFUND_IMMINENT),
/* harmony export */   "ID_REFUND_WILL_HAPPEN_AFTER": () => (/* binding */ ID_REFUND_WILL_HAPPEN_AFTER),
/* harmony export */   "ID_REGISTRATION_FEE_SUCCESS": () => (/* binding */ ID_REGISTRATION_FEE_SUCCESS),
/* harmony export */   "ID_RESCAN_STARTED": () => (/* binding */ ID_RESCAN_STARTED),
/* harmony export */   "ID_RESERVES_DEFICIT": () => (/* binding */ ID_RESERVES_DEFICIT),
/* harmony export */   "ID_RESERVES_DEFICIT_MSG": () => (/* binding */ ID_RESERVES_DEFICIT_MSG),
/* harmony export */   "ID_REVOKED": () => (/* binding */ ID_REVOKED),
/* harmony export */   "ID_SELECT_WALLET_FOR_FEE_PAYMENT": () => (/* binding */ ID_SELECT_WALLET_FOR_FEE_PAYMENT),
/* harmony export */   "ID_SELL": () => (/* binding */ ID_SELL),
/* harmony export */   "ID_SELLING": () => (/* binding */ ID_SELLING),
/* harmony export */   "ID_SEND_SUCCESS": () => (/* binding */ ID_SEND_SUCCESS),
/* harmony export */   "ID_SETTLING": () => (/* binding */ ID_SETTLING),
/* harmony export */   "ID_SETUP_NEEDED": () => (/* binding */ ID_SETUP_NEEDED),
/* harmony export */   "ID_SETUP_WALLET": () => (/* binding */ ID_SETUP_WALLET),
/* harmony export */   "ID_SET_BUTTON_BUY": () => (/* binding */ ID_SET_BUTTON_BUY),
/* harmony export */   "ID_SET_BUTTON_SELL": () => (/* binding */ ID_SET_BUTTON_SELL),
/* harmony export */   "ID_SHIELDED": () => (/* binding */ ID_SHIELDED),
/* harmony export */   "ID_SHIELDED_MSG": () => (/* binding */ ID_SHIELDED_MSG),
/* harmony export */   "ID_SHOW_ADDITIONAL_SETTINGS": () => (/* binding */ ID_SHOW_ADDITIONAL_SETTINGS),
/* harmony export */   "ID_SWAPPING": () => (/* binding */ ID_SWAPPING),
/* harmony export */   "ID_SWAP_OR_SEND_TOOLTIP": () => (/* binding */ ID_SWAP_OR_SEND_TOOLTIP),
/* harmony export */   "ID_TAKER": () => (/* binding */ ID_TAKER),
/* harmony export */   "ID_TAKER_FOUND_MAKER_REDEMPTION": () => (/* binding */ ID_TAKER_FOUND_MAKER_REDEMPTION),
/* harmony export */   "ID_TICKETS_PURCHASED": () => (/* binding */ ID_TICKETS_PURCHASED),
/* harmony export */   "ID_TICKET_STATUS_EXPIRED": () => (/* binding */ ID_TICKET_STATUS_EXPIRED),
/* harmony export */   "ID_TICKET_STATUS_IMMATURE": () => (/* binding */ ID_TICKET_STATUS_IMMATURE),
/* harmony export */   "ID_TICKET_STATUS_LIVE": () => (/* binding */ ID_TICKET_STATUS_LIVE),
/* harmony export */   "ID_TICKET_STATUS_MISSED": () => (/* binding */ ID_TICKET_STATUS_MISSED),
/* harmony export */   "ID_TICKET_STATUS_REVOKED": () => (/* binding */ ID_TICKET_STATUS_REVOKED),
/* harmony export */   "ID_TICKET_STATUS_UNKNOWN": () => (/* binding */ ID_TICKET_STATUS_UNKNOWN),
/* harmony export */   "ID_TICKET_STATUS_UNMINED": () => (/* binding */ ID_TICKET_STATUS_UNMINED),
/* harmony export */   "ID_TICKET_STATUS_UNSPENT": () => (/* binding */ ID_TICKET_STATUS_UNSPENT),
/* harmony export */   "ID_TICKET_STATUS_VOTED": () => (/* binding */ ID_TICKET_STATUS_VOTED),
/* harmony export */   "ID_TRADE": () => (/* binding */ ID_TRADE),
/* harmony export */   "ID_TRADING_TIER_UPDATED": () => (/* binding */ ID_TRADING_TIER_UPDATED),
/* harmony export */   "ID_TRANSPARENT": () => (/* binding */ ID_TRANSPARENT),
/* harmony export */   "ID_TXFEE_ERR_MSG": () => (/* binding */ ID_TXFEE_ERR_MSG),
/* harmony export */   "ID_TXFEE_UNSUPPORTED": () => (/* binding */ ID_TXFEE_UNSUPPORTED),
/* harmony export */   "ID_TX_TYPE_ACCELERATION": () => (/* binding */ ID_TX_TYPE_ACCELERATION),
/* harmony export */   "ID_TX_TYPE_APPROVE_TOKEN": () => (/* binding */ ID_TX_TYPE_APPROVE_TOKEN),
/* harmony export */   "ID_TX_TYPE_CREATE_BOND": () => (/* binding */ ID_TX_TYPE_CREATE_BOND),
/* harmony export */   "ID_TX_TYPE_MIX": () => (/* binding */ ID_TX_TYPE_MIX),
/* harmony export */   "ID_TX_TYPE_RECEIVE": () => (/* binding */ ID_TX_TYPE_RECEIVE),
/* harmony export */   "ID_TX_TYPE_REDEEM": () => (/* binding */ ID_TX_TYPE_REDEEM),
/* harmony export */   "ID_TX_TYPE_REDEEM_BOND": () => (/* binding */ ID_TX_TYPE_REDEEM_BOND),
/* harmony export */   "ID_TX_TYPE_REFUND": () => (/* binding */ ID_TX_TYPE_REFUND),
/* harmony export */   "ID_TX_TYPE_REVOKE_TOKEN_APPROVAL": () => (/* binding */ ID_TX_TYPE_REVOKE_TOKEN_APPROVAL),
/* harmony export */   "ID_TX_TYPE_SELF_TRANSFER": () => (/* binding */ ID_TX_TYPE_SELF_TRANSFER),
/* harmony export */   "ID_TX_TYPE_SEND": () => (/* binding */ ID_TX_TYPE_SEND),
/* harmony export */   "ID_TX_TYPE_SPLIT": () => (/* binding */ ID_TX_TYPE_SPLIT),
/* harmony export */   "ID_TX_TYPE_SWAP": () => (/* binding */ ID_TX_TYPE_SWAP),
/* harmony export */   "ID_TX_TYPE_SWAP_OR_SEND": () => (/* binding */ ID_TX_TYPE_SWAP_OR_SEND),
/* harmony export */   "ID_TX_TYPE_TICKET_PURCHASE": () => (/* binding */ ID_TX_TYPE_TICKET_PURCHASE),
/* harmony export */   "ID_TX_TYPE_TICKET_REVOCATION": () => (/* binding */ ID_TX_TYPE_TICKET_REVOCATION),
/* harmony export */   "ID_TX_TYPE_TICKET_VOTE": () => (/* binding */ ID_TX_TYPE_TICKET_VOTE),
/* harmony export */   "ID_TX_TYPE_UNKNOWN": () => (/* binding */ ID_TX_TYPE_UNKNOWN),
/* harmony export */   "ID_UNAVAILABLE": () => (/* binding */ ID_UNAVAILABLE),
/* harmony export */   "ID_UNKNOWN": () => (/* binding */ ID_UNKNOWN),
/* harmony export */   "ID_UNSUPPORTED_ASSET_INFO_ERR_MSG": () => (/* binding */ ID_UNSUPPORTED_ASSET_INFO_ERR_MSG),
/* harmony export */   "ID_VERSION_NOT_SUPPORTED": () => (/* binding */ ID_VERSION_NOT_SUPPORTED),
/* harmony export */   "ID_WAITING_FOR_CONFS": () => (/* binding */ ID_WAITING_FOR_CONFS),
/* harmony export */   "ID_WALLET_DISABLED_MSG": () => (/* binding */ ID_WALLET_DISABLED_MSG),
/* harmony export */   "ID_WALLET_ENABLED_MSG": () => (/* binding */ ID_WALLET_ENABLED_MSG),
/* harmony export */   "ID_WALLET_PENDING": () => (/* binding */ ID_WALLET_PENDING),
/* harmony export */   "ID_WALLET_READY": () => (/* binding */ ID_WALLET_READY),
/* harmony export */   "ID_WALLET_RECOVERY_SUPPORT_MSG": () => (/* binding */ ID_WALLET_RECOVERY_SUPPORT_MSG),
/* harmony export */   "ID_WALLET_SYNC_FINISHING_UP": () => (/* binding */ ID_WALLET_SYNC_FINISHING_UP),
/* harmony export */   "ID_WALLET_SYNC_PROGRESS": () => (/* binding */ ID_WALLET_SYNC_PROGRESS),
/* harmony export */   "ID_WALLET_UNLOCKED": () => (/* binding */ ID_WALLET_UNLOCKED),
/* harmony export */   "loadLocale": () => (/* binding */ loadLocale),
/* harmony export */   "prep": () => (/* binding */ prep)
/* harmony export */ });
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};


const ID_NO_PASS_ERROR_MSG = 'NO_PASS_ERROR_MSG';
const ID_NO_APP_PASS_ERROR_MSG = 'NO_APP_PASS_ERROR_MSG';
const ID_SET_BUTTON_BUY = 'SET_BUTTON_BUY';
const ID_SET_BUTTON_SELL = 'SET_BUTTON_SELL';
const ID_OFF = 'OFF';
const ID_MAX = 'MAX';
const ID_READY = 'READY';
const ID_NO_WALLET = 'NO_WALLET';
const ID_DISABLED_MSG = 'DISABLED_MSG';
const ID_WALLET_SYNC_PROGRESS = 'WALLET_SYNC_PROGRESS';
const ID_HIDE_ADDITIONAL_SETTINGS = 'HIDE_ADDITIONAL_SETTINGS';
const ID_SHOW_ADDITIONAL_SETTINGS = 'SHOW_ADDITIONAL_SETTINGS';
const ID_BUY = 'BUY';
const ID_SELL = 'SELL';
const ID_NOT_SUPPORTED = 'NOT_SUPPORTED';
const ID_VERSION_NOT_SUPPORTED = 'VERSION_NOT_SUPPORTED';
const ID_CONNECTION_FAILED = 'CONNECTION_FAILED';
const ID_ORDER_PREVIEW = 'ORDER_PREVIEW';
const ID_CALCULATING = 'CALCULATING';
const ID_ESTIMATE_UNAVAILABLE = 'ESTIMATE_UNAVAILABLE';
const ID_NO_ZERO_RATE = 'NO_ZERO_RATE';
const ID_NO_ZERO_QUANTITY = 'NO_ZERO_QUANTITY';
const ID_TRADE = 'TRADE';
const ID_NO_ASSET_WALLET = 'NO_ASSET_WALLET';
const ID_EXECUTED = 'EXECUTED';
const ID_BOOKED = 'BOOKED';
const ID_CANCELING = 'CANCELING';
const ID_PASSWORD_NOT_MATCH = 'PASSWORD_NOT_MATCH';
const ID_ACCT_UNDEFINED = 'ACCT_UNDEFINED';
const ID_KEEP_WALLET_PASS = 'KEEP_WALLET_PASS';
const ID_NEW_WALLET_PASS = 'NEW_WALLET_PASS';
const ID_LOT = 'LOT';
const ID_LOTS = 'LOTS';
const ID_UNKNOWN = 'UNKNOWN';
const ID_EPOCH = 'EPOCH';
const ID_ORDER_SUBMITTING = 'ORDER_SUBMITTING';
const ID_SETTLING = 'SETTLING';
const ID_NO_MATCH = 'NO_MATCH';
const ID_CANCELED = 'CANCELED';
const ID_REVOKED = 'REVOKED';
const ID_WAITING_FOR_CONFS = 'WAITING_FOR_CONFS';
const ID_NONE_SELECTED = 'NONE_SELECTED';
const ID_REGISTRATION_FEE_SUCCESS = 'REGISTRATION_FEE_SUCCESS';
const ID_API_ERROR = 'API_ERROR';
const ID_ADD = 'ADD';
const ID_CREATE = 'CREATE';
const ID_SETUP_WALLET = 'SETUP_WALLET';
const ID_WALLET_READY = 'WALLET_READY';
const ID_CHANGE_WALLET_TYPE = 'CHANGE_WALLET_TYPE';
const ID_KEEP_WALLET_TYPE = 'KEEP_WALLET_TYPE';
const ID_WALLET_PENDING = 'WALLET_PENDING';
const ID_SETUP_NEEDED = 'SETUP_NEEDED';
const ID_SEND_SUCCESS = 'SEND_SUCCESS';
const ID_RECONFIG_SUCCESS = 'RECONFIG_SUCCESS';
const ID_RESCAN_STARTED = 'RESCAN_STARTED';
const ID_NEW_WALLET_SUCCESS = 'NEW_WALLET_SUCCESS';
const ID_WALLET_UNLOCKED = 'WALLET_UNLOCKED';
const ID_SELLING = 'SELLING';
const ID_BUYING = 'BUYING';
const ID_WALLET_DISABLED_MSG = 'WALLET_DISABLED';
const ID_WALLET_ENABLED_MSG = 'WALLET_ENABLED';
const ID_ACTIVE_ORDERS_ERR_MSG = 'ACTIVE_ORDERS_ERR_MSG';
const ID_AVAILABLE = 'AVAILABLE';
const ID_LOCKED = 'LOCKED';
const ID_IMMATURE = 'IMMATURE';
const ID_FEE_BALANCE = 'FEE_BALANCE';
const ID_CANDLES_LOADING = 'CANDLES_LOADING';
const ID_DEPTH_LOADING = 'DEPTH_LOADING';
const ID_INVALID_ADDRESS_MSG = 'INVALID_ADDRESS_MSG';
const ID_TXFEE_UNSUPPORTED = 'TXFEE_UNSUPPORTED';
const ID_TXFEE_ERR_MSG = 'TXFEE_ERR_MSG';
const ID_ACTIVE_ORDERS_LOGOUT_ERR_MSG = 'ACTIVE_ORDERS_LOGOUT_ERR_MSG';
const ID_INVALID_DATE_ERR_MSG = 'INVALID_DATE_ERR_MSG';
const ID_NO_ARCHIVED_RECORDS = 'NO_ARCHIVED_RECORDS';
const ID_DELETE_ARCHIVED_RECORDS_RESULT = 'DELETE_ARCHIVED_RECORDS_RESULT';
const ID_ARCHIVED_RECORDS_PATH = 'ARCHIVED_RECORDS_PATH';
const ID_DEFAULT = 'DEFAULT';
const ID_ADDED = 'ADDED';
const ID_DISCOVERED = 'DISCOVERED';
const ID_UNSUPPORTED_ASSET_INFO_ERR_MSG = 'UNSUPPORTED_ASSET_INFO_ERR_MSG';
const ID_LIMIT_ORDER = 'LIMIT_ORDER';
const ID_LIMIT_ORDER_IMMEDIATE_TIF = 'LIMIT_ORDER_IMMEDIATE_TIF';
const ID_MARKET_ORDER = 'MARKET_ORDER';
const ID_MATCH_STATUS_NEWLY_MATCHED = 'MATCH_STATUS_NEWLY_MATCHED';
const ID_MATCH_STATUS_MAKER_SWAP_CAST = 'MATCH_STATUS_MAKER_SWAP_CAST';
const ID_MATCH_STATUS_TAKER_SWAP_CAST = 'MATCH_STATUS_TAKER_SWAP_CAST';
const ID_MATCH_STATUS_MAKER_REDEEMED = 'MATCH_STATUS_MAKER_REDEEMED';
const ID_MATCH_STATUS_REDEMPTION_SENT = 'MATCH_STATUS_REDEMPTION_SENT';
const ID_MATCH_STATUS_REDEMPTION_CONFIRMED = 'MATCH_REDEMPTION_CONFIRMED';
const ID_MATCH_STATUS_REVOKED = 'MATCH_STATUS_REVOKED';
const ID_MATCH_STATUS_REFUNDED = 'MATCH_STATUS_REFUNDED';
const ID_MATCH_STATUS_REFUND_PENDING = 'MATCH_STATUS_REFUND_PENDING';
const ID_MATCH_STATUS_REDEEM_PENDING = 'MATCH_STATUS_REDEEM_PENDING';
const ID_MATCH_STATUS_COMPLETE = 'MATCH_STATUS_COMPLETE';
const ID_TAKER_FOUND_MAKER_REDEMPTION = 'TAKER_FOUND_MAKER_REDEMPTION';
const ID_OPEN_WALLET_ERR_MSG = 'OPEN_WALLET_ERR_MSG';
const ID_ORDER_ACCELERATION_FEE_ERR_MSG = 'ORDER_ACCELERATION_FEE_ERR_MSG';
const ID_ORDER_ACCELERATION_ERR_MSG = 'ORDER_ACCELERATION_ERR_MSG';
const ID_CONNECTED = 'CONNECTED';
const ID_DISCONNECTED = 'DISCONNECTED';
const ID_INVALID_CERTIFICATE = 'INVALID_CERTIFICATE';
const ID_CONFIRMATIONS = 'CONFIRMATIONS';
const ID_TAKER = 'TAKER';
const ID_MAKER = 'MAKER';
const ID_EMPTY_DEX_ADDRESS_MSG = 'EMPTY_DEX_ADDRESS_MSG';
const ID_SELECT_WALLET_FOR_FEE_PAYMENT = 'SELECT_WALLET_FOR_FEE_PAYMENT';
const ID_UNAVAILABLE = 'UNAVAILABLE';
const ID_WALLET_SYNC_FINISHING_UP = 'WALLET_SYNC_FINISHING_UP';
const ID_CONNECT_WALLET_ERR_MSG = 'CONNECTING_WALLET_ERR_MSG';
const ID_REFUND_IMMINENT = 'REFUND_IMMINENT';
const ID_REFUND_WILL_HAPPEN_AFTER = 'REFUND_WILL_HAPPEN_AFTER';
const ID_AVAILABLE_TITLE = 'AVAILABLE_TITLE';
const ID_LOCKED_TITLE = 'LOCKED_TITLE';
const ID_IMMATURE_TITLE = 'IMMATURE_TITLE';
const ID_SWAPPING = 'SWAPPING';
const ID_BONDED = 'BONDED';
const ID_LOCKED_BAL_MSG = 'LOCKED_BAL_MSG';
const ID_IMMATURE_BAL_MSG = 'IMMATURE_BAL_MSG';
const ID_LOCKED_SWAPPING_BAL_MSG = 'LOCKED_SWAPPING_BAL_MSG';
const ID_LOCKED_BOND_BAL_MSG = 'LOCKED_BOND_BAL_MSG';
const ID_RESERVES_DEFICIT = 'RESERVES_DEFICIT';
const ID_RESERVES_DEFICIT_MSG = 'RESERVES_DEFICIT_MSG';
const ID_BOND_RESERVES = 'BOND_RESERVES';
const ID_BOND_RESERVES_MSG = 'BOND_RESERVES_MSG';
const ID_SHIELDED = 'SHIELDED';
const ID_TRANSPARENT = 'TRANSPARENT';
const ID_SHIELDED_MSG = 'SHIELDED_MSG';
const ID_ORDER = 'ORDER';
const ID_LOCKED_ORDER_BAL_MSG = 'LOCKED_ORDER_BAL_MSG';
const ID_CREATING_WALLETS = 'CREATING_WALLETS';
const ID_ADDING_SERVERS = 'ADDING_SERVER';
const ID_WALLET_RECOVERY_SUPPORT_MSG = 'WALLET_RECOVERY_SUPPORT_MSG';
const ID_TICKETS_PURCHASED = 'TICKETS_PURCHASED';
const ID_TICKET_STATUS_UNKNOWN = 'TICKET_STATUS_UNKNOWN';
const ID_TICKET_STATUS_UNMINED = 'TICKET_STATUS_UNMINED';
const ID_TICKET_STATUS_IMMATURE = 'TICKET_STATUS_IMMATURE';
const ID_TICKET_STATUS_LIVE = 'TICKET_STATUS_LIVE';
const ID_TICKET_STATUS_VOTED = 'TICKET_STATUS_VOTED';
const ID_TICKET_STATUS_MISSED = 'TICKET_STATUS_MISSED';
const ID_TICKET_STATUS_EXPIRED = 'TICKET_STATUS_EXPIRED';
const ID_TICKET_STATUS_UNSPENT = 'TICKET_STATUS_UNSPENT';
const ID_TICKET_STATUS_REVOKED = 'TICKET_STATUS_REVOKED';
const ID_PASSWORD_RESET_SUCCESS_MSG = 'PASSWORD_RESET_SUCCESS_MSG';
const ID_BROWSER_NTFN_ENABLED = 'BROWSER_NTFN_ENABLED';
const ID_BROWSER_NTFN_ORDERS = 'BROWSER_NTFN_ORDERS';
const ID_BROWSER_NTFN_MATCHES = 'BROWSER_NTFN_MATCHES';
const ID_BROWSER_NTFN_BONDS = 'BROWSER_NTFN_BONDS';
const ID_BROWSER_NTFN_CONNECTIONS = 'BROWSER_NTFN_CONNECTIONS';
const ID_ORDER_BUTTON_BUY_BALANCE_ERROR = 'ORDER_BUTTON_BUY_BALANCE_ERROR';
const ID_ORDER_BUTTON_SELL_BALANCE_ERROR = 'ORDER_BUTTON_SELL_BALANCE_ERROR';
const ID_ORDER_BUTTON_QTY_ERROR = 'ORDER_BUTTON_QTY_ERROR';
const ID_ORDER_BUTTON_QTY_RATE_ERROR = 'ORDER_BUTTON_QTY_RATE_ERROR';
const ID_CREATE_ASSET_WALLET_MSG = 'CREATE_ASSET_WALLET_MSG';
const ID_NO_WALLET_MSG = 'NO_WALLET_MSG';
const ID_TRADING_TIER_UPDATED = 'TRADING_TIER_UPDATED';
const ID_INVALID_TIER_VALUE = 'INVALID_TIER_VALUE';
const ID_INVALID_COMPS_VALUE = 'INVALID_COMPS_VALUE';
const ID_TX_TYPE_UNKNOWN = 'TX_TYPE_UNKNOWN';
const ID_TX_TYPE_SEND = 'TX_TYPE_SEND';
const ID_TX_TYPE_RECEIVE = 'TX_TYPE_RECEIVE';
const ID_TX_TYPE_SWAP = 'TX_TYPE_SWAP';
const ID_TX_TYPE_REDEEM = 'TX_TYPE_REDEEM';
const ID_TX_TYPE_REFUND = 'TX_TYPE_REFUND';
const ID_TX_TYPE_SPLIT = 'TX_TYPE_SPLIT';
const ID_TX_TYPE_CREATE_BOND = 'TX_TYPE_CREATE_BOND';
const ID_TX_TYPE_REDEEM_BOND = 'TX_TYPE_REDEEM_BOND';
const ID_TX_TYPE_APPROVE_TOKEN = 'TX_TYPE_APPROVE_TOKEN';
const ID_TX_TYPE_ACCELERATION = 'TX_TYPE_ACCELERATION';
const ID_TX_TYPE_SELF_TRANSFER = 'TX_TYPE_SELF_TRANSFER';
const ID_TX_TYPE_REVOKE_TOKEN_APPROVAL = 'TX_TYPE_REVOKE_TOKEN_APPROVAL';
const ID_TX_TYPE_TICKET_PURCHASE = 'TX_TYPE_TICKET_PURCHASE';
const ID_TX_TYPE_TICKET_VOTE = 'TX_TYPE_TICKET_VOTE';
const ID_TX_TYPE_TICKET_REVOCATION = 'TX_TYPE_TICKET_REVOCATION';
const ID_TX_TYPE_SWAP_OR_SEND = 'TX_TYPE_SWAP_OR_SEND';
const ID_TX_TYPE_MIX = 'TX_TYPE_MIX';
const ID_SWAP_OR_SEND_TOOLTIP = 'SWAP_OR_SEND_TOOLTIP';
const ID_MISSING_CEX_CREDS = 'MISSING_CEX_CREDS';
const ID_MATCH_BUFFER = 'MATCH_BUFFER';
const ID_NO_PLACEMENTS = 'NO_PLACEMENTS';
const ID_INVALID_VALUE = 'INVALID_VALUE';
const ID_NO_ZERO = 'NO_ZERO';
const ID_BOTTYPE_BASIC_MM = 'BOTTYPE_BASIC_MM';
const ID_BOTTYPE_ARB_MM = 'BOTTYPE_ARB_MM';
const ID_BOTTYPE_SIMPLE_ARB = 'BOTTYPE_SIMPLE_ARB';
const ID_NO_BOTTYPE = 'NO_BOTTYPE';
const ID_NO_CEX = 'NO_CEX';
const ID_CEXBALANCE_ERR = 'CEXBALANCE_ERR';
const ID_PENDING = 'PENDING';
const ID_COMPLETE = 'COMPLETE';
const ID_ARCHIVED_SETTINGS = 'ARCHIVED_SETTINGS';
const ID_NO_CODE_PROVIDED = 'NO_CODE_PROVIDED';
const ID_ENABLE_ACCOUNT = 'ENABLE_ACCOUNT';
const ID_DISABLE_ACCOUNT = 'DISABLE_ACCOUNT';
const ID_ACCOUNT_DISABLED_MSG = 'ACCOUNT_DISABLED_MSG';
const ID_DEX_DISABLED_MSG = 'DEX_DISABLED_MSG';
let locale;
function loadLocale(lang, commitHash, skipCache) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!skipCache) {
            const specs = _state__WEBPACK_IMPORTED_MODULE_0__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeSpecsKey);
            if (specs && specs.lang === lang && specs.commitHash === commitHash) {
                locale = _state__WEBPACK_IMPORTED_MODULE_0__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeKey);
                return;
            }
        }
        locale = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/locale', lang);
        _state__WEBPACK_IMPORTED_MODULE_0__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeSpecsKey, { lang, commitHash });
        _state__WEBPACK_IMPORTED_MODULE_0__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeKey, locale);
    });
}
/* prep will format the message to the current locale. */
function prep(k, args) {
    return stringTemplateParser(locale[k], args || {});
}
window.clearLocale = () => {
    _state__WEBPACK_IMPORTED_MODULE_0__["default"].removeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeSpecsKey);
    _state__WEBPACK_IMPORTED_MODULE_0__["default"].removeLocal(_state__WEBPACK_IMPORTED_MODULE_0__["default"].localeKey);
};
/*
 * stringTemplateParser is a template string matcher, where expression is any
 * text. It switches what is inside double brackets (e.g. 'buy {{ asset }}')
 * for the value described into args. args is an object with keys
 * equal to the placeholder keys. (e.g. {"asset": "dcr"}).
 * So that will be switched for: 'asset dcr'.
 */
function stringTemplateParser(expression, args) {
    // templateMatcher matches any text which:
    // is some {{ text }} between two brackets, and a space between them.
    // It is global, therefore it will change all occurrences found.
    // text can be anything, but brackets '{}' and space '\s'
    const templateMatcher = /{{\s?([^{}\s]*)\s?}}/g;
    return expression.replace(templateMatcher, (_, value) => args[value]);
}


/***/ }),

/***/ "./src/js/login.ts":
/*!*************************!*\
  !*** ./src/js/login.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ LoginPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




/*
  LoginPage holds the form for login and password reset.
*/
class LoginPage extends _basepage__WEBPACK_IMPORTED_MODULE_2__["default"] {
    constructor(body) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].idDescendants(body);
        this.loginForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.LoginForm(page.loginForm, () => { this.loggedIn(); });
        const prepAndDisplayLoginForm = () => {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.resetAppPWForm);
            this.loginForm.refresh();
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.loginForm);
            this.loginForm.focus();
        };
        prepAndDisplayLoginForm();
        this.appPassResetForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.AppPassResetForm(page.resetAppPWForm, () => { prepAndDisplayLoginForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.forgotPassBtn, 'click', () => {
            this.appPassResetForm.refresh();
            (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.loginForm, page.resetAppPWForm);
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.resetPassFormCloser, 'click', () => { prepAndDisplayLoginForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_1__["default"].mouseInElement(e, page.resetAppPWForm) && _doc__WEBPACK_IMPORTED_MODULE_1__["default"].isDisplayed(page.resetAppPWForm)) {
                prepAndDisplayLoginForm();
            }
        });
    }
    /* login submits the sign-in form and parses the result. */
    loggedIn() {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('wallets');
        });
    }
}


/***/ }),

/***/ "./src/js/markets.ts":
/*!***************************!*\
  !*** ./src/js/markets.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketsPage),
/* harmony export */   "marketID": () => (/* binding */ marketID)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderbook__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./orderbook */ "./src/js/orderbook.ts");
/* harmony import */ var _account__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./account */ "./src/js/account.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _ws__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ws */ "./src/js/ws.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};














const bind = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind;
const bookRoute = 'book';
const bookOrderRoute = 'book_order';
const unbookOrderRoute = 'unbook_order';
const updateRemainingRoute = 'update_remaining';
const epochOrderRoute = 'epoch_order';
const candlesRoute = 'candles';
const candleUpdateRoute = 'candle_update';
const unmarketRoute = 'unmarket';
const epochMatchSummaryRoute = 'epoch_match_summary';
const animationLength = 500;
const anHour = 60 * 60 * 1000; // milliseconds
const maxUserOrdersShown = 10;
const buyBtnClass = 'buygreen-bg';
const sellBtnClass = 'sellred-bg';
const fiveMinBinKey = '5m';
const oneHrBinKey = '1h';
const percentFormatter = new Intl.NumberFormat(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
    minimumFractionDigits: 1,
    maximumFractionDigits: 2
});
const parentIDNone = 0xFFFFFFFF;
class MarketsPage extends _basepage__WEBPACK_IMPORTED_MODULE_2__["default"] {
    constructor(main, pageParams) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(main);
        this.main = main;
        if (!this.main.parentElement)
            return; // Not gonna happen, but TypeScript cares.
        // There may be multiple pending updates to the max order. This makes sure
        // that the screen is updated with the most recent one.
        this.maxOrderUpdateCounter = 0;
        this.metaOrders = {};
        this.recentMatches = [];
        this.preorderCache = {};
        this.depthLines = {
            hover: [],
            input: []
        };
        this.hovers = [];
        // 'Recent Matches' list sort key and direction.
        this.recentMatchesSortKey = 'age';
        this.recentMatchesSortDirection = -1;
        // store original title so we can re-append it when updating market value.
        this.ogTitle = document.title;
        const depthReporters = {
            click: (x) => { this.reportDepthClick(x); },
            volume: (r) => { this.reportDepthVolume(r); },
            mouse: (r) => { this.reportDepthMouse(r); },
            zoom: (z) => { this.reportDepthZoom(z); }
        };
        this.depthChart = new _charts__WEBPACK_IMPORTED_MODULE_5__.DepthChart(page.depthChart, depthReporters, _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].depthZoomLK));
        const candleReporters = {
            mouse: c => { this.reportMouseCandle(c); }
        };
        this.candleChart = new _charts__WEBPACK_IMPORTED_MODULE_5__.CandleChart(page.candlesChart, candleReporters);
        const success = () => { };
        // Do not call cleanTemplates before creating the AccelerateOrderForm
        this.accelerateOrderForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.AccelerateOrderForm(page.accelerateForm, success);
        this.approveTokenForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.TokenApprovalForm(page.approveTokenForm);
        // Set user's last known candle duration.
        this.candleDur = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastCandleDurationLK) || oneHrBinKey;
        // Setup the register to trade button.
        // TODO: Use dexsettings page?
        const registerBttn = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(page.notRegistered, 'registerBttn');
        bind(registerBttn, 'click', () => {
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loadPage('register', { host: this.market.dex.host });
        });
        // Set up the BalanceWidget.
        {
            page.walletInfoTmpl.removeAttribute('id');
            const bWidget = page.walletInfoTmpl;
            const qWidget = page.walletInfoTmpl.cloneNode(true);
            bWidget.after(qWidget);
            const wgt = this.balanceWgt = new BalanceWidget(bWidget, qWidget);
            const baseIcons = wgt.base.stateIcons.icons;
            const quoteIcons = wgt.quote.stateIcons.icons;
            bind(wgt.base.tmpl.connect, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(wgt.quote.tmpl.connect, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(wgt.base.tmpl.expired, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(wgt.quote.tmpl.expired, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(baseIcons.sleeping, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(quoteIcons.sleeping, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(baseIcons.locked, 'click', () => { this.unlockWallet(this.market.base.id); });
            bind(quoteIcons.locked, 'click', () => { this.unlockWallet(this.market.quote.id); });
            bind(baseIcons.disabled, 'click', () => { this.showToggleWalletStatus(this.market.base); });
            bind(quoteIcons.disabled, 'click', () => { this.showToggleWalletStatus(this.market.quote); });
            bind(wgt.base.tmpl.newWalletBttn, 'click', () => { this.showCreate(this.market.base); });
            bind(wgt.quote.tmpl.newWalletBttn, 'click', () => { this.showCreate(this.market.quote); });
            bind(wgt.base.tmpl.walletAddr, 'click', () => { this.showDeposit(this.market.base.id); });
            bind(wgt.quote.tmpl.walletAddr, 'click', () => { this.showDeposit(this.market.quote.id); });
            bind(wgt.base.tmpl.wantProviders, 'click', () => { this.showCustomProviderDialog(this.market.base.id); });
            bind(wgt.quote.tmpl.wantProviders, 'click', () => { this.showCustomProviderDialog(this.market.quote.id); });
            this.depositAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.DepositAddress(page.deposit);
        }
        this.mm = new _mmutil__WEBPACK_IMPORTED_MODULE_13__.RunningMarketMakerDisplay(page.mmRunning, 'markets');
        this.reputationMeter = new _account__WEBPACK_IMPORTED_MODULE_4__.ReputationMeter(page.reputationMeter);
        // Bind toggle wallet status form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.toggleWalletStatusConfirm, page.toggleWalletStatusSubmit, () => __awaiter(this, void 0, void 0, function* () { this.toggleWalletStatus(); }));
        // Prepare templates for the buy and sell tables and the user's order table.
        (0,_opts__WEBPACK_IMPORTED_MODULE_12__.setOptionTemplates)(page);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.orderRowTmpl, page.durBttnTemplate, page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl, page.userOrderTmpl, page.recentMatchesTemplate);
        // Buttons to show token approval form
        bind(page.approveBaseBttn, 'click', () => { this.showTokenApprovalForm(true); });
        bind(page.approveQuoteBttn, 'click', () => { this.showTokenApprovalForm(false); });
        bind(page.showTradingTier, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showTradingTier);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.tradingLimits);
        });
        bind(page.showTradingReputation, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showTradingReputation);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.reputationMeter);
        });
        // Buttons to set order type and side.
        bind(page.buyBttn, 'click', () => { this.setBuy(); });
        bind(page.sellBttn, 'click', () => { this.setSell(); });
        bind(page.limitBttn, 'click', () => {
            swapBttns(page.marketBttn, page.limitBttn);
            this.setOrderVisibility();
            if (!page.rateField.value)
                return;
            this.depthLines.input = [{
                    rate: (0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.rateField.value, 0),
                    color: this.isSell() ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine
                }];
            this.drawChartLines();
        });
        bind(page.marketBttn, 'click', () => {
            swapBttns(page.limitBttn, page.marketBttn);
            this.setOrderVisibility();
            this.setMarketBuyOrderEstimate();
            this.depthLines.input = [];
            this.drawChartLines();
        });
        bind(page.maxOrd, 'click', () => {
            if (this.isSell()) {
                const maxSell = this.market.maxSell;
                if (!maxSell)
                    return;
                page.lotField.value = String(maxSell.swap.lots);
            }
            else {
                const maxBuy = this.market.maxBuys[this.adjustedRate()];
                if (!maxBuy)
                    return;
                page.lotField.value = String(maxBuy.swap.lots);
            }
            this.lotChanged();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].disableMouseWheel(page.rateField, page.lotField, page.qtyField, page.mktBuyField);
        // Handle the full orderbook sent on the 'book' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(bookRoute, (data) => { this.handleBookRoute(data); });
        // Handle the new order for the order book on the 'book_order' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(bookOrderRoute, (data) => { this.handleBookOrderRoute(data); });
        // Remove the order sent on the 'unbook_order' route from the orderbook.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(unbookOrderRoute, (data) => { this.handleUnbookOrderRoute(data); });
        // Update the remaining quantity on a booked order.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(updateRemainingRoute, (data) => { this.handleUpdateRemainingRoute(data); });
        // Handle the new order for the order book on the 'epoch_order' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(epochOrderRoute, (data) => { this.handleEpochOrderRoute(data); });
        // Handle the initial candlestick data on the 'candles' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(candlesRoute, (data) => { this.handleCandlesRoute(data); });
        // Handle the candles update on the 'candles' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(candleUpdateRoute, (data) => { this.handleCandleUpdateRoute(data); });
        // Handle the recent matches update on the 'epoch_report' route.
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].registerRoute(epochMatchSummaryRoute, (data) => { this.handleEpochMatchSummary(data); });
        // Create a wallet
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_7__.NewWalletForm(page.newWalletForm, () => __awaiter(this, void 0, void 0, function* () { this.createWallet(); }));
        // Main order form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.orderForm, page.submitBttn, () => __awaiter(this, void 0, void 0, function* () { this.stepSubmit(); }));
        // Order verification form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.verifyForm, page.vSubmit, () => __awaiter(this, void 0, void 0, function* () { this.submitOrder(); }));
        // Cancel order form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_7__.bind)(page.cancelForm, page.cancelSubmit, () => __awaiter(this, void 0, void 0, function* () { this.submitCancel(); }));
        // Order detail view.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.vFeeDetails, 'click', () => this.showForm(page.vDetailPane));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.closeDetailPane, 'click', () => this.showVerifyForm());
        // // Bind active orders list's header sort events.
        page.recentMatchesTable.querySelectorAll('[data-ordercol]')
            .forEach((th) => bind(th, 'click', () => setRecentMatchesSortCol(th.dataset.ordercol || '')));
        const setRecentMatchesSortCol = (key) => {
            // First unset header's current sorted col classes.
            unsetRecentMatchesSortColClasses();
            if (this.recentMatchesSortKey === key) {
                this.recentMatchesSortDirection *= -1;
            }
            else {
                this.recentMatchesSortKey = key;
                this.recentMatchesSortDirection = 1;
            }
            this.refreshRecentMatchesTable();
            setRecentMatchesSortColClasses();
        };
        // sortClassByDirection receives a sort direction and return a class based on it.
        const sortClassByDirection = (element) => {
            if (element === 1)
                return 'sorted-asc';
            return 'sorted-dsc';
        };
        const unsetRecentMatchesSortColClasses = () => {
            page.recentMatchesTable.querySelectorAll('[data-ordercol]')
                .forEach(th => th.classList.remove('sorted-asc', 'sorted-dsc'));
        };
        const setRecentMatchesSortColClasses = () => {
            const key = this.recentMatchesSortKey;
            const sortCls = sortClassByDirection(this.recentMatchesSortDirection);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(page.recentMatchesTable, `[data-ordercol=${key}]`).classList.add(sortCls);
        };
        // Set default's sorted col header classes.
        setRecentMatchesSortColClasses();
        const closePopups = () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
        };
        // If the user clicks outside of a form, it should close the page overlay.
        bind(page.forms, 'mousedown', (e) => {
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.vDetailPane) && !_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, page.vDetailPane))
                return this.showVerifyForm();
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                closePopups();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                closePopups();
            }
        };
        bind(document, 'keyup', this.keyup);
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { closePopups(); });
        });
        // Event listeners for interactions with the various input fields.
        bind(page.lotField, ['change', 'keyup'], () => { this.lotChanged(); });
        bind(page.qtyField, 'change', () => { this.quantityChanged(true); });
        bind(page.qtyField, 'keyup', () => { this.quantityChanged(false); });
        bind(page.mktBuyField, ['change', 'keyup'], () => { this.marketBuyChanged(); });
        bind(page.rateField, 'change', () => { this.rateFieldChanged(); });
        bind(page.rateField, 'keyup', () => { this.previewQuoteAmt(true); });
        // Market search input bindings.
        bind(page.marketSearchV1, ['change', 'keyup'], () => { this.filterMarkets(); });
        // Acknowledge the order disclaimer.
        const setDisclaimerAckViz = (acked) => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!acked, page.disclaimer, page.disclaimerAck);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(acked, page.showDisclaimer);
        };
        bind(page.disclaimerAck, 'click', () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].orderDisclaimerAckedLK, true);
            setDisclaimerAckViz(true);
        });
        bind(page.showDisclaimer, 'click', () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].orderDisclaimerAckedLK, false);
            setDisclaimerAckViz(false);
        });
        setDisclaimerAckViz(_state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].orderDisclaimerAckedLK));
        const clearChartLines = () => {
            this.depthLines.hover = [];
            this.drawChartLines();
        };
        bind(page.buyRows, 'mouseleave', clearChartLines);
        bind(page.sellRows, 'mouseleave', clearChartLines);
        bind(page.userOrders, 'mouseleave', () => {
            this.activeMarkerRate = null;
            this.setDepthMarkers();
        });
        const stats0 = page.marketStats;
        const stats1 = stats0.cloneNode(true);
        stats1.classList.add('listopen');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(stats0, stats1);
        stats1.removeAttribute('id');
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().headerSpace.appendChild(stats1);
        this.stats = [{ row: stats0, tmpl: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(stats0) }, { row: stats1, tmpl: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(stats1) }];
        const closeMarketsList = () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].leftMarketDockLK, '0');
            page.leftMarketDock.classList.remove('default');
            page.leftMarketDock.classList.add('stashed');
            for (const s of this.stats)
                s.row.classList.remove('listopen');
        };
        const openMarketsList = () => {
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].leftMarketDockLK, '1');
            page.leftMarketDock.classList.remove('default', 'stashed');
            for (const s of this.stats)
                s.row.classList.add('listopen');
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.leftHider, 'click', () => closeMarketsList());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.marketReopener, 'click', () => openMarketsList());
        for (const s of this.stats) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(s.tmpl.marketSelect, 'click', () => {
                if (page.leftMarketDock.clientWidth === 0)
                    openMarketsList();
                else
                    closeMarketsList();
            });
        }
        this.marketList = new MarketList(page.marketListV1);
        // Prepare the list of markets.
        for (const row of this.marketList.markets) {
            bind(row.node, 'click', () => {
                var _a, _b, _c, _d;
                // return early if the market is already set
                const { quoteid: quoteID, baseid: baseID, xc: { host } } = row.mkt;
                if (((_b = (_a = this.market) === null || _a === void 0 ? void 0 : _a.base) === null || _b === void 0 ? void 0 : _b.id) === baseID && ((_d = (_c = this.market) === null || _c === void 0 ? void 0 : _c.quote) === null || _d === void 0 ? void 0 : _d.id) === quoteID)
                    return;
                this.startLoadingAnimations();
                this.setMarket(host, baseID, quoteID);
            });
        }
        if (_state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].leftMarketDockLK) !== '1') { // It is shown by default, hiding if necessary.
            closeMarketsList();
        }
        // Notification filters.
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().registerNoteFeeder({
            order: (note) => { this.handleOrderNote(note); },
            match: (note) => { this.handleMatchNote(note); },
            epoch: (note) => { this.handleEpochNote(note); },
            conn: (note) => { this.handleConnNote(note); },
            balance: (note) => { this.handleBalanceNote(note); },
            bondpost: (note) => { this.handleBondUpdate(note); },
            spots: (note) => { this.handlePriceUpdate(note); },
            walletstate: (note) => { this.handleWalletState(note); },
            reputation: () => { this.updateReputation(); },
            feepayment: () => { this.updateReputation(); },
            runstats: (note) => {
                this.mm.update();
                if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host)
                    return;
                if (Boolean(this.mmRunning) !== Boolean(note.stats)) {
                    this.mmRunning = Boolean(note.stats);
                    this.resolveOrderFormVisibility();
                }
            },
            runevent: (note) => {
                if (note.baseID !== this.market.base.id || note.quoteID !== this.market.quote.id || note.host !== this.market.dex.host)
                    return;
                this.mm.update();
            }
        });
        this.loadingAnimations = {};
        this.startLoadingAnimations();
        // Start a ticker to update time-since values.
        this.secondTicker = window.setInterval(() => {
            var _a;
            for (const mord of Object.values(this.metaOrders)) {
                mord.details.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(mord.ord.submitTime);
            }
            for (const td of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.recentMatchesLiveList, '[data-tmpl=age]')) {
                td.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseFloat((_a = td.dataset.sinceStamp) !== null && _a !== void 0 ? _a : '0'));
            }
        }, 1000);
        this.init(pageParams);
    }
    init(pageParams) {
        return __awaiter(this, void 0, void 0, function* () {
            // Fetch the first market in the list, or the users last selected market, if
            // it exists.
            let selected;
            if (pageParams === null || pageParams === void 0 ? void 0 : pageParams.host) {
                selected = makeMarket(pageParams.host, parseInt(pageParams.baseID), parseInt(pageParams.quoteID));
            }
            else {
                selected = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastMarketLK);
            }
            if (!selected || !this.marketList.exists(selected.host, selected.base, selected.quote)) {
                const first = this.marketList.first();
                if (first)
                    selected = { host: first.mkt.xc.host, base: first.mkt.baseid, quote: first.mkt.quoteid };
            }
            if (selected)
                this.setMarket(selected.host, selected.base, selected.quote);
            else
                this.balanceWgt.setBalanceVisibility(false); // no market to display balance widget for.
            // set the initial state for the registration status
            this.setRegistrationStatusVisibility();
        });
    }
    startLoadingAnimations() {
        const { page, loadingAnimations: anis, depthChart, candleChart } = this;
        depthChart.canvas.classList.add('invisible');
        candleChart.canvas.classList.add('invisible');
        if (anis.candles)
            anis.candles.stop();
        anis.candles = new _charts__WEBPACK_IMPORTED_MODULE_5__.Wave(page.candlesChart, { message: _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CANDLES_LOADING) });
        if (anis.depth)
            anis.depth.stop();
        anis.depth = new _charts__WEBPACK_IMPORTED_MODULE_5__.Wave(page.depthChart, { message: _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_DEPTH_LOADING) });
    }
    /* isSell is true if the user has selected sell in the order options. */
    isSell() {
        return this.page.sellBttn.classList.contains('selected');
    }
    /* isLimit is true if the user has selected the "limit order" tab. */
    isLimit() {
        return this.page.limitBttn.classList.contains('selected');
    }
    setBuy() {
        const { page } = this;
        swapBttns(page.sellBttn, page.buyBttn);
        page.submitBttn.classList.remove(sellBtnClass);
        page.submitBttn.classList.add(buyBtnClass);
        page.maxLbl.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BUY);
        this.setOrderBttnText();
        this.setOrderVisibility();
        this.drawChartLines();
        if (!this.isLimit()) {
            this.marketBuyChanged();
        }
        else {
            this.currentOrder = this.parseOrder();
            this.updateOrderBttnState();
        }
    }
    setSell() {
        const { page } = this;
        swapBttns(page.buyBttn, page.sellBttn);
        page.submitBttn.classList.add(sellBtnClass);
        page.submitBttn.classList.remove(buyBtnClass);
        page.maxLbl.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SELL);
        this.setOrderBttnText();
        this.setOrderVisibility();
        this.drawChartLines();
        this.currentOrder = this.parseOrder();
        this.updateOrderBttnState();
    }
    /* hasPendingBonds is true if there are pending bonds */
    hasPendingBonds() {
        return Object.keys(this.market.dex.auth.pendingBonds || []).length > 0;
    }
    /* setCurrMarketPrice updates the current market price on the stats displays
       and the orderbook display. */
    setCurrMarketPrice() {
        const selected = this.market;
        if (!selected)
            return;
        // Get an up-to-date Market.
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[selected.dex.host];
        const mkt = xc.markets[selected.cfg.name];
        if (!mkt.spot)
            return;
        for (const s of this.stats) {
            const { unitInfo: { conventional: { conversionFactor: cFactor, unit } } } = xc.assets[mkt.baseid];
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[mkt.baseid];
            if (fiatRate) {
                s.tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.spot.vol24 / cFactor * fiatRate);
                s.tmpl.volUnit.textContent = 'USD';
            }
            else {
                s.tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.spot.vol24 / cFactor);
                s.tmpl.volUnit.textContent = unit;
            }
            setPriceAndChange(s.tmpl, xc, mkt);
        }
        this.page.obPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.spot.rate / this.market.rateConversionFactor);
        this.page.obPrice.classList.remove('sellcolor', 'buycolor');
        this.page.obPrice.classList.add(mkt.spot.change24 >= 0 ? 'buycolor' : 'sellcolor');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(mkt.spot.change24 >= 0, this.page.obUp);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(mkt.spot.change24 < 0, this.page.obDown);
    }
    /* setMarketDetails updates the currency names on the stats displays. */
    setMarketDetails() {
        if (!this.market)
            return;
        for (const s of this.stats) {
            const { baseCfg: ba, quoteCfg: qa } = this.market;
            s.tmpl.baseIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(ba.symbol);
            s.tmpl.quoteIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(qa.symbol);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(s.tmpl.baseSymbol, s.tmpl.quoteSymbol);
            s.tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(ba, true));
            s.tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(qa, true));
        }
    }
    /* setHighLow calculates the high and low rates over the last 24 hours. */
    setHighLow() {
        var _a;
        let [high, low] = [0, 0];
        const spot = this.market.cfg.spot;
        // Use spot values for 24 hours high and low rates if it is available. We
        // will default to setting it from candles if it's not.
        if (spot && spot.low24 && spot.high24) {
            high = spot.high24;
            low = spot.low24;
        }
        else {
            const cache = (_a = this.market) === null || _a === void 0 ? void 0 : _a.candleCaches[fiveMinBinKey];
            if (!cache) {
                if (this.candleDur !== fiveMinBinKey) {
                    this.requestCandles(fiveMinBinKey);
                    return;
                }
                for (const s of this.stats) {
                    s.tmpl.high.textContent = '-';
                    s.tmpl.low.textContent = '-';
                }
                return;
            }
            // Set high and low rates from candles.
            const aDayAgo = new Date().getTime() - 86400000;
            for (let i = cache.candles.length - 1; i >= 0; i--) {
                const c = cache.candles[i];
                if (c.endStamp < aDayAgo)
                    break;
                if (low === 0 || (c.lowRate > 0 && c.lowRate < low))
                    low = c.lowRate;
                if (c.highRate > high)
                    high = c.highRate;
            }
        }
        const baseID = this.market.base.id;
        const quoteID = this.market.quote.id;
        const dex = this.market.dex;
        for (const s of this.stats) {
            s.tmpl.high.textContent = high > 0 ? _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().conventionalRate(baseID, quoteID, high, dex)) : '-';
            s.tmpl.low.textContent = low > 0 ? _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().conventionalRate(baseID, quoteID, low, dex)) : '-';
        }
    }
    /* assetsAreSupported is true if all the assets of the current market are
     * supported
     */
    assetsAreSupported() {
        var _a, _b, _c, _d;
        const { market: { base, quote, baseCfg, quoteCfg } } = this;
        if (!base || !quote) {
            const symbol = base ? quoteCfg.symbol : baseCfg.symbol;
            return {
                isSupported: false,
                text: _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NOT_SUPPORTED, { asset: symbol.toUpperCase() })
            };
        }
        // check if versions are supported. If asset is a token, we check if its
        // parent supports the version.
        const bVers = (base.token ? (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[base.token.parentID].info) === null || _a === void 0 ? void 0 : _a.versions : (_b = base.info) === null || _b === void 0 ? void 0 : _b.versions);
        const qVers = (quote.token ? (_c = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quote.token.parentID].info) === null || _c === void 0 ? void 0 : _c.versions : (_d = quote.info) === null || _d === void 0 ? void 0 : _d.versions);
        // if none them are token, just check if own asset is supported.
        let text = '';
        if (!bVers.includes(baseCfg.version)) {
            text = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_VERSION_NOT_SUPPORTED, { asset: base.symbol.toUpperCase(), version: baseCfg.version + '' });
        }
        else if (!qVers.includes(quoteCfg.version)) {
            text = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_VERSION_NOT_SUPPORTED, { asset: quote.symbol.toUpperCase(), version: quoteCfg.version + '' });
        }
        return {
            isSupported: bVers.includes(baseCfg.version) && qVers.includes(quoteCfg.version),
            text
        };
    }
    /*
     * setOrderVisibility sets which form is visible based on the specified
     * options.
     */
    setOrderVisibility() {
        const page = this.page;
        if (this.isLimit()) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.priceBox, page.tifBox, page.qtyBox, page.maxBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mktBuyBox);
            this.previewQuoteAmt(true);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.tifBox, page.maxBox, page.priceBox);
            if (this.isSell()) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mktBuyBox);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.qtyBox);
                this.previewQuoteAmt(true);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mktBuyBox);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.qtyBox);
                this.previewQuoteAmt(false);
            }
        }
        this.updateOrderBttnState();
    }
    /* resolveOrderFormVisibility displays or hides the 'orderForm' based on
     * a set of conditions to be met.
     */
    resolveOrderFormVisibility() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const showOrderForm = () => __awaiter(this, void 0, void 0, function* () {
                if (!this.assetsAreSupported().isSupported)
                    return false; // assets not supported
                if (!this.market || this.market.dex.auth.effectiveTier < 1)
                    return false; // acct suspended or not registered
                const { baseAssetApprovalStatus, quoteAssetApprovalStatus } = this.tokenAssetApprovalStatuses();
                if (baseAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved || quoteAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved)
                    return false;
                const { base, quote } = this.market;
                const hasWallets = base && (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[base.id].wallet && quote && (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quote.id].wallet;
                if (!hasWallets)
                    return false;
                if (this.mmRunning)
                    return false;
                return true;
            });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(yield showOrderForm(), page.orderForm, page.orderTypeBttns);
            if (this.market) {
                const { auth: { effectiveTier, pendingStrength } } = this.market.dex;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(effectiveTier > 0 || pendingStrength > 0, page.reputationAndTradingTierBox);
            }
            const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().mmStatus;
            if (mmStatus && this.mmRunning === undefined && this.market.base && this.market.quote) {
                const { base: { id: baseID }, quote: { id: quoteID }, dex: { host } } = this.market;
                const botStatus = mmStatus.bots.find(({ config: cfg }) => cfg.baseID === baseID && cfg.quoteID === quoteID && cfg.host === host);
                this.mmRunning = Boolean(botStatus === null || botStatus === void 0 ? void 0 : botStatus.running);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(this.mmRunning, page.mmRunning);
            if (this.mmRunning)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.orderForm, page.orderTypeBttns);
        });
    }
    /* setLoaderMsgVisibility displays a message in case a dex asset is not
     * supported
     */
    setLoaderMsgVisibility() {
        const { page } = this;
        const { isSupported, text } = this.assetsAreSupported();
        if (isSupported) {
            // make sure to hide the loader msg
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.loaderMsg);
            return;
        }
        page.loaderMsg.textContent = text;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.loaderMsg);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.notRegistered);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noWallet);
    }
    /*
     * showTokenApprovalForm displays the form used to give allowance to the
     * swap contract of a token.
     */
    showTokenApprovalForm(isBase) {
        return __awaiter(this, void 0, void 0, function* () {
            const assetID = isBase ? this.market.base.id : this.market.quote.id;
            this.approveTokenForm.setAsset(assetID, this.market.dex.host);
            this.showForm(this.page.approveTokenForm);
        });
    }
    /*
     * tokenAssetApprovalStatuses returns the approval status of the base and
     * quote assets. If the asset is not a token, it is considered approved.
     */
    tokenAssetApprovalStatuses() {
        var _a, _b;
        const { market: { base, quote } } = this;
        let baseAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved;
        let quoteAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved;
        if (base === null || base === void 0 ? void 0 : base.token) {
            const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[base.id];
            const baseVersion = this.market.dex.assets[base.id].version;
            if (((_a = baseAsset === null || baseAsset === void 0 ? void 0 : baseAsset.wallet) === null || _a === void 0 ? void 0 : _a.approved) && baseAsset.wallet.approved[baseVersion] !== undefined) {
                baseAssetApprovalStatus = baseAsset.wallet.approved[baseVersion];
            }
        }
        if (quote === null || quote === void 0 ? void 0 : quote.token) {
            const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quote.id];
            const quoteVersion = this.market.dex.assets[quote.id].version;
            if (((_b = quoteAsset === null || quoteAsset === void 0 ? void 0 : quoteAsset.wallet) === null || _b === void 0 ? void 0 : _b.approved) && quoteAsset.wallet.approved[quoteVersion] !== undefined) {
                quoteAssetApprovalStatus = quoteAsset.wallet.approved[quoteVersion];
            }
        }
        return {
            baseAssetApprovalStatus,
            quoteAssetApprovalStatus
        };
    }
    /*
     * setTokenApprovalVisibility sets the visibility of the token approval
     * panel elements.
     */
    setTokenApprovalVisibility() {
        const { page } = this;
        const { baseAssetApprovalStatus, quoteAssetApprovalStatus } = this.tokenAssetApprovalStatuses();
        if (baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.tokenApproval);
            page.sellBttn.removeAttribute('disabled');
            page.buyBttn.removeAttribute('disabled');
            return;
        }
        if (baseAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            page.sellBttn.setAttribute('disabled', 'disabled');
            page.buyBttn.removeAttribute('disabled');
            this.setBuy();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approvalRequiredSell);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approvalRequiredBuy, page.approvalRequiredBoth);
        }
        if (baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            page.buyBttn.setAttribute('disabled', 'disabled');
            page.sellBttn.removeAttribute('disabled');
            this.setSell();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approvalRequiredBuy);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approvalRequiredSell, page.approvalRequiredBoth);
        }
        // If they are both unapproved tokens, the order form will not be shown.
        if (baseAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved && quoteAssetApprovalStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Approved) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approvalRequiredBoth);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approvalRequiredSell, page.approvalRequiredBuy);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.tokenApproval);
        page.approvalPendingBaseSymbol.textContent = page.baseTokenAsset.textContent = this.market.base.symbol.toUpperCase();
        page.approvalPendingQuoteSymbol.textContent = page.quoteTokenAsset.textContent = this.market.quote.symbol.toUpperCase();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.NotApproved, page.approveBaseBttn);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.NotApproved, page.approveQuoteBttn);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(baseAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Pending, page.approvalPendingBase);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(quoteAssetApprovalStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ApprovalStatus.Pending, page.approvalPendingQuote);
    }
    /* setRegistrationStatusView sets the text content and class for the
     * registration status view
     */
    setRegistrationStatusView(titleContent, confStatusMsg, titleClass) {
        const page = this.page;
        page.regStatusTitle.textContent = titleContent;
        page.regStatusConfsDisplay.textContent = confStatusMsg;
        page.registrationStatus.classList.remove('completed', 'error', 'waiting');
        page.registrationStatus.classList.add(titleClass);
    }
    /*
     * updateRegistrationStatusView updates the view based on the current
     * registration status
     */
    updateRegistrationStatusView() {
        const { page, market: { dex } } = this;
        page.regStatusDex.textContent = dex.host;
        page.postingBondsDex.textContent = dex.host;
        if (dex.auth.effectiveTier >= 1) {
            this.setRegistrationStatusView(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_REGISTRATION_FEE_SUCCESS), '', 'completed');
            return;
        }
        const confStatuses = (dex.auth.pendingBonds || []).map(pending => {
            const confirmationsRequired = dex.bondAssets[pending.symbol].confs;
            return `${pending.confs} / ${confirmationsRequired}`;
        });
        const confStatusMsg = confStatuses.join(', ');
        this.setRegistrationStatusView(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_WAITING_FOR_CONFS), confStatusMsg, 'waiting');
    }
    /*
     * setRegistrationStatusVisibility toggles the registration status view based
     * on the dex data.
     */
    setRegistrationStatusVisibility() {
        const { page, market } = this;
        if (!market || !market.dex)
            return;
        // If dex is not connected to server, is not possible to know the
        // registration status.
        if (market.dex.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
            return;
        this.updateRegistrationStatusView();
        const showSection = (section) => {
            const elements = [page.registrationStatus, page.bondRequired, page.bondCreationPending, page.notRegistered];
            for (const el of elements) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(el === section, el);
            }
        };
        if (market.dex.auth.effectiveTier >= 1) {
            const toggle = () => __awaiter(this, void 0, void 0, function* () {
                showSection(undefined);
                this.resolveOrderFormVisibility();
            });
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.orderForm)) {
                // wait a couple of seconds before showing the form so the success
                // message is shown to the user
                setTimeout(toggle, 5000);
                return;
            }
            toggle();
        }
        else if (market.dex.viewOnly) {
            page.unregisteredDex.textContent = market.dex.host;
            showSection(page.notRegistered);
        }
        else if (this.hasPendingBonds()) {
            showSection(page.registrationStatus);
        }
        else if (market.dex.auth.targetTier > 0) {
            showSection(page.bondCreationPending);
        }
        else {
            page.acctTier.textContent = `${market.dex.auth.effectiveTier}`;
            page.dexSettingsLink.href = `/dexsettings/${market.dex.host}`;
            showSection(page.bondRequired);
        }
    }
    setOrderBttnText() {
        if (this.isSell()) {
            this.page.submitBttn.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SET_BUTTON_SELL, { asset: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].shortSymbol(this.market.baseCfg.unitInfo.conventional.unit) });
        }
        else
            this.page.submitBttn.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SET_BUTTON_BUY, { asset: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].shortSymbol(this.market.baseCfg.unitInfo.conventional.unit) });
    }
    setOrderBttnEnabled(isEnabled, disabledTooltipMsg) {
        const btn = this.page.submitBttn;
        if (isEnabled) {
            btn.removeAttribute('disabled');
            btn.removeAttribute('title');
        }
        else {
            btn.setAttribute('disabled', 'true');
            if (disabledTooltipMsg)
                btn.setAttribute('title', disabledTooltipMsg);
        }
    }
    updateOrderBttnState() {
        const { market: mkt, currentOrder: { qty: orderQty, rate: orderRate, isLimit, sell } } = this;
        const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[this.market.base.id].wallet;
        const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.quote.id].wallet;
        if (!baseWallet || !quoteWallet)
            return;
        if (orderQty <= 0 || orderQty < mkt.cfg.lotsize) {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_ERROR));
            return;
        }
        // Market orders
        if (!isLimit) {
            if (sell) {
                this.setOrderBttnEnabled(orderQty <= baseWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
            }
            else {
                this.setOrderBttnEnabled(orderQty <= quoteWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
            }
            return;
        }
        if (!orderRate) {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_RATE_ERROR));
            return;
        }
        // Limit sell
        if (sell) {
            if (baseWallet.balance.available < mkt.cfg.lotsize) {
                this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
                return;
            }
            if (mkt.maxSell) {
                this.setOrderBttnEnabled(orderQty <= mkt.maxSell.swap.value, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
            }
            return;
        }
        // Limit buy
        const rate = this.adjustedRate();
        const aLot = mkt.cfg.lotsize * (rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor);
        if (quoteWallet.balance.available < aLot) {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
            return;
        }
        if (mkt.maxBuys[rate]) {
            const enable = orderQty <= mkt.maxBuys[rate].swap.lots * mkt.cfg.lotsize;
            this.setOrderBttnEnabled(enable, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
        }
    }
    setCandleDurBttns() {
        const { page, market } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.durBttnBox);
        for (const dur of market.dex.candleDurs) {
            const bttn = page.durBttnTemplate.cloneNode(true);
            bttn.textContent = dur;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(bttn, 'click', () => this.candleDurationSelected(dur));
            page.durBttnBox.appendChild(bttn);
        }
        // load candlesticks here since we are resetting page.durBttnBox above.
        this.loadCandles();
    }
    /* setMarket sets the currently displayed market. */
    setMarket(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            const dex = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().user.exchanges[host];
            const page = this.page;
            window.cexBook = () => __awaiter(this, void 0, void 0, function* () {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/cexbook', { host, baseID, quoteID });
                console.log(res.book);
            });
            // reset form inputs
            page.lotField.value = '';
            page.qtyField.value = '';
            page.rateField.value = '';
            // clear depth chart and orderbook.
            this.depthChart.clear();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.buyRows);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.sellRows);
            // Clear recent matches for the previous market. This will be set when we
            // receive the order book subscription response.
            this.recentMatches = [];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.recentMatchesLiveList);
            // Hide the balance widget
            this.balanceWgt.setBalanceVisibility(false);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.notRegistered, page.bondRequired, page.noWallet);
            // If we have not yet connected, there is no dex.assets or any other
            // exchange data, so just put up a message and wait for the connection to be
            // established, at which time handleConnNote will refresh and reload.
            if (!dex || !dex.markets || dex.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected) {
                let errMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CONNECTION_FAILED);
                if (dex.disabled)
                    errMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_DEX_DISABLED_MSG);
                page.chartErrMsg.textContent = errMsg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.chartErrMsg);
                return;
            }
            for (const s of this.stats)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(s.row);
            const baseCfg = dex.assets[baseID];
            const quoteCfg = dex.assets[quoteID];
            const [bui, qui] = [(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(baseID, dex), (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(quoteID, dex)];
            const rateConversionFactor = _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.maxOrd, page.chartErrMsg);
            if (this.maxEstimateTimer) {
                window.clearTimeout(this.maxEstimateTimer);
                this.maxEstimateTimer = null;
            }
            const mktId = marketID(baseCfg.symbol, quoteCfg.symbol);
            const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[baseID];
            const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[quoteID];
            const mkt = {
                dex: dex,
                sid: mktId,
                cfg: dex.markets[mktId],
                // app().assets is a map of core.SupportedAsset type, which can be found at
                // client/core/types.go.
                base: baseAsset,
                quote: quoteAsset,
                baseUnitInfo: bui,
                quoteUnitInfo: qui,
                maxSell: null,
                maxBuys: {},
                maxSellRequested: false,
                candleCaches: {},
                baseCfg,
                quoteCfg,
                rateConversionFactor,
                sellBalance: 0,
                buyBalance: 0,
                bookLoaded: false
            };
            this.market = mkt;
            this.mm.setMarket(host, baseID, quoteID);
            this.mmRunning = undefined;
            page.lotSize.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(mkt.cfg.lotsize, mkt.baseUnitInfo);
            page.rateStep.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(mkt.cfg.ratestep / rateConversionFactor);
            this.displayMessageIfMissingWallet();
            this.balanceWgt.setWallets(host, baseID, quoteID);
            this.setMarketDetails();
            this.setCurrMarketPrice();
            // if (!dex.candleDurs || dex.candleDurs.length === 0) this.currentChart = depthChart
            // depth chart
            _ws__WEBPACK_IMPORTED_MODULE_9__["default"].request('loadmarket', makeMarket(host, baseID, quoteID));
            _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastMarketLK, {
                host: host,
                base: baseID,
                quote: quoteID
            });
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().updateMarketElements(this.main, baseID, quoteID, dex);
            this.marketList.select(host, baseID, quoteID);
            this.setLoaderMsgVisibility();
            this.setTokenApprovalVisibility();
            this.setRegistrationStatusVisibility();
            this.resolveOrderFormVisibility();
            this.setOrderBttnText();
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_RATE_ERROR));
            this.setCandleDurBttns();
            this.previewQuoteAmt(false);
            this.updateTitle();
            this.reputationMeter.setHost(dex.host);
            this.updateReputation();
            this.loadUserOrders();
        });
    }
    /*
      displayMessageForMissingWallet displays a custom message on the market's
      view if one or more of the selected market's wallet is missing.
    */
    displayMessageIfMissingWallet() {
        var _a, _b, _c, _d;
        const page = this.page;
        const mkt = this.market;
        const baseSym = mkt.baseCfg.symbol.toLocaleUpperCase();
        const quoteSym = mkt.quoteCfg.symbol.toLocaleUpperCase();
        let noWalletMsg = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noWallet);
        if (!((_a = mkt.base) === null || _a === void 0 ? void 0 : _a.wallet) && !((_b = mkt.quote) === null || _b === void 0 ? void 0 : _b.wallet))
            noWalletMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_WALLET_MSG, { asset1: baseSym, asset2: quoteSym });
        else if (!((_c = mkt.base) === null || _c === void 0 ? void 0 : _c.wallet))
            noWalletMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CREATE_ASSET_WALLET_MSG, { asset: baseSym });
        else if (!((_d = mkt.quote) === null || _d === void 0 ? void 0 : _d.wallet))
            noWalletMsg = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CREATE_ASSET_WALLET_MSG, { asset: quoteSym });
        else
            return;
        page.noWallet.textContent = noWalletMsg;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noWallet);
    }
    /*
     * reportDepthClick is a callback used by the DepthChart when the user clicks
     * on the chart area. The rate field is set to the x-value of the click.
     */
    reportDepthClick(r) {
        this.page.rateField.value = String(r);
        this.rateFieldChanged();
    }
    /*
     * reportDepthVolume accepts a volume report from the DepthChart and sets the
     * values in the chart legend.
     */
    reportDepthVolume(r) {
        const page = this.page;
        const { baseUnitInfo: b, quoteUnitInfo: q } = this.market;
        // DepthChart reports volumes in conventional units. We'll still use
        // formatCoinValue for formatting though.
        page.sellBookedBase.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.sellBase * b.conventional.conversionFactor, b);
        page.sellBookedQuote.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.sellQuote * q.conventional.conversionFactor, q);
        page.buyBookedBase.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.buyBase * b.conventional.conversionFactor, b);
        page.buyBookedQuote.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.buyQuote * q.conventional.conversionFactor, q);
    }
    /*
     * reportDepthMouse accepts information about the mouse position on the chart
     * area.
     */
    reportDepthMouse(r) {
        while (this.hovers.length)
            this.hovers.shift().classList.remove('hover');
        const page = this.page;
        if (!r) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.depthLegend);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.depthLegend);
        // If the user is hovered to within a small percent (based on chart width)
        // of a user order, highlight that order's row.
        for (const { div, ord } of Object.values(this.metaOrders)) {
            if (ord.status !== _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked)
                continue;
            if (r.hoverMarkers.indexOf(ord.rate) > -1) {
                div.classList.add('hover');
                this.hovers.push(div);
            }
        }
        page.hoverPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.rate);
        page.hoverVolume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(r.depth);
        page.hoverVolume.style.color = r.dotColor;
    }
    /*
     * reportDepthZoom accepts information about the current depth chart zoom
     * level. This information is saved to disk so that the zoom level can be
     * maintained across reloads.
     */
    reportDepthZoom(zoom) {
        _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].depthZoomLK, zoom);
    }
    reportMouseCandle(candle) {
        const page = this.page;
        if (!candle) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.candlesLegend);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.candlesLegend);
        page.candleStart.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.startRate / this.market.rateConversionFactor);
        page.candleEnd.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.endRate / this.market.rateConversionFactor);
        page.candleHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.highRate / this.market.rateConversionFactor);
        page.candleLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.lowRate / this.market.rateConversionFactor);
        page.candleVol.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(candle.matchVolume, this.market.baseUnitInfo);
    }
    /*
     * parseOrder pulls the order information from the form fields. Data is not
     * validated in any way.
     */
    parseOrder() {
        const page = this.page;
        let qtyField = page.qtyField;
        const limit = this.isLimit();
        const sell = this.isSell();
        const market = this.market;
        let qtyConv = market.baseUnitInfo.conventional.conversionFactor;
        if (!limit && !sell) {
            qtyField = page.mktBuyField;
            qtyConv = market.quoteUnitInfo.conventional.conversionFactor;
        }
        return {
            host: market.dex.host,
            isLimit: limit,
            sell: sell,
            base: market.base.id,
            quote: market.quote.id,
            qty: convertToAtoms(qtyField.value || '', qtyConv),
            rate: convertToAtoms(page.rateField.value || '', market.rateConversionFactor),
            tifnow: page.tifNow.checked || false,
            options: {}
        };
    }
    /**
     * previewQuoteAmt shows quote amount when rate or quantity input are changed
     */
    previewQuoteAmt(show) {
        const page = this.page;
        if (!this.market.base || !this.market.quote)
            return; // Not a supported asset
        const order = this.currentOrder = this.parseOrder();
        const adjusted = this.adjustedRate();
        page.orderErr.textContent = '';
        if (adjusted) {
            if (order.sell)
                this.preSell();
            else
                this.preBuy();
        }
        this.depthLines.input = [];
        if (adjusted && this.isLimit()) {
            this.depthLines.input = [{
                    rate: order.rate / this.market.rateConversionFactor,
                    color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine
                }];
        }
        this.drawChartLines();
        if (!show || !adjusted || !order.qty) {
            page.orderPreview.textContent = '';
            this.drawChartLines();
            return;
        }
        const { unitInfo: { conventional: { unit } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[order.quote];
        const quoteQty = order.qty * order.rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
        const total = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteQty, this.market.quoteUnitInfo);
        page.orderPreview.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_PREVIEW, { total, asset: unit });
        if (this.isSell())
            this.preSell();
        else
            this.preBuy();
    }
    /**
     * preSell populates the max order message for the largest available sell.
     */
    preSell() {
        const mkt = this.market;
        const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.base.id].wallet;
        if (baseWallet.balance.available < mkt.cfg.lotsize) {
            this.setMaxOrder(null);
            this.updateOrderBttnState();
            return;
        }
        if (mkt.maxSell) {
            this.setMaxOrder(mkt.maxSell.swap);
            this.updateOrderBttnState();
            return;
        }
        if (mkt.maxSellRequested)
            return;
        mkt.maxSellRequested = true;
        // We only fetch pre-sell once per balance update, so don't delay.
        this.scheduleMaxEstimate('/api/maxsell', {}, 0, (res) => {
            mkt.maxSellRequested = false;
            mkt.maxSell = res.maxSell;
            mkt.sellBalance = baseWallet.balance.available;
            this.setMaxOrder(res.maxSell.swap);
            this.updateOrderBttnState();
        });
    }
    /**
     * preBuy populates the max order message for the largest available buy.
     */
    preBuy() {
        const mkt = this.market;
        const rate = this.adjustedRate();
        const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.quote.id].wallet;
        if (!quoteWallet)
            return;
        const aLot = mkt.cfg.lotsize * (rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor);
        if (quoteWallet.balance.available < aLot) {
            this.setMaxOrder(null);
            this.updateOrderBttnState();
            return;
        }
        if (mkt.maxBuys[rate]) {
            this.setMaxOrder(mkt.maxBuys[rate].swap);
            this.updateOrderBttnState();
            return;
        }
        // 0 delay for first fetch after balance update or market change, otherwise
        // meter these at 1 / sec.
        const delay = Object.keys(mkt.maxBuys).length ? 350 : 0;
        this.scheduleMaxEstimate('/api/maxbuy', { rate }, delay, (res) => {
            mkt.maxBuys[rate] = res.maxBuy;
            mkt.buyBalance = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[mkt.quote.id].wallet.balance.available;
            this.setMaxOrder(res.maxBuy.swap);
            this.updateOrderBttnState();
        });
    }
    /**
     * scheduleMaxEstimate shows the loading icon and schedules a call to an order
     * estimate api endpoint. If another call to scheduleMaxEstimate is made before
     * this one is fired (after delay), this call will be canceled.
     */
    scheduleMaxEstimate(path, args, delay, success) {
        const page = this.page;
        if (!this.maxLoaded)
            this.maxLoaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.maxOrd);
        const [bid, qid] = [this.market.base.id, this.market.quote.id];
        const [bWallet, qWallet] = [(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[bid].wallet, (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[qid].wallet];
        if (!bWallet || !bWallet.running || !qWallet || !qWallet.running)
            return;
        if (this.maxEstimateTimer)
            window.clearTimeout(this.maxEstimateTimer);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxOrd, page.maxLotBox);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.maxAboveZero, page.maxZeroNoFees, page.maxZeroNoBal);
        page.maxFromLots.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_CALCULATING);
        page.maxFromLotsLbl.textContent = '';
        this.maxOrderUpdateCounter++;
        const counter = this.maxOrderUpdateCounter;
        this.maxEstimateTimer = window.setTimeout(() => __awaiter(this, void 0, void 0, function* () {
            this.maxEstimateTimer = null;
            if (counter !== this.maxOrderUpdateCounter)
                return;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)(path, Object.assign({ host: this.market.dex.host, base: bid, quote: qid }, args));
            if (counter !== this.maxOrderUpdateCounter)
                return;
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                console.warn('max order estimate not available:', res);
                page.maxFromLots.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ESTIMATE_UNAVAILABLE);
                if (this.maxLoaded) {
                    this.maxLoaded();
                    this.maxLoaded = null;
                }
                return;
            }
            success(res);
        }), delay);
    }
    /* setMaxOrder sets the max order text. */
    setMaxOrder(maxOrder) {
        const page = this.page;
        if (this.maxLoaded) {
            this.maxLoaded();
            this.maxLoaded = null;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxOrd, page.maxLotBox);
        const sell = this.isSell();
        let lots = 0;
        if (maxOrder)
            lots = maxOrder.lots;
        page.maxFromLots.textContent = lots.toString();
        // XXX add plural into format details, so we don't need this
        page.maxFromLotsLbl.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(lots === 1 ? _locales__WEBPACK_IMPORTED_MODULE_10__.ID_LOT : _locales__WEBPACK_IMPORTED_MODULE_10__.ID_LOTS);
        if (!maxOrder)
            return;
        const fromAsset = sell ? this.market.base : this.market.quote;
        if (lots === 0) {
            // If we have a maxOrder, see if we can guess why we have no lots.
            let lotSize = this.market.cfg.lotsize;
            if (!sell) {
                const conversionRate = this.anyRate()[1];
                if (conversionRate === 0)
                    return;
                lotSize = lotSize * conversionRate;
            }
            const haveQty = fromAsset.wallet.balance.available / lotSize > 0;
            if (haveQty) {
                if (fromAsset.token) {
                    const { wallet: { balance: { available: feeAvail } }, unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[fromAsset.token.parentID];
                    if (feeAvail < maxOrder.feeReservesPerLot) {
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxZeroNoFees);
                        page.maxZeroNoFeesTicker.textContent = unitInfo.conventional.unit;
                        page.maxZeroMinFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(maxOrder.feeReservesPerLot, unitInfo);
                    }
                    // It looks like we should be able to afford it, but maybe some fees we're not seeing.
                    // Show nothing.
                    return;
                }
                // Not a token. Maybe we have enough for the swap but not for fees.
                const fundedLots = fromAsset.wallet.balance.available / (lotSize + maxOrder.feeReservesPerLot);
                if (fundedLots > 0)
                    return; // Not sure why. Could be split txs or utxos. Just show nothing.
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxZeroNoBal);
            page.maxZeroNoBalTicker.textContent = fromAsset.unitInfo.conventional.unit;
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxAboveZero);
        page.maxFromAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(maxOrder.value || 0, fromAsset.unitInfo);
        page.maxFromTicker.textContent = fromAsset.unitInfo.conventional.unit;
        // Could subtract the maxOrder.redemptionFees here.
        // The qty conversion doesn't fit well with the new design.
        // TODO: Make this work somehow?
        // const toConversion = sell ? this.adjustedRate() / OrderUtil.RateEncodingFactor : OrderUtil.RateEncodingFactor / this.adjustedRate()
        // page.maxToAmt.textContent = Doc.formatCoinValue((maxOrder.value || 0) * toConversion, toAsset.unitInfo)
        // page.maxToTicker.textContent = toAsset.symbol.toUpperCase()
    }
    /*
     * validateOrder performs some basic order sanity checks, returning boolean
     * true if the order appears valid.
     */
    validateOrder(order) {
        const { page, market: { cfg: { minimumRate }, rateConversionFactor } } = this;
        if (order.isLimit) {
            if (!order.rate) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
                page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ZERO_RATE);
                return false;
            }
            if (order.rate < minimumRate) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
                const [r, minRate] = [order.rate / rateConversionFactor, minimumRate / rateConversionFactor];
                page.orderErr.textContent = `rate is lower than the market's minimum rate. ${r} < ${minRate}`;
                return false;
            }
        }
        if (!order.qty) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
            page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ZERO_QUANTITY);
            return false;
        }
        return true;
    }
    /* handleBook accepts the data sent in the 'book' notification. */
    handleBook(data) {
        var _a;
        const { cfg, baseUnitInfo, quoteUnitInfo, baseCfg, quoteCfg } = this.market;
        this.book = new _orderbook__WEBPACK_IMPORTED_MODULE_3__["default"](data, baseCfg.symbol, quoteCfg.symbol);
        this.loadTable();
        for (const order of (data.book.epoch || [])) {
            if (order.rate > 0)
                this.book.add(order);
            this.addTableOrder(order);
        }
        if (!this.book) {
            this.depthChart.clear();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.buyRows);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.sellRows);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.epochLine);
        if (this.loadingAnimations.depth)
            this.loadingAnimations.depth.stop();
        this.depthChart.canvas.classList.remove('invisible');
        this.depthChart.set(this.book, cfg.lotsize, cfg.ratestep, baseUnitInfo, quoteUnitInfo);
        this.recentMatches = (_a = data.book.recentMatches) !== null && _a !== void 0 ? _a : [];
        this.refreshRecentMatchesTable();
    }
    /*
     * midGapConventional is the same as midGap, but returns the mid-gap rate as
     * the conventional ratio. This is used to convert from a conventional
     * quantity from base to quote or vice-versa, or for display purposes.
     */
    midGapConventional() {
        const gap = this.midGap();
        if (!gap)
            return gap;
        const { baseUnitInfo: b, quoteUnitInfo: q } = this.market;
        return gap * b.conventional.conversionFactor / q.conventional.conversionFactor;
    }
    /*
     * midGap returns the value in the middle of the best buy and best sell. If
     * either one of the buy or sell sides are empty, midGap returns the best rate
     * from the other side. If both sides are empty, midGap returns the value
     * null. The rate returned is the atomic ratio, used for conversion. For a
     * conventional rate for display or to convert conventional units, use
     * midGapConventional
     */
    midGap() {
        const book = this.book;
        if (!book)
            return;
        if (book.buys && book.buys.length) {
            if (book.sells && book.sells.length) {
                return (book.buys[0].msgRate + book.sells[0].msgRate) / 2 / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
            }
            return book.buys[0].msgRate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
        }
        if (book.sells && book.sells.length) {
            return book.sells[0].msgRate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
        }
        return null;
    }
    /*
     * setMarketBuyOrderEstimate sets the "min. buy" display for the current
     * market.
     */
    setMarketBuyOrderEstimate() {
        const market = this.market;
        const lotSize = market.cfg.lotsize;
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().user.exchanges[market.dex.host];
        const buffer = xc.markets[market.sid].buybuffer;
        const gap = this.midGapConventional();
        if (gap) {
            this.page.minMktBuy.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(lotSize * buffer * gap, market.baseUnitInfo);
        }
    }
    maxUserOrderCount() {
        const { dex: { host }, cfg: { name: mktID } } = this.market;
        return Math.max(maxUserOrdersShown, (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().orders(host, mktID).length);
    }
    loadUserOrders() {
        return __awaiter(this, void 0, void 0, function* () {
            const { base: b, quote: q, dex: { host }, cfg: { name: mktID } } = this.market;
            for (const oid in this.metaOrders)
                delete this.metaOrders[oid];
            if (!b || !q)
                return this.resolveUserOrders([]); // unsupported asset
            const activeOrders = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().orders(host, mktID);
            if (activeOrders.length >= maxUserOrdersShown)
                return this.resolveUserOrders(activeOrders);
            const filter = {
                hosts: [host],
                market: { baseID: b.id, quoteID: q.id },
                n: this.maxUserOrderCount()
            };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/orders', filter);
            const orders = res.orders || [];
            // Make sure all active orders are in there. The /orders API sorts by time,
            // so if there is are 10 cancelled/executed orders newer than an old active
            // order, the active order wouldn't be included in the result.
            for (const activeOrd of activeOrders)
                if (!orders.some((dbOrd) => dbOrd.id === activeOrd.id))
                    orders.push(activeOrd);
            return this.resolveUserOrders(res.orders || []);
        });
    }
    /* refreshActiveOrders refreshes the user's active order list. */
    refreshActiveOrders() {
        const orders = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().orders(this.market.dex.host, marketID(this.market.baseCfg.symbol, this.market.quoteCfg.symbol));
        return this.resolveUserOrders(orders);
    }
    resolveUserOrders(orders) {
        const { page, metaOrders, market } = this;
        const cfg = market.cfg;
        const orderIsActive = (ord) => ord.status < _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusExecuted || _orderutil__WEBPACK_IMPORTED_MODULE_8__.hasActiveMatches(ord);
        for (const ord of orders)
            metaOrders[ord.id] = { ord: ord };
        let sortedOrders = Object.keys(metaOrders).map((oid) => metaOrders[oid]);
        sortedOrders.sort((a, b) => {
            const [aActive, bActive] = [orderIsActive(a.ord), orderIsActive(b.ord)];
            if (aActive && !bActive)
                return -1;
            else if (!aActive && bActive)
                return 1;
            return b.ord.submitTime - a.ord.submitTime;
        });
        const n = this.maxUserOrderCount();
        if (sortedOrders.length > n) {
            sortedOrders = sortedOrders.slice(0, n);
        }
        for (const oid in metaOrders)
            delete metaOrders[oid];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.userOrders);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(sortedOrders === null || sortedOrders === void 0 ? void 0 : sortedOrders.length, page.userOrders);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!(sortedOrders === null || sortedOrders === void 0 ? void 0 : sortedOrders.length), page.userNoOrders);
        let unreadyOrders = false;
        for (const mord of sortedOrders) {
            const div = page.userOrderTmpl.cloneNode(true);
            page.userOrders.appendChild(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            const header = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tmpl.header);
            const details = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tmpl.details);
            mord.div = div;
            mord.header = header;
            mord.details = details;
            const ord = mord.ord;
            const orderID = ord.id;
            const isActive = orderIsActive(ord);
            // No need to track in-flight orders here. We've already added it to
            // display.
            if (orderID)
                metaOrders[orderID] = mord;
            if (!ord.readyToTick && _orderutil__WEBPACK_IMPORTED_MODULE_8__.hasActiveMatches(ord)) {
                tmpl.header.classList.add('unready-user-order');
                unreadyOrders = true;
            }
            header.sideLight.classList.add(ord.sell ? 'sell' : 'buy');
            if (!isActive)
                header.sideLight.classList.add('inactive');
            details.side.textContent = mord.header.side.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_8__.sellString(ord);
            details.side.classList.add(ord.sell ? 'sellcolor' : 'buycolor');
            header.side.classList.add(ord.sell ? 'sellcolor' : 'buycolor');
            details.qty.textContent = mord.header.qty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, market.baseUnitInfo);
            let rateStr;
            if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Market)
                rateStr = this.marketOrderRateString(ord, market);
            else
                rateStr = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatRateFullPrecision(ord.rate, market.baseUnitInfo, market.quoteUnitInfo, cfg.ratestep);
            details.rate.textContent = mord.header.rate.textContent = rateStr;
            header.baseSymbol.textContent = market.baseUnitInfo.conventional.unit;
            details.type.textContent = market.quoteUnitInfo.conventional.unit;
            this.updateMetaOrder(mord);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(div, 'mouseenter', () => {
                this.activeMarkerRate = ord.rate;
                this.setDepthMarkers();
            });
            const showCancel = (e) => {
                e.stopPropagation();
                this.showCancel(div, orderID);
            };
            const showAccelerate = (e) => {
                e.stopPropagation();
                this.showAccelerate(ord);
            };
            if (!orderID) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(details.accelerateBttn);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(details.cancelBttn);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(details.link);
            }
            else {
                if (_orderutil__WEBPACK_IMPORTED_MODULE_8__.isCancellable(ord)) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(details.cancelBttn);
                    bind(details.cancelBttn, 'click', (e) => { showCancel(e); });
                }
                bind(details.accelerateBttn, 'click', (e) => { showAccelerate(e); });
                if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(ord)) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(details.accelerateBttn);
                }
                details.link.href = `order/${orderID}`;
                (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindInternalNavigation(div);
            }
            let currentFloater;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.header, 'click', () => {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(tmpl.details)) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.details);
                    header.expander.classList.add('ico-arrowdown');
                    header.expander.classList.remove('ico-arrowup');
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.details);
                header.expander.classList.remove('ico-arrowdown');
                header.expander.classList.add('ico-arrowup');
                if (currentFloater)
                    currentFloater.remove();
            });
            /**
             * We'll show the button menu when they hover over the header. To avoid
             * pushing the layout around, we'll show the buttons as an absolutely
             * positioned copy of the button menu.
             */
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.header, 'mouseenter', () => {
                // Don't show the copy if the details are already displayed.
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(tmpl.details))
                    return;
                if (currentFloater)
                    currentFloater.remove();
                // Create and position the element based on the position of the header.
                const floater = document.createElement('div');
                currentFloater = floater;
                document.body.appendChild(floater);
                floater.className = 'user-order-floaty-menu';
                const m = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(tmpl.header);
                const y = m.bodyTop + m.height;
                floater.style.top = `${y - 1}px`; // - 1 to hide border on header div
                floater.style.left = `${m.bodyLeft}px`;
                // Get the updated version of the order
                const mord = this.metaOrders[orderID];
                const ord = mord.ord;
                const addButton = (baseBttn, cb) => {
                    const icon = baseBttn.cloneNode(true);
                    floater.appendChild(icon);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(icon);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(icon, 'click', (e) => { cb(e); });
                };
                if (_orderutil__WEBPACK_IMPORTED_MODULE_8__.isCancellable(ord))
                    addButton(details.cancelBttn, (e) => { showCancel(e); });
                if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(ord))
                    addButton(details.accelerateBttn, (e) => { showAccelerate(e); });
                floater.appendChild(details.link.cloneNode(true));
                const ogScrollY = page.orderScroller.scrollTop;
                // Set up the hover interactions.
                const moved = (e) => {
                    // If the user scrolled, reposition the float menu. This keeps the
                    // menu from following us around, which can prevent removal below.
                    const yShift = page.orderScroller.scrollTop - ogScrollY;
                    floater.style.top = `${y + yShift}px`;
                    if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, floater) || _doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, div))
                        return;
                    floater.remove();
                    currentFloater = null;
                    document.removeEventListener('mousemove', moved);
                    page.orderScroller.removeEventListener('scroll', moved);
                };
                document.addEventListener('mousemove', moved);
                page.orderScroller.addEventListener('scroll', moved);
            });
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(div);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(unreadyOrders, page.unreadyOrdersMsg);
        this.setDepthMarkers();
    }
    /*
     marketOrderRateString uses the market config rate step to format the average
     market order rate.
    */
    marketOrderRateString(ord, mkt) {
        var _a;
        if (!((_a = ord.matches) === null || _a === void 0 ? void 0 : _a.length))
            return _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_MARKET_ORDER);
        let rateStr = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatRateFullPrecision(_orderutil__WEBPACK_IMPORTED_MODULE_8__.averageRate(ord), mkt.baseUnitInfo, mkt.quoteUnitInfo, mkt.cfg.ratestep);
        if (ord.matches.length > 1)
            rateStr = '~ ' + rateStr; // ~ only makes sense if the order has more than one match
        return rateStr;
    }
    /*
    * updateMetaOrder sets the td contents of the user's order table row.
    */
    updateMetaOrder(mord) {
        const { header, details, ord } = mord;
        if (ord.status <= _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked || _orderutil__WEBPACK_IMPORTED_MODULE_8__.hasActiveMatches(ord))
            header.activeLight.classList.add('active');
        else
            header.activeLight.classList.remove('active');
        details.status.textContent = header.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_8__.statusString(ord);
        details.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(ord.submitTime);
        details.filled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_8__.filled(ord) / ord.qty * 100).toFixed(1)}%`;
        details.settled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_8__.settled(ord) / ord.qty * 100).toFixed(1)}%`;
    }
    /* setMarkers sets the depth chart markers for booked orders. */
    setDepthMarkers() {
        const markers = {
            buys: [],
            sells: []
        };
        const rateFactor = this.market.rateConversionFactor;
        for (const { ord } of Object.values(this.metaOrders)) {
            if (ord.rate && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked) {
                if (ord.sell) {
                    markers.sells.push({
                        rate: ord.rate / rateFactor,
                        active: ord.rate === this.activeMarkerRate
                    });
                }
                else {
                    markers.buys.push({
                        rate: ord.rate / rateFactor,
                        active: ord.rate === this.activeMarkerRate
                    });
                }
            }
        }
        this.depthChart.setMarkers(markers);
        if (this.book)
            this.depthChart.draw();
    }
    /* updateTitle update the browser title based on the midgap value and the
     * selected assets.
     */
    updateTitle() {
        // gets first price value from buy or from sell, so we can show it on
        // title.
        const midGapValue = this.midGapConventional();
        const { baseUnitInfo: { conventional: { unit: bUnit } }, quoteUnitInfo: { conventional: { unit: qUnit } } } = this.market;
        if (!midGapValue)
            document.title = `${bUnit}${qUnit} | ${this.ogTitle}`;
        else
            document.title = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(midGapValue)} | ${bUnit}${qUnit} | ${this.ogTitle}`; // more than 6 numbers it gets too big for the title.
    }
    /* handleBookRoute is the handler for the 'book' notification, which is sent
     * in response to a new market subscription. The data received will contain
     * the entire order book.
     */
    handleBookRoute(note) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleBookRoute:', note);
        const mktBook = note.payload;
        const { baseCfg: b, quoteCfg: q, dex: { host } } = this.market;
        if (mktBook.base !== b.id || mktBook.quote !== q.id || note.host !== host)
            return; // user already changed markets
        this.handleBook(mktBook);
        this.market.bookLoaded = true;
        this.updateTitle();
        this.setMarketBuyOrderEstimate();
    }
    /* handleBookOrderRoute is the handler for 'book_order' notifications. */
    handleBookOrderRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleBookOrderRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const order = data.payload;
        if (order.rate > 0)
            this.book.add(order);
        this.addTableOrder(order);
        this.updateTitle();
        this.depthChart.draw();
    }
    /* handleUnbookOrderRoute is the handler for 'unbook_order' notifications. */
    handleUnbookOrderRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleUnbookOrderRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const order = data.payload;
        this.book.remove(order.token);
        this.removeTableOrder(order);
        this.updateTitle();
        this.depthChart.draw();
    }
    /*
     * handleUpdateRemainingRoute is the handler for 'update_remaining'
     * notifications.
     */
    handleUpdateRemainingRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleUpdateRemainingRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const update = data.payload;
        this.book.updateRemaining(update.token, update.qty, update.qtyAtomic);
        this.updateTableOrder(update);
        this.depthChart.draw();
    }
    /* handleEpochOrderRoute is the handler for 'epoch_order' notifications. */
    handleEpochOrderRoute(data) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleEpochOrderRoute:', data);
        if (data.host !== this.market.dex.host || data.marketID !== this.market.sid)
            return;
        const order = data.payload;
        if (order.msgRate > 0)
            this.book.add(order); // No cancels or market orders
        if (order.qtyAtomic > 0)
            this.addTableOrder(order); // No cancel orders
        this.depthChart.draw();
    }
    /* handleCandlesRoute is the handler for 'candles' notifications. */
    handleCandlesRoute(data) {
        if (this.candlesLoading) {
            clearTimeout(this.candlesLoading.timer);
            this.candlesLoading.loaded();
            this.candlesLoading = null;
        }
        if (data.host !== this.market.dex.host || data.marketID !== this.market.cfg.name)
            return;
        const dur = data.payload.dur;
        this.market.candleCaches[dur] = data.payload;
        this.setHighLow();
        if (this.candleDur !== dur)
            return;
        if (this.loadingAnimations.candles)
            this.loadingAnimations.candles.stop();
        this.candleChart.canvas.classList.remove('invisible');
        this.candleChart.setCandles(data.payload, this.market.cfg, this.market.baseUnitInfo, this.market.quoteUnitInfo);
    }
    handleEpochMatchSummary(data) {
        this.addRecentMatches(data.payload.matchSummaries);
        this.refreshRecentMatchesTable();
    }
    /* handleCandleUpdateRoute is the handler for 'candle_update' notifications. */
    handleCandleUpdateRoute(data) {
        if (data.host !== this.market.dex.host)
            return;
        const { dur, candle } = data.payload;
        const cache = this.market.candleCaches[dur];
        if (!cache)
            return; // must not have seen the 'candles' notification yet?
        const candles = cache.candles;
        if (candles.length === 0)
            candles.push(candle);
        else {
            const last = candles[candles.length - 1];
            if (last.startStamp === candle.startStamp)
                candles[candles.length - 1] = candle;
            else
                candles.push(candle);
        }
        if (this.candleDur !== dur)
            return;
        this.candleChart.draw();
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            this.currentForm = form;
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(...Array.from(page.forms.children));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    /*
     * showToggleWalletStatus displays the toggleWalletStatusConfirm form to
     * enable a wallet.
     */
    showToggleWalletStatus(asset) {
        const page = this.page;
        this.openAsset = asset;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr, page.walletStatusDisable, page.disableWalletMsg);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletStatusEnable, page.enableWalletMsg);
        this.showForm(page.toggleWalletStatusConfirm);
    }
    /*
     * toggleWalletStatus toggle wallets status to enabled.
     */
    toggleWalletStatus() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr);
            const url = '/api/togglewalletstatus';
            const req = {
                assetID: this.openAsset.id,
                disable: false
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.toggleWalletStatusConfirm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)(url, req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                page.toggleWalletStatusErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.toggleWalletStatusErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
            this.balanceWgt.updateAsset(this.openAsset.id);
        });
    }
    /* showVerify shows the form to accept the currently parsed order information
     * and confirm submission of the order to the dex.
     */
    showVerify() {
        this.preorderCache = {};
        const page = this.page;
        const order = this.currentOrder = this.parseOrder();
        const isSell = order.sell;
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[order.base];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[order.quote];
        const toAsset = isSell ? quoteAsset : baseAsset;
        const fromAsset = isSell ? baseAsset : quoteAsset;
        const setIcon = (icon) => {
            switch (icon.dataset.icon) {
                case 'from':
                    if (fromAsset.token) {
                        const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[fromAsset.token.parentID];
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                    }
                    else {
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(fromAsset.symbol);
                    }
                    break;
                case 'to':
                    if (toAsset.token) {
                        const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[toAsset.token.parentID];
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                    }
                    else {
                        icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(toAsset.symbol);
                    }
            }
        };
        // Set the to and from icons in the fee details pane.
        for (const icon of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.vDetailPane, '[data-icon]')) {
            setIcon(icon);
        }
        // Set the to and from icons in the fee summary pane.
        for (const icon of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.vFeeSummary, '[data-icon]')) {
            setIcon(icon);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderErr);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorder);
        page.vBuySell.textContent = isSell ? _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SELLING) : _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BUYING);
        const buySellStr = isSell ? _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_SELL) : _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BUY);
        page.vSideSubmit.textContent = buySellStr;
        page.vOrderHost.textContent = order.host;
        if (order.isLimit) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.verifyLimit);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.verifyMarket);
            const orderDesc = `Limit ${buySellStr} Order`;
            page.vOrderType.textContent = order.tifnow ? orderDesc + ' (immediate)' : orderDesc;
            page.vRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(order.rate / this.market.rateConversionFactor);
            page.vQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(order.qty, baseAsset.unitInfo);
            const total = order.rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor * order.qty;
            page.vTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(total, quoteAsset.unitInfo);
            // Format total fiat value.
            this.showFiatValue(quoteAsset.id, total, page.vFiatTotal);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.verifyLimit);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.verifyMarket);
            page.vOrderType.textContent = `Market ${buySellStr} Order`;
            const ui = order.sell ? this.market.baseUnitInfo : this.market.quoteUnitInfo;
            page.vmFromTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(order.qty, ui);
            page.vmFromAsset.textContent = fromAsset.symbol.toUpperCase();
            // Format fromAsset fiat value.
            this.showFiatValue(fromAsset.id, order.qty, page.vmFromTotalFiat);
            const gap = this.midGap();
            if (gap) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vMarketEstimate);
                const received = order.sell ? order.qty * gap : order.qty / gap;
                page.vmToTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(received, toAsset.unitInfo);
                page.vmToAsset.textContent = toAsset.symbol.toUpperCase();
                // Format received value to fiat equivalent.
                this.showFiatValue(toAsset.id, received, page.vmTotalFiat);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vMarketEstimate);
            }
        }
        // Visually differentiate between buy/sell orders.
        if (isSell) {
            page.vHeader.classList.add(sellBtnClass);
            page.vHeader.classList.remove(buyBtnClass);
            page.vSubmit.classList.add(sellBtnClass);
            page.vSubmit.classList.remove(buyBtnClass);
        }
        else {
            page.vHeader.classList.add(buyBtnClass);
            page.vHeader.classList.remove(sellBtnClass);
            page.vSubmit.classList.add(buyBtnClass);
            page.vSubmit.classList.remove(sellBtnClass);
        }
        this.showVerifyForm();
        if (baseAsset.wallet.open && quoteAsset.wallet.open)
            this.preOrder(order);
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorder);
            this.unlockWalletsForEstimates();
        }
    }
    // showFiatValue displays the fiat equivalent for an order quantity.
    showFiatValue(assetID, qty, display) {
        if (display) {
            const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[assetID];
            display.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(qty, rate, (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(assetID));
            if (rate)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(display.parentElement);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(display.parentElement);
        }
    }
    /* showVerifyForm displays form to verify an order */
    showVerifyForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vErr);
            this.showForm(page.verifyForm);
        });
    }
    /*
     * unlockWalletsForEstimates unlocks any locked wallets with the provided
     * password.
     */
    unlockWalletsForEstimates() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.verifyForm);
            yield this.unlockMarketWallets();
            loaded();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorder);
            this.preOrder(this.parseOrder());
        });
    }
    unlockWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/openwallet', { assetID });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                throw Error('error unlocking wallet ' + res.msg);
            }
            this.balanceWgt.updateAsset(assetID);
        });
    }
    /*
     * unlockMarketWallets unlocks both the base and quote wallets for the current
     * market, if locked.
     */
    unlockMarketWallets() {
        return __awaiter(this, void 0, void 0, function* () {
            const { base, quote } = this.market;
            const assetIDs = [];
            if (!base.wallet.open)
                assetIDs.push(base.id);
            if (!quote.wallet.open)
                assetIDs.push(quote.id);
            for (const assetID of assetIDs) {
                this.unlockWallet(assetID);
            }
        });
    }
    /* fetchPreorder fetches the pre-order estimates and options. */
    fetchPreorder(order) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const cacheKey = JSON.stringify(order.options);
            const cached = this.preorderCache[cacheKey];
            if (cached)
                return cached;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.verifyForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/preorder', wireOrder(order));
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res))
                return { err: res.msg };
            this.preorderCache[cacheKey] = res.estimate;
            return res.estimate;
        });
    }
    /*
     * setPreorderErr sets and displays the pre-order error message and hides the
     * pre-order details box.
     */
    setPreorderErr(msg) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorder);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorderErr);
        page.vPreorderErrTip.dataset.tooltip = msg;
    }
    showPreOrderAdvancedOptions() {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showAdvancedOptions);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.hideAdvancedOptions, page.vOtherOrderOpts);
    }
    hidePreOrderAdvancedOptions() {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.hideAdvancedOptions, page.vOtherOrderOpts);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showAdvancedOptions);
    }
    reloadOrderOpts(order, swap, redeem, changed) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.vDefaultOrderOpts, page.vOtherOrderOpts);
        const addOption = (opt, isSwap) => {
            const el = _orderutil__WEBPACK_IMPORTED_MODULE_8__.optionElement(opt, order, changed, isSwap);
            if (opt.showByDefault)
                page.vDefaultOrderOpts.appendChild(el);
            else
                page.vOtherOrderOpts.appendChild(el);
        };
        for (const opt of swap.options || [])
            addOption(opt, true);
        for (const opt of redeem.options || [])
            addOption(opt, false);
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(page.vDefaultOrderOpts);
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(page.vOtherOrderOpts);
    }
    /* preOrder loads the options and fetches pre-order estimates */
    preOrder(order) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            // Add swap options.
            const refreshPreorder = () => __awaiter(this, void 0, void 0, function* () {
                const res = yield this.fetchPreorder(order);
                if (res.err)
                    return this.setPreorderErr(res.err);
                const est = res;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderErr);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorder);
                const { swap, redeem } = est;
                swap.options = swap.options || [];
                redeem.options = redeem.options || [];
                this.setFeeEstimates(swap, redeem, order);
                const changed = () => __awaiter(this, void 0, void 0, function* () {
                    yield refreshPreorder();
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(400, progress => {
                        page.vFeeSummary.style.backgroundColor = `rgba(128, 128, 128, ${0.5 - 0.5 * progress})`;
                    });
                });
                // bind show or hide advanced pre order options.
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showAdvancedOptions, 'click', () => { this.showPreOrderAdvancedOptions(); });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.hideAdvancedOptions, 'click', () => { this.hidePreOrderAdvancedOptions(); });
                this.reloadOrderOpts(order, swap, redeem, changed);
            });
            refreshPreorder();
        });
    }
    /* setFeeEstimates sets all of the pre-order estimate fields */
    setFeeEstimates(swap, redeem, order) {
        const { page, market } = this;
        if (!swap.estimate || !redeem.estimate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vPreorderEstimates);
            return; // preOrder may return just options, no fee estimates
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vPreorderEstimates);
        const { baseUnitInfo, quoteUnitInfo, rateConversionFactor } = market;
        const fmtPct = (value) => {
            if (value < 0.05)
                return '< 0.1';
            return percentFormatter.format(value);
        };
        // If the asset is a token, in order to calculate the fee as a percentage
        // of the total order, we try to  use the fiat rates to find out the
        // exchange rate between the token and parent assets.
        // Initially these are set to 1, which we would use if the asset is not a
        // token and no conversion is needed.
        let baseExchangeRate = 1;
        let quoteExchangeRate = 1;
        let baseFeeAssetUI = baseUnitInfo;
        let quoteFeeAssetUI = quoteUnitInfo;
        if (market.base.token) {
            const parent = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[market.base.token.parentID];
            baseFeeAssetUI = parent.unitInfo;
            const tokenFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[market.base.id];
            const parentFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[parent.id];
            if (tokenFiatRate && parentFiatRate) {
                const conventionalRate = parentFiatRate / tokenFiatRate;
                baseExchangeRate = conventionalRate * baseUnitInfo.conventional.conversionFactor / parent.unitInfo.conventional.conversionFactor;
            }
            else {
                baseExchangeRate = 0;
            }
        }
        if (market.quote.token) {
            const parent = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[market.quote.token.parentID];
            quoteFeeAssetUI = parent.unitInfo;
            const tokenFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[market.quote.id];
            const parentFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[parent.id];
            if (tokenFiatRate && parentFiatRate) {
                const conventionalRate = parentFiatRate / tokenFiatRate;
                quoteExchangeRate = conventionalRate * quoteUnitInfo.conventional.conversionFactor / parent.unitInfo.conventional.conversionFactor;
            }
            else {
                quoteExchangeRate = 0;
            }
        }
        let [toFeeAssetUI, fromFeeAssetUI] = [baseFeeAssetUI, quoteFeeAssetUI];
        let [toExchangeRate, fromExchangeRate] = [baseExchangeRate, quoteExchangeRate];
        if (this.currentOrder.sell) {
            [fromFeeAssetUI, toFeeAssetUI] = [toFeeAssetUI, fromFeeAssetUI];
            [fromExchangeRate, toExchangeRate] = [toExchangeRate, fromExchangeRate];
        }
        const swapped = swap.estimate.value || 0;
        const swappedInParentUnits = fromExchangeRate > 0 ? swapped / fromExchangeRate : swapped;
        // Set swap fee estimates in the details pane.
        const bestSwapPct = swap.estimate.realisticBestCase / swappedInParentUnits * 100;
        page.vSwapFeesLowPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(bestSwapPct)}%)`;
        page.vSwapFeesLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(swap.estimate.realisticBestCase, fromFeeAssetUI);
        const worstSwapPct = swap.estimate.realisticWorstCase / swappedInParentUnits * 100;
        page.vSwapFeesHighPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(worstSwapPct)}%)`;
        page.vSwapFeesHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(swap.estimate.realisticWorstCase, fromFeeAssetUI);
        const swapFeesMaxPct = swap.estimate.maxFees / swappedInParentUnits * 100;
        page.vSwapFeesMaxPct.textContent = fromExchangeRate <= 0 ? '' : `(${fmtPct(swapFeesMaxPct)}%)`;
        page.vSwapFeesMax.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(swap.estimate.maxFees, fromFeeAssetUI);
        // Set redemption fee estimates in the details pane.
        const midGap = this.midGap();
        const estRate = midGap || order.rate / rateConversionFactor;
        const received = order.sell ? swapped * estRate : swapped / estRate;
        const receivedInParentUnits = toExchangeRate > 0 ? received / toExchangeRate : received;
        const bestRedeemPct = redeem.estimate.realisticBestCase / receivedInParentUnits * 100;
        page.vRedeemFeesLowPct.textContent = toExchangeRate <= 0 ? '' : `(${fmtPct(bestRedeemPct)}%)`;
        page.vRedeemFeesLow.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(redeem.estimate.realisticBestCase, toFeeAssetUI);
        const worstRedeemPct = redeem.estimate.realisticWorstCase / receivedInParentUnits * 100;
        page.vRedeemFeesHighPct.textContent = toExchangeRate <= 0 ? '' : `(${fmtPct(worstRedeemPct)}%)`;
        page.vRedeemFeesHigh.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(redeem.estimate.realisticWorstCase, toFeeAssetUI);
        if (baseExchangeRate && quoteExchangeRate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vFeeSummaryPct);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vFeeSummary);
            page.vFeeSummaryLow.textContent = fmtPct(bestSwapPct + bestRedeemPct);
            page.vFeeSummaryHigh.textContent = fmtPct(worstSwapPct + worstRedeemPct);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vFeeSummaryPct);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vFeeSummary);
            page.summarySwapFeesLow.textContent = page.vSwapFeesLow.textContent;
            page.summarySwapFeesHigh.textContent = page.vSwapFeesHigh.textContent;
            page.summaryRedeemFeesLow.textContent = page.vRedeemFeesLow.textContent;
            page.summaryRedeemFeesHigh.textContent = page.vRedeemFeesHigh.textContent;
        }
    }
    submitCancel() {
        return __awaiter(this, void 0, void 0, function* () {
            // this will be the page.cancelSubmit button (evt.currentTarget)
            const page = this.page;
            const cancelData = this.cancelData;
            const order = cancelData.order;
            const req = {
                orderID: order.id
            };
            // Toggle the loader and submit button.
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(page.cancelSubmit);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/cancel', req);
            loaded();
            // Display error on confirmation modal.
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                page.cancelErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.cancelErr);
                return;
            }
            // Hide confirmation modal only on success.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(cancelData.bttn, page.forms);
            order.cancelling = true;
        });
    }
    /* showCancel shows a form to confirm submission of a cancel order. */
    showCancel(row, orderID) {
        const ord = this.metaOrders[orderID].ord;
        const page = this.page;
        const remaining = ord.qty - ord.filled;
        const asset = _orderutil__WEBPACK_IMPORTED_MODULE_8__.isMarketBuy(ord) ? this.market.quote : this.market.base;
        page.cancelRemain.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(remaining, asset.unitInfo);
        page.cancelUnit.textContent = asset.symbol.toUpperCase();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cancelErr);
        this.showForm(page.cancelForm);
        this.cancelData = {
            bttn: _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(row, 'cancelBttn'),
            order: ord
        };
    }
    /* showAccelerate shows the accelerate order form. */
    showAccelerate(order) {
        const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loading(this.main);
        this.accelerateOrderForm.refresh(order);
        loaded();
        this.showForm(this.page.accelerateForm);
    }
    /* showCreate shows the new wallet creation form. */
    showCreate(asset) {
        const page = this.page;
        this.currentCreate = asset;
        this.newWalletForm.setAsset(asset.id);
        this.showForm(page.newWalletForm);
    }
    /*
     * stepSubmit will examine the current state of wallets and step the user
     * through the process of order submission.
     * NOTE: I expect this process will be streamlined soon such that the wallets
     * will attempt to be unlocked in the order submission process, negating the
     * need to unlock ahead of time.
     */
    stepSubmit() {
        const page = this.page;
        const market = this.market;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.orderErr);
        if (!this.validateOrder(this.parseOrder()))
            return;
        const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().walletMap[market.base.id];
        const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().walletMap[market.quote.id];
        if (!baseWallet) {
            page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ASSET_WALLET, { asset: market.base.symbol });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
            return;
        }
        if (!quoteWallet) {
            page.orderErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_NO_ASSET_WALLET, { asset: market.quote.symbol });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderErr);
            return;
        }
        this.showVerify();
    }
    /* Display a deposit address. */
    showDeposit(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            this.depositAddrForm.setAsset(assetID);
            this.showForm(this.page.deposit);
        });
    }
    showCustomProviderDialog(assetID) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loadPage('wallets', { promptProvider: assetID, goBack: 'markets' });
    }
    /*
     * handlePriceUpdate is the handler for the 'spots' notification.
     */
    handlePriceUpdate(note) {
        if (!this.market)
            return; // This note can arrive before the market is set.
        if (note.host === this.market.dex.host && note.spots[this.market.cfg.name]) {
            this.setCurrMarketPrice();
        }
        this.marketList.updateSpots(note);
    }
    handleWalletState(note) {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.market)
                return; // This note can arrive before the market is set.
            // if (note.topic !== 'TokenApproval') return
            if (note.wallet.assetID !== ((_a = this.market.base) === null || _a === void 0 ? void 0 : _a.id) && note.wallet.assetID !== ((_b = this.market.quote) === null || _b === void 0 ? void 0 : _b.id))
                return;
            this.setTokenApprovalVisibility();
            this.resolveOrderFormVisibility();
        });
    }
    /*
     * handleBondUpdate is the handler for the 'bondpost' notification type.
     * This is used to update the registration status of the current exchange.
     */
    handleBondUpdate(note) {
        return __awaiter(this, void 0, void 0, function* () {
            const dexAddr = note.dex;
            if (!this.market)
                return; // This note can arrive before the market is set.
            if (dexAddr !== this.market.dex.host)
                return;
            // If we just finished legacy registration, we need to update the Exchange.
            // TODO: Use tier change notification once available.
            if (note.topic === 'AccountRegistered')
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchUser();
            // Update local copy of Exchange.
            this.market.dex = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[dexAddr];
            this.setRegistrationStatusVisibility();
            this.updateReputation();
        });
    }
    updateReputation() {
        const { page, market: { dex: { host }, cfg: mkt, baseCfg: { unitInfo: bui }, quoteCfg: { unitInfo: qui } } } = this;
        const { auth } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[host];
        page.parcelSizeLots.textContent = String(mkt.parcelsize);
        page.marketLimitBase.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.parcelsize * mkt.lotsize / bui.conventional.conversionFactor);
        page.marketLimitBaseUnit.textContent = bui.conventional.unit;
        page.marketLimitQuoteUnit.textContent = qui.conventional.unit;
        const conversionRate = this.anyRate()[1];
        if (conversionRate) {
            const quoteLot = mkt.lotsize * conversionRate;
            page.marketLimitQuote.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(mkt.parcelsize * quoteLot / qui.conventional.conversionFactor);
        }
        else
            page.marketLimitQuote.textContent = '-';
        const tier = (0,_account__WEBPACK_IMPORTED_MODULE_4__.strongTier)(auth);
        page.tradingTier.textContent = String(tier);
        const [usedParcels, parcelLimit] = (0,_account__WEBPACK_IMPORTED_MODULE_4__.tradingLimits)(host);
        page.tradingLimit.textContent = (parcelLimit * mkt.parcelsize).toFixed(2);
        page.limitUsage.textContent = parcelLimit > 0 ? (usedParcels / parcelLimit * 100).toFixed(1) : '0';
        page.orderLimitRemain.textContent = ((parcelLimit - usedParcels) * mkt.parcelsize).toFixed(1);
        page.orderTradingTier.textContent = String(tier);
        this.reputationMeter.update();
    }
    /*
     * anyRate finds the best rate from any of, in order of priority, the order
     * book, the server's reported spot rate, or the fiat exchange rates. A
     * 3-tuple of message-rate encoding, a conversion rate, and a conventional
     * rate is generated.
     */
    anyRate() {
        const { cfg: { spot }, baseCfg: { id: baseID }, quoteCfg: { id: quoteID }, rateConversionFactor, bookLoaded } = this.market;
        if (bookLoaded) {
            const midGap = this.midGap();
            if (midGap)
                return [midGap * _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor, midGap, this.midGapConventional() || 0];
        }
        if (spot && spot.rate)
            return [spot.rate, spot.rate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor, spot.rate / rateConversionFactor];
        const [baseUSD, quoteUSD] = [(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fiatRatesMap[quoteID]];
        if (baseUSD && quoteUSD) {
            const conventionalRate = baseUSD / quoteUSD;
            const msgRate = conventionalRate * rateConversionFactor;
            const conversionRate = msgRate / _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor;
            return [msgRate, conversionRate, conventionalRate];
        }
        return [0, 0, 0];
    }
    handleMatchNote(note) {
        const mord = this.metaOrders[note.orderID];
        const match = note.match;
        if (!mord)
            return this.refreshActiveOrders();
        else if (mord.ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Market && match.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.NewlyMatched) { // Update the average market rate display.
            // Fetch and use the updated order.
            const ord = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().order(note.orderID);
            if (ord)
                mord.details.rate.textContent = mord.header.rate.textContent = this.marketOrderRateString(ord, this.market);
        }
        if ((match.side === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MatchSideMaker && match.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MakerRedeemed) ||
            (match.side === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MatchSideTaker && match.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.MatchComplete))
            this.updateReputation();
        if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(mord.ord))
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(mord.details.accelerateBttn);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(mord.details.accelerateBttn);
    }
    /*
     * handleOrderNote is the handler for the 'order'-type notification, which are
     * used to update a user's order's status.
     */
    handleOrderNote(note) {
        const ord = note.order;
        const mord = this.metaOrders[ord.id];
        // - If metaOrder doesn't exist for the given order it means it was created
        //  via bwctl and the GUI isn't aware of it or it was an inflight order.
        //  refreshActiveOrders must be called to grab this order.
        // - If an OrderLoaded notification is recieved, it means an order that was
        //   previously not "ready to tick" (due to its wallets not being connected
        //   and unlocked) has now become ready to tick. The active orders section
        //   needs to be refreshed.
        const wasInflight = note.topic === 'AsyncOrderFailure' || note.topic === 'AsyncOrderSubmitted';
        if (!mord || wasInflight || (note.topic === 'OrderLoaded' && ord.readyToTick)) {
            return this.refreshActiveOrders();
        }
        const oldStatus = mord.ord.status;
        mord.ord = ord;
        if (note.topic === 'MissedCancel')
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(mord.details.cancelBttn);
        if (ord.filled === ord.qty)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(mord.details.cancelBttn);
        if ((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().canAccelerateOrder(ord))
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(mord.details.accelerateBttn);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(mord.details.accelerateBttn);
        this.updateMetaOrder(mord);
        // Only reset markers if there is a change, since the chart is redrawn.
        if ((oldStatus === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusEpoch && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked) ||
            (oldStatus === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked && ord.status > _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked)) {
            this.setDepthMarkers();
            this.updateReputation();
            this.mm.readBook();
        }
    }
    /*
     * handleEpochNote handles notifications signalling the start of a new epoch.
     */
    handleEpochNote(note) {
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().log('book', 'handleEpochNote:', note);
        if (!this.market)
            return; // This note can arrive before the market is set.
        if (note.host !== this.market.dex.host || note.marketID !== this.market.sid)
            return;
        if (this.book) {
            this.book.setEpoch(note.epoch);
            this.depthChart.draw();
        }
        this.clearOrderTableEpochs();
        for (const { ord, details, header } of Object.values(this.metaOrders)) {
            const alreadyMatched = note.epoch > ord.epoch;
            switch (true) {
                case ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Limit && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusEpoch && alreadyMatched: {
                    const status = ord.tif === _orderutil__WEBPACK_IMPORTED_MODULE_8__.ImmediateTiF ? _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_EXECUTED) : _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_BOOKED);
                    details.status.textContent = header.status.textContent = status;
                    ord.status = ord.tif === _orderutil__WEBPACK_IMPORTED_MODULE_8__.ImmediateTiF ? _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusExecuted : _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusBooked;
                    break;
                }
                case ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_8__.Market && ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusEpoch:
                    // Technically don't know if this should be 'executed' or 'settling'.
                    details.status.textContent = header.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_EXECUTED);
                    ord.status = _orderutil__WEBPACK_IMPORTED_MODULE_8__.StatusExecuted;
                    break;
            }
        }
    }
    /*
     * recentMatchesSortCompare returns sort compare function according to the active
     * sort key and direction.
     */
    recentMatchesSortCompare() {
        switch (this.recentMatchesSortKey) {
            case 'rate':
                return (a, b) => this.recentMatchesSortDirection * (a.rate - b.rate);
            case 'qty':
                return (a, b) => this.recentMatchesSortDirection * (a.qty - b.qty);
            case 'age':
                return (a, b) => this.recentMatchesSortDirection * (a.stamp - b.stamp);
        }
    }
    refreshRecentMatchesTable() {
        const page = this.page;
        const recentMatches = this.recentMatches;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.recentMatchesLiveList);
        if (!recentMatches)
            return;
        const compare = this.recentMatchesSortCompare();
        recentMatches.sort(compare);
        for (const match of recentMatches) {
            const row = page.recentMatchesTemplate.cloneNode(true);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(row);
            tmpl.rate.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.rate / this.market.rateConversionFactor);
            tmpl.qty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, this.market.baseUnitInfo);
            tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(match.stamp);
            tmpl.age.dataset.sinceStamp = String(match.stamp);
            row.classList.add(match.sell ? 'sellcolor' : 'buycolor');
            page.recentMatchesLiveList.append(row);
        }
    }
    addRecentMatches(matches) {
        this.recentMatches = [...matches, ...this.recentMatches].slice(0, 100);
    }
    /* handleBalanceNote handles notifications updating a wallet's balance. */
    handleBalanceNote(note) {
        this.approveTokenForm.handleBalanceNote(note);
        this.preorderCache = {}; // invalidate previous preorder results
        // if connection to dex server fails, it is not possible to retrieve
        // markets.
        const mkt = this.market;
        if (!mkt || !mkt.dex || mkt.dex.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
            return;
        this.mm.handleBalanceNote(note);
        const wgt = this.balanceWgt;
        // Display the widget if the balance note is for its base or quote wallet.
        if ((note.assetID === wgt.base.id || note.assetID === wgt.quote.id))
            wgt.setBalanceVisibility(true);
        // If there's a balance update, refresh the max order section.
        const avail = note.balance.available;
        switch (note.assetID) {
            case mkt.baseCfg.id:
                // If we're not showing the max order panel yet, don't do anything.
                if (!mkt.maxSell)
                    break;
                if (typeof mkt.sellBalance === 'number' && mkt.sellBalance !== avail)
                    mkt.maxSell = null;
                if (this.isSell())
                    this.preSell();
                break;
            case mkt.quoteCfg.id:
                if (!Object.keys(mkt.maxBuys).length)
                    break;
                if (typeof mkt.buyBalance === 'number' && mkt.buyBalance !== avail)
                    mkt.maxBuys = {};
                if (!this.isSell())
                    this.preBuy();
        }
    }
    /*
     * submitOrder is attached to the affirmative button on the order validation
     * form. Clicking the button is the last step in the order submission process.
     */
    submitOrder() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.orderErr, page.vErr);
            const order = this.currentOrder;
            const req = { order: wireOrder(order) };
            if (!this.validateOrder(order))
                return;
            // Show loader and hide submit button.
            page.vSubmit.classList.add('d-hide');
            page.vLoader.classList.remove('d-hide');
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_6__.postJSON)('/api/tradeasync', req);
            // Hide loader and show submit button.
            page.vSubmit.classList.remove('d-hide');
            page.vLoader.classList.add('d-hide');
            // If error, display error on confirmation modal.
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().checkResponse(res)) {
                page.vErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vErr);
                return;
            }
            // Hide confirmation modal only on success.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            this.refreshActiveOrders();
        });
    }
    /*
     * createWallet is attached to successful submission of the wallet creation
     * form. createWallet is only called once the form is submitted and a success
     * response is received from the client.
     */
    createWallet() {
        return __awaiter(this, void 0, void 0, function* () {
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchUser();
            if (!user)
                return;
            const asset = user.assets[this.currentCreate.id];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
            const mkt = this.market;
            if (mkt.baseCfg.id === asset.id)
                mkt.base = asset;
            else if (mkt.quoteCfg.id === asset.id)
                mkt.quote = asset;
            this.balanceWgt.updateAsset(asset.id);
            this.displayMessageIfMissingWallet();
            this.resolveOrderFormVisibility();
        });
    }
    /* lotChanged is attached to the keyup and change events of the lots input. */
    lotChanged() {
        const page = this.page;
        const lots = parseInt(page.lotField.value || '0');
        if (lots <= 0) {
            page.lotField.value = page.lotField.value === '' ? '' : '0';
            page.qtyField.value = '';
            this.previewQuoteAmt(false);
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_ERROR));
            return;
        }
        const lotSize = this.market.cfg.lotsize;
        const orderQty = lots * lotSize;
        page.lotField.value = String(lots);
        // Conversion factor must be a multiple of 10.
        page.qtyField.value = String(orderQty / this.market.baseUnitInfo.conventional.conversionFactor);
        if (!this.isLimit() && this.isSell()) {
            const baseWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[this.market.base.id].wallet;
            this.setOrderBttnEnabled(orderQty <= baseWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_SELL_BALANCE_ERROR));
        }
        this.previewQuoteAmt(true);
    }
    /*
     * quantityChanged is attached to the keyup and change events of the quantity
     * input.
     */
    quantityChanged(finalize) {
        const page = this.page;
        const order = this.currentOrder = this.parseOrder();
        if (order.qty < 0) {
            page.lotField.value = '0';
            page.qtyField.value = '';
            this.previewQuoteAmt(false);
            return;
        }
        const lotSize = this.market.cfg.lotsize;
        const lots = Math.floor(order.qty / lotSize);
        const adjusted = order.qty = this.currentOrder.qty = lots * lotSize;
        page.lotField.value = String(lots);
        if (!order.isLimit && !order.sell)
            return;
        // Conversion factor must be a multiple of 10.
        if (finalize)
            page.qtyField.value = String(adjusted / this.market.baseUnitInfo.conventional.conversionFactor);
        this.previewQuoteAmt(true);
    }
    /*
     * marketBuyChanged is attached to the keyup and change events of the quantity
     * input for the market-buy form.
     */
    marketBuyChanged() {
        const page = this.page;
        const qty = convertToAtoms(page.mktBuyField.value || '', this.market.quoteUnitInfo.conventional.conversionFactor);
        const gap = this.midGap();
        if (qty > 0) {
            const quoteWallet = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[this.market.quote.id].wallet;
            this.setOrderBttnEnabled(qty <= quoteWallet.balance.available, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_BUY_BALANCE_ERROR));
        }
        else {
            this.setOrderBttnEnabled(false, _locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_ORDER_BUTTON_QTY_ERROR));
        }
        if (!gap || !qty) {
            page.mktBuyLots.textContent = '0';
            page.mktBuyScore.textContent = '0';
            return;
        }
        const lotSize = this.market.cfg.lotsize;
        const received = qty / gap;
        const lots = (received / lotSize);
        page.mktBuyLots.textContent = lots.toFixed(1);
        page.mktBuyScore.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(received, this.market.baseUnitInfo);
    }
    /*
     * rateFieldChanged is attached to the keyup and change events of the rate
     * input.
     */
    rateFieldChanged() {
        // Truncate to rate step. If it is a market buy order, do not adjust.
        const adjusted = this.adjustedRate();
        if (adjusted <= 0) {
            this.depthLines.input = [];
            this.drawChartLines();
            this.page.rateField.value = '0';
            this.previewQuoteAmt(true);
            this.updateOrderBttnState();
            return;
        }
        const order = this.currentOrder = this.parseOrder();
        const r = adjusted / this.market.rateConversionFactor;
        this.page.rateField.value = String(r);
        this.depthLines.input = [{
                rate: r,
                color: order.sell ? this.depthChart.theme.sellLine : this.depthChart.theme.buyLine
            }];
        this.drawChartLines();
        this.previewQuoteAmt(true);
        this.updateOrderBttnState();
    }
    /*
     * adjustedRate is the current rate field rate, rounded down to a
     * multiple of rateStep.
     */
    adjustedRate() {
        const v = this.page.rateField.value;
        if (!v)
            return NaN;
        const rate = convertToAtoms(v, this.market.rateConversionFactor);
        const rateStep = this.market.cfg.ratestep;
        return rate - (rate % rateStep);
    }
    /* loadTable reloads the table from the current order book information. */
    loadTable() {
        this.loadTableSide(true);
        this.loadTableSide(false);
    }
    /* binOrdersByRateAndEpoch takes a list of sorted orders and returns the
       same orders grouped into arrays. The orders are grouped by their rate
       and whether or not they are epoch queue orders. Epoch queue orders
       will come after non epoch queue orders with the same rate. */
    binOrdersByRateAndEpoch(orders) {
        if (!orders || !orders.length)
            return [];
        const bins = [];
        let currEpochBin = [];
        let currNonEpochBin = [];
        let currRate = orders[0].msgRate;
        if (orders[0].epoch)
            currEpochBin.push(orders[0]);
        else
            currNonEpochBin.push(orders[0]);
        for (let i = 1; i < orders.length; i++) {
            if (orders[i].msgRate !== currRate) {
                bins.push(currNonEpochBin);
                bins.push(currEpochBin);
                currEpochBin = [];
                currNonEpochBin = [];
                currRate = orders[i].msgRate;
            }
            if (orders[i].epoch)
                currEpochBin.push(orders[i]);
            else
                currNonEpochBin.push(orders[i]);
        }
        bins.push(currNonEpochBin);
        bins.push(currEpochBin);
        return bins.filter(bin => bin.length > 0);
    }
    /* loadTables loads the order book side into its table. */
    loadTableSide(sell) {
        const bookSide = sell ? this.book.sells : this.book.buys;
        const tbody = sell ? this.page.sellRows : this.page.buyRows;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tbody);
        if (!bookSide || !bookSide.length)
            return;
        const orderBins = this.binOrdersByRateAndEpoch(bookSide);
        orderBins.forEach(bin => { tbody.appendChild(this.orderTableRow(bin)); });
    }
    /* addTableOrder adds a single order to the appropriate table. */
    addTableOrder(order) {
        const tbody = order.sell ? this.page.sellRows : this.page.buyRows;
        let row = tbody.firstChild;
        // Handle market order differently.
        if (order.rate === 0) {
            if (order.qtyAtomic === 0)
                return; // a cancel order. TODO: maybe make an indicator on the target order, maybe gray out
            // This is a market order.
            if (row && row.manager.getRate() === 0) {
                row.manager.insertOrder(order);
            }
            else {
                row = this.orderTableRow([order]);
                tbody.insertBefore(row, tbody.firstChild);
            }
            return;
        }
        // Must be a limit order. Sort by rate. Skip the market order row.
        if (row && row.manager.getRate() === 0)
            row = row.nextSibling;
        while (row) {
            if (row.manager.compare(order) === 0) {
                row.manager.insertOrder(order);
                return;
            }
            else if (row.manager.compare(order) > 0) {
                const tr = this.orderTableRow([order]);
                tbody.insertBefore(tr, row);
                return;
            }
            row = row.nextSibling;
        }
        const tr = this.orderTableRow([order]);
        tbody.appendChild(tr);
    }
    /* removeTableOrder removes a single order from its table. */
    removeTableOrder(order) {
        const token = order.token;
        for (const tbody of [this.page.sellRows, this.page.buyRows]) {
            for (const tr of Array.from(tbody.children)) {
                if (tr.manager.removeOrder(token)) {
                    return;
                }
            }
        }
    }
    /* updateTableOrder looks for the order in the table and updates the qty */
    updateTableOrder(u) {
        for (const tbody of [this.page.sellRows, this.page.buyRows]) {
            for (const tr of Array.from(tbody.children)) {
                if (tr.manager.updateOrderQty(u)) {
                    return;
                }
            }
        }
    }
    /*
     * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired.
     */
    clearOrderTableEpochs() {
        this.clearOrderTableEpochSide(this.page.sellRows);
        this.clearOrderTableEpochSide(this.page.buyRows);
    }
    /*
     * clearOrderTableEpochs removes immediate-tif orders whose epoch has expired
     * for a single side.
     */
    clearOrderTableEpochSide(tbody) {
        for (const tr of (Array.from(tbody.children))) {
            tr.manager.removeEpochOrders();
        }
    }
    /*
     * orderTableRow creates a new <tr> element to insert into an order table.
       Takes a bin of orders with the same rate, and displays the total quantity.
     */
    orderTableRow(orderBin) {
        const tr = this.page.orderRowTmpl.cloneNode(true);
        const { baseUnitInfo, quoteUnitInfo, rateConversionFactor, cfg: { ratestep: rateStep } } = this.market;
        const manager = new OrderTableRowManager(tr, orderBin, baseUnitInfo, quoteUnitInfo, rateStep);
        tr.manager = manager;
        bind(tr, 'click', () => {
            this.reportDepthClick(tr.manager.getRate() / rateConversionFactor);
        });
        if (tr.manager.getRate() !== 0) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tr, 'mouseenter', () => {
                const chart = this.depthChart;
                this.depthLines.hover = [{
                        rate: tr.manager.getRate() / rateConversionFactor,
                        color: tr.manager.isSell() ? chart.theme.sellLine : chart.theme.buyLine
                    }];
                this.drawChartLines();
            });
        }
        return tr;
    }
    /* handleConnNote handles the 'conn' notification.
     */
    handleConnNote(note) {
        return __awaiter(this, void 0, void 0, function* () {
            this.marketList.setConnectionStatus(note);
            if (note.connectionStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected) {
                // Having been disconnected from a DEX server, anything may have changed,
                // or this may be the first opportunity to get the server's config, so
                // fetch it all before reloading the markets page.
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchUser();
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().loadPage('markets');
            }
        });
    }
    /*
     * filterMarkets sets the display of markets in the markets list based on the
     * value of the search input.
     */
    filterMarkets() {
        var _a;
        const filterTxt = (_a = this.page.marketSearchV1.value) === null || _a === void 0 ? void 0 : _a.toLowerCase();
        const filter = filterTxt ? (mkt) => mkt.name.includes(filterTxt) : () => true;
        this.marketList.setFilter(filter);
    }
    /* drawChartLines draws the hover and input lines on the chart. */
    drawChartLines() {
        this.depthChart.setLines([...this.depthLines.hover, ...this.depthLines.input]);
        this.depthChart.draw();
    }
    /* candleDurationSelected sets the candleDur and loads the candles. It will
    default to the oneHrBinKey if dur is not valid. */
    candleDurationSelected(dur) {
        var _a, _b;
        if (!((_b = (_a = this.market) === null || _a === void 0 ? void 0 : _a.dex) === null || _b === void 0 ? void 0 : _b.candleDurs.includes(dur)))
            dur = oneHrBinKey;
        this.candleDur = dur;
        this.loadCandles();
        _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_1__["default"].lastCandleDurationLK, dur);
    }
    /*
     * loadCandles loads the candles for the current candleDur. If a cache is already
     * active, the cache will be used without a loadcandles request.
     */
    loadCandles() {
        for (const bttn of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].kids(this.page.durBttnBox)) {
            if (bttn.textContent === this.candleDur)
                bttn.classList.add('selected');
            else
                bttn.classList.remove('selected');
        }
        const { candleCaches, cfg, baseUnitInfo, quoteUnitInfo } = this.market;
        const cache = candleCaches[this.candleDur];
        if (cache) {
            // this.depthChart.hide()
            // this.candleChart.show()
            this.candleChart.setCandles(cache, cfg, baseUnitInfo, quoteUnitInfo);
            return;
        }
        this.requestCandles();
    }
    /* requestCandles sends the loadcandles request. It accepts an optional candle
     * duration which will be requested if it is provided.
     */
    requestCandles(candleDur) {
        this.candlesLoading = {
            loaded: () => { },
            timer: window.setTimeout(() => {
                if (this.candlesLoading) {
                    this.candlesLoading = null;
                    console.error('candles not received');
                }
            }, 10000)
        };
        const { dex, baseCfg, quoteCfg } = this.market;
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].request('loadcandles', { host: dex.host, base: baseCfg.id, quote: quoteCfg.id, dur: candleDur || this.candleDur });
    }
    /*
     * unload is called by the Application when the user navigates away from
     * the /markets page.
     */
    unload() {
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].request(unmarketRoute, {});
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(bookRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(bookOrderRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(unbookOrderRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(updateRemainingRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(epochOrderRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(candlesRoute);
        _ws__WEBPACK_IMPORTED_MODULE_9__["default"].deregisterRoute(candleUpdateRoute);
        this.depthChart.unattach();
        this.candleChart.unattach();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
        clearInterval(this.secondTicker);
    }
}
/*
 *  MarketList represents the list of exchanges and markets on the left side of
 * markets view. The MarketList provides utilities for adjusting the visibility
 * and sort order of markets.
 */
class MarketList {
    constructor(div) {
        this.div = div;
        this.rowTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idel(div, 'marketTmplV1');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(this.rowTmpl);
        this.reloadMarketsPane();
    }
    updateSpots(note) {
        for (const row of this.markets) {
            if (row.mkt.xc.host !== note.host)
                continue;
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges[row.mkt.xc.host];
            const mkt = xc.markets[row.mkt.name];
            setPriceAndChange(row.tmpl, xc, mkt);
        }
    }
    reloadMarketsPane() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.div);
        this.markets = [];
        const addMarket = (mkt) => {
            const bui = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(mkt.baseid, mkt.xc);
            const qui = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(mkt.quoteid, mkt.xc);
            const rateConversionFactor = _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor / bui.conventional.conversionFactor * qui.conventional.conversionFactor;
            const row = new MarketRow(this.rowTmpl, mkt, rateConversionFactor);
            this.div.appendChild(row.node);
            return row;
        };
        for (const mkt of sortedMarkets())
            this.markets.push(addMarket(mkt));
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().bindTooltips(this.div);
    }
    find(host, baseID, quoteID) {
        for (const row of this.markets) {
            if (row.mkt.xc.host === host && row.mkt.baseid === baseID && row.mkt.quoteid === quoteID)
                return row;
        }
        return null;
    }
    /* exists will be true if the specified market exists. */
    exists(host, baseID, quoteID) {
        return this.find(host, baseID, quoteID) !== null;
    }
    /* first gets the first market from the first exchange, alphabetically. */
    first() {
        return this.markets[0];
    }
    /* select sets the specified market as selected. */
    select(host, baseID, quoteID) {
        const row = this.find(host, baseID, quoteID);
        if (!row)
            return console.error(`select: no market row for ${host}, ${baseID}-${quoteID}`);
        for (const mkt of this.markets)
            mkt.node.classList.remove('selected');
        this.selected = row;
        this.selected.node.classList.add('selected');
    }
    /* setConnectionStatus sets the visibility of the disconnected icon based
     * on the core.ConnEventNote.
     */
    setConnectionStatus(note) {
        for (const row of this.markets) {
            if (row.mkt.xc.host !== note.host)
                continue;
            if (note.connectionStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(row.tmpl.disconnectedIco);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(row.tmpl.disconnectedIco);
        }
    }
    /*
     * setFilter sets the visibility of market rows based on the provided filter.
     */
    setFilter(filter) {
        for (const row of this.markets) {
            if (filter(row))
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(row.node);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(row.node);
        }
    }
}
/*
 * MarketRow represents one row in the MarketList. A MarketRow is a subsection
 * of the ExchangeSection.
 */
class MarketRow {
    constructor(template, mkt, rateConversionFactor) {
        this.mkt = mkt;
        this.name = mkt.name;
        this.baseID = mkt.baseid;
        this.quoteID = mkt.quoteid;
        this.lotSize = mkt.lotsize;
        this.rateConversionFactor = rateConversionFactor;
        this.node = template.cloneNode(true);
        const tmpl = this.tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(this.node);
        tmpl.baseIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(mkt.basesymbol);
        tmpl.quoteIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(mkt.quotesymbol);
        tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(mkt.xc.assets[mkt.baseid], true));
        tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(mkt.xc.assets[mkt.quoteid], true));
        tmpl.baseName.textContent = mkt.baseName;
        tmpl.host.textContent = mkt.xc.host;
        tmpl.host.style.color = hostColor(mkt.xc.host);
        tmpl.host.dataset.tooltip = mkt.xc.host;
        setPriceAndChange(tmpl, mkt.xc, mkt);
        if (this.mkt.xc.connectionStatus !== _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.disconnectedIco);
    }
}
/*
 * BalanceWidget is a display of balance information. Because the wallet can be
 * in any number of states, and because every exchange has different funding
 * coin confirmation requirements, the BalanceWidget displays a number of state
 * indicators and buttons, as well as tabulated balance data with rows for
 * locked and immature balance.
 */
class BalanceWidget {
    constructor(base, quote) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(base, quote);
        const btmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(base);
        this.base = {
            id: 0,
            parentID: parentIDNone,
            cfg: null,
            node: base,
            tmpl: btmpl,
            iconBox: btmpl.walletState,
            stateIcons: new _doc__WEBPACK_IMPORTED_MODULE_0__.WalletIcons(btmpl.walletState)
        };
        btmpl.balanceRowTmpl.remove();
        const qtmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(quote);
        this.quote = {
            id: 0,
            parentID: parentIDNone,
            cfg: null,
            node: quote,
            tmpl: qtmpl,
            iconBox: qtmpl.walletState,
            stateIcons: new _doc__WEBPACK_IMPORTED_MODULE_0__.WalletIcons(qtmpl.walletState)
        };
        qtmpl.balanceRowTmpl.remove();
        (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().registerNoteFeeder({
            balance: (note) => { this.updateAsset(note.assetID); },
            walletstate: (note) => { this.updateAsset(note.wallet.assetID); },
            walletsync: (note) => { this.updateAsset(note.assetID); },
            createwallet: (note) => { this.updateAsset(note.assetID); }
        });
    }
    setBalanceVisibility(connected) {
        if (connected)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.base.node, this.quote.node);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.base.node, this.quote.node);
    }
    /*
     * setWallet sets the balance widget to display data for specified market and
     * will display the widget.
     */
    setWallets(host, baseID, quoteID) {
        const parentID = (assetID) => {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[assetID];
            if (asset === null || asset === void 0 ? void 0 : asset.token)
                return asset.token.parentID;
            return parentIDNone;
        };
        this.dex = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().user.exchanges[host];
        this.base.id = baseID;
        this.base.parentID = parentID(baseID);
        this.base.cfg = this.dex.assets[baseID];
        this.quote.id = quoteID;
        this.quote.parentID = parentID(quoteID);
        this.quote.cfg = this.dex.assets[quoteID];
        this.updateWallet(this.base);
        this.updateWallet(this.quote);
        this.setBalanceVisibility(this.dex.connectionStatus === _registry__WEBPACK_IMPORTED_MODULE_11__.ConnectionStatus.Connected);
    }
    /*
     * updateWallet updates the displayed wallet information based on the
     * core.Wallet state.
     */
    updateWallet(side) {
        const { cfg, tmpl, iconBox, stateIcons, id: assetID } = side;
        if (!cfg)
            return; // no wallet set yet
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[assetID];
        // Just hide everything to start.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.newWalletRow, tmpl.expired, tmpl.unsupported, tmpl.connect, tmpl.spinner, tmpl.walletState, tmpl.balanceRows, tmpl.walletAddr, tmpl.wantProvidersBox);
        this.checkNeedsProvider(assetID, tmpl.wantProvidersBox);
        tmpl.logo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(cfg.symbol);
        tmpl.addWalletSymbol.textContent = cfg.symbol.toUpperCase();
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.symbol);
        // Handle an unsupported asset.
        if (!asset) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.unsupported);
            return;
        }
        tmpl.symbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset, true));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(iconBox);
        const wallet = asset.wallet;
        stateIcons.readWallet(wallet);
        // Handle no wallet configured.
        if (!wallet) {
            if (asset.walletCreationPending) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.spinner);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.newWalletRow);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.walletAddr);
        // Parent asset
        const bal = wallet.balance;
        // Handle not connected and no balance known for the DEX.
        if (!bal && !wallet.running && !wallet.disabled) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.connect);
            return;
        }
        // If there is no balance, but the wallet is connected, show the loading
        // icon while we fetch an update.
        if (!bal) {
            (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchBalance(assetID);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.spinner);
            return;
        }
        // We have a wallet and a DEX-specific balance. Set all of the fields.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.balanceRows);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.balanceRows);
        const addRow = (title, bal, ui, icon) => {
            const row = tmpl.balanceRowTmpl.cloneNode(true);
            tmpl.balanceRows.appendChild(row);
            const balTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            balTmpl.title.textContent = title;
            balTmpl.bal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bal, ui);
            if (icon) {
                balTmpl.bal.append(icon);
                side.parentBal = balTmpl.bal;
            }
        };
        addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_AVAILABLE), bal.available, asset.unitInfo);
        addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_LOCKED), bal.locked + bal.contractlocked + bal.bondlocked, asset.unitInfo);
        addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_IMMATURE), bal.immature, asset.unitInfo);
        if (asset.token) {
            const { wallet: { balance }, unitInfo, symbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[asset.token.parentID];
            const icon = document.createElement('img');
            icon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            icon.classList.add('micro-icon', 'ms-1');
            addRow(_locales__WEBPACK_IMPORTED_MODULE_10__.prep(_locales__WEBPACK_IMPORTED_MODULE_10__.ID_FEE_BALANCE), balance.available, unitInfo, icon);
        }
        // If the current balance update time is older than an hour, show the
        // expiration icon. Request a balance update, if possible.
        const expired = new Date().getTime() - new Date(bal.stamp).getTime() > anHour;
        if (expired && !wallet.disabled) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.expired);
            if (wallet.running)
                (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().fetchBalance(assetID);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.expired);
    }
    checkNeedsProvider(assetID, el) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(yield (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().needsCustomProvider(assetID), el);
        });
    }
    /* updateParent updates the side's parent asset balance. */
    updateParent(side) {
        var _a;
        const { wallet: { balance }, unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets[side.parentID];
        // firstChild is the text node set before the img child node in addRow.
        if ((_a = side.parentBal) === null || _a === void 0 ? void 0 : _a.firstChild)
            side.parentBal.firstChild.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(balance.available, unitInfo);
    }
    /*
     * updateAsset updates the info for one side of the existing market. If the
     * specified asset ID is not one of the current market's base or quote assets,
     * it is silently ignored.
     */
    updateAsset(assetID) {
        if (assetID === this.base.id)
            this.updateWallet(this.base);
        else if (assetID === this.quote.id)
            this.updateWallet(this.quote);
        if (assetID === this.base.parentID)
            this.updateParent(this.base);
        if (assetID === this.quote.parentID)
            this.updateParent(this.quote);
    }
}
/* makeMarket creates a market object that specifies basic market details. */
function makeMarket(host, base, quote) {
    return {
        host: host,
        base: base,
        quote: quote
    };
}
/* marketID creates a DEX-compatible market name from the ticker symbols. */
function marketID(b, q) { return `${b}_${q}`; }
/* convertToAtoms converts the float string to the basic unit of a coin. */
function convertToAtoms(s, conversionFactor) {
    if (!s)
        return 0;
    return Math.round(parseFloat(s) * conversionFactor);
}
/* swapBttns changes the 'selected' class of the buttons. */
function swapBttns(before, now) {
    before.classList.remove('selected');
    now.classList.add('selected');
}
/*
 * wireOrder prepares a copy of the order with the options field converted to a
 * string -> string map.
 */
function wireOrder(order) {
    const stringyOptions = {};
    for (const [k, v] of Object.entries(order.options))
        stringyOptions[k] = JSON.stringify(v);
    return Object.assign({}, order, { options: stringyOptions });
}
// OrderTableRowManager manages the data within a row in an order table. Each row
// represents all the orders in the order book with the same rate, but orders that
// are booked or still in the epoch queue are displayed in separate rows.
class OrderTableRowManager {
    constructor(tableRow, orderBin, baseUnitInfo, quoteUnitInfo, rateStep) {
        this.tableRow = tableRow;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tableRow);
        this.orderBin = orderBin;
        this.sell = orderBin[0].sell;
        this.msgRate = orderBin[0].msgRate;
        this.epoch = !!orderBin[0].epoch;
        this.baseUnitInfo = baseUnitInfo;
        const rateText = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatRateFullPrecision(this.msgRate, baseUnitInfo, quoteUnitInfo, rateStep);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(this.isEpoch(), this.page.epoch);
        if (this.msgRate === 0) {
            page.rate.innerText = 'market';
        }
        else {
            const cssClass = this.isSell() ? 'sellcolor' : 'buycolor';
            page.rate.innerText = rateText;
            page.rate.classList.add(cssClass);
        }
        this.updateQtyNumOrdersEl();
    }
    // updateQtyNumOrdersEl populates the quantity element in the row, and also
    // displays the number of orders if there is more than one order in the order
    // bin.
    updateQtyNumOrdersEl() {
        const { page, orderBin } = this;
        const qty = orderBin.reduce((total, curr) => total + curr.qtyAtomic, 0);
        const numOrders = orderBin.length;
        page.qty.innerText = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(qty, this.baseUnitInfo);
        if (numOrders > 1) {
            page.numOrders.removeAttribute('hidden');
            page.numOrders.innerText = String(numOrders);
            page.numOrders.title = `quantity is comprised of ${numOrders} orders`;
        }
        else {
            page.numOrders.setAttribute('hidden', 'true');
        }
    }
    // insertOrder adds an order to the order bin and updates the row elements
    // accordingly.
    insertOrder(order) {
        this.orderBin.push(order);
        this.updateQtyNumOrdersEl();
    }
    // updateOrderQuantity updates the quantity of the order identified by a token,
    // if it exists in the row, and updates the row elements accordingly. The function
    // returns true if the order is in the bin, and false otherwise.
    updateOrderQty(update) {
        const { token, qty, qtyAtomic } = update;
        for (let i = 0; i < this.orderBin.length; i++) {
            if (this.orderBin[i].token === token) {
                this.orderBin[i].qty = qty;
                this.orderBin[i].qtyAtomic = qtyAtomic;
                this.updateQtyNumOrdersEl();
                return true;
            }
        }
        return false;
    }
    // removeOrder removes the order identified by the token, if it exists in the row,
    // and updates the row elements accordingly. If the order bin is empty, the row is
    // removed from the screen. The function returns true if an order was removed, and
    // false otherwise.
    removeOrder(token) {
        const index = this.orderBin.findIndex(order => order.token === token);
        if (index < 0)
            return false;
        this.orderBin.splice(index, 1);
        if (!this.orderBin.length)
            this.tableRow.remove();
        else
            this.updateQtyNumOrdersEl();
        return true;
    }
    // removeEpochOrders removes all the orders from the row that are not in the
    // new epoch's epoch queue and updates the elements accordingly.
    removeEpochOrders(newEpoch) {
        this.orderBin = this.orderBin.filter((order) => {
            return !(order.epoch && order.epoch !== newEpoch);
        });
        if (!this.orderBin.length)
            this.tableRow.remove();
        else
            this.updateQtyNumOrdersEl();
    }
    // getRate returns the rate of the orders in the row.
    getRate() {
        return this.msgRate;
    }
    // isEpoch returns whether the orders in this row are in the epoch queue.
    isEpoch() {
        return this.epoch;
    }
    // isSell returns whether the orders in this row are sell orders.
    isSell() {
        return this.sell;
    }
    // compare takes an order and returns 0 if the order belongs in this row,
    // 1 if the order should go after this row in the table, and -1 if it should
    // be before this row in the table. Sell orders are displayed in ascending order,
    // buy orders are displayed in descending order, and epoch orders always come
    // after booked orders.
    compare(order) {
        if (this.getRate() === order.msgRate && this.isEpoch() === !!order.epoch) {
            return 0;
        }
        else if (this.getRate() !== order.msgRate) {
            return (this.getRate() > order.msgRate) === order.sell ? 1 : -1;
        }
        else {
            return this.isEpoch() ? 1 : -1;
        }
    }
}
function sortedMarkets() {
    const mkts = [];
    const assets = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().assets;
    const convertMarkets = (xc, mkts) => {
        return mkts.map((mkt) => {
            const a = assets[mkt.baseid];
            const baseName = a ? a.name : mkt.basesymbol;
            const bui = (0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().unitInfo(mkt.baseid, xc);
            return Object.assign({ xc, baseName, bui }, mkt);
        });
    };
    for (const xc of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges))
        mkts.push(...convertMarkets(xc, Object.values(xc.markets || {})));
    mkts.sort((a, b) => {
        if (!a.spot) {
            if (b.spot)
                return 1; // put b first, since we have the spot
            // no spots. compare market name then host name
            if (a.name === b.name)
                return a.xc.host.localeCompare(b.xc.host);
            return a.name.localeCompare(b.name);
        }
        else if (!b.spot)
            return -1; // put a first, since we have the spot
        const [aLots, bLots] = [a.spot.vol24 / a.lotsize, b.spot.vol24 / b.lotsize];
        return bLots - aLots; // whoever has more volume by lot count
    });
    return mkts;
}
function setPriceAndChange(tmpl, xc, mkt) {
    if (!mkt.spot)
        return;
    tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().conventionalRate(mkt.baseid, mkt.quoteid, mkt.spot.rate, xc));
    const sign = mkt.spot.change24 > 0 ? '+' : '';
    tmpl.change.classList.remove('buycolor', 'sellcolor');
    tmpl.change.classList.add(mkt.spot.change24 >= 0 ? 'buycolor' : 'sellcolor');
    tmpl.change.textContent = `${sign}${(mkt.spot.change24 * 100).toFixed(1)}%`;
}
const hues = [1 / 2, 1 / 4, 3 / 4, 1 / 8, 5 / 8, 3 / 8, 7 / 8];
function generateHue(idx) {
    const h = hues[idx % hues.length];
    return `hsl(${h * 360}, 35%, 50%)`;
}
function hostColor(host) {
    const hosts = Object.keys((0,_registry__WEBPACK_IMPORTED_MODULE_11__.app)().exchanges);
    hosts.sort();
    return generateHue(hosts.indexOf(host));
}


/***/ }),

/***/ "./src/js/mm.ts":
/*!**********************!*\
  !*** ./src/js/mm.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};








const mediumBreakpoint = 768;
const newSlider = () => {
    return {
        left: {
            cex: 0,
            dex: 0
        },
        right: {
            cex: 0,
            dex: 0
        },
        cexRange: 0,
        dexRange: 0
    };
};
function parseFundingOptions(f) {
    const { cex: { avail: cexAvail, req: cexReq }, dex: { avail: dexAvail, req: dexReq }, transferable } = f;
    let proposedDex = Math.min(dexAvail, dexReq);
    let proposedCex = Math.min(cexAvail, cexReq);
    let slider;
    if (f.fundedAndNotBalanced) {
        // We have everything we need, but not where we need it, and we can
        // deposit and withdraw.
        if (dexAvail > dexReq) {
            // We have too much dex-side, so we'll have to draw on dex to balance
            // cex's shortcomings.
            const cexShort = cexReq - cexAvail;
            const dexRemain = dexAvail - dexReq;
            if (dexRemain < cexShort) {
                // We did something really bad with math to get here.
                throw Error('bad math has us with dex surplus + cex underfund invalid remains');
            }
            proposedDex += cexShort + transferable;
        }
        else {
            // We don't have enough on dex, but we have enough on cex to cover the
            // short.
            const dexShort = dexReq - dexAvail;
            const cexRemain = cexAvail - cexReq;
            if (cexRemain < dexShort) {
                throw Error('bad math got us with cex surplus + dex underfund invalid remains');
            }
            proposedCex += dexShort + transferable;
        }
    }
    else if (f.fundedAndBalanced) {
        // This asset is fully funded, but the user may choose to fund order
        // reserves either cex or dex.
        if (transferable > 0) {
            const dexRemain = dexAvail - dexReq;
            const cexRemain = cexAvail - cexReq;
            slider = newSlider();
            if (cexRemain > transferable && dexRemain > transferable) {
                // Either one could fully fund order reserves. Let the user choose.
                slider.left.cex = transferable + cexReq;
                slider.left.dex = dexReq;
                slider.right.cex = cexReq;
                slider.right.dex = transferable + dexReq;
            }
            else if (dexRemain < transferable && cexRemain < transferable) {
                // => implied that cexRemain + dexRemain > transferable.
                // CEX can contribute SOME and DEX can contribute SOME.
                slider.left.cex = transferable - dexRemain + cexReq;
                slider.left.dex = dexRemain + dexReq;
                slider.right.cex = cexRemain + cexReq;
                slider.right.dex = transferable - cexRemain + dexReq;
            }
            else if (dexRemain > transferable) {
                // So DEX has enough to cover reserves, but CEX could potentially
                // constribute SOME. NOT ALL.
                slider.left.cex = cexReq;
                slider.left.dex = transferable + dexReq;
                slider.right.cex = cexRemain + cexReq;
                slider.right.dex = transferable - cexRemain + dexReq;
            }
            else {
                // CEX has enough to cover reserves, but DEX could contribute SOME,
                // NOT ALL.
                slider.left.cex = transferable - dexRemain + cexReq;
                slider.left.dex = dexRemain + dexReq;
                slider.right.cex = transferable + cexReq;
                slider.right.dex = dexReq;
            }
            // We prefer the slider right in the center.
            slider.cexRange = slider.right.cex - slider.left.cex;
            slider.dexRange = slider.right.dex - slider.left.dex;
            proposedDex = slider.left.dex + (slider.dexRange / 2);
            proposedCex = slider.left.cex + (slider.cexRange / 2);
        }
    }
    else { // starved
        if (cexAvail < cexReq) {
            proposedDex = Math.min(dexAvail, dexReq + transferable + (cexReq - cexAvail));
        }
        else if (dexAvail < dexReq) {
            proposedCex = Math.min(cexAvail, cexReq + transferable + (dexReq - dexAvail));
        }
        else { // just transferable wasn't covered
            proposedDex = Math.min(dexAvail, dexReq + transferable);
            proposedCex = Math.min(cexAvail, dexReq + cexReq + transferable - proposedDex);
        }
    }
    return [proposedDex, proposedCex, slider];
}
class MarketMakerPage extends _basepage__WEBPACK_IMPORTED_MODULE_3__["default"] {
    constructor(main) {
        super();
        this.bots = {};
        this.sortedBots = [];
        this.cexes = {};
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].idDescendants(main);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].cleanTemplates(page.botTmpl, page.botRowTmpl, page.exchangeRowTmpl);
        this.forms = new _forms__WEBPACK_IMPORTED_MODULE_5__.Forms(page.forms);
        this.cexConfigForm = new _forms__WEBPACK_IMPORTED_MODULE_5__.CEXConfigurationForm(page.cexConfigForm, (cexName) => this.cexConfigured(cexName));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.newBot, 'click', () => { this.newBot(); });
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.archivedLogsBtn, 'click', () => { (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmarchives'); });
        this.twoColumn = window.innerWidth >= mediumBreakpoint;
        const ro = new ResizeObserver(() => { this.resized(); });
        ro.observe(main);
        for (const [cexName, dinfo] of Object.entries(_mmutil__WEBPACK_IMPORTED_MODULE_1__.CEXDisplayInfos)) {
            const tr = page.exchangeRowTmpl.cloneNode(true);
            page.cexRows.appendChild(tr);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(tr);
            const configure = () => {
                this.cexConfigForm.setCEX(cexName);
                this.forms.show(page.cexConfigForm);
            };
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.configureBttn, 'click', configure);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.reconfigBttn, 'click', configure);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.errConfigureBttn, 'click', configure);
            const row = this.cexes[cexName] = { tr, tmpl, dinfo, cexName };
            this.updateCexRow(row);
        }
        this.setup();
    }
    resized() {
        const useTwoColumn = window.innerWidth >= 768;
        if (useTwoColumn !== this.twoColumn) {
            this.twoColumn = useTwoColumn;
            this.clearBotBoxes();
            for (const { div } of this.sortedBots)
                this.appendBotBox(div);
        }
    }
    setup() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus;
            const botConfigs = mmStatus.bots.map((s) => s.config);
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().registerNoteFeeder({
                runstats: (note) => { this.handleRunStatsNote(note); },
                runevent: (note) => {
                    const bot = this.bots[(0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(note.host, note.baseID, note.quoteID)];
                    if (bot)
                        return bot.handleRunStats();
                },
                cexnote: (note) => { this.handleCEXNote(note); }
                // TODO bot start-stop notification
            });
            const noBots = !botConfigs || botConfigs.length === 0;
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(noBots, page.noBots);
            if (noBots)
                return;
            page.noBots.remove();
            const sortedBots = [...mmStatus.bots].sort((a, b) => {
                var _a, _b, _c, _d;
                if (a.running && !b.running)
                    return -1;
                if (b.running && !a.running)
                    return 1;
                // If none are running, just do something to get a resonably reproducible
                // sort.
                if (!a.running && !b.running)
                    return (a.config.baseID + a.config.quoteID) - (b.config.baseID + b.config.quoteID);
                // Both are running. Sort by run time.
                return ((_b = (_a = b.runStats) === null || _a === void 0 ? void 0 : _a.startTime) !== null && _b !== void 0 ? _b : 0) - ((_d = (_c = a.runStats) === null || _c === void 0 ? void 0 : _c.startTime) !== null && _d !== void 0 ? _d : 0);
            });
            const startupBalanceCache = {};
            for (const botStatus of sortedBots)
                this.addBot(botStatus, startupBalanceCache);
        });
    }
    handleCEXNote(n) {
        return __awaiter(this, void 0, void 0, function* () {
            switch (n.topic) {
                case 'BalanceUpdate':
                    return this.handleCEXBalanceUpdate(n.cexName /* , n.note */);
            }
        });
    }
    handleCEXBalanceUpdate(cexName /* , note: CEXBalanceUpdate */) {
        return __awaiter(this, void 0, void 0, function* () {
            const cexRow = this.cexes[cexName];
            if (cexRow)
                this.updateCexRow(cexRow);
        });
    }
    handleRunStatsNote(note) {
        return __awaiter(this, void 0, void 0, function* () {
            const { baseID, quoteID, host } = note;
            const bot = this.bots[(0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(host, baseID, quoteID)];
            if (bot)
                return bot.handleRunStats();
            this.addBot((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().botStatus(host, baseID, quoteID));
        });
    }
    unload() {
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].unbind(document, 'keyup', this.keyup);
    }
    addBot(botStatus, startupBalanceCache) {
        var _a;
        const { page, bots, sortedBots } = this;
        // Make sure the market still exists.
        const { config: { baseID, quoteID, host } } = botStatus;
        const [baseSymbol, quoteSymbol] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID].symbol, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID].symbol];
        const mktID = `${baseSymbol}_${quoteSymbol}`;
        if (!((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host]) === null || _a === void 0 ? void 0 : _a.markets[mktID]))
            return;
        const bot = new Bot(this, botStatus, startupBalanceCache);
        page.botRows.appendChild(bot.row.tr);
        sortedBots.push(bot);
        bots[bot.id] = bot;
        this.appendBotBox(bot.div);
    }
    appendBotBox(div) {
        const { page: { boxZero, boxOne }, twoColumn } = this;
        const useZeroth = !twoColumn || (boxZero.children.length + boxOne.children.length) % 2 === 0;
        const box = useZeroth ? boxZero : boxOne;
        box.append(div);
    }
    clearBotBoxes() {
        const { page: { boxOne, boxZero } } = this;
        while (boxZero.children.length > 1)
            boxZero.removeChild(boxZero.lastChild);
        while (boxOne.children.length > 0)
            boxOne.removeChild(boxOne.lastChild);
    }
    showBot(botID) {
        const { sortedBots } = this;
        const idx = sortedBots.findIndex((bot) => bot.id === botID);
        sortedBots.splice(idx, 1);
        sortedBots.unshift(this.bots[botID]);
        this.clearBotBoxes();
        for (const { div } of sortedBots)
            this.appendBotBox(div);
        const div = this.bots[botID].div;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].animate(250, (p) => {
            div.style.opacity = `${p}`;
            div.style.transform = `scale(${0.8 + 0.2 * p})`;
        });
    }
    newBot() {
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmsettings');
    }
    cexConfigured(cexName) {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchMMStatus();
            this.updateCexRow(this.cexes[cexName]);
            this.forms.close();
        });
    }
    updateCexRow(row) {
        const { tmpl, dinfo, cexName } = row;
        tmpl.logo.src = dinfo.logo;
        tmpl.name.textContent = dinfo.name;
        const status = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!status, tmpl.unconfigured);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(status && !status.connectErr, tmpl.configured);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(status === null || status === void 0 ? void 0 : status.connectErr, tmpl.connectErrBox);
        if (status === null || status === void 0 ? void 0 : status.connectErr) {
            tmpl.connectErr.textContent = 'connection error';
            tmpl.connectErr.dataset.tooltip = status.connectErr;
        }
        tmpl.logo.classList.toggle('greyscale', !status);
        if (!status)
            return;
        let usdBal = 0;
        const cexSymbolAdded = {}; // avoid double counting tokens or counting both eth and weth
        for (const [assetIDStr, bal] of Object.entries(status.balances)) {
            const assetID = parseInt(assetIDStr);
            const cexSymbol = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bipCEXSymbol(assetID);
            if (cexSymbolAdded[cexSymbol])
                continue;
            cexSymbolAdded[cexSymbol] = true;
            const { unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[assetID];
            if (fiatRate)
                usdBal += fiatRate * (bal.available + bal.locked) / unitInfo.conventional.conversionFactor;
        }
        tmpl.usdBalance.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(usdBal);
    }
    percentageBalanceStr(assetID, balance, percentage) {
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
        const unitInfo = asset.unitInfo;
        const assetValue = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatCoinValue((balance * percentage) / 100, unitInfo);
        return `${_doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(percentage)}% - ${assetValue} ${asset.symbol.toUpperCase()}`;
    }
    /*
     * walletBalanceStr returns a string like "50% - 0.0001 BTC" representing
     * the percentage of a wallet's balance selected in the market maker setting,
     * and the amount of that asset in the wallet.
     */
    walletBalanceStr(assetID, percentage) {
        const { wallet: { balance: { available } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
        return this.percentageBalanceStr(assetID, available, percentage);
    }
}
class Bot extends _mmutil__WEBPACK_IMPORTED_MODULE_1__.BotMarket {
    constructor(pg, status, startupBalanceCache) {
        super(status.config);
        startupBalanceCache = startupBalanceCache !== null && startupBalanceCache !== void 0 ? startupBalanceCache : {};
        this.pg = pg;
        const { baseID, quoteID, host, botType, nBuyPlacements, nSellPlacements, cexName } = this;
        this.id = (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.hostedMarketID)(host, baseID, quoteID);
        const div = this.div = pg.page.botTmpl.cloneNode(true);
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(div);
        this.runDisplay = new _mmutil__WEBPACK_IMPORTED_MODULE_1__.RunningMarketMakerDisplay(page.onBox, 'mm');
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.setMarketElements)(div, baseID, quoteID, host);
        if (cexName)
            (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.setCexElements)(div, cexName);
        if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeArbMM) {
            page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BOTTYPE_ARB_MM);
        }
        else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb) {
            page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BOTTYPE_SIMPLE_ARB);
        }
        else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicMM) {
            page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BOTTYPE_BASIC_MM);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb, page.placementsChartBox, page.baseTokenSwapFeesBox);
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb) {
            this.placementsChart = new _mmutil__WEBPACK_IMPORTED_MODULE_1__.PlacementsChart(page.placementsChart);
            page.buyPlacementCount.textContent = String(nBuyPlacements);
            page.sellPlacementCount.textContent = String(nSellPlacements);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.startBttn, 'click', () => this.start());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.allocationBttn, 'click', () => this.allocate());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.reconfigureBttn, 'click', () => this.reconfigure());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.goBackFromAllocation, 'click', () => this.hideAllocationDialog());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.marketLink, 'click', () => (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('markets', { host, baseID, quoteID }));
        this.baseAllocSlider = new _doc__WEBPACK_IMPORTED_MODULE_2__.MiniSlider(page.baseAllocSlider, () => { });
        this.quoteAllocSlider = new _doc__WEBPACK_IMPORTED_MODULE_2__.MiniSlider(page.quoteAllocSlider, () => { });
        const tr = pg.page.botRowTmpl.cloneNode(true);
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_1__.setMarketElements)(tr, baseID, quoteID, host);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(tr);
        this.row = { tr, tmpl };
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.allocateBttn, 'click', (e) => {
            e.stopPropagation();
            this.allocate();
            pg.showBot(this.id);
        });
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tr, 'click', () => pg.showBot(this.id));
        this.initialize(startupBalanceCache);
    }
    initialize(startupBalanceCache) {
        const _super = Object.create(null, {
            initialize: { get: () => super.initialize }
        });
        return __awaiter(this, void 0, void 0, function* () {
            yield _super.initialize.call(this, startupBalanceCache);
            this.runDisplay.setBotMarket(this);
            const { page, host, cexName, botType, div, cfg: { arbMarketMakingConfig, basicMarketMakingConfig }, mktID, baseFactor, quoteFactor, marketReport: { baseFiatRate } } = this;
            if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicArb) {
                let buyPlacements = [];
                let sellPlacements = [];
                let profit = 0;
                if (arbMarketMakingConfig) {
                    buyPlacements = arbMarketMakingConfig.buyPlacements.map((p) => ({ lots: p.lots, gapFactor: p.multiplier }));
                    sellPlacements = arbMarketMakingConfig.sellPlacements.map((p) => ({ lots: p.lots, gapFactor: p.multiplier }));
                    profit = arbMarketMakingConfig.profit;
                }
                else if (basicMarketMakingConfig) {
                    buyPlacements = basicMarketMakingConfig.buyPlacements;
                    sellPlacements = basicMarketMakingConfig.sellPlacements;
                    let bestBuy;
                    let bestSell;
                    if (buyPlacements.length > 0)
                        bestBuy = buyPlacements.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
                    if (sellPlacements.length > 0)
                        bestSell = sellPlacements.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
                    if (bestBuy && bestSell) {
                        profit = (bestBuy.gapFactor + bestSell.gapFactor) / 2;
                    }
                    else if (bestBuy) {
                        profit = bestBuy.gapFactor;
                    }
                    else if (bestSell) {
                        profit = bestSell.gapFactor;
                    }
                }
                const marketConfig = { cexName: cexName, botType, baseFiatRate: baseFiatRate, dict: { profit, buyPlacements, sellPlacements } };
                this.placementsChart.setMarket(marketConfig);
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicMM, page.cexDataBox);
            if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_1__.botTypeBasicMM) {
                const cex = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
                if (cex) {
                    const mkt = cex.markets ? cex.markets[mktID] : undefined;
                    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(mkt === null || mkt === void 0 ? void 0 : mkt.day, page.cexDataBox);
                    if (mkt === null || mkt === void 0 ? void 0 : mkt.day) {
                        const day = mkt.day;
                        page.cexPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(day.lastPrice);
                        page.cexVol.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(baseFiatRate * day.vol);
                    }
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(Boolean(cexName), ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(div, '[data-cex-show]'));
            const { spot } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].markets[mktID];
            if (spot) {
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.dexDataBox);
                const c = _orderutil__WEBPACK_IMPORTED_MODULE_4__.RateEncodingFactor / baseFactor * quoteFactor;
                page.dexPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(spot.rate / c);
                page.dexVol.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(spot.vol24 / baseFactor * baseFiatRate);
            }
            this.updateDisplay();
            this.updateTableRow();
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.loadingBg);
        });
    }
    updateTableRow() {
        const { row: { tmpl } } = this;
        const { running, runStats } = this.status();
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(running, tmpl.profitLossBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!running, tmpl.allocateBttnBox);
        if (runStats) {
            tmpl.profitLoss.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(runStats.profitLoss.profit, 2);
        }
    }
    updateDisplay() {
        const { page, marketReport: { baseFiatRate, quoteFiatRate }, baseFeeFiatRate, quoteFeeFiatRate } = this;
        if ([baseFiatRate, quoteFiatRate, baseFeeFiatRate, quoteFeeFiatRate].some((r) => !r)) {
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.onBox, page.offBox);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.noFiatDisplay);
            return;
        }
        const { running } = this.status();
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(running, page.onBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(!running, page.offBox);
        if (running)
            this.updateRunningDisplay();
        else
            this.updateIdleDisplay();
    }
    updateRunningDisplay() {
        this.runDisplay.update();
    }
    updateIdleDisplay() {
        const { page, proj: { alloc, qProj, bProj }, baseID, quoteID, cexName, bui, qui, baseFeeID, quoteFeeID, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor, marketReport: { baseFiatRate, quoteFiatRate }, cfg: { uiConfig: { baseConfig, quoteConfig } }, quoteFeeUI, baseFeeUI } = this;
        page.baseAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(alloc[baseID], bui);
        const baseUSD = alloc[baseID] / baseFactor * baseFiatRate;
        let totalUSD = baseUSD;
        page.baseAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(baseUSD);
        page.baseBookAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bProj.book * baseFactor, bui);
        page.baseOrderReservesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bProj.orderReserves * baseFactor, bui);
        page.baseOrderReservesPct.textContent = String(Math.round(baseConfig.orderReservesFactor * 100));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, page.baseCexAllocBox);
        if (cexName)
            page.baseCexAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bProj.cex * baseFactor, bui);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID === baseID, page.baseBookingFeesAllocBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID !== baseID, page.baseTokenFeesAllocBox);
        if (baseFeeID === baseID) {
            const bookingFees = baseID === quoteFeeID ? bProj.bookingFees + qProj.bookingFees : bProj.bookingFees;
            page.baseBookingFeesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bookingFees * baseFeeFactor, baseFeeUI);
        }
        else {
            const feeAlloc = alloc[baseFeeID];
            page.baseTokenFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(feeAlloc, baseFeeUI);
            const baseFeeUSD = feeAlloc / baseFeeFactor * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[baseFeeID];
            totalUSD += baseFeeUSD;
            page.baseTokenAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(baseFeeUSD);
            const withQuote = baseFeeID === quoteFeeID;
            const bookingFees = bProj.bookingFees + (withQuote ? qProj.bookingFees : 0);
            page.baseTokenBookingFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bookingFees * baseFeeFactor, baseFeeUI);
            page.baseTokenSwapFeeN.textContent = String(baseConfig.swapFeeN + (withQuote ? quoteConfig.swapFeeN : 0));
            const swapReserves = bProj.swapFeeReserves + (withQuote ? qProj.swapFeeReserves : 0);
            page.baseTokenSwapFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(swapReserves * baseFeeFactor, baseFeeUI);
        }
        page.quoteAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(alloc[quoteID], qui);
        const quoteUSD = alloc[quoteID] / quoteFactor * quoteFiatRate;
        totalUSD += quoteUSD;
        page.quoteAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(quoteUSD);
        page.quoteBookAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.book * quoteFactor, qui);
        page.quoteOrderReservesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.orderReserves * quoteFactor, qui);
        page.quoteOrderReservesPct.textContent = String(Math.round(quoteConfig.orderReservesFactor * 100));
        page.quoteSlippageAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.slippageBuffer * quoteFactor, qui);
        page.slippageBufferFactor.textContent = String(Math.round(quoteConfig.slippageBufferFactor * 100));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, page.quoteCexAllocBox);
        if (cexName)
            page.quoteCexAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.cex * quoteFactor, qui);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteID === quoteFeeID, page.quoteBookingFeesAllocBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteFeeID !== quoteID && quoteFeeID !== baseFeeID, page.quoteTokenFeesAllocBox);
        if (quoteID === quoteFeeID) {
            const bookingFees = quoteID === baseFeeID ? bProj.bookingFees + qProj.bookingFees : qProj.bookingFees;
            page.quoteBookingFeesAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(bookingFees * quoteFeeFactor, quoteFeeUI);
        }
        else if (quoteFeeID !== baseFeeID) {
            page.quoteTokenFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(alloc[quoteFeeID], quoteFeeUI);
            const quoteFeeUSD = alloc[quoteFeeID] / quoteFeeFactor * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[quoteFeeID];
            totalUSD += quoteFeeUSD;
            page.quoteTokenAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(quoteFeeUSD);
            page.quoteTokenBookingFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.bookingFees * quoteFeeFactor, quoteFeeUI);
            page.quoteTokenSwapFeeN.textContent = String(quoteConfig.swapFeeN);
            page.quoteTokenSwapFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFullPrecision(qProj.swapFeeReserves * quoteFeeFactor, quoteFeeUI);
        }
        page.totalAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(totalUSD);
    }
    /*
     * allocate opens a dialog to choose funding sources (if applicable) and
     * confirm allocations and start the bot.
     */
    allocate() {
        var _a, _b, _c;
        const f = this.fundingState();
        const { page, marketReport: { baseFiatRate, quoteFiatRate }, baseID, quoteID, baseFeeID, quoteFeeID, baseFeeFiatRate, quoteFeeFiatRate, cexName, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor, host, mktID } = this;
        const [proposedDexBase, proposedCexBase, baseSlider] = parseFundingOptions(f.base);
        const [proposedDexQuote, proposedCexQuote, quoteSlider] = parseFundingOptions(f.quote);
        const alloc = this.alloc = {
            dex: {
                [baseID]: proposedDexBase * baseFactor,
                [quoteID]: proposedDexQuote * quoteFactor
            },
            cex: {
                [baseID]: proposedCexBase * baseFactor,
                [quoteID]: proposedCexQuote * quoteFactor
            }
        };
        alloc.dex[baseFeeID] = Math.min(((_a = alloc.dex[baseFeeID]) !== null && _a !== void 0 ? _a : 0) + (f.base.fees.req * baseFeeFactor), f.base.fees.avail * baseFeeFactor);
        alloc.dex[quoteFeeID] = Math.min(((_b = alloc.dex[quoteFeeID]) !== null && _b !== void 0 ? _b : 0) + (f.quote.fees.req * quoteFeeFactor), f.quote.fees.avail * quoteFeeFactor);
        let totalUSD = (alloc.dex[baseID] / baseFactor * baseFiatRate) + (alloc.dex[quoteID] / quoteFactor * quoteFiatRate);
        totalUSD += (alloc.cex[baseID] / baseFactor * baseFiatRate) + (alloc.cex[quoteID] / quoteFactor * quoteFiatRate);
        if (baseFeeID !== baseID)
            totalUSD += alloc.dex[baseFeeID] / baseFeeFactor * baseFeeFiatRate;
        if (quoteFeeID !== quoteID && quoteFeeID !== baseFeeID)
            totalUSD += alloc.dex[quoteFeeID] / quoteFeeFactor * quoteFeeFiatRate;
        page.allocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(totalUSD);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(page.allocationDialog, '[data-cex-only]'));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.fundedAndBalanced, page.fundedAndBalancedBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.base.transferable + f.quote.transferable > 0, page.hasTransferable);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.fundedAndNotBalanced, page.fundedAndNotBalancedBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(f.starved, page.starvedBox);
        page.startBttn.classList.toggle('go', f.fundedAndBalanced);
        page.startBttn.classList.toggle('warning', !f.fundedAndBalanced);
        page.proposedDexBaseAlloc.classList.toggle('text-warning', !(f.base.fundedAndBalanced || f.base.fundedAndNotBalanced));
        page.proposedDexQuoteAlloc.classList.toggle('text-warning', !(f.quote.fundedAndBalanced || f.quote.fundedAndNotBalanced));
        const setBaseProposal = (dex, cex) => {
            page.proposedDexBaseAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex);
            page.proposedDexBaseAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex * baseFiatRate);
            page.proposedCexBaseAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex);
            page.proposedCexBaseAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex * baseFiatRate);
        };
        setBaseProposal(proposedDexBase, proposedCexBase);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseSlider, page.baseAllocSlider);
        if (baseSlider) {
            const dexRange = baseSlider.right.dex - baseSlider.left.dex;
            const cexRange = baseSlider.right.cex - baseSlider.left.cex;
            this.baseAllocSlider.setValue(0.5);
            this.baseAllocSlider.changed = (r) => {
                const dexAlloc = baseSlider.left.dex + r * dexRange;
                const cexAlloc = baseSlider.left.cex + r * cexRange;
                alloc.dex[baseID] = dexAlloc * baseFactor;
                alloc.cex[baseID] = cexAlloc * baseFactor;
                setBaseProposal(dexAlloc, cexAlloc);
            };
        }
        const setQuoteProposal = (dex, cex) => {
            page.proposedDexQuoteAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex);
            page.proposedDexQuoteAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dex * quoteFiatRate);
            page.proposedCexQuoteAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex);
            page.proposedCexQuoteAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cex * quoteFiatRate);
        };
        setQuoteProposal(proposedDexQuote, proposedCexQuote);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteSlider, page.quoteAllocSlider);
        if (quoteSlider) {
            const dexRange = quoteSlider.right.dex - quoteSlider.left.dex;
            const cexRange = quoteSlider.right.cex - quoteSlider.left.cex;
            this.quoteAllocSlider.setValue(0.5);
            this.quoteAllocSlider.changed = (r) => {
                const dexAlloc = quoteSlider.left.dex + r * dexRange;
                const cexAlloc = quoteSlider.left.cex + r * cexRange;
                alloc.dex[quoteID] = dexAlloc * quoteFactor;
                alloc.cex[quoteID] = cexAlloc * quoteFactor;
                setQuoteProposal(dexAlloc, cexAlloc);
            };
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID !== baseID, ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(page.allocationDialog, '[data-base-token-fees]'));
        if (baseFeeID !== baseID) {
            const reqFees = f.base.fees.req + (baseFeeID === quoteFeeID ? f.quote.fees.req : 0);
            const proposedFees = Math.min(reqFees, f.base.fees.avail);
            page.proposedDexBaseFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees);
            page.proposedDexBaseFeeAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees * baseFeeFiatRate);
            page.proposedDexBaseFeeAlloc.classList.toggle('text-warning', !f.base.fees.funded);
        }
        const needQuoteTokenFees = quoteFeeID !== quoteID && quoteFeeID !== baseFeeID;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(needQuoteTokenFees, ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(page.allocationDialog, '[data-quote-token-fees]'));
        if (needQuoteTokenFees) {
            const proposedFees = Math.min(f.quote.fees.req, f.quote.fees.avail);
            page.proposedDexQuoteFeeAlloc.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees);
            page.proposedDexQuoteFeeAllocUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(proposedFees * quoteFeeFiatRate);
            page.proposedDexQuoteFeeAlloc.classList.toggle('text-warning', !f.quote.fees.funded);
        }
        const mkt = (_c = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host]) === null || _c === void 0 ? void 0 : _c.markets[mktID];
        let existingOrders = false;
        if (mkt && mkt.orders) {
            for (let i = 0; i < mkt.orders.length; i++) {
                if (mkt.orders[i].status <= _orderutil__WEBPACK_IMPORTED_MODULE_4__.StatusBooked) {
                    existingOrders = true;
                    break;
                }
            }
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(existingOrders, page.existingOrdersBox);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.allocationDialog);
        const closeDialog = (e) => {
            if (_doc__WEBPACK_IMPORTED_MODULE_2__["default"].mouseInElement(e, page.allocationDialog))
                return;
            this.hideAllocationDialog();
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].unbind(document, 'click', closeDialog);
        };
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(document, 'click', closeDialog);
    }
    hideAllocationDialog() {
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(this.page.allocationDialog);
    }
    start() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, alloc, baseID, quoteID, host, cexName, cfg: { uiConfig: { cexRebalance } } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.errMsg);
            if (cexName && !((_a = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName]) === null || _a === void 0 ? void 0 : _a.connected)) {
                page.errMsg.textContent = `${cexName} not connected`;
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.errMsg);
                return;
            }
            // round allocations values.
            for (const m of [alloc.dex, alloc.cex]) {
                for (const [assetID, v] of Object.entries(m))
                    m[parseInt(assetID)] = Math.round(v);
            }
            const startConfig = {
                baseID: baseID,
                quoteID: quoteID,
                host: host,
                alloc: alloc
            };
            if (cexName && cexRebalance)
                startConfig.autoRebalance = this.autoRebalanceSettings();
            try {
                (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().log('mm', 'starting mm bot', startConfig);
                const res = yield _mmutil__WEBPACK_IMPORTED_MODULE_1__.MM.startBot(startConfig);
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res))
                    throw res;
            }
            catch (e) {
                page.errMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_API_ERROR, e);
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.errMsg);
                return;
            }
            this.hideAllocationDialog();
        });
    }
    autoRebalanceSettings() {
        const { proj: { bProj, qProj, alloc }, baseFeeID, quoteFeeID, cfg: { uiConfig: { baseConfig, quoteConfig } }, baseID, quoteID, cexName, mktID } = this;
        const totalBase = alloc[baseID];
        let dexMinBase = bProj.book;
        if (baseID === baseFeeID)
            dexMinBase += bProj.bookingFees;
        if (baseID === quoteFeeID)
            dexMinBase += qProj.bookingFees;
        let dexMinQuote = qProj.book;
        if (quoteID === quoteFeeID)
            dexMinQuote += qProj.bookingFees;
        if (quoteID === baseFeeID)
            dexMinQuote += bProj.bookingFees;
        const maxBase = Math.max(totalBase - dexMinBase, totalBase - bProj.cex);
        const totalQuote = alloc[quoteID];
        const maxQuote = Math.max(totalQuote - dexMinQuote, totalQuote - qProj.cex);
        if (maxBase < 0 || maxQuote < 0) {
            throw Error(`rebalance math doesn't work: ${JSON.stringify({ bProj, qProj, maxBase, maxQuote })}`);
        }
        const cex = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
        const mkt = cex.markets[mktID];
        const [minB, maxB] = [mkt.baseMinWithdraw, Math.max(mkt.baseMinWithdraw * 2, maxBase)];
        const minBaseTransfer = Math.round(minB + baseConfig.transferFactor * (maxB - minB));
        const [minQ, maxQ] = [mkt.quoteMinWithdraw, Math.max(mkt.quoteMinWithdraw * 2, maxQuote)];
        const minQuoteTransfer = Math.round(minQ + quoteConfig.transferFactor * (maxQ - minQ));
        return { minBaseTransfer, minQuoteTransfer };
    }
    reconfigure() {
        const { host, baseID, quoteID, cexName, botType } = this;
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmsettings', { host, baseID, quoteID, cexName, botType });
    }
    handleRunStats() {
        this.updateDisplay();
        this.updateTableRow();
        this.runDisplay.readBook();
    }
}


/***/ }),

/***/ "./src/js/mmarchives.ts":
/*!******************************!*\
  !*** ./src/js/mmarchives.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerArchivesPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class MarketMakerArchivesPage extends _basepage__WEBPACK_IMPORTED_MODULE_3__["default"] {
    constructor(main) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].idDescendants(main);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].cleanTemplates(page.runTableRowTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(page.backButton, 'click', () => { (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm'); });
        this.setup();
    }
    setup() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.getJSON)('/api/archivedmmruns');
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res)) {
                console.error('failed to get archived mm runs', res);
                // TODO: show error
                return;
            }
            const runs = res.runs;
            for (let i = 0; i < runs.length; i++) {
                const { startTime, market: { baseID, quoteID, host } } = runs[i];
                const row = this.page.runTableRowTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(row);
                tmpl.startTime.textContent = new Date(startTime * 1000).toLocaleString();
                (0,_mmutil__WEBPACK_IMPORTED_MODULE_4__.setMarketElements)(row, baseID, quoteID, host);
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.logs, 'click', () => {
                    (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmlogs', { baseID, quoteID, host, startTime, returnPage: 'mmarchives' });
                });
                _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(tmpl.settings, 'click', () => {
                    (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmsettings', { host, baseID, quoteID });
                });
                this.page.runTableBody.appendChild(row);
            }
        });
    }
}


/***/ }),

/***/ "./src/js/mmlogs.ts":
/*!**************************!*\
  !*** ./src/js/mmlogs.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerLogsPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _wallets__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./wallets */ "./src/js/wallets.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









let net = 0;
const logsBatchSize = 50;
function eventPassesFilter(e, filters) {
    if (e.dexOrderEvent) {
        if (e.dexOrderEvent.sell)
            return filters.dexSells;
        return filters.dexBuys;
    }
    if (e.cexOrderEvent) {
        if (e.cexOrderEvent.sell)
            return filters.cexSells;
        return filters.cexBuys;
    }
    if (e.depositEvent)
        return filters.deposits;
    if (e.withdrawalEvent)
        return filters.withdrawals;
    return false;
}
class MarketMakerLogsPage extends _basepage__WEBPACK_IMPORTED_MODULE_4__["default"] {
    constructor(main, params) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].idDescendants(main);
        net = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().user.net;
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].cleanTemplates(page.eventTableRowTmpl, page.dexOrderTxRowTmpl, page.performanceTableRowTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(this.page.backButton, 'click', () => { var _a; (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage((_a = params.returnPage) !== null && _a !== void 0 ? _a : 'mm'); });
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(this.page.filterButton, 'click', () => { this.applyFilters(); });
        if (params === null || params === void 0 ? void 0 : params.host) {
            const url = new URL(window.location.href);
            url.searchParams.set('host', params.host);
            url.searchParams.set('baseID', String(params.baseID));
            url.searchParams.set('quoteID', String(params.quoteID));
            url.searchParams.set('startTime', String(params.startTime));
            window.history.replaceState(Object.assign({ page: 'mmsettings' }, params), '', url);
        }
        else {
            const urlParams = new URLSearchParams(window.location.search);
            if (!params)
                params = {};
            params.host = urlParams.get('host') || '';
            params.baseID = parseInt(urlParams.get('baseID') || '0');
            params.quoteID = parseInt(urlParams.get('quoteID') || '0');
            params.startTime = parseInt(urlParams.get('startTime') || '0');
        }
        const { baseID, quoteID, host, startTime } = params;
        this.startTime = startTime;
        this.forms = new _forms__WEBPACK_IMPORTED_MODULE_1__.Forms(page.forms);
        this.events = {};
        this.statsRows = {};
        this.mkt = { baseID: baseID, quoteID: quoteID, host };
        (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setMarketElements)(main, baseID, quoteID, host);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(main, 'scroll', () => {
            if (this.loading)
                return;
            if (this.doneScrolling)
                return;
            const belowBottom = page.eventsTable.offsetHeight - main.offsetHeight - main.scrollTop;
            if (belowBottom < 0) {
                this.nextPage();
            }
        });
        this.setup(host, baseID, quoteID);
    }
    nextPage() {
        return __awaiter(this, void 0, void 0, function* () {
            this.loading = true;
            const [events, updatedLogs, overview] = yield this.getRunLogs();
            const assets = this.mktAssets();
            for (const event of events) {
                if (this.events[event.id])
                    continue;
                const row = this.newEventRow(event, false, assets);
                this.events[event.id] = [event, row];
            }
            this.populateStats(overview.profitLoss, overview.endTime);
            this.updateExistingRows(updatedLogs);
            this.loading = false;
        });
    }
    getRunLogs() {
        return __awaiter(this, void 0, void 0, function* () {
            const { mkt, startTime } = this;
            const req = { market: mkt, startTime, n: logsBatchSize, filters: this.filters, refID: this.refID };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/mmrunlogs', req);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res)) {
                console.error('failed to get bot logs', res);
            }
            if (res.logs.length <= 1) {
                this.doneScrolling = true;
            }
            if (res.logs.length > 0) {
                this.refID = res.logs[res.logs.length - 1].id;
            }
            return [res.logs, res.updatedLogs || [], res.overview];
        });
    }
    applyFilters() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.filters = {
                dexSells: !!page.dexSellsCheckbox.checked,
                dexBuys: !!page.dexBuysCheckbox.checked,
                cexSells: !!page.cexSellsCheckbox.checked,
                cexBuys: !!page.cexBuysCheckbox.checked,
                deposits: !!page.depositsCheckbox.checked,
                withdrawals: !!page.withdrawalsCheckbox.checked
            };
            this.refID = undefined;
            const [events, , overview] = yield this.getRunLogs();
            this.populateTable(events);
            this.populateStats(overview.profitLoss, overview.endTime);
        });
    }
    setFilters() {
        const page = this.page;
        page.dexSellsCheckbox.checked = true;
        page.dexBuysCheckbox.checked = true;
        page.cexSellsCheckbox.checked = true;
        page.cexBuysCheckbox.checked = true;
        page.depositsCheckbox.checked = true;
        page.withdrawalsCheckbox.checked = true;
        this.filters = {
            dexSells: true,
            dexBuys: true,
            cexSells: true,
            cexBuys: true,
            deposits: true,
            withdrawals: true
        };
    }
    setup(host, baseID, quoteID) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.setFilters();
            const { startTime } = this;
            let profitLoss;
            let endTime = 0;
            const botStatus = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotStatus)(host, baseID, quoteID);
            const [events, , overview] = yield this.getRunLogs();
            if (((_a = botStatus === null || botStatus === void 0 ? void 0 : botStatus.runStats) === null || _a === void 0 ? void 0 : _a.startTime) === startTime) {
                this.liveBot = true;
                this.fiatRates = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap;
                profitLoss = botStatus.runStats.profitLoss;
            }
            else {
                this.fiatRates = overview.finalState.fiatRates;
                profitLoss = overview.profitLoss;
                endTime = overview.endTime;
            }
            this.populateStats(profitLoss, endTime);
            const assets = this.mktAssets();
            const parentHeader = page.sumUSDHeader.parentElement;
            for (const asset of assets) {
                const th = document.createElement('th');
                th.textContent = `${asset.symbol.toUpperCase()} Delta`;
                if (parentHeader) {
                    parentHeader.insertBefore(th, page.sumUSDHeader);
                }
            }
            this.populateTable(events);
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().registerNoteFeeder({
                runevent: (note) => { this.handleRunEventNote(note); },
                runstats: (note) => { this.handleRunStatsNote(note); }
            });
        });
    }
    handleRunEventNote(note) {
        const { baseID, quoteID, host } = this.mkt;
        if (note.host !== host || note.baseID !== baseID || note.quoteID !== quoteID)
            return;
        if (!eventPassesFilter(note.event, this.filters))
            return;
        const event = note.event;
        const cachedEvent = this.events[event.id];
        if (cachedEvent) {
            this.setRowContents(cachedEvent[1], event, this.mktAssets());
            cachedEvent[0] = event;
            return;
        }
        const row = this.newEventRow(event, true, this.mktAssets());
        this.events[event.id] = [event, row];
    }
    handleRunStatsNote(note) {
        const { mkt: { baseID, quoteID, host }, startTime } = this;
        if (note.host !== host ||
            note.baseID !== baseID ||
            note.quoteID !== quoteID)
            return;
        if (!note.stats || note.stats.startTime !== startTime)
            return;
        this.populateStats(note.stats.profitLoss, 0);
    }
    populateStats(pl, endTime) {
        const page = this.page;
        page.startTime.textContent = new Date(this.startTime * 1000).toLocaleString();
        if (endTime === 0) {
            _doc__WEBPACK_IMPORTED_MODULE_3__["default"].hide(page.endTimeRow);
        }
        else {
            page.endTime.textContent = new Date(endTime * 1000).toLocaleString();
        }
        for (const assetID in pl.diffs) {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[parseInt(assetID)];
            let row = this.statsRows[assetID];
            if (!row) {
                row = page.performanceTableRowTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
                tmpl.logo.src = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].logoPath(asset.symbol);
                tmpl.ticker.textContent = asset.symbol.toUpperCase();
                this.statsRows[assetID] = row;
                page.performanceTableBody.appendChild(row);
            }
            const diff = pl.diffs[assetID];
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
            tmpl.diff.textContent = diff.fmt;
            tmpl.usdDiff.textContent = diff.fmtUSD;
            tmpl.fiatRate.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatFiatValue(this.fiatRates[asset.id])} USD`;
        }
        page.profitLoss.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatFiatValue(pl.profit)} USD`;
    }
    mktAssets() {
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.mkt.baseID];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.mkt.quoteID];
        const assets = [baseAsset, quoteAsset];
        const assetIDs = { [baseAsset.id]: true, [quoteAsset.id]: true };
        if (baseAsset.token && !assetIDs[baseAsset.token.parentID]) {
            const baseTokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseAsset.token.parentID];
            assetIDs[baseTokenAsset.id] = true;
            assets.push(baseTokenAsset);
        }
        if (quoteAsset.token && !assetIDs[quoteAsset.token.parentID]) {
            const quoteTokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteAsset.token.parentID];
            assets.push(quoteTokenAsset);
        }
        return assets;
    }
    updateExistingRows(updatedLogs) {
        for (const event of updatedLogs) {
            const cachedEvent = this.events[event.id];
            if (!cachedEvent)
                continue;
            this.setRowContents(cachedEvent[1], event, this.mktAssets());
            cachedEvent[0] = event;
        }
    }
    populateTable(events) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].empty(page.eventsTableBody);
        this.events = {};
        this.doneScrolling = false;
        const assets = this.mktAssets();
        for (const event of events) {
            const row = this.newEventRow(event, false, assets);
            this.events[event.id] = [event, row];
        }
    }
    setRowContents(row, event, assets) {
        var _a;
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
        tmpl.time.textContent = (new Date(event.timestamp * 1000)).toLocaleString();
        tmpl.eventType.textContent = this.eventType(event);
        let id;
        if (event.depositEvent) {
            id = event.depositEvent.transaction.id;
        }
        else if (event.withdrawalEvent) {
            id = event.withdrawalEvent.id;
        }
        else if (event.dexOrderEvent) {
            id = event.dexOrderEvent.id;
        }
        else if (event.cexOrderEvent) {
            id = event.cexOrderEvent.id;
        }
        if (id) {
            tmpl.eventID.textContent = trimStringWithEllipsis(id, 30);
            tmpl.eventID.setAttribute('title', id);
        }
        let usd = 0;
        for (const asset of assets) {
            const be = event.balanceEffects;
            const sum = sumBalanceEffects(asset.id, be);
            const tmplID = `sum${asset.symbol.toUpperCase()}`;
            let el;
            if (tmpl[tmplID]) {
                el = tmpl[tmplID];
            }
            else {
                el = document.createElement('td');
                el.dataset.tmpl = tmplID;
                const parent = tmpl.sumUSD.parentElement;
                if (parent) {
                    parent.insertBefore(el, tmpl.sumUSD);
                }
            }
            el.textContent = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(sum, asset.unitInfo);
            const factor = asset.unitInfo.conventional.conversionFactor;
            usd += (_a = sum / factor * this.fiatRates[asset.id]) !== null && _a !== void 0 ? _a : 0;
        }
        tmpl.sumUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatFourSigFigs(usd);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].bind(tmpl.details, 'click', () => { this.showEventDetails(event.id); });
    }
    newEventRow(event, prepend, assets) {
        const page = this.page;
        const row = page.eventTableRowTmpl.cloneNode(true);
        row.id = event.id.toString();
        this.setRowContents(row, event, assets);
        if (prepend) {
            page.eventsTableBody.insertBefore(row, page.eventsTableBody.firstChild);
        }
        else {
            page.eventsTableBody.appendChild(row);
        }
        return row;
    }
    eventType(event) {
        if (event.depositEvent) {
            return 'Deposit';
        }
        else if (event.withdrawalEvent) {
            return 'Withdrawal';
        }
        else if (event.dexOrderEvent) {
            return event.dexOrderEvent.sell ? 'DEX Sell' : 'DEX Buy';
        }
        else if (event.cexOrderEvent) {
            return event.cexOrderEvent.sell ? 'CEX Sell' : 'CEX Buy';
        }
        return '';
    }
    showDexOrderEventDetails(event) {
        const { page, mkt: { baseID, quoteID } } = this;
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        const [bui, qui] = [baseAsset.unitInfo, quoteAsset.unitInfo];
        const [baseTicker, quoteTicker] = [bui.conventional.unit, qui.conventional.unit];
        if (this.dexOrderIDCopyListener !== undefined) {
            page.copyDexOrderID.removeEventListener('click', this.dexOrderIDCopyListener);
        }
        this.dexOrderIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.id, page.dexOrderID, page.copyDexOrderID, '#1e7d11'); };
        page.copyDexOrderID.addEventListener('click', this.dexOrderIDCopyListener);
        page.dexOrderID.textContent = trimStringWithEllipsis(event.id, 20);
        page.dexOrderID.setAttribute('title', event.id);
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, event.rate);
        page.dexOrderRate.textContent = `${rate} ${baseTicker}/${quoteTicker}`;
        page.dexOrderQty.textContent = `${event.qty / bui.conventional.conversionFactor} ${baseTicker}`;
        if (event.sell) {
            page.dexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_SELL);
        }
        else {
            page.dexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BUY);
        }
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].empty(page.dexOrderTxsTableBody);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].setVis(event.transactions && event.transactions.length > 0, page.dexOrderTxsTable);
        const txAsset = (txType, sell) => {
            switch (txType) {
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeSwap:
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeRefund:
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeSplit:
                    return sell ? baseAsset : quoteAsset;
                case _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeRedeem:
                    return sell ? quoteAsset : baseAsset;
            }
        };
        for (let i = 0; event.transactions && i < event.transactions.length; i++) {
            const tx = event.transactions[i];
            const row = page.dexOrderTxRowTmpl.cloneNode(true);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].parseTemplate(row);
            tmpl.id.textContent = trimStringWithEllipsis(tx.id, 20);
            tmpl.id.setAttribute('title', tx.id);
            tmpl.type.textContent = _wallets__WEBPACK_IMPORTED_MODULE_7__.txTypeString(tx.type);
            const asset = txAsset(tx.type, event.sell);
            if (!asset) {
                console.error('unexpected tx type in dex order event', tx.type);
                continue;
            }
            const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[asset.id];
            if (assetExplorer && assetExplorer[net]) {
                tmpl.explorerLink.href = assetExplorer[net](tx.id);
            }
            tmpl.amt.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(tx.amount, asset.unitInfo)} ${asset.unitInfo.conventional.unit.toLowerCase()}`;
            tmpl.fees.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(tx.fees, asset.unitInfo)} ${asset.unitInfo.conventional.unit.toLowerCase()}`;
            page.dexOrderTxsTableBody.appendChild(row);
        }
        this.forms.show(page.dexOrderDetailsForm);
    }
    showCexOrderEventDetails(event) {
        const { page, mkt: { baseID, quoteID } } = this;
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        const [bui, qui] = [baseAsset.unitInfo, quoteAsset.unitInfo];
        const [baseTicker, quoteTicker] = [bui.conventional.unit, qui.conventional.unit];
        page.cexOrderID.textContent = trimStringWithEllipsis(event.id, 20);
        if (this.cexOrderIDCopyListener !== undefined) {
            page.copyCexOrderID.removeEventListener('click', this.cexOrderIDCopyListener);
        }
        this.cexOrderIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.id, page.cexOrderID, page.copyCexOrderID, '#1e7d11'); };
        page.copyCexOrderID.addEventListener('click', this.cexOrderIDCopyListener);
        page.cexOrderID.setAttribute('title', event.id);
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, event.rate);
        page.cexOrderRate.textContent = `${rate} ${baseTicker}/${quoteTicker}`;
        page.cexOrderQty.textContent = `${event.qty / bui.conventional.conversionFactor} ${baseTicker}`;
        if (event.sell) {
            page.cexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_SELL);
        }
        else {
            page.cexOrderSide.textContent = _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_BUY);
        }
        page.cexOrderBaseFilled.textContent = `${event.baseFilled / bui.conventional.conversionFactor} ${baseTicker}`;
        page.cexOrderQuoteFilled.textContent = `${event.quoteFilled / qui.conventional.conversionFactor} ${quoteTicker}`;
        this.forms.show(page.cexOrderDetailsForm);
    }
    showDepositEventDetails(event, pending) {
        const page = this.page;
        page.depositID.textContent = trimStringWithEllipsis(event.transaction.id, 20);
        if (this.depositIDCopyListener !== undefined) {
            page.copyDepositID.removeEventListener('click', this.depositIDCopyListener);
        }
        this.depositIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.transaction.id, page.depositID, page.copyDepositID, '#1e7d11'); };
        page.copyDepositID.addEventListener('click', this.depositIDCopyListener);
        page.depositID.setAttribute('title', event.transaction.id);
        const unitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[event.assetID].unitInfo;
        const unit = unitInfo.conventional.unit;
        page.depositAmt.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.transaction.amount, unitInfo)} ${unit}`;
        page.depositFees.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.transaction.fees, unitInfo)} ${unit}`;
        page.depositStatus.textContent = pending ? _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_PENDING) : _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_COMPLETE);
        _doc__WEBPACK_IMPORTED_MODULE_3__["default"].setVis(!pending, page.depositCreditSection);
        if (!pending) {
            page.depositCredit.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.cexCredit, unitInfo)} ${unit}`;
        }
        this.forms.show(page.depositDetailsForm);
    }
    showWithdrawalEventDetails(event, pending) {
        const page = this.page;
        page.withdrawalID.textContent = trimStringWithEllipsis(event.id, 20);
        if (this.withdrawalIDCopyListener !== undefined) {
            page.copyWithdrawalID.removeEventListener('click', this.withdrawalIDCopyListener);
        }
        this.withdrawalIDCopyListener = () => { (0,_doc__WEBPACK_IMPORTED_MODULE_3__.setupCopyBtn)(event.id, page.withdrawalID, page.copyWithdrawalID, '#1e7d11'); };
        page.copyWithdrawalID.addEventListener('click', this.withdrawalIDCopyListener);
        page.withdrawalID.setAttribute('title', event.id);
        const unitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[event.assetID].unitInfo;
        const unit = unitInfo.conventional.unit;
        page.withdrawalAmt.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.cexDebit, unitInfo)} ${unit}`;
        page.withdrawalStatus.textContent = pending ? _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_PENDING) : _locales__WEBPACK_IMPORTED_MODULE_6__.prep(_locales__WEBPACK_IMPORTED_MODULE_6__.ID_COMPLETE);
        if (event.transaction) {
            page.withdrawalTxID.textContent = trimStringWithEllipsis(event.transaction.id, 20);
            page.withdrawalTxID.setAttribute('title', event.transaction.id);
            page.withdrawalReceived.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue(event.transaction.amount, unitInfo)} ${unit}`;
        }
        this.forms.show(page.withdrawalDetailsForm);
    }
    showEventDetails(eventID) {
        const [event] = this.events[eventID];
        if (event.dexOrderEvent)
            this.showDexOrderEventDetails(event.dexOrderEvent);
        if (event.cexOrderEvent)
            this.showCexOrderEventDetails(event.cexOrderEvent);
        if (event.depositEvent)
            this.showDepositEventDetails(event.depositEvent, event.pending);
        if (event.withdrawalEvent)
            this.showWithdrawalEventDetails(event.withdrawalEvent, event.pending);
    }
}
function trimStringWithEllipsis(str, maxLen) {
    if (str.length <= maxLen)
        return str;
    return `${str.substring(0, maxLen / 2)}...${str.substring(str.length - maxLen / 2)}`;
}
function sumBalanceEffects(assetID, be) {
    let sum = 0;
    if (be.settled[assetID])
        sum += be.settled[assetID];
    if (be.pending[assetID])
        sum += be.pending[assetID];
    if (be.locked[assetID])
        sum += be.locked[assetID];
    if (be.reserved[assetID])
        sum += be.reserved[assetID];
    return sum;
}


/***/ }),

/***/ "./src/js/mmsettings.ts":
/*!******************************!*\
  !*** ./src/js/mmsettings.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MarketMakerSettingsPage)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _mmutil__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mmutil */ "./src/js/mmutil.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









const specLK = 'lastMMSpecs';
const lastBotsLK = 'lastBots';
const lastArbExchangeLK = 'lastArbExchange';
const arbMMRowCacheKey = 'arbmm';
const defaultSwapReserves = {
    n: 50,
    prec: 0,
    inc: 10,
    minR: 0,
    maxR: 1000,
    range: 1000
};
const defaultOrderReserves = {
    factor: 1.0,
    minR: 0,
    maxR: 3,
    range: 3,
    prec: 3
};
const defaultTransfer = {
    factor: 0.1,
    minR: 0,
    maxR: 1,
    range: 1
};
const defaultSlippage = {
    factor: 0.05,
    minR: 0,
    maxR: 0.3,
    range: 0.3,
    prec: 3
};
const defaultDriftTolerance = {
    value: 0.002,
    minV: 0,
    maxV: 0.02,
    range: 0.02,
    prec: 5
};
const defaultOrderPersistence = {
    value: 20,
    minV: 0,
    maxV: 40,
    range: 40,
    prec: 0
};
const defaultProfit = {
    prec: 3,
    value: 0.01,
    minV: 0.001,
    maxV: 0.1,
    range: 0.1 - 0.001
};
const defaultLevelSpacing = {
    prec: 3,
    value: 0.005,
    minV: 0.001,
    maxV: 0.02,
    range: 0.02 - 0.0001
};
const defaultMatchBuffer = {
    value: 0,
    prec: 3,
    minV: 0,
    maxV: 1,
    range: 1
};
const defaultLevelsPerSide = {
    prec: 0,
    inc: 1,
    value: 1,
    minV: 1
};
const defaultLotsPerLevel = {
    prec: 0,
    value: 1,
    minV: 1,
    usdIncrement: 100
};
const defaultUSDPerSide = {
    prec: 2
};
const defaultMarketMakingConfig = {
    gapStrategy: _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus,
    sellPlacements: [],
    buyPlacements: [],
    driftTolerance: defaultDriftTolerance.value,
    profit: 0.02,
    orderPersistence: defaultOrderPersistence.value,
    cexRebalance: true,
    simpleArbLots: 1
};
const defaultBotAssetConfig = {
    swapFeeN: defaultSwapReserves.n,
    orderReservesFactor: defaultOrderReserves.factor,
    slippageBufferFactor: defaultSlippage.factor,
    transferFactor: defaultTransfer.factor
};
class MarketMakerSettingsPage extends _basepage__WEBPACK_IMPORTED_MODULE_3__["default"] {
    constructor(main, specs) {
        super();
        this.placementsCache = {};
        this.opts = {};
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].idDescendants(main);
        this.forms = new _forms__WEBPACK_IMPORTED_MODULE_6__.Forms(page.forms, {
            closed: () => {
                var _a, _b;
                if (!((_a = this.specs) === null || _a === void 0 ? void 0 : _a.host) || !((_b = this.specs) === null || _b === void 0 ? void 0 : _b.botType))
                    (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm');
            }
        });
        this.placementsChart = new _mmutil__WEBPACK_IMPORTED_MODULE_5__.PlacementsChart(page.placementsChart);
        this.approveTokenForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.TokenApprovalForm(page.approveTokenForm, () => { this.submitBotType(); });
        this.walletAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.DepositAddress(page.walletAddrForm);
        this.cexConfigForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.CEXConfigurationForm(page.cexConfigForm, (cexName) => this.cexConfigured(cexName));
        page.quotePane = page.basePane.cloneNode(true);
        page.assetPaneBox.appendChild(page.quotePane);
        this.basePane = new AssetPane(this, page.basePane);
        this.quotePane = new AssetPane(this, page.quotePane);
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().headerSpace.appendChild(page.mmTitle);
        (0,_opts__WEBPACK_IMPORTED_MODULE_4__.setOptionTemplates)(page);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].cleanTemplates(page.orderOptTmpl, page.booleanOptTmpl, page.rangeOptTmpl, page.placementRowTmpl, page.oracleTmpl, page.cexOptTmpl, page.arbBttnTmpl, page.marketRowTmpl, page.needRegTmpl);
        page.basePane.removeAttribute('id'); // don't remove from layout
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.resetButton, 'click', () => { this.setOriginalValues(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.updateButton, 'click', () => { this.saveSettings(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.createButton, 'click', () => __awaiter(this, void 0, void 0, function* () { this.saveSettings(); }));
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.deleteBttn, 'click', () => { this.delete(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_6__.bind)(page.botTypeForm, page.botTypeSubmit, () => { this.submitBotType(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.noMarketBttn, 'click', () => { this.showMarketSelectForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.botTypeHeader, 'click', () => { this.reshowBotTypeForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.botTypeChangeMarket, 'click', () => { this.showMarketSelectForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.marketHeader, 'click', () => { this.showMarketSelectForm(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.marketFilterInput, 'input', () => { this.sortMarketRows(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.cexRebalanceCheckbox, 'change', () => { this.autoRebalanceChanged(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToAdvanced, 'click', () => { this.showAdvancedConfig(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToQuickConfig, 'click', () => { this.switchToQuickConfig(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.qcMatchBuffer, 'change', () => { this.matchBufferChanged(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToUSDPerSide, 'click', () => { this.changeSideCommitmentDialog(); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.switchToLotsPerLevel, 'click', () => { this.changeSideCommitmentDialog(); });
        // Gap Strategy
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.gapStrategySelect, 'change', () => {
            if (!page.gapStrategySelect.value)
                return;
            const gapStrategy = page.gapStrategySelect.value;
            this.clearPlacements(this.updatedConfig.gapStrategy);
            this.loadCachedPlacements(gapStrategy);
            this.updatedConfig.gapStrategy = gapStrategy;
            this.setGapFactorLabels(gapStrategy);
            this.updateModifiedMarkers();
        });
        // Buy/Sell placements
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addBuyPlacementBtn, 'click', () => {
            this.addPlacement(true, null);
            page.addBuyPlacementLots.value = '';
            page.addBuyPlacementGapFactor.value = '';
            this.updateModifiedMarkers();
            this.placementsChart.render();
            this.updateAllocations();
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addSellPlacementBtn, 'click', () => {
            this.addPlacement(false, null);
            page.addSellPlacementLots.value = '';
            page.addSellPlacementGapFactor.value = '';
            this.updateModifiedMarkers();
            this.placementsChart.render();
            this.updateAllocations();
        });
        this.driftTolerance = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.driftToleranceInput, {
            prec: defaultDriftTolerance.prec - 2,
            sigFigs: true,
            min: 0,
            changed: (rawV) => {
                const { minV, range, prec } = defaultDriftTolerance;
                const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(rawV / 100, prec);
                this.driftToleranceSlider.setValue((v - minV) / range);
                this.updatedConfig.driftTolerance = v;
            }
        });
        this.driftToleranceSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.driftToleranceSlider, (r) => {
            const { minV, range, prec } = defaultDriftTolerance;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(minV + r * range, prec);
            this.updatedConfig.driftTolerance = v;
            this.driftTolerance.setValue(v * 100);
        });
        this.orderPersistence = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.orderPersistence, {
            changed: (v) => {
                const { minV, range } = defaultOrderPersistence;
                this.updatedConfig.orderPersistence = v;
                this.orderPersistenceSlider.setValue((v - minV) / range);
            }
        });
        this.orderPersistenceSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.orderPersistenceSlider, (r) => {
            const { minV, range, prec } = defaultOrderPersistence;
            const rawV = minV + r * range;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(rawV, prec);
            this.updatedConfig.orderPersistence = v;
            this.orderPersistence.setValue(v);
        });
        this.qcProfit = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.qcProfit, {
            prec: defaultProfit.prec - 2,
            sigFigs: true,
            min: defaultProfit.minV * 100,
            changed: (vPct) => {
                const { minV, range } = defaultProfit;
                const v = vPct / 100;
                this.updatedConfig.profit = v;
                page.profitInput.value = this.qcProfit.input.value;
                this.qcProfitSlider.setValue((v - minV) / range);
                this.quickConfigUpdated();
            }
        });
        this.qcProfitSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.qcProfitSlider, (r) => {
            const { minV, range, prec } = defaultProfit;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)((minV + r * range) * 100, prec);
            this.updatedConfig.profit = v / 100;
            this.qcProfit.setValue(v);
            page.profitInput.value = this.qcProfit.input.value;
            this.quickConfigUpdated();
        });
        this.qcLevelSpacing = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.qcLevelSpacing, {
            prec: defaultLevelSpacing.prec - 2,
            sigFigs: true,
            min: defaultLevelSpacing.minV * 100,
            changed: (vPct) => {
                const { minV, range } = defaultLevelSpacing;
                this.qcLevelSpacingSlider.setValue((vPct / 100 - minV) / range);
                this.quickConfigUpdated();
            }
        });
        this.qcLevelSpacingSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.qcLevelSpacingSlider, (r) => {
            const { minV, range } = defaultLevelSpacing;
            this.qcLevelSpacing.setValue(minV + r * range * 100);
            this.quickConfigUpdated();
        });
        this.qcMatchBuffer = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.qcMatchBuffer, {
            prec: defaultMatchBuffer.prec - 2,
            sigFigs: true,
            min: defaultMatchBuffer.minV * 100,
            changed: (vPct) => {
                const { minV, range } = defaultMatchBuffer;
                this.qcMatchBufferSlider.setValue((vPct / 100 - minV) / range);
                this.quickConfigUpdated();
            }
        });
        this.qcMatchBufferSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.qcMatchBufferSlider, (r) => {
            const { minV, range } = defaultMatchBuffer;
            this.qcMatchBuffer.setValue(minV + r * range * 100);
            this.quickConfigUpdated();
        });
        this.qcLevelsPerSide = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.qcLevelsPerSide, {
            prec: defaultLevelsPerSide.prec,
            min: defaultLevelsPerSide.minV,
            inc: defaultLevelsPerSide.inc,
            changed: (v) => {
                this.qcUSDPerSide.setValue(this.lotSizeUSD() * v * this.qcLotsPerLevel.value());
                this.quickConfigUpdated();
            }
        });
        this.qcLotsPerLevel = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.qcLotsPerLevel, {
            prec: defaultLotsPerLevel.prec,
            min: defaultLotsPerLevel.minV,
            inc: 1,
            changed: (v) => {
                this.qcUSDPerSide.setValue(this.lotSizeUSD() * v * this.qcLevelsPerSide.value());
                page.qcUSDPerSideEcho.textContent = this.qcUSDPerSide.input.value;
                this.quickConfigUpdated();
            },
            set: (v) => {
                const [, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(v * this.qcLevelsPerSide.value() * this.lotSizeUSD(), 2);
                page.qcUSDPerSideEcho.textContent = s;
                page.qcLotsPerLevelEcho.textContent = s;
            }
        });
        this.qcUSDPerSide = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.qcUSDPerSide, {
            prec: defaultUSDPerSide.prec,
            min: 1,
            inc: 1,
            changed: (v) => {
                this.qcLotsPerLevel.setValue(v / this.qcLevelsPerSide.value() / this.lotSizeUSD());
                page.qcLotsPerLevelEcho.textContent = this.qcLotsPerLevel.input.value;
                this.quickConfigUpdated();
            },
            set: (v, s) => {
                page.qcUSDPerSideEcho.textContent = s;
                page.qcLotsPerLevelEcho.textContent = String(Math.round(v / this.lotSizeUSD()));
            }
        });
        const maybeSubmitBuyRow = (e) => {
            if (e.key !== 'Enter')
                return;
            if (!isNaN(parseFloat(page.addBuyPlacementGapFactor.value || '')) &&
                !isNaN(parseFloat(page.addBuyPlacementLots.value || ''))) {
                page.addBuyPlacementBtn.click();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addBuyPlacementGapFactor, 'keyup', (e) => { maybeSubmitBuyRow(e); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addBuyPlacementLots, 'keyup', (e) => { maybeSubmitBuyRow(e); });
        const maybeSubmitSellRow = (e) => {
            if (e.key !== 'Enter')
                return;
            if (!isNaN(parseFloat(page.addSellPlacementGapFactor.value || '')) &&
                !isNaN(parseFloat(page.addSellPlacementLots.value || ''))) {
                page.addSellPlacementBtn.click();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addSellPlacementGapFactor, 'keyup', (e) => { maybeSubmitSellRow(e); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.addSellPlacementLots, 'keyup', (e) => { maybeSubmitSellRow(e); });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.profitInput, 'change', () => {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.profitInputErr);
            const showError = (errID) => {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.profitInputErr);
                page.profitInputErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(errID);
            };
            const profit = parseFloat(page.profitInput.value || '') / 100;
            if (isNaN(profit))
                return showError(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_INVALID_VALUE);
            if (profit === 0)
                return showError(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_ZERO);
            this.updatedConfig.profit = profit;
            this.updateModifiedMarkers();
        });
        this.botTypeSelectors = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].applySelector(page.botTypeForm, '[data-bot-type]');
        for (const div of this.botTypeSelectors) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(div, 'click', () => {
                if (div.classList.contains('disabled'))
                    return;
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.botTypeErr);
                page.cexSelection.classList.toggle('disabled', div.dataset.botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM);
                this.setBotTypeSelected(div.dataset.botType);
            });
        }
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_6__.NewWalletForm(page.newWalletForm, () => __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchUser();
            this.submitBotType();
        }));
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().registerNoteFeeder({
            balance: (note) => { this.handleBalanceNote(note); }
        });
        this.initialize(specs);
    }
    unload() {
        this.forms.exit();
    }
    initialize(specs) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            this.setupCEXes();
            this.initializeMarketRows();
            const isRefresh = specs && Object.keys(specs).length === 0;
            if (isRefresh)
                specs = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(specLK);
            if (!specs || !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[specs.baseID] || !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[specs.quoteID]) {
                this.showMarketSelectForm();
                return;
            }
            // If we have specs specifying only a market, make sure the cex name and
            // bot type are set.
            if (specs && !specs.botType) {
                const botCfg = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotConfig)(specs.host, specs.baseID, specs.quoteID);
                specs.cexName = (_a = botCfg === null || botCfg === void 0 ? void 0 : botCfg.cexName) !== null && _a !== void 0 ? _a : '';
                specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM;
                if (botCfg === null || botCfg === void 0 ? void 0 : botCfg.arbMarketMakingConfig)
                    specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM;
                else if (botCfg === null || botCfg === void 0 ? void 0 : botCfg.simpleArbConfig)
                    specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb;
            }
            // Must be a reconfig.
            this.specs = specs;
            yield this.fetchCEXBalances(specs);
            this.configureUI();
        });
    }
    configureUI() {
        var _a, _b, _c, _d, _e;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, specs } = this;
            const { host, baseID, quoteID, cexName, botType } = specs;
            const [{ symbol: baseSymbol, token: baseToken }, { symbol: quoteSymbol, token: quoteToken }] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]];
            this.mktID = `${baseSymbol}_${quoteSymbol}`;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.botSettingsContainer, page.marketBox, page.updateButton, page.resetButton, page.createButton, page.noMarket, page.missingFiatRates);
            if ([baseID, quoteID, (_a = baseToken === null || baseToken === void 0 ? void 0 : baseToken.parentID) !== null && _a !== void 0 ? _a : baseID, (_b = quoteToken === null || quoteToken === void 0 ? void 0 : quoteToken.parentID) !== null && _b !== void 0 ? _b : quoteID].some((assetID) => !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[assetID])) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.missingFiatRates);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.marketLoading);
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(specLK, specs);
            const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus;
            const viewOnly = isViewOnly(specs, mmStatus);
            let botCfg = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotConfig)(host, baseID, quoteID);
            if (botCfg) {
                const oldBotType = botCfg.arbMarketMakingConfig ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM : botCfg.basicMarketMakingConfig ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM : _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb;
                if (oldBotType !== botType)
                    botCfg = undefined;
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botCfg, page.deleteBttnBox);
            const oldCfg = this.originalConfig = Object.assign({}, defaultMarketMakingConfig, {
                disabled: viewOnly,
                baseOptions: this.defaultWalletOptions(baseID),
                quoteOptions: this.defaultWalletOptions(quoteID),
                buyPlacements: [],
                sellPlacements: [],
                baseConfig: Object.assign({}, defaultBotAssetConfig),
                quoteConfig: Object.assign({}, defaultBotAssetConfig)
            });
            if (botCfg) {
                const { basicMarketMakingConfig: mmCfg, arbMarketMakingConfig: arbMMCfg, simpleArbConfig: arbCfg, uiConfig: { cexRebalance } } = botCfg;
                this.creatingNewBot = false;
                // This is kinda sloppy, but we'll copy any relevant issues from the
                // old config into the originalConfig.
                const idx = oldCfg; // typescript
                for (const [k, v] of Object.entries(botCfg))
                    if (idx[k] !== undefined)
                        idx[k] = v;
                oldCfg.baseConfig = Object.assign({}, defaultBotAssetConfig, botCfg.uiConfig.baseConfig);
                oldCfg.quoteConfig = Object.assign({}, defaultBotAssetConfig, botCfg.uiConfig.quoteConfig);
                oldCfg.baseOptions = botCfg.baseWalletOptions || {};
                oldCfg.quoteOptions = botCfg.quoteWalletOptions || {};
                oldCfg.cexRebalance = cexRebalance;
                if (mmCfg) {
                    oldCfg.buyPlacements = mmCfg.buyPlacements;
                    oldCfg.sellPlacements = mmCfg.sellPlacements;
                    oldCfg.driftTolerance = mmCfg.driftTolerance;
                    oldCfg.gapStrategy = mmCfg.gapStrategy;
                }
                else if (arbMMCfg) {
                    const { buyPlacements, sellPlacements } = arbMMCfg;
                    oldCfg.buyPlacements = Array.from(buyPlacements, (p) => { return { lots: p.lots, gapFactor: p.multiplier }; });
                    oldCfg.sellPlacements = Array.from(sellPlacements, (p) => { return { lots: p.lots, gapFactor: p.multiplier }; });
                    oldCfg.profit = arbMMCfg.profit;
                    oldCfg.driftTolerance = arbMMCfg.driftTolerance;
                    oldCfg.orderPersistence = arbMMCfg.orderPersistence;
                }
                else if (arbCfg) {
                    // TODO: expose maxActiveArbs
                    oldCfg.profit = arbCfg.profitTrigger;
                    oldCfg.orderPersistence = arbCfg.numEpochsLeaveOpen;
                    oldCfg.simpleArbLots = (_c = botCfg.uiConfig.simpleArbLots) !== null && _c !== void 0 ? _c : 1;
                }
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!viewOnly, page.updateButton, page.resetButton);
            }
            else {
                this.creatingNewBot = true;
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!viewOnly, page.createButton);
            }
            // Now that we've updated the originalConfig, we'll copy it.
            this.updatedConfig = JSON.parse(JSON.stringify(oldCfg));
            switch (botType) {
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM:
                    page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_BOTTYPE_BASIC_MM);
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM:
                    page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_BOTTYPE_ARB_MM);
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb:
                    page.botTypeDisplay.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_BOTTYPE_SIMPLE_ARB);
            }
            (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setMarketElements)(document.body, baseID, quoteID, host);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb, page.driftToleranceBox, page.switchToAdvanced);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(Boolean(cexName), ..._doc__WEBPACK_IMPORTED_MODULE_1__["default"].applySelector(document.body, '[data-cex-show]'));
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(viewOnly, page.viewOnlyRunning);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(cexName, page.cexRebalanceSettings);
            if (cexName)
                (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setCexElements)(document.body, cexName);
            yield this.fetchMarketReport();
            const lotSizeUSD = this.lotSizeUSD();
            this.lotsPerLevelIncrement = Math.round(Math.max(1, defaultLotsPerLevel.usdIncrement / lotSizeUSD));
            this.qcLotsPerLevel.inc = this.lotsPerLevelIncrement;
            this.qcUSDPerSide.inc = this.lotsPerLevelIncrement * lotSizeUSD;
            this.qcUSDPerSide.min = lotSizeUSD;
            this.basePane.setAsset(baseID, false);
            this.quotePane.setAsset(quoteID, true);
            const { marketReport: { baseFiatRate } } = this;
            this.placementsChart.setMarket({ cexName: cexName, botType, baseFiatRate, dict: this.updatedConfig });
            // If this is a new bot, show the quick config form.
            const isQuickPlacements = !botCfg || this.isQuickPlacements(this.updatedConfig.buyPlacements, this.updatedConfig.sellPlacements);
            const gapStrategy = (_e = (_d = botCfg === null || botCfg === void 0 ? void 0 : botCfg.basicMarketMakingConfig) === null || _d === void 0 ? void 0 : _d.gapStrategy) !== null && _e !== void 0 ? _e : _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus;
            page.gapStrategySelect.value = gapStrategy;
            if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb || (isQuickPlacements && gapStrategy === _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus))
                this.showQuickConfig();
            else
                this.showAdvancedConfig();
            this.setOriginalValues();
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.marketLoading);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botSettingsContainer, page.marketBox);
        });
    }
    initializeMarketRows() {
        this.marketRows = [];
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(this.page.marketSelect);
        for (const { host, markets, assets, auth: { effectiveTier, pendingStrength } } of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges)) {
            if (effectiveTier + pendingStrength === 0) {
                const { needRegTmpl, needRegBox } = this.page;
                const bttn = needRegTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(bttn);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(bttn, 'click', () => { (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('register', { host, backTo: 'mmsettings' }); });
                tmpl.host.textContent = host;
                needRegBox.appendChild(bttn);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(needRegBox);
                continue;
            }
            for (const { name, baseid: baseID, quoteid: quoteID, spot, basesymbol: baseSymbol, quotesymbol: quoteSymbol } of Object.values(markets)) {
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID] || !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID])
                    continue;
                const tr = this.page.marketRowTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tr);
                const mr = { tr, tmpl, host: host, name, baseID, quoteID, spot: spot, arbs: [] };
                this.marketRows.push(mr);
                this.page.marketSelect.appendChild(tr);
                tmpl.baseIcon.src = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(baseSymbol);
                tmpl.quoteIcon.src = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(quoteSymbol);
                tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(assets[baseID], true));
                tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(assets[quoteID], true));
                tmpl.host.textContent = host;
                const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
                for (const [cexName, dinfo] of Object.entries(_mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos)) {
                    if (cexHasMarket(cexName)) {
                        const img = this.page.arbBttnTmpl.cloneNode(true);
                        img.src = dinfo.logo;
                        tmpl.arbs.appendChild(img);
                        mr.arbs.push(cexName);
                    }
                }
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(tr, 'click', () => { this.showBotTypeForm(host, baseID, quoteID); });
            }
        }
        if (this.marketRows.length === 0) {
            const { marketSelectionTable, marketFilterBox, noMarkets } = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(marketSelectionTable, marketFilterBox);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(noMarkets);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(this.page.noMarkets);
        const fiatRates = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap;
        this.marketRows.sort((a, b) => {
            var _a, _b, _c, _d;
            let [volA, volB] = [(_b = (_a = a.spot) === null || _a === void 0 ? void 0 : _a.vol24) !== null && _b !== void 0 ? _b : 0, (_d = (_c = b.spot) === null || _c === void 0 ? void 0 : _c.vol24) !== null && _d !== void 0 ? _d : 0];
            if (fiatRates[a.baseID] && fiatRates[b.baseID]) {
                volA *= fiatRates[a.baseID];
                volB *= fiatRates[b.baseID];
            }
            return volB - volA;
        });
    }
    runningBotInventory(assetID) {
        return (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.runningBotInventory)(assetID);
    }
    adjustedBalances(baseWallet, quoteWallet) {
        const { cexBaseBalance, cexQuoteBalance } = this;
        const [bInv, qInv] = [this.runningBotInventory(baseWallet.assetID), this.runningBotInventory(quoteWallet.assetID)];
        const [cexBaseAvail, cexQuoteAvail] = [((cexBaseBalance === null || cexBaseBalance === void 0 ? void 0 : cexBaseBalance.available) || 0) - bInv.cex.total, ((cexQuoteBalance === null || cexQuoteBalance === void 0 ? void 0 : cexQuoteBalance.available) || 0) - qInv.cex.total];
        const [dexBaseAvail, dexQuoteAvail] = [baseWallet.balance.available - bInv.dex.total, quoteWallet.balance.available - qInv.dex.total];
        const baseAvail = dexBaseAvail + cexBaseAvail;
        const quoteAvail = dexQuoteAvail + cexQuoteAvail;
        return { baseAvail, quoteAvail, dexBaseAvail, dexQuoteAvail, cexBaseAvail, cexQuoteAvail };
    }
    lotSizeUSD() {
        const { specs: { host, baseID }, mktID, marketReport: { baseFiatRate } } = this;
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host];
        const market = xc.markets[mktID];
        const { lotsize: lotSize } = market;
        const { unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        return lotSize / ui.conventional.conversionFactor * baseFiatRate;
    }
    /*
      * marketStuff is just a bunch of useful properties for the current specs
      * gathered in one place and with preferable names.
      */
    marketStuff() {
        const { page, specs: { host, baseID, quoteID, cexName, botType }, basePane, quotePane, marketReport: { baseFiatRate, quoteFiatRate, baseFees, quoteFees }, lotsPerLevelIncrement, updatedConfig: cfg, originalConfig: oldCfg, mktID } = this;
        const { symbol: baseSymbol, unitInfo: bui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        const { symbol: quoteSymbol, unitInfo: qui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host];
        const market = xc.markets[mktID];
        const { lotsize: lotSize, spot } = market;
        const lotSizeUSD = lotSize / bui.conventional.conversionFactor * baseFiatRate;
        const atomicRate = 1 / bui.conventional.conversionFactor * baseFiatRate / quoteFiatRate * qui.conventional.conversionFactor;
        const xcRate = {
            conv: quoteFiatRate / baseFiatRate,
            atomic: atomicRate,
            msg: Math.round(atomicRate * _orderutil__WEBPACK_IMPORTED_MODULE_8__.RateEncodingFactor),
            spot
        };
        let [dexBaseLots, dexQuoteLots] = [cfg.simpleArbLots, cfg.simpleArbLots];
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            dexBaseLots = this.updatedConfig.sellPlacements.reduce((lots, p) => lots + p.lots, 0);
            dexQuoteLots = this.updatedConfig.buyPlacements.reduce((lots, p) => lots + p.lots, 0);
        }
        const quoteLot = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.calculateQuoteLot)(lotSize, baseID, quoteID, spot);
        const walletStuff = this.walletStuff();
        const { baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker } = walletStuff;
        const { commit, fees } = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.feesAndCommit)(baseID, quoteID, baseFees, quoteFees, lotSize, dexBaseLots, dexQuoteLots, baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker, cfg.baseConfig.orderReservesFactor, cfg.quoteConfig.orderReservesFactor);
        return Object.assign({ page, cfg, oldCfg, host, xc, baseID, quoteID, botType, cexName, baseFiatRate, quoteFiatRate,
            xcRate, baseSymbol, quoteSymbol, mktID, lotSize, lotSizeUSD, lotsPerLevelIncrement,
            quoteLot, commit, basePane, quotePane, fees }, walletStuff);
    }
    walletStuff() {
        const { specs: { baseID, quoteID } } = this;
        const [baseWallet, quoteWallet] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteID]];
        const [{ token: baseToken, unitInfo: bui }, { token: quoteToken, unitInfo: qui }] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]];
        const baseFeeAssetID = baseToken ? baseToken.parentID : baseID;
        const quoteFeeAssetID = quoteToken ? quoteToken.parentID : quoteID;
        const [baseFeeUI, quoteFeeUI] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseFeeAssetID].unitInfo, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteFeeAssetID].unitInfo];
        const traitAccountLocker = 1 << 14;
        const baseIsAccountLocker = (baseWallet.traits & traitAccountLocker) > 0;
        const quoteIsAccountLocker = (quoteWallet.traits & traitAccountLocker) > 0;
        return Object.assign({ baseWallet, quoteWallet, baseFeeUI, quoteFeeUI, baseToken, quoteToken,
            bui, qui, baseFeeAssetID, quoteFeeAssetID, baseIsAccountLocker, quoteIsAccountLocker }, this.adjustedBalances(baseWallet, quoteWallet));
    }
    showAdvancedConfig() {
        const { page } = this;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.advancedConfig);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.quickConfig);
        this.placementsChart.render();
    }
    isQuickPlacements(buyPlacements, sellPlacements) {
        if (buyPlacements.length === 0 || buyPlacements.length !== sellPlacements.length)
            return false;
        for (let i = 0; i < buyPlacements.length; i++) {
            if (buyPlacements[i].gapFactor !== sellPlacements[i].gapFactor)
                return false;
            if (buyPlacements[i].lots !== sellPlacements[i].lots)
                return false;
        }
        return true;
    }
    switchToQuickConfig() {
        const { cfg, botType, lotSizeUSD } = this.marketStuff();
        const { buyPlacements: buys, sellPlacements: sells } = cfg;
        // If we have both buys and sells, get the best approximation quick config
        // approximation.
        if (buys.length > 0 && sells.length > 0) {
            const bestBuy = buys.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
            const bestSell = sells.reduce((prev, curr) => curr.gapFactor < prev.gapFactor ? curr : prev);
            const placementCount = buys.length + sells.length;
            const levelsPerSide = Math.max(1, Math.floor((placementCount) / 2));
            if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
                cfg.profit = (bestBuy.gapFactor + bestSell.gapFactor) / 2;
                const worstBuy = buys.reduce((prev, curr) => curr.gapFactor > prev.gapFactor ? curr : prev);
                const worstSell = sells.reduce((prev, curr) => curr.gapFactor > prev.gapFactor ? curr : prev);
                const range = ((worstBuy.gapFactor - bestBuy.gapFactor) + (worstSell.gapFactor - bestSell.gapFactor)) / 2;
                const inc = range / (levelsPerSide - 1);
                this.qcProfit.setValue(cfg.profit * 100);
                this.qcProfitSlider.setValue((cfg.profit - defaultProfit.minV) / defaultProfit.range);
                this.qcLevelSpacing.setValue(inc * 100);
                this.qcLevelSpacingSlider.setValue((inc - defaultLevelSpacing.minV) / defaultLevelSpacing.range);
            }
            else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM) {
                const multSum = buys.reduce((v, p) => v + p.gapFactor, 0) + sells.reduce((v, p) => v + p.gapFactor, 0);
                const buffer = ((multSum / placementCount) - 1) || defaultMatchBuffer.value;
                this.qcMatchBuffer.setValue(buffer * 100);
                this.qcMatchBufferSlider.setValue((buffer - defaultMatchBuffer.minV) / defaultMatchBuffer.range);
            }
            const lots = buys.reduce((v, p) => v + p.lots, 0) + sells.reduce((v, p) => v + p.lots, 0);
            const lotsPerLevel = Math.max(1, Math.round(lots / 2 / levelsPerSide));
            this.qcLotsPerLevel.setValue(lotsPerLevel);
            this.qcUSDPerSide.setValue(lotsPerLevel * levelsPerSide * lotSizeUSD);
            this.qcLevelsPerSide.setValue(levelsPerSide);
        }
        else if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            this.qcLotsPerLevel.setValue(cfg.simpleArbLots);
        }
        this.showQuickConfig();
        this.quickConfigUpdated();
    }
    showQuickConfig() {
        const { page, lotSizeUSD, botType, lotsPerLevelIncrement } = this.marketStuff();
        if (!this.qcLevelsPerSide.input.value) {
            this.qcLevelsPerSide.setValue(defaultLevelsPerSide.value);
            this.qcUSDPerSide.setValue(defaultLevelsPerSide.value * (this.qcLotsPerLevel.value() || lotsPerLevelIncrement) * lotSizeUSD);
        }
        if (!this.qcLotsPerLevel.input.value) {
            this.qcLotsPerLevel.setValue(lotsPerLevelIncrement);
            this.qcUSDPerSide.setValue(lotSizeUSD * lotsPerLevelIncrement * this.qcLevelsPerSide.value());
        }
        if (!page.qcLevelSpacing.value) {
            this.qcLevelSpacing.setValue(defaultLevelSpacing.value * 100);
            this.qcLevelSpacingSlider.setValue((defaultLevelSpacing.value - defaultLevelSpacing.minV) / defaultLevelSpacing.range);
        }
        if (!page.qcMatchBuffer.value)
            page.qcMatchBuffer.value = String(defaultMatchBuffer.value * 100);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.advancedConfig);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.quickConfig);
        this.showInputsForBot(botType);
    }
    showInputsForBot(botType) {
        const { page, opts: { usingUSDPerSide } } = this;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.matchMultiplierBox, page.placementsChartBox, page.placementChartLegend, page.lotsPerLevelLabel, page.levelSpacingBox, page.arbLotsLabel, page.qcLevelPerSideBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(usingUSDPerSide, page.qcUSDPerSideBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!usingUSDPerSide, page.qcLotsBox);
        switch (botType) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM:
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.qcLevelPerSideBox, page.matchMultiplierBox, page.placementsChartBox, page.placementChartLegend, page.lotsPerLevelLabel);
                break;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM:
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.qcLevelPerSideBox, page.levelSpacingBox, page.placementsChartBox, page.lotsPerLevelLabel);
                break;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb:
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.arbLotsLabel);
        }
    }
    quickConfigUpdated() {
        var _a, _b, _c;
        const { page, cfg, botType, cexName } = this.marketStuff();
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.qcError);
        const setError = (msg) => {
            page.qcError.textContent = msg;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.qcError);
        };
        const levelsPerSide = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb ? 1 : this.qcLevelsPerSide.value();
        if (isNaN(levelsPerSide)) {
            setError('invalid value for levels per side');
        }
        const lotsPerLevel = this.qcLotsPerLevel.value();
        if (isNaN(lotsPerLevel)) {
            setError('invalid value for lots per level');
        }
        const profit = parseFloat((_a = page.qcProfit.value) !== null && _a !== void 0 ? _a : '') / 100;
        if (isNaN(profit)) {
            setError('invalid value for profit');
        }
        const levelSpacing = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM ? parseFloat((_b = page.qcLevelSpacing.value) !== null && _b !== void 0 ? _b : '') / 100 : 0;
        if (isNaN(levelSpacing)) {
            setError('invalid value for level spacing');
        }
        const matchBuffer = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM ? parseFloat((_c = page.qcMatchBuffer.value) !== null && _c !== void 0 ? _c : '') / 100 : 0;
        if (isNaN(matchBuffer)) {
            setError('invalid value for match buffer');
        }
        const multiplier = matchBuffer + 1;
        const levelSpacingDisabled = levelsPerSide === 1;
        page.levelSpacingBox.classList.toggle('disabled', levelSpacingDisabled);
        page.qcLevelSpacing.disabled = levelSpacingDisabled;
        cfg.simpleArbLots = lotsPerLevel;
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            this.clearPlacements(cexName ? arbMMRowCacheKey : cfg.gapStrategy);
            for (let levelN = 0; levelN < levelsPerSide; levelN++) {
                const placement = { lots: lotsPerLevel };
                placement.gapFactor = botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM ? profit + levelSpacing * levelN : multiplier;
                cfg.buyPlacements.push(placement);
                cfg.sellPlacements.push(placement);
                // Add rows in the advanced config table.
                this.addPlacement(true, placement);
                this.addPlacement(false, placement);
            }
            this.placementsChart.render();
        }
        this.updateAllocations();
    }
    updateAllocations() {
        this.updateBaseAllocations();
        this.updateQuoteAllocations();
    }
    updateBaseAllocations() {
        const { commit, lotSize, basePane, fees } = this.marketStuff();
        basePane.updateInventory(commit.dex.base.lots, commit.dex.quote.lots, lotSize, commit.dex.base.val, commit.cex.base.val, fees.base);
        basePane.updateCommitTotal();
    }
    updateQuoteAllocations() {
        const { commit, quoteLot: lotSize, quotePane, fees } = this.marketStuff();
        quotePane.updateInventory(commit.dex.quote.lots, commit.dex.base.lots, lotSize, commit.dex.quote.val, commit.cex.quote.val, fees.quote);
        quotePane.updateCommitTotal();
    }
    matchBufferChanged() {
        var _a;
        const { page } = this;
        page.qcMatchBuffer.value = Math.max(0, parseFloat((_a = page.qcMatchBuffer.value) !== null && _a !== void 0 ? _a : '') || defaultMatchBuffer.value * 100).toFixed(2);
        this.quickConfigUpdated();
    }
    showAddress(assetID) {
        this.walletAddrForm.setAsset(assetID);
        this.forms.show(this.page.walletAddrForm);
    }
    changeSideCommitmentDialog() {
        const { page, opts } = this;
        opts.usingUSDPerSide = !opts.usingUSDPerSide;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(opts.usingUSDPerSide, page.qcUSDPerSideBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!opts.usingUSDPerSide, page.qcLotsBox);
    }
    showBotTypeForm(host, baseID, quoteID, botType, configuredCEX) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page } = this;
            this.formSpecs = { host, baseID, quoteID, botType: '' };
            const viewOnly = isViewOnly(this.formSpecs, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus);
            if (viewOnly) {
                const botCfg = (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.liveBotConfig)(host, baseID, quoteID);
                const specs = this.specs = this.formSpecs;
                switch (true) {
                    case Boolean(botCfg === null || botCfg === void 0 ? void 0 : botCfg.simpleArbConfig):
                        specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb;
                        break;
                    case Boolean(botCfg === null || botCfg === void 0 ? void 0 : botCfg.arbMarketMakingConfig):
                        specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM;
                        break;
                    default:
                        specs.botType = _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM;
                }
                specs.cexName = botCfg === null || botCfg === void 0 ? void 0 : botCfg.cexName;
                yield this.fetchCEXBalances(this.formSpecs);
                yield this.configureUI();
                this.forms.close();
                return;
            }
            (0,_mmutil__WEBPACK_IMPORTED_MODULE_5__.setMarketElements)(page.botTypeForm, baseID, quoteID, host);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.botTypeBaseSymbol, page.botTypeQuoteSymbol);
            const [b, q] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]];
            page.botTypeBaseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(b, true));
            page.botTypeQuoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_1__["default"].symbolize(q, true));
            for (const div of this.botTypeSelectors)
                div.classList.remove('selected');
            for (const { div } of Object.values(this.formCexes))
                div.classList.remove('selected');
            this.setCEXAvailability(baseID, quoteID);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.noCexesConfigured, page.noCexMarket, page.noCexMarketConfigureMore, page.botTypeErr);
            const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
            const supportingCexes = {};
            for (const cex of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes)) {
                if (cexHasMarket(cex.config.name))
                    supportingCexes[cex.config.name] = cex.config;
            }
            const nCexes = Object.keys(supportingCexes).length;
            const arbEnabled = nCexes > 0;
            for (const div of this.botTypeSelectors)
                div.classList.toggle('disabled', div.dataset.botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM && !arbEnabled);
            if (Object.keys((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes).length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noCexesConfigured);
                this.setBotTypeSelected(_mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM);
            }
            else {
                const lastBots = (_state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastBotsLK) || {});
                const lastBot = lastBots[`${baseID}_${quoteID}_${host}`];
                let cex;
                botType = botType !== null && botType !== void 0 ? botType : (lastBot ? lastBot.botType : _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM);
                if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
                    // Four ways to auto-select a cex.
                    // 1. Coming back from the cex configuration form.
                    if (configuredCEX)
                        cex = supportingCexes[configuredCEX];
                    // 2. We have a saved configuration.
                    if (!cex && lastBot)
                        cex = supportingCexes[(_a = lastBot.cexName) !== null && _a !== void 0 ? _a : ''];
                    // 3. The last exchange that the user selected.
                    if (!cex) {
                        const lastCEX = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastArbExchangeLK);
                        if (lastCEX)
                            cex = supportingCexes[lastCEX];
                    }
                    // 4. Any supporting cex.
                    if (!cex && nCexes > 0)
                        cex = Object.values(supportingCexes)[0];
                }
                if (cex) {
                    page.cexSelection.classList.remove('disabled');
                    this.setBotTypeSelected(botType !== null && botType !== void 0 ? botType : (lastBot ? lastBot.botType : _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM));
                    this.selectFormCEX(cex.name);
                }
                else {
                    page.cexSelection.classList.add('disabled');
                    _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noCexMarket);
                    this.setBotTypeSelected(_mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM);
                    // If there are unconfigured cexes, show configureMore message.
                    const unconfigured = Object.keys(_mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos).filter((cexName) => !(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName]);
                    const allConfigured = unconfigured.length === 0 || (unconfigured.length === 1 && (unconfigured[0] === 'Binance' || unconfigured[0] === 'BinanceUS'));
                    if (!allConfigured)
                        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noCexMarketConfigureMore);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.cexSelection);
            // Check if we have any cexes configured.
            this.forms.show(page.botTypeForm);
        });
    }
    reshowBotTypeForm() {
        if (isViewOnly(this.specs, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus))
            this.showMarketSelectForm();
        const { baseID, quoteID, host, cexName, botType } = this.specs;
        this.showBotTypeForm(host, baseID, quoteID, botType, cexName);
    }
    setBotTypeSelected(selectedType) {
        var _a;
        const { formSpecs: { baseID, quoteID, host }, botTypeSelectors, formCexes } = this;
        for (const { classList, dataset: { botType } } of botTypeSelectors)
            classList.toggle('selected', botType === selectedType);
        // If we don't have a cex selected, attempt to select one
        if (selectedType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM)
            return;
        const mmStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus;
        if (Object.keys(mmStatus.cexes).length === 0)
            return;
        const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
        // If there is one currently selected and it supports this market, leave it.
        const selecteds = Object.values(formCexes).filter((cex) => cex.div.classList.contains('selected'));
        if (selecteds.length && cexHasMarket(selecteds[0].name))
            return;
        // See if we have a saved configuration.
        const lastBots = (_state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastBotsLK) || {});
        const lastBot = lastBots[`${baseID}_${quoteID}_${host}`];
        if (lastBot) {
            const cex = mmStatus.cexes[(_a = lastBot.cexName) !== null && _a !== void 0 ? _a : ''];
            if (cex && cexHasMarket(cex.config.name)) {
                this.selectFormCEX(cex.config.name);
                return;
            }
        }
        // 2. The last exchange that the user selected.
        const lastCEX = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastArbExchangeLK);
        if (lastCEX) {
            const cex = mmStatus.cexes[lastCEX];
            if (cex && cexHasMarket(cex.config.name)) {
                this.selectFormCEX(cex.config.name);
                return;
            }
        }
        // 3. Any supporting cex.
        const cexes = Object.values(mmStatus.cexes).filter((cex) => cexHasMarket(cex.config.name));
        if (cexes.length)
            this.selectFormCEX(cexes[0].config.name);
    }
    showMarketSelectForm() {
        this.page.marketFilterInput.value = '';
        this.sortMarketRows();
        this.forms.show(this.page.marketSelectForm);
    }
    sortMarketRows() {
        var _a;
        const page = this.page;
        const filter = (_a = page.marketFilterInput.value) === null || _a === void 0 ? void 0 : _a.toLowerCase();
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.marketSelect);
        for (const mr of this.marketRows) {
            mr.tr.classList.remove('selected');
            if (filter && !mr.name.includes(filter))
                continue;
            page.marketSelect.appendChild(mr.tr);
        }
    }
    handleBalanceNote(n) {
        this.approveTokenForm.handleBalanceNote(n);
        if (!this.marketReport)
            return;
        const { baseID, quoteID, quoteToken, baseToken } = this.marketStuff();
        if (n.assetID === baseID || n.assetID === (baseToken === null || baseToken === void 0 ? void 0 : baseToken.parentID)) {
            this.basePane.updateBalances();
        }
        else if (n.assetID === quoteID || n.assetID === (quoteToken === null || quoteToken === void 0 ? void 0 : quoteToken.parentID)) {
            this.quotePane.updateBalances();
        }
    }
    autoRebalanceChanged() {
        var _a, _b;
        const { page, updatedConfig: cfg } = this;
        cfg.cexRebalance = (_b = (_a = page.cexRebalanceCheckbox) === null || _a === void 0 ? void 0 : _a.checked) !== null && _b !== void 0 ? _b : false;
        this.updateAllocations();
    }
    submitBotType() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loading(this.page.botTypeForm);
            try {
                yield this.submitBotWithValidation();
            }
            finally {
                loaded();
            }
        });
    }
    submitBotWithValidation() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            // check for wallets
            const { page, forms, formSpecs: { baseID, quoteID, host } } = this;
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseID]) {
                this.newWalletForm.setAsset(baseID);
                forms.show(this.page.newWalletForm);
                return;
            }
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteID]) {
                this.newWalletForm.setAsset(quoteID);
                forms.show(this.page.newWalletForm);
                return;
            }
            // Are tokens approved?
            const [bApproval, qApproval] = tokenAssetApprovalStatuses(host, (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID]);
            if (bApproval === _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.NotApproved) {
                this.approveTokenForm.setAsset(baseID, host);
                forms.show(page.approveTokenForm);
                return;
            }
            if (qApproval === _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.NotApproved) {
                this.approveTokenForm.setAsset(quoteID, host);
                forms.show(page.approveTokenForm);
                return;
            }
            const { botTypeSelectors } = this;
            const selecteds = botTypeSelectors.filter((div) => div.classList.contains('selected'));
            if (selecteds.length < 1) {
                page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_BOTTYPE);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                return;
            }
            const botType = this.formSpecs.botType = (_a = selecteds[0].dataset.botType) !== null && _a !== void 0 ? _a : '';
            if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
                const selecteds = Object.values(this.formCexes).filter((cex) => cex.div.classList.contains('selected'));
                if (selecteds.length < 1) {
                    page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_CEX);
                    _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                    return;
                }
                const cexName = selecteds[0].name;
                this.formSpecs.cexName = cexName;
                yield this.fetchCEXBalances(this.formSpecs);
            }
            this.specs = this.formSpecs;
            this.configureUI();
            this.forms.close();
        });
    }
    fetchCEXBalances(specs) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page } = this;
            const { baseID, quoteID, cexName, botType } = specs;
            if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM || !cexName)
                return;
            try {
                // This won't work if we implement live reconfiguration, because locked
                // funds would need to be considered.
                this.cexBaseBalance = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.cexBalance(cexName, baseID);
            }
            catch (e) {
                page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_CEXBALANCE_ERR, { cexName, assetID: String(baseID), err: String(e) });
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                throw e;
            }
            try {
                this.cexQuoteBalance = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.cexBalance(cexName, quoteID);
            }
            catch (e) {
                page.botTypeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_CEXBALANCE_ERR, { cexName, assetID: String(quoteID), err: String(e) });
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.botTypeErr);
                throw e;
            }
        });
    }
    defaultWalletOptions(assetID) {
        const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().currentWalletDefinition(assetID);
        if (!walletDef.multifundingopts) {
            return {};
        }
        const options = {};
        for (const opt of walletDef.multifundingopts) {
            if (opt.quoteAssetOnly && assetID !== this.specs.quoteID) {
                continue;
            }
            options[opt.key] = `${opt.default}`;
        }
        return options;
    }
    /*
     * updateModifiedMarkers checks each of the input elements on the page and
     * if the current value does not match the original value (since the last
     * save), then the input will have a colored border.
     */
    updateModifiedMarkers() {
        if (this.creatingNewBot)
            return;
        const { page, originalConfig: oldCfg, updatedConfig: newCfg } = this;
        // Gap strategy input
        const gapStrategyModified = oldCfg.gapStrategy !== newCfg.gapStrategy;
        page.gapStrategySelect.classList.toggle('modified', gapStrategyModified);
        const profitModified = oldCfg.profit !== newCfg.profit;
        page.profitInput.classList.toggle('modified', profitModified);
        // Buy placements Input
        let buyPlacementsModified = false;
        if (oldCfg.buyPlacements.length !== newCfg.buyPlacements.length) {
            buyPlacementsModified = true;
        }
        else {
            for (let i = 0; i < oldCfg.buyPlacements.length; i++) {
                if (oldCfg.buyPlacements[i].lots !== newCfg.buyPlacements[i].lots ||
                    oldCfg.buyPlacements[i].gapFactor !== newCfg.buyPlacements[i].gapFactor) {
                    buyPlacementsModified = true;
                    break;
                }
            }
        }
        page.buyPlacementsTableWrapper.classList.toggle('modified', buyPlacementsModified);
        // Sell placements input
        let sellPlacementsModified = false;
        if (oldCfg.sellPlacements.length !== newCfg.sellPlacements.length) {
            sellPlacementsModified = true;
        }
        else {
            for (let i = 0; i < oldCfg.sellPlacements.length; i++) {
                if (oldCfg.sellPlacements[i].lots !== newCfg.sellPlacements[i].lots ||
                    oldCfg.sellPlacements[i].gapFactor !== newCfg.sellPlacements[i].gapFactor) {
                    sellPlacementsModified = true;
                    break;
                }
            }
        }
        page.sellPlacementsTableWrapper.classList.toggle('modified', sellPlacementsModified);
    }
    /*
     * gapFactorHeaderUnit returns the header on the placements table and the
     * units in the gap factor rows needed for each gap strategy.
     */
    gapFactorHeaderUnit(gapStrategy) {
        switch (gapStrategy) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier:
                return ['Multiplier', 'x'];
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolute:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolutePlus: {
                const rateUnit = `${(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.specs.quoteID].symbol}/${(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.specs.baseID].symbol}`;
                return ['Rate', rateUnit];
            }
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercent:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus:
                return ['Percent', '%'];
            default:
                throw new Error(`Unknown gap strategy ${gapStrategy}`);
        }
    }
    /*
     * checkGapFactorRange returns an error string if the value input for a
     * gap factor is valid for the currently selected gap strategy.
     */
    checkGapFactorRange(gapFactor, value) {
        switch (gapFactor) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier:
                if (value < 1 || value > 100) {
                    return 'Multiplier must be between 1 and 100';
                }
                return null;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolute:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolutePlus:
                if (value <= 0) {
                    return 'Rate must be greater than 0';
                }
                return null;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercent:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus:
                if (value <= 0 || value > 10) {
                    return 'Percent must be between 0 and 10';
                }
                return null;
            default: {
                throw new Error(`Unknown gap factor ${gapFactor}`);
            }
        }
    }
    /*
     * convertGapFactor converts between the displayed gap factor in the
     * placement tables and the number that is passed to the market maker.
     * For gap strategies that involve a percentage it converts between the
     * decimal value required by the backend and a percentage displayed to
     * the user.
     */
    convertGapFactor(gapFactor, gapStrategy, toDisplay) {
        switch (gapStrategy) {
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolute:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyAbsolutePlus:
                return gapFactor;
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercent:
            case _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyPercentPlus:
                if (toDisplay) {
                    return gapFactor * 100;
                }
                return gapFactor / 100;
            default:
                throw new Error(`Unknown gap factor ${gapStrategy}`);
        }
    }
    /*
     * addPlacement adds a row to a placement table. This is called both when
     * the page is initially loaded, and when the "add" button is pressed on
     * the placement table. initialLoadPlacement is non-nil if this is being
     * called on the initial load.
     */
    addPlacement(isBuy, initialLoadPlacement, gapStrategy) {
        const { page, updatedConfig: cfg } = this;
        let tableBody = page.sellPlacementsTableBody;
        let addPlacementRow = page.addSellPlacementRow;
        let lotsElement = page.addSellPlacementLots;
        let gapFactorElement = page.addSellPlacementGapFactor;
        let errElement = page.sellPlacementsErr;
        if (isBuy) {
            tableBody = page.buyPlacementsTableBody;
            addPlacementRow = page.addBuyPlacementRow;
            lotsElement = page.addBuyPlacementLots;
            gapFactorElement = page.addBuyPlacementGapFactor;
            errElement = page.buyPlacementsErr;
        }
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(errElement);
        // updateArrowVis updates the visibility of the move up/down arrows in
        // each row of the placement table. The up arrow is not shown on the
        // top row, and the down arrow is not shown on the bottom row. They
        // are all hidden if market making is running.
        const updateArrowVis = () => {
            for (let i = 0; i < tableBody.children.length - 1; i++) {
                const row = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tableBody.children[i]);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(i !== 0, row.upBtn);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(i !== tableBody.children.length - 2, row.downBtn);
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(errElement);
        const setErr = (err) => {
            errElement.textContent = err;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(errElement);
        };
        let lots;
        let actualGapFactor;
        let displayedGapFactor;
        if (!gapStrategy)
            gapStrategy = this.specs.cexName ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier : cfg.gapStrategy;
        const placements = isBuy ? cfg.buyPlacements : cfg.sellPlacements;
        const unit = this.gapFactorHeaderUnit(gapStrategy)[1];
        if (initialLoadPlacement) {
            lots = initialLoadPlacement.lots;
            actualGapFactor = initialLoadPlacement.gapFactor;
            displayedGapFactor = this.convertGapFactor(actualGapFactor, gapStrategy, true);
        }
        else {
            lots = parseInt(lotsElement.value || '0');
            displayedGapFactor = parseFloat(gapFactorElement.value || '0');
            actualGapFactor = this.convertGapFactor(displayedGapFactor, gapStrategy, false);
            if (lots === 0) {
                setErr('Lots must be greater than 0');
                return;
            }
            const gapFactorErr = this.checkGapFactorRange(gapStrategy, displayedGapFactor);
            if (gapFactorErr) {
                setErr(gapFactorErr);
                return;
            }
            if (placements.find((placement) => placement.gapFactor === actualGapFactor)) {
                setErr('Duplicate placement');
                return;
            }
            placements.push({ lots, gapFactor: actualGapFactor });
        }
        const newRow = page.placementRowTmpl.cloneNode(true);
        const newRowTmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(newRow);
        newRowTmpl.priority.textContent = `${tableBody.children.length}`;
        newRowTmpl.lots.textContent = `${lots}`;
        newRowTmpl.gapFactor.textContent = `${displayedGapFactor} ${unit}`;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(newRowTmpl.removeBtn, 'click', () => {
            const index = placements.findIndex((placement) => {
                return placement.lots === lots && placement.gapFactor === actualGapFactor;
            });
            if (index === -1)
                return;
            placements.splice(index, 1);
            newRow.remove();
            updateArrowVis();
            this.updateModifiedMarkers();
            this.placementsChart.render();
            this.updateAllocations();
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(newRowTmpl.upBtn, 'click', () => {
            const index = placements.findIndex((p) => p.lots === lots && p.gapFactor === actualGapFactor);
            if (index === 0)
                return;
            const prevPlacement = placements[index - 1];
            placements[index - 1] = placements[index];
            placements[index] = prevPlacement;
            newRowTmpl.priority.textContent = `${index}`;
            newRow.remove();
            tableBody.insertBefore(newRow, tableBody.children[index - 1]);
            const movedDownTmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tableBody.children[index]);
            movedDownTmpl.priority.textContent = `${index + 1}`;
            updateArrowVis();
            this.updateModifiedMarkers();
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(newRowTmpl.downBtn, 'click', () => {
            const index = placements.findIndex((p) => p.lots === lots && p.gapFactor === actualGapFactor);
            if (index === placements.length - 1)
                return;
            const nextPlacement = placements[index + 1];
            placements[index + 1] = placements[index];
            placements[index] = nextPlacement;
            newRowTmpl.priority.textContent = `${index + 2}`;
            newRow.remove();
            tableBody.insertBefore(newRow, tableBody.children[index + 1]);
            const movedUpTmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tableBody.children[index]);
            movedUpTmpl.priority.textContent = `${index + 1}`;
            updateArrowVis();
            this.updateModifiedMarkers();
        });
        tableBody.insertBefore(newRow, addPlacementRow);
        updateArrowVis();
    }
    setArbMMLabels() {
        this.page.buyGapFactorHdr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_MATCH_BUFFER);
        this.page.sellGapFactorHdr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_MATCH_BUFFER);
    }
    /*
     * setGapFactorLabels sets the headers on the gap factor column of each
     * placement table.
     */
    setGapFactorLabels(gapStrategy) {
        const page = this.page;
        const header = this.gapFactorHeaderUnit(gapStrategy)[0];
        page.buyGapFactorHdr.textContent = header;
        page.sellGapFactorHdr.textContent = header;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.percentPlusInfo, page.percentInfo, page.absolutePlusInfo, page.absoluteInfo, page.multiplierInfo);
        switch (gapStrategy) {
            case 'percent-plus':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.percentPlusInfo);
            case 'percent':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.percentInfo);
            case 'absolute-plus':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.absolutePlusInfo);
            case 'absolute':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.absoluteInfo);
            case 'multiplier':
                return _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.multiplierInfo);
        }
    }
    clearPlacements(cacheKey) {
        const { page, updatedConfig: cfg } = this;
        while (page.buyPlacementsTableBody.children.length > 1) {
            page.buyPlacementsTableBody.children[0].remove();
        }
        while (page.sellPlacementsTableBody.children.length > 1) {
            page.sellPlacementsTableBody.children[0].remove();
        }
        this.placementsCache[cacheKey] = [cfg.buyPlacements, cfg.sellPlacements];
        cfg.buyPlacements.splice(0, cfg.buyPlacements.length);
        cfg.sellPlacements.splice(0, cfg.sellPlacements.length);
    }
    loadCachedPlacements(cacheKey) {
        const c = this.placementsCache[cacheKey];
        if (!c)
            return;
        const { updatedConfig: cfg } = this;
        cfg.buyPlacements.splice(0, cfg.buyPlacements.length);
        cfg.sellPlacements.splice(0, cfg.sellPlacements.length);
        cfg.buyPlacements.push(...c[0]);
        cfg.sellPlacements.push(...c[1]);
        const gapStrategy = cacheKey === arbMMRowCacheKey ? _mmutil__WEBPACK_IMPORTED_MODULE_5__.GapStrategyMultiplier : cacheKey;
        for (const p of cfg.buyPlacements)
            this.addPlacement(true, p, gapStrategy);
        for (const p of cfg.sellPlacements)
            this.addPlacement(false, p, gapStrategy);
    }
    /*
     * setOriginalValues sets the updatedConfig field to be equal to the
     * and sets the values displayed buy each field input to be equal
     * to the values since the last save.
     */
    setOriginalValues() {
        var _a, _b, _c;
        const { page, originalConfig: oldCfg, updatedConfig: cfg, specs: { cexName, botType } } = this;
        this.clearPlacements(cexName ? arbMMRowCacheKey : cfg.gapStrategy);
        const assign = (to, from) => {
            for (const [k, v] of Object.entries(from)) {
                if (Array.isArray(v)) {
                    to[k].splice(0, to[k].length);
                    for (const i of v)
                        to[k].push(i);
                }
                else if (typeof v === 'object')
                    Object.assign(to[k], v);
                else
                    to[k] = from[k];
            }
        };
        assign(cfg, JSON.parse(JSON.stringify(oldCfg)));
        const tol = (_a = cfg.driftTolerance) !== null && _a !== void 0 ? _a : defaultDriftTolerance.value;
        this.driftTolerance.setValue(tol * 100);
        this.driftToleranceSlider.setValue(tol / defaultDriftTolerance.maxV);
        const persist = (_b = cfg.orderPersistence) !== null && _b !== void 0 ? _b : defaultOrderPersistence.value;
        this.orderPersistence.setValue(persist);
        this.orderPersistenceSlider.setValue(persist / defaultOrderPersistence.maxV);
        const profit = (_c = cfg.profit) !== null && _c !== void 0 ? _c : defaultProfit.value;
        page.profitInput.value = String(profit * 100);
        this.qcProfit.setValue(profit * 100);
        this.qcProfitSlider.setValue((profit - defaultProfit.minV) / defaultProfit.range);
        if (cexName) {
            page.cexRebalanceCheckbox.checked = cfg.cexRebalance;
            this.autoRebalanceChanged();
        }
        // Gap strategy
        if (!page.gapStrategySelect.options)
            return;
        Array.from(page.gapStrategySelect.options).forEach((opt) => { opt.selected = opt.value === cfg.gapStrategy; });
        this.setGapFactorLabels(cfg.gapStrategy);
        if (botType === _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.gapStrategyBox);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.profitSelectorBox, page.orderPersistenceBox);
            this.setGapFactorLabels(page.gapStrategySelect.value || '');
        }
        else if (cexName && (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName]) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.gapStrategyBox);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.profitSelectorBox, page.orderPersistenceBox);
            this.setArbMMLabels();
        }
        // Buy/Sell placements
        oldCfg.buyPlacements.forEach((p) => { this.addPlacement(true, p); });
        oldCfg.sellPlacements.forEach((p) => { this.addPlacement(false, p); });
        this.basePane.setupWalletSettings();
        this.quotePane.setupWalletSettings();
        this.updateModifiedMarkers();
        if (_doc__WEBPACK_IMPORTED_MODULE_1__["default"].isDisplayed(page.quickConfig))
            this.switchToQuickConfig();
    }
    /*
     * validateFields validates configuration values and optionally shows error
     * messages.
     */
    validateFields(showErrors) {
        let ok = true;
        const { page, specs: { botType }, updatedConfig: { sellPlacements, buyPlacements, profit } } = this;
        const setError = (errEl, errID) => {
            ok = false;
            if (!showErrors)
                return;
            errEl.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(errID);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(errEl);
        };
        if (showErrors) {
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.buyPlacementsErr, page.sellPlacementsErr, page.profitInputErr);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb && buyPlacements.length + sellPlacements.length === 0) {
            setError(page.buyPlacementsErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_PLACEMENTS);
            setError(page.sellPlacementsErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_PLACEMENTS);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
            if (isNaN(profit))
                setError(page.profitInputErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_INVALID_VALUE);
            else if (profit === 0)
                setError(page.profitInputErr, _locales__WEBPACK_IMPORTED_MODULE_7__.ID_NO_ZERO);
        }
        return ok;
    }
    /*
     * saveSettings updates the settings in the backend, and sets the originalConfig
     * to be equal to the updatedConfig.
     */
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            // Make a copy and delete either the basic mm config or the arb-mm config,
            // depending on whether a cex is selected.
            if (!this.validateFields(true))
                return;
            const { cfg, baseID, quoteID, host, botType, cexName } = this.marketStuff();
            const botCfg = {
                host: host,
                baseID: baseID,
                quoteID: quoteID,
                cexName: cexName !== null && cexName !== void 0 ? cexName : '',
                uiConfig: {
                    simpleArbLots: cfg.simpleArbLots,
                    baseConfig: cfg.baseConfig,
                    quoteConfig: cfg.quoteConfig,
                    cexRebalance: cfg.cexRebalance
                },
                baseWalletOptions: cfg.baseOptions,
                quoteWalletOptions: cfg.quoteOptions
            };
            switch (botType) {
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM:
                    botCfg.basicMarketMakingConfig = this.basicMMConfig();
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM:
                    botCfg.arbMarketMakingConfig = this.arbMMConfig();
                    break;
                case _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb:
                    botCfg.simpleArbConfig = this.basicArbConfig();
            }
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().log('mm', 'saving bot config', botCfg);
            yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.updateBotConfig(botCfg);
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchMMStatus();
            this.originalConfig = JSON.parse(JSON.stringify(cfg));
            this.updateModifiedMarkers();
            const lastBots = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(lastBotsLK) || {};
            lastBots[`${baseID}_${quoteID}_${host}`] = this.specs;
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(lastBotsLK, lastBots);
            if (cexName)
                _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(lastArbExchangeLK, cexName);
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm');
        });
    }
    delete() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, specs: { host, baseID, quoteID } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.deleteErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loading(page.botSettingsContainer);
            const resp = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.removeBotConfig(host, baseID, quoteID);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(resp)) {
                page.deleteErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_7__.prep(_locales__WEBPACK_IMPORTED_MODULE_7__.ID_API_ERROR, { msg: resp.msg });
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.deleteErr);
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fetchMMStatus();
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mm');
        });
    }
    /*
     * arbMMConfig parses the configuration for the arb-mm bot. Only one of
     * arbMMConfig or basicMMConfig should be used when updating the bot
     * configuration. Which is used depends on if the user has configured and
     * selected a CEX or not.
     */
    arbMMConfig() {
        const { updatedConfig: cfg } = this;
        const arbCfg = {
            buyPlacements: [],
            sellPlacements: [],
            profit: cfg.profit,
            driftTolerance: cfg.driftTolerance,
            orderPersistence: cfg.orderPersistence
        };
        for (const p of cfg.buyPlacements)
            arbCfg.buyPlacements.push({ lots: p.lots, multiplier: p.gapFactor });
        for (const p of cfg.sellPlacements)
            arbCfg.sellPlacements.push({ lots: p.lots, multiplier: p.gapFactor });
        return arbCfg;
    }
    basicArbConfig() {
        const { updatedConfig: cfg } = this;
        const arbCfg = {
            profitTrigger: cfg.profit,
            maxActiveArbs: 100,
            numEpochsLeaveOpen: cfg.orderPersistence
        };
        return arbCfg;
    }
    /*
     * basicMMConfig parses the configuration for the basic marketmaker. Only of
     * of basidMMConfig or arbMMConfig should be used when updating the bot
     * configuration.
     */
    basicMMConfig() {
        const { updatedConfig: cfg } = this;
        const mmCfg = {
            gapStrategy: cfg.gapStrategy,
            sellPlacements: cfg.sellPlacements,
            buyPlacements: cfg.buyPlacements,
            driftTolerance: cfg.driftTolerance
        };
        return mmCfg;
    }
    /*
     * fetchOracles fetches the current oracle rates and fiat rates, and displays
     * them on the screen.
     */
    fetchMarketReport() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const { page, specs: { host, baseID, quoteID } } = this;
            const res = yield _mmutil__WEBPACK_IMPORTED_MODULE_5__.MM.report(host, baseID, quoteID);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.oraclesLoading, page.oraclesTable, page.noOracles);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().checkResponse(res)) {
                page.oraclesErrMsg.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.oraclesErr);
                return;
            }
            const r = this.marketReport = res.report;
            if (!r.oracles || r.oracles.length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.noOracles);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(page.noOracles);
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.oracles);
                for (const o of (_a = r.oracles) !== null && _a !== void 0 ? _a : []) {
                    const tr = page.oracleTmpl.cloneNode(true);
                    page.oracles.appendChild(tr);
                    const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(tr);
                    tmpl.logo.src = 'img/' + o.host + '.png';
                    tmpl.host.textContent = ExchangeNames[o.host];
                    tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(o.usdVol);
                    tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs((o.bestBuy + o.bestSell) / 2);
                }
                page.avgPrice.textContent = r.price ? _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(r.price) : '0';
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.oraclesTable);
            }
            if (r.baseFiatRate > 0) {
                page.baseFiatRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(r.baseFiatRate);
            }
            else {
                page.baseFiatRate.textContent = 'N/A';
            }
            if (r.quoteFiatRate > 0) {
                page.quoteFiatRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(r.quoteFiatRate);
            }
            else {
                page.quoteFiatRate.textContent = 'N/A';
            }
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(page.fiatRates);
        });
    }
    /*
     * handleCEXSubmit handles clicks on the CEX configuration submission button.
     */
    cexConfigured(cexName) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, formSpecs: { host, baseID, quoteID } } = this;
            const dinfo = _mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos[cexName];
            for (const { baseID, quoteID, tmpl, arbs } of this.marketRows) {
                if (arbs.indexOf(cexName) !== -1)
                    continue;
                const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
                if (cexHasMarket(cexName)) {
                    const img = page.arbBttnTmpl.cloneNode(true);
                    img.src = dinfo.logo;
                    tmpl.arbs.appendChild(img);
                    arbs.push(cexName);
                }
            }
            this.setCEXAvailability(baseID, quoteID, cexName);
            this.showBotTypeForm(host, baseID, quoteID, _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeArbMM, cexName);
        });
    }
    /*
     * setupCEXes should be called during initialization.
     */
    setupCEXes() {
        this.formCexes = {};
        for (const name of Object.keys(_mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos))
            this.addCEX(name);
    }
    /*
     * setCEXAvailability sets the coloring and messaging of the CEX selection
     * buttons.
     */
    setCEXAvailability(baseID, quoteID, selectedCEX) {
        const cexHasMarket = this.cexMarketSupportFilter(baseID, quoteID);
        for (const { name, div, tmpl } of Object.values(this.formCexes)) {
            const has = cexHasMarket(name);
            const cexStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[name];
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(tmpl.unavailable, tmpl.needsconfig, tmpl.disconnected);
            _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(Boolean(cexStatus), tmpl.reconfig);
            tmpl.logo.classList.remove('greyscal');
            div.classList.toggle('configured', Boolean(cexStatus) && !cexStatus.connectErr);
            if (!cexStatus) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(tmpl.needsconfig);
            }
            else if (cexStatus.connectErr) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(tmpl.disconnected);
            }
            else if (!has) {
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].show(tmpl.unavailable);
                tmpl.logo.classList.add('greyscal');
            }
            else if (name === selectedCEX)
                this.selectFormCEX(name);
        }
    }
    selectFormCEX(cexName) {
        for (const { name, div } of Object.values(this.formCexes)) {
            div.classList.toggle('selected', name === cexName);
        }
    }
    addCEX(cexName) {
        const dinfo = _mmutil__WEBPACK_IMPORTED_MODULE_5__.CEXDisplayInfos[cexName];
        const div = this.page.cexOptTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
        tmpl.name.textContent = dinfo.name;
        tmpl.logo.src = dinfo.logo;
        this.page.cexSelection.appendChild(div);
        this.formCexes[cexName] = { name: cexName, div, tmpl };
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(div, 'click', () => {
            const cexStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName];
            if (!cexStatus || cexStatus.connectErr) {
                this.showCEXConfigForm(cexName);
                return;
            }
            const cex = this.formCexes[cexName];
            if (cex.div.classList.contains('selected')) { // unselect
                for (const cex of Object.values(this.formCexes))
                    cex.div.classList.remove('selected');
                const { baseID, quoteID } = this.formSpecs;
                this.setCEXAvailability(baseID, quoteID);
                return;
            }
            for (const cex of Object.values(this.formCexes))
                cex.div.classList.toggle('selected', cex.name === cexName);
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(tmpl.reconfig, 'click', (e) => {
            e.stopPropagation();
            this.showCEXConfigForm(cexName);
        });
    }
    showCEXConfigForm(cexName) {
        const page = this.page;
        this.cexConfigForm.setCEX(cexName);
        this.forms.show(page.cexConfigForm);
    }
    /*
     * cexMarketSupportFilter returns a lookup CEXes that have a matching market
     * for the currently selected base and quote assets.
     */
    cexMarketSupportFilter(baseID, quoteID) {
        var _a;
        const cexes = {};
        for (const [cexName, cexStatus] of Object.entries((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes)) {
            for (const { baseID: b, quoteID: q } of Object.values((_a = cexStatus.markets) !== null && _a !== void 0 ? _a : [])) {
                if (b === baseID && q === quoteID) {
                    cexes[cexName] = true;
                    break;
                }
            }
        }
        return (cexName) => Boolean(cexes[cexName]);
    }
}
function isViewOnly(specs, mmStatus) {
    const botStatus = mmStatus.bots.find(({ config: cfg }) => cfg.host === specs.host && cfg.baseID === specs.baseID && cfg.quoteID === specs.quoteID);
    return Boolean(botStatus === null || botStatus === void 0 ? void 0 : botStatus.running);
}
const ExchangeNames = {
    'binance.com': 'Binance',
    'coinbase.com': 'Coinbase',
    'bittrex.com': 'Bittrex',
    'hitbtc.com': 'HitBTC',
    'exmo.com': 'EXMO'
};
function tokenAssetApprovalStatuses(host, b, q) {
    var _a, _b;
    let baseAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.Approved;
    let quoteAssetApprovalStatus = _registry__WEBPACK_IMPORTED_MODULE_0__.ApprovalStatus.Approved;
    if (b === null || b === void 0 ? void 0 : b.token) {
        const baseAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[b.id];
        const baseVersion = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].assets[b.id].version;
        if (((_a = baseAsset === null || baseAsset === void 0 ? void 0 : baseAsset.wallet) === null || _a === void 0 ? void 0 : _a.approved) && baseAsset.wallet.approved[baseVersion] !== undefined) {
            baseAssetApprovalStatus = baseAsset.wallet.approved[baseVersion];
        }
    }
    if (q === null || q === void 0 ? void 0 : q.token) {
        const quoteAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[q.id];
        const quoteVersion = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].assets[q.id].version;
        if (((_b = quoteAsset === null || quoteAsset === void 0 ? void 0 : quoteAsset.wallet) === null || _b === void 0 ? void 0 : _b.approved) && quoteAsset.wallet.approved[quoteVersion] !== undefined) {
            quoteAssetApprovalStatus = quoteAsset.wallet.approved[quoteVersion];
        }
    }
    return [
        baseAssetApprovalStatus,
        quoteAssetApprovalStatus
    ];
}
class AssetPane {
    constructor(pg, div) {
        this.pg = pg;
        this.div = div;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
        this.nSwapFees = new _doc__WEBPACK_IMPORTED_MODULE_1__.IncrementalInput(page.nSwapFees, {
            prec: defaultSwapReserves.prec,
            inc: defaultSwapReserves.inc,
            changed: (v) => {
                const { minR, range } = defaultSwapReserves;
                this.cfg.swapFeeN = v;
                this.nSwapFeesSlider.setValue((v - minR) / range);
                this.pg.updateAllocations();
            }
        });
        this.nSwapFeesSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.nSwapFeesSlider, (r) => {
            const { minR, range, prec } = defaultSwapReserves;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(minR + r * range, prec);
            this.cfg.swapFeeN = v;
            this.nSwapFees.setValue(v);
            this.pg.updateAllocations();
        });
        this.orderReserves = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.orderReservesFactor, {
            prec: defaultOrderReserves.prec,
            min: 0,
            changed: (v) => {
                const { minR, range } = defaultOrderReserves;
                this.cfg.orderReservesFactor = v;
                this.orderReservesSlider.setValue((v - minR) / range);
                this.pg.updateAllocations();
            }
        });
        this.orderReservesSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.orderReservesSlider, (r) => {
            const { minR, range, prec } = defaultOrderReserves;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(minR + r * range, prec);
            this.orderReserves.setValue(v);
            this.cfg.orderReservesFactor = v;
            this.pg.updateAllocations();
        });
        this.slippageBuffer = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.slippageBufferFactor, {
            prec: defaultSlippage.prec,
            min: 0,
            changed: (v) => {
                const { minR, range } = defaultSlippage;
                this.cfg.slippageBufferFactor = v;
                this.slippageBufferSlider.setValue((v - minR) / range);
                this.pg.updateAllocations();
            }
        });
        this.slippageBufferSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.slippageBufferSlider, (r) => {
            const { minR, range, prec } = defaultSlippage;
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)(minR + r * range, prec);
            this.slippageBuffer.setValue(minR + r * range);
            this.cfg.slippageBufferFactor = v;
            this.pg.updateAllocations();
        });
        this.minTransfer = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(page.minTransfer, {
            sigFigs: true,
            min: 0,
            changed: (v) => {
                const { cfg } = this;
                const totalInventory = this.commit();
                const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min * 2, totalInventory)];
                cfg.transferFactor = (v - minV) / (maxV - minV);
                this.minTransferSlider.setValue(cfg.transferFactor);
            }
        });
        this.minTransferSlider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(page.minTransferSlider, (r) => {
            const { cfg } = this;
            const totalInventory = this.commit();
            const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min, totalInventory)];
            cfg.transferFactor = r;
            this.minTransfer.setValue(minV + r * (maxV - minV));
        });
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(page.showBalance, 'click', () => { pg.showAddress(this.assetID); });
    }
    // lot size can change if this is the quote asset, keep it updated.
    setLotSize(lotSize) {
        const { ui } = this;
        this.lotSize = lotSize;
        this.lotSizeConv = lotSize / ui.conventional.conversionFactor;
    }
    setAsset(assetID, isQuote) {
        var _a, _b;
        this.assetID = assetID;
        this.isQuote = isQuote;
        const cfg = this.cfg = isQuote ? this.pg.updatedConfig.quoteConfig : this.pg.updatedConfig.baseConfig;
        const { page, div, pg: { specs: { botType, baseID, cexName }, mktID, updatedConfig: { baseOptions, quoteOptions } } } = this;
        const { symbol, name, token, unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[assetID];
        this.ui = ui;
        this.walletConfig = assetID === baseID ? baseOptions : quoteOptions;
        const { conventional: { unit: ticker } } = ui;
        this.feeAssetID = token ? token.parentID : assetID;
        const { unitInfo: feeUI, name: feeName, symbol: feeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.feeAssetID];
        this.feeUI = feeUI;
        this.inv = { book: 0, bookingFees: 0, swapFeeReserves: 0, cex: 0, orderReserves: 0, slippageBuffer: 0 };
        this.isToken = Boolean(token);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(this.isToken, page.feeTotalBox, page.feeReservesBox, page.feeBalances);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(isQuote, page.slippageBufferBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setSrc(div, '[data-logo]', _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(symbol));
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-name]', name);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-ticker]', ticker);
        const { conventional: { unit: feeTicker } } = feeUI;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-fee-ticker]', feeTicker);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setText(div, '[data-fee-name]', feeName);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setSrc(div, '[data-fee-logo]', _doc__WEBPACK_IMPORTED_MODULE_1__["default"].logoPath(feeSymbol));
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM, page.cexMinInvBox);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb, page.orderReservesBox);
        this.nSwapFees.setValue((_a = cfg.swapFeeN) !== null && _a !== void 0 ? _a : defaultSwapReserves.n);
        this.nSwapFeesSlider.setValue(cfg.swapFeeN / defaultSwapReserves.maxR);
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            const [v] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toPrecision)((_b = cfg.orderReservesFactor) !== null && _b !== void 0 ? _b : defaultOrderReserves.factor, defaultOrderReserves.prec);
            this.orderReserves.setValue(v);
            this.orderReservesSlider.setValue((v - defaultOrderReserves.minR) / defaultOrderReserves.range);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicMM) {
            this.minTransfer.prec = Math.log10(ui.conventional.conversionFactor);
            const mkt = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.cexes[cexName].markets[mktID];
            this.minTransfer.min = ((isQuote ? mkt.quoteMinWithdraw : mkt.baseMinWithdraw) / ui.conventional.conversionFactor);
        }
        this.slippageBuffer.setValue(cfg.slippageBufferFactor);
        const { minR, range } = defaultSlippage;
        this.slippageBufferSlider.setValue((cfg.slippageBufferFactor - minR) / range);
        this.setupWalletSettings();
        this.updateBalances();
    }
    commit() {
        const { inv, isToken } = this;
        let commit = inv.book + inv.cex + inv.orderReserves + inv.slippageBuffer;
        if (!isToken)
            commit += inv.bookingFees + inv.swapFeeReserves;
        return commit;
    }
    updateInventory(lots, counterLots, lotSize, dexCommit, cexCommit, fees) {
        this.setLotSize(lotSize);
        const { page, cfg, lotSizeConv, inv, ui, feeUI, isToken, isQuote, pg: { specs: { cexName, botType } } } = this;
        page.bookLots.textContent = String(lots);
        page.bookLotSize.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(lotSizeConv);
        inv.book = lots * lotSizeConv;
        page.bookCommitment.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.book);
        const feesPerLotConv = fees.bookingFeesPerLot / feeUI.conventional.conversionFactor;
        page.bookingFeesPerLot.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feesPerLotConv);
        page.swapReservesFactor.textContent = fees.swapReservesFactor.toFixed(2);
        page.bookingFeesLots.textContent = String(lots);
        inv.bookingFees = fees.bookingFees / feeUI.conventional.conversionFactor;
        page.bookingFees.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.bookingFees);
        if (cexName) {
            inv.cex = cexCommit / ui.conventional.conversionFactor;
            page.cexMinInv.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.cex);
        }
        if (botType !== _mmutil__WEBPACK_IMPORTED_MODULE_5__.botTypeBasicArb) {
            const totalInventory = Math.max(cexCommit, dexCommit) / ui.conventional.conversionFactor;
            page.orderReservesBasis.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(totalInventory);
            const orderReserves = totalInventory * cfg.orderReservesFactor;
            inv.orderReserves = orderReserves;
            page.orderReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(orderReserves);
        }
        if (isToken) {
            const feesPerSwapConv = fees.tokenFeesPerSwap / feeUI.conventional.conversionFactor;
            page.feeReservesPerSwap.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feesPerSwapConv);
            inv.swapFeeReserves = feesPerSwapConv * cfg.swapFeeN;
            page.feeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(inv.swapFeeReserves);
        }
        if (isQuote) {
            const basis = inv.book + inv.cex + inv.orderReserves;
            page.slippageBufferBasis.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(basis * ui.conventional.conversionFactor, ui);
            inv.slippageBuffer = basis * cfg.slippageBufferFactor;
            page.slippageBuffer.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(inv.slippageBuffer * ui.conventional.conversionFactor, ui);
        }
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(fees.bookingFeesPerCounterLot > 0, page.redemptionFeesBox);
        if (fees.bookingFeesPerCounterLot > 0) {
            const feesPerLotConv = fees.bookingFeesPerCounterLot / feeUI.conventional.conversionFactor;
            page.redemptionFeesPerLot.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feesPerLotConv);
            page.redemptionFeesLots.textContent = String(counterLots);
            page.redeemReservesFactor.textContent = fees.redeemReservesFactor.toFixed(2);
        }
        this.updateCommitTotal();
        this.updateTokenFees();
        this.updateRebalance();
    }
    updateCommitTotal() {
        const { page, assetID, ui } = this;
        const commit = this.commit();
        page.commitTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(Math.round(commit * ui.conventional.conversionFactor), ui);
        page.commitTotalFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(commit * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[assetID]);
    }
    updateTokenFees() {
        const { page, inv, feeAssetID, feeUI, isToken } = this;
        if (!isToken)
            return;
        const feeReserves = inv.bookingFees + inv.swapFeeReserves;
        page.feeTotal.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatCoinValue(feeReserves * feeUI.conventional.conversionFactor, feeUI);
        page.feeTotalFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feeReserves * (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[feeAssetID]);
    }
    updateRebalance() {
        const { page, cfg, pg: { updatedConfig: { cexRebalance }, specs: { cexName } } } = this;
        const showRebalance = cexName && cexRebalance;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(showRebalance, page.rebalanceOpts);
        if (!showRebalance)
            return;
        const totalInventory = this.commit();
        const [minV, maxV] = [this.minTransfer.min, Math.max(this.minTransfer.min * 2, totalInventory)];
        const rangeV = maxV - minV;
        this.minTransfer.setValue(minV + cfg.transferFactor * rangeV);
        this.minTransferSlider.setValue((cfg.transferFactor - defaultTransfer.minR) / defaultTransfer.range);
    }
    setupWalletSettings() {
        const { page, assetID, walletConfig } = this;
        const walletSettings = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().currentWalletDefinition(assetID);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].empty(page.walletSettings);
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(!walletSettings.multifundingopts, page.walletSettingsNone);
        if (!walletSettings.multifundingopts)
            return;
        const optToDiv = {};
        const dependentOpts = {};
        const addDependentOpt = (optKey, optSetting, dependentOn) => {
            if (!dependentOpts[dependentOn])
                dependentOpts[dependentOn] = [];
            dependentOpts[dependentOn].push(optKey);
            optToDiv[optKey] = optSetting;
        };
        const setDependentOptsVis = (parentOptKey, vis) => {
            const optKeys = dependentOpts[parentOptKey];
            if (!optKeys)
                return;
            for (const optKey of optKeys)
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(vis, optToDiv[optKey]);
        };
        const addOpt = (opt) => {
            if (opt.quoteAssetOnly && !this.isQuote)
                return;
            const currVal = walletConfig[opt.key];
            let div;
            if (opt.isboolean) {
                div = page.boolSettingTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
                tmpl.name.textContent = opt.displayname;
                tmpl.input.checked = currVal === 'true';
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].bind(tmpl.input, 'change', () => {
                    walletConfig[opt.key] = tmpl.input.checked ? 'true' : 'false';
                    setDependentOptsVis(opt.key, Boolean(tmpl.input.checked));
                });
                if (opt.description)
                    tmpl.tooltip.dataset.tooltip = opt.description;
            }
            else if (opt.xyRange) {
                const { start, end, xUnit } = opt.xyRange;
                const range = end.x - start.x;
                div = page.rangeSettingTmpl.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].parseTemplate(div);
                tmpl.name.textContent = opt.displayname;
                if (opt.description)
                    tmpl.tooltip.dataset.tooltip = opt.description;
                if (xUnit)
                    tmpl.unit.textContent = xUnit;
                else
                    _doc__WEBPACK_IMPORTED_MODULE_1__["default"].hide(tmpl.unit);
                const input = new _doc__WEBPACK_IMPORTED_MODULE_1__.NumberInput(tmpl.value, {
                    prec: 1,
                    changed: (rawV) => {
                        const [v, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(rawV, 1);
                        walletConfig[opt.key] = s;
                        slider.setValue((v - start.x) / range);
                    }
                });
                const slider = new _doc__WEBPACK_IMPORTED_MODULE_1__.MiniSlider(tmpl.slider, (r) => {
                    const rawV = start.x + r * range;
                    const [v, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)(rawV, 1);
                    walletConfig[opt.key] = s;
                    input.setValue(v);
                });
                // TODO: default value should be smaller or none for base asset.
                const [v, s] = (0,_doc__WEBPACK_IMPORTED_MODULE_1__.toFourSigFigs)((0,_doc__WEBPACK_IMPORTED_MODULE_1__.parseFloatDefault)(currVal, start.x), 3);
                walletConfig[opt.key] = s;
                slider.setValue((v - start.x) / range);
                input.setValue(v);
                tmpl.value.textContent = s;
            }
            if (!div)
                return console.error("don't know how to handle opt", opt);
            page.walletSettings.appendChild(div);
            if (opt.dependsOn) {
                addDependentOpt(opt.key, div, opt.dependsOn);
                const parentOptVal = walletConfig[opt.dependsOn];
                _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(parentOptVal === 'true', div);
            }
        };
        if (walletSettings.multifundingopts && walletSettings.multifundingopts.length > 0) {
            for (const opt of walletSettings.multifundingopts)
                addOpt(opt);
        }
        (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().bindTooltips(page.walletSettings);
    }
    updateBalances() {
        const { page, assetID, ui, feeAssetID, feeUI, pg: { specs: { cexName, baseID }, cexBaseBalance, cexQuoteBalance } } = this;
        const { balance: { available } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[assetID];
        const botInv = this.pg.runningBotInventory(assetID);
        const dexAvail = available - botInv.dex.total;
        let cexAvail = 0;
        _doc__WEBPACK_IMPORTED_MODULE_1__["default"].setVis(cexName, page.balanceBreakdown);
        if (cexName) {
            page.dexAvail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(dexAvail / ui.conventional.conversionFactor);
            const { available: cexRawAvail } = assetID === baseID ? cexBaseBalance : cexQuoteBalance;
            cexAvail = cexRawAvail - botInv.cex.total;
            page.cexAvail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(cexAvail / ui.conventional.conversionFactor);
        }
        page.avail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs((dexAvail + cexAvail) / ui.conventional.conversionFactor);
        if (assetID === feeAssetID)
            return;
        const { balance: { available: feeAvail } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[feeAssetID];
        page.feeAvail.textContent = _doc__WEBPACK_IMPORTED_MODULE_1__["default"].formatFourSigFigs(feeAvail / feeUI.conventional.conversionFactor);
    }
}


/***/ }),

/***/ "./src/js/mmutil.ts":
/*!**************************!*\
  !*** ./src/js/mmutil.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BotMarket": () => (/* binding */ BotMarket),
/* harmony export */   "CEXDisplayInfos": () => (/* binding */ CEXDisplayInfos),
/* harmony export */   "GapStrategyAbsolute": () => (/* binding */ GapStrategyAbsolute),
/* harmony export */   "GapStrategyAbsolutePlus": () => (/* binding */ GapStrategyAbsolutePlus),
/* harmony export */   "GapStrategyMultiplier": () => (/* binding */ GapStrategyMultiplier),
/* harmony export */   "GapStrategyPercent": () => (/* binding */ GapStrategyPercent),
/* harmony export */   "GapStrategyPercentPlus": () => (/* binding */ GapStrategyPercentPlus),
/* harmony export */   "MM": () => (/* binding */ MM),
/* harmony export */   "PlacementsChart": () => (/* binding */ PlacementsChart),
/* harmony export */   "RunningMarketMakerDisplay": () => (/* binding */ RunningMarketMakerDisplay),
/* harmony export */   "botTypeArbMM": () => (/* binding */ botTypeArbMM),
/* harmony export */   "botTypeBasicArb": () => (/* binding */ botTypeBasicArb),
/* harmony export */   "botTypeBasicMM": () => (/* binding */ botTypeBasicMM),
/* harmony export */   "calculateQuoteLot": () => (/* binding */ calculateQuoteLot),
/* harmony export */   "feesAndCommit": () => (/* binding */ feesAndCommit),
/* harmony export */   "hostedMarketID": () => (/* binding */ hostedMarketID),
/* harmony export */   "liveBotConfig": () => (/* binding */ liveBotConfig),
/* harmony export */   "liveBotStatus": () => (/* binding */ liveBotStatus),
/* harmony export */   "runningBotInventory": () => (/* binding */ runningBotInventory),
/* harmony export */   "setCexElements": () => (/* binding */ setCexElements),
/* harmony export */   "setMarketElements": () => (/* binding */ setMarketElements)
/* harmony export */ });
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _charts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./charts */ "./src/js/charts.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





const GapStrategyMultiplier = 'multiplier';
const GapStrategyAbsolute = 'absolute';
const GapStrategyAbsolutePlus = 'absolute-plus';
const GapStrategyPercent = 'percent';
const GapStrategyPercentPlus = 'percent-plus';
const botTypeBasicMM = 'basicMM';
const botTypeArbMM = 'arbMM';
const botTypeBasicArb = 'basicArb';
const CEXDisplayInfos = {
    'Binance': {
        name: 'Binance',
        logo: '/img/binance.com.png'
    },
    'BinanceUS': {
        name: 'Binance U.S.',
        logo: '/img/binance.us.png'
    }
};
/*
 * MarketMakerBot is the front end representation of the server's
 * mm.MarketMaker. MarketMakerBot is a singleton assigned to MM below.
 */
class MarketMakerBot {
    constructor() {
        this.cexBalanceCache = {};
    }
    /*
     * updateBotConfig appends or updates the specified BotConfig.
     */
    updateBotConfig(cfg) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/updatebotconfig', cfg);
        });
    }
    /*
     * updateCEXConfig appends or updates the specified CEXConfig.
     */
    updateCEXConfig(cfg) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/updatecexconfig', cfg);
        });
    }
    removeBotConfig(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/removebotconfig', { host, baseID, quoteID });
        });
    }
    report(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            return (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/marketreport', { host, baseID, quoteID });
        });
    }
    startBot(config) {
        return __awaiter(this, void 0, void 0, function* () {
            return yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/startmarketmakingbot', { config });
        });
    }
    stopBot(market) {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/stopmarketmakingbot', { market });
        });
    }
    status() {
        return __awaiter(this, void 0, void 0, function* () {
            return (yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.getJSON)('/api/marketmakingstatus')).status;
        });
    }
    // botStats returns the RunStats for a running bot with the specified parameters.
    botStats(baseID, quoteID, host, startTime) {
        for (const botStatus of Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots)) {
            if (!botStatus.runStats)
                continue;
            const runStats = botStatus.runStats;
            const cfg = botStatus.config;
            if (cfg.baseID === baseID && cfg.quoteID === quoteID && cfg.host === host && runStats.startTime === startTime) {
                return runStats;
            }
        }
    }
    cachedCexBalance(cexName, assetID) {
        var _a;
        return (_a = this.cexBalanceCache[cexName]) === null || _a === void 0 ? void 0 : _a[assetID];
    }
    cexBalance(cexName, assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.cexBalanceCache[cexName])
                this.cexBalanceCache[cexName] = {};
            const cexBalance = (yield (0,_http__WEBPACK_IMPORTED_MODULE_1__.postJSON)('/api/cexbalance', { cexName, assetID })).cexBalance;
            this.cexBalanceCache[cexName][assetID] = cexBalance;
            return cexBalance;
        });
    }
}
// MM is the front end representation of the server's mm.MarketMaker.
const MM = new MarketMakerBot();
function runningBotInventory(assetID) {
    return (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.reduce((v, { runStats, running }) => {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v;
        if (!running || !runStats)
            return v;
        const { dexBalances: d, cexBalances: c } = runStats;
        v.cex.locked += (_b = (_a = c[assetID]) === null || _a === void 0 ? void 0 : _a.locked) !== null && _b !== void 0 ? _b : 0;
        v.cex.locked += (_d = (_c = c[assetID]) === null || _c === void 0 ? void 0 : _c.reserved) !== null && _d !== void 0 ? _d : 0;
        v.cex.avail += (_f = (_e = c[assetID]) === null || _e === void 0 ? void 0 : _e.available) !== null && _f !== void 0 ? _f : 0;
        v.cex.total = v.cex.avail + v.cex.locked;
        v.dex.locked += (_h = (_g = d[assetID]) === null || _g === void 0 ? void 0 : _g.locked) !== null && _h !== void 0 ? _h : 0;
        v.dex.locked += (_k = (_j = d[assetID]) === null || _j === void 0 ? void 0 : _j.reserved) !== null && _k !== void 0 ? _k : 0;
        v.dex.avail += (_m = (_l = d[assetID]) === null || _l === void 0 ? void 0 : _l.available) !== null && _m !== void 0 ? _m : 0;
        v.dex.total = v.dex.avail + v.dex.locked;
        v.avail += ((_p = (_o = d[assetID]) === null || _o === void 0 ? void 0 : _o.available) !== null && _p !== void 0 ? _p : 0) + ((_r = (_q = c[assetID]) === null || _q === void 0 ? void 0 : _q.available) !== null && _r !== void 0 ? _r : 0);
        v.locked += ((_t = (_s = d[assetID]) === null || _s === void 0 ? void 0 : _s.locked) !== null && _t !== void 0 ? _t : 0) + ((_v = (_u = c[assetID]) === null || _u === void 0 ? void 0 : _u.locked) !== null && _v !== void 0 ? _v : 0);
        return v;
    }, { avail: 0, locked: 0, cex: { avail: 0, locked: 0, total: 0 }, dex: { avail: 0, locked: 0, total: 0 } });
}
function setMarketElements(ancestor, baseID, quoteID, host) {
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-host]', host);
    const { unitInfo: bui, name: baseName, symbol: baseSymbol, token: baseToken } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-name]', baseName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-base-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(baseSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-ticker]', bui.conventional.unit);
    const { unitInfo: baseFeeUI, name: baseFeeName, symbol: baseFeeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseToken ? baseToken.parentID : baseID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-fee-name]', baseFeeName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-base-fee-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(baseFeeSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-base-fee-ticker]', baseFeeUI.conventional.unit);
    const { unitInfo: qui, name: quoteName, symbol: quoteSymbol, token: quoteToken } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-name]', quoteName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-quote-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(quoteSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-ticker]', qui.conventional.unit);
    const { unitInfo: quoteFeeUI, name: quoteFeeName, symbol: quoteFeeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteToken ? quoteToken.parentID : quoteID];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-fee-name]', quoteFeeName);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-quote-fee-logo]', _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(quoteFeeSymbol));
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-quote-fee-ticker]', quoteFeeUI.conventional.unit);
}
function setCexElements(ancestor, cexName) {
    const dinfo = CEXDisplayInfos[cexName];
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setText(ancestor, '[data-cex-name]', dinfo.name);
    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setSrc(ancestor, '[data-cex-logo]', dinfo.logo);
    for (const img of _doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(ancestor, '[data-cex-logo]'))
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(img);
}
function calculateQuoteLot(lotSize, baseID, quoteID, spot) {
    const baseRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[baseID];
    const quoteRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[quoteID];
    const { unitInfo: { conventional: { conversionFactor: bFactor } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
    const { unitInfo: { conventional: { conversionFactor: qFactor } } } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
    if (baseRate && quoteRate) {
        return lotSize * baseRate / quoteRate * qFactor / bFactor;
    }
    else if (spot) {
        return lotSize * spot.rate / _orderutil__WEBPACK_IMPORTED_MODULE_3__.RateEncodingFactor;
    }
    return qFactor;
}
class PlacementsChart extends _charts__WEBPACK_IMPORTED_MODULE_4__.Chart {
    constructor(parent) {
        super(parent, {
            resize: () => this.resized(),
            click: ( /* e: MouseEvent */) => { },
            zoom: ( /* bigger: boolean */) => { }
        });
    }
    resized() {
        this.render();
    }
    draw() { }
    setMarket(cfg) {
        this.cfg = cfg;
        const { loadedCEX, cfg: { cexName } } = this;
        if (cexName && cexName !== loadedCEX) {
            this.loadedCEX = cexName;
            this.cexLogo = new Image();
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.cexLogo, 'load', () => { this.render(); });
            this.cexLogo.src = CEXDisplayInfos[cexName || ''].logo;
        }
        this.render();
    }
    render() {
        const { ctx, canvas, theme, cfg } = this;
        if (canvas.width === 0 || !cfg)
            return;
        const { dict: { buyPlacements, sellPlacements, profit }, baseFiatRate, botType } = cfg;
        if (botType === botTypeBasicArb)
            return;
        this.clear();
        const drawDashedLine = (x0, y0, x1, y1, color) => {
            ctx.save();
            ctx.setLineDash([3, 5]);
            ctx.lineWidth = 1.5;
            ctx.strokeStyle = color;
            this.line(x0, y0, x1, y1);
            ctx.restore();
        };
        const isBasicMM = botType === botTypeBasicMM;
        const cx = canvas.width / 2;
        const [cexGapL, cexGapR] = isBasicMM ? [cx, cx] : [0.48 * canvas.width, 0.52 * canvas.width];
        const buyLots = buyPlacements.reduce((v, p) => v + p.lots, 0);
        const sellLots = sellPlacements.reduce((v, p) => v + p.lots, 0);
        const maxLots = Math.max(buyLots, sellLots);
        let widest = 0;
        let fauxSpacer = 0;
        if (isBasicMM) {
            const leftmost = buyPlacements.reduce((v, p) => Math.max(v, p.gapFactor), 0);
            const rightmost = sellPlacements.reduce((v, p) => Math.max(v, p.gapFactor), 0);
            widest = Math.max(leftmost, rightmost);
        }
        else {
            // For arb-mm, we don't know how the orders will be spaced because it
            // depends on the vwap. But we're just trying to capture the general sense
            // of how the parameters will affect order placement, so we'll fake it.
            // Higher match buffer values will lead to orders with less favorable
            // rates, e.g. the spacing will be larger.
            const ps = [...buyPlacements, ...sellPlacements];
            const matchBuffer = ps.reduce((sum, p) => sum + p.gapFactor, 0) / ps.length;
            fauxSpacer = 0.01 * (1 + matchBuffer);
            widest = Math.min(10, Math.max(buyPlacements.length, sellPlacements.length)) * fauxSpacer; // arb-mm
        }
        // Make the range 15% on each side, which will include profit + placements,
        // unless they have orders with larger gap factors.
        const minRange = profit + widest;
        const defaultRange = 0.155;
        const range = Math.max(minRange * 1.05, defaultRange);
        // Increase data height logarithmically up to 1,000,000 USD.
        const maxCommitUSD = maxLots * baseFiatRate;
        const regionHeight = 0.2 + 0.7 * Math.log((0,_doc__WEBPACK_IMPORTED_MODULE_2__.clamp)(maxCommitUSD, 0, 1e6)) / Math.log(1e6);
        // Draw a region in the middle representing the cex gap.
        const plotRegion = new _charts__WEBPACK_IMPORTED_MODULE_4__.Region(ctx, new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(0, canvas.width, 0, canvas.height));
        if (isBasicMM) {
            drawDashedLine(cx, 0, cx, canvas.height, theme.gapLine);
        }
        else { // arb-mm
            plotRegion.plot(new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(0, 1, 0, 1), (ctx, tools) => {
                const [y0, y1] = [tools.y(0), tools.y(1)];
                drawDashedLine(cexGapL, y0, cexGapL, y1, theme.gapLine);
                drawDashedLine(cexGapR, y0, cexGapR, y1, theme.gapLine);
                const y = tools.y(0.95);
                ctx.drawImage(this.cexLogo, cx - 8, y, 16, 16);
                this.applyLabelStyle(18);
                ctx.fillText('δ', cx, y + 29);
            });
        }
        const plotSide = (isBuy, placements) => {
            if (!(placements === null || placements === void 0 ? void 0 : placements.length))
                return;
            const [xMin, xMax] = isBuy ? [0, cexGapL] : [cexGapR, canvas.width];
            const reg = new _charts__WEBPACK_IMPORTED_MODULE_4__.Region(ctx, new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(xMin, xMax, canvas.height * (1 - regionHeight), canvas.height));
            const [l, r] = isBuy ? [-range, 0] : [0, range];
            reg.plot(new _charts__WEBPACK_IMPORTED_MODULE_4__.Extents(l, r, 0, maxLots), (ctx, tools) => {
                ctx.lineWidth = 2.5;
                ctx.strokeStyle = isBuy ? theme.buyLine : theme.sellLine;
                ctx.fillStyle = isBuy ? theme.buyFill : theme.sellFill;
                ctx.beginPath();
                const sideFactor = isBuy ? -1 : 1;
                const firstPt = placements[0];
                const y0 = tools.y(0);
                const firstX = tools.x((isBasicMM ? firstPt.gapFactor : profit + fauxSpacer) * sideFactor);
                ctx.moveTo(firstX, y0);
                let cumulativeLots = 0;
                for (let i = 0; i < placements.length; i++) {
                    const p = placements[i];
                    // For arb-mm, we don't know exactly
                    const rawX = isBasicMM ? p.gapFactor : profit + (i + 1) * fauxSpacer;
                    const x = tools.x(rawX * sideFactor);
                    ctx.lineTo(x, tools.y(cumulativeLots));
                    cumulativeLots += p.lots;
                    ctx.lineTo(x, tools.y(cumulativeLots));
                }
                const xInfinity = isBuy ? canvas.width * -0.1 : canvas.width * 1.1;
                ctx.lineTo(xInfinity, tools.y(cumulativeLots));
                ctx.stroke();
                ctx.lineTo(xInfinity, y0);
                ctx.lineTo(firstX, y0);
                ctx.closePath();
                ctx.globalAlpha = 0.25;
                ctx.fill();
            }, true);
        };
        plotSide(false, sellPlacements);
        plotSide(true, buyPlacements);
    }
}
function hostedMarketID(host, baseID, quoteID) {
    return `${host}-${baseID}-${quoteID}`; // same as MarketWithHost.String()
}
function liveBotConfig(host, baseID, quoteID) {
    const s = liveBotStatus(host, baseID, quoteID);
    if (s)
        return s.config;
}
function liveBotStatus(host, baseID, quoteID) {
    const statuses = ((0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots || []).filter((s) => {
        return s.config.baseID === baseID && s.config.quoteID === quoteID && s.config.host === host;
    });
    if (statuses.length)
        return statuses[0];
}
function sumLots(lots, p) {
    return lots + p.lots;
}
function emptyProjection() {
    return { book: 0, bookingFees: 0, swapFeeReserves: 0, cex: 0, orderReserves: 0, slippageBuffer: 0 };
}
class BotMarket {
    constructor(cfg) {
        const host = this.host = cfg.host;
        const baseID = this.baseID = cfg.baseID;
        const quoteID = this.quoteID = cfg.quoteID;
        this.cexName = cfg.cexName;
        const status = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.find(({ config: c }) => c.baseID === baseID && c.quoteID === quoteID && c.host === host);
        if (!status)
            throw Error('where\'s the bot status?');
        this.cfg = status.config;
        const { token: baseToken, symbol: baseSymbol, unitInfo: bui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[baseID];
        this.baseSymbol = baseSymbol;
        this.baseTicker = bui.conventional.unit;
        this.bui = bui;
        this.baseFactor = bui.conventional.conversionFactor;
        this.baseToken = baseToken;
        const baseFeeID = this.baseFeeID = baseToken ? baseToken.parentID : baseID;
        const { unitInfo: baseFeeUI, symbol: baseFeeSymbol, wallet: baseWallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.baseFeeID];
        const traitAccountLocker = 1 << 14;
        this.baseIsAccountLocker = (baseWallet.traits & traitAccountLocker) > 0;
        this.baseFeeUI = baseFeeUI;
        this.baseFeeTicker = baseFeeUI.conventional.unit;
        this.baseFeeSymbol = baseFeeSymbol;
        this.baseFeeFactor = this.baseFeeUI.conventional.conversionFactor;
        const { token: quoteToken, symbol: quoteSymbol, unitInfo: qui } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[quoteID];
        this.quoteSymbol = quoteSymbol;
        this.quoteTicker = qui.conventional.unit;
        this.qui = qui;
        this.quoteFactor = qui.conventional.conversionFactor;
        this.quoteToken = quoteToken;
        const quoteFeeID = this.quoteFeeID = quoteToken ? quoteToken.parentID : quoteID;
        const { unitInfo: quoteFeeUI, symbol: quoteFeeSymbol, wallet: quoteWallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().assets[this.quoteFeeID];
        this.quoteIsAccountLocker = (quoteWallet.traits & traitAccountLocker) > 0;
        this.quoteFeeUI = quoteFeeUI;
        this.quoteFeeTicker = quoteFeeUI.conventional.unit;
        this.quoteFeeSymbol = quoteFeeSymbol;
        this.quoteFeeFactor = this.quoteFeeUI.conventional.conversionFactor;
        this.id = hostedMarketID(host, baseID, quoteID);
        this.mktID = `${baseSymbol}_${quoteSymbol}`;
        const { markets } = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host];
        const { lotsize: lotSize } = markets[this.mktID];
        this.lotSize = lotSize;
        this.lotSizeConv = lotSize / bui.conventional.conversionFactor;
        this.quoteLot = calculateQuoteLot(lotSize, baseID, quoteID);
        this.quoteLotConv = this.quoteLot / qui.conventional.conversionFactor;
        this.baseFeeFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[baseFeeID];
        this.quoteFeeFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().fiatRatesMap[quoteFeeID];
        if (cfg.arbMarketMakingConfig) {
            this.botType = botTypeArbMM;
            this.baseLots = cfg.arbMarketMakingConfig.sellPlacements.reduce(sumLots, 0);
            this.quoteLots = cfg.arbMarketMakingConfig.buyPlacements.reduce(sumLots, 0);
            this.nBuyPlacements = cfg.arbMarketMakingConfig.buyPlacements.length;
            this.nSellPlacements = cfg.arbMarketMakingConfig.sellPlacements.length;
        }
        else if (cfg.simpleArbConfig) {
            this.botType = botTypeBasicArb;
            this.baseLots = cfg.uiConfig.simpleArbLots;
            this.quoteLots = cfg.uiConfig.simpleArbLots;
        }
        else if (cfg.basicMarketMakingConfig) { // basicmm
            this.botType = botTypeBasicMM;
            this.baseLots = cfg.basicMarketMakingConfig.sellPlacements.reduce(sumLots, 0);
            this.quoteLots = cfg.basicMarketMakingConfig.buyPlacements.reduce(sumLots, 0);
            this.nBuyPlacements = cfg.basicMarketMakingConfig.buyPlacements.length;
            this.nSellPlacements = cfg.basicMarketMakingConfig.sellPlacements.length;
        }
    }
    initialize(startupBalanceCache) {
        return __awaiter(this, void 0, void 0, function* () {
            const { host, baseID, quoteID, lotSizeConv, quoteLotConv, cexName } = this;
            const res = yield MM.report(host, baseID, quoteID);
            const r = this.marketReport = res.report;
            this.lotSizeUSD = lotSizeConv * r.baseFiatRate;
            this.quoteLotUSD = quoteLotConv * r.quoteFiatRate;
            this.proj = this.projectedAllocations();
            if (cexName) {
                const b = startupBalanceCache[baseID] = startupBalanceCache[baseID] || MM.cexBalance(cexName, baseID);
                const q = startupBalanceCache[quoteID] = startupBalanceCache[quoteID] || MM.cexBalance(cexName, quoteID);
                this.cexBaseBalance = yield b;
                this.cexQuoteBalance = yield q;
            }
        });
    }
    status() {
        const { baseID, quoteID } = this;
        const botStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.find((s) => s.config.baseID === baseID && s.config.quoteID === quoteID);
        if (!botStatus)
            return { botCfg: {}, running: false, runStats: {} };
        const { config: botCfg, running, runStats } = botStatus;
        return { botCfg, running, runStats };
    }
    /*
    * adjustedBalances calculates the user's available balances and fee-asset
    * balances for a market, with consideration for currently running bots.
    */
    adjustedBalances() {
        const { baseID, quoteID, baseFeeID, quoteFeeID, cexBaseBalance, cexQuoteBalance, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor } = this;
        const [baseWallet, quoteWallet] = [(0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteID]];
        const [bInv, qInv] = [runningBotInventory(baseID), runningBotInventory(quoteID)];
        // In these available balance calcs, only subtract the available balance of
        // running bots, since the locked/reserved/immature is already subtracted
        // from the wallet's total available balance.
        const [cexBaseAvail, cexQuoteAvail] = [((cexBaseBalance === null || cexBaseBalance === void 0 ? void 0 : cexBaseBalance.available) || 0) - bInv.cex.avail, ((cexQuoteBalance === null || cexQuoteBalance === void 0 ? void 0 : cexQuoteBalance.available) || 0) - qInv.cex.avail];
        const [dexBaseAvail, dexQuoteAvail] = [baseWallet.balance.available - bInv.dex.avail, quoteWallet.balance.available - qInv.dex.avail];
        const baseAvail = dexBaseAvail + cexBaseAvail;
        const quoteAvail = dexQuoteAvail + cexQuoteAvail;
        const baseFeeWallet = baseFeeID === baseID ? baseWallet : (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[baseFeeID];
        const quoteFeeWallet = quoteFeeID === quoteID ? quoteWallet : (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().walletMap[quoteFeeID];
        let [baseFeeAvail, dexBaseFeeAvail, cexBaseFeeAvail] = [baseAvail, dexBaseAvail, cexBaseAvail];
        if (baseFeeID !== baseID) {
            const bFeeInv = runningBotInventory(baseID);
            dexBaseFeeAvail = baseFeeWallet.balance.available - bFeeInv.dex.total;
            cexBaseFeeAvail = ((cexBaseBalance === null || cexBaseBalance === void 0 ? void 0 : cexBaseBalance.available) || 0) - bFeeInv.cex.total;
            baseFeeAvail = dexBaseFeeAvail + cexBaseFeeAvail;
        }
        let [quoteFeeAvail, dexQuoteFeeAvail, cexQuoteFeeAvail] = [quoteAvail, dexQuoteAvail, cexQuoteAvail];
        if (quoteFeeID !== quoteID) {
            const qFeeInv = runningBotInventory(quoteID);
            dexQuoteFeeAvail = quoteFeeWallet.balance.available - qFeeInv.dex.total;
            cexQuoteFeeAvail = ((cexQuoteBalance === null || cexQuoteBalance === void 0 ? void 0 : cexQuoteBalance.available) || 0) - qFeeInv.cex.total;
            quoteFeeAvail = dexQuoteFeeAvail + cexQuoteFeeAvail;
        }
        return {
            baseAvail: baseAvail / baseFactor,
            quoteAvail: quoteAvail / quoteFactor,
            dexBaseAvail: dexBaseAvail / baseFactor,
            dexQuoteAvail: dexQuoteAvail / quoteFactor,
            cexBaseAvail: cexBaseAvail / baseFactor,
            cexQuoteAvail: cexQuoteAvail / quoteFactor,
            baseFeeAvail: baseFeeAvail / baseFeeFactor,
            quoteFeeAvail: quoteFeeAvail / quoteFeeFactor,
            dexBaseFeeAvail: dexBaseFeeAvail / baseFeeFactor,
            dexQuoteFeeAvail: dexQuoteFeeAvail / quoteFeeFactor,
            cexBaseFeeAvail: cexBaseFeeAvail / baseFeeFactor,
            cexQuoteFeeAvail: cexQuoteFeeAvail / quoteFeeFactor
        };
    }
    /*
     * feesAndCommit generates a snapshot of current market fees, as well as a
     * "commit", which is the funding dedicated to being on order. The commit
     * values do not include booking fees, order reserves, etc. just the order
     * quantity.
     */
    feesAndCommit() {
        const { baseID, quoteID, marketReport: { baseFees, quoteFees }, lotSize, baseLots, quoteLots, baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker, cfg: { uiConfig: { baseConfig, quoteConfig } } } = this;
        return feesAndCommit(baseID, quoteID, baseFees, quoteFees, lotSize, baseLots, quoteLots, baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker, baseConfig.orderReservesFactor, quoteConfig.orderReservesFactor);
    }
    /*
     * projectedAllocations calculates the required asset allocations from the
     * user's configuration settings and the current market state.
     */
    projectedAllocations() {
        const { cfg: { uiConfig: { quoteConfig, baseConfig } }, baseFactor, quoteFactor, baseID, quoteID, lotSizeConv, quoteLotConv, baseFeeFactor, quoteFeeFactor, baseFeeID, quoteFeeID, baseToken, quoteToken, cexName } = this;
        const { commit, fees } = this.feesAndCommit();
        const bProj = emptyProjection();
        const qProj = emptyProjection();
        bProj.book = commit.dex.base.lots * lotSizeConv;
        qProj.book = commit.cex.base.lots * quoteLotConv;
        bProj.orderReserves = Math.max(commit.cex.base.val, commit.dex.base.val) * baseConfig.orderReservesFactor / baseFactor;
        qProj.orderReserves = Math.max(commit.cex.quote.val, commit.dex.quote.val) * quoteConfig.orderReservesFactor / quoteFactor;
        if (cexName) {
            bProj.cex = commit.cex.base.lots * lotSizeConv;
            qProj.cex = commit.cex.quote.lots * quoteLotConv;
        }
        bProj.bookingFees = fees.base.bookingFees / baseFeeFactor;
        qProj.bookingFees = fees.quote.bookingFees / quoteFeeFactor;
        if (baseToken)
            bProj.swapFeeReserves = fees.base.tokenFeesPerSwap * baseConfig.swapFeeN / baseFeeFactor;
        if (quoteToken)
            qProj.swapFeeReserves = fees.quote.tokenFeesPerSwap * quoteConfig.swapFeeN / quoteFeeFactor;
        qProj.slippageBuffer = (qProj.book + qProj.cex + qProj.orderReserves) * quoteConfig.slippageBufferFactor;
        const alloc = {};
        const addAlloc = (assetID, amt) => { var _a; alloc[assetID] = ((_a = alloc[assetID]) !== null && _a !== void 0 ? _a : 0) + amt; };
        addAlloc(baseID, Math.round((bProj.book + bProj.cex + bProj.orderReserves) * baseFactor));
        addAlloc(baseFeeID, Math.round((bProj.bookingFees + bProj.swapFeeReserves) * baseFeeFactor));
        addAlloc(quoteID, Math.round((qProj.book + qProj.cex + qProj.orderReserves + qProj.slippageBuffer) * quoteFactor));
        addAlloc(quoteFeeID, Math.round((qProj.bookingFees + qProj.swapFeeReserves) * quoteFeeFactor));
        return { qProj, bProj, alloc };
    }
    /*
     * fundingState examines the projected allocations and the user's wallet
     * balances to determine whether the user can fund the bot fully, unbalanced,
     * or starved, and what funding source options might be available.
     */
    fundingState() {
        const { proj: { bProj, qProj }, baseID, quoteID, baseFeeID, quoteFeeID, cfg: { uiConfig: { cexRebalance } }, cexName } = this;
        const { baseAvail, quoteAvail, dexBaseAvail, dexQuoteAvail, cexBaseAvail, cexQuoteAvail, dexBaseFeeAvail, dexQuoteFeeAvail } = this.adjustedBalances();
        const canRebalance = Boolean(cexName && cexRebalance);
        // Three possible states.
        // 1. We have the funding in the projection, and its in the right places.
        //    Give them some options for which wallet to pull order reserves from,
        //    but they can start immediately..
        // 2. We have the funding, but it's in the wrong place or the wrong asset,
        //    but we have deposits and withdraws enabled. We can offer them the
        //    option to start in an unbalanced state.
        // 3. We don't have the funds. We offer them an option to start in a
        //    starved state.
        const cexMinBaseAlloc = bProj.cex;
        let [dexMinBaseAlloc, transferableBaseAlloc, dexBaseFeeReq] = [bProj.book, 0, 0];
        // Only add booking fees if this is the fee asset.
        if (baseID === baseFeeID)
            dexMinBaseAlloc += bProj.bookingFees;
        // Base asset is a token.
        else
            dexBaseFeeReq += bProj.bookingFees + bProj.swapFeeReserves;
        // If we can rebalance, the order reserves could potentially be withdrawn.
        if (canRebalance)
            transferableBaseAlloc += bProj.orderReserves;
        // If we can't rebalance, order reserves are required in dex balance.
        else
            dexMinBaseAlloc += bProj.orderReserves;
        // Handle the special case where the base asset it the quote asset's fee
        // asset.
        if (baseID === quoteFeeID) {
            if (canRebalance)
                transferableBaseAlloc += qProj.bookingFees + qProj.swapFeeReserves;
            else
                dexMinBaseAlloc += qProj.bookingFees + qProj.swapFeeReserves;
        }
        let [dexMinQuoteAlloc, cexMinQuoteAlloc, transferableQuoteAlloc, dexQuoteFeeReq] = [qProj.book, qProj.cex, 0, 0];
        if (quoteID === quoteFeeID)
            dexMinQuoteAlloc += qProj.bookingFees;
        else
            dexQuoteFeeReq += qProj.bookingFees + qProj.swapFeeReserves;
        if (canRebalance)
            transferableQuoteAlloc += qProj.orderReserves + qProj.slippageBuffer;
        else {
            // The slippage reserves reserves should be split between cex and dex.
            dexMinQuoteAlloc += qProj.orderReserves;
            const basis = qProj.book + qProj.cex + qProj.orderReserves;
            dexMinQuoteAlloc += (qProj.book + qProj.orderReserves) / basis * qProj.slippageBuffer;
            cexMinQuoteAlloc += qProj.cex / basis * qProj.slippageBuffer;
        }
        if (quoteID === baseFeeID) {
            if (canRebalance)
                transferableQuoteAlloc += bProj.bookingFees + bProj.swapFeeReserves;
            else
                dexMinQuoteAlloc += bProj.bookingFees + bProj.swapFeeReserves;
        }
        const dexBaseFunded = dexBaseAvail >= dexMinBaseAlloc;
        const cexBaseFunded = cexBaseAvail >= cexMinBaseAlloc;
        const dexQuoteFunded = dexQuoteAvail >= dexMinQuoteAlloc;
        const cexQuoteFunded = cexQuoteAvail >= cexMinQuoteAlloc;
        const totalBaseReq = dexMinBaseAlloc + cexMinBaseAlloc + transferableBaseAlloc;
        const totalQuoteReq = dexMinQuoteAlloc + cexMinQuoteAlloc + transferableQuoteAlloc;
        const baseFundedAndBalanced = dexBaseFunded && cexBaseFunded && baseAvail >= totalBaseReq;
        const quoteFundedAndBalanced = dexQuoteFunded && cexQuoteFunded && quoteAvail >= totalQuoteReq;
        const baseFeesFunded = dexBaseFeeAvail >= dexBaseFeeReq;
        const quoteFeesFunded = dexQuoteFeeAvail >= dexQuoteFeeReq;
        const fundedAndBalanced = baseFundedAndBalanced && quoteFundedAndBalanced && baseFeesFunded && quoteFeesFunded;
        // Are we funded but not balanced, but able to rebalance with a cex?
        let fundedAndNotBalanced = !fundedAndBalanced;
        if (!fundedAndBalanced) {
            const ordersFunded = baseAvail >= totalBaseReq && quoteAvail >= totalQuoteReq;
            const feesFunded = baseFeesFunded && quoteFeesFunded;
            fundedAndNotBalanced = ordersFunded && feesFunded && canRebalance;
        }
        return {
            base: {
                dex: {
                    avail: dexBaseAvail,
                    req: dexMinBaseAlloc,
                    funded: dexBaseFunded
                },
                cex: {
                    avail: cexBaseAvail,
                    req: cexMinBaseAlloc,
                    funded: cexBaseFunded
                },
                transferable: transferableBaseAlloc,
                fees: {
                    avail: dexBaseFeeAvail,
                    req: dexBaseFeeReq,
                    funded: baseFeesFunded
                },
                fundedAndBalanced: baseFundedAndBalanced,
                fundedAndNotBalanced: !baseFundedAndBalanced && baseAvail >= totalBaseReq && canRebalance
            },
            quote: {
                dex: {
                    avail: dexQuoteAvail,
                    req: dexMinQuoteAlloc,
                    funded: dexQuoteFunded
                },
                cex: {
                    avail: cexQuoteAvail,
                    req: cexMinQuoteAlloc,
                    funded: cexQuoteFunded
                },
                transferable: transferableQuoteAlloc,
                fees: {
                    avail: dexQuoteFeeAvail,
                    req: dexQuoteFeeReq,
                    funded: quoteFeesFunded
                },
                fundedAndBalanced: quoteFundedAndBalanced,
                fundedAndNotBalanced: !quoteFundedAndBalanced && quoteAvail >= totalQuoteReq && canRebalance
            },
            fundedAndBalanced,
            fundedAndNotBalanced,
            starved: !fundedAndBalanced && !fundedAndNotBalanced
        };
    }
}
class RunningMarketMakerDisplay {
    constructor(div, page) {
        this.div = div;
        this.page = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].parseTemplate(div);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.page.stopBttn, 'click', () => this.stop());
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].bind(this.page.runLogsBttn, 'click', () => {
            const { mkt: { baseID, quoteID, host }, startTime } = this;
            (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loadPage('mmlogs', { baseID, quoteID, host, startTime, returnPage: page });
        });
    }
    stop() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, mkt: { host, baseID, quoteID } } = this;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().loading(page.stopBttn);
            yield MM.stopBot({ host, baseID: baseID, quoteID: quoteID });
            loaded();
        });
    }
    setMarket(host, baseID, quoteID) {
        return __awaiter(this, void 0, void 0, function* () {
            const botStatus = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().mmStatus.bots.find(({ config: c }) => c.baseID === baseID && c.quoteID === quoteID && c.host === host);
            if (!botStatus)
                return;
            const mkt = new BotMarket(botStatus.config);
            yield mkt.initialize({});
            this.setBotMarket(mkt);
        });
    }
    setBotMarket(mkt) {
        var _a, _b, _c, _d, _e;
        return __awaiter(this, void 0, void 0, function* () {
            this.mkt = mkt;
            const { page, div, mkt: { host, baseID, quoteID, baseFeeID, quoteFeeID, cexName, baseFeeSymbol, quoteFeeSymbol, baseFeeTicker, quoteFeeTicker, cfg, baseFactor, quoteFactor } } = this;
            setMarketElements(div, baseID, quoteID, host);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFeeID !== baseID, page.baseFeeReservesBox);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(quoteFeeID !== quoteID, page.quoteFeeReservesBox);
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(Boolean(cexName), ..._doc__WEBPACK_IMPORTED_MODULE_2__["default"].applySelector(div, '[data-cex-show]'));
            page.baseFeeLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(baseFeeSymbol);
            page.baseFeeTicker.textContent = baseFeeTicker;
            page.quoteFeeLogo.src = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].logoPath(quoteFeeSymbol);
            page.quoteFeeTicker.textContent = quoteFeeTicker;
            const basicCfg = cfg.basicMarketMakingConfig;
            const gapStrategy = (_a = basicCfg === null || basicCfg === void 0 ? void 0 : basicCfg.gapStrategy) !== null && _a !== void 0 ? _a : GapStrategyPercent;
            let gapFactor = (_e = (_c = (_b = cfg.arbMarketMakingConfig) === null || _b === void 0 ? void 0 : _b.profit) !== null && _c !== void 0 ? _c : (_d = cfg.simpleArbConfig) === null || _d === void 0 ? void 0 : _d.profitTrigger) !== null && _e !== void 0 ? _e : 0;
            if (basicCfg) {
                const buys = [...basicCfg.buyPlacements].sort((a, b) => a.gapFactor - b.gapFactor);
                const sells = [...basicCfg.sellPlacements].sort((a, b) => a.gapFactor - b.gapFactor);
                if (buys.length > 0) {
                    if (sells.length > 0) {
                        gapFactor = (buys[0].gapFactor + sells[0].gapFactor) / 2;
                    }
                    else {
                        gapFactor = buys[0].gapFactor;
                    }
                }
                else
                    gapFactor = sells[0].gapFactor;
            }
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.profitLabel, page.gapLabel, page.multiplierLabel, page.profitUnit, page.gapUnit, page.multiplierUnit);
            switch (gapStrategy) {
                case GapStrategyPercent:
                case GapStrategyPercentPlus:
                    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.profitLabel, page.profitUnit);
                    page.gapFactor.textContent = (gapFactor * 100).toFixed(2);
                    break;
                case GapStrategyMultiplier:
                    _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.multiplierLabel, page.multiplierUnit);
                    page.gapFactor.textContent = (gapFactor * 100).toFixed(2);
                    break;
                default:
                    page.gapFactor.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(gapFactor / _orderutil__WEBPACK_IMPORTED_MODULE_3__.RateEncodingFactor * baseFactor / quoteFactor);
            }
            this.update();
            this.readBook();
        });
    }
    handleBalanceNote(n) {
        if (!this.mkt)
            return;
        const { baseID, quoteID, baseFeeID, quoteFeeID } = this.mkt;
        if (n.assetID !== baseID && n.assetID !== baseFeeID && n.assetID !== quoteID && n.assetID !== quoteFeeID)
            return;
        this.update();
    }
    setTicker() {
        this.page.runTime.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hmsSince(this.startTime);
    }
    update() {
        var _a, _b, _c, _d;
        const { div, page, mkt: { baseID, quoteID, baseFeeID, quoteFeeID, baseFactor, quoteFactor, baseFeeFactor, quoteFeeFactor, marketReport: { baseFiatRate, quoteFiatRate } } } = this;
        // Get fresh stats
        const { botCfg: { cexName, basicMarketMakingConfig: bmmCfg }, runStats } = this.mkt.status();
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].hide(page.stats, page.cexRow, page.pendingDepositBox, page.pendingWithdrawalBox);
        if (!runStats) {
            if (this.ticker) {
                clearInterval(this.ticker);
                this.ticker = undefined;
            }
            return;
        }
        else if (!this.ticker) {
            this.startTime = runStats.startTime;
            this.setTicker();
            this.ticker = setInterval(() => this.setTicker(), 1000);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.stats);
        setSignedValue(runStats.profitLoss.profitRatio * 100, page.profit, page.profitSign, 2);
        setSignedValue(runStats.profitLoss.profit, page.profitLoss, page.plSign, 2);
        this.startTime = runStats.startTime;
        const summedBalance = (b) => {
            if (!b)
                return 0;
            return b.available + b.locked + b.pending + b.reserved;
        };
        const dexBaseInv = summedBalance(runStats.dexBalances[baseID]) / baseFactor;
        page.walletBaseInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexBaseInv);
        page.walletBaseInvFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexBaseInv * baseFiatRate, 2);
        const dexQuoteInv = summedBalance(runStats.dexBalances[quoteID]) / quoteFactor;
        page.walletQuoteInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexQuoteInv);
        page.walletQuoteInvFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(dexQuoteInv * quoteFiatRate, 2);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(cexName, page.cexRow);
        if (cexName) {
            _doc__WEBPACK_IMPORTED_MODULE_2__["default"].show(page.pendingDepositBox, page.pendingWithdrawalBox);
            setCexElements(div, cexName);
            const cexBaseInv = summedBalance(runStats.cexBalances[baseID]) / baseFactor;
            page.cexBaseInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexBaseInv);
            page.cexBaseInventoryFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexBaseInv * baseFiatRate, 2);
            const cexQuoteInv = summedBalance(runStats.cexBalances[quoteID]) / quoteFactor;
            page.cexQuoteInventory.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexQuoteInv);
            page.cexQuoteInventoryFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(cexQuoteInv * quoteFiatRate, 2);
        }
        if (baseFeeID !== baseID) {
            const feeBalance = summedBalance(runStats.dexBalances[baseFeeID]) / baseFeeFactor;
            page.baseFeeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(feeBalance);
        }
        if (quoteFeeID !== quoteID) {
            const feeBalance = summedBalance(runStats.dexBalances[quoteFeeID]) / quoteFeeFactor;
            page.quoteFeeReserves.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(feeBalance);
        }
        page.pendingDeposits.textContent = String(Math.round(runStats.pendingDeposits));
        page.pendingWithdrawals.textContent = String(Math.round(runStats.pendingWithdrawals));
        page.completedMatches.textContent = String(Math.round(runStats.completedMatches));
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(runStats.tradedUSD, page.tradedUSDBox);
        if (runStats.tradedUSD > 0)
            page.tradedUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(runStats.tradedUSD);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(baseFiatRate, page.roundTripFeesBox);
        if (baseFiatRate)
            page.roundTripFeesUSD.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs((((_a = runStats.feeGap) === null || _a === void 0 ? void 0 : _a.roundTripFees) / baseFactor * baseFiatRate) || 0);
        const basisPrice = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, ((_b = runStats.feeGap) === null || _b === void 0 ? void 0 : _b.basisPrice) || 0);
        page.basisPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(basisPrice);
        const displayFeeGap = !bmmCfg || bmmCfg.gapStrategy === GapStrategyAbsolutePlus || bmmCfg.gapStrategy === GapStrategyPercentPlus;
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(displayFeeGap, page.feeGapBox);
        if (displayFeeGap) {
            const feeGap = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, ((_c = runStats.feeGap) === null || _c === void 0 ? void 0 : _c.feeGap) || 0);
            page.feeGap.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(feeGap);
            page.feeGapPct.textContent = (feeGap / basisPrice * 100 || 0).toFixed(2);
        }
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(bmmCfg, page.gapStrategyBox);
        if (bmmCfg)
            page.gapStrategy.textContent = bmmCfg.gapStrategy;
        const remoteGap = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().conventionalRate(baseID, quoteID, ((_d = runStats.feeGap) === null || _d === void 0 ? void 0 : _d.remoteGap) || 0);
        _doc__WEBPACK_IMPORTED_MODULE_2__["default"].setVis(remoteGap, page.remoteGapBox);
        if (remoteGap) {
            page.remoteGap.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(remoteGap);
            page.remoteGapPct.textContent = (remoteGap / basisPrice * 100 || 0).toFixed(2);
        }
    }
    readBook() {
        if (!this.mkt)
            return;
        const { page, mkt: { host, mktID } } = this;
        const orders = (0,_registry__WEBPACK_IMPORTED_MODULE_0__.app)().exchanges[host].markets[mktID].orders || [];
        page.nBookedOrders.textContent = String(orders.filter((ord) => ord.status === _orderutil__WEBPACK_IMPORTED_MODULE_3__.StatusBooked).length);
    }
}
function setSignedValue(v, vEl, signEl, maxDecimals) {
    vEl.textContent = _doc__WEBPACK_IMPORTED_MODULE_2__["default"].formatFourSigFigs(v, maxDecimals);
    signEl.classList.toggle('ico-plus', v > 0);
    signEl.classList.toggle('text-good', v > 0);
    // signEl.classList.toggle('ico-minus', v < 0)
}
function feesAndCommit(baseID, quoteID, baseFees, quoteFees, lotSize, baseLots, quoteLots, baseFeeID, quoteFeeID, baseIsAccountLocker, quoteIsAccountLocker, baseOrderReservesFactor, quoteOrderReservesFactor) {
    const quoteLot = calculateQuoteLot(lotSize, baseID, quoteID);
    const [cexBaseLots, cexQuoteLots] = [quoteLots, baseLots];
    const commit = {
        dex: {
            base: {
                lots: baseLots,
                val: baseLots * lotSize
            },
            quote: {
                lots: quoteLots,
                val: quoteLots * quoteLot
            }
        },
        cex: {
            base: {
                lots: cexBaseLots,
                val: cexBaseLots * lotSize
            },
            quote: {
                lots: cexQuoteLots,
                val: cexQuoteLots * quoteLot
            }
        }
    };
    let baseTokenFeesPerSwap = 0;
    let baseRedeemReservesPerLot = 0;
    if (baseID !== baseFeeID) { // token
        baseTokenFeesPerSwap += baseFees.estimated.swap;
        if (baseFeeID === quoteFeeID)
            baseTokenFeesPerSwap += quoteFees.estimated.redeem;
    }
    let baseBookingFeesPerLot = baseFees.max.swap;
    if (baseID === quoteFeeID)
        baseBookingFeesPerLot += quoteFees.max.redeem;
    if (baseIsAccountLocker) {
        baseBookingFeesPerLot += baseFees.max.refund;
        if (!quoteIsAccountLocker && baseFeeID !== quoteFeeID)
            baseRedeemReservesPerLot = baseFees.max.redeem;
    }
    let quoteTokenFeesPerSwap = 0;
    let quoteRedeemReservesPerLot = 0;
    if (quoteID !== quoteFeeID) {
        quoteTokenFeesPerSwap += quoteFees.estimated.swap;
        if (quoteFeeID === baseFeeID)
            quoteTokenFeesPerSwap += baseFees.estimated.redeem;
    }
    let quoteBookingFeesPerLot = quoteFees.max.swap;
    if (quoteID === baseFeeID)
        quoteBookingFeesPerLot += baseFees.max.redeem;
    if (quoteIsAccountLocker) {
        quoteBookingFeesPerLot += quoteFees.max.refund;
        if (!baseIsAccountLocker && quoteFeeID !== baseFeeID)
            quoteRedeemReservesPerLot = quoteFees.max.redeem;
    }
    const baseReservesFactor = 1 + baseOrderReservesFactor;
    const quoteReservesFactor = 1 + quoteOrderReservesFactor;
    const baseBookingFees = (baseBookingFeesPerLot * baseLots) * baseReservesFactor;
    const baseRedeemFees = (baseRedeemReservesPerLot * quoteLots) * quoteReservesFactor;
    const quoteBookingFees = (quoteBookingFeesPerLot * quoteLots) * quoteReservesFactor;
    const quoteRedeemFees = (quoteRedeemReservesPerLot * baseLots) * baseReservesFactor;
    const fees = {
        base: Object.assign(Object.assign({}, baseFees), { bookingFeesPerLot: baseBookingFeesPerLot, bookingFeesPerCounterLot: baseRedeemReservesPerLot, bookingFees: baseBookingFees + baseRedeemFees, swapReservesFactor: baseReservesFactor, redeemReservesFactor: quoteReservesFactor, tokenFeesPerSwap: baseTokenFeesPerSwap }),
        quote: Object.assign(Object.assign({}, quoteFees), { bookingFeesPerLot: quoteBookingFeesPerLot, bookingFeesPerCounterLot: quoteRedeemReservesPerLot, bookingFees: quoteBookingFees + quoteRedeemFees, swapReservesFactor: quoteReservesFactor, redeemReservesFactor: baseReservesFactor, tokenFeesPerSwap: quoteTokenFeesPerSwap })
    };
    return { commit, fees };
}


/***/ }),

/***/ "./src/js/notifications.ts":
/*!*********************************!*\
  !*** ./src/js/notifications.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DATA": () => (/* binding */ DATA),
/* harmony export */   "ERROR": () => (/* binding */ ERROR),
/* harmony export */   "IGNORE": () => (/* binding */ IGNORE),
/* harmony export */   "Notifier": () => (/* binding */ Notifier),
/* harmony export */   "POKE": () => (/* binding */ POKE),
/* harmony export */   "SUCCESS": () => (/* binding */ SUCCESS),
/* harmony export */   "WARNING": () => (/* binding */ WARNING),
/* harmony export */   "defaultDesktopNtfnSettings": () => (/* binding */ defaultDesktopNtfnSettings),
/* harmony export */   "desktopNotify": () => (/* binding */ desktopNotify),
/* harmony export */   "desktopNtfnLabels": () => (/* binding */ desktopNtfnLabels),
/* harmony export */   "fetchDesktopNtfnSettings": () => (/* binding */ fetchDesktopNtfnSettings),
/* harmony export */   "insertRichNote": () => (/* binding */ insertRichNote),
/* harmony export */   "make": () => (/* binding */ make),
/* harmony export */   "plainNote": () => (/* binding */ plainNote),
/* harmony export */   "updateNtfnSetting": () => (/* binding */ updateNtfnSetting)
/* harmony export */ });
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};




const IGNORE = 0;
const DATA = 1;
const POKE = 2;
const SUCCESS = 3;
const WARNING = 4;
const ERROR = 5;
/*
 * make constructs a new notification. The notification structure is a mirror of
 * the structure of notifications sent from the web server.
 * NOTE: I'm hoping to make this function obsolete, since errors generated in
 * javascript should usually be displayed/cached somewhere better. For example,
 * if the error is generated during submission of a form, the error should be
 * displayed on or near the form itself, not in the notifications.
 */
function make(subject, details, severity) {
    return {
        subject: subject,
        details: details,
        severity: severity,
        stamp: new Date().getTime(),
        acked: false,
        type: 'internal',
        topic: 'internal',
        id: ''
    };
}
const NoteTypeOrder = 'order';
const NoteTypeMatch = 'match';
const NoteTypeBondPost = 'bondpost';
const NoteTypeConnEvent = 'conn';
function desktopNtfnSettingsKey() {
    return `desktop_notifications-${window.location.host}`;
}
const desktopNtfnLabels = {
    [NoteTypeOrder]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ORDERS,
    [NoteTypeMatch]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_MATCHES,
    [NoteTypeBondPost]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_BONDS,
    [NoteTypeConnEvent]: _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_CONNECTIONS
};
const defaultDesktopNtfnSettings = {
    [NoteTypeOrder]: true,
    [NoteTypeMatch]: true,
    [NoteTypeBondPost]: true,
    [NoteTypeConnEvent]: true
};
let desktopNtfnSettings;
// BrowserNotifier is a wrapper around the browser's notification API.
class BrowserNotifier {
    static ntfnPermissionGranted() {
        return window.Notification.permission === 'granted';
    }
    static ntfnPermissionDenied() {
        return window.Notification.permission === 'denied';
    }
    static requestNtfnPermission() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!('Notification' in window)) {
                return;
            }
            if (BrowserNotifier.ntfnPermissionGranted()) {
                BrowserNotifier.sendDesktopNotification(_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ENABLED));
            }
            else if (!BrowserNotifier.ntfnPermissionDenied()) {
                yield Notification.requestPermission();
                BrowserNotifier.sendDesktopNotification(_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ENABLED));
            }
        });
    }
    static sendDesktopNotification(title, body) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!BrowserNotifier.ntfnPermissionGranted())
                return;
            const ntfn = new window.Notification(title, {
                body: body,
                icon: '/img/softened-icon.png'
            });
            return ntfn;
        });
    }
}
// OSDesktopNotifier manages OS desktop notifications via the same interface
// as BrowserNotifier, but sends notifications using an underlying Go
// notification library exposed to the webview.
class OSDesktopNotifier {
    static ntfnPermissionGranted() {
        return true;
    }
    static ntfnPermissionDenied() {
        return false;
    }
    static requestNtfnPermission() {
        return __awaiter(this, void 0, void 0, function* () {
            yield OSDesktopNotifier.sendDesktopNotification(_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BROWSER_NTFN_ENABLED));
            return Promise.resolve();
        });
    }
    static sendDesktopNotification(title, body) {
        return __awaiter(this, void 0, void 0, function* () {
            // webview/linux or webview/windows
            if (isDesktopWebview())
                yield window.sendOSNotification(title, body);
            // webkit/darwin
            // See: client/cmd/bisonw-desktop/app_darwin.go#L673-#L697
            else if (isDesktopWebkit())
                yield window.webkit.messageHandlers.bwHandler.postMessage(['sendOSNotification', title, body]);
            else
                console.error('sendDesktopNotification: unknown environment');
        });
    }
}
// isDesktopWebview checks if we are running in webview
function isDesktopWebview() {
    return window.isWebview !== undefined;
}
// isDesktopDarwin returns true if we are running in a webview on darwin
// It tests for the existence of the bwHandler webkit message handler.
function isDesktopWebkit() {
    var _a, _b;
    return ((_b = (_a = window.webkit) === null || _a === void 0 ? void 0 : _a.messageHandlers) === null || _b === void 0 ? void 0 : _b.bwHandler) !== undefined;
}
// determine whether we're running in a webview or in browser, and export
// the appropriate notifier accordingly.
const Notifier = isDesktopWebview() || isDesktopWebkit() ? OSDesktopNotifier : BrowserNotifier;
function desktopNotify(note) {
    return __awaiter(this, void 0, void 0, function* () {
        if (!desktopNtfnSettings.browserNtfnEnabled || !desktopNtfnSettings[note.type])
            return;
        yield Notifier.sendDesktopNotification(note.subject, plainNote(note.details));
    });
}
function fetchDesktopNtfnSettings() {
    var _a;
    if (desktopNtfnSettings !== undefined) {
        return desktopNtfnSettings;
    }
    const k = desktopNtfnSettingsKey();
    desktopNtfnSettings = ((_a = _state__WEBPACK_IMPORTED_MODULE_1__["default"].fetchLocal(k)) !== null && _a !== void 0 ? _a : {});
    return desktopNtfnSettings;
}
function updateNtfnSetting(noteType, enabled) {
    fetchDesktopNtfnSettings();
    desktopNtfnSettings[noteType] = enabled;
    _state__WEBPACK_IMPORTED_MODULE_1__["default"].storeLocal(desktopNtfnSettingsKey(), desktopNtfnSettings);
}
const coinExplorerTokenRe = /\{\{\{([^|]+)\|([^}]+)\}\}\}/g;
const orderTokenRe = /\{\{\{order\|([^}]+)\}\}\}/g;
/*
 * insertRichNote replaces tx and order hash tokens in the input string with
 * <a> elements that link to the asset's chain explorer and order details
 * view, and inserts the resulting HTML into the supplied parent element.
 */
function insertRichNote(parent, inputString) {
    const s = inputString.replace(orderTokenRe, (_match, orderToken) => {
        const link = document.createElement('a');
        link.setAttribute('href', '/order/' + orderToken);
        link.setAttribute('class', 'subtlelink');
        link.textContent = orderToken.slice(0, 8);
        return link.outerHTML;
    }).replace(coinExplorerTokenRe, (_match, assetID, hash) => {
        const link = document.createElement('a');
        link.setAttribute('data-explorer-coin', hash);
        link.setAttribute('target', '_blank');
        link.textContent = hash.slice(0, 8);
        (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_2__.setCoinHref)(assetID, link);
        return link.outerHTML;
    });
    const els = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].noderize(s).body;
    while (els.firstChild)
        parent.appendChild(els.firstChild);
}
/*
 * plainNote replaces tx and order hash tokens tokens in the input string with
 * shortened hashes, for rendering in browser notifications and popups.
 */
function plainNote(inputString) {
    const replacedString = inputString.replace(coinExplorerTokenRe, (_match, _assetID, hash) => {
        return hash.slice(0, 8);
    });
    return replacedString;
}


/***/ }),

/***/ "./src/js/opts.ts":
/*!************************!*\
  !*** ./src/js/opts.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BooleanOption": () => (/* binding */ BooleanOption),
/* harmony export */   "Option": () => (/* binding */ Option),
/* harmony export */   "XYRangeHandler": () => (/* binding */ XYRangeHandler),
/* harmony export */   "XYRangeOption": () => (/* binding */ XYRangeOption),
/* harmony export */   "setOptionTemplates": () => (/* binding */ setOptionTemplates)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");

// Having the caller set these vars on load using an exported function makes
// life easier.
let orderOptTmpl, booleanOptTmpl, rangeOptTmpl;
// setOptionTemplates sets the package vars for the templates and application.
function setOptionTemplates(page) {
    [booleanOptTmpl, rangeOptTmpl, orderOptTmpl] = [page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl];
}
const threeSigFigs = new Intl.NumberFormat(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
    minimumSignificantDigits: 3,
    maximumSignificantDigits: 3
});
/*
 * Option is a base class for option elements. Option stores some common
 * parameters and monitors the toggle switch, calling the child class's
 * enable/disable methods when the user manually turns the option on or off.
 */
class Option {
    constructor(opt, symbol, report) {
        this.opt = opt;
        const node = this.node = orderOptTmpl.cloneNode(true);
        const tmpl = this.tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(node);
        tmpl.optName.textContent = opt.displayname;
        tmpl.tooltip.dataset.tooltip = opt.description;
        // const isBaseChain = (isSwapOption && order.sell) || (!isSwapOption && !order.sell)
        // const symbol = isBaseChain ? this.baseSymbol() : this.quoteSymbol()
        if (symbol)
            tmpl.chainIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.chainIcon);
        this.on = false;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(node, 'click', () => {
            if (this.on)
                return;
            this.on = true;
            node.classList.add('selected');
            report.enable();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.toggle, 'click', e => {
            if (!this.on)
                return;
            e.stopPropagation();
            this.on = false;
            node.classList.remove('selected');
            report.disable();
        });
    }
}
/*
 * BooleanOption is a simple on/off option with a short summary of it's effects.
 * BooleanOrderOption is the handler for a *BooleanConfig from client/asset.
 */
class BooleanOption extends Option {
    constructor(opt, symbol, dict, changed) {
        super(opt, symbol, {
            enable: () => this.enable(),
            disable: () => this.disable()
        });
        this.dict = dict;
        this.changed = () => changed();
        if (opt.boolean === undefined)
            throw Error('not a boolean opt');
        const cfg = opt.boolean;
        const control = this.control = booleanOptTmpl.cloneNode(true);
        // Append to parent's options div.
        this.tmpl.controls.appendChild(control);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(control);
        tmpl.reason.textContent = cfg.reason;
        this.on = typeof dict[opt.key] !== 'undefined' ? dict[opt.key] : opt.default;
        if (this.on)
            this.node.classList.add('selected');
    }
    store() {
        if (this.on === this.opt.default)
            delete this.dict[this.opt.key];
        else
            this.dict[this.opt.key] = this.on;
        this.changed();
    }
    enable() {
        this.store();
    }
    disable() {
        this.store();
    }
}
/*
 * XYRangeOption is an order option that contains an XYRangeHandler. The logic
 * for handling the slider to is defined in XYRangeHandler so that the slider
 * can be used without being contained in an order option.
 */
class XYRangeOption extends Option {
    constructor(opt, symbol, dict, changed) {
        super(opt, symbol, {
            enable: () => this.enable(),
            disable: () => this.disable()
        });
        this.dict = dict;
        this.changed = changed;
        if (opt.xyRange === undefined)
            throw Error('not an xy range opt');
        const cfg = opt.xyRange;
        const setVal = dict[opt.key];
        this.on = typeof setVal !== 'undefined';
        if (this.on) {
            this.node.classList.add('selected');
            this.x = setVal;
        }
        else {
            this.x = opt.default;
        }
        const selected = () => { this.node.classList.add('selected'); };
        this.handler = new XYRangeHandler(cfg, this.x, { changed, selected, settingsDict: dict, settingsKey: opt.key });
        this.tmpl.controls.appendChild(this.handler.control);
    }
    enable() {
        this.dict[this.opt.key] = this.x;
        this.changed();
    }
    disable() {
        delete this.dict[this.opt.key];
        this.changed();
    }
    setValue(x) {
        this.handler.setValue(x);
        this.on = true;
        this.node.classList.add('selected');
    }
}
/*
 * XYRangeHandler is the handler for an *XYRange from client/asset. XYRange
 * has a slider which allows adjusting the x and y, linearly between two limits.
 * The user can also manually enter values for x or y.
 */
class XYRangeHandler {
    constructor(range, initVal, opts) {
        var _a, _b, _c, _d;
        const control = this.control = rangeOptTmpl.cloneNode(true);
        const tmpl = this.tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(control);
        tmpl.rangeLblStart.textContent = range.start.label;
        tmpl.rangeLblEnd.textContent = range.end.label;
        tmpl.xUnit.textContent = range.xUnit;
        tmpl.yUnit.textContent = range.yUnit;
        this.range = range;
        this.initVal = initVal;
        this.settingsDict = opts.settingsDict;
        this.settingsKey = (_a = opts.settingsKey) !== null && _a !== void 0 ? _a : '';
        this.roundX = Boolean(opts.roundX);
        this.roundY = Boolean(opts.roundY);
        this.setDisabled(Boolean(opts.disabled));
        this.changed = (_b = opts.changed) !== null && _b !== void 0 ? _b : (() => { });
        this.selected = (_c = opts.selected) !== null && _c !== void 0 ? _c : (() => { });
        this.updated = (_d = opts.updated) !== null && _d !== void 0 ? _d : (() => { });
        this.convert = opts.convert || ((x) => x);
        const { slider, handle } = tmpl;
        const rangeX = range.end.x - range.start.x;
        const rangeY = range.end.y - range.start.y;
        const normalizeX = (x) => (x - range.start.x) / rangeX;
        // r, x, and y will be updated by the various input event handlers. r is
        // x (or y) normalized on its range, e.g. [x_min, x_max] -> [0, 1]
        this.r = normalizeX(initVal);
        this.scrollingX = this.x = initVal;
        this.y = this.r * rangeY + range.start.y;
        this.accept(this.scrollingX, { skipUpdate: true });
        // Set up the handlers for the x and y text input fields.
        const clickOutX = (e) => {
            if (this.disabled)
                return;
            if (e.type !== 'change' && e.target === tmpl.xInput)
                return;
            const s = tmpl.xInput.value;
            if (s) {
                const xx = parseFloat(s);
                if (!isNaN(xx)) {
                    this.scrollingX = clamp(xx, range.start.x, range.end.x);
                    this.r = normalizeX(this.scrollingX);
                    this.y = this.r * rangeY + range.start.y;
                    this.accept(this.scrollingX);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.xInput);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.x);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'click', clickOutX);
            this.changed();
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.x, 'click', e => {
            if (this.disabled)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.x);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.xInput);
            tmpl.xInput.focus();
            tmpl.xInput.value = threeSigFigs.format(this.scrollingX);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'click', clickOutX);
            e.stopPropagation();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.xInput, 'change', clickOutX);
        const clickOutY = (e) => {
            if (this.disabled)
                return;
            if (e.type !== 'change' && e.target === tmpl.yInput)
                return;
            const s = tmpl.yInput.value;
            if (s) {
                const yy = parseFloat(s);
                if (!isNaN(yy)) {
                    this.y = clamp(yy, range.start.y, range.end.y);
                    this.r = (this.y - range.start.y) / rangeY;
                    this.scrollingX = range.start.x + this.r * rangeX;
                    this.accept(this.scrollingX);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.yInput);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.y);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'click', clickOutY);
            this.changed();
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.y, 'click', e => {
            if (this.disabled)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.y);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.yInput);
            tmpl.yInput.focus();
            tmpl.yInput.value = threeSigFigs.format(this.y);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'click', clickOutY);
            e.stopPropagation();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.yInput, 'change', clickOutY);
        // Read the slider.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(handle, 'mousedown', (e) => {
            if (this.disabled)
                return;
            if (e.button !== 0)
                return;
            e.preventDefault();
            e.stopPropagation();
            this.selected();
            const startX = e.pageX;
            const w = slider.clientWidth - handle.offsetWidth;
            const startLeft = normalizeX(this.scrollingX) * w;
            const left = (ee) => Math.max(Math.min(startLeft + (ee.pageX - startX), w), 0);
            const trackMouse = (ee, emit) => {
                ee.preventDefault();
                this.r = left(ee) / w;
                this.scrollingX = this.r * rangeX + range.start.x;
                this.y = this.r * rangeY + range.start.y;
                this.accept(this.scrollingX, { skipChange: !emit });
            };
            const mouseUp = (ee) => {
                trackMouse(ee, true);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'mousemove', trackMouse);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'mouseup', mouseUp);
                this.changed();
            };
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'mousemove', trackMouse);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'mouseup', mouseUp);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(tmpl.sliderBox, 'click', (e) => {
            if (this.disabled)
                return;
            if (e.button !== 0)
                return;
            const x = e.pageX;
            const m = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].layoutMetrics(tmpl.slider);
            this.r = clamp((x - m.bodyLeft) / m.width, 0, 1);
            this.scrollingX = this.r * rangeX + range.start.x;
            this.y = this.r * rangeY + range.start.y;
            this.accept(this.scrollingX);
        });
    }
    setDisabled(disabled) {
        this.control.classList.toggle('disabled', disabled);
        this.disabled = disabled;
    }
    setXLabel(s) {
        this.tmpl.x.textContent = s;
    }
    setYLabel(s) {
        this.tmpl.y.textContent = s;
    }
    accept(x, cfg) {
        const tmpl = this.tmpl;
        if (this.roundX)
            x = Math.round(x);
        if (this.roundY)
            this.y = Math.round(this.y);
        tmpl.x.textContent = threeSigFigs.format(x);
        tmpl.y.textContent = threeSigFigs.format(this.y);
        if (this.roundY)
            tmpl.y.textContent = `${this.y}`;
        const rEffective = clamp(this.r, 0, 1);
        tmpl.handle.style.left = `calc(${rEffective * 100}% - ${rEffective * 14}px)`;
        this.x = x;
        this.scrollingX = x;
        cfg = cfg !== null && cfg !== void 0 ? cfg : {};
        if (this.settingsDict)
            this.settingsDict[this.settingsKey] = this.convert(this.x, this.y);
        if (!cfg.skipUpdate) {
            this.updated(x, this.y);
            if (!cfg.skipChange)
                this.changed();
        }
    }
    setValue(x, skipUpdate) {
        const range = this.range;
        this.r = (x - range.start.x) / (range.end.x - range.start.x);
        this.y = range.start.y + this.r * (range.end.y - range.start.y);
        this.accept(x, { skipUpdate });
    }
    modified() {
        return this.x !== this.initVal;
    }
    reset() {
        this.setValue(this.initVal, true);
    }
}
const clamp = (v, min, max) => v < min ? min : v > max ? max : v;


/***/ }),

/***/ "./src/js/order.ts":
/*!*************************!*\
  !*** ./src/js/order.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ OrderPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









// lockTimeMakerMs must match the value returned from LockTimeMaker func in
// bisonw.
const lockTimeMakerMs = 20 * 60 * 60 * 1000;
// lockTimeTakerMs must match the value returned from LockTimeTaker func in
// bisonw.
const lockTimeTakerMs = 8 * 60 * 60 * 1000;
const animationLength = 500;
class OrderPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(main) {
        super();
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(main);
        this.stampers = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(main, '[data-stamp]');
        // Find the order
        this.orderID = main.dataset.oid || '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.matchCardTmpl);
        const setStamp = () => {
            for (const span of this.stampers) {
                span.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseInt(span.dataset.stamp || ''));
            }
        };
        setStamp();
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => {
                if (this.refreshOnPopupClose) {
                    window.location.replace(window.location.href);
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            });
        });
        // Some static elements on this page contain assets that can be linked
        // to blockchain explorers (such as Etherscan) so users can easily
        // examine funding/acceleration coins data there. We'd need to set up
        // such hyperlinks here.
        main.querySelectorAll('[data-explorer-id]').forEach((link) => {
            const assetID = parseInt(link.dataset.explorerId || '');
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.setCoinHref)(assetID, link);
        });
        if (page.cancelBttn) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.cancelBttn, 'click', () => {
                this.showForm(page.cancelForm);
            });
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.accelerateBttn, 'click', () => {
            this.showAccelerateForm();
        });
        const success = () => {
            this.refreshOnPopupClose = true;
        };
        // Do not call cleanTemplates before creating the AccelerateOrderForm
        (0,_opts__WEBPACK_IMPORTED_MODULE_7__.setOptionTemplates)(page);
        this.accelerateOrderForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.AccelerateOrderForm(page.accelerateForm, success);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.booleanOptTmpl, page.rangeOptTmpl, page.orderOptTmpl);
        // If the user clicks outside of a form, it should close the page overlay.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                if (this.refreshOnPopupClose) {
                    window.location.reload();
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            }
        });
        // Cancel order form
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.cancelForm, page.cancelSubmit, () => __awaiter(this, void 0, void 0, function* () { this.submitCancel(); }));
        this.secondTicker = window.setInterval(() => {
            setStamp();
        }, 10000); // update every 10 seconds
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().registerNoteFeeder({
            order: (note) => { this.handleOrderNote(note); },
            match: (note) => { this.handleMatchNote(note); }
        });
        this.start();
    }
    start() {
        return __awaiter(this, void 0, void 0, function* () {
            let ord = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().order(this.orderID);
            // app().order can only access active orders. If the order is not active,
            // we'll need to get the data from the database.
            if (ord)
                this.order = ord;
            else {
                ord = yield this.fetchOrder();
            }
            // Swap out the dot-notation symbols with token-aware symbols.
            this.page.mktBaseSymbol.replaceWith(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[ord.baseID]));
            this.page.mktQuoteSymbol.replaceWith(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[ord.quoteID]));
            this.setAccelerationButtonVis();
            this.showMatchCards();
        });
    }
    unload() {
        clearInterval(this.secondTicker);
    }
    /* fetchOrder fetches the order from the client. */
    fetchOrder() {
        return __awaiter(this, void 0, void 0, function* () {
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/order', this.orderID);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                throw res.msg;
            this.order = res.order;
            return this.order;
        });
    }
    /*
     * setImmutableMatchCardElements sets the match card elements that are never
     * changed.
     */
    setImmutableMatchCardElements(matchCard, match) {
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(matchCard);
        tmpl.matchID.textContent = match.matchID;
        const time = new Date(match.stamp);
        tmpl.matchTime.textContent = time.toLocaleTimeString(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
        tmpl.matchTimeAgo.dataset.stamp = match.stamp.toString();
        tmpl.matchTimeAgo.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(match.stamp);
        this.stampers.push(tmpl.matchTimeAgo);
        const orderPortion = _orderutil__WEBPACK_IMPORTED_MODULE_2__.orderPortion(this.order, match);
        const baseSymbol = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bipSymbol(this.order.baseID);
        const quoteSymbol = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bipSymbol(this.order.quoteID);
        const baseUnitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().unitInfo(this.order.baseID);
        const quoteUnitInfo = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().unitInfo(this.order.quoteID);
        const [bUnit, qUnit] = [baseUnitInfo.conventional.unit.toLowerCase(), quoteUnitInfo.conventional.unit.toLowerCase()];
        const quoteAmount = _orderutil__WEBPACK_IMPORTED_MODULE_2__.baseToQuote(match.rate, match.qty);
        if (match.isCancel) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.cancelInfoDiv);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.infoDiv, tmpl.status, tmpl.statusHdr);
            if (this.order.sell) {
                tmpl.cancelAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, baseUnitInfo);
                tmpl.cancelIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.baseID);
            }
            else {
                tmpl.cancelAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteAmount, quoteUnitInfo);
                tmpl.cancelIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.quoteID);
            }
            tmpl.cancelOrderPortion.textContent = orderPortion;
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.infoDiv);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.cancelInfoDiv);
        tmpl.orderPortion.textContent = orderPortion;
        if (match.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) {
            tmpl.side.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_MAKER);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.makerSwapYou, tmpl.makerRedeemYou, tmpl.takerSwapThem, tmpl.takerRedeemThem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.takerSwapYou, tmpl.takerRedeemYou, tmpl.makerSwapThem, tmpl.makerRedeemThem);
        }
        else {
            tmpl.side.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TAKER);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapYou, tmpl.makerRedeemYou, tmpl.takerSwapThem, tmpl.takerRedeemThem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.takerSwapYou, tmpl.takerRedeemYou, tmpl.makerSwapThem, tmpl.makerRedeemThem);
        }
        if ((match.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker && this.order.sell) ||
            (match.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Taker && !this.order.sell)) {
            tmpl.makerSwapAsset.textContent = bUnit;
            tmpl.takerSwapAsset.textContent = qUnit;
            tmpl.makerRedeemAsset.textContent = qUnit;
            tmpl.takerRedeemAsset.textContent = bUnit;
        }
        else {
            tmpl.makerSwapAsset.textContent = qUnit;
            tmpl.takerSwapAsset.textContent = bUnit;
            tmpl.makerRedeemAsset.textContent = bUnit;
            tmpl.takerRedeemAsset.textContent = qUnit;
        }
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().conventionalRate(this.order.baseID, this.order.quoteID, match.rate);
        tmpl.rate.textContent = `${rate} ${bUnit}/${qUnit}`;
        if (this.order.sell) {
            tmpl.refundAsset.textContent = baseSymbol;
            tmpl.fromAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, baseUnitInfo);
            tmpl.toAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteAmount, quoteUnitInfo);
            tmpl.fromIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.baseID);
            tmpl.toIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.quoteID);
        }
        else {
            tmpl.refundAsset.textContent = quoteSymbol;
            tmpl.fromAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(quoteAmount, quoteUnitInfo);
            tmpl.toAmount.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(match.qty, baseUnitInfo);
            tmpl.fromIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.quoteID);
            tmpl.toIcon.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPathFromID(this.order.baseID);
        }
    }
    /*
     * setMutableMatchCardElements sets the match card elements which may get
     * updated on each update to the match.
     */
    setMutableMatchCardElements(matchCard, m) {
        if (m.isCancel)
            return;
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(matchCard);
        tmpl.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_2__.matchStatusString(m);
        const tryShowCoin = (pendingEl, coinLink, coin) => {
            if (!coin) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(coinLink);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(pendingEl);
                return;
            }
            coinLink.textContent = (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.formatCoinID)(coin.stringID);
            coinLink.dataset.explorerCoin = coin.stringID;
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.setCoinHref)(coin.assetID, coinLink);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(coinLink);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(pendingEl);
        };
        tryShowCoin(tmpl.makerSwapPending, tmpl.makerSwapCoin, makerSwapCoin(m));
        tryShowCoin(tmpl.takerSwapPending, tmpl.takerSwapCoin, takerSwapCoin(m));
        tryShowCoin(tmpl.makerRedeemPending, tmpl.makerRedeemCoin, makerRedeemCoin(m));
        tryShowCoin(tmpl.takerRedeemPending, tmpl.takerRedeemCoin, takerRedeemCoin(m));
        if (!m.refund) {
            // Special messaging for pending refunds.
            let lockTime = lockTimeMakerMs;
            if (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Taker)
                lockTime = lockTimeTakerMs;
            const refundAfter = new Date(m.stamp + lockTime);
            if (Date.now() > refundAfter.getTime())
                tmpl.refundPending.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_REFUND_IMMINENT);
            else {
                const refundAfterStr = refundAfter.toLocaleTimeString(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages(), {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
                tmpl.refundPending.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_REFUND_WILL_HAPPEN_AFTER, { refundAfterTime: refundAfterStr });
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.refundCoin);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.refundPending);
        }
        else {
            tmpl.refundCoin.textContent = (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.formatCoinID)(m.refund.stringID);
            tmpl.refundCoin.dataset.explorerCoin = m.refund.stringID;
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_8__.setCoinHref)(m.refund.assetID, tmpl.refundCoin);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.refundCoin);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.refundPending);
        }
        if (m.status === _orderutil__WEBPACK_IMPORTED_MODULE_2__.MakerSwapCast && !m.revoked && !m.refund) {
            const c = makerSwapCoin(m);
            tmpl.makerSwapMsg.textContent = confirmationString(c);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.takerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.makerSwapMsg);
        }
        else if (m.status === _orderutil__WEBPACK_IMPORTED_MODULE_2__.TakerSwapCast && !m.revoked && !m.refund) {
            const c = takerSwapCoin(m);
            tmpl.takerSwapMsg.textContent = confirmationString(c);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.takerSwapMsg);
        }
        else if (inConfirmingMakerRedeem(m) && !m.revoked && !m.refund) {
            tmpl.makerRedeemMsg.textContent = confirmationString(m.redeem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.takerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.makerRedeemMsg);
        }
        else if (inConfirmingTakerRedeem(m) && !m.revoked && !m.refund) {
            tmpl.takerRedeemMsg.textContent = confirmationString(m.redeem);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.makerRedeemMsg);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.takerRedeemMsg);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.makerSwapMsg, tmpl.takerSwapMsg, tmpl.makerRedeemMsg, tmpl.takerRedeemMsg);
        }
        if (!m.revoked) {
            // Match is still following the usual success-path, it is desirable for the
            // user to see it in full (even if to learn how atomic swap is supposed to
            // work).
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerSwapCoin(m) || m.active, tmpl.makerSwap);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerSwapCoin(m) || m.active, tmpl.takerSwap);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerRedeemCoin(m) || m.active, tmpl.makerRedeem);
            // When maker isn't aware of taker redeem coin, once the match becomes inactive
            // (nothing else maker is expected to do in this match) just hide taker redeem.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerRedeemCoin(m) || m.active, tmpl.takerRedeem);
            // Refunding isn't a usual part of success-path, but don't rule it out.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(m.refund, tmpl.refund);
        }
        else {
            // Match diverged from the usual success-path, since this could have happened
            // at any step it is hard (maybe impossible) to predict the final state this
            // match will end up in, so show only steps that already happened plus all
            // the possibilities on the next step ahead.
            // If we don't have swap coins after revocation, we won't show the pending message.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerSwapCoin(m), tmpl.makerSwap);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerSwapCoin(m), tmpl.takerSwap);
            const takerRefundsAfter = new Date(m.stamp + lockTimeTakerMs);
            const takerLockTimeExpired = Date.now() > takerRefundsAfter.getTime();
            // When match is revoked and both swaps are present, maker redeem might still show up:
            // - as maker, we'll try to redeem until taker locktime expires (if taker refunds
            //   we won't be able to redeem; even if taker hasn't refunded just yet - it
            //   becomes too dangerous to redeem after taker locktime expired because maker
            //   reveals his secret when redeeming, and taker might be able to submit both
            //   redeem and refund transactions before maker's redeem gets mined), so we'll
            //   have to show redeem pending element until maker redeem shows up, or until
            //   we give up on redeeming due to taker locktime expiry.
            // - as taker, we should expect maker redeeming any time, so we'll have to show
            //   redeem pending element until maker redeem shows up, or until we refund.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(makerRedeemCoin(m) || (takerSwapCoin(m) && m.active && !m.refund && !takerLockTimeExpired), tmpl.makerRedeem);
            // When maker isn't aware of taker redeem coin, once the match becomes inactive
            // (nothing else maker is expected to do in this match) just hide taker redeem.
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(takerRedeemCoin(m) || (makerRedeemCoin(m) && m.active && !m.refund), tmpl.takerRedeem);
            // As taker, show refund placeholder only if we have outstanding swap to refund.
            // There is no need to wait for anything else, we can show refund placeholder
            // (to inform the user that it is likely to happen) right after match revocation.
            let expectingRefund = Boolean(takerSwapCoin(m)); // as taker
            if (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) {
                // As maker, show refund placeholder only if we have outstanding swap to refund.
                // If we don't have taker swap there is no need to wait for anything else, we
                // can show refund placeholder (to inform the user that it is likely to happen)
                // right after match revocation.
                expectingRefund = Boolean(makerSwapCoin(m));
                // If we discover taker swap we'll be trying to redeem it (instead of trying
                // to refund our own swap) until taker refunds, so start showing refund
                // placeholder only after taker is expected to start his refund process in
                // this case.
                if (takerSwapCoin(m)) {
                    expectingRefund = expectingRefund && takerLockTimeExpired;
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(m.refund || (m.active && !m.redeem && !m.counterRedeem && expectingRefund), tmpl.refund);
        }
    }
    /*
     * addNewMatchCard adds a new card to the list of match cards.
     */
    addNewMatchCard(match) {
        const page = this.page;
        const matchCard = page.matchCardTmpl.cloneNode(true);
        (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().bindUrlHandlers(matchCard);
        matchCard.dataset.matchID = match.matchID;
        this.setImmutableMatchCardElements(matchCard, match);
        this.setMutableMatchCardElements(matchCard, match);
        page.matchBox.appendChild(matchCard);
    }
    /*
     * showMatchCards creates cards for each match in the order.
     */
    showMatchCards() {
        const order = this.order;
        if (!order)
            return;
        if (!order.matches)
            return;
        order.matches.sort((a, b) => a.stamp - b.stamp);
        order.matches.forEach((match) => this.addNewMatchCard(match));
    }
    /* showCancel shows a form to confirm submission of a cancel order. */
    showCancel() {
        const order = this.order;
        const page = this.page;
        const remaining = order.qty - order.filled;
        const asset = _orderutil__WEBPACK_IMPORTED_MODULE_2__.isMarketBuy(order) ? (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[order.quoteID] : (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().assets[order.baseID];
        page.cancelRemain.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(remaining, asset.unitInfo);
        page.cancelUnit.textContent = asset.unitInfo.conventional.unit.toUpperCase();
        this.showForm(page.cancelForm);
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            this.currentForm = form;
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.cancelForm, page.accelerateForm);
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0px';
        });
    }
    /* submitCancel submits a cancellation for the order. */
    submitCancel() {
        return __awaiter(this, void 0, void 0, function* () {
            // this will be the page.cancelSubmit button (evt.currentTarget)
            const page = this.page;
            const order = this.order;
            const req = {
                orderID: order.id
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(page.cancelForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/cancel', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().checkResponse(res))
                return;
            page.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CANCELING);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            order.cancelling = true;
        });
    }
    /*
     * setAccelerationButtonVis shows the acceleration button if the order can
     * be accelerated.
     */
    setAccelerationButtonVis() {
        const order = this.order;
        if (!order)
            return;
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis((0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().canAccelerateOrder(order), page.accelerateBttn, page.actionsLabel);
    }
    /* showAccelerateForm shows a form to accelerate an order */
    showAccelerateForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_6__.app)().loading(this.page.accelerateBttn);
            this.accelerateOrderForm.refresh(this.order);
            loaded();
            this.showForm(this.page.accelerateForm);
        });
    }
    /*
     * handleOrderNote is the handler for the 'order'-type notification, which are
     * used to update an order's status.
     */
    handleOrderNote(note) {
        const page = this.page;
        const order = note.order;
        if (order.id !== this.orderID)
            return;
        this.order = order;
        const bttn = page.cancelBttn;
        if (bttn && order.status > _orderutil__WEBPACK_IMPORTED_MODULE_2__.StatusBooked)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(bttn);
        page.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_2__.statusString(order);
        for (const m of order.matches || [])
            this.processMatch(m);
        this.setAccelerationButtonVis();
    }
    /* handleMatchNote handles a 'match' notification. */
    handleMatchNote(note) {
        if (note.orderID !== this.orderID)
            return;
        this.processMatch(note.match);
        this.setAccelerationButtonVis();
    }
    /*
     * processMatch synchronizes a match's card with a match received in a
     * 'order' or 'match' notification.
     */
    processMatch(m) {
        let card = null;
        for (const div of _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(this.page.matchBox, '.match-card')) {
            if (div.dataset.matchID === m.matchID) {
                card = div;
                break;
            }
        }
        if (card) {
            this.setMutableMatchCardElements(card, m);
        }
        else {
            this.addNewMatchCard(m);
        }
    }
}
/*
 * confirmationString is a string describing the state of confirmations for a
 * coin.
 * */
function confirmationString(coin) {
    if (!coin.confs || coin.confs.required === 0)
        return '';
    return `${coin.confs.count} / ${coin.confs.required} ${_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CONFIRMATIONS)}`;
}
// makerSwapCoin return's the maker's swap coin.
function makerSwapCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.swap : m.counterSwap;
}
// takerSwapCoin return's the taker's swap coin.
function takerSwapCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.counterSwap : m.swap;
}
// makerRedeemCoin return's the maker's redeem coin.
function makerRedeemCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.redeem : m.counterRedeem;
}
// takerRedeemCoin return's the taker's redeem coin.
function takerRedeemCoin(m) {
    return (m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker) ? m.counterRedeem : m.redeem;
}
/*
* inConfirmingMakerRedeem will be true if we are the maker, and we are waiting
* on confirmations for our own redeem.
*/
function inConfirmingMakerRedeem(m) {
    return m.status < _orderutil__WEBPACK_IMPORTED_MODULE_2__.MatchConfirmed && m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Maker && m.status >= _orderutil__WEBPACK_IMPORTED_MODULE_2__.MakerRedeemed;
}
/*
* inConfirmingTakerRedeem will be true if we are the taker, and we are waiting
* on confirmations for our own redeem.
*/
function inConfirmingTakerRedeem(m) {
    return m.status < _orderutil__WEBPACK_IMPORTED_MODULE_2__.MatchConfirmed && m.side === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Taker && m.status >= _orderutil__WEBPACK_IMPORTED_MODULE_2__.MatchComplete;
}


/***/ }),

/***/ "./src/js/orderbook.ts":
/*!*****************************!*\
  !*** ./src/js/orderbook.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ OrderBook)
/* harmony export */ });
class OrderBook {
    constructor(mktBook, baseSymbol, quoteSymbol) {
        this.base = mktBook.base;
        this.baseSymbol = baseSymbol;
        this.quote = mktBook.quote;
        this.quoteSymbol = quoteSymbol;
        // Books are sorted mid-gap first.
        this.buys = mktBook.book.buys || [];
        this.sells = mktBook.book.sells || [];
    }
    /* add adds an order to the order book. */
    add(ord) {
        if (ord.qtyAtomic === 0) {
            // TODO: Somebody, for the love of god, figure out why the hell this helps
            // with the ghost orders problem. As far as I know, this order is a booked
            // order that had more than one match in an epoch and completely filled.
            // Because the first match didn't exhaust the order, there would be a
            // 'update_remaining' notification scheduled for the order. But by the
            // time OrderRouter generates the notification long after matching, the
            // order has zero qty left to fill. It's all good though, kinda, because
            // the notification is quickly followed with an 'unbook_order'
            // notification. I have tried my damnedest to catch an update_remaining
            // note without an accompanying unbook_order note, and have thus failed.
            // Yet, this fix somehow seems to work. It's infuriating, tbh.
            window.log('zeroqty', 'zero quantity order encountered', ord);
            return;
        }
        const side = ord.sell ? this.sells : this.buys;
        side.splice(findIdx(side, ord.rate, !ord.sell), 0, ord);
    }
    /* remove removes an order from the order book. */
    remove(token) {
        if (this.removeFromSide(this.sells, token))
            return;
        this.removeFromSide(this.buys, token);
    }
    /* removeFromSide removes an order from the list of orders. */
    removeFromSide(side, token) {
        const [ord, i] = this.findOrder(side, token);
        if (ord) {
            side.splice(i, 1);
            return true;
        }
        return false;
    }
    /* findOrder finds an order in a specified side */
    findOrder(side, token) {
        for (let i = 0; i < side.length; i++) {
            if (side[i].token === token) {
                return [side[i], i];
            }
        }
        return [null, -1];
    }
    /* updates the remaining quantity of an order. */
    updateRemaining(token, qty, qtyAtomic) {
        if (this.updateRemainingSide(this.sells, token, qty, qtyAtomic))
            return;
        this.updateRemainingSide(this.buys, token, qty, qtyAtomic);
    }
    /*
     * updateRemainingSide looks for the order in the side and updates the
     * quantity, returning true on success, false if order not found.
     */
    updateRemainingSide(side, token, qty, qtyAtomic) {
        const ord = this.findOrder(side, token)[0];
        if (ord) {
            ord.qty = qty;
            ord.qtyAtomic = qtyAtomic;
            return true;
        }
        return false;
    }
    /*
     * setEpoch sets the current epoch and clear any orders from previous epochs.
     */
    setEpoch(epochIdx) {
        const approve = (ord) => ord.epoch === undefined || ord.epoch === 0 || ord.epoch === epochIdx;
        this.sells = this.sells.filter(approve);
        this.buys = this.buys.filter(approve);
    }
    /* empty will return true if both the buys and sells lists are empty. */
    empty() {
        return !this.sells.length && !this.buys.length;
    }
    /* count is the total count of both buy and sell orders. */
    count() {
        return this.sells.length + this.buys.length;
    }
    /* bestGapOrder will return the best non-epoch order if one exists, or the
     * best epoch order if there are only epoch orders, or null if there are no
     * orders.
     */
    bestGapOrder(side) {
        let best = null;
        for (const ord of side) {
            if (!ord.epoch)
                return ord;
            if (!best) {
                best = ord;
            }
        }
        return best;
    }
    bestGapBuy() {
        return this.bestGapOrder(this.buys);
    }
    bestGapSell() {
        return this.bestGapOrder(this.sells);
    }
}
/*
 * findIdx find the index at which to insert the order into the list of orders.
 */
function findIdx(side, rate, less) {
    for (let i = 0; i < side.length; i++) {
        if ((side[i].rate < rate) === less)
            return i;
    }
    return side.length;
}


/***/ }),

/***/ "./src/js/orders.ts":
/*!**************************!*\
  !*** ./src/js/orders.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ OrdersPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};






const orderBatchSize = 50;
const animationLength = 500;
class OrdersPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(main) {
        super();
        this.main = main;
        // if offset is '', there are no more orders available to auto-load for
        // never-ending scrolling.
        this.offset = '';
        this.loading = false;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(main);
        this.orderTmpl = page.rowTmpl;
        this.orderTmpl.remove();
        // filterState will store arrays of strings. The assets and statuses
        // sub-filters will need to be converted to ints for JSON encoding.
        const filterState = this.filterState = {
            hosts: [],
            assets: [],
            statuses: []
        };
        const search = new URLSearchParams(window.location.search);
        const readFilter = (form, filterKey) => {
            const v = search.get(filterKey);
            if (!v || v.length === 0)
                return;
            const subFilter = v.split(',');
            if (v) {
                filterState[filterKey] = subFilter; // Kinda janky
            }
            form.querySelectorAll('input').forEach(bttn => {
                if (subFilter.indexOf(bttn.value) >= 0)
                    bttn.checked = true;
            });
        };
        readFilter(page.hostFilter, 'hosts');
        readFilter(page.assetFilter, 'assets');
        readFilter(page.statusFilter, 'statuses');
        const applyButtons = [];
        const monitorFilter = (form, filterKey) => {
            const applyBttn = form.querySelector('.apply-bttn');
            applyButtons.push(applyBttn);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(applyBttn, 'click', () => {
                this.submitFilter();
                applyButtons.forEach(bttn => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(bttn));
            });
            form.querySelectorAll('input').forEach(bttn => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(bttn, 'change', () => {
                    const subFilter = parseSubFilter(form);
                    if (compareSubFilter(subFilter, filterState[filterKey])) {
                        // Same as currently loaded. Hide the apply button.
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(applyBttn);
                    }
                    else {
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(applyBttn);
                    }
                });
            });
        };
        monitorFilter(page.hostFilter, 'hosts');
        monitorFilter(page.assetFilter, 'assets');
        monitorFilter(page.statusFilter, 'statuses');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(this.main, 'scroll', () => {
            if (this.loading)
                return;
            const belowBottom = page.ordersTable.offsetHeight - this.main.offsetHeight - this.main.scrollTop;
            if (belowBottom < 0) {
                this.nextPage();
            }
        });
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            });
        });
        // If the user clicks outside of a form, it should close the page overlay.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            }
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportOrders, 'click', () => {
            this.exportOrders();
        });
        page.showArchivedDateField.addEventListener('change', () => {
            if (page.showArchivedDateField.checked)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.archivedDateField);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.archivedDateField, page.deleteArchivedRecordsErr);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.deleteArchivedRecords, 'click', () => {
            const page = this.page;
            page.showArchivedDateField.checked = false;
            page.saveMatchesToFile.checked = false;
            page.saveOrdersToFile.checked = false;
            page.deleteArchivedRecordsErr.textContent = '';
            page.archivedRecordsLocation.textContent = '';
            page.deleteArchivedRecordsMsg.textContent = '';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.deleteArchivedResult, page.deleteArchivedRecordsErr, page.deleteArchivedRecordsMsg, page.archivedRecordsLocation, page.archivedDateField);
            this.showForm(page.deleteArchivedRecordsForm);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.deleteArchivedRecordsSubmit, 'click', () => {
            let date = 0;
            if (page.showArchivedDateField.checked) {
                date = Date.parse(page.olderThan.value || '');
                if (isNaN(date) || date <= 0) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.deleteArchivedRecordsErr, _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_INVALID_DATE_ERR_MSG));
                    return;
                }
            }
            this.deleteArchivedRecords(date);
        });
        this.submitFilter();
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            this.currentForm = form;
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.deleteArchivedRecordsForm);
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0px';
        });
    }
    /* setOrders empties the order table and appends the specified orders. */
    setOrders(orders) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(this.page.tableBody);
        this.appendOrders(orders);
    }
    /* appendOrders appends orders to the orders table. */
    appendOrders(orders) {
        const tbody = this.page.tableBody;
        for (const ord of orders) {
            const tr = this.orderTmpl.cloneNode(true);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            let fromSymbol, toSymbol, fromUnit, toUnit, fromQty;
            let toQty = '';
            const xc = (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().exchanges[ord.host] || undefined;
            if ((!(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().assets[ord.baseID] && !xc.assets[ord.baseID]) || (!(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().assets[ord.quoteID] && !xc.assets[ord.quoteID]))
                continue;
            const [baseUnitInfo, quoteUnitInfo] = [(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().unitInfo(ord.baseID, xc), (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().unitInfo(ord.quoteID, xc)];
            if (ord.sell) {
                [fromSymbol, toSymbol] = [ord.baseSymbol, ord.quoteSymbol];
                [fromUnit, toUnit] = [baseUnitInfo.conventional.unit, quoteUnitInfo.conventional.unit];
                fromQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Limit) {
                    toQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_2__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                }
            }
            else {
                [fromSymbol, toSymbol] = [ord.quoteSymbol, ord.baseSymbol];
                [fromUnit, toUnit] = [quoteUnitInfo.conventional.unit, baseUnitInfo.conventional.unit];
                if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Market) {
                    fromQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                }
                else {
                    fromQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_2__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                    toQty = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                }
            }
            const mktID = `${baseUnitInfo.conventional.unit}-${quoteUnitInfo.conventional.unit}`;
            tmpl.host.textContent = `${mktID} @ ${ord.host}`;
            tmpl.fromQty.textContent = fromQty;
            tmpl.fromLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(fromSymbol);
            tmpl.fromSymbol.textContent = fromUnit;
            tmpl.toQty.textContent = toQty;
            tmpl.toLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(toSymbol);
            tmpl.toSymbol.textContent = toUnit;
            tmpl.type.textContent = `${_orderutil__WEBPACK_IMPORTED_MODULE_2__.typeString(ord)} ${_orderutil__WEBPACK_IMPORTED_MODULE_2__.sellString(ord)}`;
            let rate = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue((0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().conventionalRate(ord.baseID, ord.quoteID, ord.rate, xc));
            if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_2__.Market)
                rate = _orderutil__WEBPACK_IMPORTED_MODULE_2__.averageMarketOrderRateString(ord);
            tmpl.rate.textContent = rate;
            tmpl.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_2__.statusString(ord);
            tmpl.filled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_2__.filled(ord) / ord.qty * 100).toFixed(1)}%`;
            tmpl.settled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_2__.settled(ord) / ord.qty * 100).toFixed(1)}%`;
            const dateTime = new Date(ord.submitTime).toLocaleString();
            tmpl.timeAgo.textContent = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(ord.submitTime)} ago`;
            tmpl.time.textContent = dateTime;
            const link = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(tr, 'link');
            link.href = `order/${ord.id}`;
            (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().bindInternalNavigation(tr);
            tbody.appendChild(tr);
        }
        if (orders.length === orderBatchSize) {
            this.offset = orders[orders.length - 1].id;
        }
        else {
            this.offset = '';
        }
    }
    /* submitFilter submits the current filter and reloads the order table. */
    submitFilter() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.offset = '';
            const filterState = this.filterState;
            filterState.hosts = parseSubFilter(page.hostFilter);
            filterState.assets = parseSubFilter(page.assetFilter).map((s) => parseInt(s));
            filterState.statuses = parseSubFilter(page.statusFilter).map((s) => parseInt(s));
            this.setOrders(yield this.fetchOrders());
        });
    }
    /* fetchOrders fetches orders using the current filter. */
    fetchOrders() {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().loading(this.main);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/orders', this.currentFilter());
            loaded();
            return res.orders;
        });
    }
    /* exportOrders downloads a csv of the user's orders based on the current filter. */
    exportOrders() {
        this.offset = '';
        const filterState = this.currentFilter();
        const url = new URL(window.location.href);
        const search = new URLSearchParams('');
        const setQuery = (k) => {
            const subFilter = filterState[k];
            subFilter.forEach((v) => {
                search.append(k, v);
            });
        };
        setQuery('hosts');
        setQuery('assets');
        setQuery('statuses');
        url.search = search.toString();
        url.pathname = '/orders/export';
        window.open(url.toString());
    }
    /* deleteArchivedRecords removes the user's archived orders and matches
     * created before user specified date time in millisecond. Deleted archived
     * records are saved to a CSV file if the user specify so.
     */
    deleteArchivedRecords(olderThanMs) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const saveMatchesToFIle = page.saveMatchesToFile.checked || false;
            const saveOrdersToFile = page.saveOrdersToFile.checked || false;
            const reqBody = {
                olderThanMs: olderThanMs,
                saveMatchesToFile: saveMatchesToFIle,
                saveOrdersToFile: saveOrdersToFile
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().loading(this.main);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_4__.postJSON)('/api/deletearchivedrecords', reqBody);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_5__.app)().checkResponse(res)) {
                return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.deleteArchivedRecordsErr, res.msg);
            }
            if (res.archivedRecordsDeleted > 0) {
                page.deleteArchivedRecordsMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_DELETE_ARCHIVED_RECORDS_RESULT, { nRecords: res.archivedRecordsDeleted });
                if (saveMatchesToFIle || saveOrdersToFile) {
                    page.archivedRecordsLocation.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_ARCHIVED_RECORDS_PATH, { path: res.archivedRecordsPath });
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.archivedRecordsLocation);
                }
                // Update the order page.
                this.submitFilter();
            }
            else {
                page.deleteArchivedRecordsMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_3__.prep(_locales__WEBPACK_IMPORTED_MODULE_3__.ID_NO_ARCHIVED_RECORDS);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.deleteArchivedResult, page.deleteArchivedRecordsMsg);
        });
    }
    /*
     * currentFilter converts the local filter type (which is all strings) to the
     * server's filter type.
     */
    currentFilter() {
        var _a, _b;
        const filterState = this.filterState;
        return {
            hosts: filterState.hosts,
            assets: (_a = filterState.assets) === null || _a === void 0 ? void 0 : _a.map((s) => parseInt(s)),
            statuses: (_b = filterState.statuses) === null || _b === void 0 ? void 0 : _b.map((s) => parseInt(s)),
            n: orderBatchSize,
            offset: this.offset
        };
    }
    /*
     * nextPage resubmits the filter with the offset set to the last loaded order.
     */
    nextPage() {
        return __awaiter(this, void 0, void 0, function* () {
            if (this.offset === '' || this.loading)
                return;
            this.loading = true;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.orderLoader);
            const orders = yield this.fetchOrders();
            this.loading = false;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.orderLoader);
            this.appendOrders(orders);
        });
    }
}
/*
 * parseSubFilter parses a bool-map from the checkbox inputs in the specified
 * ancestor element.
 */
function parseSubFilter(form) {
    const entries = [];
    form.querySelectorAll('input').forEach(box => {
        if (box.checked)
            entries.push(box.value);
    });
    return entries;
}
/* compareSubFilter compares the two filter arrays for unordered equivalence. */
function compareSubFilter(filter1, filter2) {
    if (filter1.length !== filter2.length)
        return false;
    for (const entry of filter1) {
        if (filter2.indexOf(entry) === -1)
            return false;
    }
    return true;
}


/***/ }),

/***/ "./src/js/orderutil.ts":
/*!*****************************!*\
  !*** ./src/js/orderutil.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Cancel": () => (/* binding */ Cancel),
/* harmony export */   "ImmediateTiF": () => (/* binding */ ImmediateTiF),
/* harmony export */   "Limit": () => (/* binding */ Limit),
/* harmony export */   "Maker": () => (/* binding */ Maker),
/* harmony export */   "MakerRedeemed": () => (/* binding */ MakerRedeemed),
/* harmony export */   "MakerSwapCast": () => (/* binding */ MakerSwapCast),
/* harmony export */   "Market": () => (/* binding */ Market),
/* harmony export */   "MatchComplete": () => (/* binding */ MatchComplete),
/* harmony export */   "MatchConfirmed": () => (/* binding */ MatchConfirmed),
/* harmony export */   "MatchSideMaker": () => (/* binding */ MatchSideMaker),
/* harmony export */   "MatchSideTaker": () => (/* binding */ MatchSideTaker),
/* harmony export */   "NewlyMatched": () => (/* binding */ NewlyMatched),
/* harmony export */   "OrderTypeCancel": () => (/* binding */ OrderTypeCancel),
/* harmony export */   "OrderTypeLimit": () => (/* binding */ OrderTypeLimit),
/* harmony export */   "OrderTypeMarket": () => (/* binding */ OrderTypeMarket),
/* harmony export */   "RateEncodingFactor": () => (/* binding */ RateEncodingFactor),
/* harmony export */   "StandingTiF": () => (/* binding */ StandingTiF),
/* harmony export */   "StatusBooked": () => (/* binding */ StatusBooked),
/* harmony export */   "StatusCanceled": () => (/* binding */ StatusCanceled),
/* harmony export */   "StatusEpoch": () => (/* binding */ StatusEpoch),
/* harmony export */   "StatusExecuted": () => (/* binding */ StatusExecuted),
/* harmony export */   "StatusRevoked": () => (/* binding */ StatusRevoked),
/* harmony export */   "StatusUnknown": () => (/* binding */ StatusUnknown),
/* harmony export */   "Taker": () => (/* binding */ Taker),
/* harmony export */   "TakerSwapCast": () => (/* binding */ TakerSwapCast),
/* harmony export */   "averageMarketOrderRateString": () => (/* binding */ averageMarketOrderRateString),
/* harmony export */   "averageRate": () => (/* binding */ averageRate),
/* harmony export */   "baseToQuote": () => (/* binding */ baseToQuote),
/* harmony export */   "filled": () => (/* binding */ filled),
/* harmony export */   "hasActiveMatches": () => (/* binding */ hasActiveMatches),
/* harmony export */   "isCancellable": () => (/* binding */ isCancellable),
/* harmony export */   "isMarketBuy": () => (/* binding */ isMarketBuy),
/* harmony export */   "matchStatusString": () => (/* binding */ matchStatusString),
/* harmony export */   "optionElement": () => (/* binding */ optionElement),
/* harmony export */   "orderPortion": () => (/* binding */ orderPortion),
/* harmony export */   "sellString": () => (/* binding */ sellString),
/* harmony export */   "settled": () => (/* binding */ settled),
/* harmony export */   "statusString": () => (/* binding */ statusString),
/* harmony export */   "typeString": () => (/* binding */ typeString)
/* harmony export */ });
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _opts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./opts */ "./src/js/opts.ts");
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");




const Limit = 1; // TODO: Delete for the versions below
const Market = 2; // TODO: Delete for the versions below
const Cancel = 3; // TODO: Delete for the versions below
const OrderTypeLimit = 1;
const OrderTypeMarket = 2;
const OrderTypeCancel = 3;
/* The time-in-force specifiers are a mirror of dex/order.TimeInForce. */
const ImmediateTiF = 0;
const StandingTiF = 1;
/* The order statuses are a mirror of dex/order.OrderStatus. */
const StatusUnknown = 0;
const StatusEpoch = 1;
const StatusBooked = 2;
const StatusExecuted = 3;
const StatusCanceled = 4;
const StatusRevoked = 5;
/* The match statuses are a mirror of dex/order.MatchStatus. */
const NewlyMatched = 0;
const MakerSwapCast = 1;
const TakerSwapCast = 2;
const MakerRedeemed = 3;
const MatchComplete = 4;
const MatchConfirmed = 5;
/* The match sides are a mirror of dex/order.MatchSide. */
const Maker = 0; // TODO: Delete for the versions below
const Taker = 1; // TODO: Delete for the versions below
const MatchSideMaker = 0;
const MatchSideTaker = 1;
/*
 * RateEncodingFactor is used when encoding an atomic exchange rate as an
 * integer. See docs on message-rate encoding @
 * https://github.com/decred/dcrdex/blob/master/spec/comm.mediawiki#Rate_Encoding
 */
const RateEncodingFactor = 1e8;
function sellString(ord) {
    const key = ord.sell ? _locales__WEBPACK_IMPORTED_MODULE_0__.ID_SELL : _locales__WEBPACK_IMPORTED_MODULE_0__.ID_BUY;
    const lang = document.documentElement.lang.toLowerCase();
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(key).toLocaleLowerCase(lang);
}
function typeString(ord) {
    return ord.type === Limit ? (ord.tif === ImmediateTiF ? _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_LIMIT_ORDER_IMMEDIATE_TIF) : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_LIMIT_ORDER)) : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MARKET_ORDER);
}
/* isMarketBuy will return true if the order is a market buy order. */
function isMarketBuy(ord) {
    return ord.type === Market && !ord.sell;
}
/*
 * hasActiveMatches returns true if the order has matches that have not completed
 * settlement yet.
 */
function hasActiveMatches(order) {
    if (!order.matches)
        return false;
    for (const match of order.matches) {
        if (match.active)
            return true;
    }
    return false;
}
/**
 * statusString converts the order status to a string.
 *
 * IMPORTANT: we have similar function in Golang, it must match this one exactly,
 * when updating make sure to update both!
 */
function statusString(order) {
    if (!order.id)
        return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_ORDER_SUBMITTING); // order ID is empty.
    const isLive = hasActiveMatches(order);
    switch (order.status) {
        case StatusUnknown: return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNKNOWN);
        case StatusEpoch: return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_EPOCH);
        case StatusBooked:
            if (order.cancelling)
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_CANCELING);
            return isLive ? `${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BOOKED)}/${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING)}` : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_BOOKED);
        case StatusExecuted:
            if (isLive)
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING);
            if (order.filled === 0 && order.type !== Cancel)
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_NO_MATCH);
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_EXECUTED);
        case StatusCanceled:
            return isLive ? `${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_CANCELED)}/${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING)}` : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_CANCELED);
        case StatusRevoked:
            return isLive ? `${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_REVOKED)}/${_locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_SETTLING)}` : _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_REVOKED);
    }
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNKNOWN);
}
/* filled sums the quantities of non-cancel matches available. */
function filled(order) {
    if (!order.matches)
        return 0;
    const qty = isMarketBuy(order) ? (m) => m.qty * m.rate / RateEncodingFactor : (m) => m.qty;
    return order.matches.reduce((filled, match) => {
        if (match.isCancel)
            return filled;
        return filled + qty(match);
    }, 0);
}
/* settled sums the quantities of the matches that have completed. */
function settled(order) {
    if (!order.matches)
        return 0;
    const qty = isMarketBuy(order) ? (m) => m.qty * m.rate / RateEncodingFactor : (m) => m.qty;
    return order.matches.reduce((settled, match) => {
        if (match.isCancel)
            return settled;
        const redeemed = (match.side === Maker && match.status >= MakerRedeemed) ||
            (match.side === Taker && match.status >= MatchComplete);
        return redeemed ? settled + qty(match) : settled;
    }, 0);
}
/* averageRateString returns a formatting string containing the average rate of
the matches that have been filled for a market order. */
function averageMarketOrderRateString(ord) {
    var _a;
    if (!((_a = ord.matches) === null || _a === void 0 ? void 0 : _a.length))
        return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MARKET_ORDER);
    let rateStr = _doc__WEBPACK_IMPORTED_MODULE_3__["default"].formatCoinValue((0,_registry__WEBPACK_IMPORTED_MODULE_1__.app)().conventionalRate(ord.baseID, ord.quoteID, averageRate(ord)));
    if (ord.matches.length > 1)
        rateStr = '~ ' + rateStr; // "~" only makes sense if the order has more than one match.
    return rateStr;
}
/* averageRate returns a the average rate of the matches that have been filled
in an order. */
function averageRate(ord) {
    var _a;
    if (!((_a = ord.matches) === null || _a === void 0 ? void 0 : _a.length))
        return 0;
    let rateProduct = 0;
    let baseQty = 0;
    for (const m of ord.matches) {
        baseQty += m.qty;
        rateProduct += (m.rate * m.qty); // order ~ 1e16
    }
    return rateProduct / baseQty;
}
/* baseToQuote returns the quantity of the quote asset. */
function baseToQuote(rate, base) {
    return rate * base / RateEncodingFactor;
}
/* orderPortion returns a string stating the percentage of the order a match
   makes up. */
function orderPortion(order, match) {
    let matchQty = match.qty;
    if (isMarketBuy(order)) {
        matchQty = baseToQuote(match.rate, match.qty);
    }
    return ((matchQty / order.qty) * 100).toFixed(1) + ' %';
}
/*
 * matchStatusString is a string used to create a displayable string describing
 * describing the match status.
 */
function matchStatusString(m) {
    if (m.revoked) {
        // When revoked, match status is less important than pending action if still
        // active, or the outcome if inactive.
        if (m.active) {
            if (m.redeem)
                return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_SENT); // must require confirmation if active
            // If maker and we have not redeemed, waiting to refund, assuming it's not
            // revoked while waiting for confs on an unspent/unexpired taker swap.
            if (m.side === Maker)
                return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REFUND_PENDING);
            // As taker, resolution depends on maker's actions while waiting to refund.
            if (m.counterRedeem)
                return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEEM_PENDING); // this should be very brief if we see the maker's redeem
            return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REFUND_PENDING); // may switch to redeem if maker redeems on the sly
        }
        if (m.refund) {
            return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REFUNDED);
        }
        if (m.redeem) {
            return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_CONFIRMED);
        }
        return revokedMatchStatus(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_COMPLETE); // i.e. we sent no swap
    }
    switch (m.status) {
        case NewlyMatched:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_NEWLY_MATCHED);
        case MakerSwapCast:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_MAKER_SWAP_CAST);
        case TakerSwapCast:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_TAKER_SWAP_CAST);
        case MakerRedeemed:
            if (m.side === Maker) {
                return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_SENT);
            }
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_MAKER_REDEEMED);
        case MatchComplete:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_SENT);
        case MatchConfirmed:
            return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REDEMPTION_CONFIRMED);
    }
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_UNKNOWN);
}
// revokedMatchStatus is a helper function that returns the revoked match status
// string.
function revokedMatchStatus(matchStatus) {
    return _locales__WEBPACK_IMPORTED_MODULE_0__.prep(_locales__WEBPACK_IMPORTED_MODULE_0__.ID_MATCH_STATUS_REVOKED, { status: _locales__WEBPACK_IMPORTED_MODULE_0__.prep(matchStatus) });
}
/*
 * optionElement is a getter for an element matching the *OrderOption from
 * client/asset. change is a function with no arguments that is called when the
 * returned option's value has changed.
 */
function optionElement(opt, order, change, isSwap) {
    const isBaseChain = (isSwap && order.sell) || (!isSwap && !order.sell);
    const symbol = isBaseChain ? dexAssetSymbol(order.host, order.base) : dexAssetSymbol(order.host, order.quote);
    switch (true) {
        case !!opt.boolean:
            return new _opts__WEBPACK_IMPORTED_MODULE_2__.BooleanOption(opt, symbol, order.options, change).node;
        case !!opt.xyRange:
            return new _opts__WEBPACK_IMPORTED_MODULE_2__.XYRangeOption(opt, symbol, order.options, change).node;
        default:
            console.error('no option type specified', opt);
    }
    console.error('unknown option type', opt);
    return document.createElement('div');
}
function dexAssetSymbol(host, assetID) {
    return (0,_registry__WEBPACK_IMPORTED_MODULE_1__.app)().exchanges[host].assets[assetID].symbol;
}
function isCancellable(ord) {
    return ord.type === Limit && ord.tif === StandingTiF && ord.status < StatusExecuted;
}


/***/ }),

/***/ "./src/js/register.ts":
/*!****************************!*\
  !*** ./src/js/register.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ RegistrationPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};





class RegistrationPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body, data) {
        super();
        this.body = body;
        this.data = data;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        if (data.host && page.dexAddrForm.classList.contains('selected')) {
            page.dexAddrForm.classList.remove('selected');
            page.discoverAcctForm.classList.add('selected');
            page.discoverAcctForm.dataset.host = data.host;
        }
        // Hide the form closers for the registration process except for the
        // password reset form closer.
        for (const el of body.querySelectorAll('.form-closer'))
            if (el !== page.resetPassFormCloser)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(el);
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.NewWalletForm(page.newWalletForm, assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier), () => this.animateRegAsset(page.newWalletForm));
        // ADD DEX
        this.dexAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DEXAddressForm(page.dexAddrForm, (xc, certFile) => __awaiter(this, void 0, void 0, function* () {
            this.requestFeepayment(page.dexAddrForm, xc, certFile);
        }));
        const addr = page.discoverAcctForm.dataset.host;
        if (addr) {
            this.discoverAcctForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DiscoverAccountForm(page.discoverAcctForm, addr, (xc) => __awaiter(this, void 0, void 0, function* () {
                this.requestFeepayment(page.discoverAcctForm, xc, '');
            }));
        }
        // SELECT REG ASSET
        this.regAssetForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.FeeAssetSelectionForm(page.regAssetForm, (assetID, tier) => __awaiter(this, void 0, void 0, function* () {
            if (assetID === _registry__WEBPACK_IMPORTED_MODULE_4__.PrepaidBondID) {
                this.registerDEXSuccess();
                return;
            }
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().assets[assetID];
            const wallet = asset.wallet;
            if (wallet) {
                const bondAsset = this.xc.bondAssets[asset.symbol];
                const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.regAssetForm);
                this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
                if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + bondsFeeBuffer) {
                    this.animateConfirmForm(page.regAssetForm);
                    return;
                }
                this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
                (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.regAssetForm, page.walletWait);
                return;
            }
            this.confirmRegisterForm.tier = tier;
            this.newWalletForm.setAsset(assetID);
            (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.regAssetForm, page.newWalletForm);
        }));
        this.walletWaitForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.WalletWaitForm(page.walletWait, () => {
            this.animateConfirmForm(page.walletWait);
        }, () => { this.animateRegAsset(page.walletWait); });
        // SUBMIT DEX REGISTRATION
        this.confirmRegisterForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.ConfirmRegistrationForm(page.confirmRegForm, () => {
            this.registerDEXSuccess();
        }, () => {
            this.animateRegAsset(page.confirmRegForm);
        });
        const currentForm = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].safeSelector(page.forms, ':scope > form.selected');
        currentForm.classList.remove('selected');
        switch (currentForm) {
            case page.dexAddrForm:
                this.dexAddrForm.animate();
                break;
            case page.discoverAcctForm:
                this.discoverAcctForm.animate();
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(currentForm);
        // There's nothing on the page.discoverAcctForm except to receive user pass
        // before attempting to discover user account and there's no need to have
        // them click another button when we can carry on without user interaction.
        if (currentForm === page.discoverAcctForm) {
            this.discoverAcctForm.page.submit.click();
        }
        if ((0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().authed)
            this.auth();
    }
    // auth should be called once user is known to be authed with the server.
    auth() {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().fetchUser();
        });
    }
    requestFeepayment(oldForm, xc, certFile) {
        return __awaiter(this, void 0, void 0, function* () {
            this.xc = xc;
            this.confirmRegisterForm.setExchange(xc, certFile);
            this.walletWaitForm.setExchange(xc);
            this.regAssetForm.setExchange(xc, certFile);
            this.animateRegAsset(oldForm);
        });
    }
    /* Swap in the asset selection form and run the animation. */
    animateRegAsset(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            this.regAssetForm.animate();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.regAssetForm);
        });
    }
    /* Swap in the confirmation form and run the animation. */
    animateConfirmForm(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            this.confirmRegisterForm.animate();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.confirmRegForm);
        });
    }
    // Retrieve an estimate for the tx fee needed to create new bond reserves.
    getBondsFeeBuffer(assetID, form) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/bondsfeebuffer', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().checkResponse(res)) {
                return 0;
            }
            return res.feeBuffer;
        });
    }
    /* gets the contents of the cert file */
    getCertFile() {
        return __awaiter(this, void 0, void 0, function* () {
            let cert = '';
            if (this.dexAddrForm.page.certFile.value) {
                const files = this.dexAddrForm.page.certFile.files;
                if (files && files.length)
                    cert = yield files[0].text();
            }
            return cert;
        });
    }
    /* Called after successful registration to a DEX. */
    registerDEXSuccess() {
        return __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().fetchUser();
            (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().updateMenuItemsDisplay();
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().loadPage(this.data.backTo || 'markets');
        });
    }
    newWalletCreated(assetID, tier) {
        return __awaiter(this, void 0, void 0, function* () {
            this.regAssetForm.refresh();
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_4__.app)().fetchUser();
            if (!user)
                return;
            const page = this.page;
            const asset = user.assets[assetID];
            const wallet = asset.wallet;
            const bondAmt = this.xc.bondAssets[asset.symbol].amount;
            const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.newWalletForm);
            this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
            this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
            if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {
                yield this.animateConfirmForm(page.newWalletForm);
                return;
            }
            yield (0,_forms__WEBPACK_IMPORTED_MODULE_3__.slideSwap)(page.newWalletForm, page.walletWait);
        });
    }
}


/***/ }),

/***/ "./src/js/registry.ts":
/*!****************************!*\
  !*** ./src/js/registry.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ApprovalStatus": () => (/* binding */ ApprovalStatus),
/* harmony export */   "ConnectionStatus": () => (/* binding */ ConnectionStatus),
/* harmony export */   "PeerSource": () => (/* binding */ PeerSource),
/* harmony export */   "PrepaidBondID": () => (/* binding */ PrepaidBondID),
/* harmony export */   "app": () => (/* binding */ app),
/* harmony export */   "registerApplication": () => (/* binding */ registerApplication)
/* harmony export */ });
var ConnectionStatus;
(function (ConnectionStatus) {
    ConnectionStatus[ConnectionStatus["Disconnected"] = 0] = "Disconnected";
    ConnectionStatus[ConnectionStatus["Connected"] = 1] = "Connected";
    ConnectionStatus[ConnectionStatus["InvalidCert"] = 2] = "InvalidCert";
})(ConnectionStatus || (ConnectionStatus = {}));
var ApprovalStatus;
(function (ApprovalStatus) {
    ApprovalStatus[ApprovalStatus["Approved"] = 0] = "Approved";
    ApprovalStatus[ApprovalStatus["Pending"] = 1] = "Pending";
    ApprovalStatus[ApprovalStatus["NotApproved"] = 2] = "NotApproved";
})(ApprovalStatus || (ApprovalStatus = {}));
// changing the order of the elements in this enum will affect
// the sorting of the peers table in wallets.ts.
var PeerSource;
(function (PeerSource) {
    PeerSource[PeerSource["WalletDefault"] = 0] = "WalletDefault";
    PeerSource[PeerSource["UserAdded"] = 1] = "UserAdded";
    PeerSource[PeerSource["Discovered"] = 2] = "Discovered";
})(PeerSource || (PeerSource = {}));
const PrepaidBondID = 2147483647;
// TODO: Define an interface for Application?
let application;
function registerApplication(a) {
    application = a;
}
function app() {
    return application;
}


/***/ }),

/***/ "./src/js/settings.ts":
/*!****************************!*\
  !*** ./src/js/settings.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ SettingsPage)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
/* harmony import */ var _notifications__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./notifications */ "./src/js/notifications.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __rest = (undefined && undefined.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};









const animationLength = 300;
class SettingsPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body) {
        super();
        this.body = body;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.forms = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, ':scope > form');
        this.fiatRateSources = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.fiatRateSources, 'input[type=checkbox]');
        page.darkMode.checked = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].darkModeLK) === '1';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.darkMode, 'click', () => {
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].darkModeLK, page.darkMode.checked || false ? '1' : '0');
            if (page.darkMode.checked) {
                document.body.classList.add('dark');
            }
            else {
                document.body.classList.remove('dark');
            }
        });
        page.showPokes.checked = _state__WEBPACK_IMPORTED_MODULE_2__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].popupsLK) === '1';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showPokes, 'click', () => {
            const show = page.showPokes.checked || false;
            _state__WEBPACK_IMPORTED_MODULE_2__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_2__["default"].popupsLK, show ? '1' : '0');
            (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().showPopups = show;
        });
        page.commitHash.textContent = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().commitHash.substring(0, 7);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addADex, 'click', () => {
            this.dexAddrForm.refresh();
            this.showForm(page.dexAddrForm);
        });
        this.fiatRateSources.forEach(src => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(src, 'change', () => __awaiter(this, void 0, void 0, function* () {
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/toggleratesource', {
                    disable: !src.checked,
                    source: src.value
                });
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                    src.checked = !src.checked;
                }
                // Update asset rate values and disable conversion status.
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
            }));
        });
        // Asset selection
        this.regAssetForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.FeeAssetSelectionForm(page.regAssetForm, (assetID, tier) => __awaiter(this, void 0, void 0, function* () {
            if (assetID === _registry__WEBPACK_IMPORTED_MODULE_8__.PrepaidBondID) {
                yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
                window.location.reload();
                return;
            }
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().assets[assetID];
            const wallet = asset.wallet;
            if (wallet) {
                const bondAsset = this.currentDEX.bondAssets[asset.symbol];
                const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.regAssetForm);
                this.confirmRegisterForm.setAsset(assetID, tier, bondsFeeBuffer);
                if (wallet.synced && wallet.balance.available >= 2 * bondAsset.amount + bondsFeeBuffer) {
                    this.animateConfirmForm(page.regAssetForm);
                    return;
                }
                this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
                this.slideSwap(page.walletWait);
                return;
            }
            this.confirmRegisterForm.setAsset(assetID, tier, 0);
            this.newWalletForm.setAsset(assetID);
            this.slideSwap(page.newWalletForm);
        }));
        // Approve fee payment
        this.confirmRegisterForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.ConfirmRegistrationForm(page.confirmRegForm, () => {
            this.registerDEXSuccess();
        }, () => {
            this.animateRegAsset(page.confirmRegForm);
        });
        // Create a new wallet
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.NewWalletForm(page.newWalletForm, assetID => this.newWalletCreated(assetID, this.confirmRegisterForm.tier), () => this.animateRegAsset(page.newWalletForm));
        this.walletWaitForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.WalletWaitForm(page.walletWait, () => {
            this.animateConfirmForm(page.walletWait);
        }, () => { this.animateRegAsset(page.walletWait); });
        // Enter an address for a new DEX
        this.dexAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.DEXAddressForm(page.dexAddrForm, (xc, certFile) => __awaiter(this, void 0, void 0, function* () {
            this.currentDEX = xc;
            this.confirmRegisterForm.setExchange(xc, certFile);
            this.walletWaitForm.setExchange(xc);
            this.regAssetForm.setExchange(xc, certFile);
            this.animateRegAsset(page.dexAddrForm);
        }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.importAccount, 'click', () => this.prepareAccountImport(page.authorizeAccountImportForm));
        _forms__WEBPACK_IMPORTED_MODULE_4__.bind(page.authorizeAccountImportForm, page.authorizeImportAccountConfirm, () => this.importAccount());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.changeAppPW, 'click', () => this.showForm(page.changeAppPWForm));
        _forms__WEBPACK_IMPORTED_MODULE_4__.bind(page.changeAppPWForm, page.submitNewPW, () => this.changeAppPW());
        this.appPassResetForm = new _forms__WEBPACK_IMPORTED_MODULE_4__.AppPassResetForm(page.resetAppPWForm, () => __awaiter(this, void 0, void 0, function* () {
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loadPage('login');
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
        }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.resetAppPW, 'click', () => {
            this.appPassResetForm.refresh();
            this.showForm(page.resetAppPWForm);
            this.appPassResetForm.focus();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.accountFile, 'change', () => this.onAccountFileChange());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.removeAccount, 'click', () => this.clearAccountFile());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addAccount, 'click', () => page.accountFile.click());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportSeed, 'click', () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.exportSeedErr);
            this.showForm(page.exportSeedAuth);
        });
        _forms__WEBPACK_IMPORTED_MODULE_4__.bind(page.exportSeedAuth, page.exportSeedSubmit, () => this.submitExportSeedReq());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.gameCodeLink, 'click', () => this.showForm(page.gameCodeForm));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.gameCodeSubmit, 'click', () => this.submitGameCode());
        const closePopups = () => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            page.exportSeedPW.value = '';
            page.legacySeed.textContent = '';
            page.mnemonic.textContent = '';
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                closePopups();
            }
        });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                closePopups();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { closePopups(); });
        });
        this.renderDesktopNtfnSettings();
    }
    updateNtfnSetting(e) {
        const checkbox = e.target;
        const noteType = checkbox.getAttribute('name');
        if (noteType === null)
            return;
        const enabled = checkbox.checked;
        (0,_notifications__WEBPACK_IMPORTED_MODULE_7__.updateNtfnSetting)(noteType, enabled);
    }
    getBrowserNtfnSettings() {
        const permissions = (0,_notifications__WEBPACK_IMPORTED_MODULE_7__.fetchDesktopNtfnSettings)();
        return permissions;
    }
    renderDesktopNtfnSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const ntfnSettings = this.getBrowserNtfnSettings();
            const labels = _notifications__WEBPACK_IMPORTED_MODULE_7__.desktopNtfnLabels;
            const tmpl = page.browserNtfnCheckboxTemplate;
            tmpl.removeAttribute('id');
            const container = page.browserNtfnCheckboxContainer;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.browserNtfnCheckboxContainer);
            Object.keys(labels).forEach((noteType) => {
                const html = tmpl.cloneNode(true);
                const enabled = ntfnSettings[noteType];
                const checkbox = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(html, 'checkbox');
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(html, 'label').textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(labels[noteType]);
                checkbox.setAttribute('name', noteType);
                if (enabled)
                    checkbox.setAttribute('checked', 'checked');
                container.appendChild(html);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(checkbox, 'click', this.updateNtfnSetting);
            });
            const enabledCheckbox = page.browserNtfnEnabled;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(enabledCheckbox, 'click', (e) => __awaiter(this, void 0, void 0, function* () {
                if (_notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionDenied())
                    return;
                const checkbox = e.target;
                if (checkbox.checked) {
                    yield _notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.requestNtfnPermission();
                    checkbox.checked = !_notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionDenied();
                }
                this.updateNtfnSetting(e);
                checkbox.dispatchEvent(new Event('change'));
            }));
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(enabledCheckbox, 'change', (e) => {
                const checkbox = e.target;
                const permDenied = _notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionDenied();
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(checkbox.checked, page.browserNtfnCheckboxContainer);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(permDenied, page.browserNtfnBlockedMsg);
                checkbox.disabled = permDenied;
            });
            enabledCheckbox.checked = (_notifications__WEBPACK_IMPORTED_MODULE_7__.Notifier.ntfnPermissionGranted() && ntfnSettings.browserNtfnEnabled);
            enabledCheckbox.dispatchEvent(new Event('change'));
        });
    }
    /*
     * slideSwap animates the replacement of the currently shown form with the
     * newForm and sets this.currentForm.
     */
    slideSwap(newForm) {
        _forms__WEBPACK_IMPORTED_MODULE_4__.slideSwap(this.currentForm, newForm);
        this.currentForm = newForm;
    }
    // Retrieve an estimate for the tx fee needed to create new bond reserves.
    getBondsFeeBuffer(assetID, form) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(form);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/bondsfeebuffer', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                return 0;
            }
            return res.feeBuffer;
        });
    }
    newWalletCreated(assetID, tier) {
        return __awaiter(this, void 0, void 0, function* () {
            const user = yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
            if (!user)
                return;
            const page = this.page;
            const asset = user.assets[assetID];
            const wallet = asset.wallet;
            const bondAmt = this.currentDEX.bondAssets[asset.symbol].amount;
            const bondsFeeBuffer = yield this.getBondsFeeBuffer(assetID, page.newWalletForm);
            this.confirmRegisterForm.setFees(assetID, bondsFeeBuffer);
            if (wallet.synced && wallet.balance.available >= 2 * bondAmt + bondsFeeBuffer) {
                yield this.animateConfirmForm(page.newWalletForm);
                return;
            }
            this.walletWaitForm.setWallet(assetID, bondsFeeBuffer, tier);
            this.slideSwap(page.walletWait);
        });
    }
    onAccountFileChange() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const files = page.accountFile.files;
            if (!files || !files.length)
                return;
            page.selectedAccount.textContent = files[0].name;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.removeAccount);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.addAccount);
        });
    }
    /* clearAccountFile cleanup accountFile value and selectedAccount text */
    clearAccountFile() {
        const page = this.page;
        page.accountFile.value = '';
        page.selectedAccount.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NONE_SELECTED);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.removeAccount);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.addAccount);
    }
    prepareAccountImport(authorizeAccountImportForm) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            page.importAccountErr.textContent = '';
            this.showForm(authorizeAccountImportForm);
        });
    }
    // importAccount imports the account
    importAccount() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            let accountString = '';
            if (page.accountFile.value) {
                const files = page.accountFile.files;
                if (!files || !files.length) {
                    console.error('importAccount: no file specified');
                    return;
                }
                accountString = yield files[0].text();
            }
            let account;
            try {
                account = JSON.parse(accountString);
            }
            catch (e) {
                page.importAccountErr.textContent = e.message;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.importAccountErr);
                return;
            }
            if (typeof account === 'undefined') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.importAccountErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ACCT_UNDEFINED));
                return;
            }
            const { bonds = [] } = account, acctInf = __rest(account, ["bonds"]);
            const req = {
                account: acctInf,
                bonds: bonds
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/importaccount', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.importAccountErr, res.msg);
                return;
            }
            yield (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().fetchUser();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
            // Initial method of displaying imported account.
            window.location.reload();
        });
    }
    submitExportSeedReq() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const pw = page.exportSeedPW.value;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/exportseed', { pass: pw });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.exportSeedErr, res.msg);
                return;
            }
            page.exportSeedPW.value = '';
            if (res.seed.length === 128 && res.seed.split(' ').length === 1) {
                page.legacySeed.textContent = res.seed.match(/.{1,32}/g).map((chunk) => { var _a; return (_a = chunk.match(/.{1,8}/g)) === null || _a === void 0 ? void 0 : _a.join(' '); }).join('\n');
            }
            else
                page.mnemonic.textContent = res.seed;
            this.showForm(page.authorizeSeedDisplay);
        });
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.currentForm = form;
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    /* gets the contents of the cert file */
    getCertFile() {
        return __awaiter(this, void 0, void 0, function* () {
            let cert = '';
            if (this.dexAddrForm.page.certFile.value) {
                const files = this.dexAddrForm.page.certFile.files;
                if (files && files.length)
                    cert = yield files[0].text();
            }
            return cert;
        });
    }
    /* Called after successful registration to a DEX. */
    registerDEXSuccess() {
        return __awaiter(this, void 0, void 0, function* () {
            window.location.reload();
        });
    }
    /* Change application password  */
    changeAppPW() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.changePWErrMsg);
            const clearValues = () => {
                page.appPW.value = '';
                page.newAppPW.value = '';
                page.confirmNewPW.value = '';
            };
            // Ensure password fields are nonempty.
            if (!page.appPW.value || !page.newAppPW.value || !page.confirmNewPW.value) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.changePWErrMsg, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NO_APP_PASS_ERROR_MSG));
                clearValues();
                return;
            }
            // Ensure password confirmation matches.
            if (page.newAppPW.value !== page.confirmNewPW.value) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.changePWErrMsg, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_PASSWORD_NOT_MATCH));
                clearValues();
                return;
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(page.changeAppPW);
            const req = {
                appPW: page.appPW.value,
                newAppPW: page.newAppPW.value
            };
            clearValues();
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/changeapppass', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.changePWErrMsg, res.msg);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.forms);
        });
    }
    /*
     * unload is called by the Application when the user navigates away from
     * the /settings page.
     */
    unload() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
    /* Swap in the asset selection form and run the animation. */
    animateRegAsset(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            const form = this.page.regAssetForm;
            this.currentForm = form;
            this.regAssetForm.animate();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form);
        });
    }
    /* Swap in the confirmation form and run the animation. */
    animateConfirmForm(oldForm) {
        return __awaiter(this, void 0, void 0, function* () {
            this.confirmRegisterForm.animate();
            const form = this.page.confirmRegForm;
            this.currentForm = form;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(oldForm);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(form);
        });
    }
    submitGameCode() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.gameCodeErr);
            const code = page.gameCodeInput.value;
            if (!code) {
                page.gameCodeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NO_CODE_PROVIDED);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.gameCodeErr);
                return;
            }
            const msg = page.gameCodeMsg.value || '';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().loading(page.gameCodeForm);
            const resp = yield (0,_http__WEBPACK_IMPORTED_MODULE_3__.postJSON)('/api/redeemgamecode', { code, msg });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().checkResponse(resp)) {
                page.gameCodeErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_API_ERROR, { msg: resp.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.gameCodeErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.gameCodeSuccess);
            page.gameRedeemTx.dataset.explorerCoin = resp.coinString;
            const dcrBipID = 42;
            (0,_coinexplorers__WEBPACK_IMPORTED_MODULE_6__.setCoinHref)(dcrBipID, page.gameRedeemTx);
            page.gameRedeemTx.textContent = resp.coinString;
            const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_8__.app)().unitInfo(dcrBipID);
            page.gameRedeemValue.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(resp.win, ui);
        });
    }
}


/***/ }),

/***/ "./src/js/state.ts":
/*!*************************!*\
  !*** ./src/js/state.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// State is a set of static methods for working with the user state. It has
// utilities for setting and retrieving cookies and storing user configuration
// to localStorage.
class State {
    static setCookie(cname, cvalue) {
        const d = new Date();
        // Set cookie to expire in ten years.
        d.setTime(d.getTime() + (86400 * 365 * 10 * 1000));
        const expires = 'expires=' + d.toUTCString();
        document.cookie = cname + '=' + cvalue + ';' + expires + ';path=/';
    }
    /*
     * getCookie returns the value at the specified cookie name, otherwise null.
     */
    static getCookie(cname) {
        for (const cstr of document.cookie.split(';')) {
            const [k, v] = cstr.split('=');
            if (k.trim() === cname)
                return v;
        }
        return null;
    }
    /*
     * removeCookie tells the browser to stop using cookie. It's not enough to simply
     * erase cookie value because browser will still send it to the server (with empty
     * value), and that's not what server expects.
     */
    static removeCookie(cKey) {
        document.cookie = `${cKey}=;expires=Thu, 01 Jan 1970 00:00:01 GMT;`;
    }
    /*
     * isDark returns true if the dark-mode cookie is currently set to '1' = true.
     */
    static isDark() {
        return State.fetchLocal(State.darkModeLK) === '1';
    }
    /* storeLocal puts the key-value pair into Window.localStorage. */
    static storeLocal(k, v) {
        window.localStorage.setItem(k, JSON.stringify(v));
    }
    /*
    * fetchLocal the value associated with the key in Window.localStorage, or
    * null if the no value exists for the key.
    */
    static fetchLocal(k) {
        const v = window.localStorage.getItem(k);
        if (v !== null) {
            return JSON.parse(v);
        }
        return null;
    }
    /* removeLocal removes the key-value pair from Window.localStorage. */
    static removeLocal(k) {
        window.localStorage.removeItem(k);
    }
}
// Cookie keys.
State.darkModeLK = 'darkMode';
State.authCK = 'dexauth';
State.pwKeyCK = 'sessionkey';
// Local storage keys (for data that we don't need at the server).
State.popupsLK = 'popups';
State.loggersLK = 'loggers';
State.recordersLK = 'recorders';
State.lastMarketLK = 'selectedMarket';
State.depthZoomLK = 'depthZoom';
State.lastMMMarketLK = 'mmMarket';
State.optionsExpansionLK = 'mmOptsExpand';
State.leftMarketDockLK = 'leftmarketdock';
State.selectedAssetLK = 'selectedasset';
State.notificationsLK = 'notifications'; // DEPRECATED before v1
State.orderDisclaimerAckedLK = 'ordAck';
State.lastCandleDurationLK = 'lastCandleDuration';
State.localeSpecsKey = 'localeSpecsLK';
State.localeKey = 'localeLK';
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (State);
// Setting defaults here, unless specific cookie (or local storage) value was already chosen by the user.
if (State.fetchLocal(State.darkModeLK) === null)
    State.storeLocal(State.darkModeLK, '1');
if (State.fetchLocal(State.popupsLK) === null)
    State.storeLocal(State.popupsLK, '1');
if (State.fetchLocal(State.leftMarketDockLK) === null)
    State.storeLocal(State.leftMarketDockLK, '1');


/***/ }),

/***/ "./src/js/wallets.ts":
/*!***************************!*\
  !*** ./src/js/wallets.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ WalletsPage),
/* harmony export */   "ticketStatusExpired": () => (/* binding */ ticketStatusExpired),
/* harmony export */   "ticketStatusImmature": () => (/* binding */ ticketStatusImmature),
/* harmony export */   "ticketStatusLive": () => (/* binding */ ticketStatusLive),
/* harmony export */   "ticketStatusMissed": () => (/* binding */ ticketStatusMissed),
/* harmony export */   "ticketStatusRevoked": () => (/* binding */ ticketStatusRevoked),
/* harmony export */   "ticketStatusTranslationKeys": () => (/* binding */ ticketStatusTranslationKeys),
/* harmony export */   "ticketStatusUnknown": () => (/* binding */ ticketStatusUnknown),
/* harmony export */   "ticketStatusUnmined": () => (/* binding */ ticketStatusUnmined),
/* harmony export */   "ticketStatusUnspent": () => (/* binding */ ticketStatusUnspent),
/* harmony export */   "ticketStatusVoted": () => (/* binding */ ticketStatusVoted),
/* harmony export */   "txTypeAcceleration": () => (/* binding */ txTypeAcceleration),
/* harmony export */   "txTypeApproveToken": () => (/* binding */ txTypeApproveToken),
/* harmony export */   "txTypeCreateBond": () => (/* binding */ txTypeCreateBond),
/* harmony export */   "txTypeMixing": () => (/* binding */ txTypeMixing),
/* harmony export */   "txTypeReceive": () => (/* binding */ txTypeReceive),
/* harmony export */   "txTypeRedeem": () => (/* binding */ txTypeRedeem),
/* harmony export */   "txTypeRedeemBond": () => (/* binding */ txTypeRedeemBond),
/* harmony export */   "txTypeRefund": () => (/* binding */ txTypeRefund),
/* harmony export */   "txTypeRevokeTokenApproval": () => (/* binding */ txTypeRevokeTokenApproval),
/* harmony export */   "txTypeSelfSend": () => (/* binding */ txTypeSelfSend),
/* harmony export */   "txTypeSend": () => (/* binding */ txTypeSend),
/* harmony export */   "txTypeSplit": () => (/* binding */ txTypeSplit),
/* harmony export */   "txTypeString": () => (/* binding */ txTypeString),
/* harmony export */   "txTypeSwap": () => (/* binding */ txTypeSwap),
/* harmony export */   "txTypeSwapOrSend": () => (/* binding */ txTypeSwapOrSend),
/* harmony export */   "txTypeTicketPurchase": () => (/* binding */ txTypeTicketPurchase),
/* harmony export */   "txTypeTicketRevocation": () => (/* binding */ txTypeTicketRevocation),
/* harmony export */   "txTypeTicketVote": () => (/* binding */ txTypeTicketVote),
/* harmony export */   "txTypeUnknown": () => (/* binding */ txTypeUnknown)
/* harmony export */ });
/* harmony import */ var _doc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./doc */ "./src/js/doc.ts");
/* harmony import */ var _basepage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./basepage */ "./src/js/basepage.ts");
/* harmony import */ var _http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./http */ "./src/js/http.ts");
/* harmony import */ var _forms__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./forms */ "./src/js/forms.ts");
/* harmony import */ var _state__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./state */ "./src/js/state.ts");
/* harmony import */ var _locales__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./locales */ "./src/js/locales.ts");
/* harmony import */ var _orderutil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./orderutil */ "./src/js/orderutil.ts");
/* harmony import */ var _registry__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./registry */ "./src/js/registry.ts");
/* harmony import */ var _coinexplorers__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./coinexplorers */ "./src/js/coinexplorers.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};









const animationLength = 300;
const traitRescanner = 1;
const traitLogFiler = 1 << 2;
const traitRecoverer = 1 << 5;
const traitWithdrawer = 1 << 6;
const traitRestorer = 1 << 8;
const traitTxFeeEstimator = 1 << 9;
const traitPeerManager = 1 << 10;
const traitTokenApprover = 1 << 13;
const traitTicketBuyer = 1 << 15;
const traitHistorian = 1 << 16;
const traitFundsMixer = 1 << 17;
const traitsExtraOpts = traitLogFiler | traitRecoverer | traitRestorer | traitRescanner | traitPeerManager | traitTokenApprover;
const ticketStatusUnknown = 0;
const ticketStatusUnmined = 1;
const ticketStatusImmature = 2;
const ticketStatusLive = 3;
const ticketStatusVoted = 4;
const ticketStatusMissed = 5;
const ticketStatusExpired = 6;
const ticketStatusUnspent = 7;
const ticketStatusRevoked = 8;
const ticketStatusTranslationKeys = [
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_UNKNOWN,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_UNMINED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_IMMATURE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_LIVE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_VOTED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_MISSED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_EXPIRED,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_UNSPENT,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKET_STATUS_REVOKED
];
const txTypeUnknown = 0;
const txTypeSend = 1;
const txTypeReceive = 2;
const txTypeSwap = 3;
const txTypeRedeem = 4;
const txTypeRefund = 5;
const txTypeSplit = 6;
const txTypeCreateBond = 7;
const txTypeRedeemBond = 8;
const txTypeApproveToken = 9;
const txTypeAcceleration = 10;
const txTypeSelfSend = 11;
const txTypeRevokeTokenApproval = 12;
const txTypeTicketPurchase = 13;
const txTypeTicketVote = 14;
const txTypeTicketRevocation = 15;
const txTypeSwapOrSend = 16;
const txTypeMixing = 17;
const positiveTxTypes = [
    txTypeReceive,
    txTypeRedeem,
    txTypeRefund,
    txTypeRedeemBond,
    txTypeTicketVote,
    txTypeTicketRevocation
];
const negativeTxTypes = [
    txTypeSend,
    txTypeSwap,
    txTypeCreateBond,
    txTypeTicketPurchase,
    txTypeSwapOrSend
];
const noAmtTxTypes = [
    txTypeSplit,
    txTypeApproveToken,
    txTypeAcceleration,
    txTypeRevokeTokenApproval
];
function txTypeSignAndClass(txType) {
    if (positiveTxTypes.includes(txType))
        return ['+', 'positive-tx'];
    if (negativeTxTypes.includes(txType))
        return ['-', 'negative-tx'];
    return ['', ''];
}
const txTypeTranslationKeys = [
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_UNKNOWN,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SEND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_RECEIVE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SWAP,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REDEEM,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REFUND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SPLIT,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_CREATE_BOND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REDEEM_BOND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_APPROVE_TOKEN,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_ACCELERATION,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SELF_TRANSFER,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_REVOKE_TOKEN_APPROVAL,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_TICKET_PURCHASE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_TICKET_VOTE,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_TICKET_REVOCATION,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_SWAP_OR_SEND,
    _locales__WEBPACK_IMPORTED_MODULE_5__.ID_TX_TYPE_MIX
];
function txTypeString(txType) {
    return _locales__WEBPACK_IMPORTED_MODULE_5__.prep(txTypeTranslationKeys[txType]);
}
const ticketPageSize = 10;
const scanStartMempool = -1;
let net = 0;
class WalletsPage extends _basepage__WEBPACK_IMPORTED_MODULE_1__["default"] {
    constructor(body, data) {
        super();
        this.body = body;
        this.data = data;
        const page = this.page = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].idDescendants(body);
        this.stampers = [];
        net = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.net;
        const setStamp = () => {
            for (const span of this.stampers) {
                if (span.dataset.stamp) {
                    span.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseInt(span.dataset.stamp || '') * 1000);
                }
            }
        };
        this.secondTicker = window.setInterval(() => {
            setStamp();
        }, 10000); // update every 10 seconds
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.restoreInfoCard, page.connectedIconTmpl, page.disconnectedIconTmpl, page.removeIconTmpl);
        this.restoreInfoCard = page.restoreInfoCard.cloneNode(true);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.connectedIconTmpl, page.disconnectedIconTmpl, page.removeIconTmpl);
        this.forms = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].applySelector(page.forms, ':scope > form');
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => { this.closePopups(); });
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.cancelForce, 'click', () => { this.closePopups(); });
        this.selectedAssetID = -1;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].cleanTemplates(page.iconSelectTmpl, page.balanceDetailRow, page.recentOrderTmpl, page.vspRowTmpl, page.ticketHistoryRowTmpl, page.votingChoiceTmpl, page.votingAgendaTmpl, page.tspendTmpl, page.tkeyTmpl, page.txHistoryRowTmpl, page.txHistoryDateRowTmpl);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.createWallet, 'click', () => this.showNewWallet(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.connectBttn, 'click', () => this.doConnect(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.send, 'click', () => this.showSendForm(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.receive, 'click', () => this.showDeposit(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.unlockBttn, 'click', () => this.openWallet(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.lockBttn, 'click', () => this.lock(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.reconfigureBttn, 'click', () => this.showReconfig(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.needsProviderBttn, 'click', () => this.showReconfig(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.rescanWallet, 'click', () => this.rescanWallet(this.selectedAssetID));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.earlierTxs, 'click', () => this.loadEarlierTxs());
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyTxIDBtn, 'click', () => { var _a; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_a = this.currTx) === null || _a === void 0 ? void 0 : _a.id) || '', page.txDetailsID, page.copyTxIDBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyRecipientBtn, 'click', () => { var _a; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_a = this.currTx) === null || _a === void 0 ? void 0 : _a.recipient) || '', page.txDetailsRecipient, page.copyRecipientBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyBondIDBtn, 'click', () => { var _a, _b; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_b = (_a = this.currTx) === null || _a === void 0 ? void 0 : _a.bondInfo) === null || _b === void 0 ? void 0 : _b.bondID) || '', page.txDetailsBondID, page.copyBondIDBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.copyBondAccountIDBtn, 'click', () => { var _a, _b; (0,_doc__WEBPACK_IMPORTED_MODULE_0__.setupCopyBtn)(((_b = (_a = this.currTx) === null || _a === void 0 ? void 0 : _a.bondInfo) === null || _b === void 0 ? void 0 : _b.accountID) || '', page.txDetailsBondAccountID, page.copyBondAccountIDBtn, '#1e7d11'); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.hideMixTxsCheckbox, 'change', () => { this.showTxHistory(this.selectedAssetID); });
        // Bind the new wallet form.
        this.newWalletForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.NewWalletForm(page.newWalletForm, (assetID) => {
            const fmtParams = { assetName: (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].name };
            this.assetUpdated(assetID, page.newWalletForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NEW_WALLET_SUCCESS, fmtParams));
            this.sortAssetButtons();
            this.updateTicketBuyer(assetID);
            this.updatePrivacy(assetID);
        });
        // Bind the wallet reconfig form.
        this.reconfigForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.WalletConfigForm(page.reconfigInputs, false);
        this.walletCfgGuide = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(page.reconfigForm, 'walletCfgGuide');
        // Bind the send form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.sendForm, page.submitSendForm, () => __awaiter(this, void 0, void 0, function* () { this.stepSend(); }));
        // Send confirmation form.
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.vSendForm, page.vSend, () => __awaiter(this, void 0, void 0, function* () { this.send(); }));
        // Bind the wallet reconfiguration submission.
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.reconfigForm, page.submitReconfig, () => this.reconfig());
        page.forms.querySelectorAll('.form-closer').forEach(el => {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(el, 'click', () => this.closePopups());
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.forms, 'mousedown', (e) => {
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].mouseInElement(e, this.currentForm)) {
                this.closePopups();
            }
        });
        this.mixerToggle = new _doc__WEBPACK_IMPORTED_MODULE_0__.AniToggle(page.toggleMixer, page.mixingErr, false, (newState) => { return this.updateMixerState(newState); });
        this.keyup = (e) => {
            if (e.key === 'Escape') {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.forms))
                    this.closePopups();
            }
        };
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(document, 'keyup', this.keyup);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.downloadLogs, 'click', () => __awaiter(this, void 0, void 0, function* () { this.downloadLogs(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.exportWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.displayExportWalletAuth(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.recoverWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showRecoverWallet(); }));
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.exportWalletAuth, page.exportWalletAuthSubmit, () => __awaiter(this, void 0, void 0, function* () { this.exportWalletAuthSubmit(); }));
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.recoverWalletConfirm, page.recoverWalletSubmit, () => { this.recoverWallet(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.confirmForce, page.confirmForceSubmit, () => __awaiter(this, void 0, void 0, function* () { this.confirmForceSubmit(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.disableWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showToggleWalletStatus(true); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.enableWallet, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showToggleWalletStatus(false); }));
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.toggleWalletStatusConfirm, page.toggleWalletStatusSubmit, () => __awaiter(this, void 0, void 0, function* () { this.toggleWalletStatus(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.managePeers, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showManagePeersForm(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.addPeerSubmit, 'click', () => __awaiter(this, void 0, void 0, function* () { this.submitAddPeer(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.unapproveTokenAllowance, 'click', () => __awaiter(this, void 0, void 0, function* () { this.showUnapproveTokenAllowanceTableForm(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.unapproveTokenSubmit, 'click', () => __awaiter(this, void 0, void 0, function* () { this.submitUnapproveTokenAllowance(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showVSPs, 'click', () => { this.showVSPPicker(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.vspDisplay, 'click', () => { this.showVSPPicker(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.vspPicker, page.customVspSubmit, () => __awaiter(this, void 0, void 0, function* () { this.setCustomVSP(); }));
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.purchaseTicketsBttn, 'click', () => { this.showPurchaseTicketsDialog(); });
        (0,_forms__WEBPACK_IMPORTED_MODULE_3__.bind)(page.purchaseTicketsForm, page.purchaserSubmit, () => { this.purchaseTickets(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.purchaserInput, 'change', () => { this.purchaserInputChanged(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ticketHistory, 'click', () => { this.showTicketHistory(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ticketHistoryNextPage, 'click', () => { this.nextTicketPage(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.ticketHistoryPrevPage, 'click', () => { this.prevTicketPage(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.setVotes, 'click', () => { this.showSetVotesDialog(); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.purchaseTicketsErrCloser, 'click', () => { _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.purchaseTicketsErrBox); });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.privacyInfoBttn, 'click', () => { this.showForm(page.mixingInfo); });
        // New deposit address button.
        this.depositAddrForm = new _forms__WEBPACK_IMPORTED_MODULE_3__.DepositAddress(page.deposit);
        // Clicking on the available amount on the Send form populates the
        // amount field.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.walletBal, 'click', () => { this.populateMaxSend(); });
        // Display fiat value for current send amount.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.sendAmt, 'input', () => {
            const { unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            const amt = (0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.sendAmt.value);
            const conversionFactor = ui.conventional.conversionFactor;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, amt * conversionFactor, (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[this.selectedAssetID], ui);
        });
        // Clicking on maxSend on the send form should populate the amount field.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.maxSend, 'click', () => { this.populateMaxSend(); });
        // Validate send address on input.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.sendAddr, 'input', () => __awaiter(this, void 0, void 0, function* () {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.validAddr);
            page.sendAddr.classList.remove('is-invalid');
            const addr = page.sendAddr.value || '';
            if (!asset || addr === '')
                return;
            const valid = yield this.validateSendAddress(addr, asset.id);
            if (valid)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.validAddr);
            else
                page.sendAddr.classList.add('is-invalid');
        }));
        // A link on the wallet reconfiguration form to show/hide the password field.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showChangePW, 'click', () => {
            this.changeWalletPW = !this.changeWalletPW;
            this.setPWSettingViz(this.changeWalletPW);
        });
        // Changing the type of wallet.
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.changeWalletTypeSelect, 'change', () => {
            this.changeWalletType();
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(page.showChangeType, 'click', () => {
            if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.changeWalletType)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.changeWalletType, page.changeTypeHideIcon);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.changeTypeShowIcon);
                page.changeTypeMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_KEEP_WALLET_TYPE);
            }
            else
                this.showReconfig(this.selectedAssetID, { skipAnimation: true });
        });
        (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().registerNoteFeeder({
            fiatrateupdate: (note) => { this.handleRatesNote(note); },
            balance: (note) => { this.handleBalanceNote(note); },
            walletstate: (note) => { this.handleWalletStateNote(note); },
            walletconfig: (note) => { this.handleWalletStateNote(note); },
            walletsync: (note) => { this.updateSyncAndPeers(note.assetID); },
            createwallet: (note) => { this.handleCreateWalletNote(note); },
            walletnote: (note) => { this.handleCustomWalletNote(note); }
        });
        const firstAsset = this.sortAssetButtons();
        let selectedAsset = firstAsset.id;
        const assetIDStr = _state__WEBPACK_IMPORTED_MODULE_4__["default"].fetchLocal(_state__WEBPACK_IMPORTED_MODULE_4__["default"].selectedAssetLK);
        if (assetIDStr)
            selectedAsset = Number(assetIDStr);
        this.setSelectedAsset(selectedAsset);
        setInterval(() => {
            for (const row of this.page.txHistoryTableBody.children) {
                const age = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].tmplElement(row, 'age');
                age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(parseInt(age.dataset.timestamp));
            }
        }, 5000);
    }
    closePopups() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.forms);
        this.currTx = undefined;
        if (this.animation)
            this.animation.stop();
    }
    safePost(path, args) {
        return __awaiter(this, void 0, void 0, function* () {
            const assetID = this.selectedAssetID;
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(path, args);
            if (assetID !== this.selectedAssetID)
                throw Error('asset changed during request. aborting');
            return res;
        });
    }
    // stepSend makes a request to get an estimated fee and displays the confirm
    // send form.
    stepSend() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vSendErr, page.sendErr, page.vSendEstimates, page.txFeeNotAvailable);
            const assetID = parseInt(page.sendForm.dataset.assetID || '');
            const token = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].token;
            const subtract = page.subtractCheckBox.checked || false;
            const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID).conventional.conversionFactor;
            const value = Math.round((0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.sendAmt.value, 0) * conversionFactor);
            const addr = page.sendAddr.value || '';
            if (addr === '')
                return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: addr }));
            const { wallet, unitInfo: ui, symbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            // txfee will not be available if wallet is not a fee estimator or the
            // request failed.
            let txfee = 0;
            if ((wallet.traits & traitTxFeeEstimator) !== 0) {
                const open = {
                    addr: page.sendAddr.value,
                    assetID: assetID,
                    subtract: subtract,
                    value: value
                };
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.sendForm);
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/txfee', open);
                loaded();
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                    page.txFeeNotAvailable.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TXFEE_ERR_MSG, { err: res.msg });
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txFeeNotAvailable);
                    // We still want to ensure user address is valid before proceeding to send
                    // confirm form if there's an error while calculating the transaction fee.
                    const valid = yield this.validateSendAddress(addr, assetID);
                    if (!valid)
                        return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: addr || '' }));
                }
                else if (res.ok) {
                    if (!res.validaddress)
                        return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: page.sendAddr.value || '' }));
                    txfee = res.txfee;
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vSendEstimates);
                }
            }
            else {
                // Validate only the send address for assets that are not fee estimators.
                const valid = yield this.validateSendAddress(addr, assetID);
                if (!valid)
                    return _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.sendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_INVALID_ADDRESS_MSG, { address: addr || '' }));
            }
            page.vSendSymbol.textContent = symbol.toUpperCase();
            page.vSendLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            if (token) {
                const { unitInfo: feeUI, symbol: feeSymbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID];
                page.vSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(txfee, feeUI) + ' ' + feeSymbol;
            }
            else {
                page.vSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(txfee, ui);
            }
            const xcRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.vSendFeeFiat, txfee, xcRate, ui);
            page.vSendDestinationAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(value - txfee, ui);
            page.vTotalSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(value, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.vTotalSendFiat, value, xcRate, ui);
            page.vSendAddr.textContent = page.sendAddr.value || '';
            const bal = wallet.balance.available - value;
            page.balanceAfterSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(bal, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.balanceAfterSendFiat, bal, xcRate, ui);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.approxSign);
            // NOTE: All tokens take this route because they cannot pay the fee.
            if (!subtract) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.approxSign);
                page.vSendDestinationAmt.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(value, ui);
                let totalSend = value;
                if (!token)
                    totalSend += txfee;
                page.vTotalSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(totalSend, ui);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.vTotalSendFiat, totalSend, xcRate, ui);
                let bal = wallet.balance.available - value;
                if (!token)
                    bal -= txfee;
                // handle edge cases where bal is not enough to cover totalSend.
                // we don't want a minus display of user bal.
                if (bal <= 0) {
                    page.balanceAfterSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(0, ui);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.balanceAfterSendFiat, 0, xcRate, ui);
                }
                else {
                    page.balanceAfterSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(bal, ui);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.balanceAfterSendFiat, bal, xcRate, ui);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.sendForm);
            yield this.showForm(page.vSendForm);
        });
    }
    // cancelSend displays the send form if user wants to make modification.
    cancelSend() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vSendForm, page.sendErr);
            yield this.showForm(page.sendForm);
        });
    }
    /*
     * validateSendAddress validates the provided address for an asset.
     */
    validateSendAddress(addr, assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const resp = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/validateaddress', { addr: addr, assetID: assetID });
            return (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(resp);
        });
    }
    /*
     * setPWSettingViz sets the visibility of the password field section.
     */
    setPWSettingViz(visible) {
        const page = this.page;
        if (visible) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.showIcon);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.hideIcon, page.changePW);
            page.switchPWMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_KEEP_WALLET_PASS);
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.hideIcon, page.changePW);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showIcon);
        page.switchPWMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NEW_WALLET_PASS);
    }
    /*
     * assetVersionUsedByDEXes returns a map of the versions of the
     * currently selected asset to the DEXes that use that version.
     */
    assetVersionUsedByDEXes() {
        const assetID = this.selectedAssetID;
        const versionToDEXes = {};
        const exchanges = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().exchanges;
        for (const host in exchanges) {
            const exchange = exchanges[host];
            const exchangeAsset = exchange.assets[assetID];
            if (!exchangeAsset)
                continue;
            if (!versionToDEXes[exchangeAsset.version]) {
                versionToDEXes[exchangeAsset.version] = [];
            }
            versionToDEXes[exchangeAsset.version].push(exchange.host);
        }
        return versionToDEXes;
    }
    /*
     * submitUnapproveTokenAllowance submits a request to the server to
     * unapprove a version of the currently selected token's swap contract.
     */
    submitUnapproveTokenAllowance() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const path = '/api/unapprovetoken';
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(path, {
                assetID: this.selectedAssetID,
                version: this.unapprovingTokenVersion
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.unapproveTokenErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenErr);
                return;
            }
            const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[this.selectedAssetID];
            if (assetExplorer && assetExplorer[net]) {
                page.unapproveTokenTxID.href = assetExplorer[net](res.txID);
            }
            page.unapproveTokenTxID.textContent = res.txID;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.unapproveTokenSubmissionElements, page.unapproveTokenErr);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenTxMsg);
        });
    }
    /*
     * showUnapproveTokenAllowanceForm displays the form for unapproving
     * a specific version of the currently selected token's swap contract.
     */
    showUnapproveTokenAllowanceForm(version) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.unapprovingTokenVersion = version;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenSubmissionElements);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.unapproveTokenTxMsg, page.unapproveTokenErr);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            if (!asset || !asset.token)
                return;
            const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[asset.token.parentID];
            if (!parentAsset)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.tokenAllowanceRemoveSymbol);
            page.tokenAllowanceRemoveSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset, true));
            page.tokenAllowanceRemoveVersion.textContent = version.toString();
            const path = '/api/approvetokenfee';
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(path, {
                assetID: this.selectedAssetID,
                version: version,
                approving: false
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.unapproveTokenErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.unapproveTokenErr);
            }
            else {
                let feeText = `${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(res.txFee, parentAsset.unitInfo)} ${parentAsset.unitInfo.conventional.unit}`;
                const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[parentAsset.id];
                if (rate) {
                    feeText += ` (${_doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(res.txFee, rate, parentAsset.unitInfo)} USD)`;
                }
                page.unapprovalFeeEstimate.textContent = feeText;
            }
            this.showForm(page.unapproveTokenForm);
        });
    }
    /*
     * showUnapproveTokenAllowanceTableForm displays a table showing each of the
     * versions of a token's swap contract that have been approved and allows the
     * user to unapprove any of them.
     */
    showUnapproveTokenAllowanceTableForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            if (!asset || !asset.wallet || !asset.wallet.approved)
                return;
            while (page.tokenVersionBody.firstChild) {
                page.tokenVersionBody.removeChild(page.tokenVersionBody.firstChild);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.tokenVersionTableAssetSymbol);
            page.tokenVersionTableAssetSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(asset, true));
            const versionToDEXes = this.assetVersionUsedByDEXes();
            let showTable = false;
            for (let i = 0; i <= asset.wallet.version; i++) {
                const approvalStatus = asset.wallet.approved[i];
                if (approvalStatus === undefined || approvalStatus !== _registry__WEBPACK_IMPORTED_MODULE_7__.ApprovalStatus.Approved) {
                    continue;
                }
                showTable = true;
                const row = page.tokenVersionRow.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                tmpl.version.textContent = i.toString();
                if (versionToDEXes[i]) {
                    tmpl.usedBy.textContent = versionToDEXes[i].join(', ');
                }
                const removeIcon = this.page.removeIconTmpl.cloneNode(true);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(removeIcon, 'click', () => {
                    this.showUnapproveTokenAllowanceForm(i);
                });
                tmpl.remove.appendChild(removeIcon);
                page.tokenVersionBody.appendChild(row);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(showTable, page.tokenVersionTable);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!showTable, page.tokenVersionNone);
            this.showForm(page.unapproveTokenTableForm);
        });
    }
    /*
     * updateWalletPeers retrieves the wallet peers and displays them in the
     * wallet peers table.
     */
    updateWalletPeersTable() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.peerSpinner);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/getwalletpeers', {
                assetID: this.selectedAssetID
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.managePeersErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.managePeersErr);
                return;
            }
            while (page.peersTableBody.firstChild) {
                page.peersTableBody.removeChild(page.peersTableBody.firstChild);
            }
            const peers = res.peers || [];
            peers.sort((a, b) => {
                return a.source - b.source;
            });
            const defaultText = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_DEFAULT);
            const addedText = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ADDED);
            const discoveredText = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_DISCOVERED);
            peers.forEach((peer) => {
                const row = page.peerTableRow.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                tmpl.addr.textContent = peer.addr;
                switch (peer.source) {
                    case _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.WalletDefault:
                        tmpl.source.textContent = defaultText;
                        break;
                    case _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.UserAdded:
                        tmpl.source.textContent = addedText;
                        break;
                    case _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.Discovered:
                        tmpl.source.textContent = discoveredText;
                        break;
                }
                let connectionIcon;
                if (peer.connected) {
                    connectionIcon = this.page.connectedIconTmpl.cloneNode(true);
                }
                else {
                    connectionIcon = this.page.disconnectedIconTmpl.cloneNode(true);
                }
                tmpl.connected.appendChild(connectionIcon);
                if (peer.source === _registry__WEBPACK_IMPORTED_MODULE_7__.PeerSource.UserAdded) {
                    const removeIcon = this.page.removeIconTmpl.cloneNode(true);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(removeIcon, 'click', () => __awaiter(this, void 0, void 0, function* () {
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.managePeersErr);
                        const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/removewalletpeer', {
                            assetID: this.selectedAssetID,
                            addr: peer.addr
                        });
                        if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                            page.managePeersErr.textContent = res.msg;
                            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.managePeersErr);
                            return;
                        }
                        this.spinUntilPeersUpdate();
                    }));
                    tmpl.remove.appendChild(removeIcon);
                }
                page.peersTableBody.appendChild(row);
            });
        });
    }
    // showManagePeersForm displays the manage peers form.
    showManagePeersForm() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            yield this.updateWalletPeersTable();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.managePeersErr);
            this.showForm(page.managePeersForm);
        });
    }
    // submitAddPeers sends a request for the the wallet to connect to a new
    // peer.
    submitAddPeer() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.managePeersErr);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/addwalletpeer', {
                assetID: this.selectedAssetID,
                addr: page.addPeerInput.value
            });
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.managePeersErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.managePeersErr);
                return;
            }
            this.spinUntilPeersUpdate();
            page.addPeerInput.value = '';
        });
    }
    /*
     * spinUntilPeersUpdate will show the spinner on the manage peers fork.
     * If it is still showing after 10 seconds, the peers table will be updated
     * instead of waiting for a notification.
     */
    spinUntilPeersUpdate() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.peerSpinner);
            setTimeout(() => {
                if (_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(page.peerSpinner)) {
                    this.updateWalletPeersTable();
                }
            }, 10000);
        });
    }
    /*
     * showToggleWalletStatus displays the toggleWalletStatusConfirm form with
     * relevant help message.
     */
    showToggleWalletStatus(disable) {
        const page = this.page;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr, page.walletStatusDisable, page.disableWalletMsg, page.walletStatusEnable, page.enableWalletMsg);
        if (disable)
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletStatusDisable, page.disableWalletMsg);
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.walletStatusEnable, page.enableWalletMsg);
        this.showForm(page.toggleWalletStatusConfirm);
    }
    /*
     * toggleWalletStatus toggles a wallets status to either disabled or enabled.
     */
    toggleWalletStatus() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleWalletStatusErr);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            const disable = !asset.wallet.disabled;
            const url = '/api/togglewalletstatus';
            const req = {
                assetID: this.selectedAssetID,
                disable: disable
            };
            const fmtParams = { assetName: asset.name };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.toggleWalletStatusConfirm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                if (res.code === _http__WEBPACK_IMPORTED_MODULE_2__.Errors.activeOrdersErr)
                    page.toggleWalletStatusErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ACTIVE_ORDERS_ERR_MSG, fmtParams);
                else
                    page.toggleWalletStatusErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.toggleWalletStatusErr);
                return;
            }
            let successMsg = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_DISABLED_MSG, fmtParams);
            if (!disable)
                successMsg = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_ENABLED_MSG, fmtParams);
            this.assetUpdated(this.selectedAssetID, page.toggleWalletStatusConfirm, successMsg);
        });
    }
    /*
     * showBox shows the box with a fade-in animation.
     */
    showBox(box, focuser) {
        return __awaiter(this, void 0, void 0, function* () {
            box.style.opacity = '0';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(box);
            if (focuser)
                focuser.focus();
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                box.style.opacity = `${progress}`;
            }, 'easeOut');
            box.style.opacity = '1';
            this.displayed = box;
        });
    }
    /* showForm shows a modal form with a little animation. */
    showForm(form) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.currentForm = form;
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            form.style.right = '10000px';
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.forms, form);
            const shift = (page.forms.offsetWidth + form.offsetWidth) / 2;
            yield _doc__WEBPACK_IMPORTED_MODULE_0__["default"].animate(animationLength, progress => {
                form.style.right = `${(1 - progress) * shift}px`;
            }, 'easeOutHard');
            form.style.right = '0';
        });
    }
    showSuccess(msg) {
        return __awaiter(this, void 0, void 0, function* () {
            this.forms.forEach(form => _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(form));
            this.currentForm = this.page.checkmarkForm;
            this.animation = (0,_forms__WEBPACK_IMPORTED_MODULE_3__.showSuccess)(this.page, msg);
            yield this.animation.wait();
            this.animation = new _doc__WEBPACK_IMPORTED_MODULE_0__.Animation(1500, () => { }, '', () => {
                if (this.currentForm === this.page.checkmarkForm)
                    this.closePopups();
            });
        });
    }
    /* Show the new wallet form. */
    showNewWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const box = page.newWalletForm;
            this.newWalletForm.setAsset(assetID);
            const defaultsLoaded = this.newWalletForm.loadDefaults();
            yield this.showForm(box);
            yield defaultsLoaded;
        });
    }
    // sortAssetButtons displays supported assets, sorted. Returns first asset in the
    // list.
    sortAssetButtons() {
        const page = this.page;
        this.assetButtons = {};
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.assetSelect);
        const sortedAssets = [...Object.values((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets)];
        sortedAssets.sort((a, b) => {
            if (a.wallet && !b.wallet)
                return -1;
            if (!a.wallet && b.wallet)
                return 1;
            if (!a.wallet && !b.wallet)
                return a.symbol === 'dcr' ? -1 : 1;
            const [aBal, bBal] = [a.wallet.balance, b.wallet.balance];
            const [aTotal, bTotal] = [aBal.available + aBal.immature + aBal.locked, bBal.available + bBal.immature + bBal.locked];
            if (aTotal === 0 && bTotal === 0)
                return a.symbol.localeCompare(b.symbol);
            else if (aTotal === 0)
                return 1;
            else if (aTotal === 0)
                return -1;
            const [aFiat, bFiat] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[a.id], (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[b.id]];
            if (aFiat && !bFiat)
                return -1;
            if (!aFiat && bFiat)
                return 1;
            return bFiat * bTotal - aFiat * aTotal;
        });
        for (const a of sortedAssets) {
            const bttn = page.iconSelectTmpl.cloneNode(true);
            page.assetSelect.appendChild(bttn);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(bttn);
            this.assetButtons[a.id] = { tmpl, bttn };
            this.updateAssetButton(a.id);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(bttn, 'click', () => {
                this.setSelectedAsset(a.id);
                _state__WEBPACK_IMPORTED_MODULE_4__["default"].storeLocal(_state__WEBPACK_IMPORTED_MODULE_4__["default"].selectedAssetLK, String(a.id));
            });
        }
        page.assetSelect.classList.remove('invisible');
        return sortedAssets[0];
    }
    updateAssetButton(assetID) {
        var _a, _b;
        const a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
        const { bttn, tmpl } = this.assetButtons[assetID];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.fiatBox, tmpl.noWallet);
        bttn.classList.add('nowallet');
        (_a = tmpl.img).src || (_a.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(a.symbol)); // don't initiate GET if already set (e.g. update on some notification)
        const symbolParts = a.symbol.split('.');
        if (symbolParts.length === 2) {
            const parentSymbol = symbolParts[1];
            tmpl.parentImg.classList.remove('d-hide');
            (_b = tmpl.parentImg).src || (_b.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentSymbol));
        }
        if (this.selectedAssetID === assetID)
            bttn.classList.add('selected');
        tmpl.name.textContent = a.name;
        if (a.wallet) {
            bttn.classList.remove('nowallet');
            const { wallet: { balance: b }, unitInfo: ui } = a;
            const totalBalance = b.available + b.locked + b.immature;
            const [s, unit] = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestUnitsFourSigFigs(totalBalance, ui);
            tmpl.balance.textContent = s;
            tmpl.unit.textContent = unit;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.balanceBox);
            const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[a.id];
            if (fiatRate) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.fiatBox);
                tmpl.fiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(totalBalance / ui.conventional.conversionFactor * fiatRate);
            }
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.noWallet);
    }
    setSelectedAsset(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const { assetSelect } = this.page;
            for (const b of assetSelect.children)
                b.classList.remove('selected');
            this.assetButtons[assetID].bttn.classList.add('selected');
            this.selectedAssetID = assetID;
            this.page.hideMixTxsCheckbox.checked = true;
            this.updateDisplayedAsset(assetID);
            this.showAvailableMarkets(assetID);
            const a = this.showRecentActivity(assetID);
            const b = this.showTxHistory(assetID);
            const c = this.updateTicketBuyer(assetID);
            const d = this.updatePrivacy(assetID);
            for (const p of [a, b, c, d])
                yield p;
        });
    }
    updateDisplayedAsset(assetID) {
        if (assetID !== this.selectedAssetID)
            return;
        const { symbol, wallet, name, token, unitInfo } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
        const { page, body } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(body, '[data-asset-name]', name);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setText(body, '[data-ticker]', unitInfo.conventional.unit);
        page.assetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.balanceBox, page.fiatBalanceBox, page.createWallet, page.walletDetails, page.sendReceive, page.connectBttnBox, page.statusLocked, page.statusReady, page.statusOff, page.unlockBttnBox, page.lockBttnBox, page.connectBttnBox, page.peerCountBox, page.syncProgressBox, page.statusDisabled, page.tokenInfoBox, page.needsProviderBox, page.feeStateBox, page.txSyncBox, page.txProgress, page.txFindingAddrs);
        this.checkNeedsProvider(assetID);
        if (token) {
            const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID];
            page.tokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
            page.tokenParentName.textContent = parentAsset.name;
            page.contractAddress.textContent = token.contractAddress;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.tokenInfoBox);
        }
        if (wallet) {
            this.updateDisplayedAssetBalance();
            const { feeState, running, disabled, type: walletType } = wallet;
            const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletDefinition(assetID, walletType);
            page.walletType.textContent = walletDef.tab;
            if (feeState)
                this.updateFeeState(feeState);
            if (disabled)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusDisabled); // wallet is disabled
            else if (running) {
                this.updateSyncAndPeers(wallet.assetID);
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusOff, page.connectBttnBox); // wallet not running
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.createWallet); // no wallet
        page.walletDetailsBox.classList.remove('invisible');
    }
    updateSyncAndPeers(assetID) {
        const { page, selectedAssetID } = this;
        if (assetID !== selectedAssetID)
            return;
        const { peerCount, syncProgress, syncStatus, encrypted, open, running } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[assetID];
        if (!running)
            return;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendReceive, page.peerCountBox, page.syncProgressBox);
        page.peerCount.textContent = String(peerCount);
        page.syncProgress.textContent = `${(syncProgress * 100).toFixed(1)}%`;
        if (open) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusReady);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().haveActiveOrders(assetID) && encrypted)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.lockBttnBox);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.statusLocked, page.unlockBttnBox); // wallet not unlocked
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(syncStatus.txs !== undefined, page.txSyncBox);
        if (syncStatus.txs !== undefined) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txProgress, page.txFindingAddrs);
            if (syncStatus.txs === 0 && syncStatus.blocks >= syncStatus.targetHeight)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txFindingAddrs);
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txProgress);
                const prog = syncStatus.txs / syncStatus.targetHeight;
                page.txProgress.textContent = `${(prog * 100).toFixed(1)}%`;
            }
        }
    }
    updateFeeState(feeState) {
        const { page, selectedAssetID: assetID } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.feeStateBox);
        const { unitInfo: ui, token } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
        const fiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
        if (!fiatRate)
            return;
        const feeAssetID = token ? token.parentID : assetID;
        const feeFiatRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[feeAssetID];
        if (token && !feeFiatRate)
            return;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.feeStateBox);
        const feeUI = token ? (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID].unitInfo : ui;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestRateElement(page.feeStateNetRate, feeAssetID, feeState.rate, feeUI);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestValueElement(page.feeStateSendFees, feeAssetID, feeState.send, feeUI);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestValueElement(page.feeStateSwapFees, feeAssetID, feeState.swap, feeUI);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatBestValueElement(page.feeStateRedeemFees, feeAssetID, feeState.redeem, feeUI);
        page.feeStateXcRate.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(fiatRate);
        const sendFiat = feeState.send / feeUI.conventional.conversionFactor * feeFiatRate;
        page.feeStateSendFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(sendFiat);
        const swapFiat = feeState.swap / feeUI.conventional.conversionFactor * feeFiatRate;
        page.feeStateSwapFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(swapFiat);
        const redeemFiat = feeState.redeem / feeUI.conventional.conversionFactor * feeFiatRate;
        page.feeStateRedeemFiat.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(redeemFiat);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.feeStateBox);
    }
    checkNeedsProvider(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const needs = yield (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().needsCustomProvider(assetID);
            const { page: { needsProviderBox: box, needsProviderBttn: bttn } } = this;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(needs, box);
            if (!needs)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].blink(bttn);
        });
    }
    updateTicketBuyer(assetID) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            this.ticketPage = {
                number: 0,
                history: [],
                scanned: false
            };
            const { wallet, unitInfo: ui } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.stakingBox, page.pickVSP, page.stakingSummary, page.stakingErr, page.vspDisplayBox, page.ticketPriceBox, page.purchaseTicketsBox, page.stakingRpcSpvMsg, page.ticketsDisabled);
            if (!(wallet === null || wallet === void 0 ? void 0 : wallet.running) || (wallet.traits & traitTicketBuyer) === 0)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingBox);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.stakingBox);
            const res = yield this.safePost('/api/stakestatus', assetID);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                // Look for common error for RPC + SPV wallet.
                if (res.msg.includes('disconnected from consensus RPC')) {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingRpcSpvMsg);
                    return;
                }
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingErr);
                page.stakingErr.textContent = res.msg;
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingSummary, page.ticketPriceBox);
            const stakeStatus = res.status;
            this.stakeStatus = stakeStatus;
            page.stakingAgendaCount.textContent = String(stakeStatus.stances.agendas.length);
            page.stakingTspendCount.textContent = String(stakeStatus.stances.tspends.length);
            page.purchaserCurrentPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(stakeStatus.ticketPrice / ui.conventional.conversionFactor);
            page.purchaserBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(wallet.balance.available, ui);
            this.updateTicketStats(stakeStatus.stats, ui, stakeStatus.ticketPrice, stakeStatus.votingSubsidy);
            // If this is an extension wallet, we'll might to disable all controls.
            const disableStaking = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(this.selectedAssetID)) === null || _a === void 0 ? void 0 : _a.disableStaking;
            if (disableStaking) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.setVotes, page.showVSPs);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.ticketsDisabled);
                page.extensionModeAppName.textContent = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.extensionModeConfig.name;
                return;
            }
            this.setVSPViz(stakeStatus.vsp);
        });
    }
    setVSPViz(vsp) {
        const { page, stakeStatus } = this;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.vspDisplayBox);
        if (vsp) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.vspDisplayBox, page.purchaseTicketsBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.pickVSP);
            page.vspURL.textContent = vsp;
            return;
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!stakeStatus.isRPC, page.pickVSP);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(stakeStatus.isRPC, page.purchaseTicketsBox);
    }
    updateTicketStats(stats, ui, ticketPrice, votingSubsidy) {
        const { page, stakeStatus } = this;
        stakeStatus.stats = stats;
        if (ticketPrice)
            stakeStatus.ticketPrice = ticketPrice;
        if (votingSubsidy)
            stakeStatus.votingSubsidy = votingSubsidy;
        const liveTicketCount = stakeStatus.tickets.filter((tkt) => tkt.status <= ticketStatusLive && tkt.status >= ticketStatusUnmined).length;
        page.stakingTicketCount.textContent = String(liveTicketCount);
        page.immatureTicketCount.textContent = String(stats.mempool);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(stats.mempool > 0, page.immatureTicketCountBox);
        page.queuedTicketCount.textContent = String(stats.queued);
        page.formQueuedTix.textContent = String(stats.queued);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(stats.queued > 0, page.formQueueTixBox, page.queuedTicketCountBox);
        page.totalTicketCount.textContent = String(stats.ticketCount);
        page.totalTicketRewards.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(stats.totalRewards / ui.conventional.conversionFactor);
        page.totalTicketVotes.textContent = String(stats.votes);
        if (ticketPrice)
            page.ticketPrice.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(ticketPrice / ui.conventional.conversionFactor);
        if (votingSubsidy)
            page.votingSubsidy.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(votingSubsidy / ui.conventional.conversionFactor);
    }
    showVSPPicker() {
        return __awaiter(this, void 0, void 0, function* () {
            const assetID = this.selectedAssetID;
            const page = this.page;
            this.showForm(page.vspPicker);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.vspPickerList);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.stakingErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.vspPicker);
            const res = yield this.safePost('/api/listvsps', assetID);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingErr);
                page.stakingErr.textContent = res.msg;
                return;
            }
            const vsps = res.vsps;
            for (const vsp of vsps) {
                const row = page.vspRowTmpl.cloneNode(true);
                page.vspPickerList.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                tmpl.url.textContent = vsp.url;
                tmpl.feeRate.textContent = vsp.feePercentage.toFixed(2);
                tmpl.voting.textContent = String(vsp.voting);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => {
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.stakingErr);
                    this.setVSP(assetID, vsp);
                });
            }
        });
    }
    showPurchaseTicketsDialog() {
        const page = this.page;
        page.purchaserInput.value = '';
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.purchaserErr);
        this.showForm(this.page.purchaseTicketsForm);
        page.purchaserInput.focus();
    }
    purchaserInputChanged() {
        const page = this.page;
        const n = parseInt(page.purchaserInput.value || '0');
        if (n <= 1) {
            page.purchaserInput.value = '1';
            return;
        }
        page.purchaserInput.value = String(n);
    }
    purchaseTickets() {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, selectedAssetID: assetID } = this;
            // DRAFT NOTE: The user will get an actual ticket count somewhere in the
            // range 1 <= tickets_purchased <= n. See notes in
            // (*spvWallet).PurchaseTickets.
            // How do we handle this at the UI. Or do we handle it all in the backend
            // somehow?
            const n = parseInt(page.purchaserInput.value || '0');
            if (n < 1)
                return;
            // TODO: Add confirmation dialog.
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.purchaseTicketsForm);
            const res = yield this.safePost('/api/purchasetickets', { assetID, n });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.purchaserErr.textContent = res.msg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.purchaserErr);
                return;
            }
            this.showSuccess(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TICKETS_PURCHASED, { n: n.toLocaleString(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].languages()) }));
        });
    }
    processTicketPurchaseUpdate(walletNote) {
        const { stakeStatus, selectedAssetID, page } = this;
        const { assetID } = walletNote;
        const { err, remaining, tickets, stats } = walletNote.payload;
        if (assetID !== selectedAssetID)
            return;
        if (err) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.purchaseTicketsErrBox);
            page.purchaseTicketsErr.textContent = err;
            return;
        }
        if (tickets)
            stakeStatus.tickets = tickets.concat(stakeStatus.tickets);
        if (stats)
            this.updateTicketStats(stats, (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].unitInfo);
        stakeStatus.stats.queued = remaining;
        page.queuedTicketCount.textContent = String(remaining);
        page.formQueuedTix.textContent = String(remaining);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(remaining > 0, page.queuedTicketCountBox);
    }
    setVSP(assetID, vsp) {
        return __awaiter(this, void 0, void 0, function* () {
            this.closePopups();
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.stakingBox);
            const res = yield this.safePost('/api/setvsp', { assetID, url: vsp.url });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.stakingErr);
                page.stakingErr.textContent = res.msg;
                return;
            }
            this.setVSPViz(vsp.url);
        });
    }
    setCustomVSP() {
        const assetID = this.selectedAssetID;
        const vsp = { url: this.page.customVspUrl.value };
        this.setVSP(assetID, vsp);
    }
    pageOfTickets(pgNum) {
        const { stakeStatus, ticketPage } = this;
        let startOffset = pgNum * ticketPageSize;
        const pageOfTickets = [];
        if (startOffset < stakeStatus.tickets.length) {
            pageOfTickets.push(...stakeStatus.tickets.slice(startOffset, startOffset + ticketPageSize));
            if (pageOfTickets.length < ticketPageSize) {
                const need = ticketPageSize - pageOfTickets.length;
                pageOfTickets.push(...ticketPage.history.slice(0, need));
            }
        }
        else {
            startOffset -= stakeStatus.tickets.length;
            pageOfTickets.push(...ticketPage.history.slice(startOffset, startOffset + ticketPageSize));
        }
        return pageOfTickets;
    }
    displayTicketPage(pageNumber, pageOfTickets) {
        const { page, selectedAssetID: assetID } = this;
        const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID);
        const coinLink = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[assetID][(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.net];
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.ticketHistoryRows);
        page.ticketHistoryPage.textContent = String(pageNumber);
        for (const { tx, status } of pageOfTickets) {
            const tr = page.ticketHistoryRowTmpl.cloneNode(true);
            page.ticketHistoryRows.appendChild(tr);
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindUrlHandlers(tr);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(tr);
            tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(tx.stamp * 1000);
            tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(tx.ticketPrice, ui);
            tmpl.status.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(ticketStatusTranslationKeys[status]);
            tmpl.hashStart.textContent = tx.hash.slice(0, 6);
            tmpl.hashEnd.textContent = tx.hash.slice(-6);
            tmpl.detailsLinkUrl.setAttribute('href', coinLink(tx.hash));
        }
    }
    ticketPageN(pageNumber) {
        return __awaiter(this, void 0, void 0, function* () {
            const { page, stakeStatus, ticketPage, selectedAssetID: assetID } = this;
            const pageOfTickets = this.pageOfTickets(pageNumber);
            if (pageOfTickets.length < ticketPageSize && !ticketPage.scanned) {
                const n = ticketPageSize - pageOfTickets.length;
                const lastList = ticketPage.history.length > 0 ? ticketPage.history : stakeStatus.tickets;
                const scanStart = lastList.length > 0 ? lastList[lastList.length - 1].tx.blockHeight : scanStartMempool;
                const skipN = lastList.filter((tkt) => tkt.tx.blockHeight === scanStart).length;
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.ticketHistoryForm);
                const res = yield this.safePost('/api/ticketpage', { assetID, scanStart, n, skipN });
                loaded();
                if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                    console.error('error fetching ticket page', res.msg);
                    return;
                }
                this.ticketPage.history.push(...res.tickets);
                pageOfTickets.push(...res.tickets);
                if (res.tickets.length < n)
                    this.ticketPage.scanned = true;
            }
            const totalTix = stakeStatus.tickets.length + ticketPage.history.length;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(totalTix >= ticketPageSize, page.ticketHistoryPagination);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(totalTix > 0, page.ticketHistoryTable);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(totalTix === 0, page.noTicketsMessage);
            if (pageOfTickets.length === 0) {
                // Probably ended with a page of size ticketPageSize, so didn't know we
                // had hit the end until the user clicked the arrow and we went looking
                // for the next. Would be good to figure out a way to hide the arrow in
                // that case.
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.ticketHistoryNextPage);
                return;
            }
            this.displayTicketPage(pageNumber, pageOfTickets);
            ticketPage.number = pageNumber;
            const atEnd = pageNumber * ticketPageSize + pageOfTickets.length === totalTix;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!atEnd || !ticketPage.scanned, page.ticketHistoryNextPage);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(pageNumber > 0, page.ticketHistoryPrevPage);
        });
    }
    showTicketHistory() {
        return __awaiter(this, void 0, void 0, function* () {
            this.showForm(this.page.ticketHistoryForm);
            yield this.ticketPageN(this.ticketPage.number);
        });
    }
    nextTicketPage() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.ticketPageN(this.ticketPage.number + 1);
        });
    }
    prevTicketPage() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.ticketPageN(this.ticketPage.number - 1);
        });
    }
    showSetVotesDialog() {
        var _a;
        const { page, stakeStatus, selectedAssetID: assetID } = this;
        const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.votingFormErr);
        const coinLink = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[assetID][(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.net];
        const upperCase = (s) => s.charAt(0).toUpperCase() + s.slice(1);
        const setVotes = (req) => __awaiter(this, void 0, void 0, function* () {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.votingFormErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.votingForm);
            const res = yield this.safePost('/api/setvotes', req);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.votingFormErr);
                page.votingFormErr.textContent = res.msg;
                throw Error(res.msg);
            }
        });
        const setAgendaChoice = (agendaID, choiceID) => __awaiter(this, void 0, void 0, function* () {
            yield setVotes({ assetID, choices: { [agendaID]: choiceID } });
            for (const agenda of stakeStatus.stances.agendas)
                if (agenda.id === agendaID)
                    agenda.currentChoice = choiceID;
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.votingAgendas);
        for (const agenda of stakeStatus.stances.agendas) {
            const div = page.votingAgendaTmpl.cloneNode(true);
            page.votingAgendas.appendChild(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            tmpl.description.textContent = agenda.description;
            for (const choice of agenda.choices) {
                const div = page.votingChoiceTmpl.cloneNode(true);
                tmpl.choices.appendChild(div);
                const choiceTmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
                choiceTmpl.id.textContent = upperCase(choice.id);
                choiceTmpl.id.dataset.tooltip = choice.description;
                choiceTmpl.radio.value = choice.id;
                choiceTmpl.radio.name = agenda.id;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(choiceTmpl.radio, 'change', () => {
                    if (!choiceTmpl.radio.checked)
                        return;
                    setAgendaChoice(agenda.id, choice.id);
                });
                if (choice.id === agenda.currentChoice)
                    choiceTmpl.radio.checked = true;
            }
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindTooltips(tmpl.choices);
        }
        const setTspendVote = (txHash, policyID) => __awaiter(this, void 0, void 0, function* () {
            yield setVotes({ assetID, tSpendPolicy: { [txHash]: policyID } });
            for (const tspend of stakeStatus.stances.tspends)
                if (tspend.hash === txHash)
                    tspend.currentPolicy = policyID;
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.votingTspends);
        for (const tspend of stakeStatus.stances.tspends) {
            const div = page.tspendTmpl.cloneNode(true);
            page.votingTspends.appendChild(div);
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindUrlHandlers(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            for (const opt of [tmpl.yes, tmpl.no]) {
                opt.name = tspend.hash;
                if (tspend.currentPolicy === opt.value)
                    opt.checked = true;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(opt, 'change', () => {
                    var _a;
                    if (!opt.checked)
                        return;
                    setTspendVote(tspend.hash, (_a = opt.value) !== null && _a !== void 0 ? _a : '');
                });
            }
            if (tspend.value > 0)
                tmpl.value.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(tspend.value / ui.conventional.conversionFactor);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.value);
            tmpl.hash.textContent = tspend.hash;
            tmpl.explorerLink.setAttribute('href', coinLink(tspend.hash));
        }
        const setTKeyPolicy = (key, policy) => __awaiter(this, void 0, void 0, function* () {
            yield setVotes({ assetID, treasuryPolicy: { [key]: policy } });
            for (const tkey of stakeStatus.stances.treasuryKeys)
                if (tkey.key === key)
                    tkey.policy = policy;
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.votingTKeys);
        for (const keyPolicy of ((_a = stakeStatus.stances.treasuryKeys) !== null && _a !== void 0 ? _a : [])) {
            const div = page.tkeyTmpl.cloneNode(true);
            page.votingTKeys.appendChild(div);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(div);
            for (const opt of [tmpl.yes, tmpl.no]) {
                opt.name = keyPolicy.key;
                if (keyPolicy.policy === opt.value)
                    opt.checked = true;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(opt, 'change', () => {
                    var _a;
                    if (!opt.checked)
                        return;
                    setTKeyPolicy(keyPolicy.key, (_a = opt.value) !== null && _a !== void 0 ? _a : '');
                });
            }
            tmpl.key.textContent = keyPolicy.key;
        }
        this.showForm(page.votingForm);
    }
    updatePrivacy(assetID) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const disablePrivacy = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(assetID)) === null || _a === void 0 ? void 0 : _a.disablePrivacy;
            this.mixing = false;
            const { wallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mixingBox, page.mixerOff, page.mixerOn);
            // TODO: Show special messaging if the asset supports mixing but not this
            // wallet type.
            if (disablePrivacy || !(wallet === null || wallet === void 0 ? void 0 : wallet.running) || (wallet.traits & traitFundsMixer) === 0)
                return;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixingBox, page.mixerLoading);
            const res = yield this.safePost('/api/mixingstats', { assetID });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mixerLoading);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixingErr);
                page.mixingErr.textContent = res.msg;
                return;
            }
            this.mixing = res.stats.enabled;
            if (this.mixing)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixerOn);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixerOff);
            this.mixerToggle.setState(this.mixing);
        });
    }
    updateMixerState(on) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.mixingErr);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.mixingBox);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/configuremixer', { assetID: this.selectedAssetID, enabled: on });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.mixingErr.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_API_ERROR, { msg: res.msg });
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.mixingErr);
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(on, page.mixerOn);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!on, page.mixerOff);
            this.mixerToggle.setState(on);
        });
    }
    updateDisplayedAssetBalance() {
        var _a, _b, _c;
        const page = this.page;
        const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
        const { wallet, unitInfo: ui, id: assetID } = asset;
        const bal = wallet.balance;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.balanceBox, page.walletDetails);
        const totalLocked = bal.locked + bal.contractlocked + bal.bondlocked;
        const totalBalance = bal.available + totalLocked + bal.immature;
        page.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(totalBalance, ui);
        page.balanceUnit.textContent = ui.conventional.unit;
        const rate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
        if (rate) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.fiatBalanceBox);
            page.fiatBalance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFiatConversion(totalBalance, rate, ui);
        }
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.balanceDetailBox);
        const addBalanceRow = (cat, bal, tooltipMsg) => {
            const row = page.balanceDetailRow.cloneNode(true);
            page.balanceDetailBox.appendChild(row);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            tmpl.name.textContent = cat;
            if (tooltipMsg) {
                tmpl.tooltipMsg.dataset.tooltip = tooltipMsg;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(tmpl.tooltipMsg);
            }
            tmpl.balance.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(bal, ui);
            return row;
        };
        let lastSubLockedRow;
        let lastPrimaryRow;
        const addPrimaryBalance = (cat, bal, tooltipMsg) => {
            lastSubLockedRow = undefined;
            lastPrimaryRow = addBalanceRow(cat, bal, tooltipMsg);
        };
        const addSubBalance = (cat, bal, tooltipMsg) => {
            lastSubLockedRow = addBalanceRow(cat, bal, tooltipMsg);
            lastSubLockedRow.classList.add('sub');
        };
        const setRowClasses = () => {
            if (!lastSubLockedRow)
                return;
            lastPrimaryRow.classList.add('itemized');
            lastSubLockedRow.classList.add('last');
        };
        addPrimaryBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_AVAILABLE_TITLE), bal.available, '');
        if (((_a = bal.other) === null || _a === void 0 ? void 0 : _a.Shielded) !== undefined) {
            const transparent = bal.available - bal.other.Shielded.amt;
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_TRANSPARENT), transparent);
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SHIELDED), bal.other.Shielded.amt);
        }
        setRowClasses();
        addPrimaryBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_TITLE), totalLocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_BAL_MSG));
        if (bal.orderlocked > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_ORDER), bal.orderlocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_ORDER_BAL_MSG));
        if (bal.contractlocked > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SWAPPING), bal.contractlocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_SWAPPING_BAL_MSG));
        if (bal.bondlocked > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_BONDED), bal.bondlocked, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_LOCKED_BOND_BAL_MSG));
        if (bal.bondReserves > 0)
            addSubBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_BOND_RESERVES), bal.bondReserves, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_BOND_RESERVES_MSG));
        if (((_b = bal === null || bal === void 0 ? void 0 : bal.other) === null || _b === void 0 ? void 0 : _b.Staked) !== undefined)
            addSubBalance('Staked', bal.other.Staked.amt);
        setRowClasses();
        if (bal.immature)
            addPrimaryBalance(_locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_IMMATURE_TITLE), bal.immature, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_IMMATURE_BAL_MSG));
        if (((_c = bal === null || bal === void 0 ? void 0 : bal.other) === null || _c === void 0 ? void 0 : _c.Unmixed) !== undefined)
            addSubBalance('Unmixed', bal.other.Unmixed.amt);
        setRowClasses();
        // TODO: handle reserves deficit with a notification.
        // if (bal.reservesDeficit > 0) addPrimaryBalance(intl.prep(intl.ID_RESERVES_DEFICIT), bal.reservesDeficit, intl.prep(intl.ID_RESERVES_DEFICIT_MSG))
        page.purchaserBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(bal.available / ui.conventional.conversionFactor);
        (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindTooltips(page.balanceDetailBox);
    }
    showAvailableMarkets(assetID) {
        const page = this.page;
        const exchanges = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().user.exchanges;
        const markets = [];
        for (const xc of Object.values(exchanges)) {
            if (!xc.markets)
                continue;
            for (const mkt of Object.values(xc.markets)) {
                if (mkt.baseid === assetID || mkt.quoteid === assetID)
                    markets.push([xc.host, xc, mkt]);
            }
        }
        const spotVolume = (assetID, mkt) => {
            const spot = mkt.spot;
            if (!spot)
                return 0;
            const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID).conventional.conversionFactor;
            const volume = assetID === mkt.baseid ? spot.vol24 : spot.vol24 * spot.rate / _orderutil__WEBPACK_IMPORTED_MODULE_6__.RateEncodingFactor;
            return volume / conversionFactor;
        };
        markets.sort((a, b) => {
            const [hostA, , mktA] = a;
            const [hostB, , mktB] = b;
            if (!mktA.spot && !mktB.spot)
                return hostA.localeCompare(hostB);
            return spotVolume(assetID, mktB) - spotVolume(assetID, mktA);
        });
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.availableMarkets);
        for (const [host, xc, mkt] of markets) {
            const { spot, baseid, basesymbol, quoteid, quotesymbol } = mkt;
            const row = page.marketRow.cloneNode(true);
            page.availableMarkets.appendChild(row);
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
            tmpl.host.textContent = host;
            tmpl.baseLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(basesymbol);
            tmpl.quoteLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(quotesymbol);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.baseSymbol, tmpl.quoteSymbol);
            tmpl.baseSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(xc.assets[baseid], true));
            tmpl.quoteSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(xc.assets[quoteid], true));
            if (spot) {
                const convRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().conventionalRate(baseid, quoteid, spot.rate, exchanges[host]);
                tmpl.price.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(convRate);
                const fmtSymbol = (s) => s.split('.')[0].toUpperCase();
                tmpl.priceQuoteUnit.textContent = fmtSymbol(quotesymbol);
                tmpl.priceBaseUnit.textContent = fmtSymbol(basesymbol);
                tmpl.volume.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFourSigFigs(spotVolume(assetID, mkt));
                tmpl.volumeUnit.textContent = assetID === baseid ? fmtSymbol(basesymbol) : fmtSymbol(quotesymbol);
            }
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(tmpl.priceBox, tmpl.volumeBox);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loadPage('markets', { host, baseID: baseid, quoteID: quoteid }));
        }
        page.marketsOverviewBox.classList.remove('invisible');
    }
    showRecentActivity(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.orderActivityBox);
            const filter = {
                n: 20,
                assets: [assetID],
                hosts: [],
                statuses: []
            };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/orders', filter);
            loaded();
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.noActivity, page.orderActivity);
            if (!res.orders || res.orders.length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noActivity);
                page.orderActivityBox.classList.remove('invisible');
                return;
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.orderActivity);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.recentOrders);
            for (const ord of res.orders) {
                const row = page.recentOrderTmpl.cloneNode(true);
                page.recentOrders.appendChild(row);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
                let from, to;
                const [baseUnitInfo, quoteUnitInfo] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(ord.baseID), (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(ord.quoteID)];
                if (ord.sell) {
                    [from, to] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.baseID], (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.quoteID]];
                    tmpl.fromQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_6__.Limit) {
                        tmpl.toQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_6__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                    }
                }
                else {
                    [from, to] = [(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.quoteID], (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[ord.baseID]];
                    if (ord.type === _orderutil__WEBPACK_IMPORTED_MODULE_6__.Market) {
                        tmpl.fromQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                    }
                    else {
                        tmpl.fromQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty / _orderutil__WEBPACK_IMPORTED_MODULE_6__.RateEncodingFactor * ord.rate, quoteUnitInfo);
                        tmpl.toQty.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(ord.qty, baseUnitInfo);
                    }
                }
                tmpl.fromLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(from.symbol);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(tmpl.fromSymbol, tmpl.toSymbol);
                tmpl.fromSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(from, true));
                tmpl.toLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(to.symbol);
                tmpl.toSymbol.appendChild(_doc__WEBPACK_IMPORTED_MODULE_0__["default"].symbolize(to, true));
                tmpl.status.textContent = _orderutil__WEBPACK_IMPORTED_MODULE_6__.statusString(ord);
                tmpl.filled.textContent = `${(_orderutil__WEBPACK_IMPORTED_MODULE_6__.filled(ord) / ord.qty * 100).toFixed(1)}%`;
                tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(ord.submitTime);
                tmpl.link.href = `order/${ord.id}`;
                (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().bindInternalNavigation(row);
            }
            page.orderActivityBox.classList.remove('invisible');
        });
    }
    updateTxHistoryRow(row, tx, assetID) {
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
        let amtAssetID = assetID;
        let feesAssetID = assetID;
        if (tx.tokenID) {
            amtAssetID = tx.tokenID;
            if (assetID !== tx.tokenID)
                feesAssetID = assetID;
            else {
                const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
                if (asset.token)
                    feesAssetID = asset.token.parentID;
                else
                    console.error(`unable to determine fee asset for tx ${tx.id}`);
            }
        }
        const amtAssetUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(amtAssetID);
        const feesAssetUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(feesAssetID);
        tmpl.age.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].timeSince(tx.timestamp * 1000);
        tmpl.age.dataset.timestamp = String(tx.timestamp * 1000);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.timestamp === 0, tmpl.pending);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.timestamp !== 0, tmpl.age);
        if (tx.timestamp > 0)
            tmpl.age.dataset.stamp = String(tx.timestamp);
        let txType = txTypeString(tx.type);
        if (tx.tokenID && tx.tokenID !== assetID) {
            const tokenAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[tx.tokenID];
            const tokenSymbol = tokenAsset.unitInfo.conventional.unit;
            txType = `${tokenSymbol} ${txType}`;
        }
        tmpl.type.textContent = txType;
        tmpl.id.textContent = trimStringWithEllipsis(tx.id, 12);
        tmpl.id.setAttribute('title', tx.id);
        tmpl.fees.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.fees, feesAssetUI);
        if (noAmtTxTypes.includes(tx.type)) {
            tmpl.amount.textContent = '-';
        }
        else {
            const [u, c] = txTypeSignAndClass(tx.type);
            const amt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.amount, amtAssetUI);
            tmpl.amount.textContent = `${u}${amt}`;
            if (c !== '')
                tmpl.amount.classList.add(c);
        }
    }
    txHistoryRow(tx, assetID) {
        const row = this.page.txHistoryRowTmpl.cloneNode(true);
        row.dataset.txid = tx.id;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].bind(row, 'click', () => this.showTxDetailsPopup(tx.id));
        this.updateTxHistoryRow(row, tx, assetID);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
        this.stampers.push(tmpl.age);
        return row;
    }
    txHistoryDateRow(date) {
        const row = this.page.txHistoryDateRowTmpl.cloneNode(true);
        const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(row);
        tmpl.date.textContent = date;
        return row;
    }
    setTxDetailsPopupElements(tx) {
        const page = this.page;
        // Block explorer
        const assetExplorer = _coinexplorers__WEBPACK_IMPORTED_MODULE_8__.CoinExplorers[this.selectedAssetID];
        if (assetExplorer && assetExplorer[net]) {
            page.txViewBlockExplorer.href = assetExplorer[net](tx.id);
        }
        // Tx type
        let txType = txTypeString(tx.type);
        if (tx.tokenID && tx.tokenID !== this.selectedAssetID) {
            const tokenSymbol = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[tx.tokenID].symbol.split('.')[0].toUpperCase();
            txType = `${tokenSymbol} ${txType}`;
        }
        page.txDetailsType.textContent = txType;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.type === txTypeSwapOrSend, page.txTypeTooltip);
        page.txTypeTooltip.dataset.tooltip = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SWAP_OR_SEND_TOOLTIP);
        // Amount
        if (noAmtTxTypes.includes(tx.type)) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsAmtSection);
        }
        else {
            let assetID = this.selectedAssetID;
            if (tx.tokenID)
                assetID = tx.tokenID;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsAmtSection);
            const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID);
            const amt = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.amount, ui);
            const [s, c] = txTypeSignAndClass(tx.type);
            page.txDetailsAmount.textContent = `${s}${amt} ${ui.conventional.unit}`;
            if (c !== '')
                page.txDetailsAmount.classList.add(c);
        }
        // Fee
        let feeAsset = this.selectedAssetID;
        if (tx.tokenID !== undefined) {
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[tx.tokenID];
            if (asset.token) {
                feeAsset = asset.token.parentID;
            }
            else {
                console.error(`wallet transaction ${tx.id} is supposed to be a token tx, but asset ${tx.tokenID} is not a token`);
            }
        }
        const feeUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(feeAsset);
        const fee = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatCoinValue(tx.fees, feeUI);
        page.txDetailsFee.textContent = `${fee} ${feeUI.conventional.unit}`;
        // Time / block number
        page.txDetailsBlockNumber.textContent = `${tx.blockNumber}`;
        const date = new Date(tx.timestamp * 1000);
        const dateStr = date.toLocaleDateString();
        const timeStr = date.toLocaleTimeString();
        page.txDetailsTimestamp.textContent = `${dateStr} ${timeStr}`;
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.blockNumber === 0, page.timestampPending, page.blockNumberPending);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.blockNumber !== 0, page.txDetailsBlockNumber, page.txDetailsTimestamp);
        // Tx ID
        page.txDetailsID.textContent = trimStringWithEllipsis(tx.id, 20);
        page.txDetailsID.setAttribute('title', tx.id);
        // Recipient
        if (tx.recipient) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsRecipientSection);
            page.txDetailsRecipient.textContent = trimStringWithEllipsis(tx.recipient, 20);
            page.txDetailsRecipient.setAttribute('title', tx.recipient);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsRecipientSection);
        }
        // Bond Info
        if (tx.bondInfo) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsBondIDSection, page.txDetailsBondLocktimeSection);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(tx.bondInfo.accountID !== '', page.txDetailsBondAccountIDSection);
            page.txDetailsBondID.textContent = trimStringWithEllipsis(tx.bondInfo.bondID, 20);
            page.txDetailsBondID.setAttribute('title', tx.bondInfo.bondID);
            const date = new Date(tx.bondInfo.lockTime * 1000);
            const dateStr = date.toLocaleDateString();
            const timeStr = date.toLocaleTimeString();
            page.txDetailsBondLocktime.textContent = `${dateStr} ${timeStr}`;
            page.txDetailsBondAccountID.textContent = trimStringWithEllipsis(tx.bondInfo.accountID, 20);
            page.txDetailsBondAccountID.setAttribute('title', tx.bondInfo.accountID);
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsBondIDSection, page.txDetailsBondLocktimeSection, page.txDetailsBondAccountIDSection);
        }
        // Nonce
        if (tx.additionalData && tx.additionalData.Nonce) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txDetailsNonceSection);
            page.txDetailsNonce.textContent = `${tx.additionalData.Nonce}`;
        }
        else {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txDetailsNonceSection);
        }
    }
    showTxDetailsPopup(id) {
        const tx = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().getWalletTx(this.selectedAssetID, id);
        if (!tx) {
            console.error(`wallet transaction ${id} not found`);
            return;
        }
        this.currTx = tx;
        this.setTxDetailsPopupElements(tx);
        this.showForm(this.page.txDetails);
    }
    txHistoryTableNewestDate() {
        if (this.page.txHistoryTableBody.children.length >= 1) {
            const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(this.page.txHistoryTableBody.children[0]);
            return tmpl.date.textContent || '';
        }
        return '';
    }
    txDate(tx) {
        if (tx.timestamp === 0) {
            return (new Date()).toLocaleDateString();
        }
        return (new Date(tx.timestamp * 1000)).toLocaleDateString();
    }
    handleTxNote(tx, newTx) {
        var _a;
        const w = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID].wallet;
        const hideMixing = (w.traits & traitFundsMixer) !== 0 && !!this.page.hideMixTxs.checked;
        if (hideMixing && tx.type === txTypeMixing)
            return;
        if (newTx) {
            if (!this.oldestTx) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.txHistoryTable);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.noTxHistory);
                this.page.txHistoryTableBody.appendChild(this.txHistoryDateRow(this.txDate(tx)));
                this.page.txHistoryTableBody.appendChild(this.txHistoryRow(tx, this.selectedAssetID));
                this.oldestTx = tx;
            }
            else if (this.txDate(tx) !== this.txHistoryTableNewestDate()) {
                this.page.txHistoryTableBody.insertBefore(this.txHistoryRow(tx, this.selectedAssetID), this.page.txHistoryTableBody.children[0]);
                this.page.txHistoryTableBody.insertBefore(this.txHistoryDateRow(this.txDate(tx)), this.page.txHistoryTableBody.children[0]);
            }
            else {
                this.page.txHistoryTableBody.insertBefore(this.txHistoryRow(tx, this.selectedAssetID), this.page.txHistoryTableBody.children[1]);
            }
            return;
        }
        for (const row of this.page.txHistoryTableBody.children) {
            const peRow = row;
            if (peRow.dataset.txid === tx.id) {
                this.updateTxHistoryRow(peRow, tx, this.selectedAssetID);
                break;
            }
        }
        if (tx.id === ((_a = this.currTx) === null || _a === void 0 ? void 0 : _a.id)) {
            this.setTxDetailsPopupElements(tx);
        }
    }
    getTxHistory(assetID, hideMixTxs, after) {
        return __awaiter(this, void 0, void 0, function* () {
            let numToFetch = 10;
            if (hideMixTxs)
                numToFetch = 15;
            const res = { txs: [], lastTx: false };
            let ref = after;
            for (let i = 0; i < 40; i++) {
                const currRes = yield (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().txHistory(assetID, numToFetch, ref);
                if (currRes.txs.length > 0) {
                    ref = currRes.txs[currRes.txs.length - 1].id;
                }
                let txs = currRes.txs;
                if (hideMixTxs) {
                    txs = txs.filter((tx) => tx.type !== txTypeMixing);
                }
                if (res.txs.length + txs.length > 10) {
                    const numToPush = 10 - res.txs.length;
                    res.txs.push(...txs.slice(0, numToPush));
                }
                else {
                    if (currRes.lastTx)
                        res.lastTx = true;
                    res.txs.push(...txs);
                }
                if (res.txs.length >= 10 || currRes.lastTx)
                    break;
            }
            return res;
        });
    }
    showTxHistory(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            let txRes;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.txHistoryTable, page.txHistoryBox, page.noTxHistory, page.earlierTxs, page.txHistoryNotAvailable, page.hideMixTxs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.txHistoryTableBody);
            const w = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].wallet;
            if (!w || w.disabled || (w.traits & traitHistorian) === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txHistoryNotAvailable);
                return;
            }
            this.oldestTx = undefined;
            const isMixing = (w.traits & traitFundsMixer) !== 0;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(isMixing, page.hideMixTxs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txHistoryBox);
            try {
                const hideMixing = isMixing && !!page.hideMixTxsCheckbox.checked;
                txRes = yield this.getTxHistory(assetID, hideMixing);
            }
            catch (err) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noTxHistory);
                return;
            }
            if (txRes.txs.length === 0) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.noTxHistory);
                return;
            }
            let oldestDate = this.txDate(txRes.txs[0]);
            page.txHistoryTableBody.appendChild(this.txHistoryDateRow(oldestDate));
            for (const tx of txRes.txs) {
                const date = this.txDate(tx);
                if (date !== oldestDate) {
                    oldestDate = date;
                    page.txHistoryTableBody.appendChild(this.txHistoryDateRow(date));
                }
                const row = this.txHistoryRow(tx, assetID);
                page.txHistoryTableBody.appendChild(row);
            }
            this.oldestTx = txRes.txs[txRes.txs.length - 1];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.txHistoryTable);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!txRes.lastTx, page.earlierTxs);
        });
    }
    loadEarlierTxs() {
        return __awaiter(this, void 0, void 0, function* () {
            if (!this.oldestTx)
                return;
            const page = this.page;
            let txRes;
            const w = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID].wallet;
            const hideMixing = (w.traits & traitFundsMixer) !== 0 && !!page.hideMixTxsCheckbox.checked;
            try {
                txRes = yield this.getTxHistory(this.selectedAssetID, hideMixing, this.oldestTx.id);
            }
            catch (err) {
                console.error(err);
                return;
            }
            let oldestDate = this.txDate(this.oldestTx);
            for (const tx of txRes.txs) {
                const date = this.txDate(tx);
                if (date !== oldestDate) {
                    oldestDate = date;
                    page.txHistoryTableBody.appendChild(this.txHistoryDateRow(date));
                }
                const row = this.txHistoryRow(tx, this.selectedAssetID);
                page.txHistoryTableBody.appendChild(row);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(!txRes.lastTx, page.earlierTxs);
            if (txRes.txs.length > 0) {
                this.oldestTx = txRes.txs[txRes.txs.length - 1];
            }
        });
    }
    rescanWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.reconfigErr);
            const url = '/api/rescanwallet';
            const req = { assetID: assetID };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if (res.code === _http__WEBPACK_IMPORTED_MODULE_2__.Errors.activeOrdersErr) {
                this.forceUrl = url;
                this.forceReq = req;
                this.showConfirmForce();
                return;
            }
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.reconfigErr, res.msg);
                return;
            }
            this.assetUpdated(assetID, page.reconfigForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_RESCAN_STARTED));
        });
    }
    showConfirmForce() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.confirmForceErr);
        this.showForm(this.page.confirmForce);
    }
    showRecoverWallet() {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.recoverWalletErr);
        this.showForm(this.page.recoverWalletConfirm);
    }
    /* Show the open wallet form if the password is not cached, and otherwise
     * attempt to open the wallet.
     */
    openWallet(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const open = {
                assetID: assetID
            };
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/openwallet', open);
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                console.error('openwallet error', res);
                return;
            }
            this.assetUpdated(assetID, undefined, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_UNLOCKED));
        });
    }
    /* Show the form used to change wallet configuration settings. */
    showReconfig(assetID, cfg) {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.changeWalletType, page.changeTypeHideIcon, page.reconfigErr, page.showChangeType, page.changeTypeHideIcon, page.reconfigErr, page.enableWallet, page.disableWallet);
            // Hide update password section by default
            this.changeWalletPW = false;
            this.setPWSettingViz(this.changeWalletPW);
            const asset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            const currentDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().currentWalletDefinition(assetID);
            const walletDefs = asset.token ? [asset.token.definition] : asset.info ? asset.info.availablewallets : [];
            const disableWalletType = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(assetID)) === null || _a === void 0 ? void 0 : _a.disableWalletType;
            if (walletDefs.length > 1 && !disableWalletType) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.changeWalletTypeSelect);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.showChangeType, page.changeTypeShowIcon);
                page.changeTypeMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CHANGE_WALLET_TYPE);
                for (const wDef of walletDefs) {
                    const option = document.createElement('option');
                    if (wDef.type === currentDef.type)
                        option.selected = true;
                    option.value = option.textContent = wDef.type;
                    page.changeWalletTypeSelect.appendChild(option);
                }
            }
            if (cfg === null || cfg === void 0 ? void 0 : cfg.elevateProviders) {
                for (const opt of (currentDef.configopts))
                    if (opt.key === 'providers')
                        opt.required = true;
            }
            const wallet = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitLogFiler, page.downloadLogs);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitRecoverer, page.recoverWallet);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitRestorer, page.exportWallet);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitRescanner, page.rescanWallet);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitPeerManager && !wallet.disabled, page.managePeers);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitTokenApprover && !wallet.disabled, page.unapproveTokenAllowance);
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].setVis(wallet.traits & traitsExtraOpts, page.otherActionsLabel);
            if (wallet.disabled)
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.enableWallet);
            else
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.disableWallet);
            this.showOrHideRecoverySupportMsg(wallet, currentDef.seeded);
            page.recfgAssetLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(asset.symbol);
            page.recfgAssetName.textContent = asset.name;
            if (!(cfg === null || cfg === void 0 ? void 0 : cfg.skipAnimation))
                this.showForm(page.reconfigForm);
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.reconfigForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/walletsettings', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.reconfigErr, res.msg);
                return;
            }
            const assetHasActiveOrders = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().haveActiveOrders(assetID);
            this.reconfigForm.update(asset.id, currentDef.configopts || [], assetHasActiveOrders);
            this.setGuideLink(currentDef.guidelink);
            this.reconfigForm.setConfig(res.map);
            this.updateDisplayedReconfigFields(currentDef);
        });
    }
    showOrHideRecoverySupportMsg(wallet, seeded) {
        this.setRecoverySupportMsgViz(seeded && !wallet.running && !wallet.disabled && Boolean(wallet.traits & traitRecoverer), wallet.symbol);
    }
    setRecoverySupportMsgViz(viz, symbol) {
        const page = this.page;
        if (viz) {
            page.reconfigSupportMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_WALLET_RECOVERY_SUPPORT_MSG, { walletSymbol: symbol.toLocaleUpperCase() });
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.reconfigSupportMsg);
            page.submitReconfig.setAttribute('disabled', '');
            page.submitReconfig.classList.add('grey');
            return;
        }
        page.submitReconfig.removeAttribute('disabled');
        page.submitReconfig.classList.remove('grey');
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.reconfigSupportMsg);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.reconfigSupportMsg);
    }
    changeWalletType() {
        const page = this.page;
        const walletType = page.changeWalletTypeSelect.value || '';
        const walletDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletDefinition(this.selectedAssetID, walletType);
        this.reconfigForm.update(this.selectedAssetID, walletDef.configopts || [], false);
        const wallet = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[this.selectedAssetID];
        const currentDef = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().currentWalletDefinition(this.selectedAssetID);
        if (walletDef.type !== currentDef.type)
            this.setRecoverySupportMsgViz(false, wallet.symbol);
        else
            this.showOrHideRecoverySupportMsg(wallet, walletDef.seeded);
        this.setGuideLink(walletDef.guidelink);
        this.updateDisplayedReconfigFields(walletDef);
    }
    setGuideLink(guideLink) {
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.walletCfgGuide);
        if (guideLink !== '') {
            this.walletCfgGuide.href = guideLink;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.walletCfgGuide);
        }
    }
    updateDisplayedReconfigFields(walletDef) {
        var _a;
        const disablePassword = (_a = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().extensionWallet(this.selectedAssetID)) === null || _a === void 0 ? void 0 : _a.disablePassword;
        if (walletDef.seeded || walletDef.type === 'token' || disablePassword) {
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(this.page.showChangePW, this.reconfigForm.fileSelector);
            this.changeWalletPW = false;
            this.setPWSettingViz(false);
        }
        else
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(this.page.showChangePW, this.reconfigForm.fileSelector);
    }
    /* Display a deposit address. */
    showDeposit(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            this.depositAddrForm.setAsset(assetID);
            this.showForm(this.page.deposit);
        });
    }
    /* Show the form to either send or withdraw funds. */
    showSendForm(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const box = page.sendForm;
            const { wallet, unitInfo: ui, symbol, token } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.toggleSubtract);
            page.subtractCheckBox.checked = false;
            const isWithdrawer = (wallet.traits & traitWithdrawer) !== 0;
            if (isWithdrawer) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.toggleSubtract);
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.validAddr, page.sendErr, page.maxSendDisplay, page.sendTokenMsgBox);
            page.sendAddr.classList.remove('invalid');
            page.sendAddr.value = '';
            page.sendAmt.value = '';
            const xcRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, 0, xcRate, ui);
            page.walletBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(wallet.balance.available, ui);
            page.sendLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(symbol);
            page.sendName.textContent = ui.conventional.unit;
            if (token) {
                const parentAsset = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID];
                page.sendTokenParentLogo.src = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].logoPath(parentAsset.symbol);
                page.sendTokenParentName.textContent = parentAsset.name;
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.sendTokenMsgBox);
            }
            // page.sendFee.textContent = wallet.feerate
            // page.sendUnit.textContent = wallet.units
            if (wallet.balance.available > 0 && (wallet.traits & traitTxFeeEstimator) !== 0) {
                const feeReq = {
                    assetID: assetID,
                    subtract: isWithdrawer,
                    maxWithdraw: true,
                    value: wallet.balance.available
                };
                const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(this.body);
                const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/txfee', feeReq);
                loaded();
                if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                    let canSend = wallet.balance.available;
                    if (!token) {
                        canSend -= res.txfee;
                        if (canSend < 0)
                            canSend = 0;
                    }
                    this.maxSend = canSend;
                    page.maxSend.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(canSend, ui);
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.maxSendFiat, canSend, xcRate, ui);
                    if (token) {
                        const feeUI = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[token.parentID].unitInfo;
                        page.maxSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(res.txfee, feeUI) + ' ' + feeUI.conventional.unit;
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.maxSendFeeFiat, res.txfee, (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[token.parentID], feeUI);
                    }
                    else {
                        page.maxSendFee.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(res.txfee, ui);
                        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.maxSendFeeFiat, res.txfee, xcRate, ui);
                    }
                    _doc__WEBPACK_IMPORTED_MODULE_0__["default"].show(page.maxSendDisplay);
                }
            }
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, 0, xcRate, ui);
            page.walletBal.textContent = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].formatFullPrecision(wallet.balance.available, ui);
            box.dataset.assetID = String(assetID);
            this.showForm(box);
        });
    }
    /* doConnect connects to a wallet via the connectwallet API route. */
    doConnect(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(this.body);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/connectwallet', { assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                const { symbol } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID];
                const page = this.page;
                page.errorModalMsg.textContent = _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_CONNECT_WALLET_ERR_MSG, { assetName: symbol, errMsg: res.msg });
                this.showForm(page.errorModal);
            }
            this.updateDisplayedAsset(assetID);
        });
    }
    assetUpdated(assetID, oldForm, successMsg) {
        if (assetID !== this.selectedAssetID)
            return;
        this.updateDisplayedAsset(assetID);
        if (oldForm && Object.is(this.currentForm, oldForm)) {
            if (successMsg)
                this.showSuccess(successMsg);
            else
                this.closePopups();
        }
    }
    /* populateMaxSend populates the amount field with the max amount the wallet
       can send. The max send amount can be the maximum amount based on our
       pre-estimation or the asset's wallet balance.
    */
    populateMaxSend() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const { id: assetID, unitInfo: ui, wallet } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[this.selectedAssetID];
            // Populate send amount with max send value and ensure we don't check
            // subtract checkbox for assets that don't have a withdraw method.
            const xcRate = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().fiatRatesMap[assetID];
            if ((wallet.traits & traitWithdrawer) === 0) {
                page.sendAmt.value = String(this.maxSend / ui.conventional.conversionFactor);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, this.maxSend, xcRate, ui);
                page.subtractCheckBox.checked = false;
            }
            else {
                const amt = wallet.balance.available;
                page.sendAmt.value = String(amt / ui.conventional.conversionFactor);
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFiatValue(page.sendValue, amt, xcRate, ui);
                page.subtractCheckBox.checked = true;
            }
        });
    }
    /* send submits the send form to the API. */
    send() {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const assetID = parseInt((_a = page.sendForm.dataset.assetID) !== null && _a !== void 0 ? _a : '');
            const subtract = (_b = page.subtractCheckBox.checked) !== null && _b !== void 0 ? _b : false;
            const conversionFactor = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(assetID).conventional.conversionFactor;
            const pw = page.vSendPw.value || '';
            page.vSendPw.value = '';
            if (pw === '') {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.vSendErr, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_NO_PASS_ERROR_MSG));
                return;
            }
            const open = {
                assetID: assetID,
                address: page.sendAddr.value,
                subtract: subtract,
                value: Math.round((0,_doc__WEBPACK_IMPORTED_MODULE_0__.parseFloatDefault)(page.sendAmt.value) * conversionFactor),
                pw: pw
            };
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.vSendForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/send', open);
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.vSendErr, res.msg);
                return;
            }
            const name = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().assets[assetID].name;
            this.assetUpdated(assetID, page.vSendForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_SEND_SUCCESS, { assetName: name }));
        });
    }
    /* update wallet configuration */
    reconfig() {
        var _a;
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const assetID = this.selectedAssetID;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.reconfigErr);
            let walletType = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().currentWalletDefinition(assetID).type;
            if (!_doc__WEBPACK_IMPORTED_MODULE_0__["default"].isHidden(page.changeWalletType)) {
                walletType = page.changeWalletTypeSelect.value || '';
            }
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.reconfigForm);
            const req = {
                assetID: assetID,
                config: this.reconfigForm.map(assetID),
                walletType: walletType
            };
            if (this.changeWalletPW)
                req.newWalletPW = page.newPW.value;
            const res = yield this.safePost('/api/reconfigurewallet', req);
            page.newPW.value = '';
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.reconfigErr, res.msg);
                return;
            }
            if ((_a = this.data) === null || _a === void 0 ? void 0 : _a.goBack) {
                (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loadPage(this.data.goBack);
                return;
            }
            this.assetUpdated(assetID, page.reconfigForm, _locales__WEBPACK_IMPORTED_MODULE_5__.prep(_locales__WEBPACK_IMPORTED_MODULE_5__.ID_RECONFIG_SUCCESS));
            this.updateTicketBuyer(assetID);
            (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().clearTxHistory(assetID);
            this.showTxHistory(assetID);
            this.updatePrivacy(assetID);
            this.checkNeedsProvider(assetID);
        });
    }
    /* lock instructs the API to lock the wallet. */
    lock(assetID) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.newWalletForm);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)('/api/closewallet', { assetID: assetID });
            loaded();
            if (!(0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res))
                return;
            this.updateDisplayedAsset(assetID);
            this.updatePrivacy(assetID);
        });
    }
    downloadLogs() {
        return __awaiter(this, void 0, void 0, function* () {
            const search = new URLSearchParams('');
            search.append('assetid', `${this.selectedAssetID}`);
            const url = new URL(window.location.href);
            url.search = search.toString();
            url.pathname = '/wallets/logfile';
            window.open(url.toString());
        });
    }
    // displayExportWalletAuth displays a form to warn the user about the
    // dangers of exporting a wallet, and asks them to enter their password.
    displayExportWalletAuth() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.exportWalletErr);
            page.exportWalletPW.value = '';
            this.showForm(page.exportWalletAuth);
        });
    }
    // exportWalletAuthSubmit is called after the user enters their password to
    // authorize looking up the information to restore their wallet in an
    // external wallet.
    exportWalletAuthSubmit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            const req = {
                assetID: this.selectedAssetID,
                pass: page.exportWalletPW.value
            };
            const url = '/api/restorewalletinfo';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.forms);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                page.exportWalletPW.value = '';
                this.displayRestoreWalletInfo(res.restorationinfo);
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.exportWalletErr, res.msg);
            }
        });
    }
    // displayRestoreWalletInfo displays the information needed to restore a
    // wallet in external wallets.
    displayRestoreWalletInfo(info) {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].empty(page.restoreInfoCardsList);
            for (const wr of info) {
                const card = this.restoreInfoCard.cloneNode(true);
                const tmpl = _doc__WEBPACK_IMPORTED_MODULE_0__["default"].parseTemplate(card);
                tmpl.name.textContent = wr.target;
                tmpl.seed.textContent = wr.seed;
                tmpl.seedName.textContent = `${wr.seedName}:`;
                tmpl.instructions.textContent = wr.instructions;
                page.restoreInfoCardsList.appendChild(card);
            }
            this.showForm(page.restoreWalletInfo);
        });
    }
    recoverWallet() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].hide(page.recoverWalletErr);
            const req = {
                assetID: this.selectedAssetID
            };
            const url = '/api/recoverwallet';
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.forms);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(url, req);
            loaded();
            if (res.code === _http__WEBPACK_IMPORTED_MODULE_2__.Errors.activeOrdersErr) {
                this.forceUrl = url;
                this.forceReq = req;
                this.showConfirmForce();
            }
            else if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res)) {
                this.closePopups();
            }
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.recoverWalletErr, res.msg);
            }
        });
    }
    /*
     * confirmForceSubmit resubmits either the recover or rescan requests with
     * force set to true. These two requests require force to be set to true if
     * they are called while the wallet is managing active orders.
     */
    confirmForceSubmit() {
        return __awaiter(this, void 0, void 0, function* () {
            const page = this.page;
            this.forceReq.force = true;
            const loaded = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().loading(page.forms);
            const res = yield (0,_http__WEBPACK_IMPORTED_MODULE_2__.postJSON)(this.forceUrl, this.forceReq);
            loaded();
            if ((0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().checkResponse(res))
                this.closePopups();
            else {
                _doc__WEBPACK_IMPORTED_MODULE_0__["default"].showFormError(page.confirmForceErr, res.msg);
            }
        });
    }
    /* handleBalance handles notifications updating a wallet's balance and assets'
       value in default fiat rate.
    . */
    handleBalanceNote(note) {
        this.updateAssetButton(note.assetID);
        if (note.assetID === this.selectedAssetID)
            this.updateDisplayedAssetBalance();
    }
    /* handleRatesNote handles fiat rate notifications, updating the fiat value of
     *  all supported assets.
     */
    handleRatesNote(note) {
        this.updateAssetButton(this.selectedAssetID);
        if (!note.fiatRates[this.selectedAssetID])
            return;
        this.updateDisplayedAssetBalance();
        const { feeState } = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[this.selectedAssetID];
        if (feeState)
            this.updateFeeState(feeState);
    }
    /*
     * handleWalletStateNote is a handler for both the 'walletstate' and
     * 'walletconfig' notifications.
     */
    handleWalletStateNote(note) {
        const { assetID, feeState } = note.wallet;
        this.updateAssetButton(assetID);
        this.assetUpdated(assetID);
        if (note.topic === 'WalletPeersUpdate' &&
            assetID === this.selectedAssetID &&
            _doc__WEBPACK_IMPORTED_MODULE_0__["default"].isDisplayed(this.page.managePeersForm)) {
            this.updateWalletPeersTable();
        }
        if (feeState && assetID === this.selectedAssetID)
            this.updateFeeState(feeState);
    }
    /*
     * handleCreateWalletNote is a handler for 'createwallet' notifications.
     */
    handleCreateWalletNote(note) {
        this.updateAssetButton(note.assetID);
        this.assetUpdated(note.assetID);
        this.showTxHistory(note.assetID);
    }
    handleCustomWalletNote(note) {
        const walletNote = note.payload;
        switch (walletNote.route) {
            case 'tipChange': {
                const n = walletNote;
                switch (n.assetID) {
                    case 42: { // dcr
                        if (!this.stakeStatus)
                            return;
                        const data = n.data;
                        const synced = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().walletMap[n.assetID].synced;
                        if (synced) {
                            const ui = (0,_registry__WEBPACK_IMPORTED_MODULE_7__.app)().unitInfo(n.assetID);
                            this.updateTicketStats(data.stats, ui, data.ticketPrice, data.votingSubsidy);
                        }
                    }
                }
                break;
            }
            case 'ticketPurchaseUpdate': {
                this.processTicketPurchaseUpdate(walletNote);
                break;
            }
            case 'transaction': {
                const n = walletNote;
                if (n.assetID === this.selectedAssetID)
                    this.handleTxNote(n.transaction, n.new);
                break;
            }
            case 'transactionHistorySynced': {
                const n = walletNote;
                if (n.assetID === this.selectedAssetID)
                    this.showTxHistory(n.assetID);
                break;
            }
        }
    }
    /*
     * unload is called by the Application when the user navigates away from
     * the /wallets page.
     */
    unload() {
        clearInterval(this.secondTicker);
        _doc__WEBPACK_IMPORTED_MODULE_0__["default"].unbind(document, 'keyup', this.keyup);
    }
}
function trimStringWithEllipsis(str, maxLen) {
    if (str.length <= maxLen)
        return str;
    return `${str.substring(0, maxLen / 2)}...${str.substring(str.length - maxLen / 2)}`;
}


/***/ }),

/***/ "./src/js/ws.ts":
/*!**********************!*\
  !*** ./src/js/ws.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
// MessageSocket is a WebSocket manager that uses the Decred DEX Message format
// for communications.
//
// Message request format:
// {
//   route: 'name',
//   id: int,
//   payload: anything or nothing
// }
//
// Message response payload will be a result object with either a valid 'result'
// field or an 'error' field
//
// Functions for external use:
// registerRoute (route, handler) -- register a function to handle events
// of the given type
// request (route, payload) -- create a JSON message in the above format and
// send it
//
// Based on messagesocket_service.js by Jonathan Chappelow @ dcrdata, which is
// based on ws_events_dispatcher.js by Ismael Celis
const typeRequest = 1;
function forward(route, payload, handlers) {
    if (!route && payload.error) {
        const err = payload.error;
        console.error(`websocket error (code ${err.code}): ${err.message}`);
        return;
    }
    if (typeof handlers[route] === 'undefined') {
        // console.log(`unhandled message for ${route}: ${payload}`)
        return;
    }
    // call each handler
    for (let i = 0; i < handlers[route].length; i++) {
        handlers[route][i](payload);
    }
}
let id = 0;
class MessageSocket {
    constructor() {
        this.handlers = {};
        this.queue = [];
        this.maxQlength = 5;
    }
    registerRoute(route, handler) {
        this.handlers[route] = this.handlers[route] || [];
        this.handlers[route].push(handler);
    }
    deregisterRoute(route) {
        this.handlers[route] = [];
    }
    // request sends a request-type message to the server
    request(route, payload) {
        if (!this.connection || this.connection.readyState !== window.WebSocket.OPEN) {
            while (this.queue.length > this.maxQlength - 1)
                this.queue.shift();
            this.queue.push([route, payload]);
            return;
        }
        id++;
        const message = JSON.stringify({
            route: route,
            type: typeRequest,
            id: id,
            payload: payload
        });
        window.log('ws', 'sending', message);
        this.connection.send(message);
    }
    close(reason) {
        window.log('ws', 'close, reason:', reason, this.handlers);
        this.handlers = {};
        if (this.connection)
            this.connection.close();
    }
    connect(uri, reloader) {
        this.uri = uri;
        this.reloader = reloader;
        let retrys = 0;
        const go = () => {
            window.log('ws', `connecting to ${uri}`);
            let conn = this.connection = new window.WebSocket(uri);
            if (!conn)
                return;
            const timeout = setTimeout(() => {
                // readyState is still WebSocket.CONNECTING. Cancel and trigger onclose.
                if (conn)
                    conn.close();
            }, 500);
            // unmarshal message, and forward the message to registered handlers
            conn.onmessage = (evt) => {
                const message = JSON.parse(evt.data);
                forward(message.route, message.payload, this.handlers);
            };
            // Stub out standard functions
            conn.onclose = (evt) => {
                window.log('ws', 'onclose');
                clearTimeout(timeout);
                conn = this.connection = null;
                forward('close', null, this.handlers);
                retrys++;
                // 1.2, 1.6, 2.0, 2.4, 3.1, 3.8, 4.8, 6.0, 7.5, 9.3, ...
                const delay = Math.min(Math.pow(1.25, retrys), 10);
                console.error(`websocket disconnected (${evt.code}), trying again in ${delay.toFixed(1)} seconds`);
                setTimeout(() => {
                    go();
                }, delay * 1000);
            };
            conn.onopen = () => {
                window.log('ws', 'onopen');
                clearTimeout(timeout);
                if (retrys > 0) {
                    retrys = 0;
                    reloader();
                }
                forward('open', null, this.handlers);
                const queue = this.queue;
                this.queue = [];
                for (const [route, message] of queue) {
                    this.request(route, message);
                }
            };
            conn.onerror = (evt) => {
                window.log('ws', 'onerror:', evt);
                forward('error', evt, this.handlers);
            };
        };
        go();
    }
}
const ws = new MessageSocket();
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ws);


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/app */ "./src/js/app.ts");
/* harmony import */ var _js_registry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./js/registry */ "./src/js/registry.ts");
/* harmony import */ var _css_bootstrap_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./css/bootstrap.scss */ "./src/css/bootstrap.scss");
/* harmony import */ var _css_application_scss__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./css/application.scss */ "./src/css/application.scss");




const app = new _js_app__WEBPACK_IMPORTED_MODULE_0__["default"]();
(0,_js_registry__WEBPACK_IMPORTED_MODULE_1__.registerApplication)(app);
app.start();

})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQztZQUN0RixJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQztZQUN4RixJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQztZQUN0RixJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQztZQUN4RixJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUM7WUFDbkYsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxDQUFDO1lBQ3JGLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUks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QUFFOzs7Ozs7O1VDdEpqQjtVQUNBOztVQUVBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBOztVQUVBO1VBQ0E7O1VBRUE7VUFDQTtVQUNBOzs7OztXQ3RCQTtXQUNBO1dBQ0E7V0FDQTtXQUNBLHlDQUF5Qyx3Q0FBd0M7V0FDakY7V0FDQTtXQUNBOzs7OztXQ1BBOzs7OztXQ0FBO1dBQ0E7V0FDQTtXQUNBLHVEQUF1RCxpQkFBaUI7V0FDeEU7V0FDQSxnREFBZ0QsYUFBYTtXQUM3RDs7Ozs7Ozs7Ozs7Ozs7O0FDTmtDO0FBQ2lCO0FBQ3RCO0FBQ0U7QUFFL0IsTUFBTSxHQUFHLEdBQUcsSUFBSSwrQ0FBVyxFQUFFO0FBQzdCLGlFQUFtQixDQUFDLEdBQUcsQ0FBQztBQUN4QixHQUFHLENBQUMsS0FBSyxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2Nzcy9hcHBsaWNhdGlvbi5zY3NzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9jc3MvYm9vdHN0cmFwLnNjc3MiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2FjY291bnQudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2FwcC50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvYmFzZXBhZ2UudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2NoYXJ0cy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvY29pbmV4cGxvcmVycy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvZGV4c2V0dGluZ3MudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2RvYy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvZm9ybXMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2h0dHAudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2luaXQudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2xvY2FsZXMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL2xvZ2luLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9tYXJrZXRzLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9tbS50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvbW1hcmNoaXZlcy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvbW1sb2dzLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9tbXNldHRpbmdzLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9tbXV0aWwudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL25vdGlmaWNhdGlvbnMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL29wdHMudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL29yZGVyLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9vcmRlcmJvb2sudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL29yZGVycy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvb3JkZXJ1dGlsLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9yZWdpc3Rlci50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvcmVnaXN0cnkudHMiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2pzL3NldHRpbmdzLnRzIiwid2VicGFjazovL2Jpc29udy8uL3NyYy9qcy9zdGF0ZS50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvd2FsbGV0cy50cyIsIndlYnBhY2s6Ly9iaXNvbncvLi9zcmMvanMvd3MudHMiLCJ3ZWJwYWNrOi8vYmlzb253L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2Jpc29udy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vYmlzb253L3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vYmlzb253L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vYmlzb253Ly4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpblxuZXhwb3J0IHt9OyIsIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpblxuZXhwb3J0IHt9OyIsImltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQge1xuICBPcmRlclR5cGVMaW1pdCxcbiAgT3JkZXJUeXBlTWFya2V0LFxuICBPcmRlclR5cGVDYW5jZWwsXG4gIFN0YXR1c0Vwb2NoLFxuICBTdGF0dXNCb29rZWQsXG4gIFJhdGVFbmNvZGluZ0ZhY3RvcixcbiAgTWF0Y2hTaWRlTWFrZXIsXG4gIE1ha2VyUmVkZWVtZWQsXG4gIFRha2VyU3dhcENhc3QsXG4gIEltbWVkaWF0ZVRpRlxufSBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnQsXG4gIEV4Y2hhbmdlQXV0aCxcbiAgT3JkZXIsXG4gIE1hcmtldFxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuXG5leHBvcnQgY29uc3QgYm9uZFJlc2VydmVNdWx0aXBsaWVyID0gMiAvLyBSZXNlcnZlcyBmb3IgbmV4dCBib25kXG5leHBvcnQgY29uc3QgcGVyVGllckJhc2VQYXJjZWxMaW1pdCA9IDJcbmV4cG9ydCBjb25zdCBwYXJjZWxMaW1pdFNjb3JlTXVsdGlwbGllciA9IDNcblxuZXhwb3J0IGNsYXNzIFJlcHV0YXRpb25NZXRlciB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBob3N0OiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAoZGl2OiBQYWdlRWxlbWVudCkge1xuICAgIHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXModGhpcy5wYWdlLnBlbmFsdHlNYXJrZXJUbXBsKVxuICB9XG5cbiAgc2V0SG9zdCAoaG9zdDogc3RyaW5nKSB7XG4gICAgdGhpcy5ob3N0ID0gaG9zdFxuICB9XG5cbiAgdXBkYXRlICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGhvc3QgfSA9IHRoaXNcbiAgICBjb25zdCB7IGF1dGgsIG1heFNjb3JlLCBwZW5hbHR5VGhyZXNob2xkIH0gPSBhcHAoKS5leGNoYW5nZXNbaG9zdF1cbiAgICBjb25zdCB7IHJlcDogeyBzY29yZSB9IH0gPSBhdXRoXG5cbiAgICBjb25zdCBkaXNwbGF5VGllciA9IHN0cm9uZ1RpZXIoYXV0aClcblxuICAgIGNvbnN0IG1pblNjb3JlID0gZGlzcGxheVRpZXIgPyBkaXNwbGF5VGllciAqIHBlbmFsdHlUaHJlc2hvbGQgKiAtMSA6IHBlbmFsdHlUaHJlc2hvbGQgKiAtMSAvLyBKdXN0IGZvciBsb29rc1xuICAgIGNvbnN0IHdhcm5QY3QgPSAyNVxuICAgIGNvbnN0IHNjb3JlUGN0ID0gMTAwIC0gd2FyblBjdFxuICAgIHBhZ2Uuc2NvcmVXYXJuLnN0eWxlLndpZHRoID0gYCR7d2FyblBjdH0lYFxuICAgIGNvbnN0IHBvcyA9IHNjb3JlID49IDAgPyB3YXJuUGN0ICsgKHNjb3JlIC8gbWF4U2NvcmUpICogc2NvcmVQY3QgOiB3YXJuUGN0IC0gKE1hdGgubWluKHdhcm5QY3QsIHNjb3JlIC8gbWluU2NvcmUgKiB3YXJuUGN0KSlcblxuICAgIHBhZ2Uuc2NvcmVQb2ludGVyLnN0eWxlLmxlZnQgPSBgJHtwb3N9JWBcbiAgICBwYWdlLnNjb3JlTWluLnRleHRDb250ZW50ID0gU3RyaW5nKG1pblNjb3JlKVxuICAgIHBhZ2Uuc2NvcmVNYXgudGV4dENvbnRlbnQgPSBTdHJpbmcobWF4U2NvcmUpXG4gICAgY29uc3QgYm9udXMgPSBsaW1pdEJvbnVzKHNjb3JlLCBtYXhTY29yZSlcbiAgICBwYWdlLmxpbWl0Qm9udXMudGV4dENvbnRlbnQgPSBib251cy50b0ZpeGVkKDEpXG4gICAgZm9yIChjb25zdCBtIG9mIERvYy5hcHBseVNlbGVjdG9yKHBhZ2Uuc2NvcmVUcmF5LCAnLnBlbmFsdHktbWFya2VyJykpIG0ucmVtb3ZlKClcbiAgICBpZiAoZGlzcGxheVRpZXIgPiAxKSB7XG4gICAgICBjb25zdCBtYXJrZXJQY3QgPSB3YXJuUGN0IC8gZGlzcGxheVRpZXJcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZGlzcGxheVRpZXI7IGkrKykge1xuICAgICAgICBjb25zdCBkaXYgPSBwYWdlLnBlbmFsdHlNYXJrZXJUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICBwYWdlLnNjb3JlVHJheS5hcHBlbmRDaGlsZChkaXYpXG4gICAgICAgIGRpdi5zdHlsZS5sZWZ0ID0gYCR7bWFya2VyUGN0ICogaX0lYFxuICAgICAgfVxuICAgIH1cbiAgICBwYWdlLnNjb3JlLnRleHRDb250ZW50ID0gU3RyaW5nKHNjb3JlKVxuICAgIHBhZ2Uuc2NvcmVEYXRhLmNsYXNzTGlzdC5yZW1vdmUoJ25lZ2F0aXZlJywgJ3Bvc2l0aXZlJylcbiAgICBpZiAoc2NvcmUgPiAwKSBwYWdlLnNjb3JlRGF0YS5jbGFzc0xpc3QuYWRkKCdwb3NpdGl2ZScpXG4gICAgZWxzZSBwYWdlLnNjb3JlRGF0YS5jbGFzc0xpc3QuYWRkKCduZWdhdGl2ZScpXG4gIH1cbn1cblxuLypcbiAqIHN0cm9uZ1RpZXIgaXMgdGhlIGVmZmVjdGl2ZSB0aWVyLCB3aXRoIHNvbWUgcmVzcGVjdCBmb3IgYm9uZCBvdmVybGFwLCBzdWNoXG4gKiB0aGF0IHdlIGRvbid0IGNvdW50IHdlYWsgYm9uZHMgdGhhdCBoYXZlIGFscmVhZHkgaGFkIHRoZWlyIHJlcGxhY2VtZW50c1xuICogY29uZmlybWVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc3Ryb25nVGllciAoYXV0aDogRXhjaGFuZ2VBdXRoKTogbnVtYmVyIHtcbiAgY29uc3QgeyB3ZWFrU3RyZW5ndGgsIHRhcmdldFRpZXIsIGVmZmVjdGl2ZVRpZXIgfSA9IGF1dGhcbiAgaWYgKGVmZmVjdGl2ZVRpZXIgPiB0YXJnZXRUaWVyKSB7XG4gICAgY29uc3QgZGlmZiA9IGVmZmVjdGl2ZVRpZXIgLSB0YXJnZXRUaWVyXG4gICAgaWYgKHdlYWtTdHJlbmd0aCA+PSBkaWZmKSByZXR1cm4gdGFyZ2V0VGllclxuICAgIHJldHVybiB0YXJnZXRUaWVyICsgKGRpZmYgLSB3ZWFrU3RyZW5ndGgpXG4gIH1cbiAgcmV0dXJuIGVmZmVjdGl2ZVRpZXJcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpa2VseVRha2VyIChvcmQ6IE9yZGVyLCByYXRlOiBudW1iZXIpOiBib29sZWFuIHtcbiAgaWYgKG9yZC50eXBlID09PSBPcmRlclR5cGVNYXJrZXQgfHwgb3JkLnRpZiA9PT0gSW1tZWRpYXRlVGlGKSByZXR1cm4gdHJ1ZVxuICAvLyBNdXN0IGNyb3NzIHRoZSBzcHJlYWQgdG8gYmUgYSB0YWtlciAobm90IHNvIGNvbnNlcnZhdGl2ZSkuXG4gIGlmIChyYXRlID09PSAwKSByZXR1cm4gZmFsc2VcbiAgaWYgKG9yZC5zZWxsKSByZXR1cm4gb3JkLnJhdGUgPCByYXRlXG4gIHJldHVybiBvcmQucmF0ZSA+IHJhdGVcbn1cblxuY29uc3QgcHJlcGFyY2VsUXVhbnRpdHkgPSAob3JkOiBPcmRlciwgbWt0PzogTWFya2V0LCBtaWRHYXA/OiBudW1iZXIpID0+IHtcbiAgY29uc3QgcXR5ID0gb3JkLnF0eSAtIG9yZC5maWxsZWRcbiAgaWYgKG9yZC50eXBlID09PSBPcmRlclR5cGVMaW1pdCkgcmV0dXJuIHF0eVxuICBpZiAob3JkLnNlbGwpIHJldHVybiBxdHkgKiBvcmQucmF0ZSAvIFJhdGVFbmNvZGluZ0ZhY3RvclxuICBjb25zdCByYXRlID0gbWlkR2FwIHx8IG1rdD8uc3BvdD8ucmF0ZSB8fCAwXG4gIC8vIENhbGxlciBzaG91bGQgbm90IGNhbGwgdGhpcyBmb3IgbWFya2V0IG9yZGVycyB3aXRob3V0IGEgbWt0IGFyZy5cbiAgaWYgKCFta3QpIHJldHVybiAwXG4gIC8vIFRoaXMgaXMgdHJpY2t5LiBUaGUgc2VydmVyIHdpbGwgdXNlIHRoZSBtaWQtZ2FwIHJhdGUgdG8gY29udmVydCB0aGVcbiAgLy8gb3JkZXIgcXR5LiBXZSBkb24ndCBoYXZlIGEgbWlkLWdhcCByYXRlLCBvbmx5IGEgc3BvdCByYXRlLlxuICBpZiAocmF0ZSAmJiAobWt0Py5zcG90Py5ib29rVm9sdW1lIHx8IDApID4gMCkgcmV0dXJuIHF0eSAqIFJhdGVFbmNvZGluZ0ZhY3RvciAvIHJhdGVcbiAgcmV0dXJuIG1rdC5sb3RzaXplIC8vIHNlcnZlciB1c2VzIHNhbWUgZmFsbGJhY2sgaWYgYm9vayBpcyBlbXB0eVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZXBvY2hXZWlnaHQgKG9yZDogT3JkZXIsIG1rdDogTWFya2V0LCBtaWRHYXA/OiBudW1iZXIpIHtcbiAgaWYgKG9yZC5zdGF0dXMgIT09IFN0YXR1c0Vwb2NoKSByZXR1cm4gMFxuICBjb25zdCBxdHkgPSBwcmVwYXJjZWxRdWFudGl0eShvcmQsIG1rdCwgbWlkR2FwKVxuICBjb25zdCByYXRlID0gbWlkR2FwIHx8IG1rdC5zcG90Py5yYXRlIHx8IDBcbiAgaWYgKGxpa2VseVRha2VyKG9yZCwgcmF0ZSkpIHJldHVybiBxdHkgKiAyXG4gIHJldHVybiBxdHlcbn1cblxuZnVuY3Rpb24gYm9va1dlaWdodCAob3JkOiBPcmRlcikge1xuICBpZiAob3JkLnN0YXR1cyAhPT0gU3RhdHVzQm9va2VkKSByZXR1cm4gMFxuICByZXR1cm4gcHJlcGFyY2VsUXVhbnRpdHkob3JkKVxufVxuXG5mdW5jdGlvbiBzZXR0bGluZ1dlaWdodCAob3JkOiBPcmRlcikge1xuICBsZXQgc3VtID0gMFxuICBmb3IgKGNvbnN0IG0gb2YgKG9yZC5tYXRjaGVzIHx8IFtdKSkge1xuICAgIGlmIChtLnNpZGUgPT09IE1hdGNoU2lkZU1ha2VyKSB7XG4gICAgICBpZiAobS5zdGF0dXMgPiBNYWtlclJlZGVlbWVkKSBjb250aW51ZVxuICAgIH0gZWxzZSBpZiAobS5zdGF0dXMgPiBUYWtlclN3YXBDYXN0KSBjb250aW51ZVxuICAgIHN1bSArPSBtLnF0eVxuICB9XG4gIHJldHVybiBzdW1cbn1cblxuZnVuY3Rpb24gcGFyY2VsV2VpZ2h0IChvcmQ6IE9yZGVyLCBta3Q6IE1hcmtldCwgbWlkR2FwPzogbnVtYmVyKSB7XG4gIGlmIChvcmQudHlwZSA9PT0gT3JkZXJUeXBlQ2FuY2VsKSByZXR1cm4gMFxuICByZXR1cm4gZXBvY2hXZWlnaHQob3JkLCBta3QsIG1pZEdhcCkgKyBib29rV2VpZ2h0KG9yZCkgKyBzZXR0bGluZ1dlaWdodChvcmQpXG59XG5cbi8vIGZ1bmN0aW9uIHJvdW5kUGFyY2VscyAocDogbnVtYmVyKTogbnVtYmVyIHtcbi8vICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yb3VuZCgocCAqIDFlOCkpIC8gMWU4KVxuLy8gfVxuXG5mdW5jdGlvbiBsaW1pdEJvbnVzIChzY29yZTogbnVtYmVyLCBtYXhTY29yZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgcmV0dXJuIHNjb3JlID4gMCA/IDEgKyBzY29yZSAvIG1heFNjb3JlICogKHBhcmNlbExpbWl0U2NvcmVNdWx0aXBsaWVyIC0gMSkgOiAxXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cmFkaW5nTGltaXRzIChob3N0OiBzdHJpbmcpOiBbbnVtYmVyLCBudW1iZXJdIHsgLy8gW3VzZWRQYXJjZWxzLCBwYXJjZWxMaW1pdF1cbiAgY29uc3QgeyBhdXRoLCBtYXhTY29yZSwgbWFya2V0cyB9ID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdXG4gIGNvbnN0IHsgcmVwOiB7IHNjb3JlIH0gfSA9IGF1dGhcbiAgY29uc3QgdGllciA9IHN0cm9uZ1RpZXIoYXV0aClcblxuICBsZXQgdXNlZFBhcmNlbHMgPSAwXG4gIGZvciAoY29uc3QgbWt0IG9mIE9iamVjdC52YWx1ZXMobWFya2V0cykpIHtcbiAgICBsZXQgbWt0V2VpZ2h0ID0gMFxuICAgIGZvciAoY29uc3Qgb3JkIG9mIChta3QuaW5mbGlnaHQgfHwgW10pKSBta3RXZWlnaHQgKz0gcGFyY2VsV2VpZ2h0KG9yZCwgbWt0KVxuICAgIGZvciAoY29uc3Qgb3JkIG9mIChta3Qub3JkZXJzIHx8IFtdKSkgbWt0V2VpZ2h0ICs9IHBhcmNlbFdlaWdodChvcmQsIG1rdClcbiAgICB1c2VkUGFyY2VscyArPSAobWt0V2VpZ2h0IC8gKG1rdC5wYXJjZWxzaXplICogbWt0LmxvdHNpemUpKVxuICB9XG4gIGNvbnN0IHBhcmNlbExpbWl0ID0gcGVyVGllckJhc2VQYXJjZWxMaW1pdCAqIGxpbWl0Qm9udXMoc2NvcmUsIG1heFNjb3JlKSAqIHRpZXJcbiAgcmV0dXJuIFt1c2VkUGFyY2VscywgcGFyY2VsTGltaXRdXG59XG4iLCJpbXBvcnQgRG9jIGZyb20gJy4vZG9jJ1xuaW1wb3J0IFN0YXRlIGZyb20gJy4vc3RhdGUnXG5pbXBvcnQgUmVnaXN0cmF0aW9uUGFnZSBmcm9tICcuL3JlZ2lzdGVyJ1xuaW1wb3J0IExvZ2luUGFnZSBmcm9tICcuL2xvZ2luJ1xuaW1wb3J0IFdhbGxldHNQYWdlLCB7IHR4VHlwZVN0cmluZyB9IGZyb20gJy4vd2FsbGV0cydcbmltcG9ydCBTZXR0aW5nc1BhZ2UgZnJvbSAnLi9zZXR0aW5ncydcbmltcG9ydCBNYXJrZXRzUGFnZSBmcm9tICcuL21hcmtldHMnXG5pbXBvcnQgT3JkZXJzUGFnZSBmcm9tICcuL29yZGVycydcbmltcG9ydCBPcmRlclBhZ2UgZnJvbSAnLi9vcmRlcidcbmltcG9ydCBNYXJrZXRNYWtlclBhZ2UgZnJvbSAnLi9tbSdcbmltcG9ydCBNYXJrZXRNYWtlclNldHRpbmdzUGFnZSBmcm9tICcuL21tc2V0dGluZ3MnXG5pbXBvcnQgRGV4U2V0dGluZ3NQYWdlIGZyb20gJy4vZGV4c2V0dGluZ3MnXG5pbXBvcnQgTWFya2V0TWFrZXJBcmNoaXZlc1BhZ2UgZnJvbSAnLi9tbWFyY2hpdmVzJ1xuaW1wb3J0IE1hcmtldE1ha2VyTG9nc1BhZ2UgZnJvbSAnLi9tbWxvZ3MnXG5pbXBvcnQgSW5pdFBhZ2UgZnJvbSAnLi9pbml0J1xuaW1wb3J0IHsgTU0gfSBmcm9tICcuL21tdXRpbCdcbmltcG9ydCB7IFJhdGVFbmNvZGluZ0ZhY3RvciwgU3RhdHVzRXhlY3V0ZWQsIGhhc0FjdGl2ZU1hdGNoZXMgfSBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCB7IGdldEpTT04sIHBvc3RKU09OLCBFcnJvcnMgfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQgKiBhcyBudGZuIGZyb20gJy4vbm90aWZpY2F0aW9ucydcbmltcG9ydCB3cyBmcm9tICcuL3dzJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQge1xuICBVc2VyLFxuICBTdXBwb3J0ZWRBc3NldCxcbiAgRXhjaGFuZ2UsXG4gIFdhbGxldFN0YXRlLFxuICBCb25kTm90ZSxcbiAgUmVwdXRhdGlvbk5vdGUsXG4gIENvcmVOb3RlLFxuICBPcmRlck5vdGUsXG4gIE1hcmtldCxcbiAgT3JkZXIsXG4gIE1hdGNoLFxuICBCYWxhbmNlTm90ZSxcbiAgV2FsbGV0Q29uZmlnTm90ZSxcbiAgV2FsbGV0U3luY05vdGUsXG4gIE1hdGNoTm90ZSxcbiAgQ29ubkV2ZW50Tm90ZSxcbiAgU3BvdFByaWNlTm90ZSxcbiAgVW5pdEluZm8sXG4gIFdhbGxldERlZmluaXRpb24sXG4gIFdhbGxldEJhbGFuY2UsXG4gIExvZ01lc3NhZ2UsXG4gIE5vdGVFbGVtZW50LFxuICBCYWxhbmNlUmVzcG9uc2UsXG4gIEFQSVJlc3BvbnNlLFxuICBSYXRlTm90ZSxcbiAgSW5GbGlnaHRPcmRlcixcbiAgV2FsbGV0VHJhbnNhY3Rpb24sXG4gIFR4SGlzdG9yeVJlc3VsdCxcbiAgV2FsbGV0Tm90ZSxcbiAgVHJhbnNhY3Rpb25Ob3RlLFxuICBQYWdlRWxlbWVudCxcbiAgQWN0aW9uUmVxdWlyZWROb3RlLFxuICBBY3Rpb25SZXNvbHZlZE5vdGUsXG4gIFRyYW5zYWN0aW9uQWN0aW9uTm90ZSxcbiAgQ29yZUFjdGlvblJlcXVpcmVkTm90ZSxcbiAgUmVqZWN0ZWRSZWRlbXB0aW9uRGF0YSxcbiAgTWFya2V0TWFraW5nU3RhdHVzLFxuICBSdW5TdGF0c05vdGUsXG4gIE1NQm90U3RhdHVzLFxuICBDRVhOb3RpZmljYXRpb24sXG4gIENFWEJhbGFuY2VVcGRhdGVcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7IHNldENvaW5IcmVmIH0gZnJvbSAnLi9jb2luZXhwbG9yZXJzJ1xuXG5jb25zdCBpZGVsID0gRG9jLmlkZWwgLy8gPSBlbGVtZW50IGJ5IGlkXG5jb25zdCBiaW5kID0gRG9jLmJpbmRcbmNvbnN0IHVuYmluZCA9IERvYy51bmJpbmRcblxuY29uc3Qgbm90aWZpY2F0aW9uUm91dGUgPSAnbm90aWZ5J1xuY29uc3Qgbm90ZUNhY2hlU2l6ZSA9IDEwMFxuXG5pbnRlcmZhY2UgUGFnZSB7XG4gIHVubG9hZCAoKTogdm9pZFxufVxuXG5pbnRlcmZhY2UgUGFnZUNsYXNzIHtcbiAgbmV3IChtYWluOiBIVE1MRWxlbWVudCwgZGF0YTogYW55KTogUGFnZTtcbn1cblxuaW50ZXJmYWNlIENvcmVOb3RlUGx1cyBleHRlbmRzIENvcmVOb3RlIHtcbiAgZWw6IEhUTUxFbGVtZW50IC8vIEFkZGVkIGluIGFwcFxufVxuXG5pbnRlcmZhY2UgVXNlclJlc3BvbnNlIGV4dGVuZHMgQVBJUmVzcG9uc2Uge1xuICB1c2VyPzogVXNlclxuICBsYW5nOiBzdHJpbmdcbiAgbGFuZ3M6IHN0cmluZ1tdXG4gIGluaXRlZDogYm9vbGVhblxuICBtbVN0YXR1czogTWFya2V0TWFraW5nU3RhdHVzXG59XG5cbi8qIGNvbnN0cnVjdG9ycyBpcyBhIG1hcCB0byBwYWdlIGNvbnN0cnVjdG9ycy4gKi9cbmNvbnN0IGNvbnN0cnVjdG9yczogUmVjb3JkPHN0cmluZywgUGFnZUNsYXNzPiA9IHtcbiAgbG9naW46IExvZ2luUGFnZSxcbiAgcmVnaXN0ZXI6IFJlZ2lzdHJhdGlvblBhZ2UsXG4gIG1hcmtldHM6IE1hcmtldHNQYWdlLFxuICB3YWxsZXRzOiBXYWxsZXRzUGFnZSxcbiAgc2V0dGluZ3M6IFNldHRpbmdzUGFnZSxcbiAgb3JkZXJzOiBPcmRlcnNQYWdlLFxuICBvcmRlcjogT3JkZXJQYWdlLFxuICBkZXhzZXR0aW5nczogRGV4U2V0dGluZ3NQYWdlLFxuICBpbml0OiBJbml0UGFnZSxcbiAgbW06IE1hcmtldE1ha2VyUGFnZSxcbiAgbW1zZXR0aW5nczogTWFya2V0TWFrZXJTZXR0aW5nc1BhZ2UsXG4gIG1tYXJjaGl2ZXM6IE1hcmtldE1ha2VyQXJjaGl2ZXNQYWdlLFxuICBtbWxvZ3M6IE1hcmtldE1ha2VyTG9nc1BhZ2Vcbn1cblxuaW50ZXJmYWNlIExhbmdEYXRhIHtcbiAgbmFtZTogc3RyaW5nXG4gIGZsYWc6IHN0cmluZ1xufVxuXG5jb25zdCBsYW5ndWFnZURhdGE6IFJlY29yZDxzdHJpbmcsIExhbmdEYXRhPiA9IHtcbiAgJ2VuLVVTJzoge1xuICAgIG5hbWU6ICdFbmdsaXNoJyxcbiAgICBmbGFnOiAn8J+HuvCfh7gnIC8vIE5vdCDwn4es8J+Hpy4gTVVSSUNBIVxuICB9LFxuICAncHQtQlInOiB7XG4gICAgbmFtZTogJ1BvcnR1Z2VzZScsXG4gICAgZmxhZzogJ/Cfh6fwn4e3J1xuICB9LFxuICAnemgtQ04nOiB7XG4gICAgbmFtZTogJ0NoaW5lc2UnLFxuICAgIGZsYWc6ICfwn4eo8J+HsydcbiAgfSxcbiAgJ3BsLVBMJzoge1xuICAgIG5hbWU6ICdQb2xpc2gnLFxuICAgIGZsYWc6ICfwn4e18J+HsSdcbiAgfSxcbiAgJ2RlLURFJzoge1xuICAgIG5hbWU6ICdHZXJtYW4nLFxuICAgIGZsYWc6ICfwn4ep8J+HqidcbiAgfSxcbiAgJ2FyJzoge1xuICAgIG5hbWU6ICdBcmFiaWMnLFxuICAgIGZsYWc6ICfwn4eq8J+HrCcgLy8gRWd5cHQgSSBndWVzc1xuICB9XG59XG5cbmludGVyZmFjZSByZXF1aXJlZEFjdGlvbiB7XG4gIGRpdjogUGFnZUVsZW1lbnRcbiAgc3RhbXA6IG51bWJlclxuICB1bmlxdWVJRDogc3RyaW5nXG4gIGFjdGlvbklEOiBzdHJpbmdcbiAgc2VsZWN0ZWQ6IGJvb2xlYW5cbn1cblxuLy8gQXBwbGljYXRpb24gaXMgdGhlIG1haW4gamF2YXNjcmlwdCB3ZWIgYXBwbGljYXRpb24gZm9yIEJpc29uIFdhbGxldC5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcGxpY2F0aW9uIHtcbiAgbm90ZXM6IENvcmVOb3RlUGx1c1tdXG4gIHBva2VzOiBDb3JlTm90ZVBsdXNbXVxuICBsYW5nczogc3RyaW5nW11cbiAgbGFuZzogc3RyaW5nXG4gIG1tU3RhdHVzOiBNYXJrZXRNYWtpbmdTdGF0dXNcbiAgaW5pdGVkOiBib29sZWFuXG4gIGF1dGhlZDogYm9vbGVhblxuICB1c2VyOiBVc2VyXG4gIHNlZWRHZW5UaW1lOiBudW1iZXJcbiAgY29tbWl0SGFzaDogc3RyaW5nXG4gIHNob3dQb3B1cHM6IGJvb2xlYW5cbiAgbG9nZ2VyczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj5cbiAgcmVjb3JkZXJzOiBSZWNvcmQ8c3RyaW5nLCBMb2dNZXNzYWdlW10+XG4gIG1haW46IEhUTUxFbGVtZW50XG4gIGhlYWRlcjogSFRNTEVsZW1lbnRcbiAgaGVhZGVyU3BhY2U6IEhUTUxFbGVtZW50XG4gIGFzc2V0czogUmVjb3JkPG51bWJlciwgU3VwcG9ydGVkQXNzZXQ+XG4gIGV4Y2hhbmdlczogUmVjb3JkPHN0cmluZywgRXhjaGFuZ2U+XG4gIHdhbGxldE1hcDogUmVjb3JkPG51bWJlciwgV2FsbGV0U3RhdGU+XG4gIGZpYXRSYXRlc01hcDogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICB0b29sdGlwOiBIVE1MRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBIVE1MRWxlbWVudD5cbiAgbG9hZGVkUGFnZTogUGFnZSB8IG51bGxcbiAgcG9wdXBOb3RlczogSFRNTEVsZW1lbnRcbiAgcG9wdXBUbXBsOiBIVE1MRWxlbWVudFxuICBub3RlUmVjZWl2ZXJzOiBSZWNvcmQ8c3RyaW5nLCAobjogQ29yZU5vdGUpID0+IHZvaWQ+W11cbiAgdHhIaXN0b3J5TWFwOiBSZWNvcmQ8bnVtYmVyLCBUeEhpc3RvcnlSZXN1bHQ+XG4gIHJlcXVpcmVkQWN0aW9uczogUmVjb3JkPHN0cmluZywgcmVxdWlyZWRBY3Rpb24+XG5cbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHRoaXMubm90ZXMgPSBbXVxuICAgIHRoaXMucG9rZXMgPSBbXVxuICAgIHRoaXMuc2VlZEdlblRpbWUgPSAwXG4gICAgdGhpcy5jb21taXRIYXNoID0gcHJvY2Vzcy5lbnYuQ09NTUlUSEFTSCB8fCAnJ1xuICAgIHRoaXMubm90ZVJlY2VpdmVycyA9IFtdXG4gICAgdGhpcy5maWF0UmF0ZXNNYXAgPSB7fVxuICAgIHRoaXMuc2hvd1BvcHVwcyA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUucG9wdXBzTEspID09PSAnMSdcbiAgICB0aGlzLnR4SGlzdG9yeU1hcCA9IHt9XG4gICAgdGhpcy5yZXF1aXJlZEFjdGlvbnMgPSB7fVxuXG4gICAgY29uc29sZS5sb2coJ0Jpc29uIFdhbGxldCwgQnVpbGQnLCB0aGlzLmNvbW1pdEhhc2guc3Vic3RyaW5nKDAsIDcpKVxuXG4gICAgLy8gU2V0IEJvb3RzdHJhcCBkYXJrIHRoZW1lIGF0dHJpYnV0ZSBpZiBkYXJrIG1vZGUgaXMgZW5hYmxlZC5cbiAgICBpZiAoU3RhdGUuaXNEYXJrKCkpIHtcbiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnZGFyaycpXG4gICAgfVxuXG4gICAgLy8gTG9nZ2VycyBjYW4gYmUgZW5hYmxlZCBieSBzZXR0aW5nIGEgdHJ1dGh5IHZhbHVlIHRvIHRoZSBsb2dnZXJJRCB1c2luZ1xuICAgIC8vIGVuYWJsZUxvZ2dlci4gU2V0dGluZ3MgYXJlIHN0b3JlZCBhY3Jvc3Mgc2Vzc2lvbnMuIFNlZSBkb2NzdHJpbmcgZm9yIHRoZVxuICAgIC8vIGxvZyBtZXRob2QgZm9yIG1vcmUgaW5mby5cbiAgICB0aGlzLmxvZ2dlcnMgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmxvZ2dlcnNMSykgfHwge31cbiAgICB3aW5kb3cuZW5hYmxlTG9nZ2VyID0gKGxvZ2dlcklELCBzdGF0ZSkgPT4ge1xuICAgICAgaWYgKHN0YXRlKSB0aGlzLmxvZ2dlcnNbbG9nZ2VySURdID0gdHJ1ZVxuICAgICAgZWxzZSBkZWxldGUgdGhpcy5sb2dnZXJzW2xvZ2dlcklEXVxuICAgICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5sb2dnZXJzTEssIHRoaXMubG9nZ2VycylcbiAgICAgIHJldHVybiBgJHtsb2dnZXJJRH0gbG9nZ2VyICR7c3RhdGUgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWBcbiAgICB9XG4gICAgLy8gRW5hYmxlIGxvZ2dpbmcgZnJvbSBhbnl3aGVyZS5cbiAgICB3aW5kb3cubG9nID0gKGxvZ2dlcklELCAuLi5hKSA9PiB7IHRoaXMubG9nKGxvZ2dlcklELCAuLi5hKSB9XG4gICAgd2luZG93Lm1tU3RhdHVzID0gKCkgPT4gdGhpcy5tbVN0YXR1c1xuXG4gICAgLy8gUmVjb3JkZXJzIGNhbiByZWNvcmQgbG9nIG1lc3NhZ2VzLCBhbmQgdGhlbiBzYXZlIHRoZW0gdG8gZmlsZSBvbiByZXF1ZXN0LlxuICAgIGNvbnN0IHJlY29yZGVyS2V5cyA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUucmVjb3JkZXJzTEspIHx8IFtdXG4gICAgdGhpcy5yZWNvcmRlcnMgPSB7fVxuICAgIGZvciAoY29uc3QgbG9nZ2VySUQgb2YgcmVjb3JkZXJLZXlzKSB7XG4gICAgICBjb25zb2xlLmxvZygncmVjb3JkaW5nJywgbG9nZ2VySUQpXG4gICAgICB0aGlzLnJlY29yZGVyc1tsb2dnZXJJRF0gPSBbXVxuICAgIH1cbiAgICB3aW5kb3cucmVjb3JkTG9nZ2VyID0gKGxvZ2dlcklELCBvbikgPT4ge1xuICAgICAgaWYgKG9uKSB0aGlzLnJlY29yZGVyc1tsb2dnZXJJRF0gPSBbXVxuICAgICAgZWxzZSBkZWxldGUgdGhpcy5yZWNvcmRlcnNbbG9nZ2VySURdXG4gICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLnJlY29yZGVyc0xLLCBPYmplY3Qua2V5cyh0aGlzLnJlY29yZGVycykpXG4gICAgICByZXR1cm4gYCR7bG9nZ2VySUR9IHJlY29yZGVyICR7b24gPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWBcbiAgICB9XG4gICAgd2luZG93LmR1bXBMb2dnZXIgPSBsb2dnZXJJRCA9PiB7XG4gICAgICBjb25zdCByZWNvcmQgPSB0aGlzLnJlY29yZGVyc1tsb2dnZXJJRF1cbiAgICAgIGlmICghcmVjb3JkKSByZXR1cm4gYG5vIHJlY29yZGVyIGZvciBsb2dnZXIgJHtsb2dnZXJJRH1gXG4gICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpXG4gICAgICBhLmhyZWYgPSBgZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LCR7d2luZG93LmJ0b2EoSlNPTi5zdHJpbmdpZnkocmVjb3JkLCBudWxsLCA0KSl9YFxuICAgICAgYS5kb3dubG9hZCA9IGAke2xvZ2dlcklEfS5qc29uYFxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKVxuICAgICAgYS5jbGljaygpXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKVxuICAgICAgfSwgMClcbiAgICB9XG5cbiAgICB3aW5kb3cudXNlciA9ICgpID0+IHRoaXMudXNlclxuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHRoZSBhcHBsaWNhdGlvbi4gVGhpcyBpcyB0aGUgb25seSB0aGluZyBkb25lIGZyb20gdGhlIGluZGV4LmpzIGVudHJ5XG4gICAqIHBvaW50LiBSZWFkIHRoZSBpZCA9IG1haW4gZWxlbWVudCBhbmQgYXR0YWNoIGhhbmRsZXJzLlxuICAgKi9cbiAgYXN5bmMgc3RhcnQgKCkge1xuICAgIC8vIEhhbmRsZSBiYWNrIG5hdmlnYXRpb24gZnJvbSB0aGUgYnJvd3Nlci5cbiAgICBiaW5kKHdpbmRvdywgJ3BvcHN0YXRlJywgKGU6IFBvcFN0YXRlRXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHBhZ2UgPSBlLnN0YXRlPy5wYWdlXG4gICAgICBpZiAoIXBhZ2UgJiYgcGFnZSAhPT0gJycpIHJldHVyblxuICAgICAgdGhpcy5sb2FkUGFnZShwYWdlLCBlLnN0YXRlLmRhdGEsIHRydWUpXG4gICAgfSlcbiAgICAvLyBUaGUgbWFpbiBlbGVtZW50IGlzIHRoZSBpbnRlcmNoYW5nZWFibGUgcGFydCBvZiB0aGUgcGFnZSB0aGF0IGRvZXNuJ3RcbiAgICAvLyBpbmNsdWRlIHRoZSBoZWFkZXIuIE1haW4gc2hvdWxkIGRlZmluZSBhIGRhdGEtaGFuZGxlciBhdHRyaWJ1dGVcbiAgICAvLyBhc3NvY2lhdGVkIHdpdGggb25lIG9mIHRoZSBhdmFpbGFibGUgY29uc3RydWN0b3JzLlxuICAgIHRoaXMubWFpbiA9IGlkZWwoZG9jdW1lbnQsICdtYWluJylcbiAgICBjb25zdCBoYW5kbGVyID0gdGhpcy5tYWluLmRhdGFzZXQuaGFuZGxlclxuICAgIC8vIERvbid0IGZldGNoIHRoZSB1c2VyIHVudGlsIHdlIGtub3cgd2hhdCBwYWdlIHdlJ3JlIG9uLlxuICAgIGF3YWl0IHRoaXMuZmV0Y2hVc2VyKClcbiAgICBjb25zdCBpZ25vcmVDYWNoZWRMb2NhbGUgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50J1xuICAgIGF3YWl0IGludGwubG9hZExvY2FsZSh0aGlzLmxhbmcsIHRoaXMuY29tbWl0SGFzaCwgaWdub3JlQ2FjaGVkTG9jYWxlKVxuICAgIC8vIFRoZSBhcHBsaWNhdGlvbiBpcyBmcmVlIHRvIHJlc3BvbmQgd2l0aCBhIHBhZ2UgdGhhdCBkaWZmZXJzIGZyb20gdGhlXG4gICAgLy8gb25lIHJlcXVlc3RlZCBpbiB0aGUgb21uaWJveCwgZS5nLiByb3V0aW5nIHRob3VnaCBhIGxvZ2luIHBhZ2UuIFNldCB0aGVcbiAgICAvLyBjdXJyZW50IFVSTCBzdGF0ZSBiYXNlZCBvbiB0aGUgYWN0dWFsIHBhZ2UuXG4gICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZilcbiAgICBpZiAoaGFuZGxlckZyb21QYXRoKHVybC5wYXRobmFtZSkgIT09IGhhbmRsZXIpIHtcbiAgICAgIHVybC5wYXRobmFtZSA9IGAvJHtoYW5kbGVyfWBcbiAgICAgIHVybC5zZWFyY2ggPSAnJ1xuICAgICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKHsgcGFnZTogaGFuZGxlciB9LCAnJywgdXJsKVxuICAgIH1cbiAgICAvLyBBdHRhY2ggc3R1ZmYuXG4gICAgdGhpcy5hdHRhY2hIZWFkZXIoKVxuICAgIHRoaXMuYXR0YWNoQWN0aW9ucygpXG4gICAgdGhpcy5hdHRhY2hDb21tb24odGhpcy5oZWFkZXIpXG4gICAgdGhpcy5hdHRhY2goe30pXG5cbiAgICAvLyBJZiB3ZSBhcmUgYXV0aGVkLCBwb3B1bGF0ZSBub3Rlcywgb3RoZXJ3aXNlIGdldCB3ZSdsbCB0aGVtIGZyb20gdGhlIGxvZ2luXG4gICAgLy8gcmVzcG9uc2UuXG4gICAgaWYgKHRoaXMuYXV0aGVkKSBhd2FpdCB0aGlzLmZldGNoTm90ZXMoKVxuICAgIHRoaXMudXBkYXRlTWVudUl0ZW1zRGlzcGxheSgpXG4gICAgLy8gaW5pdGlhbGl6ZSBkZXNrdG9wIG5vdGlmaWNhdGlvbnNcbiAgICBudGZuLmZldGNoRGVza3RvcE50Zm5TZXR0aW5ncygpXG4gICAgLy8gQ29ubmVjdCB0aGUgd2Vic29ja2V0IGFuZCByZWdpc3RlciB0aGUgbm90aWZpY2F0aW9uIHJvdXRlLlxuICAgIHdzLmNvbm5lY3QoZ2V0U29ja2V0VVJJKCksICgpID0+IHRoaXMucmVjb25uZWN0ZWQoKSlcbiAgICB3cy5yZWdpc3RlclJvdXRlKG5vdGlmaWNhdGlvblJvdXRlLCAobm90ZTogQ29yZU5vdGUpID0+IHtcbiAgICAgIHRoaXMubm90aWZ5KG5vdGUpXG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICAqIHJlY29ubmVjdGVkIGlzIGNhbGxlZCBieSB0aGUgd2Vic29ja2V0IGNsaWVudCB3aGVuIGEgcmVjb25uZWN0aW9uIGlzIG1hZGUuXG4gICAqL1xuICByZWNvbm5lY3RlZCAoKSB7XG4gICAgaWYgKHRoaXMubWFpbj8uZGF0YXNldC5oYW5kbGVyID09PSAnc2V0dGluZ3MnKSB3aW5kb3cubG9jYXRpb24uYXNzaWduKCcvJylcbiAgICBlbHNlIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKSAvLyBUaGlzIHRyaWdnZXJzIGFub3RoZXIgd2Vic29ja2V0IGRpc2Nvbm5lY3QvY29ubmVjdCAoISlcbiAgICAvLyBhIGZldGNoVXNlcigpIGFuZCBsb2FkUGFnZSh3aW5kb3cuaGlzdG9yeS5zdGF0ZS5wYWdlKSBtaWdodCB3b3JrXG4gIH1cblxuICAvKlxuICAgKiBGZXRjaCBhbmQgc2F2ZSB0aGUgdXNlciwgd2hpY2ggaXMgdGhlIHByaW1hcnkgY29yZSBzdGF0ZSB0aGF0IG11c3QgYmVcbiAgICogbWFpbnRhaW5lZCBieSB0aGUgQXBwbGljYXRpb24uXG4gICAqL1xuICBhc3luYyBmZXRjaFVzZXIgKCk6IFByb21pc2U8VXNlciB8IHZvaWQ+IHtcbiAgICBjb25zdCByZXNwOiBVc2VyUmVzcG9uc2UgPSBhd2FpdCBnZXRKU09OKCcvYXBpL3VzZXInKVxuICAgIGlmICghdGhpcy5jaGVja1Jlc3BvbnNlKHJlc3ApKSByZXR1cm5cbiAgICB0aGlzLmluaXRlZCA9IHJlc3AuaW5pdGVkXG4gICAgdGhpcy5hdXRoZWQgPSBCb29sZWFuKHJlc3AudXNlcilcbiAgICB0aGlzLmxhbmcgPSByZXNwLmxhbmdcbiAgICB0aGlzLmxhbmdzID0gcmVzcC5sYW5nc1xuICAgIHRoaXMubW1TdGF0dXMgPSByZXNwLm1tU3RhdHVzXG4gICAgaWYgKCFyZXNwLnVzZXIpIHJldHVyblxuICAgIGNvbnN0IHVzZXIgPSByZXNwLnVzZXJcbiAgICB0aGlzLnNlZWRHZW5UaW1lID0gdXNlci5zZWVkZ2VudGltZVxuICAgIHRoaXMudXNlciA9IHVzZXJcbiAgICB0aGlzLmFzc2V0cyA9IHVzZXIuYXNzZXRzXG4gICAgdGhpcy5leGNoYW5nZXMgPSB1c2VyLmV4Y2hhbmdlc1xuICAgIHRoaXMud2FsbGV0TWFwID0ge31cbiAgICB0aGlzLmZpYXRSYXRlc01hcCA9IHVzZXIuZmlhdFJhdGVzXG4gICAgZm9yIChjb25zdCBbYXNzZXRJRCwgYXNzZXRdIG9mIChPYmplY3QuZW50cmllcyh1c2VyLmFzc2V0cykgYXMgW2FueSwgU3VwcG9ydGVkQXNzZXRdW10pKSB7XG4gICAgICBpZiAoYXNzZXQud2FsbGV0KSB7XG4gICAgICAgIHRoaXMud2FsbGV0TWFwW2Fzc2V0SURdID0gYXNzZXQud2FsbGV0XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVNZW51SXRlbXNEaXNwbGF5KClcbiAgICByZXR1cm4gdXNlclxuICB9XG5cbiAgYXN5bmMgZmV0Y2hNTVN0YXR1cyAoKSB7XG4gICAgdGhpcy5tbVN0YXR1cyA9IGF3YWl0IE1NLnN0YXR1cygpXG4gIH1cblxuICAvKiBMb2FkIHRoZSBwYWdlIGZyb20gdGhlIHNlcnZlci4gSW5zZXJ0IGFuZCBiaW5kIHRoZSBET00uICovXG4gIGFzeW5jIGxvYWRQYWdlIChwYWdlOiBzdHJpbmcsIGRhdGE/OiBhbnksIHNraXBQdXNoPzogYm9vbGVhbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIC8vIENsb3NlIHNvbWUgbWVudXMgYW5kIHRvb2x0aXBzLlxuICAgIHRoaXMudG9vbHRpcC5zdHlsZS5sZWZ0ID0gJy0xMDAwMHB4J1xuICAgIERvYy5oaWRlKHRoaXMucGFnZS5ub3RlQm94LCB0aGlzLnBhZ2UucHJvZmlsZUJveClcbiAgICAvLyBQYXJzZSB0aGUgcmVxdWVzdC5cbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGAvJHtwYWdlfWAsIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pXG4gICAgY29uc3QgcmVxdWVzdGVkSGFuZGxlciA9IGhhbmRsZXJGcm9tUGF0aChwYWdlKVxuICAgIC8vIEZldGNoIGFuZCBwYXJzZSB0aGUgcGFnZS5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHdpbmRvdy5mZXRjaCh1cmwudG9TdHJpbmcoKSlcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSByZXR1cm4gZmFsc2VcbiAgICBjb25zdCBodG1sID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpXG4gICAgY29uc3QgZG9jID0gRG9jLm5vZGVyaXplKGh0bWwpXG4gICAgY29uc3QgbWFpbiA9IGlkZWwoZG9jLCAnbWFpbicpXG4gICAgY29uc3QgZGVsaXZlcmVkID0gbWFpbi5kYXRhc2V0LmhhbmRsZXJcbiAgICAvLyBBcHBlbmQgdGhlIHJlcXVlc3QgdG8gdGhlIHBhZ2UgaGlzdG9yeS5cbiAgICBpZiAoIXNraXBQdXNoKSB7XG4gICAgICBjb25zdCBwYXRoID0gZGVsaXZlcmVkID09PSByZXF1ZXN0ZWRIYW5kbGVyID8gdXJsLnRvU3RyaW5nKCkgOiBgLyR7ZGVsaXZlcmVkfWBcbiAgICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSh7IHBhZ2U6IHBhZ2UsIGRhdGE6IGRhdGEgfSwgJycsIHBhdGgpXG4gICAgfVxuICAgIC8vIEluc2VydCBwYWdlIGFuZCBhdHRhY2ggaGFuZGxlcnMuXG4gICAgZG9jdW1lbnQudGl0bGUgPSBkb2MudGl0bGVcbiAgICB0aGlzLm1haW4ucmVwbGFjZVdpdGgobWFpbilcbiAgICB0aGlzLm1haW4gPSBtYWluXG4gICAgdGhpcy5ub3RlUmVjZWl2ZXJzID0gW11cbiAgICBEb2MuZW1wdHkodGhpcy5oZWFkZXJTcGFjZSlcbiAgICB0aGlzLmF0dGFjaChkYXRhKVxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICAvKiBhdHRhY2ggYmluZHMgdGhlIGNvbW1vbiBoYW5kbGVycyBhbmQgY2FsbHMgdGhlIHBhZ2UgY29uc3RydWN0b3IuICovXG4gIGF0dGFjaCAoZGF0YTogYW55KSB7XG4gICAgY29uc3QgaGFuZGxlcklEID0gdGhpcy5tYWluLmRhdGFzZXQuaGFuZGxlclxuICAgIGlmICghaGFuZGxlcklEKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdjYW5ub3QgYXR0YWNoIHRvIGNvbnRlbnQgd2l0aCBubyBzcGVjaWZpZWQgaGFuZGxlcicpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5hdHRhY2hDb21tb24odGhpcy5tYWluKVxuICAgIGlmICh0aGlzLmxvYWRlZFBhZ2UpIHRoaXMubG9hZGVkUGFnZS51bmxvYWQoKVxuICAgIGNvbnN0IGNvbnN0cnVjdG9yID0gY29uc3RydWN0b3JzW2hhbmRsZXJJRF1cbiAgICBpZiAoY29uc3RydWN0b3IpIHRoaXMubG9hZGVkUGFnZSA9IG5ldyBjb25zdHJ1Y3Rvcih0aGlzLm1haW4sIGRhdGEpXG4gICAgZWxzZSB0aGlzLmxvYWRlZFBhZ2UgPSBudWxsXG5cbiAgICAvLyBCaW5kIHRoZSB0b29sdGlwcy5cbiAgICB0aGlzLmJpbmRUb29sdGlwcyh0aGlzLm1haW4pXG5cbiAgICBpZiAod2luZG93LmlzV2Vidmlldykge1xuICAgICAgLy8gQmluZCB3ZWJ2aWV3IFVSTCBoYW5kbGVyc1xuICAgICAgdGhpcy5iaW5kVXJsSGFuZGxlcnModGhpcy5tYWluKVxuICAgIH1cblxuICAgIHRoaXMuYmluZFVuaXRzKHRoaXMubWFpbilcbiAgfVxuXG4gIGJpbmRUb29sdGlwcyAoYW5jZXN0b3I6IEhUTUxFbGVtZW50KSB7XG4gICAgYW5jZXN0b3IucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdG9vbHRpcF0nKS5mb3JFYWNoKChlbDogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgIGJpbmQoZWwsICdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnRvb2x0aXAudGV4dENvbnRlbnQgPSBlbC5kYXRhc2V0LnRvb2x0aXAgfHwgJydcbiAgICAgICAgY29uc3QgbHl0ID0gRG9jLmxheW91dE1ldHJpY3MoZWwpXG4gICAgICAgIGxldCBsZWZ0ID0gbHl0LmNlbnRlclggLSB0aGlzLnRvb2x0aXAub2Zmc2V0V2lkdGggLyAyXG4gICAgICAgIGlmIChsZWZ0IDwgMCkgbGVmdCA9IDVcbiAgICAgICAgaWYgKGxlZnQgKyB0aGlzLnRvb2x0aXAub2Zmc2V0V2lkdGggPiBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoKSB7XG4gICAgICAgICAgbGVmdCA9IGRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGggLSB0aGlzLnRvb2x0aXAub2Zmc2V0V2lkdGggLSA1XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YFxuICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUudG9wID0gYCR7bHl0LmJvZHlUb3AgLSB0aGlzLnRvb2x0aXAub2Zmc2V0SGVpZ2h0IC0gNX1weGBcbiAgICAgIH0pXG4gICAgICBiaW5kKGVsLCAnbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLmxlZnQgPSAnLTEwMDAwcHgnXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICAvKlxuICAgKiBiaW5kVW5pdHMgYmluZHMgYSBob3ZlcmluZyB1bml0IHNlbGVjdGlvbiBtZW51IHRvIHRoZSB2YWx1ZSBvciByYXRlXG4gICAqIGRpc3BsYXkgZWxlbWVudHMuIFRoZSBtZW51IGdpdmVzIHVzZXJzIGFuIG9wdGlvbiB0byBjb252ZXJ0IHRoZSB2YWx1ZVxuICAgKiB0byB0aGVpciBwcmVmZXJyZWQgdW5pdHMuXG4gICAqL1xuICBiaW5kVW5pdHMgKG1haW46IFBhZ2VFbGVtZW50KSB7XG4gICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykgYXMgUGFnZUVsZW1lbnRcbiAgICBkaXYuY2xhc3NMaXN0LmFkZCgncG9zaXRpb24tYWJzb2x1dGUnLCAncC0zJylcbiAgICAvLyBkaXYuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3llbGxvdydcbiAgICBjb25zdCByb3dzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykgYXMgUGFnZUVsZW1lbnRcbiAgICBkaXYuYXBwZW5kQ2hpbGQocm93cylcbiAgICByb3dzLmNsYXNzTGlzdC5hZGQoJ2JvZHktYmcnLCAnYm9yZGVyJylcbiAgICBjb25zdCBhZGRSb3cgPSAoZWw6IFBhZ2VFbGVtZW50LCB1bml0OiBzdHJpbmcsIGNGYWN0b3I6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3QgYm94ID0gRG9jLnNhZmVTZWxlY3RvcihlbCwgJ1tkYXRhLXVuaXQtYm94XScpXG4gICAgICBjb25zdCBhdG9tcyA9IHBhcnNlSW50KGJveC5kYXRhc2V0LmF0b21zIGFzIHN0cmluZylcbiAgICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICByb3cudGV4dENvbnRlbnQgPSB1bml0XG4gICAgICByb3dzLmFwcGVuZENoaWxkKHJvdylcbiAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdwLTInLCAnaG92ZXJiZycsICdwb2ludGVyJylcbiAgICAgIERvYy5iaW5kKHJvdywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBEb2Muc2V0VGV4dChlbCwgJ1tkYXRhLXZhbHVlXScsIERvYy5mb3JtYXRGb3VyU2lnRmlncyhhdG9tcyAvIGNGYWN0b3IsIE1hdGgucm91bmQoTWF0aC5sb2cxMChjRmFjdG9yKSkpKVxuICAgICAgICBEb2Muc2V0VGV4dChlbCwgJ1tkYXRhLXVuaXRdJywgdW5pdClcbiAgICAgIH0pXG4gICAgfVxuICAgIGZvciAoY29uc3QgZWwgb2YgRG9jLmFwcGx5U2VsZWN0b3IobWFpbiwgJ1tkYXRhLWNvbnZlcnNpb24tdmFsdWVdJykpIHtcbiAgICAgIGNvbnN0IGJveCA9IERvYy5zYWZlU2VsZWN0b3IoZWwsICdbZGF0YS11bml0LWJveF0nKVxuICAgICAgRG9jLmJpbmQoYm94LCAnbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgRG9jLmVtcHR5KHJvd3MpXG4gICAgICAgIGJveC5hcHBlbmRDaGlsZChkaXYpXG4gICAgICAgIGNvbnN0IGx5dCA9IERvYy5sYXlvdXRNZXRyaWNzKGJveClcbiAgICAgICAgY29uc3QgYXNzZXRJRCA9IHBhcnNlSW50KGJveC5kYXRhc2V0LmFzc2V0SUQgYXMgc3RyaW5nKVxuICAgICAgICBjb25zdCB7IHVuaXRJbmZvOiB1aSB9ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICAgICAgYWRkUm93KGVsLCB1aS5jb252ZW50aW9uYWwudW5pdCwgdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgICAgIGZvciAoY29uc3QgeyB1bml0LCBjb252ZXJzaW9uRmFjdG9yIH0gb2YgdWkuZGVub21pbmF0aW9ucykgYWRkUm93KGVsLCB1bml0LCBjb252ZXJzaW9uRmFjdG9yKVxuICAgICAgICBhZGRSb3coZWwsIHVpLmF0b21pY1VuaXQsIDEpXG4gICAgICAgIGlmIChseXQuYm9keVRvcCA+IChkaXYub2Zmc2V0SGVpZ2h0ICsgdGhpcy5oZWFkZXIub2Zmc2V0SGVpZ2h0KSkge1xuICAgICAgICAgIGRpdi5zdHlsZS5ib3R0b20gPSAnY2FsYygxMDAlIC0gMXJlbSknXG4gICAgICAgICAgZGl2LnN0eWxlLnRvcCA9ICdhdXRvJ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRpdi5zdHlsZS50b3AgPSAnY2FsYygxMDAlIC0gMXJlbSknXG4gICAgICAgICAgZGl2LnN0eWxlLmJvdHRvbSA9ICdhdXRvJ1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgRG9jLmJpbmQoYm94LCAnbW91c2VsZWF2ZScsICgpID0+IGRpdi5yZW1vdmUoKSlcbiAgICB9XG4gIH1cblxuICBiaW5kVXJsSGFuZGxlcnMgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCkge1xuICAgIGlmICghd2luZG93Lm9wZW5VcmwpIHJldHVyblxuICAgIGZvciAoY29uc3QgbGluayBvZiBEb2MuYXBwbHlTZWxlY3RvcihhbmNlc3RvciwgJ2FbdGFyZ2V0PV9ibGFua10nKSkge1xuICAgICAgRG9jLmJpbmQobGluaywgJ2NsaWNrJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIHdpbmRvdy5vcGVuVXJsKGxpbmsuaHJlZiA/PyAnJylcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgLyogYXR0YWNoSGVhZGVyIGF0dGFjaGVzIHRoZSBoZWFkZXIgZWxlbWVudCwgd2hpY2ggdW5saWtlIHRoZSBtYWluIGVsZW1lbnQsXG4gICAqIGlzbid0IHJlcGxhY2VkIGR1cmluZyBwYWdlIG5hdmlnYXRpb24uXG4gICAqL1xuICBhdHRhY2hIZWFkZXIgKCkge1xuICAgIHRoaXMuaGVhZGVyID0gaWRlbChkb2N1bWVudC5ib2R5LCAnaGVhZGVyJylcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHModGhpcy5oZWFkZXIpXG4gICAgdGhpcy5oZWFkZXJTcGFjZSA9IHBhZ2UuaGVhZGVyU3BhY2VcbiAgICB0aGlzLnBvcHVwTm90ZXMgPSBpZGVsKGRvY3VtZW50LmJvZHksICdwb3B1cE5vdGVzJylcbiAgICB0aGlzLnBvcHVwVG1wbCA9IERvYy50bXBsRWxlbWVudCh0aGlzLnBvcHVwTm90ZXMsICdub3RlJylcbiAgICBpZiAodGhpcy5wb3B1cFRtcGwpIHRoaXMucG9wdXBUbXBsLnJlbW92ZSgpXG4gICAgZWxzZSBjb25zb2xlLmVycm9yKCdwb3B1cFRtcGwgZWxlbWVudCBub3QgZm91bmQnKVxuICAgIHRoaXMudG9vbHRpcCA9IGlkZWwoZG9jdW1lbnQuYm9keSwgJ3Rvb2x0aXAnKVxuICAgIHBhZ2Uubm90ZVRtcGwucmVtb3ZlQXR0cmlidXRlKCdpZCcpXG4gICAgcGFnZS5ub3RlVG1wbC5yZW1vdmUoKVxuICAgIHBhZ2UucG9rZVRtcGwucmVtb3ZlQXR0cmlidXRlKCdpZCcpXG4gICAgcGFnZS5wb2tlVG1wbC5yZW1vdmUoKVxuICAgIHBhZ2UubG9hZGVyLnJlbW92ZSgpXG4gICAgRG9jLnNob3cocGFnZS5sb2FkZXIpXG5cbiAgICBiaW5kKHBhZ2Uubm90ZUJlbGwsICdjbGljaycsIGFzeW5jICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UucG9rZUxpc3QpXG4gICAgICBEb2Muc2hvdyhwYWdlLm5vdGVMaXN0KVxuICAgICAgdGhpcy5hY2tOb3RlcygpXG4gICAgICBwYWdlLm5vdGVDYXQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcbiAgICAgIHBhZ2UucG9rZUNhdC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgICAgdGhpcy5zaG93RHJvcGRvd24ocGFnZS5ub3RlQmVsbCwgcGFnZS5ub3RlQm94KVxuICAgICAgRG9jLmhpZGUocGFnZS5ub3RlSW5kaWNhdG9yKVxuICAgICAgZm9yIChjb25zdCBub3RlIG9mIHRoaXMubm90ZXMpIHtcbiAgICAgICAgaWYgKG5vdGUuYWNrZWQpIHtcbiAgICAgICAgICBub3RlLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpcnN0dmlldycpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuc2V0Tm90ZVRpbWVzKHBhZ2Uubm90ZUxpc3QpXG4gICAgICB0aGlzLnNldE5vdGVUaW1lcyhwYWdlLnBva2VMaXN0KVxuICAgIH0pXG5cbiAgICBiaW5kKHBhZ2UuYnVyZ2VySWNvbiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5sb2dvdXRFcnIpXG4gICAgICB0aGlzLnNob3dEcm9wZG93bihwYWdlLmJ1cmdlckljb24sIHBhZ2UucHJvZmlsZUJveClcbiAgICB9KVxuXG4gICAgYmluZChwYWdlLmlubmVyTm90ZUljb24sICdjbGljaycsICgpID0+IHsgRG9jLmhpZGUocGFnZS5ub3RlQm94KSB9KVxuICAgIGJpbmQocGFnZS5pbm5lckJ1cmdlckljb24sICdjbGljaycsICgpID0+IHsgRG9jLmhpZGUocGFnZS5wcm9maWxlQm94KSB9KVxuXG4gICAgYmluZChwYWdlLnByb2ZpbGVTaWdub3V0LCAnY2xpY2snLCBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnNpZ25PdXQoKSlcblxuICAgIGJpbmQocGFnZS5wb2tlQ2F0LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnNldE5vdGVUaW1lcyhwYWdlLnBva2VMaXN0KVxuICAgICAgcGFnZS5wb2tlQ2F0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgICBwYWdlLm5vdGVDYXQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICAgIERvYy5oaWRlKHBhZ2Uubm90ZUxpc3QpXG4gICAgICBEb2Muc2hvdyhwYWdlLnBva2VMaXN0KVxuICAgICAgdGhpcy5hY2tOb3RlcygpXG4gICAgfSlcblxuICAgIGJpbmQocGFnZS5ub3RlQ2F0LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnNldE5vdGVUaW1lcyhwYWdlLm5vdGVMaXN0KVxuICAgICAgcGFnZS5ub3RlQ2F0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgICBwYWdlLnBva2VDYXQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICAgIERvYy5oaWRlKHBhZ2UucG9rZUxpc3QpXG4gICAgICBEb2Muc2hvdyhwYWdlLm5vdGVMaXN0KVxuICAgICAgdGhpcy5hY2tOb3RlcygpXG4gICAgfSlcblxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhwYWdlLmxhbmdCdHRuVG1wbClcbiAgICBjb25zdCB7IG5hbWUsIGZsYWcgfSA9IGxhbmd1YWdlRGF0YVt0aGlzLmxhbmddXG4gICAgcGFnZS5sYW5nRmxhZy50ZXh0Q29udGVudCA9IGZsYWdcbiAgICBwYWdlLmxhbmdOYW1lLnRleHRDb250ZW50ID0gbmFtZVxuXG4gICAgZm9yIChjb25zdCBsYW5nIG9mIHRoaXMubGFuZ3MpIHtcbiAgICAgIGlmIChsYW5nID09PSB0aGlzLmxhbmcpIGNvbnRpbnVlXG4gICAgICBjb25zdCBkaXYgPSBwYWdlLmxhbmdCdHRuVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIGNvbnN0IHsgbmFtZSwgZmxhZyB9ID0gbGFuZ3VhZ2VEYXRhW2xhbmddXG4gICAgICBkaXYudGV4dENvbnRlbnQgPSBmbGFnXG4gICAgICBkaXYudGl0bGUgPSBuYW1lXG4gICAgICBEb2MuYmluZChkaXYsICdjbGljaycsICgpID0+IHRoaXMuc2V0TGFuZ3VhZ2UobGFuZykpXG4gICAgICBwYWdlLmxhbmdCdHRucy5hcHBlbmRDaGlsZChkaXYpXG4gICAgfVxuICB9XG5cbiAgYXR0YWNoQWN0aW9ucyAoKSB7XG4gICAgY29uc3QgeyBwYWdlIH0gPSB0aGlzXG4gICAgT2JqZWN0LmFzc2lnbihwYWdlLCBEb2MuaWREZXNjZW5kYW50cyhEb2MuaWRlbChkb2N1bWVudC5ib2R5LCAncmVxdWlyZWRBY3Rpb25zJykpKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhwYWdlLm1pc3NpbmdOb25jZXNUbXBsLCBwYWdlLmFjdGlvblR4VGFibGVUbXBsLCBwYWdlLnRvb0NoZWFwVG1wbCwgcGFnZS5sb3N0Tm9uY2VUbXBsKVxuICAgIERvYy5iaW5kKHBhZ2UuYWN0aW9uc0NvbGxhcHNlLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLmFjdGlvbkRpYWxvZylcbiAgICAgIERvYy5zaG93KHBhZ2UuYWN0aW9uRGlhbG9nQ29sbGFwc2VkKVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS5hY3Rpb25EaWFsb2dDb2xsYXBzZWQsICdjbGljaycsICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuYWN0aW9uRGlhbG9nQ29sbGFwc2VkKVxuICAgICAgRG9jLnNob3cocGFnZS5hY3Rpb25EaWFsb2cpXG4gICAgICBpZiAocGFnZS5hY3Rpb25EaWFsb2dDb250ZW50LmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgdGhpcy5zaG93T2xkZXN0QWN0aW9uKClcbiAgICB9KVxuICAgIGNvbnN0IHNob3dBZGphY2VudEFjdGlvbiA9IChkaXI6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBPYmplY3QudmFsdWVzKHRoaXMucmVxdWlyZWRBY3Rpb25zKS5maWx0ZXIoKHI6IHJlcXVpcmVkQWN0aW9uKSA9PiByLnNlbGVjdGVkKVswXVxuICAgICAgY29uc3QgYWN0aW9ucyA9IHRoaXMuc29ydGVkQWN0aW9ucygpXG4gICAgICBjb25zdCBpZHggPSBhY3Rpb25zLmluZGV4T2Yoc2VsZWN0ZWQpXG4gICAgICB0aGlzLnNob3dSZXF1ZXN0ZWRBY3Rpb24oYWN0aW9uc1tpZHggKyBkaXJdLnVuaXF1ZUlEKVxuICAgIH1cbiAgICBEb2MuYmluZChwYWdlLnByZXZBY3Rpb24sICdjbGljaycsICgpID0+IHNob3dBZGphY2VudEFjdGlvbigtMSkpXG4gICAgRG9jLmJpbmQocGFnZS5uZXh0QWN0aW9uLCAnY2xpY2snLCAoKSA9PiBzaG93QWRqYWNlbnRBY3Rpb24oMSkpXG4gIH1cblxuICBzZXRSZXF1aXJlZEFjdGlvbnMgKCkge1xuICAgIGNvbnN0IHsgdXNlcjogeyBhY3Rpb25zIH0sIHJlcXVpcmVkQWN0aW9ucyB9ID0gdGhpc1xuICAgIGlmICghYWN0aW9ucykgcmV0dXJuXG4gICAgZm9yIChjb25zdCBhIG9mIGFjdGlvbnMpIHRoaXMuYWRkQWN0aW9uKGEpXG4gICAgaWYgKE9iamVjdC5rZXlzKHJlcXVpcmVkQWN0aW9ucykubGVuZ3RoKSB7XG4gICAgICB0aGlzLnNob3dPbGRlc3RBY3Rpb24oKVxuICAgICAgdGhpcy5ibGlua0FjdGlvbigpXG4gICAgfVxuICB9XG5cbiAgc29ydGVkQWN0aW9ucyAoKSB7XG4gICAgY29uc3QgYWN0aW9ucyA9IE9iamVjdC52YWx1ZXModGhpcy5yZXF1aXJlZEFjdGlvbnMpXG4gICAgYWN0aW9ucy5zb3J0KChhOiByZXF1aXJlZEFjdGlvbiwgYjogcmVxdWlyZWRBY3Rpb24pID0+IGEuc3RhbXAgLSBiLnN0YW1wKVxuICAgIHJldHVybiBhY3Rpb25zXG4gIH1cblxuICBzaG93T2xkZXN0QWN0aW9uICgpIHtcbiAgICB0aGlzLnNob3dSZXF1ZXN0ZWRBY3Rpb24odGhpcy5zb3J0ZWRBY3Rpb25zKClbMF0udW5pcXVlSUQpXG4gIH1cblxuICBhZGRBY3Rpb24gKHJlcTogQWN0aW9uUmVxdWlyZWROb3RlKSB7XG4gICAgY29uc3QgeyBwYWdlLCByZXF1aXJlZEFjdGlvbnMgfSA9IHRoaXNcbiAgICBjb25zdCBleGlzdGluZ0FjdGlvbiA9IHJlcXVpcmVkQWN0aW9uc1tyZXEudW5pcXVlSURdXG4gICAgaWYgKGV4aXN0aW5nQWN0aW9uICYmIGV4aXN0aW5nQWN0aW9uLmFjdGlvbklEID09PSByZXEuYWN0aW9uSUQpIHJldHVyblxuICAgIGNvbnN0IGRpdiA9IHRoaXMuYWN0aW9uRm9ybShyZXEpXG4gICAgaWYgKGV4aXN0aW5nQWN0aW9uKSB7XG4gICAgICBpZiAoZXhpc3RpbmdBY3Rpb24uc2VsZWN0ZWQpIGV4aXN0aW5nQWN0aW9uLmRpdi5yZXBsYWNlV2l0aChkaXYpXG4gICAgICBleGlzdGluZ0FjdGlvbi5kaXYgPSBkaXZcbiAgICB9IGVsc2Uge1xuICAgICAgcmVxdWlyZWRBY3Rpb25zW3JlcS51bmlxdWVJRF0gPSB7XG4gICAgICAgIGRpdixcbiAgICAgICAgc3RhbXA6IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCksXG4gICAgICAgIHVuaXF1ZUlEOiByZXEudW5pcXVlSUQsXG4gICAgICAgIGFjdGlvbklEOiByZXEuYWN0aW9uSUQsXG4gICAgICAgIHNlbGVjdGVkOiBmYWxzZVxuICAgICAgfVxuICAgICAgY29uc3QgbiA9IE9iamVjdC5rZXlzKHJlcXVpcmVkQWN0aW9ucykubGVuZ3RoXG4gICAgICBwYWdlLmFjdGlvbkRpYWxvZ0NvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKG4pXG4gICAgICBwYWdlLmFjdGlvbkNvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKG4pXG4gICAgICBpZiAoRG9jLmlzSGlkZGVuKHBhZ2UuYWN0aW9uRGlhbG9nKSkge1xuICAgICAgICB0aGlzLnNob3dSZXF1ZXN0ZWRBY3Rpb24ocmVxLnVuaXF1ZUlEKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGJsaW5rQWN0aW9uICgpIHtcbiAgICBEb2MuYmxpbmsodGhpcy5wYWdlLmFjdGlvbkRpYWxvZylcbiAgICBEb2MuYmxpbmsodGhpcy5wYWdlLmFjdGlvbkRpYWxvZ0NvbGxhcHNlZClcbiAgfVxuXG4gIHJlc29sdmVBY3Rpb24gKHJlcTogQWN0aW9uUmVzb2x2ZWROb3RlKSB7XG4gICAgdGhpcy5yZXNvbHZlQWN0aW9uV2l0aElEKHJlcS51bmlxdWVJRClcbiAgfVxuXG4gIHJlc29sdmVBY3Rpb25XaXRoSUQgKHVuaXF1ZUlEOiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHJlcXVpcmVkQWN0aW9ucyB9ID0gdGhpc1xuICAgIGNvbnN0IGV4aXN0aW5nQWN0aW9uID0gcmVxdWlyZWRBY3Rpb25zW3VuaXF1ZUlEXVxuICAgIGlmICghZXhpc3RpbmdBY3Rpb24pIHJldHVyblxuICAgIGRlbGV0ZSByZXF1aXJlZEFjdGlvbnNbdW5pcXVlSURdXG4gICAgY29uc3QgcmVtID0gT2JqZWN0LmtleXMocmVxdWlyZWRBY3Rpb25zKS5sZW5ndGhcbiAgICBleGlzdGluZ0FjdGlvbi5kaXYucmVtb3ZlKClcbiAgICBpZiAocmVtID09PSAwKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLmFjdGlvbkRpYWxvZywgcGFnZS5hY3Rpb25EaWFsb2dDb2xsYXBzZWQpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgcGFnZS5hY3Rpb25EaWFsb2dDb3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhyZW0pXG4gICAgcGFnZS5hY3Rpb25Db3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhyZW0pXG4gICAgaWYgKGV4aXN0aW5nQWN0aW9uLnNlbGVjdGVkKSB0aGlzLnNob3dPbGRlc3RBY3Rpb24oKVxuICB9XG5cbiAgYWN0aW9uRm9ybSAocmVxOiBBY3Rpb25SZXF1aXJlZE5vdGUpIHtcbiAgICBzd2l0Y2ggKHJlcS5hY3Rpb25JRCkge1xuICAgICAgY2FzZSAndG9vQ2hlYXAnOlxuICAgICAgICByZXR1cm4gdGhpcy50b29DaGVhcEFjdGlvbihyZXEpXG4gICAgICBjYXNlICdtaXNzaW5nTm9uY2VzJzpcbiAgICAgICAgcmV0dXJuIHRoaXMubWlzc2luZ05vbmNlc0FjdGlvbihyZXEpXG4gICAgICBjYXNlICdsb3N0Tm9uY2UnOlxuICAgICAgICByZXR1cm4gdGhpcy5sb3N0Tm9uY2VBY3Rpb24ocmVxKVxuICAgICAgY2FzZSAncmVkZWVtUmVqZWN0ZWQnOlxuICAgICAgICByZXR1cm4gdGhpcy5yZWRlZW1SZWplY3RlZEFjdGlvbihyZXEpXG4gICAgfVxuICAgIHRocm93IEVycm9yKCd1bmtub3duIHJlcXVpcmVkIGFjdGlvbiBJRCAnICsgcmVxLmFjdGlvbklEKVxuICB9XG5cbiAgYWN0aW9uVHhUYWJsZSAocmVxOiBBY3Rpb25SZXF1aXJlZE5vdGUpIHtcbiAgICBjb25zdCB7IGFzc2V0SUQsIHBheWxvYWQgfSA9IHJlcVxuICAgIGNvbnN0IG4gPSBwYXlsb2FkIGFzIFRyYW5zYWN0aW9uQWN0aW9uTm90ZVxuICAgIGNvbnN0IHsgdW5pdEluZm86IHVpLCB0b2tlbiB9ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICBjb25zdCB0YWJsZSA9IHRoaXMucGFnZS5hY3Rpb25UeFRhYmxlVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodGFibGUpXG4gICAgdG1wbC5sb3N0VHhJRC50ZXh0Q29udGVudCA9IG4udHguaWRcbiAgICB0bXBsLmxvc3RUeElELmRhdGFzZXQuZXhwbG9yZXJDb2luID0gbi50eC5pZFxuICAgIHNldENvaW5IcmVmKHRva2VuID8gdG9rZW4ucGFyZW50SUQgOiBhc3NldElELCB0bXBsLmxvc3RUeElEKVxuICAgIHRtcGwudHhBbXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG4udHguYW1vdW50LCB1aSlcbiAgICB0bXBsLmFtdFVuaXQudGV4dENvbnRlbnQgPSB1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIGNvbnN0IHBhcmVudFVJID0gdG9rZW4gPyB0aGlzLnVuaXRJbmZvKHRva2VuLnBhcmVudElEKSA6IHVpXG4gICAgdG1wbC50eXBlLnRleHRDb250ZW50ID0gdHhUeXBlU3RyaW5nKG4udHgudHlwZSlcbiAgICB0bXBsLmZlZUFtb3VudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobi50eC5mZWVzLCBwYXJlbnRVSSlcbiAgICB0bXBsLmZlZVVuaXQudGV4dENvbnRlbnQgPSBwYXJlbnRVSS5jb252ZW50aW9uYWwudW5pdFxuICAgIHN3aXRjaCAocmVxLmFjdGlvbklEKSB7XG4gICAgICBjYXNlICd0b29DaGVhcCc6IHtcbiAgICAgICAgRG9jLnNob3codG1wbC5uZXdGZWVzUm93KVxuICAgICAgICB0bXBsLm5ld0ZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG4udHguZmVlcywgcGFyZW50VUkpXG4gICAgICAgIHRtcGwubmV3RmVlc1VuaXQudGV4dENvbnRlbnQgPSBwYXJlbnRVSS5jb252ZW50aW9uYWwudW5pdFxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFibGVcbiAgfVxuXG4gIGFzeW5jIHN1Ym1pdEFjdGlvbiAocmVxOiBBY3Rpb25SZXF1aXJlZE5vdGUsIGFjdGlvbjogYW55LCBlcnJNc2c6IFBhZ2VFbGVtZW50KSB7XG4gICAgRG9jLmhpZGUoZXJyTXNnKVxuICAgIGNvbnN0IGxvYWRpbmcgPSB0aGlzLmxvYWRpbmcodGhpcy5wYWdlLmFjdGlvbkRpYWxvZylcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS90YWtlYWN0aW9uJywge1xuICAgICAgYXNzZXRJRDogcmVxLmFzc2V0SUQsXG4gICAgICBhY3Rpb25JRDogcmVxLmFjdGlvbklELFxuICAgICAgYWN0aW9uXG4gICAgfSlcbiAgICBsb2FkaW5nKClcbiAgICBpZiAoIXRoaXMuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBlcnJNc2cudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhlcnJNc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5yZXNvbHZlQWN0aW9uV2l0aElEKHJlcS51bmlxdWVJRClcbiAgfVxuXG4gIG1pc3NpbmdOb25jZXNBY3Rpb24gKHJlcTogQWN0aW9uUmVxdWlyZWROb3RlKSB7XG4gICAgY29uc3QgeyBhc3NldElEIH0gPSByZXFcbiAgICBjb25zdCBkaXYgPSB0aGlzLnBhZ2UubWlzc2luZ05vbmNlc1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcbiAgICBjb25zdCB7IG5hbWUgfSA9IHRoaXMuYXNzZXRzW2Fzc2V0SURdXG4gICAgdG1wbC5hc3NldE5hbWUudGV4dENvbnRlbnQgPSBuYW1lXG4gICAgRG9jLmJpbmQodG1wbC5kb05vdGhpbmdCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN1Ym1pdEFjdGlvbihyZXEsIHsgcmVjb3ZlcjogZmFsc2UgfSwgdG1wbC5lcnJNc2cpXG4gICAgfSlcbiAgICBEb2MuYmluZCh0bXBsLnJlY292ZXJCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN1Ym1pdEFjdGlvbihyZXEsIHsgcmVjb3ZlcjogdHJ1ZSB9LCB0bXBsLmVyck1zZylcbiAgICB9KVxuICAgIHJldHVybiBkaXZcbiAgfVxuXG4gIHRvb0NoZWFwQWN0aW9uIChyZXE6IEFjdGlvblJlcXVpcmVkTm90ZSkge1xuICAgIGNvbnN0IHsgYXNzZXRJRCwgcGF5bG9hZCB9ID0gcmVxXG4gICAgY29uc3QgbiA9IHBheWxvYWQgYXMgVHJhbnNhY3Rpb25BY3Rpb25Ob3RlXG4gICAgY29uc3QgZGl2ID0gdGhpcy5wYWdlLnRvb0NoZWFwVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgIGNvbnN0IHsgbmFtZSB9ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICB0bXBsLmFzc2V0TmFtZS50ZXh0Q29udGVudCA9IG5hbWVcbiAgICB0bXBsLnR4VGFibGUuYXBwZW5kQ2hpbGQodGhpcy5hY3Rpb25UeFRhYmxlKHJlcSkpXG4gICAgY29uc3QgYWN0ID0gKGJ1bXA6IGJvb2xlYW4pID0+IHtcbiAgICAgIHRoaXMuc3VibWl0QWN0aW9uKHJlcSwge1xuICAgICAgICB0eElEOiBuLnR4LmlkLFxuICAgICAgICBidW1wXG4gICAgICB9LCB0bXBsLmVyck1zZylcbiAgICB9XG4gICAgRG9jLmJpbmQodG1wbC5rZWVwV2FpdGluZ0J0dG4sICdjbGljaycsICgpID0+IGFjdChmYWxzZSkpXG4gICAgRG9jLmJpbmQodG1wbC5hZGRGZWVzQnR0biwgJ2NsaWNrJywgKCkgPT4gYWN0KHRydWUpKVxuICAgIHJldHVybiBkaXZcbiAgfVxuXG4gIGxvc3ROb25jZUFjdGlvbiAocmVxOiBBY3Rpb25SZXF1aXJlZE5vdGUpIHtcbiAgICBjb25zdCB7IGFzc2V0SUQsIHBheWxvYWQgfSA9IHJlcVxuICAgIGNvbnN0IG4gPSBwYXlsb2FkIGFzIFRyYW5zYWN0aW9uQWN0aW9uTm90ZVxuICAgIGNvbnN0IGRpdiA9IHRoaXMucGFnZS5sb3N0Tm9uY2VUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgY29uc3QgeyBuYW1lIH0gPSB0aGlzLmFzc2V0c1thc3NldElEXVxuICAgIHRtcGwuYXNzZXROYW1lLnRleHRDb250ZW50ID0gbmFtZVxuICAgIHRtcGwubm9uY2UudGV4dENvbnRlbnQgPSBTdHJpbmcobi5ub25jZSlcbiAgICB0bXBsLnR4VGFibGUuYXBwZW5kQ2hpbGQodGhpcy5hY3Rpb25UeFRhYmxlKHJlcSkpXG4gICAgRG9jLmJpbmQodG1wbC5hYmFuZG9uQnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zdWJtaXRBY3Rpb24ocmVxLCB7IHR4SUQ6IG4udHguaWQsIGFiYW5kb246IHRydWUgfSwgdG1wbC5lcnJNc2cpXG4gICAgfSlcbiAgICBEb2MuYmluZCh0bXBsLmtlZXBXYWl0aW5nQnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zdWJtaXRBY3Rpb24ocmVxLCB7IHR4SUQ6IG4udHguaWQsIGFiYW5kb246IGZhbHNlIH0sIHRtcGwuZXJyTXNnKVxuICAgIH0pXG4gICAgRG9jLmJpbmQodG1wbC5yZXBsYWNlQnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVwbGFjZW1lbnRJRCA9IHRtcGwuaWRJbnB1dC52YWx1ZVxuICAgICAgaWYgKCFyZXBsYWNlbWVudElEKSB7XG4gICAgICAgIHRtcGwuaWRJbnB1dC5mb2N1cygpXG4gICAgICAgIERvYy5ibGluayh0bXBsLmlkSW5wdXQpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgdGhpcy5zdWJtaXRBY3Rpb24ocmVxLCB7IHR4SUQ6IG4udHguaWQsIGFiYW5kb246IGZhbHNlLCByZXBsYWNlbWVudElEIH0sIHRtcGwuZXJyTXNnKVxuICAgIH0pXG4gICAgcmV0dXJuIGRpdlxuICB9XG5cbiAgcmVkZWVtUmVqZWN0ZWRBY3Rpb24gKHJlcTogQWN0aW9uUmVxdWlyZWROb3RlKSB7XG4gICAgY29uc3QgeyBvcmRlcklELCBjb2luSUQsIGNvaW5GbXQsIGFzc2V0SUQgfSA9IHJlcS5wYXlsb2FkIGFzIFJlamVjdGVkUmVkZW1wdGlvbkRhdGFcbiAgICBjb25zdCBkaXYgPSB0aGlzLnBhZ2UucmVqZWN0ZWRSZWRlbXB0aW9uVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgIGNvbnN0IHsgbmFtZSwgdG9rZW4gfSA9IHRoaXMuYXNzZXRzW2Fzc2V0SURdXG4gICAgdG1wbC5hc3NldE5hbWUudGV4dENvbnRlbnQgPSBuYW1lXG4gICAgdG1wbC50eGlkLnRleHRDb250ZW50ID0gY29pbkZtdFxuICAgIHRtcGwudHhpZC5kYXRhc2V0LmV4cGxvcmVyQ29pbiA9IGNvaW5JRFxuICAgIHNldENvaW5IcmVmKHRva2VuID8gdG9rZW4ucGFyZW50SUQgOiBhc3NldElELCB0bXBsLnR4aWQpXG4gICAgRG9jLmJpbmQodG1wbC5kb05vdGhpbmdCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnN1Ym1pdEFjdGlvbihyZXEsIHsgb3JkZXJJRCwgY29pbklELCByZXRyeTogZmFsc2UgfSwgdG1wbC5lcnJNc2cpXG4gICAgfSlcbiAgICBEb2MuYmluZCh0bXBsLnRyeUFnYWluQnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zdWJtaXRBY3Rpb24ocmVxLCB7IG9yZGVySUQsIGNvaW5JRCwgcmV0cnk6IHRydWUgfSwgdG1wbC5lcnJNc2cpXG4gICAgfSlcbiAgICByZXR1cm4gZGl2XG4gIH1cblxuICBzaG93UmVxdWVzdGVkQWN0aW9uICh1bmlxdWVJRDogc3RyaW5nKSB7XG4gICAgY29uc3QgeyBwYWdlLCByZXF1aXJlZEFjdGlvbnMgfSA9IHRoaXNcbiAgICBEb2MuaGlkZShwYWdlLmFjdGlvbkRpYWxvZ0NvbGxhcHNlZClcbiAgICBmb3IgKGNvbnN0IHIgb2YgT2JqZWN0LnZhbHVlcyhyZXF1aXJlZEFjdGlvbnMpKSByLnNlbGVjdGVkID0gci51bmlxdWVJRCA9PT0gdW5pcXVlSURcbiAgICBEb2MuZW1wdHkocGFnZS5hY3Rpb25EaWFsb2dDb250ZW50KVxuICAgIGNvbnN0IGFjdGlvbiA9IHJlcXVpcmVkQWN0aW9uc1t1bmlxdWVJRF1cbiAgICBwYWdlLmFjdGlvbkRpYWxvZ0NvbnRlbnQuYXBwZW5kQ2hpbGQoYWN0aW9uLmRpdilcbiAgICBEb2Muc2hvdyhwYWdlLmFjdGlvbkRpYWxvZylcbiAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5zb3J0ZWRBY3Rpb25zKClcbiAgICBpZiAoYWN0aW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuYWN0aW9uc05hdmlnYXRvcilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2Muc2hvdyhwYWdlLmFjdGlvbnNOYXZpZ2F0b3IpXG4gICAgY29uc3QgaWR4ID0gYWN0aW9ucy5pbmRleE9mKGFjdGlvbilcbiAgICBwYWdlLmN1cnJlbnRBY3Rpb24udGV4dENvbnRlbnQgPSBTdHJpbmcoaWR4ICsgMSlcbiAgICBwYWdlLnByZXZBY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnaW52aXNpYmxlJywgaWR4ID09PSAwKVxuICAgIHBhZ2UubmV4dEFjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpbnZpc2libGUnLCBpZHggPT09IGFjdGlvbnMubGVuZ3RoIC0gMSlcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZU1hcmtldEVsZW1lbnRzIHNldHMgdGhlIHRleHRDb250ZW50IGZvciBhbnkgdGlja2VyIG9yIGFzc2V0IG5hbWVcbiAgICogZWxlbWVudHMgb3IgYW55IGFzc2V0IGxvZ28gc3JjIGF0dHJpYnV0ZXMgZm9yIGRlc2NlbmRlbnRzIG9mIGFuY2VzdG9yLlxuICAgKi9cbiAgdXBkYXRlTWFya2V0RWxlbWVudHMgKGFuY2VzdG9yOiBQYWdlRWxlbWVudCwgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlciwgeGM/OiBFeGNoYW5nZSkge1xuICAgIGNvbnN0IGdldEFzc2V0ID0gKGFzc2V0SUQ6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3QgYSA9IHRoaXMuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBpZiAoYSkgcmV0dXJuIGFcbiAgICAgIGlmICgheGMpIHRocm93IEVycm9yKGBubyBhc3NldCBmb3VuZCBmb3IgYXNzZXQgSUQgJHthc3NldElEfWApXG4gICAgICBjb25zdCB4Y0Fzc2V0ID0geGMuYXNzZXRzW2Fzc2V0SURdXG4gICAgICByZXR1cm4geyB1bml0SW5mbzogeGNBc3NldC51bml0SW5mbywgbmFtZTogeGNBc3NldC5zeW1ib2wsIHN5bWJvbDogeGNBc3NldC5zeW1ib2wgfVxuICAgIH1cbiAgICBjb25zdCB7IHVuaXRJbmZvOiBidWksIG5hbWU6IGJhc2VOYW1lLCBzeW1ib2w6IGJhc2VTeW1ib2wgfSA9IGdldEFzc2V0KGJhc2VJRClcbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtYmFzZS1uYW1lJykpIGVsLnRleHRDb250ZW50ID0gYmFzZU5hbWVcbiAgICBmb3IgKGNvbnN0IGltZyBvZiBEb2MuYXBwbHlTZWxlY3RvcihhbmNlc3RvciwgJ1tkYXRhLWJhc2UtbG9nb10nKSkgaW1nLnNyYyA9IERvYy5sb2dvUGF0aChiYXNlU3ltYm9sKVxuICAgIGZvciAoY29uc3QgZWwgb2YgRG9jLmFwcGx5U2VsZWN0b3IoYW5jZXN0b3IsICdbZGF0YS1iYXNlLXRpY2tlcl0nKSkgZWwudGV4dENvbnRlbnQgPSBidWkuY29udmVudGlvbmFsLnVuaXRcbiAgICBjb25zdCB7IHVuaXRJbmZvOiBxdWksIG5hbWU6IHF1b3RlTmFtZSwgc3ltYm9sOiBxdW90ZVN5bWJvbCB9ID0gZ2V0QXNzZXQocXVvdGVJRClcbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtcXVvdGUtbmFtZScpKSBlbC50ZXh0Q29udGVudCA9IHF1b3RlTmFtZVxuICAgIGZvciAoY29uc3QgaW1nIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtcXVvdGUtbG9nb10nKSkgaW1nLnNyYyA9IERvYy5sb2dvUGF0aChxdW90ZVN5bWJvbClcbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtcXVvdGUtdGlja2VyXScpKSBlbC50ZXh0Q29udGVudCA9IHF1aS5jb252ZW50aW9uYWwudW5pdFxuICB9XG5cbiAgYXN5bmMgc2V0TGFuZ3VhZ2UgKGxhbmc6IHN0cmluZykge1xuICAgIGF3YWl0IHBvc3RKU09OKCcvYXBpL3NldGxvY2FsZScsIGxhbmcpXG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG4gIH1cblxuICAvKlxuICAgKiBzaG93RHJvcGRvd24gc2V0cyB0aGUgcG9zaXRpb24gYW5kIHZpc2liaWxpdHkgb2YgdGhlIHNwZWNpZmllZCBkcm9wZG93blxuICAgKiBkaWFsb2cgYWNjb3JkaW5nIHRvIHRoZSBwb3NpdGlvbiBvZiBpdHMgaWNvbiBidXR0b24uXG4gICAqL1xuICBzaG93RHJvcGRvd24gKGljb246IEhUTUxFbGVtZW50LCBkaWFsb2c6IEhUTUxFbGVtZW50KSB7XG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLm5vdGVCb3gsIHRoaXMucGFnZS5wcm9maWxlQm94KVxuICAgIERvYy5zaG93KGRpYWxvZylcbiAgICBpZiAod2luZG93LmlubmVyV2lkdGggPCA1MDApIE9iamVjdC5hc3NpZ24oZGlhbG9nLnN0eWxlLCB7IGxlZnQ6ICcwJywgcmlnaHQ6ICcwJywgdG9wOiAnMCcgfSlcbiAgICBlbHNlIHtcbiAgICAgIGNvbnN0IGljbyA9IGljb24uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIGNvbnN0IHJpZ2h0ID0gYCR7d2luZG93LmlubmVyV2lkdGggLSBpY28ubGVmdCAtIGljby53aWR0aCArIDV9cHhgXG4gICAgICBPYmplY3QuYXNzaWduKGRpYWxvZy5zdHlsZSwgeyBsZWZ0OiAnYXV0bycsIHJpZ2h0LCB0b3A6IGAke2ljby50b3AgLSA0fXB4YCB9KVxuICAgIH1cblxuICAgIGNvbnN0IGhpZGUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKCFEb2MubW91c2VJbkVsZW1lbnQoZSwgZGlhbG9nKSkge1xuICAgICAgICBEb2MuaGlkZShkaWFsb2cpXG4gICAgICAgIHVuYmluZChkb2N1bWVudCwgJ2NsaWNrJywgaGlkZSlcbiAgICAgICAgaWYgKGRpYWxvZyA9PT0gdGhpcy5wYWdlLm5vdGVCb3ggJiYgRG9jLmlzRGlzcGxheWVkKHRoaXMucGFnZS5ub3RlTGlzdCkpIHtcbiAgICAgICAgICB0aGlzLmFja05vdGVzKClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBiaW5kKGRvY3VtZW50LCAnY2xpY2snLCBoaWRlKVxuICB9XG5cbiAgYWNrTm90ZXMgKCkge1xuICAgIGNvbnN0IGFja3MgPSBbXVxuICAgIGZvciAoY29uc3Qgbm90ZSBvZiB0aGlzLm5vdGVzKSB7XG4gICAgICBpZiAobm90ZS5hY2tlZCkge1xuICAgICAgICBub3RlLmVsLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpcnN0dmlldycpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub3RlLmFja2VkID0gdHJ1ZVxuICAgICAgICBpZiAobm90ZS5pZCAmJiBub3RlLnNldmVyaXR5ID4gbnRmbi5QT0tFKSBhY2tzLnB1c2gobm90ZS5pZClcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGFja3MubGVuZ3RoKSB3cy5yZXF1ZXN0KCdhY2tub3RlcycsIGFja3MpXG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLm5vdGVJbmRpY2F0b3IpXG4gIH1cblxuICBzZXROb3RlVGltZXMgKG5vdGVMaXN0OiBIVE1MRWxlbWVudCkge1xuICAgIGZvciAoY29uc3QgZWwgb2YgKEFycmF5LmZyb20obm90ZUxpc3QuY2hpbGRyZW4pIGFzIE5vdGVFbGVtZW50W10pKSB7XG4gICAgICBEb2Muc2FmZVNlbGVjdG9yKGVsLCAnc3Bhbi5ub3RlLXRpbWUnKS50ZXh0Q29udGVudCA9IERvYy50aW1lU2luY2UoZWwubm90ZS5zdGFtcClcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBiaW5kSW50ZXJuYWxOYXZpZ2F0aW9uIGhpamFja3MgbmF2aWdhdGlvbiBieSBjbGljayBvbiBhbnkgbG9jYWwgbGlua3MgdGhhdFxuICAgKiBhcmUgZGVzY2VuZGFudHMgb2YgYW5jZXN0b3IuXG4gICAqL1xuICBiaW5kSW50ZXJuYWxOYXZpZ2F0aW9uIChhbmNlc3RvcjogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCBwYWdlVVJMID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZilcbiAgICBhbmNlc3Rvci5xdWVyeVNlbGVjdG9yQWxsKCdhJykuZm9yRWFjaChhID0+IHtcbiAgICAgIGlmICghYS5ocmVmKSByZXR1cm5cbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYS5ocmVmKVxuICAgICAgaWYgKHVybC5vcmlnaW4gPT09IHBhZ2VVUkwub3JpZ2luKSB7XG4gICAgICAgIGNvbnN0IHRva2VuID0gdXJsLnBhdGhuYW1lLnN1YnN0cmluZygxKVxuICAgICAgICBjb25zdCBwYXJhbXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fVxuICAgICAgICBpZiAodXJsLnNlYXJjaCkge1xuICAgICAgICAgIHVybC5zZWFyY2hQYXJhbXMuZm9yRWFjaCgodiwgaykgPT4ge1xuICAgICAgICAgICAgcGFyYW1zW2tdID0gdlxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgRG9jLmJpbmQoYSwgJ2NsaWNrJywgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgdGhpcy5sb2FkUGFnZSh0b2tlbiwgcGFyYW1zKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKlxuICAgKiB1cGRhdGVNZW51SXRlbXNEaXNwbGF5IHNob3VsZCBiZSBjYWxsZWQgd2hlbiB0aGUgdXNlciBoYXMgc2lnbmVkIGluIG9yIG91dCxcbiAgICogYW5kIHdoZW4gdGhlIHVzZXIgcmVnaXN0ZXJzIGEgREVYLlxuICAgKi9cbiAgdXBkYXRlTWVudUl0ZW1zRGlzcGxheSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBhdXRoZWQsIG1tU3RhdHVzIH0gPSB0aGlzXG4gICAgaWYgKCFwYWdlKSB7XG4gICAgICAvLyBpbml0aWFsIHBhZ2UgbG9hZCwgaGVhZGVyIGVsZW1lbnRzIG5vdCB5ZXQgYXR0YWNoZWQgYnV0IG1lbnUgaXRlbXNcbiAgICAgIC8vIHdvdWxkIGFscmVhZHkgYmUgaGlkZGVuL2Rpc3BsYXllZCBhcyBhcHByb3ByaWF0ZS5cbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoIWF1dGhlZCkge1xuICAgICAgcGFnZS5wcm9maWxlQm94LmNsYXNzTGlzdC5yZW1vdmUoJ2F1dGhlZCcpXG4gICAgICBEb2MuaGlkZShwYWdlLm5vdGVCZWxsLCBwYWdlLndhbGxldHNNZW51RW50cnksIHBhZ2UubWFya2V0c01lbnVFbnRyeSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2Muc2V0VmlzKE9iamVjdC5rZXlzKHRoaXMuZXhjaGFuZ2VzKS5sZW5ndGggPiAwLCBwYWdlLm1hcmtldHNNZW51RW50cnksIHBhZ2UubW1MaW5rKVxuXG4gICAgcGFnZS5wcm9maWxlQm94LmNsYXNzTGlzdC5hZGQoJ2F1dGhlZCcpXG4gICAgRG9jLnNob3cocGFnZS5ub3RlQmVsbCwgcGFnZS53YWxsZXRzTWVudUVudHJ5LCBwYWdlLm1hcmtldHNNZW51RW50cnkpXG4gICAgRG9jLnNldFZpcyhtbVN0YXR1cywgcGFnZS5tbUxpbmspXG4gIH1cblxuICBhc3luYyBmZXRjaE5vdGVzICgpIHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRKU09OKCcvYXBpL25vdGVzJylcbiAgICBpZiAoIXRoaXMuY2hlY2tSZXNwb25zZShyZXMpKSByZXR1cm4gY29uc29sZS5lcnJvcignZmFpbGVkIHRvIGZldGNoIG5vdGVzOicsIHJlcz8ubXNnIHx8IFN0cmluZyhyZXMpKVxuICAgIHJlcy5ub3Rlcy5yZXZlcnNlKClcbiAgICB0aGlzLnNldE5vdGVzKHJlcy5ub3RlcylcbiAgICB0aGlzLnNldFBva2VzKHJlcy5wb2tlcylcbiAgICB0aGlzLnNldFJlcXVpcmVkQWN0aW9ucygpXG4gIH1cblxuICAvKiBhdHRhY2hDb21tb24gc2NhbnMgdGhlIHByb3ZpZGVkIG5vZGUgYW5kIGhhbmRsZXMgc29tZSBjb21tb24gYmluZGluZ3MuICovXG4gIGF0dGFjaENvbW1vbiAobm9kZTogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmJpbmRJbnRlcm5hbE5hdmlnYXRpb24obm9kZSlcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZUJvbmRDb25mcyB1cGRhdGVzIHRoZSBpbmZvcm1hdGlvbiBmb3IgYSBwZW5kaW5nIGJvbmQuXG4gICAqL1xuICB1cGRhdGVCb25kQ29uZnMgKGRleEFkZHI6IHN0cmluZywgY29pbklEOiBzdHJpbmcsIGNvbmZzOiBudW1iZXIpIHtcbiAgICBjb25zdCBkZXggPSB0aGlzLmV4Y2hhbmdlc1tkZXhBZGRyXVxuICAgIGZvciAoY29uc3QgYm9uZCBvZiBkZXguYXV0aC5wZW5kaW5nQm9uZHMpIGlmIChib25kLmNvaW5JRCA9PT0gY29pbklEKSBib25kLmNvbmZzID0gY29uZnNcbiAgfVxuXG4gIHVwZGF0ZVRpZXIgKGhvc3Q6IHN0cmluZywgYm9uZGVkVGllcjogbnVtYmVyKSB7XG4gICAgdGhpcy5leGNoYW5nZXNbaG9zdF0uYXV0aC5yZXAuYm9uZGVkVGllciA9IGJvbmRlZFRpZXJcbiAgfVxuXG4gIC8qXG4gICAqIGhhbmRsZUJvbmROb3RlIGlzIHRoZSBoYW5kbGVyIGZvciB0aGUgJ2JvbmRwb3N0Jy10eXBlIG5vdGlmaWNhdGlvbiwgd2hpY2hcbiAgICogaXMgdXNlZCB0byB1cGRhdGUgdGhlIGRleCB0aWVyIGFuZCByZWdpc3RyYXRpb24gc3RhdHVzLlxuICAgKi9cbiAgaGFuZGxlQm9uZE5vdGUgKG5vdGU6IEJvbmROb3RlKSB7XG4gICAgaWYgKG5vdGUuYXV0aCkgdGhpcy5leGNoYW5nZXNbbm90ZS5kZXhdLmF1dGggPSBub3RlLmF1dGhcbiAgICBzd2l0Y2ggKG5vdGUudG9waWMpIHtcbiAgICAgIGNhc2UgJ1JlZ1VwZGF0ZSc6XG4gICAgICAgIGlmIChub3RlLmNvaW5JRCAhPT0gbnVsbCkgeyAvLyBzaG91bGQgbmV2ZXIgYmUgbnVsbCBmb3IgUmVnVXBkYXRlXG4gICAgICAgICAgdGhpcy51cGRhdGVCb25kQ29uZnMobm90ZS5kZXgsIG5vdGUuY29pbklELCBub3RlLmNvbmZpcm1hdGlvbnMpXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ0JvbmRDb25maXJtZWQnOlxuICAgICAgICBpZiAobm90ZS50aWVyICE9PSBudWxsKSB7IC8vIHNob3VsZCBuZXZlciBiZSBudWxsIGZvciBCb25kQ29uZmlybWVkXG4gICAgICAgICAgdGhpcy51cGRhdGVUaWVyKG5vdGUuZGV4LCBub3RlLnRpZXIpXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlVHJhbnNhY3Rpb24gZWl0aGVyIGFkZHMgYSBuZXcgdHJhbnNhY3Rpb24gdG8gdGhlIHRyYW5zYWN0aW9uIGhpc3RvcnlcbiAgICogb3IgdXBkYXRlcyBhbiBleGlzdGluZyB0cmFuc2FjdGlvbi5cbiAgICovXG4gIGhhbmRsZVRyYW5zYWN0aW9uTm90ZSAoYXNzZXRJRDogbnVtYmVyLCBub3RlOiBUcmFuc2FjdGlvbk5vdGUpIHtcbiAgICBjb25zdCB0eEhpc3RvcnkgPSB0aGlzLnR4SGlzdG9yeU1hcFthc3NldElEXVxuICAgIGlmICghdHhIaXN0b3J5KSByZXR1cm5cblxuICAgIGlmIChub3RlLm5ldykge1xuICAgICAgdHhIaXN0b3J5LnR4cy51bnNoaWZ0KG5vdGUudHJhbnNhY3Rpb24pXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHR4SGlzdG9yeS50eHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0eEhpc3RvcnkudHhzW2ldLmlkID09PSBub3RlLnRyYW5zYWN0aW9uLmlkKSB7XG4gICAgICAgIHR4SGlzdG9yeS50eHNbaV0gPSBub3RlLnRyYW5zYWN0aW9uXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlVHhIaXN0b3J5U3luY2VkTm90ZSAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgZGVsZXRlIHRoaXMudHhIaXN0b3J5TWFwW2Fzc2V0SURdXG4gIH1cblxuICBsb2dnZWRJbiAobm90ZXM6IENvcmVOb3RlW10sIHBva2VzOiBDb3JlTm90ZVtdKSB7XG4gICAgdGhpcy5zZXROb3Rlcyhub3RlcylcbiAgICB0aGlzLnNldFBva2VzKHBva2VzKVxuICAgIHRoaXMuc2V0UmVxdWlyZWRBY3Rpb25zKClcbiAgfVxuXG4gIC8qXG4gICAqIHNldE5vdGVzIHNldHMgdGhlIGN1cnJlbnQgbm90aWZpY2F0aW9uIGNhY2hlIGFuZCBwb3B1bGF0ZXMgdGhlIG5vdGlmaWNhdGlvblxuICAgKiBkaXNwbGF5LlxuICAgKi9cbiAgc2V0Tm90ZXMgKG5vdGVzOiBDb3JlTm90ZVtdKSB7XG4gICAgdGhpcy5sb2coJ25vdGVzJywgJ3NldE5vdGVzJywgbm90ZXMpXG4gICAgdGhpcy5ub3RlcyA9IFtdXG4gICAgRG9jLmVtcHR5KHRoaXMucGFnZS5ub3RlTGlzdClcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLnByZXBlbmROb3RlRWxlbWVudChub3Rlc1tpXSlcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBzZXRQb2tlcyBzZXRzIHRoZSBjdXJyZW50IHBva2UgY2FjaGUgYW5kIHBvcHVsYXRlcyB0aGUgcG9rZXMgZGlzcGxheS5cbiAgICovXG4gIHNldFBva2VzIChwb2tlczogQ29yZU5vdGVbXSkge1xuICAgIHRoaXMubG9nKCdwb2tlcycsICdzZXRQb2tlcycsIHBva2VzKVxuICAgIHRoaXMucG9rZXMgPSBbXVxuICAgIERvYy5lbXB0eSh0aGlzLnBhZ2UucG9rZUxpc3QpXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2tlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5wcmVwZW5kUG9rZUVsZW1lbnQocG9rZXNbaV0pXG4gICAgfVxuICB9XG5cbiAgYm90U3RhdHVzIChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpOiBNTUJvdFN0YXR1cyB8IHVuZGVmaW5lZCB7XG4gICAgZm9yIChjb25zdCBib3Qgb2YgKHRoaXMubW1TdGF0dXM/LmJvdHMgPz8gW10pKSB7XG4gICAgICBjb25zdCB7IGNvbmZpZzogYyB9ID0gYm90XG4gICAgICBpZiAoaG9zdCA9PT0gYy5ob3N0ICYmIGJhc2VJRCA9PT0gYy5iYXNlSUQgJiYgcXVvdGVJRCA9PT0gYy5xdW90ZUlEKSB7XG4gICAgICAgIHJldHVybiBib3RcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB1cGRhdGVVc2VyIChub3RlOiBDb3JlTm90ZSkge1xuICAgIGNvbnN0IHsgdXNlciwgYXNzZXRzLCB3YWxsZXRNYXAgfSA9IHRoaXNcbiAgICBpZiAobm90ZS50eXBlID09PSAnZmlhdHJhdGV1cGRhdGUnKSB7XG4gICAgICB0aGlzLmZpYXRSYXRlc01hcCA9IChub3RlIGFzIFJhdGVOb3RlKS5maWF0UmF0ZXNcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyBTb21lIG5vdGVzIGNhbiBiZSByZWNlaXZlZCBiZWZvcmUgd2UgZ2V0IGEgVXNlciBkdXJpbmcgbG9naW4uXG4gICAgaWYgKCF1c2VyKSByZXR1cm5cbiAgICBzd2l0Y2ggKG5vdGUudHlwZSkge1xuICAgICAgY2FzZSAnb3JkZXInOiB7XG4gICAgICAgIGNvbnN0IG9yZGVyTm90ZSA9IG5vdGUgYXMgT3JkZXJOb3RlXG4gICAgICAgIGNvbnN0IG9yZGVyID0gb3JkZXJOb3RlLm9yZGVyXG4gICAgICAgIGNvbnN0IG1rdCA9IHVzZXIuZXhjaGFuZ2VzW29yZGVyLmhvc3RdLm1hcmtldHNbb3JkZXIubWFya2V0XVxuICAgICAgICBjb25zdCB0ZW1wSUQgPSBvcmRlck5vdGUudGVtcElEXG5cbiAgICAgICAgLy8gRW5zdXJlIG1hcmtldCdzIGluZmxpZ2h0IG9yZGVycyBsaXN0IGlzIHVwZGF0ZWQuXG4gICAgICAgIGlmIChub3RlLnRvcGljID09PSAnQXN5bmNPcmRlclN1Ym1pdHRlZCcpIHtcbiAgICAgICAgICBjb25zdCBpbkZsaWdodCA9IG9yZGVyIGFzIEluRmxpZ2h0T3JkZXJcbiAgICAgICAgICBpbkZsaWdodC50ZW1wSUQgPSB0ZW1wSURcbiAgICAgICAgICBpZiAoIW1rdC5pbmZsaWdodCkgbWt0LmluZmxpZ2h0ID0gW2luRmxpZ2h0XVxuICAgICAgICAgIGVsc2UgbWt0LmluZmxpZ2h0LnB1c2goaW5GbGlnaHQpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfSBlbHNlIGlmIChub3RlLnRvcGljID09PSAnQXN5bmNPcmRlckZhaWx1cmUnKSB7XG4gICAgICAgICAgbWt0LmluZmxpZ2h0ID0gbWt0LmluZmxpZ2h0LmZpbHRlcihvcmQgPT4gb3JkLnRlbXBJRCAhPT0gdGVtcElEKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yIChjb25zdCBpIGluIG1rdC5pbmZsaWdodCB8fCBbXSkge1xuICAgICAgICAgICAgaWYgKCEobWt0LmluZmxpZ2h0W2ldLnRlbXBJRCA9PT0gdGVtcElEKSkgY29udGludWVcbiAgICAgICAgICAgIG1rdC5pbmZsaWdodCA9IG1rdC5pbmZsaWdodC5maWx0ZXIob3JkID0+IG9yZC50ZW1wSUQgIT09IHRlbXBJRClcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlcyBnaXZlbiBvcmRlciBpbiBtYXJrZXQncyBvcmRlcnMgbGlzdCBpZiBpdCBmaW5kcyBpdC5cbiAgICAgICAgLy8gUmV0dXJucyBhIGJvb2wgd2hpY2ggaW5kaWNhdGVzIGlmIG9yZGVyIHdhcyBmb3VuZC5cbiAgICAgICAgbWt0Lm9yZGVycyA9IG1rdC5vcmRlcnMgfHwgW11cbiAgICAgICAgY29uc3QgdXBkYXRlT3JkZXIgPSAobWt0OiBNYXJrZXQsIG9yZDogT3JkZXIpID0+IHtcbiAgICAgICAgICBjb25zdCBpID0gbWt0Lm9yZGVycy5maW5kSW5kZXgoKG86IE9yZGVyKSA9PiBvLmlkID09PSBvcmQuaWQpXG4gICAgICAgICAgaWYgKGkgPT09IC0xKSByZXR1cm4gZmFsc2VcbiAgICAgICAgICBpZiAobm90ZS50b3BpYyA9PT0gJ09yZGVyUmV0aXJlZCcpIG1rdC5vcmRlcnMuc3BsaWNlKGksIDEpXG4gICAgICAgICAgZWxzZSBta3Qub3JkZXJzW2ldID0gb3JkXG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB0aGUgbm90aWZpY2F0aW9uIG9yZGVyIGFscmVhZHkgZXhpc3RzIHdlIHVwZGF0ZSBpdC5cbiAgICAgICAgLy8gSW4gY2FzZSBtYXJrZXQncyBvcmRlcnMgbGlzdCBpcyBlbXB0eSBvciB0aGUgbm90aWZpY2F0aW9uIG9yZGVyIGlzbid0XG4gICAgICAgIC8vIHBhcnQgb2YgaXQgd2UgYWRkIGl0IG1hbnVhbGx5IGFzIHRoaXMgbWVhbnMgdGhlIG9yZGVyIHdhc1xuICAgICAgICAvLyBqdXN0IHBsYWNlZC5cbiAgICAgICAgaWYgKCF1cGRhdGVPcmRlcihta3QsIG9yZGVyKSkgbWt0Lm9yZGVycy5wdXNoKG9yZGVyKVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnYmFsYW5jZSc6IHtcbiAgICAgICAgY29uc3QgbjogQmFsYW5jZU5vdGUgPSBub3RlIGFzIEJhbGFuY2VOb3RlXG4gICAgICAgIGNvbnN0IGFzc2V0ID0gdXNlci5hc3NldHNbbi5hc3NldElEXVxuICAgICAgICAvLyBCYWxhbmNlIHVwZGF0ZXMgY2FuIGNvbWUgYmVmb3JlIHRoZSB1c2VyIGlzIGZldGNoZWQgYWZ0ZXIgbG9naW4uXG4gICAgICAgIGlmICghYXNzZXQpIGJyZWFrXG4gICAgICAgIGNvbnN0IHcgPSBhc3NldC53YWxsZXRcbiAgICAgICAgaWYgKHcpIHcuYmFsYW5jZSA9IG4uYmFsYW5jZVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnYm9uZHBvc3QnOlxuICAgICAgICB0aGlzLmhhbmRsZUJvbmROb3RlKG5vdGUgYXMgQm9uZE5vdGUpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdyZXB1dGF0aW9uJzoge1xuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBSZXB1dGF0aW9uTm90ZVxuICAgICAgICB0aGlzLmV4Y2hhbmdlc1tuLmhvc3RdLmF1dGgucmVwID0gbi5yZXBcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3dhbGxldHN0YXRlJzpcbiAgICAgIGNhc2UgJ3dhbGxldGNvbmZpZyc6IHtcbiAgICAgICAgLy8gYXNzZXRzIGNhbiBiZSBudWxsIGlmIGZhaWxlZCB0byBjb25uZWN0IHRvIGRleCBzZXJ2ZXIuXG4gICAgICAgIGlmICghYXNzZXRzKSByZXR1cm5cbiAgICAgICAgY29uc3Qgd2FsbGV0ID0gKG5vdGUgYXMgV2FsbGV0Q29uZmlnTm90ZSk/LndhbGxldFxuICAgICAgICBpZiAoIXdhbGxldCkgcmV0dXJuXG4gICAgICAgIGNvbnN0IGFzc2V0ID0gYXNzZXRzW3dhbGxldC5hc3NldElEXVxuICAgICAgICBhc3NldC53YWxsZXQgPSB3YWxsZXRcbiAgICAgICAgd2FsbGV0TWFwW3dhbGxldC5hc3NldElEXSA9IHdhbGxldFxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnd2FsbGV0c3luYyc6IHtcbiAgICAgICAgY29uc3QgbiA9IG5vdGUgYXMgV2FsbGV0U3luY05vdGVcbiAgICAgICAgY29uc3QgdyA9IHRoaXMud2FsbGV0TWFwW24uYXNzZXRJRF1cbiAgICAgICAgaWYgKHcpIHtcbiAgICAgICAgICB3LnN5bmNTdGF0dXMgPSBuLnN5bmNTdGF0dXNcbiAgICAgICAgICB3LnN5bmNlZCA9IHcuc3luY1N0YXR1cy5zeW5jZWRcbiAgICAgICAgICB3LnN5bmNQcm9ncmVzcyA9IG4uc3luY1Byb2dyZXNzXG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ21hdGNoJzoge1xuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBNYXRjaE5vdGVcbiAgICAgICAgY29uc3Qgb3JkID0gdGhpcy5vcmRlcihuLm9yZGVySUQpXG4gICAgICAgIGlmIChvcmQpIHVwZGF0ZU1hdGNoKG9yZCwgbi5tYXRjaClcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ2Nvbm4nOiB7XG4gICAgICAgIGNvbnN0IG4gPSBub3RlIGFzIENvbm5FdmVudE5vdGVcbiAgICAgICAgY29uc3QgeGMgPSB1c2VyLmV4Y2hhbmdlc1tuLmhvc3RdXG4gICAgICAgIGlmICh4YykgeGMuY29ubmVjdGlvblN0YXR1cyA9IG4uY29ubmVjdGlvblN0YXR1c1xuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgY2FzZSAnc3BvdHMnOiB7XG4gICAgICAgIGNvbnN0IG4gPSBub3RlIGFzIFNwb3RQcmljZU5vdGVcbiAgICAgICAgY29uc3QgeGMgPSB1c2VyLmV4Y2hhbmdlc1tuLmhvc3RdXG4gICAgICAgIC8vIFNwb3RzIGNhbiBjb21lIGJlZm9yZSB0aGUgdXNlciBpcyBmZXRjaGVkIGFmdGVyIGxvZ2luIGFuZCBiZWZvcmUvd2hpbGUgdGhlXG4gICAgICAgIC8vIG1hcmtldHMgcGFnZSByZWxvYWQgd2hlbiBpdCByZWNlaXZlcyBhIGRleCBjb25uIG5vdGUuXG4gICAgICAgIGlmICgheGMgfHwgIXhjLm1hcmtldHMpIGJyZWFrXG4gICAgICAgIGZvciAoY29uc3QgW21rdE5hbWUsIHNwb3RdIG9mIE9iamVjdC5lbnRyaWVzKG4uc3BvdHMpKSB4Yy5tYXJrZXRzW21rdE5hbWVdLnNwb3QgPSBzcG90XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdmaWF0cmF0ZXVwZGF0ZSc6IHtcbiAgICAgICAgdGhpcy5maWF0UmF0ZXNNYXAgPSAobm90ZSBhcyBSYXRlTm90ZSkuZmlhdFJhdGVzXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdhY3Rpb25yZXF1aXJlZCc6IHtcbiAgICAgICAgY29uc3QgbiA9IG5vdGUgYXMgQ29yZUFjdGlvblJlcXVpcmVkTm90ZVxuICAgICAgICB0aGlzLmFkZEFjdGlvbihuLnBheWxvYWQpXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICd3YWxsZXRub3RlJzoge1xuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBXYWxsZXROb3RlXG4gICAgICAgIHN3aXRjaCAobi5wYXlsb2FkLnJvdXRlKSB7XG4gICAgICAgICAgY2FzZSAndHJhbnNhY3Rpb24nOiB7XG4gICAgICAgICAgICBjb25zdCB0eE5vdGUgPSBuLnBheWxvYWQgYXMgVHJhbnNhY3Rpb25Ob3RlXG4gICAgICAgICAgICB0aGlzLmhhbmRsZVRyYW5zYWN0aW9uTm90ZShuLnBheWxvYWQuYXNzZXRJRCwgdHhOb3RlKVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSAnYWN0aW9uUmVxdWlyZWQnOiB7XG4gICAgICAgICAgICBjb25zdCByZXEgPSBuLnBheWxvYWQgYXMgQWN0aW9uUmVxdWlyZWROb3RlXG4gICAgICAgICAgICB0aGlzLmFkZEFjdGlvbihyZXEpXG4gICAgICAgICAgICB0aGlzLmJsaW5rQWN0aW9uKClcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgfVxuICAgICAgICAgIGNhc2UgJ2FjdGlvblJlc29sdmVkJzoge1xuICAgICAgICAgICAgdGhpcy5yZXNvbHZlQWN0aW9uKG4ucGF5bG9hZCBhcyBBY3Rpb25SZXNvbHZlZE5vdGUpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChuLnBheWxvYWQucm91dGUgPT09ICd0cmFuc2FjdGlvbkhpc3RvcnlTeW5jZWQnKSB7XG4gICAgICAgICAgdGhpcy5oYW5kbGVUeEhpc3RvcnlTeW5jZWROb3RlKG4ucGF5bG9hZC5hc3NldElEKVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdydW5zdGF0cyc6IHtcbiAgICAgICAgdGhpcy5sb2coJ21tJywgeyBydW5zdGF0czogbm90ZSB9KVxuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBSdW5TdGF0c05vdGVcbiAgICAgICAgY29uc3QgYm90ID0gdGhpcy5ib3RTdGF0dXMobi5ob3N0LCBuLmJhc2VJRCwgbi5xdW90ZUlEKVxuICAgICAgICBpZiAoYm90KSB7XG4gICAgICAgICAgYm90LnJ1blN0YXRzID0gbi5zdGF0c1xuICAgICAgICAgIGJvdC5ydW5uaW5nID0gQm9vbGVhbihuLnN0YXRzKVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICdjZXhub3RlJzoge1xuICAgICAgICBjb25zdCBuID0gbm90ZSBhcyBDRVhOb3RpZmljYXRpb25cbiAgICAgICAgc3dpdGNoIChuLnRvcGljKSB7XG4gICAgICAgICAgY2FzZSAnQmFsYW5jZVVwZGF0ZSc6IHtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBuLm5vdGUgYXMgQ0VYQmFsYW5jZVVwZGF0ZVxuICAgICAgICAgICAgdGhpcy5tbVN0YXR1cy5jZXhlc1tuLmNleE5hbWVdLmJhbGFuY2VzW3UuYXNzZXRJRF0gPSB1LmJhbGFuY2VcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBub3RpZnkgaXMgdGhlIHRvcC1sZXZlbCBoYW5kbGVyIGZvciBub3RpZmljYXRpb25zIHJlY2VpdmVkIGZyb20gdGhlIGNsaWVudC5cbiAgICogTm90aWZpY2F0aW9ucyBhcmUgcHJvcGFnYXRlZCB0byB0aGUgbG9hZGVkUGFnZS5cbiAgICovXG4gIG5vdGlmeSAobm90ZTogQ29yZU5vdGUpIHtcbiAgICAvLyBIYW5kbGUgdHlwZS1zcGVjaWZpYyB1cGRhdGVzLlxuICAgIHRoaXMubG9nKCdub3RlcycsICdub3RpZnknLCBub3RlKVxuICAgIHRoaXMudXBkYXRlVXNlcihub3RlKVxuICAgIC8vIEluZm9ybSB0aGUgcGFnZS5cbiAgICBmb3IgKGNvbnN0IGZlZWRlciBvZiB0aGlzLm5vdGVSZWNlaXZlcnMpIHtcbiAgICAgIGNvbnN0IGYgPSBmZWVkZXJbbm90ZS50eXBlXVxuICAgICAgaWYgKCFmKSBjb250aW51ZVxuICAgICAgdHJ5IHtcbiAgICAgICAgZihub3RlKVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignbm90ZSBmZWVkZXIgZXJyb3I6JywgZXJyb3IubWVzc2FnZSA/IGVycm9yLm1lc3NhZ2UgOiBlcnJvcilcbiAgICAgICAgY29uc29sZS5sb2cobm90ZSlcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3Iuc3RhY2spXG4gICAgICB9XG4gICAgfVxuICAgIC8vIERpc2NhcmQgZGF0YSBub3RpZmljYXRpb25zLlxuICAgIGlmIChub3RlLnNldmVyaXR5IDwgbnRmbi5QT0tFKSByZXR1cm5cbiAgICAvLyBQb2tlIG5vdGlmaWNhdGlvbnMgaGF2ZSB0aGVpciBvd24gZGlzcGxheS5cbiAgICBjb25zdCB7IHBvcHVwVG1wbCwgcG9wdXBOb3Rlcywgc2hvd1BvcHVwcyB9ID0gdGhpc1xuICAgIGlmIChzaG93UG9wdXBzKSB7XG4gICAgICBjb25zdCBzcGFuID0gcG9wdXBUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgRG9jLnRtcGxFbGVtZW50KHNwYW4sICd0ZXh0JykudGV4dENvbnRlbnQgPSBgJHtub3RlLnN1YmplY3R9OiAke250Zm4ucGxhaW5Ob3RlKG5vdGUuZGV0YWlscyl9YFxuICAgICAgY29uc3QgaW5kaWNhdG9yID0gRG9jLnRtcGxFbGVtZW50KHNwYW4sICdpbmRpY2F0b3InKVxuICAgICAgaWYgKG5vdGUuc2V2ZXJpdHkgPT09IG50Zm4uUE9LRSkge1xuICAgICAgICBEb2MuaGlkZShpbmRpY2F0b3IpXG4gICAgICB9IGVsc2Ugc2V0U2V2ZXJpdHlDbGFzcyhpbmRpY2F0b3IsIG5vdGUuc2V2ZXJpdHkpXG4gICAgICBwb3B1cE5vdGVzLmFwcGVuZENoaWxkKHNwYW4pXG4gICAgICBEb2Muc2hvdyhwb3B1cE5vdGVzKVxuICAgICAgLy8gVGhlc2UgdGFrZSB1cCBzY3JlZW4gc3BhY2UuIE9ubHkgc2hvdyBtYXggNSBhdCBhIHRpbWUuXG4gICAgICB3aGlsZSAocG9wdXBOb3Rlcy5jaGlsZHJlbi5sZW5ndGggPiA1KSBwb3B1cE5vdGVzLnJlbW92ZUNoaWxkKHBvcHVwTm90ZXMuZmlyc3RDaGlsZCBhcyBOb2RlKVxuICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICAgIGF3YWl0IERvYy5hbmltYXRlKDUwMCwgKHByb2dyZXNzOiBudW1iZXIpID0+IHtcbiAgICAgICAgICBzcGFuLnN0eWxlLm9wYWNpdHkgPSBTdHJpbmcoMSAtIHByb2dyZXNzKVxuICAgICAgICB9KVxuICAgICAgICBzcGFuLnJlbW92ZSgpXG4gICAgICAgIGlmIChwb3B1cE5vdGVzLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgRG9jLmhpZGUocG9wdXBOb3RlcylcbiAgICAgIH0sIDYwMDApXG4gICAgfVxuICAgIC8vIFN1Y2Nlc3MgYW5kIGhpZ2hlciBzZXZlcml0eSBnbyB0byB0aGUgYmVsbCBkcm9wZG93bi5cbiAgICBpZiAobm90ZS5zZXZlcml0eSA9PT0gbnRmbi5QT0tFKSB0aGlzLnByZXBlbmRQb2tlRWxlbWVudChub3RlKVxuICAgIGVsc2UgdGhpcy5wcmVwZW5kTm90ZUVsZW1lbnQobm90ZSlcblxuICAgIC8vIHNob3cgZGVza3RvcCBub3RpZmljYXRpb25cbiAgICBudGZuLmRlc2t0b3BOb3RpZnkobm90ZSlcbiAgfVxuXG4gIC8qXG4gICAqIHJlZ2lzdGVyTm90ZUZlZWRlciByZWdpc3RlcnMgYSBmZWVkZXIgZm9yIGNvcmUgbm90aWZpY2F0aW9ucy4gVGhlIGZlZWRlclxuICAgKiB3aWxsIGJlIGRlLXJlZ2lzdGVyZWQgd2hlbiBhIG5ldyBwYWdlIGlzIGxvYWRlZC5cbiAgICovXG4gIHJlZ2lzdGVyTm90ZUZlZWRlciAocmVjZWl2ZXJzOiBSZWNvcmQ8c3RyaW5nLCAobjogQ29yZU5vdGUpID0+IHZvaWQ+KSB7XG4gICAgdGhpcy5ub3RlUmVjZWl2ZXJzLnB1c2gocmVjZWl2ZXJzKVxuICB9XG5cbiAgLypcbiAgICogbG9nIHByaW50cyB0byB0aGUgY29uc29sZSBpZiBhIGxvZ2dlciBoYXMgYmVlbiBlbmFibGVkLiBMb2dnZXJzIGFyZSBjcmVhdGVkXG4gICAqIGltcGxpY2l0bHkgYnkgcGFzc2luZyBhIGxvZ2dlcklEIHRvIGxvZy4gaS5lLiB5b3UgZG9uJ3QgY3JlYXRlIGEgbG9nZ2VyLFxuICAgKiB5b3UganVzdCBsb2cgdG8gaXQuIExvZ2dlcnMgYXJlIGVuYWJsZWQgYnkgaW52b2tpbmcgYSBnbG9iYWwgZnVuY3Rpb24sXG4gICAqIGVuYWJsZUxvZ2dlcihsb2dnZXJJRCwgb25PZmZCb29sZWFuKSwgZnJvbSB0aGUgYnJvd3NlcidzIGpzIGNvbnNvbGUuIFlvdXJcbiAgICogY2hvaWNlcyBhcmUgc3RvcmVkIGFjcm9zcyBzZXNzaW9ucy4gU29tZSBjb21tb24gYW5kIHVzZWZ1bCBsb2dnZXJzIGFyZVxuICAgKiBsaXN0ZWQgYmVsb3csIGJ1dCB0aGlzIGxpc3QgaXMgbm90IG1lYW50IHRvIGJlIGNvbXByZWhlbnNpdmUuXG4gICAqXG4gICAqIExvZ2dlcklEICAgRGVzY3JpcHRpb25cbiAgICogLS0tLS0tLS0gICAtLS0tLS0tLS0tLVxuICAgKiBub3RlcyAgICAgIE5vdGlmaWNhdGlvbnMgb2YgYWxsIGxldmVscy5cbiAgICogYm9vayAgICAgICBPcmRlciBib29rIGZlZWQuXG4gICAqIHdzLi4uLi4uLi4uV2Vic29ja2V0IGNvbm5lY3Rpb24gc3RhdHVzIGNoYW5nZXMuXG4gICAqL1xuICBsb2cgKGxvZ2dlcklEOiBzdHJpbmcsIC4uLm1zZzogYW55KSB7XG4gICAgaWYgKHRoaXMubG9nZ2Vyc1tsb2dnZXJJRF0pIGNvbnNvbGUubG9nKGAke25vd1N0cmluZygpfVske2xvZ2dlcklEfV06YCwgLi4ubXNnKVxuICAgIGlmICh0aGlzLnJlY29yZGVyc1tsb2dnZXJJRF0pIHtcbiAgICAgIHRoaXMucmVjb3JkZXJzW2xvZ2dlcklEXS5wdXNoKHtcbiAgICAgICAgdGltZTogbm93U3RyaW5nKCksXG4gICAgICAgIG1zZzogbXNnXG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIHByZXBlbmRQb2tlRWxlbWVudCAoY246IENvcmVOb3RlKSB7XG4gICAgY29uc3QgW2VsLCBub3RlXSA9IHRoaXMubWFrZVBva2UoY24pXG4gICAgdGhpcy5wb2tlcy5wdXNoKG5vdGUpXG4gICAgd2hpbGUgKHRoaXMucG9rZXMubGVuZ3RoID4gbm90ZUNhY2hlU2l6ZSkgdGhpcy5wb2tlcy5zaGlmdCgpXG4gICAgdGhpcy5wcmVwZW5kTGlzdEVsZW1lbnQodGhpcy5wYWdlLnBva2VMaXN0LCBub3RlLCBlbClcbiAgfVxuXG4gIHByZXBlbmROb3RlRWxlbWVudCAoY246IENvcmVOb3RlKSB7XG4gICAgY29uc3QgW2VsLCBub3RlXSA9IHRoaXMubWFrZU5vdGUoY24pXG4gICAgdGhpcy5ub3Rlcy5wdXNoKG5vdGUpXG4gICAgd2hpbGUgKHRoaXMubm90ZXMubGVuZ3RoID4gbm90ZUNhY2hlU2l6ZSkgdGhpcy5ub3Rlcy5zaGlmdCgpXG4gICAgY29uc3Qgbm90ZUxpc3QgPSB0aGlzLnBhZ2Uubm90ZUxpc3RcbiAgICB0aGlzLnByZXBlbmRMaXN0RWxlbWVudChub3RlTGlzdCwgbm90ZSwgZWwpXG4gICAgdGhpcy5iaW5kVXJsSGFuZGxlcnMoZWwpXG4gICAgLy8gU2V0IHRoZSBpbmRpY2F0b3IgY29sb3IuXG4gICAgaWYgKHRoaXMubm90ZXMubGVuZ3RoID09PSAwIHx8IChEb2MuaXNEaXNwbGF5ZWQodGhpcy5wYWdlLm5vdGVCb3gpICYmIERvYy5pc0Rpc3BsYXllZChub3RlTGlzdCkpKSByZXR1cm5cbiAgICBsZXQgdW5hY2tlZCA9IDBcbiAgICBjb25zdCBzZXZlcml0eSA9IHRoaXMubm90ZXMucmVkdWNlKChzLCBub3RlKSA9PiB7XG4gICAgICBpZiAoIW5vdGUuYWNrZWQpIHVuYWNrZWQrK1xuICAgICAgaWYgKCFub3RlLmFja2VkICYmIG5vdGUuc2V2ZXJpdHkgPiBzKSByZXR1cm4gbm90ZS5zZXZlcml0eVxuICAgICAgcmV0dXJuIHNcbiAgICB9LCBudGZuLklHTk9SRSlcbiAgICBjb25zdCBuaSA9IHRoaXMucGFnZS5ub3RlSW5kaWNhdG9yXG4gICAgc2V0U2V2ZXJpdHlDbGFzcyhuaSwgc2V2ZXJpdHkpXG4gICAgaWYgKHVuYWNrZWQpIHtcbiAgICAgIG5pLnRleHRDb250ZW50ID0gU3RyaW5nKCh1bmFja2VkID4gbm90ZUNhY2hlU2l6ZSAtIDEpID8gYCR7bm90ZUNhY2hlU2l6ZSAtIDF9K2AgOiB1bmFja2VkKVxuICAgICAgRG9jLnNob3cobmkpXG4gICAgfSBlbHNlIERvYy5oaWRlKG5pKVxuICB9XG5cbiAgcHJlcGVuZExpc3RFbGVtZW50IChub3RlTGlzdDogSFRNTEVsZW1lbnQsIG5vdGU6IENvcmVOb3RlUGx1cywgZWw6IE5vdGVFbGVtZW50KSB7XG4gICAgZWwubm90ZSA9IG5vdGVcbiAgICBub3RlTGlzdC5wcmVwZW5kKGVsKVxuICAgIHdoaWxlIChub3RlTGlzdC5jaGlsZHJlbi5sZW5ndGggPiBub3RlQ2FjaGVTaXplKSBub3RlTGlzdC5yZW1vdmVDaGlsZChub3RlTGlzdC5sYXN0Q2hpbGQgYXMgTm9kZSlcbiAgICB0aGlzLnNldE5vdGVUaW1lcyhub3RlTGlzdClcbiAgfVxuXG4gIC8qXG4gICAqIG1ha2VOb3RlIGNvbnN0cnVjdHMgYSBzaW5nbGUgbm90aWZpY2F0aW9uIGVsZW1lbnQgZm9yIHRoZSBkcm9wLWRvd25cbiAgICogbm90aWZpY2F0aW9uIGxpc3QuXG4gICAqL1xuICBtYWtlTm90ZSAobm90ZTogQ29yZU5vdGUpOiBbTm90ZUVsZW1lbnQsIENvcmVOb3RlUGx1c10ge1xuICAgIGNvbnN0IGVsID0gdGhpcy5wYWdlLm5vdGVUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBOb3RlRWxlbWVudFxuICAgIGlmIChub3RlLnNldmVyaXR5ID4gbnRmbi5QT0tFKSB7XG4gICAgICBjb25zdCBjbHMgPSBub3RlLnNldmVyaXR5ID09PSBudGZuLlNVQ0NFU1MgPyAnZ29vZCcgOiBub3RlLnNldmVyaXR5ID09PSBudGZuLldBUk5JTkcgPyAnd2FybicgOiAnYmFkJ1xuICAgICAgRG9jLnNhZmVTZWxlY3RvcihlbCwgJ2Rpdi5ub3RlLWluZGljYXRvcicpLmNsYXNzTGlzdC5hZGQoY2xzKVxuICAgIH1cblxuICAgIERvYy5zYWZlU2VsZWN0b3IoZWwsICdkaXYubm90ZS1zdWJqZWN0JykudGV4dENvbnRlbnQgPSBub3RlLnN1YmplY3RcbiAgICBudGZuLmluc2VydFJpY2hOb3RlKERvYy5zYWZlU2VsZWN0b3IoZWwsICdkaXYubm90ZS1kZXRhaWxzJyksIG5vdGUuZGV0YWlscylcbiAgICBjb25zdCBucDogQ29yZU5vdGVQbHVzID0geyBlbCwgLi4ubm90ZSB9XG4gICAgcmV0dXJuIFtlbCwgbnBdXG4gIH1cblxuICBtYWtlUG9rZSAobm90ZTogQ29yZU5vdGUpOiBbTm90ZUVsZW1lbnQsIENvcmVOb3RlUGx1c10ge1xuICAgIGNvbnN0IGVsID0gdGhpcy5wYWdlLnBva2VUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBOb3RlRWxlbWVudFxuICAgIERvYy50bXBsRWxlbWVudChlbCwgJ3N1YmplY3QnKS50ZXh0Q29udGVudCA9IGAke25vdGUuc3ViamVjdH06YFxuICAgIG50Zm4uaW5zZXJ0UmljaE5vdGUoRG9jLnRtcGxFbGVtZW50KGVsLCAnZGV0YWlscycpLCBub3RlLmRldGFpbHMpXG4gICAgY29uc3QgbnA6IENvcmVOb3RlUGx1cyA9IHsgZWwsIC4uLm5vdGUgfVxuICAgIHJldHVybiBbZWwsIG5wXVxuICB9XG5cbiAgLypcbiAgICogbG9hZGluZyBhcHBlbmRzIHRoZSBsb2FkZXIgdG8gdGhlIHNwZWNpZmllZCBlbGVtZW50IGFuZCBkaXNwbGF5cyB0aGVcbiAgICogbG9hZGluZyBpY29uLiBUaGUgbG9hZGVyIHdpbGwgYmxvY2sgYWxsIGludGVyYWN0aW9uIHdpdGggdGhlIHNwZWNpZmllZFxuICAgKiBlbGVtZW50IHVudGlsIEFwcGxpY2F0aW9uLmxvYWRlZCBpcyBjYWxsZWQuXG4gICAqL1xuICBsb2FkaW5nIChlbDogSFRNTEVsZW1lbnQpOiAoKSA9PiB2b2lkIHtcbiAgICBjb25zdCBsb2FkZXIgPSB0aGlzLnBhZ2UubG9hZGVyLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgIGVsLmFwcGVuZENoaWxkKGxvYWRlcilcbiAgICByZXR1cm4gKCkgPT4geyBsb2FkZXIucmVtb3ZlKCkgfVxuICB9XG5cbiAgLyogb3JkZXJzIHJldHJpZXZlcyBhIGxpc3Qgb2Ygb3JkZXJzIGZvciB0aGUgc3BlY2lmaWVkIGRleCBhbmQgbWFya2V0XG4gICAqIGluY2x1ZGluZyBpbmZsaWdodCBvcmRlcnMuXG4gICAqL1xuICBvcmRlcnMgKGhvc3Q6IHN0cmluZywgbWt0SUQ6IHN0cmluZyk6IE9yZGVyW10ge1xuICAgIGxldCBvcmRlcnM6IE9yZGVyW10gPSBbXVxuICAgIGNvbnN0IG1rdCA9IHRoaXMudXNlci5leGNoYW5nZXNbaG9zdF0ubWFya2V0c1tta3RJRF1cbiAgICBpZiAobWt0Lm9yZGVycykgb3JkZXJzID0gb3JkZXJzLmNvbmNhdChta3Qub3JkZXJzKVxuICAgIGlmIChta3QuaW5mbGlnaHQpIG9yZGVycyA9IG9yZGVycy5jb25jYXQobWt0LmluZmxpZ2h0KVxuICAgIHJldHVybiBvcmRlcnNcbiAgfVxuXG4gIC8qXG4gICAqIGhhdmVBY3RpdmVPcmRlcnMgcmV0dXJucyB3aGV0aGVyIG9yIG5vdCB0aGVyZSBhcmUgYWN0aXZlIG9yZGVycyBpbnZvbHZpbmcgYVxuICAgKiBjZXJ0YWluIGFzc2V0LlxuICAgKi9cbiAgaGF2ZUFjdGl2ZU9yZGVycyAoYXNzZXRJRDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgZm9yIChjb25zdCB4YyBvZiBPYmplY3QudmFsdWVzKHRoaXMudXNlci5leGNoYW5nZXMpKSB7XG4gICAgICBpZiAoIXhjLm1hcmtldHMpIGNvbnRpbnVlXG4gICAgICBmb3IgKGNvbnN0IG1hcmtldCBvZiBPYmplY3QudmFsdWVzKHhjLm1hcmtldHMpKSB7XG4gICAgICAgIGlmICghbWFya2V0Lm9yZGVycykgY29udGludWVcbiAgICAgICAgZm9yIChjb25zdCBvcmQgb2YgbWFya2V0Lm9yZGVycykge1xuICAgICAgICAgIGlmICgob3JkLmJhc2VJRCA9PT0gYXNzZXRJRCB8fCBvcmQucXVvdGVJRCA9PT0gYXNzZXRJRCkgJiZcbiAgICAgICAgICAgIChvcmQuc3RhdHVzIDwgU3RhdHVzRXhlY3V0ZWQgfHwgaGFzQWN0aXZlTWF0Y2hlcyhvcmQpKSkgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIC8qIG9yZGVyIGF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBvcmRlciBieSBvcmRlciBJRC4gKi9cbiAgb3JkZXIgKG9pZDogc3RyaW5nKTogT3JkZXIgfCBudWxsIHtcbiAgICBmb3IgKGNvbnN0IHhjIG9mIE9iamVjdC52YWx1ZXModGhpcy51c2VyLmV4Y2hhbmdlcykpIHtcbiAgICAgIGlmICgheGMgfHwgIXhjLm1hcmtldHMpIGNvbnRpbnVlXG4gICAgICBmb3IgKGNvbnN0IG1hcmtldCBvZiBPYmplY3QudmFsdWVzKHhjLm1hcmtldHMpKSB7XG4gICAgICAgIGlmICghbWFya2V0Lm9yZGVycykgY29udGludWVcbiAgICAgICAgZm9yIChjb25zdCBvcmQgb2YgbWFya2V0Lm9yZGVycykge1xuICAgICAgICAgIGlmIChvcmQuaWQgPT09IG9pZCkgcmV0dXJuIG9yZFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKlxuICAgKiBjYW5BY2NlbGVyYXRlT3JkZXIgcmV0dXJucyB0cnVlIGlmIHRoZSBcImZyb21cIiB3YWxsZXQgb2YgdGhlIG9yZGVyXG4gICAqIHN1cHBvcnRzIGFjY2VsZXJhdGlvbiwgYW5kIGlmIHRoZSBvcmRlciBoYXMgdW5jb25maXJtZWQgc3dhcFxuICAgKiB0cmFuc2FjdGlvbnMuXG4gICAqL1xuICBjYW5BY2NlbGVyYXRlT3JkZXIgKG9yZGVyOiBPcmRlcik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHdhbGxldFRyYWl0QWNjZWxlcmF0b3IgPSAxIDw8IDRcbiAgICBsZXQgZnJvbUFzc2V0SURcbiAgICBpZiAob3JkZXIuc2VsbCkgZnJvbUFzc2V0SUQgPSBvcmRlci5iYXNlSURcbiAgICBlbHNlIGZyb21Bc3NldElEID0gb3JkZXIucXVvdGVJRFxuICAgIGNvbnN0IHdhbGxldCA9IHRoaXMud2FsbGV0TWFwW2Zyb21Bc3NldElEXVxuICAgIGlmICghd2FsbGV0IHx8ICEod2FsbGV0LnRyYWl0cyAmIHdhbGxldFRyYWl0QWNjZWxlcmF0b3IpKSByZXR1cm4gZmFsc2VcbiAgICBpZiAob3JkZXIubWF0Y2hlcykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcmRlci5tYXRjaGVzPy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBtYXRjaCA9IG9yZGVyLm1hdGNoZXNbaV1cbiAgICAgICAgaWYgKG1hdGNoLnN3YXAgJiYgbWF0Y2guc3dhcC5jb25mcyAmJiBtYXRjaC5zd2FwLmNvbmZzLmNvdW50ID09PSAwICYmICFtYXRjaC5yZXZva2VkKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIC8qXG4gICAqIHVuaXRJbmZvIGZldGNoZXMgdW5pdCBpbmZvIFtkZXguVW5pdEluZm9dIGZvciB0aGUgYXNzZXQuIElmIHhjXG4gICAqIFtjb3JlLkV4Y2hhbmdlXSBpcyBwcm92aWRlZCwgYW5kIHRoaXMgaXMgbm90IGEgU3VwcG9ydGVkQXNzZXQsIHRoZSBVbml0SW5mb1xuICAgKiBzZW50IGZyb20gdGhlIGV4Y2hhbmdlJ3MgYXNzZXRzIG1hcCBbZGV4LkFzc2V0XSB3aWxsIGJlIHVzZWQuXG4gICAqL1xuICB1bml0SW5mbyAoYXNzZXRJRDogbnVtYmVyLCB4Yz86IEV4Y2hhbmdlKTogVW5pdEluZm8ge1xuICAgIGNvbnN0IHN1cHBvcnRlZEFzc2V0ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICBpZiAoc3VwcG9ydGVkQXNzZXQpIHJldHVybiBzdXBwb3J0ZWRBc3NldC51bml0SW5mb1xuICAgIGlmICgheGMgfHwgIXhjLmFzc2V0cykge1xuICAgICAgdGhyb3cgRXJyb3IoaW50bC5wcmVwKGludGwuSURfVU5TVVBQT1JURURfQVNTRVRfSU5GT19FUlJfTVNHLCB7IGFzc2V0SUQ6IGAke2Fzc2V0SUR9YCB9KSlcbiAgICB9XG4gICAgcmV0dXJuIHhjLmFzc2V0c1thc3NldElEXS51bml0SW5mb1xuICB9XG5cbiAgcGFyZW50QXNzZXQgKGFzc2V0SUQ6IG51bWJlcikgOiBTdXBwb3J0ZWRBc3NldCB7XG4gICAgY29uc3QgYXNzZXQgPSB0aGlzLmFzc2V0c1thc3NldElEXVxuICAgIGlmICghYXNzZXQudG9rZW4pIHJldHVybiBhc3NldFxuICAgIHJldHVybiB0aGlzLmFzc2V0c1thc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgfVxuXG4gIC8qXG4gICogYmFzZUNoYWluU3ltYm9sIHJldHVybnMgdGhlIHN5bWJvbCBmb3IgdGhlIGFzc2V0J3MgcGFyZW50IGlmIHRoZSBhc3NldCBpcyBhXG4gICogdG9rZW4sIG90aGVyd2lzZSB0aGUgc3ltYm9sIGZvciB0aGUgYXNzZXQgaXRzZWxmLlxuICAqL1xuICBiYXNlQ2hhaW5TeW1ib2wgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IGFzc2V0ID0gdGhpcy51c2VyLmFzc2V0c1thc3NldElEXVxuICAgIHJldHVybiBhc3NldC50b2tlbiA/IHRoaXMudXNlci5hc3NldHNbYXNzZXQudG9rZW4ucGFyZW50SURdLnN5bWJvbCA6IGFzc2V0LnN5bWJvbFxuICB9XG5cbiAgLypcbiAgICogZXh0ZW5zaW9uV2FsbGV0IHJldHVybnMgdGhlIEV4dGVuc2lvbkNvbmZpZ3VyZWRXYWxsZXQgZm9yIHRoZSBhc3NldCwgaWZcbiAgICogaXQgZXhpc3RzLlxuICAgKi9cbiAgZXh0ZW5zaW9uV2FsbGV0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy51c2VyLmV4dGVuc2lvbk1vZGVDb25maWc/LnJlc3RyaWN0ZWRXYWxsZXRzW3RoaXMuYmFzZUNoYWluU3ltYm9sKGFzc2V0SUQpXVxuICB9XG5cbiAgLyogY29udmVudGlvbmFsUmF0ZSBjb252ZXJ0cyB0aGUgZW5jb2RlZCBhdG9taWMgcmF0ZSB0byBhIGNvbnZlbnRpb25hbCByYXRlICovXG4gIGNvbnZlbnRpb25hbFJhdGUgKGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIsIGVuY1JhdGU6IG51bWJlciwgeGM/OiBFeGNoYW5nZSk6IG51bWJlciB7XG4gICAgY29uc3QgW2IsIHFdID0gW3RoaXMudW5pdEluZm8oYmFzZUlELCB4YyksIHRoaXMudW5pdEluZm8ocXVvdGVJRCwgeGMpXVxuXG4gICAgY29uc3QgciA9IGIuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgLyBxLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgcmV0dXJuIGVuY1JhdGUgKiByIC8gUmF0ZUVuY29kaW5nRmFjdG9yXG4gIH1cblxuICB3YWxsZXREZWZpbml0aW9uIChhc3NldElEOiBudW1iZXIsIHdhbGxldFR5cGU6IHN0cmluZyk6IFdhbGxldERlZmluaXRpb24ge1xuICAgIGNvbnN0IGFzc2V0ID0gdGhpcy5hc3NldHNbYXNzZXRJRF1cbiAgICBpZiAoYXNzZXQudG9rZW4pIHJldHVybiBhc3NldC50b2tlbi5kZWZpbml0aW9uXG4gICAgaWYgKCFhc3NldC5pbmZvKSB0aHJvdyBFcnJvcignd2hlcmVcXCdzIHRoZSB3YWxsZXQgaW5mbz8nKVxuICAgIGlmICh3YWxsZXRUeXBlID09PSAnJykgcmV0dXJuIGFzc2V0LmluZm8uYXZhaWxhYmxld2FsbGV0c1thc3NldC5pbmZvLmVtcHR5aWR4XVxuICAgIHJldHVybiBhc3NldC5pbmZvLmF2YWlsYWJsZXdhbGxldHMuZmlsdGVyKGRlZiA9PiBkZWYudHlwZSA9PT0gd2FsbGV0VHlwZSlbMF1cbiAgfVxuXG4gIGN1cnJlbnRXYWxsZXREZWZpbml0aW9uIChhc3NldElEOiBudW1iZXIpOiBXYWxsZXREZWZpbml0aW9uIHtcbiAgICBjb25zdCBhc3NldCA9IHRoaXMuYXNzZXRzW2Fzc2V0SURdXG4gICAgaWYgKGFzc2V0LnRva2VuKSB7XG4gICAgICByZXR1cm4gYXNzZXQudG9rZW4uZGVmaW5pdGlvblxuICAgIH1cbiAgICByZXR1cm4gdGhpcy53YWxsZXREZWZpbml0aW9uKGFzc2V0SUQsIHRoaXMuYXNzZXRzW2Fzc2V0SURdLndhbGxldC50eXBlKVxuICB9XG5cbiAgLypcbiAgICogZmV0Y2hCYWxhbmNlIHJlcXVlc3RzIGEgYmFsYW5jZSB1cGRhdGUgZnJvbSB0aGUgQVBJLiBUaGUgQVBJIHJlc3BvbnNlIGRvZXNcbiAgICogaW5jbHVkZSB0aGUgYmFsYW5jZSwgYnV0IHdlJ3JlIGlnbm9yaW5nIGl0LCBzaW5jZSBhIGJhbGFuY2UgdXBkYXRlXG4gICAqIG5vdGlmaWNhdGlvbiBpcyByZWNlaXZlZCB2aWEgdGhlIEFwcGxpY2F0aW9uIGFueXdheXMuXG4gICAqL1xuICBhc3luYyBmZXRjaEJhbGFuY2UgKGFzc2V0SUQ6IG51bWJlcik6IFByb21pc2U8V2FsbGV0QmFsYW5jZT4ge1xuICAgIGNvbnN0IHJlczogQmFsYW5jZVJlc3BvbnNlID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvYmFsYW5jZScsIHsgYXNzZXRJRDogYXNzZXRJRCB9KVxuICAgIGlmICghdGhpcy5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgZmFpbGVkIHRvIGZldGNoIGJhbGFuY2UgZm9yIGFzc2V0IElEICR7YXNzZXRJRH1gKVxuICAgIH1cbiAgICByZXR1cm4gcmVzLmJhbGFuY2VcbiAgfVxuXG4gIC8qXG4gICAqIGNoZWNrUmVzcG9uc2UgY2hlY2tzIHRoZSByZXNwb25zZSBvYmplY3QgYXMgcmV0dXJuZWQgZnJvbSB0aGUgZnVuY3Rpb25zIGluXG4gICAqIHRoZSBodHRwIG1vZHVsZS4gSWYgdGhlIHJlc3BvbnNlIGluZGljYXRlcyB0aGF0IHRoZSByZXF1ZXN0IGZhaWxlZCwgaXRcbiAgICogcmV0dXJucyBmYWxzZSwgb3RoZXJ3aXNlLCB0cnVlLlxuICAgKi9cbiAgY2hlY2tSZXNwb25zZSAocmVzcDogQVBJUmVzcG9uc2UpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKHJlc3AucmVxdWVzdFN1Y2Nlc3NmdWwgJiYgcmVzcC5vaylcbiAgfVxuXG4gIC8qKlxuICAgKiBzaWduT3V0IGNhbGwgdG8gL2FwaS9sb2dvdXQsIGlmIHJlc3BvbnNlIHdpdGggbm8gZXJyb3JzIG9jY3VycmVkIHJlbW92ZSBhdXRoXG4gICAqIGFuZCBvdGhlciBwcml2YWN5LWNyaXRpY2FsIGNvb2tpZXMvbG9jYWxzIGFuZCByZWxvYWQgdGhlIHBhZ2UsIG90aGVyd2lzZVxuICAgKiBzaG93IGEgbm90aWZpY2F0aW9uLlxuICAgKi9cbiAgYXN5bmMgc2lnbk91dCAoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvbG9nb3V0JylcbiAgICBpZiAoIXRoaXMuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBpZiAocmVzLmNvZGUgPT09IEVycm9ycy5hY3RpdmVPcmRlcnNFcnIpIHtcbiAgICAgICAgdGhpcy5wYWdlLmxvZ291dEVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FDVElWRV9PUkRFUlNfTE9HT1VUX0VSUl9NU0cpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBhZ2UubG9nb3V0RXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgfVxuICAgICAgRG9jLnNob3codGhpcy5wYWdlLmxvZ291dEVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBTdGF0ZS5yZW1vdmVDb29raWUoU3RhdGUuYXV0aENLKVxuICAgIFN0YXRlLnJlbW92ZUNvb2tpZShTdGF0ZS5wd0tleUNLKVxuICAgIFN0YXRlLnJlbW92ZUxvY2FsKFN0YXRlLm5vdGlmaWNhdGlvbnNMSykgLy8gTm90aWZpY2F0aW9uIHN0b3JhZ2Ugd2FzIERFUFJFQ0FURUQgcHJlLXYxLlxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9sb2dpbidcbiAgfVxuXG4gIC8qXG4gICAqIHR4SGlzdG9yeSBsb2FkcyB0aGUgdHggaGlzdG9yeSBmb3IgYW4gYXNzZXQuIElmIHRoZSByZXN1bHRzIGFyZSBub3RcbiAgICogYWxyZWFkeSBjYWNoZWQsIHRoZXkgYXJlIGNhY2hlZC4gSWYgd2UgaGF2ZSByZWFjaGVkIHRoZSBvbGRlc3QgdHgsXG4gICAqIHRoaXMgZmFjdCBpcyBhbHNvIGNhY2hlZC4gSWYgdGhlIGV4YWN0IGFtb3VudCBvZiB0cmFuc2FjdGlvbnMgYXMgaGF2ZSBiZWVuXG4gICAqIG1hZGUgYXJlIHJlcXVlc3RlZCwgd2Ugd2lsbCBub3Qga25vdyBpZiB3ZSBoYXZlIHJlYWNoZWQgdGhlIGxhc3QgdHggdW50aWxcbiAgICogYSBzdWJzZXF1ZW50IGNhbGwuXG4gICovXG4gIGFzeW5jIHR4SGlzdG9yeSAoYXNzZXRJRDogbnVtYmVyLCBuOiBudW1iZXIsIGFmdGVyPzogc3RyaW5nKTogUHJvbWlzZTxUeEhpc3RvcnlSZXN1bHQ+IHtcbiAgICBjb25zdCB1cmwgPSAnL2FwaS90eGhpc3RvcnknXG4gICAgY29uc3QgY2FjaGVkVHhIaXN0b3J5ID0gdGhpcy50eEhpc3RvcnlNYXBbYXNzZXRJRF1cbiAgICBpZiAoIWNhY2hlZFR4SGlzdG9yeSkge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04odXJsLCB7XG4gICAgICAgIG46IG4sXG4gICAgICAgIGFzc2V0SUQ6IGFzc2V0SURcbiAgICAgIH0pXG4gICAgICBpZiAoIXRoaXMuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihyZXMubXNnKVxuICAgICAgfVxuICAgICAgbGV0IHR4cyA6IFdhbGxldFRyYW5zYWN0aW9uW10gfCBudWxsIHwgdW5kZWZpbmVkID0gcmVzLnR4c1xuICAgICAgaWYgKCF0eHMpIHtcbiAgICAgICAgdHhzID0gW11cbiAgICAgIH1cbiAgICAgIHRoaXMudHhIaXN0b3J5TWFwW2Fzc2V0SURdID0ge1xuICAgICAgICB0eHM6IHR4cyxcbiAgICAgICAgbGFzdFR4OiB0eHMubGVuZ3RoIDwgblxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMudHhIaXN0b3J5TWFwW2Fzc2V0SURdXG4gICAgfVxuICAgIGNvbnN0IHR4cyA6IFdhbGxldFRyYW5zYWN0aW9uW10gPSBbXVxuICAgIGxldCBsYXN0VHggPSBmYWxzZVxuICAgIGNvbnN0IHN0YXJ0SW5kZXggPSBhZnRlciA/IGNhY2hlZFR4SGlzdG9yeS50eHMuZmluZEluZGV4KHR4ID0+IHR4LmlkID09PSBhZnRlcikgKyAxIDogMFxuICAgIGlmIChhZnRlciAmJiBzdGFydEluZGV4ID09PSAtMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFmdGVyIHR4ICcgKyBhZnRlcilcbiAgICB9XG4gICAgbGV0IGxhc3RJbmRleCA9IHN0YXJ0SW5kZXhcbiAgICBmb3IgKGxldCBpID0gc3RhcnRJbmRleDsgaSA8IGNhY2hlZFR4SGlzdG9yeS50eHMubGVuZ3RoICYmIHR4cy5sZW5ndGggPCBuOyBpKyspIHtcbiAgICAgIHR4cy5wdXNoKGNhY2hlZFR4SGlzdG9yeS50eHNbaV0pXG4gICAgICBsYXN0SW5kZXggPSBpXG4gICAgICBhZnRlciA9IGNhY2hlZFR4SGlzdG9yeS50eHNbaV0uaWRcbiAgICB9XG4gICAgaWYgKGNhY2hlZFR4SGlzdG9yeS5sYXN0VHggJiYgbGFzdEluZGV4ID09PSBjYWNoZWRUeEhpc3RvcnkudHhzLmxlbmd0aCAtIDEpIHtcbiAgICAgIGxhc3RUeCA9IHRydWVcbiAgICB9XG4gICAgaWYgKHR4cy5sZW5ndGggPCBuICYmICFjYWNoZWRUeEhpc3RvcnkubGFzdFR4KSB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTih1cmwsIHtcbiAgICAgICAgbjogbiAtIHR4cy5sZW5ndGggKyAxLCAvLyArIDEgYmVjYXVzZSBmaXJzdCByZXN1bHQgd2lsbCBiZSByZWZJRFxuICAgICAgICBhc3NldElEOiBhc3NldElELFxuICAgICAgICByZWZJRDogYWZ0ZXIsXG4gICAgICAgIHBhc3Q6IHRydWVcbiAgICAgIH0pXG4gICAgICBpZiAoIXRoaXMuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihyZXMubXNnKVxuICAgICAgfVxuICAgICAgbGV0IHJlc1R4cyA6IFdhbGxldFRyYW5zYWN0aW9uW10gfCBudWxsIHwgdW5kZWZpbmVkID0gcmVzLnR4c1xuICAgICAgaWYgKCFyZXNUeHMpIHtcbiAgICAgICAgcmVzVHhzID0gW11cbiAgICAgIH1cbiAgICAgIGlmIChyZXNUeHMubGVuZ3RoID4gMCAmJiBhZnRlcikge1xuICAgICAgICBpZiAocmVzVHhzWzBdLmlkID09PSBhZnRlcikge1xuICAgICAgICAgIHJlc1R4cy5zaGlmdCgpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gSW1wbGllcyBhIGJ1ZyBpbiB0aGUgY2xpZW50XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRmlyc3QgdHggaGlzdG9yeSBlbGVtZW50ICE9IHJlZklEJylcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY2FjaGVkVHhIaXN0b3J5Lmxhc3RUeCA9IHJlc1R4cy5sZW5ndGggPCBuIC0gdHhzLmxlbmd0aFxuICAgICAgbGFzdFR4ID0gY2FjaGVkVHhIaXN0b3J5Lmxhc3RUeFxuICAgICAgdHhzLnB1c2goLi4ucmVzVHhzKVxuICAgICAgY2FjaGVkVHhIaXN0b3J5LnR4cy5wdXNoKC4uLnJlc1R4cylcbiAgICB9XG4gICAgcmV0dXJuIHsgdHhzLCBsYXN0VHggfVxuICB9XG5cbiAgZ2V0V2FsbGV0VHggKGFzc2V0SUQ6IG51bWJlciwgdHhJRDogc3RyaW5nKTogV2FsbGV0VHJhbnNhY3Rpb24gfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IGNhY2hlZFR4SGlzdG9yeSA9IHRoaXMudHhIaXN0b3J5TWFwW2Fzc2V0SURdXG4gICAgaWYgKCFjYWNoZWRUeEhpc3RvcnkpIHJldHVybiB1bmRlZmluZWRcbiAgICByZXR1cm4gY2FjaGVkVHhIaXN0b3J5LnR4cy5maW5kKHR4ID0+IHR4LmlkID09PSB0eElEKVxuICB9XG5cbiAgY2xlYXJUeEhpc3RvcnkgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGRlbGV0ZSB0aGlzLnR4SGlzdG9yeU1hcFthc3NldElEXVxuICB9XG5cbiAgYXN5bmMgbmVlZHNDdXN0b21Qcm92aWRlciAoYXNzZXRJRDogbnVtYmVyKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgY29uc3QgYmFzZUNoYWluSUQgPSB0aGlzLmFzc2V0c1thc3NldElEXT8udG9rZW4/LnBhcmVudElEID8/IGFzc2V0SURcbiAgICBpZiAoIWJhc2VDaGFpbklEKSByZXR1cm4gZmFsc2VcbiAgICBjb25zdCB3ID0gdGhpcy53YWxsZXRNYXBbYmFzZUNoYWluSURdXG4gICAgaWYgKCF3KSByZXR1cm4gZmFsc2VcbiAgICBjb25zdCB0cmFpdEFjY291bnRMb2NrZXIgPSAxIDw8IDE0XG4gICAgaWYgKCh3LnRyYWl0cyAmIHRyYWl0QWNjb3VudExvY2tlcikgPT09IDApIHJldHVybiBmYWxzZVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3dhbGxldHNldHRpbmdzJywgeyBhc3NldElEOiBiYXNlQ2hhaW5JRCB9KVxuICAgIGlmICghdGhpcy5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IocmVzLm1zZylcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICBjb25zdCBzZXR0aW5ncyA9IHJlcy5tYXAgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICAgIHJldHVybiAhc2V0dGluZ3MucHJvdmlkZXJzXG4gIH1cbn1cblxuLyogZ2V0U29ja2V0VVJJIHJldHVybnMgdGhlIHdlYnNvY2tldCBVUkkgZm9yIHRoZSBjbGllbnQuICovXG5mdW5jdGlvbiBnZXRTb2NrZXRVUkkgKCk6IHN0cmluZyB7XG4gIGNvbnN0IHByb3RvY29sID0gKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicpID8gJ3dzcycgOiAnd3MnXG4gIHJldHVybiBgJHtwcm90b2NvbH06Ly8ke3dpbmRvdy5sb2NhdGlvbi5ob3N0fS93c2Bcbn1cblxuLypcbiAqIHNldmVyaXR5Q2xhc3NNYXAgbWFwcyBhIG5vdGlmaWNhdGlvbiBzZXZlcml0eSBsZXZlbCB0byBhIENTUyBjbGFzcyB0aGF0XG4gKiBhc3NpZ25zIGEgYmFja2dyb3VuZCBjb2xvci5cbiAqL1xuY29uc3Qgc2V2ZXJpdHlDbGFzc01hcDogUmVjb3JkPG51bWJlciwgc3RyaW5nPiA9IHtcbiAgW250Zm4uU1VDQ0VTU106ICdnb29kJyxcbiAgW250Zm4uRVJST1JdOiAnYmFkJyxcbiAgW250Zm4uV0FSTklOR106ICd3YXJuJ1xufVxuXG4vKiBoYW5kbGVyRnJvbVBhdGggcGFyc2VzIHRoZSBoYW5kbGVyIG5hbWUgZnJvbSB0aGUgcGF0aC4gKi9cbmZ1bmN0aW9uIGhhbmRsZXJGcm9tUGF0aCAocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIHBhdGgucmVwbGFjZSgvXlxcLy8sICcnKS5zcGxpdCgnLycpWzBdLnNwbGl0KCc/JylbMF0uc3BsaXQoJyMnKVswXVxufVxuXG4vKiBub3dTdHJpbmcgY3JlYXRlcyBhIHN0cmluZyBmb3JtYXR0ZWQgbGlrZSBISDpNTTpTUy54eHggKi9cbmZ1bmN0aW9uIG5vd1N0cmluZyAoKTogc3RyaW5nIHtcbiAgY29uc3Qgc3RhbXAgPSBuZXcgRGF0ZSgpXG4gIGNvbnN0IGggPSBzdGFtcC5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKVxuICBjb25zdCBtID0gc3RhbXAuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKVxuICBjb25zdCBzID0gc3RhbXAuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKVxuICBjb25zdCBtcyA9IHN0YW1wLmdldE1pbGxpc2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMywgJzAnKVxuICByZXR1cm4gYCR7aH06JHttfToke3N9LiR7bXN9YFxufVxuXG5mdW5jdGlvbiBzZXRTZXZlcml0eUNsYXNzIChlbDogSFRNTEVsZW1lbnQsIHNldmVyaXR5OiBudW1iZXIpIHtcbiAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnYmFkJywgJ3dhcm4nLCAnZ29vZCcpXG4gIGVsLmNsYXNzTGlzdC5hZGQoc2V2ZXJpdHlDbGFzc01hcFtzZXZlcml0eV0pXG59XG5cbi8qIHVwZGF0ZU1hdGNoIHVwZGF0ZXMgdGhlIG1hdGNoIGluIG9yIGFkZHMgdGhlIG1hdGNoIHRvIHRoZSBvcmRlci4gKi9cbmZ1bmN0aW9uIHVwZGF0ZU1hdGNoIChvcmRlcjogT3JkZXIsIG1hdGNoOiBNYXRjaCkge1xuICBmb3IgKGNvbnN0IGkgaW4gb3JkZXIubWF0Y2hlcykge1xuICAgIGNvbnN0IG0gPSBvcmRlci5tYXRjaGVzW2ldXG4gICAgaWYgKG0ubWF0Y2hJRCA9PT0gbWF0Y2gubWF0Y2hJRCkge1xuICAgICAgb3JkZXIubWF0Y2hlc1tpXSA9IG1hdGNoXG4gICAgICByZXR1cm5cbiAgICB9XG4gIH1cbiAgb3JkZXIubWF0Y2hlcyA9IG9yZGVyLm1hdGNoZXMgfHwgW11cbiAgb3JkZXIubWF0Y2hlcy5wdXNoKG1hdGNoKVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZVBhZ2Uge1xuICAvKiB1bmxvYWQgaXMgY2FsbGVkIHdoZW4gdGhlIHVzZXIgbmF2aWdhdGVzIGF3YXkgZnJvbSB0aGUgcGFnZS4gKi9cbiAgdW5sb2FkICgpIHtcbiAgICAvLyBzaG91bGQgYmUgaW1wbGVtZW50ZWQgYnkgaW5oZXJpdGluZyBjbGFzcy5cbiAgfVxufVxuIiwiaW1wb3J0IERvYywgeyBBbmltYXRpb24sIGNsYW1wIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgeyBSYXRlRW5jb2RpbmdGYWN0b3IgfSBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCBPcmRlckJvb2sgZnJvbSAnLi9vcmRlcmJvb2snXG5pbXBvcnQgU3RhdGUgZnJvbSAnLi9zdGF0ZSdcbmltcG9ydCB7IFVuaXRJbmZvLCBNYXJrZXQsIENhbmRsZSwgQ2FuZGxlc1BheWxvYWQsIGFwcCB9IGZyb20gJy4vcmVnaXN0cnknXG5cbmNvbnN0IGJpbmQgPSBEb2MuYmluZFxuY29uc3QgUElQSSA9IDIgKiBNYXRoLlBJXG5jb25zdCBwbHVzQ2hhciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoNTk5MTQpXG5jb25zdCBtaW51c0NoYXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDU5OTE1KVxuXG5pbnRlcmZhY2UgUG9pbnQge1xuICB4OiBudW1iZXJcbiAgeTogbnVtYmVyXG59XG5cbmludGVyZmFjZSBNaW5NYXgge1xuICBtaW46IG51bWJlclxuICBtYXg6IG51bWJlclxufVxuXG5pbnRlcmZhY2UgTGFiZWwge1xuICB2YWw6IG51bWJlclxuICB0eHQ6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgTGFiZWxTZXQge1xuICB3aWRlc3Q/OiBudW1iZXJcbiAgbGJsczogTGFiZWxbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zbGF0b3Ige1xuICAgIHg6ICh4OiBudW1iZXIpID0+IG51bWJlclxuICAgIHk6ICh5OiBudW1iZXIpID0+IG51bWJlclxuICAgIHVueDogKHg6IG51bWJlcikgPT4gbnVtYmVyXG4gICAgdW55OiAoeTogbnVtYmVyKSA9PiBudW1iZXJcbiAgICB3OiAodzogbnVtYmVyKSA9PiBudW1iZXJcbiAgICBoOiAoaDogbnVtYmVyKSA9PiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNb3VzZVJlcG9ydCB7XG4gIHJhdGU6IG51bWJlclxuICBkZXB0aDogbnVtYmVyXG4gIGRvdENvbG9yOiBzdHJpbmdcbiAgaG92ZXJNYXJrZXJzOiBudW1iZXJbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZvbHVtZVJlcG9ydCB7XG4gIGJ1eUJhc2U6IG51bWJlclxuICBidXlRdW90ZTogbnVtYmVyXG4gIHNlbGxCYXNlOiBudW1iZXJcbiAgc2VsbFF1b3RlOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXB0aFJlcG9ydGVycyB7XG4gIG1vdXNlOiAocjogTW91c2VSZXBvcnQgfCBudWxsKSA9PiB2b2lkXG4gIGNsaWNrOiAoeDogbnVtYmVyKSA9PiB2b2lkXG4gIHZvbHVtZTogKHI6IFZvbHVtZVJlcG9ydCkgPT4gdm9pZFxuICB6b29tOiAoejogbnVtYmVyKSA9PiB2b2lkXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FuZGxlUmVwb3J0ZXJzIHtcbiAgbW91c2U6IChyOiBDYW5kbGUgfCBudWxsKSA9PiB2b2lkXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhcnRSZXBvcnRlcnMge1xuICByZXNpemU6ICgpID0+IHZvaWQsXG4gIGNsaWNrOiAoZTogTW91c2VFdmVudCkgPT4gdm9pZCxcbiAgem9vbTogKGJpZ2dlcjogYm9vbGVhbikgPT4gdm9pZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIERlcHRoTGluZSB7XG4gIHJhdGU6IG51bWJlclxuICBjb2xvcjogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVwdGhNYXJrZXIge1xuICByYXRlOiBudW1iZXJcbiAgYWN0aXZlOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBEZXB0aE1hcmsgZXh0ZW5kcyBEZXB0aE1hcmtlciB7XG4gIHF0eTogbnVtYmVyXG4gIHNlbGw6IGJvb2xlYW5cbn1cblxuaW50ZXJmYWNlIFRoZW1lIHtcbiAgYm9keTogc3RyaW5nXG4gIGF4aXNMYWJlbDogc3RyaW5nXG4gIGdyaWRCb3JkZXI6IHN0cmluZ1xuICBncmlkTGluZXM6IHN0cmluZ1xuICBnYXBMaW5lOiBzdHJpbmdcbiAgdmFsdWU6IHN0cmluZ1xuICB6b29tOiBzdHJpbmdcbiAgem9vbUhvdmVyOiBzdHJpbmdcbiAgc2VsbExpbmU6IHN0cmluZ1xuICBidXlMaW5lOiBzdHJpbmdcbiAgc2VsbEZpbGw6IHN0cmluZ1xuICBidXlGaWxsOiBzdHJpbmdcbiAgY3Jvc3NoYWlyczogc3RyaW5nXG4gIGxlZ2VuZEZpbGw6IHN0cmluZ1xuICBsZWdlbmRUZXh0OiBzdHJpbmdcbn1cblxuY29uc3QgZGFya1RoZW1lOiBUaGVtZSA9IHtcbiAgYm9keTogJyMwYjIwMzEnLFxuICBheGlzTGFiZWw6ICcjYjFiMWIxJyxcbiAgZ3JpZEJvcmRlcjogJyMzODNmNGInLFxuICBncmlkTGluZXM6ICcjMzgzZjRiJyxcbiAgZ2FwTGluZTogJyM2YjZiNmInLFxuICB2YWx1ZTogJyM5YTlhOWEnLFxuICB6b29tOiAnIzViNWI1YicsXG4gIHpvb21Ib3ZlcjogJyNhYWEnLFxuICBzZWxsTGluZTogJyNhZTMzMzMnLFxuICBidXlMaW5lOiAnIzA1YTM1YScsXG4gIHNlbGxGaWxsOiAnIzU5MWExYScsXG4gIGJ1eUZpbGw6ICcjMDI1NzJmJyxcbiAgY3Jvc3NoYWlyczogJyM4ODgnLFxuICBsZWdlbmRGaWxsOiAnYmxhY2snLFxuICBsZWdlbmRUZXh0OiAnI2Q1ZDVkNSdcbn1cblxuY29uc3QgbGlnaHRUaGVtZTogVGhlbWUgPSB7XG4gIGJvZHk6ICcjZjRmNGY0JyxcbiAgYXhpc0xhYmVsOiAnIzFiMWIxYicsXG4gIGdyaWRCb3JkZXI6ICcjZGRkJyxcbiAgZ3JpZExpbmVzOiAnI2RkZCcsXG4gIGdhcExpbmU6ICcjNTk1OTU5JyxcbiAgdmFsdWU6ICcjNGQ0ZDRkJyxcbiAgem9vbTogJyM3NzcnLFxuICB6b29tSG92ZXI6ICcjMzMzJyxcbiAgc2VsbExpbmU6ICcjOTkzMDJiJyxcbiAgYnV5TGluZTogJyMyMDdhNDYnLFxuICBzZWxsRmlsbDogJyNiZDU5NTknLFxuICBidXlGaWxsOiAnIzRjYWQ3NScsXG4gIGNyb3NzaGFpcnM6ICcjNTk1OTU5JyxcbiAgbGVnZW5kRmlsbDogJyNlNmU2ZTYnLFxuICBsZWdlbmRUZXh0OiAnIzFiMWIxYidcbn1cblxuLy8gQ2hhcnQgaXMgdGhlIGJhc2UgY2xhc3MgZm9yIGNoYXJ0cy5cbmV4cG9ydCBjbGFzcyBDaGFydCB7XG4gIHBhcmVudDogSFRNTEVsZW1lbnRcbiAgcmVwb3J0OiBDaGFydFJlcG9ydGVyc1xuICB0aGVtZTogVGhlbWVcbiAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudFxuICB2aXNpYmxlOiBib29sZWFuXG4gIHJlbmRlclNjaGVkdWxlZDogYm9vbGVhblxuICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRFxuICBtb3VzZVBvczogUG9pbnQgfCBudWxsXG4gIHJlY3Q6IERPTVJlY3RcbiAgd2hlZWxMaW1pdGVyOiBudW1iZXIgfCBudWxsXG4gIGJvdW5kUmVzaXplcjogKCkgPT4gdm9pZFxuICBwbG90UmVnaW9uOiBSZWdpb25cbiAgeFJlZ2lvbjogUmVnaW9uXG4gIHlSZWdpb246IFJlZ2lvblxuICBkYXRhRXh0ZW50czogRXh0ZW50c1xuICB1bmF0dGFjaGVyczogKCgpID0+IHZvaWQpW11cblxuICBjb25zdHJ1Y3RvciAocGFyZW50OiBIVE1MRWxlbWVudCwgcmVwb3J0ZXJzOiBDaGFydFJlcG9ydGVycykge1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50XG4gICAgdGhpcy5yZXBvcnQgPSByZXBvcnRlcnNcbiAgICB0aGlzLnRoZW1lID0gU3RhdGUuaXNEYXJrKCkgPyBkYXJrVGhlbWUgOiBsaWdodFRoZW1lXG4gICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKVxuICAgIHRoaXMudmlzaWJsZSA9IHRydWVcbiAgICBwYXJlbnQuYXBwZW5kQ2hpbGQodGhpcy5jYW52YXMpXG4gICAgY29uc3QgY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxuICAgIGlmICghY3R4KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdlcnJvciBnZXR0aW5nIGNhbnZhcyBjb250ZXh0JylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLmN0eCA9IGN0eFxuICAgIHRoaXMuY3R4LnRleHRBbGlnbiA9ICdjZW50ZXInXG4gICAgdGhpcy5jdHgudGV4dEJhc2VsaW5lID0gJ21pZGRsZSdcbiAgICAvLyBNb3VzZSBoYW5kbGluZ1xuICAgIHRoaXMubW91c2VQb3MgPSBudWxsXG4gICAgYmluZCh0aGlzLmNhbnZhcywgJ21vdXNlbW92ZScsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAvLyB0aGlzLnJlY3Qgd2lsbCBiZSBzZXQgaW4gcmVzaXplKCkuXG4gICAgICBpZiAoIXRoaXMucmVjdCkgcmV0dXJuXG4gICAgICB0aGlzLm1vdXNlUG9zID0ge1xuICAgICAgICB4OiBlLmNsaWVudFggLSB0aGlzLnJlY3QubGVmdCxcbiAgICAgICAgeTogZS5jbGllbnRZIC0gdGhpcy5yZWN0LnlcbiAgICAgIH1cbiAgICAgIHRoaXMuZHJhdygpXG4gICAgfSlcbiAgICBiaW5kKHRoaXMuY2FudmFzLCAnbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgIHRoaXMubW91c2VQb3MgPSBudWxsXG4gICAgICB0aGlzLmRyYXcoKVxuICAgIH0pXG5cbiAgICAvLyBCaW5kIHJlc2l6ZS5cbiAgICBjb25zdCByZXNpemVPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcigoKSA9PiB0aGlzLnJlc2l6ZSgpKVxuICAgIHJlc2l6ZU9ic2VydmVyLm9ic2VydmUodGhpcy5wYXJlbnQpXG5cbiAgICAvLyBTY3JvbGxpbmcgYnkgd2hlZWwgaXMgc21vb3RoZXIgd2hlbiB0aGUgcmF0ZSBpcyBzbGlnaHRseSBsaW1pdGVkLlxuICAgIHRoaXMud2hlZWxMaW1pdGVyID0gbnVsbFxuICAgIGJpbmQodGhpcy5jYW52YXMsICd3aGVlbCcsIChlOiBXaGVlbEV2ZW50KSA9PiB7IHRoaXMud2hlZWwoZSkgfSwgeyBwYXNzaXZlOiB0cnVlIH0pXG4gICAgYmluZCh0aGlzLmNhbnZhcywgJ2NsaWNrJywgKGU6IE1vdXNlRXZlbnQpID0+IHsgdGhpcy5jbGljayhlKSB9KVxuICAgIGNvbnN0IHNldFZpcyA9ICgpID0+IHtcbiAgICAgIHRoaXMudmlzaWJsZSA9IGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSAhPT0gJ2hpZGRlbidcbiAgICAgIGlmICh0aGlzLnZpc2libGUgJiYgdGhpcy5yZW5kZXJTY2hlZHVsZWQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJTY2hlZHVsZWQgPSBmYWxzZVxuICAgICAgICB0aGlzLmRyYXcoKVxuICAgICAgfVxuICAgIH1cbiAgICBiaW5kKGRvY3VtZW50LCAndmlzaWJpbGl0eWNoYW5nZScsIHNldFZpcylcbiAgICB0aGlzLnVuYXR0YWNoZXJzID0gWygpID0+IHsgRG9jLnVuYmluZChkb2N1bWVudCwgJ3Zpc2liaWxpdHljaGFuZ2UnLCBzZXRWaXMpIH1dXG4gIH1cblxuICB3aGVlbGVkICgpIHtcbiAgICB0aGlzLndoZWVsTGltaXRlciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHsgdGhpcy53aGVlbExpbWl0ZXIgPSBudWxsIH0sIDEwMClcbiAgfVxuXG4gIC8qIGNsZWFyIHRoZSBjYW52YXMuICovXG4gIGNsZWFyICgpIHtcbiAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodClcbiAgfVxuXG4gIC8qIGRyYXcgY2FsbHMgdGhlIGNoaWxkIGNsYXNzJ3MgcmVuZGVyIG1ldGhvZC4gKi9cbiAgZHJhdyAoKSB7XG4gICAgdGhpcy5yZW5kZXIoKVxuICB9XG5cbiAgLyogY2xpY2sgaXMgdGhlIGhhbmRsZXIgZm9yIGEgY2xpY2sgZXZlbnQgb24gdGhlIGNhbnZhcy4gKi9cbiAgY2xpY2sgKGU6IE1vdXNlRXZlbnQpIHtcbiAgICB0aGlzLnJlcG9ydC5jbGljayhlKVxuICB9XG5cbiAgLyogd2hlZWwgaXMgYSBtb3VzZXdoZWVsIGV2ZW50IGhhbmRsZXIuICovXG4gIHdoZWVsIChlOiBXaGVlbEV2ZW50KSB7XG4gICAgdGhpcy56b29tKGUuZGVsdGFZIDwgMClcbiAgfVxuXG4gIC8qXG4gICAqIHJlc2l6ZSB1cGRhdGVzIHRoZSBjaGFydCBzaXplLiBUaGUgcGFyZW50SGVpZ2h0IGlzIGFuIGFyZ3VtZW50IHRvIHN1cHBvcnRcbiAgICogdXBkYXRpbmcgdGhlIGhlaWdodCBwcm9ncmFtbWF0aWNhbGx5IGFmdGVyIHRoZSBjYWxsZXIgc2V0cyBhIHN0eWxlLmhlaWdodFxuICAgKiBidXQgYmVmb3JlIHRoZSBjbGllbnRIZWlnaHQgaGFzIGJlZW4gdXBkYXRlZC5cbiAgICovXG4gIHJlc2l6ZSAoKSB7XG4gICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLnBhcmVudC5jbGllbnRXaWR0aFxuICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMucGFyZW50LmNsaWVudEhlaWdodFxuICAgIGNvbnN0IHhMYmxIZWlnaHQgPSAzMFxuICAgIGNvbnN0IHlHdWVzcyA9IDQwIC8vIHkgbGFiZWwgd2lkdGggZ3Vlc3MuIFdpbGwgYmUgYWRqdXN0ZWQgd2hlbiBkcmF3bi5cbiAgICBjb25zdCBwbG90RXh0ZW50cyA9IG5ldyBFeHRlbnRzKDAsIHRoaXMuY2FudmFzLndpZHRoLCAwLCB0aGlzLmNhbnZhcy5oZWlnaHQgLSB4TGJsSGVpZ2h0KVxuICAgIGNvbnN0IHhMYmxFeHRlbnRzID0gbmV3IEV4dGVudHMoMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCAtIHhMYmxIZWlnaHQsIHRoaXMuY2FudmFzLmhlaWdodClcbiAgICBjb25zdCB5TGJsRXh0ZW50cyA9IG5ldyBFeHRlbnRzKDAsIHlHdWVzcywgMCwgdGhpcy5jYW52YXMuaGVpZ2h0IC0geExibEhlaWdodClcbiAgICB0aGlzLnBsb3RSZWdpb24gPSBuZXcgUmVnaW9uKHRoaXMuY3R4LCBwbG90RXh0ZW50cylcbiAgICB0aGlzLnhSZWdpb24gPSBuZXcgUmVnaW9uKHRoaXMuY3R4LCB4TGJsRXh0ZW50cylcbiAgICB0aGlzLnlSZWdpb24gPSBuZXcgUmVnaW9uKHRoaXMuY3R4LCB5TGJsRXh0ZW50cylcbiAgICAvLyBBZnRlciBjaGFuZ2luZyB0aGUgdmlzaWJpbGl0eSwgdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0IHdpbGxcbiAgICAvLyByZXR1cm4gbm9uc2Vuc2UgdW50aWwgYSByZW5kZXIuXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0aGlzLnJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgdGhpcy5yZXBvcnQucmVzaXplKClcbiAgICB9KVxuICB9XG5cbiAgLyogem9vbSBpcyBjYWxsZWQgd2hlbiB0aGUgdXNlciBzY3JvbGxzIHRoZSBtb3VzZSB3aGVlbCBvbiB0aGUgY2FudmFzLiAqL1xuICB6b29tIChiaWdnZXI6IGJvb2xlYW4pIHtcbiAgICBpZiAodGhpcy53aGVlbExpbWl0ZXIpIHJldHVyblxuICAgIHRoaXMucmVwb3J0Lnpvb20oYmlnZ2VyKVxuICB9XG5cbiAgLyogVGhlIG1hcmtldCBoYW5kbGVyIHdpbGwgY2FsbCB1bmF0dGFjaCB3aGVuIHRoZSBtYXJrZXRzIHBhZ2UgaXMgdW5sb2FkZWQuICovXG4gIHVuYXR0YWNoICgpIHtcbiAgICBmb3IgKGNvbnN0IHUgb2YgdGhpcy51bmF0dGFjaGVycykgdSgpXG4gICAgdGhpcy51bmF0dGFjaGVycyA9IFtdXG4gIH1cblxuICAvKiByZW5kZXIgbXVzdCBiZSBpbXBsZW1lbnRlZCBieSB0aGUgY2hpbGQgY2xhc3MuICovXG4gIHJlbmRlciAoKSB7XG4gICAgY29uc29sZS5lcnJvcignY2hpbGQgY2xhc3MgbXVzdCBvdmVycmlkZSByZW5kZXIgbWV0aG9kJylcbiAgfVxuXG4gIC8qIGFwcGx5TGFiZWxTdHlsZSBhcHBsaWVzIHRoZSBzdHlsZSB1c2VkIGZvciBheGlzIHRpY2sgbGFiZWxzLiAqL1xuICBhcHBseUxhYmVsU3R5bGUgKGZvbnRTaXplPzogbnVtYmVyKSB7XG4gICAgdGhpcy5jdHgudGV4dEFsaWduID0gJ2NlbnRlcidcbiAgICB0aGlzLmN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJ1xuICAgIHRoaXMuY3R4LmZvbnQgPSBgJHtmb250U2l6ZSA/PyAnMTQnfXB4ICdzYW5zJywgc2Fucy1zZXJpZmBcbiAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLmF4aXNMYWJlbFxuICB9XG5cbiAgLyogcGxvdFhMYWJlbHMgYXBwbGllcyB0aGUgcHJvdmlkZWQgbGFiZWxzIHRvIHRoZSB4IGF4aXMgYW5kIGRyYXdzIHRoZSBncmlkLiAqL1xuICBwbG90WExhYmVscyAobGFiZWxzOiBMYWJlbFNldCwgbWluWDogbnVtYmVyLCBtYXhYOiBudW1iZXIsIHVuaXRMaW5lczogc3RyaW5nW10pIHtcbiAgICBjb25zdCBleHRlbnRzID0gbmV3IEV4dGVudHMobWluWCwgbWF4WCwgMCwgMSlcbiAgICB0aGlzLnhSZWdpb24ucGxvdChleHRlbnRzLCAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHRvb2xzOiBUcmFuc2xhdG9yKSA9PiB7XG4gICAgICB0aGlzLmFwcGx5TGFiZWxTdHlsZSgpXG4gICAgICBjb25zdCBjZW50ZXJYID0gKG1heFggKyBtaW5YKSAvIDJcbiAgICAgIGxldCBsYXN0WCA9IG1pblhcbiAgICAgIGxldCB1bml0Q2VudGVyID0gY2VudGVyWFxuICAgICAgY29uc3QgW2xlZnRFZGdlLCByaWdodEVkZ2VdID0gW3Rvb2xzLngobWluWCksIHRvb2xzLngobWF4WCldXG4gICAgICBjb25zdCBjZW50ZXJZID0gdG9vbHMueSgwLjUpXG4gICAgICBsYWJlbHMubGJscy5mb3JFYWNoKGxibCA9PiB7XG4gICAgICAgIGNvbnN0IG0gPSBjdHgubWVhc3VyZVRleHQobGJsLnR4dClcbiAgICAgICAgY29uc3QgeCA9IHRvb2xzLngobGJsLnZhbClcbiAgICAgICAgaWYgKHggLSBtLndpZHRoIC8gMiA8IGxlZnRFZGdlIHx8IHggKyBtLndpZHRoIC8gMiA+IHJpZ2h0RWRnZSkgcmV0dXJuXG4gICAgICAgIGN0eC5maWxsVGV4dChsYmwudHh0LCB4LCBjZW50ZXJZKVxuICAgICAgICBpZiAoY2VudGVyWCA+PSBsYXN0WCAmJiBjZW50ZXJYIDwgbGJsLnZhbCkge1xuICAgICAgICAgIHVuaXRDZW50ZXIgPSAobGFzdFggKyBsYmwudmFsKSAvIDJcbiAgICAgICAgfVxuICAgICAgICBsYXN0WCA9IGxibC52YWxcbiAgICAgIH0pXG4gICAgICBjdHguZm9udCA9ICcxMXB4IFxcJ3NhbnNcXCcsIHNhbnMtc2VyaWYnXG4gICAgICBpZiAodW5pdExpbmVzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBjdHguZmlsbFRleHQodW5pdExpbmVzWzBdLCB0b29scy54KHVuaXRDZW50ZXIpLCB0b29scy55KDAuNjMpKVxuICAgICAgICBjdHguZmlsbFRleHQodW5pdExpbmVzWzFdLCB0b29scy54KHVuaXRDZW50ZXIpLCB0b29scy55KDAuMjMpKVxuICAgICAgfSBlbHNlIGlmICh1bml0TGluZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGN0eC5maWxsVGV4dCh1bml0TGluZXNbMF0sIHRvb2xzLngodW5pdENlbnRlciksIGNlbnRlclkpXG4gICAgICB9XG4gICAgfSwgdHJ1ZSlcbiAgfVxuXG4gIHBsb3RYR3JpZCAobGFiZWxzOiBMYWJlbFNldCwgbWluWDogbnVtYmVyLCBtYXhYOiBudW1iZXIpIHtcbiAgICBjb25zdCBleHRlbnRzID0gbmV3IEV4dGVudHMobWluWCwgbWF4WCwgMCwgMSlcbiAgICB0aGlzLnBsb3RSZWdpb24ucGxvdChleHRlbnRzLCAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHRvb2xzOiBUcmFuc2xhdG9yKSA9PiB7XG4gICAgICBjdHgubGluZVdpZHRoID0gMVxuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5ncmlkTGluZXNcbiAgICAgIGxhYmVscy5sYmxzLmZvckVhY2gobGJsID0+IHtcbiAgICAgICAgbGluZShjdHgsIHRvb2xzLngobGJsLnZhbCksIHRvb2xzLnkoMCksIHRvb2xzLngobGJsLnZhbCksIHRvb2xzLnkoMSkpXG4gICAgICB9KVxuICAgIH0sIHRydWUpXG4gIH1cblxuICAvKlxuICAgKiBwbG90WUxhYmVscyBhcHBsaWVzIHRoZSB5IGxhYmVscyBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgcGxvdCByZWdpb24sIGFuZFxuICAgKiBkcmF3cyB0aGUgZ3JpZC5cbiAgICovXG4gIHBsb3RZTGFiZWxzIChsYWJlbHM6IExhYmVsU2V0LCBtaW5ZOiBudW1iZXIsIG1heFk6IG51bWJlciwgdW5pdDogc3RyaW5nKSB7XG4gICAgY29uc3QgZXh0ZW50cyA9IG5ldyBFeHRlbnRzKDAsIDEsIG1pblksIG1heFkpXG5cbiAgICBjb25zdCBmaWxsUmVjdCA9IChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgeDogbnVtYmVyLCB5OiBudW1iZXIsIHc6IG51bWJlciwgaDogbnVtYmVyLCByOiBudW1iZXIpID0+IHtcbiAgICAgIGN0eC5zYXZlKClcbiAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLmJvZHlcbiAgICAgIGN0eC5iZWdpblBhdGgoKVxuICAgICAgaWYgKGN0eC5yb3VuZFJlY3QpIGN0eC5yb3VuZFJlY3QoeCwgeSwgdywgaCwgcikgLy8gU2FmYXJpIDwgMTYgZG9lc24ndCBzdXBwb3J0XG4gICAgICBlbHNlIGN0eC5yZWN0KHgsIHksIHcsIGgpXG4gICAgICBjdHguZmlsbCgpXG4gICAgICBjdHgucmVzdG9yZSgpXG4gICAgfVxuXG4gICAgdGhpcy55UmVnaW9uLnBsb3QoZXh0ZW50cywgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0b29sczogVHJhbnNsYXRvcikgPT4ge1xuICAgICAgdGhpcy5hcHBseUxhYmVsU3R5bGUoKVxuICAgICAgdGhpcy5jdHgudGV4dEFsaWduID0gJ2xlZnQnXG4gICAgICBjb25zdCBjZW50ZXJZID0gbWF4WSAvIDJcbiAgICAgIGxldCBsYXN0WSA9IDBcbiAgICAgIGxldCB1bml0Q2VudGVyID0gY2VudGVyWVxuICAgICAgY29uc3QgeCA9IHRvb2xzLngoMClcbiAgICAgIGNvbnN0IFt4UGFkLCB5UGFkXSA9IFszLCAzXVxuICAgICAgbGFiZWxzLmxibHMuZm9yRWFjaChsYmwgPT4ge1xuICAgICAgICBjb25zdCB5ID0gdG9vbHMueShsYmwudmFsKVxuICAgICAgICBpZiAoeSA8IHRvb2xzLnkobWF4WSkgKyB5UGFkICsgNyB8fCB5ID4gdG9vbHMueShtaW5ZKSAtIHlQYWQgLSA3KSByZXR1cm5cbiAgICAgICAgY29uc3QgbSA9IGN0eC5tZWFzdXJlVGV4dChsYmwudHh0KVxuICAgICAgICBmaWxsUmVjdChjdHgsIHgsIHkgLSA3IC0geVBhZCwgbS53aWR0aCArIHhQYWQgKiAyLCAxNCArIHlQYWQgKiAzLCAzKVxuICAgICAgICBjdHguZmlsbFRleHQobGJsLnR4dCwgeCArIHhQYWQsIHkgKyAyKVxuICAgICAgICBpZiAoY2VudGVyWSA+PSBsYXN0WSAmJiBjZW50ZXJZIDwgbGJsLnZhbCkge1xuICAgICAgICAgIHVuaXRDZW50ZXIgPSAobGFzdFkgKyBsYmwudmFsKSAvIDJcbiAgICAgICAgfVxuICAgICAgICBsYXN0WSA9IGxibC52YWxcbiAgICAgIH0pXG4gICAgICBjb25zdCBtID0gY3R4Lm1lYXN1cmVUZXh0KHVuaXQpXG4gICAgICBjb25zdCB5ID0gdG9vbHMueSh1bml0Q2VudGVyKVxuICAgICAgZmlsbFJlY3QoY3R4LCB4LCB5IC0geVBhZCAtIDcsIG0ud2lkdGggKyB4UGFkICogMiwgMTQgKyB5UGFkICogMiwgMylcbiAgICAgIGN0eC5maWxsVGV4dCh1bml0LCB4ICsgeFBhZCwgdG9vbHMueSh1bml0Q2VudGVyKSlcbiAgICB9LCB0cnVlKVxuICB9XG5cbiAgcGxvdFlHcmlkIChyZWdpb246IFJlZ2lvbiwgbGFiZWxzOiBMYWJlbFNldCwgbWluWTogbnVtYmVyLCBtYXhZOiBudW1iZXIpIHtcbiAgICBjb25zdCBleHRlbnRzID0gbmV3IEV4dGVudHMoMCwgMSwgbWluWSwgbWF4WSlcbiAgICByZWdpb24ucGxvdChleHRlbnRzLCAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHRvb2xzOiBUcmFuc2xhdG9yKSA9PiB7XG4gICAgICBjdHgubGluZVdpZHRoID0gMVxuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5ncmlkTGluZXNcbiAgICAgIGxhYmVscy5sYmxzLmZvckVhY2gobGJsID0+IHtcbiAgICAgICAgbGluZShjdHgsIHRvb2xzLngoMCksIHRvb2xzLnkobGJsLnZhbCksIHRvb2xzLngoMSksIHRvb2xzLnkobGJsLnZhbCkpXG4gICAgICB9KVxuICAgIH0sIHRydWUpXG4gIH1cblxuICAvKlxuICAgKiBkb1lMYWJlbHMgZ2VuZXJhdGVzIGFuZCBhcHBsaWVzIHRoZSB5LWF4aXMgbGFiZWxzLCBiYXNlZCB1cG9uIHRoZVxuICAgKiBwcm92aWRlZCBwbG90IHJlZ2lvbi5cbiAgICovXG4gIG1ha2VZTGFiZWxzIChyZWdpb246IFJlZ2lvbiwgc3RlcDogbnVtYmVyLCB1bml0OiBzdHJpbmcsIHZhbEZtdD86ICh2OiBudW1iZXIpID0+IHN0cmluZyk6IExhYmVsU2V0IHtcbiAgICB0aGlzLmFwcGx5TGFiZWxTdHlsZSgpXG4gICAgY29uc3QgeUxhYmVscyA9IG1ha2VMYWJlbHModGhpcy5jdHgsIHJlZ2lvbi5oZWlnaHQoKSwgdGhpcy5kYXRhRXh0ZW50cy55Lm1pbixcbiAgICAgIHRoaXMuZGF0YUV4dGVudHMueS5tYXgsIDUwLCBzdGVwLCB1bml0LCB2YWxGbXQpXG5cbiAgICAvLyBSZWFzc2lnbiB0aGUgd2lkdGggb2YgdGhlIHktbGFiZWwgY29sdW1uIHRvIGFjY29tbW9kYXRlIHRoZSB3aWRlc3QgdGV4dC5cbiAgICBjb25zdCB5QXhpc1dpZHRoID0gKHlMYWJlbHMud2lkZXN0IHx8IDApICsgMjAgLyogeCBwYWRkaW5nICovXG4gICAgdGhpcy55UmVnaW9uLmV4dGVudHMueC5tYXggPSB5QXhpc1dpZHRoXG4gICAgdGhpcy55UmVnaW9uLmV4dGVudHMueS5tYXggPSByZWdpb24uZXh0ZW50cy55Lm1heFxuXG4gICAgcmV0dXJuIHlMYWJlbHNcbiAgfVxuXG4gIGxpbmUgKHgwOiBudW1iZXIsIHkwOiBudW1iZXIsIHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHNraXBTdHJva2U/OiBib29sZWFuKSB7XG4gICAgbGluZSh0aGlzLmN0eCwgeDAsIHkwLCB4MSwgeTEsIHNraXBTdHJva2UpXG4gIH1cblxuICAvKiBkb3QgZHJhd3MgYSBjaXJjbGUgd2l0aCB0aGUgcHJvdmlkZWQgY29udGV4dC4gKi9cbiAgZG90ICh4OiBudW1iZXIsIHk6IG51bWJlciwgY29sb3I6IHN0cmluZywgcmFkaXVzOiBudW1iZXIpIHtcbiAgICBkb3QodGhpcy5jdHgsIHgsIHksIGNvbG9yLCByYWRpdXMpXG4gIH1cbn1cblxuLyogRGVwdGhDaGFydCBpcyBhIGphdmFzY3JpcHQgQ2FudmFzLWJhc2VkIGRlcHRoIGNoYXJ0IHJlbmRlcmVyLiAqL1xuZXhwb3J0IGNsYXNzIERlcHRoQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XG4gIHJlcG9ydGVyczogRGVwdGhSZXBvcnRlcnNcbiAgYm9vazogT3JkZXJCb29rXG4gIHpvb21MZXZlbDogbnVtYmVyXG4gIGxvdFNpemU6IG51bWJlclxuICBjb252ZW50aW9uYWxSYXRlU3RlcDogbnVtYmVyXG4gIGxpbmVzOiBEZXB0aExpbmVbXVxuICBtYXJrZXJzOiBSZWNvcmQ8c3RyaW5nLCBEZXB0aE1hcmtlcltdPlxuICB6b29tSW5CdHRuOiBSZWdpb25cbiAgem9vbU91dEJ0dG46IFJlZ2lvblxuICBiYXNlVW5pdDogc3RyaW5nXG4gIHF1b3RlVW5pdDogc3RyaW5nXG5cbiAgY29uc3RydWN0b3IgKHBhcmVudDogSFRNTEVsZW1lbnQsIHJlcG9ydGVyczogRGVwdGhSZXBvcnRlcnMsIHpvb206IG51bWJlcikge1xuICAgIHN1cGVyKHBhcmVudCwge1xuICAgICAgcmVzaXplOiAoKSA9PiB0aGlzLnJlc2l6ZWQoKSxcbiAgICAgIGNsaWNrOiAoZTogTW91c2VFdmVudCkgPT4gdGhpcy5jbGlja2VkKGUpLFxuICAgICAgem9vbTogKGJpZ2dlcjogYm9vbGVhbikgPT4gdGhpcy56b29tZWQoYmlnZ2VyKVxuICAgIH0pXG4gICAgdGhpcy5yZXBvcnRlcnMgPSByZXBvcnRlcnNcbiAgICB0aGlzLnpvb21MZXZlbCA9IHpvb21cbiAgICB0aGlzLmxpbmVzID0gW11cbiAgICB0aGlzLm1hcmtlcnMgPSB7XG4gICAgICBidXlzOiBbXSxcbiAgICAgIHNlbGxzOiBbXVxuICAgIH1cbiAgICB0aGlzLnNldFpvb21CdHRucygpIC8vIGNhbid0IHdhaXQgZm9yIHJlcXVlc3RBbmltYXRpb25GcmFtZSAtPiByZXNpemVkXG4gICAgdGhpcy5yZXNpemUoKVxuICB9XG5cbiAgLy8gc2V0Wm9vbUJ0dG5zIGNyZWF0ZXMgbmV3IHJlZ2lvbnMgZm9yIHpvb20gaW4gYW5kIHpvb20gb3V0IGJ1dHRvbnMuIEl0IGlzXG4gIC8vIHVzZWQgaW4gaW5pdGlhdGlvbiBvZiB0aGUgYnV0dG9ucyBhbmQgcmVzaXppbmcuXG4gIHNldFpvb21CdHRucyAoKSB7XG4gICAgdGhpcy56b29tSW5CdHRuID0gbmV3IFJlZ2lvbih0aGlzLmN0eCwgbmV3IEV4dGVudHMoMCwgMCwgMCwgMCkpXG4gICAgdGhpcy56b29tT3V0QnR0biA9IG5ldyBSZWdpb24odGhpcy5jdHgsIG5ldyBFeHRlbnRzKDAsIDAsIDAsIDApKVxuICB9XG5cbiAgLyogcmVzaXplZCBpcyBjYWxsZWQgd2hlbiB0aGUgd2luZG93IG9yIHBhcmVudCBlbGVtZW50IGFyZSByZXNpemVkLiAqL1xuICByZXNpemVkICgpIHtcbiAgICAvLyBUaGUgYnV0dG9uIHJlZ2lvbiBleHRlbnRzIGFyZSBzZXQgZHVyaW5nIGRyYXdpbmcuXG4gICAgdGhpcy5zZXRab29tQnR0bnMoKVxuICAgIGlmICh0aGlzLmJvb2spIHRoaXMuZHJhdygpXG4gIH1cblxuICAvKiB6b29tZWQgem9vbXMgdGhlIGN1cnJlbnQgdmlldyBpbiBvciBvdXQuIGJpZ2dlcj10cnVlIGlzIHpvb20gaW4uICovXG4gIHpvb21lZCAoYmlnZ2VyOiBib29sZWFuKSB7XG4gICAgaWYgKCF0aGlzLnpvb21MZXZlbCkgcmV0dXJuXG4gICAgaWYgKCF0aGlzLmJvb2suYnV5cyB8fCAhdGhpcy5ib29rLnNlbGxzKSByZXR1cm5cbiAgICB0aGlzLndoZWVsZWQoKVxuICAgIC8vIFpvb20gaW4gdG8gNjYlLCBidXQgb3V0IHRvIDE1MCUgPSAxIC8gKDIvMykgc28gdGhhdCB0aGUgc2FtZSB6b29tIGxldmVsc1xuICAgIC8vIGFyZSBoaXQgd2hlbiByZXZlcnNpbmcgZGlyZWN0aW9uLlxuICAgIHRoaXMuem9vbUxldmVsICo9IGJpZ2dlciA/IDIgLyAzIDogMyAvIDJcbiAgICB0aGlzLnpvb21MZXZlbCA9IGNsYW1wKHRoaXMuem9vbUxldmVsLCAwLjAwNSwgMilcbiAgICB0aGlzLmRyYXcoKVxuICAgIHRoaXMucmVwb3J0ZXJzLnpvb20odGhpcy56b29tTGV2ZWwpXG4gIH1cblxuICAvKiBjbGlja2VkIGlzIHRoZSBjYW52YXMgJ2NsaWNrJyBldmVudCBoYW5kbGVyLiAqL1xuICBjbGlja2VkIChlOiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmRhdGFFeHRlbnRzKSByZXR1cm5cbiAgICBjb25zdCB4ID0gZS5jbGllbnRYIC0gdGhpcy5yZWN0LmxlZnRcbiAgICBjb25zdCB5ID0gZS5jbGllbnRZIC0gdGhpcy5yZWN0LnlcbiAgICBpZiAodGhpcy56b29tSW5CdHRuLmNvbnRhaW5zKHgsIHkpKSB7IHRoaXMuem9vbSh0cnVlKTsgcmV0dXJuIH1cbiAgICBpZiAodGhpcy56b29tT3V0QnR0bi5jb250YWlucyh4LCB5KSkgeyB0aGlzLnpvb20oZmFsc2UpOyByZXR1cm4gfVxuICAgIGNvbnN0IHRyYW5zbGF0b3IgPSB0aGlzLnBsb3RSZWdpb24udHJhbnNsYXRvcih0aGlzLmRhdGFFeHRlbnRzKVxuICAgIHRoaXMucmVwb3J0ZXJzLmNsaWNrKHRyYW5zbGF0b3IudW54KHgpKVxuICB9XG5cbiAgLy8gc2V0IHNldHMgdGhlIGN1cnJlbnQgZGF0YSBzZXQgYW5kIGRyYXdzLlxuICBzZXQgKGJvb2s6IE9yZGVyQm9vaywgbG90U2l6ZTogbnVtYmVyLCByYXRlU3RlcEVuYzogbnVtYmVyLCBiYXNlVW5pdEluZm86IFVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvOiBVbml0SW5mbykge1xuICAgIHRoaXMuYm9vayA9IGJvb2tcbiAgICB0aGlzLmxvdFNpemUgPSBsb3RTaXplIC8gYmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgdGhpcy5jb252ZW50aW9uYWxSYXRlU3RlcCA9IERvYy5jb252ZW50aW9uYWxSYXRlU3RlcChyYXRlU3RlcEVuYywgYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvKVxuICAgIHRoaXMuYmFzZVVuaXQgPSBiYXNlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICB0aGlzLnF1b3RlVW5pdCA9IHF1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICBpZiAoIXRoaXMuem9vbUxldmVsKSB7XG4gICAgICBjb25zdCBbbWlkR2FwLCBnYXBXaWR0aF0gPSB0aGlzLmdhcCgpXG4gICAgICAvLyBEZWZhdWx0IHRvIDUlIHpvb20sIGJ1dCB3aXRoIGEgbWluaW11bSBvZiA1ICogbWlkR2FwLCBidXQgc3RpbGwgb2JzZXJ2aW5nXG4gICAgICAvLyB0aGUgaGFyZCBjYXAgb2YgMjAwJS5cbiAgICAgIGNvbnN0IG1pblpvb20gPSBNYXRoLm1heChnYXBXaWR0aCAvIG1pZEdhcCAqIDUsIDAuMDUpXG4gICAgICB0aGlzLnpvb21MZXZlbCA9IE1hdGgubWluKG1pblpvb20sIDIpXG4gICAgfVxuICAgIHRoaXMuZHJhdygpXG4gIH1cblxuICAvKlxuICAgKiByZW5kZXIgZHJhd3MgdGhlIGNoYXJ0LlxuICAgKiAxLiBDYWxjdWxhdGUgdGhlIGRhdGEgZXh0ZW50cyBhbmQgdHJhbnNsYXRlIHRoZSBvcmRlciBib29rIGRhdGEgdG8gYVxuICAgKiAgICBjdW11bGF0aXZlIGZvcm0uXG4gICAqIDIuIERyYXcgYXhpcyB0aWNrcyBhbmQgZ3JpZCwgbWlkLWdhcCBsaW5lIGFuZCB2YWx1ZSwgem9vbSBidXR0b25zLCBtb3VzZVxuICAgKiAgICBwb3NpdGlvbiBpbmRpY2F0b3IuLi5cbiAgICogNC4gVGljayBsYWJlbHMuXG4gICAqIDUuIERhdGEuXG4gICAqIDYuIEVwb2NoIGxpbmUgbGVnZW5kLlxuICAgKiA3LiBIb3ZlciBsZWdlbmQuXG4gICAqL1xuICByZW5kZXIgKCkge1xuICAgIC8vIGlmIGNvbm5lY3Rpb24gZmFpbHMgaXQgaXMgbm90IHBvc3NpYmxlIHRvIGdldCBib29rLlxuICAgIGlmICghdGhpcy5ib29rIHx8ICF0aGlzLnZpc2libGUgfHwgdGhpcy5jYW52YXMud2lkdGggPT09IDApIHtcbiAgICAgIHRoaXMucmVuZGVyU2NoZWR1bGVkID0gdHJ1ZVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5jbGVhcigpXG4gICAgLy8gaWYgKCF0aGlzLmJvb2sgfHwgdGhpcy5ib29rLmVtcHR5KCkpIHJldHVyblxuICAgIGNvbnN0IGN0eCA9IHRoaXMuY3R4XG4gICAgY29uc3QgbW91c2VQb3MgPSB0aGlzLm1vdXNlUG9zXG4gICAgY29uc3QgYnV5cyA9IHRoaXMuYm9vay5idXlzXG4gICAgY29uc3Qgc2VsbHMgPSB0aGlzLmJvb2suc2VsbHNcblxuICAgIGNvbnN0IFttaWRHYXAsIGdhcFdpZHRoXSA9IHRoaXMuZ2FwKClcblxuICAgIGNvbnN0IGhhbGZXaW5kb3cgPSB0aGlzLnpvb21MZXZlbCAqIG1pZEdhcCAvIDJcbiAgICBjb25zdCBoaWdoID0gbWlkR2FwICsgaGFsZldpbmRvd1xuICAgIGNvbnN0IGxvdyA9IG1pZEdhcCAtIGhhbGZXaW5kb3dcblxuICAgIC8vIEdldCBhIHNvcnRlZCBjb3B5IG9mIHRoZSBtYXJrZXJzIGxpc3QuXG4gICAgY29uc3QgYnV5TWFya2VycyA9IFsuLi50aGlzLm1hcmtlcnMuYnV5c11cbiAgICBjb25zdCBzZWxsTWFya2VycyA9IFsuLi50aGlzLm1hcmtlcnMuc2VsbHNdXG4gICAgYnV5TWFya2Vycy5zb3J0KChhLCBiKSA9PiBiLnJhdGUgLSBhLnJhdGUpXG4gICAgc2VsbE1hcmtlcnMuc29ydCgoYSwgYikgPT4gYS5yYXRlIC0gYi5yYXRlKVxuICAgIGNvbnN0IG1hcmtlcnM6IERlcHRoTWFya1tdID0gW11cblxuICAgIGNvbnN0IGJ1eURlcHRoOiBbbnVtYmVyLCBudW1iZXJdW10gPSBbXVxuICAgIGNvbnN0IGJ1eUVwb2NoOiBbbnVtYmVyLCBudW1iZXJdW10gPSBbXVxuICAgIGNvbnN0IHNlbGxEZXB0aDogW251bWJlciwgbnVtYmVyXVtdID0gW11cbiAgICBjb25zdCBzZWxsRXBvY2g6IFtudW1iZXIsIG51bWJlcl1bXSA9IFtdXG4gICAgY29uc3Qgdm9sdW1lUmVwb3J0ID0ge1xuICAgICAgYnV5QmFzZTogMCxcbiAgICAgIGJ1eVF1b3RlOiAwLFxuICAgICAgc2VsbEJhc2U6IDAsXG4gICAgICBzZWxsUXVvdGU6IDBcbiAgICB9XG4gICAgbGV0IHN1bSA9IDBcbiAgICAvLyBUaGUgZXBvY2ggbGluZSBpcyBhYm92ZSB0aGUgbm9uLWVwb2NoIHJlZ2lvbiwgc28gdGhlIGVwb2NoU3VtIHkgdmFsdWVcbiAgICAvLyBtdXN0IGFjY291bnQgZm9yIG5vbi1lcG9jaCBvcmRlcnMgdG9vLlxuICAgIGxldCBlcG9jaFN1bSA9IDBcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnV5cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgb3JkID0gYnV5c1tpXVxuICAgICAgZXBvY2hTdW0gKz0gb3JkLnF0eVxuICAgICAgaWYgKG9yZC5yYXRlID49IGxvdykgYnV5RXBvY2gucHVzaChbb3JkLnJhdGUsIGVwb2NoU3VtXSlcbiAgICAgIGlmIChvcmQuZXBvY2gpIGNvbnRpbnVlXG4gICAgICBzdW0gKz0gb3JkLnF0eVxuICAgICAgYnV5RGVwdGgucHVzaChbb3JkLnJhdGUsIHN1bV0pXG4gICAgICB2b2x1bWVSZXBvcnQuYnV5QmFzZSArPSBvcmQucXR5XG4gICAgICB2b2x1bWVSZXBvcnQuYnV5UXVvdGUgKz0gb3JkLnF0eSAqIG9yZC5yYXRlXG4gICAgICB3aGlsZSAoYnV5TWFya2Vycy5sZW5ndGggJiYgZmxvYXRDb21wYXJlKGJ1eU1hcmtlcnNbMF0ucmF0ZSwgb3JkLnJhdGUpKSB7XG4gICAgICAgIGNvbnN0IG1hcmsgPSBidXlNYXJrZXJzLnNoaWZ0KClcbiAgICAgICAgaWYgKCFtYXJrKSBjb250aW51ZVxuICAgICAgICBtYXJrZXJzLnB1c2goe1xuICAgICAgICAgIHJhdGU6IG1hcmsucmF0ZSxcbiAgICAgICAgICBxdHk6IG9yZC5lcG9jaCA/IGVwb2NoU3VtIDogc3VtLFxuICAgICAgICAgIHNlbGw6IG9yZC5zZWxsLFxuICAgICAgICAgIGFjdGl2ZTogbWFyay5hY3RpdmVcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgYnV5U3VtID0gYnV5RGVwdGgubGVuZ3RoID8gbGFzdChidXlEZXB0aClbMV0gOiAwXG4gICAgYnV5RGVwdGgucHVzaChbbG93LCBidXlTdW1dKVxuICAgIGNvbnN0IGVwb2NoQnV5U3VtID0gYnV5RXBvY2gubGVuZ3RoID8gbGFzdChidXlFcG9jaClbMV0gOiAwXG4gICAgYnV5RXBvY2gucHVzaChbbG93LCBlcG9jaEJ1eVN1bV0pXG5cbiAgICBlcG9jaFN1bSA9IHN1bSA9IDBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBvcmQgPSBzZWxsc1tpXVxuICAgICAgZXBvY2hTdW0gKz0gb3JkLnF0eVxuICAgICAgaWYgKG9yZC5yYXRlIDw9IGhpZ2gpIHNlbGxFcG9jaC5wdXNoKFtvcmQucmF0ZSwgZXBvY2hTdW1dKVxuICAgICAgaWYgKG9yZC5lcG9jaCkgY29udGludWVcbiAgICAgIHN1bSArPSBvcmQucXR5XG4gICAgICBzZWxsRGVwdGgucHVzaChbb3JkLnJhdGUsIHN1bV0pXG4gICAgICB2b2x1bWVSZXBvcnQuc2VsbEJhc2UgKz0gb3JkLnF0eVxuICAgICAgdm9sdW1lUmVwb3J0LnNlbGxRdW90ZSArPSBvcmQucXR5ICogb3JkLnJhdGVcbiAgICAgIHdoaWxlIChzZWxsTWFya2Vycy5sZW5ndGggJiYgZmxvYXRDb21wYXJlKHNlbGxNYXJrZXJzWzBdLnJhdGUsIG9yZC5yYXRlKSkge1xuICAgICAgICBjb25zdCBtYXJrID0gc2VsbE1hcmtlcnMuc2hpZnQoKVxuICAgICAgICBpZiAoIW1hcmspIGNvbnRpbnVlXG4gICAgICAgIG1hcmtlcnMucHVzaCh7XG4gICAgICAgICAgcmF0ZTogbWFyay5yYXRlLFxuICAgICAgICAgIHF0eTogb3JkLmVwb2NoID8gZXBvY2hTdW0gOiBzdW0sXG4gICAgICAgICAgc2VsbDogb3JkLnNlbGwsXG4gICAgICAgICAgYWN0aXZlOiBtYXJrLmFjdGl2ZVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgICAvLyBBZGQgYSBkYXRhIHBvaW50IGdvaW5nIHRvIHRoZSBsZWZ0IHNvIHRoYXQgdGhlIGRhdGEgZG9lc24ndCBlbmQgd2l0aCBhXG4gICAgLy8gdmVydGljYWwgbGluZS5cbiAgICBjb25zdCBzZWxsU3VtID0gc2VsbERlcHRoLmxlbmd0aCA/IGxhc3Qoc2VsbERlcHRoKVsxXSA6IDBcbiAgICBzZWxsRGVwdGgucHVzaChbaGlnaCwgc2VsbFN1bV0pXG4gICAgY29uc3QgZXBvY2hTZWxsU3VtID0gc2VsbEVwb2NoLmxlbmd0aCA/IGxhc3Qoc2VsbEVwb2NoKVsxXSA6IDBcbiAgICBzZWxsRXBvY2gucHVzaChbaGlnaCwgZXBvY2hTZWxsU3VtXSlcblxuICAgIC8vIEFkZCB+MzBweCBwYWRkaW5nIHRvIHRoZSB0b3Agb2YgdGhlIGNoYXJ0LlxuICAgIGNvbnN0IGggPSB0aGlzLnhSZWdpb24uZXh0ZW50cy55Lm1pblxuICAgIGNvbnN0IGdyb3d0aEZhY3RvciA9IChoICsgNDApIC8gaFxuICAgIGNvbnN0IG1heFkgPSAoZXBvY2hTZWxsU3VtICYmIGVwb2NoQnV5U3VtID8gTWF0aC5tYXgoZXBvY2hCdXlTdW0sIGVwb2NoU2VsbFN1bSkgOiBlcG9jaFNlbGxTdW0gfHwgZXBvY2hCdXlTdW0gfHwgMSkgKiBncm93dGhGYWN0b3JcblxuICAgIGNvbnN0IGRhdGFFeHRlbnRzID0gbmV3IEV4dGVudHMobG93LCBoaWdoLCAwLCBtYXhZKVxuICAgIHRoaXMuZGF0YUV4dGVudHMgPSBkYXRhRXh0ZW50c1xuXG4gICAgLy8gQSBmdW5jdGlvbiB0byBiZSBydW4gYXQgdGhlIGVuZCBpZiB0aGVyZSBpcyBsZWdlbmQgZGF0YSB0byBkaXNwbGF5LlxuICAgIGxldCBtb3VzZURhdGE6IE1vdXNlUmVwb3J0IHwgbnVsbCA9IG51bGxcblxuICAgIC8vIERyYXcgdGhlIGdyaWQuXG4gICAgY29uc3QgeExhYmVscyA9IG1ha2VMYWJlbHMoY3R4LCB0aGlzLnBsb3RSZWdpb24ud2lkdGgoKSwgZGF0YUV4dGVudHMueC5taW4sIGRhdGFFeHRlbnRzLngubWF4LCAxMDAsIHRoaXMuY29udmVudGlvbmFsUmF0ZVN0ZXAsICcnKVxuICAgIHRoaXMucGxvdFhHcmlkKHhMYWJlbHMsIGxvdywgaGlnaClcbiAgICBjb25zdCB5TGFiZWxzID0gdGhpcy5tYWtlWUxhYmVscyh0aGlzLnBsb3RSZWdpb24sIHRoaXMubG90U2l6ZSwgdGhpcy5iYXNlVW5pdClcbiAgICB0aGlzLnBsb3RZR3JpZCh0aGlzLnBsb3RSZWdpb24sIHlMYWJlbHMsIHRoaXMuZGF0YUV4dGVudHMueS5taW4sIHRoaXMuZGF0YUV4dGVudHMueS5tYXgpXG5cbiAgICB0aGlzLnBsb3RSZWdpb24ucGxvdChkYXRhRXh0ZW50cywgKGN0eCwgdG9vbHMpID0+IHtcbiAgICAgIGN0eC5saW5lV2lkdGggPSAxXG4gICAgICAvLyBmaXJzdCwgYSBzcXVhcmUgYXJvdW5kIHRoZSBwbG90IGFyZWEuXG4gICAgICBjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLnRoZW1lLmdyaWRCb3JkZXJcbiAgICAgIC8vIGRyYXcgYSBsaW5lIHRvIGluZGljYXRlIG1pZC1nYXBcbiAgICAgIGN0eC5saW5lV2lkdGggPSAyLjVcbiAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHRoaXMudGhlbWUuZ2FwTGluZVxuICAgICAgbGluZShjdHgsIHRvb2xzLngobWlkR2FwKSwgdG9vbHMueSgwKSwgdG9vbHMueChtaWRHYXApLCB0b29scy55KDAuMyAqIGRhdGFFeHRlbnRzLnkubWF4KSlcblxuICAgICAgY3R4LmZvbnQgPSAnMzBweCBcXCdkZW1pLXNhbnNcXCcsIHNhbnMtc2VyaWYnXG4gICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcidcbiAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJ1xuICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUudmFsdWVcbiAgICAgIGNvbnN0IHkgPSAwLjUgKiBkYXRhRXh0ZW50cy55Lm1heFxuICAgICAgY3R4LmZpbGxUZXh0KERvYy5mb3JtYXRGb3VyU2lnRmlncyhtaWRHYXApLCB0b29scy54KG1pZEdhcCksIHRvb2xzLnkoeSkpXG4gICAgICBjdHguZm9udCA9ICcxMnB4IFxcJ3NhbnNcXCcsIHNhbnMtc2VyaWYnXG4gICAgICAvLyBjdHguZmlsbFRleHQoJ21pZC1tYXJrZXQgcHJpY2UnLCB0b29scy54KG1pZEdhcCksIHRvb2xzLnkoeSkgKyAyNClcbiAgICAgIGN0eC5maWxsVGV4dChgJHsoZ2FwV2lkdGggLyBtaWRHYXAgKiAxMDApLnRvRml4ZWQoMil9JSBzcHJlYWRgLFxuICAgICAgICB0b29scy54KG1pZEdhcCksIHRvb2xzLnkoeSkgKyAyNClcblxuICAgICAgLy8gRHJhdyB6b29tIGJ1dHRvbnMuXG4gICAgICBjdHgudGV4dEFsaWduID0gJ2NlbnRlcidcbiAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSAnbWlkZGxlJ1xuICAgICAgY29uc3QgdG9wQ2VudGVyWCA9IHRoaXMucGxvdFJlZ2lvbi5leHRlbnRzLm1pZFhcbiAgICAgIGNvbnN0IHRvcENlbnRlclkgPSB0b29scy55KG1heFkgKiAwLjkpXG4gICAgICBjb25zdCB6b29tUGN0ID0gZGF0YUV4dGVudHMueFJhbmdlIC8gbWlkR2FwICogMTAwXG4gICAgICBjb25zdCB6b29tVGV4dCA9IGAke3pvb21QY3QudG9GaXhlZCgxKX0lYFxuICAgICAgY29uc3QgdyA9IGN0eC5tZWFzdXJlVGV4dCh6b29tVGV4dCkud2lkdGhcbiAgICAgIGN0eC5mb250ID0gJzEzcHggXFwnc2Fuc1xcJywgc2Fucy1zZXJpZidcbiAgICAgIGN0eC5maWxsVGV4dCh6b29tVGV4dCwgdG9wQ2VudGVyWCwgdG9wQ2VudGVyWSArIDEpXG4gICAgICAvLyBkZWZpbmUgdGhlIHJlZ2lvbiBmb3IgdGhlIHpvb20gYnV0dG9uXG4gICAgICBjb25zdCBidHRuU2l6ZSA9IDIwXG4gICAgICBjb25zdCB4UGFkID0gMTBcbiAgICAgIGxldCBidHRuTGVmdCA9IHRvcENlbnRlclggLSB3IC8gMiAtIHhQYWQgLSBidHRuU2l6ZVxuICAgICAgY29uc3QgYnR0blRvcCA9IHRvcENlbnRlclkgLSBidHRuU2l6ZSAvIDJcbiAgICAgIHRoaXMuem9vbU91dEJ0dG4uc2V0RXh0ZW50cyhcbiAgICAgICAgYnR0bkxlZnQsXG4gICAgICAgIGJ0dG5MZWZ0ICsgYnR0blNpemUsXG4gICAgICAgIGJ0dG5Ub3AsXG4gICAgICAgIGJ0dG5Ub3AgKyBidHRuU2l6ZVxuICAgICAgKVxuICAgICAgbGV0IGhvdmVyID0gbW91c2VQb3MgJiYgdGhpcy56b29tT3V0QnR0bi5jb250YWlucyhtb3VzZVBvcy54LCBtb3VzZVBvcy55KVxuICAgICAgdGhpcy56b29tT3V0QnR0bi5wbG90KG5ldyBFeHRlbnRzKDAsIDEsIDAsIDEpLCBjdHggPT4ge1xuICAgICAgICBjdHguZm9udCA9ICcxMnB4IFxcJ2ljb21vb25cXCcnXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLnpvb21cbiAgICAgICAgaWYgKGhvdmVyKSB7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuem9vbUhvdmVyXG4gICAgICAgICAgY3R4LmZvbnQgPSAnMTNweCBcXCdpY29tb29uXFwnJ1xuICAgICAgICB9XG4gICAgICAgIGN0eC5maWxsVGV4dChtaW51c0NoYXIsIHRoaXMuem9vbU91dEJ0dG4uZXh0ZW50cy5taWRYLCB0aGlzLnpvb21PdXRCdHRuLmV4dGVudHMubWlkWSlcbiAgICAgIH0pXG4gICAgICBidHRuTGVmdCA9IHRvcENlbnRlclggKyB3IC8gMiArIHhQYWRcbiAgICAgIHRoaXMuem9vbUluQnR0bi5zZXRFeHRlbnRzKFxuICAgICAgICBidHRuTGVmdCxcbiAgICAgICAgYnR0bkxlZnQgKyBidHRuU2l6ZSxcbiAgICAgICAgYnR0blRvcCxcbiAgICAgICAgYnR0blRvcCArIGJ0dG5TaXplXG4gICAgICApXG4gICAgICBob3ZlciA9IG1vdXNlUG9zICYmIHRoaXMuem9vbUluQnR0bi5jb250YWlucyhtb3VzZVBvcy54LCBtb3VzZVBvcy55KVxuICAgICAgdGhpcy56b29tSW5CdHRuLnBsb3QobmV3IEV4dGVudHMoMCwgMSwgMCwgMSksIGN0eCA9PiB7XG4gICAgICAgIGN0eC5mb250ID0gJzEycHggXFwnaWNvbW9vblxcJydcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuem9vbVxuICAgICAgICBpZiAoaG92ZXIpIHtcbiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZS56b29tSG92ZXJcbiAgICAgICAgICBjdHguZm9udCA9ICcxNHB4IFxcJ2ljb21vb25cXCcnXG4gICAgICAgIH1cbiAgICAgICAgY3R4LmZpbGxUZXh0KHBsdXNDaGFyLCB0aGlzLnpvb21JbkJ0dG4uZXh0ZW50cy5taWRYLCB0aGlzLnpvb21JbkJ0dG4uZXh0ZW50cy5taWRZKVxuICAgICAgfSlcblxuICAgICAgLy8gRHJhdyBhIGRvdHRlZCB2ZXJ0aWNhbCBsaW5lIHdoZXJlIHRoZSBtb3VzZSBpcywgYW5kIGEgZG90IGF0IHRoZSBsZXZlbFxuICAgICAgLy8gb2YgdGhlIGRlcHRoIGxpbmUuXG4gICAgICBjb25zdCBkcmF3TGluZSA9ICh4OiBudW1iZXIsIGNvbG9yOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKHggPiBoaWdoIHx8IHggPCBsb3cpIHJldHVyblxuICAgICAgICBjdHguc2F2ZSgpXG4gICAgICAgIGN0eC5zZXRMaW5lRGFzaChbMywgNV0pXG4gICAgICAgIGN0eC5saW5lV2lkdGggPSAxLjVcbiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gY29sb3JcbiAgICAgICAgbGluZShjdHgsIHRvb2xzLngoeCksIHRvb2xzLnkoMCksIHRvb2xzLngoeCksIHRvb2xzLnkobWF4WSkpXG4gICAgICAgIGN0eC5yZXN0b3JlKClcbiAgICAgIH1cblxuICAgICAgLy8gZm9yIChjb25zdCBsaW5lIG9mIHRoaXMubGluZXMgfHwgW10pIHtcbiAgICAgIC8vICAgZHJhd0xpbmUobGluZS5yYXRlLCBsaW5lLmNvbG9yKVxuICAgICAgLy8gfVxuXG4gICAgICBjb25zdCB0b2xlcmFuY2UgPSAoaGlnaCAtIGxvdykgKiAwLjAwNVxuICAgICAgY29uc3QgaG92ZXJNYXJrZXJzID0gW11cbiAgICAgIGZvciAoY29uc3QgbWFya2VyIG9mIG1hcmtlcnMgfHwgW10pIHtcbiAgICAgICAgY29uc3QgaG92ZXJlZCA9IChtb3VzZVBvcyAmJiB3aXRoaW5Ub2xlcmFuY2UobWFya2VyLnJhdGUsIHRvb2xzLnVueChtb3VzZVBvcy54KSwgdG9sZXJhbmNlKSlcbiAgICAgICAgaWYgKGhvdmVyZWQpIGhvdmVyTWFya2Vycy5wdXNoKG1hcmtlci5yYXRlKVxuICAgICAgICBjdHguc2F2ZSgpXG4gICAgICAgIGN0eC5saW5lV2lkdGggPSAoaG92ZXJlZCB8fCBtYXJrZXIuYWN0aXZlKSA/IDUgOiAzXG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IG1hcmtlci5zZWxsID8gdGhpcy50aGVtZS5zZWxsTGluZSA6IHRoaXMudGhlbWUuYnV5TGluZVxuICAgICAgICBjdHguZmlsbFN0eWxlID0gbWFya2VyLnNlbGwgPyB0aGlzLnRoZW1lLnNlbGxGaWxsIDogdGhpcy50aGVtZS5idXlGaWxsXG4gICAgICAgIGNvbnN0IHNpemUgPSAoaG92ZXJlZCB8fCBtYXJrZXIuYWN0aXZlKSA/IDEwIDogOFxuICAgICAgICBjdHguYmVnaW5QYXRoKClcbiAgICAgICAgY29uc3QgdGlwID0ge1xuICAgICAgICAgIHg6IHRvb2xzLngobWFya2VyLnJhdGUpLFxuICAgICAgICAgIHk6IHRvb2xzLnkobWFya2VyLnF0eSkgLSA4XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdG9wID0gdGlwLnkgLSAoTWF0aC5zcXJ0KDMpICogc2l6ZSAvIDIpIC8vIGNvcygzMClcbiAgICAgICAgY3R4Lm1vdmVUbyh0aXAueCwgdGlwLnkpXG4gICAgICAgIGN0eC5saW5lVG8odGlwLnggLSBzaXplIC8gMiwgdG9wKVxuICAgICAgICBjdHgubGluZVRvKHRpcC54ICsgc2l6ZSAvIDIsIHRvcClcbiAgICAgICAgY3R4LmNsb3NlUGF0aCgpXG4gICAgICAgIGN0eC5zdHJva2UoKVxuICAgICAgICBjdHguZmlsbCgpXG4gICAgICAgIGN0eC5yZXN0b3JlKClcbiAgICAgIH1cblxuICAgICAgLy8gSWYgdGhlIG1vdXNlIGlzIGluIHRoZSBjaGFydCBhcmVhLCBkcmF3IHRoZSBjcm9zc2hhaXJzLlxuICAgICAgaWYgKCFtb3VzZVBvcykgcmV0dXJuXG4gICAgICBpZiAoIXRoaXMucGxvdFJlZ2lvbi5jb250YWlucyhtb3VzZVBvcy54LCBtb3VzZVBvcy55KSkgcmV0dXJuXG4gICAgICAvLyBUaGUgbW91c2UgaXMgaW4gdGhlIHBsb3QgcmVnaW9uLiBHZXQgdGhlIGRhdGEgY29vcmRpbmF0ZXMgYW5kIGZpbmQgdGhlXG4gICAgICAvLyBzaWRlIGFuZCBkZXB0aCBmb3IgdGhlIHggdmFsdWUuXG4gICAgICBjb25zdCBkYXRhWCA9IHRvb2xzLnVueChtb3VzZVBvcy54KVxuICAgICAgbGV0IGV2YWxTaWRlID0gc2VsbERlcHRoXG4gICAgICBsZXQgdHJpZ2dlciA9IChwdFg6IG51bWJlcikgPT4gcHRYID49IGRhdGFYXG4gICAgICBsZXQgZG90Q29sb3IgPSB0aGlzLnRoZW1lLnNlbGxMaW5lXG4gICAgICBpZiAoZGF0YVggPCBtaWRHYXApIHtcbiAgICAgICAgZXZhbFNpZGUgPSBidXlEZXB0aFxuICAgICAgICB0cmlnZ2VyID0gKHB0WCkgPT4gcHRYIDw9IGRhdGFYXG4gICAgICAgIGRvdENvbG9yID0gdGhpcy50aGVtZS5idXlMaW5lXG4gICAgICB9XG4gICAgICBsZXQgYmVzdERlcHRoID0gZXZhbFNpZGVbMF1cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXZhbFNpZGUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgcHQgPSBldmFsU2lkZVtpXVxuICAgICAgICBpZiAodHJpZ2dlcihwdFswXSkpIGJyZWFrXG4gICAgICAgIGJlc3REZXB0aCA9IHB0XG4gICAgICB9XG4gICAgICBkcmF3TGluZShkYXRhWCwgdGhpcy50aGVtZS5jcm9zc2hhaXJzKVxuICAgICAgbW91c2VEYXRhID0ge1xuICAgICAgICByYXRlOiBkYXRhWCxcbiAgICAgICAgZGVwdGg6IGJlc3REZXB0aFsxXSxcbiAgICAgICAgZG90Q29sb3I6IGRvdENvbG9yLFxuICAgICAgICBob3Zlck1hcmtlcnM6IGhvdmVyTWFya2Vyc1xuICAgICAgfVxuICAgIH0pXG5cbiAgICAvLyBEcmF3IHRoZSBlcG9jaCBsaW5lc1xuICAgIGN0eC5saW5lV2lkdGggPSAxLjVcbiAgICBjdHguc2V0TGluZURhc2goWzMsIDNdKVxuICAgIC8vIGVwb2NoIHNlbGxzXG4gICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuc2VsbEZpbGxcbiAgICBjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLnRoZW1lLnNlbGxMaW5lXG4gICAgdGhpcy5kcmF3RGVwdGgoc2VsbEVwb2NoKVxuICAgIC8vIGVwb2NoIGJ1eXNcbiAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZS5idXlGaWxsXG4gICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5idXlMaW5lXG4gICAgdGhpcy5kcmF3RGVwdGgoYnV5RXBvY2gpXG5cbiAgICAvLyBEcmF3IHRoZSBib29rIGRlcHRoLlxuICAgIGN0eC5saW5lV2lkdGggPSAyLjVcbiAgICBjdHguc2V0TGluZURhc2goW10pXG4gICAgLy8gYm9vayBzZWxsc1xuICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLnRoZW1lLnNlbGxGaWxsXG4gICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5zZWxsTGluZVxuICAgIHRoaXMuZHJhd0RlcHRoKHNlbGxEZXB0aClcbiAgICAvLyBib29rIGJ1eXNcbiAgICBjdHguZmlsbFN0eWxlID0gdGhpcy50aGVtZS5idXlGaWxsXG4gICAgY3R4LnN0cm9rZVN0eWxlID0gdGhpcy50aGVtZS5idXlMaW5lXG4gICAgdGhpcy5kcmF3RGVwdGgoYnV5RGVwdGgpXG5cbiAgICB0aGlzLnBsb3RZTGFiZWxzKHlMYWJlbHMsIHRoaXMuZGF0YUV4dGVudHMueS5taW4sIHRoaXMuZGF0YUV4dGVudHMueS5tYXgsIHRoaXMuYmFzZVVuaXQpXG4gICAgdGhpcy5wbG90WExhYmVscyh4TGFiZWxzLCBsb3csIGhpZ2gsIFtgJHt0aGlzLnF1b3RlVW5pdH0vYCwgdGhpcy5iYXNlVW5pdF0pXG5cbiAgICAvLyBEaXNwbGF5IHRoZSBkb3QgYXQgdGhlIGludGVyc2VjdGlvbiBvZiB0aGUgbW91c2UgaG92ZXIgbGluZSBhbmQgdGhlIGRlcHRoXG4gICAgLy8gbGluZS4gVGhpcyBzaG91bGQgYmUgZHJhd24gYWZ0ZXIgdGhlIGRlcHRocy5cbiAgICBpZiAobW91c2VEYXRhKSB7XG4gICAgICB0aGlzLnBsb3RSZWdpb24ucGxvdChkYXRhRXh0ZW50cywgKGN0eCwgdG9vbHMpID0+IHtcbiAgICAgICAgaWYgKCFtb3VzZURhdGEpIHJldHVybiAvLyBGb3IgVHlwZVNjcmlwdC4gRHVoLlxuICAgICAgICBkb3QoY3R4LCB0b29scy54KG1vdXNlRGF0YS5yYXRlKSwgdG9vbHMueShtb3VzZURhdGEuZGVwdGgpLCBtb3VzZURhdGEuZG90Q29sb3IsIDUpXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIFJlcG9ydCB0aGUgYm9vayB2b2x1bWVzLlxuICAgIHRoaXMucmVwb3J0ZXJzLnZvbHVtZSh2b2x1bWVSZXBvcnQpXG4gICAgdGhpcy5yZXBvcnRlcnMubW91c2UobW91c2VEYXRhKVxuICB9XG5cbiAgLyogZHJhd0RlcHRoIGRyYXdzIGEgc2luZ2xlIHNpZGUncyBkZXB0aCBjaGFydCBkYXRhLiAqL1xuICBkcmF3RGVwdGggKGRlcHRoOiBbbnVtYmVyLCBudW1iZXJdW10pIHtcbiAgICBjb25zdCBmaXJzdFB0ID0gZGVwdGhbMF1cbiAgICBsZXQgeDogbnVtYmVyXG4gICAgdGhpcy5wbG90UmVnaW9uLnBsb3QodGhpcy5kYXRhRXh0ZW50cywgKGN0eCwgdG9vbHMpID0+IHtcbiAgICAgIGNvbnN0IHlaZXJvID0gdG9vbHMueSgwKVxuICAgICAgbGV0IHkgPSB0b29scy55KGZpcnN0UHRbMV0pXG4gICAgICBjdHguYmVnaW5QYXRoKClcbiAgICAgIGN0eC5tb3ZlVG8odG9vbHMueChmaXJzdFB0WzBdKSwgdG9vbHMueShmaXJzdFB0WzFdKSlcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGVwdGgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgLy8gU2V0IHgsIGJ1dCBkb24ndCBzZXQgeSB1bnRpbCB3ZSBkcmF3IHRoZSBob3Jpem9udGFsIGxpbmUuXG4gICAgICAgIHggPSB0b29scy54KGRlcHRoW2ldWzBdKVxuICAgICAgICBjdHgubGluZVRvKHgsIHkpXG4gICAgICAgIC8vIElmIHRoaXMgaXMgcGFzdCB0aGUgcmVuZGVyIGVkZ2UsIHF1aXQgZHJhd2luZy5cbiAgICAgICAgeSA9IHRvb2xzLnkoZGVwdGhbaV1bMV0pXG4gICAgICAgIGN0eC5saW5lVG8oeCwgeSlcbiAgICAgIH1cbiAgICAgIGN0eC5zdHJva2UoKVxuICAgICAgY3R4LmxpbmVUbyh4LCB5WmVybylcbiAgICAgIGN0eC5saW5lVG8odG9vbHMueChmaXJzdFB0WzBdKSwgeVplcm8pXG4gICAgICBjdHguY2xvc2VQYXRoKClcbiAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuMjVcbiAgICAgIGN0eC5maWxsKClcbiAgICB9KVxuICB9XG5cbiAgLyogcmV0dXJucyB0aGUgbWlkLWdhcCByYXRlIGFuZCBnYXAgd2lkdGggYXMgYSB0dXBsZS4gKi9cbiAgZ2FwICgpIHtcbiAgICBjb25zdCBbYiwgc10gPSBbdGhpcy5ib29rLmJlc3RHYXBCdXkoKSwgdGhpcy5ib29rLmJlc3RHYXBTZWxsKCldXG4gICAgaWYgKCFiKSB7XG4gICAgICBpZiAoIXMpIHJldHVybiBbMSwgMF1cbiAgICAgIHJldHVybiBbcy5yYXRlLCAwXVxuICAgIH0gZWxzZSBpZiAoIXMpIHJldHVybiBbYi5yYXRlLCAwXVxuICAgIHJldHVybiBbKHMucmF0ZSArIGIucmF0ZSkgLyAyLCBzLnJhdGUgLSBiLnJhdGVdXG4gIH1cblxuICAvKiBzZXRMaW5lcyBzdG9yZXMgdGhlIGluZGljYXRvciBsaW5lcyB0byBkcmF3LiAqL1xuICBzZXRMaW5lcyAobGluZXM6IERlcHRoTGluZVtdKSB7XG4gICAgdGhpcy5saW5lcyA9IGxpbmVzXG4gIH1cblxuICAvKiBzZXRNYXJrZXJzIHNldHMgdGhlIGluZGljYXRvciBtYXJrZXJzIHRvIGRyYXcuICovXG4gIHNldE1hcmtlcnMgKG1hcmtlcnM6IFJlY29yZDxzdHJpbmcsIERlcHRoTWFya2VyW10+KSB7XG4gICAgdGhpcy5tYXJrZXJzID0gbWFya2Vyc1xuICB9XG59XG5cbi8qIENhbmRsZUNoYXJ0IGlzIGEgY2FuZGxlc3RpY2sgZGF0YSByZW5kZXJlci4gKi9cbmV4cG9ydCBjbGFzcyBDYW5kbGVDaGFydCBleHRlbmRzIENoYXJ0IHtcbiAgcmVwb3J0ZXJzOiBDYW5kbGVSZXBvcnRlcnNcbiAgZGF0YTogQ2FuZGxlc1BheWxvYWRcbiAgem9vbUxldmVsOiBudW1iZXJcbiAgbnVtVG9TaG93OiBudW1iZXJcbiAgY2FuZGxlUmVnaW9uOiBSZWdpb25cbiAgdm9sdW1lUmVnaW9uOiBSZWdpb25cbiAgcmVzaXplVGltZXI6IG51bWJlclxuICB6b29tTGV2ZWxzOiBudW1iZXJbXVxuICBtYXJrZXQ6IE1hcmtldFxuICByYXRlQ29udmVyc2lvbkZhY3RvcjogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IgKHBhcmVudDogSFRNTEVsZW1lbnQsIHJlcG9ydGVyczogQ2FuZGxlUmVwb3J0ZXJzKSB7XG4gICAgc3VwZXIocGFyZW50LCB7XG4gICAgICByZXNpemU6ICgpID0+IHRoaXMucmVzaXplZCgpLFxuICAgICAgY2xpY2s6ICgvKiBlOiBNb3VzZUV2ZW50ICovKSA9PiB7IHRoaXMuY2xpY2tlZCgpIH0sXG4gICAgICB6b29tOiAoYmlnZ2VyOiBib29sZWFuKSA9PiB0aGlzLnpvb21lZChiaWdnZXIpXG4gICAgfSlcbiAgICB0aGlzLnJlcG9ydGVycyA9IHJlcG9ydGVyc1xuICAgIHRoaXMuem9vbUxldmVsID0gMVxuICAgIHRoaXMubnVtVG9TaG93ID0gMTAwXG4gICAgdGhpcy5yZXNpemUoKVxuICB9XG5cbiAgLyogcmVzaXplZCBpcyBjYWxsZWQgd2hlbiB0aGUgd2luZG93IG9yIHBhcmVudCBlbGVtZW50IGFyZSByZXNpemVkLiAqL1xuICByZXNpemVkICgpIHtcbiAgICBjb25zdCBleHQgPSB0aGlzLnBsb3RSZWdpb24uZXh0ZW50c1xuICAgIGNvbnN0IGNhbmRsZUV4dGVudHMgPSBuZXcgRXh0ZW50cyhleHQueC5taW4sIGV4dC54Lm1heCwgZXh0LnkubWluLCBleHQueS5taW4gKyBleHQueVJhbmdlICogMC44NSlcbiAgICB0aGlzLmNhbmRsZVJlZ2lvbiA9IG5ldyBSZWdpb24odGhpcy5jdHgsIGNhbmRsZUV4dGVudHMpXG4gICAgY29uc3Qgdm9sdW1lRXh0ZW50cyA9IG5ldyBFeHRlbnRzKGV4dC54Lm1pbiwgZXh0LngubWF4LCBleHQueS5taW4gKyAwLjg1ICogZXh0LnlSYW5nZSwgZXh0LnkubWF4KVxuICAgIHRoaXMudm9sdW1lUmVnaW9uID0gbmV3IFJlZ2lvbih0aGlzLmN0eCwgdm9sdW1lRXh0ZW50cylcbiAgICAvLyBTZXQgYSBkZWxheSBvbiB0aGUgcmVuZGVyIHRvIHByZXZlbnQgbGFnLlxuICAgIGlmICh0aGlzLnJlc2l6ZVRpbWVyKSBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVUaW1lcilcbiAgICB0aGlzLnJlc2l6ZVRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5kcmF3KCksIDEwMClcbiAgfVxuXG4gIGNsaWNrZWQgKC8qIGU6IE1vdXNlRXZlbnQgKi8pIHtcbiAgICAvLyBoYW5kbGUgY2xpY2tzXG4gIH1cblxuICAvKiB6b29tZWQgem9vbXMgdGhlIGN1cnJlbnQgdmlldyBpbiBvciBvdXQuIGJpZ2dlcj10cnVlIGlzIHpvb20gaW4uICovXG4gIHpvb21lZCAoYmlnZ2VyOiBib29sZWFuKSB7XG4gICAgLy8gYmlnZ2VyIGFjdHVhbGx5IG1lYW5zIGZld2VyIGNhbmRsZXMgLT4gcmVkdWNlIHpvb21MZXZlbHMgaW5kZXguXG4gICAgY29uc3QgaWR4ID0gdGhpcy56b29tTGV2ZWxzLmluZGV4T2YodGhpcy5udW1Ub1Nob3cpXG4gICAgaWYgKGJpZ2dlcikge1xuICAgICAgaWYgKGlkeCA9PT0gMCkgcmV0dXJuXG4gICAgICB0aGlzLm51bVRvU2hvdyA9IHRoaXMuem9vbUxldmVsc1tpZHggLSAxXVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy56b29tTGV2ZWxzLmxlbmd0aCA8PSBpZHggKyAxIHx8IHRoaXMubnVtVG9TaG93ID4gdGhpcy5kYXRhLmNhbmRsZXMubGVuZ3RoKSByZXR1cm5cbiAgICAgIHRoaXMubnVtVG9TaG93ID0gdGhpcy56b29tTGV2ZWxzW2lkeCArIDFdXG4gICAgfVxuICAgIHRoaXMuZHJhdygpXG4gIH1cblxuICAvKiByZW5kZXIgZHJhd3MgdGhlIGNoYXJ0ICovXG4gIHJlbmRlciAoKSB7XG4gICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YVxuICAgIGlmICghZGF0YSB8fCAhdGhpcy52aXNpYmxlIHx8IHRoaXMuY2FudmFzLndpZHRoID09PSAwKSB7XG4gICAgICB0aGlzLnJlbmRlclNjaGVkdWxlZCA9IHRydWVcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBjYW5kbGVXaWR0aCA9IGRhdGEubXNcbiAgICBjb25zdCBtb3VzZVBvcyA9IHRoaXMubW91c2VQb3NcbiAgICBjb25zdCBhbGxDYW5kbGVzID0gZGF0YS5jYW5kbGVzIHx8IFtdXG5cbiAgICBjb25zdCBuID0gTWF0aC5taW4odGhpcy5udW1Ub1Nob3csIGFsbENhbmRsZXMubGVuZ3RoKVxuICAgIGNvbnN0IGNhbmRsZXMgPSBhbGxDYW5kbGVzLnNsaWNlKGFsbENhbmRsZXMubGVuZ3RoIC0gbilcblxuICAgIHRoaXMuY2xlYXIoKVxuXG4gICAgLy8gSWYgdGhlcmUgYXJlIG5vIGNhbmRsZXMuIGp1c3QgZG9uJ3QgZHJhdyBhbnl0aGluZy5cbiAgICBpZiAobiA9PT0gMCkgcmV0dXJuXG5cbiAgICAvLyBwYWRkaW5nIGRlZmluaXRpb24gYW5kIHNvbWUgaGVscGVyIGZ1bmN0aW9ucyB0byBwYXJzZSBjYW5kbGVzLlxuICAgIGNvbnN0IGNhbmRsZVdpZHRoUGFkZGluZyA9IDAuMlxuICAgIGNvbnN0IHN0YXJ0ID0gKGM6IENhbmRsZSkgPT4gdHJ1bmNhdGUoYy5lbmRTdGFtcCwgY2FuZGxlV2lkdGgpXG4gICAgY29uc3QgZW5kID0gKGM6IENhbmRsZSkgPT4gc3RhcnQoYykgKyBjYW5kbGVXaWR0aFxuICAgIGNvbnN0IHBhZGRlZFN0YXJ0ID0gKGM6IENhbmRsZSkgPT4gc3RhcnQoYykgKyBjYW5kbGVXaWR0aFBhZGRpbmcgKiBjYW5kbGVXaWR0aFxuICAgIGNvbnN0IHBhZGRlZFdpZHRoID0gKDEgLSAyICogY2FuZGxlV2lkdGhQYWRkaW5nKSAqIGNhbmRsZVdpZHRoXG5cbiAgICBjb25zdCBmaXJzdCA9IGNhbmRsZXNbMF1cbiAgICBjb25zdCBsYXN0ID0gY2FuZGxlc1tuIC0gMV1cblxuICAgIGxldCBbaGlnaCwgbG93LCBoaWdoVm9sXSA9IFtmaXJzdC5oaWdoUmF0ZSwgZmlyc3QubG93UmF0ZSwgZmlyc3QubWF0Y2hWb2x1bWVdXG4gICAgZm9yIChjb25zdCBjIG9mIGNhbmRsZXMpIHtcbiAgICAgIGlmIChjLmhpZ2hSYXRlID4gaGlnaCkgaGlnaCA9IGMuaGlnaFJhdGVcbiAgICAgIGlmIChjLmxvd1JhdGUgPCBsb3cpIGxvdyA9IGMubG93UmF0ZVxuICAgICAgaWYgKGMubWF0Y2hWb2x1bWUgPiBoaWdoVm9sKSBoaWdoVm9sID0gYy5tYXRjaFZvbHVtZVxuICAgIH1cblxuICAgIGhpZ2ggKz0gKGhpZ2ggLSBsb3cpICogMC4xIC8vIGEgbGl0dGxlIHBhZGRpbmdcbiAgICBjb25zdCB4U3RhcnQgPSBzdGFydChmaXJzdClcbiAgICBsZXQgeEVuZCA9IGVuZChsYXN0KVxuICAgIHhFbmQgKz0gKHhFbmQgLSB4U3RhcnQpICogMC4wNSAvLyBhIGxpdHRsZSBwYWRkaW5nXG5cbiAgICAvLyBDYWxjdWxhdGUgZGF0YSBleHRlbnRzIGFuZCBzdG9yZSB0aGVtLiBUaGV5IGFyZSB1c2VkIHRvIGFwcGx5IGxhYmVscy5cbiAgICBjb25zdCByYXRlU3RlcCA9IHRoaXMubWFya2V0LnJhdGVzdGVwXG4gICAgY29uc3QgZGF0YUV4dGVudHMgPSBuZXcgRXh0ZW50cyh4U3RhcnQsIHhFbmQsIGxvdywgaGlnaClcbiAgICBpZiAobG93ID09PSBoaWdoKSB7XG4gICAgICAvLyBJZiB0aGVyZSBpcyBubyBwcmljZSBtb3ZlbWVudCBhdCBhbGwgaW4gdGhlIHdpbmRvdywgc2hvdyBhIGxpdHRsZSBtb3JlXG4gICAgICAvLyB0b3AgYW5kIGJvdHRvbSBzbyB0aGluZ3MgcmVuZGVyIG5pY2VseS5cbiAgICAgIGRhdGFFeHRlbnRzLnkubWluIC09IHJhdGVTdGVwXG4gICAgICBkYXRhRXh0ZW50cy55Lm1heCArPSByYXRlU3RlcFxuICAgIH1cbiAgICB0aGlzLmRhdGFFeHRlbnRzID0gZGF0YUV4dGVudHNcblxuICAgIGxldCBtb3VzZUNhbmRsZTogQ2FuZGxlIHwgbnVsbCA9IG51bGxcbiAgICBpZiAobW91c2VQb3MpIHtcbiAgICAgIHRoaXMucGxvdFJlZ2lvbi5wbG90KG5ldyBFeHRlbnRzKGRhdGFFeHRlbnRzLngubWluLCBkYXRhRXh0ZW50cy54Lm1heCwgMCwgMSksIChjdHgsIHRvb2xzKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkU3RhcnRTdGFtcCA9IHRydW5jYXRlKHRvb2xzLnVueChtb3VzZVBvcy54KSwgY2FuZGxlV2lkdGgpXG4gICAgICAgIGZvciAoY29uc3QgYyBvZiBjYW5kbGVzKSB7XG4gICAgICAgICAgaWYgKHN0YXJ0KGMpID09PSBzZWxlY3RlZFN0YXJ0U3RhbXApIHtcbiAgICAgICAgICAgIG1vdXNlQ2FuZGxlID0gY1xuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuZ3JpZExpbmVzXG4gICAgICAgICAgICBjdHguZmlsbFJlY3QodG9vbHMueChzdGFydChjKSksIHRvb2xzLnkoMCksIHRvb2xzLncoY2FuZGxlV2lkdGgpLCB0b29scy5oKDEpKVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gRHJhdyB0aGUgZ3JpZFxuICAgIGNvbnN0IHJGYWN0b3IgPSB0aGlzLnJhdGVDb252ZXJzaW9uRmFjdG9yXG4gICAgY29uc3QgYmFzZVVuaXQgPSBhcHAoKS5hc3NldHNbdGhpcy5tYXJrZXQuYmFzZWlkXT8udW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQgfHwgdGhpcy5tYXJrZXQuYmFzZXN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgY29uc3QgeExhYmVscyA9IG1ha2VDYW5kbGVUaW1lTGFiZWxzKGNhbmRsZXMsIGNhbmRsZVdpZHRoLCB0aGlzLnBsb3RSZWdpb24ud2lkdGgoKSwgMTAwKVxuICAgIHRoaXMucGxvdFhHcmlkKHhMYWJlbHMsIHhTdGFydCwgeEVuZClcbiAgICBjb25zdCB5TGFiZWxzID0gdGhpcy5tYWtlWUxhYmVscyh0aGlzLmNhbmRsZVJlZ2lvbiwgcmF0ZVN0ZXAsIGJhc2VVbml0LCB2ID0+IERvYy5mb3JtYXRGb3VyU2lnRmlncyh2IC8gckZhY3RvcikpXG4gICAgdGhpcy5wbG90WUdyaWQodGhpcy5jYW5kbGVSZWdpb24sIHlMYWJlbHMsIHRoaXMuZGF0YUV4dGVudHMueS5taW4sIHRoaXMuZGF0YUV4dGVudHMueS5tYXgpXG5cbiAgICAvLyBEcmF3IHRoZSB2b2x1bWUgYmFycy5cbiAgICBjb25zdCB2b2xEYXRhRXh0ZW50cyA9IG5ldyBFeHRlbnRzKHhTdGFydCwgeEVuZCwgMCwgaGlnaFZvbClcbiAgICB0aGlzLnZvbHVtZVJlZ2lvbi5wbG90KHZvbERhdGFFeHRlbnRzLCAoY3R4LCB0b29scykgPT4ge1xuICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUuZ3JpZEJvcmRlclxuICAgICAgZm9yIChjb25zdCBjIG9mIGNhbmRsZXMpIHtcbiAgICAgICAgY3R4LmZpbGxSZWN0KHRvb2xzLngocGFkZGVkU3RhcnQoYykpLCB0b29scy55KDApLCB0b29scy53KHBhZGRlZFdpZHRoKSwgdG9vbHMuaChjLm1hdGNoVm9sdW1lKSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gRHJhdyB0aGUgY2FuZGxlcy5cbiAgICB0aGlzLmNhbmRsZVJlZ2lvbi5wbG90KGRhdGFFeHRlbnRzLCAoY3R4LCB0b29scykgPT4ge1xuICAgICAgY3R4LmxpbmVXaWR0aCA9IDFcbiAgICAgIGZvciAoY29uc3QgYyBvZiBjYW5kbGVzKSB7XG4gICAgICAgIGNvbnN0IGRlc2MgPSBjLnN0YXJ0UmF0ZSA+IGMuZW5kUmF0ZVxuICAgICAgICBjb25zdCBbeCwgeSwgdywgaF0gPSBbdG9vbHMueChwYWRkZWRTdGFydChjKSksIHRvb2xzLnkoYy5zdGFydFJhdGUpLCB0b29scy53KHBhZGRlZFdpZHRoKSwgdG9vbHMuaChjLmVuZFJhdGUgLSBjLnN0YXJ0UmF0ZSldXG4gICAgICAgIGNvbnN0IFtoaWdoLCBsb3csIGN4XSA9IFt0b29scy55KGMuaGlnaFJhdGUpLCB0b29scy55KGMubG93UmF0ZSksIHcgLyAyICsgeF1cbiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gZGVzYyA/IHRoaXMudGhlbWUuc2VsbExpbmUgOiB0aGlzLnRoZW1lLmJ1eUxpbmVcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGRlc2MgPyB0aGlzLnRoZW1lLnNlbGxGaWxsIDogdGhpcy50aGVtZS5idXlGaWxsXG5cbiAgICAgICAgY3R4LmJlZ2luUGF0aCgpXG4gICAgICAgIGN0eC5tb3ZlVG8oY3gsIGhpZ2gpXG4gICAgICAgIGN0eC5saW5lVG8oY3gsIGxvdylcbiAgICAgICAgY3R4LnN0cm9rZSgpXG5cbiAgICAgICAgY3R4LmZpbGxSZWN0KHgsIHksIHcsIGgpXG4gICAgICAgIGN0eC5zdHJva2VSZWN0KHgsIHksIHcsIGgpXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIEFwcGx5IGxhYmVscy5cbiAgICB0aGlzLnBsb3RYTGFiZWxzKHhMYWJlbHMsIHhTdGFydCwgeEVuZCwgW10pXG4gICAgdGhpcy5wbG90WUxhYmVscyh5TGFiZWxzLCB0aGlzLmRhdGFFeHRlbnRzLnkubWluLCB0aGlzLmRhdGFFeHRlbnRzLnkubWF4LCBiYXNlVW5pdClcblxuICAgIC8vIEhpZ2hsaWdodCB0aGUgY2FuZGxlIGlmIHRoZSB1c2VyIG1vdXNlIGlzIG92ZXIgdGhlIGNhbnZhcy5cbiAgICBpZiAobW91c2VDYW5kbGUpIHtcbiAgICAgIGNvbnN0IHlFeHQgPSB0aGlzLnhSZWdpb24uZXh0ZW50cy55XG4gICAgICB0aGlzLnhSZWdpb24ucGxvdChuZXcgRXh0ZW50cyhkYXRhRXh0ZW50cy54Lm1pbiwgZGF0YUV4dGVudHMueC5tYXgsIHlFeHQubWluLCB5RXh0Lm1heCksIChjdHgsIHRvb2xzKSA9PiB7XG4gICAgICAgIGlmICghbW91c2VDYW5kbGUpIHJldHVybiAvLyBGb3IgVHlwZVNjcmlwdC4gRHVoLlxuICAgICAgICB0aGlzLmFwcGx5TGFiZWxTdHlsZSgpXG4gICAgICAgIGNvbnN0IHJhbmdlVHh0ID0gYCR7bmV3IERhdGUoc3RhcnQobW91c2VDYW5kbGUpKS50b0xvY2FsZVN0cmluZygpfSAtICR7bmV3IERhdGUoZW5kKG1vdXNlQ2FuZGxlKSkudG9Mb2NhbGVTdHJpbmcoKX1gXG4gICAgICAgIGNvbnN0IFt4UGFkLCB5UGFkXSA9IFsyNSwgMl1cbiAgICAgICAgY29uc3QgcmFuZ2VXaWR0aCA9IGN0eC5tZWFzdXJlVGV4dChyYW5nZVR4dCkud2lkdGggKyAyICogeFBhZFxuICAgICAgICBjb25zdCByYW5nZUhlaWdodCA9IDE2XG4gICAgICAgIGxldCBjZW50ZXJYID0gdG9vbHMueCgoc3RhcnQobW91c2VDYW5kbGUpICsgZW5kKG1vdXNlQ2FuZGxlKSkgLyAyKVxuICAgICAgICBsZXQgbGVmdCA9IGNlbnRlclggLSByYW5nZVdpZHRoIC8gMlxuICAgICAgICBjb25zdCB4RXh0ID0gdGhpcy54UmVnaW9uLmV4dGVudHMueFxuICAgICAgICBpZiAobGVmdCA8IHhFeHQubWluKSBsZWZ0ID0geEV4dC5taW5cbiAgICAgICAgZWxzZSBpZiAobGVmdCArIHJhbmdlV2lkdGggPiB4RXh0Lm1heCkgbGVmdCA9IHhFeHQubWF4IC0gcmFuZ2VXaWR0aFxuICAgICAgICBjZW50ZXJYID0gbGVmdCArIHJhbmdlV2lkdGggLyAyXG4gICAgICAgIGNvbnN0IHRvcCA9IHlFeHQubWluICsgKHRoaXMueFJlZ2lvbi5oZWlnaHQoKSAtIHJhbmdlSGVpZ2h0KSAvIDJcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMudGhlbWUubGVnZW5kRmlsbFxuICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSB0aGlzLnRoZW1lLmdyaWRCb3JkZXJcbiAgICAgICAgY29uc3QgcmVjdEFyZ3M6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJdID0gW2xlZnQgLSB4UGFkLCB0b3AgLSB5UGFkLCByYW5nZVdpZHRoICsgMiAqIHhQYWQsIHJhbmdlSGVpZ2h0ICsgMiAqIHlQYWRdXG4gICAgICAgIGN0eC5maWxsUmVjdCguLi5yZWN0QXJncylcbiAgICAgICAgY3R4LnN0cm9rZVJlY3QoLi4ucmVjdEFyZ3MpXG4gICAgICAgIHRoaXMuYXBwbHlMYWJlbFN0eWxlKClcbiAgICAgICAgY3R4LmZpbGxUZXh0KHJhbmdlVHh0LCBjZW50ZXJYLCB0aGlzLnhSZWdpb24uZXh0ZW50cy5taWRZLCByYW5nZVdpZHRoKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBSZXBvcnQgdGhlIG1vdXNlIGNhbmRsZS5cbiAgICB0aGlzLnJlcG9ydGVycy5tb3VzZShtb3VzZUNhbmRsZSlcbiAgfVxuXG4gIC8qIHNldENhbmRsZXMgc2V0cyB0aGUgY2FuZGxlIGRhdGEgYW5kIHJlZHJhd3MgdGhlIGNoYXJ0LiAqL1xuICBzZXRDYW5kbGVzIChkYXRhOiBDYW5kbGVzUGF5bG9hZCwgbWFya2V0OiBNYXJrZXQsIGJhc2VVbml0SW5mbzogVW5pdEluZm8sIHF1b3RlVW5pdEluZm86IFVuaXRJbmZvKSB7XG4gICAgdGhpcy5kYXRhID0gZGF0YVxuICAgIGlmICghZGF0YS5jYW5kbGVzKSByZXR1cm5cbiAgICB0aGlzLm1hcmtldCA9IG1hcmtldFxuICAgIGNvbnN0IFtxRmFjdG9yLCBiRmFjdG9yXSA9IFtxdW90ZVVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yLCBiYXNlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JdXG4gICAgdGhpcy5yYXRlQ29udmVyc2lvbkZhY3RvciA9IFJhdGVFbmNvZGluZ0ZhY3RvciAqIHFGYWN0b3IgLyBiRmFjdG9yXG4gICAgbGV0IG4gPSAyNVxuICAgIHRoaXMuem9vbUxldmVscyA9IFtdXG4gICAgY29uc3QgbWF4Q2FuZGxlcyA9IE1hdGgubWF4KGRhdGEuY2FuZGxlcy5sZW5ndGgsIDEwMDApXG4gICAgd2hpbGUgKG4gPCBtYXhDYW5kbGVzKSB7XG4gICAgICB0aGlzLnpvb21MZXZlbHMucHVzaChuKVxuICAgICAgbiAqPSAyXG4gICAgfVxuICAgIHRoaXMubnVtVG9TaG93ID0gMTAwXG4gICAgdGhpcy5kcmF3KClcbiAgfVxufVxuXG5pbnRlcmZhY2UgV2F2ZU9wdHMge1xuICBtZXNzYWdlPzogc3RyaW5nXG4gIGJhY2tncm91bmRDb2xvcj86IHN0cmluZyB8IGJvb2xlYW4gLy8gdHJ1ZSBmb3IgPGJvZHk+IGJhY2tncm91bmQgY29sb3Jcbn1cblxuLyogV2F2ZSBpcyBhIGxvYWRpbmcgYW5pbWF0aW9uIHRoYXQgZGlzcGxheXMgYSBjb2xvcmZ1bCBsaW5lIHRoYXQgb3NjaWxsYXRlcyAqL1xuZXhwb3J0IGNsYXNzIFdhdmUgZXh0ZW5kcyBDaGFydCB7XG4gIGFuaTogQW5pbWF0aW9uXG4gIHNpemU6IFtudW1iZXIsIG51bWJlcl1cbiAgcmVnaW9uOiBSZWdpb25cbiAgY29sb3JTaGlmdDogbnVtYmVyXG4gIG9wdHM6IFdhdmVPcHRzXG4gIG1zZ1JlZ2lvbjogUmVnaW9uXG4gIGZvbnRTaXplOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAocGFyZW50OiBIVE1MRWxlbWVudCwgb3B0cz86IFdhdmVPcHRzKSB7XG4gICAgc3VwZXIocGFyZW50LCB7XG4gICAgICByZXNpemU6ICgpID0+IHRoaXMucmVzaXplZCgpLFxuICAgICAgY2xpY2s6ICgvKiBlOiBNb3VzZUV2ZW50ICovKSA9PiB7IC8qIHBhc3MgKi8gfSxcbiAgICAgIHpvb206ICgvKiBiaWdnZXI6IGJvb2xlYW4gKi8pID0+IHsgLyogcGFzcyAqLyB9XG4gICAgfSlcbiAgICB0aGlzLmNhbnZhcy5jbGFzc0xpc3QuYWRkKCdmaWxsLWFicycpXG4gICAgdGhpcy5jYW52YXMuc3R5bGUuekluZGV4ID0gJzUnXG5cbiAgICB0aGlzLm9wdHMgPSBvcHRzID8/IHt9XG5cbiAgICBjb25zdCBwZXJpb2QgPSAxNTAwIC8vIG1zXG4gICAgY29uc3Qgc3RhcnQgPSBNYXRoLnJhbmRvbSgpICogcGVyaW9kXG4gICAgdGhpcy5jb2xvclNoaWZ0ID0gTWF0aC5yYW5kb20oKSAqIDM2MFxuXG4gICAgLy8geSA9IEEqY29zKGsqeCArIHRoZXRhKnQgKyBjKVxuICAgIC8vIGNvbWJpbmUgdGhyZWUgd2F2ZXMgd2l0aCBkaWZmZXJlbnQgcGVyaW9kcyBhbmQgc3BlZWRzIGFuZCBwaGFzZXMuXG4gICAgY29uc3QgYW1wbGl0dWRlcyA9IFsxLCAwLjY1LCAwLjc1XVxuICAgIGNvbnN0IGtzID0gWzMsIDMsIDJdXG4gICAgY29uc3Qgc3BlZWRzID0gW01hdGguUEksIE1hdGguUEkgKiAxMCAvIDksIE1hdGguUEkgLyAyLjVdXG4gICAgY29uc3QgcGhhc2VzID0gWzAsIDAsIE1hdGguUEkgKiAxLjVdXG4gICAgY29uc3QgbiA9IDc1XG4gICAgY29uc3Qgc2luZ2xlID0gKG46IG51bWJlciwgYW5ndWxhclg6IG51bWJlciwgYW5ndWxhclRpbWU6IG51bWJlcik6IG51bWJlciA9PiB7XG4gICAgICByZXR1cm4gYW1wbGl0dWRlc1tuXSAqIE1hdGguY29zKGtzW25dICogYW5ndWxhclggKyBzcGVlZHNbbl0gKiBhbmd1bGFyVGltZSArIHBoYXNlc1tuXSlcbiAgICB9XG4gICAgY29uc3QgdmFsdWUgPSAoeDogbnVtYmVyLCBhbmd1bGFyVGltZTogbnVtYmVyKTogbnVtYmVyID0+IHtcbiAgICAgIGNvbnN0IGFuZ3VsYXJYID0geCAqIE1hdGguUEkgKiAyXG4gICAgICByZXR1cm4gKHNpbmdsZSgwLCBhbmd1bGFyWCwgYW5ndWxhclRpbWUpICsgc2luZ2xlKDEsIGFuZ3VsYXJYLCBhbmd1bGFyVGltZSkgKyBzaW5nbGUoMiwgYW5ndWxhclgsIGFuZ3VsYXJUaW1lKSkgLyAzXG4gICAgfVxuICAgIHRoaXMucmVzaXplKClcbiAgICB0aGlzLmFuaSA9IG5ldyBBbmltYXRpb24oQW5pbWF0aW9uLkZvcmV2ZXIsICgpID0+IHtcbiAgICAgIGNvbnN0IGFuZ3VsYXJUaW1lID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gc3RhcnQpIC8gcGVyaW9kICogTWF0aC5QSSAqIDJcbiAgICAgIGNvbnN0IHZhbHVlcyA9IFtdXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xuICAgICAgICB2YWx1ZXMucHVzaCh2YWx1ZShpIC8gKG4gLSAxKSwgYW5ndWxhclRpbWUpKVxuICAgICAgfVxuICAgICAgdGhpcy5kcmF3VmFsdWVzKHZhbHVlcylcbiAgICB9KVxuICB9XG5cbiAgcmVzaXplZCAoKSB7XG4gICAgY29uc3Qgb3B0cyA9IHRoaXMub3B0c1xuICAgIGNvbnN0IFttYXhXLCBtYXhIXSA9IFsxNTAsIDEwMF1cbiAgICBjb25zdCBbY3csIGNoXSA9IFt0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0XVxuICAgIGxldCBbdywgaF0gPSBbY3cgKiAwLjgsIGNoICogMC44XVxuICAgIGlmICh3ID4gbWF4VykgdyA9IG1heFdcbiAgICBpZiAoaCA+IG1heEgpIGggPSBtYXhIXG4gICAgbGV0IFtsLCB0XSA9IFsoY3cgLSB3KSAvIDIsIChjaCAtIGgpIC8gMl1cbiAgICBpZiAob3B0cy5tZXNzYWdlKSB7XG4gICAgICB0aGlzLmZvbnRTaXplID0gY2xhbXAoaCAqIDAuMTUsIDEwLCAxNClcbiAgICAgIHRoaXMuYXBwbHlMYWJlbFN0eWxlKHRoaXMuZm9udFNpemUpXG4gICAgICBjb25zdCB5cGFkID0gdGhpcy5mb250U2l6ZSAqIDAuNVxuICAgICAgY29uc3QgaGFsZkggPSAodGhpcy5mb250U2l6ZSAvIDIpICsgeXBhZFxuICAgICAgdCAtPSBoYWxmSFxuICAgICAgdGhpcy5tc2dSZWdpb24gPSBuZXcgUmVnaW9uKHRoaXMuY3R4LCBuZXcgRXh0ZW50cygwLCBjdywgdCArIGgsIHQgKyBoICsgMiAqIGhhbGZIKSlcbiAgICB9XG4gICAgdGhpcy5yZWdpb24gPSBuZXcgUmVnaW9uKHRoaXMuY3R4LCBuZXcgRXh0ZW50cyhsLCBsICsgdywgdCwgdCArIGgpKVxuICB9XG5cbiAgZHJhd1ZhbHVlcyAodmFsdWVzOiBudW1iZXJbXSkge1xuICAgIGlmICghdGhpcy5yZWdpb24pIHJldHVyblxuICAgIHRoaXMuY2xlYXIoKVxuICAgIGNvbnN0IGhzbCA9IChoOiBudW1iZXIpID0+IGBoc2woJHtofSwgMzUlLCA1MCUpYFxuXG4gICAgY29uc3QgeyByZWdpb24sIG1zZ1JlZ2lvbiwgY2FudmFzOiB7IHdpZHRoOiB3LCBoZWlnaHQ6IGggfSwgb3B0czogeyBiYWNrZ3JvdW5kQ29sb3I6IGJnLCBtZXNzYWdlOiBtc2cgfSwgY29sb3JTaGlmdCwgY3R4IH0gPSB0aGlzXG5cbiAgICBpZiAoYmcpIHtcbiAgICAgIGlmIChiZyA9PT0gdHJ1ZSkgY3R4LmZpbGxTdHlsZSA9IFN0YXRlLmlzRGFyaygpID8gJyMwYTFlMzQnIDogJyNmMGYwZjAnXG4gICAgICBlbHNlIGN0eC5maWxsU3R5bGUgPSBiZ1xuICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIHcsIGgpXG4gICAgfVxuXG4gICAgcmVnaW9uLnBsb3QobmV3IEV4dGVudHMoMCwgMSwgLTEsIDEpLCAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHQ6IFRyYW5zbGF0b3IpID0+IHtcbiAgICAgIGN0eC5saW5lV2lkdGggPSA0XG4gICAgICBjdHgubGluZUNhcCA9ICdyb3VuZCdcblxuICAgICAgY29uc3Qgc2hpZnQgPSBjb2xvclNoaWZ0ICsgKG5ldyBEYXRlKCkuZ2V0VGltZSgpICUgMjAwMCkgLyAyMDAwICogMzYwIC8vIGNvbG9ycyBtb3ZlIHdpdGggZnJlcXVlbmN5IDEgLyAyc1xuICAgICAgY29uc3QgZ3JhZCA9IGN0eC5jcmVhdGVMaW5lYXJHcmFkaWVudCh0LngoMCksIDAsIHQueCgxKSwgMClcbiAgICAgIGdyYWQuYWRkQ29sb3JTdG9wKDAsIGhzbChzaGlmdCkpXG4gICAgICBjdHguc3Ryb2tlU3R5bGUgPSBncmFkXG5cbiAgICAgIGN0eC5iZWdpblBhdGgoKVxuICAgICAgY3R4Lm1vdmVUbyh0LngoMCksIHQueSh2YWx1ZXNbMF0pKVxuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgcHJvZyA9IGkgLyAodmFsdWVzLmxlbmd0aCAtIDEpXG4gICAgICAgIGdyYWQuYWRkQ29sb3JTdG9wKHByb2csIGhzbChwcm9nICogMzAwICsgc2hpZnQpKVxuICAgICAgICBjdHgubGluZVRvKHQueChwcm9nKSwgdC55KHZhbHVlc1tpXSkpXG4gICAgICB9XG4gICAgICBjdHguc3Ryb2tlKClcbiAgICB9KVxuICAgIGlmICghbXNnKSByZXR1cm5cbiAgICBtc2dSZWdpb24ucGxvdChuZXcgRXh0ZW50cygwLCAxLCAwLCAxKSwgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0OiBUcmFuc2xhdG9yKSA9PiB7XG4gICAgICB0aGlzLmFwcGx5TGFiZWxTdHlsZSh0aGlzLmZvbnRTaXplKVxuICAgICAgY3R4LmZpbGxUZXh0KG1zZywgdC54KDAuNSksIHQueSgwLjUpLCB0aGlzLm1zZ1JlZ2lvbi53aWR0aCgpKVxuICAgIH0pXG4gIH1cblxuICByZW5kZXIgKCkgeyAvKiBwYXNzICovIH1cblxuICBzdG9wICgpIHtcbiAgICB0aGlzLmFuaS5zdG9wKClcbiAgICB0aGlzLmNhbnZhcy5yZW1vdmUoKVxuICB9XG59XG5cbi8qXG4gKiBFeHRlbnRzIGhvbGRzIGEgbWluIGFuZCBtYXggaW4gYm90aCB0aGUgeCBhbmQgeSBkaXJlY3Rpb25zLCBhbmQgcHJvdmlkZXNcbiAqIGdldHRlcnMgZm9yIHJlbGF0ZWQgZGF0YS5cbiAqL1xuZXhwb3J0IGNsYXNzIEV4dGVudHMge1xuICB4OiBNaW5NYXhcbiAgeTogTWluTWF4XG5cbiAgY29uc3RydWN0b3IgKHhNaW46IG51bWJlciwgeE1heDogbnVtYmVyLCB5TWluOiBudW1iZXIsIHlNYXg6IG51bWJlcikge1xuICAgIHRoaXMuc2V0RXh0ZW50cyh4TWluLCB4TWF4LCB5TWluLCB5TWF4KVxuICB9XG5cbiAgc2V0RXh0ZW50cyAoeE1pbjogbnVtYmVyLCB4TWF4OiBudW1iZXIsIHlNaW46IG51bWJlciwgeU1heDogbnVtYmVyKSB7XG4gICAgdGhpcy54ID0ge1xuICAgICAgbWluOiB4TWluLFxuICAgICAgbWF4OiB4TWF4XG4gICAgfVxuICAgIHRoaXMueSA9IHtcbiAgICAgIG1pbjogeU1pbixcbiAgICAgIG1heDogeU1heFxuICAgIH1cbiAgfVxuXG4gIGdldCB4UmFuZ2UgKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMueC5tYXggLSB0aGlzLngubWluXG4gIH1cblxuICBnZXQgbWlkWCAoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gKHRoaXMueC5tYXggKyB0aGlzLngubWluKSAvIDJcbiAgfVxuXG4gIGdldCB5UmFuZ2UgKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMueS5tYXggLSB0aGlzLnkubWluXG4gIH1cblxuICBnZXQgbWlkWSAoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gKHRoaXMueS5tYXggKyB0aGlzLnkubWluKSAvIDJcbiAgfVxufVxuXG4vKlxuICogUmVnaW9uIGFwcGxpZXMgYW4gRXh0ZW50cyB0byB0aGUgY2FudmFzLCBwcm92aWRpbmcgdXRpbGl0aWVzIGZvciBjb29yZGluYXRlXG4gKiB0cmFuc2Zvcm1hdGlvbnMgYW5kIHJlc3RyaWN0aW5nIGRyYXdpbmcgdG8gYSBzcGVjaWZpZWQgcmVnaW9uIG9mIHRoZSBjYW52YXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBSZWdpb24ge1xuICBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRcbiAgZXh0ZW50czogRXh0ZW50c1xuXG4gIGNvbnN0cnVjdG9yIChjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIGV4dGVudHM6IEV4dGVudHMpIHtcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0XG4gICAgdGhpcy5leHRlbnRzID0gZXh0ZW50c1xuICB9XG5cbiAgc2V0RXh0ZW50cyAoeE1pbjogbnVtYmVyLCB4TWF4OiBudW1iZXIsIHlNaW46IG51bWJlciwgeU1heDogbnVtYmVyKSB7XG4gICAgdGhpcy5leHRlbnRzLnNldEV4dGVudHMoeE1pbiwgeE1heCwgeU1pbiwgeU1heClcbiAgfVxuXG4gIHdpZHRoICgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmV4dGVudHMueFJhbmdlXG4gIH1cblxuICBoZWlnaHQgKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZXh0ZW50cy55UmFuZ2VcbiAgfVxuXG4gIGNvbnRhaW5zICh4OiBudW1iZXIsIHk6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGV4dCA9IHRoaXMuZXh0ZW50c1xuICAgIHJldHVybiAoeCA8IGV4dC54Lm1heCAmJiB4ID4gZXh0LngubWluICYmXG4gICAgICB5IDwgZXh0LnkubWF4ICYmIHkgPiBleHQueS5taW4pXG4gIH1cblxuICAvKlxuICAgKiBBIHRyYW5zbGF0b3IgcHJvdmlkZXMgNCBmdW5jdGlvbiBmb3IgY29vcmRpbmF0ZSB0cmFuc2Zvcm1hdGlvbnMuIHggYW5kIHlcbiAgICogdHJhbnNsYXRlIGRhdGEgY29vcmRpbmF0ZXMgdG8gY2FudmFzIGNvb3JkaW5hdGVzIGZvciB0aGUgc3BlY2lmaWVkIGRhdGFcbiAgICogRXh0ZW50cy4gdW54IGFuZCB1bnkgdHJhbnNsYXRlIGNhbnZhcyBjb29yZGluYXRlcyB0byBkYXRhIGNvb3JkaW5hdGVzLlxuICAgKi9cbiAgdHJhbnNsYXRvciAoZGF0YUV4dGVudHM6IEV4dGVudHMpOiBUcmFuc2xhdG9yIHtcbiAgICBjb25zdCByZWdpb24gPSB0aGlzLmV4dGVudHNcbiAgICBjb25zdCB4TWluID0gZGF0YUV4dGVudHMueC5taW5cbiAgICAvLyBjb25zdCB4TWF4ID0gZGF0YUV4dGVudHMueC5tYXhcbiAgICBjb25zdCB5TWluID0gZGF0YUV4dGVudHMueS5taW5cbiAgICAvLyBjb25zdCB5TWF4ID0gZGF0YUV4dGVudHMueS5tYXhcbiAgICBjb25zdCB5UmFuZ2UgPSBkYXRhRXh0ZW50cy55UmFuZ2VcbiAgICBjb25zdCB4UmFuZ2UgPSBkYXRhRXh0ZW50cy54UmFuZ2VcbiAgICBjb25zdCBzY3JlZW5NaW5YID0gcmVnaW9uLngubWluXG4gICAgY29uc3Qgc2NyZWVuVyA9IHJlZ2lvbi54Lm1heCAtIHNjcmVlbk1pblhcbiAgICBjb25zdCBzY3JlZW5NYXhZID0gcmVnaW9uLnkubWF4XG4gICAgY29uc3Qgc2NyZWVuSCA9IHNjcmVlbk1heFkgLSByZWdpb24ueS5taW5cbiAgICBjb25zdCB4RmFjdG9yID0gc2NyZWVuVyAvIHhSYW5nZVxuICAgIGNvbnN0IHlGYWN0b3IgPSBzY3JlZW5IIC8geVJhbmdlXG4gICAgcmV0dXJuIHtcbiAgICAgIHg6ICh4OiBudW1iZXIpID0+ICh4IC0geE1pbikgKiB4RmFjdG9yICsgc2NyZWVuTWluWCxcbiAgICAgIHk6ICh5OiBudW1iZXIpID0+IHNjcmVlbk1heFkgLSAoeSAtIHlNaW4pICogeUZhY3RvcixcbiAgICAgIHVueDogKHg6IG51bWJlcikgPT4gKHggLSBzY3JlZW5NaW5YKSAvIHhGYWN0b3IgKyB4TWluLFxuICAgICAgdW55OiAoeTogbnVtYmVyKSA9PiB5TWluIC0gKHkgLSBzY3JlZW5NYXhZKSAvIHlGYWN0b3IsXG4gICAgICB3OiAodzogbnVtYmVyKSA9PiB3IC8geFJhbmdlICogc2NyZWVuVyxcbiAgICAgIGg6IChoOiBudW1iZXIpID0+IC1oIC8geVJhbmdlICogc2NyZWVuSFxuICAgIH1cbiAgfVxuXG4gIC8qIGNsZWFyIGNsZWFycyB0aGUgcmVnaW9uLiAqL1xuICBjbGVhciAoKSB7XG4gICAgY29uc3QgZXh0ID0gdGhpcy5leHRlbnRzXG4gICAgdGhpcy5jb250ZXh0LmNsZWFyUmVjdChleHQueC5taW4sIGV4dC55Lm1pbiwgZXh0LnhSYW5nZSwgZXh0LnlSYW5nZSlcbiAgfVxuXG4gIC8qIHBsb3QgcHJlcGFyZXMgdG9vbHMgZm9yIGRyYXdpbmcgdXNpbmcgZGF0YSBjb29yZGluYXRlcy4gKi9cbiAgcGxvdCAoZGF0YUV4dGVudHM6IEV4dGVudHMsIGRyYXdGdW5jOiAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHRvb2xzOiBUcmFuc2xhdG9yKSA9PiB2b2lkLCBza2lwTWFzaz86IGJvb2xlYW4pIHtcbiAgICBjb25zdCBjdHggPSB0aGlzLmNvbnRleHRcbiAgICBjb25zdCByZWdpb24gPSB0aGlzLmV4dGVudHNcbiAgICBjdHguc2F2ZSgpIC8vIFNhdmUgdGhlIG9yaWdpbmFsIHN0YXRlXG4gICAgaWYgKCFza2lwTWFzaykge1xuICAgICAgY3R4LmJlZ2luUGF0aCgpXG4gICAgICBjdHgucmVjdChyZWdpb24ueC5taW4sIHJlZ2lvbi55Lm1pbiwgcmVnaW9uLnhSYW5nZSwgcmVnaW9uLnlSYW5nZSlcbiAgICAgIGN0eC5jbGlwKClcbiAgICB9XG5cbiAgICAvLyBUaGUgZHJhd0Z1bmMgd2lsbCBiZSBwYXNzZWQgYSBzZXQgb2YgdG9vbCB0aGF0IGNhbiBiZSB1c2VkIHRvIGFzc2lzdFxuICAgIC8vIGRyYXdpbmcuIFRoZSB0b29scyBzdGFydCB3aXRoIHRoZSB0cmFuc2Zvcm1hdGlvbiBmdW5jdGlvbnMuXG4gICAgY29uc3QgdG9vbHMgPSB0aGlzLnRyYW5zbGF0b3IoZGF0YUV4dGVudHMpXG5cbiAgICAvLyBDcmVhdGUgYSB0cmFuc2Zvcm1hdGlvbiB0aGF0IGFsbG93cyBkcmF3aW5nIGluIGRhdGEgY29vcmRpbmF0ZXMuIEl0J3NcbiAgICAvLyBub3QgYWR2aXNhYmxlIHRvIHN0cm9rZSBvciBhZGQgdGV4dCB3aXRoIHRoaXMgdHJhbnNmb3JtIGluIHBsYWNlLCBhcyB0aGVcbiAgICAvLyByZXN1bHQgd2lsbCBiZSBkaXN0b3J0ZWQuIFlvdSBjYW4gaG93ZXZlciB1c2UgY3R4Lm1vdmVUbyBhbmQgY3R4LmxpbmVUb1xuICAgIC8vIHdpdGggdGhpcyB0cmFuc2Zvcm0gaW4gcGxhY2UgdXNpbmcgZGF0YSBjb29yZGluYXRlcywgYW5kIHJlbW92ZSB0aGVcbiAgICAvLyB0cmFuc2Zvcm0gYmVmb3JlIHN0cm9raW5nLiBUaGUgZGF0YUNvb3JkcyBtZXRob2Qgb2YgdGhlIHN1cHBsaWVkIHRvb2xcbiAgICAvLyBwcm92aWRlcyB0aGlzIGZ1bmN0aW9uYWxpdHkuXG5cbiAgICAvLyBUT0RPOiBGaWd1cmUgb3V0IHdoeSB0aGlzIGRvZXNuJ3Qgd29yayBvbiBXZWJWaWV3LlxuICAgIC8vIGNvbnN0IHlSYW5nZSA9IGRhdGFFeHRlbnRzLnlSYW5nZVxuICAgIC8vIGNvbnN0IHhGYWN0b3IgPSByZWdpb24ueFJhbmdlIC8gZGF0YUV4dGVudHMueFJhbmdlXG4gICAgLy8gY29uc3QgeUZhY3RvciA9IHJlZ2lvbi55UmFuZ2UgLyB5UmFuZ2VcbiAgICAvLyBjb25zdCB4TWluID0gZGF0YUV4dGVudHMueC5taW5cbiAgICAvLyBjb25zdCB5TWluID0gZGF0YUV4dGVudHMueS5taW5cbiAgICAvLyAvLyBUaGVzZSB0cmFuc2xhdGlvbiBmYWN0b3JzIGFyZSBjb21wbGljYXRlZCBiZWNhdXNlIHRoZSAoMCwgMCkgb2YgdGhlXG4gICAgLy8gLy8gcmVnaW9uIGlzIG5vdCBuZWNlc3NhcmlseSB0aGUgKDAsIDApIG9mIHRoZSBjYW52YXMuXG4gICAgLy8gY29uc3QgdHggPSAocmVnaW9uLngubWluICsgeE1pbikgLSB4TWluICogeEZhY3RvclxuICAgIC8vIGNvbnN0IHR5ID0gLXJlZ2lvbi55Lm1pbiAtICh5UmFuZ2UgLSB5TWluKSAqIHlGYWN0b3JcbiAgICAvLyBjb25zdCBzZXRUcmFuc2Zvcm0gPSAoKSA9PiB7XG4gICAgLy8gICAvLyBEYXRhIGNvb3JkaW5hdGVzIGFyZSBmbGlwcGVkIGFib3V0IHkuIEZsaXAgdGhlIGNvb3JkaW5hdGVzIGFuZFxuICAgIC8vICAgLy8gdHJhbnNsYXRlIHRvcCBsZWZ0IGNvcm5lciB0byBjYW52YXMgKDAsIDApLlxuICAgIC8vICAgY3R4LnRyYW5zZm9ybSgxLCAwLCAwLCAtMSwgLXhNaW4sIHlNaW4pXG4gICAgLy8gICAvLyBTY2FsZSB0byBkYXRhIGNvb3JkaW5hdGVzIGFuZCBzaGlmdCBpbnRvIHBsYWNlIGZvciB0aGUgcmVnaW9uJ3Mgb2Zmc2V0XG4gICAgLy8gICAvLyBvbiB0aGUgY2FudmFzLlxuICAgIC8vICAgY3R4LnRyYW5zZm9ybSh4RmFjdG9yLCAwLCAwLCB5RmFjdG9yLCB0eCwgdHkpXG4gICAgLy8gfVxuICAgIC8vIC8vIGRhdGFDb29yZHMgYWxsb3dzIHNvbWUgZHJhd2luZyB0byBiZSBwZXJmb3JtZWQgZGlyZWN0bHkgaW4gZGF0YVxuICAgIC8vIC8vIGNvb3JkaW5hdGVzLiBNb3N0IGFjdHVhbCBkcmF3aW5nIGZ1bmN0aW9ucyBsaWtlIGN0eC5zdHJva2UgYW5kXG4gICAgLy8gLy8gY3R4LmZpbGxSZWN0IHNob3VsZCBub3QgYmUgY2FsbGVkIGZyb20gaW5zaWRlIGRhdGFDb29yZHMsIGJ1dFxuICAgIC8vIC8vIGN0eC5tb3ZlVG8gYW5kIGN0eC5MaW5lVG8gYXJlIGZpbmUuXG4gICAgLy8gdG9vbHMuZGF0YUNvb3JkcyA9IGYgPT4ge1xuICAgIC8vICAgY3R4LnNhdmUoKVxuICAgIC8vICAgc2V0VHJhbnNmb3JtKClcbiAgICAvLyAgIGYoKVxuICAgIC8vICAgY3R4LnJlc3RvcmUoKVxuICAgIC8vIH1cblxuICAgIGRyYXdGdW5jKHRoaXMuY29udGV4dCwgdG9vbHMpXG4gICAgY3R4LnJlc3RvcmUoKVxuICB9XG59XG5cbi8qXG4gKiBtYWtlTGFiZWxzIGF0dGVtcHRzIHRvIGNyZWF0ZSB0aGUgYXBwcm9wcmlhdGUgbGFiZWxzIGZvciB0aGUgc3BlY2lmaWVkXG4gKiBzY3JlZW4gc2l6ZSwgY29udGV4dCwgYW5kIGxhYmVsIHNwYWNpbmcuXG4gKi9cbmZ1bmN0aW9uIG1ha2VMYWJlbHMgKFxuICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCxcbiAgc2NyZWVuVzogbnVtYmVyLFxuICBtaW46IG51bWJlcixcbiAgbWF4OiBudW1iZXIsXG4gIHNwYWNpbmdHdWVzczogbnVtYmVyLFxuICBzdGVwOiBudW1iZXIsXG4gIHVuaXQ6IHN0cmluZyxcbiAgdmFsRm10PzogKHY6IG51bWJlcikgPT4gc3RyaW5nXG4pOiBMYWJlbFNldCB7XG4gIHZhbEZtdCA9IHZhbEZtdCB8fCBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3NcbiAgY29uc3QgbiA9IHNjcmVlblcgLyBzcGFjaW5nR3Vlc3NcbiAgY29uc3QgZGlmZiA9IG1heCAtIG1pblxuICBpZiAobiA8IDEgfHwgZGlmZiA8PSAwKSByZXR1cm4geyBsYmxzOiBbXSB9XG4gIGNvbnN0IHRpY2tHdWVzcyA9IGRpZmYgLyBuXG4gIC8vIG1ha2UgdGhlIHRpY2sgc3BhY2luZyBhIG11bHRpcGxlIG9mIHRoZSBzdGVwXG4gIGNvbnN0IHRpY2sgPSB0aWNrR3Vlc3MgKyBzdGVwIC0gKHRpY2tHdWVzcyAlIHN0ZXApXG4gIGxldCB4ID0gbWluICsgdGljayAtIChtaW4gJSB0aWNrKVxuICBjb25zdCBhYnNNYXggPSBNYXRoLm1heChNYXRoLmFicyhtYXgpLCBNYXRoLmFicyhtaW4pKVxuICAvLyBUaGUgTWF0aC5yb3VuZCBwYXJ0IGlzIHRoZSBtaW5pbXVtIHByZWNpc2lvbiByZXF1aXJlZCB0byBzZWUgdGhlIGNoYW5nZSBpbiB0aGUgbnVtYmVycy5cbiAgLy8gVGhlIDIgYWNjb3VudHMgZm9yIHRoZSBwcmVjaXNpb24gb2YgdGhlIHRpY2suXG4gIGNvbnN0IHNpZ0ZpZ3MgPSBNYXRoLnJvdW5kKE1hdGgubG9nMTAoYWJzTWF4IC8gdGljaykpICsgMlxuICBjb25zdCBwdHM6IExhYmVsW10gPSBbXVxuICBsZXQgd2lkZXN0ID0gMFxuICB3aGlsZSAoeCA8IG1heCkge1xuICAgIHggPSBOdW1iZXIoeC50b1ByZWNpc2lvbihzaWdGaWdzKSlcbiAgICBjb25zdCBsYmwgPSB2YWxGbXQoeClcbiAgICB3aWRlc3QgPSBNYXRoLm1heCh3aWRlc3QsIGN0eC5tZWFzdXJlVGV4dChsYmwpLndpZHRoKVxuICAgIHB0cy5wdXNoKHtcbiAgICAgIHZhbDogeCxcbiAgICAgIHR4dDogbGJsXG4gICAgfSlcbiAgICB4ICs9IHRpY2tcbiAgfVxuICBjb25zdCB1bml0VyA9IGN0eC5tZWFzdXJlVGV4dCh1bml0KS53aWR0aFxuICBpZiAodW5pdFcgPiB3aWRlc3QpIHdpZGVzdCA9IHVuaXRXXG4gIHJldHVybiB7XG4gICAgd2lkZXN0OiB3aWRlc3QsXG4gICAgbGJsczogcHRzXG4gIH1cbn1cblxuY29uc3QgbW9udGhzID0gWydqYW4nLCAnZmViJywgJ21hcicsICdhcHInLCAnbWF5JywgJ2p1bicsICdqdWwnLCAnYXVnJywgJ3NlcCcsICdvY3QnLCAnbm92JywgJ2RlYyddXG5cbi8qIG1ha2VDYW5kbGVUaW1lTGFiZWxzIHByZXBhcmVzIGxhYmVscyBmb3IgY2FuZGxlc3RpY2sgZGF0YS4gKi9cbmZ1bmN0aW9uIG1ha2VDYW5kbGVUaW1lTGFiZWxzIChjYW5kbGVzOiBDYW5kbGVbXSwgZHVyOiBudW1iZXIsIHNjcmVlblc6IG51bWJlciwgc3BhY2luZ0d1ZXNzOiBudW1iZXIpOiBMYWJlbFNldCB7XG4gIGNvbnN0IGZpcnN0ID0gY2FuZGxlc1swXVxuICBjb25zdCBsYXN0ID0gY2FuZGxlc1tjYW5kbGVzLmxlbmd0aCAtIDFdXG4gIGNvbnN0IHN0YXJ0ID0gdHJ1bmNhdGUoZmlyc3QuZW5kU3RhbXAsIGR1cilcbiAgY29uc3QgZW5kID0gdHJ1bmNhdGUobGFzdC5lbmRTdGFtcCwgZHVyKSArIGR1clxuICBjb25zdCBkaWZmID0gZW5kIC0gc3RhcnRcbiAgY29uc3QgbiA9IE1hdGgubWluKGNhbmRsZXMubGVuZ3RoLCBzY3JlZW5XIC8gc3BhY2luZ0d1ZXNzKVxuICBjb25zdCB0aWNrID0gdHJ1bmNhdGUoZGlmZiAvIG4sIGR1cilcbiAgaWYgKHRpY2sgPT09IDApIHtcbiAgICBjb25zb2xlLmVycm9yKCd6ZXJvIHRpY2snLCBkdXIsIGRpZmYsIG4pIC8vIHByb2JhYmx5IHdvbid0IGhhcHBlbiwgYnV0IGl0J2Qgc3VjayBpZiBpdCBkaWRcbiAgICByZXR1cm4geyBsYmxzOiBbXSB9XG4gIH1cbiAgbGV0IHggPSBzdGFydFxuICBjb25zdCB6b25lT2Zmc2V0ID0gbmV3IERhdGUoKS5nZXRUaW1lem9uZU9mZnNldCgpXG4gIGNvbnN0IGRheVN0YW1wID0gKHg6IG51bWJlcikgPT4ge1xuICAgIHggPSB4IC0gem9uZU9mZnNldCAqIDYwMDAwXG4gICAgcmV0dXJuIHggLSAoeCAlIDg2NDAwMDAwKVxuICB9XG4gIGxldCBsYXN0RGF5ID0gZGF5U3RhbXAoc3RhcnQpXG4gIGxldCBsYXN0WWVhciA9IDAgLy8gbmV3IERhdGUoc3RhcnQpLmdldEZ1bGxZZWFyKClcbiAgaWYgKGRheVN0YW1wKGZpcnN0LmVuZFN0YW1wKSA9PT0gZGF5U3RhbXAobGFzdC5lbmRTdGFtcCkpIGxhc3REYXkgPSAwIC8vIEZvcmNlIGF0IGxlYXN0IG9uZSBkYXkgc3RhbXAuXG4gIGNvbnN0IHB0cyA9IFtdXG4gIGxldCBsYWJlbFxuICBpZiAoZHVyIDwgODY0MDAwMDApIHtcbiAgICBsYWJlbCA9IChkOiBEYXRlLCB4OiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IGRheSA9IGRheVN0YW1wKHgpXG4gICAgICBpZiAoZGF5ICE9PSBsYXN0RGF5KSByZXR1cm4gYCR7bW9udGhzW2QuZ2V0TW9udGgoKV19JHtkLmdldERhdGUoKX0gJHtkLmdldEhvdXJzKCl9OiR7U3RyaW5nKGQuZ2V0TWludXRlcygpKS5wYWRTdGFydCgyLCAnMCcpfWBcbiAgICAgIGVsc2UgcmV0dXJuIGAke2QuZ2V0SG91cnMoKX06JHtTdHJpbmcoZC5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsICcwJyl9YFxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsYWJlbCA9IChkOiBEYXRlKSA9PiB7XG4gICAgICBjb25zdCB5ZWFyID0gZC5nZXRGdWxsWWVhcigpXG4gICAgICBpZiAoeWVhciAhPT0gbGFzdFllYXIpIHJldHVybiBgJHttb250aHNbZC5nZXRNb250aCgpXX0ke2QuZ2V0RGF0ZSgpfSAnJHtTdHJpbmcoeWVhcikuc2xpY2UoMiwgNCl9YFxuICAgICAgZWxzZSByZXR1cm4gYCR7bW9udGhzW2QuZ2V0TW9udGgoKV19JHtkLmdldERhdGUoKX1gXG4gICAgfVxuICB9XG4gIHdoaWxlICh4IDw9IGVuZCkge1xuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSh4KVxuICAgIHB0cy5wdXNoKHtcbiAgICAgIHZhbDogeCxcbiAgICAgIHR4dDogbGFiZWwoZCwgeClcbiAgICB9KVxuICAgIGxhc3REYXkgPSBkYXlTdGFtcCh4KVxuICAgIGxhc3RZZWFyID0gZC5nZXRGdWxsWWVhcigpXG4gICAgeCArPSB0aWNrXG4gIH1cbiAgcmV0dXJuIHsgbGJsczogcHRzIH1cbn1cblxuLyogVGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheS4gKi9cbmZ1bmN0aW9uIGxhc3QgKGFycjogYW55W10pOiBhbnkge1xuICByZXR1cm4gYXJyW2Fyci5sZW5ndGggLSAxXVxufVxuXG4vKiBsaW5lIGRyYXdzIGEgbGluZSB3aXRoIHRoZSBwcm92aWRlZCBjb250ZXh0LiAqL1xuZnVuY3Rpb24gbGluZSAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHgwOiBudW1iZXIsIHkwOiBudW1iZXIsIHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHNraXBTdHJva2U/OiBib29sZWFuKSB7XG4gIGN0eC5iZWdpblBhdGgoKVxuICBjdHgubW92ZVRvKHgwLCB5MClcbiAgY3R4LmxpbmVUbyh4MSwgeTEpXG4gIGlmICghc2tpcFN0cm9rZSkgY3R4LnN0cm9rZSgpXG59XG5cbi8qIGRvdCBkcmF3cyBhIGNpcmNsZSB3aXRoIHRoZSBwcm92aWRlZCBjb250ZXh0LiAqL1xuZnVuY3Rpb24gZG90IChjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCwgeDogbnVtYmVyLCB5OiBudW1iZXIsIGNvbG9yOiBzdHJpbmcsIHJhZGl1czogbnVtYmVyKSB7XG4gIGN0eC5maWxsU3R5bGUgPSBjb2xvclxuICBjdHguYmVnaW5QYXRoKClcbiAgY3R4LmFyYyh4LCB5LCByYWRpdXMsIDAsIFBJUEkpXG4gIGN0eC5maWxsKClcbn1cblxuLyogZmxvYXRDb21wYXJlIGNvbXBhcmVzIHR3byBmbG9hdHMgdG8gd2l0aGluIGEgdG9sZXJhbmNlIG9mICAxZS04LiAqL1xuZnVuY3Rpb24gZmxvYXRDb21wYXJlIChhOiBudW1iZXIsIGI6IG51bWJlcikge1xuICByZXR1cm4gd2l0aGluVG9sZXJhbmNlKGEsIGIsIDFlLTgpXG59XG5cbi8qXG4gKiB3aXRoaW5Ub2xlcmFuY2UgcmV0dXJucyB0cnVlIGlmIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gYSBhbmQgYiBhcmUgd2l0aFxuICogdGhlIHNwZWNpZmllZCB0b2xlcmFuY2UuXG4gKi9cbmZ1bmN0aW9uIHdpdGhpblRvbGVyYW5jZSAoYTogbnVtYmVyLCBiOiBudW1iZXIsIHRvbGVyYW5jZTogbnVtYmVyKSB7XG4gIHJldHVybiBNYXRoLmFicyhhIC0gYikgPCBNYXRoLmFicyh0b2xlcmFuY2UpXG59XG5cbmZ1bmN0aW9uIHRydW5jYXRlICh2OiBudW1iZXIsIHc6IG51bWJlcik6IG51bWJlciB7XG4gIHJldHVybiB2IC0gKHYgJSB3KVxufVxuIiwiaW1wb3J0IHtcbiAgYXBwLFxuICBQYWdlRWxlbWVudFxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5cbmV4cG9ydCBjb25zdCBNYWlubmV0ID0gMFxuZXhwb3J0IGNvbnN0IFRlc3RuZXQgPSAxXG5leHBvcnQgY29uc3QgU2ltbmV0ID0gMlxuXG5jb25zdCBjb2luSURUYWtlckZvdW5kTWFrZXJSZWRlbXB0aW9uID0gJ1Rha2VyRm91bmRNYWtlclJlZGVtcHRpb246J1xuXG4vKiBldGhCYXNlZEV4cGxvcmVyQXJnIHJldHVybnMgdGhlIGV4cGxvcmVyIGFyZ3VtZW50IGZvciBFVEgsIEVSQzIwIGFuZCBFVk1cbkNvbXBhdGlibGUgYXNzZXRzIGFuZCB3aGV0aGVyIHRoZSByZXR1cm4gdmFsdWUgaXMgYW4gYWRkcmVzcy4gKi9cbmZ1bmN0aW9uIGV0aEJhc2VkRXhwbG9yZXJBcmcgKGNpZDogc3RyaW5nKTogW3N0cmluZywgYm9vbGVhbl0ge1xuICBpZiAoY2lkLnN0YXJ0c1dpdGgoY29pbklEVGFrZXJGb3VuZE1ha2VyUmVkZW1wdGlvbikpIHJldHVybiBbY2lkLnN1YnN0cmluZyhjb2luSURUYWtlckZvdW5kTWFrZXJSZWRlbXB0aW9uLmxlbmd0aCksIHRydWVdXG4gIGVsc2UgaWYgKGNpZC5sZW5ndGggPT09IDQyKSByZXR1cm4gW2NpZCwgdHJ1ZV1cbiAgZWxzZSByZXR1cm4gW2NpZCwgZmFsc2VdXG59XG5cbmNvbnN0IGV0aEV4cGxvcmVyczogUmVjb3JkPG51bWJlciwgKGNpZDogc3RyaW5nKSA9PiBzdHJpbmc+ID0ge1xuICBbTWFpbm5ldF06IChjaWQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IFthcmcsIGlzQWRkcl0gPSBldGhCYXNlZEV4cGxvcmVyQXJnKGNpZClcbiAgICByZXR1cm4gaXNBZGRyID8gYGh0dHBzOi8vZXRoZXJzY2FuLmlvL2FkZHJlc3MvJHthcmd9YCA6IGBodHRwczovL2V0aGVyc2Nhbi5pby90eC8ke2FyZ31gXG4gIH0sXG4gIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgW2FyZywgaXNBZGRyXSA9IGV0aEJhc2VkRXhwbG9yZXJBcmcoY2lkKVxuICAgIHJldHVybiBpc0FkZHIgPyBgaHR0cHM6Ly9zZXBvbGlhLmV0aGVyc2Nhbi5pby9hZGRyZXNzLyR7YXJnfWAgOiBgaHR0cHM6Ly9zZXBvbGlhLmV0aGVyc2Nhbi5pby90eC8ke2FyZ31gXG4gIH0sXG4gIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBbYXJnLCBpc0FkZHJdID0gZXRoQmFzZWRFeHBsb3JlckFyZyhjaWQpXG4gICAgcmV0dXJuIGlzQWRkciA/IGBodHRwczovL2V0aGVyc2Nhbi5pby9hZGRyZXNzLyR7YXJnfWAgOiBgaHR0cHM6Ly9ldGhlcnNjYW4uaW8vdHgvJHthcmd9YFxuICB9XG59XG5cbmNvbnN0IHBvbHlnb25FeHBsb3JlcnM6IFJlY29yZDxudW1iZXIsIChjaWQ6IHN0cmluZykgPT4gc3RyaW5nPiA9IHtcbiAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBbYXJnLCBpc0FkZHJdID0gZXRoQmFzZWRFeHBsb3JlckFyZyhjaWQpXG4gICAgcmV0dXJuIGlzQWRkciA/IGBodHRwczovL3BvbHlnb25zY2FuLmNvbS9hZGRyZXNzLyR7YXJnfWAgOiBgaHR0cHM6Ly9wb2x5Z29uc2Nhbi5jb20vdHgvJHthcmd9YFxuICB9LFxuICBbVGVzdG5ldF06IChjaWQ6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IFthcmcsIGlzQWRkcl0gPSBldGhCYXNlZEV4cGxvcmVyQXJnKGNpZClcbiAgICByZXR1cm4gaXNBZGRyID8gYGh0dHBzOi8vYW1veS5wb2x5Z29uc2Nhbi5jb20vYWRkcmVzcy8ke2FyZ31gIDogYGh0dHBzOi8vYW1veS5wb2x5Z29uc2Nhbi5jb20vdHgvJHthcmd9YFxuICB9LFxuICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgW2FyZywgaXNBZGRyXSA9IGV0aEJhc2VkRXhwbG9yZXJBcmcoY2lkKVxuICAgIHJldHVybiBpc0FkZHIgPyBgaHR0cHM6Ly9wb2x5Z29uc2Nhbi5jb20vYWRkcmVzcy8ke2FyZ31gIDogYGh0dHBzOi8vcG9seWdvbnNjYW4uY29tL3R4LyR7YXJnfWBcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgQ29pbkV4cGxvcmVyczogUmVjb3JkPG51bWJlciwgUmVjb3JkPG51bWJlciwgKGNpZDogc3RyaW5nKSA9PiBzdHJpbmc+PiA9IHtcbiAgNDI6IHsgLy8gZGNyXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IFt0eGlkLCB2b3V0XSA9IGNpZC5zcGxpdCgnOicpXG4gICAgICBpZiAodm91dCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gYGh0dHBzOi8vZXhwbG9yZXIuZGNyZGF0YS5vcmcvdHgvJHt0eGlkfS9vdXQvJHt2b3V0fWBcbiAgICAgIHJldHVybiBgaHR0cHM6Ly9leHBsb3Jlci5kY3JkYXRhLm9yZy90eC8ke3R4aWR9YFxuICAgIH0sXG4gICAgW1Rlc3RuZXRdOiAoY2lkOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IFt0eGlkLCB2b3V0XSA9IGNpZC5zcGxpdCgnOicpXG4gICAgICBpZiAodm91dCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gYGh0dHBzOi8vdGVzdG5ldC5kY3JkYXRhLm9yZy90eC8ke3R4aWR9L291dC8ke3ZvdXR9YFxuICAgICAgcmV0dXJuIGBodHRwczovL3Rlc3RuZXQuZGNyZGF0YS5vcmcvdHgvJHt0eGlkfWBcbiAgICB9LFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IFt0eGlkLCB2b3V0XSA9IGNpZC5zcGxpdCgnOicpXG4gICAgICBpZiAodm91dCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gYGh0dHA6Ly8xMjcuMC4wLjE6MTc3NzkvdHgvJHt0eGlkfS9vdXQvJHt2b3V0fWBcbiAgICAgIHJldHVybiBgaHR0cHM6Ly8xMjcuMC4wLjE6MTc3NzkvdHgvJHt0eGlkfWBcbiAgICB9XG4gIH0sXG4gIDA6IHsgLy8gYnRjXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL21lbXBvb2wuc3BhY2UvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9tZW1wb29sLnNwYWNlL3Rlc3RuZXQvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL21lbXBvb2wuc3BhY2UvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gXG4gIH0sXG4gIDI6IHsgLy8gbHRjXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2x0Yy5iaXRhcHMuY29tLyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbVGVzdG5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vc29jaGFpbi5jb20vdHgvTFRDVEVTVC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1NpbW5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vbHRjLmJpdGFwcy5jb20vJHtjaWQuc3BsaXQoJzonKVswXX1gXG4gIH0sXG4gIDIwOiB7IC8vIGRnYlxuICAgIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9kaWdpZXhwbG9yZXIuaW5mby90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1Rlc3RuZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL3Rlc3RuZXRleHBsb3Jlci5kaWdpYnl0ZXNlcnZlcnMuaW8vdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2RpZ2lleHBsb3Jlci5pbmZvL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YFxuICB9LFxuICA2MDogZXRoRXhwbG9yZXJzLFxuICA2MDAwMTogZXRoRXhwbG9yZXJzLFxuICA2MDAwMjogZXRoRXhwbG9yZXJzLFxuICAzOiB7IC8vIGRvZ2VcbiAgICBbTWFpbm5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vZG9nZWJsb2Nrcy5jb20vdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9ibG9ja2V4cGxvcmVyLm9uZS9kb2dlY29pbi90ZXN0bmV0L3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9kb2dlYmxvY2tzLmNvbS90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWBcbiAgfSxcbiAgNTogeyAvLyBkYXNoXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2Jsb2NrZXhwbG9yZXIub25lL2Rhc2gvbWFpbm5ldC90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1Rlc3RuZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2Jsb2NrZXhwbG9yZXIub25lL2Rhc2gvdGVzdG5ldC90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1NpbW5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vYmxvY2tleHBsb3Jlci5vbmUvZGFzaC9tYWlubmV0L3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YFxuICB9LFxuICAxMzM6IHsgLy8gemVjXG4gICAgW01haW5uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL3pjYXNoYmxvY2tleHBsb3Jlci5jb20vdHJhbnNhY3Rpb25zLyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbVGVzdG5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vYmxvY2tleHBsb3Jlci5vbmUvemNhc2gvdGVzdG5ldC90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1NpbW5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vemNhc2hibG9ja2V4cGxvcmVyLmNvbS90cmFuc2FjdGlvbnMvJHtjaWQuc3BsaXQoJzonKVswXX1gXG4gIH0sXG4gIDE0NzogeyAvLyB6Y2xcbiAgICBbTWFpbm5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vZXhwbG9yZXIuemNsLnplbGNvcmUuaW8vdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtTaW1uZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL2V4cGxvcmVyLnpjbC56ZWxjb3JlLmlvL3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YFxuICB9LFxuICAxMzY6IHsgLy8gZmlyb1xuICAgIFtNYWlubmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9leHBsb3Jlci5maXJvLm9yZy90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1Rlc3RuZXRdOiAoY2lkOiBzdHJpbmcpID0+IGBodHRwczovL3Rlc3RleHBsb3Jlci5maXJvLm9yZy90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWAsXG4gICAgW1NpbW5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vZXhwbG9yZXIuZmlyby5vcmcvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gXG4gIH0sXG4gIDE0NTogeyAvLyBiY2hcbiAgICBbTWFpbm5ldF06IChjaWQ6IHN0cmluZykgPT4gYGh0dHBzOi8vYmNoLmxvcGluZy5uZXQvdHgvJHtjaWQuc3BsaXQoJzonKVswXX1gLFxuICAgIFtUZXN0bmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly90YmNoNC5sb3BpbmcubmV0L3R4LyR7Y2lkLnNwbGl0KCc6JylbMF19YCxcbiAgICBbU2ltbmV0XTogKGNpZDogc3RyaW5nKSA9PiBgaHR0cHM6Ly9iY2gubG9waW5nLm5ldC90eC8ke2NpZC5zcGxpdCgnOicpWzBdfWBcbiAgfSxcbiAgOTY2OiBwb2x5Z29uRXhwbG9yZXJzLFxuICA5NjYwMDE6IHBvbHlnb25FeHBsb3JlcnMsXG4gIDk2NjAwMjogcG9seWdvbkV4cGxvcmVycyxcbiAgOTY2MDAzOiBwb2x5Z29uRXhwbG9yZXJzLFxuICA5NjYwMDQ6IHBvbHlnb25FeHBsb3JlcnNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdENvaW5JRCAoY2lkOiBzdHJpbmcpIHtcbiAgaWYgKGNpZC5zdGFydHNXaXRoKGNvaW5JRFRha2VyRm91bmRNYWtlclJlZGVtcHRpb24pKSB7XG4gICAgY29uc3QgbWFrZXJBZGRyID0gY2lkLnN1YnN0cmluZyhjb2luSURUYWtlckZvdW5kTWFrZXJSZWRlbXB0aW9uLmxlbmd0aClcbiAgICByZXR1cm4gaW50bC5wcmVwKGludGwuSURfVEFLRVJfRk9VTkRfTUFLRVJfUkVERU1QVElPTiwgeyBtYWtlckFkZHI6IG1ha2VyQWRkciB9KVxuICB9XG4gIHJldHVybiBjaWRcbn1cblxuLypcbiAqIGJhc2VDaGFpbklEIHJldHVybnMgdGhlIGFzc2V0IElEIGZvciB0aGUgYXNzZXQncyBwYXJlbnQgaWYgdGhlIGFzc2V0IGlzIGFcbiAqIHRva2VuLCBvdGhlcndpc2UgdGhlIElEIGZvciB0aGUgYXNzZXQgaXRzZWxmLlxuICovXG5mdW5jdGlvbiBiYXNlQ2hhaW5JRCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gIGNvbnN0IGFzc2V0ID0gYXBwKCkudXNlci5hc3NldHNbYXNzZXRJRF1cbiAgcmV0dXJuIGFzc2V0LnRva2VuID8gYXNzZXQudG9rZW4ucGFyZW50SUQgOiBhc3NldElEXG59XG5cbi8qXG4gKiBzZXRDb2luSHJlZiBzZXRzIHRoZSBoeXBlcmxpbmsgZWxlbWVudCdzIGhyZWYgYXR0cmlidXRlIGJhc2VkIG9uIHByb3ZpZGVkXG4gKiBhc3NldElEIGFuZCBkYXRhLWV4cGxvcmVyLWNvaW4gdmFsdWUgcHJlc2VudCBvbiBzdXBwbGllZCBsaW5rIGVsZW1lbnQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRDb2luSHJlZiAoYXNzZXRJRDogbnVtYmVyLCBsaW5rOiBQYWdlRWxlbWVudCkge1xuICBjb25zdCBuZXQgPSBhcHAoKS51c2VyLm5ldFxuICBjb25zdCBhc3NldEV4cGxvcmVyID0gQ29pbkV4cGxvcmVyc1tiYXNlQ2hhaW5JRChhc3NldElEKV1cbiAgaWYgKCFhc3NldEV4cGxvcmVyKSByZXR1cm5cbiAgY29uc3QgZm9ybWF0dGVyID0gYXNzZXRFeHBsb3JlcltuZXRdXG4gIGlmICghZm9ybWF0dGVyKSByZXR1cm5cbiAgbGluay5jbGFzc0xpc3QucmVtb3ZlKCdwbGFpbmxpbmsnKVxuICBsaW5rLmNsYXNzTGlzdC5hZGQoJ3N1YnRsZWxpbmsnKVxuICBsaW5rLmhyZWYgPSBmb3JtYXR0ZXIobGluay5kYXRhc2V0LmV4cGxvcmVyQ29pbiB8fCAnJylcbn1cbiIsImltcG9ydCBEb2MsIHsgQW5pbWF0aW9uLCBBbmlUb2dnbGUgfSBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQgKiBhcyBmb3JtcyBmcm9tICcuL2Zvcm1zJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQgeyBSZXB1dGF0aW9uTWV0ZXIsIHN0cm9uZ1RpZXIgfSBmcm9tICcuL2FjY291bnQnXG5pbXBvcnQge1xuICBhcHAsXG4gIFBhZ2VFbGVtZW50LFxuICBDb25uZWN0aW9uU3RhdHVzLFxuICBFeGNoYW5nZSxcbiAgV2FsbGV0U3RhdGUsXG4gIFByZXBhaWRCb25kSURcbn0gZnJvbSAnLi9yZWdpc3RyeSdcblxuaW50ZXJmYWNlIEFuaW1hdG9yIHtcbiAgYW5pbWF0ZTogKCgpID0+IFByb21pc2U8dm9pZD4pXG59XG5cbmludGVyZmFjZSBCb25kT3B0aW9uc0Zvcm0ge1xuICBob3N0Pzogc3RyaW5nIC8vIFJlcXVpcmVkLCBidXQgc2V0IGJ5IHVwZGF0ZUJvbmRPcHRpb25zXG4gIGJvbmRBc3NldElEPzogbnVtYmVyXG4gIHRhcmdldFRpZXI/OiBudW1iZXJcbiAgcGVuYWx0eUNvbXBzPzogbnVtYmVyXG59XG5cbmNvbnN0IGFuaW1hdGlvbkxlbmd0aCA9IDMwMFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEZXhTZXR0aW5nc1BhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIGJvZHk6IEhUTUxFbGVtZW50XG4gIGZvcm1zOiBQYWdlRWxlbWVudFtdXG4gIGN1cnJlbnRGb3JtOiBQYWdlRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgaG9zdDogc3RyaW5nXG4gIGFjY291bnREaXNhYmxlZDpib29sZWFuXG4gIGtleXVwOiAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZFxuICBkZXhBZGRyRm9ybTogZm9ybXMuREVYQWRkcmVzc0Zvcm1cbiAgYm9uZEZlZUJ1ZmZlckNhY2hlOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+XG4gIG5ld1dhbGxldEZvcm06IGZvcm1zLk5ld1dhbGxldEZvcm1cbiAgcmVnQXNzZXRGb3JtOiBmb3Jtcy5GZWVBc3NldFNlbGVjdGlvbkZvcm1cbiAgd2FsbGV0V2FpdEZvcm06IGZvcm1zLldhbGxldFdhaXRGb3JtXG4gIGNvbmZpcm1SZWdpc3RlckZvcm06IGZvcm1zLkNvbmZpcm1SZWdpc3RyYXRpb25Gb3JtXG4gIHJlcHV0YXRpb25NZXRlcjogUmVwdXRhdGlvbk1ldGVyXG4gIGFuaW1hdGlvbjogQW5pbWF0aW9uXG4gIHJlbmV3VG9nZ2xlOiBBbmlUb2dnbGVcblxuICBjb25zdHJ1Y3RvciAoYm9keTogSFRNTEVsZW1lbnQpIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5ib2R5ID0gYm9keVxuICAgIGNvbnN0IGhvc3QgPSB0aGlzLmhvc3QgPSBib2R5LmRhdGFzZXQuaG9zdCA/IGJvZHkuZGF0YXNldC5ob3N0IDogJydcbiAgICBjb25zdCB4YyA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhib2R5KVxuICAgIHRoaXMuZm9ybXMgPSBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLmZvcm1zLCAnOnNjb3BlID4gZm9ybScpXG5cbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0gPSBuZXcgZm9ybXMuQ29uZmlybVJlZ2lzdHJhdGlvbkZvcm0ocGFnZS5jb25maXJtUmVnRm9ybSwgYXN5bmMgKCkgPT4ge1xuICAgICAgdGhpcy5zaG93U3VjY2VzcyhpbnRsLnByZXAoaW50bC5JRF9UUkFESU5HX1RJRVJfVVBEQVRFRCkpXG4gICAgICB0aGlzLnJlbmV3VG9nZ2xlLnNldFN0YXRlKHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS50aWVyID4gMClcbiAgICAgIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgICBhcHAoKS51cGRhdGVNZW51SXRlbXNEaXNwbGF5KClcbiAgICB9LCAoKSA9PiB7XG4gICAgICB0aGlzLnJ1bkFuaW1hdGlvbih0aGlzLnJlZ0Fzc2V0Rm9ybSwgcGFnZS5yZWdBc3NldEZvcm0pXG4gICAgfSlcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0RXhjaGFuZ2UoeGMsICcnKVxuXG4gICAgdGhpcy53YWxsZXRXYWl0Rm9ybSA9IG5ldyBmb3Jtcy5XYWxsZXRXYWl0Rm9ybShwYWdlLndhbGxldFdhaXQsICgpID0+IHtcbiAgICAgIHRoaXMucnVuQW5pbWF0aW9uKHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybSwgcGFnZS5jb25maXJtUmVnRm9ybSlcbiAgICB9LCAoKSA9PiB7XG4gICAgICB0aGlzLnJ1bkFuaW1hdGlvbih0aGlzLnJlZ0Fzc2V0Rm9ybSwgcGFnZS5yZWdBc3NldEZvcm0pXG4gICAgfSlcbiAgICB0aGlzLndhbGxldFdhaXRGb3JtLnNldEV4Y2hhbmdlKHhjKVxuXG4gICAgdGhpcy5uZXdXYWxsZXRGb3JtID0gbmV3IGZvcm1zLk5ld1dhbGxldEZvcm0oXG4gICAgICBwYWdlLm5ld1dhbGxldEZvcm0sXG4gICAgICBhc3NldElEID0+IHRoaXMubmV3V2FsbGV0Q3JlYXRlZChhc3NldElELCB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0udGllciksXG4gICAgICAoKSA9PiB0aGlzLnJ1bkFuaW1hdGlvbih0aGlzLnJlZ0Fzc2V0Rm9ybSwgcGFnZS5yZWdBc3NldEZvcm0pXG4gICAgKVxuXG4gICAgdGhpcy5yZWdBc3NldEZvcm0gPSBuZXcgZm9ybXMuRmVlQXNzZXRTZWxlY3Rpb25Gb3JtKHBhZ2UucmVnQXNzZXRGb3JtLCBhc3luYyAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIpID0+IHtcbiAgICAgIGlmIChhc3NldElEID09PSBQcmVwYWlkQm9uZElEKSB7XG4gICAgICAgIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgICAgIHRoaXMudXBkYXRlUmVwdXRhdGlvbigpXG4gICAgICAgIHRoaXMuc2hvd1N1Y2Nlc3MoaW50bC5wcmVwKGludGwuSURfVFJBRElOR19USUVSX1VQREFURUQpKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBjb25zdCB3YWxsZXQgPSBhc3NldC53YWxsZXRcbiAgICAgIGlmICh3YWxsZXQpIHtcbiAgICAgICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnJlZ0Fzc2V0Rm9ybSlcbiAgICAgICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgICAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGllciwgYm9uZHNGZWVCdWZmZXIpXG4gICAgICAgIGxvYWRlZCgpXG4gICAgICAgIHRoaXMucHJvZ3Jlc3NUaWVyRm9ybXNXaXRoV2FsbGV0KGFzc2V0SUQsIHdhbGxldClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGllciwgMClcbiAgICAgIHRoaXMubmV3V2FsbGV0Rm9ybS5zZXRBc3NldChhc3NldElEKVxuICAgICAgdGhpcy5zaG93Rm9ybShwYWdlLm5ld1dhbGxldEZvcm0pXG4gICAgfSlcbiAgICB0aGlzLnJlZ0Fzc2V0Rm9ybS5zZXRFeGNoYW5nZSh4YywgJycpXG5cbiAgICB0aGlzLnJlcHV0YXRpb25NZXRlciA9IG5ldyBSZXB1dGF0aW9uTWV0ZXIocGFnZS5yZXBNZXRlcilcbiAgICB0aGlzLnJlcHV0YXRpb25NZXRlci5zZXRIb3N0KGhvc3QpXG5cbiAgICBEb2MuYmluZChwYWdlLmV4cG9ydERleEJ0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5leHBvcnRBY2NvdW50KCkpXG5cbiAgICB0aGlzLmFjY291bnREaXNhYmxlZCA9IGJvZHkuZGF0YXNldC5kaXNhYmxlZCA9PT0gJ3RydWUnXG4gICAgRG9jLmJpbmQocGFnZS50b2dnbGVBY2NvdW50U3RhdHVzQnRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuYWNjb3VudERpc2FibGVkKSB0aGlzLnByZXBhcmVBY2NvdW50RGlzYWJsZShwYWdlLmRpc2FibGVBY2NvdW50Rm9ybSlcbiAgICAgIGVsc2UgdGhpcy50b2dnbGVBY2NvdW50U3RhdHVzKGZhbHNlKVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS51cGRhdGVDZXJ0QnRuLCAnY2xpY2snLCAoKSA9PiBwYWdlLmNlcnRGaWxlSW5wdXQuY2xpY2soKSlcbiAgICBEb2MuYmluZChwYWdlLnVwZGF0ZUhvc3RCdG4sICdjbGljaycsICgpID0+IHRoaXMucHJlcGFyZVVwZGF0ZUhvc3QoKSlcbiAgICBEb2MuYmluZChwYWdlLmNlcnRGaWxlSW5wdXQsICdjaGFuZ2UnLCAoKSA9PiB0aGlzLm9uQ2VydEZpbGVDaGFuZ2UoKSlcbiAgICBEb2MuYmluZChwYWdlLmdvQmFja1RvU2V0dGluZ3MsICdjbGljaycsICgpID0+IGFwcCgpLmxvYWRQYWdlKCdzZXR0aW5ncycpKVxuXG4gICAgY29uc3Qgc2hvd1RpZXJGb3JtID0gKCkgPT4ge1xuICAgICAgdGhpcy5yZWdBc3NldEZvcm0uc2V0RXhjaGFuZ2UoYXBwKCkuZXhjaGFuZ2VzW2hvc3RdLCAnJykgLy8gcmVzZXQgZm9ybVxuICAgICAgdGhpcy5zaG93Rm9ybShwYWdlLnJlZ0Fzc2V0Rm9ybSlcbiAgICB9XG4gICAgRG9jLmJpbmQocGFnZS5jaGFuZ2VUaWVyLCAnY2xpY2snLCAoKSA9PiB7IHNob3dUaWVyRm9ybSgpIH0pXG4gICAgY29uc3Qgd2lsbEF1dG9SZW5ldyA9IHhjLmF1dGgudGFyZ2V0VGllciA+IDBcbiAgICB0aGlzLnJlbmV3VG9nZ2xlID0gbmV3IEFuaVRvZ2dsZShwYWdlLnRvZ2dsZUF1dG9SZW5ldywgcGFnZS5yZW5ld0Vyciwgd2lsbEF1dG9SZW5ldywgYXN5bmMgKG5ld1N0YXRlOiBib29sZWFuKSA9PiB7XG4gICAgICBpZiAodGhpcy5hY2NvdW50RGlzYWJsZWQpIHJldHVyblxuICAgICAgaWYgKG5ld1N0YXRlKSBzaG93VGllckZvcm0oKVxuICAgICAgZWxzZSByZXR1cm4gdGhpcy5kaXNhYmxlQXV0b1JlbmV3KClcbiAgICB9KVxuICAgIERvYy5iaW5kKHBhZ2UuYXV0b1JlbmV3Qm94LCAnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgaWYgKCF0aGlzLmFjY291bnREaXNhYmxlZCkgcGFnZS50b2dnbGVBdXRvUmVuZXcuY2xpY2soKVxuICAgIH0pXG5cbiAgICBwYWdlLnBlbmFsdHlDb21wcy50ZXh0Q29udGVudCA9IFN0cmluZyh4Yy5hdXRoLnBlbmFsdHlDb21wcylcbiAgICBjb25zdCBoaWRlQ29tcElucHV0ID0gKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5wZW5hbHR5Q29tcElucHV0KVxuICAgICAgRG9jLnNob3cocGFnZS5wZW5hbHR5Q29tcHMpXG4gICAgfVxuICAgIERvYy5iaW5kKHBhZ2UucGVuYWx0eUNvbXBCb3gsICdjbGljaycsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICBjb25zdCB4YyA9IGFwcCgpLmV4Y2hhbmdlc1t0aGlzLmhvc3RdXG4gICAgICBwYWdlLnBlbmFsdHlDb21wSW5wdXQudmFsdWUgPSBTdHJpbmcoeGMuYXV0aC5wZW5hbHR5Q29tcHMpXG4gICAgICBEb2MuaGlkZShwYWdlLnBlbmFsdHlDb21wcylcbiAgICAgIERvYy5zaG93KHBhZ2UucGVuYWx0eUNvbXBJbnB1dClcbiAgICAgIHBhZ2UucGVuYWx0eUNvbXBJbnB1dC5mb2N1cygpXG4gICAgICBjb25zdCBjaGVja0NsaWNrID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgaWYgKERvYy5tb3VzZUluRWxlbWVudChlLCBwYWdlLnBlbmFsdHlDb21wQm94KSkgcmV0dXJuXG4gICAgICAgIGhpZGVDb21wSW5wdXQoKVxuICAgICAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjaGVja0NsaWNrKVxuICAgICAgfVxuICAgICAgRG9jLmJpbmQoZG9jdW1lbnQsICdjbGljaycsIGNoZWNrQ2xpY2spXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHBhZ2UucGVuYWx0eUNvbXBJbnB1dCwgJ2tleXVwJywgYXN5bmMgKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UucGVuYWx0eUNvbXBzRXJyKVxuICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICBoaWRlQ29tcElucHV0KClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBpZiAoIShlLmtleSA9PT0gJ0VudGVyJykpIHJldHVyblxuICAgICAgY29uc3QgcGVuYWx0eUNvbXBzID0gcGFyc2VJbnQocGFnZS5wZW5hbHR5Q29tcElucHV0LnZhbHVlIHx8ICcnKVxuICAgICAgaWYgKGlzTmFOKHBlbmFsdHlDb21wcykpIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS5wZW5hbHR5Q29tcHNFcnIpXG4gICAgICAgIHBhZ2UucGVuYWx0eUNvbXBzRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9DT01QU19WQUxVRSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2Uub3RoZXJCb25kU2V0dGluZ3MpXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZUJvbmRPcHRpb25zKHsgcGVuYWx0eUNvbXBzIH0pXG4gICAgICAgIGxvYWRlZCgpXG4gICAgICAgIHBhZ2UucGVuYWx0eUNvbXBzLnRleHRDb250ZW50ID0gU3RyaW5nKHBlbmFsdHlDb21wcylcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9hZGVkKClcbiAgICAgICAgRG9jLnNob3cocGFnZS5wZW5hbHR5Q29tcHNFcnIpXG4gICAgICAgIHBhZ2UucGVuYWx0eUNvbXBzRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQVBJX0VSUk9SLCB7IG1zZzogZS5tc2cgfSlcbiAgICAgIH1cbiAgICAgIGhpZGVDb21wSW5wdXQoKVxuICAgIH0pXG5cbiAgICB0aGlzLmRleEFkZHJGb3JtID0gbmV3IGZvcm1zLkRFWEFkZHJlc3NGb3JtKHBhZ2UuZGV4QWRkckZvcm0sIGFzeW5jICh4YzogRXhjaGFuZ2UpID0+IHtcbiAgICAgIGFwcCgpLmxvYWRQYWdlKGAvZGV4c2V0dGluZ3MvJHt4Yy5ob3N0fWApXG4gICAgfSwgdGhpcy5ob3N0KVxuXG4gICAgLy8gZm9ybXMuYmluZChwYWdlLmJvbmREZXRhaWxzRm9ybSwgcGFnZS51cGRhdGVCb25kT3B0aW9uc0NvbmZpcm0sICgpID0+IHRoaXMudXBkYXRlQm9uZE9wdGlvbnMoKSlcbiAgICBmb3Jtcy5iaW5kKHBhZ2UuZGlzYWJsZUFjY291bnRGb3JtLCBwYWdlLmRpc2FibGVBY2NvdW50Q29uZmlybSwgKCkgPT4gdGhpcy50b2dnbGVBY2NvdW50U3RhdHVzKHRydWUpKVxuXG4gICAgRG9jLmJpbmQocGFnZS5mb3JtcywgJ21vdXNlZG93bicsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoIURvYy5tb3VzZUluRWxlbWVudChlLCB0aGlzLmN1cnJlbnRGb3JtKSkgeyB0aGlzLmNsb3NlUG9wdXBzKCkgfVxuICAgIH0pXG5cbiAgICB0aGlzLmtleXVwID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwcygpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuXG4gICAgRG9jLmFwcGx5U2VsZWN0b3IocGFnZS5mb3JtcywgJy5mb3JtLWNsb3NlcicpLmZvckVhY2goZWwgPT4ge1xuICAgICAgRG9jLmJpbmQoZWwsICdjbGljaycsICgpID0+IHsgdGhpcy5jbG9zZVBvcHVwcygpIH0pXG4gICAgfSlcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBjb25uOiAoKSA9PiB7IHRoaXMuc2V0Q29ubmVjdGlvblN0YXR1cygpIH0sXG4gICAgICByZXB1dGF0aW9uOiAoKSA9PiB7IHRoaXMudXBkYXRlUmVwdXRhdGlvbigpIH0sXG4gICAgICBmZWVwYXltZW50OiAoKSA9PiB7IHRoaXMudXBkYXRlUmVwdXRhdGlvbigpIH0sXG4gICAgICBib25kcG9zdDogKCkgPT4geyB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKSB9XG4gICAgfSlcblxuICAgIHRoaXMuc2V0Q29ubmVjdGlvblN0YXR1cygpXG4gICAgdGhpcy51cGRhdGVSZXB1dGF0aW9uKClcbiAgfVxuXG4gIHVubG9hZCAoKSB7XG4gICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5rZXl1cClcbiAgfVxuXG4gIGFzeW5jIHByb2dyZXNzVGllckZvcm1zV2l0aFdhbGxldCAoYXNzZXRJRDogbnVtYmVyLCB3YWxsZXQ6IFdhbGxldFN0YXRlKSB7XG4gICAgY29uc3QgeyBwYWdlLCBjb25maXJtUmVnaXN0ZXJGb3JtOiB7IGZlZXMgfSB9ID0gdGhpc1xuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgeyBib25kQXNzZXRzIH0gPSB0aGlzLnJlZ0Fzc2V0Rm9ybS54Y1xuICAgIGNvbnN0IGJvbmRBc3NldCA9IGJvbmRBc3NldHNbYXNzZXQuc3ltYm9sXVxuICAgIGlmICghd2FsbGV0Lm9wZW4pIHtcbiAgICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5mb3JtcylcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL29wZW53YWxsZXQnLCB7IGFzc2V0SUQ6IGFzc2V0SUQgfSlcbiAgICAgIGxvYWRlZCgpXG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgICB0aGlzLnJlZ0Fzc2V0Rm9ybS5zZXRBc3NldEVycm9yKGBlcnJvciB1bmxvY2tpbmcgd2FsbGV0OiAke3Jlcy5tc2d9YClcbiAgICAgICAgdGhpcy5ydW5BbmltYXRpb24odGhpcy5yZWdBc3NldEZvcm0sIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgICAgfVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmICh3YWxsZXQuc3luY2VkICYmIHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA+PSAyICogYm9uZEFzc2V0LmFtb3VudCArIGZlZXMpIHtcbiAgICAgIC8vIElmIHdlIGFyZSByYWlzaW5nIG91ciB0aWVyLCB3ZSdsbCBzaG93IGEgY29uZmlybWF0aW9uIGZvcm1cbiAgICAgIHRoaXMucHJvZ3Jlc3NUaWVyRm9ybVdpdGhTeW5jZWRGdW5kZWRXYWxsZXQoYXNzZXRJRClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLndhbGxldFdhaXRGb3JtLnNldFdhbGxldChhc3NldElELCBmZWVzLCB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0udGllcilcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2Uud2FsbGV0V2FpdClcbiAgfVxuXG4gIGFzeW5jIHByb2dyZXNzVGllckZvcm1XaXRoU3luY2VkRnVuZGVkV2FsbGV0IChib25kQXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbdGhpcy5ob3N0XVxuICAgIGNvbnN0IHRhcmdldFRpZXIgPSB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0udGllclxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBzdHJvbmdUaWVyID0geGMuYXV0aC5saXZlU3RyZW5ndGggKyB4Yy5hdXRoLnBlbmRpbmdTdHJlbmd0aCAtIHhjLmF1dGgud2Vha1N0cmVuZ3RoXG4gICAgaWYgKHRhcmdldFRpZXIgPiB4Yy5hdXRoLnRhcmdldFRpZXIgJiYgdGFyZ2V0VGllciA+IHN0cm9uZ1RpZXIpIHtcbiAgICAgIHRoaXMucnVuQW5pbWF0aW9uKHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybSwgcGFnZS5jb25maXJtUmVnRm9ybSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyBMb3dlcmluZyB0aWVyXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmJvZHkpXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlQm9uZE9wdGlvbnMoeyBib25kQXNzZXRJRCwgdGFyZ2V0VGllciB9KVxuICAgICAgbG9hZGVkKClcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2FkZWQoKVxuICAgICAgdGhpcy5yZWdBc3NldEZvcm0uc2V0VGllckVycm9yKGUubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIHRoaXMuYW5pbWF0ZUNvbmZpcm1Gb3JtKHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgIHRoaXMuc2hvd1N1Y2Nlc3MoaW50bC5wcmVwKGludGwuSURfVFJBRElOR19USUVSX1VQREFURUQpKVxuICB9XG5cbiAgdXBkYXRlUmVwdXRhdGlvbiAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGF1dGggPSBhcHAoKS5leGNoYW5nZXNbdGhpcy5ob3N0XS5hdXRoXG4gICAgY29uc3QgeyByZXA6IHsgcGVuYWx0aWVzIH0sIHRhcmdldFRpZXIsIGV4cGlyZWRCb25kcyB9ID0gYXV0aFxuICAgIGNvbnN0IGRpc3BsYXlUaWVyID0gc3Ryb25nVGllcihhdXRoKVxuICAgIHBhZ2UudGFyZ2V0VGllci50ZXh0Q29udGVudCA9IFN0cmluZyh0YXJnZXRUaWVyKVxuICAgIHBhZ2UuZWZmZWN0aXZlVGllci50ZXh0Q29udGVudCA9IFN0cmluZyhkaXNwbGF5VGllcilcbiAgICBwYWdlLnBlbmFsdGllcy50ZXh0Q29udGVudCA9IFN0cmluZyhwZW5hbHRpZXMpXG4gICAgcGFnZS5ib25kc1BlbmRpbmdSZWZ1bmQudGV4dENvbnRlbnQgPSBgJHtleHBpcmVkQm9uZHM/Lmxlbmd0aCB8fCAwfWBcbiAgICB0aGlzLnJlcHV0YXRpb25NZXRlci51cGRhdGUoKVxuICB9XG5cbiAgLyogc2hvd0Zvcm0gc2hvd3MgYSBtb2RhbCBmb3JtIHdpdGggYSBsaXR0bGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBzaG93Rm9ybSAoZm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IGZvcm1cbiAgICB0aGlzLmZvcm1zLmZvckVhY2goZm9ybSA9PiBEb2MuaGlkZShmb3JtKSlcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzEwMDAwcHgnXG4gICAgRG9jLnNob3cocGFnZS5mb3JtcywgZm9ybSlcbiAgICBjb25zdCBzaGlmdCA9IChwYWdlLmZvcm1zLm9mZnNldFdpZHRoICsgZm9ybS5vZmZzZXRXaWR0aCkgLyAyXG4gICAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pbWF0aW9uTGVuZ3RoLCBwcm9ncmVzcyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gYCR7KDEgLSBwcm9ncmVzcykgKiBzaGlmdH1weGBcbiAgICB9LCAnZWFzZU91dEhhcmQnKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMCdcbiAgfVxuXG4gIGFzeW5jIHJ1bkFuaW1hdGlvbiAoYW5pOiBBbmltYXRvciwgZm9ybTogUGFnZUVsZW1lbnQpIHtcbiAgICBEb2MuaGlkZSh0aGlzLmN1cnJlbnRGb3JtKVxuICAgIGF3YWl0IGFuaS5hbmltYXRlKClcbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gZm9ybVxuICAgIERvYy5zaG93KGZvcm0pXG4gIH1cblxuICBjbG9zZVBvcHVwcyAoKSB7XG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLmZvcm1zKVxuICAgIGlmICh0aGlzLmFuaW1hdGlvbikgdGhpcy5hbmltYXRpb24uc3RvcCgpXG4gIH1cblxuICBhc3luYyBzaG93U3VjY2VzcyAobXNnOiBzdHJpbmcpIHtcbiAgICB0aGlzLmZvcm1zLmZvckVhY2goZm9ybSA9PiBEb2MuaGlkZShmb3JtKSlcbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gdGhpcy5wYWdlLmNoZWNrbWFya0Zvcm1cbiAgICB0aGlzLmFuaW1hdGlvbiA9IGZvcm1zLnNob3dTdWNjZXNzKHRoaXMucGFnZSwgbXNnKVxuICAgIGF3YWl0IHRoaXMuYW5pbWF0aW9uLndhaXQoKVxuICAgIHRoaXMuYW5pbWF0aW9uID0gbmV3IEFuaW1hdGlvbigxNTAwLCAoKSA9PiB7IC8qIHBhc3MgKi8gfSwgJycsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmN1cnJlbnRGb3JtID09PSB0aGlzLnBhZ2UuY2hlY2ttYXJrRm9ybSkgdGhpcy5jbG9zZVBvcHVwcygpXG4gICAgfSlcbiAgfVxuXG4gIC8vIGV4cG9ydEFjY291bnQgZXhwb3J0cyBhbmQgZG93bmxvYWRzIHRoZSBhY2NvdW50IGluZm8uXG4gIGFzeW5jIGV4cG9ydEFjY291bnQgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgaG9zdCB9ID0gdGhpc1xuICAgIGNvbnN0IHJlcSA9IHsgaG9zdCB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmJvZHkpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvZXhwb3J0YWNjb3VudCcsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmV4cG9ydEFjY291bnRFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLmV4cG9ydEFjY291bnRFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgcmVzLmFjY291bnQuYm9uZHMgPSByZXMuYm9uZHMgLy8gbWFpbnRhaW4gYmFja3dhcmQgY29tcGF0IG9mIEpTT04gZmlsZVxuICAgIGNvbnN0IGFjY291bnRGb3JFeHBvcnQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlcy5hY2NvdW50KSlcbiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpXG4gICAgYS5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgJ2RjckFjY291bnQtJyArIGhvc3QgKyAnLmpzb24nKVxuICAgIGEuc2V0QXR0cmlidXRlKCdocmVmJywgJ2RhdGE6dGV4dC9qc29uLCcgKyBKU09OLnN0cmluZ2lmeShhY2NvdW50Rm9yRXhwb3J0LCBudWxsLCAyKSlcbiAgICBhLmNsaWNrKClcbiAgICBEb2MuaGlkZShwYWdlLmZvcm1zKVxuICB9XG5cbiAgLy8gdG9nZ2xlQWNjb3VudFN0YXR1cyBlbmFibGVzIG9yIGRpc2FibGVzIHRoZSBhY2NvdW50IGFzc29jaWF0ZWQgd2l0aCB0aGVcbiAgLy8gcHJvdmlkZWQgaG9zdC5cbiAgYXN5bmMgdG9nZ2xlQWNjb3VudFN0YXR1cyAoZGlzYWJsZTpib29sZWFuKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuZXJyTXNnKVxuICAgIGxldCBob3N0OiBzdHJpbmd8bnVsbCA9IHRoaXMuaG9zdFxuICAgIGlmIChkaXNhYmxlKSBob3N0ID0gcGFnZS5kaXNhYmxlQWNjb3VudEhvc3QudGV4dENvbnRlbnRcbiAgICBjb25zdCByZXEgPSB7IGhvc3QsIGRpc2FibGU6IGRpc2FibGUgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5ib2R5KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3RvZ2dsZWFjY291bnRzdGF0dXMnLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgaWYgKGRpc2FibGUpIHtcbiAgICAgICAgcGFnZS5kaXNhYmxlQWNjb3VudEVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgICAgRG9jLnNob3cocGFnZS5kaXNhYmxlQWNjb3VudEVycilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhZ2UuZXJyTXNnLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgICBEb2Muc2hvdyhwYWdlLmVyck1zZylcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoZGlzYWJsZSkge1xuICAgICAgdGhpcy5wYWdlLnRvZ2dsZUFjY291bnRTdGF0dXNCdG4udGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9FTkFCTEVfQUNDT1VOVClcbiAgICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gICAgfSBlbHNlIHRoaXMucGFnZS50b2dnbGVBY2NvdW50U3RhdHVzQnRuLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfRElTQUJMRV9BQ0NPVU5UKVxuXG4gICAgdGhpcy5hY2NvdW50RGlzYWJsZWQgPSBkaXNhYmxlXG4gICAgYXBwKCkubG9hZFBhZ2UoYGRleHNldHRpbmdzLyR7aG9zdH1gKVxuICB9XG5cbiAgYXN5bmMgcHJlcGFyZUFjY291bnREaXNhYmxlIChkaXNhYmxlQWNjb3VudEZvcm06IEhUTUxFbGVtZW50KSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UuZGlzYWJsZUFjY291bnRIb3N0LnRleHRDb250ZW50ID0gdGhpcy5ob3N0XG4gICAgcGFnZS5kaXNhYmxlQWNjb3VudEVyci50ZXh0Q29udGVudCA9ICcnXG4gICAgdGhpcy5zaG93Rm9ybShkaXNhYmxlQWNjb3VudEZvcm0pXG4gIH1cblxuICAvLyBSZXRyaWV2ZSBhbiBlc3RpbWF0ZSBmb3IgdGhlIHR4IGZlZSBuZWVkZWQgdG8gY3JlYXRlIG5ldyBib25kIHJlc2VydmVzLlxuICBhc3luYyBnZXRCb25kc0ZlZUJ1ZmZlciAoYXNzZXRJRDogbnVtYmVyLCBmb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcoZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9ib25kc2ZlZWJ1ZmZlcicsIHsgYXNzZXRJRCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHJldHVybiAwXG4gICAgfVxuICAgIHJldHVybiByZXMuZmVlQnVmZmVyXG4gIH1cblxuICBhc3luYyBwcmVwYXJlVXBkYXRlSG9zdCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHRoaXMuZGV4QWRkckZvcm0ucmVmcmVzaCgpXG4gICAgdGhpcy5zaG93Rm9ybShwYWdlLmRleEFkZHJGb3JtKVxuICB9XG5cbiAgYXN5bmMgb25DZXJ0RmlsZUNoYW5nZSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuZXJyTXNnKVxuICAgIGNvbnN0IGZpbGVzID0gcGFnZS5jZXJ0RmlsZUlucHV0LmZpbGVzXG4gICAgbGV0IGNlcnRcbiAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoKSBjZXJ0ID0gYXdhaXQgZmlsZXNbMF0udGV4dCgpXG4gICAgaWYgKCFjZXJ0KSByZXR1cm5cbiAgICBjb25zdCByZXEgPSB7IGhvc3Q6IHRoaXMuaG9zdCwgY2VydDogY2VydCB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmJvZHkpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvdXBkYXRlY2VydCcsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmVyck1zZy50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UuZXJyTXNnKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnVwZGF0ZUNlcnRNc2cpXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHsgRG9jLmhpZGUocGFnZS51cGRhdGVDZXJ0TXNnKSB9LCA1MDAwKVxuICAgIH1cbiAgfVxuXG4gIHNldENvbm5lY3Rpb25TdGF0dXMgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBleGNoYW5nZSA9IGFwcCgpLnVzZXIuZXhjaGFuZ2VzW3RoaXMuaG9zdF1cbiAgICBjb25zdCBkaXNwbGF5SWNvbnMgPSAoY29ubmVjdGVkOiBib29sZWFuKSA9PiB7XG4gICAgICBpZiAoY29ubmVjdGVkKSB7XG4gICAgICAgIERvYy5oaWRlKHBhZ2UuZGlzY29ubmVjdGVkSWNvbilcbiAgICAgICAgRG9jLnNob3cocGFnZS5jb25uZWN0ZWRJY29uKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS5kaXNjb25uZWN0ZWRJY29uKVxuICAgICAgICBEb2MuaGlkZShwYWdlLmNvbm5lY3RlZEljb24pXG4gICAgICB9XG4gICAgfVxuICAgIGlmIChleGNoYW5nZSkge1xuICAgICAgc3dpdGNoIChleGNoYW5nZS5jb25uZWN0aW9uU3RhdHVzKSB7XG4gICAgICAgIGNhc2UgQ29ubmVjdGlvblN0YXR1cy5Db25uZWN0ZWQ6XG4gICAgICAgICAgZGlzcGxheUljb25zKHRydWUpXG4gICAgICAgICAgcGFnZS5jb25uZWN0aW9uU3RhdHVzLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQ09OTkVDVEVEKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgQ29ubmVjdGlvblN0YXR1cy5EaXNjb25uZWN0ZWQ6XG4gICAgICAgICAgZGlzcGxheUljb25zKGZhbHNlKVxuICAgICAgICAgIGlmICh0aGlzLmFjY291bnREaXNhYmxlZCkgcGFnZS5jb25uZWN0aW9uU3RhdHVzLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQUNDT1VOVF9ESVNBQkxFRF9NU0cpXG4gICAgICAgICAgZWxzZSBwYWdlLmNvbm5lY3Rpb25TdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9ESVNDT05ORUNURUQpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBDb25uZWN0aW9uU3RhdHVzLkludmFsaWRDZXJ0OlxuICAgICAgICAgIGRpc3BsYXlJY29ucyhmYWxzZSlcbiAgICAgICAgICBwYWdlLmNvbm5lY3Rpb25TdGF0dXMudGV4dENvbnRlbnQgPSBgJHtpbnRsLnByZXAoaW50bC5JRF9ESVNDT05ORUNURUQpfSAtICR7aW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9DRVJUSUZJQ0FURSl9YFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRpc2FibGVBdXRvUmVuZXcgKCkge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5wYWdlLm90aGVyQm9uZFNldHRpbmdzKVxuICAgIHRyeSB7XG4gICAgICB0aGlzLnVwZGF0ZUJvbmRPcHRpb25zKHsgdGFyZ2V0VGllcjogMCB9KVxuICAgICAgbG9hZGVkKClcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2FkZWQoKVxuICAgICAgdGhyb3cgZVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZUJvbmRPcHRpb25zIGlzIGNhbGxlZCB3aGVuIHRoZSBmb3JtIHRvIHVwZGF0ZSBib25kIG9wdGlvbnMgaXNcbiAgICogc3VibWl0dGVkLlxuICAgKi9cbiAgYXN5bmMgdXBkYXRlQm9uZE9wdGlvbnMgKGNvbmY6IEJvbmRPcHRpb25zRm9ybSk6IFByb21pc2U8YW55PiB7XG4gICAgY29uZi5ob3N0ID0gdGhpcy5ob3N0XG4gICAgYXdhaXQgcG9zdEpTT04oJy9hcGkvdXBkYXRlYm9uZG9wdGlvbnMnLCBjb25mKVxuICAgIGNvbnN0IHRhcmdldFRpZXIgPSBjb25mLnRhcmdldFRpZXIgPz8gYXBwKCkuZXhjaGFuZ2VzW3RoaXMuaG9zdF0uYXV0aC50YXJnZXRUaWVyXG4gICAgdGhpcy5yZW5ld1RvZ2dsZS5zZXRTdGF0ZSh0YXJnZXRUaWVyID4gMClcbiAgfVxuXG4gIGFzeW5jIG5ld1dhbGxldENyZWF0ZWQgKGFzc2V0SUQ6IG51bWJlciwgdGllcjogbnVtYmVyKSB7XG4gICAgdGhpcy5yZWdBc3NldEZvcm0ucmVmcmVzaCgpXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgaWYgKCF1c2VyKSByZXR1cm5cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYXNzZXQgPSB1c2VyLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHdhbGxldCA9IGFzc2V0LndhbGxldFxuICAgIGNvbnN0IHhjID0gYXBwKCkuZXhjaGFuZ2VzW3RoaXMuaG9zdF1cbiAgICBjb25zdCBib25kQW10ID0geGMuYm9uZEFzc2V0c1thc3NldC5zeW1ib2xdLmFtb3VudFxuXG4gICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0RmVlcyhhc3NldElELCBib25kc0ZlZUJ1ZmZlcilcblxuICAgIGlmICh3YWxsZXQuc3luY2VkICYmIHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA+PSAyICogYm9uZEFtdCArIGJvbmRzRmVlQnVmZmVyKSB7XG4gICAgICB0aGlzLnByb2dyZXNzVGllckZvcm1XaXRoU3luY2VkRnVuZGVkV2FsbGV0KGFzc2V0SUQpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLndhbGxldFdhaXRGb3JtLnNldFdhbGxldChhc3NldElELCBib25kc0ZlZUJ1ZmZlciwgdGllcilcbiAgICBhd2FpdCB0aGlzLnNob3dGb3JtKHBhZ2Uud2FsbGV0V2FpdClcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQge1xuICBVbml0SW5mbyxcbiAgTGF5b3V0TWV0cmljcyxcbiAgV2FsbGV0U3RhdGUsXG4gIFBhZ2VFbGVtZW50XG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgU3RhdGUgZnJvbSAnLi9zdGF0ZSdcblxuLy8gU3ltYm9saXplciBpcyBzYXRpc2ZpZWQgYnkgYm90aCBkZXguQXNzZXQgYW5kIGNvcmUuU3VwcG9ydGVkQXNzZXQuIFVzZWQgYnlcbi8vIERvYy5zeW1ib2xpemUuXG5pbnRlcmZhY2UgU3ltYm9saXplciB7XG4gIHN5bWJvbDogc3RyaW5nXG4gIHVuaXRJbmZvOiBVbml0SW5mb1xufVxuXG5jb25zdCBwYXJzZXIgPSBuZXcgd2luZG93LkRPTVBhcnNlcigpXG5cbmNvbnN0IEZQUyA9IDMwXG5cbmNvbnN0IEJpcElEczogUmVjb3JkPG51bWJlciwgc3RyaW5nPiA9IHtcbiAgMDogJ2J0YycsXG4gIDQyOiAnZGNyJyxcbiAgMjogJ2x0YycsXG4gIDU6ICdkYXNoJyxcbiAgMjA6ICdkZ2InLFxuICAyMjogJ21vbmEnLFxuICAyODogJ3Z0YycsXG4gIDM6ICdkb2dlJyxcbiAgMTQ1OiAnYmNoJyxcbiAgNjA6ICdldGgnLFxuICA2MDAwMTogJ3VzZGMuZXRoJyxcbiAgNjAwMDI6ICd1c2R0LmV0aCcsXG4gIDYwMDAzOiAnbWF0aWMuZXRoJyxcbiAgMTM2OiAnZmlybycsXG4gIDEzMzogJ3plYycsXG4gIDk2NjogJ3BvbHlnb24nLFxuICA5NjYwMDE6ICd1c2RjLnBvbHlnb24nLFxuICA5NjYwMDI6ICd3ZXRoLnBvbHlnb24nLFxuICA5NjYwMDM6ICd3YnRjLnBvbHlnb24nLFxuICA5NjYwMDQ6ICd1c2R0LnBvbHlnb24nLFxuICAxNDc6ICd6Y2wnXG59XG5cbmNvbnN0IEJpcFN5bWJvbElEczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuKGZ1bmN0aW9uICgpIHtcbiAgZm9yIChjb25zdCBrIG9mIE9iamVjdC5rZXlzKEJpcElEcykpIHtcbiAgICBCaXBTeW1ib2xJRHNbQmlwSURzW3BhcnNlSW50KGspXV0gPSBwYXJzZUludChrKVxuICB9XG59KSgpXG5cbmNvbnN0IEJpcFN5bWJvbHMgPSBPYmplY3QudmFsdWVzKEJpcElEcylcblxuY29uc3QgUmF0ZUVuY29kaW5nRmFjdG9yID0gMWU4IC8vIHNhbWUgYXMgdmFsdWUgZGVmaW5lZCBpbiAuL29yZGVydXRpbFxuXG5jb25zdCBsb2cxMFJhdGVFbmNvZGluZ0ZhY3RvciA9IE1hdGgucm91bmQoTWF0aC5sb2cxMChSYXRlRW5jb2RpbmdGYWN0b3IpKVxuXG5jb25zdCBsYW5ndWFnZXMgPSBuYXZpZ2F0b3IubGFuZ3VhZ2VzLmZpbHRlcigobG9jYWxlOiBzdHJpbmcpID0+IGxvY2FsZSAhPT0gJ2MnKVxuXG5jb25zdCBpbnRGb3JtYXR0ZXIgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQobGFuZ3VhZ2VzLCB7IG1heGltdW1GcmFjdGlvbkRpZ2l0czogMCB9KVxuXG5jb25zdCBmb3VyU2lnRmlncyA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChsYW5ndWFnZXMsIHtcbiAgbWluaW11bVNpZ25pZmljYW50RGlnaXRzOiA0LFxuICBtYXhpbXVtU2lnbmlmaWNhbnREaWdpdHM6IDRcbn0pXG5cbi8qIEEgY2FjaGUgZm9yIGZvcm1hdHRlcnMgdXNlZCBmb3IgRG9jLmZvcm1hdENvaW5WYWx1ZS4gKi9cbmNvbnN0IGRlY2ltYWxGb3JtYXR0ZXJzOiBSZWNvcmQ8bnVtYmVyLCBJbnRsLk51bWJlckZvcm1hdD4gPSB7fVxuXG4vKlxuICogZGVjaW1hbEZvcm1hdHRlciBnZXRzIHRoZSBmb3JtYXRDb2luVmFsdWUgZm9ybWF0dGVyIGZvciB0aGUgc3BlY2lmaWVkIGRlY2ltYWxcbiAqIHByZWNpc2lvbi5cbiAqL1xuZnVuY3Rpb24gZGVjaW1hbEZvcm1hdHRlciAocHJlYzogbnVtYmVyKSB7XG4gIHJldHVybiBmb3JtYXR0ZXIoZGVjaW1hbEZvcm1hdHRlcnMsIDIsIHByZWMpXG59XG5cbi8qIEEgY2FjaGUgZm9yIGZvcm1hdHRlcnMgdXNlZCBmb3IgRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24uICovXG5jb25zdCBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyczogUmVjb3JkPG51bWJlciwgSW50bC5OdW1iZXJGb3JtYXQ+ID0ge31cblxuLypcbiAqIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXIgZ2V0cyB0aGUgZm9ybWF0RnVsbFByZWNpc2lvbiBmb3JtYXR0ZXIgZm9yIHRoZVxuICogc3BlY2lmaWVkIGRlY2ltYWwgcHJlY2lzaW9uLlxuICovXG5mdW5jdGlvbiBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyIChwcmVjOiBudW1iZXIsIGxvY2FsZXM/OiBzdHJpbmcgfCBzdHJpbmdbXSkge1xuICByZXR1cm4gZm9ybWF0dGVyKGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXJzLCBwcmVjLCBwcmVjLCBsb2NhbGVzKVxufVxuXG4vKlxuICogZm9ybWF0dGVyIGdldHMgdGhlIGZvcm1hdHRlciBmcm9tIHRoZSBzdXBwbGllZCBjYWNoZSBpZiBpdCBhbHJlYWR5IGV4aXN0cyxcbiAqIGVsc2UgY3JlYXRlcyBpdC5cbiAqL1xuZnVuY3Rpb24gZm9ybWF0dGVyIChmb3JtYXR0ZXJzOiBSZWNvcmQ8c3RyaW5nLCBJbnRsLk51bWJlckZvcm1hdD4sIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlciwgbG9jYWxlcz86IHN0cmluZyB8IHN0cmluZ1tdKTogSW50bC5OdW1iZXJGb3JtYXQge1xuICBjb25zdCBrID0gYCR7bWlufS0ke21heH1gXG4gIGxldCBmbXQgPSBmb3JtYXR0ZXJzW2tdXG4gIGlmICghZm10KSB7XG4gICAgZm10ID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KGxvY2FsZXMgPz8gbGFuZ3VhZ2VzLCB7XG4gICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IG1pbixcbiAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogbWF4XG4gICAgfSlcbiAgICBmb3JtYXR0ZXJzW2tdID0gZm10XG4gIH1cbiAgcmV0dXJuIGZtdFxufVxuXG4vKlxuICogY29udmVydFRvQ29udmVudGlvbmFsIGNvbnZlcnRzIHRoZSB2YWx1ZSBpbiBhdG9taWMgdW5pdHMgdG8gY29udmVudGlvbmFsXG4gKiB1bml0cy5cbiAqL1xuZnVuY3Rpb24gY29udmVydFRvQ29udmVudGlvbmFsICh2OiBudW1iZXIsIHVuaXRJbmZvPzogVW5pdEluZm8pIHtcbiAgbGV0IHByZWMgPSA4XG4gIGlmICh1bml0SW5mbykge1xuICAgIGNvbnN0IGYgPSB1bml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIHYgLz0gZlxuICAgIHByZWMgPSBNYXRoLnJvdW5kKE1hdGgubG9nMTAoZikpXG4gIH1cbiAgcmV0dXJuIFt2LCBwcmVjXVxufVxuXG4vKlxuICogYmVzdERpc3BsYXlPcmRlciBpcyB1c2VkIGluIGJlc3RDb252ZXJzaW9uLCBhbmQgaXMgdGhlIG9yZGVyIG9mIG1hZ25pdHVkZVxuICogdGhhdCBpcyBjb25zaWRlcmVkIHRoZSBiZXN0IGZvciBkaXNwbGF5LiBGb3IgZXhhbXBsZSwgaWYgYmVzdERpc3BsYXlPcmRlciBpc1xuICogMSwgYW5kIHRoZSBjaG9pY2VzIGZvciBkaXNwbGF5IGFyZSAxLDAwMCBCVEMgb3IgMC4wMDAwMSBTYXRzLCB0aGUgYWxnb3JpdGhtXG4gKiB3aWxsIGxvb2sgYXQgdGhlIG9yZGVycyBvZiB0aGUgY29udmVyc2lvbnMsIDEwMDAgPT4gMTBeMyA9PiBvcmRlciAzLCBhbmRcbiAqIDAuMDAwMDEgPT4gMTBeLTUgPT4gb3JkZXIgNSwgYW5kIHNlZSB3aGljaCBpcyBjbG9zZXN0IHRvIGJlc3REaXNwbGF5T3JkZXIgYW5kXG4gKiBjaG9vc2UgdGhhdCBjb252ZXJzaW9uLiBJbiB0aGUgZXhhbXBsZSwgMyAtIGJlc3REaXNwbGF5T3JkZXIgPSAyIGFuZFxuICogMSAtICgtNSkgPSA2LCBzbyB0aGUgY29udmVyc2lvbiB0aGF0IGhhcyB0aGUgb3JkZXIgY2xvc2VzdCB0b1xuICogYmVzdERpc3BsYXlPcmRlciBpcyB0aGUgZmlyc3Qgb25lLCAxLDAwMCBCVEMuXG4gKi9cbmNvbnN0IGJlc3REaXNwbGF5T3JkZXIgPSAxIC8vIDEwXjEgPT4gMVxuXG4vKlxuICogcmVzb2x2ZVVuaXRDb252ZXJzaW9ucyBjcmVhdGVzIGEgbG9va3VwIG9iamVjdCBtYXBwaW5nIHVuaXQgLT4gY29udmVyc2lvblxuICogZmFjdG9yLiBCeSBkZWZhdWx0LCByZXNvbHZlVW5pdENvbnZlcnNpb25zIG9ubHkgbWFwcyB0aGUgYXRvbWljIGFuZFxuICogY29udmVudGlvbmFsIHVuaXRzLiBJZiBhIHByZWZzIGRpY3QgaXMgcHJvdmlkZWQsIGFkZGl0aW9uYWwgdW5pdHMgY2FuIGJlXG4gKiBpbmNsdWRlZC5cbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZVVuaXRDb252ZXJzaW9ucyAodWk6IFVuaXRJbmZvLCBwcmVmcz86IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+KTogUmVjb3JkPHN0cmluZywgbnVtYmVyPiB7XG4gIGNvbnN0IHVuaXRGYWN0b3JzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge1xuICAgIFt1aS5hdG9taWNVbml0XTogMSxcbiAgICBbdWkuY29udmVudGlvbmFsLnVuaXRdOiB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICB9XG4gIGlmICh1aS5kZW5vbWluYXRpb25zICYmIHByZWZzKSB7XG4gICAgZm9yIChjb25zdCBhbHQgb2YgdWkuZGVub21pbmF0aW9ucykgaWYgKHByZWZzW2FsdC51bml0XSkgdW5pdEZhY3RvcnNbYWx0LnVuaXRdID0gYWx0LmNvbnZlcnNpb25GYWN0b3JcbiAgfVxuICByZXR1cm4gdW5pdEZhY3RvcnNcbn1cblxuLy8gSGVscGVycyBmb3Igd29ya2luZyB3aXRoIHRoZSBET00uXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb2Mge1xuICAvKlxuICAgKiBpZGVsIGlzIHRoZSBlbGVtZW50IHdpdGggdGhlIHNwZWNpZmllZCBpZCB0aGF0IGlzIHRoZSBkZXNjZW5kZW50IG9mIHRoZVxuICAgKiBzcGVjaWZpZWQgbm9kZS5cbiAgICovXG4gIHN0YXRpYyBpZGVsIChlbDogRG9jdW1lbnQgfCBFbGVtZW50LCBpZDogc3RyaW5nKTogSFRNTEVsZW1lbnQge1xuICAgIHJldHVybiBlbC5xdWVyeVNlbGVjdG9yKGAjJHtpZH1gKSBhcyBIVE1MRWxlbWVudFxuICB9XG5cbiAgLyogYmluZCBiaW5kcyB0aGUgZnVuY3Rpb24gdG8gdGhlIGV2ZW50IGZvciB0aGUgZWxlbWVudC4gKi9cbiAgc3RhdGljIGJpbmQgKGVsOiBFdmVudFRhcmdldCwgZXY6IHN0cmluZyB8IHN0cmluZ1tdLCBmOiBFdmVudExpc3RlbmVyT3JFdmVudExpc3RlbmVyT2JqZWN0LCBvcHRzPzogYW55IC8qIEV2ZW50TGlzdGVuZXJPcHRpb25zICovKTogdm9pZCB7XG4gICAgZm9yIChjb25zdCBlIG9mIChBcnJheS5pc0FycmF5KGV2KSA/IGV2IDogW2V2XSkpIGVsLmFkZEV2ZW50TGlzdGVuZXIoZSwgZiwgb3B0cylcbiAgfVxuXG4gIC8qIHVuYmluZCByZW1vdmVzIHRoZSBoYW5kbGVyIGZvciB0aGUgZXZlbnQgZnJvbSB0aGUgZWxlbWVudC4gKi9cbiAgc3RhdGljIHVuYmluZCAoZWw6IEV2ZW50VGFyZ2V0LCBldjogc3RyaW5nLCBmOiAoZTogRXZlbnQpID0+IHZvaWQpOiB2b2lkIHtcbiAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKGV2LCBmKVxuICB9XG5cbiAgLyogbm9kZXJpemUgY3JlYXRlcyBhIERvY3VtZW50IG9iamVjdCBmcm9tIGEgc3RyaW5nIG9mIEhUTUwuICovXG4gIHN0YXRpYyBub2Rlcml6ZSAoaHRtbDogc3RyaW5nKTogRG9jdW1lbnQge1xuICAgIHJldHVybiBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKGh0bWwsICd0ZXh0L2h0bWwnKVxuICB9XG5cbiAgLypcbiAgICogbW91c2VJbkVsZW1lbnQgcmV0dXJucyB0cnVlIGlmIHRoZSBwb3NpdGlvbiBvZiBtb3VzZSBldmVudCwgZSwgaXMgd2l0aGluXG4gICAqIHRoZSBib3VuZHMgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IG9yIGFueSBvZiBpdHMgZGVzY2VuZGVudHMuXG4gICAqL1xuICBzdGF0aWMgbW91c2VJbkVsZW1lbnQgKGU6IE1vdXNlRXZlbnQsIGVsOiBIVE1MRWxlbWVudCk6IGJvb2xlYW4ge1xuICAgIGlmIChlbC5jb250YWlucyhlLnRhcmdldCBhcyBOb2RlKSkgcmV0dXJuIHRydWVcbiAgICBjb25zdCByZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICByZXR1cm4gZS5wYWdlWCA+PSByZWN0LmxlZnQgJiYgZS5wYWdlWCA8PSByZWN0LnJpZ2h0ICYmXG4gICAgICBlLnBhZ2VZID49IHJlY3QudG9wICYmIGUucGFnZVkgPD0gcmVjdC5ib3R0b21cbiAgfVxuXG4gIC8qXG4gICAqIGxheW91dE1ldHJpY3MgZ2V0cyBpbmZvcm1hdGlvbiBhYm91dCB0aGUgZWxlbWVudHMgcG9zaXRpb24gb24gdGhlIHBhZ2UuXG4gICAqL1xuICBzdGF0aWMgbGF5b3V0TWV0cmljcyAoZWw6IEhUTUxFbGVtZW50KTogTGF5b3V0TWV0cmljcyB7XG4gICAgY29uc3QgYm94ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICBjb25zdCBkb2NFbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxuICAgIGNvbnN0IHRvcCA9IGJveC50b3AgKyBkb2NFbC5zY3JvbGxUb3BcbiAgICBjb25zdCBsZWZ0ID0gYm94LmxlZnQgKyBkb2NFbC5zY3JvbGxMZWZ0XG4gICAgY29uc3QgdyA9IGVsLm9mZnNldFdpZHRoXG4gICAgY29uc3QgaCA9IGVsLm9mZnNldEhlaWdodFxuICAgIHJldHVybiB7XG4gICAgICBib2R5VG9wOiB0b3AsXG4gICAgICBib2R5TGVmdDogbGVmdCxcbiAgICAgIHdpZHRoOiB3LFxuICAgICAgaGVpZ2h0OiBoLFxuICAgICAgY2VudGVyWDogbGVmdCArIHcgLyAyLFxuICAgICAgY2VudGVyWTogdG9wICsgaCAvIDJcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgZGVzY2VuZGVudE1ldHJpY3MgKHBhcmVudDogUGFnZUVsZW1lbnQsIGtpZDogUGFnZUVsZW1lbnQpOiBMYXlvdXRNZXRyaWNzIHtcbiAgICBjb25zdCBwYXJlbnRNZXRyaWNzID0gRG9jLmxheW91dE1ldHJpY3MocGFyZW50KVxuICAgIGNvbnN0IGtpZE1ldHJpY3MgPSBEb2MubGF5b3V0TWV0cmljcyhraWQpXG4gICAgcmV0dXJuIHtcbiAgICAgIGJvZHlUb3A6IGtpZE1ldHJpY3MuYm9keVRvcCAtIHBhcmVudE1ldHJpY3MuYm9keVRvcCxcbiAgICAgIGJvZHlMZWZ0OiBraWRNZXRyaWNzLmJvZHlMZWZ0IC0gcGFyZW50TWV0cmljcy5ib2R5TGVmdCxcbiAgICAgIHdpZHRoOiBraWRNZXRyaWNzLndpZHRoLFxuICAgICAgaGVpZ2h0OiBraWRNZXRyaWNzLmhlaWdodCxcbiAgICAgIGNlbnRlclg6IGtpZE1ldHJpY3MuY2VudGVyWCAtIHBhcmVudE1ldHJpY3MuYm9keUxlZnQsXG4gICAgICBjZW50ZXJZOiBraWRNZXRyaWNzLmNlbnRlclkgLSBwYXJlbnRNZXRyaWNzLmJvZHlUb3BcbiAgICB9XG4gIH1cblxuICAvKiBlbXB0eSByZW1vdmVzIGFsbCBjaGlsZCBub2RlcyBmcm9tIHRoZSBzcGVjaWZpZWQgZWxlbWVudC4gKi9cbiAgc3RhdGljIGVtcHR5ICguLi5lbHM6IEVsZW1lbnRbXSkge1xuICAgIGZvciAoY29uc3QgZWwgb2YgZWxzKSB3aGlsZSAoZWwuZmlyc3RDaGlsZCkgZWwucmVtb3ZlQ2hpbGQoZWwuZmlyc3RDaGlsZClcbiAgfVxuXG4gIC8qXG4gICAqIHNldENvbnRlbnQgcmVtb3ZlcyBhbGwgY2hpbGQgbm9kZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgYW5kIGFwcGVuZHNcbiAgICogcGFzc2VkIGVsZW1lbnRzLlxuICAgKi9cbiAgc3RhdGljIHNldENvbnRlbnQgKGFuY2VzdG9yOiBQYWdlRWxlbWVudCwgLi4ua2lkczogUGFnZUVsZW1lbnRbXSkge1xuICAgIERvYy5lbXB0eShhbmNlc3RvcilcbiAgICBmb3IgKGNvbnN0IGsgb2Yga2lkcykgYW5jZXN0b3IuYXBwZW5kQ2hpbGQoaylcbiAgfVxuXG4gIC8qXG4gICAqIGhpZGUgaGlkZXMgdGhlIHNwZWNpZmllZCBlbGVtZW50cy4gVGhpcyBpcyBhY2NvbXBsaXNoZWQgYnkgYWRkaW5nIHRoZVxuICAgKiBib290c3RyYXAgZC1oaWRlIGNsYXNzIHRvIHRoZSBlbGVtZW50LiBVc2UgRG9jLnNob3cgdG8gdW5kby5cbiAgICovXG4gIHN0YXRpYyBoaWRlICguLi5lbHM6IEVsZW1lbnRbXSkge1xuICAgIGZvciAoY29uc3QgZWwgb2YgZWxzKSBlbC5jbGFzc0xpc3QuYWRkKCdkLWhpZGUnKVxuICB9XG5cbiAgLypcbiAgICogc2hvdyBzaG93cyB0aGUgc3BlY2lmaWVkIGVsZW1lbnRzLiBUaGlzIGlzIGFjY29tcGxpc2hlZCBieSByZW1vdmluZyB0aGVcbiAgICogYm9vdHN0cmFwIGQtaGlkZSBjbGFzcyBhcyBhZGRlZCB3aXRoIERvYy5oaWRlLlxuICAgKi9cbiAgc3RhdGljIHNob3cgKC4uLmVsczogRWxlbWVudFtdKSB7XG4gICAgZm9yIChjb25zdCBlbCBvZiBlbHMpIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2QtaGlkZScpXG4gIH1cblxuICAvKlxuICAgKiBzaG93IG9yIGhpZGUgdGhlIHNwZWNpZmllZCBlbGVtZW50cywgYmFzZWQgb24gdmFsdWUgb2YgdGhlIHRydXRoaW5lc3Mgb2ZcbiAgICogdmlzLlxuICAgKi9cbiAgc3RhdGljIHNldFZpcyAodmlzOiBhbnksIC4uLmVsczogRWxlbWVudFtdKSB7XG4gICAgaWYgKHZpcykgRG9jLnNob3coLi4uZWxzKVxuICAgIGVsc2UgRG9jLmhpZGUoLi4uZWxzKVxuICB9XG5cbiAgLyogaXNIaWRkZW4gcmV0dXJucyB0cnVlIGlmIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBpcyBoaWRkZW4gKi9cbiAgc3RhdGljIGlzSGlkZGVuIChlbDogRWxlbWVudCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBlbC5jbGFzc0xpc3QuY29udGFpbnMoJ2QtaGlkZScpXG4gIH1cblxuICAvKiBpc0Rpc3BsYXllZCByZXR1cm5zIHRydWUgaWYgdGhlIHNwZWNpZmllZCBlbGVtZW50IGlzIG5vdCBoaWRkZW4gKi9cbiAgc3RhdGljIGlzRGlzcGxheWVkIChlbDogRWxlbWVudCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdkLWhpZGUnKVxuICB9XG5cbiAgLypcbiAgICogYW5pbWF0ZSBydW5zIHRoZSBzdXBwbGllZCBmdW5jdGlvbiwgd2hpY2ggc2hvdWxkIGJlIGEgXCJwcm9ncmVzc1wiIGZ1bmN0aW9uXG4gICAqIGFjY2VwdGluZyBvbmUgYXJndW1lbnQuIFRoZSBwcm9ncmVzcyBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCByZXBlYXRlZGx5XG4gICAqIHdpdGggdGhlIGFyZ3VtZW50IHZhcnlpbmcgZnJvbSAwLjAgdG8gMS4wLiBUaGUgZXhhY3QgcGF0aCB0aGF0IGFuaW1hdGVcbiAgICogdGFrZXMgZnJvbSAwLjAgdG8gMS4wIHdpbGwgdmFyeSBkZXBlbmRpbmcgb24gdGhlIGNob2ljZSBvZiBlYXNpbmdcbiAgICogYWxnb3JpdGhtLiBTZWUgdGhlIEVhc2luZyBvYmplY3QgZm9yIHRoZSBhdmFpbGFibGUgZWFzaW5nIGFsZ28gY2hvaWNlcy4gVGhlXG4gICAqIGRlZmF1bHQgZWFzaW5nIGFsZ29yaXRobSBpcyBsaW5lYXIuXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgYW5pbWF0ZSAoZHVyYXRpb246IG51bWJlciwgZjogKHByb2dyZXNzOiBudW1iZXIpID0+IHZvaWQsIGVhc2luZ0FsZ28/OiBzdHJpbmcpIHtcbiAgICBhd2FpdCBuZXcgQW5pbWF0aW9uKGR1cmF0aW9uLCBmLCBlYXNpbmdBbGdvKS53YWl0KClcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBibGluayAoZWw6IFBhZ2VFbGVtZW50KSB7XG4gICAgY29uc3QgW3IsIGcsIGJdID0gU3RhdGUuaXNEYXJrKCkgPyBbMjU1LCAyNTUsIDI1NV0gOiBbMCwgMCwgMF1cbiAgICBjb25zdCBjeWNsZXMgPSAyXG4gICAgRG9jLmFuaW1hdGUoMTAwMCwgKHA6IG51bWJlcikgPT4ge1xuICAgICAgZWwuc3R5bGUub3V0bGluZSA9IGAycHggc29saWQgcmdiYSgke3J9LCAke2d9LCAke2J9LCAkeyhjeWNsZXMgLSBwICogY3ljbGVzKSAlIDF9KWBcbiAgICB9KVxuICB9XG5cbiAgc3RhdGljIGFwcGx5U2VsZWN0b3IgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCwgazogc3RyaW5nKTogUGFnZUVsZW1lbnRbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oYW5jZXN0b3IucXVlcnlTZWxlY3RvckFsbChrKSkgYXMgUGFnZUVsZW1lbnRbXVxuICB9XG5cbiAgc3RhdGljIGtpZHMgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCk6IFBhZ2VFbGVtZW50W10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGFuY2VzdG9yLmNoaWxkcmVuKSBhcyBQYWdlRWxlbWVudFtdXG4gIH1cblxuICBzdGF0aWMgc2FmZVNlbGVjdG9yIChhbmNlc3RvcjogSFRNTEVsZW1lbnQsIGs6IHN0cmluZyk6IFBhZ2VFbGVtZW50IHtcbiAgICBjb25zdCBlbCA9IGFuY2VzdG9yLnF1ZXJ5U2VsZWN0b3IoaylcbiAgICBpZiAoZWwpIHJldHVybiBlbCBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnNvbGUud2Fybihgbm8gZWxlbWVudCBmb3VuZCBmb3Igc2VsZWN0b3IgJyR7a30nIG9uIGVsZW1lbnQgLT5gLCBhbmNlc3RvcilcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgfVxuXG4gIC8qXG4gICAqIGlkRGVzY2VuZGFudHMgY3JlYXRlcyBhbiBvYmplY3QgbWFwcGluZyB0byBlbGVtZW50cyB3aGljaCBhcmUgZGVzY2VuZGFudHNcbiAgICogb2YgdGhlIGFuY2VzdG9yIGFuZCBoYXZlIGlkIGF0dHJpYnV0ZXMuIEVsZW1lbnRzIGFyZSBrZXllZCBieSB0aGVpciBpZFxuICAgKiB2YWx1ZS5cbiAgICovXG4gIHN0YXRpYyBpZERlc2NlbmRhbnRzIChhbmNlc3RvcjogSFRNTEVsZW1lbnQpOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD4ge1xuICAgIGNvbnN0IGQ6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PiA9IHt9XG4gICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3RvcihhbmNlc3RvciwgJ1tpZF0nKSkgZFtlbC5pZF0gPSBlbFxuICAgIHJldHVybiBkXG4gIH1cblxuICAvKlxuICAgKiBmb3JtYXRDb2luVmFsdWUgZm9ybWF0cyB0aGUgdmFsdWUgaW4gYXRvbWljIHVuaXRzIGludG8gYSBzdHJpbmdcbiAgICogcmVwcmVzZW50YXRpb24gaW4gY29udmVudGlvbmFsIHVuaXRzLiBJZiB0aGUgdmFsdWUgaGFwcGVucyB0byBiZSBhblxuICAgKiBpbnRlZ2VyLCBubyBkZWNpbWFscyBhcmUgZGlzcGxheWVkLiBUcmFpbGluZyB6ZXJvcyBtYXkgYmUgdHJ1bmNhdGVkLlxuICAgKi9cbiAgc3RhdGljIGZvcm1hdENvaW5WYWx1ZSAodkF0b21pYzogbnVtYmVyLCB1bml0SW5mbz86IFVuaXRJbmZvKTogc3RyaW5nIHtcbiAgICBjb25zdCBbdiwgcHJlY10gPSBjb252ZXJ0VG9Db252ZW50aW9uYWwodkF0b21pYywgdW5pdEluZm8pXG4gICAgaWYgKE51bWJlci5pc0ludGVnZXIodikpIHJldHVybiBpbnRGb3JtYXR0ZXIuZm9ybWF0KHYpXG4gICAgcmV0dXJuIGRlY2ltYWxGb3JtYXR0ZXIocHJlYykuZm9ybWF0KHYpXG4gIH1cblxuICBzdGF0aWMgY29udmVudGlvbmFsQ29pblZhbHVlICh2QXRvbWljOiBudW1iZXIsIHVuaXRJbmZvPzogVW5pdEluZm8pOiBudW1iZXIge1xuICAgIGNvbnN0IFt2XSA9IGNvbnZlcnRUb0NvbnZlbnRpb25hbCh2QXRvbWljLCB1bml0SW5mbylcbiAgICByZXR1cm4gdlxuICB9XG5cbiAgLypcbiAgICogZm9ybWF0UmF0ZUZ1bGxQcmVjaXNpb24gZm9ybWF0cyByYXRlIHRvIHJlcHJlc2VudCBpdCBleGFjdGx5IGF0IHJhdGUgc3RlcFxuICAgKiBwcmVjaXNpb24sIHRyaW1taW5nIG5vbi1lZmZlY3R1YWwgemVyb3MgaWYgdGhlcmUgYXJlIGFueS5cbiAgICovXG4gIHN0YXRpYyBmb3JtYXRSYXRlRnVsbFByZWNpc2lvbiAoZW5jUmF0ZTogbnVtYmVyLCBidWk6IFVuaXRJbmZvLCBxdWk6IFVuaXRJbmZvLCByYXRlU3RlcEVuYzogbnVtYmVyKSB7XG4gICAgY29uc3QgciA9IGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAvIHF1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIGNvbnN0IGNvbnZSYXRlID0gZW5jUmF0ZSAqIHIgLyBSYXRlRW5jb2RpbmdGYWN0b3JcbiAgICBjb25zdCByYXRlU3RlcERpZ2l0cyA9IGxvZzEwUmF0ZUVuY29kaW5nRmFjdG9yIC0gTWF0aC5mbG9vcihNYXRoLmxvZzEwKHJhdGVTdGVwRW5jKSkgLVxuICAgICAgTWF0aC5mbG9vcihNYXRoLmxvZzEwKGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcikgLSBNYXRoLmxvZzEwKHF1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcikpXG4gICAgaWYgKHJhdGVTdGVwRGlnaXRzIDw9IDApIHJldHVybiBpbnRGb3JtYXR0ZXIuZm9ybWF0KGNvbnZSYXRlKVxuICAgIHJldHVybiBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyKHJhdGVTdGVwRGlnaXRzKS5mb3JtYXQoY29udlJhdGUpXG4gIH1cblxuICBzdGF0aWMgZm9ybWF0Rm91clNpZ0ZpZ3MgKG46IG51bWJlciwgbWF4RGVjaW1hbHM/OiBudW1iZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBmb3JtYXRTaWdGaWdzV2l0aEZvcm1hdHRlcnMoaW50Rm9ybWF0dGVyLCBmb3VyU2lnRmlncywgbiwgbWF4RGVjaW1hbHMpXG4gIH1cblxuICBzdGF0aWMgZm9ybWF0SW50IChpOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBpbnRGb3JtYXR0ZXIuZm9ybWF0KGkpXG4gIH1cblxuICAvKlxuICAgKiBmb3JtYXRGdWxsUHJlY2lzaW9uIGZvcm1hdHMgdGhlIHZhbHVlIGluIGF0b21pYyB1bml0cyBpbnRvIGEgc3RyaW5nXG4gICAqIHJlcHJlc2VudGF0aW9uIGluIGNvbnZlbnRpb25hbCB1bml0cyB1c2luZyB0aGUgZnVsbCBkZWNpbWFsIHByZWNpc2lvblxuICAgKiBhc3NvY2lhdGVkIHdpdGggdGhlIGNvbnZlbnRpb25hbCB1bml0J3MgY29udmVyc2lvbiBmYWN0b3IuXG4gICAqL1xuICBzdGF0aWMgZm9ybWF0RnVsbFByZWNpc2lvbiAodkF0b21pYzogbnVtYmVyLCB1bml0SW5mbz86IFVuaXRJbmZvKTogc3RyaW5nIHtcbiAgICBjb25zdCBbdiwgcHJlY10gPSBjb252ZXJ0VG9Db252ZW50aW9uYWwodkF0b21pYywgdW5pdEluZm8pXG4gICAgcmV0dXJuIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXIocHJlYykuZm9ybWF0KHYpXG4gIH1cblxuICAvKlxuICAgKiBmb3JtYXRGaWF0Q29udmVyc2lvbiBmb3JtYXRzIHRoZSB2YWx1ZSBpbiBhdG9taWMgdW5pdHMgdG8gaXRzIHJlcHJlc2VudGF0aW9uIGluXG4gICAqIGNvbnZlbnRpb25hbCB1bml0cyBhbmQgcmV0dXJucyB0aGUgZmlhdCB2YWx1ZSBhcyBhIHN0cmluZy5cbiAgICovXG4gIHN0YXRpYyBmb3JtYXRGaWF0Q29udmVyc2lvbiAodkF0b21pYzogbnVtYmVyLCByYXRlOiBudW1iZXIsIHVuaXRJbmZvPzogVW5pdEluZm8pOiBzdHJpbmcge1xuICAgIGlmICghcmF0ZSB8fCByYXRlID09PSAwKSByZXR1cm4gaW50bC5wcmVwKGludGwuSURfVU5BVkFJTEFCTEUpXG4gICAgY29uc3QgcHJlYyA9IDJcbiAgICBjb25zdCBbdl0gPSBjb252ZXJ0VG9Db252ZW50aW9uYWwodkF0b21pYywgdW5pdEluZm8pXG4gICAgY29uc3QgdmFsdWUgPSB2ICogcmF0ZVxuICAgIHJldHVybiBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyKHByZWMpLmZvcm1hdCh2YWx1ZSlcbiAgfVxuXG4gIHN0YXRpYyBsYW5ndWFnZXMgKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gbGFuZ3VhZ2VzXG4gIH1cblxuICBzdGF0aWMgZm9ybWF0RmlhdFZhbHVlICh2YWx1ZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gZnVsbFByZWNpc2lvbkZvcm1hdHRlcigyKS5mb3JtYXQodmFsdWUpXG4gIH1cblxuICAvKlxuICAgKiBiZXN0Q29udmVyc2lvbiBwaWNrcyB0aGUgYmVzdCBjb252ZXJzaW9uIGZhY3RvciBmb3IgdGhlIGF0b21pYyB2YWx1ZS4gVGhlXG4gICAqIGJlc3QgaXMgdGhlIG9uZSBpbiB3aGljaCBsb2cxMChjb252ZXJ0ZWRfdmFsdWUpIGlzIGNsb3Nlc3QgdG9cbiAgICogYmVzdERpc3BsYXlPcmRlci4gUmV0dXJuOiBbY29udmVydGVkX3ZhbHVlLCBwcmVjaXNpb24sIHVuaXRdLlxuICAgKi9cbiAgc3RhdGljIGJlc3RDb252ZXJzaW9uIChhdG9tczogbnVtYmVyLCB1aTogVW5pdEluZm8sIHByZWZzPzogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4pOiBbbnVtYmVyLCBudW1iZXIsIHN0cmluZ10ge1xuICAgIGNvbnN0IHVuaXRGYWN0b3JzID0gcmVzb2x2ZVVuaXRDb252ZXJzaW9ucyh1aSwgcHJlZnMpXG4gICAgY29uc3QgbG9nRGlmZnM6IFtzdHJpbmcsIG51bWJlcl1bXSA9IFtdXG4gICAgY29uc3QgZW50cnlEaWZmID0gKGVudHJ5OiBbc3RyaW5nLCBudW1iZXJdKSA9PiBNYXRoLmFicyhNYXRoLmxvZzEwKGF0b21zIC8gZW50cnlbMV0pIC0gYmVzdERpc3BsYXlPcmRlcilcbiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIE9iamVjdC5lbnRyaWVzKHVuaXRGYWN0b3JzKSkgbG9nRGlmZnMucHVzaChbZW50cnlbMF0sIGVudHJ5RGlmZihlbnRyeSldKVxuICAgIGNvbnN0IGJlc3QgPSBsb2dEaWZmcy5yZWR1Y2UoKGJlc3Q6IFtzdHJpbmcsIG51bWJlcl0sIGVudHJ5OiBbc3RyaW5nLCBudW1iZXJdKSA9PiBlbnRyeVsxXSA8IGJlc3RbMV0gPyBlbnRyeSA6IGJlc3QpXG4gICAgY29uc3QgdW5pdCA9IGJlc3RbMF1cbiAgICBjb25zdCBjRmFjdG9yID0gdW5pdEZhY3RvcnNbdW5pdF1cbiAgICBjb25zdCB2ID0gYXRvbXMgLyBjRmFjdG9yXG4gICAgcmV0dXJuIFt2LCBNYXRoLnJvdW5kKE1hdGgubG9nMTAoY0ZhY3RvcikpLCB1bml0XVxuICB9XG5cbiAgLypcbiAgICogZm9ybWF0QmVzdFVuaXRzRnVsbFByZWNpc2lvbiBmb3JtYXRzIHRoZSB2YWx1ZSB3aXRoIHRoZSBiZXN0IGNob2ljZSBvZlxuICAgKiB1bml0cywgYXQgZnVsbCBwcmVjaXNpb24uXG4gICAqL1xuICBzdGF0aWMgZm9ybWF0QmVzdFVuaXRzRnVsbFByZWNpc2lvbiAoYXRvbXM6IG51bWJlciwgdWk6IFVuaXRJbmZvLCBwcmVmcz86IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+KTogW3N0cmluZywgc3RyaW5nXSB7XG4gICAgY29uc3QgW3YsIHByZWMsIHVuaXRdID0gdGhpcy5iZXN0Q29udmVyc2lvbihhdG9tcywgdWksIHByZWZzKVxuICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKHYpKSByZXR1cm4gW2ludEZvcm1hdHRlci5mb3JtYXQodiksIHVuaXRdXG4gICAgcmV0dXJuIFtmdWxsUHJlY2lzaW9uRm9ybWF0dGVyKHByZWMpLmZvcm1hdCh2KSwgdW5pdF1cbiAgfVxuXG4gIC8qXG4gICAqIGZvcm1hdEJlc3RVbml0c0ZvdXJTaWdGaWdzIGZvcm1hdHMgdGhlIHZhbHVlIHdpdGggdGhlIGJlc3QgY2hvaWNlIG9mXG4gICAqIHVuaXRzIGFuZCByb3VuZGVkIHRvIGZvdXIgc2lnbmlmaWNhbnQgZmlndXJlcy5cbiAgICovXG4gIHN0YXRpYyBmb3JtYXRCZXN0VW5pdHNGb3VyU2lnRmlncyAoYXRvbXM6IG51bWJlciwgdWk6IFVuaXRJbmZvLCBwcmVmcz86IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+KTogW3N0cmluZywgc3RyaW5nXSB7XG4gICAgY29uc3QgW3YsIHByZWMsIHVuaXRdID0gdGhpcy5iZXN0Q29udmVyc2lvbihhdG9tcywgdWksIHByZWZzKVxuICAgIHJldHVybiBbRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHYsIHByZWMpLCB1bml0XVxuICB9XG5cbiAgLypcbiAgICogZm9ybWF0QmVzdFJhdGVFbGVtZW50IGZvcm1hdHMgYSByYXRlIHVzaW5nIHRoZSBiZXN0IGF2YWlsYWJsZSB1bml0cyBhbmRcbiAgICogdXBkYXRlcyB0aGUgVUkgZWxlbWVudC4gVGhlIGFuY2VzdG9yIHNob3VsZCBoYXZlIGRlc2NlbmRlbnRzIHdpdGggZGF0YVxuICAgKiBhdHRyaWJ1dGVzIFtiZXN0LXZhbHVlLCBkYXRhLXVuaXQsIGRhdGEtdW5pdC1ib3gsIGRhdGEtZGVub21dLlxuICAgKi9cbiAgc3RhdGljIGZvcm1hdEJlc3RSYXRlRWxlbWVudCAoYW5jZXN0b3I6IFBhZ2VFbGVtZW50LCBhc3NldElEOiBudW1iZXIsIGF0b21zOiBudW1iZXIsIHVpOiBVbml0SW5mbywgcHJlZnM/OiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPikge1xuICAgIERvYy5mb3JtYXRCZXN0VmFsdWVFbGVtZW50KGFuY2VzdG9yLCBhc3NldElELCBhdG9tcywgdWksIHByZWZzKVxuICAgIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtZGVub21dJywgdWkuZmVlUmF0ZURlbm9tKVxuICB9XG5cbiAgLypcbiAgICogZm9ybWF0QmVzdFJhdGVFbGVtZW50IGZvcm1hdHMgYSB2YWx1ZSB1c2luZyB0aGUgYmVzdCBhdmFpbGFibGUgdW5pdHMgYW5kXG4gICAqIHVwZGF0ZXMgdGhlIFVJIGVsZW1lbnQuIFRoZSBhbmNlc3RvciBzaG91bGQgaGF2ZSBkZXNjZW5kZW50cyB3aXRoIGRhdGFcbiAgICogYXR0cmlidXRlcyBbYmVzdC12YWx1ZSwgZGF0YS11bml0LCBkYXRhLXVuaXQtYm94XS5cbiAgICovXG4gIHN0YXRpYyBmb3JtYXRCZXN0VmFsdWVFbGVtZW50IChhbmNlc3RvcjogUGFnZUVsZW1lbnQsIGFzc2V0SUQ6IG51bWJlciwgYXRvbXM6IG51bWJlciwgdWk6IFVuaXRJbmZvLCBwcmVmcz86IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+KSB7XG4gICAgY29uc3QgW3YsIHVuaXRdID0gdGhpcy5mb3JtYXRCZXN0VW5pdHNGb3VyU2lnRmlncyhhdG9tcywgdWksIHByZWZzKVxuICAgIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtdmFsdWVdJywgdilcbiAgICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLXVuaXRdJywgdW5pdClcbiAgICBjb25zdCBzcGFuID0gRG9jLnNhZmVTZWxlY3RvcihhbmNlc3RvciwgJ1tkYXRhLXVuaXQtYm94XScpXG4gICAgc3Bhbi5kYXRhc2V0LmF0b21zID0gU3RyaW5nKGF0b21zKVxuICAgIHNwYW4uZGF0YXNldC5hc3NldElEID0gU3RyaW5nKGFzc2V0SUQpXG4gIH1cblxuICBzdGF0aWMgY29udmVudGlvbmFsUmF0ZVN0ZXAgKHJhdGVTdGVwRW5jOiBudW1iZXIsIGJhc2VVbml0SW5mbzogVW5pdEluZm8sIHF1b3RlVW5pdEluZm86IFVuaXRJbmZvKSB7XG4gICAgY29uc3QgW3FGYWN0b3IsIGJGYWN0b3JdID0gW3F1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IsIGJhc2VVbml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3Rvcl1cbiAgICByZXR1cm4gcmF0ZVN0ZXBFbmMgLyBSYXRlRW5jb2RpbmdGYWN0b3IgKiAoYkZhY3RvciAvIHFGYWN0b3IpXG4gIH1cblxuICAvKlxuICAgKiBsb2dvUGF0aCBjcmVhdGVzIGEgcGF0aCB0byBhIHBuZyBsb2dvIGZvciB0aGUgc3BlY2lmaWVkIHRpY2tlciBzeW1ib2wuIElmXG4gICAqIHRoZSBzeW1ib2wgaXMgbm90IGEgc3VwcG9ydGVkIGFzc2V0LCB0aGUgZ2VuZXJpYyBsZXR0ZXIgbG9nbyB3aWxsIGJlXG4gICAqIHJlcXVlc3RlZCBpbnN0ZWFkLlxuICAgKi9cbiAgc3RhdGljIGxvZ29QYXRoIChzeW1ib2w6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKEJpcFN5bWJvbHMuaW5kZXhPZihzeW1ib2wpID09PSAtMSkgc3ltYm9sID0gc3ltYm9sLnN1YnN0cmluZygwLCAxKVxuICAgIHN5bWJvbCA9IHN5bWJvbC5zcGxpdCgnLicpWzBdIC8vIGUuZy4gdXNkYy5ldGggPT4gdXNkY1xuICAgIHJldHVybiBgL2ltZy9jb2lucy8ke3N5bWJvbH0ucG5nYFxuICB9XG5cbiAgc3RhdGljIGJpcFN5bWJvbCAoYXNzZXRJRDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gQmlwSURzW2Fzc2V0SURdXG4gIH1cblxuICBzdGF0aWMgYmlwSURGcm9tU3ltYm9sIChzeW1ib2w6IHN0cmluZyk6IG51bWJlciB7XG4gICAgcmV0dXJuIEJpcFN5bWJvbElEc1tzeW1ib2xdXG4gIH1cblxuICBzdGF0aWMgYmlwQ0VYU3ltYm9sIChhc3NldElEOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IGJpcFN5bWJvbCA9IEJpcElEc1thc3NldElEXVxuICAgIGlmICghYmlwU3ltYm9sIHx8IGJpcFN5bWJvbCA9PT0gJycpIHJldHVybiAnJ1xuICAgIGNvbnN0IHBhcnRzID0gYmlwU3ltYm9sLnNwbGl0KCcuJylcbiAgICBpZiAocGFydHNbMF0gPT09ICd3ZXRoJykgcmV0dXJuICdldGgnXG4gICAgcmV0dXJuIHBhcnRzWzBdXG4gIH1cblxuICBzdGF0aWMgbG9nb1BhdGhGcm9tSUQgKGFzc2V0SUQ6IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIERvYy5sb2dvUGF0aChCaXBJRHNbYXNzZXRJRF0pXG4gIH1cblxuICAvKlxuICAgKiBzeW1ib2xpemUgY3JlYXRlcyBhIHRva2VuLWF3YXJlIHN5bWJvbCBlbGVtZW50IGZvciB0aGUgYXNzZXQncyBzeW1ib2wuIEZvclxuICAgKiBub24tdG9rZW4gYXNzZXRzLCB0aGlzIGlzIHNpbXBseSBhIDxzcGFuPlNZTUJPTDwvc3Bhbj4uIEZvciB0b2tlbnMsIGl0J2xsXG4gICAqIGJlIDxzcGFuPjxzcGFuPlNZTUJPTDwvc3Bhbj48c3VwPlBBUkVOVDwvc3VwPjwvc3Bhbj4uXG4gICAqL1xuICBzdGF0aWMgc3ltYm9saXplIChhc3NldDogU3ltYm9saXplciwgdXNlTG9nbz86IGJvb2xlYW4pOiBQYWdlRWxlbWVudCB7XG4gICAgY29uc3QgdGlja2VyID0gYXNzZXQudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICBjb25zdCBzeW1ib2xTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG4gICAgc3ltYm9sU3Bhbi50ZXh0Q29udGVudCA9IHRpY2tlci50b1VwcGVyQ2FzZSgpXG4gICAgY29uc3QgcGFydHMgPSBhc3NldC5zeW1ib2wuc3BsaXQoJy4nKVxuICAgIGNvbnN0IGlzVG9rZW4gPSBwYXJ0cy5sZW5ndGggPT09IDJcbiAgICBpZiAoIWlzVG9rZW4pIHJldHVybiBzeW1ib2xTcGFuXG4gICAgY29uc3QgcGFyZW50U3ltYm9sID0gcGFydHNbMV1cbiAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpXG4gICAgc3Bhbi5hcHBlbmRDaGlsZChzeW1ib2xTcGFuKVxuICAgIGlmICh1c2VMb2dvKSB7XG4gICAgICBjb25zdCBwYXJlbnRMb2dvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICAgIHBhcmVudExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHBhcmVudFN5bWJvbClcbiAgICAgIHBhcmVudExvZ28uY2xhc3NMaXN0LmFkZCgndG9rZW4tcGFyZW50JylcbiAgICAgIHNwYW4uYXBwZW5kQ2hpbGQocGFyZW50TG9nbylcbiAgICAgIHJldHVybiBzcGFuXG4gICAgfVxuICAgIGNvbnN0IHBhcmVudFN1cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N1cCcpXG4gICAgcGFyZW50U3VwLnRleHRDb250ZW50ID0gcGFyZW50U3ltYm9sLnRvVXBwZXJDYXNlKClcbiAgICBwYXJlbnRTdXAuY2xhc3NMaXN0LmFkZCgndG9rZW4tcGFyZW50JylcbiAgICBzcGFuLmFwcGVuZENoaWxkKHBhcmVudFN1cClcbiAgICByZXR1cm4gc3BhblxuICB9XG5cbiAgLypcbiAgICogc2hvcnRTeW1ib2wgcmVtb3ZlcyB0aGUgc2hvcnQgZm9ybWF0IG9mIGEgc3ltYm9sLCB3aXRoIGFueSBwYXJlbnQgY2hhaW5cbiAgICogaWRlbnRpZmllciByZW1vdmVkXG4gICAqL1xuICBzdGF0aWMgc2hvcnRTeW1ib2wgKHN5bWJvbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gc3ltYm9sLnNwbGl0KCcuJylbMF0udG9VcHBlckNhc2UoKVxuICB9XG5cbiAgLypcbiAgICogc2V0VGV4dCBzZXRzIHRoZSB0ZXh0Q29udGVudCBmb3IgYWxsIGRlc2NlbmRhbnQgZWxlbWVudHMgdGhhdCBtYXRjaCB0aGVcbiAgICogc3BlY2lmaWVkIENTUyBzZWxlY3Rvci5cbiAgICovXG4gIHN0YXRpYyBzZXRUZXh0IChhbmNlc3RvcjogUGFnZUVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcsIHRleHRDb250ZW50OiBzdHJpbmcpIHtcbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCBzZWxlY3RvcikpIGVsLnRleHRDb250ZW50ID0gdGV4dENvbnRlbnRcbiAgfVxuXG4gIHN0YXRpYyBzZXRTcmMgKGFuY2VzdG9yOiBQYWdlRWxlbWVudCwgc2VsZWN0b3I6IHN0cmluZywgdGV4dENvbnRlbnQ6IHN0cmluZykge1xuICAgIGZvciAoY29uc3QgaW1nIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCBzZWxlY3RvcikpIGltZy5zcmMgPSB0ZXh0Q29udGVudFxuICB9XG5cbiAgLypcbiAgKiBjbGVhblRlbXBsYXRlcyByZW1vdmVzIHRoZSBlbGVtZW50cyBmcm9tIHRoZSBET00gYW5kIGRlbGV0ZXMgdGhlIGlkXG4gICogYXR0cmlidXRlLlxuICAqL1xuICBzdGF0aWMgY2xlYW5UZW1wbGF0ZXMgKC4uLnRtcGxzOiBIVE1MRWxlbWVudFtdKSB7XG4gICAgdG1wbHMuZm9yRWFjaCh0bXBsID0+IHtcbiAgICAgIHRtcGwucmVtb3ZlKClcbiAgICAgIHRtcGwucmVtb3ZlQXR0cmlidXRlKCdpZCcpXG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICogdG1wbEVsZW1lbnQgaXMgYSBoZWxwZXIgZnVuY3Rpb24gZm9yIGdyYWJiaW5nIHN1Yi1lbGVtZW50cyBvZiB0aGUgbWFya2V0IGxpc3RcbiAgKiB0ZW1wbGF0ZS5cbiAgKi9cbiAgc3RhdGljIHRtcGxFbGVtZW50IChhbmNlc3RvcjogRG9jdW1lbnQgfCBIVE1MRWxlbWVudCwgczogc3RyaW5nKTogUGFnZUVsZW1lbnQge1xuICAgIHJldHVybiBhbmNlc3Rvci5xdWVyeVNlbGVjdG9yKGBbZGF0YS10bXBsPVwiJHtzfVwiXWApIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gIH1cblxuICAvKlxuICAqIHBhcnNlVGVtcGxhdGUgcmV0dXJucyBhbiBvYmplY3Qgb2YgZGF0YS10bXBsIGVsZW1lbnRzLCBrZXllZCBieSB0aGVpclxuICAqIGRhdGEtdG1wbCB2YWx1ZXMuXG4gICovXG4gIHN0YXRpYyBwYXJzZVRlbXBsYXRlIChhbmNlc3RvcjogSFRNTEVsZW1lbnQpOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD4ge1xuICAgIGNvbnN0IGQ6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PiA9IHt9XG4gICAgZm9yIChjb25zdCBlbCBvZiBEb2MuYXBwbHlTZWxlY3RvcihhbmNlc3RvciwgJ1tkYXRhLXRtcGxdJykpIGRbZWwuZGF0YXNldC50bXBsIHx8ICcnXSA9IGVsXG4gICAgcmV0dXJuIGRcbiAgfVxuXG4gIC8qXG4gICAqIHRpbWVTaW5jZSByZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBkdXJhdGlvbiBzaW5jZSB0aGVcbiAgICogc3BlY2lmaWVkIHVuaXggdGltZXN0YW1wIChtaWxsaXNlY29uZHMpLlxuICAgKi9cbiAgc3RhdGljIHRpbWVTaW5jZSAobXM6IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIERvYy5mb3JtYXREdXJhdGlvbigobmV3IERhdGUoKS5nZXRUaW1lKCkpIC0gbXMpXG4gIH1cblxuICAvKlxuICAgKiBobXNTaW5jZSByZXR1cm5zIGEgdGltZSBkdXJhdGlvbiBzaW5jZSB0aGUgc3BlY2lmaWVkIHVuaXggdGltZXN0YW1wXG4gICAqIGZvcm1hdHRlZCBhcyBISDpNTTpTU1xuICAgKi9cbiAgc3RhdGljIGhtc1NpbmNlIChzZWNzOiBudW1iZXIpIHtcbiAgICBsZXQgciA9IChuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApIC0gc2Vjc1xuICAgIGNvbnN0IGggPSBTdHJpbmcoTWF0aC5mbG9vcihyIC8gMzYwMCkpXG4gICAgciA9IHIgJSAzNjAwXG4gICAgY29uc3QgbSA9IFN0cmluZyhNYXRoLmZsb29yKHIgLyA2MCkpXG4gICAgY29uc3QgcyA9IFN0cmluZyhNYXRoLmZsb29yKHIgJSA2MCkpXG4gICAgcmV0dXJuIGAke2gucGFkU3RhcnQoMiwgJzAnKX06JHttLnBhZFN0YXJ0KDIsICcwJyl9OiR7cy5wYWRTdGFydCgyLCAnMCcpfWBcbiAgfVxuXG4gIC8qIGZvcm1hdER1cmF0aW9uIHJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGR1cmF0aW9uICovXG4gIHN0YXRpYyBmb3JtYXREdXJhdGlvbiAoZHVyOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGxldCBzZWNvbmRzID0gTWF0aC5mbG9vcihkdXIpXG4gICAgbGV0IHJlc3VsdCA9ICcnXG4gICAgbGV0IGNvdW50ID0gMFxuICAgIGNvbnN0IGFkZCA9IChuOiBudW1iZXIsIHM6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKG4gPiAwIHx8IGNvdW50ID4gMCkgY291bnQrK1xuICAgICAgaWYgKG4gPiAwKSByZXN1bHQgKz0gYCR7bn0gJHtzfSBgXG4gICAgICByZXR1cm4gY291bnQgPj0gMlxuICAgIH1cbiAgICBsZXQgeSwgbW8sIGQsIGgsIG0sIHNcbiAgICBbeSwgc2Vjb25kc10gPSB0aW1lTW9kKHNlY29uZHMsIGFZZWFyKVxuICAgIGlmIChhZGQoeSwgJ3knKSkgeyByZXR1cm4gcmVzdWx0IH1cbiAgICBbbW8sIHNlY29uZHNdID0gdGltZU1vZChzZWNvbmRzLCBhTW9udGgpXG4gICAgaWYgKGFkZChtbywgJ21vJykpIHsgcmV0dXJuIHJlc3VsdCB9XG4gICAgW2QsIHNlY29uZHNdID0gdGltZU1vZChzZWNvbmRzLCBhRGF5KVxuICAgIGlmIChhZGQoZCwgJ2QnKSkgeyByZXR1cm4gcmVzdWx0IH1cbiAgICBbaCwgc2Vjb25kc10gPSB0aW1lTW9kKHNlY29uZHMsIGFuSG91cilcbiAgICBpZiAoYWRkKGgsICdoJykpIHsgcmV0dXJuIHJlc3VsdCB9XG4gICAgW20sIHNlY29uZHNdID0gdGltZU1vZChzZWNvbmRzLCBhTWludXRlKVxuICAgIGlmIChhZGQobSwgJ20nKSkgeyByZXR1cm4gcmVzdWx0IH1cbiAgICBbcywgc2Vjb25kc10gPSB0aW1lTW9kKHNlY29uZHMsIDEwMDApXG4gICAgYWRkKHMsICdzJylcbiAgICByZXR1cm4gcmVzdWx0IHx8ICcwIHMnXG4gIH1cblxuICAvKlxuICAgKiBkaXNhYmxlTW91c2VXaGVlbCBjYW4gYmUgdXNlZCB0byBkaXNhYmxlIHRoZSBtb3VzZSB3aGVlbCBmb3IgYW55XG4gICAqIGlucHV0LiBJdCBpcyB2ZXJ5IGVhc3kgdG8gdW5rbm93aW5nbHkgc2Nyb2xsIHVwIG9uIGEgbnVtYmVyIGlucHV0XG4gICAqIGFuZCB0aGVuIHN1Ym1pdCBhbiB1bmV4cGVjdGVkIHZhbHVlLiBUaGlzIGZ1bmN0aW9uIHByZXZlbnRzIHRoZVxuICAgKiBzY3JvbGwgaW5jcmVtZW50L2RlY3JlbWVudCBiZWhhdmlvciBmb3IgYSB3aGVlbCBhY3Rpb24gb24gYVxuICAgKiBudW1iZXIgaW5wdXQuXG4gICAqL1xuICBzdGF0aWMgZGlzYWJsZU1vdXNlV2hlZWwgKC4uLmlucHV0RmllbGRzOiBFbGVtZW50W10pIHtcbiAgICBmb3IgKGNvbnN0IGlucHV0RmllbGQgb2YgaW5wdXRGaWVsZHMpIHtcbiAgICAgIERvYy5iaW5kKGlucHV0RmllbGQsICd3aGVlbCcsICgpID0+IHsgLyogcGFzcyAqLyB9LCB7IHBhc3NpdmU6IHRydWUgfSlcbiAgICB9XG4gIH1cblxuICAvLyBzaG93Rm9ybUVycm9yIGNhbiBiZSB1c2VkIHRvIHNldCBhbmQgZGlzcGxheSBlcnJvciBtZXNzYWdlIG9uIGZvcm1zLlxuICBzdGF0aWMgc2hvd0Zvcm1FcnJvciAoZWw6IFBhZ2VFbGVtZW50LCBtc2c6IGFueSkge1xuICAgIGVsLnRleHRDb250ZW50ID0gbXNnXG4gICAgRG9jLnNob3coZWwpXG4gIH1cblxuICAvLyBzaG93RmlhdFZhbHVlIGRpc3BsYXlzIHRoZSBmaWF0IGVxdWl2YWxlbnQgZm9yIHRoZSBwcm92aWRlZCBhbW91bnQuXG4gIHN0YXRpYyBzaG93RmlhdFZhbHVlIChkaXNwbGF5OiBQYWdlRWxlbWVudCwgYW1vdW50OiBudW1iZXIsIHJhdGU6IG51bWJlciwgdWk6IFVuaXRJbmZvKTogdm9pZCB7XG4gICAgaWYgKHJhdGUpIHtcbiAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RmlhdENvbnZlcnNpb24oYW1vdW50LCByYXRlLCB1aSlcbiAgICAgIERvYy5zaG93KGRpc3BsYXkucGFyZW50RWxlbWVudCBhcyBFbGVtZW50KVxuICAgIH0gZWxzZSBEb2MuaGlkZShkaXNwbGF5LnBhcmVudEVsZW1lbnQgYXMgRWxlbWVudClcbiAgfVxufVxuXG4vKlxuICogQW5pbWF0aW9uIGlzIGEgaGFuZGxlciBmb3Igc3RhcnRpbmcgYW5kIHN0b3BwaW5nIGFuaW1hdGlvbnMuXG4gKi9cbmV4cG9ydCBjbGFzcyBBbmltYXRpb24ge1xuICBkb25lOiAoKCkgPT4gdm9pZCkgfCB1bmRlZmluZWRcbiAgZW5kQW5pbWF0aW9uOiBib29sZWFuXG4gIHRocmVhZDogUHJvbWlzZTx2b2lkPlxuICBzdGF0aWMgRm9yZXZlcjogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IgKGR1cmF0aW9uOiBudW1iZXIsIGY6IChwcm9ncmVzczogbnVtYmVyKSA9PiB2b2lkLCBlYXNpbmdBbGdvPzogc3RyaW5nLCBkb25lPzogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZG9uZSA9IGRvbmVcbiAgICB0aGlzLnRocmVhZCA9IHRoaXMucnVuKGR1cmF0aW9uLCBmLCBlYXNpbmdBbGdvKVxuICB9XG5cbiAgLypcbiAgICogcnVuIHJ1bnMgdGhlIGFuaW1hdGlvbiBmdW5jdGlvbiwgaW5jcmVhc2luZyBwcm9ncmVzcyBmcm9tIDAgdG8gMSBpbiBhXG4gICAqIG1hbm5lciBkaWN0YXRlZCBieSBlYXNpbmdBbGdvLlxuICAgKi9cbiAgYXN5bmMgcnVuIChkdXJhdGlvbjogbnVtYmVyLCBmOiAocHJvZ3Jlc3M6IG51bWJlcikgPT4gdm9pZCwgZWFzaW5nQWxnbz86IHN0cmluZykge1xuICAgIGR1cmF0aW9uID0gZHVyYXRpb24gPj0gMCA/IGR1cmF0aW9uIDogMTAwMCAqIDg2NDAwICogMzY1ICogMTAgLy8gMTAgeWVhcnMsIGluIG1zXG4gICAgY29uc3QgZWFzZXIgPSBlYXNpbmdBbGdvID8gRWFzaW5nW2Vhc2luZ0FsZ29dIDogRWFzaW5nLmxpbmVhclxuICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICBjb25zdCBlbmQgPSAoZHVyYXRpb24gPT09IEFuaW1hdGlvbi5Gb3JldmVyKSA/IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSIDogc3RhcnQgKyBkdXJhdGlvblxuICAgIGNvbnN0IHJhbmdlID0gZW5kIC0gc3RhcnRcbiAgICBjb25zdCBmcmFtZUR1cmF0aW9uID0gMTAwMCAvIEZQU1xuICAgIGxldCBub3cgPSBzdGFydFxuICAgIHRoaXMuZW5kQW5pbWF0aW9uID0gZmFsc2VcbiAgICB3aGlsZSAobm93IDwgZW5kKSB7XG4gICAgICBpZiAodGhpcy5lbmRBbmltYXRpb24pIHJldHVybiB0aGlzLnJ1bkNvbXBsZXRpb25GdW5jdGlvbigpXG4gICAgICBmKGVhc2VyKChub3cgLSBzdGFydCkgLyByYW5nZSkpXG4gICAgICBhd2FpdCBzbGVlcChmcmFtZUR1cmF0aW9uKVxuICAgICAgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKClcbiAgICB9XG4gICAgZigxKVxuICAgIHRoaXMucnVuQ29tcGxldGlvbkZ1bmN0aW9uKClcbiAgfVxuXG4gIC8qIHdhaXQgcmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmUgd2hlbiB0aGUgYW5pbWF0aW9uIGNvbXBsZXRlcy4gKi9cbiAgYXN5bmMgd2FpdCAoKSB7XG4gICAgYXdhaXQgdGhpcy50aHJlYWRcbiAgfVxuXG4gIC8qIHN0b3Agc2NoZWR1bGVzIHRoZSBhbmltYXRpb24gdG8gZXhpdCBhdCBpdHMgbmV4dCBmcmFtZS4gKi9cbiAgc3RvcCAoKSB7XG4gICAgdGhpcy5lbmRBbmltYXRpb24gPSB0cnVlXG4gIH1cblxuICAvKlxuICAgKiBzdG9wQW5kV2FpdCBzdG9wcyB0aGUgYW5pbWF0aW9ucyBhbmQgcmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIHJlc29sdmVcbiAgICogd2hlbiB0aGUgYW5pbWF0aW9uIGV4aXRzLlxuICAgKi9cbiAgYXN5bmMgc3RvcEFuZFdhaXQgKCkge1xuICAgIHRoaXMuc3RvcCgpXG4gICAgYXdhaXQgdGhpcy53YWl0KClcbiAgfVxuXG4gIC8qIHJ1bkNvbXBsZXRpb25GdW5jdGlvbiBydW5zIGFueSByZWdpc3RlcmVkIGNhbGxiYWNrIGZ1bmN0aW9uICovXG4gIHJ1bkNvbXBsZXRpb25GdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuZG9uZSkgdGhpcy5kb25lKClcbiAgfVxufVxuQW5pbWF0aW9uLkZvcmV2ZXIgPSAtMVxuXG4vKiBFYXNpbmcgYWxnb3JpdGhtcyBmb3IgYW5pbWF0aW9ucy4gKi9cbmV4cG9ydCBjb25zdCBFYXNpbmc6IFJlY29yZDxzdHJpbmcsICh0OiBudW1iZXIpID0+IG51bWJlcj4gPSB7XG4gIGxpbmVhcjogdCA9PiB0LFxuICBlYXNlSW46IHQgPT4gdCAqIHQsXG4gIGVhc2VPdXQ6IHQgPT4gdCAqICgyIC0gdCksXG4gIGVhc2VJbkhhcmQ6IHQgPT4gdCAqIHQgKiB0LFxuICBlYXNlT3V0SGFyZDogdCA9PiAoLS10KSAqIHQgKiB0ICsgMSxcbiAgZWFzZU91dEVsYXN0aWM6IHQgPT4ge1xuICAgIGNvbnN0IGM0ID0gKDIgKiBNYXRoLlBJKSAvIDNcbiAgICByZXR1cm4gdCA9PT0gMFxuICAgICAgPyAwXG4gICAgICA6IHQgPT09IDFcbiAgICAgICAgPyAxXG4gICAgICAgIDogTWF0aC5wb3coMiwgLTEwICogdCkgKiBNYXRoLnNpbigodCAqIDEwIC0gMC43NSkgKiBjNCkgKyAxXG4gIH1cbn1cblxuLyogV2FsbGV0SWNvbnMgYXJlIHVzZWQgZm9yIGNvbnRyb2xsaW5nIHdhbGxldHMgaW4gdmFyaW91cyBwbGFjZXMuICovXG5leHBvcnQgY2xhc3MgV2FsbGV0SWNvbnMge1xuICBpY29uczogUmVjb3JkPHN0cmluZywgSFRNTEVsZW1lbnQ+XG4gIHN0YXR1czogRWxlbWVudFxuXG4gIGNvbnN0cnVjdG9yIChib3g6IEhUTUxFbGVtZW50KSB7XG4gICAgY29uc3Qgc3RhdGVFbGVtZW50ID0gKG5hbWU6IHN0cmluZykgPT4gYm94LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXN0YXRlPSR7bmFtZX1dYCkgYXMgSFRNTEVsZW1lbnRcbiAgICB0aGlzLmljb25zID0ge31cbiAgICB0aGlzLmljb25zLnNsZWVwaW5nID0gc3RhdGVFbGVtZW50KCdzbGVlcGluZycpXG4gICAgdGhpcy5pY29ucy5sb2NrZWQgPSBzdGF0ZUVsZW1lbnQoJ2xvY2tlZCcpXG4gICAgdGhpcy5pY29ucy51bmxvY2tlZCA9IHN0YXRlRWxlbWVudCgndW5sb2NrZWQnKVxuICAgIHRoaXMuaWNvbnMubm93YWxsZXQgPSBzdGF0ZUVsZW1lbnQoJ25vd2FsbGV0JylcbiAgICB0aGlzLmljb25zLnN5bmNpbmcgPSBzdGF0ZUVsZW1lbnQoJ3N5bmNpbmcnKVxuICAgIHRoaXMuaWNvbnMubm9wZWVycyA9IHN0YXRlRWxlbWVudCgnbm9wZWVycycpXG4gICAgdGhpcy5pY29ucy5kaXNhYmxlZCA9IHN0YXRlRWxlbWVudCgnZGlzYWJsZWQnKVxuICAgIHRoaXMuc3RhdHVzID0gc3RhdGVFbGVtZW50KCdzdGF0dXMnKVxuICB9XG5cbiAgLyogc2xlZXBpbmcgc2V0cyB0aGUgaWNvbnMgdG8gaW5kaWNhdGUgdGhhdCB0aGUgd2FsbGV0IGlzIG5vdCBjb25uZWN0ZWQuICovXG4gIHNsZWVwaW5nICgpIHtcbiAgICBjb25zdCBpID0gdGhpcy5pY29uc1xuICAgIERvYy5oaWRlKGkubG9ja2VkLCBpLnVubG9ja2VkLCBpLm5vd2FsbGV0LCBpLnN5bmNpbmcsIGkuZGlzYWJsZWQpXG4gICAgRG9jLnNob3coaS5zbGVlcGluZylcbiAgICBpZiAodGhpcy5zdGF0dXMpIHRoaXMuc3RhdHVzLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfT0ZGKVxuICB9XG5cbiAgLypcbiAgICogbG9ja2VkIHNldHMgdGhlIGljb25zIHRvIGluZGljYXRlIHRoYXQgdGhlIHdhbGxldCBpcyBjb25uZWN0ZWQsIGJ1dCBsb2NrZWQuXG4gICAqL1xuICBsb2NrZWQgKCkge1xuICAgIGNvbnN0IGkgPSB0aGlzLmljb25zXG4gICAgRG9jLmhpZGUoaS51bmxvY2tlZCwgaS5ub3dhbGxldCwgaS5zbGVlcGluZywgaS5kaXNhYmxlZClcbiAgICBEb2Muc2hvdyhpLmxvY2tlZClcbiAgICBpZiAodGhpcy5zdGF0dXMpIHRoaXMuc3RhdHVzLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTE9DS0VEKVxuICB9XG5cbiAgLypcbiAgICogdW5sb2NrZWQgc2V0cyB0aGUgaWNvbnMgdG8gaW5kaWNhdGUgdGhhdCB0aGUgd2FsbGV0IGlzIGNvbm5lY3RlZCBhbmRcbiAgICogdW5sb2NrZWQuXG4gICAqL1xuICB1bmxvY2tlZCAoKSB7XG4gICAgY29uc3QgaSA9IHRoaXMuaWNvbnNcbiAgICBEb2MuaGlkZShpLmxvY2tlZCwgaS5ub3dhbGxldCwgaS5zbGVlcGluZywgaS5kaXNhYmxlZClcbiAgICBEb2Muc2hvdyhpLnVubG9ja2VkKVxuICAgIGlmICh0aGlzLnN0YXR1cykgdGhpcy5zdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9SRUFEWSlcbiAgfVxuXG4gIC8qIG5vd2FsbGV0IHNldHMgdGhlIGljb25zIHRvIGluZGljYXRlIHRoYXQgbm8gd2FsbGV0IGV4aXN0cy4gKi9cbiAgbm93YWxsZXQgKCkge1xuICAgIGNvbnN0IGkgPSB0aGlzLmljb25zXG4gICAgRG9jLmhpZGUoaS5sb2NrZWQsIGkudW5sb2NrZWQsIGkuc2xlZXBpbmcsIGkuc3luY2luZywgaS5kaXNhYmxlZClcbiAgICBEb2Muc2hvdyhpLm5vd2FsbGV0KVxuICAgIGlmICh0aGlzLnN0YXR1cykgdGhpcy5zdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9OT19XQUxMRVQpXG4gIH1cblxuICAvKiBzZXQgdGhlIGljb25zIHRvIGluZGljYXRlIHRoYXQgdGhlIHdhbGxldCBpcyBkaXNhYmxlZCAqL1xuICBkaXNhYmxlZCAoKSB7XG4gICAgY29uc3QgaSA9IHRoaXMuaWNvbnNcbiAgICBEb2MuaGlkZShpLmxvY2tlZCwgaS51bmxvY2tlZCwgaS5zbGVlcGluZywgaS5zeW5jaW5nLCBpLm5vd2FsbGV0LCBpLm5vcGVlcnMpXG4gICAgRG9jLnNob3coaS5kaXNhYmxlZClcbiAgICBpLmRpc2FibGVkLmRhdGFzZXQudG9vbHRpcCA9IGludGwucHJlcChpbnRsLklEX0RJU0FCTEVEX01TRylcbiAgfVxuXG4gIHNldFN5bmNpbmcgKHdhbGxldDogV2FsbGV0U3RhdGUgfCBudWxsKSB7XG4gICAgY29uc3Qgc3luY0ljb24gPSB0aGlzLmljb25zLnN5bmNpbmdcbiAgICBpZiAoIXdhbGxldCB8fCAhd2FsbGV0LnJ1bm5pbmcgfHwgd2FsbGV0LmRpc2FibGVkKSB7XG4gICAgICBEb2MuaGlkZShzeW5jSWNvbilcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmICh3YWxsZXQucGVlckNvdW50ID09PSAwKSB7XG4gICAgICBEb2Muc2hvdyh0aGlzLmljb25zLm5vcGVlcnMpXG4gICAgICBEb2MuaGlkZShzeW5jSWNvbikgLy8gcG90ZW50aWFsbHkgbWlzbGVhZGluZyB3aXRoIG5vIHBlZXJzXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLmhpZGUodGhpcy5pY29ucy5ub3BlZXJzKVxuXG4gICAgaWYgKCF3YWxsZXQuc3luY2VkKSB7XG4gICAgICBEb2Muc2hvdyhzeW5jSWNvbilcbiAgICAgIHN5bmNJY29uLmRhdGFzZXQudG9vbHRpcCA9IGludGwucHJlcChpbnRsLklEX1dBTExFVF9TWU5DX1BST0dSRVNTLCB7IHN5bmNQcm9ncmVzczogKHdhbGxldC5zeW5jUHJvZ3Jlc3MgKiAxMDApLnRvRml4ZWQoMSkgfSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2MuaGlkZShzeW5jSWNvbilcbiAgfVxuXG4gIC8qIHJlYWRzIHRoZSBjb3JlLldhbGxldCBzdGF0ZSBhbmQgc2V0cyB0aGUgaWNvbiB2aXNpYmlsaXR5LiAqL1xuICByZWFkV2FsbGV0ICh3YWxsZXQ6IFdhbGxldFN0YXRlIHwgbnVsbCkge1xuICAgIHRoaXMuc2V0U3luY2luZyh3YWxsZXQpXG4gICAgaWYgKCF3YWxsZXQpIHJldHVybiB0aGlzLm5vd2FsbGV0KClcbiAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgIGNhc2UgKHdhbGxldC5kaXNhYmxlZCk6XG4gICAgICAgIHRoaXMuZGlzYWJsZWQoKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSAoIXdhbGxldC5ydW5uaW5nKTpcbiAgICAgICAgdGhpcy5zbGVlcGluZygpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICghd2FsbGV0Lm9wZW4pOlxuICAgICAgICB0aGlzLmxvY2tlZCgpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICh3YWxsZXQub3Blbik6XG4gICAgICAgIHRoaXMudW5sb2NrZWQoKVxuICAgICAgICBicmVha1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgY29uc29sZS5lcnJvcignd2FsbGV0IGluIHVua25vd24gc3RhdGUnLCB3YWxsZXQpXG4gICAgfVxuICB9XG59XG5cbi8qXG4gKiBBbmlUb2dnbGUgaXMgYSBzbWFsbCB0b2dnbGUgc3dpdGNoLCBkZWZpbmVkIGluIEhUTUwgd2l0aCB0aGUgZWxlbWVudFxuICogPGRpdiBjbGFzcz1cImFuaXRvZ2dsZVwiPjwvZGl2Pi4gVGhlIGFuaW1hdGlvbnMgYXJlIGRlZmluZWQgaW4gdGhlIGFuaXRvZ2dsZVxuICogQ1NTIGNsYXNzLiBBbmlUb2dnbGUgdHJpZ2dlcnMgdGhlIGNhbGxiYWNrIG9uIGNsaWNrIGV2ZW50cywgYnV0IGRvZXMgbm90XG4gKiB1cGRhdGUgdG9nZ2xlIGFwcGVhcmFuY2UsIHNvIHRoZSBjYWxsZXIgbXVzdCBjYWxsIHRoZSBzZXRTdGF0ZSBtZXRob2QgZnJvbVxuICogdGhlIGNhbGxiYWNrIG9yIGVsc2V3aGVyZSBpZiB0aGUgbmV3U3RhdGVcbiAqIGlzIGFjY2VwdGVkLlxuICovXG5leHBvcnQgY2xhc3MgQW5pVG9nZ2xlIHtcbiAgdG9nZ2xlOiBQYWdlRWxlbWVudFxuICB0b2dnbGluZzogYm9vbGVhblxuXG4gIGNvbnN0cnVjdG9yICh0b2dnbGU6IFBhZ2VFbGVtZW50LCBlcnJvckVsOiBQYWdlRWxlbWVudCwgaW5pdGlhbFN0YXRlOiBib29sZWFuLCBjYWxsYmFjazogKG5ld1N0YXRlOiBib29sZWFuKSA9PiBQcm9taXNlPGFueT4pIHtcbiAgICB0aGlzLnRvZ2dsZSA9IHRvZ2dsZVxuICAgIGlmICh0b2dnbGUuY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB0b2dnbGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpXG5cbiAgICBEb2MuYmluZCh0b2dnbGUsICdjbGljaycsIGFzeW5jIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICBEb2MuaGlkZShlcnJvckVsKVxuICAgICAgY29uc3QgbmV3U3RhdGUgPSAhdG9nZ2xlLmNsYXNzTGlzdC5jb250YWlucygnb24nKVxuICAgICAgdGhpcy50b2dnbGluZyA9IHRydWVcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGNhbGxiYWNrKG5ld1N0YXRlKVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aGlzLnRvZ2dsaW5nID0gZmFsc2VcbiAgICAgICAgRG9jLnNob3coZXJyb3JFbClcbiAgICAgICAgZXJyb3JFbC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FQSV9FUlJPUiwgeyBtc2c6IGUubXNnIHx8IFN0cmluZyhlKSB9KVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHRoaXMudG9nZ2xpbmcgPSBmYWxzZVxuICAgIH0pXG4gICAgdGhpcy5zZXRTdGF0ZShpbml0aWFsU3RhdGUpXG4gIH1cblxuICBzZXRTdGF0ZSAoc3RhdGU6IGJvb2xlYW4pIHtcbiAgICBpZiAoc3RhdGUpIHRoaXMudG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ29uJylcbiAgICBlbHNlIHRoaXMudG9nZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ29uJylcbiAgfVxufVxuXG4vKiBzbGVlcCBjYW4gYmUgdXNlZCBieSBhc3luYyBmdW5jdGlvbnMgdG8gcGF1c2UgZm9yIGEgc3BlY2lmaWVkIHBlcmlvZC4gKi9cbmZ1bmN0aW9uIHNsZWVwIChtczogbnVtYmVyKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKVxufVxuXG5jb25zdCBhWWVhciA9IDMxNTM2MDAwMDAwXG5jb25zdCBhTW9udGggPSAyNTkyMDAwMDAwXG5jb25zdCBhRGF5ID0gODY0MDAwMDBcbmNvbnN0IGFuSG91ciA9IDM2MDAwMDBcbmNvbnN0IGFNaW51dGUgPSA2MDAwMFxuXG4vKiB0aW1lTW9kIHJldHVybnMgdGhlIHF1b3RpZW50IGFuZCByZW1haW5kZXIgb2YgdCAvIGR1ci4gKi9cbmZ1bmN0aW9uIHRpbWVNb2QgKHQ6IG51bWJlciwgZHVyOiBudW1iZXIpIHtcbiAgY29uc3QgbiA9IE1hdGguZmxvb3IodCAvIGR1cilcbiAgcmV0dXJuIFtuLCB0IC0gbiAqIGR1cl1cbn1cblxuZnVuY3Rpb24gZm9ybWF0U2lnRmlnc1dpdGhGb3JtYXR0ZXJzIChpbnRGb3JtYXR0ZXI6IEludGwuTnVtYmVyRm9ybWF0LCBzaWdGaWdGb3JtYXR0ZXI6IEludGwuTnVtYmVyRm9ybWF0LCBuOiBudW1iZXIsIG1heERlY2ltYWxzPzogbnVtYmVyLCBsb2NhbGVzPzogc3RyaW5nIHwgc3RyaW5nW10pOiBzdHJpbmcge1xuICBpZiAobiA+PSAxMDAwKSByZXR1cm4gaW50Rm9ybWF0dGVyLmZvcm1hdChuKVxuICBjb25zdCBzID0gc2lnRmlnRm9ybWF0dGVyLmZvcm1hdChuKVxuICBpZiAodHlwZW9mIG1heERlY2ltYWxzICE9PSAnbnVtYmVyJykgcmV0dXJuIHNcbiAgY29uc3QgZnJhY3Rpb25hbCA9IHNpZ0ZpZ0Zvcm1hdHRlci5mb3JtYXRUb1BhcnRzKG4pLmZpbHRlcigocGFydDogSW50bC5OdW1iZXJGb3JtYXRQYXJ0KSA9PiBwYXJ0LnR5cGUgPT09ICdmcmFjdGlvbicpWzBdPy52YWx1ZSA/PyAnJ1xuICBpZiAoZnJhY3Rpb25hbC5sZW5ndGggPD0gbWF4RGVjaW1hbHMpIHJldHVybiBzXG4gIHJldHVybiBmdWxsUHJlY2lzaW9uRm9ybWF0dGVyKG1heERlY2ltYWxzLCBsb2NhbGVzKS5mb3JtYXQobilcbn1cblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gIC8vIENvZGUgd2lsbCBvbmx5IGFwcGVhciBpbiBkZXYgYnVpbGQuXG4gIC8vIGh0dHBzOi8vd2VicGFjay5qcy5vcmcvZ3VpZGVzL3Byb2R1Y3Rpb24vXG4gIHdpbmRvdy50ZXN0Rm9ybWF0Rm91clNpZ0ZpZ3MgPSAoKSA9PiB7XG4gICAgY29uc3QgdGVzdHM6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyIHwgdW5kZWZpbmVkLCBzdHJpbmddW10gPSBbXG4gICAgICBbJ2VuLVVTJywgJzEuMjM0NTY3JywgdW5kZWZpbmVkLCAnMS4yMzUnXSwgLy8gc2lnRmlnRm9ybWF0dGVyXG4gICAgICBbJ2VuLVVTJywgJzEuMjM0NTY3JywgMiwgJzEuMjMnXSwgLy8gZGVjaW1hbEZvcm1hdHRlclxuICAgICAgWydlbi1VUycsICcxMjM0JywgdW5kZWZpbmVkLCAnMSwyMzQuMCddLCAvLyBvbmVGcmFjdGlvbmFsRGlnaXRcbiAgICAgIFsnZW4tVVMnLCAnMTInLCB1bmRlZmluZWQsICcxMi4wMCddLCAvLyBzaWdGaWdGb3JtYXR0ZXJcbiAgICAgIFsnZnItRlInLCAnMTIzLjQ1Njc4JywgdW5kZWZpbmVkLCAnMTIzLDUnXSwgLy8gb25lRnJhY3Rpb25hbERpZ2l0XG4gICAgICBbJ2ZyLUZSJywgJzEyMzQuNScsIHVuZGVmaW5lZCwgJzHigK8yMzQsNSddLCAvLyBVKzIwMkYgZm9yIHRob3VzYW5kcyBzZXBhcmF0b3JcbiAgICAgIC8vIEZvciBBcmFiaWMsIGh0dHBzOi8vd3d3LnNhaXRhay5jb20vbnVtYmVyIGlzIHVzZWZ1bCwgYnV0IHNlZW1zIHRvIHVzZVxuICAgICAgLy8gc2xpZ2h0bHkgZGlmZmVyZW50IHVuaWNvZGUgcG9pbnRzIGFuZCBubyB0aG91c2FuZHMgc2VwYXJhdG9yLiBJIHRoaW5rXG4gICAgICAvLyB0aGUgQXJhYmljIGRlY2ltYWwgc2VwYXJhdG9yIGlzIHN1cHBvc2VkIHRvIGJlIG1vcmUgbGlrZSBhIHBvaW50LCBub3RcbiAgICAgIC8vIGEgY29tbWEsIGJ1dCBHb29nbGUgQ2hyb21lIHVzZXMgVSswNjZCIChBcmFiaWMgRGVjaW1hbCBTZXBhcmF0b3IpLFxuICAgICAgLy8gd2hpY2ggbG9va3MgbGlrZSBhIGNvbW1hIHRvIG1lLiDCr1xcXyjjg4QpXy/Cr1xuICAgICAgWydhci1FRycsICcxMjMuNDU2NzgnLCB1bmRlZmluZWQsICfZodmi2aPZq9mlJ10sXG4gICAgICBbJ2FyLUVHJywgJzEyMzQnLCB1bmRlZmluZWQsICfZodms2aLZo9mk2avZoCddLFxuICAgICAgWydhci1FRycsICcwLjEyMzQ1JywgMywgJ9mg2avZodmi2aMnXVxuICAgIF1cblxuICAgIC8vIFJlcHJvZHVjZSB0aGUgTnVtYmVyRm9ybWF0cyB3aXRoIE9OTFkgb3VyIGRlc2lyZWQgbGFuZ3VhZ2UuXG4gICAgZm9yIChjb25zdCBbY29kZSwgdW5mb3JtYXR0ZWQsIG1heERlY2ltYWxzLCBleHBlY3RlZF0gb2YgdGVzdHMpIHtcbiAgICAgIGNvbnN0IGludEZvcm1hdHRlciA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChjb2RlLCB7IC8vIG9uZUZyYWN0aW9uYWxEaWdpdFxuICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDEsXG4gICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogMVxuICAgICAgfSlcbiAgICAgIGNvbnN0IHNpZ0ZpZ0Zvcm1hdHRlciA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChjb2RlLCB7XG4gICAgICAgIG1pbmltdW1TaWduaWZpY2FudERpZ2l0czogNCxcbiAgICAgICAgbWF4aW11bVNpZ25pZmljYW50RGlnaXRzOiA0XG4gICAgICB9KVxuICAgICAgZm9yIChjb25zdCBrIGluIGRlY2ltYWxGb3JtYXR0ZXJzKSBkZWxldGUgZGVjaW1hbEZvcm1hdHRlcnNba10gLy8gY2xlYW51cFxuICAgICAgZm9yIChjb25zdCBrIGluIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXJzKSBkZWxldGUgZnVsbFByZWNpc2lvbkZvcm1hdHRlcnNba10gLy8gY2xlYW51cFxuICAgICAgY29uc3QgcyA9IGZvcm1hdFNpZ0ZpZ3NXaXRoRm9ybWF0dGVycyhpbnRGb3JtYXR0ZXIsIHNpZ0ZpZ0Zvcm1hdHRlciwgcGFyc2VGbG9hdERlZmF1bHQodW5mb3JtYXR0ZWQpLCBtYXhEZWNpbWFscywgY29kZSlcbiAgICAgIGlmIChzICE9PSBleHBlY3RlZCkgY29uc29sZS5sb2coYFRFU1QgRkFJTEVEOiBmKCcke2NvZGV9JywgJHt1bmZvcm1hdHRlZH0sICR7bWF4RGVjaW1hbHN9KSA9PiAnJHtzfScgIT0gJyR7ZXhwZWN0ZWR9J31gKVxuICAgICAgZWxzZSBjb25zb2xlLmxvZyhg4pyU77iPIGYoJyR7Y29kZX0nLCAke3VuZm9ybWF0dGVkfSwgJHttYXhEZWNpbWFsc30pID0+ICR7c30g4pyU77iPYClcbiAgICB9XG4gIH1cblxuICB3aW5kb3cudGVzdEZvcm1hdFJhdGVGdWxsUHJlY2lzaW9uID0gKCkgPT4ge1xuICAgIGNvbnN0IHRlc3RzOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyLCBzdHJpbmddW10gPSBbXG4gICAgICAvLyBUd28gdXR4byBhc3NldHMgd2l0aCBhIGNvbnZlbnRpb25hbCByYXRlIG9mIDAuMTUuIENvbnZlbnRpb25hbCByYXRlXG4gICAgICAvLyBzdGVwIGlzIDEwMCAvIDFlOCA9IDFlLTYsIHNvIHRoZXJlIHNob3VsZCBiZSA2IGRlY2ltYWwgZGlnaXRzLlxuICAgICAgWzEuNWU3LCAxMDAsIDFlOCwgMWU4LCAnMC4xNTAwMDAnXSxcbiAgICAgIC8vIFVTREMgcXVvdGUgLT4gdXR4byBiYXNlIHdpdGggYSByYXRlIG9mICQxMCAvIDEgWFlaLiBVU0RDIGhhcyBhblxuICAgICAgLy8gY29udmVyc2lvbiBmYWN0b3Igb2YgMWU2LCBzbyAkMTAgZW5jb2RlcyB0byAxZTcsIDEgWFlaIGVuY29kZXMgdG8gMWU4LFxuICAgICAgLy8gZW5jb2RlZCByYXRlIGlzIDFlNyAvIDFlOCAqIDFlOCA9IDFlNywgYkZhY3RvciAvIHFGYWN0b3IgaXMgMWUyLlxuICAgICAgLy8gVGhlIGNvbnZlbnRpb25hbCByYXRlIHN0ZXAgaXMgMjAwIC8gMWU4ICogMWUyID0gMmUtNCwgc28gdXNpbmdcbiAgICAgIC8vIHJhdGVTdGVwRGlnaXRzLCB3ZSBzaG91bGQgZ2V0IDQgZGVjaW1hbCBkaWdpdHMuXG4gICAgICBbMWU3LCAyMDAsIDFlNiwgMWU4LCAnMTAuMDAwMCddLFxuICAgICAgLy8gU2V0IGEgcmF0ZSBvZiAxIGF0b20gVVNEQyBmb3IgMC4wMSBCVEMuIFRoYXQgYXRvbWljIHJhdGUgd2lsbCBiZSAxIC9cbiAgICAgIC8vIDFlNiA9IDFlLTYuIFRoZSBlbmNvZGVkIHJhdGUgd2lsbCBiZSAxZS02ICogMWU4ID0gMWUyLiBBcyBsb25nIGFzIG91clxuICAgICAgLy8gcmF0ZSBzdGVwIGRpdmlkZXMgZXZlbmx5IGludG8gMTAwLCB0aGlzIHNob3VsZCB3b3JrLiBUaGUgY29udmVudGlvbmFsXG4gICAgICAvLyByYXRlIGlzIDFlLTYgLyAxZS0yID0gMWUtNCwgc28gZXhwZWN0IDQgZGVjaW1hbCBkaWdpdHMuXG4gICAgICBbMWUyLCAxMDAsIDFlNiwgMWU4LCAnMC4wMDAxJ10sXG4gICAgICAvLyBEQ1ItRVRILCBleHBlY3QgNiBkZWNpbWFscy5cbiAgICAgIFsxLjVlNywgMTAwMCwgMWU5LCAxZTgsICcwLjAxNTAwMCddLFxuICAgICAgWzFlNiwgMTAwMCwgMWU5LCAxZTgsICcwLjAwMTAwMCddLFxuICAgICAgWzFlMywgMTAwMCwgMWU5LCAxZTgsICcwLjAwMDAwMSddLFxuICAgICAgWzEwMDAwMTAwMCwgMTAwMCwgMWU5LCAxZTgsICcwLjEwMDAwMSddLFxuICAgICAgWzEwMDAwMDEwMDAsIDEwMDAsIDFlOSwgMWU4LCAnMS4wMDAwMDEnXSxcbiAgICAgIC8vIERDUi1VU0RDLCBleHBlY3QgMyBkZWNpbWFscy5cbiAgICAgIFsxLjVlNywgMTAwMCwgMWU2LCAxZTgsICcxNS4wMDAnXSxcbiAgICAgIFsxZTYsIDEwMDAsIDFlNiwgMWU4LCAnMS4wMDAnXSxcbiAgICAgIFsxZTMsIDEwMDAsIDFlNiwgMWU4LCAnMC4wMDEnXSxcbiAgICAgIFsxMDEwMDAsIDEwMDAsIDFlNiwgMWU4LCAnMC4xMDEnXSxcbiAgICAgIFsxMDAxMDAwLCAxMDAwLCAxZTYsIDFlOCwgJzEuMDAxJ10sXG4gICAgICAvLyBVVFhPIGFzc2V0cyBidXQgd2l0aCBhIHJhdGUgc3RlcCB0aGF0J3Mgbm90IGEgcGVyZmVjdCBwb3dlciBvZiAxMC5cbiAgICAgIC8vIEZvciBhIHJhdGUgc3RlcCBvZiA1MDAsIGEgbWluIHJhdGUgd291bGQgYmUgZS5nLiByYXRlIHN0ZXAgPSA1MDAuXG4gICAgICAvLyA1ZTIgLyAxZTggPSA1ZS02ID0gMC4wMDAwMDVcbiAgICAgIFs1ZTIsIDUwMCwgMWU4LCAxZTgsICcwLjAwMDAwNSddXG4gICAgXVxuXG4gICAgZm9yIChjb25zdCBbZW5jUmF0ZSwgcmF0ZVN0ZXAsIHFGYWN0b3IsIGJGYWN0b3IsIGV4cEVuY29kaW5nXSBvZiB0ZXN0cykge1xuICAgICAgZm9yIChjb25zdCBrIGluIGZ1bGxQcmVjaXNpb25Gb3JtYXR0ZXJzKSBkZWxldGUgZnVsbFByZWNpc2lvbkZvcm1hdHRlcnNba10gLy8gY2xlYW51cFxuICAgICAgY29uc3QgYnVpID0geyBjb252ZW50aW9uYWw6IHsgY29udmVyc2lvbkZhY3RvcjogYkZhY3RvciB9IH0gYXMgYW55IGFzIFVuaXRJbmZvXG4gICAgICBjb25zdCBxdWkgPSB7IGNvbnZlbnRpb25hbDogeyBjb252ZXJzaW9uRmFjdG9yOiBxRmFjdG9yIH0gfSBhcyBhbnkgYXMgVW5pdEluZm9cbiAgICAgIGNvbnN0IGVuYyA9IERvYy5mb3JtYXRSYXRlRnVsbFByZWNpc2lvbihlbmNSYXRlLCBidWksIHF1aSwgcmF0ZVN0ZXApXG4gICAgICBpZiAoZW5jICE9PSBleHBFbmNvZGluZykgY29uc29sZS5sb2coYFRFU1QgRkFJTEVEOiBmKCR7ZW5jUmF0ZX0sICR7YkZhY3Rvcn0sICR7cUZhY3Rvcn0sICR7cmF0ZVN0ZXB9KSA9PiAke2VuY30gIT0gJHtleHBFbmNvZGluZ31gKVxuICAgICAgZWxzZSBjb25zb2xlLmxvZyhg4pyU77iPIGYoJHtlbmNSYXRlfSwgJHtiRmFjdG9yfSwgJHtxRmFjdG9yfSwgJHtyYXRlU3RlcH0pID0+ICR7ZW5jfSDinJTvuI9gKVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE51bWJlcklucHV0T3B0cyB7XG4gIHByZWM/OiBudW1iZXJcbiAgc2lnRmlncz86IGJvb2xlYW5cbiAgY2hhbmdlZD86ICh2OiBudW1iZXIpID0+IHZvaWRcbiAgbWluPzogbnVtYmVyXG4gIHNldD86ICh2OiBudW1iZXIsIHM6IHN0cmluZykgPT4gdm9pZCAvLyBjYWxsZWQgd2hlbiBzZXRWYWx1ZSBpcyBjYWxsZWRcbn1cblxuZXhwb3J0IGNsYXNzIE51bWJlcklucHV0IHtcbiAgaW5wdXQ6IFBhZ2VFbGVtZW50XG4gIHByZWM6IG51bWJlclxuICBmbXQ6ICh2OiBudW1iZXIsIHByZWM6IG51bWJlcikgPT4gW251bWJlciwgc3RyaW5nXVxuICBjaGFuZ2VkOiAodjogbnVtYmVyKSA9PiB2b2lkXG4gIHNldD86ICh2OiBudW1iZXIsIHM6IHN0cmluZykgPT4gdm9pZFxuICBtaW46IG51bWJlclxuXG4gIGNvbnN0cnVjdG9yIChpbnB1dDogUGFnZUVsZW1lbnQsIG9wdHM6IE51bWJlcklucHV0T3B0cykge1xuICAgIHRoaXMuaW5wdXQgPSBpbnB1dFxuICAgIHRoaXMucHJlYyA9IG9wdHMucHJlYyA/PyAwXG4gICAgdGhpcy5mbXQgPSBvcHRzLnNpZ0ZpZ3MgPyB0b0ZvdXJTaWdGaWdzIDogdG9QcmVjaXNpb25cbiAgICB0aGlzLmNoYW5nZWQgPSBvcHRzLmNoYW5nZWQgPz8gKCgpID0+IHsgLyogcGFzcyAqLyB9KVxuICAgIHRoaXMuc2V0ID0gb3B0cy5zZXRcbiAgICB0aGlzLm1pbiA9IG9wdHMubWluID8/IDBcblxuICAgIERvYy5iaW5kKGlucHV0LCAnY2hhbmdlJywgKCkgPT4geyB0aGlzLmlucHV0Q2hhbmdlZCgpIH0pXG4gIH1cblxuICBpbnB1dENoYW5nZWQgKCkge1xuICAgIGNvbnN0IHsgY2hhbmdlZCB9ID0gdGhpc1xuICAgIGlmIChjaGFuZ2VkKSBjaGFuZ2VkKHRoaXMudmFsdWUoKSlcbiAgfVxuXG4gIHNldFZhbHVlICh2OiBudW1iZXIpIHtcbiAgICB0aGlzLmlucHV0LnZhbHVlID0gU3RyaW5nKHYpXG4gICAgdiA9IHRoaXMudmFsdWUoKVxuICAgIGlmICh0aGlzLnNldCkgdGhpcy5zZXQodiwgdGhpcy5pbnB1dC52YWx1ZSlcbiAgfVxuXG4gIHZhbHVlICgpIHtcbiAgICBjb25zdCB7IGlucHV0LCBtaW4sIHByZWMsIGZtdCB9ID0gdGhpc1xuICAgIGNvbnN0IHJhd1YgPSBNYXRoLm1heChwYXJzZUZsb2F0RGVmYXVsdChpbnB1dC52YWx1ZSwgbWluID8/IDApLCBtaW4gPz8gMClcbiAgICBjb25zdCBbdiwgc10gPSBmbXQocmF3ViwgcHJlYyA/PyAwKVxuICAgIGlucHV0LnZhbHVlID0gc1xuICAgIHJldHVybiB2XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbmNyZW1lbnRhbElucHV0T3B0cyBleHRlbmRzIE51bWJlcklucHV0T3B0cyB7XG4gIGluYz86IG51bWJlclxufVxuXG5leHBvcnQgY2xhc3MgSW5jcmVtZW50YWxJbnB1dCBleHRlbmRzIE51bWJlcklucHV0IHtcbiAgaW5jOiBudW1iZXJcbiAgb3B0czogSW5jcmVtZW50YWxJbnB1dE9wdHNcblxuICBjb25zdHJ1Y3RvciAoYm94OiBQYWdlRWxlbWVudCwgb3B0czogSW5jcmVtZW50YWxJbnB1dE9wdHMpIHtcbiAgICBzdXBlcihEb2Muc2FmZVNlbGVjdG9yKGJveCwgJ2lucHV0JyksIG9wdHMpXG4gICAgdGhpcy5vcHRzID0gb3B0c1xuICAgIHRoaXMuaW5jID0gb3B0cy5pbmMgPz8gMVxuXG4gICAgY29uc3QgdXAgPSBEb2Muc2FmZVNlbGVjdG9yKGJveCwgJy5pY28tYXJyb3d1cCcpXG4gICAgY29uc3QgZG93biA9IERvYy5zYWZlU2VsZWN0b3IoYm94LCAnLmljby1hcnJvd2Rvd24nKVxuXG4gICAgRG9jLmJpbmQodXAsICdjbGljaycsICgpID0+IHsgdGhpcy5pbmNyZW1lbnQoMSkgfSlcbiAgICBEb2MuYmluZChkb3duLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuaW5jcmVtZW50KC0xKSB9KVxuICB9XG5cbiAgc2V0SW5jcmVtZW50QW5kTWluaW11bSAoaW5jOiBudW1iZXIsIG1pbjogbnVtYmVyKSB7XG4gICAgdGhpcy5pbmMgPSBpbmNcbiAgICB0aGlzLm1pbiA9IG1pblxuICB9XG5cbiAgaW5jcmVtZW50IChzaWduOiBudW1iZXIpIHtcbiAgICBjb25zdCB7IGluYywgbWluLCBpbnB1dCB9ID0gdGhpc1xuICAgIGlucHV0LnZhbHVlID0gU3RyaW5nKE1hdGgubWF4KHRoaXMudmFsdWUoKSArIHNpZ24gKiBpbmMsIG1pbikpXG4gICAgdGhpcy5pbnB1dENoYW5nZWQoKVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBNaW5pU2xpZGVyIHtcbiAgdHJhY2s6IFBhZ2VFbGVtZW50XG4gIGJhbGw6IFBhZ2VFbGVtZW50XG4gIHI6IG51bWJlclxuICBjaGFuZ2VkOiAocjogbnVtYmVyKSA9PiB2b2lkXG5cbiAgY29uc3RydWN0b3IgKGJveDogUGFnZUVsZW1lbnQsIGNoYW5nZWQ6IChyOiBudW1iZXIpID0+IHZvaWQpIHtcbiAgICB0aGlzLmNoYW5nZWQgPSBjaGFuZ2VkXG4gICAgdGhpcy5yID0gMFxuXG4gICAgY29uc3QgY29sb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNvbG9yLmRhdGFzZXQudG1wbCA9ICdjb2xvcidcbiAgICBib3guYXBwZW5kQ2hpbGQoY29sb3IpXG4gICAgY29uc3QgdHJhY2sgPSB0aGlzLnRyYWNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICB0cmFjay5kYXRhc2V0LnRtcGwgPSAndHJhY2snXG4gICAgY29sb3IuYXBwZW5kQ2hpbGQodHJhY2spXG4gICAgY29uc3QgYmFsbCA9IHRoaXMuYmFsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgYmFsbC5kYXRhc2V0LnRtcGwgPSAnYmFsbCdcbiAgICB0cmFjay5hcHBlbmRDaGlsZChiYWxsKVxuXG4gICAgRG9jLmJpbmQoYm94LCAnbW91c2Vkb3duJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmJ1dHRvbiAhPT0gMCkgcmV0dXJuXG4gICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIGNvbnN0IHN0YXJ0WCA9IGUucGFnZVhcbiAgICAgIGNvbnN0IHcgPSB0cmFjay5jbGllbnRXaWR0aFxuICAgICAgY29uc3Qgc3RhcnRMZWZ0ID0gdGhpcy5yICogd1xuICAgICAgY29uc3QgbGVmdCA9IChlZTogTW91c2VFdmVudCkgPT4gTWF0aC5tYXgoTWF0aC5taW4oc3RhcnRMZWZ0ICsgKGVlLnBhZ2VYIC0gc3RhcnRYKSwgdyksIDApXG4gICAgICBjb25zdCB0cmFja01vdXNlID0gKGVlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIGVlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgY29uc3QgbCA9IGxlZnQoZWUpXG4gICAgICAgIHRoaXMuciA9IGwgLyB3XG4gICAgICAgIGJhbGwuc3R5bGUubGVmdCA9IGAke3RoaXMuciAqIDEwMH0lYFxuICAgICAgICB0aGlzLmNoYW5nZWQodGhpcy5yKVxuICAgICAgfVxuICAgICAgY29uc3QgbW91c2VVcCA9IChlZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICB0cmFja01vdXNlKGVlKVxuICAgICAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdHJhY2tNb3VzZSlcbiAgICAgICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ21vdXNldXAnLCBtb3VzZVVwKVxuICAgICAgfVxuICAgICAgRG9jLmJpbmQoZG9jdW1lbnQsICdtb3VzZW1vdmUnLCB0cmFja01vdXNlKVxuICAgICAgRG9jLmJpbmQoZG9jdW1lbnQsICdtb3VzZXVwJywgbW91c2VVcClcbiAgICB9KVxuXG4gICAgRG9jLmJpbmQoYm94LCAnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKGUuYnV0dG9uICE9PSAwKSByZXR1cm5cbiAgICAgIGNvbnN0IHggPSBlLnBhZ2VYXG4gICAgICBjb25zdCBtID0gRG9jLmxheW91dE1ldHJpY3ModHJhY2spXG4gICAgICB0aGlzLnIgPSBjbGFtcCgoeCAtIG0uYm9keUxlZnQpIC8gbS53aWR0aCwgMCwgMSlcbiAgICAgIGJhbGwuc3R5bGUubGVmdCA9IGAke3RoaXMuciAqIG0ud2lkdGh9cHhgXG4gICAgICB0aGlzLmNoYW5nZWQodGhpcy5yKVxuICAgIH0pXG4gIH1cblxuICBzZXRWYWx1ZSAocjogbnVtYmVyKSB7XG4gICAgdGhpcy5yID0gY2xhbXAociwgMCwgMSlcbiAgICB0aGlzLmJhbGwuc3R5bGUubGVmdCA9IGAke3RoaXMuciAqIDEwMH0lYFxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b1ByZWNpc2lvbiAodjogbnVtYmVyLCBwcmVjOiBudW1iZXIpOiBbbnVtYmVyLCBzdHJpbmddIHtcbiAgY29uc3Qgb3JkID0gTWF0aC5wb3coMTAsIHByZWMgPz8gMClcbiAgdiA9IE1hdGgucm91bmQodiAqIG9yZCkgLyBvcmRcbiAgbGV0IHMgPSB2LnRvRml4ZWQocHJlYylcbiAgaWYgKHByZWMgPiAwKSB7XG4gICAgd2hpbGUgKHMuZW5kc1dpdGgoJzAnKSkgcyA9IHMuc3Vic3RyaW5nKDAsIHMubGVuZ3RoIC0gMSlcbiAgICBpZiAocy5lbmRzV2l0aCgnLicpKSBzID0gcy5zdWJzdHJpbmcoMCwgcy5sZW5ndGggLSAxKVxuICB9XG4gIHJldHVybiBbdiwgc11cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvRm91clNpZ0ZpZ3MgKHY6IG51bWJlciwgbWF4UHJlYzogbnVtYmVyKTogW251bWJlciwgc3RyaW5nXSB7XG4gIGNvbnN0IG9yZCA9IE1hdGguZmxvb3IoTWF0aC5sb2cxMChNYXRoLmFicyh2KSkpXG4gIGlmIChvcmQgPj0gMykgcmV0dXJuIFtNYXRoLnJvdW5kKHYpLCB2LnRvRml4ZWQoMCldXG4gIGNvbnN0IHByZWMgPSBNYXRoLm1pbig0IC0gb3JkLCBtYXhQcmVjKVxuICByZXR1cm4gdG9QcmVjaXNpb24odiwgcHJlYylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRmxvYXREZWZhdWx0IChpbnB1dFZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQsIGRlZmF1bHRWYWx1ZT86IG51bWJlcikge1xuICBjb25zdCB2ID0gcGFyc2VGbG9hdCgoaW5wdXRWYWx1ZSA/PyAnJykucmVwbGFjZSgvLC9nLCAnJykpXG4gIGlmICghaXNOYU4odikpIHJldHVybiB2XG4gIHJldHVybiBkZWZhdWx0VmFsdWUgPz8gMFxufVxuXG4vKiBjbGFtcCByZXR1cm5zIHYgaWYgbWluIDw9IHYgPD0gbWF4LCBlbHNlIG1pbiBvciBtYXguICovXG5leHBvcnQgZnVuY3Rpb24gY2xhbXAgKHY6IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcbiAgaWYgKHYgPCBtaW4pIHJldHVybiBtaW5cbiAgaWYgKHYgPiBtYXgpIHJldHVybiBtYXhcbiAgcmV0dXJuIHZcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldHVwQ29weUJ0biAodHh0OiBzdHJpbmcsIHRleHRFbDogUGFnZUVsZW1lbnQsIGJ0bkVsOiBQYWdlRWxlbWVudCwgY29sb3I6IHN0cmluZykge1xuICB0cnkge1xuICAgIGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHR4dClcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcignVW5hYmxlIHRvIGNvcHk6ICcsIGVycilcbiAgfVxuICBjb25zdCB0ZXh0T3JpZ2luYWxDb2xvciA9IHRleHRFbC5zdHlsZS5jb2xvclxuICBjb25zdCBidG5PcmlnaW5hbENvbG9yID0gYnRuRWwuc3R5bGUuY29sb3JcbiAgdGV4dEVsLnN0eWxlLmNvbG9yID0gY29sb3JcbiAgYnRuRWwuc3R5bGUuY29sb3IgPSBjb2xvclxuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICB0ZXh0RWwuc3R5bGUuY29sb3IgPSB0ZXh0T3JpZ2luYWxDb2xvclxuICAgIGJ0bkVsLnN0eWxlLmNvbG9yID0gYnRuT3JpZ2luYWxDb2xvclxuICB9LCAzNTApXG59XG4iLCJpbXBvcnQgRG9jLCB7IEFuaW1hdGlvbiB9IGZyb20gJy4vZG9jJ1xuaW1wb3J0IHsgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQgU3RhdGUgZnJvbSAnLi9zdGF0ZSdcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0IHsgV2F2ZSB9IGZyb20gJy4vY2hhcnRzJ1xuaW1wb3J0IHtcbiAgYm9uZFJlc2VydmVNdWx0aXBsaWVyLFxuICBwZXJUaWVyQmFzZVBhcmNlbExpbWl0LFxuICBwYXJjZWxMaW1pdFNjb3JlTXVsdGlwbGllcixcbiAgc3Ryb25nVGllclxufSBmcm9tICcuL2FjY291bnQnXG5pbXBvcnQge1xuICBhcHAsXG4gIFN1cHBvcnRlZEFzc2V0LFxuICBQYWdlRWxlbWVudCxcbiAgV2FsbGV0RGVmaW5pdGlvbixcbiAgQ29uZmlnT3B0aW9uLFxuICBFeGNoYW5nZSxcbiAgTWFya2V0LFxuICBCb25kQXNzZXQsXG4gIFdhbGxldFN0YXRlLFxuICBCYWxhbmNlTm90ZSxcbiAgT3JkZXIsXG4gIFhZUmFuZ2UsXG4gIFdhbGxldFN0YXRlTm90ZSxcbiAgV2FsbGV0U3luY05vdGUsXG4gIFdhbGxldEluZm8sXG4gIFRva2VuLFxuICBXYWxsZXRDcmVhdGlvbk5vdGUsXG4gIENvcmVOb3RlLFxuICBQcmVwYWlkQm9uZElEXG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgeyBYWVJhbmdlSGFuZGxlciB9IGZyb20gJy4vb3B0cydcbmltcG9ydCB7IENvaW5FeHBsb3JlcnMgfSBmcm9tICcuL2NvaW5leHBsb3JlcnMnXG5pbXBvcnQgeyBNTSwgc2V0Q2V4RWxlbWVudHMgfSBmcm9tICcuL21tdXRpbCdcblxuaW50ZXJmYWNlIENvbmZpZ09wdGlvbklucHV0IGV4dGVuZHMgSFRNTElucHV0RWxlbWVudCB7XG4gIGNvbmZpZ09wdDogQ29uZmlnT3B0aW9uXG59XG5cbmludGVyZmFjZSBQcm9ncmVzc1BvaW50IHtcbiAgc3RhbXA6IG51bWJlclxuICBwcm9ncmVzczogbnVtYmVyXG59XG5cbmludGVyZmFjZSBDdXJyZW50QXNzZXQge1xuICBhc3NldDogU3VwcG9ydGVkQXNzZXRcbiAgcGFyZW50QXNzZXQ/OiBTdXBwb3J0ZWRBc3NldFxuICB3aW5mbzogV2FsbGV0SW5mbyB8IFRva2VuXG4gIC8vIHNlbGVjdGVkRGVmIGlzIHVzZWQgaW4gYSBzdHJhbmdlIHdheSBmb3IgdG9rZW5zLiBJZiBhIHRva2VuJ3MgcGFyZW50IHdhbGxldFxuICAvLyBhbHJlYWR5IGV4aXN0cywgdGhlbiBzZWxlY3RlZERlZiBpcyBnb2luZyB0byBiZSB0aGUgVG9rZW4uZGVmaW5pdGlvbi5cbiAgLy8gQlVULCBpZiB0aGUgdG9rZW4ncyBwYXJlbnQgd2FsbGV0IGRvZXNuJ3QgZXhpc3QgeWV0LCB0aGUgTmV3V2FsbGV0Rm9ybVxuICAvLyBvcGVyYXRlcyBpbiBhIGNvbWJpbmVkIGNvbmZpZ3VyYXRpb24gbW9kZSwgYW5kIHRoZSBzZWxlY3RlZERlZiB3aWxsIGJlIHRoZVxuICAvLyBjdXJyZW50bHkgc2VsZWN0ZWQgcGFyZW50IGFzc2V0IGRlZmluaXRpb24uIFRoZXJlIGlzIG5vIGxvc3Mgb2YgaW5mb1xuICAvLyBpbiBzdWNoIGEgY2FzZSwgYmVjYXVzZSB0aGUgdG9rZW4gd2FsbGV0IG9ubHkgaGFzIG9uZSBkZWZpbml0aW9uLlxuICBzZWxlY3RlZERlZjogV2FsbGV0RGVmaW5pdGlvblxufVxuXG5pbnRlcmZhY2UgV2FsbGV0Q29uZmlnIHtcbiAgYXNzZXRJRDogbnVtYmVyXG4gIGNvbmZpZzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICB3YWxsZXRUeXBlOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIEZvcm1zQ29uZmlnIHtcbiAgY2xvc2VkPzogKCkgPT4gdm9pZFxufVxuXG5leHBvcnQgY2xhc3MgRm9ybXMge1xuICBmb3Jtc0RpdjogUGFnZUVsZW1lbnRcbiAgY3VycmVudEZvcm06IFBhZ2VFbGVtZW50XG4gIGtleXVwOiAoZTogS2V5Ym9hcmRFdmVudCkgPT4gdm9pZFxuICBjbG9zZWQ/OiAoKSA9PiB2b2lkXG5cbiAgY29uc3RydWN0b3IgKGZvcm1zRGl2OiBQYWdlRWxlbWVudCwgY2ZnPzogRm9ybXNDb25maWcpIHtcbiAgICB0aGlzLmZvcm1zRGl2ID0gZm9ybXNEaXZcbiAgICB0aGlzLmNsb3NlZCA9IGNmZz8uY2xvc2VkXG5cbiAgICBmb3Jtc0Rpdi5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIERvYy5iaW5kKGVsLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuY2xvc2UoKSB9KVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChmb3Jtc0RpdiwgJ21vdXNlZG93bicsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoIURvYy5tb3VzZUluRWxlbWVudChlLCB0aGlzLmN1cnJlbnRGb3JtKSkgeyB0aGlzLmNsb3NlKCkgfVxuICAgIH0pXG5cbiAgICB0aGlzLmtleXVwID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuICB9XG5cbiAgLyogc2hvd0Zvcm0gc2hvd3MgYSBtb2RhbCBmb3JtIHdpdGggYSBsaXR0bGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBzaG93IChmb3JtOiBIVE1MRWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuY3VycmVudEZvcm0gPSBmb3JtXG4gICAgRG9jLmhpZGUoLi4uQXJyYXkuZnJvbSh0aGlzLmZvcm1zRGl2LmNoaWxkcmVuKSlcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzEwMDAwcHgnXG4gICAgRG9jLnNob3codGhpcy5mb3Jtc0RpdiwgZm9ybSlcbiAgICBjb25zdCBzaGlmdCA9ICh0aGlzLmZvcm1zRGl2Lm9mZnNldFdpZHRoICsgZm9ybS5vZmZzZXRXaWR0aCkgLyAyXG4gICAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pbWF0aW9uTGVuZ3RoLCBwcm9ncmVzcyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gYCR7KDEgLSBwcm9ncmVzcykgKiBzaGlmdH1weGBcbiAgICB9LCAnZWFzZU91dEhhcmQnKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMCdcbiAgfVxuXG4gIGNsb3NlICgpOiB2b2lkIHtcbiAgICBEb2MuaGlkZSh0aGlzLmZvcm1zRGl2KVxuICAgIGlmICh0aGlzLmNsb3NlZCkgdGhpcy5jbG9zZWQoKVxuICB9XG5cbiAgZXhpdCAoKSB7XG4gICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5rZXl1cClcbiAgfVxufVxuXG4vKlxuICogTmV3V2FsbGV0Rm9ybSBzaG91bGQgYmUgdXNlZCB3aXRoIHRoZSBcIm5ld1dhbGxldEZvcm1cIiB0ZW1wbGF0ZS4gVGhlIGVuY2xvc2luZ1xuICogPGZvcm0+IGVsZW1lbnQgc2hvdWxkIGJlIHRoZSBmaXJzdCBhcmd1bWVudCBvZiB0aGUgY29uc3RydWN0b3IuXG4gKi9cbmV4cG9ydCBjbGFzcyBOZXdXYWxsZXRGb3JtIHtcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGZvcm06IEhUTUxFbGVtZW50XG4gIHN1Y2Nlc3M6IChhc3NldElEOiBudW1iZXIpID0+IHZvaWRcbiAgY3VycmVudDogQ3VycmVudEFzc2V0XG4gIHN1YmZvcm06IFdhbGxldENvbmZpZ0Zvcm1cbiAgd2FsbGV0Q2ZnR3VpZGU6IFBhZ2VFbGVtZW50XG4gIHBhcmVudFN5bmNlcjogbnVsbCB8ICgodzogV2FsbGV0U3RhdGUpID0+IHZvaWQpXG4gIGNyZWF0ZVVwZGF0ZXI6IG51bGwgfCAoKG5vdGU6IFdhbGxldENyZWF0aW9uTm90ZSkgPT4gdm9pZClcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogSFRNTEVsZW1lbnQsIHN1Y2Nlc3M6IChhc3NldElEOiBudW1iZXIpID0+IHZvaWQsIGJhY2tGdW5jPzogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGZvcm0pXG5cbiAgICBpZiAoYmFja0Z1bmMpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuZ29CYWNrKVxuICAgICAgRG9jLmJpbmQocGFnZS5nb0JhY2ssICdjbGljaycsICgpID0+IHsgYmFja0Z1bmMoKSB9KVxuICAgIH1cblxuICAgIERvYy5lbXB0eShwYWdlLndhbGxldFRhYlRtcGwpXG4gICAgcGFnZS53YWxsZXRUYWJUbXBsLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKVxuXG4gICAgLy8gV2FsbGV0Q29uZmlnRm9ybSB3aWxsIHNldCB0aGUgZ2xvYmFsIGFwcCB2YXJpYWJsZS5cbiAgICB0aGlzLnN1YmZvcm0gPSBuZXcgV2FsbGV0Q29uZmlnRm9ybShwYWdlLndhbGxldFNldHRpbmdzLCB0cnVlKVxuXG4gICAgdGhpcy53YWxsZXRDZmdHdWlkZSA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnd2FsbGV0Q2ZnR3VpZGUnKVxuXG4gICAgYmluZChmb3JtLCBwYWdlLnN1Ym1pdEFkZCwgKCkgPT4gdGhpcy5zdWJtaXQoKSlcbiAgICBiaW5kKGZvcm0sIHBhZ2Uub25lQnR0biwgKCkgPT4gdGhpcy5zdWJtaXQoKSlcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICB3YWxsZXRzdGF0ZTogKG5vdGU6IFdhbGxldFN0YXRlTm90ZSkgPT4geyB0aGlzLnJlcG9ydFdhbGxldFN0YXRlKG5vdGUud2FsbGV0KSB9LFxuICAgICAgd2FsbGV0c3luYzogKG5vdGU6IFdhbGxldFN5bmNOb3RlKSA9PiB7IGlmICh0aGlzLnBhcmVudFN5bmNlcikgdGhpcy5wYXJlbnRTeW5jZXIoYXBwKCkud2FsbGV0TWFwW25vdGUuYXNzZXRJRF0pIH0sXG4gICAgICBjcmVhdGV3YWxsZXQ6IChub3RlOiBXYWxsZXRDcmVhdGlvbk5vdGUpID0+IHsgdGhpcy5yZXBvcnRDcmVhdGlvblVwZGF0ZShub3RlKSB9XG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydFdhbGxldFN0YXRlIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhICd3YWxsZXRzdGF0ZScgbm90aWZpY2F0aW9uIGlzXG4gICAqIHJlY2VpdmVkLlxuICAgKiBUT0RPOiBMZXQgZm9ybSBjbGFzc2VzIHJlZ2lzdGVyIGZvciBub3RpZmljYXRpb25zLlxuICAgKi9cbiAgcmVwb3J0V2FsbGV0U3RhdGUgKHc6IFdhbGxldFN0YXRlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucGFyZW50U3luY2VyKSB0aGlzLnBhcmVudFN5bmNlcih3KVxuICB9XG5cbiAgLypcbiAgICogcmVwb3J0V2FsbGV0U3RhdGUgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGEgJ2NyZWF0ZXdhbGxldCcgbm90aWZpY2F0aW9uIGlzXG4gICAqIHJlY2VpdmVkLlxuICAgKi9cbiAgcmVwb3J0Q3JlYXRpb25VcGRhdGUgKG5vdGU6IFdhbGxldENyZWF0aW9uTm90ZSkge1xuICAgIGlmICh0aGlzLmNyZWF0ZVVwZGF0ZXIpIHRoaXMuY3JlYXRlVXBkYXRlcihub3RlKVxuICB9XG5cbiAgYXN5bmMgY3JlYXRlV2FsbGV0IChhc3NldElEOiBudW1iZXIsIHdhbGxldFR5cGU6IHN0cmluZywgcGFyZW50Rm9ybT86IFdhbGxldENvbmZpZykge1xuICAgIGNvbnN0IGNyZWF0ZUZvcm0gPSB7XG4gICAgICBhc3NldElEOiBhc3NldElELFxuICAgICAgcGFzczogdGhpcy5wYWdlLm5ld1dhbGxldFBhc3MudmFsdWUgfHwgJycsXG4gICAgICBjb25maWc6IHRoaXMuc3ViZm9ybS5tYXAoYXNzZXRJRCksXG4gICAgICB3YWxsZXRUeXBlOiB3YWxsZXRUeXBlLFxuICAgICAgcGFyZW50Rm9ybTogcGFyZW50Rm9ybVxuICAgIH1cblxuICAgIGNvbnN0IGFuaSA9IG5ldyBXYXZlKHRoaXMuZm9ybSwgeyBiYWNrZ3JvdW5kQ29sb3I6IHRydWUgfSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9uZXd3YWxsZXQnLCBjcmVhdGVGb3JtKVxuICAgIGFuaS5zdG9wKClcbiAgICByZXR1cm4gcmVzXG4gIH1cblxuICBhc3luYyBzdWJtaXQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBuZXdXYWxsZXRQYXNzID0gcGFnZS5uZXdXYWxsZXRQYXNzIGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICBEb2MuaGlkZShwYWdlLm5ld1dhbGxldEVycilcblxuICAgIGNvbnN0IHsgYXNzZXQsIHBhcmVudEFzc2V0IH0gPSB0aGlzLmN1cnJlbnRcbiAgICBjb25zdCBzZWxlY3RlZERlZiA9IHRoaXMuY3VycmVudC5zZWxlY3RlZERlZlxuICAgIGxldCBwYXJlbnRGb3JtXG4gICAgbGV0IHdhbGxldFR5cGUgPSBzZWxlY3RlZERlZi50eXBlXG4gICAgaWYgKHBhcmVudEFzc2V0KSB7XG4gICAgICB3YWxsZXRUeXBlID0gKGFzc2V0LnRva2VuIGFzIFRva2VuKS5kZWZpbml0aW9uLnR5cGVcbiAgICAgIHBhcmVudEZvcm0gPSB7XG4gICAgICAgIGFzc2V0SUQ6IHBhcmVudEFzc2V0LmlkLFxuICAgICAgICBjb25maWc6IHRoaXMuc3ViZm9ybS5tYXAocGFyZW50QXNzZXQuaWQpLFxuICAgICAgICB3YWxsZXRUeXBlOiBzZWxlY3RlZERlZi50eXBlXG4gICAgICB9XG4gICAgfVxuICAgIC8vIFJlZ2lzdGVyIHRoZSBzZWxlY3RlZCBhc3NldC5cbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmNyZWF0ZVdhbGxldChhc3NldC5pZCwgd2FsbGV0VHlwZSwgcGFyZW50Rm9ybSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgdGhpcy5zZXRFcnJvcihyZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIG5ld1dhbGxldFBhc3MudmFsdWUgPSAnJ1xuICAgIGlmIChwYXJlbnRBc3NldCkgYXdhaXQgdGhpcy5ydW5QYXJlbnRTeW5jKClcbiAgICBlbHNlIHRoaXMuc3VjY2Vzcyh0aGlzLmN1cnJlbnQuYXNzZXQuaWQpXG4gIH1cblxuICAvKlxuICAgKiBydW5QYXJlbnRTeW5jIHNob3dzIGEgc3luY2luZyBzdWItZGlhbG9nIHRoYXQgdHJhY2tzIHRoZSBwYXJlbnQgYXNzZXQnc1xuICAgKiBzeW5jUHJvZ3Jlc3MgYW5kIGluZm9ybXMgdGhlIHVzZXIgdGhhdCB0aGUgdG9rZW4gd2FsbGV0IHdpbGwgYmUgY3JlYXRlZFxuICAgKiBhZnRlciBzeW5jIGlzIGNvbXBsZXRlLlxuICAgKi9cbiAgYXN5bmMgcnVuUGFyZW50U3luYyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBjdXJyZW50OiB7IHBhcmVudEFzc2V0LCBhc3NldCB9IH0gPSB0aGlzXG4gICAgaWYgKCFwYXJlbnRBc3NldCkgcmV0dXJuXG5cbiAgICBwYWdlLnBhcmVudFN5bmNQY3QudGV4dENvbnRlbnQgPSAnMCdcbiAgICBwYWdlLnBhcmVudE5hbWUudGV4dENvbnRlbnQgPSBwYXJlbnRBc3NldC5uYW1lXG4gICAgcGFnZS5wYXJlbnRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChwYXJlbnRBc3NldC5zeW1ib2wpXG4gICAgcGFnZS5jaGlsZE5hbWUudGV4dENvbnRlbnQgPSBhc3NldC5uYW1lXG4gICAgcGFnZS5jaGlsZExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGFzc2V0LnN5bWJvbClcbiAgICBEb2MuaGlkZShwYWdlLm1haW5Gb3JtKVxuICAgIERvYy5zaG93KHBhZ2UucGFyZW50U3luY2luZylcblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnN5bmNQYXJlbnQocGFyZW50QXNzZXQpXG4gICAgICB0aGlzLnN1Y2Nlc3ModGhpcy5jdXJyZW50LmFzc2V0LmlkKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLnNldEVycm9yKGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UubWFpbkZvcm0pXG4gICAgRG9jLmhpZGUocGFnZS5wYXJlbnRTeW5jaW5nKVxuICB9XG5cbiAgLypcbiAgICogc3luY1BhcmVudCBtb25pdG9ycyB0aGUgc3luYyBwcm9ncmVzcyBvZiBhIHRva2VuJ3MgcGFyZW50IGFzc2V0LCBnZW5lcmF0aW5nXG4gICAqIGFuIEVycm9yIGlmIHRoZSB0b2tlbiB3YWxsZXQgY3JlYXRpb24gZG9lcyBub3QgY29tcGxldGUgc3VjY2Vzc2Z1bGx5LlxuICAgKi9cbiAgc3luY1BhcmVudCAocGFyZW50QXNzZXQ6IFN1cHBvcnRlZEFzc2V0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyBwYWdlLCBjdXJyZW50OiB7IGFzc2V0IH0gfSA9IHRoaXNcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgLy8gRmlyc3QsIGNoZWNrIGlmIGl0J3MgYWxyZWFkeSBzeW5jZWQuXG4gICAgICBjb25zdCB3ID0gYXBwKCkuYXNzZXRzW3BhcmVudEFzc2V0LmlkXS53YWxsZXRcbiAgICAgIGlmICh3ICYmIHcuc3luY2VkKSByZXR1cm4gcmVzb2x2ZSgpXG4gICAgICAvLyBOb3Qgc3luY2VkLCBzbyBjcmVhdGUgYSBzeW5jZXIgdG8gdXBkYXRlIHRoZSBwYXJlbnQgc3luYyBwYW5lLlxuICAgICAgdGhpcy5wYXJlbnRTeW5jZXIgPSAodzogV2FsbGV0U3RhdGUpID0+IHtcbiAgICAgICAgaWYgKHcuYXNzZXRJRCAhPT0gcGFyZW50QXNzZXQuaWQpIHJldHVyblxuICAgICAgICBwYWdlLnBhcmVudFN5bmNQY3QudGV4dENvbnRlbnQgPSAody5zeW5jUHJvZ3Jlc3MgKiAxMDApLnRvRml4ZWQoMSlcbiAgICAgIH1cbiAgICAgIC8vIEhhbmRsZSB0aGUgYXN5bmMgcmVzdWx0LlxuICAgICAgdGhpcy5jcmVhdGVVcGRhdGVyID0gKG5vdGU6IFdhbGxldENyZWF0aW9uTm90ZSkgPT4ge1xuICAgICAgICBpZiAobm90ZS5hc3NldElEICE9PSBhc3NldC5pZCkgcmV0dXJuXG4gICAgICAgIHN3aXRjaCAobm90ZS50b3BpYykge1xuICAgICAgICAgIGNhc2UgJ1F1ZXVlZENyZWF0aW9uRmFpbGVkJzpcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYCR7bm90ZS5zdWJqZWN0fTogJHtub3RlLmRldGFpbHN9YCkpXG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIGNhc2UgJ1F1ZXVlZENyZWF0aW9uU3VjY2Vzcyc6XG4gICAgICAgICAgICByZXNvbHZlKClcbiAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50U3luY2VyID0gbnVsbFxuICAgICAgICB0aGlzLmNyZWF0ZVVwZGF0ZXIgPSBudWxsXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8qIHNldEFzc2V0IHNldHMgdGhlIGN1cnJlbnQgYXNzZXQgb2YgdGhlIE5ld1dhbGxldEZvcm0gKi9cbiAgYXN5bmMgc2V0QXNzZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGlmICghdGhpcy5wYXJzZUFzc2V0KGFzc2V0SUQpKSByZXR1cm4gLy8gbm90aGluZyB0byBjaGFuZ2VcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgdGFicyA9IHBhZ2Uud2FsbGV0VHlwZVRhYnNcbiAgICBjb25zdCB7IHdpbmZvLCBhc3NldCwgcGFyZW50QXNzZXQgfSA9IHRoaXMuY3VycmVudFxuICAgIHBhZ2UuYXNzZXROYW1lLnRleHRDb250ZW50ID0gd2luZm8ubmFtZVxuICAgIHBhZ2UubmV3V2FsbGV0UGFzcy52YWx1ZSA9ICcnXG5cbiAgICBEb2MuZW1wdHkodGFicylcbiAgICBEb2MuaGlkZSh0YWJzLCBwYWdlLm5ld1dhbGxldEVyciwgcGFnZS50b2tlbk1zZ0JveClcbiAgICB0aGlzLnBhZ2UuYXNzZXRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChhc3NldC5zeW1ib2wpXG4gICAgaWYgKHBhcmVudEFzc2V0KSB7XG4gICAgICBwYWdlLnRva2VuUGFyZW50TG9nby5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50QXNzZXQuc3ltYm9sKVxuICAgICAgcGFnZS50b2tlblBhcmVudE5hbWUudGV4dENvbnRlbnQgPSBwYXJlbnRBc3NldC5uYW1lXG4gICAgICBEb2Muc2hvdyhwYWdlLnRva2VuTXNnQm94KVxuICAgIH1cblxuICAgIGNvbnN0IHBpbmZvID0gcGFyZW50QXNzZXQgPyBwYXJlbnRBc3NldC5pbmZvIDogbnVsbFxuICAgIGNvbnN0IHdhbGxldERlZnMgPSBwaW5mbyA/IHBpbmZvLmF2YWlsYWJsZXdhbGxldHMgOiAod2luZm8gYXMgV2FsbGV0SW5mbykuYXZhaWxhYmxld2FsbGV0cyA/ICh3aW5mbyBhcyBXYWxsZXRJbmZvKS5hdmFpbGFibGV3YWxsZXRzIDogWyh3aW5mbyBhcyBUb2tlbikuZGVmaW5pdGlvbl1cblxuICAgIGlmICh3YWxsZXREZWZzLmxlbmd0aCA+IDEpIHtcbiAgICAgIERvYy5zaG93KHRhYnMpXG4gICAgICBmb3IgKGNvbnN0IHdEZWYgb2Ygd2FsbGV0RGVmcykge1xuICAgICAgICBjb25zdCB0YWIgPSBwYWdlLndhbGxldFRhYlRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgICAgIHRhYi5kYXRhc2V0LnRvb2x0aXAgPSB3RGVmLmRlc2NyaXB0aW9uXG4gICAgICAgIHRhYi50ZXh0Q29udGVudCA9IHdEZWYudGFiXG4gICAgICAgIHRhYnMuYXBwZW5kQ2hpbGQodGFiKVxuICAgICAgICBEb2MuYmluZCh0YWIsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgRG9jLmtpZHModGFicykpIHQuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgICAgICAgIHRhYi5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgICAgICAgdGhpcy51cGRhdGUod0RlZilcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIGFwcCgpLmJpbmRUb29sdGlwcyh0YWJzKVxuICAgICAgY29uc3QgZmlyc3QgPSB0YWJzLmZpcnN0Q2hpbGQgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGZpcnN0LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnVwZGF0ZSh0aGlzLmN1cnJlbnQuc2VsZWN0ZWREZWYpXG4gICAgaWYgKGFzc2V0LndhbGxldENyZWF0aW9uUGVuZGluZykgYXdhaXQgdGhpcy5ydW5QYXJlbnRTeW5jKClcbiAgfVxuXG4gIC8qXG4gICogcGFyc2VBc3NldCBwYXJzZXMgdGhlIGN1cnJlbnQgZGF0YSBmb3IgdGhlIGFzc2V0IElELlxuICAqL1xuICBwYXJzZUFzc2V0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBpZiAodGhpcy5jdXJyZW50ICYmIHRoaXMuY3VycmVudC5hc3NldC5pZCA9PT0gYXNzZXRJRCkgcmV0dXJuIGZhbHNlXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICBjb25zdCB0b2tlbiA9IGFzc2V0LnRva2VuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgaWYgKCFhc3NldC5pbmZvKSB0aHJvdyBFcnJvcigndGhpcyBub24tdG9rZW4gYXNzZXQgaGFzIG5vIHdhbGxldCBpbmZvIScpXG4gICAgICB0aGlzLmN1cnJlbnQgPSB7IGFzc2V0LCB3aW5mbzogYXNzZXQuaW5mbywgc2VsZWN0ZWREZWY6IGFzc2V0LmluZm8uYXZhaWxhYmxld2FsbGV0c1swXSB9XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBjb25zdCBwYXJlbnRBc3NldCA9IGFwcCgpLnVzZXIuYXNzZXRzW3Rva2VuLnBhcmVudElEXVxuICAgIGlmIChwYXJlbnRBc3NldC53YWxsZXQpIHtcbiAgICAgIC8vIElmIHRoZSBwYXJlbnQgYXNzZXQgYWxyZWFkeSBoYXMgYSB3YWxsZXQsIHRoZXJlJ3Mgbm8gbmVlZCB0byBjb25maWd1cmVcbiAgICAgIC8vIHRoZSBwYXJlbnQgdG9vLiBKdXN0IGNvbmZpZ3VyZSB0aGUgdG9rZW4uXG4gICAgICB0aGlzLmN1cnJlbnQgPSB7IGFzc2V0LCB3aW5mbzogdG9rZW4sIHNlbGVjdGVkRGVmOiB0b2tlbi5kZWZpbml0aW9uIH1cbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIGlmICghcGFyZW50QXNzZXQuaW5mbykgdGhyb3cgRXJyb3IoJ3RoaXMgcGFyZW50IGhhcyBubyB3YWxsZXQgaW5mbyEnKVxuICAgIHRoaXMuY3VycmVudCA9IHsgYXNzZXQsIHBhcmVudEFzc2V0LCB3aW5mbzogdG9rZW4sIHNlbGVjdGVkRGVmOiBwYXJlbnRBc3NldC5pbmZvLmF2YWlsYWJsZXdhbGxldHNbMF0gfVxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBhc3luYyB1cGRhdGUgKHdhbGxldERlZjogV2FsbGV0RGVmaW5pdGlvbikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmN1cnJlbnQuc2VsZWN0ZWREZWYgPSB3YWxsZXREZWZcbiAgICBEb2MuaGlkZShwYWdlLndhbGxldFBhc3NBbmRTdWJtaXRCdHRuLCBwYWdlLm9uZUJ0dG5Cb3gsIHBhZ2UubmV3V2FsbGV0UGFzc0JveClcbiAgICBjb25zdCBndWlkZUxpbmsgPSB3YWxsZXREZWYuZ3VpZGVsaW5rXG4gICAgY29uc3QgY29uZmlnT3B0cyA9IHdhbGxldERlZi5jb25maWdvcHRzIHx8IFtdXG4gICAgLy8gSWYgYSBjb25maWcgcmVwcmVzZW50cyBhIHdhbGxldCdzIGJpcnRoZGF5LCB3ZSB1cGRhdGUgdGhlIGRlZmF1bHRcbiAgICAvLyBzZWxlY3Rpb24gdG8gdGhlIGN1cnJlbnQgZGF0ZSBpZiB0aGlzIGluc3RhbGxhdGlvbiBvZiB0aGUgY2xpZW50XG4gICAgLy8gZ2VuZXJhdGVkIGEgc2VlZC5cbiAgICBjb25maWdPcHRzLm1hcCgob3B0KSA9PiB7XG4gICAgICBpZiAob3B0LmlzQmlydGhkYXlDb25maWcgJiYgYXBwKCkuc2VlZEdlblRpbWUgPiAwKSB7XG4gICAgICAgIG9wdC5kZWZhdWx0ID0gdG9Vbml4RGF0ZShuZXcgRGF0ZSgpKVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9wdFxuICAgIH0pXG4gICAgLy8gRWl0aGVyIHRoaXMgaXMgYSB3YWxsZXREZWYgZm9yIGEgdG9rZW4ncyB1bmNyZWF0ZWQgcGFyZW50IGFzc2V0LCBvciB0aGlzXG4gICAgLy8gaXMgdGhlIGRlZmluaXRpb24gZm9yIHRoZSB0b2tlbi5cbiAgICBsZXQgY29udGFpbnNSZXF1aXJlZCA9IGZhbHNlXG4gICAgZm9yIChjb25zdCBvcHQgb2YgY29uZmlnT3B0cykge1xuICAgICAgaWYgKG9wdC5yZXF1aXJlZCkge1xuICAgICAgICBjb250YWluc1JlcXVpcmVkID0gdHJ1ZVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCB7IGFzc2V0LCBwYXJlbnRBc3NldCwgd2luZm8gfSA9IHRoaXMuY3VycmVudFxuICAgIGNvbnN0IGRpc3BsYXlDcmVhdGVCdG4gPSB3YWxsZXREZWYuc2VlZGVkIHx8IEJvb2xlYW4oYXNzZXQudG9rZW4pXG4gICAgaWYgKGRpc3BsYXlDcmVhdGVCdG4gJiYgIWNvbnRhaW5zUmVxdWlyZWQpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uud2FsbGV0U2V0dGluZ3NIZWFkZXIpXG4gICAgICBEb2Muc2hvdyhwYWdlLm9uZUJ0dG5Cb3gpXG4gICAgfSBlbHNlIGlmIChkaXNwbGF5Q3JlYXRlQnRuKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLndhbGxldFBhc3NBbmRTdWJtaXRCdHRuLCBwYWdlLndhbGxldFNldHRpbmdzSGVhZGVyKVxuICAgICAgcGFnZS5uZXdXYWxsZXRQYXNzLnZhbHVlID0gJydcbiAgICAgIHBhZ2Uuc3VibWl0QWRkLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQ1JFQVRFKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLndhbGxldFBhc3NBbmRTdWJtaXRCdHRuLCBwYWdlLndhbGxldFNldHRpbmdzSGVhZGVyKVxuICAgICAgaWYgKCF3YWxsZXREZWYubm9hdXRoKSBEb2Muc2hvdyhwYWdlLm5ld1dhbGxldFBhc3NCb3gpXG4gICAgICBwYWdlLnN1Ym1pdEFkZC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FERClcbiAgICB9XG5cbiAgICBpZiAocGFyZW50QXNzZXQpIHtcbiAgICAgIGNvbnN0IHBhcmVudEFuZFRva2VuT3B0cyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29uZmlnT3B0cykpXG4gICAgICAvLyBBZGQgdGhlIHJlZ0Fzc2V0IGZpZWxkIHRvIHRoZSBjb25maWd1cmF0aW9ucyBzbyBwcm9wZXIgbG9nb3Mgd2lsbCBiZSBkaXNwbGF5ZWRcbiAgICAgIC8vIG5leHQgdG8gdGhlbSwgYW5kIG1hcCBjYW4gZmlsdGVyIHRoZW0gb3V0LiBUaGUgb3B0cyBhcmUgY29waWVkIGhlcmUgc28gdGhlIG9yaWdpbmFsc1xuICAgICAgLy8gZG8gbm90IGhhdmUgdGhlIHJlZ0Fzc2V0IGZpZWxkIGFkZGVkIHRvIHRoZW0uXG4gICAgICBmb3IgKGNvbnN0IG9wdCBvZiBwYXJlbnRBbmRUb2tlbk9wdHMpIG9wdC5yZWdBc3NldCA9IHBhcmVudEFzc2V0LmlkXG4gICAgICBjb25zdCB0b2tlbk9wdHMgPSAod2luZm8gYXMgVG9rZW4pLmRlZmluaXRpb24uY29uZmlnb3B0cyB8fCBbXVxuICAgICAgaWYgKHRva2VuT3B0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IHRva2VuT3B0c0NvcHkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRva2VuT3B0cykpXG4gICAgICAgIGZvciAoY29uc3Qgb3B0IG9mIHRva2VuT3B0c0NvcHkpIG9wdC5yZWdBc3NldCA9IGFzc2V0LmlkXG4gICAgICAgIHBhcmVudEFuZFRva2VuT3B0cy5wdXNoKC4uLnRva2VuT3B0c0NvcHkpXG4gICAgICB9XG4gICAgICB0aGlzLnN1YmZvcm0udXBkYXRlKGFzc2V0LmlkLCBwYXJlbnRBbmRUb2tlbk9wdHMsIGZhbHNlKVxuICAgIH0gZWxzZSB0aGlzLnN1YmZvcm0udXBkYXRlKGFzc2V0LmlkLCBjb25maWdPcHRzLCBmYWxzZSlcbiAgICB0aGlzLnNldEd1aWRlTGluayhndWlkZUxpbmspXG5cbiAgICAvLyBBIHNlZWRlZCBvciB0b2tlbiB3YWxsZXQgaXMgaW50ZXJuYWwgdG8gQmlzb24gV2FsbGV0IGFuZCBhcyBzdWNoIGRvZXNcbiAgICAvLyBub3QgaGF2ZSBhbiBleHRlcm5hbCBjb25maWcgZmlsZSB0byBzZWxlY3QuXG4gICAgaWYgKHdhbGxldERlZi5zZWVkZWQgfHwgQm9vbGVhbih0aGlzLmN1cnJlbnQuYXNzZXQudG9rZW4pKSBEb2MuaGlkZSh0aGlzLnN1YmZvcm0uZmlsZVNlbGVjdG9yKVxuICAgIGVsc2UgRG9jLnNob3codGhpcy5zdWJmb3JtLmZpbGVTZWxlY3RvcilcblxuICAgIGF3YWl0IHRoaXMubG9hZERlZmF1bHRzKClcbiAgfVxuXG4gIHNldEd1aWRlTGluayAoZ3VpZGVMaW5rOiBzdHJpbmcpIHtcbiAgICBEb2MuaGlkZSh0aGlzLndhbGxldENmZ0d1aWRlKVxuICAgIGlmIChndWlkZUxpbmsgIT09ICcnKSB7XG4gICAgICB0aGlzLndhbGxldENmZ0d1aWRlLmhyZWYgPSBndWlkZUxpbmtcbiAgICAgIERvYy5zaG93KHRoaXMud2FsbGV0Q2ZnR3VpZGUpXG4gICAgfVxuICB9XG5cbiAgLyogc2V0RXJyb3Igc2V0cyBhbmQgc2hvd3MgdGhlIGluLWZvcm0gZXJyb3IgbWVzc2FnZS4gKi9cbiAgYXN5bmMgc2V0RXJyb3IgKGVyck1zZzogc3RyaW5nKSB7XG4gICAgdGhpcy5wYWdlLm5ld1dhbGxldEVyci50ZXh0Q29udGVudCA9IGVyck1zZ1xuICAgIERvYy5zaG93KHRoaXMucGFnZS5uZXdXYWxsZXRFcnIpXG4gIH1cblxuICAvKlxuICAgKiBsb2FkRGVmYXVsdHMgYXR0ZW1wdHMgdG8gbG9hZCB0aGUgRXhjaGFuZ2VXYWxsZXQgY29uZmlndXJhdGlvbiBmcm9tIHRoZVxuICAgKiBkZWZhdWx0IHdhbGxldCBjb25maWcgcGF0aCBvbiB0aGUgc2VydmVyIGFuZCB3aWxsIGF1dG8tZmlsbCB0aGUgcGFnZSBvblxuICAgKiB0aGUgc3ViZm9ybSBpZiBzZXR0aW5ncyBhcmUgZm91bmQuXG4gICAqL1xuICBhc3luYyBsb2FkRGVmYXVsdHMgKCkge1xuICAgIC8vIE5vIGRlZmF1bHQgY29uZmlnIGZpbGVzIGZvciBzZWVkZWQgYXNzZXRzIHJpZ2h0IG5vdy5cbiAgICBjb25zdCB7IGFzc2V0LCBwYXJlbnRBc3NldCwgc2VsZWN0ZWREZWYgfSA9IHRoaXMuY3VycmVudFxuICAgIGlmICghc2VsZWN0ZWREZWYuY29uZmlncGF0aCkgcmV0dXJuXG4gICAgbGV0IGNvbmZpZ0lEID0gYXNzZXQuaWRcbiAgICBpZiAocGFyZW50QXNzZXQpIHtcbiAgICAgIGlmIChzZWxlY3RlZERlZi5zZWVkZWQpIHJldHVyblxuICAgICAgY29uZmlnSUQgPSBwYXJlbnRBc3NldC5pZFxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9kZWZhdWx0d2FsbGV0Y2ZnJywge1xuICAgICAgYXNzZXRJRDogY29uZmlnSUQsXG4gICAgICB0eXBlOiBzZWxlY3RlZERlZi50eXBlXG4gICAgfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICB0aGlzLnNldEVycm9yKHJlcy5tc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zdWJmb3JtLnNldExvYWRlZENvbmZpZyhyZXMuY29uZmlnKVxuICB9XG59XG5cbmxldCBkeW5hbWljSW5wdXRDb3VudGVyID0gMFxuXG4vKlxuICogV2FsbGV0Q29uZmlnRm9ybSBpcyBhIGR5bmFtaWNhbGx5IGdlbmVyYXRlZCBzdWItZm9ybSBmb3Igc2V0dGluZ1xuICogYXNzZXQtc3BlY2lmaWMgd2FsbGV0IGNvbmZpZ3VyYXRpb24gb3B0aW9ucy5cbiovXG5leHBvcnQgY2xhc3MgV2FsbGV0Q29uZmlnRm9ybSB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBmb3JtOiBIVE1MRWxlbWVudFxuICBjb25maWdFbGVtZW50czogW0NvbmZpZ09wdGlvbiwgSFRNTEVsZW1lbnRdW11cbiAgY29uZmlnT3B0czogQ29uZmlnT3B0aW9uW11cbiAgc2VjdGlvbml6ZTogYm9vbGVhblxuICBhbGxTZXR0aW5nczogUGFnZUVsZW1lbnRcbiAgZHluYW1pY09wdHM6IFBhZ2VFbGVtZW50XG4gIHRleHRJbnB1dFRtcGw6IFBhZ2VFbGVtZW50XG4gIGRhdGVJbnB1dFRtcGw6IFBhZ2VFbGVtZW50XG4gIGNoZWNrYm94VG1wbDogUGFnZUVsZW1lbnRcbiAgcmVwZWF0YWJsZVRtcGw6IFBhZ2VFbGVtZW50XG4gIGZpbGVTZWxlY3RvcjogUGFnZUVsZW1lbnRcbiAgZmlsZUlucHV0OiBQYWdlRWxlbWVudFxuICBlcnJNc2c6IFBhZ2VFbGVtZW50XG4gIHNob3dPdGhlcjogUGFnZUVsZW1lbnRcbiAgc2hvd0ljb246IFBhZ2VFbGVtZW50XG4gIGhpZGVJY29uOiBQYWdlRWxlbWVudFxuICBzaG93SGlkZU1zZzogUGFnZUVsZW1lbnRcbiAgb3RoZXJTZXR0aW5nczogUGFnZUVsZW1lbnRcbiAgbG9hZGVkU2V0dGluZ3NNc2c6IFBhZ2VFbGVtZW50XG4gIGxvYWRlZFNldHRpbmdzOiBQYWdlRWxlbWVudFxuICBkZWZhdWx0U2V0dGluZ3NNc2c6IFBhZ2VFbGVtZW50XG4gIGRlZmF1bHRTZXR0aW5nczogUGFnZUVsZW1lbnRcbiAgYXNzZXRIYXNBY3RpdmVPcmRlcnM6IGJvb2xlYW5cbiAgYXNzZXRJRDogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzZWN0aW9uaXplOiBib29sZWFuKSB7XG4gICAgdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoZm9ybSlcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgLy8gQSBjb25maWdFbGVtZW50IGlzIGEgZGl2IGNvbnRhaW5pbmcgYW4gaW5wdXQgYW5kIGl0cyBsYWJlbC5cbiAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gW11cbiAgICAvLyBjb25maWdPcHRzIGlzIHRoZSB3YWxsZXQgb3B0aW9ucyBwcm92aWRlZCBieSBjb3JlLlxuICAgIHRoaXMuY29uZmlnT3B0cyA9IFtdXG4gICAgdGhpcy5zZWN0aW9uaXplID0gc2VjdGlvbml6ZVxuXG4gICAgLy8gR2V0IHRlbXBsYXRlIGVsZW1lbnRzXG4gICAgdGhpcy5hbGxTZXR0aW5ncyA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnYWxsU2V0dGluZ3MnKVxuICAgIHRoaXMuZHluYW1pY09wdHMgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2R5bmFtaWNPcHRzJylcbiAgICB0aGlzLnRleHRJbnB1dFRtcGwgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ3RleHRJbnB1dCcpXG4gICAgdGhpcy50ZXh0SW5wdXRUbXBsLnJlbW92ZSgpXG4gICAgdGhpcy5kYXRlSW5wdXRUbXBsID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdkYXRlSW5wdXQnKVxuICAgIHRoaXMuZGF0ZUlucHV0VG1wbC5yZW1vdmUoKVxuICAgIHRoaXMuY2hlY2tib3hUbXBsID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdjaGVja2JveCcpXG4gICAgdGhpcy5jaGVja2JveFRtcGwucmVtb3ZlKClcbiAgICB0aGlzLnJlcGVhdGFibGVUbXBsID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdyZXBlYXRhYmxlSW5wdXQnKVxuICAgIHRoaXMucmVwZWF0YWJsZVRtcGwucmVtb3ZlKClcbiAgICB0aGlzLmZpbGVTZWxlY3RvciA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnZmlsZVNlbGVjdG9yJylcbiAgICB0aGlzLmZpbGVJbnB1dCA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnZmlsZUlucHV0JylcbiAgICB0aGlzLmVyck1zZyA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnZXJyTXNnJylcbiAgICB0aGlzLnNob3dPdGhlciA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnc2hvd090aGVyJylcbiAgICB0aGlzLnNob3dJY29uID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdzaG93SWNvbicpXG4gICAgdGhpcy5oaWRlSWNvbiA9IERvYy50bXBsRWxlbWVudChmb3JtLCAnaGlkZUljb24nKVxuICAgIHRoaXMuc2hvd0hpZGVNc2cgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ3Nob3dIaWRlTXNnJylcbiAgICB0aGlzLm90aGVyU2V0dGluZ3MgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ290aGVyU2V0dGluZ3MnKVxuICAgIHRoaXMubG9hZGVkU2V0dGluZ3NNc2cgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2xvYWRlZFNldHRpbmdzTXNnJylcbiAgICB0aGlzLmxvYWRlZFNldHRpbmdzID0gRG9jLnRtcGxFbGVtZW50KGZvcm0sICdsb2FkZWRTZXR0aW5ncycpXG4gICAgdGhpcy5kZWZhdWx0U2V0dGluZ3NNc2cgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2RlZmF1bHRTZXR0aW5nc01zZycpXG4gICAgdGhpcy5kZWZhdWx0U2V0dGluZ3MgPSBEb2MudG1wbEVsZW1lbnQoZm9ybSwgJ2RlZmF1bHRTZXR0aW5ncycpXG5cbiAgICBpZiAoIXNlY3Rpb25pemUpIERvYy5oaWRlKHRoaXMuc2hvd090aGVyKVxuXG4gICAgRG9jLmJpbmQodGhpcy5maWxlU2VsZWN0b3IsICdjbGljaycsICgpID0+IHRoaXMuZmlsZUlucHV0LmNsaWNrKCkpXG5cbiAgICAvLyBjb25maWcgZmlsZSB1cGxvYWRcbiAgICBEb2MuYmluZCh0aGlzLmZpbGVJbnB1dCwgJ2NoYW5nZScsIGFzeW5jICgpID0+IHRoaXMuZmlsZUlucHV0Q2hhbmdlZCgpKVxuXG4gICAgRG9jLmJpbmQodGhpcy5zaG93T3RoZXIsICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc2V0T3RoZXJTZXR0aW5nc1Zpeih0aGlzLmhpZGVJY29uLmNsYXNzTGlzdC5jb250YWlucygnZC1oaWRlJykpXG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICAqIGZpbGVJbnB1dENoYW5nZWQgd2lsbCByZWFkIHRoZSBzZWxlY3RlZCBmaWxlIGFuZCBhdHRlbXB0IHRvIGxvYWQgdGhlXG4gICAqIGNvbmZpZ3VyYXRpb24gc2V0dGluZ3MuIEFsbCBsb2FkZWQgc2V0dGluZ3Mgd2lsbCBiZSBtYWRlIHZpc2libGUgZm9yXG4gICAqIGluc3BlY3Rpb24gYnkgdGhlIHVzZXIuXG4gICAqL1xuICBhc3luYyBmaWxlSW5wdXRDaGFuZ2VkICgpIHtcbiAgICBEb2MuaGlkZSh0aGlzLmVyck1zZylcbiAgICBpZiAoIXRoaXMuZmlsZUlucHV0LnZhbHVlKSByZXR1cm5cbiAgICBjb25zdCBmaWxlcyA9IHRoaXMuZmlsZUlucHV0LmZpbGVzXG4gICAgaWYgKCFmaWxlcyB8fCBmaWxlcy5sZW5ndGggPT09IDApIHJldHVyblxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5mb3JtKVxuICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IGZpbGVzWzBdLnRleHQoKVxuICAgIGlmICghY29uZmlnKSByZXR1cm5cbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9wYXJzZWNvbmZpZycsIHtcbiAgICAgIGNvbmZpZ3RleHQ6IGNvbmZpZ1xuICAgIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgdGhpcy5lcnJNc2cudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyh0aGlzLmVyck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAoT2JqZWN0LmtleXMocmVzLm1hcCkubGVuZ3RoID09PSAwKSByZXR1cm5cbiAgICB0aGlzLmR5bmFtaWNPcHRzLmFwcGVuZCguLi50aGlzLnNldENvbmZpZyhyZXMubWFwKSlcbiAgICB0aGlzLnJlb3JkZXIodGhpcy5keW5hbWljT3B0cylcbiAgICBjb25zdCBbbG9hZGVkT3B0cywgZGVmYXVsdE9wdHNdID0gW3RoaXMubG9hZGVkU2V0dGluZ3MuY2hpbGRyZW4ubGVuZ3RoLCB0aGlzLmRlZmF1bHRTZXR0aW5ncy5jaGlsZHJlbi5sZW5ndGhdXG4gICAgaWYgKGxvYWRlZE9wdHMgPT09IDApIERvYy5oaWRlKHRoaXMubG9hZGVkU2V0dGluZ3MsIHRoaXMubG9hZGVkU2V0dGluZ3NNc2cpXG4gICAgaWYgKGRlZmF1bHRPcHRzID09PSAwKSBEb2MuaGlkZSh0aGlzLmRlZmF1bHRTZXR0aW5ncywgdGhpcy5kZWZhdWx0U2V0dGluZ3NNc2cpXG4gICAgaWYgKGxvYWRlZE9wdHMgKyBkZWZhdWx0T3B0cyA9PT0gMCkgRG9jLmhpZGUodGhpcy5zaG93T3RoZXIsIHRoaXMub3RoZXJTZXR0aW5ncylcbiAgfVxuXG4gIGFkZE9wdCAoYm94OiBIVE1MRWxlbWVudCwgb3B0OiBDb25maWdPcHRpb24sIGluc2VydEFmdGVyPzogUGFnZUVsZW1lbnQsIHNraXBSZXBlYXROPzogYm9vbGVhbik6IFBhZ2VFbGVtZW50IHtcbiAgICBsZXQgZWw6IEhUTUxFbGVtZW50XG4gICAgaWYgKG9wdC5pc2Jvb2xlYW4pIGVsID0gdGhpcy5jaGVja2JveFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgZWxzZSBpZiAob3B0LmlzZGF0ZSkgZWwgPSB0aGlzLmRhdGVJbnB1dFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgZWxzZSBpZiAob3B0LnJlcGVhdGFibGUpIHtcbiAgICAgIGVsID0gdGhpcy5yZXBlYXRhYmxlVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3JlcGVhdGFibGUnKVxuICAgICAgRG9jLmJpbmQoRG9jLnRtcGxFbGVtZW50KGVsLCAnYWRkJyksICdjbGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy5hZGRPcHQoYm94LCBvcHQsIGVsLCB0cnVlKVxuICAgICAgfSlcbiAgICAgIGlmICghc2tpcFJlcGVhdE4pIGZvciAobGV0IGkgPSAwOyBpIDwgKG9wdC5yZXBlYXROID8gb3B0LnJlcGVhdE4gLSAxIDogMCk7IGkrKykgdGhpcy5hZGRPcHQoYm94LCBvcHQsIGluc2VydEFmdGVyLCB0cnVlKVxuICAgIH0gZWxzZSBlbCA9IHRoaXMudGV4dElucHV0VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICBjb25zdCBoaWRkZW5GaWVsZHMgPSBhcHAoKS5leHRlbnNpb25XYWxsZXQodGhpcy5hc3NldElEKT8uaGlkZGVuRmllbGRzIHx8IFtdXG4gICAgaWYgKGhpZGRlbkZpZWxkcy5pbmRleE9mKG9wdC5rZXkpICE9PSAtMSkgRG9jLmhpZGUoZWwpXG4gICAgdGhpcy5jb25maWdFbGVtZW50cy5wdXNoKFtvcHQsIGVsXSlcbiAgICBjb25zdCBpbnB1dCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0JykgYXMgQ29uZmlnT3B0aW9uSW5wdXRcbiAgICBpbnB1dC5kYXRhc2V0LmNvbmZpZ0tleSA9IG9wdC5rZXlcbiAgICAvLyBXZSBuZWVkIHRvIGdlbmVyYXRlIGEgdW5pcXVlIElEIG9ubHkgZm9yIHRoZSA8aW5wdXQgaWQ+ID0+IDxsYWJlbCBmb3I+XG4gICAgLy8gbWF0Y2hpbmcuXG4gICAgZHluYW1pY0lucHV0Q291bnRlcisrXG4gICAgY29uc3QgZWxJRCA9ICd3Y2ZnLScgKyBTdHJpbmcoZHluYW1pY0lucHV0Q291bnRlcilcbiAgICBpbnB1dC5pZCA9IGVsSURcbiAgICBjb25zdCBsYWJlbCA9IERvYy5zYWZlU2VsZWN0b3IoZWwsICdsYWJlbCcpXG4gICAgbGFiZWwuaHRtbEZvciA9IGVsSUQgLy8gJ2ZvcicgYXR0cmlidXRlLCBidXQgJ2ZvcicgaXMgYSBrZXl3b3JkXG4gICAgbGFiZWwucHJlcGVuZChvcHQuZGlzcGxheW5hbWUpXG4gICAgaWYgKG9wdC5yZWdBc3NldCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBjb25zdCBsb2dvID0gbmV3IHdpbmRvdy5JbWFnZSgxNSwgMTUpXG4gICAgICBsb2dvLnNyYyA9IERvYy5sb2dvUGF0aEZyb21JRChvcHQucmVnQXNzZXQgfHwgLTEpXG4gICAgICBsYWJlbC5wcmVwZW5kKGxvZ28pXG4gICAgfVxuICAgIGlmIChpbnNlcnRBZnRlcikgaW5zZXJ0QWZ0ZXIuYWZ0ZXIoZWwpXG4gICAgZWxzZSBib3guYXBwZW5kQ2hpbGQoZWwpXG4gICAgaWYgKG9wdC5ub2VjaG8pIHtcbiAgICAgIGlucHV0LnR5cGUgPSAncGFzc3dvcmQnXG4gICAgICBpbnB1dC5hdXRvY29tcGxldGUgPSAnb2ZmJ1xuICAgIH1cbiAgICBpZiAob3B0LmRlc2NyaXB0aW9uKSBsYWJlbC5kYXRhc2V0LnRvb2x0aXAgPSBvcHQuZGVzY3JpcHRpb25cbiAgICBpZiAob3B0LmlzYm9vbGVhbikgaW5wdXQuY2hlY2tlZCA9IG9wdC5kZWZhdWx0XG4gICAgZWxzZSBpZiAob3B0LmlzZGF0ZSkge1xuICAgICAgY29uc3QgZ2V0TWluTWF4VmFsID0gKG1pbk1heDogc3RyaW5nIHwgbnVtYmVyKSA9PiB7XG4gICAgICAgIGlmICghbWluTWF4KSByZXR1cm4gJydcbiAgICAgICAgaWYgKG1pbk1heCA9PT0gJ25vdycpIHJldHVybiBkYXRlVG9TdHJpbmcobmV3IERhdGUoKSlcbiAgICAgICAgcmV0dXJuIGRhdGVUb1N0cmluZyhuZXcgRGF0ZSgobWluTWF4IGFzIG51bWJlcikgKiAxMDAwKSlcbiAgICAgIH1cbiAgICAgIGlucHV0Lm1heCA9IGdldE1pbk1heFZhbChvcHQubWF4KVxuICAgICAgaW5wdXQubWluID0gZ2V0TWluTWF4VmFsKG9wdC5taW4pXG4gICAgICBjb25zdCBkYXRlID0gb3B0LmRlZmF1bHQgPyBuZXcgRGF0ZShvcHQuZGVmYXVsdCAqIDEwMDApIDogbmV3IERhdGUoKVxuICAgICAgLy8gVUkgc2hvd3MgRGF0ZXMgaW4gdmFsdWVBc0RhdGUgYXMgVVRDLCBidXQgdXNlciBpbnRlcnByZXRzIGxvY2FsLiBTZXQgYVxuICAgICAgLy8gbG9jYWwgZGF0ZSBzdHJpbmcgc28gdGhlIFVJIGRpc3BsYXlzIHdoYXQgdGhlIHVzZXIgZXhwZWN0cy4gYWx0OlxuICAgICAgLy8gaW5wdXQudmFsdWVBc0RhdGUgPSBkYXRlQXBwbHlPZmZzZXQoZGF0ZSlcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0ZVRvU3RyaW5nKGRhdGUpXG4gICAgfSBlbHNlIGlucHV0LnZhbHVlID0gb3B0LmRlZmF1bHQgIT09IG51bGwgPyBvcHQuZGVmYXVsdCA6ICcnXG4gICAgaW5wdXQuZGlzYWJsZWQgPSBCb29sZWFuKG9wdC5kaXNhYmxld2hlbmFjdGl2ZSAmJiB0aGlzLmFzc2V0SGFzQWN0aXZlT3JkZXJzKVxuICAgIHJldHVybiBlbFxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlIGNyZWF0ZXMgdGhlIGR5bmFtaWMgZm9ybS5cbiAgICovXG4gIHVwZGF0ZSAoYXNzZXRJRDogbnVtYmVyLCBjb25maWdPcHRzOiBDb25maWdPcHRpb25bXSB8IG51bGwsIGFjdGl2ZU9yZGVyczogYm9vbGVhbikge1xuICAgIHRoaXMuYXNzZXRIYXNBY3RpdmVPcmRlcnMgPSBhY3RpdmVPcmRlcnNcbiAgICB0aGlzLmNvbmZpZ0VsZW1lbnRzID0gW11cbiAgICB0aGlzLmNvbmZpZ09wdHMgPSBjb25maWdPcHRzIHx8IFtdXG4gICAgdGhpcy5hc3NldElEID0gYXNzZXRJRFxuICAgIERvYy5lbXB0eSh0aGlzLmR5bmFtaWNPcHRzLCB0aGlzLmRlZmF1bHRTZXR0aW5ncywgdGhpcy5sb2FkZWRTZXR0aW5ncylcblxuICAgIC8vIElmIHRoZXJlIGFyZSBubyBvcHRpb25zLCBqdXN0IGhpZGUgdGhlIGVudGlyZSBmb3JtLlxuICAgIGlmICh0aGlzLmNvbmZpZ09wdHMubGVuZ3RoID09PSAwKSByZXR1cm4gRG9jLmhpZGUodGhpcy5mb3JtKVxuICAgIERvYy5zaG93KHRoaXMuZm9ybSlcblxuICAgIHRoaXMuc2V0T3RoZXJTZXR0aW5nc1ZpeihmYWxzZSlcbiAgICBEb2MuaGlkZShcbiAgICAgIHRoaXMubG9hZGVkU2V0dGluZ3NNc2csIHRoaXMubG9hZGVkU2V0dGluZ3MsIHRoaXMuZGVmYXVsdFNldHRpbmdzTXNnLFxuICAgICAgdGhpcy5kZWZhdWx0U2V0dGluZ3MsIHRoaXMuZXJyTXNnXG4gICAgKVxuICAgIGNvbnN0IGRlZmF1bHRlZE9wdHMgPSBbXVxuICAgIGZvciAoY29uc3Qgb3B0IG9mIHRoaXMuY29uZmlnT3B0cykge1xuICAgICAgaWYgKHRoaXMuc2VjdGlvbml6ZSAmJiBvcHQuZGVmYXVsdCAhPT0gbnVsbCkgZGVmYXVsdGVkT3B0cy5wdXNoKG9wdClcbiAgICAgIGVsc2UgdGhpcy5hZGRPcHQodGhpcy5keW5hbWljT3B0cywgb3B0KVxuICAgIH1cbiAgICBpZiAoZGVmYXVsdGVkT3B0cy5sZW5ndGgpIHtcbiAgICAgIGZvciAoY29uc3Qgb3B0IG9mIGRlZmF1bHRlZE9wdHMpIHRoaXMuYWRkT3B0KHRoaXMuZGVmYXVsdFNldHRpbmdzLCBvcHQpXG4gICAgICBEb2Muc2hvdyh0aGlzLnNob3dPdGhlciwgdGhpcy5kZWZhdWx0U2V0dGluZ3NNc2csIHRoaXMuZGVmYXVsdFNldHRpbmdzKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2MuaGlkZSh0aGlzLnNob3dPdGhlcilcbiAgICB9XG4gICAgYXBwKCkuYmluZFRvb2x0aXBzKHRoaXMuYWxsU2V0dGluZ3MpXG4gICAgaWYgKHRoaXMuZHluYW1pY09wdHMuY2hpbGRyZW4ubGVuZ3RoKSBEb2Muc2hvdyh0aGlzLmR5bmFtaWNPcHRzKVxuICAgIGVsc2UgRG9jLmhpZGUodGhpcy5keW5hbWljT3B0cylcbiAgfVxuXG4gIC8qXG4gICAqIHNldE90aGVyU2V0dGluZ3NWaXogc2V0cyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgYWRkaXRpb25hbCBzZXR0aW5ncyBzZWN0aW9uLlxuICAgKi9cbiAgc2V0T3RoZXJTZXR0aW5nc1ZpeiAodmlzaWJsZTogYm9vbGVhbikge1xuICAgIGlmICh2aXNpYmxlKSB7XG4gICAgICBEb2MuaGlkZSh0aGlzLnNob3dJY29uKVxuICAgICAgRG9jLnNob3codGhpcy5oaWRlSWNvbiwgdGhpcy5vdGhlclNldHRpbmdzKVxuICAgICAgdGhpcy5zaG93SGlkZU1zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0hJREVfQURESVRJT05BTF9TRVRUSU5HUylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2MuaGlkZSh0aGlzLmhpZGVJY29uLCB0aGlzLm90aGVyU2V0dGluZ3MpXG4gICAgRG9jLnNob3codGhpcy5zaG93SWNvbilcbiAgICB0aGlzLnNob3dIaWRlTXNnLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfU0hPV19BRERJVElPTkFMX1NFVFRJTkdTKVxuICB9XG5cbiAgLypcbiAgICogc2V0Q29uZmlnIGxvb2tzIGZvciBpbnB1dHMgd2l0aCBjb25maWdPcHQga2V5cyBtYXRjaGluZyB0aGUgY2ZnIG9iamVjdCwgYW5kXG4gICAqIHNldHMgdGhlIGlucHV0cyB2YWx1ZSB0byB0aGUgY29ycmVzcG9uZGluZyBjZmcgdmFsdWUuIEEgbGlzdCBvZiBtYXRjaGluZ1xuICAgKiBjb25maWdFbGVtZW50cyBpcyByZXR1cm5lZC5cbiAgICovXG4gIHNldENvbmZpZyAoY2ZnOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KTogSFRNTEVsZW1lbnRbXSB7XG4gICAgY29uc3QgZmluZHM6IEhUTUxFbGVtZW50W10gPSBbXVxuICAgIGNvbnN0IGhhbmRsZWRSZXBlYXRhYmxlczogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4gPSB7fVxuICAgIGNvbnN0IHJlbW92ZXM6IFtDb25maWdPcHRpb24sIFBhZ2VFbGVtZW50XVtdID0gW11cbiAgICBmb3IgKGNvbnN0IHIgb2YgWy4uLnRoaXMuY29uZmlnRWxlbWVudHNdKSB7XG4gICAgICBjb25zdCBbb3B0LCBlbF0gPSByXG4gICAgICBjb25zdCB2ID0gY2ZnW29wdC5rZXldXG4gICAgICBpZiAodiA9PT0gdW5kZWZpbmVkKSBjb250aW51ZVxuICAgICAgaWYgKG9wdC5yZXBlYXRhYmxlKSB7XG4gICAgICAgIGlmIChoYW5kbGVkUmVwZWF0YWJsZXNbb3B0LmtleV0pIHtcbiAgICAgICAgICBlbC5yZW1vdmUoKVxuICAgICAgICAgIHJlbW92ZXMucHVzaChyKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cbiAgICAgICAgaGFuZGxlZFJlcGVhdGFibGVzW29wdC5rZXldID0gdHJ1ZVxuICAgICAgICBjb25zdCB2YWxzID0gdi5zcGxpdChvcHQucmVwZWF0YWJsZSlcbiAgICAgICAgY29uc3QgZmlyc3RWYWwgPSB2YWxzWzBdXG4gICAgICAgIGZpbmRzLnB1c2goZWwpXG4gICAgICAgIERvYy5zYWZlU2VsZWN0b3IoZWwsICdpbnB1dCcpLnZhbHVlID0gZmlyc3RWYWxcbiAgICAgICAgLy8gQWRkIHJlcGVhdE4gLSAxIGVtcHR5IGVsZW1lbnRzIHRvIHRoZSByZWNvbmZpZyBmb3JtLiBBZGQgdGhlbSBiZWZvcmVcbiAgICAgICAgLy8gdGhlIHBvcHVsYXRlZCBpbnB1dHMganVzdCBiZWNhdXNlIG9mIHRoZSB3YXkgd2UncmUgdXNpbmcgdGhlXG4gICAgICAgIC8vIGluc2VydEFmdGVyIGFyZ3VtZW50IHRvIGFkZE9wdC5cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCAob3B0LnJlcGVhdE4gfHwgMSk7IGkrKykgZmluZHMucHVzaCh0aGlzLmFkZE9wdChlbC5wYXJlbnRFbGVtZW50IGFzIFBhZ2VFbGVtZW50LCBvcHQsIGVsLCB0cnVlKSlcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB2YWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgbmV3RWwgPSB0aGlzLmFkZE9wdChlbC5wYXJlbnRFbGVtZW50IGFzIFBhZ2VFbGVtZW50LCBvcHQsIGVsLCB0cnVlKVxuICAgICAgICAgIERvYy5zYWZlU2VsZWN0b3IobmV3RWwsICdpbnB1dCcpLnZhbHVlID0gdmFsc1tpXVxuICAgICAgICAgIGZpbmRzLnB1c2gobmV3RWwpXG4gICAgICAgIH1cbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIGZpbmRzLnB1c2goZWwpXG4gICAgICBjb25zdCBpbnB1dCA9IERvYy5zYWZlU2VsZWN0b3IoZWwsICdpbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICAgIGlmIChvcHQuaXNib29sZWFuKSBpbnB1dC5jaGVja2VkID0gaXNUcnV0aHlTdHJpbmcodilcbiAgICAgIGVsc2UgaWYgKG9wdC5pc2RhdGUpIHtcbiAgICAgICAgaW5wdXQudmFsdWUgPSBkYXRlVG9TdHJpbmcobmV3IERhdGUocGFyc2VJbnQodikgKiAxMDAwKSlcbiAgICAgICAgLy8gYWx0OiBpbnB1dC52YWx1ZUFzRGF0ZSA9IGRhdGVBcHBseU9mZnNldCguLi4pXG4gICAgICB9IGVsc2UgaW5wdXQudmFsdWUgPSB2XG4gICAgfVxuICAgIGZvciAoY29uc3QgciBvZiByZW1vdmVzKSB7XG4gICAgICBjb25zdCBpID0gdGhpcy5jb25maWdFbGVtZW50cy5pbmRleE9mKHIpXG4gICAgICBpZiAoaSA+PSAwKSB0aGlzLmNvbmZpZ0VsZW1lbnRzLnNwbGljZShpLCAxKVxuICAgIH1cblxuICAgIHJldHVybiBmaW5kc1xuICB9XG5cbiAgLypcbiAgICogc2V0TG9hZGVkQ29uZmlnIHNldHMgdGhlIGlucHV0IHZhbHVlcyBmb3IgdGhlIGVudHJpZXMgaW4gY2ZnLCBhbmQgbW92ZXNcbiAgICogdGhlbSB0byB0aGUgbG9hZGVkU2V0dGluZ3MgYm94LlxuICAgKi9cbiAgc2V0TG9hZGVkQ29uZmlnIChjZmc6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4pIHtcbiAgICBjb25zdCBmaW5kcyA9IHRoaXMuc2V0Q29uZmlnKGNmZylcbiAgICBpZiAoIXRoaXMuc2VjdGlvbml6ZSB8fCBmaW5kcy5sZW5ndGggPT09IDApIHJldHVyblxuICAgIHRoaXMubG9hZGVkU2V0dGluZ3MuYXBwZW5kKC4uLmZpbmRzKVxuICAgIHRoaXMucmVvcmRlcih0aGlzLmxvYWRlZFNldHRpbmdzKVxuICAgIERvYy5zaG93KHRoaXMubG9hZGVkU2V0dGluZ3MsIHRoaXMubG9hZGVkU2V0dGluZ3NNc2cpXG4gICAgaWYgKHRoaXMuZGVmYXVsdFNldHRpbmdzLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgRG9jLmhpZGUodGhpcy5kZWZhdWx0U2V0dGluZ3MsIHRoaXMuZGVmYXVsdFNldHRpbmdzTXNnKVxuICB9XG5cbiAgLypcbiAgICogbWFwIHJlYWRzIGFsbCBpbnB1dHMgYW5kIGNvbnN0cnVjdHMgYW4gb2JqZWN0IGZyb20gdGhlIGNvbmZpZ09wdCBrZXlzIGFuZFxuICAgKiB2YWx1ZXMuXG4gICAqL1xuICBtYXAgKGFzc2V0SUQ6IG51bWJlcik6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIGNvbnN0IGNvbmZpZzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgZm9yIChjb25zdCBbb3B0LCBlbF0gb2YgdGhpcy5jb25maWdFbGVtZW50cykge1xuICAgICAgY29uc3QgaW5wdXQgPSBEb2Muc2FmZVNlbGVjdG9yKGVsLCAnaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgICBpZiAob3B0LnJlZ0Fzc2V0ICE9PSB1bmRlZmluZWQgJiYgb3B0LnJlZ0Fzc2V0ICE9PSBhc3NldElEKSBjb250aW51ZVxuICAgICAgaWYgKG9wdC5pc2Jvb2xlYW4gJiYgb3B0LmtleSkge1xuICAgICAgICBjb25maWdbb3B0LmtleV0gPSBpbnB1dC5jaGVja2VkID8gJzEnIDogJzAnXG4gICAgICB9IGVsc2UgaWYgKG9wdC5pc2RhdGUgJiYgb3B0LmtleSkge1xuICAgICAgICAvLyBGb3JjZSBsb2NhbCB0aW1lIGludGVycHJldGF0aW9uIGJ5IGFwcGVuZGluZyBhIHRpbWUgdG8gdGhlIGRhdGVcbiAgICAgICAgLy8gc3RyaW5nLCBvdGhlcndpc2UgdGhlIERhdGUgY29uc3RydWN0b3IgY29uc2lkZXJzIGl0IFVUQy5cbiAgICAgICAgY29uc3QgbWluRGF0ZSA9IGlucHV0Lm1pbiA/IHRvVW5peERhdGUobmV3IERhdGUoaW5wdXQubWluICsgJ1QwMDowMCcpKSA6IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSXG4gICAgICAgIGNvbnN0IG1heERhdGUgPSBpbnB1dC5tYXggPyB0b1VuaXhEYXRlKG5ldyBEYXRlKGlucHV0Lm1heCArICdUMDA6MDAnKSkgOiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUlxuICAgICAgICBsZXQgZGF0ZSA9IGlucHV0LnZhbHVlID8gdG9Vbml4RGF0ZShuZXcgRGF0ZShpbnB1dC52YWx1ZSArICdUMDA6MDAnKSkgOiAwXG4gICAgICAgIGlmIChkYXRlIDwgbWluRGF0ZSkgZGF0ZSA9IG1pbkRhdGVcbiAgICAgICAgZWxzZSBpZiAoZGF0ZSA+IG1heERhdGUpIGRhdGUgPSBtYXhEYXRlXG4gICAgICAgIGNvbmZpZ1tvcHQua2V5XSA9IFN0cmluZyhkYXRlKVxuICAgICAgfSBlbHNlIGlmIChpbnB1dC52YWx1ZSkge1xuICAgICAgICBpZiAob3B0LnJlcGVhdGFibGUgJiYgY29uZmlnW29wdC5rZXldKSBjb25maWdbb3B0LmtleV0gKz0gb3B0LnJlcGVhdGFibGUgKyBpbnB1dC52YWx1ZVxuICAgICAgICBlbHNlIGNvbmZpZ1tvcHQua2V5XSA9IGlucHV0LnZhbHVlXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb25maWdcbiAgfVxuXG4gIC8qXG4gICAqIHJlb3JkZXIgc29ydHMgdGhlIGNvbmZpZ0VsZW1lbnRzIGluIHRoZSBib3ggYnkgdGhlIG9yZGVyIG9mIHRoZVxuICAgKiBzZXJ2ZXItcHJvdmlkZWQgY29uZmlnT3B0cyBhcnJheS5cbiAgICovXG4gIHJlb3JkZXIgKGJveDogSFRNTEVsZW1lbnQpIHtcbiAgICBjb25zdCBpbnB1dHM6IFJlY29yZDxzdHJpbmcsIEhUTUxFbGVtZW50W10+ID0ge31cbiAgICBib3gucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKChpbnB1dDogQ29uZmlnT3B0aW9uSW5wdXQpID0+IHtcbiAgICAgIGNvbnN0IGsgPSBpbnB1dC5kYXRhc2V0LmNvbmZpZ0tleVxuICAgICAgaWYgKCFrKSByZXR1cm4gLy8gVFMyNTM4XG4gICAgICBjb25zdCBlbHMgPSBbXVxuICAgICAgZm9yIChjb25zdCBbb3B0LCBlbF0gb2YgdGhpcy5jb25maWdFbGVtZW50cykgaWYgKG9wdC5rZXkgPT09IGspIGVscy5wdXNoKGVsKVxuICAgICAgaW5wdXRzW2tdID0gZWxzXG4gICAgfSlcbiAgICBmb3IgKGNvbnN0IG9wdCBvZiB0aGlzLmNvbmZpZ09wdHMpIHtcbiAgICAgIGNvbnN0IGVscyA9IGlucHV0c1tvcHQua2V5XSB8fCBbXVxuICAgICAgZm9yIChjb25zdCBlbCBvZiBlbHMpIGJveC5hcHBlbmQoZWwpXG4gICAgfVxuICB9XG59XG5cbi8qXG4gKiBDb25maXJtUmVnaXN0cmF0aW9uRm9ybSBzaG91bGQgYmUgdXNlZCB3aXRoIHRoZSBcImNvbmZpcm1SZWdpc3RyYXRpb25Gb3JtXCJcbiAqIHRlbXBsYXRlLlxuICovXG5leHBvcnQgY2xhc3MgQ29uZmlybVJlZ2lzdHJhdGlvbkZvcm0ge1xuICBmb3JtOiBIVE1MRWxlbWVudFxuICBzdWNjZXNzOiAoKSA9PiB2b2lkXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICB4YzogRXhjaGFuZ2VcbiAgY2VydEZpbGU6IHN0cmluZ1xuICBib25kQXNzZXRJRDogbnVtYmVyXG4gIHRpZXI6IG51bWJlclxuICBmZWVzOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogSFRNTEVsZW1lbnQsIHN1Y2Nlc3M6ICgpID0+IHZvaWQsIGdvQmFjazogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUoZm9ybSlcbiAgICB0aGlzLmNlcnRGaWxlID0gJydcblxuICAgIERvYy5iaW5kKHRoaXMucGFnZS5nb0JhY2ssICdjbGljaycsICgpID0+IGdvQmFjaygpKVxuICAgIGJpbmQoZm9ybSwgdGhpcy5wYWdlLnN1Ym1pdCwgKCkgPT4gdGhpcy5zdWJtaXRGb3JtKCkpXG4gIH1cblxuICBzZXRFeGNoYW5nZSAoeGM6IEV4Y2hhbmdlLCBjZXJ0RmlsZTogc3RyaW5nKSB7XG4gICAgdGhpcy54YyA9IHhjXG4gICAgdGhpcy5jZXJ0RmlsZSA9IGNlcnRGaWxlXG4gICAgdGhpcy5wYWdlLmhvc3QudGV4dENvbnRlbnQgPSB4Yy5ob3N0XG4gIH1cblxuICBzZXRBc3NldCAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIsIGZlZXM6IG51bWJlcikge1xuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgeyBjb252ZXJzaW9uRmFjdG9yLCB1bml0IH0gPSBhc3NldC51bml0SW5mby5jb252ZW50aW9uYWxcbiAgICB0aGlzLmJvbmRBc3NldElEID0gYXNzZXQuaWRcbiAgICB0aGlzLnRpZXIgPSB0aWVyXG4gICAgdGhpcy5mZWVzID0gZmVlc1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBib25kQXNzZXQgPSB0aGlzLnhjLmJvbmRBc3NldHNbYXNzZXQuc3ltYm9sXVxuICAgIGNvbnN0IGJvbmRMb2NrID0gYm9uZEFzc2V0LmFtb3VudCAqIHRpZXIgKiBib25kUmVzZXJ2ZU11bHRpcGxpZXJcbiAgICBjb25zdCBib25kTG9ja0NvbnZlbnRpb25hbCA9IGJvbmRMb2NrIC8gY29udmVyc2lvbkZhY3RvclxuICAgIHBhZ2UudHJhZGluZ1RpZXIudGV4dENvbnRlbnQgPSBTdHJpbmcodGllcilcbiAgICBwYWdlLmxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGFzc2V0LnN5bWJvbClcbiAgICBwYWdlLmJvbmRMb2NrLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGJvbmRMb2NrQ29udmVudGlvbmFsKVxuICAgIHBhZ2UuYm9uZFVuaXQudGV4dENvbnRlbnQgPSB1bml0XG4gICAgY29uc3QgciA9IGFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXVxuICAgIERvYy5zaG93KHBhZ2UuYm9uZExvY2tVU0RCb3gpXG4gICAgaWYgKHIpIHBhZ2UuYm9uZExvY2tVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYm9uZExvY2tDb252ZW50aW9uYWwgKiByKVxuICAgIGVsc2UgRG9jLmhpZGUocGFnZS5ib25kTG9ja1VTREJveClcbiAgICBpZiAoZmVlcykgcGFnZS5mZWVSZXNlcnZlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVzIC8gY29udmVyc2lvbkZhY3RvcilcbiAgICBwYWdlLnJlc2VydmVzVW5pdC50ZXh0Q29udGVudCA9IHVuaXRcbiAgfVxuXG4gIHNldEZlZXMgKGFzc2V0SUQ6IG51bWJlciwgZmVlczogbnVtYmVyKSB7XG4gICAgdGhpcy5mZWVzID0gZmVlc1xuICAgIGNvbnN0IGNvbnZlcnNpb25GYWN0b3IgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF0udW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICB0aGlzLnBhZ2UuZmVlUmVzZXJ2ZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZmVlcyAvIGNvbnZlcnNpb25GYWN0b3IpXG4gIH1cblxuICAvKiBGb3JtIGV4cGFuZHMgaW50byBpdHMgc3BhY2UgcXVpY2tseSBmcm9tIHRoZSBsb3dlci1yaWdodCBhcyBpdCBmYWRlcyBpbi4gKi9cbiAgYXN5bmMgYW5pbWF0ZSAoKSB7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuZm9ybVxuICAgIERvYy5hbmltYXRlKDQwMCwgcHJvZyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgke3Byb2d9KWBcbiAgICAgIGZvcm0uc3R5bGUub3BhY2l0eSA9IFN0cmluZyhNYXRoLnBvdyhwcm9nLCA0KSlcbiAgICAgIGNvbnN0IG9mZnNldCA9IGAkeygxIC0gcHJvZykgKiA1MDB9cHhgXG4gICAgICBmb3JtLnN0eWxlLnRvcCA9IG9mZnNldFxuICAgICAgZm9ybS5zdHlsZS5sZWZ0ID0gb2Zmc2V0XG4gICAgfSlcbiAgfVxuXG4gIC8qXG4gICAqIHN1Ym1pdEZvcm0gaXMgY2FsbGVkIHdoZW4gdGhlIGZvcm0gaXMgc3VibWl0dGVkLlxuICAgKi9cbiAgYXN5bmMgc3VibWl0Rm9ybSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBib25kQXNzZXRJRCwgeGMsIGNlcnRGaWxlLCB0aWVyIH0gPSB0aGlzXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYm9uZEFzc2V0SURdXG4gICAgaWYgKCFhc3NldCkge1xuICAgICAgcGFnZS5yZWdFcnIuaW5uZXJUZXh0ID0gaW50bC5wcmVwKGludGwuSURfU0VMRUNUX1dBTExFVF9GT1JfRkVFX1BBWU1FTlQpXG4gICAgICBEb2Muc2hvdyhwYWdlLnJlZ0VycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBEb2MuaGlkZShwYWdlLnJlZ0VycilcbiAgICBjb25zdCBib25kQXNzZXQgPSB4Yy5ib25kQXNzZXRzW2Fzc2V0LndhbGxldC5zeW1ib2xdXG4gICAgY29uc3QgZGV4QWRkciA9IHhjLmhvc3RcbiAgICBsZXQgZm9ybTogYW55XG4gICAgbGV0IHVybDogc3RyaW5nXG4gICAgaWYgKCFhcHAoKS5leGNoYW5nZXNbeGMuaG9zdF0gfHwgYXBwKCkuZXhjaGFuZ2VzW3hjLmhvc3RdLnZpZXdPbmx5KSB7XG4gICAgICBmb3JtID0ge1xuICAgICAgICBhZGRyOiBkZXhBZGRyLFxuICAgICAgICBjZXJ0OiBjZXJ0RmlsZSxcbiAgICAgICAgYm9uZDogYm9uZEFzc2V0LmFtb3VudCAqIHRpZXIsXG4gICAgICAgIGFzc2V0OiBib25kQXNzZXQuaWRcbiAgICAgIH1cbiAgICAgIHVybCA9ICcvYXBpL3Bvc3Rib25kJ1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3JtID0ge1xuICAgICAgICBob3N0OiBkZXhBZGRyLFxuICAgICAgICB0YXJnZXRUaWVyOiB0aWVyLFxuICAgICAgICBib25kQXNzZXRJRDogYm9uZEFzc2V0SURcbiAgICAgIH1cbiAgICAgIHVybCA9ICcvYXBpL3VwZGF0ZWJvbmRvcHRpb25zJ1xuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTih1cmwsIGZvcm0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5yZWdFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLnJlZ0VycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnN1Y2Nlc3MoKVxuICB9XG59XG5cbmludGVyZmFjZSBSZWdBc3NldFJvdyB7XG4gIHJlYWR5OiBQYWdlRWxlbWVudFxufVxuXG5pbnRlcmZhY2UgTWFya2V0TGltaXRzUm93IHtcbiAgbWt0OiBNYXJrZXRcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIHNldFRpZXI6ICgodGllcjogbnVtYmVyKSA9PiB2b2lkKVxufVxuXG4vKlxuICogRmVlQXNzZXRTZWxlY3Rpb25Gb3JtIHNob3VsZCBiZSB1c2VkIHdpdGggdGhlIFwicmVnQXNzZXRGb3JtXCIgdGVtcGxhdGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBGZWVBc3NldFNlbGVjdGlvbkZvcm0ge1xuICBmb3JtOiBIVE1MRWxlbWVudFxuICBzdWNjZXNzOiAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIpID0+IFByb21pc2U8dm9pZD5cbiAgeGM6IEV4Y2hhbmdlXG4gIHNlbGVjdGVkQXNzZXRJRDogbnVtYmVyXG4gIGNlcnRGaWxlOiBzdHJpbmdcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGFzc2V0Um93czogUmVjb3JkPHN0cmluZywgUmVnQXNzZXRSb3c+XG4gIG1hcmtldFJvd3M6IE1hcmtldExpbWl0c1Jvd1tdXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzdWNjZXNzOiAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIpID0+IFByb21pc2U8dm9pZD4pIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5jZXJ0RmlsZSA9ICcnXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShmb3JtKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhwYWdlLmN1cnJlbnRCb25kVG1wbCwgcGFnZS5ib25kQXNzZXRUbXBsLCBwYWdlLm1hcmtldFRtcGwpXG5cbiAgICBEb2MuYmluZChwYWdlLnRyYWRpbmdUaWVySW5wdXQsICdpbnB1dCcsICgpID0+IHsgdGhpcy5zZXRUaWVyKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnRyYWRpbmdUaWVySW5wdXQsICdrZXl1cCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7IGlmIChlLmtleSA9PT0gJ0VudGVyJykgdGhpcy5hY2NlcHRUaWVyKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnN1Ym1pdFRyYWRpbmdUaWVyLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuYWNjZXB0VGllcigpIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLnRpZXJVcCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmluY3JlbWVudFRpZXIodHJ1ZSkgfSlcbiAgICBEb2MuYmluZChwYWdlLnRpZXJEb3duLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuaW5jcmVtZW50VGllcihmYWxzZSkgfSlcblxuICAgIERvYy5iaW5kKHBhZ2UuZ29CYWNrVG9Bc3NldHMsICdjbGljaycsICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2UudHJhZGluZ1RpZXJGb3JtKVxuICAgICAgRG9jLnNob3cocGFnZS5hc3NldEZvcm0pXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHBhZ2Uud2hhdHNBQm9uZCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5hc3NldEZvcm0pXG4gICAgICBEb2Muc2hvdyhwYWdlLndoYXRzQUJvbmRQYW5lbClcbiAgICB9KVxuXG4gICAgY29uc3QgaGlkZVdoYXRzQUJvbmQgPSAoKSA9PiB7XG4gICAgICBEb2Muc2hvdyhwYWdlLmFzc2V0Rm9ybSlcbiAgICAgIERvYy5oaWRlKHBhZ2Uud2hhdHNBQm9uZFBhbmVsKVxuICAgIH1cblxuICAgIERvYy5iaW5kKHBhZ2UuYm9uZEdvdEl0LCAnY2xpY2snLCAoKSA9PiB7IGhpZGVXaGF0c0FCb25kKCkgfSlcblxuICAgIERvYy5iaW5kKHBhZ2Uud2hhdHNBQm9uZEJhY2ssICdjbGljaycsICgpID0+IHsgaGlkZVdoYXRzQUJvbmQoKSB9KVxuXG4gICAgRG9jLmJpbmQocGFnZS51c2VQcmVwYWlkQm9uZCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dQcmVwYWlkQm9uZEZvcm0oKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UucHBiR29CYWNrLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuaGlkZVByZXBhaWRCb25kRm9ybSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zdWJtaXRQcmVwYWlkQm9uZCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnN1Ym1pdFByZXBhaWRCb25kKCkgfSlcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBjcmVhdGV3YWxsZXQ6IChub3RlOiBXYWxsZXRDcmVhdGlvbk5vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUudG9waWMgPT09ICdRdWV1ZWRDcmVhdGlvblN1Y2Nlc3MnKSB0aGlzLndhbGxldENyZWF0ZWQobm90ZS5hc3NldElEKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBzZXRUaWVyRXJyb3IgKGVyck1zZzogc3RyaW5nKSB7XG4gICAgdGhpcy5wYWdlLnRyYWRpbmdUaWVyRXJyLnRleHRDb250ZW50ID0gZXJyTXNnXG4gICAgRG9jLnNob3codGhpcy5wYWdlLnRyYWRpbmdUaWVyRXJyKVxuICB9XG5cbiAgc2V0QXNzZXRFcnJvciAoZXJyTXNnOiBzdHJpbmcpIHtcbiAgICB0aGlzLnBhZ2UucmVnQXNzZXRFcnIudGV4dENvbnRlbnQgPSBlcnJNc2dcbiAgICBEb2Muc2hvdyh0aGlzLnBhZ2UucmVnQXNzZXRFcnIpXG4gIH1cblxuICBjbGVhckVycm9ycyAoKSB7XG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLnJlZ0Fzc2V0RXJyLCB0aGlzLnBhZ2UudHJhZGluZ1RpZXJFcnIpXG4gIH1cblxuICBzZXRFeGNoYW5nZSAoeGM6IEV4Y2hhbmdlLCBjZXJ0RmlsZTogc3RyaW5nKSB7XG4gICAgdGhpcy54YyA9IHhjXG4gICAgdGhpcy5jZXJ0RmlsZSA9IGNlcnRGaWxlXG4gICAgdGhpcy5hc3NldFJvd3MgPSB7fVxuICAgIHRoaXMubWFya2V0Um93cyA9IFtdXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuYXNzZXRGb3JtLCBwYWdlLnRyYWRpbmdUaWVyRm9ybSwgcGFnZS53aGF0c0FCb25kUGFuZWwsIHBhZ2UucHJlcGFpZEJvbmRzKVxuICAgIERvYy5lbXB0eShwYWdlLmJvbmRBc3NldHMsIHBhZ2UubWFya2V0cylcbiAgICB0aGlzLmNsZWFyRXJyb3JzKClcblxuICAgIGNvbnN0IGFkZEJvbmRSb3cgPSAoYXNzZXRJRDogbnVtYmVyLCBib25kQXNzZXQ6IEJvbmRBc3NldCkgPT4ge1xuICAgICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICAgIGlmICghYXNzZXQpIHJldHVyblxuICAgICAgY29uc3QgeyB1bml0SW5mbzogeyBjb252ZW50aW9uYWw6IHsgdW5pdCwgY29udmVyc2lvbkZhY3RvciB9IH0sIG5hbWUsIHN5bWJvbCB9ID0gYXNzZXRcbiAgICAgIGNvbnN0IHRyID0gcGFnZS5ib25kQXNzZXRUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgcGFnZS5ib25kQXNzZXRzLmFwcGVuZENoaWxkKHRyKVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRyKVxuXG4gICAgICB0bXBsLmxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHN5bWJvbClcbiAgICAgIHRtcGwubmFtZS50ZXh0Q29udGVudCA9IG5hbWVcblxuICAgICAgRG9jLmJpbmQodHIsICdjbGljaycsICgpID0+IHsgdGhpcy5hc3NldFNlbGVjdGVkKGFzc2V0SUQpIH0pXG4gICAgICB0bXBsLmZlZVN5bWJvbC50ZXh0Q29udGVudCA9IHVuaXRcbiAgICAgIGNvbnN0IGJvbmRTaXplQ29udmVudGlvbmFsID0gYm9uZEFzc2V0LmFtb3VudCAvIGNvbnZlcnNpb25GYWN0b3JcbiAgICAgIHRtcGwuZmVlQW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGJvbmRTaXplQ29udmVudGlvbmFsKVxuICAgICAgY29uc3QgZmlhdFJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICAgIERvYy5zZXRWaXMoZmlhdFJhdGUsIHRtcGwuZmlhdEJveClcbiAgICAgIGlmIChmaWF0UmF0ZSkgdG1wbC5maWF0Qm9uZEFtb3VudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhib25kU2l6ZUNvbnZlbnRpb25hbCAqIGZpYXRSYXRlKVxuICAgICAgdGhpcy5hc3NldFJvd3NbYXNzZXRJRF0gPSB7IHJlYWR5OiB0bXBsLnJlYWR5IH1cbiAgICB9XG5cbiAgICBjb25zdCBhZGRNYXJrZXRSb3cgPSAobWt0OiBNYXJrZXQpID0+IHtcbiAgICAgIGNvbnN0IHsgYmFzZWlkOiBiYXNlSUQsIHF1b3RlaWQ6IHF1b3RlSUQgfSA9IG1rdFxuICAgICAgY29uc3QgW2IsIHFdID0gW2FwcCgpLmFzc2V0c1tiYXNlSURdLCBhcHAoKS5hc3NldHNbcXVvdGVJRF1dXG4gICAgICBpZiAoIWIgfHwgIXEpIHJldHVyblxuICAgICAgY29uc3QgdHIgPSBwYWdlLm1hcmtldFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgICBwYWdlLm1hcmtldHMuYXBwZW5kQ2hpbGQodHIpXG4gICAgICBjb25zdCB7IHN5bWJvbDogYmFzZVN5bWJvbCwgdW5pdEluZm86IGJ1aSB9ID0geGMuYXNzZXRzW2Jhc2VJRF1cbiAgICAgIGNvbnN0IHsgc3ltYm9sOiBxdW90ZVN5bWJvbCwgdW5pdEluZm86IHF1aSB9ID0geGMuYXNzZXRzW3F1b3RlSURdXG4gICAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKHRyLCAnW2RhdGEtYmFzZS10aWNrZXJdJykpIGVsLnRleHRDb250ZW50ID0gYnVpLmNvbnZlbnRpb25hbC51bml0XG4gICAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKHRyLCAnW2RhdGEtcXVvdGUtdGlja2VyXScpKSBlbC50ZXh0Q29udGVudCA9IHF1aS5jb252ZW50aW9uYWwudW5pdFxuXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodHIpXG4gICAgICB0bXBsLmJhc2VMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChiYXNlU3ltYm9sKVxuICAgICAgdG1wbC5xdW90ZUxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHF1b3RlU3ltYm9sKVxuXG4gICAgICBjb25zdCBzZXRUaWVyID0gKHRpZXI6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IHBhcmNlbHNpemU6IHBhcmNlbFNpemUsIGxvdHNpemU6IGxvdFNpemUgfSA9IG1rdFxuICAgICAgICBjb25zdCBjb252ZW50aW9uYWxMb3RTaXplID0gbG90U2l6ZSAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgICAgICBjb25zdCBzdGFydGluZ0xpbWl0ID0gY29udmVudGlvbmFsTG90U2l6ZSAqIHBhcmNlbFNpemUgKiBwZXJUaWVyQmFzZVBhcmNlbExpbWl0ICogdGllclxuICAgICAgICBjb25zdCBwcml2aWxlZ2VkTGltaXQgPSBjb252ZW50aW9uYWxMb3RTaXplICogcGFyY2VsU2l6ZSAqIHBlclRpZXJCYXNlUGFyY2VsTGltaXQgKiBwYXJjZWxMaW1pdFNjb3JlTXVsdGlwbGllciAqIHRpZXJcbiAgICAgICAgdG1wbC50cmFkZUxpbWl0TG93LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHN0YXJ0aW5nTGltaXQpXG4gICAgICAgIHRtcGwudHJhZGVMaW1pdEhpZ2gudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocHJpdmlsZWdlZExpbWl0KVxuICAgICAgICBjb25zdCBiYXNlRmlhdFJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYmFzZUlEXVxuICAgICAgICBpZiAoYmFzZUZpYXRSYXRlKSB7XG4gICAgICAgICAgdG1wbC5maWF0VHJhZGVMaW1pdExvdy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhzdGFydGluZ0xpbWl0ICogYmFzZUZpYXRSYXRlKVxuICAgICAgICAgIHRtcGwuZmlhdFRyYWRlTGltaXRIaWdoLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHByaXZpbGVnZWRMaW1pdCAqIGJhc2VGaWF0UmF0ZSlcbiAgICAgICAgfVxuICAgICAgICBEb2Muc2V0VmlzKGJhc2VGaWF0UmF0ZSwgcGFnZS5maWF0VHJhZGVMb3dCb3gsIHBhZ2UuZmlhdFRyYWRlSGlnaEJveClcbiAgICAgIH1cblxuICAgICAgc2V0VGllcihzdHJvbmdUaWVyKHhjLmF1dGgpIHx8IDEpXG4gICAgICB0aGlzLm1hcmtldFJvd3MucHVzaCh7IG1rdCwgdG1wbCwgc2V0VGllciB9KVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgeyBzeW1ib2wsIGlkOiBhc3NldElEIH0gb2YgT2JqZWN0LnZhbHVlcyh4Yy5hc3NldHMgfHwge30pKSB7XG4gICAgICBpZiAoIWFwcCgpLmFzc2V0c1thc3NldElEXSkgY29udGludWVcbiAgICAgIGNvbnN0IGJvbmRBc3NldCA9IHhjLmJvbmRBc3NldHNbc3ltYm9sXVxuICAgICAgaWYgKGJvbmRBc3NldCkgYWRkQm9uZFJvdyhhc3NldElELCBib25kQXNzZXQpXG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBta3Qgb2YgT2JqZWN0LnZhbHVlcyh4Yy5tYXJrZXRzIHx8IHt9KSkgYWRkTWFya2V0Um93KG1rdClcblxuICAgIC8vIHBhZ2UuaG9zdC50ZXh0Q29udGVudCA9IHhjLmhvc3RcbiAgICBwYWdlLnRyYWRpbmdUaWVySW5wdXQudmFsdWUgPSB4Yy5hdXRoLnRhcmdldFRpZXIgPyBTdHJpbmcoeGMuYXV0aC50YXJnZXRUaWVyKSA6ICcxJ1xuXG4gICAgaWYgKHRoaXMudmFsaWRCb25kQXNzZXRTZWxlY3RlZCh4YykpIHRoaXMuYXNzZXRTZWxlY3RlZCh4Yy5hdXRoLmJvbmRBc3NldElEKVxuICAgIGVsc2UgRG9jLnNob3cocGFnZS5hc3NldEZvcm0pXG4gIH1cblxuICB2YWxpZEJvbmRBc3NldFNlbGVjdGVkICh4YzogRXhjaGFuZ2UpIHtcbiAgICBpZiAoeGMudmlld09ubHkpIHJldHVybiBmYWxzZVxuICAgIGNvbnN0IHsgdGFyZ2V0VGllciwgYm9uZEFzc2V0SUQgfSA9IHhjLmF1dGhcbiAgICBpZiAodGFyZ2V0VGllciA8IDEpIHJldHVybiBmYWxzZVxuICAgIGNvbnN0IGEgPSBhcHAoKS5hc3NldHNbYm9uZEFzc2V0SURdXG4gICAgcmV0dXJuIGEgJiYgQm9vbGVhbih4Yy5ib25kQXNzZXRzW2Euc3ltYm9sXSlcbiAgfVxuXG4gIC8qXG4gICAqIHdhbGxldENyZWF0ZWQgc2hvdWxkIGJlIGNhbGxlZCB3aGVuIGFuIGFzeW5jaHJvbm91cyB3YWxsZXQgY3JlYXRpb25cbiAgICogY29tcGxldGVzIHN1Y2Nlc3NmdWxseS5cbiAgICovXG4gIHdhbGxldENyZWF0ZWQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IGEgPSB0aGlzLmFzc2V0Um93c1thc3NldElEXVxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgc2V0UmVhZHlNZXNzYWdlKGEucmVhZHksIGFzc2V0KVxuICB9XG5cbiAgcmVmcmVzaCAoKSB7XG4gICAgdGhpcy5zZXRFeGNoYW5nZSh0aGlzLnhjLCB0aGlzLmNlcnRGaWxlKVxuICB9XG5cbiAgYXNzZXRTZWxlY3RlZCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgdGhpcy5zZWxlY3RlZEFzc2V0SUQgPSBhc3NldElEXG4gICAgdGhpcy5zZXRUaWVyKClcbiAgICBjb25zdCB7IHBhZ2U6IHsgYXNzZXRGb3JtLCB0cmFkaW5nVGllckZvcm0sIHRyYWRpbmdUaWVySW5wdXQgfSB9ID0gdGhpc1xuICAgIERvYy5oaWRlKGFzc2V0Rm9ybSlcbiAgICBEb2Muc2hvdyh0cmFkaW5nVGllckZvcm0pXG4gICAgdHJhZGluZ1RpZXJJbnB1dC5mb2N1cygpXG4gIH1cblxuICBzZXRUaWVyICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHhjOiB7IGJvbmRBc3NldHMgfSwgc2VsZWN0ZWRBc3NldElEOiBhc3NldElEIH0gPSB0aGlzXG4gICAgY29uc3QgeyBzeW1ib2wsIHVuaXRJbmZvOiB1aSB9ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgeyBjb252ZW50aW9uYWw6IHsgY29udmVyc2lvbkZhY3RvciwgdW5pdCB9IH0gPSB1aVxuXG4gICAgY29uc3QgYm9uZEFzc2V0ID0gYm9uZEFzc2V0c1tzeW1ib2xdXG4gICAgY29uc3QgcmF3ID0gcGFnZS50cmFkaW5nVGllcklucHV0LnZhbHVlID8/ICcnXG4gICAgaWYgKCFyYXcpIHJldHVyblxuICAgIGNvbnN0IHRpZXIgPSBwYXJzZUludChyYXcpXG4gICAgaWYgKGlzTmFOKHRpZXIpKSB7XG4gICAgICB0aGlzLnNldFRpZXJFcnJvcihpbnRsLnByZXAoaW50bC5JRF9JTlZBTElEX1RJRVJfVkFMVUUpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHBhZ2UudHJhZGluZ1RpZXJJbnB1dC52YWx1ZSA9IFN0cmluZyh0aWVyKVxuICAgIHBhZ2UuYm9uZFNpemVEaXNwbGF5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShib25kQXNzZXQuYW1vdW50LCB1aSlcbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKHBhZ2UudHJhZGluZ1RpZXJGb3JtLCAnW2RhdGEtdGllcl0nKSkgZWwudGV4dENvbnRlbnQgPSBTdHJpbmcodGllcilcbiAgICBmb3IgKGNvbnN0IGVsIG9mIERvYy5hcHBseVNlbGVjdG9yKHBhZ2UudHJhZGluZ1RpZXJGb3JtLCAnW2RhdGEtYm9uZC1hc3NldC10aWNrZXJdJykpIGVsLnRleHRDb250ZW50ID0gdW5pdFxuICAgIGNvbnN0IGJvbmRMb2NrID0gYm9uZEFzc2V0LmFtb3VudCAqIHRpZXIgKiBib25kUmVzZXJ2ZU11bHRpcGxpZXJcbiAgICBwYWdlLmJvbmRMb2NrRGlzcGxheS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYm9uZExvY2ssIHVpKVxuICAgIGNvbnN0IGZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Fzc2V0SURdXG4gICAgaWYgKGZpYXRSYXRlKSBwYWdlLmZpYXRMb2NrRGlzcGxheS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhib25kTG9jayAvIGNvbnZlcnNpb25GYWN0b3IgKiBmaWF0UmF0ZSlcbiAgICBmb3IgKGNvbnN0IG0gb2YgT2JqZWN0LnZhbHVlcyh0aGlzLm1hcmtldFJvd3MpKSBtLnNldFRpZXIodGllcilcbiAgICBjb25zdCBjdXJyZW50Qm9uZEFtdHM6IFJlY29yZDxudW1iZXIsIG51bWJlcj4gPSB7fVxuICAgIGZvciAoY29uc3QgW2Fzc2V0SURTdHIsIHsgd2FsbGV0IH1dIG9mIE9iamVjdC5lbnRyaWVzKGFwcCgpLmFzc2V0cykpIHtcbiAgICAgIGlmICghd2FsbGV0KSBjb250aW51ZVxuICAgICAgY29uc3QgeyBiYWxhbmNlOiB7IGJvbmRsb2NrZWQsIGJvbmRSZXNlcnZlcyB9IH0gPSB3YWxsZXRcbiAgICAgIGNvbnN0IGJvbmRlZCA9IGJvbmRsb2NrZWQgKyBib25kUmVzZXJ2ZXNcbiAgICAgIGlmIChib25kZWQgPiAwKSBjdXJyZW50Qm9uZEFtdHNbcGFyc2VJbnQoYXNzZXRJRFN0cildID0gYm9uZGVkXG4gICAgfVxuICAgIGNvbnN0IGhhdmVMb2NrID0gT2JqZWN0LmtleXMoY3VycmVudEJvbmRBbXRzKS5sZW5ndGggPiAwXG4gICAgRG9jLnNldFZpcyhoYXZlTG9jaywgcGFnZS5jdXJyZW50Qm9uZEJveClcbiAgICBpZiAoaGF2ZUxvY2spIHtcbiAgICAgIERvYy5lbXB0eShwYWdlLmN1cnJlbnRCb25kcylcbiAgICAgIGZvciAoY29uc3QgW2Fzc2V0SURTdHIsIGJvbmRMb2NrZWRdIG9mIE9iamVjdC5lbnRyaWVzKGN1cnJlbnRCb25kQW10cykpIHtcbiAgICAgICAgY29uc3QgYXNzZXRJRCA9IHBhcnNlSW50KGFzc2V0SURTdHIpXG4gICAgICAgIGNvbnN0IHsgdW5pdEluZm86IHVpLCBzeW1ib2wsIG5hbWUgfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgICAgICBjb25zdCB7IGNvbnZlbnRpb25hbDogeyBjb252ZXJzaW9uRmFjdG9yLCB1bml0IH0gfSA9IHVpXG4gICAgICAgIGNvbnN0IHRyID0gcGFnZS5jdXJyZW50Qm9uZFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgIHBhZ2UuY3VycmVudEJvbmRzLmFwcGVuZENoaWxkKHRyKVxuICAgICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodHIpXG4gICAgICAgIHRtcGwuaWNvbi5zcmMgPSBEb2MubG9nb1BhdGgoc3ltYm9sKVxuICAgICAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBuYW1lXG4gICAgICAgIHRtcGwuYW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShib25kTG9ja2VkLCB1aSlcbiAgICAgICAgdG1wbC50aWNrZXIudGV4dENvbnRlbnQgPSB1bml0XG4gICAgICAgIHRtcGwubmFtZS50ZXh0Q29udGVudCA9IG5hbWVcbiAgICAgICAgY29uc3QgZmlhdFJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICAgICAgRG9jLnNldFZpcyh0bXBsLmZpYXRCb3gpXG4gICAgICAgIGlmIChmaWF0UmF0ZSkgdG1wbC5maWF0QW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGJvbmRMb2NrZWQgLyBjb252ZXJzaW9uRmFjdG9yICogZmlhdFJhdGUpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5zZXRWaXMoZmlhdFJhdGUsIHBhZ2UuZmlhdExvY2tCb3gpXG4gIH1cblxuICBhY2NlcHRUaWVyICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHNlbGVjdGVkQXNzZXRJRDogYXNzZXRJRCB9ID0gdGhpc1xuICAgIHRoaXMuY2xlYXJFcnJvcnMoKVxuICAgIGNvbnN0IHJhdyA9IHBhZ2UudHJhZGluZ1RpZXJJbnB1dC52YWx1ZSA/PyAnJ1xuICAgIGlmICghcmF3KSByZXR1cm5cbiAgICBjb25zdCB0aWVyID0gcGFyc2VJbnQocmF3KVxuICAgIGlmIChpc05hTih0aWVyKSkge1xuICAgICAgdGhpcy5zZXRUaWVyRXJyb3IoaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9USUVSX1ZBTFVFKSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnN1Y2Nlc3MoYXNzZXRJRCwgdGllcilcbiAgfVxuXG4gIGluY3JlbWVudFRpZXIgKHVwOiBib29sZWFuKSB7XG4gICAgY29uc3QgeyBwYWdlOiB7IHRyYWRpbmdUaWVySW5wdXQ6IGlucHV0IH0gfSA9IHRoaXNcbiAgICBpbnB1dC52YWx1ZSA9IFN0cmluZyhNYXRoLm1heCgxLCAocGFyc2VJbnQoaW5wdXQudmFsdWUgPz8gJycpIHx8IDEpICsgKHVwID8gMSA6IC0xKSkpXG4gICAgdGhpcy5zZXRUaWVyKClcbiAgfVxuXG4gIC8qXG4gICAqIEFuaW1hdGlvbiB0byBtYWtlIHRoZSBlbGVtZW50cyBzb3J0IG9mIGV4cGFuZCBpbnRvIHRoZWlyIHNwYWNlIGZyb20gdGhlXG4gICAqIGJvdHRvbSBhcyB0aGV5IGZhZGUgaW4uXG4gICAqL1xuICBhc3luYyBhbmltYXRlICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGZvcm0gfSA9IHRoaXNcbiAgICBjb25zdCBleHRyYU1hcmdpbiA9IDc1XG4gICAgY29uc3QgZXh0cmFUb3AgPSA1MFxuICAgIGNvbnN0IHJlZ0Fzc2V0RWxlbWVudHMgPSBBcnJheS5mcm9tKHBhZ2UuYm9uZEFzc2V0cy5jaGlsZHJlbikgYXMgUGFnZUVsZW1lbnRbXVxuICAgIGZvcm0uc3R5bGUub3BhY2l0eSA9ICcwJ1xuXG4gICAgY29uc3QgYW5pTGVuID0gMzUwXG4gICAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pTGVuLCBwcm9nID0+IHtcbiAgICAgIGZvciAoY29uc3QgZWwgb2YgcmVnQXNzZXRFbGVtZW50cykge1xuICAgICAgICBlbC5zdHlsZS5tYXJnaW5Ub3AgPSBgJHsoMSAtIHByb2cpICogZXh0cmFNYXJnaW59cHhgXG4gICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgke3Byb2d9KWBcbiAgICAgIH1cbiAgICAgIGZvcm0uc3R5bGUub3BhY2l0eSA9IE1hdGgucG93KHByb2csIDQpLnRvRml4ZWQoMSlcbiAgICAgIGZvcm0uc3R5bGUudG9wID0gYCR7KDEgLSBwcm9nKSAqIGV4dHJhVG9wfXB4YFxuICAgIH0sICdlYXNlT3V0JylcbiAgfVxuXG4gIHNob3dQcmVwYWlkQm9uZEZvcm0gKCkge1xuICAgIGNvbnN0IHsgcGFnZSB9ID0gdGhpc1xuICAgIERvYy5oaWRlKHBhZ2UuYXNzZXRGb3JtLCBwYWdlLnByZXBhaWRCb25kRXJyKVxuICAgIHBhZ2UucHJlcGFpZEJvbmRDb2RlLnZhbHVlID0gJydcbiAgICBEb2Muc2hvdyhwYWdlLnByZXBhaWRCb25kcylcbiAgfVxuXG4gIGhpZGVQcmVwYWlkQm9uZEZvcm0gKCkge1xuICAgIGNvbnN0IHsgcGFnZSB9ID0gdGhpc1xuICAgIERvYy5oaWRlKHBhZ2UucHJlcGFpZEJvbmRzKVxuICAgIERvYy5zaG93KHBhZ2UuYXNzZXRGb3JtKVxuICB9XG5cbiAgYXN5bmMgc3VibWl0UHJlcGFpZEJvbmQgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgeGM6IHsgaG9zdCB9IH0gPSB0aGlzXG4gICAgRG9jLmhpZGUocGFnZS5wcmVwYWlkQm9uZEVycilcbiAgICBjb25zdCBjb2RlID0gcGFnZS5wcmVwYWlkQm9uZENvZGUudmFsdWVcbiAgICBpZiAoIWNvZGUpIHtcbiAgICAgIHBhZ2UucHJlcGFpZEJvbmRFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9JTlZBTElEX1ZBTFVFKVxuICAgICAgRG9jLnNob3cocGFnZS5wcmVwYWlkQm9uZEVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9yZWRlZW1wcmVwYWlkYm9uZCcsIHsgaG9zdCwgY29kZSwgY2VydDogdGhpcy5jZXJ0RmlsZSB9KVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLnByZXBhaWRCb25kRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5wcmVwYWlkQm9uZEVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnN1Y2Nlc3MoUHJlcGFpZEJvbmRJRCwgcmVzLnRpZXIpXG4gIH1cbn1cblxuLypcbiAqIHNldFJlYWR5TWVzc2FnZSBzZXRzIGFuIGFzc2V0J3Mgc3RhdHVzIG1lc3NhZ2Ugb24gdGhlIEZlZUFzc2V0U2VsZWN0aW9uRm9ybS5cbiAqL1xuZnVuY3Rpb24gc2V0UmVhZHlNZXNzYWdlIChlbDogUGFnZUVsZW1lbnQsIGFzc2V0OiBTdXBwb3J0ZWRBc3NldCkge1xuICBpZiAoYXNzZXQud2FsbGV0KSBlbC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1dBTExFVF9SRUFEWSlcbiAgZWxzZSBpZiAoYXNzZXQud2FsbGV0Q3JlYXRpb25QZW5kaW5nKSBlbC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1dBTExFVF9QRU5ESU5HKVxuICBlbHNlIGVsLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfU0VUVVBfTkVFREVEKVxuICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdyZWFkeWdyZWVuJywgJ3NldHVwb3JhbmdlJylcbiAgZWwuY2xhc3NMaXN0LmFkZChhc3NldC53YWxsZXQgPyAncmVhZHlncmVlbicgOiAnc2V0dXBvcmFuZ2UnKVxufVxuXG4vKlxuICogV2FsbGV0V2FpdEZvcm0gaXMgYSBmb3JtIHVzZWQgdG8gdHJhY2sgdGhlIHdhbGxldCBzeW5jIHN0YXR1cyBhbmQgYmFsYW5jZVxuICogaW4gcHJlcGFyYXRpb24gZm9yIHBvc3RpbmcgYSBib25kLlxuICovXG5leHBvcnQgY2xhc3MgV2FsbGV0V2FpdEZvcm0ge1xuICBmb3JtOiBIVE1MRWxlbWVudFxuICBzdWNjZXNzOiAoKSA9PiB2b2lkXG4gIGdvQmFjazogKCkgPT4gdm9pZFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgYXNzZXRJRDogbnVtYmVyXG4gIHBhcmVudElEPzogbnVtYmVyXG4gIHhjOiBFeGNoYW5nZVxuICBib25kQXNzZXQ6IEJvbmRBc3NldFxuICBwcm9ncmVzc0NhY2hlOiBQcm9ncmVzc1BvaW50W11cbiAgcHJvZ3Jlc3NlZDogYm9vbGVhblxuICBmdW5kZWQ6IGJvb2xlYW5cbiAgLy8gaWYgcHJvZ3Jlc3NlZCAmJiBmdW5kZWQsIHN0b3AgcmVwb3J0aW5nIGJhbGFuY2Ugb3Igc3RhdGU7IGNhbGwgc3VjY2VzcygpXG4gIGJvbmRGZWVCdWZmZXI6IG51bWJlciAvLyBpbiBwYXJlbnQgYXNzZXRcbiAgcGFyZW50QXNzZXRTeW5jZWQ6IGJvb2xlYW5cblxuICBjb25zdHJ1Y3RvciAoZm9ybTogSFRNTEVsZW1lbnQsIHN1Y2Nlc3M6ICgpID0+IHZvaWQsIGdvQmFjazogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUoZm9ybSlcbiAgICB0aGlzLmFzc2V0SUQgPSAtMVxuICAgIHRoaXMucHJvZ3Jlc3NDYWNoZSA9IFtdXG4gICAgdGhpcy5wcm9ncmVzc2VkID0gZmFsc2VcbiAgICB0aGlzLmZ1bmRlZCA9IGZhbHNlXG5cbiAgICBEb2MuYmluZCh0aGlzLnBhZ2UuZ29CYWNrLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmFzc2V0SUQgPSAtMVxuICAgICAgZ29CYWNrKClcbiAgICB9KVxuXG4gICAgYXBwKCkucmVnaXN0ZXJOb3RlRmVlZGVyKHtcbiAgICAgIHdhbGxldHN0YXRlOiAobm90ZTogV2FsbGV0U3RhdGVOb3RlKSA9PiB0aGlzLnJlcG9ydFdhbGxldFN0YXRlKG5vdGUud2FsbGV0KSxcbiAgICAgIHdhbGxldHN5bmM6IChub3RlOiBXYWxsZXRTeW5jTm90ZSkgPT4ge1xuICAgICAgICBpZiAobm90ZS5hc3NldElEICE9PSB0aGlzLmFzc2V0SUQpIHJldHVyblxuICAgICAgICBjb25zdCB3ID0gYXBwKCkud2FsbGV0TWFwW25vdGUuYXNzZXRJRF1cbiAgICAgICAgdGhpcy5yZXBvcnRQcm9ncmVzcyh3LnN5bmNlZCwgdy5zeW5jUHJvZ3Jlc3MpXG4gICAgICB9LFxuICAgICAgYmFsYW5jZTogKG5vdGU6IEJhbGFuY2VOb3RlKSA9PiB0aGlzLnJlcG9ydEJhbGFuY2Uobm90ZS5hc3NldElEKVxuICAgIH0pXG4gIH1cblxuICAvKiBzZXRFeGNoYW5nZSBzZXRzIHRoZSBleGNoYW5nZSBmb3Igd2hpY2ggdGhlIGZlZSBpcyBiZWluZyBwYWlkLiAqL1xuICBzZXRFeGNoYW5nZSAoeGM6IEV4Y2hhbmdlKSB7XG4gICAgdGhpcy54YyA9IHhjXG4gIH1cblxuICAvKiBzZXRXYWxsZXQgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIHNob3dpbmcgdGhlIFdhbGxldFdhaXRGb3JtLiAqL1xuICBzZXRXYWxsZXQgKGFzc2V0SUQ6IG51bWJlciwgYm9uZEZlZUJ1ZmZlcjogbnVtYmVyLCB0aWVyOiBudW1iZXIpIHtcbiAgICB0aGlzLmFzc2V0SUQgPSBhc3NldElEXG4gICAgdGhpcy5wcm9ncmVzc0NhY2hlID0gW11cbiAgICB0aGlzLnByb2dyZXNzZWQgPSBmYWxzZVxuICAgIHRoaXMuZnVuZGVkID0gZmFsc2VcbiAgICB0aGlzLmJvbmRGZWVCdWZmZXIgPSBib25kRmVlQnVmZmVyIC8vIGluIGNhc2Ugd2UncmUgYSB0b2tlbiwgcGFyZW50J3MgYmFsYW5jZSBtdXN0IGNvdmVyXG4gICAgdGhpcy5wYXJlbnRBc3NldFN5bmNlZCA9IGZhbHNlXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgeyBzeW1ib2wsIHVuaXRJbmZvOiB1aSwgd2FsbGV0OiB7IGJhbGFuY2U6IGJhbCwgYWRkcmVzcywgc3luY2VkLCBzeW5jUHJvZ3Jlc3MgfSwgdG9rZW4gfSA9IGFzc2V0XG4gICAgdGhpcy5wYXJlbnRJRCA9IHRva2VuPy5wYXJlbnRJRFxuICAgIGNvbnN0IGJvbmRBc3NldCA9IHRoaXMuYm9uZEFzc2V0ID0gdGhpcy54Yy5ib25kQXNzZXRzW3N5bWJvbF1cblxuICAgIGNvbnN0IHN5bWJvbGl6ZSA9IChlbDogUGFnZUVsZW1lbnQsIGFzc2V0OiBTdXBwb3J0ZWRBc3NldCkgPT4ge1xuICAgICAgRG9jLmVtcHR5KGVsKVxuICAgICAgZWwuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShhc3NldCkpXG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBzcGFuIG9mIERvYy5hcHBseVNlbGVjdG9yKHRoaXMuZm9ybSwgJy51bml0JykpIHN5bWJvbGl6ZShzcGFuLCBhc3NldClcbiAgICBwYWdlLmxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHN5bWJvbClcbiAgICBwYWdlLmRlcG9BZGRyLnRleHRDb250ZW50ID0gYWRkcmVzc1xuXG4gICAgRG9jLmhpZGUocGFnZS5zeW5jVW5jaGVjaywgcGFnZS5zeW5jQ2hlY2ssIHBhZ2UuYmFsVW5jaGVjaywgcGFnZS5iYWxDaGVjaywgcGFnZS5zeW5jUmVtYWluQm94LCBwYWdlLmJvbmRDb3N0QnJlYWtkb3duKVxuICAgIERvYy5zaG93KHBhZ2UuYmFsYW5jZUJveClcblxuICAgIGxldCBib25kTG9jayA9IDIgKiBib25kQXNzZXQuYW1vdW50ICogdGllclxuICAgIGlmIChib25kRmVlQnVmZmVyID4gMCkge1xuICAgICAgRG9jLnNob3cocGFnZS5ib25kQ29zdEJyZWFrZG93bilcbiAgICAgIHBhZ2UuYm9uZExvY2tOb0ZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJvbmRMb2NrLCB1aSlcbiAgICAgIHBhZ2UuYm9uZExvY2tGZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShib25kRmVlQnVmZmVyLCB1aSlcbiAgICAgIGJvbmRMb2NrICs9IGJvbmRGZWVCdWZmZXJcbiAgICAgIGNvbnN0IG5lZWQgPSBNYXRoLm1heChib25kTG9jayAtIGJhbC5hdmFpbGFibGUgKyBiYWwucmVzZXJ2ZXNEZWZpY2l0LCAwKVxuICAgICAgcGFnZS50b3RhbEZvckJvbmQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG5lZWQsIHVpKVxuICAgICAgRG9jLmhpZGUocGFnZS5zZW5kRW5vdWdoKSAvLyBnZW5lcmljIG1zZyB3aGVuIG5vIGZlZSBpbmZvIGF2YWlsYWJsZSB3aGVuXG4gICAgICBEb2MuaGlkZShwYWdlLnR4RmVlQm94LCBwYWdlLnNlbmRFbm91Z2hGb3JUb2tlbiwgcGFnZS50eEZlZUJhbGFuY2VCb3gpIC8vIGZvciB0b2tlbnNcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc2VuZEVub3VnaFdpdGhFc3QpIC8vIG5vbi10b2tlbnNcblxuICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UudHhGZWVCb3gsIHBhZ2Uuc2VuZEVub3VnaEZvclRva2VuLCBwYWdlLnR4RmVlQmFsYW5jZUJveClcbiAgICAgICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS5hc3NldHNbdG9rZW4ucGFyZW50SURdXG4gICAgICAgIHBhZ2UudHhGZWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJvbmRGZWVCdWZmZXIsIHBhcmVudEFzc2V0LnVuaXRJbmZvKVxuICAgICAgICBwYWdlLnBhcmVudEZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJvbmRGZWVCdWZmZXIsIHBhcmVudEFzc2V0LnVuaXRJbmZvKVxuICAgICAgICBwYWdlLnRva2VuRmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobmVlZCwgdWkpXG4gICAgICAgIHN5bWJvbGl6ZShwYWdlLnR4RmVlVW5pdCwgcGFyZW50QXNzZXQpXG4gICAgICAgIHN5bWJvbGl6ZShwYWdlLnBhcmVudFVuaXQsIHBhcmVudEFzc2V0KVxuICAgICAgICBzeW1ib2xpemUocGFnZS5wYXJlbnRCYWxVbml0LCBwYXJlbnRBc3NldClcbiAgICAgICAgcGFnZS5wYXJlbnRCYWwudGV4dENvbnRlbnQgPSBwYXJlbnRBc3NldC53YWxsZXQgPyBEb2MuZm9ybWF0Q29pblZhbHVlKHBhcmVudEFzc2V0LndhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSwgcGFyZW50QXNzZXQudW5pdEluZm8pIDogJzAnXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLnNlbmRFbm91Z2hXaXRoRXN0KVxuICAgICAgfVxuICAgICAgcGFnZS5mZWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJvbmRMb2NrLCB1aSlcbiAgICB9IGVsc2UgeyAvLyBzaG93IHNvbWUgZ2VuZXJpYyBtZXNzYWdlIHdpdGggbm8gYW1vdW50cywgdGhpcyBzaG91bGRuJ3QgaGFwcGVuLi4uIHNob3cgd2FsbGV0IGVycm9yP1xuICAgICAgRG9jLnNob3cocGFnZS5zZW5kRW5vdWdoKVxuICAgIH1cblxuICAgIERvYy5zaG93KHN5bmNlZCA/IHBhZ2Uuc3luY0NoZWNrIDogc3luY1Byb2dyZXNzID49IDEgPyBwYWdlLnN5bmNTcGlubmVyIDogcGFnZS5zeW5jVW5jaGVjaylcbiAgICBEb2Muc2hvdyhiYWwuYXZhaWxhYmxlID49IDIgKiBib25kQXNzZXQuYW1vdW50ICsgYm9uZEZlZUJ1ZmZlciA/IHBhZ2UuYmFsQ2hlY2sgOiBwYWdlLmJhbFVuY2hlY2spXG5cbiAgICBwYWdlLnByb2dyZXNzLnRleHRDb250ZW50ID0gKHN5bmNQcm9ncmVzcyAqIDEwMCkudG9GaXhlZCgxKVxuXG4gICAgaWYgKHN5bmNlZCkge1xuICAgICAgdGhpcy5wcm9ncmVzc2VkID0gdHJ1ZVxuICAgIH1cbiAgICB0aGlzLnJlcG9ydEJhbGFuY2UoYXNzZXRJRClcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydFdhbGxldFN0YXRlIHNldHMgdGhlIHByb2dyZXNzIGFuZCBiYWxhbmNlLCB1bHRpbWF0ZWx5IGNhbGxpbmcgdGhlXG4gICAqIHN1Y2Nlc3MgZnVuY3Rpb24gaWYgY29uZGl0aW9ucyBhcmUgbWV0LlxuICAgKi9cbiAgcmVwb3J0V2FsbGV0U3RhdGUgKHdhbGxldDogV2FsbGV0U3RhdGUpIHtcbiAgICBpZiAodGhpcy5wcm9ncmVzc2VkICYmIHRoaXMuZnVuZGVkKSByZXR1cm5cbiAgICBpZiAod2FsbGV0LmFzc2V0SUQgPT09IHRoaXMuYXNzZXRJRCkgdGhpcy5yZXBvcnRQcm9ncmVzcyh3YWxsZXQuc3luY2VkLCB3YWxsZXQuc3luY1Byb2dyZXNzKVxuICAgIHRoaXMucmVwb3J0QmFsYW5jZSh3YWxsZXQuYXNzZXRJRClcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydEJhbGFuY2Ugc2V0cyB0aGUgYmFsYW5jZSBkaXNwbGF5IGFuZCBjYWxscyBzdWNjZXNzIGlmIHdlIGdvIG92ZXIgdGhlXG4gICAqIHRocmVzaG9sZC5cbiAgICovXG4gIHJlcG9ydEJhbGFuY2UgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGlmICh0aGlzLmZ1bmRlZCB8fCB0aGlzLmFzc2V0SUQgPT09IC0xKSByZXR1cm5cbiAgICBpZiAoYXNzZXRJRCAhPT0gdGhpcy5hc3NldElEICYmIGFzc2V0SUQgIT09IHRoaXMucGFyZW50SUQpIHJldHVyblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1t0aGlzLmFzc2V0SURdXG5cbiAgICBjb25zdCBhdmFpbCA9IGFzc2V0LndhbGxldC5iYWxhbmNlLmF2YWlsYWJsZVxuICAgIHBhZ2UuYmFsYW5jZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYXZhaWwsIGFzc2V0LnVuaXRJbmZvKVxuXG4gICAgaWYgKGFzc2V0LnRva2VuKSB7XG4gICAgICBjb25zdCBwYXJlbnRBc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgICAgIGNvbnN0IHBhcmVudEF2YWlsID0gcGFyZW50QXNzZXQud2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlXG4gICAgICBwYWdlLnBhcmVudEJhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocGFyZW50QXZhaWwsIHBhcmVudEFzc2V0LnVuaXRJbmZvKVxuICAgICAgaWYgKHBhcmVudEF2YWlsIDwgdGhpcy5ib25kRmVlQnVmZmVyKSByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBOT1RFOiB3aGVuL2lmIHdlIGFsbG93IG9uZS10aW1lIGJvbmQgcG9zdCAobm8gbWFpbnRlbmFuY2UpIGZyb20gdGhlIFVJIHdlXG4gICAgLy8gbWF5IGFsbG93IHRvIHByb2NlZWQgYXMgbG9uZyBhcyB0aGV5IGhhdmUgZW5vdWdoIGZvciB0eCBmZWVzLiBGb3Igbm93LFxuICAgIC8vIHRoZSBiYWxhbmNlIGNoZWNrIGJveCB3aWxsIHJlbWFpbiB1bmNoZWNrZWQgYW5kIHdlIHdpbGwgbm90IHByb2NlZWQuXG4gICAgaWYgKGF2YWlsIDwgMiAqIHRoaXMuYm9uZEFzc2V0LmFtb3VudCArIHRoaXMuYm9uZEZlZUJ1ZmZlcikgcmV0dXJuXG5cbiAgICBEb2Muc2hvdyhwYWdlLmJhbENoZWNrKVxuICAgIERvYy5oaWRlKHBhZ2UuYmFsVW5jaGVjaywgcGFnZS5iYWxhbmNlQm94LCBwYWdlLnNlbmRFbm91Z2gpXG4gICAgdGhpcy5mdW5kZWQgPSB0cnVlXG4gICAgaWYgKHRoaXMucHJvZ3Jlc3NlZCkgdGhpcy5zdWNjZXNzKClcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydFByb2dyZXNzIHNldHMgdGhlIHByb2dyZXNzIGRpc3BsYXkgYW5kIGNhbGxzIHN1Y2Nlc3MgaWYgd2UgYXJlIGZ1bGx5XG4gICAqIHN5bmNlZC5cbiAgICovXG4gIHJlcG9ydFByb2dyZXNzIChzeW5jZWQ6IGJvb2xlYW4sIHByb2c6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBpZiAoc3luY2VkKSB7XG4gICAgICBwYWdlLnByb2dyZXNzLnRleHRDb250ZW50ID0gJzEwMCdcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc3luY1VuY2hlY2ssIHBhZ2Uuc3luY1JlbWFpbkJveCwgcGFnZS5zeW5jU3Bpbm5lcilcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3luY0NoZWNrKVxuICAgICAgdGhpcy5wcm9ncmVzc2VkID0gdHJ1ZVxuICAgICAgaWYgKHRoaXMuZnVuZGVkKSB0aGlzLnN1Y2Nlc3MoKVxuICAgICAgcmV0dXJuXG4gICAgfSBlbHNlIGlmIChwcm9nID09PSAxKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnN5bmNVbmNoZWNrKVxuICAgICAgRG9jLnNob3cocGFnZS5zeW5jU3Bpbm5lcilcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS5zeW5jU3Bpbm5lcilcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3luY1VuY2hlY2spXG4gICAgfVxuICAgIHBhZ2UucHJvZ3Jlc3MudGV4dENvbnRlbnQgPSAocHJvZyAqIDEwMCkudG9GaXhlZCgxKVxuXG4gICAgaWYgKHByb2cgPj0gMC45OTkpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc3luY1JlbWFpbmluZylcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3luY0ZpbmlzaGluZ1VwKVxuICAgICAgRG9jLnNob3cocGFnZS5zeW5jUmVtYWluQm94KVxuICAgICAgLy8gVGhlIGZpbmFsIHN0YWdlIG9mIHdhbGxldCBzeW5jIHByb2Nlc3MgY2FuIHRha2UgYSB3aGlsZSAoaXQgbWlnaHQgaGFuZ1xuICAgICAgLy8gYXQgOTkuOSUgZm9yIG1hbnkgbWludXRlcywgaW5kZXhpbmcgYWRkcmVzc2VzIGZvciBleGFtcGxlKSwgdGhlIHNpbXBsZXN0XG4gICAgICAvLyB3YXkgdG8gaGFuZGxlIGl0IGlzIHRvIGtlZXAgZGlzcGxheWluZyBcImZpbmlzaGluZyB1cFwiIG1lc3NhZ2UgdW50aWwgdGhlXG4gICAgICAvLyBzeW5jIGlzIGZpbmlzaGVkLCBzaW5jZSB3ZSBjYW4ndCByZWFzb25hYmx5IHNob3cgaXQgcHJvZ3Jlc3Npbmcgb3ZlciB0aW1lLlxuICAgICAgcGFnZS5zeW5jRmluaXNoaW5nVXAudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9XQUxMRVRfU1lOQ19GSU5JU0hJTkdfVVApXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgLy8gQmVmb3JlIHdlIGdldCB0byA5OS45JSB0aGUgcmVtYWluaW5nIHRpbWUgZXN0aW1hdGUgbXVzdCBiZSBiYXNlZCBvbiBtb3JlXG4gICAgLy8gdGhhbiBvbmUgcHJvZ3Jlc3MgcmVwb3J0LiBXZSdsbCBjYWNoZSB1cCB0byB0aGUgbGFzdCAyMCBhbmQgbG9vayBhdCB0aGVcbiAgICAvLyBkaWZmZXJlbmNlIGJldHdlZW4gdGhlIGZpcnN0IGFuZCBsYXN0IHRvIG1ha2UgdGhlIGVzdGltYXRlLlxuICAgIGNvbnN0IGNhY2hlU2l6ZSA9IDIwXG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLnByb2dyZXNzQ2FjaGVcbiAgICBjYWNoZS5wdXNoKHtcbiAgICAgIHN0YW1wOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcbiAgICAgIHByb2dyZXNzOiBwcm9nXG4gICAgfSlcbiAgICBpZiAoY2FjaGUubGVuZ3RoIDwgMikge1xuICAgICAgLy8gQ2FuJ3QgbWVhbmluZ2Z1bGx5IGVzdGltYXRlIHJlbWFpbmluZyB1bnRpbCB3ZSBoYXZlIGF0IGxlYXN0IDIgZGF0YSBwb2ludHMuXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgd2hpbGUgKGNhY2hlLmxlbmd0aCA+IGNhY2hlU2l6ZSkgY2FjaGUuc2hpZnQoKVxuICAgIGNvbnN0IFtmaXJzdCwgbGFzdF0gPSBbY2FjaGVbMF0sIGNhY2hlW2NhY2hlLmxlbmd0aCAtIDFdXVxuICAgIGNvbnN0IHByb2dEZWx0YSA9IGxhc3QucHJvZ3Jlc3MgLSBmaXJzdC5wcm9ncmVzc1xuICAgIGlmIChwcm9nRGVsdGEgPT09IDApIHtcbiAgICAgIC8vIEhhdmluZyBubyBwcm9ncmVzcyBmb3IgYSB3aGlsZSBsaWtlbHkgbWVhbnMgd2UgYXJlIGV4cGVyaWVuY2luZyBuZXR3b3JrXG4gICAgICAvLyBpc3N1ZXMsIGNhbid0IHJlYXNvbmFibHkgZXN0aW1hdGUgdGltZSByZW1haW5pbmcgaW4gdGhpcyBjYXNlLlxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2Uuc3luY0ZpbmlzaGluZ1VwKVxuICAgIERvYy5zaG93KHBhZ2Uuc3luY1JlbWFpbmluZylcbiAgICBEb2Muc2hvdyhwYWdlLnN5bmNSZW1haW5Cb3gpXG4gICAgY29uc3QgdGltZURlbHRhID0gbGFzdC5zdGFtcCAtIGZpcnN0LnN0YW1wXG4gICAgY29uc3QgcHJvZ1JhdGUgPSBwcm9nRGVsdGEgLyB0aW1lRGVsdGFcbiAgICBjb25zdCB0b0dvUHJvZyA9IDEgLSBsYXN0LnByb2dyZXNzXG4gICAgY29uc3QgdG9Hb1RpbWUgPSB0b0dvUHJvZyAvIHByb2dSYXRlXG4gICAgcGFnZS5zeW5jUmVtYWluLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdER1cmF0aW9uKHRvR29UaW1lKVxuICB9XG59XG5cbmludGVyZmFjZSBFYXJseUFjY2VsZXJhdGlvbiB7XG4gIHRpbWVQYXN0OiBudW1iZXIsXG4gIHdhc0FjY2VsZXJhdGlvbjogYm9vbGVhblxufVxuXG5pbnRlcmZhY2UgUHJlQWNjZWxlcmF0ZSB7XG4gIHN3YXBSYXRlOiBudW1iZXJcbiAgc3VnZ2VzdGVkUmF0ZTogbnVtYmVyXG4gIHN1Z2dlc3RlZFJhbmdlOiBYWVJhbmdlXG4gIGVhcmx5QWNjZWxlcmF0aW9uPzogRWFybHlBY2NlbGVyYXRpb25cbn1cblxuLypcbiAqIEFjY2VsZXJhdGVPcmRlckZvcm0gaXMgdXNlZCB0byBzdWJtaXQgYW4gYWNjZWxlcmF0aW9uIHJlcXVlc3QgZm9yIGFuIG9yZGVyLlxuICovXG5leHBvcnQgY2xhc3MgQWNjZWxlcmF0ZU9yZGVyRm9ybSB7XG4gIGZvcm06IEhUTUxFbGVtZW50XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBvcmRlcjogT3JkZXJcbiAgYWNjZWxlcmF0ZWRSYXRlOiBudW1iZXJcbiAgZWFybHlBY2NlbGVyYXRpb24/OiBFYXJseUFjY2VsZXJhdGlvblxuICBjdXJyZW5jeVVuaXQ6IHN0cmluZ1xuICBzdWNjZXNzOiAoKSA9PiB2b2lkXG5cbiAgY29uc3RydWN0b3IgKGZvcm06IEhUTUxFbGVtZW50LCBzdWNjZXNzOiAoKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIHRoaXMuc3VjY2VzcyA9IHN1Y2Nlc3NcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoZm9ybSlcblxuICAgIERvYy5iaW5kKHBhZ2UuYWNjZWxlcmF0ZVN1Ym1pdCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5zdWJtaXQoKVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zdWJtaXRFYXJseUNvbmZpcm0sICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuc2VuZEFjY2VsZXJhdGVSZXF1ZXN0KClcbiAgICB9KVxuICB9XG5cbiAgLypcbiAgICogZGlzcGxheUVhcmx5QWNjZWxlcmF0aW9uTXNnIGRpc3BsYXlzIGEgbWVzc2FnZSBhc2tpbmcgZm9yIGNvbmZpcm1hdGlvblxuICAgKiB3aGVuIHRoZSB1c2VyIHRyaWVzIHRvIHN1Ym1pdCBhbiBhY2NlbGVyYXRpb24gdHJhbnNhY3Rpb24gdmVyeSBzb29uIGFmdGVyXG4gICAqIHRoZSBzd2FwIHRyYW5zYWN0aW9uIHdhcyBicm9hZGNhc3QsIG9yIHZlcnkgc29vbiBhZnRlciBhIHByZXZpb3VzXG4gICAqIGFjY2VsZXJhdGlvbi5cbiAgICovXG4gIGRpc3BsYXlFYXJseUFjY2VsZXJhdGlvbk1zZyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIC8vIHRoaXMgaXMgY2hlY2tlZCBpbiBzdWJtaXQsIGJ1dCBhbm90aGVyIGNoZWNrIGlzIG5lZWRlZCBmb3IgdHMgY29tcGlsZXJcbiAgICBpZiAoIXRoaXMuZWFybHlBY2NlbGVyYXRpb24pIHJldHVyblxuICAgIHBhZ2UucmVjZW50QWNjZWxlcmF0aW9uVGltZS50ZXh0Q29udGVudCA9IGAke01hdGguZmxvb3IodGhpcy5lYXJseUFjY2VsZXJhdGlvbi50aW1lUGFzdCAvIDYwKX1gXG4gICAgcGFnZS5yZWNlbnRTd2FwVGltZS50ZXh0Q29udGVudCA9IGAke01hdGguZmxvb3IodGhpcy5lYXJseUFjY2VsZXJhdGlvbi50aW1lUGFzdCAvIDYwKX1gXG4gICAgaWYgKHRoaXMuZWFybHlBY2NlbGVyYXRpb24ud2FzQWNjZWxlcmF0aW9uKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnJlY2VudEFjY2VsZXJhdGlvbk1zZylcbiAgICAgIERvYy5oaWRlKHBhZ2UucmVjZW50U3dhcE1zZylcbiAgICAgIHBhZ2UucmVjZW50QWNjZWxlcmF0aW9uVGltZS50ZXh0Q29udGVudCA9IGAke01hdGguZmxvb3IodGhpcy5lYXJseUFjY2VsZXJhdGlvbi50aW1lUGFzdCAvIDYwKX1gXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5zaG93KHBhZ2UucmVjZW50U3dhcE1zZylcbiAgICAgIERvYy5oaWRlKHBhZ2UucmVjZW50QWNjZWxlcmF0aW9uTXNnKVxuICAgICAgcGFnZS5yZWNlbnRTd2FwVGltZS50ZXh0Q29udGVudCA9IGAke01hdGguZmxvb3IodGhpcy5lYXJseUFjY2VsZXJhdGlvbi50aW1lUGFzdCAvIDYwKX1gXG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2UuY29uZmlndXJlQWNjZWxlcmF0aW9uRGl2LCBwYWdlLmFjY2VsZXJhdGVFcnIpXG4gICAgRG9jLnNob3cocGFnZS5lYXJseUFjY2VsZXJhdGlvbkRpdilcbiAgfVxuXG4gIC8vIHNlbmRBY2NlbGVyYXRlUmVxdWVzdCBtYWtlcyBhbiBhY2NlbGVyYXRlIG9yZGVyIHJlcXVlc3QgdG8gdGhlIGNsaWVudFxuICAvLyBiYWNrZW5kLlxuICBhc3luYyBzZW5kQWNjZWxlcmF0ZVJlcXVlc3QgKCkge1xuICAgIGNvbnN0IG9yZGVyID0gdGhpcy5vcmRlclxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBvcmRlcklEOiBvcmRlci5pZCxcbiAgICAgIG5ld1JhdGU6IHRoaXMuYWNjZWxlcmF0ZWRSYXRlXG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5hY2NlbGVyYXRlTWFpbkRpdilcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9hY2NlbGVyYXRlb3JkZXInLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmFjY2VsZXJhdGVUeElELnRleHRDb250ZW50ID0gcmVzLnR4SURcbiAgICAgIERvYy5oaWRlKHBhZ2UuYWNjZWxlcmF0ZU1haW5EaXYsIHBhZ2UucHJlQWNjZWxlcmF0ZUVyciwgcGFnZS5hY2NlbGVyYXRlRXJyKVxuICAgICAgRG9jLnNob3cocGFnZS5hY2NlbGVyYXRlTXNnRGl2LCBwYWdlLmFjY2VsZXJhdGVTdWNjZXNzKVxuICAgICAgdGhpcy5zdWNjZXNzKClcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5hY2NlbGVyYXRlRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfT1JERVJfQUNDRUxFUkFUSU9OX0VSUl9NU0csIHsgbXNnOiByZXMubXNnIH0pXG4gICAgICBEb2MuaGlkZShwYWdlLmVhcmx5QWNjZWxlcmF0aW9uRGl2KVxuICAgICAgRG9jLnNob3cocGFnZS5hY2NlbGVyYXRlRXJyLCBwYWdlLmNvbmZpZ3VyZUFjY2VsZXJhdGlvbkRpdilcbiAgICB9XG4gIH1cblxuICAvLyBzdWJtaXQgaXMgY2FsbGVkIHdoZW4gdGhlIHN1Ym1pdCBidXR0b24gaXMgY2xpY2tlZC5cbiAgYXN5bmMgc3VibWl0ICgpIHtcbiAgICBpZiAodGhpcy5lYXJseUFjY2VsZXJhdGlvbikge1xuICAgICAgdGhpcy5kaXNwbGF5RWFybHlBY2NlbGVyYXRpb25Nc2coKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNlbmRBY2NlbGVyYXRlUmVxdWVzdCgpXG4gICAgfVxuICB9XG5cbiAgLy8gcmVmcmVzaCBzaG91bGQgYmUgY2FsbGVkIGJlZm9yZSB0aGUgZm9ybSBpcyBkaXNwbGF5ZWQuIEl0IG1ha2VzIGFcbiAgLy8gcHJlYWNjZWxlcmF0ZSByZXF1ZXN0IHRvIHRoZSBjbGllbnQgYmFja2VuZCBhbmQgc2V0cyB1cCB0aGUgZm9ybVxuICAvLyBiYXNlZCBvbiB0aGUgcmVzdWx0cy5cbiAgYXN5bmMgcmVmcmVzaCAob3JkZXI6IE9yZGVyKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHRoaXMub3JkZXIgPSBvcmRlclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3ByZWFjY2VsZXJhdGUnLCBvcmRlci5pZClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5wcmVBY2NlbGVyYXRlRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfT1JERVJfQUNDRUxFUkFUSU9OX0VSUl9NU0csIHsgbXNnOiByZXMubXNnIH0pXG4gICAgICBEb2MuaGlkZShwYWdlLmFjY2VsZXJhdGVNYWluRGl2LCBwYWdlLmFjY2VsZXJhdGVTdWNjZXNzKVxuICAgICAgRG9jLnNob3cocGFnZS5hY2NlbGVyYXRlTXNnRGl2LCBwYWdlLnByZUFjY2VsZXJhdGVFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLmhpZGUocGFnZS5hY2NlbGVyYXRlTXNnRGl2LCBwYWdlLnByZUFjY2VsZXJhdGVFcnIsIHBhZ2UuYWNjZWxlcmF0ZUVyciwgcGFnZS5mZWVFc3RpbWF0ZURpdiwgcGFnZS5lYXJseUFjY2VsZXJhdGlvbkRpdilcbiAgICBEb2Muc2hvdyhwYWdlLmFjY2VsZXJhdGVNYWluRGl2LCBwYWdlLmFjY2VsZXJhdGVTdWNjZXNzLCBwYWdlLmNvbmZpZ3VyZUFjY2VsZXJhdGlvbkRpdilcbiAgICBjb25zdCBwcmVBY2NlbGVyYXRlOiBQcmVBY2NlbGVyYXRlID0gcmVzLnByZUFjY2VsZXJhdGVcbiAgICB0aGlzLmVhcmx5QWNjZWxlcmF0aW9uID0gcHJlQWNjZWxlcmF0ZS5lYXJseUFjY2VsZXJhdGlvblxuICAgIHRoaXMuY3VycmVuY3lVbml0ID0gcHJlQWNjZWxlcmF0ZS5zdWdnZXN0ZWRSYW5nZS55VW5pdFxuICAgIHBhZ2UuYWNjZWxlcmF0ZUF2Z0ZlZVJhdGUudGV4dENvbnRlbnQgPSBgJHtwcmVBY2NlbGVyYXRlLnN3YXBSYXRlfSAke3ByZUFjY2VsZXJhdGUuc3VnZ2VzdGVkUmFuZ2UueVVuaXR9YFxuICAgIHBhZ2UuYWNjZWxlcmF0ZUN1cnJlbnRGZWVSYXRlLnRleHRDb250ZW50ID0gYCR7cHJlQWNjZWxlcmF0ZS5zdWdnZXN0ZWRSYXRlfSAke3ByZUFjY2VsZXJhdGUuc3VnZ2VzdGVkUmFuZ2UueVVuaXR9YFxuICAgIHRoaXMuYWNjZWxlcmF0ZWRSYXRlID0gcHJlQWNjZWxlcmF0ZS5zdWdnZXN0ZWRSYW5nZS5zdGFydC55XG4gICAgY29uc3Qgc2VsZWN0ZWQgPSAoKSA9PiB7IC8qIGRvIG5vdGhpbmcgKi8gfVxuICAgIGNvbnN0IHJvdW5kWSA9IHRydWVcbiAgICBjb25zdCB1cGRhdGVSYXRlID0gKF86IG51bWJlciwgbmV3WTogbnVtYmVyKSA9PiB7IHRoaXMuYWNjZWxlcmF0ZWRSYXRlID0gbmV3WSB9XG4gICAgY29uc3QgcmFuZ2VIYW5kbGVyID0gbmV3IFhZUmFuZ2VIYW5kbGVyKHByZUFjY2VsZXJhdGUuc3VnZ2VzdGVkUmFuZ2UsIHByZUFjY2VsZXJhdGUuc3VnZ2VzdGVkUmFuZ2Uuc3RhcnQueCwge1xuICAgICAgdXBkYXRlZDogdXBkYXRlUmF0ZSwgY2hhbmdlZDogKCkgPT4gdGhpcy51cGRhdGVBY2NlbGVyYXRpb25Fc3RpbWF0ZSgpLCBzZWxlY3RlZCwgcm91bmRZXG4gICAgfSlcbiAgICBEb2MuZW1wdHkocGFnZS5zbGlkZXJDb250YWluZXIpXG4gICAgcGFnZS5zbGlkZXJDb250YWluZXIuYXBwZW5kQ2hpbGQocmFuZ2VIYW5kbGVyLmNvbnRyb2wpXG4gICAgdGhpcy51cGRhdGVBY2NlbGVyYXRpb25Fc3RpbWF0ZSgpXG4gIH1cblxuICAvLyB1cGRhdGVBY2NlbGVyYXRpb25Fc3RpbWF0ZSBtYWtlcyBhbiBhY2NlbGVyYXRlIGVzdGltYXRlIHJlcXVlc3QgdG8gdGhlXG4gIC8vIGNsaWVudCBiYWNrZW5kIHVzaW5nIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgcmF0ZSBvbiB0aGUgc2xpZGVyLCBhbmRcbiAgLy8gZGlzcGxheXMgdGhlIHJlc3VsdHMuXG4gIGFzeW5jIHVwZGF0ZUFjY2VsZXJhdGlvbkVzdGltYXRlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLm9yZGVyXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgb3JkZXJJRDogb3JkZXIuaWQsXG4gICAgICBuZXdSYXRlOiB0aGlzLmFjY2VsZXJhdGVkUmF0ZVxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2Uuc2xpZGVyQ29udGFpbmVyKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2FjY2VsZXJhdGlvbmVzdGltYXRlJywgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UuYWNjZWxlcmF0ZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX09SREVSX0FDQ0VMRVJBVElPTl9GRUVfRVJSX01TRywgeyBtc2c6IHJlcy5tc2cgfSlcbiAgICAgIERvYy5zaG93KHBhZ2UuYWNjZWxlcmF0ZUVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBwYWdlLmZlZVJhdGVFc3RpbWF0ZS50ZXh0Q29udGVudCA9IGAke3RoaXMuYWNjZWxlcmF0ZWRSYXRlfSAke3RoaXMuY3VycmVuY3lVbml0fWBcbiAgICBsZXQgYXNzZXRJRFxuICAgIGxldCBhc3NldFN5bWJvbFxuICAgIGlmIChvcmRlci5zZWxsKSB7XG4gICAgICBhc3NldElEID0gb3JkZXIuYmFzZUlEXG4gICAgICBhc3NldFN5bWJvbCA9IG9yZGVyLmJhc2VTeW1ib2xcbiAgICB9IGVsc2Uge1xuICAgICAgYXNzZXRJRCA9IG9yZGVyLnF1b3RlSURcbiAgICAgIGFzc2V0U3ltYm9sID0gb3JkZXIucXVvdGVTeW1ib2xcbiAgICB9XG4gICAgY29uc3QgdW5pdEluZm8gPSBhcHAoKS51bml0SW5mbyhhc3NldElEKVxuICAgIHBhZ2UuZmVlRXN0aW1hdGUudGV4dENvbnRlbnQgPSBgJHtyZXMuZmVlIC8gdW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3J9ICR7YXNzZXRTeW1ib2x9YFxuICAgIERvYy5zaG93KHBhZ2UuZmVlRXN0aW1hdGVEaXYpXG4gIH1cbn1cblxuLyogREVYQWRkcmVzc0Zvcm0gYWNjZXB0cyBhIERFWCBhZGRyZXNzIGFuZCBwZXJmb3JtcyBhY2NvdW50IGRpc2NvdmVyeS4gKi9cbmV4cG9ydCBjbGFzcyBERVhBZGRyZXNzRm9ybSB7XG4gIGZvcm06IEhUTUxFbGVtZW50XG4gIHN1Y2Nlc3M6ICh4YzogRXhjaGFuZ2UsIGNlcnQ6IHN0cmluZykgPT4gdm9pZFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAga25vd25FeGNoYW5nZXM6IEhUTUxFbGVtZW50W11cbiAgZGV4VG9VcGRhdGU/OiBzdHJpbmdcbiAgY2VydFBpY2tlcjogQ2VydGlmaWNhdGVQaWNrZXJcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogSFRNTEVsZW1lbnQsIHN1Y2Nlc3M6ICh4YzogRXhjaGFuZ2UsIGNlcnQ6IHN0cmluZykgPT4gdm9pZCwgZGV4VG9VcGRhdGU/OiBzdHJpbmcpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGZvcm0pXG5cbiAgICB0aGlzLmNlcnRQaWNrZXIgPSBuZXcgQ2VydGlmaWNhdGVQaWNrZXIoZm9ybSlcblxuICAgIERvYy5iaW5kKHBhZ2Uuc2tpcFJlZ2lzdHJhdGlvbiwgJ2NoYW5nZScsICgpID0+IHRoaXMuc2hvd09ySGlkZVN1Ym1pdEJ0dG4oKSlcbiAgICBEb2MuYmluZChwYWdlLnNob3dDdXN0b20sICdjbGljaycsICgpID0+IHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uuc2hvd0N1c3RvbSlcbiAgICAgIERvYy5zaG93KHBhZ2UuY3VzdG9tQm94LCBwYWdlLmF1dGgpXG4gICAgfSlcblxuICAgIHRoaXMua25vd25FeGNoYW5nZXMgPSBBcnJheS5mcm9tKHBhZ2Uua25vd25YQ3MucXVlcnlTZWxlY3RvckFsbCgnLmtub3duLWV4Y2hhbmdlJykpXG4gICAgZm9yIChjb25zdCBkaXYgb2YgdGhpcy5rbm93bkV4Y2hhbmdlcykge1xuICAgICAgRG9jLmJpbmQoZGl2LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGhvc3QgPSBkaXYuZGF0YXNldC5ob3N0XG4gICAgICAgIGZvciAoY29uc3QgZCBvZiB0aGlzLmtub3duRXhjaGFuZ2VzKSBkLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tERVgoaG9zdClcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgYmluZChmb3JtLCBwYWdlLnN1Ym1pdCwgKCkgPT4gdGhpcy5jaGVja0RFWCgpKVxuXG4gICAgaWYgKGRleFRvVXBkYXRlKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLmFkZERleEhkciwgcGFnZS5za2lwUmVnaXN0cmF0aW9uQm94KVxuICAgICAgRG9jLnNob3cocGFnZS51cGRhdGVEZXhIZHIpXG4gICAgICB0aGlzLmRleFRvVXBkYXRlID0gZGV4VG9VcGRhdGVcbiAgICB9XG5cbiAgICB0aGlzLnJlZnJlc2goKVxuICB9XG5cbiAgcmVmcmVzaCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UuYWRkci52YWx1ZSA9ICcnXG4gICAgdGhpcy5jZXJ0UGlja2VyLmNsZWFyQ2VydEZpbGUoKVxuICAgIERvYy5oaWRlKHBhZ2UuZXJyKVxuICAgIGlmICh0aGlzLmtub3duRXhjaGFuZ2VzLmxlbmd0aCA9PT0gMCB8fCB0aGlzLmRleFRvVXBkYXRlKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLmN1c3RvbUJveCwgcGFnZS5hdXRoKVxuICAgICAgRG9jLmhpZGUocGFnZS5zaG93Q3VzdG9tLCBwYWdlLmtub3duWENzLCBwYWdlLnBpY2tTZXJ2ZXJNc2csIHBhZ2UuYWRkQ3VzdG9tTXNnKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2MuaGlkZShwYWdlLmN1c3RvbUJveClcbiAgICAgIERvYy5zaG93KHBhZ2Uuc2hvd0N1c3RvbSlcbiAgICB9XG4gICAgZm9yIChjb25zdCBkaXYgb2YgdGhpcy5rbm93bkV4Y2hhbmdlcykgZGl2LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICB0aGlzLnNob3dPckhpZGVTdWJtaXRCdHRuKClcbiAgfVxuXG4gIC8qKlxuICAgKiBTaG93IG9yIGhpZGUgYXBwUFdCb3ggZGVwZW5kaW5nIG9uIGlmIHBhc3N3b3JkIGlzIHJlcXVpcmVkLiBTaG93IHRoZVxuICAgKiBzdWJtaXQgYnV0dG9uIGlmIGNvbm5lY3RpbmcgYSBjdXN0b20gc2VydmVyIG9yIHBhc3N3b3JkIGlzIHJlcXVpcmVkKS5cbiAgICovXG4gIHNob3dPckhpZGVTdWJtaXRCdHRuICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLnNldFZpcyhEb2MuaXNEaXNwbGF5ZWQocGFnZS5jdXN0b21Cb3gpLCBwYWdlLmF1dGgpXG4gIH1cblxuICBza2lwUmVnaXN0cmF0aW9uICgpIDogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucGFnZS5za2lwUmVnaXN0cmF0aW9uLmNoZWNrZWQgPz8gZmFsc2VcbiAgfVxuXG4gIC8qIEp1c3QgYSBzbWFsbCBzaXplIHR3ZWFrIGFuZCBmYWRlLWluLiAqL1xuICBhc3luYyBhbmltYXRlICgpIHtcbiAgICBjb25zdCBmb3JtID0gdGhpcy5mb3JtXG4gICAgRG9jLmFuaW1hdGUoNTUwLCBwcm9nID0+IHtcbiAgICAgIGZvcm0uc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7MC45ICsgMC4xICogcHJvZ30pYFxuICAgICAgZm9ybS5zdHlsZS5vcGFjaXR5ID0gU3RyaW5nKE1hdGgucG93KHByb2csIDQpKVxuICAgIH0sICdlYXNlT3V0JylcbiAgfVxuXG4gIGFzeW5jIGNoZWNrREVYIChhZGRyPzogc3RyaW5nKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuZXJyKVxuICAgIGFkZHIgPSBhZGRyIHx8IHBhZ2UuYWRkci52YWx1ZVxuICAgIGlmIChhZGRyID09PSAnJykge1xuICAgICAgcGFnZS5lcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9FTVBUWV9ERVhfQUREUkVTU19NU0cpXG4gICAgICBEb2Muc2hvdyhwYWdlLmVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBjZXJ0ID0gYXdhaXQgdGhpcy5jZXJ0UGlja2VyLmZpbGUoKVxuICAgIGNvbnN0IHNraXBSZWdpc3RyYXRpb24gPSB0aGlzLnNraXBSZWdpc3RyYXRpb24oKVxuICAgIGxldCBlbmRwb2ludCA6IHN0cmluZywgcmVxOiBhbnlcbiAgICBpZiAodGhpcy5kZXhUb1VwZGF0ZSkge1xuICAgICAgZW5kcG9pbnQgPSAnL2FwaS91cGRhdGVkZXhob3N0J1xuICAgICAgcmVxID0ge1xuICAgICAgICBuZXdIb3N0OiBhZGRyLFxuICAgICAgICBjZXJ0OiBjZXJ0LFxuICAgICAgICBvbGRIb3N0OiB0aGlzLmRleFRvVXBkYXRlXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGVuZHBvaW50ID0gc2tpcFJlZ2lzdHJhdGlvbiA/ICcvYXBpL2FkZGRleCcgOiAnL2FwaS9kaXNjb3ZlcmFjY3QnXG4gICAgICByZXEgPSB7XG4gICAgICAgIGFkZHI6IGFkZHIsXG4gICAgICAgIGNlcnQ6IGNlcnRcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTihlbmRwb2ludCwgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGlmIChTdHJpbmcocmVzLm1zZykuaW5jbHVkZXMoJ2NlcnRpZmljYXRlIHJlcXVpcmVkJykpIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS5uZWVkQ2VydClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhZ2UuZXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgICBEb2Muc2hvdyhwYWdlLmVycilcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIGlmICghdGhpcy5kZXhUb1VwZGF0ZSAmJiAoc2tpcFJlZ2lzdHJhdGlvbiB8fCByZXMucGFpZCB8fCBPYmplY3Qua2V5cyhyZXMueGMuYXV0aC5wZW5kaW5nQm9uZHMpLmxlbmd0aCA+IDApKSB7XG4gICAgICBhd2FpdCBhcHAoKS5sb2FkUGFnZSgnbWFya2V0cycpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zdWNjZXNzKHJlcy54YywgY2VydClcbiAgfVxufVxuXG4vKiBEaXNjb3ZlckFjY291bnRGb3JtIHBlcmZvcm1zIGFjY291bnQgZGlzY292ZXJ5IGZvciBhIHByZS1zZWxlY3RlZCBERVguICovXG5leHBvcnQgY2xhc3MgRGlzY292ZXJBY2NvdW50Rm9ybSB7XG4gIGZvcm06IEhUTUxFbGVtZW50XG4gIGFkZHI6IHN0cmluZ1xuICBzdWNjZXNzOiAoeGM6IEV4Y2hhbmdlKSA9PiB2b2lkXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBIVE1MRWxlbWVudCwgYWRkcjogc3RyaW5nLCBzdWNjZXNzOiAoeGM6IEV4Y2hhbmdlKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIHRoaXMuYWRkciA9IGFkZHJcbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG5cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUoZm9ybSlcbiAgICBwYWdlLmRleEhvc3QudGV4dENvbnRlbnQgPSBhZGRyXG4gICAgYmluZChmb3JtLCBwYWdlLnN1Ym1pdCwgKCkgPT4gdGhpcy5jaGVja0RFWCgpKVxuICB9XG5cbiAgLyogSnVzdCBhIHNtYWxsIHNpemUgdHdlYWsgYW5kIGZhZGUtaW4uICovXG4gIGFzeW5jIGFuaW1hdGUgKCkge1xuICAgIGNvbnN0IGZvcm0gPSB0aGlzLmZvcm1cbiAgICBEb2MuYW5pbWF0ZSg1NTAsIHByb2cgPT4ge1xuICAgICAgZm9ybS5zdHlsZS50cmFuc2Zvcm0gPSBgc2NhbGUoJHswLjkgKyAwLjEgKiBwcm9nfSlgXG4gICAgICBmb3JtLnN0eWxlLm9wYWNpdHkgPSBTdHJpbmcoTWF0aC5wb3cocHJvZywgNCkpXG4gICAgfSwgJ2Vhc2VPdXQnKVxuICB9XG5cbiAgYXN5bmMgY2hlY2tERVggKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmVycilcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBhZGRyOiB0aGlzLmFkZHJcbiAgICB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvZGlzY292ZXJhY2N0JywgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UuZXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5lcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHJlcy5wYWlkKSB7XG4gICAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgICAgYXdhaXQgYXBwKCkubG9hZFBhZ2UoJ21hcmtldHMnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuc3VjY2VzcyhyZXMueGMpXG4gIH1cbn1cblxuLyogTG9naW5Gb3JtIGlzIHVzZWQgdG8gc2lnbiBpbnRvIHRoZSBhcHAuICovXG5leHBvcnQgY2xhc3MgTG9naW5Gb3JtIHtcbiAgZm9ybTogSFRNTEVsZW1lbnRcbiAgc3VjY2VzczogKCkgPT4gdm9pZFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cblxuICBjb25zdHJ1Y3RvciAoZm9ybTogSFRNTEVsZW1lbnQsIHN1Y2Nlc3M6ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShmb3JtKVxuICAgIGJpbmQoZm9ybSwgcGFnZS5zdWJtaXQsICgpID0+IHsgdGhpcy5zdWJtaXQoKSB9KVxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBsb2dpbjogKG5vdGU6IENvcmVOb3RlKSA9PiB7IHRoaXMuaGFuZGxlTG9naW5Ob3RlKG5vdGUpIH1cbiAgICB9KVxuICB9XG5cbiAgaGFuZGxlTG9naW5Ob3RlIChuOiBDb3JlTm90ZSkge1xuICAgIGlmIChuLmRldGFpbHMgPT09ICcnKSByZXR1cm5cbiAgICBjb25zdCBsb2dpbk1zZyA9IERvYy5pZGVsKHRoaXMuZm9ybSwgJ2xvYWRlck1zZycpXG4gICAgRG9jLnNob3cobG9naW5Nc2cpXG4gICAgaWYgKGxvZ2luTXNnKSBsb2dpbk1zZy50ZXh0Q29udGVudCA9IG4uZGV0YWlsc1xuICB9XG5cbiAgZm9jdXMgKCkge1xuICAgIHRoaXMucGFnZS5wdy5mb2N1cygpXG4gIH1cblxuICByZWZyZXNoICgpIHtcbiAgICBEb2MuaGlkZSh0aGlzLnBhZ2UuZXJyTXNnKVxuICAgIHRoaXMucGFnZS5wdy52YWx1ZSA9ICcnXG4gIH1cblxuICBhc3luYyBzdWJtaXQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmVyck1zZylcbiAgICBjb25zdCBwdyA9IHBhZ2UucHcudmFsdWUgfHwgJydcbiAgICBpZiAocHcgPT09ICcnKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmVyck1zZywgaW50bC5wcmVwKGludGwuSURfTk9fUEFTU19FUlJPUl9NU0cpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5mb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2xvZ2luJywgeyBwYXNzOiBwdyB9KVxuICAgIGxvYWRlZCgpXG4gICAgcGFnZS5wdy52YWx1ZSA9ICcnXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuZXJyTXNnLCByZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgcmVzLm5vdGVzID0gcmVzLm5vdGVzIHx8IFtdXG4gICAgcmVzLm5vdGVzLnJldmVyc2UoKVxuICAgIHJlcy5wb2tlcyA9IHJlcy5wb2tlcyB8fCBbXVxuICAgIGFwcCgpLmxvZ2dlZEluKHJlcy5ub3RlcywgcmVzLnBva2VzKVxuICAgIHRoaXMuc3VjY2VzcygpXG4gIH1cblxuICAvKiBKdXN0IGEgc21hbGwgc2l6ZSB0d2VhayBhbmQgZmFkZS1pbi4gKi9cbiAgYXN5bmMgYW5pbWF0ZSAoKSB7XG4gICAgY29uc3QgZm9ybSA9IHRoaXMuZm9ybVxuICAgIERvYy5hbmltYXRlKDU1MCwgcHJvZyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnRyYW5zZm9ybSA9IGBzY2FsZSgkezAuOSArIDAuMSAqIHByb2d9KWBcbiAgICAgIGZvcm0uc3R5bGUub3BhY2l0eSA9IFN0cmluZyhNYXRoLnBvdyhwcm9nLCA0KSlcbiAgICB9LCAnZWFzZU91dCcpXG4gIH1cbn1cblxuY29uc3QgdHJhaXROZXdBZGRyZXNzZXIgPSAxIDw8IDFcblxuLypcbiAqIERlcG9zaXRBZGRyZXNzIGRpc3BsYXlzIGEgZGVwb3NpdCBhZGRyZXNzLCBhIFFSIGNvZGUsIGFuZCBhIGJ1dHRvbiB0b1xuICogZ2VuZXJhdGUgYSBuZXcgYWRkcmVzcyAoaWYgc3VwcG9ydGVkKS5cbiAqL1xuZXhwb3J0IGNsYXNzIERlcG9zaXRBZGRyZXNzIHtcbiAgZm9ybTogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGFzc2V0SUQ6IG51bWJlclxuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBQYWdlRWxlbWVudCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoZm9ybSlcbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXMocGFnZS51bmlmaWVkUmVjZWl2ZXJUbXBsKVxuICAgIERvYy5iaW5kKHBhZ2UubmV3RGVwQWRkckJ0dG4sICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5uZXdEZXBvc2l0QWRkcmVzcygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5jb3B5QWRkcmVzc0J0biwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmNvcHlBZGRyZXNzKCkgfSlcbiAgfVxuXG4gIC8qIERpc3BsYXkgYSBkZXBvc2l0IGFkZHJlc3MuICovXG4gIGFzeW5jIHNldEFzc2V0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICB0aGlzLmFzc2V0SUQgPSBhc3NldElEXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuZGVwb3NpdEVyciwgcGFnZS5kZXBvc2l0VG9rZW5Nc2dCb3gpXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICBwYWdlLmRlcG9zaXRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChhc3NldC5zeW1ib2wpXG4gICAgY29uc3Qgd2FsbGV0ID0gYXBwKCkud2FsbGV0TWFwW2Fzc2V0SURdXG4gICAgcGFnZS5kZXBvc2l0TmFtZS50ZXh0Q29udGVudCA9IGFzc2V0LnVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XG4gICAgaWYgKGFzc2V0LnRva2VuKSB7XG4gICAgICBjb25zdCBwYXJlbnRBc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgICAgIHBhZ2UuZGVwb3NpdFRva2VuUGFyZW50TG9nby5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50QXNzZXQuc3ltYm9sKVxuICAgICAgcGFnZS5kZXBvc2l0VG9rZW5QYXJlbnROYW1lLnRleHRDb250ZW50ID0gcGFyZW50QXNzZXQubmFtZVxuICAgICAgRG9jLnNob3cocGFnZS5kZXBvc2l0VG9rZW5Nc2dCb3gpXG4gICAgfVxuICAgIERvYy5zZXRWaXMoKHdhbGxldC50cmFpdHMgJiB0cmFpdE5ld0FkZHJlc3NlcikgIT09IDAsIHBhZ2UubmV3RGVwQWRkckJ0dG5Cb3gpXG4gICAgdGhpcy5zZXRBZGRyZXNzKHdhbGxldC5hZGRyZXNzKVxuICB9XG5cbiAgc2V0QWRkcmVzcyAoYWRkcjogc3RyaW5nKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UudW5pZmllZFJlY2VpdmVycylcbiAgICBpZiAoYWRkci5zdGFydHNXaXRoKCd1bmlmaWVkOicpKSB7XG4gICAgICBjb25zdCByZWNlaXZlcnMgPSBKU09OLnBhcnNlKGFkZHIuc3Vic3RyaW5nKCd1bmlmaWVkOicubGVuZ3RoKSkgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICAgICAgRG9jLmVtcHR5KHBhZ2UudW5pZmllZFJlY2VpdmVycylcbiAgICAgIERvYy5zaG93KHBhZ2UudW5pZmllZFJlY2VpdmVycylcbiAgICAgIGNvbnN0IGRlZmF1bHRSZWNlaXZlclR5cGUgPSAndW5pZmllZCdcbiAgICAgIGZvciAoY29uc3QgW3JlY3ZUeXBlLCByZWN2XSBvZiBPYmplY3QuZW50cmllcyhyZWNlaXZlcnMpKSB7XG4gICAgICAgIGNvbnN0IGRpdiA9IHBhZ2UudW5pZmllZFJlY2VpdmVyVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgICAgcGFnZS51bmlmaWVkUmVjZWl2ZXJzLmFwcGVuZENoaWxkKGRpdilcbiAgICAgICAgZGl2LnRleHRDb250ZW50ID0gcmVjdlR5cGVcbiAgICAgICAgZGl2LmRhdGFzZXQudHlwZSA9IHJlY3ZUeXBlXG4gICAgICAgIGlmIChyZWN2VHlwZSA9PT0gZGVmYXVsdFJlY2VpdmVyVHlwZSkgZGl2LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgICAgLy8gdG1wbC5hZGRyLnRleHRDb250ZW50ID0gcmVjdlxuICAgICAgICBEb2MuYmluZChkaXYsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGJ0dG4gb2YgKEFycmF5LmZyb20ocGFnZS51bmlmaWVkUmVjZWl2ZXJzLmNoaWxkcmVuKSBhcyBQYWdlRWxlbWVudFtdKSkgYnR0bi5jbGFzc0xpc3QudG9nZ2xlKCdzZWxlY3RlZCcsIGJ0dG4uZGF0YXNldC50eXBlID09PSByZWN2VHlwZSlcbiAgICAgICAgICB0aGlzLnNldENlbnRyYWxBZGRyZXNzKHJlY3YpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgICBhZGRyID0gcmVjZWl2ZXJzLnVuaWZpZWRcbiAgICB9XG5cbiAgICB0aGlzLnNldENlbnRyYWxBZGRyZXNzKGFkZHIpXG4gIH1cblxuICBzZXRDZW50cmFsQWRkcmVzcyAoYWRkcjogc3RyaW5nKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UuZGVwb3NpdEFkZHJlc3MudGV4dENvbnRlbnQgPSBhZGRyXG4gICAgcGFnZS5xcmNvZGUuc3JjID0gYC9nZW5lcmF0ZXFyY29kZT9hZGRyZXNzPSR7YWRkcn1gXG4gIH1cblxuICAvKiBGZXRjaCBhIG5ldyBhZGRyZXNzIGZyb20gdGhlIHdhbGxldC4gKi9cbiAgYXN5bmMgbmV3RGVwb3NpdEFkZHJlc3MgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgYXNzZXRJRCwgZm9ybSB9ID0gdGhpc1xuICAgIERvYy5oaWRlKHBhZ2UuZGVwb3NpdEVycilcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKGZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvZGVwb3NpdGFkZHJlc3MnLCB7XG4gICAgICBhc3NldElEOiBhc3NldElEXG4gICAgfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmRlcG9zaXRFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLmRlcG9zaXRFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgYXBwKCkud2FsbGV0TWFwW2Fzc2V0SURdLmFkZHJlc3MgPSByZXMuYWRkcmVzc1xuICAgIHRoaXMuc2V0QWRkcmVzcyhyZXMuYWRkcmVzcylcbiAgfVxuXG4gIGFzeW5jIGNvcHlBZGRyZXNzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQocGFnZS5kZXBvc2l0QWRkcmVzcy50ZXh0Q29udGVudCB8fCAnJylcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgRG9jLnNob3cocGFnZS5jb3B5QWxlcnQpXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIERvYy5oaWRlKHBhZ2UuY29weUFsZXJ0KVxuICAgICAgICB9LCA4MDApXG4gICAgICB9KVxuICAgICAgLmNhdGNoKChyZWFzb24pID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcignVW5hYmxlIHRvIGNvcHk6ICcsIHJlYXNvbilcbiAgICAgIH0pXG4gIH1cbn1cblxuLy8gQXBwUGFzc1Jlc2V0Rm9ybSBpcyB1c2VkIHRvIHJlc2V0IHRoZSBhcHAgYXBzc3dvcmQgdXNpbmcgdGhlIGFwcCBzZWVkLlxuZXhwb3J0IGNsYXNzIEFwcFBhc3NSZXNldEZvcm0ge1xuICBmb3JtOiBQYWdlRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgc3VjY2VzczogKCkgPT4gdm9pZFxuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBQYWdlRWxlbWVudCwgc3VjY2VzczogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGZvcm0pXG4gICAgYmluZChmb3JtLCBwYWdlLnJlc2V0QXBwUFdTdWJtaXRCdG4sICgpID0+IHRoaXMucmVzZXRBcHBQVygpKVxuICB9XG5cbiAgYXN5bmMgcmVzZXRBcHBQVyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IG5ld0FwcFBXID0gcGFnZS5uZXdBcHBQYXNzd29yZC52YWx1ZSB8fCAnJ1xuICAgIGNvbnN0IGNvbmZpcm1OZXdBcHBQVyA9IHBhZ2UuY29uZmlybU5ld0FwcFBhc3N3b3JkLnZhbHVlXG4gICAgaWYgKG5ld0FwcFBXID09PSAnJykge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5hcHBQV1Jlc2V0RXJyTXNnLCBpbnRsLnByZXAoaW50bC5JRF9OT19QQVNTX0VSUk9SX01TRykpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKG5ld0FwcFBXICE9PSBjb25maXJtTmV3QXBwUFcpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuYXBwUFdSZXNldEVyck1zZywgaW50bC5wcmVwKGludGwuSURfUEFTU1dPUkRfTk9UX01BVENIKSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5mb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3Jlc2V0YXBwcGFzc3dvcmQnLCB7XG4gICAgICBuZXdQYXNzOiBuZXdBcHBQVyxcbiAgICAgIHNlZWQ6IHBhZ2Uuc2VlZElucHV0LnZhbHVlXG4gICAgfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmFwcFBXUmVzZXRFcnJNc2csIHJlcy5tc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBpZiAoRG9jLmlzRGlzcGxheWVkKHBhZ2UuYXBwUFdSZXNldEVyck1zZykpIERvYy5oaWRlKHBhZ2UuYXBwUFdSZXNldEVyck1zZylcbiAgICBwYWdlLmFwcFBXUmVzZXRTdWNjZXNzTXNnLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfUEFTU1dPUkRfUkVTRVRfU1VDQ0VTU19NU0cpXG4gICAgRG9jLnNob3cocGFnZS5hcHBQV1Jlc2V0U3VjY2Vzc01zZylcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuc3VjY2VzcygpLCAzMDAwKSAvLyBhbGxvdyB0aW1lIHRvIHZpZXcgdGhlIG1lc3NhZ2VcbiAgfVxuXG4gIGZvY3VzICgpIHtcbiAgICB0aGlzLnBhZ2UubmV3QXBwUGFzc3dvcmQuZm9jdXMoKVxuICB9XG5cbiAgcmVmcmVzaCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UubmV3QXBwUGFzc3dvcmQudmFsdWUgPSAnJ1xuICAgIHBhZ2UuY29uZmlybU5ld0FwcFBhc3N3b3JkLnZhbHVlID0gJydcbiAgICBwYWdlLnNlZWRJbnB1dC52YWx1ZSA9ICcnXG4gICAgRG9jLmhpZGUocGFnZS5hcHBQV1Jlc2V0U3VjY2Vzc01zZywgcGFnZS5hcHBQV1Jlc2V0RXJyTXNnKVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDZXJ0aWZpY2F0ZVBpY2tlciB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuXG4gIGNvbnN0cnVjdG9yIChwYXJlbnQ6IFBhZ2VFbGVtZW50KSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKHBhcmVudClcbiAgICBwYWdlLnNlbGVjdGVkQ2VydC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PTkVfU0VMRUNURUQpXG4gICAgRG9jLmJpbmQocGFnZS5jZXJ0RmlsZSwgJ2NoYW5nZScsICgpID0+IHRoaXMub25DZXJ0RmlsZUNoYW5nZSgpKVxuICAgIERvYy5iaW5kKHBhZ2UucmVtb3ZlQ2VydCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5jbGVhckNlcnRGaWxlKCkpXG4gICAgRG9jLmJpbmQocGFnZS5hZGRDZXJ0LCAnY2xpY2snLCAoKSA9PiBwYWdlLmNlcnRGaWxlLmNsaWNrKCkpXG4gIH1cblxuICAvKipcbiAgICogb25DZXJ0RmlsZUNoYW5nZSB3aGVuIHRoZSBpbnB1dCBjZXJ0RmlsZSBjaGFuZ2VkLCByZWFkIHRoZSBmaWxlXG4gICAqIGFuZCBzZXR0aW5nIGNlcnQgbmFtZSBpbnRvIHRleHQgb2Ygc2VsZWN0ZWRDZXJ0IHRvIGRpc3BsYXkgb24gdGhlIHZpZXdcbiAgICovXG4gIGFzeW5jIG9uQ2VydEZpbGVDaGFuZ2UgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBmaWxlcyA9IHBhZ2UuY2VydEZpbGUuZmlsZXNcbiAgICBpZiAoIWZpbGVzIHx8ICFmaWxlcy5sZW5ndGgpIHJldHVyblxuICAgIHBhZ2Uuc2VsZWN0ZWRDZXJ0LnRleHRDb250ZW50ID0gZmlsZXNbMF0ubmFtZVxuICAgIERvYy5zaG93KHBhZ2UucmVtb3ZlQ2VydClcbiAgICBEb2MuaGlkZShwYWdlLmFkZENlcnQpXG4gIH1cblxuICAvKiBjbGVhckNlcnRGaWxlIGNsZWFudXAgY2VydEZpbGUgdmFsdWUgYW5kIHNlbGVjdGVkQ2VydCB0ZXh0ICovXG4gIGNsZWFyQ2VydEZpbGUgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLmNlcnRGaWxlLnZhbHVlID0gJydcbiAgICBwYWdlLnNlbGVjdGVkQ2VydC50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PTkVfU0VMRUNURUQpXG4gICAgRG9jLmhpZGUocGFnZS5yZW1vdmVDZXJ0KVxuICAgIERvYy5zaG93KHBhZ2UuYWRkQ2VydClcbiAgfVxuXG4gIGFzeW5jIGZpbGUgKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGlmIChwYWdlLmNlcnRGaWxlLnZhbHVlKSB7XG4gICAgICBjb25zdCBmaWxlcyA9IHBhZ2UuY2VydEZpbGUuZmlsZXNcbiAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGZpbGVzWzBdLnRleHQoKVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gJydcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVG9rZW5BcHByb3ZhbEZvcm0ge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgc3VjY2Vzcz86ICgpID0+IHZvaWRcbiAgYXNzZXRJRDogbnVtYmVyXG4gIHBhcmVudElEOiBudW1iZXJcbiAgdHhGZWU6IG51bWJlclxuICBob3N0OiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAocGFyZW50OiBQYWdlRWxlbWVudCwgc3VjY2Vzcz86ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShwYXJlbnQpXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIERvYy5iaW5kKHRoaXMucGFnZS5zdWJtaXQsICdjbGljaycsICgpID0+IHsgdGhpcy5hcHByb3ZlKCkgfSlcbiAgfVxuXG4gIGFzeW5jIHNldEFzc2V0IChhc3NldElEOiBudW1iZXIsIGhvc3Q6IHN0cmluZykge1xuICAgIHRoaXMuYXNzZXRJRCA9IGFzc2V0SURcbiAgICB0aGlzLmhvc3QgPSBob3N0XG4gICAgY29uc3QgdG9rZW5Bc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHBhcmVudElEID0gdGhpcy5wYXJlbnRJRCA9IHRva2VuQXNzZXQudG9rZW4/LnBhcmVudElEIGFzIG51bWJlclxuICAgIGNvbnN0IHsgcGFnZSB9ID0gdGhpc1xuXG4gICAgRG9jLnNob3cocGFnZS5zdWJtaXNzaW9uRWxlbWVudHMpXG4gICAgRG9jLmhpZGUocGFnZS50eE1zZywgcGFnZS5lcnJNc2csIHBhZ2UuYWRkcmVzc0JveCwgcGFnZS5iYWxhbmNlQm94LCBwYWdlLmFkZHJlc3NCb3gpXG5cbiAgICBEb2MuZW1wdHkocGFnZS50b2tlblN5bWJvbClcbiAgICBwYWdlLnRva2VuU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUodG9rZW5Bc3NldCwgdHJ1ZSkpXG4gICAgY29uc3QgcHJvdG9jb2xWZXJzaW9uID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdLmFzc2V0c1thc3NldElEXS52ZXJzaW9uXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvYXBwcm92ZXRva2VuZmVlJywge1xuICAgICAgYXNzZXRJRDogdG9rZW5Bc3NldC5pZCxcbiAgICAgIHZlcnNpb246IHByb3RvY29sVmVyc2lvbixcbiAgICAgIGFwcHJvdmluZzogdHJ1ZVxuICAgIH0pXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UuZXJyTXNnLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS5lcnJNc2cpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHsgdW5pdEluZm86IHVpLCB3YWxsZXQ6IHsgYWRkcmVzcywgYmFsYW5jZTogeyBhdmFpbGFibGU6IGF2YWlsIH0gfSwgbmFtZTogcGFyZW50TmFtZSB9ID0gYXBwKCkuYXNzZXRzW3BhcmVudElEXVxuICAgICAgY29uc3QgdHhGZWUgPSB0aGlzLnR4RmVlID0gcmVzLnR4RmVlIGFzIG51bWJlclxuICAgICAgbGV0IGZlZVRleHQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKHR4RmVlLCB1aSl9ICR7dWkuY29udmVudGlvbmFsLnVuaXR9YFxuICAgICAgY29uc3QgcmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtwYXJlbnRJRF1cbiAgICAgIGlmIChyYXRlKSB7XG4gICAgICAgIGZlZVRleHQgKz0gYCAoJHtEb2MuZm9ybWF0RmlhdENvbnZlcnNpb24odHhGZWUsIHJhdGUsIHVpKX0gVVNEKWBcbiAgICAgIH1cbiAgICAgIHBhZ2UuZmVlRXN0aW1hdGUudGV4dENvbnRlbnQgPSBmZWVUZXh0XG4gICAgICBEb2Muc2hvdyhwYWdlLmJhbGFuY2VCb3gpXG4gICAgICBwYWdlLmJhbGFuY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGF2YWlsLCB1aSlcbiAgICAgIHBhZ2UucGFyZW50VGlja2VyLnRleHRDb250ZW50ID0gdWkuY29udmVudGlvbmFsLnVuaXRcbiAgICAgIHBhZ2UucGFyZW50TmFtZS50ZXh0Q29udGVudCA9IHBhcmVudE5hbWVcbiAgICAgIGlmIChhdmFpbCA8IHR4RmVlKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UuYWRkcmVzc0JveClcbiAgICAgICAgcGFnZS5hZGRyZXNzLnRleHRDb250ZW50ID0gYWRkcmVzc1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGFwcHJvdmUgY2FsbHMgdGhlIC9hcGkvYXBwcm92ZXRva2VuIGVuZHBvaW50LlxuICAgKi9cbiAgYXN5bmMgYXBwcm92ZSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBhc3NldElELCBob3N0LCBzdWNjZXNzIH0gPSB0aGlzXG4gICAgY29uc3QgcGF0aCA9ICcvYXBpL2FwcHJvdmV0b2tlbidcbiAgICBjb25zdCB0b2tlbkFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04ocGF0aCwge1xuICAgICAgYXNzZXRJRDogdG9rZW5Bc3NldC5pZCxcbiAgICAgIGRleEFkZHI6IGhvc3RcbiAgICB9KVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmVyck1zZy50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UuZXJyTXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHBhZ2UudHhpZC5pbm5lclRleHQgPSByZXMudHhJRFxuICAgIGNvbnN0IGFzc2V0RXhwbG9yZXIgPSBDb2luRXhwbG9yZXJzW3Rva2VuQXNzZXQuaWRdXG4gICAgaWYgKGFzc2V0RXhwbG9yZXIgJiYgYXNzZXRFeHBsb3JlclthcHAoKS51c2VyLm5ldF0pIHtcbiAgICAgIHBhZ2UudHhpZC5ocmVmID0gYXNzZXRFeHBsb3JlclthcHAoKS51c2VyLm5ldF0ocmVzLnR4SUQpXG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2Uuc3VibWlzc2lvbkVsZW1lbnRzLCBwYWdlLmJhbGFuY2VCb3gsIHBhZ2UuYWRkcmVzc0JveClcbiAgICBEb2Muc2hvdyhwYWdlLnR4TXNnKVxuICAgIGlmIChzdWNjZXNzKSBzdWNjZXNzKClcbiAgfVxuXG4gIGhhbmRsZUJhbGFuY2VOb3RlIChuOiBCYWxhbmNlTm90ZSkge1xuICAgIGNvbnN0IHsgcGFnZSwgcGFyZW50SUQsIHR4RmVlIH0gPSB0aGlzXG4gICAgaWYgKG4uYXNzZXRJRCAhPT0gcGFyZW50SUQpIHJldHVyblxuICAgIHBhZ2UuYmFsYW5jZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobi5iYWxhbmNlLmF2YWlsYWJsZSwgYXBwKCkuYXNzZXRzW3BhcmVudElEXS51bml0SW5mbylcbiAgICBpZiAobi5iYWxhbmNlLmF2YWlsYWJsZSA+PSB0eEZlZSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5hZGRyZXNzQm94KVxuICAgIH0gZWxzZSBEb2MuaGlkZShwYWdlLmVyck1zZylcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ0VYQ29uZmlndXJhdGlvbkZvcm0ge1xuICBmb3JtOiBQYWdlRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgc3VjY2VzczogKGNleE5hbWU6IHN0cmluZykgPT4gdm9pZFxuICBjZXhOYW1lOiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogUGFnZUVsZW1lbnQsIHN1Y2Nlc3M6IChjZXhOYW1lOiBzdHJpbmcpID0+IHZvaWQpIHtcbiAgICB0aGlzLmZvcm0gPSBmb3JtXG4gICAgdGhpcy5zdWNjZXNzID0gc3VjY2Vzc1xuICAgIHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGZvcm0pXG5cbiAgICBEb2MuYmluZCh0aGlzLnBhZ2UuY2V4U3VibWl0LCAnY2xpY2snLCAoKSA9PiB0aGlzLnN1Ym1pdCgpKVxuICB9XG5cbiAgc2V0Q0VYIChjZXhOYW1lOiBzdHJpbmcpIHtcbiAgICB0aGlzLmNleE5hbWUgPSBjZXhOYW1lXG4gICAgc2V0Q2V4RWxlbWVudHModGhpcy5mb3JtLCBjZXhOYW1lKVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmNleENvbmZpZ1Byb21wdCwgcGFnZS5jZXhDb25uZWN0RXJyQm94LCBwYWdlLmNleEZvcm1FcnIpXG4gICAgcGFnZS5jZXhBcGlLZXlJbnB1dC52YWx1ZSA9ICcnXG4gICAgcGFnZS5jZXhTZWNyZXRJbnB1dC52YWx1ZSA9ICcnXG4gICAgY29uc3QgY2V4U3RhdHVzID0gYXBwKCkubW1TdGF0dXMuY2V4ZXNbY2V4TmFtZV1cbiAgICBjb25zdCBjb25uZWN0RXJyID0gY2V4U3RhdHVzPy5jb25uZWN0RXJyXG4gICAgaWYgKGNvbm5lY3RFcnIpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuY2V4Q29ubmVjdEVyckJveClcbiAgICAgIHBhZ2UuY2V4Q29ubmVjdEVyci50ZXh0Q29udGVudCA9IGNvbm5lY3RFcnJcbiAgICAgIHBhZ2UuY2V4QXBpS2V5SW5wdXQudmFsdWUgPSBjZXhTdGF0dXMuY29uZmlnLmFwaUtleVxuICAgICAgcGFnZS5jZXhTZWNyZXRJbnB1dC52YWx1ZSA9IGNleFN0YXR1cy5jb25maWcuYXBpU2VjcmV0XG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuY2V4Q29uZmlnUHJvbXB0KVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICogaGFuZGxlQ0VYU3VibWl0IGhhbmRsZXMgY2xpY2tzIG9uIHRoZSBDRVggY29uZmlndXJhdGlvbiBzdWJtaXNzaW9uIGJ1dHRvbi5cbiAgKi9cbiAgYXN5bmMgc3VibWl0ICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGNleE5hbWUsIGZvcm0gfSA9IHRoaXNcbiAgICBEb2MuaGlkZShwYWdlLmNleEZvcm1FcnIpXG4gICAgY29uc3QgYXBpS2V5ID0gcGFnZS5jZXhBcGlLZXlJbnB1dC52YWx1ZVxuICAgIGNvbnN0IGFwaVNlY3JldCA9IHBhZ2UuY2V4U2VjcmV0SW5wdXQudmFsdWVcbiAgICBpZiAoIWFwaUtleSB8fCAhYXBpU2VjcmV0KSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLmNleEZvcm1FcnIpXG4gICAgICBwYWdlLmNleEZvcm1FcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9OT19QQVNTX0VSUk9SX01TRylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKGZvcm0pXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IE1NLnVwZGF0ZUNFWENvbmZpZyh7XG4gICAgICAgIG5hbWU6IGNleE5hbWUsXG4gICAgICAgIGFwaUtleTogYXBpS2V5LFxuICAgICAgICBhcGlTZWNyZXQ6IGFwaVNlY3JldFxuICAgICAgfSlcbiAgICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB0aHJvdyByZXNcbiAgICAgIGF3YWl0IGFwcCgpLmZldGNoTU1TdGF0dXMoKVxuICAgICAgdGhpcy5zdWNjZXNzKGNleE5hbWUpXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgRG9jLnNob3cocGFnZS5jZXhGb3JtRXJyKVxuICAgICAgcGFnZS5jZXhGb3JtRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQVBJX0VSUk9SLCB7IG1zZzogZS5tc2cgPz8gU3RyaW5nKGUpIH0pXG4gICAgICByZXR1cm5cbiAgICB9IGZpbmFsbHkge1xuICAgICAgbG9hZGVkKClcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgYW5pbWF0aW9uTGVuZ3RoID0gMzAwXG5cbi8qIFN3YXAgZm9ybTEgZm9yIGZvcm0yIHdpdGggYW4gYW5pbWF0aW9uLiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNsaWRlU3dhcCAoZm9ybTE6IEhUTUxFbGVtZW50LCBmb3JtMjogSFRNTEVsZW1lbnQpIHtcbiAgY29uc3Qgc2hpZnQgPSBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoIC8gMlxuICBhd2FpdCBEb2MuYW5pbWF0ZShhbmltYXRpb25MZW5ndGgsIHByb2dyZXNzID0+IHtcbiAgICBmb3JtMS5zdHlsZS5yaWdodCA9IGAke3Byb2dyZXNzICogc2hpZnR9cHhgXG4gIH0sICdlYXNlSW5IYXJkJylcbiAgRG9jLmhpZGUoZm9ybTEpXG4gIGZvcm0xLnN0eWxlLnJpZ2h0ID0gJzAnXG4gIGZvcm0yLnN0eWxlLnJpZ2h0ID0gU3RyaW5nKC1zaGlmdClcbiAgRG9jLnNob3coZm9ybTIpXG4gIGlmIChmb3JtMi5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpKSB7XG4gICAgRG9jLnNhZmVTZWxlY3Rvcihmb3JtMiwgJ2lucHV0JykuZm9jdXMoKVxuICB9XG4gIGF3YWl0IERvYy5hbmltYXRlKGFuaW1hdGlvbkxlbmd0aCwgcHJvZ3Jlc3MgPT4ge1xuICAgIGZvcm0yLnN0eWxlLnJpZ2h0ID0gYCR7LXNoaWZ0ICsgcHJvZ3Jlc3MgKiBzaGlmdH1weGBcbiAgfSwgJ2Vhc2VPdXRIYXJkJylcbiAgZm9ybTIuc3R5bGUucmlnaHQgPSAnMCdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dTdWNjZXNzIChwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD4sIG1zZzogc3RyaW5nKSB7XG4gIHBhZ2Uuc3VjY2Vzc01lc3NhZ2UudGV4dENvbnRlbnQgPSBtc2dcbiAgRG9jLnNob3cocGFnZS5mb3JtcywgcGFnZS5jaGVja21hcmtGb3JtKVxuICBwYWdlLmNoZWNrbWFya0Zvcm0uc3R5bGUucmlnaHQgPSAnMCdcbiAgcGFnZS5jaGVja21hcmsuc3R5bGUuZm9udFNpemUgPSAnMHB4J1xuXG4gIGNvbnN0IFtzdGFydFIsIHN0YXJ0Rywgc3RhcnRCXSA9IFN0YXRlLmlzRGFyaygpID8gWzIyMywgMjI2LCAyMjVdIDogWzUxLCA1MSwgNTFdXG4gIGNvbnN0IFtlbmRSLCBlbmRHLCBlbmRCXSA9IFsxNiwgMTYzLCAxNl1cbiAgY29uc3QgW2RpZmZSLCBkaWZmRywgZGlmZkJdID0gW2VuZFIgLSBzdGFydFIsIGVuZEcgLSBzdGFydEcsIGVuZEIgLSBzdGFydEJdXG5cbiAgcmV0dXJuIG5ldyBBbmltYXRpb24oMTIwMCwgKHByb2c6IG51bWJlcikgPT4ge1xuICAgIHBhZ2UuY2hlY2ttYXJrLnN0eWxlLmZvbnRTaXplID0gYCR7cHJvZyAqIDgwfXB4YFxuICAgIHBhZ2UuY2hlY2ttYXJrLnN0eWxlLmNvbG9yID0gYHJnYigke3N0YXJ0UiArIHByb2cgKiBkaWZmUn0sICR7c3RhcnRHICsgcHJvZyAqIGRpZmZHfSwgJHtzdGFydEIgKyBwcm9nICogZGlmZkJ9KWBcbiAgfSwgJ2Vhc2VPdXRFbGFzdGljJylcbn1cblxuLypcbiAqIGJpbmQgYmluZHMgdGhlIGNsaWNrIGFuZCBzdWJtaXQgZXZlbnRzIGFuZCBwcmV2ZW50cyBwYWdlIHJlbG9hZGluZyBvblxuICogc3VibWlzc2lvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJpbmQgKGZvcm06IEhUTUxFbGVtZW50LCBzdWJtaXRCdHRuOiBIVE1MRWxlbWVudCwgaGFuZGxlcjogKGU6IEV2ZW50KSA9PiB2b2lkKSB7XG4gIGNvbnN0IHdyYXBwZXIgPSAoZTogRXZlbnQpID0+IHtcbiAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCkgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgaGFuZGxlcihlKVxuICB9XG4gIERvYy5iaW5kKHN1Ym1pdEJ0dG4sICdjbGljaycsIHdyYXBwZXIpXG4gIERvYy5iaW5kKGZvcm0sICdzdWJtaXQnLCB3cmFwcGVyKVxufVxuXG4vLyBpc1RydXRoeVN0cmluZyB3aWxsIGJlIHRydWUgaWYgdGhlIHByb3ZpZGVkIHN0cmluZyBpcyByZWNvZ25pemVkIGFzIGFcbi8vIHZhbHVlIHJlcHJlc2VudGluZyB0cnVlLlxuZnVuY3Rpb24gaXNUcnV0aHlTdHJpbmcgKHM6IHN0cmluZykge1xuICByZXR1cm4gcyA9PT0gJzEnIHx8IHMudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnXG59XG5cbi8vIHRvVW5peERhdGUgY29udmVydHMgYSBqYXZhc2NyaXB0IGRhdGUgb2JqZWN0IHRvIGEgdW5peCBkYXRlLCB3aGljaCBpc1xuLy8gdGhlIG51bWJlciBvZiAqc2Vjb25kcyogc2luY2UgdGhlIHN0YXJ0IG9mIHRoZSBlcG9jaC5cbmZ1bmN0aW9uIHRvVW5peERhdGUgKGRhdGU6IERhdGUpIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoZGF0ZS5nZXRUaW1lKCkgLyAxMDAwKVxufVxuXG4vLyBkYXRlQXBwbHlPZmZzZXQgc2hpZnRzIGEgZGF0ZSBieSB0aGUgdGltZXpvbmUgb2Zmc2V0LiBUaGlzIGlzIHVzZWQgdG8gbWFrZVxuLy8gVVRDIGRhdGVzIHNob3cgdGhlIGxvY2FsIGRhdGUuIFRoaXMgY2FuIGJlIHVzZWQgdG8gcHJlcGFyZSBhIERhdGUgc29cbi8vIHRvSVNPU3RyaW5nIGdlbmVyYXRlcyBhIGxvY2FsIGRhdGUgc3RyaW5nLiBUaGlzIGlzIGFsc28gdXNlZCB0byB0cmljayBhbiBodG1sXG4vLyBpbnB1dCBlbGVtZW50IHRvIHNob3cgdGhlIGxvY2FsIGRhdGUgd2hlbiBzZXR0aW5nIHRoZSB2YWx1ZUFzRGF0ZSBmaWVsZC4gV2hlblxuLy8gcmVhZGluZyB0aGUgZGF0ZSBiYWNrIHRvIEpTLCB0aGUgdmFsdWUgZmllbGQgc2hvdWxkIGJlIGludGVycHJldGVkIGFzIGxvY2FsXG4vLyB1c2luZyB0aGUgXCJUMDA6MDBcIiBzdWZmaXgsIG9yIHRoZSBEYXRlIGluIHZhbHVlQXNEYXRlIHNob3VsZCBiZSBzaGlmdGVkIGluXG4vLyB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLlxuZnVuY3Rpb24gZGF0ZUFwcGx5T2Zmc2V0IChkYXRlOiBEYXRlKSB7XG4gIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSAtIGRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwICogMTAwMClcbn1cblxuLy8gZGF0ZVRvU3RyaW5nIGNvbnZlcnRzIGEgamF2YXNjcmlwdCBkYXRlIG9iamVjdCB0byBhIFlZWVktTU0tREQgZm9ybWF0IHN0cmluZyxcbi8vIGluIHRoZSBsb2NhbCB0aW1lIHpvbmUuXG5mdW5jdGlvbiBkYXRlVG9TdHJpbmcgKGRhdGU6IERhdGUpIHtcbiAgcmV0dXJuIGRhdGVBcHBseU9mZnNldChkYXRlKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF1cbiAgLy8gQW5vdGhlciBjb21tb24gaGFjazpcbiAgLy8gZGF0ZS50b0xvY2FsZVN0cmluZyhcInN2LVNFXCIsIHsgeWVhcjogXCJudW1lcmljXCIsIG1vbnRoOiBcIjItZGlnaXRcIiwgZGF5OiBcIjItZGlnaXRcIiB9KVxufVxuIiwiLypcbiAqIHJlcXVlc3RKU09OIGVuY29kZXMgdGhlIG9iamVjdCBhbmQgc2VuZHMgdGhlIEpTT04gdG8gdGhlIHNwZWNpZmllZCBhZGRyZXNzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWVzdEpTT04gKG1ldGhvZDogc3RyaW5nLCBhZGRyOiBzdHJpbmcsIHJlcUJvZHk/OiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgd2luZG93LmZldGNoKGFkZHIsIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgaGVhZGVyczogbmV3IHdpbmRvdy5IZWFkZXJzKHsgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9KSxcbiAgICAgIC8vIGNyZWRlbnRpYWxzOiBcInNhbWUtb3JpZ2luXCIsXG4gICAgICBib2R5OiByZXFCb2R5XG4gICAgfSlcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsgdGhyb3cgcmVzcG9uc2UgfVxuICAgIGNvbnN0IG9iaiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgIG9iai5yZXF1ZXN0U3VjY2Vzc2Z1bCA9IHRydWVcbiAgICByZXR1cm4gb2JqXG4gIH0gY2F0Y2ggKHJlc3BvbnNlKSB7XG4gICAgcmVzcG9uc2UucmVxdWVzdFN1Y2Nlc3NmdWwgPSBmYWxzZVxuICAgIHJlc3BvbnNlLm1zZyA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKVxuICAgIHJldHVybiByZXNwb25zZVxuICB9XG59XG5cbi8qXG4gKiBwb3N0SlNPTiBzZW5kcyBhIFBPU1QgcmVxdWVzdCB3aXRoIEpTT04tZm9ybWF0dGVkIGRhdGEgYW5kIHJldHVybnMgdGhlXG4gKiByZXNwb25zZS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBvc3RKU09OIChhZGRyOiBzdHJpbmcsIGRhdGE/OiBhbnkpIHtcbiAgcmV0dXJuIHJlcXVlc3RKU09OKCdQT1NUJywgYWRkciwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpXG59XG5cbi8qXG4gKiBnZXRKU09OIHNlbmRzIGEgR0VUIHJlcXVlc3QgYW5kIHJldHVybnMgdGhlIHJlc3BvbnNlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SlNPTiAoYWRkcjogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIHJlcXVlc3RKU09OKCdHRVQnLCBhZGRyKVxufVxuXG5leHBvcnQgZW51bSBFcnJvcnMge1xuICB3YWxsZXRFcnIsXG4gIHdhbGxldEF1dGhFcnIsXG4gIHdhbGxldEJhbGFuY2VFcnIsXG4gIGR1cGVERVhFcnIsXG4gIGFzc2V0U3VwcG9ydEVycixcbiAgcmVnaXN0ZXJFcnIsXG4gIHNpZ25hdHVyZUVycixcbiAgemVyb0ZlZUVycixcbiAgZmVlTWlzbWF0Y2hFcnIsXG4gIGZlZVNlbmRFcnIsXG4gIHBhc3N3b3JkRXJyLFxuICBlbXB0eUhvc3RFcnIsXG4gIGNvbm5lY3Rpb25FcnIsXG4gIGFjY3RLZXlFcnIsXG4gIHVua25vd25PcmRlckVycixcbiAgb3JkZXJQYXJhbXNFcnIsXG4gIGRiRXJyLFxuICBhdXRoRXJyLFxuICBjb25uZWN0V2FsbGV0RXJyLFxuICBtaXNzaW5nV2FsbGV0RXJyLFxuICBlbmNyeXB0aW9uRXJyLFxuICBkZWNvZGVFcnIsXG4gIGFjY291bnRWZXJpZmljYXRpb25FcnIsXG4gIGFjY291bnRQcm9vZkVycixcbiAgcGFyc2VLZXlFcnIsXG4gIG1hcmtldEVycixcbiAgYWRkcmVzc1BhcnNlRXJyLFxuICBhZGRyRXJyLFxuICBmaWxlUmVhZEVycixcbiAgdW5rbm93bkRFWEVycixcbiAgYWNjb3VudFJldHJpZXZlRXJyLFxuICBhY2NvdW50RGlzYWJsZUVycixcbiAgc3VzcGVuZGVkQWNjdEVycixcbiAgZXhpc3RlbmNlQ2hlY2tFcnIsXG4gIGNyZWF0ZVdhbGxldEVycixcbiAgYWN0aXZlT3JkZXJzRXJyLFxuICBuZXdBZGRyRXJyLFxufVxuIiwiaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7XG4gIGJpbmQgYXMgYmluZEZvcm0sXG4gIHNsaWRlU3dhcFxufSBmcm9tICcuL2Zvcm1zJ1xuaW1wb3J0IHsgV2F2ZSB9IGZyb20gJy4vY2hhcnRzJ1xuaW1wb3J0IHtcbiAgYXBwLFxuICBQYWdlRWxlbWVudCxcbiAgU3VwcG9ydGVkQXNzZXQsXG4gIFVzZXIsXG4gIFdhbGxldEluZm8sXG4gIFdhbGxldERlZmluaXRpb24sXG4gIENvbmZpZ09wdGlvbixcbiAgQVBJUmVzcG9uc2Vcbn0gZnJvbSAnLi9yZWdpc3RyeSdcblxuaW50ZXJmYWNlIEluaXRSZXNwb25zZSBleHRlbmRzIEFQSVJlc3BvbnNlIHtcbiAgaG9zdHM6IHN0cmluZ1tdXG4gIG1uZW1vbmljPzogc3RyaW5nXG59XG5cbi8qXG4gKiBJbml0UGFnZSBpcyB0aGUgcGFnZSBoYW5kbGVyIGZvciB0aGUgL2luaXQgdmlldy4gSW5pdFBhZ2UgaXMgZXNzZW50aWFsbHkgYVxuICogZm9ybSBoYW5kbGVyLiBUaGVyZSBhcmUgbm8gbm9uLWZvcm0gZWxlbWVudHMgb24gL2luaXQuIEluaXRQYWdlIGFkZGl0aW9uYWxseVxuICogaGFzIGEgcm9sZSBjYWNoaW5nIHRoZSBpbml0aWFsaXphdGlvbiBwYXNzd29yZC4gQSBjb3VwbGUgb2Ygbm90ZXMgYWJvdXRcbiAqIEluaXRQYWdlLlxuICogICAxKSBUaGVyZSBpcyBubyBnb2luZyBiYWNrd2FyZHMuIE9uY2UgeW91IHNldCBhIHBhc3N3b3JkLCB5b3UgY2FuJ3QgZ28gYmFja1xuICogICAgICB0byB0aGUgcGFzc3dvcmQgZm9ybS4gSWYgeW91IHJlZnJlc2gsIHlvdSB3b24ndCBlbmQgdXAgb24gL2luaXQsIHNvXG4gKiAgICAgIHdvbid0IGhhdmUgYWNjZXNzIHRvIHRoZSBRdWlja0NvbmZpZ0Zvcm0gb3IgU2VlZEJhY2t1cEZvcm0gLiBPbmNlIHlvdVxuICogICAgICBzdWJtaXQgeW91ciBhdXRvLWNvbmZpZyBjaG9pY2VzLCB5b3UgY2FuJ3QgY2hhbmdlIHRoZW0uIFRoaXMgaGFzXG4gKiAgICAgIGltcGxpY2F0aW9ucyBmb3IgY29kaW5nIGFuZCBVSS4gVGhlcmUgYXJlIG5vIFwiZ28gYmFja1wiIG9yIFwiY2xvc2UgZm9ybVwiXG4gKiAgICAgIGVsZW1lbnRzLlxuICogICAyKSBUaGUgdXNlciBjYW4gcHJlY2x1ZGUgYXV0by1jb25maWcgYW5kIHNlZWQgYmFja3VwIGJ5IGNsaWNraW5nIGFuXG4gKiAgICAgIGF2YWlsYWJsZSBoZWFkZXIgbGluayBhZnRlciBwYXNzd29yZCBpbml0LCBlLmcuIFdhbGxldHMsIGluIHRoZSBwYWdlXG4gKiAgICAgIGhlYWRlci4gTk9URTogUmVnYXJkbGVzcyBvZiB3aGF0IHRoZSB1c2VyIGRvZXMgYWZ0ZXIgc2V0dGluZyB0aGUgYXBwXG4gKiAgICAgIHBhc3MsIHRoZXkgd2lsbCByZWNlaXZlIGEgbm90aWZpY2F0aW9uIHJlbWluZGluZyB0aGVtIHRvIGJhY2sgdXAgdGhlaXJcbiAqICAgICAgc2VlZC4gUGVyaGFwcyBpdCB3b3VsZCBiZSBiZXR0ZXIgdG8gc29tZWhvdyBkZWxheSB0aGF0IG1lc3NhZ2UgdW50aWxcbiAqICAgICAgdGhleSBjaG9vc2UgdG8gaWdub3JlIHRoZSBzZWVkIGJhY2t1cCBkaWFsb2csIGJ1dCBoYXZpbmcgbW9yZSByZW1pbmRlcnNcbiAqICAgICAgaXMgYWxzbyBva2F5LlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbml0UGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgYm9keTogSFRNTEVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGluaXRGb3JtOiBBcHBJbml0Rm9ybVxuICBxdWlja0NvbmZpZ0Zvcm06IFF1aWNrQ29uZmlnRm9ybVxuICBzZWVkQmFja3VwRm9ybTogU2VlZEJhY2t1cEZvcm1cbiAgbW5lbW9uaWM/OiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAoYm9keTogSFRNTEVsZW1lbnQpIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5ib2R5ID0gYm9keVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhib2R5KVxuICAgIHRoaXMuaW5pdEZvcm0gPSBuZXcgQXBwSW5pdEZvcm0ocGFnZS5hcHBQV0Zvcm0sIChwdzogc3RyaW5nLCBob3N0czogc3RyaW5nW10sIG1uZW1vbmljPzogc3RyaW5nKSA9PiB7IHRoaXMuYXBwSW5pdGVkKHB3LCBob3N0cywgbW5lbW9uaWMpIH0pXG4gICAgdGhpcy5xdWlja0NvbmZpZ0Zvcm0gPSBuZXcgUXVpY2tDb25maWdGb3JtKHBhZ2UucXVpY2tDb25maWdGb3JtLCAoKSA9PiB0aGlzLnF1aWNrQ29uZmlnRG9uZSgpKVxuICAgIHRoaXMuc2VlZEJhY2t1cEZvcm0gPSBuZXcgU2VlZEJhY2t1cEZvcm0ocGFnZS5zZWVkQmFja3VwRm9ybSwgKCkgPT4gdGhpcy5zZWVkQmFja2VkVXAoKSlcbiAgfVxuXG4gIGFzeW5jIGFwcEluaXRlZCAocHc6IHN0cmluZywgaG9zdHM6IHN0cmluZ1tdLCBtbmVtb25pYz86IHN0cmluZykge1xuICAgIHRoaXMubW5lbW9uaWMgPSBtbmVtb25pY1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBhd2FpdCB0aGlzLnF1aWNrQ29uZmlnRm9ybS51cGRhdGUocHcsIGhvc3RzKVxuICAgIGlmIChtbmVtb25pYykgdGhpcy5zZWVkQmFja3VwRm9ybS51cGRhdGUobW5lbW9uaWMpXG4gICAgc2xpZGVTd2FwKHBhZ2UuYXBwUFdGb3JtLCBwYWdlLnF1aWNrQ29uZmlnRm9ybSlcbiAgfVxuXG4gIHF1aWNrQ29uZmlnRG9uZSAoKSB7XG4gICAgaWYgKCF0aGlzLm1uZW1vbmljKSBhcHAoKS5sb2FkUGFnZSgnd2FsbGV0cycpXG4gICAgZWxzZSBzbGlkZVN3YXAodGhpcy5wYWdlLnF1aWNrQ29uZmlnRm9ybSwgdGhpcy5wYWdlLnNlZWRCYWNrdXBGb3JtKVxuICB9XG5cbiAgc2VlZEJhY2tlZFVwICgpIHtcbiAgICBhcHAoKS5sb2FkUGFnZSgnd2FsbGV0cycpXG4gIH1cbn1cblxuLypcbiAqIFRoZSBBcHBJbml0Rm9ybSBoYW5kbGVzIHRoZSBmb3JtIHRoYXQgc2V0cyB0aGUgYXBwIHBhc3N3b3JkLCBhY2NlcHRzIGFuXG4gKiBvcHRpb25hbCBzZWVkLCBhbmQgaW5pdGlhbGl6ZXMgdGhlIGFwcC5cbiAqL1xuY2xhc3MgQXBwSW5pdEZvcm0ge1xuICBmb3JtOiBQYWdlRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgc3VjY2VzczogKHB3OiBzdHJpbmcsIGhvc3RzOiBzdHJpbmdbXSwgbW5lbW9uaWM/OiBzdHJpbmcpID0+IHZvaWRcblxuICBjb25zdHJ1Y3RvciAoZm9ybTogUGFnZUVsZW1lbnQsIHN1Y2Nlc3M6IChwdzogc3RyaW5nLCBob3N0czogc3RyaW5nW10sIG1uZW1vbmljPzogc3RyaW5nKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5mb3JtID0gZm9ybVxuICAgIHRoaXMuc3VjY2VzcyA9IHN1Y2Nlc3NcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoZm9ybSlcbiAgICBiaW5kRm9ybShmb3JtLCBwYWdlLmFwcFBXU3VibWl0LCAoKSA9PiB0aGlzLnNldEFwcFBhc3MoKSlcbiAgICBiaW5kRm9ybShmb3JtLCBwYWdlLnRvZ2dsZVNlZWRJbnB1dCwgKCkgPT4ge1xuICAgICAgaWYgKERvYy5pc0hpZGRlbihwYWdlLnNlZWRJbnB1dEJveCkpIHtcbiAgICAgICAgcGFnZS50b2dnbGVTZWVkSW5wdXRJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2ljby1wbHVzJylcbiAgICAgICAgcGFnZS50b2dnbGVTZWVkSW5wdXRJY29uLmNsYXNzTGlzdC5hZGQoJ2ljby1taW51cycpXG4gICAgICAgIERvYy5zaG93KHBhZ2Uuc2VlZElucHV0Qm94KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFnZS50b2dnbGVTZWVkSW5wdXRJY29uLmNsYXNzTGlzdC5yZW1vdmUoJ2ljby1taW51cycpXG4gICAgICAgIHBhZ2UudG9nZ2xlU2VlZElucHV0SWNvbi5jbGFzc0xpc3QuYWRkKCdpY28tcGx1cycpXG4gICAgICAgIERvYy5oaWRlKHBhZ2Uuc2VlZElucHV0Qm94KVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKiBTZXQgdGhlIGFwcGxpY2F0aW9uIHBhc3N3b3JkLiBBdHRhY2hlZCB0byBmb3JtIHN1Ym1pc3Npb24uICovXG4gIGFzeW5jIHNldEFwcFBhc3MgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLmFwcFBXRXJyTXNnKVxuICAgIGNvbnN0IHB3ID0gcGFnZS5hcHBQVy52YWx1ZSB8fCAnJ1xuICAgIGNvbnN0IHB3QWdhaW4gPSBwYWdlLmFwcFBXQWdhaW4udmFsdWVcbiAgICBpZiAocHcgPT09ICcnKSB7XG4gICAgICBwYWdlLmFwcFBXRXJyTXNnLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fUEFTU19FUlJPUl9NU0cpXG4gICAgICBEb2Muc2hvdyhwYWdlLmFwcFBXRXJyTXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmIChwdyAhPT0gcHdBZ2Fpbikge1xuICAgICAgcGFnZS5hcHBQV0Vyck1zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1BBU1NXT1JEX05PVF9NQVRDSClcbiAgICAgIERvYy5zaG93KHBhZ2UuYXBwUFdFcnJNc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBwYWdlLmFwcFBXLnZhbHVlID0gJydcbiAgICBwYWdlLmFwcFBXQWdhaW4udmFsdWUgPSAnJ1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5mb3JtKVxuICAgIC8vIGNvbnN0IHNlZWQgPSBwYWdlLnNlZWRJbnB1dC52YWx1ZT8ucmVwbGFjZSgvXFxzKy9nLCAnJykgLy8gc3RyaXAgd2hpdGVzcGFjZVxuICAgIGNvbnN0IHNlZWQgPSBwYWdlLnNlZWRJbnB1dC52YWx1ZSA/PyAnJ1xuICAgIGNvbnN0IHJlczogSW5pdFJlc3BvbnNlID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvaW5pdCcsIHtcbiAgICAgIHBhc3M6IHB3LFxuICAgICAgc2VlZDogc2VlZFxuICAgIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5hcHBQV0Vyck1zZy50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UuYXBwUFdFcnJNc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zdWNjZXNzKHB3LCByZXMuaG9zdHMsIHJlcy5tbmVtb25pYylcbiAgfVxufVxuXG4vLyBIb3N0Q29uZmlnUm93IGlzIHVzZWQgYnkgdGhlIFF1aWNrQ29uZmlnRm9ybSB0byB0cmFjayB0aGUgdXNlcidzIGNob2ljZXMuXG5pbnRlcmZhY2UgSG9zdENvbmZpZ1JvdyB7XG4gIGhvc3Q6IHN0cmluZ1xuICBjaGVja2JveDogSFRNTElucHV0RWxlbWVudFxufVxuXG4vLyBXYWxsZXRDb25maWdSb3cgaXMgdXNlZCBieSB0aGUgUXVpY2tDb25maWdGb3JtIHRvIHRyYWNrIHRoZSB1c2VyJ3MgY2hvaWNlcy5cbmludGVyZmFjZSBXYWxsZXRDb25maWdSb3cge1xuICBhc3NldDogU3VwcG9ydGVkQXNzZXRcbiAgdHlwZTogc3RyaW5nXG4gIGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50XG59XG5cbmxldCByb3dJRENvdW50ZXIgPSAwXG5cbi8qXG4gKiBRdWlja0NvbmZpZ0Zvcm0gaGFuZGxlcyB0aGUgZm9ybSB0aGF0IGFsbG93cyB1c2VycyB0byBxdWlja2x5IGNvbmZpZ3VyZVxuICogdmlldy1vbmx5IHNlcnZlcnMgYW5kIG5hdGl2ZSB3YWxsZXRzICh0aGF0IGRvbid0IHJlcXVpcmUgYW55IGNvbmZpZ3VyYXRpb24pLlxuICovXG5jbGFzcyBRdWlja0NvbmZpZ0Zvcm0ge1xuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgZm9ybTogUGFnZUVsZW1lbnRcbiAgc2VydmVyczogSG9zdENvbmZpZ1Jvd1tdXG4gIHdhbGxldHM6IFdhbGxldENvbmZpZ1Jvd1tdXG4gIHB3OiBzdHJpbmdcbiAgc3VjY2VzczogKCkgPT4gdm9pZFxuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBQYWdlRWxlbWVudCwgc3VjY2VzczogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICB0aGlzLnN1Y2Nlc3MgPSBzdWNjZXNzXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKGZvcm0pXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UucWNTZXJ2ZXJUbXBsLCBwYWdlLnFjV2FsbGV0VG1wbClcbiAgICBiaW5kRm9ybShmb3JtLCBwYWdlLnF1aWNrQ29uZmlnU3VibWl0LCAoKSA9PiB7IHRoaXMuc3VibWl0KCkgfSlcbiAgICBiaW5kRm9ybShmb3JtLCBwYWdlLnFjRXJyQWNrLCAoKSA9PiB7IHRoaXMuc3VjY2VzcygpIH0pXG4gIH1cblxuICBhc3luYyB1cGRhdGUgKHB3OiBzdHJpbmcsIGhvc3RzOiBzdHJpbmdbXSkge1xuICAgIHRoaXMucHcgPSBwd1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcblxuICAgIHRoaXMuc2VydmVycyA9IFtdXG4gICAgZm9yIChjb25zdCBob3N0IG9mIGhvc3RzKSB7XG4gICAgICBjb25zdCByb3cgPSBwYWdlLnFjU2VydmVyVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIHBhZ2UucWNTZXJ2ZXJzQm94LmFwcGVuZENoaWxkKHJvdylcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICByb3dJRENvdW50ZXIrK1xuICAgICAgY29uc3Qgcm93SUQgPSBgcWNzcm93JHtyb3dJRENvdW50ZXJ9YFxuICAgICAgcm93Lmh0bWxGb3IgPSByb3dJRFxuICAgICAgdG1wbC5jaGVja2JveC5pZCA9IHJvd0lEXG4gICAgICB0bXBsLmhvc3QudGV4dENvbnRlbnQgPSBob3N0XG4gICAgICB0aGlzLnNlcnZlcnMucHVzaCh7IGhvc3QsIGNoZWNrYm94OiB0bXBsLmNoZWNrYm94IGFzIEhUTUxJbnB1dEVsZW1lbnQgfSlcbiAgICB9XG5cbiAgICBjb25zdCB1ID0gYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKCkgYXMgVXNlclxuICAgIHRoaXMud2FsbGV0cyA9IFtdXG4gICAgZm9yIChjb25zdCBhIG9mIE9iamVjdC52YWx1ZXModS5hc3NldHMpKSB7XG4gICAgICBpZiAoYS50b2tlbikgY29udGludWVcbiAgICAgIGNvbnN0IHdpbmZvID0gYS5pbmZvIGFzIFdhbGxldEluZm9cbiAgICAgIGxldCBhdXRvQ29uZmlndXJhYmxlOiBXYWxsZXREZWZpbml0aW9uIHwgbnVsbCA9IG51bGxcbiAgICAgIGZvciAoY29uc3Qgd0RlZiBvZiB3aW5mby5hdmFpbGFibGV3YWxsZXRzKSB7XG4gICAgICAgIGlmICghd0RlZi5zZWVkZWQpIGNvbnRpbnVlXG4gICAgICAgIGlmICh3RGVmLmNvbmZpZ29wdHMgJiYgd0RlZi5jb25maWdvcHRzLnNvbWUoKG9wdDogQ29uZmlnT3B0aW9uKSA9PiBvcHQucmVxdWlyZWQpKSBjb250aW51ZVxuICAgICAgICBhdXRvQ29uZmlndXJhYmxlID0gd0RlZlxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgaWYgKCFhdXRvQ29uZmlndXJhYmxlKSBjb250aW51ZVxuICAgICAgY29uc3Qgcm93ID0gcGFnZS5xY1dhbGxldFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLnFjV2FsbGV0c0JveC5hcHBlbmRDaGlsZChyb3cpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgICAgcm93SURDb3VudGVyKytcbiAgICAgIGNvbnN0IHJvd0lEID0gYHFjd3JvdyR7cm93SURDb3VudGVyfWBcbiAgICAgIHJvdy5odG1sRm9yID0gcm93SURcbiAgICAgIHRtcGwuY2hlY2tib3guaWQgPSByb3dJRFxuICAgICAgdG1wbC5pY29uLnNyYyA9IERvYy5sb2dvUGF0aChhLnN5bWJvbClcbiAgICAgIHRtcGwubmFtZS50ZXh0Q29udGVudCA9IGEubmFtZVxuICAgICAgdGhpcy53YWxsZXRzLnB1c2goe1xuICAgICAgICBhc3NldDogYSxcbiAgICAgICAgdHlwZTogYXV0b0NvbmZpZ3VyYWJsZS50eXBlLFxuICAgICAgICBjaGVja2JveDogdG1wbC5jaGVja2JveCBhcyBIVE1MSW5wdXRFbGVtZW50XG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHN1Ym1pdCAoKSB7XG4gICAgY29uc3QgW2ZhaWxlZEhvc3RzLCBmYWlsZWRXYWxsZXRzXTogW3N0cmluZ1tdLCBzdHJpbmdbXV0gPSBbW10sIFtdXVxuICAgIGNvbnN0IGFuaSA9IG5ldyBXYXZlKHRoaXMuZm9ybSwgeyBiYWNrZ3JvdW5kQ29sb3I6IHRydWUsIG1lc3NhZ2U6ICcuLi4nIH0pXG4gICAgYW5pLm9wdHMubWVzc2FnZSA9IGludGwucHJlcChpbnRsLklEX0FERElOR19TRVJWRVJTKVxuICAgIGNvbnN0IGNvbm5lY3RTZXJ2ZXIgPSBhc3luYyAoc3J2Um93OiBIb3N0Q29uZmlnUm93KSA9PiB7XG4gICAgICBpZiAoIXNydlJvdy5jaGVja2JveC5jaGVja2VkKSByZXR1cm5cbiAgICAgIGNvbnN0IHJlcSA9IHtcbiAgICAgICAgYWRkcjogc3J2Um93Lmhvc3QsXG4gICAgICAgIGFwcFBXOiB0aGlzLnB3XG4gICAgICB9XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9hZGRkZXgnLCByZXEpIC8vIERSQUZUIE5PVEU6IGlnbm9yZSBlcnJvcnMgb2s/XG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkgZmFpbGVkSG9zdHMucHVzaChzcnZSb3cuaG9zdClcbiAgICB9XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwodGhpcy5zZXJ2ZXJzLm1hcChjb25uZWN0U2VydmVyKSlcblxuICAgIGFuaS5vcHRzLm1lc3NhZ2UgPSBpbnRsLnByZXAoaW50bC5JRF9DUkVBVElOR19XQUxMRVRTKVxuICAgIGNvbnN0IGNyZWF0ZVdhbGxldCA9IGFzeW5jICh3YWxsZXRSb3c6IFdhbGxldENvbmZpZ1JvdykgPT4ge1xuICAgICAgY29uc3QgeyBhc3NldDogYSwgdHlwZSwgY2hlY2tib3ggfSA9IHdhbGxldFJvd1xuICAgICAgaWYgKCFjaGVja2JveC5jaGVja2VkKSByZXR1cm5cbiAgICAgIGNvbnN0IGNvbmZpZzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgICBjb25zdCB3YWxsZXREZWYgPSBhcHAoKS53YWxsZXREZWZpbml0aW9uKGEuaWQsIHR5cGUpXG4gICAgICBmb3IgKGNvbnN0IG9wdCBvZiAod2FsbGV0RGVmLmNvbmZpZ29wdHMgPz8gW10pKSB7XG4gICAgICAgIGlmICghb3B0LmRlZmF1bHQpIGNvbnRpbnVlXG4gICAgICAgIGlmIChvcHQuaXNib29sZWFuKSB7XG4gICAgICAgICAgY29uZmlnW29wdC5rZXldID0gb3B0LmRlZmF1bHQgPyAnMScgOiAnMCdcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICAgIGlmIChvcHQucmVwZWF0YWJsZSAmJiBjb25maWdbb3B0LmtleV0pIGNvbmZpZ1tvcHQua2V5XSArPSBvcHQucmVwZWF0YWJsZSArIG9wdC5kZWZhdWx0XG4gICAgICAgIGVsc2UgY29uZmlnW29wdC5rZXldID0gU3RyaW5nKG9wdC5kZWZhdWx0KVxuICAgICAgfVxuICAgICAgY29uc3QgY3JlYXRlRm9ybSA9IHtcbiAgICAgICAgYXNzZXRJRDogYS5pZCxcbiAgICAgICAgYXBwUGFzczogdGhpcy5wdyxcbiAgICAgICAgY29uZmlnOiBjb25maWcsXG4gICAgICAgIHdhbGxldFR5cGU6IHR5cGVcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL25ld3dhbGxldCcsIGNyZWF0ZUZvcm0pXG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkgZmFpbGVkV2FsbGV0cy5wdXNoKGEubmFtZSlcbiAgICB9XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwodGhpcy53YWxsZXRzLm1hcChjcmVhdGVXYWxsZXQpKVxuXG4gICAgYW5pLnN0b3AoKVxuICAgIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpIC8vIENhbGxzIHVwZGF0ZU1lbnVJdGVtc0Rpc3BsYXkgaW50ZXJuYWxseVxuICAgIGlmIChmYWlsZWRXYWxsZXRzLmxlbmd0aCArIGZhaWxlZEhvc3RzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHRoaXMuc3VjY2VzcygpXG5cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5xY0Nob2ljZXMpXG4gICAgRG9jLnNob3cocGFnZS5xY0Vycm9ycylcblxuICAgIGlmIChmYWlsZWRIb3N0cy5sZW5ndGgpIHtcbiAgICAgIGZvciAoY29uc3QgaG9zdCBvZiBmYWlsZWRIb3N0cykge1xuICAgICAgICBwYWdlLnFjU2VydmVyRXJyb3JMaXN0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGhvc3QpKVxuICAgICAgICBwYWdlLnFjU2VydmVyRXJyb3JMaXN0LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpXG4gICAgICB9XG4gICAgfSBlbHNlIERvYy5oaWRlKHBhZ2UucWNTZXJ2ZXJFcnJvcnMpXG5cbiAgICBpZiAoZmFpbGVkV2FsbGV0cy5sZW5ndGgpIHtcbiAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBmYWlsZWRXYWxsZXRzKSB7XG4gICAgICAgIHBhZ2UucWNXYWxsZXRFcnJvckxpc3QuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobmFtZSkpXG4gICAgICAgIHBhZ2UucWNXYWxsZXRFcnJvckxpc3QuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSlcbiAgICAgIH1cbiAgICB9IGVsc2UgRG9jLmhpZGUocGFnZS5xY1dhbGxldEVycm9ycylcbiAgfVxufVxuXG4vKlxuICogU2VlZEJhY2t1cEZvcm0gaGFuZGxlcyB0aGUgZm9ybSB0aGF0IGFsbG93cyB0aGUgdXNlciB0byBiYWNrIHVwIHRoZWlyIHNlZWRcbiAqIGR1cmluZyBpbml0aWFsaXphdGlvbi5cbiAqL1xuY2xhc3MgU2VlZEJhY2t1cEZvcm0ge1xuICBmb3JtOiBQYWdlRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgbW5lbW9uaWM6IHN0cmluZ1xuXG4gIGNvbnN0cnVjdG9yIChmb3JtOiBQYWdlRWxlbWVudCwgc3VjY2VzczogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMuZm9ybSA9IGZvcm1cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoZm9ybSlcbiAgICBiaW5kRm9ybShmb3JtLCBwYWdlLnNlZWRBY2ssICgpID0+IHN1Y2Nlc3MoKSlcbiAgICBiaW5kRm9ybShmb3JtLCBwYWdlLnNob3dTZWVkLCAoKSA9PiB0aGlzLnNob3dTZWVkKCkpXG4gIH1cblxuICB1cGRhdGUgKG1uZW1vbmljOiBzdHJpbmcpIHtcbiAgICB0aGlzLm1uZW1vbmljID0gbW5lbW9uaWNcbiAgfVxuXG4gIHNob3dTZWVkICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5tbmVtb25pYy50ZXh0Q29udGVudCA9IHRoaXMubW5lbW9uaWMgLy8gYCR7d29yZHMuc2xpY2UoMCwgNSkuam9pbignICcpfVxcbiR7d29yZHMuc2xpY2UoNSwgMTApLmpvaW4oJyAnKX1cXG4ke3dvcmRzLnNsaWNlKDEwLDE1KS5qb2luKCcgJyl9YFxuICAgIERvYy5oaWRlKHBhZ2Uuc2JXYW5uYSlcbiAgICBEb2Muc2hvdyhwYWdlLnNiU2VlZClcbiAgfVxufVxuIiwiaW1wb3J0IFN0YXRlIGZyb20gJy4vc3RhdGUnXG5pbXBvcnQgeyBwb3N0SlNPTiB9IGZyb20gJy4vaHR0cCdcblxudHlwZSBMb2NhbGUgPSBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG5cbmV4cG9ydCBjb25zdCBJRF9OT19QQVNTX0VSUk9SX01TRyA9ICdOT19QQVNTX0VSUk9SX01TRydcbmV4cG9ydCBjb25zdCBJRF9OT19BUFBfUEFTU19FUlJPUl9NU0cgPSAnTk9fQVBQX1BBU1NfRVJST1JfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1NFVF9CVVRUT05fQlVZID0gJ1NFVF9CVVRUT05fQlVZJ1xuZXhwb3J0IGNvbnN0IElEX1NFVF9CVVRUT05fU0VMTCA9ICdTRVRfQlVUVE9OX1NFTEwnXG5leHBvcnQgY29uc3QgSURfT0ZGID0gJ09GRidcbmV4cG9ydCBjb25zdCBJRF9NQVggPSAnTUFYJ1xuZXhwb3J0IGNvbnN0IElEX1JFQURZID0gJ1JFQURZJ1xuZXhwb3J0IGNvbnN0IElEX05PX1dBTExFVCA9ICdOT19XQUxMRVQnXG5leHBvcnQgY29uc3QgSURfRElTQUJMRURfTVNHID0gJ0RJU0FCTEVEX01TRydcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfU1lOQ19QUk9HUkVTUyA9ICdXQUxMRVRfU1lOQ19QUk9HUkVTUydcbmV4cG9ydCBjb25zdCBJRF9ISURFX0FERElUSU9OQUxfU0VUVElOR1MgPSAnSElERV9BRERJVElPTkFMX1NFVFRJTkdTJ1xuZXhwb3J0IGNvbnN0IElEX1NIT1dfQURESVRJT05BTF9TRVRUSU5HUyA9ICdTSE9XX0FERElUSU9OQUxfU0VUVElOR1MnXG5leHBvcnQgY29uc3QgSURfQlVZID0gJ0JVWSdcbmV4cG9ydCBjb25zdCBJRF9TRUxMID0gJ1NFTEwnXG5leHBvcnQgY29uc3QgSURfTk9UX1NVUFBPUlRFRCA9ICdOT1RfU1VQUE9SVEVEJ1xuZXhwb3J0IGNvbnN0IElEX1ZFUlNJT05fTk9UX1NVUFBPUlRFRCA9ICdWRVJTSU9OX05PVF9TVVBQT1JURUQnXG5leHBvcnQgY29uc3QgSURfQ09OTkVDVElPTl9GQUlMRUQgPSAnQ09OTkVDVElPTl9GQUlMRUQnXG5leHBvcnQgY29uc3QgSURfT1JERVJfUFJFVklFVyA9ICdPUkRFUl9QUkVWSUVXJ1xuZXhwb3J0IGNvbnN0IElEX0NBTENVTEFUSU5HID0gJ0NBTENVTEFUSU5HJ1xuZXhwb3J0IGNvbnN0IElEX0VTVElNQVRFX1VOQVZBSUxBQkxFID0gJ0VTVElNQVRFX1VOQVZBSUxBQkxFJ1xuZXhwb3J0IGNvbnN0IElEX05PX1pFUk9fUkFURSA9ICdOT19aRVJPX1JBVEUnXG5leHBvcnQgY29uc3QgSURfTk9fWkVST19RVUFOVElUWSA9ICdOT19aRVJPX1FVQU5USVRZJ1xuZXhwb3J0IGNvbnN0IElEX1RSQURFID0gJ1RSQURFJ1xuZXhwb3J0IGNvbnN0IElEX05PX0FTU0VUX1dBTExFVCA9ICdOT19BU1NFVF9XQUxMRVQnXG5leHBvcnQgY29uc3QgSURfRVhFQ1VURUQgPSAnRVhFQ1VURUQnXG5leHBvcnQgY29uc3QgSURfQk9PS0VEID0gJ0JPT0tFRCdcbmV4cG9ydCBjb25zdCBJRF9DQU5DRUxJTkcgPSAnQ0FOQ0VMSU5HJ1xuZXhwb3J0IGNvbnN0IElEX1BBU1NXT1JEX05PVF9NQVRDSCA9ICdQQVNTV09SRF9OT1RfTUFUQ0gnXG5leHBvcnQgY29uc3QgSURfQUNDVF9VTkRFRklORUQgPSAnQUNDVF9VTkRFRklORUQnXG5leHBvcnQgY29uc3QgSURfS0VFUF9XQUxMRVRfUEFTUyA9ICdLRUVQX1dBTExFVF9QQVNTJ1xuZXhwb3J0IGNvbnN0IElEX05FV19XQUxMRVRfUEFTUyA9ICdORVdfV0FMTEVUX1BBU1MnXG5leHBvcnQgY29uc3QgSURfTE9UID0gJ0xPVCdcbmV4cG9ydCBjb25zdCBJRF9MT1RTID0gJ0xPVFMnXG5leHBvcnQgY29uc3QgSURfVU5LTk9XTiA9ICdVTktOT1dOJ1xuZXhwb3J0IGNvbnN0IElEX0VQT0NIID0gJ0VQT0NIJ1xuZXhwb3J0IGNvbnN0IElEX09SREVSX1NVQk1JVFRJTkcgPSAnT1JERVJfU1VCTUlUVElORydcbmV4cG9ydCBjb25zdCBJRF9TRVRUTElORyA9ICdTRVRUTElORydcbmV4cG9ydCBjb25zdCBJRF9OT19NQVRDSCA9ICdOT19NQVRDSCdcbmV4cG9ydCBjb25zdCBJRF9DQU5DRUxFRCA9ICdDQU5DRUxFRCdcbmV4cG9ydCBjb25zdCBJRF9SRVZPS0VEID0gJ1JFVk9LRUQnXG5leHBvcnQgY29uc3QgSURfV0FJVElOR19GT1JfQ09ORlMgPSAnV0FJVElOR19GT1JfQ09ORlMnXG5leHBvcnQgY29uc3QgSURfTk9ORV9TRUxFQ1RFRCA9ICdOT05FX1NFTEVDVEVEJ1xuZXhwb3J0IGNvbnN0IElEX1JFR0lTVFJBVElPTl9GRUVfU1VDQ0VTUyA9ICdSRUdJU1RSQVRJT05fRkVFX1NVQ0NFU1MnXG5leHBvcnQgY29uc3QgSURfQVBJX0VSUk9SID0gJ0FQSV9FUlJPUidcbmV4cG9ydCBjb25zdCBJRF9BREQgPSAnQUREJ1xuZXhwb3J0IGNvbnN0IElEX0NSRUFURSA9ICdDUkVBVEUnXG5leHBvcnQgY29uc3QgSURfU0VUVVBfV0FMTEVUID0gJ1NFVFVQX1dBTExFVCdcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfUkVBRFkgPSAnV0FMTEVUX1JFQURZJ1xuZXhwb3J0IGNvbnN0IElEX0NIQU5HRV9XQUxMRVRfVFlQRSA9ICdDSEFOR0VfV0FMTEVUX1RZUEUnXG5leHBvcnQgY29uc3QgSURfS0VFUF9XQUxMRVRfVFlQRSA9ICdLRUVQX1dBTExFVF9UWVBFJ1xuZXhwb3J0IGNvbnN0IElEX1dBTExFVF9QRU5ESU5HID0gJ1dBTExFVF9QRU5ESU5HJ1xuZXhwb3J0IGNvbnN0IElEX1NFVFVQX05FRURFRCA9ICdTRVRVUF9ORUVERUQnXG5leHBvcnQgY29uc3QgSURfU0VORF9TVUNDRVNTID0gJ1NFTkRfU1VDQ0VTUydcbmV4cG9ydCBjb25zdCBJRF9SRUNPTkZJR19TVUNDRVNTID0gJ1JFQ09ORklHX1NVQ0NFU1MnXG5leHBvcnQgY29uc3QgSURfUkVTQ0FOX1NUQVJURUQgPSAnUkVTQ0FOX1NUQVJURUQnXG5leHBvcnQgY29uc3QgSURfTkVXX1dBTExFVF9TVUNDRVNTID0gJ05FV19XQUxMRVRfU1VDQ0VTUydcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfVU5MT0NLRUQgPSAnV0FMTEVUX1VOTE9DS0VEJ1xuZXhwb3J0IGNvbnN0IElEX1NFTExJTkcgPSAnU0VMTElORydcbmV4cG9ydCBjb25zdCBJRF9CVVlJTkcgPSAnQlVZSU5HJ1xuZXhwb3J0IGNvbnN0IElEX1dBTExFVF9ESVNBQkxFRF9NU0cgPSAnV0FMTEVUX0RJU0FCTEVEJ1xuZXhwb3J0IGNvbnN0IElEX1dBTExFVF9FTkFCTEVEX01TRyA9ICdXQUxMRVRfRU5BQkxFRCdcbmV4cG9ydCBjb25zdCBJRF9BQ1RJVkVfT1JERVJTX0VSUl9NU0cgPSAnQUNUSVZFX09SREVSU19FUlJfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX0FWQUlMQUJMRSA9ICdBVkFJTEFCTEUnXG5leHBvcnQgY29uc3QgSURfTE9DS0VEID0gJ0xPQ0tFRCdcbmV4cG9ydCBjb25zdCBJRF9JTU1BVFVSRSA9ICdJTU1BVFVSRSdcbmV4cG9ydCBjb25zdCBJRF9GRUVfQkFMQU5DRSA9ICdGRUVfQkFMQU5DRSdcbmV4cG9ydCBjb25zdCBJRF9DQU5ETEVTX0xPQURJTkcgPSAnQ0FORExFU19MT0FESU5HJ1xuZXhwb3J0IGNvbnN0IElEX0RFUFRIX0xPQURJTkcgPSAnREVQVEhfTE9BRElORydcbmV4cG9ydCBjb25zdCBJRF9JTlZBTElEX0FERFJFU1NfTVNHID0gJ0lOVkFMSURfQUREUkVTU19NU0cnXG5leHBvcnQgY29uc3QgSURfVFhGRUVfVU5TVVBQT1JURUQgPSAnVFhGRUVfVU5TVVBQT1JURUQnXG5leHBvcnQgY29uc3QgSURfVFhGRUVfRVJSX01TRyA9ICdUWEZFRV9FUlJfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX0FDVElWRV9PUkRFUlNfTE9HT1VUX0VSUl9NU0cgPSAnQUNUSVZFX09SREVSU19MT0dPVVRfRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9JTlZBTElEX0RBVEVfRVJSX01TRyA9ICdJTlZBTElEX0RBVEVfRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9OT19BUkNISVZFRF9SRUNPUkRTID0gJ05PX0FSQ0hJVkVEX1JFQ09SRFMnXG5leHBvcnQgY29uc3QgSURfREVMRVRFX0FSQ0hJVkVEX1JFQ09SRFNfUkVTVUxUID0gJ0RFTEVURV9BUkNISVZFRF9SRUNPUkRTX1JFU1VMVCdcbmV4cG9ydCBjb25zdCBJRF9BUkNISVZFRF9SRUNPUkRTX1BBVEggPSAnQVJDSElWRURfUkVDT1JEU19QQVRIJ1xuZXhwb3J0IGNvbnN0IElEX0RFRkFVTFQgPSAnREVGQVVMVCdcbmV4cG9ydCBjb25zdCBJRF9BRERFRCA9ICdBRERFRCdcbmV4cG9ydCBjb25zdCBJRF9ESVNDT1ZFUkVEID0gJ0RJU0NPVkVSRUQnXG5leHBvcnQgY29uc3QgSURfVU5TVVBQT1JURURfQVNTRVRfSU5GT19FUlJfTVNHID0gJ1VOU1VQUE9SVEVEX0FTU0VUX0lORk9fRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9MSU1JVF9PUkRFUiA9ICdMSU1JVF9PUkRFUidcbmV4cG9ydCBjb25zdCBJRF9MSU1JVF9PUkRFUl9JTU1FRElBVEVfVElGID0gJ0xJTUlUX09SREVSX0lNTUVESUFURV9USUYnXG5leHBvcnQgY29uc3QgSURfTUFSS0VUX09SREVSID0gJ01BUktFVF9PUkRFUidcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfTkVXTFlfTUFUQ0hFRCA9ICdNQVRDSF9TVEFUVVNfTkVXTFlfTUFUQ0hFRCdcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfTUFLRVJfU1dBUF9DQVNUID0gJ01BVENIX1NUQVRVU19NQUtFUl9TV0FQX0NBU1QnXG5leHBvcnQgY29uc3QgSURfTUFUQ0hfU1RBVFVTX1RBS0VSX1NXQVBfQ0FTVCA9ICdNQVRDSF9TVEFUVVNfVEFLRVJfU1dBUF9DQVNUJ1xuZXhwb3J0IGNvbnN0IElEX01BVENIX1NUQVRVU19NQUtFUl9SRURFRU1FRCA9ICdNQVRDSF9TVEFUVVNfTUFLRVJfUkVERUVNRUQnXG5leHBvcnQgY29uc3QgSURfTUFUQ0hfU1RBVFVTX1JFREVNUFRJT05fU0VOVCA9ICdNQVRDSF9TVEFUVVNfUkVERU1QVElPTl9TRU5UJ1xuZXhwb3J0IGNvbnN0IElEX01BVENIX1NUQVRVU19SRURFTVBUSU9OX0NPTkZJUk1FRCA9ICdNQVRDSF9SRURFTVBUSU9OX0NPTkZJUk1FRCdcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfUkVWT0tFRCA9ICdNQVRDSF9TVEFUVVNfUkVWT0tFRCdcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfUkVGVU5ERUQgPSAnTUFUQ0hfU1RBVFVTX1JFRlVOREVEJ1xuZXhwb3J0IGNvbnN0IElEX01BVENIX1NUQVRVU19SRUZVTkRfUEVORElORyA9ICdNQVRDSF9TVEFUVVNfUkVGVU5EX1BFTkRJTkcnXG5leHBvcnQgY29uc3QgSURfTUFUQ0hfU1RBVFVTX1JFREVFTV9QRU5ESU5HID0gJ01BVENIX1NUQVRVU19SRURFRU1fUEVORElORydcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9TVEFUVVNfQ09NUExFVEUgPSAnTUFUQ0hfU1RBVFVTX0NPTVBMRVRFJ1xuZXhwb3J0IGNvbnN0IElEX1RBS0VSX0ZPVU5EX01BS0VSX1JFREVNUFRJT04gPSAnVEFLRVJfRk9VTkRfTUFLRVJfUkVERU1QVElPTidcbmV4cG9ydCBjb25zdCBJRF9PUEVOX1dBTExFVF9FUlJfTVNHID0gJ09QRU5fV0FMTEVUX0VSUl9NU0cnXG5leHBvcnQgY29uc3QgSURfT1JERVJfQUNDRUxFUkFUSU9OX0ZFRV9FUlJfTVNHID0gJ09SREVSX0FDQ0VMRVJBVElPTl9GRUVfRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9BQ0NFTEVSQVRJT05fRVJSX01TRyA9ICdPUkRFUl9BQ0NFTEVSQVRJT05fRVJSX01TRydcbmV4cG9ydCBjb25zdCBJRF9DT05ORUNURUQgPSAnQ09OTkVDVEVEJ1xuZXhwb3J0IGNvbnN0IElEX0RJU0NPTk5FQ1RFRCA9ICdESVNDT05ORUNURUQnXG5leHBvcnQgY29uc3QgSURfSU5WQUxJRF9DRVJUSUZJQ0FURSA9ICdJTlZBTElEX0NFUlRJRklDQVRFJ1xuZXhwb3J0IGNvbnN0IElEX0NPTkZJUk1BVElPTlMgPSAnQ09ORklSTUFUSU9OUydcbmV4cG9ydCBjb25zdCBJRF9UQUtFUiA9ICdUQUtFUidcbmV4cG9ydCBjb25zdCBJRF9NQUtFUiA9ICdNQUtFUidcbmV4cG9ydCBjb25zdCBJRF9FTVBUWV9ERVhfQUREUkVTU19NU0cgPSAnRU1QVFlfREVYX0FERFJFU1NfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1NFTEVDVF9XQUxMRVRfRk9SX0ZFRV9QQVlNRU5UID0gJ1NFTEVDVF9XQUxMRVRfRk9SX0ZFRV9QQVlNRU5UJ1xuZXhwb3J0IGNvbnN0IElEX1VOQVZBSUxBQkxFID0gJ1VOQVZBSUxBQkxFJ1xuZXhwb3J0IGNvbnN0IElEX1dBTExFVF9TWU5DX0ZJTklTSElOR19VUCA9ICdXQUxMRVRfU1lOQ19GSU5JU0hJTkdfVVAnXG5leHBvcnQgY29uc3QgSURfQ09OTkVDVF9XQUxMRVRfRVJSX01TRyA9ICdDT05ORUNUSU5HX1dBTExFVF9FUlJfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1JFRlVORF9JTU1JTkVOVCA9ICdSRUZVTkRfSU1NSU5FTlQnXG5leHBvcnQgY29uc3QgSURfUkVGVU5EX1dJTExfSEFQUEVOX0FGVEVSID0gJ1JFRlVORF9XSUxMX0hBUFBFTl9BRlRFUidcbmV4cG9ydCBjb25zdCBJRF9BVkFJTEFCTEVfVElUTEUgPSAnQVZBSUxBQkxFX1RJVExFJ1xuZXhwb3J0IGNvbnN0IElEX0xPQ0tFRF9USVRMRSA9ICdMT0NLRURfVElUTEUnXG5leHBvcnQgY29uc3QgSURfSU1NQVRVUkVfVElUTEUgPSAnSU1NQVRVUkVfVElUTEUnXG5leHBvcnQgY29uc3QgSURfU1dBUFBJTkcgPSAnU1dBUFBJTkcnXG5leHBvcnQgY29uc3QgSURfQk9OREVEID0gJ0JPTkRFRCdcbmV4cG9ydCBjb25zdCBJRF9MT0NLRURfQkFMX01TRyA9ICdMT0NLRURfQkFMX01TRydcbmV4cG9ydCBjb25zdCBJRF9JTU1BVFVSRV9CQUxfTVNHID0gJ0lNTUFUVVJFX0JBTF9NU0cnXG5leHBvcnQgY29uc3QgSURfTE9DS0VEX1NXQVBQSU5HX0JBTF9NU0cgPSAnTE9DS0VEX1NXQVBQSU5HX0JBTF9NU0cnXG5leHBvcnQgY29uc3QgSURfTE9DS0VEX0JPTkRfQkFMX01TRyA9ICdMT0NLRURfQk9ORF9CQUxfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1JFU0VSVkVTX0RFRklDSVQgPSAnUkVTRVJWRVNfREVGSUNJVCdcbmV4cG9ydCBjb25zdCBJRF9SRVNFUlZFU19ERUZJQ0lUX01TRyA9ICdSRVNFUlZFU19ERUZJQ0lUX01TRydcbmV4cG9ydCBjb25zdCBJRF9CT05EX1JFU0VSVkVTID0gJ0JPTkRfUkVTRVJWRVMnXG5leHBvcnQgY29uc3QgSURfQk9ORF9SRVNFUlZFU19NU0cgPSAnQk9ORF9SRVNFUlZFU19NU0cnXG5leHBvcnQgY29uc3QgSURfU0hJRUxERUQgPSAnU0hJRUxERUQnXG5leHBvcnQgY29uc3QgSURfVFJBTlNQQVJFTlQgPSAnVFJBTlNQQVJFTlQnXG5leHBvcnQgY29uc3QgSURfU0hJRUxERURfTVNHID0gJ1NISUVMREVEX01TRydcbmV4cG9ydCBjb25zdCBJRF9PUkRFUiA9ICdPUkRFUidcbmV4cG9ydCBjb25zdCBJRF9MT0NLRURfT1JERVJfQkFMX01TRyA9ICdMT0NLRURfT1JERVJfQkFMX01TRydcbmV4cG9ydCBjb25zdCBJRF9DUkVBVElOR19XQUxMRVRTID0gJ0NSRUFUSU5HX1dBTExFVFMnXG5leHBvcnQgY29uc3QgSURfQURESU5HX1NFUlZFUlMgPSAnQURESU5HX1NFUlZFUidcbmV4cG9ydCBjb25zdCBJRF9XQUxMRVRfUkVDT1ZFUllfU1VQUE9SVF9NU0cgPSAnV0FMTEVUX1JFQ09WRVJZX1NVUFBPUlRfTVNHJ1xuZXhwb3J0IGNvbnN0IElEX1RJQ0tFVFNfUFVSQ0hBU0VEID0gJ1RJQ0tFVFNfUFVSQ0hBU0VEJ1xuZXhwb3J0IGNvbnN0IElEX1RJQ0tFVF9TVEFUVVNfVU5LTk9XTiA9ICdUSUNLRVRfU1RBVFVTX1VOS05PV04nXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19VTk1JTkVEID0gJ1RJQ0tFVF9TVEFUVVNfVU5NSU5FRCdcbmV4cG9ydCBjb25zdCBJRF9USUNLRVRfU1RBVFVTX0lNTUFUVVJFID0gJ1RJQ0tFVF9TVEFUVVNfSU1NQVRVUkUnXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19MSVZFID0gJ1RJQ0tFVF9TVEFUVVNfTElWRSdcbmV4cG9ydCBjb25zdCBJRF9USUNLRVRfU1RBVFVTX1ZPVEVEID0gJ1RJQ0tFVF9TVEFUVVNfVk9URUQnXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19NSVNTRUQgPSAnVElDS0VUX1NUQVRVU19NSVNTRUQnXG5leHBvcnQgY29uc3QgSURfVElDS0VUX1NUQVRVU19FWFBJUkVEID0gJ1RJQ0tFVF9TVEFUVVNfRVhQSVJFRCdcbmV4cG9ydCBjb25zdCBJRF9USUNLRVRfU1RBVFVTX1VOU1BFTlQgPSAnVElDS0VUX1NUQVRVU19VTlNQRU5UJ1xuZXhwb3J0IGNvbnN0IElEX1RJQ0tFVF9TVEFUVVNfUkVWT0tFRCA9ICdUSUNLRVRfU1RBVFVTX1JFVk9LRUQnXG5leHBvcnQgY29uc3QgSURfUEFTU1dPUkRfUkVTRVRfU1VDQ0VTU19NU0cgPSAnUEFTU1dPUkRfUkVTRVRfU1VDQ0VTU19NU0cnXG5leHBvcnQgY29uc3QgSURfQlJPV1NFUl9OVEZOX0VOQUJMRUQgPSAnQlJPV1NFUl9OVEZOX0VOQUJMRUQnXG5leHBvcnQgY29uc3QgSURfQlJPV1NFUl9OVEZOX09SREVSUyA9ICdCUk9XU0VSX05URk5fT1JERVJTJ1xuZXhwb3J0IGNvbnN0IElEX0JST1dTRVJfTlRGTl9NQVRDSEVTID0gJ0JST1dTRVJfTlRGTl9NQVRDSEVTJ1xuZXhwb3J0IGNvbnN0IElEX0JST1dTRVJfTlRGTl9CT05EUyA9ICdCUk9XU0VSX05URk5fQk9ORFMnXG5leHBvcnQgY29uc3QgSURfQlJPV1NFUl9OVEZOX0NPTk5FQ1RJT05TID0gJ0JST1dTRVJfTlRGTl9DT05ORUNUSU9OUydcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9CVVRUT05fQlVZX0JBTEFOQ0VfRVJST1IgPSAnT1JERVJfQlVUVE9OX0JVWV9CQUxBTkNFX0VSUk9SJ1xuZXhwb3J0IGNvbnN0IElEX09SREVSX0JVVFRPTl9TRUxMX0JBTEFOQ0VfRVJST1IgPSAnT1JERVJfQlVUVE9OX1NFTExfQkFMQU5DRV9FUlJPUidcbmV4cG9ydCBjb25zdCBJRF9PUkRFUl9CVVRUT05fUVRZX0VSUk9SID0gJ09SREVSX0JVVFRPTl9RVFlfRVJST1InXG5leHBvcnQgY29uc3QgSURfT1JERVJfQlVUVE9OX1FUWV9SQVRFX0VSUk9SID0gJ09SREVSX0JVVFRPTl9RVFlfUkFURV9FUlJPUidcbmV4cG9ydCBjb25zdCBJRF9DUkVBVEVfQVNTRVRfV0FMTEVUX01TRyA9ICdDUkVBVEVfQVNTRVRfV0FMTEVUX01TRydcbmV4cG9ydCBjb25zdCBJRF9OT19XQUxMRVRfTVNHID0gJ05PX1dBTExFVF9NU0cnXG5leHBvcnQgY29uc3QgSURfVFJBRElOR19USUVSX1VQREFURUQgPSAnVFJBRElOR19USUVSX1VQREFURUQnXG5leHBvcnQgY29uc3QgSURfSU5WQUxJRF9USUVSX1ZBTFVFID0gJ0lOVkFMSURfVElFUl9WQUxVRSdcbmV4cG9ydCBjb25zdCBJRF9JTlZBTElEX0NPTVBTX1ZBTFVFID0gJ0lOVkFMSURfQ09NUFNfVkFMVUUnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9VTktOT1dOID0gJ1RYX1RZUEVfVU5LTk9XTidcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1NFTkQgPSAnVFhfVFlQRV9TRU5EJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfUkVDRUlWRSA9ICdUWF9UWVBFX1JFQ0VJVkUnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9TV0FQID0gJ1RYX1RZUEVfU1dBUCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1JFREVFTSA9ICdUWF9UWVBFX1JFREVFTSdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1JFRlVORCA9ICdUWF9UWVBFX1JFRlVORCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1NQTElUID0gJ1RYX1RZUEVfU1BMSVQnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9DUkVBVEVfQk9ORCA9ICdUWF9UWVBFX0NSRUFURV9CT05EJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfUkVERUVNX0JPTkQgPSAnVFhfVFlQRV9SRURFRU1fQk9ORCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX0FQUFJPVkVfVE9LRU4gPSAnVFhfVFlQRV9BUFBST1ZFX1RPS0VOJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfQUNDRUxFUkFUSU9OID0gJ1RYX1RZUEVfQUNDRUxFUkFUSU9OJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfU0VMRl9UUkFOU0ZFUiA9ICdUWF9UWVBFX1NFTEZfVFJBTlNGRVInXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9SRVZPS0VfVE9LRU5fQVBQUk9WQUwgPSAnVFhfVFlQRV9SRVZPS0VfVE9LRU5fQVBQUk9WQUwnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9USUNLRVRfUFVSQ0hBU0UgPSAnVFhfVFlQRV9USUNLRVRfUFVSQ0hBU0UnXG5leHBvcnQgY29uc3QgSURfVFhfVFlQRV9USUNLRVRfVk9URSA9ICdUWF9UWVBFX1RJQ0tFVF9WT1RFJ1xuZXhwb3J0IGNvbnN0IElEX1RYX1RZUEVfVElDS0VUX1JFVk9DQVRJT04gPSAnVFhfVFlQRV9USUNLRVRfUkVWT0NBVElPTidcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX1NXQVBfT1JfU0VORCA9ICdUWF9UWVBFX1NXQVBfT1JfU0VORCdcbmV4cG9ydCBjb25zdCBJRF9UWF9UWVBFX01JWCA9ICdUWF9UWVBFX01JWCdcbmV4cG9ydCBjb25zdCBJRF9TV0FQX09SX1NFTkRfVE9PTFRJUCA9ICdTV0FQX09SX1NFTkRfVE9PTFRJUCdcbmV4cG9ydCBjb25zdCBJRF9NSVNTSU5HX0NFWF9DUkVEUyA9ICdNSVNTSU5HX0NFWF9DUkVEUydcbmV4cG9ydCBjb25zdCBJRF9NQVRDSF9CVUZGRVIgPSAnTUFUQ0hfQlVGRkVSJ1xuZXhwb3J0IGNvbnN0IElEX05PX1BMQUNFTUVOVFMgPSAnTk9fUExBQ0VNRU5UUydcbmV4cG9ydCBjb25zdCBJRF9JTlZBTElEX1ZBTFVFID0gJ0lOVkFMSURfVkFMVUUnXG5leHBvcnQgY29uc3QgSURfTk9fWkVSTyA9ICdOT19aRVJPJ1xuZXhwb3J0IGNvbnN0IElEX0JPVFRZUEVfQkFTSUNfTU0gPSAnQk9UVFlQRV9CQVNJQ19NTSdcbmV4cG9ydCBjb25zdCBJRF9CT1RUWVBFX0FSQl9NTSA9ICdCT1RUWVBFX0FSQl9NTSdcbmV4cG9ydCBjb25zdCBJRF9CT1RUWVBFX1NJTVBMRV9BUkIgPSAnQk9UVFlQRV9TSU1QTEVfQVJCJ1xuZXhwb3J0IGNvbnN0IElEX05PX0JPVFRZUEUgPSAnTk9fQk9UVFlQRSdcbmV4cG9ydCBjb25zdCBJRF9OT19DRVggPSAnTk9fQ0VYJ1xuZXhwb3J0IGNvbnN0IElEX0NFWEJBTEFOQ0VfRVJSID0gJ0NFWEJBTEFOQ0VfRVJSJ1xuZXhwb3J0IGNvbnN0IElEX1BFTkRJTkcgPSAnUEVORElORydcbmV4cG9ydCBjb25zdCBJRF9DT01QTEVURSA9ICdDT01QTEVURSdcbmV4cG9ydCBjb25zdCBJRF9BUkNISVZFRF9TRVRUSU5HUyA9ICdBUkNISVZFRF9TRVRUSU5HUydcbmV4cG9ydCBjb25zdCBJRF9OT19DT0RFX1BST1ZJREVEID0gJ05PX0NPREVfUFJPVklERUQnXG5leHBvcnQgY29uc3QgSURfRU5BQkxFX0FDQ09VTlQgPSAnRU5BQkxFX0FDQ09VTlQnXG5leHBvcnQgY29uc3QgSURfRElTQUJMRV9BQ0NPVU5UID0gJ0RJU0FCTEVfQUNDT1VOVCdcbmV4cG9ydCBjb25zdCBJRF9BQ0NPVU5UX0RJU0FCTEVEX01TRyA9ICdBQ0NPVU5UX0RJU0FCTEVEX01TRydcbmV4cG9ydCBjb25zdCBJRF9ERVhfRElTQUJMRURfTVNHID0gJ0RFWF9ESVNBQkxFRF9NU0cnXG5cbmxldCBsb2NhbGU6IExvY2FsZVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZExvY2FsZSAobGFuZzogc3RyaW5nLCBjb21taXRIYXNoOiBzdHJpbmcsIHNraXBDYWNoZTogYm9vbGVhbikge1xuICBpZiAoIXNraXBDYWNoZSkge1xuICAgIGNvbnN0IHNwZWNzID0gU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5sb2NhbGVTcGVjc0tleSlcbiAgICBpZiAoc3BlY3MgJiYgc3BlY3MubGFuZyA9PT0gbGFuZyAmJiBzcGVjcy5jb21taXRIYXNoID09PSBjb21taXRIYXNoKSB7XG4gICAgICBsb2NhbGUgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmxvY2FsZUtleSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgfVxuICBsb2NhbGUgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9sb2NhbGUnLCBsYW5nKVxuICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmxvY2FsZVNwZWNzS2V5LCB7IGxhbmcsIGNvbW1pdEhhc2ggfSlcbiAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5sb2NhbGVLZXksIGxvY2FsZSlcbn1cblxuLyogcHJlcCB3aWxsIGZvcm1hdCB0aGUgbWVzc2FnZSB0byB0aGUgY3VycmVudCBsb2NhbGUuICovXG5leHBvcnQgZnVuY3Rpb24gcHJlcCAoazogc3RyaW5nLCBhcmdzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuICByZXR1cm4gc3RyaW5nVGVtcGxhdGVQYXJzZXIobG9jYWxlW2tdLCBhcmdzIHx8IHt9KVxufVxuXG53aW5kb3cuY2xlYXJMb2NhbGUgPSAoKSA9PiB7XG4gIFN0YXRlLnJlbW92ZUxvY2FsKFN0YXRlLmxvY2FsZVNwZWNzS2V5KVxuICBTdGF0ZS5yZW1vdmVMb2NhbChTdGF0ZS5sb2NhbGVLZXkpXG59XG5cbi8qXG4gKiBzdHJpbmdUZW1wbGF0ZVBhcnNlciBpcyBhIHRlbXBsYXRlIHN0cmluZyBtYXRjaGVyLCB3aGVyZSBleHByZXNzaW9uIGlzIGFueVxuICogdGV4dC4gSXQgc3dpdGNoZXMgd2hhdCBpcyBpbnNpZGUgZG91YmxlIGJyYWNrZXRzIChlLmcuICdidXkge3sgYXNzZXQgfX0nKVxuICogZm9yIHRoZSB2YWx1ZSBkZXNjcmliZWQgaW50byBhcmdzLiBhcmdzIGlzIGFuIG9iamVjdCB3aXRoIGtleXNcbiAqIGVxdWFsIHRvIHRoZSBwbGFjZWhvbGRlciBrZXlzLiAoZS5nLiB7XCJhc3NldFwiOiBcImRjclwifSkuXG4gKiBTbyB0aGF0IHdpbGwgYmUgc3dpdGNoZWQgZm9yOiAnYXNzZXQgZGNyJy5cbiAqL1xuZnVuY3Rpb24gc3RyaW5nVGVtcGxhdGVQYXJzZXIgKGV4cHJlc3Npb246IHN0cmluZywgYXJnczogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuICAvLyB0ZW1wbGF0ZU1hdGNoZXIgbWF0Y2hlcyBhbnkgdGV4dCB3aGljaDpcbiAgLy8gaXMgc29tZSB7eyB0ZXh0IH19IGJldHdlZW4gdHdvIGJyYWNrZXRzLCBhbmQgYSBzcGFjZSBiZXR3ZWVuIHRoZW0uXG4gIC8vIEl0IGlzIGdsb2JhbCwgdGhlcmVmb3JlIGl0IHdpbGwgY2hhbmdlIGFsbCBvY2N1cnJlbmNlcyBmb3VuZC5cbiAgLy8gdGV4dCBjYW4gYmUgYW55dGhpbmcsIGJ1dCBicmFja2V0cyAne30nIGFuZCBzcGFjZSAnXFxzJ1xuICBjb25zdCB0ZW1wbGF0ZU1hdGNoZXIgPSAve3tcXHM/KFtee31cXHNdKilcXHM/fX0vZ1xuICByZXR1cm4gZXhwcmVzc2lvbi5yZXBsYWNlKHRlbXBsYXRlTWF0Y2hlciwgKF8sIHZhbHVlKSA9PiBhcmdzW3ZhbHVlXSlcbn1cbiIsImltcG9ydCB7IFBhZ2VFbGVtZW50LCBhcHAgfSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgQXBwUGFzc1Jlc2V0Rm9ybSwgTG9naW5Gb3JtLCBzbGlkZVN3YXAgfSBmcm9tICcuL2Zvcm1zJ1xuXG4vKlxuICBMb2dpblBhZ2UgaG9sZHMgdGhlIGZvcm0gZm9yIGxvZ2luIGFuZCBwYXNzd29yZCByZXNldC5cbiovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMb2dpblBhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIGxvZ2luRm9ybTogTG9naW5Gb3JtXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBhcHBQYXNzUmVzZXRGb3JtOiBBcHBQYXNzUmVzZXRGb3JtXG5cbiAgY29uc3RydWN0b3IgKGJvZHk6IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhib2R5KVxuICAgIHRoaXMubG9naW5Gb3JtID0gbmV3IExvZ2luRm9ybShwYWdlLmxvZ2luRm9ybSwgKCkgPT4geyB0aGlzLmxvZ2dlZEluKCkgfSlcblxuICAgIGNvbnN0IHByZXBBbmREaXNwbGF5TG9naW5Gb3JtID0gKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5yZXNldEFwcFBXRm9ybSlcbiAgICAgIHRoaXMubG9naW5Gb3JtLnJlZnJlc2goKVxuICAgICAgRG9jLnNob3cocGFnZS5sb2dpbkZvcm0pXG4gICAgICB0aGlzLmxvZ2luRm9ybS5mb2N1cygpXG4gICAgfVxuICAgIHByZXBBbmREaXNwbGF5TG9naW5Gb3JtKClcblxuICAgIHRoaXMuYXBwUGFzc1Jlc2V0Rm9ybSA9IG5ldyBBcHBQYXNzUmVzZXRGb3JtKHBhZ2UucmVzZXRBcHBQV0Zvcm0sICgpID0+IHsgcHJlcEFuZERpc3BsYXlMb2dpbkZvcm0oKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuZm9yZ290UGFzc0J0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5hcHBQYXNzUmVzZXRGb3JtLnJlZnJlc2goKVxuICAgICAgc2xpZGVTd2FwKHBhZ2UubG9naW5Gb3JtLCBwYWdlLnJlc2V0QXBwUFdGb3JtKVxuICAgIH0pXG4gICAgRG9jLmJpbmQocGFnZS5yZXNldFBhc3NGb3JtQ2xvc2VyLCAnY2xpY2snLCAoKSA9PiB7IHByZXBBbmREaXNwbGF5TG9naW5Gb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmZvcm1zLCAnbW91c2Vkb3duJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICghRG9jLm1vdXNlSW5FbGVtZW50KGUsIHBhZ2UucmVzZXRBcHBQV0Zvcm0pICYmIERvYy5pc0Rpc3BsYXllZChwYWdlLnJlc2V0QXBwUFdGb3JtKSkgeyBwcmVwQW5kRGlzcGxheUxvZ2luRm9ybSgpIH1cbiAgICB9KVxuICB9XG5cbiAgLyogbG9naW4gc3VibWl0cyB0aGUgc2lnbi1pbiBmb3JtIGFuZCBwYXJzZXMgdGhlIHJlc3VsdC4gKi9cbiAgYXN5bmMgbG9nZ2VkSW4gKCkge1xuICAgIGF3YWl0IGFwcCgpLmxvYWRQYWdlKCd3YWxsZXRzJylcbiAgfVxufVxuIiwiaW1wb3J0IERvYywgeyBXYWxsZXRJY29ucywgcGFyc2VGbG9hdERlZmF1bHQgfSBmcm9tICcuL2RvYydcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0IEJhc2VQYWdlIGZyb20gJy4vYmFzZXBhZ2UnXG5pbXBvcnQgT3JkZXJCb29rIGZyb20gJy4vb3JkZXJib29rJ1xuaW1wb3J0IHsgUmVwdXRhdGlvbk1ldGVyLCB0cmFkaW5nTGltaXRzLCBzdHJvbmdUaWVyIH0gZnJvbSAnLi9hY2NvdW50J1xuaW1wb3J0IHtcbiAgQ2FuZGxlQ2hhcnQsXG4gIERlcHRoQ2hhcnQsXG4gIERlcHRoTGluZSxcbiAgQ2FuZGxlUmVwb3J0ZXJzLFxuICBNb3VzZVJlcG9ydCxcbiAgVm9sdW1lUmVwb3J0LFxuICBEZXB0aE1hcmtlcixcbiAgV2F2ZVxufSBmcm9tICcuL2NoYXJ0cydcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0IHtcbiAgTmV3V2FsbGV0Rm9ybSxcbiAgQWNjZWxlcmF0ZU9yZGVyRm9ybSxcbiAgRGVwb3NpdEFkZHJlc3MsXG4gIFRva2VuQXBwcm92YWxGb3JtLFxuICBiaW5kIGFzIGJpbmRGb3JtXG59IGZyb20gJy4vZm9ybXMnXG5pbXBvcnQgKiBhcyBPcmRlclV0aWwgZnJvbSAnLi9vcmRlcnV0aWwnXG5pbXBvcnQgd3MgZnJvbSAnLi93cydcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0IHtcbiAgYXBwLFxuICBTdXBwb3J0ZWRBc3NldCxcbiAgUGFnZUVsZW1lbnQsXG4gIE9yZGVyLFxuICBNYXJrZXQsXG4gIE9yZGVyRXN0aW1hdGUsXG4gIE1heE9yZGVyRXN0aW1hdGUsXG4gIEV4Y2hhbmdlLFxuICBVbml0SW5mbyxcbiAgQXNzZXQsXG4gIENhbmRsZSxcbiAgQ2FuZGxlc1BheWxvYWQsXG4gIFRyYWRlRm9ybSxcbiAgQm9va1VwZGF0ZSxcbiAgTWF4U2VsbCxcbiAgTWF4QnV5LFxuICBTd2FwRXN0aW1hdGUsXG4gIE1hcmtldE9yZGVyQm9vayxcbiAgQVBJUmVzcG9uc2UsXG4gIFByZVN3YXAsXG4gIFByZVJlZGVlbSxcbiAgV2FsbGV0U3RhdGVOb3RlLFxuICBXYWxsZXRTeW5jTm90ZSxcbiAgV2FsbGV0Q3JlYXRpb25Ob3RlLFxuICBTcG90UHJpY2VOb3RlLFxuICBCb25kTm90ZSxcbiAgT3JkZXJOb3RlLFxuICBFcG9jaE5vdGUsXG4gIEJhbGFuY2VOb3RlLFxuICBNaW5pT3JkZXIsXG4gIFJlbWFpbmRlclVwZGF0ZSxcbiAgQ29ubkV2ZW50Tm90ZSxcbiAgT3JkZXJPcHRpb24sXG4gIENvbm5lY3Rpb25TdGF0dXMsXG4gIFJlY2VudE1hdGNoLFxuICBNYXRjaE5vdGUsXG4gIEFwcHJvdmFsU3RhdHVzLFxuICBPcmRlckZpbHRlcixcbiAgUnVuU3RhdHNOb3RlLFxuICBSdW5FdmVudE5vdGVcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7IHNldE9wdGlvblRlbXBsYXRlcyB9IGZyb20gJy4vb3B0cydcbmltcG9ydCB7IFJ1bm5pbmdNYXJrZXRNYWtlckRpc3BsYXkgfSBmcm9tICcuL21tdXRpbCdcblxuY29uc3QgYmluZCA9IERvYy5iaW5kXG5cbmNvbnN0IGJvb2tSb3V0ZSA9ICdib29rJ1xuY29uc3QgYm9va09yZGVyUm91dGUgPSAnYm9va19vcmRlcidcbmNvbnN0IHVuYm9va09yZGVyUm91dGUgPSAndW5ib29rX29yZGVyJ1xuY29uc3QgdXBkYXRlUmVtYWluaW5nUm91dGUgPSAndXBkYXRlX3JlbWFpbmluZydcbmNvbnN0IGVwb2NoT3JkZXJSb3V0ZSA9ICdlcG9jaF9vcmRlcidcbmNvbnN0IGNhbmRsZXNSb3V0ZSA9ICdjYW5kbGVzJ1xuY29uc3QgY2FuZGxlVXBkYXRlUm91dGUgPSAnY2FuZGxlX3VwZGF0ZSdcbmNvbnN0IHVubWFya2V0Um91dGUgPSAndW5tYXJrZXQnXG5jb25zdCBlcG9jaE1hdGNoU3VtbWFyeVJvdXRlID0gJ2Vwb2NoX21hdGNoX3N1bW1hcnknXG5cbmNvbnN0IGFuaW1hdGlvbkxlbmd0aCA9IDUwMFxuXG5jb25zdCBhbkhvdXIgPSA2MCAqIDYwICogMTAwMCAvLyBtaWxsaXNlY29uZHNcbmNvbnN0IG1heFVzZXJPcmRlcnNTaG93biA9IDEwXG5cbmNvbnN0IGJ1eUJ0bkNsYXNzID0gJ2J1eWdyZWVuLWJnJ1xuY29uc3Qgc2VsbEJ0bkNsYXNzID0gJ3NlbGxyZWQtYmcnXG5cbmNvbnN0IGZpdmVNaW5CaW5LZXkgPSAnNW0nXG5jb25zdCBvbmVIckJpbktleSA9ICcxaCdcblxuY29uc3QgcGVyY2VudEZvcm1hdHRlciA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChEb2MubGFuZ3VhZ2VzKCksIHtcbiAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAxLFxuICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM6IDJcbn0pXG5cbmNvbnN0IHBhcmVudElETm9uZSA9IDB4RkZGRkZGRkZcblxuaW50ZXJmYWNlIE1ldGFPcmRlciB7XG4gIGRpdjogSFRNTEVsZW1lbnRcbiAgaGVhZGVyOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgZGV0YWlsczogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIG9yZDogT3JkZXJcbiAgY2FuY2VsbGluZz86IGJvb2xlYW5cbn1cblxuaW50ZXJmYWNlIENhbmNlbERhdGEge1xuICBidHRuOiBQYWdlRWxlbWVudFxuICBvcmRlcjogT3JkZXJcbn1cblxuaW50ZXJmYWNlIEN1cnJlbnRNYXJrZXQge1xuICBkZXg6IEV4Y2hhbmdlXG4gIHNpZDogc3RyaW5nIC8vIEEgc3RyaW5nIG1hcmtldCBpZGVudGlmaWVyIHVzZWQgYnkgdGhlIERFWC5cbiAgY2ZnOiBNYXJrZXRcbiAgYmFzZTogU3VwcG9ydGVkQXNzZXRcbiAgcXVvdGU6IFN1cHBvcnRlZEFzc2V0XG4gIGJhc2VVbml0SW5mbzogVW5pdEluZm9cbiAgcXVvdGVVbml0SW5mbzogVW5pdEluZm9cbiAgbWF4U2VsbFJlcXVlc3RlZDogYm9vbGVhblxuICBtYXhTZWxsOiBNYXhPcmRlckVzdGltYXRlIHwgbnVsbFxuICBzZWxsQmFsYW5jZTogbnVtYmVyXG4gIGJ1eUJhbGFuY2U6IG51bWJlclxuICBtYXhCdXlzOiBSZWNvcmQ8bnVtYmVyLCBNYXhPcmRlckVzdGltYXRlPlxuICBjYW5kbGVDYWNoZXM6IFJlY29yZDxzdHJpbmcsIENhbmRsZXNQYXlsb2FkPlxuICBiYXNlQ2ZnOiBBc3NldFxuICBxdW90ZUNmZzogQXNzZXRcbiAgcmF0ZUNvbnZlcnNpb25GYWN0b3I6IG51bWJlclxuICBib29rTG9hZGVkOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBMb2FkVHJhY2tlciB7XG4gIGxvYWRlZDogKCkgPT4gdm9pZFxuICB0aW1lcjogbnVtYmVyXG59XG5cbmludGVyZmFjZSBPcmRlclJvdyBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgbWFuYWdlcjogT3JkZXJUYWJsZVJvd01hbmFnZXJcbn1cblxuaW50ZXJmYWNlIFN0YXRzRGlzcGxheSB7XG4gIHJvdzogUGFnZUVsZW1lbnRcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG59XG5cbmludGVyZmFjZSBNYXJrZXRzUGFnZVBhcmFtcyB7XG4gIGhvc3Q6IHN0cmluZ1xuICBiYXNlSUQ6IHN0cmluZ1xuICBxdW90ZUlEOiBzdHJpbmdcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFya2V0c1BhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBtYWluOiBIVE1MRWxlbWVudFxuICBtYXhMb2FkZWQ6ICgoKSA9PiB2b2lkKSB8IG51bGxcbiAgbWF4T3JkZXJVcGRhdGVDb3VudGVyOiBudW1iZXJcbiAgbWFya2V0OiBDdXJyZW50TWFya2V0XG4gIGN1cnJlbnRGb3JtOiBIVE1MRWxlbWVudFxuICBvcGVuQXNzZXQ6IFN1cHBvcnRlZEFzc2V0XG4gIGN1cnJlbnRDcmVhdGU6IFN1cHBvcnRlZEFzc2V0XG4gIG1heEVzdGltYXRlVGltZXI6IG51bWJlciB8IG51bGxcbiAgYm9vazogT3JkZXJCb29rXG4gIGNhbmNlbERhdGE6IENhbmNlbERhdGFcbiAgbWV0YU9yZGVyczogUmVjb3JkPHN0cmluZywgTWV0YU9yZGVyPlxuICBwcmVvcmRlckNhY2hlOiBSZWNvcmQ8c3RyaW5nLCBPcmRlckVzdGltYXRlPlxuICBjdXJyZW50T3JkZXI6IFRyYWRlRm9ybVxuICBkZXB0aExpbmVzOiBSZWNvcmQ8c3RyaW5nLCBEZXB0aExpbmVbXT5cbiAgYWN0aXZlTWFya2VyUmF0ZTogbnVtYmVyIHwgbnVsbFxuICBob3ZlcnM6IEhUTUxFbGVtZW50W11cbiAgb2dUaXRsZTogc3RyaW5nXG4gIGRlcHRoQ2hhcnQ6IERlcHRoQ2hhcnRcbiAgY2FuZGxlQ2hhcnQ6IENhbmRsZUNoYXJ0XG4gIGNhbmRsZUR1cjogc3RyaW5nXG4gIGJhbGFuY2VXZ3Q6IEJhbGFuY2VXaWRnZXRcbiAgbW06IFJ1bm5pbmdNYXJrZXRNYWtlckRpc3BsYXlcbiAgbWFya2V0TGlzdDogTWFya2V0TGlzdFxuICBuZXdXYWxsZXRGb3JtOiBOZXdXYWxsZXRGb3JtXG4gIGRlcG9zaXRBZGRyRm9ybTogRGVwb3NpdEFkZHJlc3NcbiAgYXBwcm92ZVRva2VuRm9ybTogVG9rZW5BcHByb3ZhbEZvcm1cbiAgcmVwdXRhdGlvbk1ldGVyOiBSZXB1dGF0aW9uTWV0ZXJcbiAga2V5dXA6IChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG4gIHNlY29uZFRpY2tlcjogbnVtYmVyXG4gIGNhbmRsZXNMb2FkaW5nOiBMb2FkVHJhY2tlciB8IG51bGxcbiAgYWNjZWxlcmF0ZU9yZGVyRm9ybTogQWNjZWxlcmF0ZU9yZGVyRm9ybVxuICByZWNlbnRNYXRjaGVzOiBSZWNlbnRNYXRjaFtdXG4gIHJlY2VudE1hdGNoZXNTb3J0S2V5OiBzdHJpbmdcbiAgcmVjZW50TWF0Y2hlc1NvcnREaXJlY3Rpb246IDEgfCAtMVxuICBzdGF0czogW1N0YXRzRGlzcGxheSwgU3RhdHNEaXNwbGF5XVxuICBsb2FkaW5nQW5pbWF0aW9uczogeyBjYW5kbGVzPzogV2F2ZSwgZGVwdGg/OiBXYXZlIH1cbiAgbW1SdW5uaW5nOiBib29sZWFuIHwgdW5kZWZpbmVkXG5cbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50LCBwYWdlUGFyYW1zOiBNYXJrZXRzUGFnZVBhcmFtcykge1xuICAgIHN1cGVyKClcblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhtYWluKVxuICAgIHRoaXMubWFpbiA9IG1haW5cbiAgICBpZiAoIXRoaXMubWFpbi5wYXJlbnRFbGVtZW50KSByZXR1cm4gLy8gTm90IGdvbm5hIGhhcHBlbiwgYnV0IFR5cGVTY3JpcHQgY2FyZXMuXG4gICAgLy8gVGhlcmUgbWF5IGJlIG11bHRpcGxlIHBlbmRpbmcgdXBkYXRlcyB0byB0aGUgbWF4IG9yZGVyLiBUaGlzIG1ha2VzIHN1cmVcbiAgICAvLyB0aGF0IHRoZSBzY3JlZW4gaXMgdXBkYXRlZCB3aXRoIHRoZSBtb3N0IHJlY2VudCBvbmUuXG4gICAgdGhpcy5tYXhPcmRlclVwZGF0ZUNvdW50ZXIgPSAwXG4gICAgdGhpcy5tZXRhT3JkZXJzID0ge31cbiAgICB0aGlzLnJlY2VudE1hdGNoZXMgPSBbXVxuICAgIHRoaXMucHJlb3JkZXJDYWNoZSA9IHt9XG4gICAgdGhpcy5kZXB0aExpbmVzID0ge1xuICAgICAgaG92ZXI6IFtdLFxuICAgICAgaW5wdXQ6IFtdXG4gICAgfVxuICAgIHRoaXMuaG92ZXJzID0gW11cbiAgICAvLyAnUmVjZW50IE1hdGNoZXMnIGxpc3Qgc29ydCBrZXkgYW5kIGRpcmVjdGlvbi5cbiAgICB0aGlzLnJlY2VudE1hdGNoZXNTb3J0S2V5ID0gJ2FnZSdcbiAgICB0aGlzLnJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uID0gLTFcbiAgICAvLyBzdG9yZSBvcmlnaW5hbCB0aXRsZSBzbyB3ZSBjYW4gcmUtYXBwZW5kIGl0IHdoZW4gdXBkYXRpbmcgbWFya2V0IHZhbHVlLlxuICAgIHRoaXMub2dUaXRsZSA9IGRvY3VtZW50LnRpdGxlXG5cbiAgICBjb25zdCBkZXB0aFJlcG9ydGVycyA9IHtcbiAgICAgIGNsaWNrOiAoeDogbnVtYmVyKSA9PiB7IHRoaXMucmVwb3J0RGVwdGhDbGljayh4KSB9LFxuICAgICAgdm9sdW1lOiAocjogVm9sdW1lUmVwb3J0KSA9PiB7IHRoaXMucmVwb3J0RGVwdGhWb2x1bWUocikgfSxcbiAgICAgIG1vdXNlOiAocjogTW91c2VSZXBvcnQpID0+IHsgdGhpcy5yZXBvcnREZXB0aE1vdXNlKHIpIH0sXG4gICAgICB6b29tOiAoejogbnVtYmVyKSA9PiB7IHRoaXMucmVwb3J0RGVwdGhab29tKHopIH1cbiAgICB9XG4gICAgdGhpcy5kZXB0aENoYXJ0ID0gbmV3IERlcHRoQ2hhcnQocGFnZS5kZXB0aENoYXJ0LCBkZXB0aFJlcG9ydGVycywgU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5kZXB0aFpvb21MSykpXG5cbiAgICBjb25zdCBjYW5kbGVSZXBvcnRlcnM6IENhbmRsZVJlcG9ydGVycyA9IHtcbiAgICAgIG1vdXNlOiBjID0+IHsgdGhpcy5yZXBvcnRNb3VzZUNhbmRsZShjKSB9XG4gICAgfVxuICAgIHRoaXMuY2FuZGxlQ2hhcnQgPSBuZXcgQ2FuZGxlQ2hhcnQocGFnZS5jYW5kbGVzQ2hhcnQsIGNhbmRsZVJlcG9ydGVycylcblxuICAgIGNvbnN0IHN1Y2Nlc3MgPSAoKSA9PiB7IC8qIGRvIG5vdGhpbmcgKi8gfVxuICAgIC8vIERvIG5vdCBjYWxsIGNsZWFuVGVtcGxhdGVzIGJlZm9yZSBjcmVhdGluZyB0aGUgQWNjZWxlcmF0ZU9yZGVyRm9ybVxuICAgIHRoaXMuYWNjZWxlcmF0ZU9yZGVyRm9ybSA9IG5ldyBBY2NlbGVyYXRlT3JkZXJGb3JtKHBhZ2UuYWNjZWxlcmF0ZUZvcm0sIHN1Y2Nlc3MpXG5cbiAgICB0aGlzLmFwcHJvdmVUb2tlbkZvcm0gPSBuZXcgVG9rZW5BcHByb3ZhbEZvcm0ocGFnZS5hcHByb3ZlVG9rZW5Gb3JtKVxuXG4gICAgLy8gU2V0IHVzZXIncyBsYXN0IGtub3duIGNhbmRsZSBkdXJhdGlvbi5cbiAgICB0aGlzLmNhbmRsZUR1ciA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUubGFzdENhbmRsZUR1cmF0aW9uTEspIHx8IG9uZUhyQmluS2V5XG5cbiAgICAvLyBTZXR1cCB0aGUgcmVnaXN0ZXIgdG8gdHJhZGUgYnV0dG9uLlxuICAgIC8vIFRPRE86IFVzZSBkZXhzZXR0aW5ncyBwYWdlP1xuICAgIGNvbnN0IHJlZ2lzdGVyQnR0biA9IERvYy50bXBsRWxlbWVudChwYWdlLm5vdFJlZ2lzdGVyZWQsICdyZWdpc3RlckJ0dG4nKVxuICAgIGJpbmQocmVnaXN0ZXJCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBhcHAoKS5sb2FkUGFnZSgncmVnaXN0ZXInLCB7IGhvc3Q6IHRoaXMubWFya2V0LmRleC5ob3N0IH0pXG4gICAgfSlcblxuICAgIC8vIFNldCB1cCB0aGUgQmFsYW5jZVdpZGdldC5cbiAgICB7XG4gICAgICBwYWdlLndhbGxldEluZm9UbXBsLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKVxuICAgICAgY29uc3QgYldpZGdldCA9IHBhZ2Uud2FsbGV0SW5mb1RtcGxcbiAgICAgIGNvbnN0IHFXaWRnZXQgPSBwYWdlLndhbGxldEluZm9UbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgYldpZGdldC5hZnRlcihxV2lkZ2V0KVxuICAgICAgY29uc3Qgd2d0ID0gdGhpcy5iYWxhbmNlV2d0ID0gbmV3IEJhbGFuY2VXaWRnZXQoYldpZGdldCwgcVdpZGdldClcbiAgICAgIGNvbnN0IGJhc2VJY29ucyA9IHdndC5iYXNlLnN0YXRlSWNvbnMuaWNvbnNcbiAgICAgIGNvbnN0IHF1b3RlSWNvbnMgPSB3Z3QucXVvdGUuc3RhdGVJY29ucy5pY29uc1xuICAgICAgYmluZCh3Z3QuYmFzZS50bXBsLmNvbm5lY3QsICdjbGljaycsICgpID0+IHsgdGhpcy51bmxvY2tXYWxsZXQodGhpcy5tYXJrZXQuYmFzZS5pZCkgfSlcbiAgICAgIGJpbmQod2d0LnF1b3RlLnRtcGwuY29ubmVjdCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnVubG9ja1dhbGxldCh0aGlzLm1hcmtldC5xdW90ZS5pZCkgfSlcbiAgICAgIGJpbmQod2d0LmJhc2UudG1wbC5leHBpcmVkLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMudW5sb2NrV2FsbGV0KHRoaXMubWFya2V0LmJhc2UuaWQpIH0pXG4gICAgICBiaW5kKHdndC5xdW90ZS50bXBsLmV4cGlyZWQsICdjbGljaycsICgpID0+IHsgdGhpcy51bmxvY2tXYWxsZXQodGhpcy5tYXJrZXQucXVvdGUuaWQpIH0pXG4gICAgICBiaW5kKGJhc2VJY29ucy5zbGVlcGluZywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnVubG9ja1dhbGxldCh0aGlzLm1hcmtldC5iYXNlLmlkKSB9KVxuICAgICAgYmluZChxdW90ZUljb25zLnNsZWVwaW5nLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMudW5sb2NrV2FsbGV0KHRoaXMubWFya2V0LnF1b3RlLmlkKSB9KVxuICAgICAgYmluZChiYXNlSWNvbnMubG9ja2VkLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMudW5sb2NrV2FsbGV0KHRoaXMubWFya2V0LmJhc2UuaWQpIH0pXG4gICAgICBiaW5kKHF1b3RlSWNvbnMubG9ja2VkLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMudW5sb2NrV2FsbGV0KHRoaXMubWFya2V0LnF1b3RlLmlkKSB9KVxuICAgICAgYmluZChiYXNlSWNvbnMuZGlzYWJsZWQsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93VG9nZ2xlV2FsbGV0U3RhdHVzKHRoaXMubWFya2V0LmJhc2UpIH0pXG4gICAgICBiaW5kKHF1b3RlSWNvbnMuZGlzYWJsZWQsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93VG9nZ2xlV2FsbGV0U3RhdHVzKHRoaXMubWFya2V0LnF1b3RlKSB9KVxuICAgICAgYmluZCh3Z3QuYmFzZS50bXBsLm5ld1dhbGxldEJ0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93Q3JlYXRlKHRoaXMubWFya2V0LmJhc2UpIH0pXG4gICAgICBiaW5kKHdndC5xdW90ZS50bXBsLm5ld1dhbGxldEJ0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93Q3JlYXRlKHRoaXMubWFya2V0LnF1b3RlKSB9KVxuICAgICAgYmluZCh3Z3QuYmFzZS50bXBsLndhbGxldEFkZHIsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93RGVwb3NpdCh0aGlzLm1hcmtldC5iYXNlLmlkKSB9KVxuICAgICAgYmluZCh3Z3QucXVvdGUudG1wbC53YWxsZXRBZGRyLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd0RlcG9zaXQodGhpcy5tYXJrZXQucXVvdGUuaWQpIH0pXG4gICAgICBiaW5kKHdndC5iYXNlLnRtcGwud2FudFByb3ZpZGVycywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dDdXN0b21Qcm92aWRlckRpYWxvZyh0aGlzLm1hcmtldC5iYXNlLmlkKSB9KVxuICAgICAgYmluZCh3Z3QucXVvdGUudG1wbC53YW50UHJvdmlkZXJzLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd0N1c3RvbVByb3ZpZGVyRGlhbG9nKHRoaXMubWFya2V0LnF1b3RlLmlkKSB9KVxuICAgICAgdGhpcy5kZXBvc2l0QWRkckZvcm0gPSBuZXcgRGVwb3NpdEFkZHJlc3MocGFnZS5kZXBvc2l0KVxuICAgIH1cblxuICAgIHRoaXMubW0gPSBuZXcgUnVubmluZ01hcmtldE1ha2VyRGlzcGxheShwYWdlLm1tUnVubmluZywgJ21hcmtldHMnKVxuXG4gICAgdGhpcy5yZXB1dGF0aW9uTWV0ZXIgPSBuZXcgUmVwdXRhdGlvbk1ldGVyKHBhZ2UucmVwdXRhdGlvbk1ldGVyKVxuXG4gICAgLy8gQmluZCB0b2dnbGUgd2FsbGV0IHN0YXR1cyBmb3JtLlxuICAgIGJpbmRGb3JtKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzQ29uZmlybSwgcGFnZS50b2dnbGVXYWxsZXRTdGF0dXNTdWJtaXQsIGFzeW5jICgpID0+IHsgdGhpcy50b2dnbGVXYWxsZXRTdGF0dXMoKSB9KVxuXG4gICAgLy8gUHJlcGFyZSB0ZW1wbGF0ZXMgZm9yIHRoZSBidXkgYW5kIHNlbGwgdGFibGVzIGFuZCB0aGUgdXNlcidzIG9yZGVyIHRhYmxlLlxuICAgIHNldE9wdGlvblRlbXBsYXRlcyhwYWdlKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhcbiAgICAgIHBhZ2Uub3JkZXJSb3dUbXBsLCBwYWdlLmR1ckJ0dG5UZW1wbGF0ZSwgcGFnZS5ib29sZWFuT3B0VG1wbCwgcGFnZS5yYW5nZU9wdFRtcGwsXG4gICAgICBwYWdlLm9yZGVyT3B0VG1wbCwgcGFnZS51c2VyT3JkZXJUbXBsLCBwYWdlLnJlY2VudE1hdGNoZXNUZW1wbGF0ZVxuICAgIClcblxuICAgIC8vIEJ1dHRvbnMgdG8gc2hvdyB0b2tlbiBhcHByb3ZhbCBmb3JtXG4gICAgYmluZChwYWdlLmFwcHJvdmVCYXNlQnR0biwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dUb2tlbkFwcHJvdmFsRm9ybSh0cnVlKSB9KVxuICAgIGJpbmQocGFnZS5hcHByb3ZlUXVvdGVCdHRuLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1Rva2VuQXBwcm92YWxGb3JtKGZhbHNlKSB9KVxuXG4gICAgYmluZChwYWdlLnNob3dUcmFkaW5nVGllciwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5zaG93VHJhZGluZ1RpZXIpXG4gICAgICBEb2Muc2hvdyhwYWdlLnRyYWRpbmdMaW1pdHMpXG4gICAgfSlcbiAgICBiaW5kKHBhZ2Uuc2hvd1RyYWRpbmdSZXB1dGF0aW9uLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLnNob3dUcmFkaW5nUmVwdXRhdGlvbilcbiAgICAgIERvYy5zaG93KHBhZ2UucmVwdXRhdGlvbk1ldGVyKVxuICAgIH0pXG5cbiAgICAvLyBCdXR0b25zIHRvIHNldCBvcmRlciB0eXBlIGFuZCBzaWRlLlxuICAgIGJpbmQocGFnZS5idXlCdHRuLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2V0QnV5KCkgfSlcbiAgICBiaW5kKHBhZ2Uuc2VsbEJ0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zZXRTZWxsKCkgfSlcblxuICAgIGJpbmQocGFnZS5saW1pdEJ0dG4sICdjbGljaycsICgpID0+IHtcbiAgICAgIHN3YXBCdHRucyhwYWdlLm1hcmtldEJ0dG4sIHBhZ2UubGltaXRCdHRuKVxuICAgICAgdGhpcy5zZXRPcmRlclZpc2liaWxpdHkoKVxuICAgICAgaWYgKCFwYWdlLnJhdGVGaWVsZC52YWx1ZSkgcmV0dXJuXG4gICAgICB0aGlzLmRlcHRoTGluZXMuaW5wdXQgPSBbe1xuICAgICAgICByYXRlOiBwYXJzZUZsb2F0RGVmYXVsdChwYWdlLnJhdGVGaWVsZC52YWx1ZSwgMCksXG4gICAgICAgIGNvbG9yOiB0aGlzLmlzU2VsbCgpID8gdGhpcy5kZXB0aENoYXJ0LnRoZW1lLnNlbGxMaW5lIDogdGhpcy5kZXB0aENoYXJ0LnRoZW1lLmJ1eUxpbmVcbiAgICAgIH1dXG4gICAgICB0aGlzLmRyYXdDaGFydExpbmVzKClcbiAgICB9KVxuICAgIGJpbmQocGFnZS5tYXJrZXRCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBzd2FwQnR0bnMocGFnZS5saW1pdEJ0dG4sIHBhZ2UubWFya2V0QnR0bilcbiAgICAgIHRoaXMuc2V0T3JkZXJWaXNpYmlsaXR5KClcbiAgICAgIHRoaXMuc2V0TWFya2V0QnV5T3JkZXJFc3RpbWF0ZSgpXG4gICAgICB0aGlzLmRlcHRoTGluZXMuaW5wdXQgPSBbXVxuICAgICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgfSlcbiAgICBiaW5kKHBhZ2UubWF4T3JkLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5pc1NlbGwoKSkge1xuICAgICAgICBjb25zdCBtYXhTZWxsID0gdGhpcy5tYXJrZXQubWF4U2VsbFxuICAgICAgICBpZiAoIW1heFNlbGwpIHJldHVyblxuICAgICAgICBwYWdlLmxvdEZpZWxkLnZhbHVlID0gU3RyaW5nKG1heFNlbGwuc3dhcC5sb3RzKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbWF4QnV5ID0gdGhpcy5tYXJrZXQubWF4QnV5c1t0aGlzLmFkanVzdGVkUmF0ZSgpXVxuICAgICAgICBpZiAoIW1heEJ1eSkgcmV0dXJuXG4gICAgICAgIHBhZ2UubG90RmllbGQudmFsdWUgPSBTdHJpbmcobWF4QnV5LnN3YXAubG90cylcbiAgICAgIH1cbiAgICAgIHRoaXMubG90Q2hhbmdlZCgpXG4gICAgfSlcblxuICAgIERvYy5kaXNhYmxlTW91c2VXaGVlbChwYWdlLnJhdGVGaWVsZCwgcGFnZS5sb3RGaWVsZCwgcGFnZS5xdHlGaWVsZCwgcGFnZS5ta3RCdXlGaWVsZClcblxuICAgIC8vIEhhbmRsZSB0aGUgZnVsbCBvcmRlcmJvb2sgc2VudCBvbiB0aGUgJ2Jvb2snIHJvdXRlLlxuICAgIHdzLnJlZ2lzdGVyUm91dGUoYm9va1JvdXRlLCAoZGF0YTogQm9va1VwZGF0ZSkgPT4geyB0aGlzLmhhbmRsZUJvb2tSb3V0ZShkYXRhKSB9KVxuICAgIC8vIEhhbmRsZSB0aGUgbmV3IG9yZGVyIGZvciB0aGUgb3JkZXIgYm9vayBvbiB0aGUgJ2Jvb2tfb3JkZXInIHJvdXRlLlxuICAgIHdzLnJlZ2lzdGVyUm91dGUoYm9va09yZGVyUm91dGUsIChkYXRhOiBCb29rVXBkYXRlKSA9PiB7IHRoaXMuaGFuZGxlQm9va09yZGVyUm91dGUoZGF0YSkgfSlcbiAgICAvLyBSZW1vdmUgdGhlIG9yZGVyIHNlbnQgb24gdGhlICd1bmJvb2tfb3JkZXInIHJvdXRlIGZyb20gdGhlIG9yZGVyYm9vay5cbiAgICB3cy5yZWdpc3RlclJvdXRlKHVuYm9va09yZGVyUm91dGUsIChkYXRhOiBCb29rVXBkYXRlKSA9PiB7IHRoaXMuaGFuZGxlVW5ib29rT3JkZXJSb3V0ZShkYXRhKSB9KVxuICAgIC8vIFVwZGF0ZSB0aGUgcmVtYWluaW5nIHF1YW50aXR5IG9uIGEgYm9va2VkIG9yZGVyLlxuICAgIHdzLnJlZ2lzdGVyUm91dGUodXBkYXRlUmVtYWluaW5nUm91dGUsIChkYXRhOiBCb29rVXBkYXRlKSA9PiB7IHRoaXMuaGFuZGxlVXBkYXRlUmVtYWluaW5nUm91dGUoZGF0YSkgfSlcbiAgICAvLyBIYW5kbGUgdGhlIG5ldyBvcmRlciBmb3IgdGhlIG9yZGVyIGJvb2sgb24gdGhlICdlcG9jaF9vcmRlcicgcm91dGUuXG4gICAgd3MucmVnaXN0ZXJSb3V0ZShlcG9jaE9yZGVyUm91dGUsIChkYXRhOiBCb29rVXBkYXRlKSA9PiB7IHRoaXMuaGFuZGxlRXBvY2hPcmRlclJvdXRlKGRhdGEpIH0pXG4gICAgLy8gSGFuZGxlIHRoZSBpbml0aWFsIGNhbmRsZXN0aWNrIGRhdGEgb24gdGhlICdjYW5kbGVzJyByb3V0ZS5cbiAgICB3cy5yZWdpc3RlclJvdXRlKGNhbmRsZXNSb3V0ZSwgKGRhdGE6IEJvb2tVcGRhdGUpID0+IHsgdGhpcy5oYW5kbGVDYW5kbGVzUm91dGUoZGF0YSkgfSlcbiAgICAvLyBIYW5kbGUgdGhlIGNhbmRsZXMgdXBkYXRlIG9uIHRoZSAnY2FuZGxlcycgcm91dGUuXG4gICAgd3MucmVnaXN0ZXJSb3V0ZShjYW5kbGVVcGRhdGVSb3V0ZSwgKGRhdGE6IEJvb2tVcGRhdGUpID0+IHsgdGhpcy5oYW5kbGVDYW5kbGVVcGRhdGVSb3V0ZShkYXRhKSB9KVxuXG4gICAgLy8gSGFuZGxlIHRoZSByZWNlbnQgbWF0Y2hlcyB1cGRhdGUgb24gdGhlICdlcG9jaF9yZXBvcnQnIHJvdXRlLlxuICAgIHdzLnJlZ2lzdGVyUm91dGUoZXBvY2hNYXRjaFN1bW1hcnlSb3V0ZSwgKGRhdGE6IEJvb2tVcGRhdGUpID0+IHsgdGhpcy5oYW5kbGVFcG9jaE1hdGNoU3VtbWFyeShkYXRhKSB9KVxuICAgIC8vIENyZWF0ZSBhIHdhbGxldFxuICAgIHRoaXMubmV3V2FsbGV0Rm9ybSA9IG5ldyBOZXdXYWxsZXRGb3JtKHBhZ2UubmV3V2FsbGV0Rm9ybSwgYXN5bmMgKCkgPT4geyB0aGlzLmNyZWF0ZVdhbGxldCgpIH0pXG4gICAgLy8gTWFpbiBvcmRlciBmb3JtLlxuICAgIGJpbmRGb3JtKHBhZ2Uub3JkZXJGb3JtLCBwYWdlLnN1Ym1pdEJ0dG4sIGFzeW5jICgpID0+IHsgdGhpcy5zdGVwU3VibWl0KCkgfSlcbiAgICAvLyBPcmRlciB2ZXJpZmljYXRpb24gZm9ybS5cbiAgICBiaW5kRm9ybShwYWdlLnZlcmlmeUZvcm0sIHBhZ2UudlN1Ym1pdCwgYXN5bmMgKCkgPT4geyB0aGlzLnN1Ym1pdE9yZGVyKCkgfSlcbiAgICAvLyBDYW5jZWwgb3JkZXIgZm9ybS5cbiAgICBiaW5kRm9ybShwYWdlLmNhbmNlbEZvcm0sIHBhZ2UuY2FuY2VsU3VibWl0LCBhc3luYyAoKSA9PiB7IHRoaXMuc3VibWl0Q2FuY2VsKCkgfSlcbiAgICAvLyBPcmRlciBkZXRhaWwgdmlldy5cbiAgICBEb2MuYmluZChwYWdlLnZGZWVEZXRhaWxzLCAnY2xpY2snLCAoKSA9PiB0aGlzLnNob3dGb3JtKHBhZ2UudkRldGFpbFBhbmUpKVxuICAgIERvYy5iaW5kKHBhZ2UuY2xvc2VEZXRhaWxQYW5lLCAnY2xpY2snLCAoKSA9PiB0aGlzLnNob3dWZXJpZnlGb3JtKCkpXG4gICAgLy8gLy8gQmluZCBhY3RpdmUgb3JkZXJzIGxpc3QncyBoZWFkZXIgc29ydCBldmVudHMuXG4gICAgcGFnZS5yZWNlbnRNYXRjaGVzVGFibGUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtb3JkZXJjb2xdJylcbiAgICAgIC5mb3JFYWNoKCh0aDogSFRNTEVsZW1lbnQpID0+IGJpbmQoXG4gICAgICAgIHRoLCAnY2xpY2snLCAoKSA9PiBzZXRSZWNlbnRNYXRjaGVzU29ydENvbCh0aC5kYXRhc2V0Lm9yZGVyY29sIHx8ICcnKVxuICAgICAgKSlcblxuICAgIGNvbnN0IHNldFJlY2VudE1hdGNoZXNTb3J0Q29sID0gKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAvLyBGaXJzdCB1bnNldCBoZWFkZXIncyBjdXJyZW50IHNvcnRlZCBjb2wgY2xhc3Nlcy5cbiAgICAgIHVuc2V0UmVjZW50TWF0Y2hlc1NvcnRDb2xDbGFzc2VzKClcbiAgICAgIGlmICh0aGlzLnJlY2VudE1hdGNoZXNTb3J0S2V5ID09PSBrZXkpIHtcbiAgICAgICAgdGhpcy5yZWNlbnRNYXRjaGVzU29ydERpcmVjdGlvbiAqPSAtMVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yZWNlbnRNYXRjaGVzU29ydEtleSA9IGtleVxuICAgICAgICB0aGlzLnJlY2VudE1hdGNoZXNTb3J0RGlyZWN0aW9uID0gMVxuICAgICAgfVxuICAgICAgdGhpcy5yZWZyZXNoUmVjZW50TWF0Y2hlc1RhYmxlKClcbiAgICAgIHNldFJlY2VudE1hdGNoZXNTb3J0Q29sQ2xhc3NlcygpXG4gICAgfVxuXG4gICAgLy8gc29ydENsYXNzQnlEaXJlY3Rpb24gcmVjZWl2ZXMgYSBzb3J0IGRpcmVjdGlvbiBhbmQgcmV0dXJuIGEgY2xhc3MgYmFzZWQgb24gaXQuXG4gICAgY29uc3Qgc29ydENsYXNzQnlEaXJlY3Rpb24gPSAoZWxlbWVudDogMSB8IC0xKSA9PiB7XG4gICAgICBpZiAoZWxlbWVudCA9PT0gMSkgcmV0dXJuICdzb3J0ZWQtYXNjJ1xuICAgICAgcmV0dXJuICdzb3J0ZWQtZHNjJ1xuICAgIH1cblxuICAgIGNvbnN0IHVuc2V0UmVjZW50TWF0Y2hlc1NvcnRDb2xDbGFzc2VzID0gKCkgPT4ge1xuICAgICAgcGFnZS5yZWNlbnRNYXRjaGVzVGFibGUucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtb3JkZXJjb2xdJylcbiAgICAgICAgLmZvckVhY2godGggPT4gdGguY2xhc3NMaXN0LnJlbW92ZSgnc29ydGVkLWFzYycsICdzb3J0ZWQtZHNjJykpXG4gICAgfVxuXG4gICAgY29uc3Qgc2V0UmVjZW50TWF0Y2hlc1NvcnRDb2xDbGFzc2VzID0gKCkgPT4ge1xuICAgICAgY29uc3Qga2V5ID0gdGhpcy5yZWNlbnRNYXRjaGVzU29ydEtleVxuICAgICAgY29uc3Qgc29ydENscyA9IHNvcnRDbGFzc0J5RGlyZWN0aW9uKHRoaXMucmVjZW50TWF0Y2hlc1NvcnREaXJlY3Rpb24pXG4gICAgICBEb2Muc2FmZVNlbGVjdG9yKHBhZ2UucmVjZW50TWF0Y2hlc1RhYmxlLCBgW2RhdGEtb3JkZXJjb2w9JHtrZXl9XWApLmNsYXNzTGlzdC5hZGQoc29ydENscylcbiAgICB9XG5cbiAgICAvLyBTZXQgZGVmYXVsdCdzIHNvcnRlZCBjb2wgaGVhZGVyIGNsYXNzZXMuXG4gICAgc2V0UmVjZW50TWF0Y2hlc1NvcnRDb2xDbGFzc2VzKClcblxuICAgIGNvbnN0IGNsb3NlUG9wdXBzID0gKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgdXNlciBjbGlja3Mgb3V0c2lkZSBvZiBhIGZvcm0sIGl0IHNob3VsZCBjbG9zZSB0aGUgcGFnZSBvdmVybGF5LlxuICAgIGJpbmQocGFnZS5mb3JtcywgJ21vdXNlZG93bicsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoRG9jLmlzRGlzcGxheWVkKHBhZ2UudkRldGFpbFBhbmUpICYmICFEb2MubW91c2VJbkVsZW1lbnQoZSwgcGFnZS52RGV0YWlsUGFuZSkpIHJldHVybiB0aGlzLnNob3dWZXJpZnlGb3JtKClcbiAgICAgIGlmICghRG9jLm1vdXNlSW5FbGVtZW50KGUsIHRoaXMuY3VycmVudEZvcm0pKSB7XG4gICAgICAgIGNsb3NlUG9wdXBzKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5rZXl1cCA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIGNsb3NlUG9wdXBzKClcbiAgICAgIH1cbiAgICB9XG4gICAgYmluZChkb2N1bWVudCwgJ2tleXVwJywgdGhpcy5rZXl1cClcblxuICAgIHBhZ2UuZm9ybXMucXVlcnlTZWxlY3RvckFsbCgnLmZvcm0tY2xvc2VyJykuZm9yRWFjaChlbCA9PiB7XG4gICAgICBEb2MuYmluZChlbCwgJ2NsaWNrJywgKCkgPT4geyBjbG9zZVBvcHVwcygpIH0pXG4gICAgfSlcblxuICAgIC8vIEV2ZW50IGxpc3RlbmVycyBmb3IgaW50ZXJhY3Rpb25zIHdpdGggdGhlIHZhcmlvdXMgaW5wdXQgZmllbGRzLlxuICAgIGJpbmQocGFnZS5sb3RGaWVsZCwgWydjaGFuZ2UnLCAna2V5dXAnXSwgKCkgPT4geyB0aGlzLmxvdENoYW5nZWQoKSB9KVxuICAgIGJpbmQocGFnZS5xdHlGaWVsZCwgJ2NoYW5nZScsICgpID0+IHsgdGhpcy5xdWFudGl0eUNoYW5nZWQodHJ1ZSkgfSlcbiAgICBiaW5kKHBhZ2UucXR5RmllbGQsICdrZXl1cCcsICgpID0+IHsgdGhpcy5xdWFudGl0eUNoYW5nZWQoZmFsc2UpIH0pXG4gICAgYmluZChwYWdlLm1rdEJ1eUZpZWxkLCBbJ2NoYW5nZScsICdrZXl1cCddLCAoKSA9PiB7IHRoaXMubWFya2V0QnV5Q2hhbmdlZCgpIH0pXG4gICAgYmluZChwYWdlLnJhdGVGaWVsZCwgJ2NoYW5nZScsICgpID0+IHsgdGhpcy5yYXRlRmllbGRDaGFuZ2VkKCkgfSlcbiAgICBiaW5kKHBhZ2UucmF0ZUZpZWxkLCAna2V5dXAnLCAoKSA9PiB7IHRoaXMucHJldmlld1F1b3RlQW10KHRydWUpIH0pXG5cbiAgICAvLyBNYXJrZXQgc2VhcmNoIGlucHV0IGJpbmRpbmdzLlxuICAgIGJpbmQocGFnZS5tYXJrZXRTZWFyY2hWMSwgWydjaGFuZ2UnLCAna2V5dXAnXSwgKCkgPT4geyB0aGlzLmZpbHRlck1hcmtldHMoKSB9KVxuXG4gICAgLy8gQWNrbm93bGVkZ2UgdGhlIG9yZGVyIGRpc2NsYWltZXIuXG4gICAgY29uc3Qgc2V0RGlzY2xhaW1lckFja1ZpeiA9IChhY2tlZDogYm9vbGVhbikgPT4ge1xuICAgICAgRG9jLnNldFZpcyghYWNrZWQsIHBhZ2UuZGlzY2xhaW1lciwgcGFnZS5kaXNjbGFpbWVyQWNrKVxuICAgICAgRG9jLnNldFZpcyhhY2tlZCwgcGFnZS5zaG93RGlzY2xhaW1lcilcbiAgICB9XG4gICAgYmluZChwYWdlLmRpc2NsYWltZXJBY2ssICdjbGljaycsICgpID0+IHtcbiAgICAgIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUub3JkZXJEaXNjbGFpbWVyQWNrZWRMSywgdHJ1ZSlcbiAgICAgIHNldERpc2NsYWltZXJBY2tWaXoodHJ1ZSlcbiAgICB9KVxuICAgIGJpbmQocGFnZS5zaG93RGlzY2xhaW1lciwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5vcmRlckRpc2NsYWltZXJBY2tlZExLLCBmYWxzZSlcbiAgICAgIHNldERpc2NsYWltZXJBY2tWaXooZmFsc2UpXG4gICAgfSlcbiAgICBzZXREaXNjbGFpbWVyQWNrVml6KFN0YXRlLmZldGNoTG9jYWwoU3RhdGUub3JkZXJEaXNjbGFpbWVyQWNrZWRMSykpXG5cbiAgICBjb25zdCBjbGVhckNoYXJ0TGluZXMgPSAoKSA9PiB7XG4gICAgICB0aGlzLmRlcHRoTGluZXMuaG92ZXIgPSBbXVxuICAgICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgfVxuICAgIGJpbmQocGFnZS5idXlSb3dzLCAnbW91c2VsZWF2ZScsIGNsZWFyQ2hhcnRMaW5lcylcbiAgICBiaW5kKHBhZ2Uuc2VsbFJvd3MsICdtb3VzZWxlYXZlJywgY2xlYXJDaGFydExpbmVzKVxuICAgIGJpbmQocGFnZS51c2VyT3JkZXJzLCAnbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgIHRoaXMuYWN0aXZlTWFya2VyUmF0ZSA9IG51bGxcbiAgICAgIHRoaXMuc2V0RGVwdGhNYXJrZXJzKClcbiAgICB9KVxuXG4gICAgY29uc3Qgc3RhdHMwID0gcGFnZS5tYXJrZXRTdGF0c1xuICAgIGNvbnN0IHN0YXRzMSA9IHN0YXRzMC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBzdGF0czEuY2xhc3NMaXN0LmFkZCgnbGlzdG9wZW4nKVxuICAgIERvYy5oaWRlKHN0YXRzMCwgc3RhdHMxKVxuICAgIHN0YXRzMS5yZW1vdmVBdHRyaWJ1dGUoJ2lkJylcbiAgICBhcHAoKS5oZWFkZXJTcGFjZS5hcHBlbmRDaGlsZChzdGF0czEpXG4gICAgdGhpcy5zdGF0cyA9IFt7IHJvdzogc3RhdHMwLCB0bXBsOiBEb2MucGFyc2VUZW1wbGF0ZShzdGF0czApIH0sIHsgcm93OiBzdGF0czEsIHRtcGw6IERvYy5wYXJzZVRlbXBsYXRlKHN0YXRzMSkgfV1cblxuICAgIGNvbnN0IGNsb3NlTWFya2V0c0xpc3QgPSAoKSA9PiB7XG4gICAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmxlZnRNYXJrZXREb2NrTEssICcwJylcbiAgICAgIHBhZ2UubGVmdE1hcmtldERvY2suY2xhc3NMaXN0LnJlbW92ZSgnZGVmYXVsdCcpXG4gICAgICBwYWdlLmxlZnRNYXJrZXREb2NrLmNsYXNzTGlzdC5hZGQoJ3N0YXNoZWQnKVxuICAgICAgZm9yIChjb25zdCBzIG9mIHRoaXMuc3RhdHMpIHMucm93LmNsYXNzTGlzdC5yZW1vdmUoJ2xpc3RvcGVuJylcbiAgICB9XG4gICAgY29uc3Qgb3Blbk1hcmtldHNMaXN0ID0gKCkgPT4ge1xuICAgICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5sZWZ0TWFya2V0RG9ja0xLLCAnMScpXG4gICAgICBwYWdlLmxlZnRNYXJrZXREb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2RlZmF1bHQnLCAnc3Rhc2hlZCcpXG4gICAgICBmb3IgKGNvbnN0IHMgb2YgdGhpcy5zdGF0cykgcy5yb3cuY2xhc3NMaXN0LmFkZCgnbGlzdG9wZW4nKVxuICAgIH1cbiAgICBEb2MuYmluZChwYWdlLmxlZnRIaWRlciwgJ2NsaWNrJywgKCkgPT4gY2xvc2VNYXJrZXRzTGlzdCgpKVxuICAgIERvYy5iaW5kKHBhZ2UubWFya2V0UmVvcGVuZXIsICdjbGljaycsICgpID0+IG9wZW5NYXJrZXRzTGlzdCgpKVxuICAgIGZvciAoY29uc3QgcyBvZiB0aGlzLnN0YXRzKSB7XG4gICAgICBEb2MuYmluZChzLnRtcGwubWFya2V0U2VsZWN0LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGlmIChwYWdlLmxlZnRNYXJrZXREb2NrLmNsaWVudFdpZHRoID09PSAwKSBvcGVuTWFya2V0c0xpc3QoKVxuICAgICAgICBlbHNlIGNsb3NlTWFya2V0c0xpc3QoKVxuICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5tYXJrZXRMaXN0ID0gbmV3IE1hcmtldExpc3QocGFnZS5tYXJrZXRMaXN0VjEpXG4gICAgLy8gUHJlcGFyZSB0aGUgbGlzdCBvZiBtYXJrZXRzLlxuICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMubWFya2V0TGlzdC5tYXJrZXRzKSB7XG4gICAgICBiaW5kKHJvdy5ub2RlLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIC8vIHJldHVybiBlYXJseSBpZiB0aGUgbWFya2V0IGlzIGFscmVhZHkgc2V0XG4gICAgICAgIGNvbnN0IHsgcXVvdGVpZDogcXVvdGVJRCwgYmFzZWlkOiBiYXNlSUQsIHhjOiB7IGhvc3QgfSB9ID0gcm93Lm1rdFxuICAgICAgICBpZiAodGhpcy5tYXJrZXQ/LmJhc2U/LmlkID09PSBiYXNlSUQgJiYgdGhpcy5tYXJrZXQ/LnF1b3RlPy5pZCA9PT0gcXVvdGVJRCkgcmV0dXJuXG4gICAgICAgIHRoaXMuc3RhcnRMb2FkaW5nQW5pbWF0aW9ucygpXG4gICAgICAgIHRoaXMuc2V0TWFya2V0KGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICAgIH0pXG4gICAgfVxuICAgIGlmIChTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmxlZnRNYXJrZXREb2NrTEspICE9PSAnMScpIHsgLy8gSXQgaXMgc2hvd24gYnkgZGVmYXVsdCwgaGlkaW5nIGlmIG5lY2Vzc2FyeS5cbiAgICAgIGNsb3NlTWFya2V0c0xpc3QoKVxuICAgIH1cblxuICAgIC8vIE5vdGlmaWNhdGlvbiBmaWx0ZXJzLlxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBvcmRlcjogKG5vdGU6IE9yZGVyTm90ZSkgPT4geyB0aGlzLmhhbmRsZU9yZGVyTm90ZShub3RlKSB9LFxuICAgICAgbWF0Y2g6IChub3RlOiBNYXRjaE5vdGUpID0+IHsgdGhpcy5oYW5kbGVNYXRjaE5vdGUobm90ZSkgfSxcbiAgICAgIGVwb2NoOiAobm90ZTogRXBvY2hOb3RlKSA9PiB7IHRoaXMuaGFuZGxlRXBvY2hOb3RlKG5vdGUpIH0sXG4gICAgICBjb25uOiAobm90ZTogQ29ubkV2ZW50Tm90ZSkgPT4geyB0aGlzLmhhbmRsZUNvbm5Ob3RlKG5vdGUpIH0sXG4gICAgICBiYWxhbmNlOiAobm90ZTogQmFsYW5jZU5vdGUpID0+IHsgdGhpcy5oYW5kbGVCYWxhbmNlTm90ZShub3RlKSB9LFxuICAgICAgYm9uZHBvc3Q6IChub3RlOiBCb25kTm90ZSkgPT4geyB0aGlzLmhhbmRsZUJvbmRVcGRhdGUobm90ZSkgfSxcbiAgICAgIHNwb3RzOiAobm90ZTogU3BvdFByaWNlTm90ZSkgPT4geyB0aGlzLmhhbmRsZVByaWNlVXBkYXRlKG5vdGUpIH0sXG4gICAgICB3YWxsZXRzdGF0ZTogKG5vdGU6IFdhbGxldFN0YXRlTm90ZSkgPT4geyB0aGlzLmhhbmRsZVdhbGxldFN0YXRlKG5vdGUpIH0sXG4gICAgICByZXB1dGF0aW9uOiAoKSA9PiB7IHRoaXMudXBkYXRlUmVwdXRhdGlvbigpIH0sXG4gICAgICBmZWVwYXltZW50OiAoKSA9PiB7IHRoaXMudXBkYXRlUmVwdXRhdGlvbigpIH0sXG4gICAgICBydW5zdGF0czogKG5vdGU6IFJ1blN0YXRzTm90ZSkgPT4ge1xuICAgICAgICB0aGlzLm1tLnVwZGF0ZSgpXG4gICAgICAgIGlmIChub3RlLmJhc2VJRCAhPT0gdGhpcy5tYXJrZXQuYmFzZS5pZCB8fCBub3RlLnF1b3RlSUQgIT09IHRoaXMubWFya2V0LnF1b3RlLmlkIHx8IG5vdGUuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QpIHJldHVyblxuICAgICAgICBpZiAoQm9vbGVhbih0aGlzLm1tUnVubmluZykgIT09IEJvb2xlYW4obm90ZS5zdGF0cykpIHtcbiAgICAgICAgICB0aGlzLm1tUnVubmluZyA9IEJvb2xlYW4obm90ZS5zdGF0cylcbiAgICAgICAgICB0aGlzLnJlc29sdmVPcmRlckZvcm1WaXNpYmlsaXR5KClcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJ1bmV2ZW50OiAobm90ZTogUnVuRXZlbnROb3RlKSA9PiB7XG4gICAgICAgIGlmIChub3RlLmJhc2VJRCAhPT0gdGhpcy5tYXJrZXQuYmFzZS5pZCB8fCBub3RlLnF1b3RlSUQgIT09IHRoaXMubWFya2V0LnF1b3RlLmlkIHx8IG5vdGUuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QpIHJldHVyblxuICAgICAgICB0aGlzLm1tLnVwZGF0ZSgpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMubG9hZGluZ0FuaW1hdGlvbnMgPSB7fVxuICAgIHRoaXMuc3RhcnRMb2FkaW5nQW5pbWF0aW9ucygpXG5cbiAgICAvLyBTdGFydCBhIHRpY2tlciB0byB1cGRhdGUgdGltZS1zaW5jZSB2YWx1ZXMuXG4gICAgdGhpcy5zZWNvbmRUaWNrZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgZm9yIChjb25zdCBtb3JkIG9mIE9iamVjdC52YWx1ZXModGhpcy5tZXRhT3JkZXJzKSkge1xuICAgICAgICBtb3JkLmRldGFpbHMuYWdlLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShtb3JkLm9yZC5zdWJtaXRUaW1lKVxuICAgICAgfVxuICAgICAgZm9yIChjb25zdCB0ZCBvZiBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLnJlY2VudE1hdGNoZXNMaXZlTGlzdCwgJ1tkYXRhLXRtcGw9YWdlXScpKSB7XG4gICAgICAgIHRkLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShwYXJzZUZsb2F0KHRkLmRhdGFzZXQuc2luY2VTdGFtcCA/PyAnMCcpKVxuICAgICAgfVxuICAgIH0sIDEwMDApXG5cbiAgICB0aGlzLmluaXQocGFnZVBhcmFtcylcbiAgfVxuXG4gIGFzeW5jIGluaXQgKHBhZ2VQYXJhbXM/OiBNYXJrZXRzUGFnZVBhcmFtcykge1xuICAgIC8vIEZldGNoIHRoZSBmaXJzdCBtYXJrZXQgaW4gdGhlIGxpc3QsIG9yIHRoZSB1c2VycyBsYXN0IHNlbGVjdGVkIG1hcmtldCwgaWZcbiAgICAvLyBpdCBleGlzdHMuXG4gICAgbGV0IHNlbGVjdGVkXG4gICAgaWYgKHBhZ2VQYXJhbXM/Lmhvc3QpIHtcbiAgICAgIHNlbGVjdGVkID0gbWFrZU1hcmtldChwYWdlUGFyYW1zLmhvc3QsIHBhcnNlSW50KHBhZ2VQYXJhbXMuYmFzZUlEKSwgcGFyc2VJbnQocGFnZVBhcmFtcy5xdW90ZUlEKSlcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZWN0ZWQgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmxhc3RNYXJrZXRMSylcbiAgICB9XG4gICAgaWYgKCFzZWxlY3RlZCB8fCAhdGhpcy5tYXJrZXRMaXN0LmV4aXN0cyhzZWxlY3RlZC5ob3N0LCBzZWxlY3RlZC5iYXNlLCBzZWxlY3RlZC5xdW90ZSkpIHtcbiAgICAgIGNvbnN0IGZpcnN0ID0gdGhpcy5tYXJrZXRMaXN0LmZpcnN0KClcbiAgICAgIGlmIChmaXJzdCkgc2VsZWN0ZWQgPSB7IGhvc3Q6IGZpcnN0Lm1rdC54Yy5ob3N0LCBiYXNlOiBmaXJzdC5ta3QuYmFzZWlkLCBxdW90ZTogZmlyc3QubWt0LnF1b3RlaWQgfVxuICAgIH1cbiAgICBpZiAoc2VsZWN0ZWQpIHRoaXMuc2V0TWFya2V0KHNlbGVjdGVkLmhvc3QsIHNlbGVjdGVkLmJhc2UsIHNlbGVjdGVkLnF1b3RlKVxuICAgIGVsc2UgdGhpcy5iYWxhbmNlV2d0LnNldEJhbGFuY2VWaXNpYmlsaXR5KGZhbHNlKSAvLyBubyBtYXJrZXQgdG8gZGlzcGxheSBiYWxhbmNlIHdpZGdldCBmb3IuXG5cbiAgICAvLyBzZXQgdGhlIGluaXRpYWwgc3RhdGUgZm9yIHRoZSByZWdpc3RyYXRpb24gc3RhdHVzXG4gICAgdGhpcy5zZXRSZWdpc3RyYXRpb25TdGF0dXNWaXNpYmlsaXR5KClcbiAgfVxuXG4gIHN0YXJ0TG9hZGluZ0FuaW1hdGlvbnMgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbG9hZGluZ0FuaW1hdGlvbnM6IGFuaXMsIGRlcHRoQ2hhcnQsIGNhbmRsZUNoYXJ0IH0gPSB0aGlzXG4gICAgZGVwdGhDaGFydC5jYW52YXMuY2xhc3NMaXN0LmFkZCgnaW52aXNpYmxlJylcbiAgICBjYW5kbGVDaGFydC5jYW52YXMuY2xhc3NMaXN0LmFkZCgnaW52aXNpYmxlJylcbiAgICBpZiAoYW5pcy5jYW5kbGVzKSBhbmlzLmNhbmRsZXMuc3RvcCgpXG4gICAgYW5pcy5jYW5kbGVzID0gbmV3IFdhdmUocGFnZS5jYW5kbGVzQ2hhcnQsIHsgbWVzc2FnZTogaW50bC5wcmVwKGludGwuSURfQ0FORExFU19MT0FESU5HKSB9KVxuICAgIGlmIChhbmlzLmRlcHRoKSBhbmlzLmRlcHRoLnN0b3AoKVxuICAgIGFuaXMuZGVwdGggPSBuZXcgV2F2ZShwYWdlLmRlcHRoQ2hhcnQsIHsgbWVzc2FnZTogaW50bC5wcmVwKGludGwuSURfREVQVEhfTE9BRElORykgfSlcbiAgfVxuXG4gIC8qIGlzU2VsbCBpcyB0cnVlIGlmIHRoZSB1c2VyIGhhcyBzZWxlY3RlZCBzZWxsIGluIHRoZSBvcmRlciBvcHRpb25zLiAqL1xuICBpc1NlbGwgKCkge1xuICAgIHJldHVybiB0aGlzLnBhZ2Uuc2VsbEJ0dG4uY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpXG4gIH1cblxuICAvKiBpc0xpbWl0IGlzIHRydWUgaWYgdGhlIHVzZXIgaGFzIHNlbGVjdGVkIHRoZSBcImxpbWl0IG9yZGVyXCIgdGFiLiAqL1xuICBpc0xpbWl0ICgpIHtcbiAgICByZXR1cm4gdGhpcy5wYWdlLmxpbWl0QnR0bi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJylcbiAgfVxuXG4gIHNldEJ1eSAoKSB7XG4gICAgY29uc3QgeyBwYWdlIH0gPSB0aGlzXG4gICAgc3dhcEJ0dG5zKHBhZ2Uuc2VsbEJ0dG4sIHBhZ2UuYnV5QnR0bilcbiAgICBwYWdlLnN1Ym1pdEJ0dG4uY2xhc3NMaXN0LnJlbW92ZShzZWxsQnRuQ2xhc3MpXG4gICAgcGFnZS5zdWJtaXRCdHRuLmNsYXNzTGlzdC5hZGQoYnV5QnRuQ2xhc3MpXG4gICAgcGFnZS5tYXhMYmwudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9CVVkpXG4gICAgdGhpcy5zZXRPcmRlckJ0dG5UZXh0KClcbiAgICB0aGlzLnNldE9yZGVyVmlzaWJpbGl0eSgpXG4gICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgaWYgKCF0aGlzLmlzTGltaXQoKSkge1xuICAgICAgdGhpcy5tYXJrZXRCdXlDaGFuZ2VkKClcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jdXJyZW50T3JkZXIgPSB0aGlzLnBhcnNlT3JkZXIoKVxuICAgICAgdGhpcy51cGRhdGVPcmRlckJ0dG5TdGF0ZSgpXG4gICAgfVxuICB9XG5cbiAgc2V0U2VsbCAoKSB7XG4gICAgY29uc3QgeyBwYWdlIH0gPSB0aGlzXG4gICAgc3dhcEJ0dG5zKHBhZ2UuYnV5QnR0biwgcGFnZS5zZWxsQnR0bilcbiAgICBwYWdlLnN1Ym1pdEJ0dG4uY2xhc3NMaXN0LmFkZChzZWxsQnRuQ2xhc3MpXG4gICAgcGFnZS5zdWJtaXRCdHRuLmNsYXNzTGlzdC5yZW1vdmUoYnV5QnRuQ2xhc3MpXG4gICAgcGFnZS5tYXhMYmwudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9TRUxMKVxuICAgIHRoaXMuc2V0T3JkZXJCdHRuVGV4dCgpXG4gICAgdGhpcy5zZXRPcmRlclZpc2liaWxpdHkoKVxuICAgIHRoaXMuZHJhd0NoYXJ0TGluZXMoKVxuICAgIHRoaXMuY3VycmVudE9yZGVyID0gdGhpcy5wYXJzZU9yZGVyKClcbiAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgfVxuXG4gIC8qIGhhc1BlbmRpbmdCb25kcyBpcyB0cnVlIGlmIHRoZXJlIGFyZSBwZW5kaW5nIGJvbmRzICovXG4gIGhhc1BlbmRpbmdCb25kcyAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMubWFya2V0LmRleC5hdXRoLnBlbmRpbmdCb25kcyB8fCBbXSkubGVuZ3RoID4gMFxuICB9XG5cbiAgLyogc2V0Q3Vyck1hcmtldFByaWNlIHVwZGF0ZXMgdGhlIGN1cnJlbnQgbWFya2V0IHByaWNlIG9uIHRoZSBzdGF0cyBkaXNwbGF5c1xuICAgICBhbmQgdGhlIG9yZGVyYm9vayBkaXNwbGF5LiAqL1xuICBzZXRDdXJyTWFya2V0UHJpY2UgKCk6IHZvaWQge1xuICAgIGNvbnN0IHNlbGVjdGVkID0gdGhpcy5tYXJrZXRcbiAgICBpZiAoIXNlbGVjdGVkKSByZXR1cm5cbiAgICAvLyBHZXQgYW4gdXAtdG8tZGF0ZSBNYXJrZXQuXG4gICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbc2VsZWN0ZWQuZGV4Lmhvc3RdXG4gICAgY29uc3QgbWt0ID0geGMubWFya2V0c1tzZWxlY3RlZC5jZmcubmFtZV1cbiAgICBpZiAoIW1rdC5zcG90KSByZXR1cm5cblxuICAgIGZvciAoY29uc3QgcyBvZiB0aGlzLnN0YXRzKSB7XG4gICAgICBjb25zdCB7IHVuaXRJbmZvOiB7IGNvbnZlbnRpb25hbDogeyBjb252ZXJzaW9uRmFjdG9yOiBjRmFjdG9yLCB1bml0IH0gfSB9ID0geGMuYXNzZXRzW21rdC5iYXNlaWRdXG4gICAgICBjb25zdCBmaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtta3QuYmFzZWlkXVxuICAgICAgaWYgKGZpYXRSYXRlKSB7XG4gICAgICAgIHMudG1wbC52b2x1bWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MobWt0LnNwb3Qudm9sMjQgLyBjRmFjdG9yICogZmlhdFJhdGUpXG4gICAgICAgIHMudG1wbC52b2xVbml0LnRleHRDb250ZW50ID0gJ1VTRCdcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHMudG1wbC52b2x1bWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MobWt0LnNwb3Qudm9sMjQgLyBjRmFjdG9yKVxuICAgICAgICBzLnRtcGwudm9sVW5pdC50ZXh0Q29udGVudCA9IHVuaXRcbiAgICAgIH1cbiAgICAgIHNldFByaWNlQW5kQ2hhbmdlKHMudG1wbCwgeGMsIG1rdClcbiAgICB9XG5cbiAgICB0aGlzLnBhZ2Uub2JQcmljZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhta3Quc3BvdC5yYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgdGhpcy5wYWdlLm9iUHJpY2UuY2xhc3NMaXN0LnJlbW92ZSgnc2VsbGNvbG9yJywgJ2J1eWNvbG9yJylcbiAgICB0aGlzLnBhZ2Uub2JQcmljZS5jbGFzc0xpc3QuYWRkKG1rdC5zcG90LmNoYW5nZTI0ID49IDAgPyAnYnV5Y29sb3InIDogJ3NlbGxjb2xvcicpXG4gICAgRG9jLnNldFZpcyhta3Quc3BvdC5jaGFuZ2UyNCA+PSAwLCB0aGlzLnBhZ2Uub2JVcClcbiAgICBEb2Muc2V0VmlzKG1rdC5zcG90LmNoYW5nZTI0IDwgMCwgdGhpcy5wYWdlLm9iRG93bilcbiAgfVxuXG4gIC8qIHNldE1hcmtldERldGFpbHMgdXBkYXRlcyB0aGUgY3VycmVuY3kgbmFtZXMgb24gdGhlIHN0YXRzIGRpc3BsYXlzLiAqL1xuICBzZXRNYXJrZXREZXRhaWxzICgpIHtcbiAgICBpZiAoIXRoaXMubWFya2V0KSByZXR1cm5cbiAgICBmb3IgKGNvbnN0IHMgb2YgdGhpcy5zdGF0cykge1xuICAgICAgY29uc3QgeyBiYXNlQ2ZnOiBiYSwgcXVvdGVDZmc6IHFhIH0gPSB0aGlzLm1hcmtldFxuICAgICAgcy50bXBsLmJhc2VJY29uLnNyYyA9IERvYy5sb2dvUGF0aChiYS5zeW1ib2wpXG4gICAgICBzLnRtcGwucXVvdGVJY29uLnNyYyA9IERvYy5sb2dvUGF0aChxYS5zeW1ib2wpXG4gICAgICBEb2MuZW1wdHkocy50bXBsLmJhc2VTeW1ib2wsIHMudG1wbC5xdW90ZVN5bWJvbClcbiAgICAgIHMudG1wbC5iYXNlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUoYmEsIHRydWUpKVxuICAgICAgcy50bXBsLnF1b3RlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUocWEsIHRydWUpKVxuICAgIH1cbiAgfVxuXG4gIC8qIHNldEhpZ2hMb3cgY2FsY3VsYXRlcyB0aGUgaGlnaCBhbmQgbG93IHJhdGVzIG92ZXIgdGhlIGxhc3QgMjQgaG91cnMuICovXG4gIHNldEhpZ2hMb3cgKCkge1xuICAgIGxldCBbaGlnaCwgbG93XSA9IFswLCAwXVxuICAgIGNvbnN0IHNwb3QgPSB0aGlzLm1hcmtldC5jZmcuc3BvdFxuICAgIC8vIFVzZSBzcG90IHZhbHVlcyBmb3IgMjQgaG91cnMgaGlnaCBhbmQgbG93IHJhdGVzIGlmIGl0IGlzIGF2YWlsYWJsZS4gV2VcbiAgICAvLyB3aWxsIGRlZmF1bHQgdG8gc2V0dGluZyBpdCBmcm9tIGNhbmRsZXMgaWYgaXQncyBub3QuXG4gICAgaWYgKHNwb3QgJiYgc3BvdC5sb3cyNCAmJiBzcG90LmhpZ2gyNCkge1xuICAgICAgaGlnaCA9IHNwb3QuaGlnaDI0XG4gICAgICBsb3cgPSBzcG90LmxvdzI0XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5tYXJrZXQ/LmNhbmRsZUNhY2hlc1tmaXZlTWluQmluS2V5XVxuICAgICAgaWYgKCFjYWNoZSkge1xuICAgICAgICBpZiAodGhpcy5jYW5kbGVEdXIgIT09IGZpdmVNaW5CaW5LZXkpIHtcbiAgICAgICAgICB0aGlzLnJlcXVlc3RDYW5kbGVzKGZpdmVNaW5CaW5LZXkpXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHRoaXMuc3RhdHMpIHtcbiAgICAgICAgICBzLnRtcGwuaGlnaC50ZXh0Q29udGVudCA9ICctJ1xuICAgICAgICAgIHMudG1wbC5sb3cudGV4dENvbnRlbnQgPSAnLSdcbiAgICAgICAgfVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLy8gU2V0IGhpZ2ggYW5kIGxvdyByYXRlcyBmcm9tIGNhbmRsZXMuXG4gICAgICBjb25zdCBhRGF5QWdvID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLSA4NjQwMDAwMFxuICAgICAgZm9yIChsZXQgaSA9IGNhY2hlLmNhbmRsZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY29uc3QgYyA9IGNhY2hlLmNhbmRsZXNbaV1cbiAgICAgICAgaWYgKGMuZW5kU3RhbXAgPCBhRGF5QWdvKSBicmVha1xuICAgICAgICBpZiAobG93ID09PSAwIHx8IChjLmxvd1JhdGUgPiAwICYmIGMubG93UmF0ZSA8IGxvdykpIGxvdyA9IGMubG93UmF0ZVxuICAgICAgICBpZiAoYy5oaWdoUmF0ZSA+IGhpZ2gpIGhpZ2ggPSBjLmhpZ2hSYXRlXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgYmFzZUlEID0gdGhpcy5tYXJrZXQuYmFzZS5pZFxuICAgIGNvbnN0IHF1b3RlSUQgPSB0aGlzLm1hcmtldC5xdW90ZS5pZFxuICAgIGNvbnN0IGRleCA9IHRoaXMubWFya2V0LmRleFxuICAgIGZvciAoY29uc3QgcyBvZiB0aGlzLnN0YXRzKSB7XG4gICAgICBzLnRtcGwuaGlnaC50ZXh0Q29udGVudCA9IGhpZ2ggPiAwID8gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGFwcCgpLmNvbnZlbnRpb25hbFJhdGUoYmFzZUlELCBxdW90ZUlELCBoaWdoLCBkZXgpKSA6ICctJ1xuICAgICAgcy50bXBsLmxvdy50ZXh0Q29udGVudCA9IGxvdyA+IDAgPyBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIGxvdywgZGV4KSkgOiAnLSdcbiAgICB9XG4gIH1cblxuICAvKiBhc3NldHNBcmVTdXBwb3J0ZWQgaXMgdHJ1ZSBpZiBhbGwgdGhlIGFzc2V0cyBvZiB0aGUgY3VycmVudCBtYXJrZXQgYXJlXG4gICAqIHN1cHBvcnRlZFxuICAgKi9cbiAgYXNzZXRzQXJlU3VwcG9ydGVkICgpOiB7XG4gICAgaXNTdXBwb3J0ZWQ6IGJvb2xlYW47XG4gICAgdGV4dDogc3RyaW5nO1xuICAgIH0ge1xuICAgIGNvbnN0IHsgbWFya2V0OiB7IGJhc2UsIHF1b3RlLCBiYXNlQ2ZnLCBxdW90ZUNmZyB9IH0gPSB0aGlzXG4gICAgaWYgKCFiYXNlIHx8ICFxdW90ZSkge1xuICAgICAgY29uc3Qgc3ltYm9sID0gYmFzZSA/IHF1b3RlQ2ZnLnN5bWJvbCA6IGJhc2VDZmcuc3ltYm9sXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1N1cHBvcnRlZDogZmFsc2UsXG4gICAgICAgIHRleHQ6IGludGwucHJlcChpbnRsLklEX05PVF9TVVBQT1JURUQsIHsgYXNzZXQ6IHN5bWJvbC50b1VwcGVyQ2FzZSgpIH0pXG4gICAgICB9XG4gICAgfVxuICAgIC8vIGNoZWNrIGlmIHZlcnNpb25zIGFyZSBzdXBwb3J0ZWQuIElmIGFzc2V0IGlzIGEgdG9rZW4sIHdlIGNoZWNrIGlmIGl0c1xuICAgIC8vIHBhcmVudCBzdXBwb3J0cyB0aGUgdmVyc2lvbi5cbiAgICBjb25zdCBiVmVycyA9IChiYXNlLnRva2VuID8gYXBwKCkuYXNzZXRzW2Jhc2UudG9rZW4ucGFyZW50SURdLmluZm8/LnZlcnNpb25zIDogYmFzZS5pbmZvPy52ZXJzaW9ucykgYXMgbnVtYmVyW11cbiAgICBjb25zdCBxVmVycyA9IChxdW90ZS50b2tlbiA/IGFwcCgpLmFzc2V0c1txdW90ZS50b2tlbi5wYXJlbnRJRF0uaW5mbz8udmVyc2lvbnMgOiBxdW90ZS5pbmZvPy52ZXJzaW9ucykgYXMgbnVtYmVyW11cbiAgICAvLyBpZiBub25lIHRoZW0gYXJlIHRva2VuLCBqdXN0IGNoZWNrIGlmIG93biBhc3NldCBpcyBzdXBwb3J0ZWQuXG4gICAgbGV0IHRleHQgPSAnJ1xuICAgIGlmICghYlZlcnMuaW5jbHVkZXMoYmFzZUNmZy52ZXJzaW9uKSkge1xuICAgICAgdGV4dCA9IGludGwucHJlcChpbnRsLklEX1ZFUlNJT05fTk9UX1NVUFBPUlRFRCwgeyBhc3NldDogYmFzZS5zeW1ib2wudG9VcHBlckNhc2UoKSwgdmVyc2lvbjogYmFzZUNmZy52ZXJzaW9uICsgJycgfSlcbiAgICB9IGVsc2UgaWYgKCFxVmVycy5pbmNsdWRlcyhxdW90ZUNmZy52ZXJzaW9uKSkge1xuICAgICAgdGV4dCA9IGludGwucHJlcChpbnRsLklEX1ZFUlNJT05fTk9UX1NVUFBPUlRFRCwgeyBhc3NldDogcXVvdGUuc3ltYm9sLnRvVXBwZXJDYXNlKCksIHZlcnNpb246IHF1b3RlQ2ZnLnZlcnNpb24gKyAnJyB9KVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgaXNTdXBwb3J0ZWQ6IGJWZXJzLmluY2x1ZGVzKGJhc2VDZmcudmVyc2lvbikgJiYgcVZlcnMuaW5jbHVkZXMocXVvdGVDZmcudmVyc2lvbiksXG4gICAgICB0ZXh0XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogc2V0T3JkZXJWaXNpYmlsaXR5IHNldHMgd2hpY2ggZm9ybSBpcyB2aXNpYmxlIGJhc2VkIG9uIHRoZSBzcGVjaWZpZWRcbiAgICogb3B0aW9ucy5cbiAgICovXG4gIHNldE9yZGVyVmlzaWJpbGl0eSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGlmICh0aGlzLmlzTGltaXQoKSkge1xuICAgICAgRG9jLnNob3cocGFnZS5wcmljZUJveCwgcGFnZS50aWZCb3gsIHBhZ2UucXR5Qm94LCBwYWdlLm1heEJveClcbiAgICAgIERvYy5oaWRlKHBhZ2UubWt0QnV5Qm94KVxuICAgICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQodHJ1ZSlcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS50aWZCb3gsIHBhZ2UubWF4Qm94LCBwYWdlLnByaWNlQm94KVxuICAgICAgaWYgKHRoaXMuaXNTZWxsKCkpIHtcbiAgICAgICAgRG9jLmhpZGUocGFnZS5ta3RCdXlCb3gpXG4gICAgICAgIERvYy5zaG93KHBhZ2UucXR5Qm94KVxuICAgICAgICB0aGlzLnByZXZpZXdRdW90ZUFtdCh0cnVlKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS5ta3RCdXlCb3gpXG4gICAgICAgIERvYy5oaWRlKHBhZ2UucXR5Qm94KVxuICAgICAgICB0aGlzLnByZXZpZXdRdW90ZUFtdChmYWxzZSlcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy51cGRhdGVPcmRlckJ0dG5TdGF0ZSgpXG4gIH1cblxuICAvKiByZXNvbHZlT3JkZXJGb3JtVmlzaWJpbGl0eSBkaXNwbGF5cyBvciBoaWRlcyB0aGUgJ29yZGVyRm9ybScgYmFzZWQgb25cbiAgICogYSBzZXQgb2YgY29uZGl0aW9ucyB0byBiZSBtZXQuXG4gICAqL1xuICBhc3luYyByZXNvbHZlT3JkZXJGb3JtVmlzaWJpbGl0eSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuXG4gICAgY29uc3Qgc2hvd09yZGVyRm9ybSA9IGFzeW5jICgpIDogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgICBpZiAoIXRoaXMuYXNzZXRzQXJlU3VwcG9ydGVkKCkuaXNTdXBwb3J0ZWQpIHJldHVybiBmYWxzZSAvLyBhc3NldHMgbm90IHN1cHBvcnRlZFxuXG4gICAgICBpZiAoIXRoaXMubWFya2V0IHx8IHRoaXMubWFya2V0LmRleC5hdXRoLmVmZmVjdGl2ZVRpZXIgPCAxKSByZXR1cm4gZmFsc2UvLyBhY2N0IHN1c3BlbmRlZCBvciBub3QgcmVnaXN0ZXJlZFxuXG4gICAgICBjb25zdCB7IGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzLCBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgfSA9IHRoaXMudG9rZW5Bc3NldEFwcHJvdmFsU3RhdHVzZXMoKVxuICAgICAgaWYgKGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzICE9PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCB8fCBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgIT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkKSByZXR1cm4gZmFsc2VcblxuICAgICAgY29uc3QgeyBiYXNlLCBxdW90ZSB9ID0gdGhpcy5tYXJrZXRcbiAgICAgIGNvbnN0IGhhc1dhbGxldHMgPSBiYXNlICYmIGFwcCgpLmFzc2V0c1tiYXNlLmlkXS53YWxsZXQgJiYgcXVvdGUgJiYgYXBwKCkuYXNzZXRzW3F1b3RlLmlkXS53YWxsZXRcbiAgICAgIGlmICghaGFzV2FsbGV0cykgcmV0dXJuIGZhbHNlXG4gICAgICBpZiAodGhpcy5tbVJ1bm5pbmcpIHJldHVybiBmYWxzZVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBEb2Muc2V0VmlzKGF3YWl0IHNob3dPcmRlckZvcm0oKSwgcGFnZS5vcmRlckZvcm0sIHBhZ2Uub3JkZXJUeXBlQnR0bnMpXG5cbiAgICBpZiAodGhpcy5tYXJrZXQpIHtcbiAgICAgIGNvbnN0IHsgYXV0aDogeyBlZmZlY3RpdmVUaWVyLCBwZW5kaW5nU3RyZW5ndGggfSB9ID0gdGhpcy5tYXJrZXQuZGV4XG4gICAgICBEb2Muc2V0VmlzKGVmZmVjdGl2ZVRpZXIgPiAwIHx8IHBlbmRpbmdTdHJlbmd0aCA+IDAsIHBhZ2UucmVwdXRhdGlvbkFuZFRyYWRpbmdUaWVyQm94KVxuICAgIH1cblxuICAgIGNvbnN0IG1tU3RhdHVzID0gYXBwKCkubW1TdGF0dXNcbiAgICBpZiAobW1TdGF0dXMgJiYgdGhpcy5tbVJ1bm5pbmcgPT09IHVuZGVmaW5lZCAmJiB0aGlzLm1hcmtldC5iYXNlICYmIHRoaXMubWFya2V0LnF1b3RlKSB7XG4gICAgICBjb25zdCB7IGJhc2U6IHsgaWQ6IGJhc2VJRCB9LCBxdW90ZTogeyBpZDogcXVvdGVJRCB9LCBkZXg6IHsgaG9zdCB9IH0gPSB0aGlzLm1hcmtldFxuICAgICAgY29uc3QgYm90U3RhdHVzID0gbW1TdGF0dXMuYm90cy5maW5kKCh7IGNvbmZpZzogY2ZnIH0pID0+IGNmZy5iYXNlSUQgPT09IGJhc2VJRCAmJiBjZmcucXVvdGVJRCA9PT0gcXVvdGVJRCAmJiBjZmcuaG9zdCA9PT0gaG9zdClcbiAgICAgIHRoaXMubW1SdW5uaW5nID0gQm9vbGVhbihib3RTdGF0dXM/LnJ1bm5pbmcpXG4gICAgfVxuXG4gICAgRG9jLnNldFZpcyh0aGlzLm1tUnVubmluZywgcGFnZS5tbVJ1bm5pbmcpXG4gICAgaWYgKHRoaXMubW1SdW5uaW5nKSBEb2MuaGlkZShwYWdlLm9yZGVyRm9ybSwgcGFnZS5vcmRlclR5cGVCdHRucylcbiAgfVxuXG4gIC8qIHNldExvYWRlck1zZ1Zpc2liaWxpdHkgZGlzcGxheXMgYSBtZXNzYWdlIGluIGNhc2UgYSBkZXggYXNzZXQgaXMgbm90XG4gICAqIHN1cHBvcnRlZFxuICAgKi9cbiAgc2V0TG9hZGVyTXNnVmlzaWJpbGl0eSAoKSB7XG4gICAgY29uc3QgeyBwYWdlIH0gPSB0aGlzXG5cbiAgICBjb25zdCB7IGlzU3VwcG9ydGVkLCB0ZXh0IH0gPSB0aGlzLmFzc2V0c0FyZVN1cHBvcnRlZCgpXG4gICAgaWYgKGlzU3VwcG9ydGVkKSB7XG4gICAgICAvLyBtYWtlIHN1cmUgdG8gaGlkZSB0aGUgbG9hZGVyIG1zZ1xuICAgICAgRG9jLmhpZGUocGFnZS5sb2FkZXJNc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgcGFnZS5sb2FkZXJNc2cudGV4dENvbnRlbnQgPSB0ZXh0XG4gICAgRG9jLnNob3cocGFnZS5sb2FkZXJNc2cpXG4gICAgRG9jLmhpZGUocGFnZS5ub3RSZWdpc3RlcmVkKVxuICAgIERvYy5oaWRlKHBhZ2Uubm9XYWxsZXQpXG4gIH1cblxuICAvKlxuICAgKiBzaG93VG9rZW5BcHByb3ZhbEZvcm0gZGlzcGxheXMgdGhlIGZvcm0gdXNlZCB0byBnaXZlIGFsbG93YW5jZSB0byB0aGVcbiAgICogc3dhcCBjb250cmFjdCBvZiBhIHRva2VuLlxuICAgKi9cbiAgYXN5bmMgc2hvd1Rva2VuQXBwcm92YWxGb3JtIChpc0Jhc2U6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBhc3NldElEID0gaXNCYXNlID8gdGhpcy5tYXJrZXQuYmFzZS5pZCA6IHRoaXMubWFya2V0LnF1b3RlLmlkXG4gICAgdGhpcy5hcHByb3ZlVG9rZW5Gb3JtLnNldEFzc2V0KGFzc2V0SUQsIHRoaXMubWFya2V0LmRleC5ob3N0KVxuICAgIHRoaXMuc2hvd0Zvcm0odGhpcy5wYWdlLmFwcHJvdmVUb2tlbkZvcm0pXG4gIH1cblxuICAvKlxuICAgKiB0b2tlbkFzc2V0QXBwcm92YWxTdGF0dXNlcyByZXR1cm5zIHRoZSBhcHByb3ZhbCBzdGF0dXMgb2YgdGhlIGJhc2UgYW5kXG4gICAqIHF1b3RlIGFzc2V0cy4gSWYgdGhlIGFzc2V0IGlzIG5vdCBhIHRva2VuLCBpdCBpcyBjb25zaWRlcmVkIGFwcHJvdmVkLlxuICAgKi9cbiAgdG9rZW5Bc3NldEFwcHJvdmFsU3RhdHVzZXMgKCk6IHtcbiAgICBiYXNlQXNzZXRBcHByb3ZhbFN0YXR1czogQXBwcm92YWxTdGF0dXM7XG4gICAgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzOiBBcHByb3ZhbFN0YXR1cztcbiAgICB9IHtcbiAgICBjb25zdCB7IG1hcmtldDogeyBiYXNlLCBxdW90ZSB9IH0gPSB0aGlzXG4gICAgbGV0IGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzID0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWRcbiAgICBsZXQgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWRcblxuICAgIGlmIChiYXNlPy50b2tlbikge1xuICAgICAgY29uc3QgYmFzZUFzc2V0ID0gYXBwKCkuYXNzZXRzW2Jhc2UuaWRdXG4gICAgICBjb25zdCBiYXNlVmVyc2lvbiA9IHRoaXMubWFya2V0LmRleC5hc3NldHNbYmFzZS5pZF0udmVyc2lvblxuICAgICAgaWYgKGJhc2VBc3NldD8ud2FsbGV0Py5hcHByb3ZlZCAmJiBiYXNlQXNzZXQud2FsbGV0LmFwcHJvdmVkW2Jhc2VWZXJzaW9uXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzID0gYmFzZUFzc2V0LndhbGxldC5hcHByb3ZlZFtiYXNlVmVyc2lvbl1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHF1b3RlPy50b2tlbikge1xuICAgICAgY29uc3QgcXVvdGVBc3NldCA9IGFwcCgpLmFzc2V0c1txdW90ZS5pZF1cbiAgICAgIGNvbnN0IHF1b3RlVmVyc2lvbiA9IHRoaXMubWFya2V0LmRleC5hc3NldHNbcXVvdGUuaWRdLnZlcnNpb25cbiAgICAgIGlmIChxdW90ZUFzc2V0Py53YWxsZXQ/LmFwcHJvdmVkICYmIHF1b3RlQXNzZXQud2FsbGV0LmFwcHJvdmVkW3F1b3RlVmVyc2lvbl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgPSBxdW90ZUFzc2V0LndhbGxldC5hcHByb3ZlZFtxdW90ZVZlcnNpb25dXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzLFxuICAgICAgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogc2V0VG9rZW5BcHByb3ZhbFZpc2liaWxpdHkgc2V0cyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgdG9rZW4gYXBwcm92YWxcbiAgICogcGFuZWwgZWxlbWVudHMuXG4gICAqL1xuICBzZXRUb2tlbkFwcHJvdmFsVmlzaWJpbGl0eSAoKSB7XG4gICAgY29uc3QgeyBwYWdlIH0gPSB0aGlzXG5cbiAgICBjb25zdCB7IGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzLCBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgfSA9IHRoaXMudG9rZW5Bc3NldEFwcHJvdmFsU3RhdHVzZXMoKVxuXG4gICAgaWYgKGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzID09PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCAmJiBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgPT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnRva2VuQXBwcm92YWwpXG4gICAgICBwYWdlLnNlbGxCdHRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxuICAgICAgcGFnZS5idXlCdHRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzICE9PSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZCAmJiBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgPT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkKSB7XG4gICAgICBwYWdlLnNlbGxCdHRuLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKVxuICAgICAgcGFnZS5idXlCdHRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxuICAgICAgdGhpcy5zZXRCdXkoKVxuICAgICAgRG9jLnNob3cocGFnZS5hcHByb3ZhbFJlcXVpcmVkU2VsbClcbiAgICAgIERvYy5oaWRlKHBhZ2UuYXBwcm92YWxSZXF1aXJlZEJ1eSwgcGFnZS5hcHByb3ZhbFJlcXVpcmVkQm90aClcbiAgICB9XG5cbiAgICBpZiAoYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMgPT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkICYmIHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1cyAhPT0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWQpIHtcbiAgICAgIHBhZ2UuYnV5QnR0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJylcbiAgICAgIHBhZ2Uuc2VsbEJ0dG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpXG4gICAgICB0aGlzLnNldFNlbGwoKVxuICAgICAgRG9jLnNob3cocGFnZS5hcHByb3ZhbFJlcXVpcmVkQnV5KVxuICAgICAgRG9jLmhpZGUocGFnZS5hcHByb3ZhbFJlcXVpcmVkU2VsbCwgcGFnZS5hcHByb3ZhbFJlcXVpcmVkQm90aClcbiAgICB9XG5cbiAgICAvLyBJZiB0aGV5IGFyZSBib3RoIHVuYXBwcm92ZWQgdG9rZW5zLCB0aGUgb3JkZXIgZm9ybSB3aWxsIG5vdCBiZSBzaG93bi5cbiAgICBpZiAoYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMgIT09IEFwcHJvdmFsU3RhdHVzLkFwcHJvdmVkICYmIHF1b3RlQXNzZXRBcHByb3ZhbFN0YXR1cyAhPT0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWQpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuYXBwcm92YWxSZXF1aXJlZEJvdGgpXG4gICAgICBEb2MuaGlkZShwYWdlLmFwcHJvdmFsUmVxdWlyZWRTZWxsLCBwYWdlLmFwcHJvdmFsUmVxdWlyZWRCdXkpXG4gICAgfVxuXG4gICAgRG9jLnNob3cocGFnZS50b2tlbkFwcHJvdmFsKVxuICAgIHBhZ2UuYXBwcm92YWxQZW5kaW5nQmFzZVN5bWJvbC50ZXh0Q29udGVudCA9IHBhZ2UuYmFzZVRva2VuQXNzZXQudGV4dENvbnRlbnQgPSB0aGlzLm1hcmtldC5iYXNlLnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gICAgcGFnZS5hcHByb3ZhbFBlbmRpbmdRdW90ZVN5bWJvbC50ZXh0Q29udGVudCA9IHBhZ2UucXVvdGVUb2tlbkFzc2V0LnRleHRDb250ZW50ID0gdGhpcy5tYXJrZXQucXVvdGUuc3ltYm9sLnRvVXBwZXJDYXNlKClcbiAgICBEb2Muc2V0VmlzKGJhc2VBc3NldEFwcHJvdmFsU3RhdHVzID09PSBBcHByb3ZhbFN0YXR1cy5Ob3RBcHByb3ZlZCwgcGFnZS5hcHByb3ZlQmFzZUJ0dG4pXG4gICAgRG9jLnNldFZpcyhxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgPT09IEFwcHJvdmFsU3RhdHVzLk5vdEFwcHJvdmVkLCBwYWdlLmFwcHJvdmVRdW90ZUJ0dG4pXG4gICAgRG9jLnNldFZpcyhiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyA9PT0gQXBwcm92YWxTdGF0dXMuUGVuZGluZywgcGFnZS5hcHByb3ZhbFBlbmRpbmdCYXNlKVxuICAgIERvYy5zZXRWaXMocXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID09PSBBcHByb3ZhbFN0YXR1cy5QZW5kaW5nLCBwYWdlLmFwcHJvdmFsUGVuZGluZ1F1b3RlKVxuICB9XG5cbiAgLyogc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlldyBzZXRzIHRoZSB0ZXh0IGNvbnRlbnQgYW5kIGNsYXNzIGZvciB0aGVcbiAgICogcmVnaXN0cmF0aW9uIHN0YXR1cyB2aWV3XG4gICAqL1xuICBzZXRSZWdpc3RyYXRpb25TdGF0dXNWaWV3ICh0aXRsZUNvbnRlbnQ6IHN0cmluZywgY29uZlN0YXR1c01zZzogc3RyaW5nLCB0aXRsZUNsYXNzOiBzdHJpbmcpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5yZWdTdGF0dXNUaXRsZS50ZXh0Q29udGVudCA9IHRpdGxlQ29udGVudFxuICAgIHBhZ2UucmVnU3RhdHVzQ29uZnNEaXNwbGF5LnRleHRDb250ZW50ID0gY29uZlN0YXR1c01zZ1xuICAgIHBhZ2UucmVnaXN0cmF0aW9uU3RhdHVzLmNsYXNzTGlzdC5yZW1vdmUoJ2NvbXBsZXRlZCcsICdlcnJvcicsICd3YWl0aW5nJylcbiAgICBwYWdlLnJlZ2lzdHJhdGlvblN0YXR1cy5jbGFzc0xpc3QuYWRkKHRpdGxlQ2xhc3MpXG4gIH1cblxuICAvKlxuICAgKiB1cGRhdGVSZWdpc3RyYXRpb25TdGF0dXNWaWV3IHVwZGF0ZXMgdGhlIHZpZXcgYmFzZWQgb24gdGhlIGN1cnJlbnRcbiAgICogcmVnaXN0cmF0aW9uIHN0YXR1c1xuICAgKi9cbiAgdXBkYXRlUmVnaXN0cmF0aW9uU3RhdHVzVmlldyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBtYXJrZXQ6IHsgZGV4IH0gfSA9IHRoaXNcbiAgICBwYWdlLnJlZ1N0YXR1c0RleC50ZXh0Q29udGVudCA9IGRleC5ob3N0XG4gICAgcGFnZS5wb3N0aW5nQm9uZHNEZXgudGV4dENvbnRlbnQgPSBkZXguaG9zdFxuXG4gICAgaWYgKGRleC5hdXRoLmVmZmVjdGl2ZVRpZXIgPj0gMSkge1xuICAgICAgdGhpcy5zZXRSZWdpc3RyYXRpb25TdGF0dXNWaWV3KGludGwucHJlcChpbnRsLklEX1JFR0lTVFJBVElPTl9GRUVfU1VDQ0VTUyksICcnLCAnY29tcGxldGVkJylcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IGNvbmZTdGF0dXNlcyA9IChkZXguYXV0aC5wZW5kaW5nQm9uZHMgfHwgW10pLm1hcChwZW5kaW5nID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpcm1hdGlvbnNSZXF1aXJlZCA9IGRleC5ib25kQXNzZXRzW3BlbmRpbmcuc3ltYm9sXS5jb25mc1xuICAgICAgcmV0dXJuIGAke3BlbmRpbmcuY29uZnN9IC8gJHtjb25maXJtYXRpb25zUmVxdWlyZWR9YFxuICAgIH0pXG4gICAgY29uc3QgY29uZlN0YXR1c01zZyA9IGNvbmZTdGF0dXNlcy5qb2luKCcsICcpXG4gICAgdGhpcy5zZXRSZWdpc3RyYXRpb25TdGF0dXNWaWV3KGludGwucHJlcChpbnRsLklEX1dBSVRJTkdfRk9SX0NPTkZTKSwgY29uZlN0YXR1c01zZywgJ3dhaXRpbmcnKVxuICB9XG5cbiAgLypcbiAgICogc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlzaWJpbGl0eSB0b2dnbGVzIHRoZSByZWdpc3RyYXRpb24gc3RhdHVzIHZpZXcgYmFzZWRcbiAgICogb24gdGhlIGRleCBkYXRhLlxuICAgKi9cbiAgc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlzaWJpbGl0eSAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBtYXJrZXQgfSA9IHRoaXNcbiAgICBpZiAoIW1hcmtldCB8fCAhbWFya2V0LmRleCkgcmV0dXJuXG5cbiAgICAvLyBJZiBkZXggaXMgbm90IGNvbm5lY3RlZCB0byBzZXJ2ZXIsIGlzIG5vdCBwb3NzaWJsZSB0byBrbm93IHRoZVxuICAgIC8vIHJlZ2lzdHJhdGlvbiBzdGF0dXMuXG4gICAgaWYgKG1hcmtldC5kZXguY29ubmVjdGlvblN0YXR1cyAhPT0gQ29ubmVjdGlvblN0YXR1cy5Db25uZWN0ZWQpIHJldHVyblxuXG4gICAgdGhpcy51cGRhdGVSZWdpc3RyYXRpb25TdGF0dXNWaWV3KClcblxuICAgIGNvbnN0IHNob3dTZWN0aW9uID0gKHNlY3Rpb246IFBhZ2VFbGVtZW50IHwgdW5kZWZpbmVkKSA9PiB7XG4gICAgICBjb25zdCBlbGVtZW50cyA9IFtwYWdlLnJlZ2lzdHJhdGlvblN0YXR1cywgcGFnZS5ib25kUmVxdWlyZWQsIHBhZ2UuYm9uZENyZWF0aW9uUGVuZGluZywgcGFnZS5ub3RSZWdpc3RlcmVkXVxuICAgICAgZm9yIChjb25zdCBlbCBvZiBlbGVtZW50cykge1xuICAgICAgICBEb2Muc2V0VmlzKGVsID09PSBzZWN0aW9uLCBlbClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWFya2V0LmRleC5hdXRoLmVmZmVjdGl2ZVRpZXIgPj0gMSkge1xuICAgICAgY29uc3QgdG9nZ2xlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBzaG93U2VjdGlvbih1bmRlZmluZWQpXG4gICAgICAgIHRoaXMucmVzb2x2ZU9yZGVyRm9ybVZpc2liaWxpdHkoKVxuICAgICAgfVxuICAgICAgaWYgKERvYy5pc0hpZGRlbihwYWdlLm9yZGVyRm9ybSkpIHtcbiAgICAgICAgLy8gd2FpdCBhIGNvdXBsZSBvZiBzZWNvbmRzIGJlZm9yZSBzaG93aW5nIHRoZSBmb3JtIHNvIHRoZSBzdWNjZXNzXG4gICAgICAgIC8vIG1lc3NhZ2UgaXMgc2hvd24gdG8gdGhlIHVzZXJcbiAgICAgICAgc2V0VGltZW91dCh0b2dnbGUsIDUwMDApXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgdG9nZ2xlKClcbiAgICB9IGVsc2UgaWYgKG1hcmtldC5kZXgudmlld09ubHkpIHtcbiAgICAgIHBhZ2UudW5yZWdpc3RlcmVkRGV4LnRleHRDb250ZW50ID0gbWFya2V0LmRleC5ob3N0XG4gICAgICBzaG93U2VjdGlvbihwYWdlLm5vdFJlZ2lzdGVyZWQpXG4gICAgfSBlbHNlIGlmICh0aGlzLmhhc1BlbmRpbmdCb25kcygpKSB7XG4gICAgICBzaG93U2VjdGlvbihwYWdlLnJlZ2lzdHJhdGlvblN0YXR1cylcbiAgICB9IGVsc2UgaWYgKG1hcmtldC5kZXguYXV0aC50YXJnZXRUaWVyID4gMCkge1xuICAgICAgc2hvd1NlY3Rpb24ocGFnZS5ib25kQ3JlYXRpb25QZW5kaW5nKVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLmFjY3RUaWVyLnRleHRDb250ZW50ID0gYCR7bWFya2V0LmRleC5hdXRoLmVmZmVjdGl2ZVRpZXJ9YFxuICAgICAgcGFnZS5kZXhTZXR0aW5nc0xpbmsuaHJlZiA9IGAvZGV4c2V0dGluZ3MvJHttYXJrZXQuZGV4Lmhvc3R9YFxuICAgICAgc2hvd1NlY3Rpb24ocGFnZS5ib25kUmVxdWlyZWQpXG4gICAgfVxuICB9XG5cbiAgc2V0T3JkZXJCdHRuVGV4dCAoKSB7XG4gICAgaWYgKHRoaXMuaXNTZWxsKCkpIHtcbiAgICAgIHRoaXMucGFnZS5zdWJtaXRCdHRuLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfU0VUX0JVVFRPTl9TRUxMLCB7IGFzc2V0OiBEb2Muc2hvcnRTeW1ib2wodGhpcy5tYXJrZXQuYmFzZUNmZy51bml0SW5mby5jb252ZW50aW9uYWwudW5pdCkgfSlcbiAgICB9IGVsc2UgdGhpcy5wYWdlLnN1Ym1pdEJ0dG4udGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9TRVRfQlVUVE9OX0JVWSwgeyBhc3NldDogRG9jLnNob3J0U3ltYm9sKHRoaXMubWFya2V0LmJhc2VDZmcudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQpIH0pXG4gIH1cblxuICBzZXRPcmRlckJ0dG5FbmFibGVkIChpc0VuYWJsZWQ6IGJvb2xlYW4sIGRpc2FibGVkVG9vbHRpcE1zZz86IHN0cmluZykge1xuICAgIGNvbnN0IGJ0biA9IHRoaXMucGFnZS5zdWJtaXRCdHRuXG4gICAgaWYgKGlzRW5hYmxlZCkge1xuICAgICAgYnRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxuICAgICAgYnRuLnJlbW92ZUF0dHJpYnV0ZSgndGl0bGUnKVxuICAgIH0gZWxzZSB7XG4gICAgICBidG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICd0cnVlJylcbiAgICAgIGlmIChkaXNhYmxlZFRvb2x0aXBNc2cpIGJ0bi5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZGlzYWJsZWRUb29sdGlwTXNnKVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZU9yZGVyQnR0blN0YXRlICgpIHtcbiAgICBjb25zdCB7IG1hcmtldDogbWt0LCBjdXJyZW50T3JkZXI6IHsgcXR5OiBvcmRlclF0eSwgcmF0ZTogb3JkZXJSYXRlLCBpc0xpbWl0LCBzZWxsIH0gfSA9IHRoaXNcbiAgICBjb25zdCBiYXNlV2FsbGV0ID0gYXBwKCkuYXNzZXRzW3RoaXMubWFya2V0LmJhc2UuaWRdLndhbGxldFxuICAgIGNvbnN0IHF1b3RlV2FsbGV0ID0gYXBwKCkuYXNzZXRzW21rdC5xdW90ZS5pZF0ud2FsbGV0XG4gICAgaWYgKCFiYXNlV2FsbGV0IHx8ICFxdW90ZVdhbGxldCkgcmV0dXJuXG5cbiAgICBpZiAob3JkZXJRdHkgPD0gMCB8fCBvcmRlclF0eSA8IG1rdC5jZmcubG90c2l6ZSkge1xuICAgICAgdGhpcy5zZXRPcmRlckJ0dG5FbmFibGVkKGZhbHNlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fUVRZX0VSUk9SKSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIE1hcmtldCBvcmRlcnNcbiAgICBpZiAoIWlzTGltaXQpIHtcbiAgICAgIGlmIChzZWxsKSB7XG4gICAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChvcmRlclF0eSA8PSBiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fU0VMTF9CQUxBTkNFX0VSUk9SKSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChvcmRlclF0eSA8PSBxdW90ZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX0JVWV9CQUxBTkNFX0VSUk9SKSlcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmICghb3JkZXJSYXRlKSB7XG4gICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQoZmFsc2UsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9RVFlfUkFURV9FUlJPUikpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBMaW1pdCBzZWxsXG4gICAgaWYgKHNlbGwpIHtcbiAgICAgIGlmIChiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIDwgbWt0LmNmZy5sb3RzaXplKSB7XG4gICAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChmYWxzZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX1NFTExfQkFMQU5DRV9FUlJPUikpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgaWYgKG1rdC5tYXhTZWxsKSB7XG4gICAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChvcmRlclF0eSA8PSBta3QubWF4U2VsbC5zd2FwLnZhbHVlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fU0VMTF9CQUxBTkNFX0VSUk9SKSlcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIC8vIExpbWl0IGJ1eVxuICAgIGNvbnN0IHJhdGUgPSB0aGlzLmFkanVzdGVkUmF0ZSgpXG4gICAgY29uc3QgYUxvdCA9IG1rdC5jZmcubG90c2l6ZSAqIChyYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvcilcbiAgICBpZiAocXVvdGVXYWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgPCBhTG90KSB7XG4gICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQoZmFsc2UsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9CVVlfQkFMQU5DRV9FUlJPUikpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKG1rdC5tYXhCdXlzW3JhdGVdKSB7XG4gICAgICBjb25zdCBlbmFibGUgPSBvcmRlclF0eSA8PSBta3QubWF4QnV5c1tyYXRlXS5zd2FwLmxvdHMgKiBta3QuY2ZnLmxvdHNpemVcbiAgICAgIHRoaXMuc2V0T3JkZXJCdHRuRW5hYmxlZChlbmFibGUsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9CVVlfQkFMQU5DRV9FUlJPUikpXG4gICAgfVxuICB9XG5cbiAgc2V0Q2FuZGxlRHVyQnR0bnMgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0IH0gPSB0aGlzXG4gICAgRG9jLmVtcHR5KHBhZ2UuZHVyQnR0bkJveClcbiAgICBmb3IgKGNvbnN0IGR1ciBvZiBtYXJrZXQuZGV4LmNhbmRsZUR1cnMpIHtcbiAgICAgIGNvbnN0IGJ0dG4gPSBwYWdlLmR1ckJ0dG5UZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgIGJ0dG4udGV4dENvbnRlbnQgPSBkdXJcbiAgICAgIERvYy5iaW5kKGJ0dG4sICdjbGljaycsICgpID0+IHRoaXMuY2FuZGxlRHVyYXRpb25TZWxlY3RlZChkdXIpKVxuICAgICAgcGFnZS5kdXJCdHRuQm94LmFwcGVuZENoaWxkKGJ0dG4pXG4gICAgfVxuXG4gICAgLy8gbG9hZCBjYW5kbGVzdGlja3MgaGVyZSBzaW5jZSB3ZSBhcmUgcmVzZXR0aW5nIHBhZ2UuZHVyQnR0bkJveCBhYm92ZS5cbiAgICB0aGlzLmxvYWRDYW5kbGVzKClcbiAgfVxuXG4gIC8qIHNldE1hcmtldCBzZXRzIHRoZSBjdXJyZW50bHkgZGlzcGxheWVkIG1hcmtldC4gKi9cbiAgYXN5bmMgc2V0TWFya2V0IChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpIHtcbiAgICBjb25zdCBkZXggPSBhcHAoKS51c2VyLmV4Y2hhbmdlc1tob3N0XVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcblxuICAgIHdpbmRvdy5jZXhCb29rID0gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvY2V4Ym9vaycsIHsgaG9zdCwgYmFzZUlELCBxdW90ZUlEIH0pXG4gICAgICBjb25zb2xlLmxvZyhyZXMuYm9vaylcbiAgICB9XG5cbiAgICAvLyByZXNldCBmb3JtIGlucHV0c1xuICAgIHBhZ2UubG90RmllbGQudmFsdWUgPSAnJ1xuICAgIHBhZ2UucXR5RmllbGQudmFsdWUgPSAnJ1xuICAgIHBhZ2UucmF0ZUZpZWxkLnZhbHVlID0gJydcblxuICAgIC8vIGNsZWFyIGRlcHRoIGNoYXJ0IGFuZCBvcmRlcmJvb2suXG4gICAgdGhpcy5kZXB0aENoYXJ0LmNsZWFyKClcbiAgICBEb2MuZW1wdHkodGhpcy5wYWdlLmJ1eVJvd3MpXG4gICAgRG9jLmVtcHR5KHRoaXMucGFnZS5zZWxsUm93cylcblxuICAgIC8vIENsZWFyIHJlY2VudCBtYXRjaGVzIGZvciB0aGUgcHJldmlvdXMgbWFya2V0LiBUaGlzIHdpbGwgYmUgc2V0IHdoZW4gd2VcbiAgICAvLyByZWNlaXZlIHRoZSBvcmRlciBib29rIHN1YnNjcmlwdGlvbiByZXNwb25zZS5cbiAgICB0aGlzLnJlY2VudE1hdGNoZXMgPSBbXVxuICAgIERvYy5lbXB0eShwYWdlLnJlY2VudE1hdGNoZXNMaXZlTGlzdClcblxuICAgIC8vIEhpZGUgdGhlIGJhbGFuY2Ugd2lkZ2V0XG4gICAgdGhpcy5iYWxhbmNlV2d0LnNldEJhbGFuY2VWaXNpYmlsaXR5KGZhbHNlKVxuXG4gICAgRG9jLmhpZGUocGFnZS5ub3RSZWdpc3RlcmVkLCBwYWdlLmJvbmRSZXF1aXJlZCwgcGFnZS5ub1dhbGxldClcblxuICAgIC8vIElmIHdlIGhhdmUgbm90IHlldCBjb25uZWN0ZWQsIHRoZXJlIGlzIG5vIGRleC5hc3NldHMgb3IgYW55IG90aGVyXG4gICAgLy8gZXhjaGFuZ2UgZGF0YSwgc28ganVzdCBwdXQgdXAgYSBtZXNzYWdlIGFuZCB3YWl0IGZvciB0aGUgY29ubmVjdGlvbiB0byBiZVxuICAgIC8vIGVzdGFibGlzaGVkLCBhdCB3aGljaCB0aW1lIGhhbmRsZUNvbm5Ob3RlIHdpbGwgcmVmcmVzaCBhbmQgcmVsb2FkLlxuICAgIGlmICghZGV4IHx8ICFkZXgubWFya2V0cyB8fCBkZXguY29ubmVjdGlvblN0YXR1cyAhPT0gQ29ubmVjdGlvblN0YXR1cy5Db25uZWN0ZWQpIHtcbiAgICAgIGxldCBlcnJNc2cgPSBpbnRsLnByZXAoaW50bC5JRF9DT05ORUNUSU9OX0ZBSUxFRClcbiAgICAgIGlmIChkZXguZGlzYWJsZWQpIGVyck1zZyA9IGludGwucHJlcChpbnRsLklEX0RFWF9ESVNBQkxFRF9NU0cpXG4gICAgICBwYWdlLmNoYXJ0RXJyTXNnLnRleHRDb250ZW50ID0gZXJyTXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLmNoYXJ0RXJyTXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBzIG9mIHRoaXMuc3RhdHMpIERvYy5zaG93KHMucm93KVxuXG4gICAgY29uc3QgYmFzZUNmZyA9IGRleC5hc3NldHNbYmFzZUlEXVxuICAgIGNvbnN0IHF1b3RlQ2ZnID0gZGV4LmFzc2V0c1txdW90ZUlEXVxuXG4gICAgY29uc3QgW2J1aSwgcXVpXSA9IFthcHAoKS51bml0SW5mbyhiYXNlSUQsIGRleCksIGFwcCgpLnVuaXRJbmZvKHF1b3RlSUQsIGRleCldXG5cbiAgICBjb25zdCByYXRlQ29udmVyc2lvbkZhY3RvciA9IE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgLyBidWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgKiBxdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICBEb2MuaGlkZShwYWdlLm1heE9yZCwgcGFnZS5jaGFydEVyck1zZylcbiAgICBpZiAodGhpcy5tYXhFc3RpbWF0ZVRpbWVyKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMubWF4RXN0aW1hdGVUaW1lcilcbiAgICAgIHRoaXMubWF4RXN0aW1hdGVUaW1lciA9IG51bGxcbiAgICB9XG4gICAgY29uc3QgbWt0SWQgPSBtYXJrZXRJRChiYXNlQ2ZnLnN5bWJvbCwgcXVvdGVDZmcuc3ltYm9sKVxuICAgIGNvbnN0IGJhc2VBc3NldCA9IGFwcCgpLmFzc2V0c1tiYXNlSURdXG4gICAgY29uc3QgcXVvdGVBc3NldCA9IGFwcCgpLmFzc2V0c1txdW90ZUlEXVxuXG4gICAgY29uc3QgbWt0ID0ge1xuICAgICAgZGV4OiBkZXgsXG4gICAgICBzaWQ6IG1rdElkLCAvLyBBIHN0cmluZyBtYXJrZXQgaWRlbnRpZmllciB1c2VkIGJ5IHRoZSBERVguXG4gICAgICBjZmc6IGRleC5tYXJrZXRzW21rdElkXSxcbiAgICAgIC8vIGFwcCgpLmFzc2V0cyBpcyBhIG1hcCBvZiBjb3JlLlN1cHBvcnRlZEFzc2V0IHR5cGUsIHdoaWNoIGNhbiBiZSBmb3VuZCBhdFxuICAgICAgLy8gY2xpZW50L2NvcmUvdHlwZXMuZ28uXG4gICAgICBiYXNlOiBiYXNlQXNzZXQsXG4gICAgICBxdW90ZTogcXVvdGVBc3NldCxcbiAgICAgIGJhc2VVbml0SW5mbzogYnVpLFxuICAgICAgcXVvdGVVbml0SW5mbzogcXVpLFxuICAgICAgbWF4U2VsbDogbnVsbCxcbiAgICAgIG1heEJ1eXM6IHt9LFxuICAgICAgbWF4U2VsbFJlcXVlc3RlZDogZmFsc2UsXG4gICAgICBjYW5kbGVDYWNoZXM6IHt9LFxuICAgICAgYmFzZUNmZyxcbiAgICAgIHF1b3RlQ2ZnLFxuICAgICAgcmF0ZUNvbnZlcnNpb25GYWN0b3IsXG4gICAgICBzZWxsQmFsYW5jZTogMCxcbiAgICAgIGJ1eUJhbGFuY2U6IDAsXG4gICAgICBib29rTG9hZGVkOiBmYWxzZVxuICAgIH1cblxuICAgIHRoaXMubWFya2V0ID0gbWt0XG4gICAgdGhpcy5tbS5zZXRNYXJrZXQoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIHRoaXMubW1SdW5uaW5nID0gdW5kZWZpbmVkXG4gICAgcGFnZS5sb3RTaXplLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShta3QuY2ZnLmxvdHNpemUsIG1rdC5iYXNlVW5pdEluZm8pXG4gICAgcGFnZS5yYXRlU3RlcC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWt0LmNmZy5yYXRlc3RlcCAvIHJhdGVDb252ZXJzaW9uRmFjdG9yKVxuXG4gICAgdGhpcy5kaXNwbGF5TWVzc2FnZUlmTWlzc2luZ1dhbGxldCgpXG4gICAgdGhpcy5iYWxhbmNlV2d0LnNldFdhbGxldHMoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIHRoaXMuc2V0TWFya2V0RGV0YWlscygpXG4gICAgdGhpcy5zZXRDdXJyTWFya2V0UHJpY2UoKVxuXG4gICAgLy8gaWYgKCFkZXguY2FuZGxlRHVycyB8fCBkZXguY2FuZGxlRHVycy5sZW5ndGggPT09IDApIHRoaXMuY3VycmVudENoYXJ0ID0gZGVwdGhDaGFydFxuXG4gICAgLy8gZGVwdGggY2hhcnRcbiAgICB3cy5yZXF1ZXN0KCdsb2FkbWFya2V0JywgbWFrZU1hcmtldChob3N0LCBiYXNlSUQsIHF1b3RlSUQpKVxuXG4gICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5sYXN0TWFya2V0TEssIHtcbiAgICAgIGhvc3Q6IGhvc3QsXG4gICAgICBiYXNlOiBiYXNlSUQsXG4gICAgICBxdW90ZTogcXVvdGVJRFxuICAgIH0pXG4gICAgYXBwKCkudXBkYXRlTWFya2V0RWxlbWVudHModGhpcy5tYWluLCBiYXNlSUQsIHF1b3RlSUQsIGRleClcbiAgICB0aGlzLm1hcmtldExpc3Quc2VsZWN0KGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICB0aGlzLnNldExvYWRlck1zZ1Zpc2liaWxpdHkoKVxuICAgIHRoaXMuc2V0VG9rZW5BcHByb3ZhbFZpc2liaWxpdHkoKVxuICAgIHRoaXMuc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlzaWJpbGl0eSgpXG4gICAgdGhpcy5yZXNvbHZlT3JkZXJGb3JtVmlzaWJpbGl0eSgpXG4gICAgdGhpcy5zZXRPcmRlckJ0dG5UZXh0KClcbiAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQoZmFsc2UsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9RVFlfUkFURV9FUlJPUikpXG4gICAgdGhpcy5zZXRDYW5kbGVEdXJCdHRucygpXG4gICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQoZmFsc2UpXG4gICAgdGhpcy51cGRhdGVUaXRsZSgpXG4gICAgdGhpcy5yZXB1dGF0aW9uTWV0ZXIuc2V0SG9zdChkZXguaG9zdClcbiAgICB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKVxuICAgIHRoaXMubG9hZFVzZXJPcmRlcnMoKVxuICB9XG5cbiAgLypcbiAgICBkaXNwbGF5TWVzc2FnZUZvck1pc3NpbmdXYWxsZXQgZGlzcGxheXMgYSBjdXN0b20gbWVzc2FnZSBvbiB0aGUgbWFya2V0J3NcbiAgICB2aWV3IGlmIG9uZSBvciBtb3JlIG9mIHRoZSBzZWxlY3RlZCBtYXJrZXQncyB3YWxsZXQgaXMgbWlzc2luZy5cbiAgKi9cbiAgZGlzcGxheU1lc3NhZ2VJZk1pc3NpbmdXYWxsZXQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBta3QgPSB0aGlzLm1hcmtldFxuICAgIGNvbnN0IGJhc2VTeW0gPSBta3QuYmFzZUNmZy5zeW1ib2wudG9Mb2NhbGVVcHBlckNhc2UoKVxuICAgIGNvbnN0IHF1b3RlU3ltID0gbWt0LnF1b3RlQ2ZnLnN5bWJvbC50b0xvY2FsZVVwcGVyQ2FzZSgpXG4gICAgbGV0IG5vV2FsbGV0TXNnID0gJydcbiAgICBEb2MuaGlkZShwYWdlLm5vV2FsbGV0KVxuICAgIGlmICghbWt0LmJhc2U/LndhbGxldCAmJiAhbWt0LnF1b3RlPy53YWxsZXQpIG5vV2FsbGV0TXNnID0gaW50bC5wcmVwKGludGwuSURfTk9fV0FMTEVUX01TRywgeyBhc3NldDE6IGJhc2VTeW0sIGFzc2V0MjogcXVvdGVTeW0gfSlcbiAgICBlbHNlIGlmICghbWt0LmJhc2U/LndhbGxldCkgbm9XYWxsZXRNc2cgPSBpbnRsLnByZXAoaW50bC5JRF9DUkVBVEVfQVNTRVRfV0FMTEVUX01TRywgeyBhc3NldDogYmFzZVN5bSB9KVxuICAgIGVsc2UgaWYgKCFta3QucXVvdGU/LndhbGxldCkgbm9XYWxsZXRNc2cgPSBpbnRsLnByZXAoaW50bC5JRF9DUkVBVEVfQVNTRVRfV0FMTEVUX01TRywgeyBhc3NldDogcXVvdGVTeW0gfSlcbiAgICBlbHNlIHJldHVyblxuXG4gICAgcGFnZS5ub1dhbGxldC50ZXh0Q29udGVudCA9IG5vV2FsbGV0TXNnXG4gICAgRG9jLnNob3cocGFnZS5ub1dhbGxldClcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydERlcHRoQ2xpY2sgaXMgYSBjYWxsYmFjayB1c2VkIGJ5IHRoZSBEZXB0aENoYXJ0IHdoZW4gdGhlIHVzZXIgY2xpY2tzXG4gICAqIG9uIHRoZSBjaGFydCBhcmVhLiBUaGUgcmF0ZSBmaWVsZCBpcyBzZXQgdG8gdGhlIHgtdmFsdWUgb2YgdGhlIGNsaWNrLlxuICAgKi9cbiAgcmVwb3J0RGVwdGhDbGljayAocjogbnVtYmVyKSB7XG4gICAgdGhpcy5wYWdlLnJhdGVGaWVsZC52YWx1ZSA9IFN0cmluZyhyKVxuICAgIHRoaXMucmF0ZUZpZWxkQ2hhbmdlZCgpXG4gIH1cblxuICAvKlxuICAgKiByZXBvcnREZXB0aFZvbHVtZSBhY2NlcHRzIGEgdm9sdW1lIHJlcG9ydCBmcm9tIHRoZSBEZXB0aENoYXJ0IGFuZCBzZXRzIHRoZVxuICAgKiB2YWx1ZXMgaW4gdGhlIGNoYXJ0IGxlZ2VuZC5cbiAgICovXG4gIHJlcG9ydERlcHRoVm9sdW1lIChyOiBWb2x1bWVSZXBvcnQpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgeyBiYXNlVW5pdEluZm86IGIsIHF1b3RlVW5pdEluZm86IHEgfSA9IHRoaXMubWFya2V0XG4gICAgLy8gRGVwdGhDaGFydCByZXBvcnRzIHZvbHVtZXMgaW4gY29udmVudGlvbmFsIHVuaXRzLiBXZSdsbCBzdGlsbCB1c2VcbiAgICAvLyBmb3JtYXRDb2luVmFsdWUgZm9yIGZvcm1hdHRpbmcgdGhvdWdoLlxuICAgIHBhZ2Uuc2VsbEJvb2tlZEJhc2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHIuc2VsbEJhc2UgKiBiLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yLCBiKVxuICAgIHBhZ2Uuc2VsbEJvb2tlZFF1b3RlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyLnNlbGxRdW90ZSAqIHEuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IsIHEpXG4gICAgcGFnZS5idXlCb29rZWRCYXNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyLmJ1eUJhc2UgKiBiLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yLCBiKVxuICAgIHBhZ2UuYnV5Qm9va2VkUXVvdGUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHIuYnV5UXVvdGUgKiBxLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yLCBxKVxuICB9XG5cbiAgLypcbiAgICogcmVwb3J0RGVwdGhNb3VzZSBhY2NlcHRzIGluZm9ybWF0aW9uIGFib3V0IHRoZSBtb3VzZSBwb3NpdGlvbiBvbiB0aGUgY2hhcnRcbiAgICogYXJlYS5cbiAgICovXG4gIHJlcG9ydERlcHRoTW91c2UgKHI6IE1vdXNlUmVwb3J0KSB7XG4gICAgd2hpbGUgKHRoaXMuaG92ZXJzLmxlbmd0aCkgKHRoaXMuaG92ZXJzLnNoaWZ0KCkgYXMgSFRNTEVsZW1lbnQpLmNsYXNzTGlzdC5yZW1vdmUoJ2hvdmVyJylcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgaWYgKCFyKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLmRlcHRoTGVnZW5kKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UuZGVwdGhMZWdlbmQpXG5cbiAgICAvLyBJZiB0aGUgdXNlciBpcyBob3ZlcmVkIHRvIHdpdGhpbiBhIHNtYWxsIHBlcmNlbnQgKGJhc2VkIG9uIGNoYXJ0IHdpZHRoKVxuICAgIC8vIG9mIGEgdXNlciBvcmRlciwgaGlnaGxpZ2h0IHRoYXQgb3JkZXIncyByb3cuXG4gICAgZm9yIChjb25zdCB7IGRpdiwgb3JkIH0gb2YgT2JqZWN0LnZhbHVlcyh0aGlzLm1ldGFPcmRlcnMpKSB7XG4gICAgICBpZiAob3JkLnN0YXR1cyAhPT0gT3JkZXJVdGlsLlN0YXR1c0Jvb2tlZCkgY29udGludWVcbiAgICAgIGlmIChyLmhvdmVyTWFya2Vycy5pbmRleE9mKG9yZC5yYXRlKSA+IC0xKSB7XG4gICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKCdob3ZlcicpXG4gICAgICAgIHRoaXMuaG92ZXJzLnB1c2goZGl2KVxuICAgICAgfVxuICAgIH1cblxuICAgIHBhZ2UuaG92ZXJQcmljZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoci5yYXRlKVxuICAgIHBhZ2UuaG92ZXJWb2x1bWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHIuZGVwdGgpXG4gICAgcGFnZS5ob3ZlclZvbHVtZS5zdHlsZS5jb2xvciA9IHIuZG90Q29sb3JcbiAgfVxuXG4gIC8qXG4gICAqIHJlcG9ydERlcHRoWm9vbSBhY2NlcHRzIGluZm9ybWF0aW9uIGFib3V0IHRoZSBjdXJyZW50IGRlcHRoIGNoYXJ0IHpvb21cbiAgICogbGV2ZWwuIFRoaXMgaW5mb3JtYXRpb24gaXMgc2F2ZWQgdG8gZGlzayBzbyB0aGF0IHRoZSB6b29tIGxldmVsIGNhbiBiZVxuICAgKiBtYWludGFpbmVkIGFjcm9zcyByZWxvYWRzLlxuICAgKi9cbiAgcmVwb3J0RGVwdGhab29tICh6b29tOiBudW1iZXIpIHtcbiAgICBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmRlcHRoWm9vbUxLLCB6b29tKVxuICB9XG5cbiAgcmVwb3J0TW91c2VDYW5kbGUgKGNhbmRsZTogQ2FuZGxlIHwgbnVsbCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBpZiAoIWNhbmRsZSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5jYW5kbGVzTGVnZW5kKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UuY2FuZGxlc0xlZ2VuZClcbiAgICBwYWdlLmNhbmRsZVN0YXJ0LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShjYW5kbGUuc3RhcnRSYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgcGFnZS5jYW5kbGVFbmQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGNhbmRsZS5lbmRSYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgcGFnZS5jYW5kbGVIaWdoLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShjYW5kbGUuaGlnaFJhdGUgLyB0aGlzLm1hcmtldC5yYXRlQ29udmVyc2lvbkZhY3RvcilcbiAgICBwYWdlLmNhbmRsZUxvdy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoY2FuZGxlLmxvd1JhdGUgLyB0aGlzLm1hcmtldC5yYXRlQ29udmVyc2lvbkZhY3RvcilcbiAgICBwYWdlLmNhbmRsZVZvbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoY2FuZGxlLm1hdGNoVm9sdW1lLCB0aGlzLm1hcmtldC5iYXNlVW5pdEluZm8pXG4gIH1cblxuICAvKlxuICAgKiBwYXJzZU9yZGVyIHB1bGxzIHRoZSBvcmRlciBpbmZvcm1hdGlvbiBmcm9tIHRoZSBmb3JtIGZpZWxkcy4gRGF0YSBpcyBub3RcbiAgICogdmFsaWRhdGVkIGluIGFueSB3YXkuXG4gICAqL1xuICBwYXJzZU9yZGVyICgpOiBUcmFkZUZvcm0ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBsZXQgcXR5RmllbGQgPSBwYWdlLnF0eUZpZWxkXG4gICAgY29uc3QgbGltaXQgPSB0aGlzLmlzTGltaXQoKVxuICAgIGNvbnN0IHNlbGwgPSB0aGlzLmlzU2VsbCgpXG4gICAgY29uc3QgbWFya2V0ID0gdGhpcy5tYXJrZXRcbiAgICBsZXQgcXR5Q29udiA9IG1hcmtldC5iYXNlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICBpZiAoIWxpbWl0ICYmICFzZWxsKSB7XG4gICAgICBxdHlGaWVsZCA9IHBhZ2UubWt0QnV5RmllbGRcbiAgICAgIHF0eUNvbnYgPSBtYXJrZXQucXVvdGVVbml0SW5mby5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgaG9zdDogbWFya2V0LmRleC5ob3N0LFxuICAgICAgaXNMaW1pdDogbGltaXQsXG4gICAgICBzZWxsOiBzZWxsLFxuICAgICAgYmFzZTogbWFya2V0LmJhc2UuaWQsXG4gICAgICBxdW90ZTogbWFya2V0LnF1b3RlLmlkLFxuICAgICAgcXR5OiBjb252ZXJ0VG9BdG9tcyhxdHlGaWVsZC52YWx1ZSB8fCAnJywgcXR5Q29udiksXG4gICAgICByYXRlOiBjb252ZXJ0VG9BdG9tcyhwYWdlLnJhdGVGaWVsZC52YWx1ZSB8fCAnJywgbWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yKSwgLy8gbWVzc2FnZS1yYXRlXG4gICAgICB0aWZub3c6IHBhZ2UudGlmTm93LmNoZWNrZWQgfHwgZmFsc2UsXG4gICAgICBvcHRpb25zOiB7fVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBwcmV2aWV3UXVvdGVBbXQgc2hvd3MgcXVvdGUgYW1vdW50IHdoZW4gcmF0ZSBvciBxdWFudGl0eSBpbnB1dCBhcmUgY2hhbmdlZFxuICAgKi9cbiAgcHJldmlld1F1b3RlQW10IChzaG93OiBib29sZWFuKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGlmICghdGhpcy5tYXJrZXQuYmFzZSB8fCAhdGhpcy5tYXJrZXQucXVvdGUpIHJldHVybiAvLyBOb3QgYSBzdXBwb3J0ZWQgYXNzZXRcbiAgICBjb25zdCBvcmRlciA9IHRoaXMuY3VycmVudE9yZGVyID0gdGhpcy5wYXJzZU9yZGVyKClcbiAgICBjb25zdCBhZGp1c3RlZCA9IHRoaXMuYWRqdXN0ZWRSYXRlKClcbiAgICBwYWdlLm9yZGVyRXJyLnRleHRDb250ZW50ID0gJydcbiAgICBpZiAoYWRqdXN0ZWQpIHtcbiAgICAgIGlmIChvcmRlci5zZWxsKSB0aGlzLnByZVNlbGwoKVxuICAgICAgZWxzZSB0aGlzLnByZUJ1eSgpXG4gICAgfVxuICAgIHRoaXMuZGVwdGhMaW5lcy5pbnB1dCA9IFtdXG4gICAgaWYgKGFkanVzdGVkICYmIHRoaXMuaXNMaW1pdCgpKSB7XG4gICAgICB0aGlzLmRlcHRoTGluZXMuaW5wdXQgPSBbe1xuICAgICAgICByYXRlOiBvcmRlci5yYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IsXG4gICAgICAgIGNvbG9yOiBvcmRlci5zZWxsID8gdGhpcy5kZXB0aENoYXJ0LnRoZW1lLnNlbGxMaW5lIDogdGhpcy5kZXB0aENoYXJ0LnRoZW1lLmJ1eUxpbmVcbiAgICAgIH1dXG4gICAgfVxuICAgIHRoaXMuZHJhd0NoYXJ0TGluZXMoKVxuICAgIGlmICghc2hvdyB8fCAhYWRqdXN0ZWQgfHwgIW9yZGVyLnF0eSkge1xuICAgICAgcGFnZS5vcmRlclByZXZpZXcudGV4dENvbnRlbnQgPSAnJ1xuICAgICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgeyB1bml0SW5mbzogeyBjb252ZW50aW9uYWw6IHsgdW5pdCB9IH0gfSA9IGFwcCgpLmFzc2V0c1tvcmRlci5xdW90ZV1cbiAgICBjb25zdCBxdW90ZVF0eSA9IG9yZGVyLnF0eSAqIG9yZGVyLnJhdGUgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yXG4gICAgY29uc3QgdG90YWwgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHF1b3RlUXR5LCB0aGlzLm1hcmtldC5xdW90ZVVuaXRJbmZvKVxuXG4gICAgcGFnZS5vcmRlclByZXZpZXcudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9QUkVWSUVXLCB7IHRvdGFsLCBhc3NldDogdW5pdCB9KVxuICAgIGlmICh0aGlzLmlzU2VsbCgpKSB0aGlzLnByZVNlbGwoKVxuICAgIGVsc2UgdGhpcy5wcmVCdXkoKVxuICB9XG5cbiAgLyoqXG4gICAqIHByZVNlbGwgcG9wdWxhdGVzIHRoZSBtYXggb3JkZXIgbWVzc2FnZSBmb3IgdGhlIGxhcmdlc3QgYXZhaWxhYmxlIHNlbGwuXG4gICAqL1xuICBwcmVTZWxsICgpIHtcbiAgICBjb25zdCBta3QgPSB0aGlzLm1hcmtldFxuICAgIGNvbnN0IGJhc2VXYWxsZXQgPSBhcHAoKS5hc3NldHNbbWt0LmJhc2UuaWRdLndhbGxldFxuICAgIGlmIChiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIDwgbWt0LmNmZy5sb3RzaXplKSB7XG4gICAgICB0aGlzLnNldE1heE9yZGVyKG51bGwpXG4gICAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAobWt0Lm1heFNlbGwpIHtcbiAgICAgIHRoaXMuc2V0TWF4T3JkZXIobWt0Lm1heFNlbGwuc3dhcClcbiAgICAgIHRoaXMudXBkYXRlT3JkZXJCdHRuU3RhdGUoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKG1rdC5tYXhTZWxsUmVxdWVzdGVkKSByZXR1cm5cbiAgICBta3QubWF4U2VsbFJlcXVlc3RlZCA9IHRydWVcbiAgICAvLyBXZSBvbmx5IGZldGNoIHByZS1zZWxsIG9uY2UgcGVyIGJhbGFuY2UgdXBkYXRlLCBzbyBkb24ndCBkZWxheS5cbiAgICB0aGlzLnNjaGVkdWxlTWF4RXN0aW1hdGUoJy9hcGkvbWF4c2VsbCcsIHt9LCAwLCAocmVzOiBNYXhTZWxsKSA9PiB7XG4gICAgICBta3QubWF4U2VsbFJlcXVlc3RlZCA9IGZhbHNlXG4gICAgICBta3QubWF4U2VsbCA9IHJlcy5tYXhTZWxsXG4gICAgICBta3Quc2VsbEJhbGFuY2UgPSBiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlXG4gICAgICB0aGlzLnNldE1heE9yZGVyKHJlcy5tYXhTZWxsLnN3YXApXG4gICAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIHByZUJ1eSBwb3B1bGF0ZXMgdGhlIG1heCBvcmRlciBtZXNzYWdlIGZvciB0aGUgbGFyZ2VzdCBhdmFpbGFibGUgYnV5LlxuICAgKi9cbiAgcHJlQnV5ICgpIHtcbiAgICBjb25zdCBta3QgPSB0aGlzLm1hcmtldFxuICAgIGNvbnN0IHJhdGUgPSB0aGlzLmFkanVzdGVkUmF0ZSgpXG4gICAgY29uc3QgcXVvdGVXYWxsZXQgPSBhcHAoKS5hc3NldHNbbWt0LnF1b3RlLmlkXS53YWxsZXRcbiAgICBpZiAoIXF1b3RlV2FsbGV0KSByZXR1cm5cbiAgICBjb25zdCBhTG90ID0gbWt0LmNmZy5sb3RzaXplICogKHJhdGUgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yKVxuICAgIGlmIChxdW90ZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA8IGFMb3QpIHtcbiAgICAgIHRoaXMuc2V0TWF4T3JkZXIobnVsbClcbiAgICAgIHRoaXMudXBkYXRlT3JkZXJCdHRuU3RhdGUoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmIChta3QubWF4QnV5c1tyYXRlXSkge1xuICAgICAgdGhpcy5zZXRNYXhPcmRlcihta3QubWF4QnV5c1tyYXRlXS5zd2FwKVxuICAgICAgdGhpcy51cGRhdGVPcmRlckJ0dG5TdGF0ZSgpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgLy8gMCBkZWxheSBmb3IgZmlyc3QgZmV0Y2ggYWZ0ZXIgYmFsYW5jZSB1cGRhdGUgb3IgbWFya2V0IGNoYW5nZSwgb3RoZXJ3aXNlXG4gICAgLy8gbWV0ZXIgdGhlc2UgYXQgMSAvIHNlYy5cbiAgICBjb25zdCBkZWxheSA9IE9iamVjdC5rZXlzKG1rdC5tYXhCdXlzKS5sZW5ndGggPyAzNTAgOiAwXG4gICAgdGhpcy5zY2hlZHVsZU1heEVzdGltYXRlKCcvYXBpL21heGJ1eScsIHsgcmF0ZSB9LCBkZWxheSwgKHJlczogTWF4QnV5KSA9PiB7XG4gICAgICBta3QubWF4QnV5c1tyYXRlXSA9IHJlcy5tYXhCdXlcbiAgICAgIG1rdC5idXlCYWxhbmNlID0gYXBwKCkuYXNzZXRzW21rdC5xdW90ZS5pZF0ud2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlXG4gICAgICB0aGlzLnNldE1heE9yZGVyKHJlcy5tYXhCdXkuc3dhcClcbiAgICAgIHRoaXMudXBkYXRlT3JkZXJCdHRuU3RhdGUoKVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogc2NoZWR1bGVNYXhFc3RpbWF0ZSBzaG93cyB0aGUgbG9hZGluZyBpY29uIGFuZCBzY2hlZHVsZXMgYSBjYWxsIHRvIGFuIG9yZGVyXG4gICAqIGVzdGltYXRlIGFwaSBlbmRwb2ludC4gSWYgYW5vdGhlciBjYWxsIHRvIHNjaGVkdWxlTWF4RXN0aW1hdGUgaXMgbWFkZSBiZWZvcmVcbiAgICogdGhpcyBvbmUgaXMgZmlyZWQgKGFmdGVyIGRlbGF5KSwgdGhpcyBjYWxsIHdpbGwgYmUgY2FuY2VsZWQuXG4gICAqL1xuICBzY2hlZHVsZU1heEVzdGltYXRlIChwYXRoOiBzdHJpbmcsIGFyZ3M6IGFueSwgZGVsYXk6IG51bWJlciwgc3VjY2VzczogKHJlczogYW55KSA9PiB2b2lkKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGlmICghdGhpcy5tYXhMb2FkZWQpIHRoaXMubWF4TG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLm1heE9yZClcbiAgICBjb25zdCBbYmlkLCBxaWRdID0gW3RoaXMubWFya2V0LmJhc2UuaWQsIHRoaXMubWFya2V0LnF1b3RlLmlkXVxuICAgIGNvbnN0IFtiV2FsbGV0LCBxV2FsbGV0XSA9IFthcHAoKS5hc3NldHNbYmlkXS53YWxsZXQsIGFwcCgpLmFzc2V0c1txaWRdLndhbGxldF1cbiAgICBpZiAoIWJXYWxsZXQgfHwgIWJXYWxsZXQucnVubmluZyB8fCAhcVdhbGxldCB8fCAhcVdhbGxldC5ydW5uaW5nKSByZXR1cm5cbiAgICBpZiAodGhpcy5tYXhFc3RpbWF0ZVRpbWVyKSB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMubWF4RXN0aW1hdGVUaW1lcilcblxuICAgIERvYy5zaG93KHBhZ2UubWF4T3JkLCBwYWdlLm1heExvdEJveClcbiAgICBEb2MuaGlkZShwYWdlLm1heEFib3ZlWmVybywgcGFnZS5tYXhaZXJvTm9GZWVzLCBwYWdlLm1heFplcm9Ob0JhbClcbiAgICBwYWdlLm1heEZyb21Mb3RzLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQ0FMQ1VMQVRJTkcpXG4gICAgcGFnZS5tYXhGcm9tTG90c0xibC50ZXh0Q29udGVudCA9ICcnXG4gICAgdGhpcy5tYXhPcmRlclVwZGF0ZUNvdW50ZXIrK1xuICAgIGNvbnN0IGNvdW50ZXIgPSB0aGlzLm1heE9yZGVyVXBkYXRlQ291bnRlclxuICAgIHRoaXMubWF4RXN0aW1hdGVUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcbiAgICAgIHRoaXMubWF4RXN0aW1hdGVUaW1lciA9IG51bGxcbiAgICAgIGlmIChjb3VudGVyICE9PSB0aGlzLm1heE9yZGVyVXBkYXRlQ291bnRlcikgcmV0dXJuXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTihwYXRoLCB7XG4gICAgICAgIGhvc3Q6IHRoaXMubWFya2V0LmRleC5ob3N0LFxuICAgICAgICBiYXNlOiBiaWQsXG4gICAgICAgIHF1b3RlOiBxaWQsXG4gICAgICAgIC4uLmFyZ3NcbiAgICAgIH0pXG4gICAgICBpZiAoY291bnRlciAhPT0gdGhpcy5tYXhPcmRlclVwZGF0ZUNvdW50ZXIpIHJldHVyblxuICAgICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdtYXggb3JkZXIgZXN0aW1hdGUgbm90IGF2YWlsYWJsZTonLCByZXMpXG4gICAgICAgIHBhZ2UubWF4RnJvbUxvdHMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9FU1RJTUFURV9VTkFWQUlMQUJMRSlcbiAgICAgICAgaWYgKHRoaXMubWF4TG9hZGVkKSB7XG4gICAgICAgICAgdGhpcy5tYXhMb2FkZWQoKVxuICAgICAgICAgIHRoaXMubWF4TG9hZGVkID0gbnVsbFxuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgc3VjY2VzcyhyZXMpXG4gICAgfSwgZGVsYXkpXG4gIH1cblxuICAvKiBzZXRNYXhPcmRlciBzZXRzIHRoZSBtYXggb3JkZXIgdGV4dC4gKi9cbiAgc2V0TWF4T3JkZXIgKG1heE9yZGVyOiBTd2FwRXN0aW1hdGUgfCBudWxsKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGlmICh0aGlzLm1heExvYWRlZCkge1xuICAgICAgdGhpcy5tYXhMb2FkZWQoKVxuICAgICAgdGhpcy5tYXhMb2FkZWQgPSBudWxsXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UubWF4T3JkLCBwYWdlLm1heExvdEJveClcbiAgICBjb25zdCBzZWxsID0gdGhpcy5pc1NlbGwoKVxuXG4gICAgbGV0IGxvdHMgPSAwXG4gICAgaWYgKG1heE9yZGVyKSBsb3RzID0gbWF4T3JkZXIubG90c1xuXG4gICAgcGFnZS5tYXhGcm9tTG90cy50ZXh0Q29udGVudCA9IGxvdHMudG9TdHJpbmcoKVxuICAgIC8vIFhYWCBhZGQgcGx1cmFsIGludG8gZm9ybWF0IGRldGFpbHMsIHNvIHdlIGRvbid0IG5lZWQgdGhpc1xuICAgIHBhZ2UubWF4RnJvbUxvdHNMYmwudGV4dENvbnRlbnQgPSBpbnRsLnByZXAobG90cyA9PT0gMSA/IGludGwuSURfTE9UIDogaW50bC5JRF9MT1RTKVxuICAgIGlmICghbWF4T3JkZXIpIHJldHVyblxuXG4gICAgY29uc3QgZnJvbUFzc2V0ID0gc2VsbCA/IHRoaXMubWFya2V0LmJhc2UgOiB0aGlzLm1hcmtldC5xdW90ZVxuXG4gICAgaWYgKGxvdHMgPT09IDApIHtcbiAgICAgIC8vIElmIHdlIGhhdmUgYSBtYXhPcmRlciwgc2VlIGlmIHdlIGNhbiBndWVzcyB3aHkgd2UgaGF2ZSBubyBsb3RzLlxuICAgICAgbGV0IGxvdFNpemUgPSB0aGlzLm1hcmtldC5jZmcubG90c2l6ZVxuICAgICAgaWYgKCFzZWxsKSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnNpb25SYXRlID0gdGhpcy5hbnlSYXRlKClbMV1cbiAgICAgICAgaWYgKGNvbnZlcnNpb25SYXRlID09PSAwKSByZXR1cm5cbiAgICAgICAgbG90U2l6ZSA9IGxvdFNpemUgKiBjb252ZXJzaW9uUmF0ZVxuICAgICAgfVxuICAgICAgY29uc3QgaGF2ZVF0eSA9IGZyb21Bc3NldC53YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgLyBsb3RTaXplID4gMFxuICAgICAgaWYgKGhhdmVRdHkpIHtcbiAgICAgICAgaWYgKGZyb21Bc3NldC50b2tlbikge1xuICAgICAgICAgIGNvbnN0IHsgd2FsbGV0OiB7IGJhbGFuY2U6IHsgYXZhaWxhYmxlOiBmZWVBdmFpbCB9IH0sIHVuaXRJbmZvIH0gPSBhcHAoKS5hc3NldHNbZnJvbUFzc2V0LnRva2VuLnBhcmVudElEXVxuICAgICAgICAgIGlmIChmZWVBdmFpbCA8IG1heE9yZGVyLmZlZVJlc2VydmVzUGVyTG90KSB7XG4gICAgICAgICAgICBEb2Muc2hvdyhwYWdlLm1heFplcm9Ob0ZlZXMpXG4gICAgICAgICAgICBwYWdlLm1heFplcm9Ob0ZlZXNUaWNrZXIudGV4dENvbnRlbnQgPSB1bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgICAgICAgICAgcGFnZS5tYXhaZXJvTWluRmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWF4T3JkZXIuZmVlUmVzZXJ2ZXNQZXJMb3QsIHVuaXRJbmZvKVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBJdCBsb29rcyBsaWtlIHdlIHNob3VsZCBiZSBhYmxlIHRvIGFmZm9yZCBpdCwgYnV0IG1heWJlIHNvbWUgZmVlcyB3ZSdyZSBub3Qgc2VlaW5nLlxuICAgICAgICAgIC8vIFNob3cgbm90aGluZy5cbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICAvLyBOb3QgYSB0b2tlbi4gTWF5YmUgd2UgaGF2ZSBlbm91Z2ggZm9yIHRoZSBzd2FwIGJ1dCBub3QgZm9yIGZlZXMuXG4gICAgICAgIGNvbnN0IGZ1bmRlZExvdHMgPSBmcm9tQXNzZXQud2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC8gKGxvdFNpemUgKyBtYXhPcmRlci5mZWVSZXNlcnZlc1BlckxvdClcbiAgICAgICAgaWYgKGZ1bmRlZExvdHMgPiAwKSByZXR1cm4gLy8gTm90IHN1cmUgd2h5LiBDb3VsZCBiZSBzcGxpdCB0eHMgb3IgdXR4b3MuIEp1c3Qgc2hvdyBub3RoaW5nLlxuICAgICAgfVxuICAgICAgRG9jLnNob3cocGFnZS5tYXhaZXJvTm9CYWwpXG4gICAgICBwYWdlLm1heFplcm9Ob0JhbFRpY2tlci50ZXh0Q29udGVudCA9IGZyb21Bc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UubWF4QWJvdmVaZXJvKVxuXG4gICAgcGFnZS5tYXhGcm9tQW10LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShtYXhPcmRlci52YWx1ZSB8fCAwLCBmcm9tQXNzZXQudW5pdEluZm8pXG4gICAgcGFnZS5tYXhGcm9tVGlja2VyLnRleHRDb250ZW50ID0gZnJvbUFzc2V0LnVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XG4gICAgLy8gQ291bGQgc3VidHJhY3QgdGhlIG1heE9yZGVyLnJlZGVtcHRpb25GZWVzIGhlcmUuXG4gICAgLy8gVGhlIHF0eSBjb252ZXJzaW9uIGRvZXNuJ3QgZml0IHdlbGwgd2l0aCB0aGUgbmV3IGRlc2lnbi5cbiAgICAvLyBUT0RPOiBNYWtlIHRoaXMgd29yayBzb21laG93P1xuICAgIC8vIGNvbnN0IHRvQ29udmVyc2lvbiA9IHNlbGwgPyB0aGlzLmFkanVzdGVkUmF0ZSgpIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvciA6IE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgLyB0aGlzLmFkanVzdGVkUmF0ZSgpXG4gICAgLy8gcGFnZS5tYXhUb0FtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoKG1heE9yZGVyLnZhbHVlIHx8IDApICogdG9Db252ZXJzaW9uLCB0b0Fzc2V0LnVuaXRJbmZvKVxuICAgIC8vIHBhZ2UubWF4VG9UaWNrZXIudGV4dENvbnRlbnQgPSB0b0Fzc2V0LnN5bWJvbC50b1VwcGVyQ2FzZSgpXG4gIH1cblxuICAvKlxuICAgKiB2YWxpZGF0ZU9yZGVyIHBlcmZvcm1zIHNvbWUgYmFzaWMgb3JkZXIgc2FuaXR5IGNoZWNrcywgcmV0dXJuaW5nIGJvb2xlYW5cbiAgICogdHJ1ZSBpZiB0aGUgb3JkZXIgYXBwZWFycyB2YWxpZC5cbiAgICovXG4gIHZhbGlkYXRlT3JkZXIgKG9yZGVyOiBUcmFkZUZvcm0pIHtcbiAgICBjb25zdCB7IHBhZ2UsIG1hcmtldDogeyBjZmc6IHsgbWluaW11bVJhdGUgfSwgcmF0ZUNvbnZlcnNpb25GYWN0b3IgfSB9ID0gdGhpc1xuICAgIGlmIChvcmRlci5pc0xpbWl0KSB7XG4gICAgICBpZiAoIW9yZGVyLnJhdGUpIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS5vcmRlckVycilcbiAgICAgICAgcGFnZS5vcmRlckVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX1pFUk9fUkFURSlcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgICBpZiAob3JkZXIucmF0ZSA8IG1pbmltdW1SYXRlKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2Uub3JkZXJFcnIpXG4gICAgICAgIGNvbnN0IFtyLCBtaW5SYXRlXSA9IFtvcmRlci5yYXRlIC8gcmF0ZUNvbnZlcnNpb25GYWN0b3IsIG1pbmltdW1SYXRlIC8gcmF0ZUNvbnZlcnNpb25GYWN0b3JdXG4gICAgICAgIHBhZ2Uub3JkZXJFcnIudGV4dENvbnRlbnQgPSBgcmF0ZSBpcyBsb3dlciB0aGFuIHRoZSBtYXJrZXQncyBtaW5pbXVtIHJhdGUuICR7cn0gPCAke21pblJhdGV9YFxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFvcmRlci5xdHkpIHtcbiAgICAgIERvYy5zaG93KHBhZ2Uub3JkZXJFcnIpXG4gICAgICBwYWdlLm9yZGVyRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fWkVST19RVUFOVElUWSlcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgLyogaGFuZGxlQm9vayBhY2NlcHRzIHRoZSBkYXRhIHNlbnQgaW4gdGhlICdib29rJyBub3RpZmljYXRpb24uICovXG4gIGhhbmRsZUJvb2sgKGRhdGE6IE1hcmtldE9yZGVyQm9vaykge1xuICAgIGNvbnN0IHsgY2ZnLCBiYXNlVW5pdEluZm8sIHF1b3RlVW5pdEluZm8sIGJhc2VDZmcsIHF1b3RlQ2ZnIH0gPSB0aGlzLm1hcmtldFxuICAgIHRoaXMuYm9vayA9IG5ldyBPcmRlckJvb2soZGF0YSwgYmFzZUNmZy5zeW1ib2wsIHF1b3RlQ2ZnLnN5bWJvbClcbiAgICB0aGlzLmxvYWRUYWJsZSgpXG4gICAgZm9yIChjb25zdCBvcmRlciBvZiAoZGF0YS5ib29rLmVwb2NoIHx8IFtdKSkge1xuICAgICAgaWYgKG9yZGVyLnJhdGUgPiAwKSB0aGlzLmJvb2suYWRkKG9yZGVyKVxuICAgICAgdGhpcy5hZGRUYWJsZU9yZGVyKG9yZGVyKVxuICAgIH1cbiAgICBpZiAoIXRoaXMuYm9vaykge1xuICAgICAgdGhpcy5kZXB0aENoYXJ0LmNsZWFyKClcbiAgICAgIERvYy5lbXB0eSh0aGlzLnBhZ2UuYnV5Um93cylcbiAgICAgIERvYy5lbXB0eSh0aGlzLnBhZ2Uuc2VsbFJvd3MpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLnNob3codGhpcy5wYWdlLmVwb2NoTGluZSlcbiAgICBpZiAodGhpcy5sb2FkaW5nQW5pbWF0aW9ucy5kZXB0aCkgdGhpcy5sb2FkaW5nQW5pbWF0aW9ucy5kZXB0aC5zdG9wKClcbiAgICB0aGlzLmRlcHRoQ2hhcnQuY2FudmFzLmNsYXNzTGlzdC5yZW1vdmUoJ2ludmlzaWJsZScpXG4gICAgdGhpcy5kZXB0aENoYXJ0LnNldCh0aGlzLmJvb2ssIGNmZy5sb3RzaXplLCBjZmcucmF0ZXN0ZXAsIGJhc2VVbml0SW5mbywgcXVvdGVVbml0SW5mbylcbiAgICB0aGlzLnJlY2VudE1hdGNoZXMgPSBkYXRhLmJvb2sucmVjZW50TWF0Y2hlcyA/PyBbXVxuICAgIHRoaXMucmVmcmVzaFJlY2VudE1hdGNoZXNUYWJsZSgpXG4gIH1cblxuICAvKlxuICAgKiBtaWRHYXBDb252ZW50aW9uYWwgaXMgdGhlIHNhbWUgYXMgbWlkR2FwLCBidXQgcmV0dXJucyB0aGUgbWlkLWdhcCByYXRlIGFzXG4gICAqIHRoZSBjb252ZW50aW9uYWwgcmF0aW8uIFRoaXMgaXMgdXNlZCB0byBjb252ZXJ0IGZyb20gYSBjb252ZW50aW9uYWxcbiAgICogcXVhbnRpdHkgZnJvbSBiYXNlIHRvIHF1b3RlIG9yIHZpY2UtdmVyc2EsIG9yIGZvciBkaXNwbGF5IHB1cnBvc2VzLlxuICAgKi9cbiAgbWlkR2FwQ29udmVudGlvbmFsICgpIHtcbiAgICBjb25zdCBnYXAgPSB0aGlzLm1pZEdhcCgpXG4gICAgaWYgKCFnYXApIHJldHVybiBnYXBcbiAgICBjb25zdCB7IGJhc2VVbml0SW5mbzogYiwgcXVvdGVVbml0SW5mbzogcSB9ID0gdGhpcy5tYXJrZXRcbiAgICByZXR1cm4gZ2FwICogYi5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAvIHEuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgfVxuXG4gIC8qXG4gICAqIG1pZEdhcCByZXR1cm5zIHRoZSB2YWx1ZSBpbiB0aGUgbWlkZGxlIG9mIHRoZSBiZXN0IGJ1eSBhbmQgYmVzdCBzZWxsLiBJZlxuICAgKiBlaXRoZXIgb25lIG9mIHRoZSBidXkgb3Igc2VsbCBzaWRlcyBhcmUgZW1wdHksIG1pZEdhcCByZXR1cm5zIHRoZSBiZXN0IHJhdGVcbiAgICogZnJvbSB0aGUgb3RoZXIgc2lkZS4gSWYgYm90aCBzaWRlcyBhcmUgZW1wdHksIG1pZEdhcCByZXR1cm5zIHRoZSB2YWx1ZVxuICAgKiBudWxsLiBUaGUgcmF0ZSByZXR1cm5lZCBpcyB0aGUgYXRvbWljIHJhdGlvLCB1c2VkIGZvciBjb252ZXJzaW9uLiBGb3IgYVxuICAgKiBjb252ZW50aW9uYWwgcmF0ZSBmb3IgZGlzcGxheSBvciB0byBjb252ZXJ0IGNvbnZlbnRpb25hbCB1bml0cywgdXNlXG4gICAqIG1pZEdhcENvbnZlbnRpb25hbFxuICAgKi9cbiAgbWlkR2FwICgpIHtcbiAgICBjb25zdCBib29rID0gdGhpcy5ib29rXG4gICAgaWYgKCFib29rKSByZXR1cm5cbiAgICBpZiAoYm9vay5idXlzICYmIGJvb2suYnV5cy5sZW5ndGgpIHtcbiAgICAgIGlmIChib29rLnNlbGxzICYmIGJvb2suc2VsbHMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiAoYm9vay5idXlzWzBdLm1zZ1JhdGUgKyBib29rLnNlbGxzWzBdLm1zZ1JhdGUpIC8gMiAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3JcbiAgICAgIH1cbiAgICAgIHJldHVybiBib29rLmJ1eXNbMF0ubXNnUmF0ZSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3JcbiAgICB9XG4gICAgaWYgKGJvb2suc2VsbHMgJiYgYm9vay5zZWxscy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBib29rLnNlbGxzWzBdLm1zZ1JhdGUgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yXG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKlxuICAgKiBzZXRNYXJrZXRCdXlPcmRlckVzdGltYXRlIHNldHMgdGhlIFwibWluLiBidXlcIiBkaXNwbGF5IGZvciB0aGUgY3VycmVudFxuICAgKiBtYXJrZXQuXG4gICAqL1xuICBzZXRNYXJrZXRCdXlPcmRlckVzdGltYXRlICgpIHtcbiAgICBjb25zdCBtYXJrZXQgPSB0aGlzLm1hcmtldFxuICAgIGNvbnN0IGxvdFNpemUgPSBtYXJrZXQuY2ZnLmxvdHNpemVcbiAgICBjb25zdCB4YyA9IGFwcCgpLnVzZXIuZXhjaGFuZ2VzW21hcmtldC5kZXguaG9zdF1cbiAgICBjb25zdCBidWZmZXIgPSB4Yy5tYXJrZXRzW21hcmtldC5zaWRdLmJ1eWJ1ZmZlclxuICAgIGNvbnN0IGdhcCA9IHRoaXMubWlkR2FwQ29udmVudGlvbmFsKClcbiAgICBpZiAoZ2FwKSB7XG4gICAgICB0aGlzLnBhZ2UubWluTWt0QnV5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShsb3RTaXplICogYnVmZmVyICogZ2FwLCBtYXJrZXQuYmFzZVVuaXRJbmZvKVxuICAgIH1cbiAgfVxuXG4gIG1heFVzZXJPcmRlckNvdW50ICgpOiBudW1iZXIge1xuICAgIGNvbnN0IHsgZGV4OiB7IGhvc3QgfSwgY2ZnOiB7IG5hbWU6IG1rdElEIH0gfSA9IHRoaXMubWFya2V0XG4gICAgcmV0dXJuIE1hdGgubWF4KG1heFVzZXJPcmRlcnNTaG93biwgYXBwKCkub3JkZXJzKGhvc3QsIG1rdElEKS5sZW5ndGgpXG4gIH1cblxuICBhc3luYyBsb2FkVXNlck9yZGVycyAoKSB7XG4gICAgY29uc3QgeyBiYXNlOiBiLCBxdW90ZTogcSwgZGV4OiB7IGhvc3QgfSwgY2ZnOiB7IG5hbWU6IG1rdElEIH0gfSA9IHRoaXMubWFya2V0XG4gICAgZm9yIChjb25zdCBvaWQgaW4gdGhpcy5tZXRhT3JkZXJzKSBkZWxldGUgdGhpcy5tZXRhT3JkZXJzW29pZF1cbiAgICBpZiAoIWIgfHwgIXEpIHJldHVybiB0aGlzLnJlc29sdmVVc2VyT3JkZXJzKFtdKSAvLyB1bnN1cHBvcnRlZCBhc3NldFxuICAgIGNvbnN0IGFjdGl2ZU9yZGVycyA9IGFwcCgpLm9yZGVycyhob3N0LCBta3RJRClcbiAgICBpZiAoYWN0aXZlT3JkZXJzLmxlbmd0aCA+PSBtYXhVc2VyT3JkZXJzU2hvd24pIHJldHVybiB0aGlzLnJlc29sdmVVc2VyT3JkZXJzKGFjdGl2ZU9yZGVycylcbiAgICBjb25zdCBmaWx0ZXI6IE9yZGVyRmlsdGVyID0ge1xuICAgICAgaG9zdHM6IFtob3N0XSxcbiAgICAgIG1hcmtldDogeyBiYXNlSUQ6IGIuaWQsIHF1b3RlSUQ6IHEuaWQgfSxcbiAgICAgIG46IHRoaXMubWF4VXNlck9yZGVyQ291bnQoKVxuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9vcmRlcnMnLCBmaWx0ZXIpXG4gICAgY29uc3Qgb3JkZXJzID0gcmVzLm9yZGVycyB8fCBbXVxuICAgIC8vIE1ha2Ugc3VyZSBhbGwgYWN0aXZlIG9yZGVycyBhcmUgaW4gdGhlcmUuIFRoZSAvb3JkZXJzIEFQSSBzb3J0cyBieSB0aW1lLFxuICAgIC8vIHNvIGlmIHRoZXJlIGlzIGFyZSAxMCBjYW5jZWxsZWQvZXhlY3V0ZWQgb3JkZXJzIG5ld2VyIHRoYW4gYW4gb2xkIGFjdGl2ZVxuICAgIC8vIG9yZGVyLCB0aGUgYWN0aXZlIG9yZGVyIHdvdWxkbid0IGJlIGluY2x1ZGVkIGluIHRoZSByZXN1bHQuXG4gICAgZm9yIChjb25zdCBhY3RpdmVPcmQgb2YgYWN0aXZlT3JkZXJzKSBpZiAoIW9yZGVycy5zb21lKChkYk9yZDogT3JkZXIpID0+IGRiT3JkLmlkID09PSBhY3RpdmVPcmQuaWQpKSBvcmRlcnMucHVzaChhY3RpdmVPcmQpXG4gICAgcmV0dXJuIHRoaXMucmVzb2x2ZVVzZXJPcmRlcnMocmVzLm9yZGVycyB8fCBbXSlcbiAgfVxuXG4gIC8qIHJlZnJlc2hBY3RpdmVPcmRlcnMgcmVmcmVzaGVzIHRoZSB1c2VyJ3MgYWN0aXZlIG9yZGVyIGxpc3QuICovXG4gIHJlZnJlc2hBY3RpdmVPcmRlcnMgKCkge1xuICAgIGNvbnN0IG9yZGVycyA9IGFwcCgpLm9yZGVycyh0aGlzLm1hcmtldC5kZXguaG9zdCwgbWFya2V0SUQodGhpcy5tYXJrZXQuYmFzZUNmZy5zeW1ib2wsIHRoaXMubWFya2V0LnF1b3RlQ2ZnLnN5bWJvbCkpXG4gICAgcmV0dXJuIHRoaXMucmVzb2x2ZVVzZXJPcmRlcnMob3JkZXJzKVxuICB9XG5cbiAgcmVzb2x2ZVVzZXJPcmRlcnMgKG9yZGVyczogT3JkZXJbXSkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWV0YU9yZGVycywgbWFya2V0IH0gPSB0aGlzXG4gICAgY29uc3QgY2ZnID0gbWFya2V0LmNmZ1xuXG4gICAgY29uc3Qgb3JkZXJJc0FjdGl2ZSA9IChvcmQ6IE9yZGVyKSA9PiBvcmQuc3RhdHVzIDwgT3JkZXJVdGlsLlN0YXR1c0V4ZWN1dGVkIHx8IE9yZGVyVXRpbC5oYXNBY3RpdmVNYXRjaGVzKG9yZClcblxuICAgIGZvciAoY29uc3Qgb3JkIG9mIG9yZGVycykgbWV0YU9yZGVyc1tvcmQuaWRdID0geyBvcmQ6IG9yZCB9IGFzIE1ldGFPcmRlclxuICAgIGxldCBzb3J0ZWRPcmRlcnMgPSBPYmplY3Qua2V5cyhtZXRhT3JkZXJzKS5tYXAoKG9pZDogc3RyaW5nKSA9PiBtZXRhT3JkZXJzW29pZF0pXG4gICAgc29ydGVkT3JkZXJzLnNvcnQoKGE6IE1ldGFPcmRlciwgYjogTWV0YU9yZGVyKSA9PiB7XG4gICAgICBjb25zdCBbYUFjdGl2ZSwgYkFjdGl2ZV0gPSBbb3JkZXJJc0FjdGl2ZShhLm9yZCksIG9yZGVySXNBY3RpdmUoYi5vcmQpXVxuICAgICAgaWYgKGFBY3RpdmUgJiYgIWJBY3RpdmUpIHJldHVybiAtMVxuICAgICAgZWxzZSBpZiAoIWFBY3RpdmUgJiYgYkFjdGl2ZSkgcmV0dXJuIDFcbiAgICAgIHJldHVybiBiLm9yZC5zdWJtaXRUaW1lIC0gYS5vcmQuc3VibWl0VGltZVxuICAgIH0pXG4gICAgY29uc3QgbiA9IHRoaXMubWF4VXNlck9yZGVyQ291bnQoKVxuICAgIGlmIChzb3J0ZWRPcmRlcnMubGVuZ3RoID4gbikgeyBzb3J0ZWRPcmRlcnMgPSBzb3J0ZWRPcmRlcnMuc2xpY2UoMCwgbikgfVxuXG4gICAgZm9yIChjb25zdCBvaWQgaW4gbWV0YU9yZGVycykgZGVsZXRlIG1ldGFPcmRlcnNbb2lkXVxuXG4gICAgRG9jLmVtcHR5KHBhZ2UudXNlck9yZGVycylcbiAgICBEb2Muc2V0VmlzKHNvcnRlZE9yZGVycz8ubGVuZ3RoLCBwYWdlLnVzZXJPcmRlcnMpXG4gICAgRG9jLnNldFZpcyghc29ydGVkT3JkZXJzPy5sZW5ndGgsIHBhZ2UudXNlck5vT3JkZXJzKVxuXG4gICAgbGV0IHVucmVhZHlPcmRlcnMgPSBmYWxzZVxuICAgIGZvciAoY29uc3QgbW9yZCBvZiBzb3J0ZWRPcmRlcnMpIHtcbiAgICAgIGNvbnN0IGRpdiA9IHBhZ2UudXNlck9yZGVyVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIHBhZ2UudXNlck9yZGVycy5hcHBlbmRDaGlsZChkaXYpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgICAgY29uc3QgaGVhZGVyID0gRG9jLnBhcnNlVGVtcGxhdGUodG1wbC5oZWFkZXIpXG4gICAgICBjb25zdCBkZXRhaWxzID0gRG9jLnBhcnNlVGVtcGxhdGUodG1wbC5kZXRhaWxzKVxuXG4gICAgICBtb3JkLmRpdiA9IGRpdlxuICAgICAgbW9yZC5oZWFkZXIgPSBoZWFkZXJcbiAgICAgIG1vcmQuZGV0YWlscyA9IGRldGFpbHNcbiAgICAgIGNvbnN0IG9yZCA9IG1vcmQub3JkXG5cbiAgICAgIGNvbnN0IG9yZGVySUQgPSBvcmQuaWRcbiAgICAgIGNvbnN0IGlzQWN0aXZlID0gb3JkZXJJc0FjdGl2ZShvcmQpXG5cbiAgICAgIC8vIE5vIG5lZWQgdG8gdHJhY2sgaW4tZmxpZ2h0IG9yZGVycyBoZXJlLiBXZSd2ZSBhbHJlYWR5IGFkZGVkIGl0IHRvXG4gICAgICAvLyBkaXNwbGF5LlxuICAgICAgaWYgKG9yZGVySUQpIG1ldGFPcmRlcnNbb3JkZXJJRF0gPSBtb3JkXG5cbiAgICAgIGlmICghb3JkLnJlYWR5VG9UaWNrICYmIE9yZGVyVXRpbC5oYXNBY3RpdmVNYXRjaGVzKG9yZCkpIHtcbiAgICAgICAgdG1wbC5oZWFkZXIuY2xhc3NMaXN0LmFkZCgndW5yZWFkeS11c2VyLW9yZGVyJylcbiAgICAgICAgdW5yZWFkeU9yZGVycyA9IHRydWVcbiAgICAgIH1cbiAgICAgIGhlYWRlci5zaWRlTGlnaHQuY2xhc3NMaXN0LmFkZChvcmQuc2VsbCA/ICdzZWxsJyA6ICdidXknKVxuICAgICAgaWYgKCFpc0FjdGl2ZSkgaGVhZGVyLnNpZGVMaWdodC5jbGFzc0xpc3QuYWRkKCdpbmFjdGl2ZScpXG4gICAgICBkZXRhaWxzLnNpZGUudGV4dENvbnRlbnQgPSBtb3JkLmhlYWRlci5zaWRlLnRleHRDb250ZW50ID0gT3JkZXJVdGlsLnNlbGxTdHJpbmcob3JkKVxuICAgICAgZGV0YWlscy5zaWRlLmNsYXNzTGlzdC5hZGQob3JkLnNlbGwgPyAnc2VsbGNvbG9yJyA6ICdidXljb2xvcicpXG4gICAgICBoZWFkZXIuc2lkZS5jbGFzc0xpc3QuYWRkKG9yZC5zZWxsID8gJ3NlbGxjb2xvcicgOiAnYnV5Y29sb3InKVxuICAgICAgZGV0YWlscy5xdHkudGV4dENvbnRlbnQgPSBtb3JkLmhlYWRlci5xdHkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHksIG1hcmtldC5iYXNlVW5pdEluZm8pXG4gICAgICBsZXQgcmF0ZVN0cjogc3RyaW5nXG4gICAgICBpZiAob3JkLnR5cGUgPT09IE9yZGVyVXRpbC5NYXJrZXQpIHJhdGVTdHIgPSB0aGlzLm1hcmtldE9yZGVyUmF0ZVN0cmluZyhvcmQsIG1hcmtldClcbiAgICAgIGVsc2UgcmF0ZVN0ciA9IERvYy5mb3JtYXRSYXRlRnVsbFByZWNpc2lvbihvcmQucmF0ZSwgbWFya2V0LmJhc2VVbml0SW5mbywgbWFya2V0LnF1b3RlVW5pdEluZm8sIGNmZy5yYXRlc3RlcClcbiAgICAgIGRldGFpbHMucmF0ZS50ZXh0Q29udGVudCA9IG1vcmQuaGVhZGVyLnJhdGUudGV4dENvbnRlbnQgPSByYXRlU3RyXG4gICAgICBoZWFkZXIuYmFzZVN5bWJvbC50ZXh0Q29udGVudCA9IG1hcmtldC5iYXNlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICAgIGRldGFpbHMudHlwZS50ZXh0Q29udGVudCA9IG1hcmtldC5xdW90ZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XG4gICAgICB0aGlzLnVwZGF0ZU1ldGFPcmRlcihtb3JkKVxuXG4gICAgICBEb2MuYmluZChkaXYsICdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICB0aGlzLmFjdGl2ZU1hcmtlclJhdGUgPSBvcmQucmF0ZVxuICAgICAgICB0aGlzLnNldERlcHRoTWFya2VycygpXG4gICAgICB9KVxuXG4gICAgICBjb25zdCBzaG93Q2FuY2VsID0gKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgICAgdGhpcy5zaG93Q2FuY2VsKGRpdiwgb3JkZXJJRClcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2hvd0FjY2VsZXJhdGUgPSAoZTogRXZlbnQpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICB0aGlzLnNob3dBY2NlbGVyYXRlKG9yZClcbiAgICAgIH1cblxuICAgICAgaWYgKCFvcmRlcklEKSB7XG4gICAgICAgIERvYy5oaWRlKGRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4pXG4gICAgICAgIERvYy5oaWRlKGRldGFpbHMuY2FuY2VsQnR0bilcbiAgICAgICAgRG9jLmhpZGUoZGV0YWlscy5saW5rKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKE9yZGVyVXRpbC5pc0NhbmNlbGxhYmxlKG9yZCkpIHtcbiAgICAgICAgICBEb2Muc2hvdyhkZXRhaWxzLmNhbmNlbEJ0dG4pXG4gICAgICAgICAgYmluZChkZXRhaWxzLmNhbmNlbEJ0dG4sICdjbGljaycsIChlOiBFdmVudCkgPT4geyBzaG93Q2FuY2VsKGUpIH0pXG4gICAgICAgIH1cblxuICAgICAgICBiaW5kKGRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4sICdjbGljaycsIChlOiBFdmVudCkgPT4geyBzaG93QWNjZWxlcmF0ZShlKSB9KVxuICAgICAgICBpZiAoYXBwKCkuY2FuQWNjZWxlcmF0ZU9yZGVyKG9yZCkpIHtcbiAgICAgICAgICBEb2Muc2hvdyhkZXRhaWxzLmFjY2VsZXJhdGVCdHRuKVxuICAgICAgICB9XG5cbiAgICAgICAgZGV0YWlscy5saW5rLmhyZWYgPSBgb3JkZXIvJHtvcmRlcklEfWBcbiAgICAgICAgYXBwKCkuYmluZEludGVybmFsTmF2aWdhdGlvbihkaXYpXG4gICAgICB9XG4gICAgICBsZXQgY3VycmVudEZsb2F0ZXI6IChQYWdlRWxlbWVudCB8IG51bGwpXG4gICAgICBEb2MuYmluZCh0bXBsLmhlYWRlciwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBpZiAoRG9jLmlzRGlzcGxheWVkKHRtcGwuZGV0YWlscykpIHtcbiAgICAgICAgICBEb2MuaGlkZSh0bXBsLmRldGFpbHMpXG4gICAgICAgICAgaGVhZGVyLmV4cGFuZGVyLmNsYXNzTGlzdC5hZGQoJ2ljby1hcnJvd2Rvd24nKVxuICAgICAgICAgIGhlYWRlci5leHBhbmRlci5jbGFzc0xpc3QucmVtb3ZlKCdpY28tYXJyb3d1cCcpXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgRG9jLnNob3codG1wbC5kZXRhaWxzKVxuICAgICAgICBoZWFkZXIuZXhwYW5kZXIuY2xhc3NMaXN0LnJlbW92ZSgnaWNvLWFycm93ZG93bicpXG4gICAgICAgIGhlYWRlci5leHBhbmRlci5jbGFzc0xpc3QuYWRkKCdpY28tYXJyb3d1cCcpXG4gICAgICAgIGlmIChjdXJyZW50RmxvYXRlcikgY3VycmVudEZsb2F0ZXIucmVtb3ZlKClcbiAgICAgIH0pXG4gICAgICAvKipcbiAgICAgICAqIFdlJ2xsIHNob3cgdGhlIGJ1dHRvbiBtZW51IHdoZW4gdGhleSBob3ZlciBvdmVyIHRoZSBoZWFkZXIuIFRvIGF2b2lkXG4gICAgICAgKiBwdXNoaW5nIHRoZSBsYXlvdXQgYXJvdW5kLCB3ZSdsbCBzaG93IHRoZSBidXR0b25zIGFzIGFuIGFic29sdXRlbHlcbiAgICAgICAqIHBvc2l0aW9uZWQgY29weSBvZiB0aGUgYnV0dG9uIG1lbnUuXG4gICAgICAgKi9cbiAgICAgIERvYy5iaW5kKHRtcGwuaGVhZGVyLCAnbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgLy8gRG9uJ3Qgc2hvdyB0aGUgY29weSBpZiB0aGUgZGV0YWlscyBhcmUgYWxyZWFkeSBkaXNwbGF5ZWQuXG4gICAgICAgIGlmIChEb2MuaXNEaXNwbGF5ZWQodG1wbC5kZXRhaWxzKSkgcmV0dXJuXG4gICAgICAgIGlmIChjdXJyZW50RmxvYXRlcikgY3VycmVudEZsb2F0ZXIucmVtb3ZlKClcbiAgICAgICAgLy8gQ3JlYXRlIGFuZCBwb3NpdGlvbiB0aGUgZWxlbWVudCBiYXNlZCBvbiB0aGUgcG9zaXRpb24gb2YgdGhlIGhlYWRlci5cbiAgICAgICAgY29uc3QgZmxvYXRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgIGN1cnJlbnRGbG9hdGVyID0gZmxvYXRlclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZsb2F0ZXIpXG4gICAgICAgIGZsb2F0ZXIuY2xhc3NOYW1lID0gJ3VzZXItb3JkZXItZmxvYXR5LW1lbnUnXG4gICAgICAgIGNvbnN0IG0gPSBEb2MubGF5b3V0TWV0cmljcyh0bXBsLmhlYWRlcilcbiAgICAgICAgY29uc3QgeSA9IG0uYm9keVRvcCArIG0uaGVpZ2h0XG4gICAgICAgIGZsb2F0ZXIuc3R5bGUudG9wID0gYCR7eSAtIDF9cHhgIC8vIC0gMSB0byBoaWRlIGJvcmRlciBvbiBoZWFkZXIgZGl2XG4gICAgICAgIGZsb2F0ZXIuc3R5bGUubGVmdCA9IGAke20uYm9keUxlZnR9cHhgXG4gICAgICAgIC8vIEdldCB0aGUgdXBkYXRlZCB2ZXJzaW9uIG9mIHRoZSBvcmRlclxuICAgICAgICBjb25zdCBtb3JkID0gdGhpcy5tZXRhT3JkZXJzW29yZGVySURdXG4gICAgICAgIGNvbnN0IG9yZCA9IG1vcmQub3JkXG5cbiAgICAgICAgY29uc3QgYWRkQnV0dG9uID0gKGJhc2VCdHRuOiBQYWdlRWxlbWVudCwgY2I6ICgoZTogRXZlbnQpID0+IHZvaWQpKSA9PiB7XG4gICAgICAgICAgY29uc3QgaWNvbiA9IGJhc2VCdHRuLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICAgIGZsb2F0ZXIuYXBwZW5kQ2hpbGQoaWNvbilcbiAgICAgICAgICBEb2Muc2hvdyhpY29uKVxuICAgICAgICAgIERvYy5iaW5kKGljb24sICdjbGljaycsIChlOiBFdmVudCkgPT4geyBjYihlKSB9KVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKE9yZGVyVXRpbC5pc0NhbmNlbGxhYmxlKG9yZCkpIGFkZEJ1dHRvbihkZXRhaWxzLmNhbmNlbEJ0dG4sIChlOiBFdmVudCkgPT4geyBzaG93Q2FuY2VsKGUpIH0pXG4gICAgICAgIGlmIChhcHAoKS5jYW5BY2NlbGVyYXRlT3JkZXIob3JkKSkgYWRkQnV0dG9uKGRldGFpbHMuYWNjZWxlcmF0ZUJ0dG4sIChlOiBFdmVudCkgPT4geyBzaG93QWNjZWxlcmF0ZShlKSB9KVxuICAgICAgICBmbG9hdGVyLmFwcGVuZENoaWxkKGRldGFpbHMubGluay5jbG9uZU5vZGUodHJ1ZSkpXG5cbiAgICAgICAgY29uc3Qgb2dTY3JvbGxZID0gcGFnZS5vcmRlclNjcm9sbGVyLnNjcm9sbFRvcFxuICAgICAgICAvLyBTZXQgdXAgdGhlIGhvdmVyIGludGVyYWN0aW9ucy5cbiAgICAgICAgY29uc3QgbW92ZWQgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgIC8vIElmIHRoZSB1c2VyIHNjcm9sbGVkLCByZXBvc2l0aW9uIHRoZSBmbG9hdCBtZW51LiBUaGlzIGtlZXBzIHRoZVxuICAgICAgICAgIC8vIG1lbnUgZnJvbSBmb2xsb3dpbmcgdXMgYXJvdW5kLCB3aGljaCBjYW4gcHJldmVudCByZW1vdmFsIGJlbG93LlxuICAgICAgICAgIGNvbnN0IHlTaGlmdCA9IHBhZ2Uub3JkZXJTY3JvbGxlci5zY3JvbGxUb3AgLSBvZ1Njcm9sbFlcbiAgICAgICAgICBmbG9hdGVyLnN0eWxlLnRvcCA9IGAke3kgKyB5U2hpZnR9cHhgXG4gICAgICAgICAgaWYgKERvYy5tb3VzZUluRWxlbWVudChlLCBmbG9hdGVyKSB8fCBEb2MubW91c2VJbkVsZW1lbnQoZSwgZGl2KSkgcmV0dXJuXG4gICAgICAgICAgZmxvYXRlci5yZW1vdmUoKVxuICAgICAgICAgIGN1cnJlbnRGbG9hdGVyID0gbnVsbFxuICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG1vdmVkKVxuICAgICAgICAgIHBhZ2Uub3JkZXJTY3JvbGxlci5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBtb3ZlZClcbiAgICAgICAgfVxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBtb3ZlZClcbiAgICAgICAgcGFnZS5vcmRlclNjcm9sbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIG1vdmVkKVxuICAgICAgfSlcbiAgICAgIGFwcCgpLmJpbmRUb29sdGlwcyhkaXYpXG4gICAgfVxuICAgIERvYy5zZXRWaXModW5yZWFkeU9yZGVycywgcGFnZS51bnJlYWR5T3JkZXJzTXNnKVxuICAgIHRoaXMuc2V0RGVwdGhNYXJrZXJzKClcbiAgfVxuXG4gIC8qXG4gICBtYXJrZXRPcmRlclJhdGVTdHJpbmcgdXNlcyB0aGUgbWFya2V0IGNvbmZpZyByYXRlIHN0ZXAgdG8gZm9ybWF0IHRoZSBhdmVyYWdlXG4gICBtYXJrZXQgb3JkZXIgcmF0ZS5cbiAgKi9cbiAgbWFya2V0T3JkZXJSYXRlU3RyaW5nIChvcmQ6IE9yZGVyLCBta3Q6IEN1cnJlbnRNYXJrZXQpIDpzdHJpbmcge1xuICAgIGlmICghb3JkLm1hdGNoZXM/Lmxlbmd0aCkgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BUktFVF9PUkRFUilcbiAgICBsZXQgcmF0ZVN0ciA9IERvYy5mb3JtYXRSYXRlRnVsbFByZWNpc2lvbihPcmRlclV0aWwuYXZlcmFnZVJhdGUob3JkKSwgbWt0LmJhc2VVbml0SW5mbywgbWt0LnF1b3RlVW5pdEluZm8sIG1rdC5jZmcucmF0ZXN0ZXApXG4gICAgaWYgKG9yZC5tYXRjaGVzLmxlbmd0aCA+IDEpIHJhdGVTdHIgPSAnfiAnICsgcmF0ZVN0ciAvLyB+IG9ubHkgbWFrZXMgc2Vuc2UgaWYgdGhlIG9yZGVyIGhhcyBtb3JlIHRoYW4gb25lIG1hdGNoXG4gICAgcmV0dXJuIHJhdGVTdHJcbiAgfVxuXG4gIC8qXG4gICogdXBkYXRlTWV0YU9yZGVyIHNldHMgdGhlIHRkIGNvbnRlbnRzIG9mIHRoZSB1c2VyJ3Mgb3JkZXIgdGFibGUgcm93LlxuICAqL1xuICB1cGRhdGVNZXRhT3JkZXIgKG1vcmQ6IE1ldGFPcmRlcikge1xuICAgIGNvbnN0IHsgaGVhZGVyLCBkZXRhaWxzLCBvcmQgfSA9IG1vcmRcbiAgICBpZiAob3JkLnN0YXR1cyA8PSBPcmRlclV0aWwuU3RhdHVzQm9va2VkIHx8IE9yZGVyVXRpbC5oYXNBY3RpdmVNYXRjaGVzKG9yZCkpIGhlYWRlci5hY3RpdmVMaWdodC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgIGVsc2UgaGVhZGVyLmFjdGl2ZUxpZ2h0LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgZGV0YWlscy5zdGF0dXMudGV4dENvbnRlbnQgPSBoZWFkZXIuc3RhdHVzLnRleHRDb250ZW50ID0gT3JkZXJVdGlsLnN0YXR1c1N0cmluZyhvcmQpXG4gICAgZGV0YWlscy5hZ2UudGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKG9yZC5zdWJtaXRUaW1lKVxuICAgIGRldGFpbHMuZmlsbGVkLnRleHRDb250ZW50ID0gYCR7KE9yZGVyVXRpbC5maWxsZWQob3JkKSAvIG9yZC5xdHkgKiAxMDApLnRvRml4ZWQoMSl9JWBcbiAgICBkZXRhaWxzLnNldHRsZWQudGV4dENvbnRlbnQgPSBgJHsoT3JkZXJVdGlsLnNldHRsZWQob3JkKSAvIG9yZC5xdHkgKiAxMDApLnRvRml4ZWQoMSl9JWBcbiAgfVxuXG4gIC8qIHNldE1hcmtlcnMgc2V0cyB0aGUgZGVwdGggY2hhcnQgbWFya2VycyBmb3IgYm9va2VkIG9yZGVycy4gKi9cbiAgc2V0RGVwdGhNYXJrZXJzICgpIHtcbiAgICBjb25zdCBtYXJrZXJzOiBSZWNvcmQ8c3RyaW5nLCBEZXB0aE1hcmtlcltdPiA9IHtcbiAgICAgIGJ1eXM6IFtdLFxuICAgICAgc2VsbHM6IFtdXG4gICAgfVxuICAgIGNvbnN0IHJhdGVGYWN0b3IgPSB0aGlzLm1hcmtldC5yYXRlQ29udmVyc2lvbkZhY3RvclxuICAgIGZvciAoY29uc3QgeyBvcmQgfSBvZiBPYmplY3QudmFsdWVzKHRoaXMubWV0YU9yZGVycykpIHtcbiAgICAgIGlmIChvcmQucmF0ZSAmJiBvcmQuc3RhdHVzID09PSBPcmRlclV0aWwuU3RhdHVzQm9va2VkKSB7XG4gICAgICAgIGlmIChvcmQuc2VsbCkge1xuICAgICAgICAgIG1hcmtlcnMuc2VsbHMucHVzaCh7XG4gICAgICAgICAgICByYXRlOiBvcmQucmF0ZSAvIHJhdGVGYWN0b3IsXG4gICAgICAgICAgICBhY3RpdmU6IG9yZC5yYXRlID09PSB0aGlzLmFjdGl2ZU1hcmtlclJhdGVcbiAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1hcmtlcnMuYnV5cy5wdXNoKHtcbiAgICAgICAgICAgIHJhdGU6IG9yZC5yYXRlIC8gcmF0ZUZhY3RvcixcbiAgICAgICAgICAgIGFjdGl2ZTogb3JkLnJhdGUgPT09IHRoaXMuYWN0aXZlTWFya2VyUmF0ZVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5kZXB0aENoYXJ0LnNldE1hcmtlcnMobWFya2VycylcbiAgICBpZiAodGhpcy5ib29rKSB0aGlzLmRlcHRoQ2hhcnQuZHJhdygpXG4gIH1cblxuICAvKiB1cGRhdGVUaXRsZSB1cGRhdGUgdGhlIGJyb3dzZXIgdGl0bGUgYmFzZWQgb24gdGhlIG1pZGdhcCB2YWx1ZSBhbmQgdGhlXG4gICAqIHNlbGVjdGVkIGFzc2V0cy5cbiAgICovXG4gIHVwZGF0ZVRpdGxlICgpIHtcbiAgICAvLyBnZXRzIGZpcnN0IHByaWNlIHZhbHVlIGZyb20gYnV5IG9yIGZyb20gc2VsbCwgc28gd2UgY2FuIHNob3cgaXQgb25cbiAgICAvLyB0aXRsZS5cbiAgICBjb25zdCBtaWRHYXBWYWx1ZSA9IHRoaXMubWlkR2FwQ29udmVudGlvbmFsKClcbiAgICBjb25zdCB7IGJhc2VVbml0SW5mbzogeyBjb252ZW50aW9uYWw6IHsgdW5pdDogYlVuaXQgfSB9LCBxdW90ZVVuaXRJbmZvOiB7IGNvbnZlbnRpb25hbDogeyB1bml0OiBxVW5pdCB9IH0gfSA9IHRoaXMubWFya2V0XG4gICAgaWYgKCFtaWRHYXBWYWx1ZSkgZG9jdW1lbnQudGl0bGUgPSBgJHtiVW5pdH0ke3FVbml0fSB8ICR7dGhpcy5vZ1RpdGxlfWBcbiAgICBlbHNlIGRvY3VtZW50LnRpdGxlID0gYCR7RG9jLmZvcm1hdENvaW5WYWx1ZShtaWRHYXBWYWx1ZSl9IHwgJHtiVW5pdH0ke3FVbml0fSB8ICR7dGhpcy5vZ1RpdGxlfWAgLy8gbW9yZSB0aGFuIDYgbnVtYmVycyBpdCBnZXRzIHRvbyBiaWcgZm9yIHRoZSB0aXRsZS5cbiAgfVxuXG4gIC8qIGhhbmRsZUJvb2tSb3V0ZSBpcyB0aGUgaGFuZGxlciBmb3IgdGhlICdib29rJyBub3RpZmljYXRpb24sIHdoaWNoIGlzIHNlbnRcbiAgICogaW4gcmVzcG9uc2UgdG8gYSBuZXcgbWFya2V0IHN1YnNjcmlwdGlvbi4gVGhlIGRhdGEgcmVjZWl2ZWQgd2lsbCBjb250YWluXG4gICAqIHRoZSBlbnRpcmUgb3JkZXIgYm9vay5cbiAgICovXG4gIGhhbmRsZUJvb2tSb3V0ZSAobm90ZTogQm9va1VwZGF0ZSkge1xuICAgIGFwcCgpLmxvZygnYm9vaycsICdoYW5kbGVCb29rUm91dGU6Jywgbm90ZSlcbiAgICBjb25zdCBta3RCb29rID0gbm90ZS5wYXlsb2FkXG4gICAgY29uc3QgeyBiYXNlQ2ZnOiBiLCBxdW90ZUNmZzogcSwgZGV4OiB7IGhvc3QgfSB9ID0gdGhpcy5tYXJrZXRcbiAgICBpZiAobWt0Qm9vay5iYXNlICE9PSBiLmlkIHx8IG1rdEJvb2sucXVvdGUgIT09IHEuaWQgfHwgbm90ZS5ob3N0ICE9PSBob3N0KSByZXR1cm4gLy8gdXNlciBhbHJlYWR5IGNoYW5nZWQgbWFya2V0c1xuICAgIHRoaXMuaGFuZGxlQm9vayhta3RCb29rKVxuICAgIHRoaXMubWFya2V0LmJvb2tMb2FkZWQgPSB0cnVlXG4gICAgdGhpcy51cGRhdGVUaXRsZSgpXG4gICAgdGhpcy5zZXRNYXJrZXRCdXlPcmRlckVzdGltYXRlKClcbiAgfVxuXG4gIC8qIGhhbmRsZUJvb2tPcmRlclJvdXRlIGlzIHRoZSBoYW5kbGVyIGZvciAnYm9va19vcmRlcicgbm90aWZpY2F0aW9ucy4gKi9cbiAgaGFuZGxlQm9va09yZGVyUm91dGUgKGRhdGE6IEJvb2tVcGRhdGUpIHtcbiAgICBhcHAoKS5sb2coJ2Jvb2snLCAnaGFuZGxlQm9va09yZGVyUm91dGU6JywgZGF0YSlcbiAgICBpZiAoZGF0YS5ob3N0ICE9PSB0aGlzLm1hcmtldC5kZXguaG9zdCB8fCBkYXRhLm1hcmtldElEICE9PSB0aGlzLm1hcmtldC5zaWQpIHJldHVyblxuICAgIGNvbnN0IG9yZGVyID0gZGF0YS5wYXlsb2FkIGFzIE1pbmlPcmRlclxuICAgIGlmIChvcmRlci5yYXRlID4gMCkgdGhpcy5ib29rLmFkZChvcmRlcilcbiAgICB0aGlzLmFkZFRhYmxlT3JkZXIob3JkZXIpXG4gICAgdGhpcy51cGRhdGVUaXRsZSgpXG4gICAgdGhpcy5kZXB0aENoYXJ0LmRyYXcoKVxuICB9XG5cbiAgLyogaGFuZGxlVW5ib29rT3JkZXJSb3V0ZSBpcyB0aGUgaGFuZGxlciBmb3IgJ3VuYm9va19vcmRlcicgbm90aWZpY2F0aW9ucy4gKi9cbiAgaGFuZGxlVW5ib29rT3JkZXJSb3V0ZSAoZGF0YTogQm9va1VwZGF0ZSkge1xuICAgIGFwcCgpLmxvZygnYm9vaycsICdoYW5kbGVVbmJvb2tPcmRlclJvdXRlOicsIGRhdGEpXG4gICAgaWYgKGRhdGEuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QgfHwgZGF0YS5tYXJrZXRJRCAhPT0gdGhpcy5tYXJrZXQuc2lkKSByZXR1cm5cbiAgICBjb25zdCBvcmRlciA9IGRhdGEucGF5bG9hZFxuICAgIHRoaXMuYm9vay5yZW1vdmUob3JkZXIudG9rZW4pXG4gICAgdGhpcy5yZW1vdmVUYWJsZU9yZGVyKG9yZGVyKVxuICAgIHRoaXMudXBkYXRlVGl0bGUoKVxuICAgIHRoaXMuZGVwdGhDaGFydC5kcmF3KClcbiAgfVxuXG4gIC8qXG4gICAqIGhhbmRsZVVwZGF0ZVJlbWFpbmluZ1JvdXRlIGlzIHRoZSBoYW5kbGVyIGZvciAndXBkYXRlX3JlbWFpbmluZydcbiAgICogbm90aWZpY2F0aW9ucy5cbiAgICovXG4gIGhhbmRsZVVwZGF0ZVJlbWFpbmluZ1JvdXRlIChkYXRhOiBCb29rVXBkYXRlKSB7XG4gICAgYXBwKCkubG9nKCdib29rJywgJ2hhbmRsZVVwZGF0ZVJlbWFpbmluZ1JvdXRlOicsIGRhdGEpXG4gICAgaWYgKGRhdGEuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QgfHwgZGF0YS5tYXJrZXRJRCAhPT0gdGhpcy5tYXJrZXQuc2lkKSByZXR1cm5cbiAgICBjb25zdCB1cGRhdGUgPSBkYXRhLnBheWxvYWRcbiAgICB0aGlzLmJvb2sudXBkYXRlUmVtYWluaW5nKHVwZGF0ZS50b2tlbiwgdXBkYXRlLnF0eSwgdXBkYXRlLnF0eUF0b21pYylcbiAgICB0aGlzLnVwZGF0ZVRhYmxlT3JkZXIodXBkYXRlKVxuICAgIHRoaXMuZGVwdGhDaGFydC5kcmF3KClcbiAgfVxuXG4gIC8qIGhhbmRsZUVwb2NoT3JkZXJSb3V0ZSBpcyB0aGUgaGFuZGxlciBmb3IgJ2Vwb2NoX29yZGVyJyBub3RpZmljYXRpb25zLiAqL1xuICBoYW5kbGVFcG9jaE9yZGVyUm91dGUgKGRhdGE6IEJvb2tVcGRhdGUpIHtcbiAgICBhcHAoKS5sb2coJ2Jvb2snLCAnaGFuZGxlRXBvY2hPcmRlclJvdXRlOicsIGRhdGEpXG4gICAgaWYgKGRhdGEuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QgfHwgZGF0YS5tYXJrZXRJRCAhPT0gdGhpcy5tYXJrZXQuc2lkKSByZXR1cm5cbiAgICBjb25zdCBvcmRlciA9IGRhdGEucGF5bG9hZFxuICAgIGlmIChvcmRlci5tc2dSYXRlID4gMCkgdGhpcy5ib29rLmFkZChvcmRlcikgLy8gTm8gY2FuY2VscyBvciBtYXJrZXQgb3JkZXJzXG4gICAgaWYgKG9yZGVyLnF0eUF0b21pYyA+IDApIHRoaXMuYWRkVGFibGVPcmRlcihvcmRlcikgLy8gTm8gY2FuY2VsIG9yZGVyc1xuICAgIHRoaXMuZGVwdGhDaGFydC5kcmF3KClcbiAgfVxuXG4gIC8qIGhhbmRsZUNhbmRsZXNSb3V0ZSBpcyB0aGUgaGFuZGxlciBmb3IgJ2NhbmRsZXMnIG5vdGlmaWNhdGlvbnMuICovXG4gIGhhbmRsZUNhbmRsZXNSb3V0ZSAoZGF0YTogQm9va1VwZGF0ZSkge1xuICAgIGlmICh0aGlzLmNhbmRsZXNMb2FkaW5nKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5jYW5kbGVzTG9hZGluZy50aW1lcilcbiAgICAgIHRoaXMuY2FuZGxlc0xvYWRpbmcubG9hZGVkKClcbiAgICAgIHRoaXMuY2FuZGxlc0xvYWRpbmcgPSBudWxsXG4gICAgfVxuICAgIGlmIChkYXRhLmhvc3QgIT09IHRoaXMubWFya2V0LmRleC5ob3N0IHx8IGRhdGEubWFya2V0SUQgIT09IHRoaXMubWFya2V0LmNmZy5uYW1lKSByZXR1cm5cbiAgICBjb25zdCBkdXIgPSBkYXRhLnBheWxvYWQuZHVyXG4gICAgdGhpcy5tYXJrZXQuY2FuZGxlQ2FjaGVzW2R1cl0gPSBkYXRhLnBheWxvYWRcbiAgICB0aGlzLnNldEhpZ2hMb3coKVxuICAgIGlmICh0aGlzLmNhbmRsZUR1ciAhPT0gZHVyKSByZXR1cm5cbiAgICBpZiAodGhpcy5sb2FkaW5nQW5pbWF0aW9ucy5jYW5kbGVzKSB0aGlzLmxvYWRpbmdBbmltYXRpb25zLmNhbmRsZXMuc3RvcCgpXG4gICAgdGhpcy5jYW5kbGVDaGFydC5jYW52YXMuY2xhc3NMaXN0LnJlbW92ZSgnaW52aXNpYmxlJylcbiAgICB0aGlzLmNhbmRsZUNoYXJ0LnNldENhbmRsZXMoZGF0YS5wYXlsb2FkLCB0aGlzLm1hcmtldC5jZmcsIHRoaXMubWFya2V0LmJhc2VVbml0SW5mbywgdGhpcy5tYXJrZXQucXVvdGVVbml0SW5mbylcbiAgfVxuXG4gIGhhbmRsZUVwb2NoTWF0Y2hTdW1tYXJ5IChkYXRhOiBCb29rVXBkYXRlKSB7XG4gICAgdGhpcy5hZGRSZWNlbnRNYXRjaGVzKGRhdGEucGF5bG9hZC5tYXRjaFN1bW1hcmllcylcbiAgICB0aGlzLnJlZnJlc2hSZWNlbnRNYXRjaGVzVGFibGUoKVxuICB9XG5cbiAgLyogaGFuZGxlQ2FuZGxlVXBkYXRlUm91dGUgaXMgdGhlIGhhbmRsZXIgZm9yICdjYW5kbGVfdXBkYXRlJyBub3RpZmljYXRpb25zLiAqL1xuICBoYW5kbGVDYW5kbGVVcGRhdGVSb3V0ZSAoZGF0YTogQm9va1VwZGF0ZSkge1xuICAgIGlmIChkYXRhLmhvc3QgIT09IHRoaXMubWFya2V0LmRleC5ob3N0KSByZXR1cm5cbiAgICBjb25zdCB7IGR1ciwgY2FuZGxlIH0gPSBkYXRhLnBheWxvYWRcbiAgICBjb25zdCBjYWNoZSA9IHRoaXMubWFya2V0LmNhbmRsZUNhY2hlc1tkdXJdXG4gICAgaWYgKCFjYWNoZSkgcmV0dXJuIC8vIG11c3Qgbm90IGhhdmUgc2VlbiB0aGUgJ2NhbmRsZXMnIG5vdGlmaWNhdGlvbiB5ZXQ/XG4gICAgY29uc3QgY2FuZGxlcyA9IGNhY2hlLmNhbmRsZXNcbiAgICBpZiAoY2FuZGxlcy5sZW5ndGggPT09IDApIGNhbmRsZXMucHVzaChjYW5kbGUpXG4gICAgZWxzZSB7XG4gICAgICBjb25zdCBsYXN0ID0gY2FuZGxlc1tjYW5kbGVzLmxlbmd0aCAtIDFdXG4gICAgICBpZiAobGFzdC5zdGFydFN0YW1wID09PSBjYW5kbGUuc3RhcnRTdGFtcCkgY2FuZGxlc1tjYW5kbGVzLmxlbmd0aCAtIDFdID0gY2FuZGxlXG4gICAgICBlbHNlIGNhbmRsZXMucHVzaChjYW5kbGUpXG4gICAgfVxuICAgIGlmICh0aGlzLmNhbmRsZUR1ciAhPT0gZHVyKSByZXR1cm5cbiAgICB0aGlzLmNhbmRsZUNoYXJ0LmRyYXcoKVxuICB9XG5cbiAgLyogc2hvd0Zvcm0gc2hvd3MgYSBtb2RhbCBmb3JtIHdpdGggYSBsaXR0bGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBzaG93Rm9ybSAoZm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gZm9ybVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZSguLi5BcnJheS5mcm9tKHBhZ2UuZm9ybXMuY2hpbGRyZW4pKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMTAwMDBweCdcbiAgICBEb2Muc2hvdyhwYWdlLmZvcm1zLCBmb3JtKVxuICAgIGNvbnN0IHNoaWZ0ID0gKHBhZ2UuZm9ybXMub2Zmc2V0V2lkdGggKyBmb3JtLm9mZnNldFdpZHRoKSAvIDJcbiAgICBhd2FpdCBEb2MuYW5pbWF0ZShhbmltYXRpb25MZW5ndGgsIHByb2dyZXNzID0+IHtcbiAgICAgIGZvcm0uc3R5bGUucmlnaHQgPSBgJHsoMSAtIHByb2dyZXNzKSAqIHNoaWZ0fXB4YFxuICAgIH0sICdlYXNlT3V0SGFyZCcpXG4gICAgZm9ybS5zdHlsZS5yaWdodCA9ICcwJ1xuICB9XG5cbiAgLypcbiAgICogc2hvd1RvZ2dsZVdhbGxldFN0YXR1cyBkaXNwbGF5cyB0aGUgdG9nZ2xlV2FsbGV0U3RhdHVzQ29uZmlybSBmb3JtIHRvXG4gICAqIGVuYWJsZSBhIHdhbGxldC5cbiAgICovXG4gIHNob3dUb2dnbGVXYWxsZXRTdGF0dXMgKGFzc2V0OiBTdXBwb3J0ZWRBc3NldCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLm9wZW5Bc3NldCA9IGFzc2V0XG4gICAgRG9jLmhpZGUocGFnZS50b2dnbGVXYWxsZXRTdGF0dXNFcnIsIHBhZ2Uud2FsbGV0U3RhdHVzRGlzYWJsZSwgcGFnZS5kaXNhYmxlV2FsbGV0TXNnKVxuICAgIERvYy5zaG93KHBhZ2Uud2FsbGV0U3RhdHVzRW5hYmxlLCBwYWdlLmVuYWJsZVdhbGxldE1zZylcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzQ29uZmlybSlcbiAgfVxuXG4gIC8qXG4gICAqIHRvZ2dsZVdhbGxldFN0YXR1cyB0b2dnbGUgd2FsbGV0cyBzdGF0dXMgdG8gZW5hYmxlZC5cbiAgICovXG4gIGFzeW5jIHRvZ2dsZVdhbGxldFN0YXR1cyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzRXJyKVxuXG4gICAgY29uc3QgdXJsID0gJy9hcGkvdG9nZ2xld2FsbGV0c3RhdHVzJ1xuICAgIGNvbnN0IHJlcSA9IHtcbiAgICAgIGFzc2V0SUQ6IHRoaXMub3BlbkFzc2V0LmlkLFxuICAgICAgZGlzYWJsZTogZmFsc2VcbiAgICB9XG5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzQ29uZmlybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTih1cmwsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0Vyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLmZvcm1zKVxuICAgIHRoaXMuYmFsYW5jZVdndC51cGRhdGVBc3NldCh0aGlzLm9wZW5Bc3NldC5pZClcbiAgfVxuXG4gIC8qIHNob3dWZXJpZnkgc2hvd3MgdGhlIGZvcm0gdG8gYWNjZXB0IHRoZSBjdXJyZW50bHkgcGFyc2VkIG9yZGVyIGluZm9ybWF0aW9uXG4gICAqIGFuZCBjb25maXJtIHN1Ym1pc3Npb24gb2YgdGhlIG9yZGVyIHRvIHRoZSBkZXguXG4gICAqL1xuICBzaG93VmVyaWZ5ICgpIHtcbiAgICB0aGlzLnByZW9yZGVyQ2FjaGUgPSB7fVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBvcmRlciA9IHRoaXMuY3VycmVudE9yZGVyID0gdGhpcy5wYXJzZU9yZGVyKClcbiAgICBjb25zdCBpc1NlbGwgPSBvcmRlci5zZWxsXG4gICAgY29uc3QgYmFzZUFzc2V0ID0gYXBwKCkuYXNzZXRzW29yZGVyLmJhc2VdXG4gICAgY29uc3QgcXVvdGVBc3NldCA9IGFwcCgpLmFzc2V0c1tvcmRlci5xdW90ZV1cbiAgICBjb25zdCB0b0Fzc2V0ID0gaXNTZWxsID8gcXVvdGVBc3NldCA6IGJhc2VBc3NldFxuICAgIGNvbnN0IGZyb21Bc3NldCA9IGlzU2VsbCA/IGJhc2VBc3NldCA6IHF1b3RlQXNzZXRcblxuICAgIGNvbnN0IHNldEljb24gPSAoaWNvbjogUGFnZUVsZW1lbnQpID0+IHtcbiAgICAgIHN3aXRjaCAoaWNvbi5kYXRhc2V0Lmljb24pIHtcbiAgICAgICAgY2FzZSAnZnJvbSc6XG4gICAgICAgICAgaWYgKGZyb21Bc3NldC50b2tlbikge1xuICAgICAgICAgICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS5hc3NldHNbZnJvbUFzc2V0LnRva2VuLnBhcmVudElEXVxuICAgICAgICAgICAgaWNvbi5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50QXNzZXQuc3ltYm9sKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpY29uLnNyYyA9IERvYy5sb2dvUGF0aChmcm9tQXNzZXQuc3ltYm9sKVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICd0byc6XG4gICAgICAgICAgaWYgKHRvQXNzZXQudG9rZW4pIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudEFzc2V0ID0gYXBwKCkuYXNzZXRzW3RvQXNzZXQudG9rZW4ucGFyZW50SURdXG4gICAgICAgICAgICBpY29uLnNyYyA9IERvYy5sb2dvUGF0aChwYXJlbnRBc3NldC5zeW1ib2wpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGljb24uc3JjID0gRG9jLmxvZ29QYXRoKHRvQXNzZXQuc3ltYm9sKVxuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTZXQgdGhlIHRvIGFuZCBmcm9tIGljb25zIGluIHRoZSBmZWUgZGV0YWlscyBwYW5lLlxuICAgIGZvciAoY29uc3QgaWNvbiBvZiBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLnZEZXRhaWxQYW5lLCAnW2RhdGEtaWNvbl0nKSkge1xuICAgICAgc2V0SWNvbihpY29uKVxuICAgIH1cblxuICAgIC8vIFNldCB0aGUgdG8gYW5kIGZyb20gaWNvbnMgaW4gdGhlIGZlZSBzdW1tYXJ5IHBhbmUuXG4gICAgZm9yIChjb25zdCBpY29uIG9mIERvYy5hcHBseVNlbGVjdG9yKHBhZ2UudkZlZVN1bW1hcnksICdbZGF0YS1pY29uXScpKSB7XG4gICAgICBzZXRJY29uKGljb24pXG4gICAgfVxuXG4gICAgRG9jLmhpZGUocGFnZS52UHJlb3JkZXJFcnIpXG4gICAgRG9jLnNob3cocGFnZS52UHJlb3JkZXIpXG5cbiAgICBwYWdlLnZCdXlTZWxsLnRleHRDb250ZW50ID0gaXNTZWxsID8gaW50bC5wcmVwKGludGwuSURfU0VMTElORykgOiBpbnRsLnByZXAoaW50bC5JRF9CVVlJTkcpXG4gICAgY29uc3QgYnV5U2VsbFN0ciA9IGlzU2VsbCA/IGludGwucHJlcChpbnRsLklEX1NFTEwpIDogaW50bC5wcmVwKGludGwuSURfQlVZKVxuICAgIHBhZ2UudlNpZGVTdWJtaXQudGV4dENvbnRlbnQgPSBidXlTZWxsU3RyXG4gICAgcGFnZS52T3JkZXJIb3N0LnRleHRDb250ZW50ID0gb3JkZXIuaG9zdFxuICAgIGlmIChvcmRlci5pc0xpbWl0KSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnZlcmlmeUxpbWl0KVxuICAgICAgRG9jLmhpZGUocGFnZS52ZXJpZnlNYXJrZXQpXG4gICAgICBjb25zdCBvcmRlckRlc2MgPSBgTGltaXQgJHtidXlTZWxsU3RyfSBPcmRlcmBcbiAgICAgIHBhZ2Uudk9yZGVyVHlwZS50ZXh0Q29udGVudCA9IG9yZGVyLnRpZm5vdyA/IG9yZGVyRGVzYyArICcgKGltbWVkaWF0ZSknIDogb3JkZXJEZXNjXG4gICAgICBwYWdlLnZSYXRlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmRlci5yYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgICBwYWdlLnZRdHkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZGVyLnF0eSwgYmFzZUFzc2V0LnVuaXRJbmZvKVxuICAgICAgY29uc3QgdG90YWwgPSBvcmRlci5yYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvciAqIG9yZGVyLnF0eVxuICAgICAgcGFnZS52VG90YWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHRvdGFsLCBxdW90ZUFzc2V0LnVuaXRJbmZvKVxuICAgICAgLy8gRm9ybWF0IHRvdGFsIGZpYXQgdmFsdWUuXG4gICAgICB0aGlzLnNob3dGaWF0VmFsdWUocXVvdGVBc3NldC5pZCwgdG90YWwsIHBhZ2UudkZpYXRUb3RhbClcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS52ZXJpZnlMaW1pdClcbiAgICAgIERvYy5zaG93KHBhZ2UudmVyaWZ5TWFya2V0KVxuICAgICAgcGFnZS52T3JkZXJUeXBlLnRleHRDb250ZW50ID0gYE1hcmtldCAke2J1eVNlbGxTdHJ9IE9yZGVyYFxuICAgICAgY29uc3QgdWkgPSBvcmRlci5zZWxsID8gdGhpcy5tYXJrZXQuYmFzZVVuaXRJbmZvIDogdGhpcy5tYXJrZXQucXVvdGVVbml0SW5mb1xuICAgICAgcGFnZS52bUZyb21Ub3RhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkZXIucXR5LCB1aSlcbiAgICAgIHBhZ2Uudm1Gcm9tQXNzZXQudGV4dENvbnRlbnQgPSBmcm9tQXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKClcbiAgICAgIC8vIEZvcm1hdCBmcm9tQXNzZXQgZmlhdCB2YWx1ZS5cbiAgICAgIHRoaXMuc2hvd0ZpYXRWYWx1ZShmcm9tQXNzZXQuaWQsIG9yZGVyLnF0eSwgcGFnZS52bUZyb21Ub3RhbEZpYXQpXG4gICAgICBjb25zdCBnYXAgPSB0aGlzLm1pZEdhcCgpXG4gICAgICBpZiAoZ2FwKSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2Uudk1hcmtldEVzdGltYXRlKVxuICAgICAgICBjb25zdCByZWNlaXZlZCA9IG9yZGVyLnNlbGwgPyBvcmRlci5xdHkgKiBnYXAgOiBvcmRlci5xdHkgLyBnYXBcbiAgICAgICAgcGFnZS52bVRvVG90YWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlY2VpdmVkLCB0b0Fzc2V0LnVuaXRJbmZvKVxuICAgICAgICBwYWdlLnZtVG9Bc3NldC50ZXh0Q29udGVudCA9IHRvQXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKClcbiAgICAgICAgLy8gRm9ybWF0IHJlY2VpdmVkIHZhbHVlIHRvIGZpYXQgZXF1aXZhbGVudC5cbiAgICAgICAgdGhpcy5zaG93RmlhdFZhbHVlKHRvQXNzZXQuaWQsIHJlY2VpdmVkLCBwYWdlLnZtVG90YWxGaWF0KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgRG9jLmhpZGUocGFnZS52TWFya2V0RXN0aW1hdGUpXG4gICAgICB9XG4gICAgfVxuICAgIC8vIFZpc3VhbGx5IGRpZmZlcmVudGlhdGUgYmV0d2VlbiBidXkvc2VsbCBvcmRlcnMuXG4gICAgaWYgKGlzU2VsbCkge1xuICAgICAgcGFnZS52SGVhZGVyLmNsYXNzTGlzdC5hZGQoc2VsbEJ0bkNsYXNzKVxuICAgICAgcGFnZS52SGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoYnV5QnRuQ2xhc3MpXG4gICAgICBwYWdlLnZTdWJtaXQuY2xhc3NMaXN0LmFkZChzZWxsQnRuQ2xhc3MpXG4gICAgICBwYWdlLnZTdWJtaXQuY2xhc3NMaXN0LnJlbW92ZShidXlCdG5DbGFzcylcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS52SGVhZGVyLmNsYXNzTGlzdC5hZGQoYnV5QnRuQ2xhc3MpXG4gICAgICBwYWdlLnZIZWFkZXIuY2xhc3NMaXN0LnJlbW92ZShzZWxsQnRuQ2xhc3MpXG4gICAgICBwYWdlLnZTdWJtaXQuY2xhc3NMaXN0LmFkZChidXlCdG5DbGFzcylcbiAgICAgIHBhZ2UudlN1Ym1pdC5jbGFzc0xpc3QucmVtb3ZlKHNlbGxCdG5DbGFzcylcbiAgICB9XG4gICAgdGhpcy5zaG93VmVyaWZ5Rm9ybSgpXG5cbiAgICBpZiAoYmFzZUFzc2V0LndhbGxldC5vcGVuICYmIHF1b3RlQXNzZXQud2FsbGV0Lm9wZW4pIHRoaXMucHJlT3JkZXIob3JkZXIpXG4gICAgZWxzZSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnZQcmVvcmRlcilcbiAgICAgIHRoaXMudW5sb2NrV2FsbGV0c0ZvckVzdGltYXRlcygpXG4gICAgfVxuICB9XG5cbiAgLy8gc2hvd0ZpYXRWYWx1ZSBkaXNwbGF5cyB0aGUgZmlhdCBlcXVpdmFsZW50IGZvciBhbiBvcmRlciBxdWFudGl0eS5cbiAgc2hvd0ZpYXRWYWx1ZSAoYXNzZXRJRDogbnVtYmVyLCBxdHk6IG51bWJlciwgZGlzcGxheTogUGFnZUVsZW1lbnQpIHtcbiAgICBpZiAoZGlzcGxheSkge1xuICAgICAgY29uc3QgcmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXVxuICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGaWF0Q29udmVyc2lvbihxdHksIHJhdGUsIGFwcCgpLnVuaXRJbmZvKGFzc2V0SUQpKVxuICAgICAgaWYgKHJhdGUpIERvYy5zaG93KGRpc3BsYXkucGFyZW50RWxlbWVudCBhcyBFbGVtZW50KVxuICAgICAgZWxzZSBEb2MuaGlkZShkaXNwbGF5LnBhcmVudEVsZW1lbnQgYXMgRWxlbWVudClcbiAgICB9XG4gIH1cblxuICAvKiBzaG93VmVyaWZ5Rm9ybSBkaXNwbGF5cyBmb3JtIHRvIHZlcmlmeSBhbiBvcmRlciAqL1xuICBhc3luYyBzaG93VmVyaWZ5Rm9ybSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UudkVycilcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UudmVyaWZ5Rm9ybSlcbiAgfVxuXG4gIC8qXG4gICAqIHVubG9ja1dhbGxldHNGb3JFc3RpbWF0ZXMgdW5sb2NrcyBhbnkgbG9ja2VkIHdhbGxldHMgd2l0aCB0aGUgcHJvdmlkZWRcbiAgICogcGFzc3dvcmQuXG4gICAqL1xuICBhc3luYyB1bmxvY2tXYWxsZXRzRm9yRXN0aW1hdGVzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnZlcmlmeUZvcm0pXG4gICAgYXdhaXQgdGhpcy51bmxvY2tNYXJrZXRXYWxsZXRzKClcbiAgICBsb2FkZWQoKVxuICAgIERvYy5zaG93KHBhZ2UudlByZW9yZGVyKVxuICAgIHRoaXMucHJlT3JkZXIodGhpcy5wYXJzZU9yZGVyKCkpXG4gIH1cblxuICBhc3luYyB1bmxvY2tXYWxsZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL29wZW53YWxsZXQnLCB7IGFzc2V0SUQgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ2Vycm9yIHVubG9ja2luZyB3YWxsZXQgJyArIHJlcy5tc2cpXG4gICAgfVxuICAgIHRoaXMuYmFsYW5jZVdndC51cGRhdGVBc3NldChhc3NldElEKVxuICB9XG5cbiAgLypcbiAgICogdW5sb2NrTWFya2V0V2FsbGV0cyB1bmxvY2tzIGJvdGggdGhlIGJhc2UgYW5kIHF1b3RlIHdhbGxldHMgZm9yIHRoZSBjdXJyZW50XG4gICAqIG1hcmtldCwgaWYgbG9ja2VkLlxuICAgKi9cbiAgYXN5bmMgdW5sb2NrTWFya2V0V2FsbGV0cyAoKSB7XG4gICAgY29uc3QgeyBiYXNlLCBxdW90ZSB9ID0gdGhpcy5tYXJrZXRcbiAgICBjb25zdCBhc3NldElEcyA9IFtdXG4gICAgaWYgKCFiYXNlLndhbGxldC5vcGVuKSBhc3NldElEcy5wdXNoKGJhc2UuaWQpXG4gICAgaWYgKCFxdW90ZS53YWxsZXQub3BlbikgYXNzZXRJRHMucHVzaChxdW90ZS5pZClcbiAgICBmb3IgKGNvbnN0IGFzc2V0SUQgb2YgYXNzZXRJRHMpIHtcbiAgICAgIHRoaXMudW5sb2NrV2FsbGV0KGFzc2V0SUQpXG4gICAgfVxuICB9XG5cbiAgLyogZmV0Y2hQcmVvcmRlciBmZXRjaGVzIHRoZSBwcmUtb3JkZXIgZXN0aW1hdGVzIGFuZCBvcHRpb25zLiAqL1xuICBhc3luYyBmZXRjaFByZW9yZGVyIChvcmRlcjogVHJhZGVGb3JtKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGNhY2hlS2V5ID0gSlNPTi5zdHJpbmdpZnkob3JkZXIub3B0aW9ucylcbiAgICBjb25zdCBjYWNoZWQgPSB0aGlzLnByZW9yZGVyQ2FjaGVbY2FjaGVLZXldXG4gICAgaWYgKGNhY2hlZCkgcmV0dXJuIGNhY2hlZFxuXG4gICAgRG9jLmhpZGUocGFnZS52UHJlb3JkZXJFcnIpXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnZlcmlmeUZvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvcHJlb3JkZXInLCB3aXJlT3JkZXIob3JkZXIpKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHJldHVybiB7IGVycjogcmVzLm1zZyB9XG4gICAgdGhpcy5wcmVvcmRlckNhY2hlW2NhY2hlS2V5XSA9IHJlcy5lc3RpbWF0ZVxuICAgIHJldHVybiByZXMuZXN0aW1hdGVcbiAgfVxuXG4gIC8qXG4gICAqIHNldFByZW9yZGVyRXJyIHNldHMgYW5kIGRpc3BsYXlzIHRoZSBwcmUtb3JkZXIgZXJyb3IgbWVzc2FnZSBhbmQgaGlkZXMgdGhlXG4gICAqIHByZS1vcmRlciBkZXRhaWxzIGJveC5cbiAgICovXG4gIHNldFByZW9yZGVyRXJyIChtc2c6IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnZQcmVvcmRlcilcbiAgICBEb2Muc2hvdyhwYWdlLnZQcmVvcmRlckVycilcbiAgICBwYWdlLnZQcmVvcmRlckVyclRpcC5kYXRhc2V0LnRvb2x0aXAgPSBtc2dcbiAgfVxuXG4gIHNob3dQcmVPcmRlckFkdmFuY2VkT3B0aW9ucyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2Uuc2hvd0FkdmFuY2VkT3B0aW9ucylcbiAgICBEb2Muc2hvdyhwYWdlLmhpZGVBZHZhbmNlZE9wdGlvbnMsIHBhZ2Uudk90aGVyT3JkZXJPcHRzKVxuICB9XG5cbiAgaGlkZVByZU9yZGVyQWR2YW5jZWRPcHRpb25zICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5oaWRlQWR2YW5jZWRPcHRpb25zLCBwYWdlLnZPdGhlck9yZGVyT3B0cylcbiAgICBEb2Muc2hvdyhwYWdlLnNob3dBZHZhbmNlZE9wdGlvbnMpXG4gIH1cblxuICByZWxvYWRPcmRlck9wdHMgKG9yZGVyOiBUcmFkZUZvcm0sIHN3YXA6IFByZVN3YXAsIHJlZGVlbTogUHJlUmVkZWVtLCBjaGFuZ2VkOiAoKT0+dm9pZCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuZW1wdHkocGFnZS52RGVmYXVsdE9yZGVyT3B0cywgcGFnZS52T3RoZXJPcmRlck9wdHMpXG4gICAgY29uc3QgYWRkT3B0aW9uID0gKG9wdDogT3JkZXJPcHRpb24sIGlzU3dhcDogYm9vbGVhbikgPT4ge1xuICAgICAgY29uc3QgZWwgPSBPcmRlclV0aWwub3B0aW9uRWxlbWVudChvcHQsIG9yZGVyLCBjaGFuZ2VkLCBpc1N3YXApXG4gICAgICBpZiAob3B0LnNob3dCeURlZmF1bHQpIHBhZ2UudkRlZmF1bHRPcmRlck9wdHMuYXBwZW5kQ2hpbGQoZWwpXG4gICAgICBlbHNlIHBhZ2Uudk90aGVyT3JkZXJPcHRzLmFwcGVuZENoaWxkKGVsKVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IG9wdCBvZiBzd2FwLm9wdGlvbnMgfHwgW10pIGFkZE9wdGlvbihvcHQsIHRydWUpXG4gICAgZm9yIChjb25zdCBvcHQgb2YgcmVkZWVtLm9wdGlvbnMgfHwgW10pIGFkZE9wdGlvbihvcHQsIGZhbHNlKVxuICAgIGFwcCgpLmJpbmRUb29sdGlwcyhwYWdlLnZEZWZhdWx0T3JkZXJPcHRzKVxuICAgIGFwcCgpLmJpbmRUb29sdGlwcyhwYWdlLnZPdGhlck9yZGVyT3B0cylcbiAgfVxuXG4gIC8qIHByZU9yZGVyIGxvYWRzIHRoZSBvcHRpb25zIGFuZCBmZXRjaGVzIHByZS1vcmRlciBlc3RpbWF0ZXMgKi9cbiAgYXN5bmMgcHJlT3JkZXIgKG9yZGVyOiBUcmFkZUZvcm0pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG5cbiAgICAvLyBBZGQgc3dhcCBvcHRpb25zLlxuICAgIGNvbnN0IHJlZnJlc2hQcmVvcmRlciA9IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlczogQVBJUmVzcG9uc2UgPSBhd2FpdCB0aGlzLmZldGNoUHJlb3JkZXIob3JkZXIpXG4gICAgICBpZiAocmVzLmVycikgcmV0dXJuIHRoaXMuc2V0UHJlb3JkZXJFcnIocmVzLmVycilcbiAgICAgIGNvbnN0IGVzdCA9IChyZXMgYXMgYW55KSBhcyBPcmRlckVzdGltYXRlXG4gICAgICBEb2MuaGlkZShwYWdlLnZQcmVvcmRlckVycilcbiAgICAgIERvYy5zaG93KHBhZ2UudlByZW9yZGVyKVxuICAgICAgY29uc3QgeyBzd2FwLCByZWRlZW0gfSA9IGVzdFxuICAgICAgc3dhcC5vcHRpb25zID0gc3dhcC5vcHRpb25zIHx8IFtdXG4gICAgICByZWRlZW0ub3B0aW9ucyA9IHJlZGVlbS5vcHRpb25zIHx8IFtdXG4gICAgICB0aGlzLnNldEZlZUVzdGltYXRlcyhzd2FwLCByZWRlZW0sIG9yZGVyKVxuXG4gICAgICBjb25zdCBjaGFuZ2VkID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBhd2FpdCByZWZyZXNoUHJlb3JkZXIoKVxuICAgICAgICBEb2MuYW5pbWF0ZSg0MDAsIHByb2dyZXNzID0+IHtcbiAgICAgICAgICBwYWdlLnZGZWVTdW1tYXJ5LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2JhKDEyOCwgMTI4LCAxMjgsICR7MC41IC0gMC41ICogcHJvZ3Jlc3N9KWBcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIC8vIGJpbmQgc2hvdyBvciBoaWRlIGFkdmFuY2VkIHByZSBvcmRlciBvcHRpb25zLlxuICAgICAgRG9jLmJpbmQocGFnZS5zaG93QWR2YW5jZWRPcHRpb25zLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd1ByZU9yZGVyQWR2YW5jZWRPcHRpb25zKCkgfSlcbiAgICAgIERvYy5iaW5kKHBhZ2UuaGlkZUFkdmFuY2VkT3B0aW9ucywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmhpZGVQcmVPcmRlckFkdmFuY2VkT3B0aW9ucygpIH0pXG4gICAgICB0aGlzLnJlbG9hZE9yZGVyT3B0cyhvcmRlciwgc3dhcCwgcmVkZWVtLCBjaGFuZ2VkKVxuICAgIH1cblxuICAgIHJlZnJlc2hQcmVvcmRlcigpXG4gIH1cblxuICAvKiBzZXRGZWVFc3RpbWF0ZXMgc2V0cyBhbGwgb2YgdGhlIHByZS1vcmRlciBlc3RpbWF0ZSBmaWVsZHMgKi9cbiAgc2V0RmVlRXN0aW1hdGVzIChzd2FwOiBQcmVTd2FwLCByZWRlZW06IFByZVJlZGVlbSwgb3JkZXI6IFRyYWRlRm9ybSkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0IH0gPSB0aGlzXG4gICAgaWYgKCFzd2FwLmVzdGltYXRlIHx8ICFyZWRlZW0uZXN0aW1hdGUpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UudlByZW9yZGVyRXN0aW1hdGVzKVxuICAgICAgcmV0dXJuIC8vIHByZU9yZGVyIG1heSByZXR1cm4ganVzdCBvcHRpb25zLCBubyBmZWUgZXN0aW1hdGVzXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UudlByZW9yZGVyRXN0aW1hdGVzKVxuICAgIGNvbnN0IHsgYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvLCByYXRlQ29udmVyc2lvbkZhY3RvciB9ID0gbWFya2V0XG4gICAgY29uc3QgZm10UGN0ID0gKHZhbHVlOiBudW1iZXIpID0+IHtcbiAgICAgIGlmICh2YWx1ZSA8IDAuMDUpIHJldHVybiAnPCAwLjEnXG4gICAgICByZXR1cm4gcGVyY2VudEZvcm1hdHRlci5mb3JtYXQodmFsdWUpXG4gICAgfVxuXG4gICAgLy8gSWYgdGhlIGFzc2V0IGlzIGEgdG9rZW4sIGluIG9yZGVyIHRvIGNhbGN1bGF0ZSB0aGUgZmVlIGFzIGEgcGVyY2VudGFnZVxuICAgIC8vIG9mIHRoZSB0b3RhbCBvcmRlciwgd2UgdHJ5IHRvICB1c2UgdGhlIGZpYXQgcmF0ZXMgdG8gZmluZCBvdXQgdGhlXG4gICAgLy8gZXhjaGFuZ2UgcmF0ZSBiZXR3ZWVuIHRoZSB0b2tlbiBhbmQgcGFyZW50IGFzc2V0cy5cbiAgICAvLyBJbml0aWFsbHkgdGhlc2UgYXJlIHNldCB0byAxLCB3aGljaCB3ZSB3b3VsZCB1c2UgaWYgdGhlIGFzc2V0IGlzIG5vdCBhXG4gICAgLy8gdG9rZW4gYW5kIG5vIGNvbnZlcnNpb24gaXMgbmVlZGVkLlxuICAgIGxldCBiYXNlRXhjaGFuZ2VSYXRlID0gMVxuICAgIGxldCBxdW90ZUV4Y2hhbmdlUmF0ZSA9IDFcbiAgICBsZXQgYmFzZUZlZUFzc2V0VUkgPSBiYXNlVW5pdEluZm9cbiAgICBsZXQgcXVvdGVGZWVBc3NldFVJID0gcXVvdGVVbml0SW5mb1xuXG4gICAgaWYgKG1hcmtldC5iYXNlLnRva2VuKSB7XG4gICAgICBjb25zdCBwYXJlbnQgPSBhcHAoKS5hc3NldHNbbWFya2V0LmJhc2UudG9rZW4ucGFyZW50SURdXG4gICAgICBiYXNlRmVlQXNzZXRVSSA9IHBhcmVudC51bml0SW5mb1xuICAgICAgY29uc3QgdG9rZW5GaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFttYXJrZXQuYmFzZS5pZF1cbiAgICAgIGNvbnN0IHBhcmVudEZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW3BhcmVudC5pZF1cbiAgICAgIGlmICh0b2tlbkZpYXRSYXRlICYmIHBhcmVudEZpYXRSYXRlKSB7XG4gICAgICAgIGNvbnN0IGNvbnZlbnRpb25hbFJhdGUgPSBwYXJlbnRGaWF0UmF0ZSAvIHRva2VuRmlhdFJhdGVcbiAgICAgICAgYmFzZUV4Y2hhbmdlUmF0ZSA9IGNvbnZlbnRpb25hbFJhdGUgKiBiYXNlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgLyBwYXJlbnQudW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJhc2VFeGNoYW5nZVJhdGUgPSAwXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hcmtldC5xdW90ZS50b2tlbikge1xuICAgICAgY29uc3QgcGFyZW50ID0gYXBwKCkuYXNzZXRzW21hcmtldC5xdW90ZS50b2tlbi5wYXJlbnRJRF1cbiAgICAgIHF1b3RlRmVlQXNzZXRVSSA9IHBhcmVudC51bml0SW5mb1xuICAgICAgY29uc3QgdG9rZW5GaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFttYXJrZXQucXVvdGUuaWRdXG4gICAgICBjb25zdCBwYXJlbnRGaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtwYXJlbnQuaWRdXG4gICAgICBpZiAodG9rZW5GaWF0UmF0ZSAmJiBwYXJlbnRGaWF0UmF0ZSkge1xuICAgICAgICBjb25zdCBjb252ZW50aW9uYWxSYXRlID0gcGFyZW50RmlhdFJhdGUgLyB0b2tlbkZpYXRSYXRlXG4gICAgICAgIHF1b3RlRXhjaGFuZ2VSYXRlID0gY29udmVudGlvbmFsUmF0ZSAqIHF1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgLyBwYXJlbnQudW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHF1b3RlRXhjaGFuZ2VSYXRlID0gMFxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBbdG9GZWVBc3NldFVJLCBmcm9tRmVlQXNzZXRVSV0gPSBbYmFzZUZlZUFzc2V0VUksIHF1b3RlRmVlQXNzZXRVSV1cbiAgICBsZXQgW3RvRXhjaGFuZ2VSYXRlLCBmcm9tRXhjaGFuZ2VSYXRlXSA9IFtiYXNlRXhjaGFuZ2VSYXRlLCBxdW90ZUV4Y2hhbmdlUmF0ZV1cbiAgICBpZiAodGhpcy5jdXJyZW50T3JkZXIuc2VsbCkge1xuICAgICAgW2Zyb21GZWVBc3NldFVJLCB0b0ZlZUFzc2V0VUldID0gW3RvRmVlQXNzZXRVSSwgZnJvbUZlZUFzc2V0VUldO1xuICAgICAgW2Zyb21FeGNoYW5nZVJhdGUsIHRvRXhjaGFuZ2VSYXRlXSA9IFt0b0V4Y2hhbmdlUmF0ZSwgZnJvbUV4Y2hhbmdlUmF0ZV1cbiAgICB9XG5cbiAgICBjb25zdCBzd2FwcGVkID0gc3dhcC5lc3RpbWF0ZS52YWx1ZSB8fCAwXG4gICAgY29uc3Qgc3dhcHBlZEluUGFyZW50VW5pdHMgPSBmcm9tRXhjaGFuZ2VSYXRlID4gMCA/IHN3YXBwZWQgLyBmcm9tRXhjaGFuZ2VSYXRlIDogc3dhcHBlZFxuXG4gICAgLy8gU2V0IHN3YXAgZmVlIGVzdGltYXRlcyBpbiB0aGUgZGV0YWlscyBwYW5lLlxuICAgIGNvbnN0IGJlc3RTd2FwUGN0ID0gc3dhcC5lc3RpbWF0ZS5yZWFsaXN0aWNCZXN0Q2FzZSAvIHN3YXBwZWRJblBhcmVudFVuaXRzICogMTAwXG4gICAgcGFnZS52U3dhcEZlZXNMb3dQY3QudGV4dENvbnRlbnQgPSBmcm9tRXhjaGFuZ2VSYXRlIDw9IDAgPyAnJyA6IGAoJHtmbXRQY3QoYmVzdFN3YXBQY3QpfSUpYFxuICAgIHBhZ2UudlN3YXBGZWVzTG93LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShzd2FwLmVzdGltYXRlLnJlYWxpc3RpY0Jlc3RDYXNlLCBmcm9tRmVlQXNzZXRVSSlcblxuICAgIGNvbnN0IHdvcnN0U3dhcFBjdCA9IHN3YXAuZXN0aW1hdGUucmVhbGlzdGljV29yc3RDYXNlIC8gc3dhcHBlZEluUGFyZW50VW5pdHMgKiAxMDBcbiAgICBwYWdlLnZTd2FwRmVlc0hpZ2hQY3QudGV4dENvbnRlbnQgPSBmcm9tRXhjaGFuZ2VSYXRlIDw9IDAgPyAnJyA6IGAoJHtmbXRQY3Qod29yc3RTd2FwUGN0KX0lKWBcbiAgICBwYWdlLnZTd2FwRmVlc0hpZ2gudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHN3YXAuZXN0aW1hdGUucmVhbGlzdGljV29yc3RDYXNlLCBmcm9tRmVlQXNzZXRVSSlcblxuICAgIGNvbnN0IHN3YXBGZWVzTWF4UGN0ID0gc3dhcC5lc3RpbWF0ZS5tYXhGZWVzIC8gc3dhcHBlZEluUGFyZW50VW5pdHMgKiAxMDBcbiAgICBwYWdlLnZTd2FwRmVlc01heFBjdC50ZXh0Q29udGVudCA9IGZyb21FeGNoYW5nZVJhdGUgPD0gMCA/ICcnIDogYCgke2ZtdFBjdChzd2FwRmVlc01heFBjdCl9JSlgXG4gICAgcGFnZS52U3dhcEZlZXNNYXgudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHN3YXAuZXN0aW1hdGUubWF4RmVlcywgZnJvbUZlZUFzc2V0VUkpXG5cbiAgICAvLyBTZXQgcmVkZW1wdGlvbiBmZWUgZXN0aW1hdGVzIGluIHRoZSBkZXRhaWxzIHBhbmUuXG4gICAgY29uc3QgbWlkR2FwID0gdGhpcy5taWRHYXAoKVxuICAgIGNvbnN0IGVzdFJhdGUgPSBtaWRHYXAgfHwgb3JkZXIucmF0ZSAvIHJhdGVDb252ZXJzaW9uRmFjdG9yXG4gICAgY29uc3QgcmVjZWl2ZWQgPSBvcmRlci5zZWxsID8gc3dhcHBlZCAqIGVzdFJhdGUgOiBzd2FwcGVkIC8gZXN0UmF0ZVxuICAgIGNvbnN0IHJlY2VpdmVkSW5QYXJlbnRVbml0cyA9IHRvRXhjaGFuZ2VSYXRlID4gMCA/IHJlY2VpdmVkIC8gdG9FeGNoYW5nZVJhdGUgOiByZWNlaXZlZFxuXG4gICAgY29uc3QgYmVzdFJlZGVlbVBjdCA9IHJlZGVlbS5lc3RpbWF0ZS5yZWFsaXN0aWNCZXN0Q2FzZSAvIHJlY2VpdmVkSW5QYXJlbnRVbml0cyAqIDEwMFxuICAgIHBhZ2UudlJlZGVlbUZlZXNMb3dQY3QudGV4dENvbnRlbnQgPSB0b0V4Y2hhbmdlUmF0ZSA8PSAwID8gJycgOiBgKCR7Zm10UGN0KGJlc3RSZWRlZW1QY3QpfSUpYFxuICAgIHBhZ2UudlJlZGVlbUZlZXNMb3cudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlZGVlbS5lc3RpbWF0ZS5yZWFsaXN0aWNCZXN0Q2FzZSwgdG9GZWVBc3NldFVJKVxuXG4gICAgY29uc3Qgd29yc3RSZWRlZW1QY3QgPSByZWRlZW0uZXN0aW1hdGUucmVhbGlzdGljV29yc3RDYXNlIC8gcmVjZWl2ZWRJblBhcmVudFVuaXRzICogMTAwXG4gICAgcGFnZS52UmVkZWVtRmVlc0hpZ2hQY3QudGV4dENvbnRlbnQgPSB0b0V4Y2hhbmdlUmF0ZSA8PSAwID8gJycgOiBgKCR7Zm10UGN0KHdvcnN0UmVkZWVtUGN0KX0lKWBcbiAgICBwYWdlLnZSZWRlZW1GZWVzSGlnaC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocmVkZWVtLmVzdGltYXRlLnJlYWxpc3RpY1dvcnN0Q2FzZSwgdG9GZWVBc3NldFVJKVxuXG4gICAgaWYgKGJhc2VFeGNoYW5nZVJhdGUgJiYgcXVvdGVFeGNoYW5nZVJhdGUpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudkZlZVN1bW1hcnlQY3QpXG4gICAgICBEb2MuaGlkZShwYWdlLnZGZWVTdW1tYXJ5KVxuICAgICAgcGFnZS52RmVlU3VtbWFyeUxvdy50ZXh0Q29udGVudCA9IGZtdFBjdChiZXN0U3dhcFBjdCArIGJlc3RSZWRlZW1QY3QpXG4gICAgICBwYWdlLnZGZWVTdW1tYXJ5SGlnaC50ZXh0Q29udGVudCA9IGZtdFBjdCh3b3JzdFN3YXBQY3QgKyB3b3JzdFJlZGVlbVBjdClcbiAgICB9IGVsc2Uge1xuICAgICAgRG9jLmhpZGUocGFnZS52RmVlU3VtbWFyeVBjdClcbiAgICAgIERvYy5zaG93KHBhZ2UudkZlZVN1bW1hcnkpXG4gICAgICBwYWdlLnN1bW1hcnlTd2FwRmVlc0xvdy50ZXh0Q29udGVudCA9IHBhZ2UudlN3YXBGZWVzTG93LnRleHRDb250ZW50XG4gICAgICBwYWdlLnN1bW1hcnlTd2FwRmVlc0hpZ2gudGV4dENvbnRlbnQgPSBwYWdlLnZTd2FwRmVlc0hpZ2gudGV4dENvbnRlbnRcbiAgICAgIHBhZ2Uuc3VtbWFyeVJlZGVlbUZlZXNMb3cudGV4dENvbnRlbnQgPSBwYWdlLnZSZWRlZW1GZWVzTG93LnRleHRDb250ZW50XG4gICAgICBwYWdlLnN1bW1hcnlSZWRlZW1GZWVzSGlnaC50ZXh0Q29udGVudCA9IHBhZ2UudlJlZGVlbUZlZXNIaWdoLnRleHRDb250ZW50XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3VibWl0Q2FuY2VsICgpIHtcbiAgICAvLyB0aGlzIHdpbGwgYmUgdGhlIHBhZ2UuY2FuY2VsU3VibWl0IGJ1dHRvbiAoZXZ0LmN1cnJlbnRUYXJnZXQpXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGNhbmNlbERhdGEgPSB0aGlzLmNhbmNlbERhdGFcbiAgICBjb25zdCBvcmRlciA9IGNhbmNlbERhdGEub3JkZXJcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBvcmRlcklEOiBvcmRlci5pZFxuICAgIH1cbiAgICAvLyBUb2dnbGUgdGhlIGxvYWRlciBhbmQgc3VibWl0IGJ1dHRvbi5cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuY2FuY2VsU3VibWl0KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2NhbmNlbCcsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIC8vIERpc3BsYXkgZXJyb3Igb24gY29uZmlybWF0aW9uIG1vZGFsLlxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLmNhbmNlbEVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UuY2FuY2VsRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIC8vIEhpZGUgY29uZmlybWF0aW9uIG1vZGFsIG9ubHkgb24gc3VjY2Vzcy5cbiAgICBEb2MuaGlkZShjYW5jZWxEYXRhLmJ0dG4sIHBhZ2UuZm9ybXMpXG4gICAgb3JkZXIuY2FuY2VsbGluZyA9IHRydWVcbiAgfVxuXG4gIC8qIHNob3dDYW5jZWwgc2hvd3MgYSBmb3JtIHRvIGNvbmZpcm0gc3VibWlzc2lvbiBvZiBhIGNhbmNlbCBvcmRlci4gKi9cbiAgc2hvd0NhbmNlbCAocm93OiBIVE1MRWxlbWVudCwgb3JkZXJJRDogc3RyaW5nKSB7XG4gICAgY29uc3Qgb3JkID0gdGhpcy5tZXRhT3JkZXJzW29yZGVySURdLm9yZFxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCByZW1haW5pbmcgPSBvcmQucXR5IC0gb3JkLmZpbGxlZFxuICAgIGNvbnN0IGFzc2V0ID0gT3JkZXJVdGlsLmlzTWFya2V0QnV5KG9yZCkgPyB0aGlzLm1hcmtldC5xdW90ZSA6IHRoaXMubWFya2V0LmJhc2VcbiAgICBwYWdlLmNhbmNlbFJlbWFpbi50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocmVtYWluaW5nLCBhc3NldC51bml0SW5mbylcbiAgICBwYWdlLmNhbmNlbFVuaXQudGV4dENvbnRlbnQgPSBhc3NldC5zeW1ib2wudG9VcHBlckNhc2UoKVxuICAgIERvYy5oaWRlKHBhZ2UuY2FuY2VsRXJyKVxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5jYW5jZWxGb3JtKVxuICAgIHRoaXMuY2FuY2VsRGF0YSA9IHtcbiAgICAgIGJ0dG46IERvYy50bXBsRWxlbWVudChyb3csICdjYW5jZWxCdHRuJyksXG4gICAgICBvcmRlcjogb3JkXG4gICAgfVxuICB9XG5cbiAgLyogc2hvd0FjY2VsZXJhdGUgc2hvd3MgdGhlIGFjY2VsZXJhdGUgb3JkZXIgZm9ybS4gKi9cbiAgc2hvd0FjY2VsZXJhdGUgKG9yZGVyOiBPcmRlcikge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5tYWluKVxuICAgIHRoaXMuYWNjZWxlcmF0ZU9yZGVyRm9ybS5yZWZyZXNoKG9yZGVyKVxuICAgIGxvYWRlZCgpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UuYWNjZWxlcmF0ZUZvcm0pXG4gIH1cblxuICAvKiBzaG93Q3JlYXRlIHNob3dzIHRoZSBuZXcgd2FsbGV0IGNyZWF0aW9uIGZvcm0uICovXG4gIHNob3dDcmVhdGUgKGFzc2V0OiBTdXBwb3J0ZWRBc3NldCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmN1cnJlbnRDcmVhdGUgPSBhc3NldFxuICAgIHRoaXMubmV3V2FsbGV0Rm9ybS5zZXRBc3NldChhc3NldC5pZClcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgfVxuXG4gIC8qXG4gICAqIHN0ZXBTdWJtaXQgd2lsbCBleGFtaW5lIHRoZSBjdXJyZW50IHN0YXRlIG9mIHdhbGxldHMgYW5kIHN0ZXAgdGhlIHVzZXJcbiAgICogdGhyb3VnaCB0aGUgcHJvY2VzcyBvZiBvcmRlciBzdWJtaXNzaW9uLlxuICAgKiBOT1RFOiBJIGV4cGVjdCB0aGlzIHByb2Nlc3Mgd2lsbCBiZSBzdHJlYW1saW5lZCBzb29uIHN1Y2ggdGhhdCB0aGUgd2FsbGV0c1xuICAgKiB3aWxsIGF0dGVtcHQgdG8gYmUgdW5sb2NrZWQgaW4gdGhlIG9yZGVyIHN1Ym1pc3Npb24gcHJvY2VzcywgbmVnYXRpbmcgdGhlXG4gICAqIG5lZWQgdG8gdW5sb2NrIGFoZWFkIG9mIHRpbWUuXG4gICAqL1xuICBzdGVwU3VibWl0ICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbWFya2V0ID0gdGhpcy5tYXJrZXRcbiAgICBEb2MuaGlkZShwYWdlLm9yZGVyRXJyKVxuICAgIGlmICghdGhpcy52YWxpZGF0ZU9yZGVyKHRoaXMucGFyc2VPcmRlcigpKSkgcmV0dXJuXG4gICAgY29uc3QgYmFzZVdhbGxldCA9IGFwcCgpLndhbGxldE1hcFttYXJrZXQuYmFzZS5pZF1cbiAgICBjb25zdCBxdW90ZVdhbGxldCA9IGFwcCgpLndhbGxldE1hcFttYXJrZXQucXVvdGUuaWRdXG4gICAgaWYgKCFiYXNlV2FsbGV0KSB7XG4gICAgICBwYWdlLm9yZGVyRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fQVNTRVRfV0FMTEVULCB7IGFzc2V0OiBtYXJrZXQuYmFzZS5zeW1ib2wgfSlcbiAgICAgIERvYy5zaG93KHBhZ2Uub3JkZXJFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKCFxdW90ZVdhbGxldCkge1xuICAgICAgcGFnZS5vcmRlckVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX0FTU0VUX1dBTExFVCwgeyBhc3NldDogbWFya2V0LnF1b3RlLnN5bWJvbCB9KVxuICAgICAgRG9jLnNob3cocGFnZS5vcmRlckVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnNob3dWZXJpZnkoKVxuICB9XG5cbiAgLyogRGlzcGxheSBhIGRlcG9zaXQgYWRkcmVzcy4gKi9cbiAgYXN5bmMgc2hvd0RlcG9zaXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIHRoaXMuZGVwb3NpdEFkZHJGb3JtLnNldEFzc2V0KGFzc2V0SUQpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UuZGVwb3NpdClcbiAgfVxuXG4gIHNob3dDdXN0b21Qcm92aWRlckRpYWxvZyAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgYXBwKCkubG9hZFBhZ2UoJ3dhbGxldHMnLCB7IHByb21wdFByb3ZpZGVyOiBhc3NldElELCBnb0JhY2s6ICdtYXJrZXRzJyB9KVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlUHJpY2VVcGRhdGUgaXMgdGhlIGhhbmRsZXIgZm9yIHRoZSAnc3BvdHMnIG5vdGlmaWNhdGlvbi5cbiAgICovXG4gIGhhbmRsZVByaWNlVXBkYXRlIChub3RlOiBTcG90UHJpY2VOb3RlKSB7XG4gICAgaWYgKCF0aGlzLm1hcmtldCkgcmV0dXJuIC8vIFRoaXMgbm90ZSBjYW4gYXJyaXZlIGJlZm9yZSB0aGUgbWFya2V0IGlzIHNldC5cbiAgICBpZiAobm90ZS5ob3N0ID09PSB0aGlzLm1hcmtldC5kZXguaG9zdCAmJiBub3RlLnNwb3RzW3RoaXMubWFya2V0LmNmZy5uYW1lXSkge1xuICAgICAgdGhpcy5zZXRDdXJyTWFya2V0UHJpY2UoKVxuICAgIH1cbiAgICB0aGlzLm1hcmtldExpc3QudXBkYXRlU3BvdHMobm90ZSlcbiAgfVxuXG4gIGFzeW5jIGhhbmRsZVdhbGxldFN0YXRlIChub3RlOiBXYWxsZXRTdGF0ZU5vdGUpIHtcbiAgICBpZiAoIXRoaXMubWFya2V0KSByZXR1cm4gLy8gVGhpcyBub3RlIGNhbiBhcnJpdmUgYmVmb3JlIHRoZSBtYXJrZXQgaXMgc2V0LlxuICAgIC8vIGlmIChub3RlLnRvcGljICE9PSAnVG9rZW5BcHByb3ZhbCcpIHJldHVyblxuICAgIGlmIChub3RlLndhbGxldC5hc3NldElEICE9PSB0aGlzLm1hcmtldC5iYXNlPy5pZCAmJiBub3RlLndhbGxldC5hc3NldElEICE9PSB0aGlzLm1hcmtldC5xdW90ZT8uaWQpIHJldHVyblxuICAgIHRoaXMuc2V0VG9rZW5BcHByb3ZhbFZpc2liaWxpdHkoKVxuICAgIHRoaXMucmVzb2x2ZU9yZGVyRm9ybVZpc2liaWxpdHkoKVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlQm9uZFVwZGF0ZSBpcyB0aGUgaGFuZGxlciBmb3IgdGhlICdib25kcG9zdCcgbm90aWZpY2F0aW9uIHR5cGUuXG4gICAqIFRoaXMgaXMgdXNlZCB0byB1cGRhdGUgdGhlIHJlZ2lzdHJhdGlvbiBzdGF0dXMgb2YgdGhlIGN1cnJlbnQgZXhjaGFuZ2UuXG4gICAqL1xuICBhc3luYyBoYW5kbGVCb25kVXBkYXRlIChub3RlOiBCb25kTm90ZSkge1xuICAgIGNvbnN0IGRleEFkZHIgPSBub3RlLmRleFxuICAgIGlmICghdGhpcy5tYXJrZXQpIHJldHVybiAvLyBUaGlzIG5vdGUgY2FuIGFycml2ZSBiZWZvcmUgdGhlIG1hcmtldCBpcyBzZXQuXG4gICAgaWYgKGRleEFkZHIgIT09IHRoaXMubWFya2V0LmRleC5ob3N0KSByZXR1cm5cbiAgICAvLyBJZiB3ZSBqdXN0IGZpbmlzaGVkIGxlZ2FjeSByZWdpc3RyYXRpb24sIHdlIG5lZWQgdG8gdXBkYXRlIHRoZSBFeGNoYW5nZS5cbiAgICAvLyBUT0RPOiBVc2UgdGllciBjaGFuZ2Ugbm90aWZpY2F0aW9uIG9uY2UgYXZhaWxhYmxlLlxuICAgIGlmIChub3RlLnRvcGljID09PSAnQWNjb3VudFJlZ2lzdGVyZWQnKSBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIC8vIFVwZGF0ZSBsb2NhbCBjb3B5IG9mIEV4Y2hhbmdlLlxuICAgIHRoaXMubWFya2V0LmRleCA9IGFwcCgpLmV4Y2hhbmdlc1tkZXhBZGRyXVxuICAgIHRoaXMuc2V0UmVnaXN0cmF0aW9uU3RhdHVzVmlzaWJpbGl0eSgpXG4gICAgdGhpcy51cGRhdGVSZXB1dGF0aW9uKClcbiAgfVxuXG4gIHVwZGF0ZVJlcHV0YXRpb24gKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0OiB7IGRleDogeyBob3N0IH0sIGNmZzogbWt0LCBiYXNlQ2ZnOiB7IHVuaXRJbmZvOiBidWkgfSwgcXVvdGVDZmc6IHsgdW5pdEluZm86IHF1aSB9IH0gfSA9IHRoaXNcbiAgICBjb25zdCB7IGF1dGggfSA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XVxuXG4gICAgcGFnZS5wYXJjZWxTaXplTG90cy50ZXh0Q29udGVudCA9IFN0cmluZyhta3QucGFyY2Vsc2l6ZSlcbiAgICBwYWdlLm1hcmtldExpbWl0QmFzZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhta3QucGFyY2Vsc2l6ZSAqIG1rdC5sb3RzaXplIC8gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgIHBhZ2UubWFya2V0TGltaXRCYXNlVW5pdC50ZXh0Q29udGVudCA9IGJ1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIHBhZ2UubWFya2V0TGltaXRRdW90ZVVuaXQudGV4dENvbnRlbnQgPSBxdWkuY29udmVudGlvbmFsLnVuaXRcbiAgICBjb25zdCBjb252ZXJzaW9uUmF0ZSA9IHRoaXMuYW55UmF0ZSgpWzFdXG4gICAgaWYgKGNvbnZlcnNpb25SYXRlKSB7XG4gICAgICBjb25zdCBxdW90ZUxvdCA9IG1rdC5sb3RzaXplICogY29udmVyc2lvblJhdGVcbiAgICAgIHBhZ2UubWFya2V0TGltaXRRdW90ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhta3QucGFyY2Vsc2l6ZSAqIHF1b3RlTG90IC8gcXVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgIH0gZWxzZSBwYWdlLm1hcmtldExpbWl0UXVvdGUudGV4dENvbnRlbnQgPSAnLSdcblxuICAgIGNvbnN0IHRpZXIgPSBzdHJvbmdUaWVyKGF1dGgpXG4gICAgcGFnZS50cmFkaW5nVGllci50ZXh0Q29udGVudCA9IFN0cmluZyh0aWVyKVxuICAgIGNvbnN0IFt1c2VkUGFyY2VscywgcGFyY2VsTGltaXRdID0gdHJhZGluZ0xpbWl0cyhob3N0KVxuICAgIHBhZ2UudHJhZGluZ0xpbWl0LnRleHRDb250ZW50ID0gKHBhcmNlbExpbWl0ICogbWt0LnBhcmNlbHNpemUpLnRvRml4ZWQoMilcbiAgICBwYWdlLmxpbWl0VXNhZ2UudGV4dENvbnRlbnQgPSBwYXJjZWxMaW1pdCA+IDAgPyAodXNlZFBhcmNlbHMgLyBwYXJjZWxMaW1pdCAqIDEwMCkudG9GaXhlZCgxKSA6ICcwJ1xuXG4gICAgcGFnZS5vcmRlckxpbWl0UmVtYWluLnRleHRDb250ZW50ID0gKChwYXJjZWxMaW1pdCAtIHVzZWRQYXJjZWxzKSAqIG1rdC5wYXJjZWxzaXplKS50b0ZpeGVkKDEpXG4gICAgcGFnZS5vcmRlclRyYWRpbmdUaWVyLnRleHRDb250ZW50ID0gU3RyaW5nKHRpZXIpXG5cbiAgICB0aGlzLnJlcHV0YXRpb25NZXRlci51cGRhdGUoKVxuICB9XG5cbiAgLypcbiAgICogYW55UmF0ZSBmaW5kcyB0aGUgYmVzdCByYXRlIGZyb20gYW55IG9mLCBpbiBvcmRlciBvZiBwcmlvcml0eSwgdGhlIG9yZGVyXG4gICAqIGJvb2ssIHRoZSBzZXJ2ZXIncyByZXBvcnRlZCBzcG90IHJhdGUsIG9yIHRoZSBmaWF0IGV4Y2hhbmdlIHJhdGVzLiBBXG4gICAqIDMtdHVwbGUgb2YgbWVzc2FnZS1yYXRlIGVuY29kaW5nLCBhIGNvbnZlcnNpb24gcmF0ZSwgYW5kIGEgY29udmVudGlvbmFsXG4gICAqIHJhdGUgaXMgZ2VuZXJhdGVkLlxuICAgKi9cbiAgYW55UmF0ZSAoKTogW251bWJlciwgbnVtYmVyLCBudW1iZXJdIHtcbiAgICBjb25zdCB7IGNmZzogeyBzcG90IH0sIGJhc2VDZmc6IHsgaWQ6IGJhc2VJRCB9LCBxdW90ZUNmZzogeyBpZDogcXVvdGVJRCB9LCByYXRlQ29udmVyc2lvbkZhY3RvciwgYm9va0xvYWRlZCB9ID0gdGhpcy5tYXJrZXRcbiAgICBpZiAoYm9va0xvYWRlZCkge1xuICAgICAgY29uc3QgbWlkR2FwID0gdGhpcy5taWRHYXAoKVxuICAgICAgaWYgKG1pZEdhcCkgcmV0dXJuIFttaWRHYXAgKiBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yLCBtaWRHYXAsIHRoaXMubWlkR2FwQ29udmVudGlvbmFsKCkgfHwgMF1cbiAgICB9XG4gICAgaWYgKHNwb3QgJiYgc3BvdC5yYXRlKSByZXR1cm4gW3Nwb3QucmF0ZSwgc3BvdC5yYXRlIC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3Rvciwgc3BvdC5yYXRlIC8gcmF0ZUNvbnZlcnNpb25GYWN0b3JdXG4gICAgY29uc3QgW2Jhc2VVU0QsIHF1b3RlVVNEXSA9IFthcHAoKS5maWF0UmF0ZXNNYXBbYmFzZUlEXSwgYXBwKCkuZmlhdFJhdGVzTWFwW3F1b3RlSURdXVxuICAgIGlmIChiYXNlVVNEICYmIHF1b3RlVVNEKSB7XG4gICAgICBjb25zdCBjb252ZW50aW9uYWxSYXRlID0gYmFzZVVTRCAvIHF1b3RlVVNEXG4gICAgICBjb25zdCBtc2dSYXRlID0gY29udmVudGlvbmFsUmF0ZSAqIHJhdGVDb252ZXJzaW9uRmFjdG9yXG4gICAgICBjb25zdCBjb252ZXJzaW9uUmF0ZSA9IG1zZ1JhdGUgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yXG4gICAgICByZXR1cm4gW21zZ1JhdGUsIGNvbnZlcnNpb25SYXRlLCBjb252ZW50aW9uYWxSYXRlXVxuICAgIH1cbiAgICByZXR1cm4gWzAsIDAsIDBdXG4gIH1cblxuICBoYW5kbGVNYXRjaE5vdGUgKG5vdGU6IE1hdGNoTm90ZSkge1xuICAgIGNvbnN0IG1vcmQgPSB0aGlzLm1ldGFPcmRlcnNbbm90ZS5vcmRlcklEXVxuICAgIGNvbnN0IG1hdGNoID0gbm90ZS5tYXRjaFxuICAgIGlmICghbW9yZCkgcmV0dXJuIHRoaXMucmVmcmVzaEFjdGl2ZU9yZGVycygpXG4gICAgZWxzZSBpZiAobW9yZC5vcmQudHlwZSA9PT0gT3JkZXJVdGlsLk1hcmtldCAmJiBtYXRjaC5zdGF0dXMgPT09IE9yZGVyVXRpbC5OZXdseU1hdGNoZWQpIHsgLy8gVXBkYXRlIHRoZSBhdmVyYWdlIG1hcmtldCByYXRlIGRpc3BsYXkuXG4gICAgICAvLyBGZXRjaCBhbmQgdXNlIHRoZSB1cGRhdGVkIG9yZGVyLlxuICAgICAgY29uc3Qgb3JkID0gYXBwKCkub3JkZXIobm90ZS5vcmRlcklEKVxuICAgICAgaWYgKG9yZCkgbW9yZC5kZXRhaWxzLnJhdGUudGV4dENvbnRlbnQgPSBtb3JkLmhlYWRlci5yYXRlLnRleHRDb250ZW50ID0gdGhpcy5tYXJrZXRPcmRlclJhdGVTdHJpbmcob3JkLCB0aGlzLm1hcmtldClcbiAgICB9XG4gICAgaWYgKFxuICAgICAgKG1hdGNoLnNpZGUgPT09IE9yZGVyVXRpbC5NYXRjaFNpZGVNYWtlciAmJiBtYXRjaC5zdGF0dXMgPT09IE9yZGVyVXRpbC5NYWtlclJlZGVlbWVkKSB8fFxuICAgICAgKG1hdGNoLnNpZGUgPT09IE9yZGVyVXRpbC5NYXRjaFNpZGVUYWtlciAmJiBtYXRjaC5zdGF0dXMgPT09IE9yZGVyVXRpbC5NYXRjaENvbXBsZXRlKVxuICAgICkgdGhpcy51cGRhdGVSZXB1dGF0aW9uKClcbiAgICBpZiAoYXBwKCkuY2FuQWNjZWxlcmF0ZU9yZGVyKG1vcmQub3JkKSkgRG9jLnNob3cobW9yZC5kZXRhaWxzLmFjY2VsZXJhdGVCdHRuKVxuICAgIGVsc2UgRG9jLmhpZGUobW9yZC5kZXRhaWxzLmFjY2VsZXJhdGVCdHRuKVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlT3JkZXJOb3RlIGlzIHRoZSBoYW5kbGVyIGZvciB0aGUgJ29yZGVyJy10eXBlIG5vdGlmaWNhdGlvbiwgd2hpY2ggYXJlXG4gICAqIHVzZWQgdG8gdXBkYXRlIGEgdXNlcidzIG9yZGVyJ3Mgc3RhdHVzLlxuICAgKi9cbiAgaGFuZGxlT3JkZXJOb3RlIChub3RlOiBPcmRlck5vdGUpIHtcbiAgICBjb25zdCBvcmQgPSBub3RlLm9yZGVyXG4gICAgY29uc3QgbW9yZCA9IHRoaXMubWV0YU9yZGVyc1tvcmQuaWRdXG4gICAgLy8gLSBJZiBtZXRhT3JkZXIgZG9lc24ndCBleGlzdCBmb3IgdGhlIGdpdmVuIG9yZGVyIGl0IG1lYW5zIGl0IHdhcyBjcmVhdGVkXG4gICAgLy8gIHZpYSBid2N0bCBhbmQgdGhlIEdVSSBpc24ndCBhd2FyZSBvZiBpdCBvciBpdCB3YXMgYW4gaW5mbGlnaHQgb3JkZXIuXG4gICAgLy8gIHJlZnJlc2hBY3RpdmVPcmRlcnMgbXVzdCBiZSBjYWxsZWQgdG8gZ3JhYiB0aGlzIG9yZGVyLlxuICAgIC8vIC0gSWYgYW4gT3JkZXJMb2FkZWQgbm90aWZpY2F0aW9uIGlzIHJlY2lldmVkLCBpdCBtZWFucyBhbiBvcmRlciB0aGF0IHdhc1xuICAgIC8vICAgcHJldmlvdXNseSBub3QgXCJyZWFkeSB0byB0aWNrXCIgKGR1ZSB0byBpdHMgd2FsbGV0cyBub3QgYmVpbmcgY29ubmVjdGVkXG4gICAgLy8gICBhbmQgdW5sb2NrZWQpIGhhcyBub3cgYmVjb21lIHJlYWR5IHRvIHRpY2suIFRoZSBhY3RpdmUgb3JkZXJzIHNlY3Rpb25cbiAgICAvLyAgIG5lZWRzIHRvIGJlIHJlZnJlc2hlZC5cbiAgICBjb25zdCB3YXNJbmZsaWdodCA9IG5vdGUudG9waWMgPT09ICdBc3luY09yZGVyRmFpbHVyZScgfHwgbm90ZS50b3BpYyA9PT0gJ0FzeW5jT3JkZXJTdWJtaXR0ZWQnXG4gICAgaWYgKCFtb3JkIHx8IHdhc0luZmxpZ2h0IHx8IChub3RlLnRvcGljID09PSAnT3JkZXJMb2FkZWQnICYmIG9yZC5yZWFkeVRvVGljaykpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlZnJlc2hBY3RpdmVPcmRlcnMoKVxuICAgIH1cbiAgICBjb25zdCBvbGRTdGF0dXMgPSBtb3JkLm9yZC5zdGF0dXNcbiAgICBtb3JkLm9yZCA9IG9yZFxuICAgIGlmIChub3RlLnRvcGljID09PSAnTWlzc2VkQ2FuY2VsJykgRG9jLnNob3cobW9yZC5kZXRhaWxzLmNhbmNlbEJ0dG4pXG4gICAgaWYgKG9yZC5maWxsZWQgPT09IG9yZC5xdHkpIERvYy5oaWRlKG1vcmQuZGV0YWlscy5jYW5jZWxCdHRuKVxuICAgIGlmIChhcHAoKS5jYW5BY2NlbGVyYXRlT3JkZXIob3JkKSkgRG9jLnNob3cobW9yZC5kZXRhaWxzLmFjY2VsZXJhdGVCdHRuKVxuICAgIGVsc2UgRG9jLmhpZGUobW9yZC5kZXRhaWxzLmFjY2VsZXJhdGVCdHRuKVxuICAgIHRoaXMudXBkYXRlTWV0YU9yZGVyKG1vcmQpXG4gICAgLy8gT25seSByZXNldCBtYXJrZXJzIGlmIHRoZXJlIGlzIGEgY2hhbmdlLCBzaW5jZSB0aGUgY2hhcnQgaXMgcmVkcmF3bi5cbiAgICBpZiAoXG4gICAgICAob2xkU3RhdHVzID09PSBPcmRlclV0aWwuU3RhdHVzRXBvY2ggJiYgb3JkLnN0YXR1cyA9PT0gT3JkZXJVdGlsLlN0YXR1c0Jvb2tlZCkgfHxcbiAgICAgIChvbGRTdGF0dXMgPT09IE9yZGVyVXRpbC5TdGF0dXNCb29rZWQgJiYgb3JkLnN0YXR1cyA+IE9yZGVyVXRpbC5TdGF0dXNCb29rZWQpXG4gICAgKSB7XG4gICAgICB0aGlzLnNldERlcHRoTWFya2VycygpXG4gICAgICB0aGlzLnVwZGF0ZVJlcHV0YXRpb24oKVxuICAgICAgdGhpcy5tbS5yZWFkQm9vaygpXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlRXBvY2hOb3RlIGhhbmRsZXMgbm90aWZpY2F0aW9ucyBzaWduYWxsaW5nIHRoZSBzdGFydCBvZiBhIG5ldyBlcG9jaC5cbiAgICovXG4gIGhhbmRsZUVwb2NoTm90ZSAobm90ZTogRXBvY2hOb3RlKSB7XG4gICAgYXBwKCkubG9nKCdib29rJywgJ2hhbmRsZUVwb2NoTm90ZTonLCBub3RlKVxuICAgIGlmICghdGhpcy5tYXJrZXQpIHJldHVybiAvLyBUaGlzIG5vdGUgY2FuIGFycml2ZSBiZWZvcmUgdGhlIG1hcmtldCBpcyBzZXQuXG4gICAgaWYgKG5vdGUuaG9zdCAhPT0gdGhpcy5tYXJrZXQuZGV4Lmhvc3QgfHwgbm90ZS5tYXJrZXRJRCAhPT0gdGhpcy5tYXJrZXQuc2lkKSByZXR1cm5cbiAgICBpZiAodGhpcy5ib29rKSB7XG4gICAgICB0aGlzLmJvb2suc2V0RXBvY2gobm90ZS5lcG9jaClcbiAgICAgIHRoaXMuZGVwdGhDaGFydC5kcmF3KClcbiAgICB9XG5cbiAgICB0aGlzLmNsZWFyT3JkZXJUYWJsZUVwb2NocygpXG4gICAgZm9yIChjb25zdCB7IG9yZCwgZGV0YWlscywgaGVhZGVyIH0gb2YgT2JqZWN0LnZhbHVlcyh0aGlzLm1ldGFPcmRlcnMpKSB7XG4gICAgICBjb25zdCBhbHJlYWR5TWF0Y2hlZCA9IG5vdGUuZXBvY2ggPiBvcmQuZXBvY2hcbiAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICBjYXNlIG9yZC50eXBlID09PSBPcmRlclV0aWwuTGltaXQgJiYgb3JkLnN0YXR1cyA9PT0gT3JkZXJVdGlsLlN0YXR1c0Vwb2NoICYmIGFscmVhZHlNYXRjaGVkOiB7XG4gICAgICAgICAgY29uc3Qgc3RhdHVzID0gb3JkLnRpZiA9PT0gT3JkZXJVdGlsLkltbWVkaWF0ZVRpRiA/IGludGwucHJlcChpbnRsLklEX0VYRUNVVEVEKSA6IGludGwucHJlcChpbnRsLklEX0JPT0tFRClcbiAgICAgICAgICBkZXRhaWxzLnN0YXR1cy50ZXh0Q29udGVudCA9IGhlYWRlci5zdGF0dXMudGV4dENvbnRlbnQgPSBzdGF0dXNcbiAgICAgICAgICBvcmQuc3RhdHVzID0gb3JkLnRpZiA9PT0gT3JkZXJVdGlsLkltbWVkaWF0ZVRpRiA/IE9yZGVyVXRpbC5TdGF0dXNFeGVjdXRlZCA6IE9yZGVyVXRpbC5TdGF0dXNCb29rZWRcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2Ugb3JkLnR5cGUgPT09IE9yZGVyVXRpbC5NYXJrZXQgJiYgb3JkLnN0YXR1cyA9PT0gT3JkZXJVdGlsLlN0YXR1c0Vwb2NoOlxuICAgICAgICAgIC8vIFRlY2huaWNhbGx5IGRvbid0IGtub3cgaWYgdGhpcyBzaG91bGQgYmUgJ2V4ZWN1dGVkJyBvciAnc2V0dGxpbmcnLlxuICAgICAgICAgIGRldGFpbHMuc3RhdHVzLnRleHRDb250ZW50ID0gaGVhZGVyLnN0YXR1cy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0VYRUNVVEVEKVxuICAgICAgICAgIG9yZC5zdGF0dXMgPSBPcmRlclV0aWwuU3RhdHVzRXhlY3V0ZWRcbiAgICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIHJlY2VudE1hdGNoZXNTb3J0Q29tcGFyZSByZXR1cm5zIHNvcnQgY29tcGFyZSBmdW5jdGlvbiBhY2NvcmRpbmcgdG8gdGhlIGFjdGl2ZVxuICAgKiBzb3J0IGtleSBhbmQgZGlyZWN0aW9uLlxuICAgKi9cbiAgcmVjZW50TWF0Y2hlc1NvcnRDb21wYXJlICgpIHtcbiAgICBzd2l0Y2ggKHRoaXMucmVjZW50TWF0Y2hlc1NvcnRLZXkpIHtcbiAgICAgIGNhc2UgJ3JhdGUnOlxuICAgICAgICByZXR1cm4gKGE6IFJlY2VudE1hdGNoLCBiOiBSZWNlbnRNYXRjaCkgPT4gdGhpcy5yZWNlbnRNYXRjaGVzU29ydERpcmVjdGlvbiAqIChhLnJhdGUgLSBiLnJhdGUpXG4gICAgICBjYXNlICdxdHknOlxuICAgICAgICByZXR1cm4gKGE6IFJlY2VudE1hdGNoLCBiOiBSZWNlbnRNYXRjaCkgPT4gdGhpcy5yZWNlbnRNYXRjaGVzU29ydERpcmVjdGlvbiAqIChhLnF0eSAtIGIucXR5KVxuICAgICAgY2FzZSAnYWdlJzpcbiAgICAgICAgcmV0dXJuIChhOiBSZWNlbnRNYXRjaCwgYjpSZWNlbnRNYXRjaCkgPT4gdGhpcy5yZWNlbnRNYXRjaGVzU29ydERpcmVjdGlvbiAqIChhLnN0YW1wIC0gYi5zdGFtcClcbiAgICB9XG4gIH1cblxuICByZWZyZXNoUmVjZW50TWF0Y2hlc1RhYmxlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgcmVjZW50TWF0Y2hlcyA9IHRoaXMucmVjZW50TWF0Y2hlc1xuICAgIERvYy5lbXB0eShwYWdlLnJlY2VudE1hdGNoZXNMaXZlTGlzdClcbiAgICBpZiAoIXJlY2VudE1hdGNoZXMpIHJldHVyblxuICAgIGNvbnN0IGNvbXBhcmUgPSB0aGlzLnJlY2VudE1hdGNoZXNTb3J0Q29tcGFyZSgpXG4gICAgcmVjZW50TWF0Y2hlcy5zb3J0KGNvbXBhcmUpXG4gICAgZm9yIChjb25zdCBtYXRjaCBvZiByZWNlbnRNYXRjaGVzKSB7XG4gICAgICBjb25zdCByb3cgPSBwYWdlLnJlY2VudE1hdGNoZXNUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICBhcHAoKS5iaW5kVG9vbHRpcHMocm93KVxuICAgICAgdG1wbC5yYXRlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShtYXRjaC5yYXRlIC8gdGhpcy5tYXJrZXQucmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgICB0bXBsLnF0eS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWF0Y2gucXR5LCB0aGlzLm1hcmtldC5iYXNlVW5pdEluZm8pXG4gICAgICB0bXBsLmFnZS50ZXh0Q29udGVudCA9IERvYy50aW1lU2luY2UobWF0Y2guc3RhbXApXG4gICAgICB0bXBsLmFnZS5kYXRhc2V0LnNpbmNlU3RhbXAgPSBTdHJpbmcobWF0Y2guc3RhbXApXG4gICAgICByb3cuY2xhc3NMaXN0LmFkZChtYXRjaC5zZWxsID8gJ3NlbGxjb2xvcicgOiAnYnV5Y29sb3InKVxuICAgICAgcGFnZS5yZWNlbnRNYXRjaGVzTGl2ZUxpc3QuYXBwZW5kKHJvdylcbiAgICB9XG4gIH1cblxuICBhZGRSZWNlbnRNYXRjaGVzIChtYXRjaGVzOiBSZWNlbnRNYXRjaFtdKSB7XG4gICAgdGhpcy5yZWNlbnRNYXRjaGVzID0gWy4uLm1hdGNoZXMsIC4uLnRoaXMucmVjZW50TWF0Y2hlc10uc2xpY2UoMCwgMTAwKVxuICB9XG5cbiAgLyogaGFuZGxlQmFsYW5jZU5vdGUgaGFuZGxlcyBub3RpZmljYXRpb25zIHVwZGF0aW5nIGEgd2FsbGV0J3MgYmFsYW5jZS4gKi9cbiAgaGFuZGxlQmFsYW5jZU5vdGUgKG5vdGU6IEJhbGFuY2VOb3RlKSB7XG4gICAgdGhpcy5hcHByb3ZlVG9rZW5Gb3JtLmhhbmRsZUJhbGFuY2VOb3RlKG5vdGUpXG4gICAgdGhpcy5wcmVvcmRlckNhY2hlID0ge30gLy8gaW52YWxpZGF0ZSBwcmV2aW91cyBwcmVvcmRlciByZXN1bHRzXG4gICAgLy8gaWYgY29ubmVjdGlvbiB0byBkZXggc2VydmVyIGZhaWxzLCBpdCBpcyBub3QgcG9zc2libGUgdG8gcmV0cmlldmVcbiAgICAvLyBtYXJrZXRzLlxuICAgIGNvbnN0IG1rdCA9IHRoaXMubWFya2V0XG4gICAgaWYgKCFta3QgfHwgIW1rdC5kZXggfHwgbWt0LmRleC5jb25uZWN0aW9uU3RhdHVzICE9PSBDb25uZWN0aW9uU3RhdHVzLkNvbm5lY3RlZCkgcmV0dXJuXG5cbiAgICB0aGlzLm1tLmhhbmRsZUJhbGFuY2VOb3RlKG5vdGUpXG4gICAgY29uc3Qgd2d0ID0gdGhpcy5iYWxhbmNlV2d0XG4gICAgLy8gRGlzcGxheSB0aGUgd2lkZ2V0IGlmIHRoZSBiYWxhbmNlIG5vdGUgaXMgZm9yIGl0cyBiYXNlIG9yIHF1b3RlIHdhbGxldC5cbiAgICBpZiAoKG5vdGUuYXNzZXRJRCA9PT0gd2d0LmJhc2UuaWQgfHwgbm90ZS5hc3NldElEID09PSB3Z3QucXVvdGUuaWQpKSB3Z3Quc2V0QmFsYW5jZVZpc2liaWxpdHkodHJ1ZSlcblxuICAgIC8vIElmIHRoZXJlJ3MgYSBiYWxhbmNlIHVwZGF0ZSwgcmVmcmVzaCB0aGUgbWF4IG9yZGVyIHNlY3Rpb24uXG4gICAgY29uc3QgYXZhaWwgPSBub3RlLmJhbGFuY2UuYXZhaWxhYmxlXG4gICAgc3dpdGNoIChub3RlLmFzc2V0SUQpIHtcbiAgICAgIGNhc2UgbWt0LmJhc2VDZmcuaWQ6XG4gICAgICAgIC8vIElmIHdlJ3JlIG5vdCBzaG93aW5nIHRoZSBtYXggb3JkZXIgcGFuZWwgeWV0LCBkb24ndCBkbyBhbnl0aGluZy5cbiAgICAgICAgaWYgKCFta3QubWF4U2VsbCkgYnJlYWtcbiAgICAgICAgaWYgKHR5cGVvZiBta3Quc2VsbEJhbGFuY2UgPT09ICdudW1iZXInICYmIG1rdC5zZWxsQmFsYW5jZSAhPT0gYXZhaWwpIG1rdC5tYXhTZWxsID0gbnVsbFxuICAgICAgICBpZiAodGhpcy5pc1NlbGwoKSkgdGhpcy5wcmVTZWxsKClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgbWt0LnF1b3RlQ2ZnLmlkOlxuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKG1rdC5tYXhCdXlzKS5sZW5ndGgpIGJyZWFrXG4gICAgICAgIGlmICh0eXBlb2YgbWt0LmJ1eUJhbGFuY2UgPT09ICdudW1iZXInICYmIG1rdC5idXlCYWxhbmNlICE9PSBhdmFpbCkgbWt0Lm1heEJ1eXMgPSB7fVxuICAgICAgICBpZiAoIXRoaXMuaXNTZWxsKCkpIHRoaXMucHJlQnV5KClcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBzdWJtaXRPcmRlciBpcyBhdHRhY2hlZCB0byB0aGUgYWZmaXJtYXRpdmUgYnV0dG9uIG9uIHRoZSBvcmRlciB2YWxpZGF0aW9uXG4gICAqIGZvcm0uIENsaWNraW5nIHRoZSBidXR0b24gaXMgdGhlIGxhc3Qgc3RlcCBpbiB0aGUgb3JkZXIgc3VibWlzc2lvbiBwcm9jZXNzLlxuICAgKi9cbiAgYXN5bmMgc3VibWl0T3JkZXIgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLm9yZGVyRXJyLCBwYWdlLnZFcnIpXG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLmN1cnJlbnRPcmRlclxuICAgIGNvbnN0IHJlcSA9IHsgb3JkZXI6IHdpcmVPcmRlcihvcmRlcikgfVxuICAgIGlmICghdGhpcy52YWxpZGF0ZU9yZGVyKG9yZGVyKSkgcmV0dXJuXG4gICAgLy8gU2hvdyBsb2FkZXIgYW5kIGhpZGUgc3VibWl0IGJ1dHRvbi5cbiAgICBwYWdlLnZTdWJtaXQuY2xhc3NMaXN0LmFkZCgnZC1oaWRlJylcbiAgICBwYWdlLnZMb2FkZXIuY2xhc3NMaXN0LnJlbW92ZSgnZC1oaWRlJylcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS90cmFkZWFzeW5jJywgcmVxKVxuICAgIC8vIEhpZGUgbG9hZGVyIGFuZCBzaG93IHN1Ym1pdCBidXR0b24uXG4gICAgcGFnZS52U3VibWl0LmNsYXNzTGlzdC5yZW1vdmUoJ2QtaGlkZScpXG4gICAgcGFnZS52TG9hZGVyLmNsYXNzTGlzdC5hZGQoJ2QtaGlkZScpXG4gICAgLy8gSWYgZXJyb3IsIGRpc3BsYXkgZXJyb3Igb24gY29uZmlybWF0aW9uIG1vZGFsLlxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLnZFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLnZFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgLy8gSGlkZSBjb25maXJtYXRpb24gbW9kYWwgb25seSBvbiBzdWNjZXNzLlxuICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gICAgdGhpcy5yZWZyZXNoQWN0aXZlT3JkZXJzKClcbiAgfVxuXG4gIC8qXG4gICAqIGNyZWF0ZVdhbGxldCBpcyBhdHRhY2hlZCB0byBzdWNjZXNzZnVsIHN1Ym1pc3Npb24gb2YgdGhlIHdhbGxldCBjcmVhdGlvblxuICAgKiBmb3JtLiBjcmVhdGVXYWxsZXQgaXMgb25seSBjYWxsZWQgb25jZSB0aGUgZm9ybSBpcyBzdWJtaXR0ZWQgYW5kIGEgc3VjY2Vzc1xuICAgKiByZXNwb25zZSBpcyByZWNlaXZlZCBmcm9tIHRoZSBjbGllbnQuXG4gICAqL1xuICBhc3luYyBjcmVhdGVXYWxsZXQgKCkge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIGlmICghdXNlcikgcmV0dXJuXG4gICAgY29uc3QgYXNzZXQgPSB1c2VyLmFzc2V0c1t0aGlzLmN1cnJlbnRDcmVhdGUuaWRdXG4gICAgRG9jLmhpZGUodGhpcy5wYWdlLmZvcm1zKVxuICAgIGNvbnN0IG1rdCA9IHRoaXMubWFya2V0XG4gICAgaWYgKG1rdC5iYXNlQ2ZnLmlkID09PSBhc3NldC5pZCkgbWt0LmJhc2UgPSBhc3NldFxuICAgIGVsc2UgaWYgKG1rdC5xdW90ZUNmZy5pZCA9PT0gYXNzZXQuaWQpIG1rdC5xdW90ZSA9IGFzc2V0XG4gICAgdGhpcy5iYWxhbmNlV2d0LnVwZGF0ZUFzc2V0KGFzc2V0LmlkKVxuICAgIHRoaXMuZGlzcGxheU1lc3NhZ2VJZk1pc3NpbmdXYWxsZXQoKVxuICAgIHRoaXMucmVzb2x2ZU9yZGVyRm9ybVZpc2liaWxpdHkoKVxuICB9XG5cbiAgLyogbG90Q2hhbmdlZCBpcyBhdHRhY2hlZCB0byB0aGUga2V5dXAgYW5kIGNoYW5nZSBldmVudHMgb2YgdGhlIGxvdHMgaW5wdXQuICovXG4gIGxvdENoYW5nZWQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBsb3RzID0gcGFyc2VJbnQocGFnZS5sb3RGaWVsZC52YWx1ZSB8fCAnMCcpXG4gICAgaWYgKGxvdHMgPD0gMCkge1xuICAgICAgcGFnZS5sb3RGaWVsZC52YWx1ZSA9IHBhZ2UubG90RmllbGQudmFsdWUgPT09ICcnID8gJycgOiAnMCdcbiAgICAgIHBhZ2UucXR5RmllbGQudmFsdWUgPSAnJ1xuICAgICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQoZmFsc2UpXG4gICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQoZmFsc2UsIGludGwucHJlcChpbnRsLklEX09SREVSX0JVVFRPTl9RVFlfRVJST1IpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IGxvdFNpemUgPSB0aGlzLm1hcmtldC5jZmcubG90c2l6ZVxuICAgIGNvbnN0IG9yZGVyUXR5ID0gbG90cyAqIGxvdFNpemVcbiAgICBwYWdlLmxvdEZpZWxkLnZhbHVlID0gU3RyaW5nKGxvdHMpXG4gICAgLy8gQ29udmVyc2lvbiBmYWN0b3IgbXVzdCBiZSBhIG11bHRpcGxlIG9mIDEwLlxuICAgIHBhZ2UucXR5RmllbGQudmFsdWUgPSBTdHJpbmcob3JkZXJRdHkgLyB0aGlzLm1hcmtldC5iYXNlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG5cbiAgICBpZiAoIXRoaXMuaXNMaW1pdCgpICYmIHRoaXMuaXNTZWxsKCkpIHtcbiAgICAgIGNvbnN0IGJhc2VXYWxsZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5tYXJrZXQuYmFzZS5pZF0ud2FsbGV0XG4gICAgICB0aGlzLnNldE9yZGVyQnR0bkVuYWJsZWQob3JkZXJRdHkgPD0gYmFzZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX1NFTExfQkFMQU5DRV9FUlJPUikpXG4gICAgfVxuICAgIHRoaXMucHJldmlld1F1b3RlQW10KHRydWUpXG4gIH1cblxuICAvKlxuICAgKiBxdWFudGl0eUNoYW5nZWQgaXMgYXR0YWNoZWQgdG8gdGhlIGtleXVwIGFuZCBjaGFuZ2UgZXZlbnRzIG9mIHRoZSBxdWFudGl0eVxuICAgKiBpbnB1dC5cbiAgICovXG4gIHF1YW50aXR5Q2hhbmdlZCAoZmluYWxpemU6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLmN1cnJlbnRPcmRlciA9IHRoaXMucGFyc2VPcmRlcigpXG4gICAgaWYgKG9yZGVyLnF0eSA8IDApIHtcbiAgICAgIHBhZ2UubG90RmllbGQudmFsdWUgPSAnMCdcbiAgICAgIHBhZ2UucXR5RmllbGQudmFsdWUgPSAnJ1xuICAgICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQoZmFsc2UpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgbG90U2l6ZSA9IHRoaXMubWFya2V0LmNmZy5sb3RzaXplXG4gICAgY29uc3QgbG90cyA9IE1hdGguZmxvb3Iob3JkZXIucXR5IC8gbG90U2l6ZSlcbiAgICBjb25zdCBhZGp1c3RlZCA9IG9yZGVyLnF0eSA9IHRoaXMuY3VycmVudE9yZGVyLnF0eSA9IGxvdHMgKiBsb3RTaXplXG4gICAgcGFnZS5sb3RGaWVsZC52YWx1ZSA9IFN0cmluZyhsb3RzKVxuXG4gICAgaWYgKCFvcmRlci5pc0xpbWl0ICYmICFvcmRlci5zZWxsKSByZXR1cm5cblxuICAgIC8vIENvbnZlcnNpb24gZmFjdG9yIG11c3QgYmUgYSBtdWx0aXBsZSBvZiAxMC5cbiAgICBpZiAoZmluYWxpemUpIHBhZ2UucXR5RmllbGQudmFsdWUgPSBTdHJpbmcoYWRqdXN0ZWQgLyB0aGlzLm1hcmtldC5iYXNlVW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQodHJ1ZSlcbiAgfVxuXG4gIC8qXG4gICAqIG1hcmtldEJ1eUNoYW5nZWQgaXMgYXR0YWNoZWQgdG8gdGhlIGtleXVwIGFuZCBjaGFuZ2UgZXZlbnRzIG9mIHRoZSBxdWFudGl0eVxuICAgKiBpbnB1dCBmb3IgdGhlIG1hcmtldC1idXkgZm9ybS5cbiAgICovXG4gIG1hcmtldEJ1eUNoYW5nZWQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBxdHkgPSBjb252ZXJ0VG9BdG9tcyhwYWdlLm1rdEJ1eUZpZWxkLnZhbHVlIHx8ICcnLCB0aGlzLm1hcmtldC5xdW90ZVVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgIGNvbnN0IGdhcCA9IHRoaXMubWlkR2FwKClcbiAgICBpZiAocXR5ID4gMCkge1xuICAgICAgY29uc3QgcXVvdGVXYWxsZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5tYXJrZXQucXVvdGUuaWRdLndhbGxldFxuICAgICAgdGhpcy5zZXRPcmRlckJ0dG5FbmFibGVkKHF0eSA8PSBxdW90ZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSwgaW50bC5wcmVwKGludGwuSURfT1JERVJfQlVUVE9OX0JVWV9CQUxBTkNFX0VSUk9SKSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXRPcmRlckJ0dG5FbmFibGVkKGZhbHNlLCBpbnRsLnByZXAoaW50bC5JRF9PUkRFUl9CVVRUT05fUVRZX0VSUk9SKSlcbiAgICB9XG4gICAgaWYgKCFnYXAgfHwgIXF0eSkge1xuICAgICAgcGFnZS5ta3RCdXlMb3RzLnRleHRDb250ZW50ID0gJzAnXG4gICAgICBwYWdlLm1rdEJ1eVNjb3JlLnRleHRDb250ZW50ID0gJzAnXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgbG90U2l6ZSA9IHRoaXMubWFya2V0LmNmZy5sb3RzaXplXG4gICAgY29uc3QgcmVjZWl2ZWQgPSBxdHkgLyBnYXBcbiAgICBjb25zdCBsb3RzID0gKHJlY2VpdmVkIC8gbG90U2l6ZSlcbiAgICBwYWdlLm1rdEJ1eUxvdHMudGV4dENvbnRlbnQgPSBsb3RzLnRvRml4ZWQoMSlcbiAgICBwYWdlLm1rdEJ1eVNjb3JlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShyZWNlaXZlZCwgdGhpcy5tYXJrZXQuYmFzZVVuaXRJbmZvKVxuICB9XG5cbiAgLypcbiAgICogcmF0ZUZpZWxkQ2hhbmdlZCBpcyBhdHRhY2hlZCB0byB0aGUga2V5dXAgYW5kIGNoYW5nZSBldmVudHMgb2YgdGhlIHJhdGVcbiAgICogaW5wdXQuXG4gICAqL1xuICByYXRlRmllbGRDaGFuZ2VkICgpIHtcbiAgICAvLyBUcnVuY2F0ZSB0byByYXRlIHN0ZXAuIElmIGl0IGlzIGEgbWFya2V0IGJ1eSBvcmRlciwgZG8gbm90IGFkanVzdC5cbiAgICBjb25zdCBhZGp1c3RlZCA9IHRoaXMuYWRqdXN0ZWRSYXRlKClcbiAgICBpZiAoYWRqdXN0ZWQgPD0gMCkge1xuICAgICAgdGhpcy5kZXB0aExpbmVzLmlucHV0ID0gW11cbiAgICAgIHRoaXMuZHJhd0NoYXJ0TGluZXMoKVxuICAgICAgdGhpcy5wYWdlLnJhdGVGaWVsZC52YWx1ZSA9ICcwJ1xuICAgICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQodHJ1ZSlcbiAgICAgIHRoaXMudXBkYXRlT3JkZXJCdHRuU3RhdGUoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IG9yZGVyID0gdGhpcy5jdXJyZW50T3JkZXIgPSB0aGlzLnBhcnNlT3JkZXIoKVxuICAgIGNvbnN0IHIgPSBhZGp1c3RlZCAvIHRoaXMubWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yXG4gICAgdGhpcy5wYWdlLnJhdGVGaWVsZC52YWx1ZSA9IFN0cmluZyhyKVxuICAgIHRoaXMuZGVwdGhMaW5lcy5pbnB1dCA9IFt7XG4gICAgICByYXRlOiByLFxuICAgICAgY29sb3I6IG9yZGVyLnNlbGwgPyB0aGlzLmRlcHRoQ2hhcnQudGhlbWUuc2VsbExpbmUgOiB0aGlzLmRlcHRoQ2hhcnQudGhlbWUuYnV5TGluZVxuICAgIH1dXG4gICAgdGhpcy5kcmF3Q2hhcnRMaW5lcygpXG4gICAgdGhpcy5wcmV2aWV3UXVvdGVBbXQodHJ1ZSlcbiAgICB0aGlzLnVwZGF0ZU9yZGVyQnR0blN0YXRlKClcbiAgfVxuXG4gIC8qXG4gICAqIGFkanVzdGVkUmF0ZSBpcyB0aGUgY3VycmVudCByYXRlIGZpZWxkIHJhdGUsIHJvdW5kZWQgZG93biB0byBhXG4gICAqIG11bHRpcGxlIG9mIHJhdGVTdGVwLlxuICAgKi9cbiAgYWRqdXN0ZWRSYXRlICgpOiBudW1iZXIge1xuICAgIGNvbnN0IHYgPSB0aGlzLnBhZ2UucmF0ZUZpZWxkLnZhbHVlXG4gICAgaWYgKCF2KSByZXR1cm4gTmFOXG4gICAgY29uc3QgcmF0ZSA9IGNvbnZlcnRUb0F0b21zKHYsIHRoaXMubWFya2V0LnJhdGVDb252ZXJzaW9uRmFjdG9yKVxuICAgIGNvbnN0IHJhdGVTdGVwID0gdGhpcy5tYXJrZXQuY2ZnLnJhdGVzdGVwXG4gICAgcmV0dXJuIHJhdGUgLSAocmF0ZSAlIHJhdGVTdGVwKVxuICB9XG5cbiAgLyogbG9hZFRhYmxlIHJlbG9hZHMgdGhlIHRhYmxlIGZyb20gdGhlIGN1cnJlbnQgb3JkZXIgYm9vayBpbmZvcm1hdGlvbi4gKi9cbiAgbG9hZFRhYmxlICgpIHtcbiAgICB0aGlzLmxvYWRUYWJsZVNpZGUodHJ1ZSlcbiAgICB0aGlzLmxvYWRUYWJsZVNpZGUoZmFsc2UpXG4gIH1cblxuICAvKiBiaW5PcmRlcnNCeVJhdGVBbmRFcG9jaCB0YWtlcyBhIGxpc3Qgb2Ygc29ydGVkIG9yZGVycyBhbmQgcmV0dXJucyB0aGVcbiAgICAgc2FtZSBvcmRlcnMgZ3JvdXBlZCBpbnRvIGFycmF5cy4gVGhlIG9yZGVycyBhcmUgZ3JvdXBlZCBieSB0aGVpciByYXRlXG4gICAgIGFuZCB3aGV0aGVyIG9yIG5vdCB0aGV5IGFyZSBlcG9jaCBxdWV1ZSBvcmRlcnMuIEVwb2NoIHF1ZXVlIG9yZGVyc1xuICAgICB3aWxsIGNvbWUgYWZ0ZXIgbm9uIGVwb2NoIHF1ZXVlIG9yZGVycyB3aXRoIHRoZSBzYW1lIHJhdGUuICovXG4gIGJpbk9yZGVyc0J5UmF0ZUFuZEVwb2NoIChvcmRlcnM6IE1pbmlPcmRlcltdKSB7XG4gICAgaWYgKCFvcmRlcnMgfHwgIW9yZGVycy5sZW5ndGgpIHJldHVybiBbXVxuICAgIGNvbnN0IGJpbnMgPSBbXVxuICAgIGxldCBjdXJyRXBvY2hCaW4gPSBbXVxuICAgIGxldCBjdXJyTm9uRXBvY2hCaW4gPSBbXVxuICAgIGxldCBjdXJyUmF0ZSA9IG9yZGVyc1swXS5tc2dSYXRlXG4gICAgaWYgKG9yZGVyc1swXS5lcG9jaCkgY3VyckVwb2NoQmluLnB1c2gob3JkZXJzWzBdKVxuICAgIGVsc2UgY3Vyck5vbkVwb2NoQmluLnB1c2gob3JkZXJzWzBdKVxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgb3JkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAob3JkZXJzW2ldLm1zZ1JhdGUgIT09IGN1cnJSYXRlKSB7XG4gICAgICAgIGJpbnMucHVzaChjdXJyTm9uRXBvY2hCaW4pXG4gICAgICAgIGJpbnMucHVzaChjdXJyRXBvY2hCaW4pXG4gICAgICAgIGN1cnJFcG9jaEJpbiA9IFtdXG4gICAgICAgIGN1cnJOb25FcG9jaEJpbiA9IFtdXG4gICAgICAgIGN1cnJSYXRlID0gb3JkZXJzW2ldLm1zZ1JhdGVcbiAgICAgIH1cbiAgICAgIGlmIChvcmRlcnNbaV0uZXBvY2gpIGN1cnJFcG9jaEJpbi5wdXNoKG9yZGVyc1tpXSlcbiAgICAgIGVsc2UgY3Vyck5vbkVwb2NoQmluLnB1c2gob3JkZXJzW2ldKVxuICAgIH1cbiAgICBiaW5zLnB1c2goY3Vyck5vbkVwb2NoQmluKVxuICAgIGJpbnMucHVzaChjdXJyRXBvY2hCaW4pXG4gICAgcmV0dXJuIGJpbnMuZmlsdGVyKGJpbiA9PiBiaW4ubGVuZ3RoID4gMClcbiAgfVxuXG4gIC8qIGxvYWRUYWJsZXMgbG9hZHMgdGhlIG9yZGVyIGJvb2sgc2lkZSBpbnRvIGl0cyB0YWJsZS4gKi9cbiAgbG9hZFRhYmxlU2lkZSAoc2VsbDogYm9vbGVhbikge1xuICAgIGNvbnN0IGJvb2tTaWRlID0gc2VsbCA/IHRoaXMuYm9vay5zZWxscyA6IHRoaXMuYm9vay5idXlzXG4gICAgY29uc3QgdGJvZHkgPSBzZWxsID8gdGhpcy5wYWdlLnNlbGxSb3dzIDogdGhpcy5wYWdlLmJ1eVJvd3NcbiAgICBEb2MuZW1wdHkodGJvZHkpXG4gICAgaWYgKCFib29rU2lkZSB8fCAhYm9va1NpZGUubGVuZ3RoKSByZXR1cm5cbiAgICBjb25zdCBvcmRlckJpbnMgPSB0aGlzLmJpbk9yZGVyc0J5UmF0ZUFuZEVwb2NoKGJvb2tTaWRlKVxuICAgIG9yZGVyQmlucy5mb3JFYWNoKGJpbiA9PiB7IHRib2R5LmFwcGVuZENoaWxkKHRoaXMub3JkZXJUYWJsZVJvdyhiaW4pKSB9KVxuICB9XG5cbiAgLyogYWRkVGFibGVPcmRlciBhZGRzIGEgc2luZ2xlIG9yZGVyIHRvIHRoZSBhcHByb3ByaWF0ZSB0YWJsZS4gKi9cbiAgYWRkVGFibGVPcmRlciAob3JkZXI6IE1pbmlPcmRlcikge1xuICAgIGNvbnN0IHRib2R5ID0gb3JkZXIuc2VsbCA/IHRoaXMucGFnZS5zZWxsUm93cyA6IHRoaXMucGFnZS5idXlSb3dzXG4gICAgbGV0IHJvdyA9IHRib2R5LmZpcnN0Q2hpbGQgYXMgT3JkZXJSb3dcbiAgICAvLyBIYW5kbGUgbWFya2V0IG9yZGVyIGRpZmZlcmVudGx5LlxuICAgIGlmIChvcmRlci5yYXRlID09PSAwKSB7XG4gICAgICBpZiAob3JkZXIucXR5QXRvbWljID09PSAwKSByZXR1cm4gLy8gYSBjYW5jZWwgb3JkZXIuIFRPRE86IG1heWJlIG1ha2UgYW4gaW5kaWNhdG9yIG9uIHRoZSB0YXJnZXQgb3JkZXIsIG1heWJlIGdyYXkgb3V0XG4gICAgICAvLyBUaGlzIGlzIGEgbWFya2V0IG9yZGVyLlxuICAgICAgaWYgKHJvdyAmJiByb3cubWFuYWdlci5nZXRSYXRlKCkgPT09IDApIHtcbiAgICAgICAgcm93Lm1hbmFnZXIuaW5zZXJ0T3JkZXIob3JkZXIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByb3cgPSB0aGlzLm9yZGVyVGFibGVSb3coW29yZGVyXSlcbiAgICAgICAgdGJvZHkuaW5zZXJ0QmVmb3JlKHJvdywgdGJvZHkuZmlyc3RDaGlsZClcbiAgICAgIH1cbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyBNdXN0IGJlIGEgbGltaXQgb3JkZXIuIFNvcnQgYnkgcmF0ZS4gU2tpcCB0aGUgbWFya2V0IG9yZGVyIHJvdy5cbiAgICBpZiAocm93ICYmIHJvdy5tYW5hZ2VyLmdldFJhdGUoKSA9PT0gMCkgcm93ID0gcm93Lm5leHRTaWJsaW5nIGFzIE9yZGVyUm93XG4gICAgd2hpbGUgKHJvdykge1xuICAgICAgaWYgKHJvdy5tYW5hZ2VyLmNvbXBhcmUob3JkZXIpID09PSAwKSB7XG4gICAgICAgIHJvdy5tYW5hZ2VyLmluc2VydE9yZGVyKG9yZGVyKVxuICAgICAgICByZXR1cm5cbiAgICAgIH0gZWxzZSBpZiAocm93Lm1hbmFnZXIuY29tcGFyZShvcmRlcikgPiAwKSB7XG4gICAgICAgIGNvbnN0IHRyID0gdGhpcy5vcmRlclRhYmxlUm93KFtvcmRlcl0pXG4gICAgICAgIHRib2R5Lmluc2VydEJlZm9yZSh0ciwgcm93KVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHJvdyA9IHJvdy5uZXh0U2libGluZyBhcyBPcmRlclJvd1xuICAgIH1cbiAgICBjb25zdCB0ciA9IHRoaXMub3JkZXJUYWJsZVJvdyhbb3JkZXJdKVxuICAgIHRib2R5LmFwcGVuZENoaWxkKHRyKVxuICB9XG5cbiAgLyogcmVtb3ZlVGFibGVPcmRlciByZW1vdmVzIGEgc2luZ2xlIG9yZGVyIGZyb20gaXRzIHRhYmxlLiAqL1xuICByZW1vdmVUYWJsZU9yZGVyIChvcmRlcjogTWluaU9yZGVyKSB7XG4gICAgY29uc3QgdG9rZW4gPSBvcmRlci50b2tlblxuICAgIGZvciAoY29uc3QgdGJvZHkgb2YgW3RoaXMucGFnZS5zZWxsUm93cywgdGhpcy5wYWdlLmJ1eVJvd3NdKSB7XG4gICAgICBmb3IgKGNvbnN0IHRyIG9mIChBcnJheS5mcm9tKHRib2R5LmNoaWxkcmVuKSBhcyBPcmRlclJvd1tdKSkge1xuICAgICAgICBpZiAodHIubWFuYWdlci5yZW1vdmVPcmRlcih0b2tlbikpIHtcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qIHVwZGF0ZVRhYmxlT3JkZXIgbG9va3MgZm9yIHRoZSBvcmRlciBpbiB0aGUgdGFibGUgYW5kIHVwZGF0ZXMgdGhlIHF0eSAqL1xuICB1cGRhdGVUYWJsZU9yZGVyICh1OiBSZW1haW5kZXJVcGRhdGUpIHtcbiAgICBmb3IgKGNvbnN0IHRib2R5IG9mIFt0aGlzLnBhZ2Uuc2VsbFJvd3MsIHRoaXMucGFnZS5idXlSb3dzXSkge1xuICAgICAgZm9yIChjb25zdCB0ciBvZiAoQXJyYXkuZnJvbSh0Ym9keS5jaGlsZHJlbikgYXMgT3JkZXJSb3dbXSkpIHtcbiAgICAgICAgaWYgKHRyLm1hbmFnZXIudXBkYXRlT3JkZXJRdHkodSkpIHtcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGNsZWFyT3JkZXJUYWJsZUVwb2NocyByZW1vdmVzIGltbWVkaWF0ZS10aWYgb3JkZXJzIHdob3NlIGVwb2NoIGhhcyBleHBpcmVkLlxuICAgKi9cbiAgY2xlYXJPcmRlclRhYmxlRXBvY2hzICgpIHtcbiAgICB0aGlzLmNsZWFyT3JkZXJUYWJsZUVwb2NoU2lkZSh0aGlzLnBhZ2Uuc2VsbFJvd3MpXG4gICAgdGhpcy5jbGVhck9yZGVyVGFibGVFcG9jaFNpZGUodGhpcy5wYWdlLmJ1eVJvd3MpXG4gIH1cblxuICAvKlxuICAgKiBjbGVhck9yZGVyVGFibGVFcG9jaHMgcmVtb3ZlcyBpbW1lZGlhdGUtdGlmIG9yZGVycyB3aG9zZSBlcG9jaCBoYXMgZXhwaXJlZFxuICAgKiBmb3IgYSBzaW5nbGUgc2lkZS5cbiAgICovXG4gIGNsZWFyT3JkZXJUYWJsZUVwb2NoU2lkZSAodGJvZHk6IEhUTUxFbGVtZW50KSB7XG4gICAgZm9yIChjb25zdCB0ciBvZiAoQXJyYXkuZnJvbSh0Ym9keS5jaGlsZHJlbikpIGFzIE9yZGVyUm93W10pIHtcbiAgICAgIHRyLm1hbmFnZXIucmVtb3ZlRXBvY2hPcmRlcnMoKVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIG9yZGVyVGFibGVSb3cgY3JlYXRlcyBhIG5ldyA8dHI+IGVsZW1lbnQgdG8gaW5zZXJ0IGludG8gYW4gb3JkZXIgdGFibGUuXG4gICAgIFRha2VzIGEgYmluIG9mIG9yZGVycyB3aXRoIHRoZSBzYW1lIHJhdGUsIGFuZCBkaXNwbGF5cyB0aGUgdG90YWwgcXVhbnRpdHkuXG4gICAqL1xuICBvcmRlclRhYmxlUm93IChvcmRlckJpbjogTWluaU9yZGVyW10pOiBPcmRlclJvdyB7XG4gICAgY29uc3QgdHIgPSB0aGlzLnBhZ2Uub3JkZXJSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBPcmRlclJvd1xuICAgIGNvbnN0IHsgYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvLCByYXRlQ29udmVyc2lvbkZhY3RvciwgY2ZnOiB7IHJhdGVzdGVwOiByYXRlU3RlcCB9IH0gPSB0aGlzLm1hcmtldFxuICAgIGNvbnN0IG1hbmFnZXIgPSBuZXcgT3JkZXJUYWJsZVJvd01hbmFnZXIodHIsIG9yZGVyQmluLCBiYXNlVW5pdEluZm8sIHF1b3RlVW5pdEluZm8sIHJhdGVTdGVwKVxuICAgIHRyLm1hbmFnZXIgPSBtYW5hZ2VyXG4gICAgYmluZCh0ciwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5yZXBvcnREZXB0aENsaWNrKHRyLm1hbmFnZXIuZ2V0UmF0ZSgpIC8gcmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgfSlcbiAgICBpZiAodHIubWFuYWdlci5nZXRSYXRlKCkgIT09IDApIHtcbiAgICAgIERvYy5iaW5kKHRyLCAnbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgY29uc3QgY2hhcnQgPSB0aGlzLmRlcHRoQ2hhcnRcbiAgICAgICAgdGhpcy5kZXB0aExpbmVzLmhvdmVyID0gW3tcbiAgICAgICAgICByYXRlOiB0ci5tYW5hZ2VyLmdldFJhdGUoKSAvIHJhdGVDb252ZXJzaW9uRmFjdG9yLFxuICAgICAgICAgIGNvbG9yOiB0ci5tYW5hZ2VyLmlzU2VsbCgpID8gY2hhcnQudGhlbWUuc2VsbExpbmUgOiBjaGFydC50aGVtZS5idXlMaW5lXG4gICAgICAgIH1dXG4gICAgICAgIHRoaXMuZHJhd0NoYXJ0TGluZXMoKVxuICAgICAgfSlcbiAgICB9XG4gICAgcmV0dXJuIHRyXG4gIH1cblxuICAvKiBoYW5kbGVDb25uTm90ZSBoYW5kbGVzIHRoZSAnY29ubicgbm90aWZpY2F0aW9uLlxuICAgKi9cbiAgYXN5bmMgaGFuZGxlQ29ubk5vdGUgKG5vdGU6IENvbm5FdmVudE5vdGUpIHtcbiAgICB0aGlzLm1hcmtldExpc3Quc2V0Q29ubmVjdGlvblN0YXR1cyhub3RlKVxuICAgIGlmIChub3RlLmNvbm5lY3Rpb25TdGF0dXMgPT09IENvbm5lY3Rpb25TdGF0dXMuQ29ubmVjdGVkKSB7XG4gICAgICAvLyBIYXZpbmcgYmVlbiBkaXNjb25uZWN0ZWQgZnJvbSBhIERFWCBzZXJ2ZXIsIGFueXRoaW5nIG1heSBoYXZlIGNoYW5nZWQsXG4gICAgICAvLyBvciB0aGlzIG1heSBiZSB0aGUgZmlyc3Qgb3Bwb3J0dW5pdHkgdG8gZ2V0IHRoZSBzZXJ2ZXIncyBjb25maWcsIHNvXG4gICAgICAvLyBmZXRjaCBpdCBhbGwgYmVmb3JlIHJlbG9hZGluZyB0aGUgbWFya2V0cyBwYWdlLlxuICAgICAgYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICAgIGF3YWl0IGFwcCgpLmxvYWRQYWdlKCdtYXJrZXRzJylcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBmaWx0ZXJNYXJrZXRzIHNldHMgdGhlIGRpc3BsYXkgb2YgbWFya2V0cyBpbiB0aGUgbWFya2V0cyBsaXN0IGJhc2VkIG9uIHRoZVxuICAgKiB2YWx1ZSBvZiB0aGUgc2VhcmNoIGlucHV0LlxuICAgKi9cbiAgZmlsdGVyTWFya2V0cyAoKSB7XG4gICAgY29uc3QgZmlsdGVyVHh0ID0gdGhpcy5wYWdlLm1hcmtldFNlYXJjaFYxLnZhbHVlPy50b0xvd2VyQ2FzZSgpXG4gICAgY29uc3QgZmlsdGVyID0gZmlsdGVyVHh0ID8gKG1rdDogTWFya2V0Um93KSA9PiBta3QubmFtZS5pbmNsdWRlcyhmaWx0ZXJUeHQpIDogKCkgPT4gdHJ1ZVxuICAgIHRoaXMubWFya2V0TGlzdC5zZXRGaWx0ZXIoZmlsdGVyKVxuICB9XG5cbiAgLyogZHJhd0NoYXJ0TGluZXMgZHJhd3MgdGhlIGhvdmVyIGFuZCBpbnB1dCBsaW5lcyBvbiB0aGUgY2hhcnQuICovXG4gIGRyYXdDaGFydExpbmVzICgpIHtcbiAgICB0aGlzLmRlcHRoQ2hhcnQuc2V0TGluZXMoWy4uLnRoaXMuZGVwdGhMaW5lcy5ob3ZlciwgLi4udGhpcy5kZXB0aExpbmVzLmlucHV0XSlcbiAgICB0aGlzLmRlcHRoQ2hhcnQuZHJhdygpXG4gIH1cblxuICAvKiBjYW5kbGVEdXJhdGlvblNlbGVjdGVkIHNldHMgdGhlIGNhbmRsZUR1ciBhbmQgbG9hZHMgdGhlIGNhbmRsZXMuIEl0IHdpbGxcbiAgZGVmYXVsdCB0byB0aGUgb25lSHJCaW5LZXkgaWYgZHVyIGlzIG5vdCB2YWxpZC4gKi9cbiAgY2FuZGxlRHVyYXRpb25TZWxlY3RlZCAoZHVyOiBzdHJpbmcpIHtcbiAgICBpZiAoIXRoaXMubWFya2V0Py5kZXg/LmNhbmRsZUR1cnMuaW5jbHVkZXMoZHVyKSkgZHVyID0gb25lSHJCaW5LZXlcbiAgICB0aGlzLmNhbmRsZUR1ciA9IGR1clxuICAgIHRoaXMubG9hZENhbmRsZXMoKVxuICAgIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUubGFzdENhbmRsZUR1cmF0aW9uTEssIGR1cilcbiAgfVxuXG4gIC8qXG4gICAqIGxvYWRDYW5kbGVzIGxvYWRzIHRoZSBjYW5kbGVzIGZvciB0aGUgY3VycmVudCBjYW5kbGVEdXIuIElmIGEgY2FjaGUgaXMgYWxyZWFkeVxuICAgKiBhY3RpdmUsIHRoZSBjYWNoZSB3aWxsIGJlIHVzZWQgd2l0aG91dCBhIGxvYWRjYW5kbGVzIHJlcXVlc3QuXG4gICAqL1xuICBsb2FkQ2FuZGxlcyAoKSB7XG4gICAgZm9yIChjb25zdCBidHRuIG9mIERvYy5raWRzKHRoaXMucGFnZS5kdXJCdHRuQm94KSkge1xuICAgICAgaWYgKGJ0dG4udGV4dENvbnRlbnQgPT09IHRoaXMuY2FuZGxlRHVyKSBidHRuLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgIGVsc2UgYnR0bi5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgfVxuICAgIGNvbnN0IHsgY2FuZGxlQ2FjaGVzLCBjZmcsIGJhc2VVbml0SW5mbywgcXVvdGVVbml0SW5mbyB9ID0gdGhpcy5tYXJrZXRcbiAgICBjb25zdCBjYWNoZSA9IGNhbmRsZUNhY2hlc1t0aGlzLmNhbmRsZUR1cl1cbiAgICBpZiAoY2FjaGUpIHtcbiAgICAgIC8vIHRoaXMuZGVwdGhDaGFydC5oaWRlKClcbiAgICAgIC8vIHRoaXMuY2FuZGxlQ2hhcnQuc2hvdygpXG4gICAgICB0aGlzLmNhbmRsZUNoYXJ0LnNldENhbmRsZXMoY2FjaGUsIGNmZywgYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMucmVxdWVzdENhbmRsZXMoKVxuICB9XG5cbiAgLyogcmVxdWVzdENhbmRsZXMgc2VuZHMgdGhlIGxvYWRjYW5kbGVzIHJlcXVlc3QuIEl0IGFjY2VwdHMgYW4gb3B0aW9uYWwgY2FuZGxlXG4gICAqIGR1cmF0aW9uIHdoaWNoIHdpbGwgYmUgcmVxdWVzdGVkIGlmIGl0IGlzIHByb3ZpZGVkLlxuICAgKi9cbiAgcmVxdWVzdENhbmRsZXMgKGNhbmRsZUR1cj86IHN0cmluZykge1xuICAgIHRoaXMuY2FuZGxlc0xvYWRpbmcgPSB7XG4gICAgICBsb2FkZWQ6ICgpID0+IHsgLyogcGFzcyAqLyB9LFxuICAgICAgdGltZXI6IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuY2FuZGxlc0xvYWRpbmcpIHtcbiAgICAgICAgICB0aGlzLmNhbmRsZXNMb2FkaW5nID0gbnVsbFxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2NhbmRsZXMgbm90IHJlY2VpdmVkJylcbiAgICAgICAgfVxuICAgICAgfSwgMTAwMDApXG4gICAgfVxuICAgIGNvbnN0IHsgZGV4LCBiYXNlQ2ZnLCBxdW90ZUNmZyB9ID0gdGhpcy5tYXJrZXRcbiAgICB3cy5yZXF1ZXN0KCdsb2FkY2FuZGxlcycsIHsgaG9zdDogZGV4Lmhvc3QsIGJhc2U6IGJhc2VDZmcuaWQsIHF1b3RlOiBxdW90ZUNmZy5pZCwgZHVyOiBjYW5kbGVEdXIgfHwgdGhpcy5jYW5kbGVEdXIgfSlcbiAgfVxuXG4gIC8qXG4gICAqIHVubG9hZCBpcyBjYWxsZWQgYnkgdGhlIEFwcGxpY2F0aW9uIHdoZW4gdGhlIHVzZXIgbmF2aWdhdGVzIGF3YXkgZnJvbVxuICAgKiB0aGUgL21hcmtldHMgcGFnZS5cbiAgICovXG4gIHVubG9hZCAoKSB7XG4gICAgd3MucmVxdWVzdCh1bm1hcmtldFJvdXRlLCB7fSlcbiAgICB3cy5kZXJlZ2lzdGVyUm91dGUoYm9va1JvdXRlKVxuICAgIHdzLmRlcmVnaXN0ZXJSb3V0ZShib29rT3JkZXJSb3V0ZSlcbiAgICB3cy5kZXJlZ2lzdGVyUm91dGUodW5ib29rT3JkZXJSb3V0ZSlcbiAgICB3cy5kZXJlZ2lzdGVyUm91dGUodXBkYXRlUmVtYWluaW5nUm91dGUpXG4gICAgd3MuZGVyZWdpc3RlclJvdXRlKGVwb2NoT3JkZXJSb3V0ZSlcbiAgICB3cy5kZXJlZ2lzdGVyUm91dGUoY2FuZGxlc1JvdXRlKVxuICAgIHdzLmRlcmVnaXN0ZXJSb3V0ZShjYW5kbGVVcGRhdGVSb3V0ZSlcbiAgICB0aGlzLmRlcHRoQ2hhcnQudW5hdHRhY2goKVxuICAgIHRoaXMuY2FuZGxlQ2hhcnQudW5hdHRhY2goKVxuICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdrZXl1cCcsIHRoaXMua2V5dXApXG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLnNlY29uZFRpY2tlcilcbiAgfVxufVxuXG4vKlxuICogIE1hcmtldExpc3QgcmVwcmVzZW50cyB0aGUgbGlzdCBvZiBleGNoYW5nZXMgYW5kIG1hcmtldHMgb24gdGhlIGxlZnQgc2lkZSBvZlxuICogbWFya2V0cyB2aWV3LiBUaGUgTWFya2V0TGlzdCBwcm92aWRlcyB1dGlsaXRpZXMgZm9yIGFkanVzdGluZyB0aGUgdmlzaWJpbGl0eVxuICogYW5kIHNvcnQgb3JkZXIgb2YgbWFya2V0cy5cbiAqL1xuY2xhc3MgTWFya2V0TGlzdCB7XG4gIC8vIHhjU2VjdGlvbnM6IEV4Y2hhbmdlU2VjdGlvbltdXG4gIGRpdjogUGFnZUVsZW1lbnRcbiAgcm93VG1wbDogUGFnZUVsZW1lbnRcbiAgbWFya2V0czogTWFya2V0Um93W11cbiAgc2VsZWN0ZWQ6IE1hcmtldFJvd1xuXG4gIGNvbnN0cnVjdG9yIChkaXY6IEhUTUxFbGVtZW50KSB7XG4gICAgdGhpcy5kaXYgPSBkaXZcbiAgICB0aGlzLnJvd1RtcGwgPSBEb2MuaWRlbChkaXYsICdtYXJrZXRUbXBsVjEnKVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyh0aGlzLnJvd1RtcGwpXG4gICAgdGhpcy5yZWxvYWRNYXJrZXRzUGFuZSgpXG4gIH1cblxuICB1cGRhdGVTcG90cyAobm90ZTogU3BvdFByaWNlTm90ZSkge1xuICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMubWFya2V0cykge1xuICAgICAgaWYgKHJvdy5ta3QueGMuaG9zdCAhPT0gbm90ZS5ob3N0KSBjb250aW51ZVxuICAgICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbcm93Lm1rdC54Yy5ob3N0XVxuICAgICAgY29uc3QgbWt0ID0geGMubWFya2V0c1tyb3cubWt0Lm5hbWVdXG4gICAgICBzZXRQcmljZUFuZENoYW5nZShyb3cudG1wbCwgeGMsIG1rdClcbiAgICB9XG4gIH1cblxuICByZWxvYWRNYXJrZXRzUGFuZSAoKTogdm9pZCB7XG4gICAgRG9jLmVtcHR5KHRoaXMuZGl2KVxuICAgIHRoaXMubWFya2V0cyA9IFtdXG5cbiAgICBjb25zdCBhZGRNYXJrZXQgPSAobWt0OiBFeGNoYW5nZU1hcmtldCkgPT4ge1xuICAgICAgY29uc3QgYnVpID0gYXBwKCkudW5pdEluZm8obWt0LmJhc2VpZCwgbWt0LnhjKVxuICAgICAgY29uc3QgcXVpID0gYXBwKCkudW5pdEluZm8obWt0LnF1b3RlaWQsIG1rdC54YylcbiAgICAgIGNvbnN0IHJhdGVDb252ZXJzaW9uRmFjdG9yID0gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvciAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAqIHF1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgICAgY29uc3Qgcm93ID0gbmV3IE1hcmtldFJvdyh0aGlzLnJvd1RtcGwsIG1rdCwgcmF0ZUNvbnZlcnNpb25GYWN0b3IpXG4gICAgICB0aGlzLmRpdi5hcHBlbmRDaGlsZChyb3cubm9kZSlcbiAgICAgIHJldHVybiByb3dcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IG1rdCBvZiBzb3J0ZWRNYXJrZXRzKCkpIHRoaXMubWFya2V0cy5wdXNoKGFkZE1hcmtldChta3QpKVxuICAgIGFwcCgpLmJpbmRUb29sdGlwcyh0aGlzLmRpdilcbiAgfVxuXG4gIGZpbmQgKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcik6IE1hcmtldFJvdyB8IG51bGwge1xuICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMubWFya2V0cykge1xuICAgICAgaWYgKHJvdy5ta3QueGMuaG9zdCA9PT0gaG9zdCAmJiByb3cubWt0LmJhc2VpZCA9PT0gYmFzZUlEICYmIHJvdy5ta3QucXVvdGVpZCA9PT0gcXVvdGVJRCkgcmV0dXJuIHJvd1xuICAgIH1cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLyogZXhpc3RzIHdpbGwgYmUgdHJ1ZSBpZiB0aGUgc3BlY2lmaWVkIG1hcmtldCBleGlzdHMuICovXG4gIGV4aXN0cyAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZmluZChob3N0LCBiYXNlSUQsIHF1b3RlSUQpICE9PSBudWxsXG4gIH1cblxuICAvKiBmaXJzdCBnZXRzIHRoZSBmaXJzdCBtYXJrZXQgZnJvbSB0aGUgZmlyc3QgZXhjaGFuZ2UsIGFscGhhYmV0aWNhbGx5LiAqL1xuICBmaXJzdCAoKTogTWFya2V0Um93IHtcbiAgICByZXR1cm4gdGhpcy5tYXJrZXRzWzBdXG4gIH1cblxuICAvKiBzZWxlY3Qgc2V0cyB0aGUgc3BlY2lmaWVkIG1hcmtldCBhcyBzZWxlY3RlZC4gKi9cbiAgc2VsZWN0IChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpIHtcbiAgICBjb25zdCByb3cgPSB0aGlzLmZpbmQoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIGlmICghcm93KSByZXR1cm4gY29uc29sZS5lcnJvcihgc2VsZWN0OiBubyBtYXJrZXQgcm93IGZvciAke2hvc3R9LCAke2Jhc2VJRH0tJHtxdW90ZUlEfWApXG4gICAgZm9yIChjb25zdCBta3Qgb2YgdGhpcy5tYXJrZXRzKSBta3Qubm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgdGhpcy5zZWxlY3RlZCA9IHJvd1xuICAgIHRoaXMuc2VsZWN0ZWQubm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gIH1cblxuICAvKiBzZXRDb25uZWN0aW9uU3RhdHVzIHNldHMgdGhlIHZpc2liaWxpdHkgb2YgdGhlIGRpc2Nvbm5lY3RlZCBpY29uIGJhc2VkXG4gICAqIG9uIHRoZSBjb3JlLkNvbm5FdmVudE5vdGUuXG4gICAqL1xuICBzZXRDb25uZWN0aW9uU3RhdHVzIChub3RlOiBDb25uRXZlbnROb3RlKSB7XG4gICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5tYXJrZXRzKSB7XG4gICAgICBpZiAocm93Lm1rdC54Yy5ob3N0ICE9PSBub3RlLmhvc3QpIGNvbnRpbnVlXG4gICAgICBpZiAobm90ZS5jb25uZWN0aW9uU3RhdHVzID09PSBDb25uZWN0aW9uU3RhdHVzLkNvbm5lY3RlZCkgRG9jLmhpZGUocm93LnRtcGwuZGlzY29ubmVjdGVkSWNvKVxuICAgICAgZWxzZSBEb2Muc2hvdyhyb3cudG1wbC5kaXNjb25uZWN0ZWRJY28pXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogc2V0RmlsdGVyIHNldHMgdGhlIHZpc2liaWxpdHkgb2YgbWFya2V0IHJvd3MgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGZpbHRlci5cbiAgICovXG4gIHNldEZpbHRlciAoZmlsdGVyOiAobWt0OiBNYXJrZXRSb3cpID0+IGJvb2xlYW4pIHtcbiAgICBmb3IgKGNvbnN0IHJvdyBvZiB0aGlzLm1hcmtldHMpIHtcbiAgICAgIGlmIChmaWx0ZXIocm93KSkgRG9jLnNob3cocm93Lm5vZGUpXG4gICAgICBlbHNlIERvYy5oaWRlKHJvdy5ub2RlKVxuICAgIH1cbiAgfVxufVxuXG4vKlxuICogTWFya2V0Um93IHJlcHJlc2VudHMgb25lIHJvdyBpbiB0aGUgTWFya2V0TGlzdC4gQSBNYXJrZXRSb3cgaXMgYSBzdWJzZWN0aW9uXG4gKiBvZiB0aGUgRXhjaGFuZ2VTZWN0aW9uLlxuICovXG5jbGFzcyBNYXJrZXRSb3cge1xuICBub2RlOiBIVE1MRWxlbWVudFxuICBta3Q6IEV4Y2hhbmdlTWFya2V0XG4gIG5hbWU6IHN0cmluZ1xuICBiYXNlSUQ6IG51bWJlclxuICBxdW90ZUlEOiBudW1iZXJcbiAgbG90U2l6ZTogbnVtYmVyXG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICByYXRlQ29udmVyc2lvbkZhY3RvcjogbnVtYmVyXG5cbiAgY29uc3RydWN0b3IgKHRlbXBsYXRlOiBIVE1MRWxlbWVudCwgbWt0OiBFeGNoYW5nZU1hcmtldCwgcmF0ZUNvbnZlcnNpb25GYWN0b3I6IG51bWJlcikge1xuICAgIHRoaXMubWt0ID0gbWt0XG4gICAgdGhpcy5uYW1lID0gbWt0Lm5hbWVcbiAgICB0aGlzLmJhc2VJRCA9IG1rdC5iYXNlaWRcbiAgICB0aGlzLnF1b3RlSUQgPSBta3QucXVvdGVpZFxuICAgIHRoaXMubG90U2l6ZSA9IG1rdC5sb3RzaXplXG4gICAgdGhpcy5yYXRlQ29udmVyc2lvbkZhY3RvciA9IHJhdGVDb252ZXJzaW9uRmFjdG9yXG4gICAgdGhpcy5ub2RlID0gdGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgY29uc3QgdG1wbCA9IHRoaXMudG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRoaXMubm9kZSlcbiAgICB0bXBsLmJhc2VJY29uLnNyYyA9IERvYy5sb2dvUGF0aChta3QuYmFzZXN5bWJvbClcbiAgICB0bXBsLnF1b3RlSWNvbi5zcmMgPSBEb2MubG9nb1BhdGgobWt0LnF1b3Rlc3ltYm9sKVxuICAgIHRtcGwuYmFzZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKG1rdC54Yy5hc3NldHNbbWt0LmJhc2VpZF0sIHRydWUpKVxuICAgIHRtcGwucXVvdGVTeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShta3QueGMuYXNzZXRzW21rdC5xdW90ZWlkXSwgdHJ1ZSkpXG4gICAgdG1wbC5iYXNlTmFtZS50ZXh0Q29udGVudCA9IG1rdC5iYXNlTmFtZVxuICAgIHRtcGwuaG9zdC50ZXh0Q29udGVudCA9IG1rdC54Yy5ob3N0XG4gICAgdG1wbC5ob3N0LnN0eWxlLmNvbG9yID0gaG9zdENvbG9yKG1rdC54Yy5ob3N0KVxuICAgIHRtcGwuaG9zdC5kYXRhc2V0LnRvb2x0aXAgPSBta3QueGMuaG9zdFxuICAgIHNldFByaWNlQW5kQ2hhbmdlKHRtcGwsIG1rdC54YywgbWt0KVxuICAgIGlmICh0aGlzLm1rdC54Yy5jb25uZWN0aW9uU3RhdHVzICE9PSBDb25uZWN0aW9uU3RhdHVzLkNvbm5lY3RlZCkgRG9jLnNob3codG1wbC5kaXNjb25uZWN0ZWRJY28pXG4gIH1cbn1cblxuaW50ZXJmYWNlIEJhbGFuY2VXaWRnZXRFbGVtZW50IHtcbiAgaWQ6IG51bWJlclxuICBwYXJlbnRJRDogbnVtYmVyXG4gIGNmZzogQXNzZXQgfCBudWxsXG4gIG5vZGU6IFBhZ2VFbGVtZW50XG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBpY29uQm94OiBQYWdlRWxlbWVudFxuICBzdGF0ZUljb25zOiBXYWxsZXRJY29uc1xuICBwYXJlbnRCYWw/OiBQYWdlRWxlbWVudFxufVxuXG4vKlxuICogQmFsYW5jZVdpZGdldCBpcyBhIGRpc3BsYXkgb2YgYmFsYW5jZSBpbmZvcm1hdGlvbi4gQmVjYXVzZSB0aGUgd2FsbGV0IGNhbiBiZVxuICogaW4gYW55IG51bWJlciBvZiBzdGF0ZXMsIGFuZCBiZWNhdXNlIGV2ZXJ5IGV4Y2hhbmdlIGhhcyBkaWZmZXJlbnQgZnVuZGluZ1xuICogY29pbiBjb25maXJtYXRpb24gcmVxdWlyZW1lbnRzLCB0aGUgQmFsYW5jZVdpZGdldCBkaXNwbGF5cyBhIG51bWJlciBvZiBzdGF0ZVxuICogaW5kaWNhdG9ycyBhbmQgYnV0dG9ucywgYXMgd2VsbCBhcyB0YWJ1bGF0ZWQgYmFsYW5jZSBkYXRhIHdpdGggcm93cyBmb3JcbiAqIGxvY2tlZCBhbmQgaW1tYXR1cmUgYmFsYW5jZS5cbiAqL1xuY2xhc3MgQmFsYW5jZVdpZGdldCB7XG4gIGJhc2U6IEJhbGFuY2VXaWRnZXRFbGVtZW50XG4gIHF1b3RlOiBCYWxhbmNlV2lkZ2V0RWxlbWVudFxuICAvLyBwYXJlbnRSb3c6IFBhZ2VFbGVtZW50XG4gIGRleDogRXhjaGFuZ2VcblxuICBjb25zdHJ1Y3RvciAoYmFzZTogSFRNTEVsZW1lbnQsIHF1b3RlOiBIVE1MRWxlbWVudCkge1xuICAgIERvYy5oaWRlKGJhc2UsIHF1b3RlKVxuICAgIGNvbnN0IGJ0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoYmFzZSlcbiAgICB0aGlzLmJhc2UgPSB7XG4gICAgICBpZDogMCxcbiAgICAgIHBhcmVudElEOiBwYXJlbnRJRE5vbmUsXG4gICAgICBjZmc6IG51bGwsXG4gICAgICBub2RlOiBiYXNlLFxuICAgICAgdG1wbDogYnRtcGwsXG4gICAgICBpY29uQm94OiBidG1wbC53YWxsZXRTdGF0ZSxcbiAgICAgIHN0YXRlSWNvbnM6IG5ldyBXYWxsZXRJY29ucyhidG1wbC53YWxsZXRTdGF0ZSlcbiAgICB9XG4gICAgYnRtcGwuYmFsYW5jZVJvd1RtcGwucmVtb3ZlKClcblxuICAgIGNvbnN0IHF0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocXVvdGUpXG4gICAgdGhpcy5xdW90ZSA9IHtcbiAgICAgIGlkOiAwLFxuICAgICAgcGFyZW50SUQ6IHBhcmVudElETm9uZSxcbiAgICAgIGNmZzogbnVsbCxcbiAgICAgIG5vZGU6IHF1b3RlLFxuICAgICAgdG1wbDogcXRtcGwsXG4gICAgICBpY29uQm94OiBxdG1wbC53YWxsZXRTdGF0ZSxcbiAgICAgIHN0YXRlSWNvbnM6IG5ldyBXYWxsZXRJY29ucyhxdG1wbC53YWxsZXRTdGF0ZSlcbiAgICB9XG4gICAgcXRtcGwuYmFsYW5jZVJvd1RtcGwucmVtb3ZlKClcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBiYWxhbmNlOiAobm90ZTogQmFsYW5jZU5vdGUpID0+IHsgdGhpcy51cGRhdGVBc3NldChub3RlLmFzc2V0SUQpIH0sXG4gICAgICB3YWxsZXRzdGF0ZTogKG5vdGU6IFdhbGxldFN0YXRlTm90ZSkgPT4geyB0aGlzLnVwZGF0ZUFzc2V0KG5vdGUud2FsbGV0LmFzc2V0SUQpIH0sXG4gICAgICB3YWxsZXRzeW5jOiAobm90ZTogV2FsbGV0U3luY05vdGUpID0+IHsgdGhpcy51cGRhdGVBc3NldChub3RlLmFzc2V0SUQpIH0sXG4gICAgICBjcmVhdGV3YWxsZXQ6IChub3RlOiBXYWxsZXRDcmVhdGlvbk5vdGUpID0+IHsgdGhpcy51cGRhdGVBc3NldChub3RlLmFzc2V0SUQpIH1cbiAgICB9KVxuICB9XG5cbiAgc2V0QmFsYW5jZVZpc2liaWxpdHkgKGNvbm5lY3RlZDogYm9vbGVhbikge1xuICAgIGlmIChjb25uZWN0ZWQpIERvYy5zaG93KHRoaXMuYmFzZS5ub2RlLCB0aGlzLnF1b3RlLm5vZGUpXG4gICAgZWxzZSBEb2MuaGlkZSh0aGlzLmJhc2Uubm9kZSwgdGhpcy5xdW90ZS5ub2RlKVxuICB9XG5cbiAgLypcbiAgICogc2V0V2FsbGV0IHNldHMgdGhlIGJhbGFuY2Ugd2lkZ2V0IHRvIGRpc3BsYXkgZGF0YSBmb3Igc3BlY2lmaWVkIG1hcmtldCBhbmRcbiAgICogd2lsbCBkaXNwbGF5IHRoZSB3aWRnZXQuXG4gICAqL1xuICBzZXRXYWxsZXRzIChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpIHtcbiAgICBjb25zdCBwYXJlbnRJRCA9IChhc3NldElEOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBpZiAoYXNzZXQ/LnRva2VuKSByZXR1cm4gYXNzZXQudG9rZW4ucGFyZW50SURcbiAgICAgIHJldHVybiBwYXJlbnRJRE5vbmVcbiAgICB9XG4gICAgdGhpcy5kZXggPSBhcHAoKS51c2VyLmV4Y2hhbmdlc1tob3N0XVxuICAgIHRoaXMuYmFzZS5pZCA9IGJhc2VJRFxuICAgIHRoaXMuYmFzZS5wYXJlbnRJRCA9IHBhcmVudElEKGJhc2VJRClcbiAgICB0aGlzLmJhc2UuY2ZnID0gdGhpcy5kZXguYXNzZXRzW2Jhc2VJRF1cbiAgICB0aGlzLnF1b3RlLmlkID0gcXVvdGVJRFxuICAgIHRoaXMucXVvdGUucGFyZW50SUQgPSBwYXJlbnRJRChxdW90ZUlEKVxuICAgIHRoaXMucXVvdGUuY2ZnID0gdGhpcy5kZXguYXNzZXRzW3F1b3RlSURdXG4gICAgdGhpcy51cGRhdGVXYWxsZXQodGhpcy5iYXNlKVxuICAgIHRoaXMudXBkYXRlV2FsbGV0KHRoaXMucXVvdGUpXG4gICAgdGhpcy5zZXRCYWxhbmNlVmlzaWJpbGl0eSh0aGlzLmRleC5jb25uZWN0aW9uU3RhdHVzID09PSBDb25uZWN0aW9uU3RhdHVzLkNvbm5lY3RlZClcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZVdhbGxldCB1cGRhdGVzIHRoZSBkaXNwbGF5ZWQgd2FsbGV0IGluZm9ybWF0aW9uIGJhc2VkIG9uIHRoZVxuICAgKiBjb3JlLldhbGxldCBzdGF0ZS5cbiAgICovXG4gIHVwZGF0ZVdhbGxldCAoc2lkZTogQmFsYW5jZVdpZGdldEVsZW1lbnQpIHtcbiAgICBjb25zdCB7IGNmZywgdG1wbCwgaWNvbkJveCwgc3RhdGVJY29ucywgaWQ6IGFzc2V0SUQgfSA9IHNpZGVcbiAgICBpZiAoIWNmZykgcmV0dXJuIC8vIG5vIHdhbGxldCBzZXQgeWV0XG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICAvLyBKdXN0IGhpZGUgZXZlcnl0aGluZyB0byBzdGFydC5cbiAgICBEb2MuaGlkZShcbiAgICAgIHRtcGwubmV3V2FsbGV0Um93LCB0bXBsLmV4cGlyZWQsIHRtcGwudW5zdXBwb3J0ZWQsIHRtcGwuY29ubmVjdCwgdG1wbC5zcGlubmVyLFxuICAgICAgdG1wbC53YWxsZXRTdGF0ZSwgdG1wbC5iYWxhbmNlUm93cywgdG1wbC53YWxsZXRBZGRyLCB0bXBsLndhbnRQcm92aWRlcnNCb3hcbiAgICApXG4gICAgdGhpcy5jaGVja05lZWRzUHJvdmlkZXIoYXNzZXRJRCwgdG1wbC53YW50UHJvdmlkZXJzQm94KVxuICAgIHRtcGwubG9nby5zcmMgPSBEb2MubG9nb1BhdGgoY2ZnLnN5bWJvbClcbiAgICB0bXBsLmFkZFdhbGxldFN5bWJvbC50ZXh0Q29udGVudCA9IGNmZy5zeW1ib2wudG9VcHBlckNhc2UoKVxuICAgIERvYy5lbXB0eSh0bXBsLnN5bWJvbClcblxuICAgIC8vIEhhbmRsZSBhbiB1bnN1cHBvcnRlZCBhc3NldC5cbiAgICBpZiAoIWFzc2V0KSB7XG4gICAgICBEb2Muc2hvdyh0bXBsLnVuc3VwcG9ydGVkKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRtcGwuc3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUoYXNzZXQsIHRydWUpKVxuICAgIERvYy5zaG93KGljb25Cb3gpXG4gICAgY29uc3Qgd2FsbGV0ID0gYXNzZXQud2FsbGV0XG4gICAgc3RhdGVJY29ucy5yZWFkV2FsbGV0KHdhbGxldClcbiAgICAvLyBIYW5kbGUgbm8gd2FsbGV0IGNvbmZpZ3VyZWQuXG4gICAgaWYgKCF3YWxsZXQpIHtcbiAgICAgIGlmIChhc3NldC53YWxsZXRDcmVhdGlvblBlbmRpbmcpIHtcbiAgICAgICAgRG9jLnNob3codG1wbC5zcGlubmVyKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIERvYy5zaG93KHRtcGwubmV3V2FsbGV0Um93KVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHRtcGwud2FsbGV0QWRkcilcbiAgICAvLyBQYXJlbnQgYXNzZXRcbiAgICBjb25zdCBiYWwgPSB3YWxsZXQuYmFsYW5jZVxuICAgIC8vIEhhbmRsZSBub3QgY29ubmVjdGVkIGFuZCBubyBiYWxhbmNlIGtub3duIGZvciB0aGUgREVYLlxuICAgIGlmICghYmFsICYmICF3YWxsZXQucnVubmluZyAmJiAhd2FsbGV0LmRpc2FibGVkKSB7XG4gICAgICBEb2Muc2hvdyh0bXBsLmNvbm5lY3QpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgLy8gSWYgdGhlcmUgaXMgbm8gYmFsYW5jZSwgYnV0IHRoZSB3YWxsZXQgaXMgY29ubmVjdGVkLCBzaG93IHRoZSBsb2FkaW5nXG4gICAgLy8gaWNvbiB3aGlsZSB3ZSBmZXRjaCBhbiB1cGRhdGUuXG4gICAgaWYgKCFiYWwpIHtcbiAgICAgIGFwcCgpLmZldGNoQmFsYW5jZShhc3NldElEKVxuICAgICAgRG9jLnNob3codG1wbC5zcGlubmVyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gV2UgaGF2ZSBhIHdhbGxldCBhbmQgYSBERVgtc3BlY2lmaWMgYmFsYW5jZS4gU2V0IGFsbCBvZiB0aGUgZmllbGRzLlxuICAgIERvYy5zaG93KHRtcGwuYmFsYW5jZVJvd3MpXG4gICAgRG9jLmVtcHR5KHRtcGwuYmFsYW5jZVJvd3MpXG4gICAgY29uc3QgYWRkUm93ID0gKHRpdGxlOiBzdHJpbmcsIGJhbDogbnVtYmVyLCB1aTogVW5pdEluZm8sIGljb24/OiBQYWdlRWxlbWVudCkgPT4ge1xuICAgICAgY29uc3Qgcm93ID0gdG1wbC5iYWxhbmNlUm93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIHRtcGwuYmFsYW5jZVJvd3MuYXBwZW5kQ2hpbGQocm93KVxuICAgICAgY29uc3QgYmFsVG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIGJhbFRtcGwudGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZVxuICAgICAgYmFsVG1wbC5iYWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJhbCwgdWkpXG4gICAgICBpZiAoaWNvbikge1xuICAgICAgICBiYWxUbXBsLmJhbC5hcHBlbmQoaWNvbilcbiAgICAgICAgc2lkZS5wYXJlbnRCYWwgPSBiYWxUbXBsLmJhbFxuICAgICAgfVxuICAgIH1cbiAgICBhZGRSb3coaW50bC5wcmVwKGludGwuSURfQVZBSUxBQkxFKSwgYmFsLmF2YWlsYWJsZSwgYXNzZXQudW5pdEluZm8pXG4gICAgYWRkUm93KGludGwucHJlcChpbnRsLklEX0xPQ0tFRCksIGJhbC5sb2NrZWQgKyBiYWwuY29udHJhY3Rsb2NrZWQgKyBiYWwuYm9uZGxvY2tlZCwgYXNzZXQudW5pdEluZm8pXG4gICAgYWRkUm93KGludGwucHJlcChpbnRsLklEX0lNTUFUVVJFKSwgYmFsLmltbWF0dXJlLCBhc3NldC51bml0SW5mbylcbiAgICBpZiAoYXNzZXQudG9rZW4pIHtcbiAgICAgIGNvbnN0IHsgd2FsbGV0OiB7IGJhbGFuY2UgfSwgdW5pdEluZm8sIHN5bWJvbCB9ID0gYXBwKCkuYXNzZXRzW2Fzc2V0LnRva2VuLnBhcmVudElEXVxuICAgICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpXG4gICAgICBpY29uLnNyYyA9IERvYy5sb2dvUGF0aChzeW1ib2wpXG4gICAgICBpY29uLmNsYXNzTGlzdC5hZGQoJ21pY3JvLWljb24nLCAnbXMtMScpXG4gICAgICBhZGRSb3coaW50bC5wcmVwKGludGwuSURfRkVFX0JBTEFOQ0UpLCBiYWxhbmNlLmF2YWlsYWJsZSwgdW5pdEluZm8sIGljb24pXG4gICAgfVxuXG4gICAgLy8gSWYgdGhlIGN1cnJlbnQgYmFsYW5jZSB1cGRhdGUgdGltZSBpcyBvbGRlciB0aGFuIGFuIGhvdXIsIHNob3cgdGhlXG4gICAgLy8gZXhwaXJhdGlvbiBpY29uLiBSZXF1ZXN0IGEgYmFsYW5jZSB1cGRhdGUsIGlmIHBvc3NpYmxlLlxuICAgIGNvbnN0IGV4cGlyZWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGJhbC5zdGFtcCkuZ2V0VGltZSgpID4gYW5Ib3VyXG4gICAgaWYgKGV4cGlyZWQgJiYgIXdhbGxldC5kaXNhYmxlZCkge1xuICAgICAgRG9jLnNob3codG1wbC5leHBpcmVkKVxuICAgICAgaWYgKHdhbGxldC5ydW5uaW5nKSBhcHAoKS5mZXRjaEJhbGFuY2UoYXNzZXRJRClcbiAgICB9IGVsc2UgRG9jLmhpZGUodG1wbC5leHBpcmVkKVxuICB9XG5cbiAgYXN5bmMgY2hlY2tOZWVkc1Byb3ZpZGVyIChhc3NldElEOiBudW1iZXIsIGVsOiBQYWdlRWxlbWVudCkge1xuICAgIERvYy5zZXRWaXMoYXdhaXQgYXBwKCkubmVlZHNDdXN0b21Qcm92aWRlcihhc3NldElEKSwgZWwpXG4gIH1cblxuICAvKiB1cGRhdGVQYXJlbnQgdXBkYXRlcyB0aGUgc2lkZSdzIHBhcmVudCBhc3NldCBiYWxhbmNlLiAqL1xuICB1cGRhdGVQYXJlbnQgKHNpZGU6IEJhbGFuY2VXaWRnZXRFbGVtZW50KSB7XG4gICAgY29uc3QgeyB3YWxsZXQ6IHsgYmFsYW5jZSB9LCB1bml0SW5mbyB9ID0gYXBwKCkuYXNzZXRzW3NpZGUucGFyZW50SURdXG4gICAgLy8gZmlyc3RDaGlsZCBpcyB0aGUgdGV4dCBub2RlIHNldCBiZWZvcmUgdGhlIGltZyBjaGlsZCBub2RlIGluIGFkZFJvdy5cbiAgICBpZiAoc2lkZS5wYXJlbnRCYWw/LmZpcnN0Q2hpbGQpIHNpZGUucGFyZW50QmFsLmZpcnN0Q2hpbGQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGJhbGFuY2UuYXZhaWxhYmxlLCB1bml0SW5mbylcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZUFzc2V0IHVwZGF0ZXMgdGhlIGluZm8gZm9yIG9uZSBzaWRlIG9mIHRoZSBleGlzdGluZyBtYXJrZXQuIElmIHRoZVxuICAgKiBzcGVjaWZpZWQgYXNzZXQgSUQgaXMgbm90IG9uZSBvZiB0aGUgY3VycmVudCBtYXJrZXQncyBiYXNlIG9yIHF1b3RlIGFzc2V0cyxcbiAgICogaXQgaXMgc2lsZW50bHkgaWdub3JlZC5cbiAgICovXG4gIHVwZGF0ZUFzc2V0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBpZiAoYXNzZXRJRCA9PT0gdGhpcy5iYXNlLmlkKSB0aGlzLnVwZGF0ZVdhbGxldCh0aGlzLmJhc2UpXG4gICAgZWxzZSBpZiAoYXNzZXRJRCA9PT0gdGhpcy5xdW90ZS5pZCkgdGhpcy51cGRhdGVXYWxsZXQodGhpcy5xdW90ZSlcbiAgICBpZiAoYXNzZXRJRCA9PT0gdGhpcy5iYXNlLnBhcmVudElEKSB0aGlzLnVwZGF0ZVBhcmVudCh0aGlzLmJhc2UpXG4gICAgaWYgKGFzc2V0SUQgPT09IHRoaXMucXVvdGUucGFyZW50SUQpIHRoaXMudXBkYXRlUGFyZW50KHRoaXMucXVvdGUpXG4gIH1cbn1cblxuLyogbWFrZU1hcmtldCBjcmVhdGVzIGEgbWFya2V0IG9iamVjdCB0aGF0IHNwZWNpZmllcyBiYXNpYyBtYXJrZXQgZGV0YWlscy4gKi9cbmZ1bmN0aW9uIG1ha2VNYXJrZXQgKGhvc3Q6IHN0cmluZywgYmFzZT86IG51bWJlciwgcXVvdGU/OiBudW1iZXIpIHtcbiAgcmV0dXJuIHtcbiAgICBob3N0OiBob3N0LFxuICAgIGJhc2U6IGJhc2UsXG4gICAgcXVvdGU6IHF1b3RlXG4gIH1cbn1cblxuLyogbWFya2V0SUQgY3JlYXRlcyBhIERFWC1jb21wYXRpYmxlIG1hcmtldCBuYW1lIGZyb20gdGhlIHRpY2tlciBzeW1ib2xzLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1hcmtldElEIChiOiBzdHJpbmcsIHE6IHN0cmluZykgeyByZXR1cm4gYCR7Yn1fJHtxfWAgfVxuXG4vKiBjb252ZXJ0VG9BdG9tcyBjb252ZXJ0cyB0aGUgZmxvYXQgc3RyaW5nIHRvIHRoZSBiYXNpYyB1bml0IG9mIGEgY29pbi4gKi9cbmZ1bmN0aW9uIGNvbnZlcnRUb0F0b21zIChzOiBzdHJpbmcsIGNvbnZlcnNpb25GYWN0b3I6IG51bWJlcikge1xuICBpZiAoIXMpIHJldHVybiAwXG4gIHJldHVybiBNYXRoLnJvdW5kKHBhcnNlRmxvYXQocykgKiBjb252ZXJzaW9uRmFjdG9yKVxufVxuXG4vKiBzd2FwQnR0bnMgY2hhbmdlcyB0aGUgJ3NlbGVjdGVkJyBjbGFzcyBvZiB0aGUgYnV0dG9ucy4gKi9cbmZ1bmN0aW9uIHN3YXBCdHRucyAoYmVmb3JlOiBIVE1MRWxlbWVudCwgbm93OiBIVE1MRWxlbWVudCkge1xuICBiZWZvcmUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICBub3cuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxufVxuXG4vKlxuICogd2lyZU9yZGVyIHByZXBhcmVzIGEgY29weSBvZiB0aGUgb3JkZXIgd2l0aCB0aGUgb3B0aW9ucyBmaWVsZCBjb252ZXJ0ZWQgdG8gYVxuICogc3RyaW5nIC0+IHN0cmluZyBtYXAuXG4gKi9cbmZ1bmN0aW9uIHdpcmVPcmRlciAob3JkZXI6IFRyYWRlRm9ybSkge1xuICBjb25zdCBzdHJpbmd5T3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gIGZvciAoY29uc3QgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKG9yZGVyLm9wdGlvbnMpKSBzdHJpbmd5T3B0aW9uc1trXSA9IEpTT04uc3RyaW5naWZ5KHYpXG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBvcmRlciwgeyBvcHRpb25zOiBzdHJpbmd5T3B0aW9ucyB9KVxufVxuXG4vLyBPcmRlclRhYmxlUm93TWFuYWdlciBtYW5hZ2VzIHRoZSBkYXRhIHdpdGhpbiBhIHJvdyBpbiBhbiBvcmRlciB0YWJsZS4gRWFjaCByb3dcbi8vIHJlcHJlc2VudHMgYWxsIHRoZSBvcmRlcnMgaW4gdGhlIG9yZGVyIGJvb2sgd2l0aCB0aGUgc2FtZSByYXRlLCBidXQgb3JkZXJzIHRoYXRcbi8vIGFyZSBib29rZWQgb3Igc3RpbGwgaW4gdGhlIGVwb2NoIHF1ZXVlIGFyZSBkaXNwbGF5ZWQgaW4gc2VwYXJhdGUgcm93cy5cbmNsYXNzIE9yZGVyVGFibGVSb3dNYW5hZ2VyIHtcbiAgdGFibGVSb3c6IEhUTUxFbGVtZW50XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBvcmRlckJpbjogTWluaU9yZGVyW11cbiAgc2VsbDogYm9vbGVhblxuICBtc2dSYXRlOiBudW1iZXJcbiAgZXBvY2g6IGJvb2xlYW5cbiAgYmFzZVVuaXRJbmZvOiBVbml0SW5mb1xuXG4gIGNvbnN0cnVjdG9yICh0YWJsZVJvdzogSFRNTEVsZW1lbnQsIG9yZGVyQmluOiBNaW5pT3JkZXJbXSwgYmFzZVVuaXRJbmZvOiBVbml0SW5mbywgcXVvdGVVbml0SW5mbzogVW5pdEluZm8sIHJhdGVTdGVwOiBudW1iZXIpIHtcbiAgICB0aGlzLnRhYmxlUm93ID0gdGFibGVSb3dcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUodGFibGVSb3cpXG4gICAgdGhpcy5vcmRlckJpbiA9IG9yZGVyQmluXG4gICAgdGhpcy5zZWxsID0gb3JkZXJCaW5bMF0uc2VsbFxuICAgIHRoaXMubXNnUmF0ZSA9IG9yZGVyQmluWzBdLm1zZ1JhdGVcbiAgICB0aGlzLmVwb2NoID0gISFvcmRlckJpblswXS5lcG9jaFxuICAgIHRoaXMuYmFzZVVuaXRJbmZvID0gYmFzZVVuaXRJbmZvXG4gICAgY29uc3QgcmF0ZVRleHQgPSBEb2MuZm9ybWF0UmF0ZUZ1bGxQcmVjaXNpb24odGhpcy5tc2dSYXRlLCBiYXNlVW5pdEluZm8sIHF1b3RlVW5pdEluZm8sIHJhdGVTdGVwKVxuICAgIERvYy5zZXRWaXModGhpcy5pc0Vwb2NoKCksIHRoaXMucGFnZS5lcG9jaClcbiAgICBpZiAodGhpcy5tc2dSYXRlID09PSAwKSB7XG4gICAgICBwYWdlLnJhdGUuaW5uZXJUZXh0ID0gJ21hcmtldCdcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgY3NzQ2xhc3MgPSB0aGlzLmlzU2VsbCgpID8gJ3NlbGxjb2xvcicgOiAnYnV5Y29sb3InXG4gICAgICBwYWdlLnJhdGUuaW5uZXJUZXh0ID0gcmF0ZVRleHRcbiAgICAgIHBhZ2UucmF0ZS5jbGFzc0xpc3QuYWRkKGNzc0NsYXNzKVxuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVF0eU51bU9yZGVyc0VsKClcbiAgfVxuXG4gIC8vIHVwZGF0ZVF0eU51bU9yZGVyc0VsIHBvcHVsYXRlcyB0aGUgcXVhbnRpdHkgZWxlbWVudCBpbiB0aGUgcm93LCBhbmQgYWxzb1xuICAvLyBkaXNwbGF5cyB0aGUgbnVtYmVyIG9mIG9yZGVycyBpZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIG9yZGVyIGluIHRoZSBvcmRlclxuICAvLyBiaW4uXG4gIHVwZGF0ZVF0eU51bU9yZGVyc0VsICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIG9yZGVyQmluIH0gPSB0aGlzXG4gICAgY29uc3QgcXR5ID0gb3JkZXJCaW4ucmVkdWNlKCh0b3RhbCwgY3VycikgPT4gdG90YWwgKyBjdXJyLnF0eUF0b21pYywgMClcbiAgICBjb25zdCBudW1PcmRlcnMgPSBvcmRlckJpbi5sZW5ndGhcbiAgICBwYWdlLnF0eS5pbm5lclRleHQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihxdHksIHRoaXMuYmFzZVVuaXRJbmZvKVxuICAgIGlmIChudW1PcmRlcnMgPiAxKSB7XG4gICAgICBwYWdlLm51bU9yZGVycy5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpXG4gICAgICBwYWdlLm51bU9yZGVycy5pbm5lclRleHQgPSBTdHJpbmcobnVtT3JkZXJzKVxuICAgICAgcGFnZS5udW1PcmRlcnMudGl0bGUgPSBgcXVhbnRpdHkgaXMgY29tcHJpc2VkIG9mICR7bnVtT3JkZXJzfSBvcmRlcnNgXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2UubnVtT3JkZXJzLnNldEF0dHJpYnV0ZSgnaGlkZGVuJywgJ3RydWUnKVxuICAgIH1cbiAgfVxuXG4gIC8vIGluc2VydE9yZGVyIGFkZHMgYW4gb3JkZXIgdG8gdGhlIG9yZGVyIGJpbiBhbmQgdXBkYXRlcyB0aGUgcm93IGVsZW1lbnRzXG4gIC8vIGFjY29yZGluZ2x5LlxuICBpbnNlcnRPcmRlciAob3JkZXI6IE1pbmlPcmRlcikge1xuICAgIHRoaXMub3JkZXJCaW4ucHVzaChvcmRlcilcbiAgICB0aGlzLnVwZGF0ZVF0eU51bU9yZGVyc0VsKClcbiAgfVxuXG4gIC8vIHVwZGF0ZU9yZGVyUXVhbnRpdHkgdXBkYXRlcyB0aGUgcXVhbnRpdHkgb2YgdGhlIG9yZGVyIGlkZW50aWZpZWQgYnkgYSB0b2tlbixcbiAgLy8gaWYgaXQgZXhpc3RzIGluIHRoZSByb3csIGFuZCB1cGRhdGVzIHRoZSByb3cgZWxlbWVudHMgYWNjb3JkaW5nbHkuIFRoZSBmdW5jdGlvblxuICAvLyByZXR1cm5zIHRydWUgaWYgdGhlIG9yZGVyIGlzIGluIHRoZSBiaW4sIGFuZCBmYWxzZSBvdGhlcndpc2UuXG4gIHVwZGF0ZU9yZGVyUXR5ICh1cGRhdGU6IFJlbWFpbmRlclVwZGF0ZSkge1xuICAgIGNvbnN0IHsgdG9rZW4sIHF0eSwgcXR5QXRvbWljIH0gPSB1cGRhdGVcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMub3JkZXJCaW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLm9yZGVyQmluW2ldLnRva2VuID09PSB0b2tlbikge1xuICAgICAgICB0aGlzLm9yZGVyQmluW2ldLnF0eSA9IHF0eVxuICAgICAgICB0aGlzLm9yZGVyQmluW2ldLnF0eUF0b21pYyA9IHF0eUF0b21pY1xuICAgICAgICB0aGlzLnVwZGF0ZVF0eU51bU9yZGVyc0VsKClcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICAvLyByZW1vdmVPcmRlciByZW1vdmVzIHRoZSBvcmRlciBpZGVudGlmaWVkIGJ5IHRoZSB0b2tlbiwgaWYgaXQgZXhpc3RzIGluIHRoZSByb3csXG4gIC8vIGFuZCB1cGRhdGVzIHRoZSByb3cgZWxlbWVudHMgYWNjb3JkaW5nbHkuIElmIHRoZSBvcmRlciBiaW4gaXMgZW1wdHksIHRoZSByb3cgaXNcbiAgLy8gcmVtb3ZlZCBmcm9tIHRoZSBzY3JlZW4uIFRoZSBmdW5jdGlvbiByZXR1cm5zIHRydWUgaWYgYW4gb3JkZXIgd2FzIHJlbW92ZWQsIGFuZFxuICAvLyBmYWxzZSBvdGhlcndpc2UuXG4gIHJlbW92ZU9yZGVyICh0b2tlbjogc3RyaW5nKSB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLm9yZGVyQmluLmZpbmRJbmRleChvcmRlciA9PiBvcmRlci50b2tlbiA9PT0gdG9rZW4pXG4gICAgaWYgKGluZGV4IDwgMCkgcmV0dXJuIGZhbHNlXG4gICAgdGhpcy5vcmRlckJpbi5zcGxpY2UoaW5kZXgsIDEpXG4gICAgaWYgKCF0aGlzLm9yZGVyQmluLmxlbmd0aCkgdGhpcy50YWJsZVJvdy5yZW1vdmUoKVxuICAgIGVsc2UgdGhpcy51cGRhdGVRdHlOdW1PcmRlcnNFbCgpXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIC8vIHJlbW92ZUVwb2NoT3JkZXJzIHJlbW92ZXMgYWxsIHRoZSBvcmRlcnMgZnJvbSB0aGUgcm93IHRoYXQgYXJlIG5vdCBpbiB0aGVcbiAgLy8gbmV3IGVwb2NoJ3MgZXBvY2ggcXVldWUgYW5kIHVwZGF0ZXMgdGhlIGVsZW1lbnRzIGFjY29yZGluZ2x5LlxuICByZW1vdmVFcG9jaE9yZGVycyAobmV3RXBvY2g/OiBudW1iZXIpIHtcbiAgICB0aGlzLm9yZGVyQmluID0gdGhpcy5vcmRlckJpbi5maWx0ZXIoKG9yZGVyKSA9PiB7XG4gICAgICByZXR1cm4gIShvcmRlci5lcG9jaCAmJiBvcmRlci5lcG9jaCAhPT0gbmV3RXBvY2gpXG4gICAgfSlcbiAgICBpZiAoIXRoaXMub3JkZXJCaW4ubGVuZ3RoKSB0aGlzLnRhYmxlUm93LnJlbW92ZSgpXG4gICAgZWxzZSB0aGlzLnVwZGF0ZVF0eU51bU9yZGVyc0VsKClcbiAgfVxuXG4gIC8vIGdldFJhdGUgcmV0dXJucyB0aGUgcmF0ZSBvZiB0aGUgb3JkZXJzIGluIHRoZSByb3cuXG4gIGdldFJhdGUgKCkge1xuICAgIHJldHVybiB0aGlzLm1zZ1JhdGVcbiAgfVxuXG4gIC8vIGlzRXBvY2ggcmV0dXJucyB3aGV0aGVyIHRoZSBvcmRlcnMgaW4gdGhpcyByb3cgYXJlIGluIHRoZSBlcG9jaCBxdWV1ZS5cbiAgaXNFcG9jaCAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZXBvY2hcbiAgfVxuXG4gIC8vIGlzU2VsbCByZXR1cm5zIHdoZXRoZXIgdGhlIG9yZGVycyBpbiB0aGlzIHJvdyBhcmUgc2VsbCBvcmRlcnMuXG4gIGlzU2VsbCAoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsbFxuICB9XG5cbiAgLy8gY29tcGFyZSB0YWtlcyBhbiBvcmRlciBhbmQgcmV0dXJucyAwIGlmIHRoZSBvcmRlciBiZWxvbmdzIGluIHRoaXMgcm93LFxuICAvLyAxIGlmIHRoZSBvcmRlciBzaG91bGQgZ28gYWZ0ZXIgdGhpcyByb3cgaW4gdGhlIHRhYmxlLCBhbmQgLTEgaWYgaXQgc2hvdWxkXG4gIC8vIGJlIGJlZm9yZSB0aGlzIHJvdyBpbiB0aGUgdGFibGUuIFNlbGwgb3JkZXJzIGFyZSBkaXNwbGF5ZWQgaW4gYXNjZW5kaW5nIG9yZGVyLFxuICAvLyBidXkgb3JkZXJzIGFyZSBkaXNwbGF5ZWQgaW4gZGVzY2VuZGluZyBvcmRlciwgYW5kIGVwb2NoIG9yZGVycyBhbHdheXMgY29tZVxuICAvLyBhZnRlciBib29rZWQgb3JkZXJzLlxuICBjb21wYXJlIChvcmRlcjogTWluaU9yZGVyKSB7XG4gICAgaWYgKHRoaXMuZ2V0UmF0ZSgpID09PSBvcmRlci5tc2dSYXRlICYmIHRoaXMuaXNFcG9jaCgpID09PSAhIW9yZGVyLmVwb2NoKSB7XG4gICAgICByZXR1cm4gMFxuICAgIH0gZWxzZSBpZiAodGhpcy5nZXRSYXRlKCkgIT09IG9yZGVyLm1zZ1JhdGUpIHtcbiAgICAgIHJldHVybiAodGhpcy5nZXRSYXRlKCkgPiBvcmRlci5tc2dSYXRlKSA9PT0gb3JkZXIuc2VsbCA/IDEgOiAtMVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5pc0Vwb2NoKCkgPyAxIDogLTFcbiAgICB9XG4gIH1cbn1cblxuaW50ZXJmYWNlIEV4Y2hhbmdlTWFya2V0IGV4dGVuZHMgTWFya2V0IHtcbiAgeGM6IEV4Y2hhbmdlXG4gIGJhc2VOYW1lOiBzdHJpbmdcbiAgYnVpOiBVbml0SW5mb1xufVxuXG5mdW5jdGlvbiBzb3J0ZWRNYXJrZXRzICgpOiBFeGNoYW5nZU1hcmtldFtdIHtcbiAgY29uc3QgbWt0czogRXhjaGFuZ2VNYXJrZXRbXSA9IFtdXG4gIGNvbnN0IGFzc2V0cyA9IGFwcCgpLmFzc2V0c1xuICBjb25zdCBjb252ZXJ0TWFya2V0cyA9ICh4YzogRXhjaGFuZ2UsIG1rdHM6IE1hcmtldFtdKSA9PiB7XG4gICAgcmV0dXJuIG1rdHMubWFwKChta3Q6IE1hcmtldCkgPT4ge1xuICAgICAgY29uc3QgYSA9IGFzc2V0c1tta3QuYmFzZWlkXVxuICAgICAgY29uc3QgYmFzZU5hbWUgPSBhID8gYS5uYW1lIDogbWt0LmJhc2VzeW1ib2xcbiAgICAgIGNvbnN0IGJ1aSA9IGFwcCgpLnVuaXRJbmZvKG1rdC5iYXNlaWQsIHhjKVxuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oeyB4YywgYmFzZU5hbWUsIGJ1aSB9LCBta3QpXG4gICAgfSlcbiAgfVxuICBmb3IgKGNvbnN0IHhjIG9mIE9iamVjdC52YWx1ZXMoYXBwKCkuZXhjaGFuZ2VzKSkgbWt0cy5wdXNoKC4uLmNvbnZlcnRNYXJrZXRzKHhjLCBPYmplY3QudmFsdWVzKHhjLm1hcmtldHMgfHwge30pKSlcbiAgbWt0cy5zb3J0KChhOiBFeGNoYW5nZU1hcmtldCwgYjogRXhjaGFuZ2VNYXJrZXQpOiBudW1iZXIgPT4ge1xuICAgIGlmICghYS5zcG90KSB7XG4gICAgICBpZiAoYi5zcG90KSByZXR1cm4gMSAvLyBwdXQgYiBmaXJzdCwgc2luY2Ugd2UgaGF2ZSB0aGUgc3BvdFxuICAgICAgLy8gbm8gc3BvdHMuIGNvbXBhcmUgbWFya2V0IG5hbWUgdGhlbiBob3N0IG5hbWVcbiAgICAgIGlmIChhLm5hbWUgPT09IGIubmFtZSkgcmV0dXJuIGEueGMuaG9zdC5sb2NhbGVDb21wYXJlKGIueGMuaG9zdClcbiAgICAgIHJldHVybiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpXG4gICAgfSBlbHNlIGlmICghYi5zcG90KSByZXR1cm4gLTEgLy8gcHV0IGEgZmlyc3QsIHNpbmNlIHdlIGhhdmUgdGhlIHNwb3RcbiAgICBjb25zdCBbYUxvdHMsIGJMb3RzXSA9IFthLnNwb3Qudm9sMjQgLyBhLmxvdHNpemUsIGIuc3BvdC52b2wyNCAvIGIubG90c2l6ZV1cbiAgICByZXR1cm4gYkxvdHMgLSBhTG90cyAvLyB3aG9ldmVyIGhhcyBtb3JlIHZvbHVtZSBieSBsb3QgY291bnRcbiAgfSlcbiAgcmV0dXJuIG1rdHNcbn1cblxuZnVuY3Rpb24gc2V0UHJpY2VBbmRDaGFuZ2UgKHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PiwgeGM6IEV4Y2hhbmdlLCBta3Q6IE1hcmtldCkge1xuICBpZiAoIW1rdC5zcG90KSByZXR1cm5cbiAgdG1wbC5wcmljZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhhcHAoKS5jb252ZW50aW9uYWxSYXRlKG1rdC5iYXNlaWQsIG1rdC5xdW90ZWlkLCBta3Quc3BvdC5yYXRlLCB4YykpXG4gIGNvbnN0IHNpZ24gPSBta3Quc3BvdC5jaGFuZ2UyNCA+IDAgPyAnKycgOiAnJ1xuICB0bXBsLmNoYW5nZS5jbGFzc0xpc3QucmVtb3ZlKCdidXljb2xvcicsICdzZWxsY29sb3InKVxuICB0bXBsLmNoYW5nZS5jbGFzc0xpc3QuYWRkKG1rdC5zcG90LmNoYW5nZTI0ID49IDAgPyAnYnV5Y29sb3InIDogJ3NlbGxjb2xvcicpXG4gIHRtcGwuY2hhbmdlLnRleHRDb250ZW50ID0gYCR7c2lnbn0keyhta3Quc3BvdC5jaGFuZ2UyNCAqIDEwMCkudG9GaXhlZCgxKX0lYFxufVxuXG5jb25zdCBodWVzID0gWzEgLyAyLCAxIC8gNCwgMyAvIDQsIDEgLyA4LCA1IC8gOCwgMyAvIDgsIDcgLyA4XVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUh1ZSAoaWR4OiBudW1iZXIpOiBzdHJpbmcge1xuICBjb25zdCBoID0gaHVlc1tpZHggJSBodWVzLmxlbmd0aF1cbiAgcmV0dXJuIGBoc2woJHtoICogMzYwfSwgMzUlLCA1MCUpYFxufVxuXG5mdW5jdGlvbiBob3N0Q29sb3IgKGhvc3Q6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGhvc3RzID0gT2JqZWN0LmtleXMoYXBwKCkuZXhjaGFuZ2VzKVxuICBob3N0cy5zb3J0KClcbiAgcmV0dXJuIGdlbmVyYXRlSHVlKGhvc3RzLmluZGV4T2YoaG9zdCkpXG59XG4iLCJpbXBvcnQge1xuICBhcHAsXG4gIFBhZ2VFbGVtZW50LFxuICBNTUJvdFN0YXR1cyxcbiAgUnVuU3RhdHNOb3RlLFxuICBSdW5FdmVudE5vdGUsXG4gIEV4Y2hhbmdlQmFsYW5jZSxcbiAgU3RhcnRDb25maWcsXG4gIE9yZGVyUGxhY2VtZW50LFxuICBBdXRvUmViYWxhbmNlQ29uZmlnLFxuICBDRVhOb3RpZmljYXRpb25cbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7XG4gIE1NLFxuICBDRVhEaXNwbGF5SW5mbyxcbiAgQ0VYRGlzcGxheUluZm9zLFxuICBib3RUeXBlQmFzaWNBcmIsXG4gIGJvdFR5cGVBcmJNTSxcbiAgYm90VHlwZUJhc2ljTU0sXG4gIHNldE1hcmtldEVsZW1lbnRzLFxuICBzZXRDZXhFbGVtZW50cyxcbiAgUGxhY2VtZW50c0NoYXJ0LFxuICBCb3RNYXJrZXQsXG4gIGhvc3RlZE1hcmtldElELFxuICBSdW5uaW5nTWFya2V0TWFrZXJEaXNwbGF5XG59IGZyb20gJy4vbW11dGlsJ1xuaW1wb3J0IERvYywgeyBNaW5pU2xpZGVyIH0gZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCAqIGFzIE9yZGVyVXRpbCBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCB7IEZvcm1zLCBDRVhDb25maWd1cmF0aW9uRm9ybSB9IGZyb20gJy4vZm9ybXMnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7IFN0YXR1c0Jvb2tlZCB9IGZyb20gJy4vb3JkZXJ1dGlsJ1xuXG5jb25zdCBtZWRpdW1CcmVha3BvaW50ID0gNzY4XG5cbmludGVyZmFjZSBGdW5kaW5nU2xpZGVyIHtcbiAgbGVmdDoge1xuICAgIGNleDogbnVtYmVyXG4gICAgZGV4OiBudW1iZXJcbiAgfVxuICByaWdodDoge1xuICAgIGNleDogbnVtYmVyXG4gICAgZGV4OiBudW1iZXJcbiAgfVxuICBjZXhSYW5nZTogbnVtYmVyXG4gIGRleFJhbmdlOiBudW1iZXJcbn1cblxuY29uc3QgbmV3U2xpZGVyID0gKCkgPT4ge1xuICByZXR1cm4ge1xuICAgIGxlZnQ6IHtcbiAgICAgIGNleDogMCxcbiAgICAgIGRleDogMFxuICAgIH0sXG4gICAgcmlnaHQ6IHtcbiAgICAgIGNleDogMCxcbiAgICAgIGRleDogMFxuICAgIH0sXG4gICAgY2V4UmFuZ2U6IDAsXG4gICAgZGV4UmFuZ2U6IDBcbiAgfVxufVxuXG5pbnRlcmZhY2UgRnVuZGluZ1NvdXJjZSB7XG4gIGF2YWlsOiBudW1iZXJcbiAgcmVxOiBudW1iZXJcbiAgZnVuZGVkOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBGdW5kaW5nT3V0bG9vayB7XG4gIGRleDogRnVuZGluZ1NvdXJjZVxuICBjZXg6IEZ1bmRpbmdTb3VyY2VcbiAgdHJhbnNmZXJhYmxlOiBudW1iZXJcbiAgZmVlczoge1xuICAgIGF2YWlsOiBudW1iZXJcbiAgICByZXE6IG51bWJlclxuICAgIGZ1bmRlZDogYm9vbGVhblxuICB9LFxuICBmdW5kZWRBbmRCYWxhbmNlZDogYm9vbGVhblxuICBmdW5kZWRBbmROb3RCYWxhbmNlZDogYm9vbGVhblxufVxuXG5mdW5jdGlvbiBwYXJzZUZ1bmRpbmdPcHRpb25zIChmOiBGdW5kaW5nT3V0bG9vayk6IFtudW1iZXIsIG51bWJlciwgRnVuZGluZ1NsaWRlciB8IHVuZGVmaW5lZF0ge1xuICBjb25zdCB7IGNleDogeyBhdmFpbDogY2V4QXZhaWwsIHJlcTogY2V4UmVxIH0sIGRleDogeyBhdmFpbDogZGV4QXZhaWwsIHJlcTogZGV4UmVxIH0sIHRyYW5zZmVyYWJsZSB9ID0gZlxuXG4gIGxldCBwcm9wb3NlZERleCA9IE1hdGgubWluKGRleEF2YWlsLCBkZXhSZXEpXG4gIGxldCBwcm9wb3NlZENleCA9IE1hdGgubWluKGNleEF2YWlsLCBjZXhSZXEpXG4gIGxldCBzbGlkZXI6IEZ1bmRpbmdTbGlkZXIgfCB1bmRlZmluZWRcbiAgaWYgKGYuZnVuZGVkQW5kTm90QmFsYW5jZWQpIHtcbiAgICAvLyBXZSBoYXZlIGV2ZXJ5dGhpbmcgd2UgbmVlZCwgYnV0IG5vdCB3aGVyZSB3ZSBuZWVkIGl0LCBhbmQgd2UgY2FuXG4gICAgLy8gZGVwb3NpdCBhbmQgd2l0aGRyYXcuXG4gICAgaWYgKGRleEF2YWlsID4gZGV4UmVxKSB7XG4gICAgICAvLyBXZSBoYXZlIHRvbyBtdWNoIGRleC1zaWRlLCBzbyB3ZSdsbCBoYXZlIHRvIGRyYXcgb24gZGV4IHRvIGJhbGFuY2VcbiAgICAgIC8vIGNleCdzIHNob3J0Y29taW5ncy5cbiAgICAgIGNvbnN0IGNleFNob3J0ID0gY2V4UmVxIC0gY2V4QXZhaWxcbiAgICAgIGNvbnN0IGRleFJlbWFpbiA9IGRleEF2YWlsIC0gZGV4UmVxXG4gICAgICBpZiAoZGV4UmVtYWluIDwgY2V4U2hvcnQpIHtcbiAgICAgICAgLy8gV2UgZGlkIHNvbWV0aGluZyByZWFsbHkgYmFkIHdpdGggbWF0aCB0byBnZXQgaGVyZS5cbiAgICAgICAgdGhyb3cgRXJyb3IoJ2JhZCBtYXRoIGhhcyB1cyB3aXRoIGRleCBzdXJwbHVzICsgY2V4IHVuZGVyZnVuZCBpbnZhbGlkIHJlbWFpbnMnKVxuICAgICAgfVxuICAgICAgcHJvcG9zZWREZXggKz0gY2V4U2hvcnQgKyB0cmFuc2ZlcmFibGVcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gV2UgZG9uJ3QgaGF2ZSBlbm91Z2ggb24gZGV4LCBidXQgd2UgaGF2ZSBlbm91Z2ggb24gY2V4IHRvIGNvdmVyIHRoZVxuICAgICAgLy8gc2hvcnQuXG4gICAgICBjb25zdCBkZXhTaG9ydCA9IGRleFJlcSAtIGRleEF2YWlsXG4gICAgICBjb25zdCBjZXhSZW1haW4gPSBjZXhBdmFpbCAtIGNleFJlcVxuICAgICAgaWYgKGNleFJlbWFpbiA8IGRleFNob3J0KSB7XG4gICAgICAgIHRocm93IEVycm9yKCdiYWQgbWF0aCBnb3QgdXMgd2l0aCBjZXggc3VycGx1cyArIGRleCB1bmRlcmZ1bmQgaW52YWxpZCByZW1haW5zJylcbiAgICAgIH1cbiAgICAgIHByb3Bvc2VkQ2V4ICs9IGRleFNob3J0ICsgdHJhbnNmZXJhYmxlXG4gICAgfVxuICB9IGVsc2UgaWYgKGYuZnVuZGVkQW5kQmFsYW5jZWQpIHtcbiAgICAvLyBUaGlzIGFzc2V0IGlzIGZ1bGx5IGZ1bmRlZCwgYnV0IHRoZSB1c2VyIG1heSBjaG9vc2UgdG8gZnVuZCBvcmRlclxuICAgIC8vIHJlc2VydmVzIGVpdGhlciBjZXggb3IgZGV4LlxuICAgIGlmICh0cmFuc2ZlcmFibGUgPiAwKSB7XG4gICAgICBjb25zdCBkZXhSZW1haW4gPSBkZXhBdmFpbCAtIGRleFJlcVxuICAgICAgY29uc3QgY2V4UmVtYWluID0gY2V4QXZhaWwgLSBjZXhSZXFcblxuICAgICAgc2xpZGVyID0gbmV3U2xpZGVyKClcblxuICAgICAgaWYgKGNleFJlbWFpbiA+IHRyYW5zZmVyYWJsZSAmJiBkZXhSZW1haW4gPiB0cmFuc2ZlcmFibGUpIHtcbiAgICAgICAgLy8gRWl0aGVyIG9uZSBjb3VsZCBmdWxseSBmdW5kIG9yZGVyIHJlc2VydmVzLiBMZXQgdGhlIHVzZXIgY2hvb3NlLlxuICAgICAgICBzbGlkZXIubGVmdC5jZXggPSB0cmFuc2ZlcmFibGUgKyBjZXhSZXFcbiAgICAgICAgc2xpZGVyLmxlZnQuZGV4ID0gZGV4UmVxXG4gICAgICAgIHNsaWRlci5yaWdodC5jZXggPSBjZXhSZXFcbiAgICAgICAgc2xpZGVyLnJpZ2h0LmRleCA9IHRyYW5zZmVyYWJsZSArIGRleFJlcVxuICAgICAgfSBlbHNlIGlmIChkZXhSZW1haW4gPCB0cmFuc2ZlcmFibGUgJiYgY2V4UmVtYWluIDwgdHJhbnNmZXJhYmxlKSB7XG4gICAgICAgIC8vID0+IGltcGxpZWQgdGhhdCBjZXhSZW1haW4gKyBkZXhSZW1haW4gPiB0cmFuc2ZlcmFibGUuXG4gICAgICAgIC8vIENFWCBjYW4gY29udHJpYnV0ZSBTT01FIGFuZCBERVggY2FuIGNvbnRyaWJ1dGUgU09NRS5cbiAgICAgICAgc2xpZGVyLmxlZnQuY2V4ID0gdHJhbnNmZXJhYmxlIC0gZGV4UmVtYWluICsgY2V4UmVxXG4gICAgICAgIHNsaWRlci5sZWZ0LmRleCA9IGRleFJlbWFpbiArIGRleFJlcVxuICAgICAgICBzbGlkZXIucmlnaHQuY2V4ID0gY2V4UmVtYWluICsgY2V4UmVxXG4gICAgICAgIHNsaWRlci5yaWdodC5kZXggPSB0cmFuc2ZlcmFibGUgLSBjZXhSZW1haW4gKyBkZXhSZXFcbiAgICAgIH0gZWxzZSBpZiAoZGV4UmVtYWluID4gdHJhbnNmZXJhYmxlKSB7XG4gICAgICAgIC8vIFNvIERFWCBoYXMgZW5vdWdoIHRvIGNvdmVyIHJlc2VydmVzLCBidXQgQ0VYIGNvdWxkIHBvdGVudGlhbGx5XG4gICAgICAgIC8vIGNvbnN0cmlidXRlIFNPTUUuIE5PVCBBTEwuXG4gICAgICAgIHNsaWRlci5sZWZ0LmNleCA9IGNleFJlcVxuICAgICAgICBzbGlkZXIubGVmdC5kZXggPSB0cmFuc2ZlcmFibGUgKyBkZXhSZXFcbiAgICAgICAgc2xpZGVyLnJpZ2h0LmNleCA9IGNleFJlbWFpbiArIGNleFJlcVxuICAgICAgICBzbGlkZXIucmlnaHQuZGV4ID0gdHJhbnNmZXJhYmxlIC0gY2V4UmVtYWluICsgZGV4UmVxXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBDRVggaGFzIGVub3VnaCB0byBjb3ZlciByZXNlcnZlcywgYnV0IERFWCBjb3VsZCBjb250cmlidXRlIFNPTUUsXG4gICAgICAgIC8vIE5PVCBBTEwuXG4gICAgICAgIHNsaWRlci5sZWZ0LmNleCA9IHRyYW5zZmVyYWJsZSAtIGRleFJlbWFpbiArIGNleFJlcVxuICAgICAgICBzbGlkZXIubGVmdC5kZXggPSBkZXhSZW1haW4gKyBkZXhSZXFcbiAgICAgICAgc2xpZGVyLnJpZ2h0LmNleCA9IHRyYW5zZmVyYWJsZSArIGNleFJlcVxuICAgICAgICBzbGlkZXIucmlnaHQuZGV4ID0gZGV4UmVxXG4gICAgICB9XG4gICAgICAvLyBXZSBwcmVmZXIgdGhlIHNsaWRlciByaWdodCBpbiB0aGUgY2VudGVyLlxuICAgICAgc2xpZGVyLmNleFJhbmdlID0gc2xpZGVyLnJpZ2h0LmNleCAtIHNsaWRlci5sZWZ0LmNleFxuICAgICAgc2xpZGVyLmRleFJhbmdlID0gc2xpZGVyLnJpZ2h0LmRleCAtIHNsaWRlci5sZWZ0LmRleFxuICAgICAgcHJvcG9zZWREZXggPSBzbGlkZXIubGVmdC5kZXggKyAoc2xpZGVyLmRleFJhbmdlIC8gMilcbiAgICAgIHByb3Bvc2VkQ2V4ID0gc2xpZGVyLmxlZnQuY2V4ICsgKHNsaWRlci5jZXhSYW5nZSAvIDIpXG4gICAgfVxuICB9IGVsc2UgeyAvLyBzdGFydmVkXG4gICAgaWYgKGNleEF2YWlsIDwgY2V4UmVxKSB7XG4gICAgICBwcm9wb3NlZERleCA9IE1hdGgubWluKGRleEF2YWlsLCBkZXhSZXEgKyB0cmFuc2ZlcmFibGUgKyAoY2V4UmVxIC0gY2V4QXZhaWwpKVxuICAgIH0gZWxzZSBpZiAoZGV4QXZhaWwgPCBkZXhSZXEpIHtcbiAgICAgIHByb3Bvc2VkQ2V4ID0gTWF0aC5taW4oY2V4QXZhaWwsIGNleFJlcSArIHRyYW5zZmVyYWJsZSArIChkZXhSZXEgLSBkZXhBdmFpbCkpXG4gICAgfSBlbHNlIHsgLy8ganVzdCB0cmFuc2ZlcmFibGUgd2Fzbid0IGNvdmVyZWRcbiAgICAgIHByb3Bvc2VkRGV4ID0gTWF0aC5taW4oZGV4QXZhaWwsIGRleFJlcSArIHRyYW5zZmVyYWJsZSlcbiAgICAgIHByb3Bvc2VkQ2V4ID0gTWF0aC5taW4oY2V4QXZhaWwsIGRleFJlcSArIGNleFJlcSArIHRyYW5zZmVyYWJsZSAtIHByb3Bvc2VkRGV4KVxuICAgIH1cbiAgfVxuICByZXR1cm4gW3Byb3Bvc2VkRGV4LCBwcm9wb3NlZENleCwgc2xpZGVyXVxufVxuXG5pbnRlcmZhY2UgQ0VYUm93IHtcbiAgY2V4TmFtZTogc3RyaW5nXG4gIHRyOiBQYWdlRWxlbWVudFxuICB0bXBsOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgZGluZm86IENFWERpc3BsYXlJbmZvXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcmtldE1ha2VyUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGZvcm1zOiBGb3Jtc1xuICBjdXJyZW50Rm9ybTogSFRNTEVsZW1lbnRcbiAga2V5dXA6IChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG4gIGNleENvbmZpZ0Zvcm06IENFWENvbmZpZ3VyYXRpb25Gb3JtXG4gIGJvdHM6IFJlY29yZDxzdHJpbmcsIEJvdD5cbiAgc29ydGVkQm90czogQm90W11cbiAgY2V4ZXM6IFJlY29yZDxzdHJpbmcsIENFWFJvdz5cbiAgdHdvQ29sdW1uOiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuXG4gICAgdGhpcy5ib3RzID0ge31cbiAgICB0aGlzLnNvcnRlZEJvdHMgPSBbXVxuICAgIHRoaXMuY2V4ZXMgPSB7fVxuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKG1haW4pXG5cbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXMocGFnZS5ib3RUbXBsLCBwYWdlLmJvdFJvd1RtcGwsIHBhZ2UuZXhjaGFuZ2VSb3dUbXBsKVxuXG4gICAgdGhpcy5mb3JtcyA9IG5ldyBGb3JtcyhwYWdlLmZvcm1zKVxuICAgIHRoaXMuY2V4Q29uZmlnRm9ybSA9IG5ldyBDRVhDb25maWd1cmF0aW9uRm9ybShwYWdlLmNleENvbmZpZ0Zvcm0sIChjZXhOYW1lOiBzdHJpbmcpID0+IHRoaXMuY2V4Q29uZmlndXJlZChjZXhOYW1lKSlcblxuICAgIERvYy5iaW5kKHBhZ2UubmV3Qm90LCAnY2xpY2snLCAoKSA9PiB7IHRoaXMubmV3Qm90KCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmFyY2hpdmVkTG9nc0J0biwgJ2NsaWNrJywgKCkgPT4geyBhcHAoKS5sb2FkUGFnZSgnbW1hcmNoaXZlcycpIH0pXG5cbiAgICB0aGlzLnR3b0NvbHVtbiA9IHdpbmRvdy5pbm5lcldpZHRoID49IG1lZGl1bUJyZWFrcG9pbnRcbiAgICBjb25zdCBybyA9IG5ldyBSZXNpemVPYnNlcnZlcigoKSA9PiB7IHRoaXMucmVzaXplZCgpIH0pXG4gICAgcm8ub2JzZXJ2ZShtYWluKVxuXG4gICAgZm9yIChjb25zdCBbY2V4TmFtZSwgZGluZm9dIG9mIE9iamVjdC5lbnRyaWVzKENFWERpc3BsYXlJbmZvcykpIHtcbiAgICAgIGNvbnN0IHRyID0gcGFnZS5leGNoYW5nZVJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLmNleFJvd3MuYXBwZW5kQ2hpbGQodHIpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodHIpXG4gICAgICBjb25zdCBjb25maWd1cmUgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2V4Q29uZmlnRm9ybS5zZXRDRVgoY2V4TmFtZSlcbiAgICAgICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UuY2V4Q29uZmlnRm9ybSlcbiAgICAgIH1cbiAgICAgIERvYy5iaW5kKHRtcGwuY29uZmlndXJlQnR0biwgJ2NsaWNrJywgY29uZmlndXJlKVxuICAgICAgRG9jLmJpbmQodG1wbC5yZWNvbmZpZ0J0dG4sICdjbGljaycsIGNvbmZpZ3VyZSlcbiAgICAgIERvYy5iaW5kKHRtcGwuZXJyQ29uZmlndXJlQnR0biwgJ2NsaWNrJywgY29uZmlndXJlKVxuICAgICAgY29uc3Qgcm93ID0gdGhpcy5jZXhlc1tjZXhOYW1lXSA9IHsgdHIsIHRtcGwsIGRpbmZvLCBjZXhOYW1lIH1cbiAgICAgIHRoaXMudXBkYXRlQ2V4Um93KHJvdylcbiAgICB9XG5cbiAgICB0aGlzLnNldHVwKClcbiAgfVxuXG4gIHJlc2l6ZWQgKCkge1xuICAgIGNvbnN0IHVzZVR3b0NvbHVtbiA9IHdpbmRvdy5pbm5lcldpZHRoID49IDc2OFxuICAgIGlmICh1c2VUd29Db2x1bW4gIT09IHRoaXMudHdvQ29sdW1uKSB7XG4gICAgICB0aGlzLnR3b0NvbHVtbiA9IHVzZVR3b0NvbHVtblxuICAgICAgdGhpcy5jbGVhckJvdEJveGVzKClcbiAgICAgIGZvciAoY29uc3QgeyBkaXYgfSBvZiB0aGlzLnNvcnRlZEJvdHMpIHRoaXMuYXBwZW5kQm90Qm94KGRpdilcbiAgICB9XG4gIH1cblxuICBhc3luYyBzZXR1cCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IG1tU3RhdHVzID0gYXBwKCkubW1TdGF0dXNcblxuICAgIGNvbnN0IGJvdENvbmZpZ3MgPSBtbVN0YXR1cy5ib3RzLm1hcCgoczogTU1Cb3RTdGF0dXMpID0+IHMuY29uZmlnKVxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBydW5zdGF0czogKG5vdGU6IFJ1blN0YXRzTm90ZSkgPT4geyB0aGlzLmhhbmRsZVJ1blN0YXRzTm90ZShub3RlKSB9LFxuICAgICAgcnVuZXZlbnQ6IChub3RlOiBSdW5FdmVudE5vdGUpID0+IHtcbiAgICAgICAgY29uc3QgYm90ID0gdGhpcy5ib3RzW2hvc3RlZE1hcmtldElEKG5vdGUuaG9zdCwgbm90ZS5iYXNlSUQsIG5vdGUucXVvdGVJRCldXG4gICAgICAgIGlmIChib3QpIHJldHVybiBib3QuaGFuZGxlUnVuU3RhdHMoKVxuICAgICAgfSxcbiAgICAgIGNleG5vdGU6IChub3RlOiBDRVhOb3RpZmljYXRpb24pID0+IHsgdGhpcy5oYW5kbGVDRVhOb3RlKG5vdGUpIH1cbiAgICAgIC8vIFRPRE8gYm90IHN0YXJ0LXN0b3Agbm90aWZpY2F0aW9uXG4gICAgfSlcblxuICAgIGNvbnN0IG5vQm90cyA9ICFib3RDb25maWdzIHx8IGJvdENvbmZpZ3MubGVuZ3RoID09PSAwXG4gICAgRG9jLnNldFZpcyhub0JvdHMsIHBhZ2Uubm9Cb3RzKVxuICAgIGlmIChub0JvdHMpIHJldHVyblxuICAgIHBhZ2Uubm9Cb3RzLnJlbW92ZSgpXG5cbiAgICBjb25zdCBzb3J0ZWRCb3RzID0gWy4uLm1tU3RhdHVzLmJvdHNdLnNvcnQoKGE6IE1NQm90U3RhdHVzLCBiOiBNTUJvdFN0YXR1cykgPT4ge1xuICAgICAgaWYgKGEucnVubmluZyAmJiAhYi5ydW5uaW5nKSByZXR1cm4gLTFcbiAgICAgIGlmIChiLnJ1bm5pbmcgJiYgIWEucnVubmluZykgcmV0dXJuIDFcbiAgICAgIC8vIElmIG5vbmUgYXJlIHJ1bm5pbmcsIGp1c3QgZG8gc29tZXRoaW5nIHRvIGdldCBhIHJlc29uYWJseSByZXByb2R1Y2libGVcbiAgICAgIC8vIHNvcnQuXG4gICAgICBpZiAoIWEucnVubmluZyAmJiAhYi5ydW5uaW5nKSByZXR1cm4gKGEuY29uZmlnLmJhc2VJRCArIGEuY29uZmlnLnF1b3RlSUQpIC0gKGIuY29uZmlnLmJhc2VJRCArIGIuY29uZmlnLnF1b3RlSUQpXG4gICAgICAvLyBCb3RoIGFyZSBydW5uaW5nLiBTb3J0IGJ5IHJ1biB0aW1lLlxuICAgICAgcmV0dXJuIChiLnJ1blN0YXRzPy5zdGFydFRpbWUgPz8gMCkgLSAoYS5ydW5TdGF0cz8uc3RhcnRUaW1lID8/IDApXG4gICAgfSlcblxuICAgIGNvbnN0IHN0YXJ0dXBCYWxhbmNlQ2FjaGU6IFJlY29yZDxudW1iZXIsIFByb21pc2U8RXhjaGFuZ2VCYWxhbmNlPj4gPSB7fVxuXG4gICAgZm9yIChjb25zdCBib3RTdGF0dXMgb2Ygc29ydGVkQm90cykgdGhpcy5hZGRCb3QoYm90U3RhdHVzLCBzdGFydHVwQmFsYW5jZUNhY2hlKVxuICB9XG5cbiAgYXN5bmMgaGFuZGxlQ0VYTm90ZSAobjogQ0VYTm90aWZpY2F0aW9uKSB7XG4gICAgc3dpdGNoIChuLnRvcGljKSB7XG4gICAgICBjYXNlICdCYWxhbmNlVXBkYXRlJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlQ0VYQmFsYW5jZVVwZGF0ZShuLmNleE5hbWUgLyogLCBuLm5vdGUgKi8pXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaGFuZGxlQ0VYQmFsYW5jZVVwZGF0ZSAoY2V4TmFtZTogc3RyaW5nIC8qICwgbm90ZTogQ0VYQmFsYW5jZVVwZGF0ZSAqLykge1xuICAgIGNvbnN0IGNleFJvdyA9IHRoaXMuY2V4ZXNbY2V4TmFtZV1cbiAgICBpZiAoY2V4Um93KSB0aGlzLnVwZGF0ZUNleFJvdyhjZXhSb3cpXG4gIH1cblxuICBhc3luYyBoYW5kbGVSdW5TdGF0c05vdGUgKG5vdGU6IFJ1blN0YXRzTm90ZSkge1xuICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlELCBob3N0IH0gPSBub3RlXG4gICAgY29uc3QgYm90ID0gdGhpcy5ib3RzW2hvc3RlZE1hcmtldElEKGhvc3QsIGJhc2VJRCwgcXVvdGVJRCldXG4gICAgaWYgKGJvdCkgcmV0dXJuIGJvdC5oYW5kbGVSdW5TdGF0cygpXG4gICAgdGhpcy5hZGRCb3QoYXBwKCkuYm90U3RhdHVzKGhvc3QsIGJhc2VJRCwgcXVvdGVJRCkgYXMgTU1Cb3RTdGF0dXMpXG4gIH1cblxuICB1bmxvYWQgKCk6IHZvaWQge1xuICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdrZXl1cCcsIHRoaXMua2V5dXApXG4gIH1cblxuICBhZGRCb3QgKGJvdFN0YXR1czogTU1Cb3RTdGF0dXMsIHN0YXJ0dXBCYWxhbmNlQ2FjaGU/OiBSZWNvcmQ8bnVtYmVyLCBQcm9taXNlPEV4Y2hhbmdlQmFsYW5jZT4+KSB7XG4gICAgY29uc3QgeyBwYWdlLCBib3RzLCBzb3J0ZWRCb3RzIH0gPSB0aGlzXG4gICAgLy8gTWFrZSBzdXJlIHRoZSBtYXJrZXQgc3RpbGwgZXhpc3RzLlxuICAgIGNvbnN0IHsgY29uZmlnOiB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCB9IH0gPSBib3RTdGF0dXNcbiAgICBjb25zdCBbYmFzZVN5bWJvbCwgcXVvdGVTeW1ib2xdID0gW2FwcCgpLmFzc2V0c1tiYXNlSURdLnN5bWJvbCwgYXBwKCkuYXNzZXRzW3F1b3RlSURdLnN5bWJvbF1cbiAgICBjb25zdCBta3RJRCA9IGAke2Jhc2VTeW1ib2x9XyR7cXVvdGVTeW1ib2x9YFxuICAgIGlmICghYXBwKCkuZXhjaGFuZ2VzW2hvc3RdPy5tYXJrZXRzW21rdElEXSkgcmV0dXJuXG4gICAgY29uc3QgYm90ID0gbmV3IEJvdCh0aGlzLCBib3RTdGF0dXMsIHN0YXJ0dXBCYWxhbmNlQ2FjaGUpXG4gICAgcGFnZS5ib3RSb3dzLmFwcGVuZENoaWxkKGJvdC5yb3cudHIpXG4gICAgc29ydGVkQm90cy5wdXNoKGJvdClcbiAgICBib3RzW2JvdC5pZF0gPSBib3RcbiAgICB0aGlzLmFwcGVuZEJvdEJveChib3QuZGl2KVxuICB9XG5cbiAgYXBwZW5kQm90Qm94IChkaXY6IFBhZ2VFbGVtZW50KSB7XG4gICAgY29uc3QgeyBwYWdlOiB7IGJveFplcm8sIGJveE9uZSB9LCB0d29Db2x1bW4gfSA9IHRoaXNcbiAgICBjb25zdCB1c2VaZXJvdGggPSAhdHdvQ29sdW1uIHx8IChib3haZXJvLmNoaWxkcmVuLmxlbmd0aCArIGJveE9uZS5jaGlsZHJlbi5sZW5ndGgpICUgMiA9PT0gMFxuICAgIGNvbnN0IGJveCA9IHVzZVplcm90aCA/IGJveFplcm8gOiBib3hPbmVcbiAgICBib3guYXBwZW5kKGRpdilcbiAgfVxuXG4gIGNsZWFyQm90Qm94ZXMgKCkge1xuICAgIGNvbnN0IHsgcGFnZTogeyBib3hPbmUsIGJveFplcm8gfSB9ID0gdGhpc1xuICAgIHdoaWxlIChib3haZXJvLmNoaWxkcmVuLmxlbmd0aCA+IDEpIGJveFplcm8ucmVtb3ZlQ2hpbGQoYm94WmVyby5sYXN0Q2hpbGQgYXMgRWxlbWVudClcbiAgICB3aGlsZSAoYm94T25lLmNoaWxkcmVuLmxlbmd0aCA+IDApIGJveE9uZS5yZW1vdmVDaGlsZChib3hPbmUubGFzdENoaWxkIGFzIEVsZW1lbnQpXG4gIH1cblxuICBzaG93Qm90IChib3RJRDogc3RyaW5nKSB7XG4gICAgY29uc3QgeyBzb3J0ZWRCb3RzIH0gPSB0aGlzXG4gICAgY29uc3QgaWR4ID0gc29ydGVkQm90cy5maW5kSW5kZXgoKGJvdDogQm90KSA9PiBib3QuaWQgPT09IGJvdElEKVxuICAgIHNvcnRlZEJvdHMuc3BsaWNlKGlkeCwgMSlcbiAgICBzb3J0ZWRCb3RzLnVuc2hpZnQodGhpcy5ib3RzW2JvdElEXSlcbiAgICB0aGlzLmNsZWFyQm90Qm94ZXMoKVxuICAgIGZvciAoY29uc3QgeyBkaXYgfSBvZiBzb3J0ZWRCb3RzKSB0aGlzLmFwcGVuZEJvdEJveChkaXYpXG4gICAgY29uc3QgZGl2ID0gdGhpcy5ib3RzW2JvdElEXS5kaXZcbiAgICBEb2MuYW5pbWF0ZSgyNTAsIChwOiBudW1iZXIpID0+IHtcbiAgICAgIGRpdi5zdHlsZS5vcGFjaXR5ID0gYCR7cH1gXG4gICAgICBkaXYuc3R5bGUudHJhbnNmb3JtID0gYHNjYWxlKCR7MC44ICsgMC4yICogcH0pYFxuICAgIH0pXG4gIH1cblxuICBuZXdCb3QgKCkge1xuICAgIGFwcCgpLmxvYWRQYWdlKCdtbXNldHRpbmdzJylcbiAgfVxuXG4gIGFzeW5jIGNleENvbmZpZ3VyZWQgKGNleE5hbWU6IHN0cmluZykge1xuICAgIGF3YWl0IGFwcCgpLmZldGNoTU1TdGF0dXMoKVxuICAgIHRoaXMudXBkYXRlQ2V4Um93KHRoaXMuY2V4ZXNbY2V4TmFtZV0pXG4gICAgdGhpcy5mb3Jtcy5jbG9zZSgpXG4gIH1cblxuICB1cGRhdGVDZXhSb3cgKHJvdzogQ0VYUm93KSB7XG4gICAgY29uc3QgeyB0bXBsLCBkaW5mbywgY2V4TmFtZSB9ID0gcm93XG4gICAgdG1wbC5sb2dvLnNyYyA9IGRpbmZvLmxvZ29cbiAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBkaW5mby5uYW1lXG4gICAgY29uc3Qgc3RhdHVzID0gYXBwKCkubW1TdGF0dXMuY2V4ZXNbY2V4TmFtZV1cbiAgICBEb2Muc2V0VmlzKCFzdGF0dXMsIHRtcGwudW5jb25maWd1cmVkKVxuICAgIERvYy5zZXRWaXMoc3RhdHVzICYmICFzdGF0dXMuY29ubmVjdEVyciwgdG1wbC5jb25maWd1cmVkKVxuICAgIERvYy5zZXRWaXMoc3RhdHVzPy5jb25uZWN0RXJyLCB0bXBsLmNvbm5lY3RFcnJCb3gpXG4gICAgaWYgKHN0YXR1cz8uY29ubmVjdEVycikge1xuICAgICAgdG1wbC5jb25uZWN0RXJyLnRleHRDb250ZW50ID0gJ2Nvbm5lY3Rpb24gZXJyb3InXG4gICAgICB0bXBsLmNvbm5lY3RFcnIuZGF0YXNldC50b29sdGlwID0gc3RhdHVzLmNvbm5lY3RFcnJcbiAgICB9XG4gICAgdG1wbC5sb2dvLmNsYXNzTGlzdC50b2dnbGUoJ2dyZXlzY2FsZScsICFzdGF0dXMpXG4gICAgaWYgKCFzdGF0dXMpIHJldHVyblxuICAgIGxldCB1c2RCYWwgPSAwXG4gICAgY29uc3QgY2V4U3ltYm9sQWRkZWQgOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPiA9IHt9IC8vIGF2b2lkIGRvdWJsZSBjb3VudGluZyB0b2tlbnMgb3IgY291bnRpbmcgYm90aCBldGggYW5kIHdldGhcbiAgICBmb3IgKGNvbnN0IFthc3NldElEU3RyLCBiYWxdIG9mIE9iamVjdC5lbnRyaWVzKHN0YXR1cy5iYWxhbmNlcykpIHtcbiAgICAgIGNvbnN0IGFzc2V0SUQgPSBwYXJzZUludChhc3NldElEU3RyKVxuICAgICAgY29uc3QgY2V4U3ltYm9sID0gRG9jLmJpcENFWFN5bWJvbChhc3NldElEKVxuICAgICAgaWYgKGNleFN5bWJvbEFkZGVkW2NleFN5bWJvbF0pIGNvbnRpbnVlXG4gICAgICBjZXhTeW1ib2xBZGRlZFtjZXhTeW1ib2xdID0gdHJ1ZVxuICAgICAgY29uc3QgeyB1bml0SW5mbyB9ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBjb25zdCBmaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXVxuICAgICAgaWYgKGZpYXRSYXRlKSB1c2RCYWwgKz0gZmlhdFJhdGUgKiAoYmFsLmF2YWlsYWJsZSArIGJhbC5sb2NrZWQpIC8gdW5pdEluZm8uY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICB9XG4gICAgdG1wbC51c2RCYWxhbmNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHVzZEJhbClcbiAgfVxuXG4gIHBlcmNlbnRhZ2VCYWxhbmNlU3RyIChhc3NldElEOiBudW1iZXIsIGJhbGFuY2U6IG51bWJlciwgcGVyY2VudGFnZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHVuaXRJbmZvID0gYXNzZXQudW5pdEluZm9cbiAgICBjb25zdCBhc3NldFZhbHVlID0gRG9jLmZvcm1hdENvaW5WYWx1ZSgoYmFsYW5jZSAqIHBlcmNlbnRhZ2UpIC8gMTAwLCB1bml0SW5mbylcbiAgICByZXR1cm4gYCR7RG9jLmZvcm1hdEZvdXJTaWdGaWdzKHBlcmNlbnRhZ2UpfSUgLSAke2Fzc2V0VmFsdWV9ICR7YXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKCl9YFxuICB9XG5cbiAgLypcbiAgICogd2FsbGV0QmFsYW5jZVN0ciByZXR1cm5zIGEgc3RyaW5nIGxpa2UgXCI1MCUgLSAwLjAwMDEgQlRDXCIgcmVwcmVzZW50aW5nXG4gICAqIHRoZSBwZXJjZW50YWdlIG9mIGEgd2FsbGV0J3MgYmFsYW5jZSBzZWxlY3RlZCBpbiB0aGUgbWFya2V0IG1ha2VyIHNldHRpbmcsXG4gICAqIGFuZCB0aGUgYW1vdW50IG9mIHRoYXQgYXNzZXQgaW4gdGhlIHdhbGxldC5cbiAgICovXG4gIHdhbGxldEJhbGFuY2VTdHIgKGFzc2V0SUQ6IG51bWJlciwgcGVyY2VudGFnZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB7IHdhbGxldDogeyBiYWxhbmNlOiB7IGF2YWlsYWJsZSB9IH0gfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIHJldHVybiB0aGlzLnBlcmNlbnRhZ2VCYWxhbmNlU3RyKGFzc2V0SUQsIGF2YWlsYWJsZSwgcGVyY2VudGFnZSlcbiAgfVxufVxuXG5pbnRlcmZhY2UgQm90Um93IHtcbiAgdHI6IFBhZ2VFbGVtZW50XG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxufVxuXG5jbGFzcyBCb3QgZXh0ZW5kcyBCb3RNYXJrZXQge1xuICBwZzogTWFya2V0TWFrZXJQYWdlXG4gIGRpdjogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIHBsYWNlbWVudHNDaGFydDogUGxhY2VtZW50c0NoYXJ0XG4gIGJhc2VBbGxvY1NsaWRlcjogTWluaVNsaWRlclxuICBxdW90ZUFsbG9jU2xpZGVyOiBNaW5pU2xpZGVyXG4gIHJvdzogQm90Um93XG4gIHJ1bkRpc3BsYXk6IFJ1bm5pbmdNYXJrZXRNYWtlckRpc3BsYXlcblxuICBjb25zdHJ1Y3RvciAocGc6IE1hcmtldE1ha2VyUGFnZSwgc3RhdHVzOiBNTUJvdFN0YXR1cywgc3RhcnR1cEJhbGFuY2VDYWNoZT86IFJlY29yZDxudW1iZXIsIFByb21pc2U8RXhjaGFuZ2VCYWxhbmNlPj4pIHtcbiAgICBzdXBlcihzdGF0dXMuY29uZmlnKVxuICAgIHN0YXJ0dXBCYWxhbmNlQ2FjaGUgPSBzdGFydHVwQmFsYW5jZUNhY2hlID8/IHt9XG4gICAgdGhpcy5wZyA9IHBnXG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QsIGJvdFR5cGUsIG5CdXlQbGFjZW1lbnRzLCBuU2VsbFBsYWNlbWVudHMsIGNleE5hbWUgfSA9IHRoaXNcbiAgICB0aGlzLmlkID0gaG9zdGVkTWFya2V0SUQoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuXG4gICAgY29uc3QgZGl2ID0gdGhpcy5kaXYgPSBwZy5wYWdlLmJvdFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5wYXJzZVRlbXBsYXRlKGRpdilcblxuICAgIHRoaXMucnVuRGlzcGxheSA9IG5ldyBSdW5uaW5nTWFya2V0TWFrZXJEaXNwbGF5KHBhZ2Uub25Cb3gsICdtbScpXG5cbiAgICBzZXRNYXJrZXRFbGVtZW50cyhkaXYsIGJhc2VJRCwgcXVvdGVJRCwgaG9zdClcbiAgICBpZiAoY2V4TmFtZSkgc2V0Q2V4RWxlbWVudHMoZGl2LCBjZXhOYW1lKVxuXG4gICAgaWYgKGJvdFR5cGUgPT09IGJvdFR5cGVBcmJNTSkge1xuICAgICAgcGFnZS5ib3RUeXBlRGlzcGxheS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0JPVFRZUEVfQVJCX01NKVxuICAgIH0gZWxzZSBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICBwYWdlLmJvdFR5cGVEaXNwbGF5LnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQk9UVFlQRV9TSU1QTEVfQVJCKVxuICAgIH0gZWxzZSBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljTU0pIHtcbiAgICAgIHBhZ2UuYm90VHlwZURpc3BsYXkudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9CT1RUWVBFX0JBU0lDX01NKVxuICAgIH1cblxuICAgIERvYy5zZXRWaXMoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiLCBwYWdlLnBsYWNlbWVudHNDaGFydEJveCwgcGFnZS5iYXNlVG9rZW5Td2FwRmVlc0JveClcbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICB0aGlzLnBsYWNlbWVudHNDaGFydCA9IG5ldyBQbGFjZW1lbnRzQ2hhcnQocGFnZS5wbGFjZW1lbnRzQ2hhcnQpXG4gICAgICBwYWdlLmJ1eVBsYWNlbWVudENvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKG5CdXlQbGFjZW1lbnRzKVxuICAgICAgcGFnZS5zZWxsUGxhY2VtZW50Q291bnQudGV4dENvbnRlbnQgPSBTdHJpbmcoblNlbGxQbGFjZW1lbnRzKVxuICAgIH1cblxuICAgIERvYy5iaW5kKHBhZ2Uuc3RhcnRCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLnN0YXJ0KCkpXG4gICAgRG9jLmJpbmQocGFnZS5hbGxvY2F0aW9uQnR0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5hbGxvY2F0ZSgpKVxuICAgIERvYy5iaW5kKHBhZ2UucmVjb25maWd1cmVCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLnJlY29uZmlndXJlKCkpXG4gICAgRG9jLmJpbmQocGFnZS5nb0JhY2tGcm9tQWxsb2NhdGlvbiwgJ2NsaWNrJywgKCkgPT4gdGhpcy5oaWRlQWxsb2NhdGlvbkRpYWxvZygpKVxuICAgIERvYy5iaW5kKHBhZ2UubWFya2V0TGluaywgJ2NsaWNrJywgKCkgPT4gYXBwKCkubG9hZFBhZ2UoJ21hcmtldHMnLCB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCB9KSlcblxuICAgIHRoaXMuYmFzZUFsbG9jU2xpZGVyID0gbmV3IE1pbmlTbGlkZXIocGFnZS5iYXNlQWxsb2NTbGlkZXIsICgpID0+IHsgLyogY2FsbGJhY2sgc2V0IGxhdGVyICovIH0pXG4gICAgdGhpcy5xdW90ZUFsbG9jU2xpZGVyID0gbmV3IE1pbmlTbGlkZXIocGFnZS5xdW90ZUFsbG9jU2xpZGVyLCAoKSA9PiB7IC8qIGNhbGxiYWNrIHNldCBsYXRlciAqLyB9KVxuXG4gICAgY29uc3QgdHIgPSBwZy5wYWdlLmJvdFJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgc2V0TWFya2V0RWxlbWVudHModHIsIGJhc2VJRCwgcXVvdGVJRCwgaG9zdClcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUodHIpXG4gICAgdGhpcy5yb3cgPSB7IHRyLCB0bXBsIH1cbiAgICBEb2MuYmluZCh0bXBsLmFsbG9jYXRlQnR0biwgJ2NsaWNrJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIHRoaXMuYWxsb2NhdGUoKVxuICAgICAgcGcuc2hvd0JvdCh0aGlzLmlkKVxuICAgIH0pXG4gICAgRG9jLmJpbmQodHIsICdjbGljaycsICgpID0+IHBnLnNob3dCb3QodGhpcy5pZCkpXG5cbiAgICB0aGlzLmluaXRpYWxpemUoc3RhcnR1cEJhbGFuY2VDYWNoZSlcbiAgfVxuXG4gIGFzeW5jIGluaXRpYWxpemUgKHN0YXJ0dXBCYWxhbmNlQ2FjaGU6IFJlY29yZDxudW1iZXIsIFByb21pc2U8RXhjaGFuZ2VCYWxhbmNlPj4pIHtcbiAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHN0YXJ0dXBCYWxhbmNlQ2FjaGUpXG4gICAgdGhpcy5ydW5EaXNwbGF5LnNldEJvdE1hcmtldCh0aGlzKVxuICAgIGNvbnN0IHtcbiAgICAgIHBhZ2UsIGhvc3QsIGNleE5hbWUsIGJvdFR5cGUsIGRpdixcbiAgICAgIGNmZzogeyBhcmJNYXJrZXRNYWtpbmdDb25maWcsIGJhc2ljTWFya2V0TWFraW5nQ29uZmlnIH0sIG1rdElELFxuICAgICAgYmFzZUZhY3RvciwgcXVvdGVGYWN0b3IsIG1hcmtldFJlcG9ydDogeyBiYXNlRmlhdFJhdGUgfVxuICAgIH0gPSB0aGlzXG5cbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICBsZXQgYnV5UGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXSA9IFtdXG4gICAgICBsZXQgc2VsbFBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W10gPSBbXVxuICAgICAgbGV0IHByb2ZpdCA9IDBcbiAgICAgIGlmIChhcmJNYXJrZXRNYWtpbmdDb25maWcpIHtcbiAgICAgICAgYnV5UGxhY2VtZW50cyA9IGFyYk1hcmtldE1ha2luZ0NvbmZpZy5idXlQbGFjZW1lbnRzLm1hcCgocCkgPT4gKHsgbG90czogcC5sb3RzLCBnYXBGYWN0b3I6IHAubXVsdGlwbGllciB9KSlcbiAgICAgICAgc2VsbFBsYWNlbWVudHMgPSBhcmJNYXJrZXRNYWtpbmdDb25maWcuc2VsbFBsYWNlbWVudHMubWFwKChwKSA9PiAoeyBsb3RzOiBwLmxvdHMsIGdhcEZhY3RvcjogcC5tdWx0aXBsaWVyIH0pKVxuICAgICAgICBwcm9maXQgPSBhcmJNYXJrZXRNYWtpbmdDb25maWcucHJvZml0XG4gICAgICB9IGVsc2UgaWYgKGJhc2ljTWFya2V0TWFraW5nQ29uZmlnKSB7XG4gICAgICAgIGJ1eVBsYWNlbWVudHMgPSBiYXNpY01hcmtldE1ha2luZ0NvbmZpZy5idXlQbGFjZW1lbnRzXG4gICAgICAgIHNlbGxQbGFjZW1lbnRzID0gYmFzaWNNYXJrZXRNYWtpbmdDb25maWcuc2VsbFBsYWNlbWVudHNcbiAgICAgICAgbGV0IGJlc3RCdXk6IE9yZGVyUGxhY2VtZW50IHwgdW5kZWZpbmVkXG4gICAgICAgIGxldCBiZXN0U2VsbCA6IE9yZGVyUGxhY2VtZW50IHwgdW5kZWZpbmVkXG4gICAgICAgIGlmIChidXlQbGFjZW1lbnRzLmxlbmd0aCA+IDApIGJlc3RCdXkgPSBidXlQbGFjZW1lbnRzLnJlZHVjZSgocHJldjogT3JkZXJQbGFjZW1lbnQsIGN1cnI6IE9yZGVyUGxhY2VtZW50KSA9PiBjdXJyLmdhcEZhY3RvciA8IHByZXYuZ2FwRmFjdG9yID8gY3VyciA6IHByZXYpXG4gICAgICAgIGlmIChzZWxsUGxhY2VtZW50cy5sZW5ndGggPiAwKSBiZXN0U2VsbCA9IHNlbGxQbGFjZW1lbnRzLnJlZHVjZSgocHJldjogT3JkZXJQbGFjZW1lbnQsIGN1cnI6IE9yZGVyUGxhY2VtZW50KSA9PiBjdXJyLmdhcEZhY3RvciA8IHByZXYuZ2FwRmFjdG9yID8gY3VyciA6IHByZXYpXG4gICAgICAgIGlmIChiZXN0QnV5ICYmIGJlc3RTZWxsKSB7XG4gICAgICAgICAgcHJvZml0ID0gKGJlc3RCdXkuZ2FwRmFjdG9yICsgYmVzdFNlbGwuZ2FwRmFjdG9yKSAvIDJcbiAgICAgICAgfSBlbHNlIGlmIChiZXN0QnV5KSB7XG4gICAgICAgICAgcHJvZml0ID0gYmVzdEJ1eS5nYXBGYWN0b3JcbiAgICAgICAgfSBlbHNlIGlmIChiZXN0U2VsbCkge1xuICAgICAgICAgIHByb2ZpdCA9IGJlc3RTZWxsLmdhcEZhY3RvclxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBtYXJrZXRDb25maWcgPSB7IGNleE5hbWU6IGNleE5hbWUgYXMgc3RyaW5nLCBib3RUeXBlLCBiYXNlRmlhdFJhdGU6IGJhc2VGaWF0UmF0ZSwgZGljdDogeyBwcm9maXQsIGJ1eVBsYWNlbWVudHMsIHNlbGxQbGFjZW1lbnRzIH0gfVxuICAgICAgdGhpcy5wbGFjZW1lbnRzQ2hhcnQuc2V0TWFya2V0KG1hcmtldENvbmZpZylcbiAgICB9XG5cbiAgICBEb2Muc2V0VmlzKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NLCBwYWdlLmNleERhdGFCb3gpXG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NKSB7XG4gICAgICBjb25zdCBjZXggPSBhcHAoKS5tbVN0YXR1cy5jZXhlc1tjZXhOYW1lXVxuICAgICAgaWYgKGNleCkge1xuICAgICAgICBjb25zdCBta3QgPSBjZXgubWFya2V0cyA/IGNleC5tYXJrZXRzW21rdElEXSA6IHVuZGVmaW5lZFxuICAgICAgICBEb2Muc2V0VmlzKG1rdD8uZGF5LCBwYWdlLmNleERhdGFCb3gpXG4gICAgICAgIGlmIChta3Q/LmRheSkge1xuICAgICAgICAgIGNvbnN0IGRheSA9IG1rdC5kYXlcbiAgICAgICAgICBwYWdlLmNleFByaWNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGRheS5sYXN0UHJpY2UpXG4gICAgICAgICAgcGFnZS5jZXhWb2wudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYmFzZUZpYXRSYXRlICogZGF5LnZvbClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBEb2Muc2V0VmlzKEJvb2xlYW4oY2V4TmFtZSksIC4uLkRvYy5hcHBseVNlbGVjdG9yKGRpdiwgJ1tkYXRhLWNleC1zaG93XScpKVxuXG4gICAgY29uc3QgeyBzcG90IH0gPSBhcHAoKS5leGNoYW5nZXNbaG9zdF0ubWFya2V0c1tta3RJRF1cbiAgICBpZiAoc3BvdCkge1xuICAgICAgRG9jLnNob3cocGFnZS5kZXhEYXRhQm94KVxuICAgICAgY29uc3QgYyA9IE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgLyBiYXNlRmFjdG9yICogcXVvdGVGYWN0b3JcbiAgICAgIHBhZ2UuZGV4UHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moc3BvdC5yYXRlIC8gYylcbiAgICAgIHBhZ2UuZGV4Vm9sLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHNwb3Qudm9sMjQgLyBiYXNlRmFjdG9yICogYmFzZUZpYXRSYXRlKVxuICAgIH1cblxuICAgIHRoaXMudXBkYXRlRGlzcGxheSgpXG4gICAgdGhpcy51cGRhdGVUYWJsZVJvdygpXG4gICAgRG9jLmhpZGUocGFnZS5sb2FkaW5nQmcpXG4gIH1cblxuICB1cGRhdGVUYWJsZVJvdyAoKSB7XG4gICAgY29uc3QgeyByb3c6IHsgdG1wbCB9IH0gPSB0aGlzXG4gICAgY29uc3QgeyBydW5uaW5nLCBydW5TdGF0cyB9ID0gdGhpcy5zdGF0dXMoKVxuICAgIERvYy5zZXRWaXMocnVubmluZywgdG1wbC5wcm9maXRMb3NzQm94KVxuICAgIERvYy5zZXRWaXMoIXJ1bm5pbmcsIHRtcGwuYWxsb2NhdGVCdHRuQm94KVxuICAgIGlmIChydW5TdGF0cykge1xuICAgICAgdG1wbC5wcm9maXRMb3NzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHJ1blN0YXRzLnByb2ZpdExvc3MucHJvZml0LCAyKVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZURpc3BsYXkgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWFya2V0UmVwb3J0OiB7IGJhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSB9LCBiYXNlRmVlRmlhdFJhdGUsIHF1b3RlRmVlRmlhdFJhdGUgfSA9IHRoaXNcbiAgICBpZiAoW2Jhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSwgYmFzZUZlZUZpYXRSYXRlLCBxdW90ZUZlZUZpYXRSYXRlXS5zb21lKChyOiBudW1iZXIpID0+ICFyKSkge1xuICAgICAgRG9jLmhpZGUocGFnZS5vbkJveCwgcGFnZS5vZmZCb3gpXG4gICAgICBEb2Muc2hvdyhwYWdlLm5vRmlhdERpc3BsYXkpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgeyBydW5uaW5nIH0gPSB0aGlzLnN0YXR1cygpXG4gICAgRG9jLnNldFZpcyhydW5uaW5nLCBwYWdlLm9uQm94KVxuICAgIERvYy5zZXRWaXMoIXJ1bm5pbmcsIHBhZ2Uub2ZmQm94KVxuICAgIGlmIChydW5uaW5nKSB0aGlzLnVwZGF0ZVJ1bm5pbmdEaXNwbGF5KClcbiAgICBlbHNlIHRoaXMudXBkYXRlSWRsZURpc3BsYXkoKVxuICB9XG5cbiAgdXBkYXRlUnVubmluZ0Rpc3BsYXkgKCkge1xuICAgIHRoaXMucnVuRGlzcGxheS51cGRhdGUoKVxuICB9XG5cbiAgdXBkYXRlSWRsZURpc3BsYXkgKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHBhZ2UsIHByb2o6IHsgYWxsb2MsIHFQcm9qLCBiUHJvaiB9LCBiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUsIGJ1aSwgcXVpLCBiYXNlRmVlSUQsXG4gICAgICBxdW90ZUZlZUlELCBiYXNlRmFjdG9yLCBxdW90ZUZhY3RvciwgYmFzZUZlZUZhY3RvciwgcXVvdGVGZWVGYWN0b3IsXG4gICAgICBtYXJrZXRSZXBvcnQ6IHsgYmFzZUZpYXRSYXRlLCBxdW90ZUZpYXRSYXRlIH0sIGNmZzogeyB1aUNvbmZpZzogeyBiYXNlQ29uZmlnLCBxdW90ZUNvbmZpZyB9IH0sXG4gICAgICBxdW90ZUZlZVVJLCBiYXNlRmVlVUlcbiAgICB9ID0gdGhpc1xuICAgIHBhZ2UuYmFzZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oYWxsb2NbYmFzZUlEXSwgYnVpKVxuICAgIGNvbnN0IGJhc2VVU0QgPSBhbGxvY1tiYXNlSURdIC8gYmFzZUZhY3RvciAqIGJhc2VGaWF0UmF0ZVxuICAgIGxldCB0b3RhbFVTRCA9IGJhc2VVU0RcbiAgICBwYWdlLmJhc2VBbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhiYXNlVVNEKVxuICAgIHBhZ2UuYmFzZUJvb2tBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGJQcm9qLmJvb2sgKiBiYXNlRmFjdG9yLCBidWkpXG4gICAgcGFnZS5iYXNlT3JkZXJSZXNlcnZlc0FsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oYlByb2oub3JkZXJSZXNlcnZlcyAqIGJhc2VGYWN0b3IsIGJ1aSlcbiAgICBwYWdlLmJhc2VPcmRlclJlc2VydmVzUGN0LnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQoYmFzZUNvbmZpZy5vcmRlclJlc2VydmVzRmFjdG9yICogMTAwKSlcbiAgICBEb2Muc2V0VmlzKGNleE5hbWUsIHBhZ2UuYmFzZUNleEFsbG9jQm94KVxuICAgIGlmIChjZXhOYW1lKSBwYWdlLmJhc2VDZXhBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGJQcm9qLmNleCAqIGJhc2VGYWN0b3IsIGJ1aSlcbiAgICBEb2Muc2V0VmlzKGJhc2VGZWVJRCA9PT0gYmFzZUlELCBwYWdlLmJhc2VCb29raW5nRmVlc0FsbG9jQm94KVxuICAgIERvYy5zZXRWaXMoYmFzZUZlZUlEICE9PSBiYXNlSUQsIHBhZ2UuYmFzZVRva2VuRmVlc0FsbG9jQm94KVxuICAgIGlmIChiYXNlRmVlSUQgPT09IGJhc2VJRCkge1xuICAgICAgY29uc3QgYm9va2luZ0ZlZXMgPSBiYXNlSUQgPT09IHF1b3RlRmVlSUQgPyBiUHJvai5ib29raW5nRmVlcyArIHFQcm9qLmJvb2tpbmdGZWVzIDogYlByb2ouYm9va2luZ0ZlZXNcbiAgICAgIHBhZ2UuYmFzZUJvb2tpbmdGZWVzQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihib29raW5nRmVlcyAqIGJhc2VGZWVGYWN0b3IsIGJhc2VGZWVVSSlcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZmVlQWxsb2MgPSBhbGxvY1tiYXNlRmVlSURdXG4gICAgICBwYWdlLmJhc2VUb2tlbkZlZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oZmVlQWxsb2MsIGJhc2VGZWVVSSlcbiAgICAgIGNvbnN0IGJhc2VGZWVVU0QgPSBmZWVBbGxvYyAvIGJhc2VGZWVGYWN0b3IgKiBhcHAoKS5maWF0UmF0ZXNNYXBbYmFzZUZlZUlEXVxuICAgICAgdG90YWxVU0QgKz0gYmFzZUZlZVVTRFxuICAgICAgcGFnZS5iYXNlVG9rZW5BbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhiYXNlRmVlVVNEKVxuICAgICAgY29uc3Qgd2l0aFF1b3RlID0gYmFzZUZlZUlEID09PSBxdW90ZUZlZUlEXG4gICAgICBjb25zdCBib29raW5nRmVlcyA9IGJQcm9qLmJvb2tpbmdGZWVzICsgKHdpdGhRdW90ZSA/IHFQcm9qLmJvb2tpbmdGZWVzIDogMClcbiAgICAgIHBhZ2UuYmFzZVRva2VuQm9va2luZ0ZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihib29raW5nRmVlcyAqIGJhc2VGZWVGYWN0b3IsIGJhc2VGZWVVSSlcbiAgICAgIHBhZ2UuYmFzZVRva2VuU3dhcEZlZU4udGV4dENvbnRlbnQgPSBTdHJpbmcoYmFzZUNvbmZpZy5zd2FwRmVlTiArICh3aXRoUXVvdGUgPyBxdW90ZUNvbmZpZy5zd2FwRmVlTiA6IDApKVxuICAgICAgY29uc3Qgc3dhcFJlc2VydmVzID0gYlByb2ouc3dhcEZlZVJlc2VydmVzICsgKHdpdGhRdW90ZSA/IHFQcm9qLnN3YXBGZWVSZXNlcnZlcyA6IDApXG4gICAgICBwYWdlLmJhc2VUb2tlblN3YXBGZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oc3dhcFJlc2VydmVzICogYmFzZUZlZUZhY3RvciwgYmFzZUZlZVVJKVxuICAgIH1cblxuICAgIHBhZ2UucXVvdGVBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGFsbG9jW3F1b3RlSURdLCBxdWkpXG4gICAgY29uc3QgcXVvdGVVU0QgPSBhbGxvY1txdW90ZUlEXSAvIHF1b3RlRmFjdG9yICogcXVvdGVGaWF0UmF0ZVxuICAgIHRvdGFsVVNEICs9IHF1b3RlVVNEXG4gICAgcGFnZS5xdW90ZUFsbG9jVVNELnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHF1b3RlVVNEKVxuICAgIHBhZ2UucXVvdGVCb29rQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihxUHJvai5ib29rICogcXVvdGVGYWN0b3IsIHF1aSlcbiAgICBwYWdlLnF1b3RlT3JkZXJSZXNlcnZlc0FsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24ocVByb2oub3JkZXJSZXNlcnZlcyAqIHF1b3RlRmFjdG9yLCBxdWkpXG4gICAgcGFnZS5xdW90ZU9yZGVyUmVzZXJ2ZXNQY3QudGV4dENvbnRlbnQgPSBTdHJpbmcoTWF0aC5yb3VuZChxdW90ZUNvbmZpZy5vcmRlclJlc2VydmVzRmFjdG9yICogMTAwKSlcbiAgICBwYWdlLnF1b3RlU2xpcHBhZ2VBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHFQcm9qLnNsaXBwYWdlQnVmZmVyICogcXVvdGVGYWN0b3IsIHF1aSlcbiAgICBwYWdlLnNsaXBwYWdlQnVmZmVyRmFjdG9yLnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQocXVvdGVDb25maWcuc2xpcHBhZ2VCdWZmZXJGYWN0b3IgKiAxMDApKVxuICAgIERvYy5zZXRWaXMoY2V4TmFtZSwgcGFnZS5xdW90ZUNleEFsbG9jQm94KVxuICAgIGlmIChjZXhOYW1lKSBwYWdlLnF1b3RlQ2V4QWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihxUHJvai5jZXggKiBxdW90ZUZhY3RvciwgcXVpKVxuICAgIERvYy5zZXRWaXMocXVvdGVJRCA9PT0gcXVvdGVGZWVJRCwgcGFnZS5xdW90ZUJvb2tpbmdGZWVzQWxsb2NCb3gpXG4gICAgRG9jLnNldFZpcyhxdW90ZUZlZUlEICE9PSBxdW90ZUlEICYmIHF1b3RlRmVlSUQgIT09IGJhc2VGZWVJRCwgcGFnZS5xdW90ZVRva2VuRmVlc0FsbG9jQm94KVxuICAgIGlmIChxdW90ZUlEID09PSBxdW90ZUZlZUlEKSB7XG4gICAgICBjb25zdCBib29raW5nRmVlcyA9IHF1b3RlSUQgPT09IGJhc2VGZWVJRCA/IGJQcm9qLmJvb2tpbmdGZWVzICsgcVByb2ouYm9va2luZ0ZlZXMgOiBxUHJvai5ib29raW5nRmVlc1xuICAgICAgcGFnZS5xdW90ZUJvb2tpbmdGZWVzQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihib29raW5nRmVlcyAqIHF1b3RlRmVlRmFjdG9yLCBxdW90ZUZlZVVJKVxuICAgIH0gZWxzZSBpZiAocXVvdGVGZWVJRCAhPT0gYmFzZUZlZUlEKSB7XG4gICAgICBwYWdlLnF1b3RlVG9rZW5GZWVBbGxvYy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGFsbG9jW3F1b3RlRmVlSURdLCBxdW90ZUZlZVVJKVxuICAgICAgY29uc3QgcXVvdGVGZWVVU0QgPSBhbGxvY1txdW90ZUZlZUlEXSAvIHF1b3RlRmVlRmFjdG9yICogYXBwKCkuZmlhdFJhdGVzTWFwW3F1b3RlRmVlSURdXG4gICAgICB0b3RhbFVTRCArPSBxdW90ZUZlZVVTRFxuICAgICAgcGFnZS5xdW90ZVRva2VuQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocXVvdGVGZWVVU0QpXG4gICAgICBwYWdlLnF1b3RlVG9rZW5Cb29raW5nRmVlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHFQcm9qLmJvb2tpbmdGZWVzICogcXVvdGVGZWVGYWN0b3IsIHF1b3RlRmVlVUkpXG4gICAgICBwYWdlLnF1b3RlVG9rZW5Td2FwRmVlTi50ZXh0Q29udGVudCA9IFN0cmluZyhxdW90ZUNvbmZpZy5zd2FwRmVlTilcbiAgICAgIHBhZ2UucXVvdGVUb2tlblN3YXBGZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24ocVByb2ouc3dhcEZlZVJlc2VydmVzICogcXVvdGVGZWVGYWN0b3IsIHF1b3RlRmVlVUkpXG4gICAgfVxuICAgIHBhZ2UudG90YWxBbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyh0b3RhbFVTRClcbiAgfVxuXG4gIC8qXG4gICAqIGFsbG9jYXRlIG9wZW5zIGEgZGlhbG9nIHRvIGNob29zZSBmdW5kaW5nIHNvdXJjZXMgKGlmIGFwcGxpY2FibGUpIGFuZFxuICAgKiBjb25maXJtIGFsbG9jYXRpb25zIGFuZCBzdGFydCB0aGUgYm90LlxuICAgKi9cbiAgYWxsb2NhdGUgKCkge1xuICAgIGNvbnN0IGYgPSB0aGlzLmZ1bmRpbmdTdGF0ZSgpXG4gICAgY29uc3Qge1xuICAgICAgcGFnZSwgbWFya2V0UmVwb3J0OiB7IGJhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSB9LCBiYXNlSUQsIHF1b3RlSUQsXG4gICAgICBiYXNlRmVlSUQsIHF1b3RlRmVlSUQsIGJhc2VGZWVGaWF0UmF0ZSwgcXVvdGVGZWVGaWF0UmF0ZSwgY2V4TmFtZSxcbiAgICAgIGJhc2VGYWN0b3IsIHF1b3RlRmFjdG9yLCBiYXNlRmVlRmFjdG9yLCBxdW90ZUZlZUZhY3RvciwgaG9zdCwgbWt0SURcbiAgICB9ID0gdGhpc1xuXG4gICAgY29uc3QgW3Byb3Bvc2VkRGV4QmFzZSwgcHJvcG9zZWRDZXhCYXNlLCBiYXNlU2xpZGVyXSA9IHBhcnNlRnVuZGluZ09wdGlvbnMoZi5iYXNlKVxuICAgIGNvbnN0IFtwcm9wb3NlZERleFF1b3RlLCBwcm9wb3NlZENleFF1b3RlLCBxdW90ZVNsaWRlcl0gPSBwYXJzZUZ1bmRpbmdPcHRpb25zKGYucXVvdGUpXG5cbiAgICBjb25zdCBhbGxvYyA9IHRoaXMuYWxsb2MgPSB7XG4gICAgICBkZXg6IHtcbiAgICAgICAgW2Jhc2VJRF06IHByb3Bvc2VkRGV4QmFzZSAqIGJhc2VGYWN0b3IsXG4gICAgICAgIFtxdW90ZUlEXTogcHJvcG9zZWREZXhRdW90ZSAqIHF1b3RlRmFjdG9yXG4gICAgICB9LFxuICAgICAgY2V4OiB7XG4gICAgICAgIFtiYXNlSURdOiBwcm9wb3NlZENleEJhc2UgKiBiYXNlRmFjdG9yLFxuICAgICAgICBbcXVvdGVJRF06IHByb3Bvc2VkQ2V4UXVvdGUgKiBxdW90ZUZhY3RvclxuICAgICAgfVxuICAgIH1cblxuICAgIGFsbG9jLmRleFtiYXNlRmVlSURdID0gTWF0aC5taW4oKGFsbG9jLmRleFtiYXNlRmVlSURdID8/IDApICsgKGYuYmFzZS5mZWVzLnJlcSAqIGJhc2VGZWVGYWN0b3IpLCBmLmJhc2UuZmVlcy5hdmFpbCAqIGJhc2VGZWVGYWN0b3IpXG4gICAgYWxsb2MuZGV4W3F1b3RlRmVlSURdID0gTWF0aC5taW4oKGFsbG9jLmRleFtxdW90ZUZlZUlEXSA/PyAwKSArIChmLnF1b3RlLmZlZXMucmVxICogcXVvdGVGZWVGYWN0b3IpLCBmLnF1b3RlLmZlZXMuYXZhaWwgKiBxdW90ZUZlZUZhY3RvcilcblxuICAgIGxldCB0b3RhbFVTRCA9IChhbGxvYy5kZXhbYmFzZUlEXSAvIGJhc2VGYWN0b3IgKiBiYXNlRmlhdFJhdGUpICsgKGFsbG9jLmRleFtxdW90ZUlEXSAvIHF1b3RlRmFjdG9yICogcXVvdGVGaWF0UmF0ZSlcbiAgICB0b3RhbFVTRCArPSAoYWxsb2MuY2V4W2Jhc2VJRF0gLyBiYXNlRmFjdG9yICogYmFzZUZpYXRSYXRlKSArIChhbGxvYy5jZXhbcXVvdGVJRF0gLyBxdW90ZUZhY3RvciAqIHF1b3RlRmlhdFJhdGUpXG4gICAgaWYgKGJhc2VGZWVJRCAhPT0gYmFzZUlEKSB0b3RhbFVTRCArPSBhbGxvYy5kZXhbYmFzZUZlZUlEXSAvIGJhc2VGZWVGYWN0b3IgKiBiYXNlRmVlRmlhdFJhdGVcbiAgICBpZiAocXVvdGVGZWVJRCAhPT0gcXVvdGVJRCAmJiBxdW90ZUZlZUlEICE9PSBiYXNlRmVlSUQpIHRvdGFsVVNEICs9IGFsbG9jLmRleFtxdW90ZUZlZUlEXSAvIHF1b3RlRmVlRmFjdG9yICogcXVvdGVGZWVGaWF0UmF0ZVxuICAgIHBhZ2UuYWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModG90YWxVU0QpXG5cbiAgICBEb2Muc2V0VmlzKGNleE5hbWUsIC4uLkRvYy5hcHBseVNlbGVjdG9yKHBhZ2UuYWxsb2NhdGlvbkRpYWxvZywgJ1tkYXRhLWNleC1vbmx5XScpKVxuICAgIERvYy5zZXRWaXMoZi5mdW5kZWRBbmRCYWxhbmNlZCwgcGFnZS5mdW5kZWRBbmRCYWxhbmNlZEJveClcbiAgICBEb2Muc2V0VmlzKGYuYmFzZS50cmFuc2ZlcmFibGUgKyBmLnF1b3RlLnRyYW5zZmVyYWJsZSA+IDAsIHBhZ2UuaGFzVHJhbnNmZXJhYmxlKVxuICAgIERvYy5zZXRWaXMoZi5mdW5kZWRBbmROb3RCYWxhbmNlZCwgcGFnZS5mdW5kZWRBbmROb3RCYWxhbmNlZEJveClcbiAgICBEb2Muc2V0VmlzKGYuc3RhcnZlZCwgcGFnZS5zdGFydmVkQm94KVxuICAgIHBhZ2Uuc3RhcnRCdHRuLmNsYXNzTGlzdC50b2dnbGUoJ2dvJywgZi5mdW5kZWRBbmRCYWxhbmNlZClcbiAgICBwYWdlLnN0YXJ0QnR0bi5jbGFzc0xpc3QudG9nZ2xlKCd3YXJuaW5nJywgIWYuZnVuZGVkQW5kQmFsYW5jZWQpXG4gICAgcGFnZS5wcm9wb3NlZERleEJhc2VBbGxvYy5jbGFzc0xpc3QudG9nZ2xlKCd0ZXh0LXdhcm5pbmcnLCAhKGYuYmFzZS5mdW5kZWRBbmRCYWxhbmNlZCB8fCBmLmJhc2UuZnVuZGVkQW5kTm90QmFsYW5jZWQpKVxuICAgIHBhZ2UucHJvcG9zZWREZXhRdW90ZUFsbG9jLmNsYXNzTGlzdC50b2dnbGUoJ3RleHQtd2FybmluZycsICEoZi5xdW90ZS5mdW5kZWRBbmRCYWxhbmNlZCB8fCBmLnF1b3RlLmZ1bmRlZEFuZE5vdEJhbGFuY2VkKSlcblxuICAgIGNvbnN0IHNldEJhc2VQcm9wb3NhbCA9IChkZXg6IG51bWJlciwgY2V4OiBudW1iZXIpID0+IHtcbiAgICAgIHBhZ2UucHJvcG9zZWREZXhCYXNlQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4KVxuICAgICAgcGFnZS5wcm9wb3NlZERleEJhc2VBbGxvY1VTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhkZXggKiBiYXNlRmlhdFJhdGUpXG4gICAgICBwYWdlLnByb3Bvc2VkQ2V4QmFzZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleClcbiAgICAgIHBhZ2UucHJvcG9zZWRDZXhCYXNlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoY2V4ICogYmFzZUZpYXRSYXRlKVxuICAgIH1cbiAgICBzZXRCYXNlUHJvcG9zYWwocHJvcG9zZWREZXhCYXNlLCBwcm9wb3NlZENleEJhc2UpXG5cbiAgICBEb2Muc2V0VmlzKGJhc2VTbGlkZXIsIHBhZ2UuYmFzZUFsbG9jU2xpZGVyKVxuICAgIGlmIChiYXNlU2xpZGVyKSB7XG4gICAgICBjb25zdCBkZXhSYW5nZSA9IGJhc2VTbGlkZXIucmlnaHQuZGV4IC0gYmFzZVNsaWRlci5sZWZ0LmRleFxuICAgICAgY29uc3QgY2V4UmFuZ2UgPSBiYXNlU2xpZGVyLnJpZ2h0LmNleCAtIGJhc2VTbGlkZXIubGVmdC5jZXhcbiAgICAgIHRoaXMuYmFzZUFsbG9jU2xpZGVyLnNldFZhbHVlKDAuNSlcbiAgICAgIHRoaXMuYmFzZUFsbG9jU2xpZGVyLmNoYW5nZWQgPSAocjogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IGRleEFsbG9jID0gYmFzZVNsaWRlci5sZWZ0LmRleCArIHIgKiBkZXhSYW5nZVxuICAgICAgICBjb25zdCBjZXhBbGxvYyA9IGJhc2VTbGlkZXIubGVmdC5jZXggKyByICogY2V4UmFuZ2VcbiAgICAgICAgYWxsb2MuZGV4W2Jhc2VJRF0gPSBkZXhBbGxvYyAqIGJhc2VGYWN0b3JcbiAgICAgICAgYWxsb2MuY2V4W2Jhc2VJRF0gPSBjZXhBbGxvYyAqIGJhc2VGYWN0b3JcbiAgICAgICAgc2V0QmFzZVByb3Bvc2FsKGRleEFsbG9jLCBjZXhBbGxvYylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZXRRdW90ZVByb3Bvc2FsID0gKGRleDogbnVtYmVyLCBjZXg6IG51bWJlcikgPT4ge1xuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4KVxuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4ICogcXVvdGVGaWF0UmF0ZSlcbiAgICAgIHBhZ2UucHJvcG9zZWRDZXhRdW90ZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleClcbiAgICAgIHBhZ2UucHJvcG9zZWRDZXhRdW90ZUFsbG9jVVNELnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleCAqIHF1b3RlRmlhdFJhdGUpXG4gICAgfVxuICAgIHNldFF1b3RlUHJvcG9zYWwocHJvcG9zZWREZXhRdW90ZSwgcHJvcG9zZWRDZXhRdW90ZSlcblxuICAgIERvYy5zZXRWaXMocXVvdGVTbGlkZXIsIHBhZ2UucXVvdGVBbGxvY1NsaWRlcilcbiAgICBpZiAocXVvdGVTbGlkZXIpIHtcbiAgICAgIGNvbnN0IGRleFJhbmdlID0gcXVvdGVTbGlkZXIucmlnaHQuZGV4IC0gcXVvdGVTbGlkZXIubGVmdC5kZXhcbiAgICAgIGNvbnN0IGNleFJhbmdlID0gcXVvdGVTbGlkZXIucmlnaHQuY2V4IC0gcXVvdGVTbGlkZXIubGVmdC5jZXhcbiAgICAgIHRoaXMucXVvdGVBbGxvY1NsaWRlci5zZXRWYWx1ZSgwLjUpXG4gICAgICB0aGlzLnF1b3RlQWxsb2NTbGlkZXIuY2hhbmdlZCA9IChyOiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgZGV4QWxsb2MgPSBxdW90ZVNsaWRlci5sZWZ0LmRleCArIHIgKiBkZXhSYW5nZVxuICAgICAgICBjb25zdCBjZXhBbGxvYyA9IHF1b3RlU2xpZGVyLmxlZnQuY2V4ICsgciAqIGNleFJhbmdlXG4gICAgICAgIGFsbG9jLmRleFtxdW90ZUlEXSA9IGRleEFsbG9jICogcXVvdGVGYWN0b3JcbiAgICAgICAgYWxsb2MuY2V4W3F1b3RlSURdID0gY2V4QWxsb2MgKiBxdW90ZUZhY3RvclxuICAgICAgICBzZXRRdW90ZVByb3Bvc2FsKGRleEFsbG9jLCBjZXhBbGxvYylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBEb2Muc2V0VmlzKGJhc2VGZWVJRCAhPT0gYmFzZUlELCAuLi5Eb2MuYXBwbHlTZWxlY3RvcihwYWdlLmFsbG9jYXRpb25EaWFsb2csICdbZGF0YS1iYXNlLXRva2VuLWZlZXNdJykpXG4gICAgaWYgKGJhc2VGZWVJRCAhPT0gYmFzZUlEKSB7XG4gICAgICBjb25zdCByZXFGZWVzID0gZi5iYXNlLmZlZXMucmVxICsgKGJhc2VGZWVJRCA9PT0gcXVvdGVGZWVJRCA/IGYucXVvdGUuZmVlcy5yZXEgOiAwKVxuICAgICAgY29uc3QgcHJvcG9zZWRGZWVzID0gTWF0aC5taW4ocmVxRmVlcywgZi5iYXNlLmZlZXMuYXZhaWwpXG4gICAgICBwYWdlLnByb3Bvc2VkRGV4QmFzZUZlZUFsbG9jLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHByb3Bvc2VkRmVlcylcbiAgICAgIHBhZ2UucHJvcG9zZWREZXhCYXNlRmVlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocHJvcG9zZWRGZWVzICogYmFzZUZlZUZpYXRSYXRlKVxuICAgICAgcGFnZS5wcm9wb3NlZERleEJhc2VGZWVBbGxvYy5jbGFzc0xpc3QudG9nZ2xlKCd0ZXh0LXdhcm5pbmcnLCAhZi5iYXNlLmZlZXMuZnVuZGVkKVxuICAgIH1cblxuICAgIGNvbnN0IG5lZWRRdW90ZVRva2VuRmVlcyA9IHF1b3RlRmVlSUQgIT09IHF1b3RlSUQgJiYgcXVvdGVGZWVJRCAhPT0gYmFzZUZlZUlEXG4gICAgRG9jLnNldFZpcyhuZWVkUXVvdGVUb2tlbkZlZXMsIC4uLkRvYy5hcHBseVNlbGVjdG9yKHBhZ2UuYWxsb2NhdGlvbkRpYWxvZywgJ1tkYXRhLXF1b3RlLXRva2VuLWZlZXNdJykpXG4gICAgaWYgKG5lZWRRdW90ZVRva2VuRmVlcykge1xuICAgICAgY29uc3QgcHJvcG9zZWRGZWVzID0gTWF0aC5taW4oZi5xdW90ZS5mZWVzLnJlcSwgZi5xdW90ZS5mZWVzLmF2YWlsKVxuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlRmVlQWxsb2MudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocHJvcG9zZWRGZWVzKVxuICAgICAgcGFnZS5wcm9wb3NlZERleFF1b3RlRmVlQWxsb2NVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MocHJvcG9zZWRGZWVzICogcXVvdGVGZWVGaWF0UmF0ZSlcbiAgICAgIHBhZ2UucHJvcG9zZWREZXhRdW90ZUZlZUFsbG9jLmNsYXNzTGlzdC50b2dnbGUoJ3RleHQtd2FybmluZycsICFmLnF1b3RlLmZlZXMuZnVuZGVkKVxuICAgIH1cblxuICAgIGNvbnN0IG1rdCA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XT8ubWFya2V0c1tta3RJRF1cbiAgICBsZXQgZXhpc3RpbmdPcmRlcnMgPSBmYWxzZVxuICAgIGlmIChta3QgJiYgbWt0Lm9yZGVycykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBta3Qub3JkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChta3Qub3JkZXJzW2ldLnN0YXR1cyA8PSBTdGF0dXNCb29rZWQpIHtcbiAgICAgICAgICBleGlzdGluZ09yZGVycyA9IHRydWVcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIERvYy5zZXRWaXMoZXhpc3RpbmdPcmRlcnMsIHBhZ2UuZXhpc3RpbmdPcmRlcnNCb3gpXG5cbiAgICBEb2Muc2hvdyhwYWdlLmFsbG9jYXRpb25EaWFsb2cpXG4gICAgY29uc3QgY2xvc2VEaWFsb2cgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKERvYy5tb3VzZUluRWxlbWVudChlLCBwYWdlLmFsbG9jYXRpb25EaWFsb2cpKSByZXR1cm5cbiAgICAgIHRoaXMuaGlkZUFsbG9jYXRpb25EaWFsb2coKVxuICAgICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ2NsaWNrJywgY2xvc2VEaWFsb2cpXG4gICAgfVxuICAgIERvYy5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjbG9zZURpYWxvZylcbiAgfVxuXG4gIGhpZGVBbGxvY2F0aW9uRGlhbG9nICgpIHtcbiAgICBEb2MuaGlkZSh0aGlzLnBhZ2UuYWxsb2NhdGlvbkRpYWxvZylcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0ICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGFsbG9jLCBiYXNlSUQsIHF1b3RlSUQsIGhvc3QsIGNleE5hbWUsIGNmZzogeyB1aUNvbmZpZzogeyBjZXhSZWJhbGFuY2UgfSB9IH0gPSB0aGlzXG5cbiAgICBEb2MuaGlkZShwYWdlLmVyck1zZylcbiAgICBpZiAoY2V4TmFtZSAmJiAhYXBwKCkubW1TdGF0dXMuY2V4ZXNbY2V4TmFtZV0/LmNvbm5lY3RlZCkge1xuICAgICAgcGFnZS5lcnJNc2cudGV4dENvbnRlbnQgPSBgJHtjZXhOYW1lfSBub3QgY29ubmVjdGVkYFxuICAgICAgRG9jLnNob3cocGFnZS5lcnJNc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyByb3VuZCBhbGxvY2F0aW9ucyB2YWx1ZXMuXG4gICAgZm9yIChjb25zdCBtIG9mIFthbGxvYy5kZXgsIGFsbG9jLmNleF0pIHtcbiAgICAgIGZvciAoY29uc3QgW2Fzc2V0SUQsIHZdIG9mIE9iamVjdC5lbnRyaWVzKG0pKSBtW3BhcnNlSW50KGFzc2V0SUQpXSA9IE1hdGgucm91bmQodilcbiAgICB9XG5cbiAgICBjb25zdCBzdGFydENvbmZpZzogU3RhcnRDb25maWcgPSB7XG4gICAgICBiYXNlSUQ6IGJhc2VJRCxcbiAgICAgIHF1b3RlSUQ6IHF1b3RlSUQsXG4gICAgICBob3N0OiBob3N0LFxuICAgICAgYWxsb2M6IGFsbG9jXG4gICAgfVxuICAgIGlmIChjZXhOYW1lICYmIGNleFJlYmFsYW5jZSkgc3RhcnRDb25maWcuYXV0b1JlYmFsYW5jZSA9IHRoaXMuYXV0b1JlYmFsYW5jZVNldHRpbmdzKClcblxuICAgIHRyeSB7XG4gICAgICBhcHAoKS5sb2coJ21tJywgJ3N0YXJ0aW5nIG1tIGJvdCcsIHN0YXJ0Q29uZmlnKVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgTU0uc3RhcnRCb3Qoc3RhcnRDb25maWcpXG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkgdGhyb3cgcmVzXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcGFnZS5lcnJNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9BUElfRVJST1IsIGUpXG4gICAgICBEb2Muc2hvdyhwYWdlLmVyck1zZylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLmhpZGVBbGxvY2F0aW9uRGlhbG9nKClcbiAgfVxuXG4gIGF1dG9SZWJhbGFuY2VTZXR0aW5ncyAoKTogQXV0b1JlYmFsYW5jZUNvbmZpZyB7XG4gICAgY29uc3Qge1xuICAgICAgcHJvajogeyBiUHJvaiwgcVByb2osIGFsbG9jIH0sIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCwgY2ZnOiB7IHVpQ29uZmlnOiB7IGJhc2VDb25maWcsIHF1b3RlQ29uZmlnIH0gfSxcbiAgICAgIGJhc2VJRCwgcXVvdGVJRCwgY2V4TmFtZSwgbWt0SURcbiAgICB9ID0gdGhpc1xuXG4gICAgY29uc3QgdG90YWxCYXNlID0gYWxsb2NbYmFzZUlEXVxuICAgIGxldCBkZXhNaW5CYXNlID0gYlByb2ouYm9va1xuICAgIGlmIChiYXNlSUQgPT09IGJhc2VGZWVJRCkgZGV4TWluQmFzZSArPSBiUHJvai5ib29raW5nRmVlc1xuICAgIGlmIChiYXNlSUQgPT09IHF1b3RlRmVlSUQpIGRleE1pbkJhc2UgKz0gcVByb2ouYm9va2luZ0ZlZXNcbiAgICBsZXQgZGV4TWluUXVvdGUgPSBxUHJvai5ib29rXG4gICAgaWYgKHF1b3RlSUQgPT09IHF1b3RlRmVlSUQpIGRleE1pblF1b3RlICs9IHFQcm9qLmJvb2tpbmdGZWVzXG4gICAgaWYgKHF1b3RlSUQgPT09IGJhc2VGZWVJRCkgZGV4TWluUXVvdGUgKz0gYlByb2ouYm9va2luZ0ZlZXNcbiAgICBjb25zdCBtYXhCYXNlID0gTWF0aC5tYXgodG90YWxCYXNlIC0gZGV4TWluQmFzZSwgdG90YWxCYXNlIC0gYlByb2ouY2V4KVxuICAgIGNvbnN0IHRvdGFsUXVvdGUgPSBhbGxvY1txdW90ZUlEXVxuICAgIGNvbnN0IG1heFF1b3RlID0gTWF0aC5tYXgodG90YWxRdW90ZSAtIGRleE1pblF1b3RlLCB0b3RhbFF1b3RlIC0gcVByb2ouY2V4KVxuICAgIGlmIChtYXhCYXNlIDwgMCB8fCBtYXhRdW90ZSA8IDApIHtcbiAgICAgIHRocm93IEVycm9yKGByZWJhbGFuY2UgbWF0aCBkb2Vzbid0IHdvcms6ICR7SlNPTi5zdHJpbmdpZnkoeyBiUHJvaiwgcVByb2osIG1heEJhc2UsIG1heFF1b3RlIH0pfWApXG4gICAgfVxuICAgIGNvbnN0IGNleCA9IGFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWVdXG4gICAgY29uc3QgbWt0ID0gY2V4Lm1hcmtldHNbbWt0SURdXG4gICAgY29uc3QgW21pbkIsIG1heEJdID0gW21rdC5iYXNlTWluV2l0aGRyYXcsIE1hdGgubWF4KG1rdC5iYXNlTWluV2l0aGRyYXcgKiAyLCBtYXhCYXNlKV1cbiAgICBjb25zdCBtaW5CYXNlVHJhbnNmZXIgPSBNYXRoLnJvdW5kKG1pbkIgKyBiYXNlQ29uZmlnLnRyYW5zZmVyRmFjdG9yICogKG1heEIgLSBtaW5CKSlcbiAgICBjb25zdCBbbWluUSwgbWF4UV0gPSBbbWt0LnF1b3RlTWluV2l0aGRyYXcsIE1hdGgubWF4KG1rdC5xdW90ZU1pbldpdGhkcmF3ICogMiwgbWF4UXVvdGUpXVxuICAgIGNvbnN0IG1pblF1b3RlVHJhbnNmZXIgPSBNYXRoLnJvdW5kKG1pblEgKyBxdW90ZUNvbmZpZy50cmFuc2ZlckZhY3RvciAqIChtYXhRIC0gbWluUSkpXG4gICAgcmV0dXJuIHsgbWluQmFzZVRyYW5zZmVyLCBtaW5RdW90ZVRyYW5zZmVyIH1cbiAgfVxuXG4gIHJlY29uZmlndXJlICgpIHtcbiAgICBjb25zdCB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCwgY2V4TmFtZSwgYm90VHlwZSB9ID0gdGhpc1xuICAgIGFwcCgpLmxvYWRQYWdlKCdtbXNldHRpbmdzJywgeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUsIGJvdFR5cGUgfSlcbiAgfVxuXG4gIGhhbmRsZVJ1blN0YXRzICgpIHtcbiAgICB0aGlzLnVwZGF0ZURpc3BsYXkoKVxuICAgIHRoaXMudXBkYXRlVGFibGVSb3coKVxuICAgIHRoaXMucnVuRGlzcGxheS5yZWFkQm9vaygpXG4gIH1cbn1cbiIsImltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnQsXG4gIE1hcmtldFdpdGhIb3N0XG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgeyBnZXRKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgc2V0TWFya2V0RWxlbWVudHMgfSBmcm9tICcuL21tdXRpbCdcblxuaW50ZXJmYWNlIE1hcmtldE1ha2luZ1J1biB7XG4gIHN0YXJ0VGltZTogbnVtYmVyXG4gIG1hcmtldDogTWFya2V0V2l0aEhvc3Rcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFya2V0TWFrZXJBcmNoaXZlc1BhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBiYXNlOiBudW1iZXJcbiAgcXVvdGU6IG51bWJlclxuICBob3N0OiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvciAobWFpbjogSFRNTEVsZW1lbnQpIHtcbiAgICBzdXBlcigpXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKG1haW4pXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UucnVuVGFibGVSb3dUbXBsKVxuICAgIERvYy5iaW5kKHBhZ2UuYmFja0J1dHRvbiwgJ2NsaWNrJywgKCkgPT4geyBhcHAoKS5sb2FkUGFnZSgnbW0nKSB9KVxuICAgIHRoaXMuc2V0dXAoKVxuICB9XG5cbiAgYXN5bmMgc2V0dXAgKCkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGdldEpTT04oJy9hcGkvYXJjaGl2ZWRtbXJ1bnMnKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdmYWlsZWQgdG8gZ2V0IGFyY2hpdmVkIG1tIHJ1bnMnLCByZXMpXG4gICAgICAvLyBUT0RPOiBzaG93IGVycm9yXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBydW5zIDogTWFya2V0TWFraW5nUnVuW10gPSByZXMucnVuc1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBydW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCB7IHN0YXJ0VGltZSwgbWFya2V0OiB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCB9IH0gPSBydW5zW2ldXG4gICAgICBjb25zdCByb3cgPSB0aGlzLnBhZ2UucnVuVGFibGVSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIHRtcGwuc3RhcnRUaW1lLnRleHRDb250ZW50ID0gbmV3IERhdGUoc3RhcnRUaW1lICogMTAwMCkudG9Mb2NhbGVTdHJpbmcoKVxuICAgICAgc2V0TWFya2V0RWxlbWVudHMocm93LCBiYXNlSUQsIHF1b3RlSUQsIGhvc3QpXG5cbiAgICAgIERvYy5iaW5kKHRtcGwubG9ncywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBhcHAoKS5sb2FkUGFnZSgnbW1sb2dzJywgeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QsIHN0YXJ0VGltZSwgcmV0dXJuUGFnZTogJ21tYXJjaGl2ZXMnIH0pXG4gICAgICB9KVxuXG4gICAgICBEb2MuYmluZCh0bXBsLnNldHRpbmdzLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGFwcCgpLmxvYWRQYWdlKCdtbXNldHRpbmdzJywgeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQgfSlcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMucGFnZS5ydW5UYWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93KVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgYXBwLFxuICBQYWdlRWxlbWVudCxcbiAgTWFya2V0TWFraW5nRXZlbnQsXG4gIERFWE9yZGVyRXZlbnQsXG4gIENFWE9yZGVyRXZlbnQsXG4gIFJ1bkV2ZW50Tm90ZSxcbiAgUnVuU3RhdHNOb3RlLFxuICBEZXBvc2l0RXZlbnQsXG4gIFdpdGhkcmF3YWxFdmVudCxcbiAgTWFya2V0TWFraW5nUnVuT3ZlcnZpZXcsXG4gIFN1cHBvcnRlZEFzc2V0LFxuICBCYWxhbmNlRWZmZWN0cyxcbiAgTWFya2V0V2l0aEhvc3QsXG4gIFByb2ZpdExvc3Ncbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7IEZvcm1zIH0gZnJvbSAnLi9mb3JtcydcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0IERvYywgeyBzZXR1cENvcHlCdG4gfSBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgc2V0TWFya2V0RWxlbWVudHMsIGxpdmVCb3RTdGF0dXMgfSBmcm9tICcuL21tdXRpbCdcbmltcG9ydCAqIGFzIGludGwgZnJvbSAnLi9sb2NhbGVzJ1xuaW1wb3J0ICogYXMgd2FsbGV0cyBmcm9tICcuL3dhbGxldHMnXG5pbXBvcnQgeyBDb2luRXhwbG9yZXJzIH0gZnJvbSAnLi9jb2luZXhwbG9yZXJzJ1xuXG5pbnRlcmZhY2UgTG9nc1BhZ2VQYXJhbXMge1xuICBob3N0OiBzdHJpbmdcbiAgcXVvdGVJRDogbnVtYmVyXG4gIGJhc2VJRDogbnVtYmVyXG4gIHN0YXJ0VGltZTogbnVtYmVyXG4gIHJldHVyblBhZ2U6IHN0cmluZ1xufVxuXG5sZXQgbmV0ID0gMFxuXG5jb25zdCBsb2dzQmF0Y2hTaXplID0gNTBcblxuaW50ZXJmYWNlIGxvZ0ZpbHRlcnMge1xuICBkZXhTZWxsczogYm9vbGVhblxuICBkZXhCdXlzOiBib29sZWFuXG4gIGNleFNlbGxzOiBib29sZWFuXG4gIGNleEJ1eXM6IGJvb2xlYW5cbiAgZGVwb3NpdHM6IGJvb2xlYW5cbiAgd2l0aGRyYXdhbHM6IGJvb2xlYW5cbn1cblxuZnVuY3Rpb24gZXZlbnRQYXNzZXNGaWx0ZXIgKGU6IE1hcmtldE1ha2luZ0V2ZW50LCBmaWx0ZXJzOiBsb2dGaWx0ZXJzKTogYm9vbGVhbiB7XG4gIGlmIChlLmRleE9yZGVyRXZlbnQpIHtcbiAgICBpZiAoZS5kZXhPcmRlckV2ZW50LnNlbGwpIHJldHVybiBmaWx0ZXJzLmRleFNlbGxzXG4gICAgcmV0dXJuIGZpbHRlcnMuZGV4QnV5c1xuICB9XG4gIGlmIChlLmNleE9yZGVyRXZlbnQpIHtcbiAgICBpZiAoZS5jZXhPcmRlckV2ZW50LnNlbGwpIHJldHVybiBmaWx0ZXJzLmNleFNlbGxzXG4gICAgcmV0dXJuIGZpbHRlcnMuY2V4QnV5c1xuICB9XG4gIGlmIChlLmRlcG9zaXRFdmVudCkgcmV0dXJuIGZpbHRlcnMuZGVwb3NpdHNcbiAgaWYgKGUud2l0aGRyYXdhbEV2ZW50KSByZXR1cm4gZmlsdGVycy53aXRoZHJhd2Fsc1xuICByZXR1cm4gZmFsc2Vcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFya2V0TWFrZXJMb2dzUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIG1rdDogTWFya2V0V2l0aEhvc3RcbiAgc3RhcnRUaW1lOiBudW1iZXJcbiAgZmlhdFJhdGVzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIGxpdmVCb3Q6IGJvb2xlYW5cbiAgb3ZlcnZpZXc6IE1hcmtldE1ha2luZ1J1bk92ZXJ2aWV3XG4gIGV2ZW50czogUmVjb3JkPG51bWJlciwgW01hcmtldE1ha2luZ0V2ZW50LCBIVE1MRWxlbWVudF0+XG4gIGZvcm1zOiBGb3Jtc1xuICBkZXhPcmRlcklEQ29weUxpc3RlbmVyOiAoKSA9PiB2b2lkIHwgdW5kZWZpbmVkXG4gIGNleE9yZGVySURDb3B5TGlzdGVuZXI6ICgpID0+IHZvaWQgfCB1bmRlZmluZWRcbiAgZGVwb3NpdElEQ29weUxpc3RlbmVyOiAoKSA9PiB2b2lkIHwgdW5kZWZpbmVkXG4gIHdpdGhkcmF3YWxJRENvcHlMaXN0ZW5lcjogKCkgPT4gdm9pZCB8IHVuZGVmaW5lZFxuICBmaWx0ZXJzOiBsb2dGaWx0ZXJzXG4gIGxvYWRpbmc6IGJvb2xlYW5cbiAgcmVmSUQ6IG51bWJlciB8IHVuZGVmaW5lZFxuICBkb25lU2Nyb2xsaW5nOiBib29sZWFuXG4gIHN0YXRzUm93czogUmVjb3JkPG51bWJlciwgSFRNTEVsZW1lbnQ+XG5cbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50LCBwYXJhbXM6IExvZ3NQYWdlUGFyYW1zKSB7XG4gICAgc3VwZXIoKVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhtYWluKVxuICAgIG5ldCA9IGFwcCgpLnVzZXIubmV0XG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UuZXZlbnRUYWJsZVJvd1RtcGwsIHBhZ2UuZGV4T3JkZXJUeFJvd1RtcGwsIHBhZ2UucGVyZm9ybWFuY2VUYWJsZVJvd1RtcGwpXG4gICAgRG9jLmJpbmQodGhpcy5wYWdlLmJhY2tCdXR0b24sICdjbGljaycsICgpID0+IHsgYXBwKCkubG9hZFBhZ2UocGFyYW1zLnJldHVyblBhZ2UgPz8gJ21tJykgfSlcbiAgICBEb2MuYmluZCh0aGlzLnBhZ2UuZmlsdGVyQnV0dG9uLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuYXBwbHlGaWx0ZXJzKCkgfSlcbiAgICBpZiAocGFyYW1zPy5ob3N0KSB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2hvc3QnLCBwYXJhbXMuaG9zdClcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdiYXNlSUQnLCBTdHJpbmcocGFyYW1zLmJhc2VJRCkpXG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgncXVvdGVJRCcsIFN0cmluZyhwYXJhbXMucXVvdGVJRCkpXG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnc3RhcnRUaW1lJywgU3RyaW5nKHBhcmFtcy5zdGFydFRpbWUpKVxuICAgICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKHsgcGFnZTogJ21tc2V0dGluZ3MnLCAuLi5wYXJhbXMgfSwgJycsIHVybClcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKVxuICAgICAgaWYgKCFwYXJhbXMpIHBhcmFtcyA9IHt9IGFzIExvZ3NQYWdlUGFyYW1zXG4gICAgICBwYXJhbXMuaG9zdCA9IHVybFBhcmFtcy5nZXQoJ2hvc3QnKSB8fCAnJ1xuICAgICAgcGFyYW1zLmJhc2VJRCA9IHBhcnNlSW50KHVybFBhcmFtcy5nZXQoJ2Jhc2VJRCcpIHx8ICcwJylcbiAgICAgIHBhcmFtcy5xdW90ZUlEID0gcGFyc2VJbnQodXJsUGFyYW1zLmdldCgncXVvdGVJRCcpIHx8ICcwJylcbiAgICAgIHBhcmFtcy5zdGFydFRpbWUgPSBwYXJzZUludCh1cmxQYXJhbXMuZ2V0KCdzdGFydFRpbWUnKSB8fCAnMCcpXG4gICAgfVxuICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlELCBob3N0LCBzdGFydFRpbWUgfSA9IHBhcmFtc1xuICAgIHRoaXMuc3RhcnRUaW1lID0gc3RhcnRUaW1lXG4gICAgdGhpcy5mb3JtcyA9IG5ldyBGb3JtcyhwYWdlLmZvcm1zKVxuICAgIHRoaXMuZXZlbnRzID0ge31cbiAgICB0aGlzLnN0YXRzUm93cyA9IHt9XG4gICAgdGhpcy5ta3QgPSB7IGJhc2VJRDogYmFzZUlELCBxdW90ZUlEOiBxdW90ZUlELCBob3N0IH1cbiAgICBzZXRNYXJrZXRFbGVtZW50cyhtYWluLCBiYXNlSUQsIHF1b3RlSUQsIGhvc3QpXG4gICAgRG9jLmJpbmQobWFpbiwgJ3Njcm9sbCcsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmxvYWRpbmcpIHJldHVyblxuICAgICAgaWYgKHRoaXMuZG9uZVNjcm9sbGluZykgcmV0dXJuXG4gICAgICBjb25zdCBiZWxvd0JvdHRvbSA9IHBhZ2UuZXZlbnRzVGFibGUub2Zmc2V0SGVpZ2h0IC0gbWFpbi5vZmZzZXRIZWlnaHQgLSBtYWluLnNjcm9sbFRvcFxuICAgICAgaWYgKGJlbG93Qm90dG9tIDwgMCkge1xuICAgICAgICB0aGlzLm5leHRQYWdlKClcbiAgICAgIH1cbiAgICB9KVxuICAgIHRoaXMuc2V0dXAoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICB9XG5cbiAgYXN5bmMgbmV4dFBhZ2UgKCkge1xuICAgIHRoaXMubG9hZGluZyA9IHRydWVcbiAgICBjb25zdCBbZXZlbnRzLCB1cGRhdGVkTG9ncywgb3ZlcnZpZXddID0gYXdhaXQgdGhpcy5nZXRSdW5Mb2dzKClcbiAgICBjb25zdCBhc3NldHMgPSB0aGlzLm1rdEFzc2V0cygpXG4gICAgZm9yIChjb25zdCBldmVudCBvZiBldmVudHMpIHtcbiAgICAgIGlmICh0aGlzLmV2ZW50c1tldmVudC5pZF0pIGNvbnRpbnVlXG4gICAgICBjb25zdCByb3cgPSB0aGlzLm5ld0V2ZW50Um93KGV2ZW50LCBmYWxzZSwgYXNzZXRzKVxuICAgICAgdGhpcy5ldmVudHNbZXZlbnQuaWRdID0gW2V2ZW50LCByb3ddXG4gICAgfVxuICAgIHRoaXMucG9wdWxhdGVTdGF0cyhvdmVydmlldy5wcm9maXRMb3NzLCBvdmVydmlldy5lbmRUaW1lKVxuICAgIHRoaXMudXBkYXRlRXhpc3RpbmdSb3dzKHVwZGF0ZWRMb2dzKVxuICAgIHRoaXMubG9hZGluZyA9IGZhbHNlXG4gIH1cblxuICBhc3luYyBnZXRSdW5Mb2dzICgpOiBQcm9taXNlPFtNYXJrZXRNYWtpbmdFdmVudFtdLCBNYXJrZXRNYWtpbmdFdmVudFtdLCBNYXJrZXRNYWtpbmdSdW5PdmVydmlld10+IHtcbiAgICBjb25zdCB7IG1rdCwgc3RhcnRUaW1lIH0gPSB0aGlzXG4gICAgY29uc3QgcmVxOiBhbnkgPSB7IG1hcmtldDogbWt0LCBzdGFydFRpbWUsIG46IGxvZ3NCYXRjaFNpemUsIGZpbHRlcnM6IHRoaXMuZmlsdGVycywgcmVmSUQ6IHRoaXMucmVmSUQgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL21tcnVubG9ncycsIHJlcSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgY29uc29sZS5lcnJvcignZmFpbGVkIHRvIGdldCBib3QgbG9ncycsIHJlcylcbiAgICB9XG4gICAgaWYgKHJlcy5sb2dzLmxlbmd0aCA8PSAxKSB7XG4gICAgICB0aGlzLmRvbmVTY3JvbGxpbmcgPSB0cnVlXG4gICAgfVxuICAgIGlmIChyZXMubG9ncy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLnJlZklEID0gcmVzLmxvZ3NbcmVzLmxvZ3MubGVuZ3RoIC0gMV0uaWRcbiAgICB9XG4gICAgcmV0dXJuIFtyZXMubG9ncywgcmVzLnVwZGF0ZWRMb2dzIHx8IFtdLCByZXMub3ZlcnZpZXddXG4gIH1cblxuICBhc3luYyBhcHBseUZpbHRlcnMgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmZpbHRlcnMgPSB7XG4gICAgICBkZXhTZWxsczogISFwYWdlLmRleFNlbGxzQ2hlY2tib3guY2hlY2tlZCxcbiAgICAgIGRleEJ1eXM6ICEhcGFnZS5kZXhCdXlzQ2hlY2tib3guY2hlY2tlZCxcbiAgICAgIGNleFNlbGxzOiAhIXBhZ2UuY2V4U2VsbHNDaGVja2JveC5jaGVja2VkLFxuICAgICAgY2V4QnV5czogISFwYWdlLmNleEJ1eXNDaGVja2JveC5jaGVja2VkLFxuICAgICAgZGVwb3NpdHM6ICEhcGFnZS5kZXBvc2l0c0NoZWNrYm94LmNoZWNrZWQsXG4gICAgICB3aXRoZHJhd2FsczogISFwYWdlLndpdGhkcmF3YWxzQ2hlY2tib3guY2hlY2tlZFxuICAgIH1cbiAgICB0aGlzLnJlZklEID0gdW5kZWZpbmVkXG4gICAgY29uc3QgW2V2ZW50cywgLCBvdmVydmlld10gPSBhd2FpdCB0aGlzLmdldFJ1bkxvZ3MoKVxuICAgIHRoaXMucG9wdWxhdGVUYWJsZShldmVudHMpXG4gICAgdGhpcy5wb3B1bGF0ZVN0YXRzKG92ZXJ2aWV3LnByb2ZpdExvc3MsIG92ZXJ2aWV3LmVuZFRpbWUpXG4gIH1cblxuICBzZXRGaWx0ZXJzICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5kZXhTZWxsc0NoZWNrYm94LmNoZWNrZWQgPSB0cnVlXG4gICAgcGFnZS5kZXhCdXlzQ2hlY2tib3guY2hlY2tlZCA9IHRydWVcbiAgICBwYWdlLmNleFNlbGxzQ2hlY2tib3guY2hlY2tlZCA9IHRydWVcbiAgICBwYWdlLmNleEJ1eXNDaGVja2JveC5jaGVja2VkID0gdHJ1ZVxuICAgIHBhZ2UuZGVwb3NpdHNDaGVja2JveC5jaGVja2VkID0gdHJ1ZVxuICAgIHBhZ2Uud2l0aGRyYXdhbHNDaGVja2JveC5jaGVja2VkID0gdHJ1ZVxuICAgIHRoaXMuZmlsdGVycyA9IHtcbiAgICAgIGRleFNlbGxzOiB0cnVlLFxuICAgICAgZGV4QnV5czogdHJ1ZSxcbiAgICAgIGNleFNlbGxzOiB0cnVlLFxuICAgICAgY2V4QnV5czogdHJ1ZSxcbiAgICAgIGRlcG9zaXRzOiB0cnVlLFxuICAgICAgd2l0aGRyYXdhbHM6IHRydWVcbiAgICB9XG4gIH1cblxuICBhc3luYyBzZXR1cCAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHRoaXMuc2V0RmlsdGVycygpXG4gICAgY29uc3QgeyBzdGFydFRpbWUgfSA9IHRoaXNcbiAgICBsZXQgcHJvZml0TG9zczogUHJvZml0TG9zc1xuICAgIGxldCBlbmRUaW1lID0gMFxuICAgIGNvbnN0IGJvdFN0YXR1cyA9IGxpdmVCb3RTdGF0dXMoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIGNvbnN0IFtldmVudHMsICwgb3ZlcnZpZXddID0gYXdhaXQgdGhpcy5nZXRSdW5Mb2dzKClcbiAgICBpZiAoYm90U3RhdHVzPy5ydW5TdGF0cz8uc3RhcnRUaW1lID09PSBzdGFydFRpbWUpIHtcbiAgICAgIHRoaXMubGl2ZUJvdCA9IHRydWVcbiAgICAgIHRoaXMuZmlhdFJhdGVzID0gYXBwKCkuZmlhdFJhdGVzTWFwXG4gICAgICBwcm9maXRMb3NzID0gYm90U3RhdHVzLnJ1blN0YXRzLnByb2ZpdExvc3NcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5maWF0UmF0ZXMgPSBvdmVydmlldy5maW5hbFN0YXRlLmZpYXRSYXRlc1xuICAgICAgcHJvZml0TG9zcyA9IG92ZXJ2aWV3LnByb2ZpdExvc3NcbiAgICAgIGVuZFRpbWUgPSBvdmVydmlldy5lbmRUaW1lXG4gICAgfVxuICAgIHRoaXMucG9wdWxhdGVTdGF0cyhwcm9maXRMb3NzLCBlbmRUaW1lKVxuICAgIGNvbnN0IGFzc2V0cyA9IHRoaXMubWt0QXNzZXRzKClcbiAgICBjb25zdCBwYXJlbnRIZWFkZXIgPSBwYWdlLnN1bVVTREhlYWRlci5wYXJlbnRFbGVtZW50XG4gICAgZm9yIChjb25zdCBhc3NldCBvZiBhc3NldHMpIHtcbiAgICAgIGNvbnN0IHRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKSBhcyBQYWdlRWxlbWVudFxuICAgICAgdGgudGV4dENvbnRlbnQgPSBgJHthc3NldC5zeW1ib2wudG9VcHBlckNhc2UoKX0gRGVsdGFgXG4gICAgICBpZiAocGFyZW50SGVhZGVyKSB7XG4gICAgICAgIHBhcmVudEhlYWRlci5pbnNlcnRCZWZvcmUodGgsIHBhZ2Uuc3VtVVNESGVhZGVyKVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnBvcHVsYXRlVGFibGUoZXZlbnRzKVxuXG4gICAgYXBwKCkucmVnaXN0ZXJOb3RlRmVlZGVyKHtcbiAgICAgIHJ1bmV2ZW50OiAobm90ZTogUnVuRXZlbnROb3RlKSA9PiB7IHRoaXMuaGFuZGxlUnVuRXZlbnROb3RlKG5vdGUpIH0sXG4gICAgICBydW5zdGF0czogKG5vdGU6IFJ1blN0YXRzTm90ZSkgPT4geyB0aGlzLmhhbmRsZVJ1blN0YXRzTm90ZShub3RlKSB9XG4gICAgfSlcbiAgfVxuXG4gIGhhbmRsZVJ1bkV2ZW50Tm90ZSAobm90ZTogUnVuRXZlbnROb3RlKSB7XG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QgfSA9IHRoaXMubWt0XG4gICAgaWYgKG5vdGUuaG9zdCAhPT0gaG9zdCB8fCBub3RlLmJhc2VJRCAhPT0gYmFzZUlEIHx8IG5vdGUucXVvdGVJRCAhPT0gcXVvdGVJRCkgcmV0dXJuXG4gICAgaWYgKCFldmVudFBhc3Nlc0ZpbHRlcihub3RlLmV2ZW50LCB0aGlzLmZpbHRlcnMpKSByZXR1cm5cbiAgICBjb25zdCBldmVudCA9IG5vdGUuZXZlbnRcbiAgICBjb25zdCBjYWNoZWRFdmVudCA9IHRoaXMuZXZlbnRzW2V2ZW50LmlkXVxuICAgIGlmIChjYWNoZWRFdmVudCkge1xuICAgICAgdGhpcy5zZXRSb3dDb250ZW50cyhjYWNoZWRFdmVudFsxXSwgZXZlbnQsIHRoaXMubWt0QXNzZXRzKCkpXG4gICAgICBjYWNoZWRFdmVudFswXSA9IGV2ZW50XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3Qgcm93ID0gdGhpcy5uZXdFdmVudFJvdyhldmVudCwgdHJ1ZSwgdGhpcy5ta3RBc3NldHMoKSlcbiAgICB0aGlzLmV2ZW50c1tldmVudC5pZF0gPSBbZXZlbnQsIHJvd11cbiAgfVxuXG4gIGhhbmRsZVJ1blN0YXRzTm90ZSAobm90ZTogUnVuU3RhdHNOb3RlKSB7XG4gICAgY29uc3QgeyBta3Q6IHsgYmFzZUlELCBxdW90ZUlELCBob3N0IH0sIHN0YXJ0VGltZSB9ID0gdGhpc1xuICAgIGlmIChub3RlLmhvc3QgIT09IGhvc3QgfHxcbiAgICAgIG5vdGUuYmFzZUlEICE9PSBiYXNlSUQgfHxcbiAgICAgIG5vdGUucXVvdGVJRCAhPT0gcXVvdGVJRCkgcmV0dXJuXG4gICAgaWYgKCFub3RlLnN0YXRzIHx8IG5vdGUuc3RhdHMuc3RhcnRUaW1lICE9PSBzdGFydFRpbWUpIHJldHVyblxuICAgIHRoaXMucG9wdWxhdGVTdGF0cyhub3RlLnN0YXRzLnByb2ZpdExvc3MsIDApXG4gIH1cblxuICBwb3B1bGF0ZVN0YXRzIChwbDogUHJvZml0TG9zcywgZW5kVGltZTogbnVtYmVyKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2Uuc3RhcnRUaW1lLnRleHRDb250ZW50ID0gbmV3IERhdGUodGhpcy5zdGFydFRpbWUgKiAxMDAwKS50b0xvY2FsZVN0cmluZygpXG4gICAgaWYgKGVuZFRpbWUgPT09IDApIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuZW5kVGltZVJvdylcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5lbmRUaW1lLnRleHRDb250ZW50ID0gbmV3IERhdGUoZW5kVGltZSAqIDEwMDApLnRvTG9jYWxlU3RyaW5nKClcbiAgICB9XG4gICAgZm9yIChjb25zdCBhc3NldElEIGluIHBsLmRpZmZzKSB7XG4gICAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1twYXJzZUludChhc3NldElEKV1cbiAgICAgIGxldCByb3cgPSB0aGlzLnN0YXRzUm93c1thc3NldElEXVxuICAgICAgaWYgKCFyb3cpIHtcbiAgICAgICAgcm93ID0gcGFnZS5wZXJmb3JtYW5jZVRhYmxlUm93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgICAgdG1wbC5sb2dvLnNyYyA9IERvYy5sb2dvUGF0aChhc3NldC5zeW1ib2wpXG4gICAgICAgIHRtcGwudGlja2VyLnRleHRDb250ZW50ID0gYXNzZXQuc3ltYm9sLnRvVXBwZXJDYXNlKClcbiAgICAgICAgdGhpcy5zdGF0c1Jvd3NbYXNzZXRJRF0gPSByb3dcbiAgICAgICAgcGFnZS5wZXJmb3JtYW5jZVRhYmxlQm9keS5hcHBlbmRDaGlsZChyb3cpXG4gICAgICB9XG4gICAgICBjb25zdCBkaWZmID0gcGwuZGlmZnNbYXNzZXRJRF1cbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICB0bXBsLmRpZmYudGV4dENvbnRlbnQgPSBkaWZmLmZtdFxuICAgICAgdG1wbC51c2REaWZmLnRleHRDb250ZW50ID0gZGlmZi5mbXRVU0RcbiAgICAgIHRtcGwuZmlhdFJhdGUudGV4dENvbnRlbnQgPSBgJHtEb2MuZm9ybWF0RmlhdFZhbHVlKHRoaXMuZmlhdFJhdGVzW2Fzc2V0LmlkXSl9IFVTRGBcbiAgICB9XG4gICAgcGFnZS5wcm9maXRMb3NzLnRleHRDb250ZW50ID0gYCR7RG9jLmZvcm1hdEZpYXRWYWx1ZShwbC5wcm9maXQpfSBVU0RgXG4gIH1cblxuICBta3RBc3NldHMgKCkgOiBTdXBwb3J0ZWRBc3NldFtdIHtcbiAgICBjb25zdCBiYXNlQXNzZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5ta3QuYmFzZUlEXVxuICAgIGNvbnN0IHF1b3RlQXNzZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5ta3QucXVvdGVJRF1cblxuICAgIGNvbnN0IGFzc2V0cyA9IFtiYXNlQXNzZXQsIHF1b3RlQXNzZXRdXG4gICAgY29uc3QgYXNzZXRJRHMgPSB7IFtiYXNlQXNzZXQuaWRdOiB0cnVlLCBbcXVvdGVBc3NldC5pZF06IHRydWUgfVxuXG4gICAgaWYgKGJhc2VBc3NldC50b2tlbiAmJiAhYXNzZXRJRHNbYmFzZUFzc2V0LnRva2VuLnBhcmVudElEXSkge1xuICAgICAgY29uc3QgYmFzZVRva2VuQXNzZXQgPSBhcHAoKS5hc3NldHNbYmFzZUFzc2V0LnRva2VuLnBhcmVudElEXVxuICAgICAgYXNzZXRJRHNbYmFzZVRva2VuQXNzZXQuaWRdID0gdHJ1ZVxuICAgICAgYXNzZXRzLnB1c2goYmFzZVRva2VuQXNzZXQpXG4gICAgfVxuXG4gICAgaWYgKHF1b3RlQXNzZXQudG9rZW4gJiYgIWFzc2V0SURzW3F1b3RlQXNzZXQudG9rZW4ucGFyZW50SURdKSB7XG4gICAgICBjb25zdCBxdW90ZVRva2VuQXNzZXQgPSBhcHAoKS5hc3NldHNbcXVvdGVBc3NldC50b2tlbi5wYXJlbnRJRF1cbiAgICAgIGFzc2V0cy5wdXNoKHF1b3RlVG9rZW5Bc3NldClcbiAgICB9XG5cbiAgICByZXR1cm4gYXNzZXRzXG4gIH1cblxuICB1cGRhdGVFeGlzdGluZ1Jvd3MgKHVwZGF0ZWRMb2dzOiBNYXJrZXRNYWtpbmdFdmVudFtdKSB7XG4gICAgZm9yIChjb25zdCBldmVudCBvZiB1cGRhdGVkTG9ncykge1xuICAgICAgY29uc3QgY2FjaGVkRXZlbnQgPSB0aGlzLmV2ZW50c1tldmVudC5pZF1cbiAgICAgIGlmICghY2FjaGVkRXZlbnQpIGNvbnRpbnVlXG4gICAgICB0aGlzLnNldFJvd0NvbnRlbnRzKGNhY2hlZEV2ZW50WzFdLCBldmVudCwgdGhpcy5ta3RBc3NldHMoKSlcbiAgICAgIGNhY2hlZEV2ZW50WzBdID0gZXZlbnRcbiAgICB9XG4gIH1cblxuICBwb3B1bGF0ZVRhYmxlIChldmVudHM6IE1hcmtldE1ha2luZ0V2ZW50W10pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmVtcHR5KHBhZ2UuZXZlbnRzVGFibGVCb2R5KVxuICAgIHRoaXMuZXZlbnRzID0ge31cbiAgICB0aGlzLmRvbmVTY3JvbGxpbmcgPSBmYWxzZVxuICAgIGNvbnN0IGFzc2V0cyA9IHRoaXMubWt0QXNzZXRzKClcbiAgICBmb3IgKGNvbnN0IGV2ZW50IG9mIGV2ZW50cykge1xuICAgICAgY29uc3Qgcm93ID0gdGhpcy5uZXdFdmVudFJvdyhldmVudCwgZmFsc2UsIGFzc2V0cylcbiAgICAgIHRoaXMuZXZlbnRzW2V2ZW50LmlkXSA9IFtldmVudCwgcm93XVxuICAgIH1cbiAgfVxuXG4gIHNldFJvd0NvbnRlbnRzIChyb3c6IEhUTUxFbGVtZW50LCBldmVudDogTWFya2V0TWFraW5nRXZlbnQsIGFzc2V0czogU3VwcG9ydGVkQXNzZXRbXSkge1xuICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgdG1wbC50aW1lLnRleHRDb250ZW50ID0gKG5ldyBEYXRlKGV2ZW50LnRpbWVzdGFtcCAqIDEwMDApKS50b0xvY2FsZVN0cmluZygpXG4gICAgdG1wbC5ldmVudFR5cGUudGV4dENvbnRlbnQgPSB0aGlzLmV2ZW50VHlwZShldmVudClcbiAgICBsZXQgaWRcbiAgICBpZiAoZXZlbnQuZGVwb3NpdEV2ZW50KSB7XG4gICAgICBpZCA9IGV2ZW50LmRlcG9zaXRFdmVudC50cmFuc2FjdGlvbi5pZFxuICAgIH0gZWxzZSBpZiAoZXZlbnQud2l0aGRyYXdhbEV2ZW50KSB7XG4gICAgICBpZCA9IGV2ZW50LndpdGhkcmF3YWxFdmVudC5pZFxuICAgIH0gZWxzZSBpZiAoZXZlbnQuZGV4T3JkZXJFdmVudCkge1xuICAgICAgaWQgPSBldmVudC5kZXhPcmRlckV2ZW50LmlkXG4gICAgfSBlbHNlIGlmIChldmVudC5jZXhPcmRlckV2ZW50KSB7XG4gICAgICBpZCA9IGV2ZW50LmNleE9yZGVyRXZlbnQuaWRcbiAgICB9XG4gICAgaWYgKGlkKSB7XG4gICAgICB0bXBsLmV2ZW50SUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKGlkLCAzMClcbiAgICAgIHRtcGwuZXZlbnRJRC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgaWQpXG4gICAgfVxuICAgIGxldCB1c2QgPSAwXG4gICAgZm9yIChjb25zdCBhc3NldCBvZiBhc3NldHMpIHtcbiAgICAgIGNvbnN0IGJlID0gZXZlbnQuYmFsYW5jZUVmZmVjdHNcbiAgICAgIGNvbnN0IHN1bSA9IHN1bUJhbGFuY2VFZmZlY3RzKGFzc2V0LmlkLCBiZSlcbiAgICAgIGNvbnN0IHRtcGxJRCA9IGBzdW0ke2Fzc2V0LnN5bWJvbC50b1VwcGVyQ2FzZSgpfWBcbiAgICAgIGxldCBlbCA6IFBhZ2VFbGVtZW50XG4gICAgICBpZiAodG1wbFt0bXBsSURdKSB7XG4gICAgICAgIGVsID0gdG1wbFt0bXBsSURdXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJylcbiAgICAgICAgZWwuZGF0YXNldC50bXBsID0gdG1wbElEXG4gICAgICAgIGNvbnN0IHBhcmVudCA9IHRtcGwuc3VtVVNELnBhcmVudEVsZW1lbnRcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoZWwsIHRtcGwuc3VtVVNEKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoc3VtLCBhc3NldC51bml0SW5mbylcbiAgICAgIGNvbnN0IGZhY3RvciA9IGFzc2V0LnVuaXRJbmZvLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgICB1c2QgKz0gc3VtIC8gZmFjdG9yICogdGhpcy5maWF0UmF0ZXNbYXNzZXQuaWRdID8/IDBcbiAgICB9XG4gICAgdG1wbC5zdW1VU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModXNkKVxuICAgIERvYy5iaW5kKHRtcGwuZGV0YWlscywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dFdmVudERldGFpbHMoZXZlbnQuaWQpIH0pXG4gIH1cblxuICBuZXdFdmVudFJvdyAoZXZlbnQ6IE1hcmtldE1ha2luZ0V2ZW50LCBwcmVwZW5kOiBib29sZWFuLCBhc3NldHM6IFN1cHBvcnRlZEFzc2V0W10pIDogSFRNTEVsZW1lbnQge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCByb3cgPSBwYWdlLmV2ZW50VGFibGVSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgIHJvdy5pZCA9IGV2ZW50LmlkLnRvU3RyaW5nKClcbiAgICB0aGlzLnNldFJvd0NvbnRlbnRzKHJvdywgZXZlbnQsIGFzc2V0cylcbiAgICBpZiAocHJlcGVuZCkge1xuICAgICAgcGFnZS5ldmVudHNUYWJsZUJvZHkuaW5zZXJ0QmVmb3JlKHJvdywgcGFnZS5ldmVudHNUYWJsZUJvZHkuZmlyc3RDaGlsZClcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS5ldmVudHNUYWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93KVxuICAgIH1cbiAgICByZXR1cm4gcm93XG4gIH1cblxuICBldmVudFR5cGUgKGV2ZW50OiBNYXJrZXRNYWtpbmdFdmVudCkgOiBzdHJpbmcge1xuICAgIGlmIChldmVudC5kZXBvc2l0RXZlbnQpIHtcbiAgICAgIHJldHVybiAnRGVwb3NpdCdcbiAgICB9IGVsc2UgaWYgKGV2ZW50LndpdGhkcmF3YWxFdmVudCkge1xuICAgICAgcmV0dXJuICdXaXRoZHJhd2FsJ1xuICAgIH0gZWxzZSBpZiAoZXZlbnQuZGV4T3JkZXJFdmVudCkge1xuICAgICAgcmV0dXJuIGV2ZW50LmRleE9yZGVyRXZlbnQuc2VsbCA/ICdERVggU2VsbCcgOiAnREVYIEJ1eSdcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmNleE9yZGVyRXZlbnQpIHtcbiAgICAgIHJldHVybiBldmVudC5jZXhPcmRlckV2ZW50LnNlbGwgPyAnQ0VYIFNlbGwnIDogJ0NFWCBCdXknXG4gICAgfVxuXG4gICAgcmV0dXJuICcnXG4gIH1cblxuICBzaG93RGV4T3JkZXJFdmVudERldGFpbHMgKGV2ZW50OiBERVhPcmRlckV2ZW50KSB7XG4gICAgY29uc3QgeyBwYWdlLCBta3Q6IHsgYmFzZUlELCBxdW90ZUlEIH0gfSA9IHRoaXNcbiAgICBjb25zdCBiYXNlQXNzZXQgPSBhcHAoKS5hc3NldHNbYmFzZUlEXVxuICAgIGNvbnN0IHF1b3RlQXNzZXQgPSBhcHAoKS5hc3NldHNbcXVvdGVJRF1cbiAgICBjb25zdCBbYnVpLCBxdWldID0gW2Jhc2VBc3NldC51bml0SW5mbywgcXVvdGVBc3NldC51bml0SW5mb11cbiAgICBjb25zdCBbYmFzZVRpY2tlciwgcXVvdGVUaWNrZXJdID0gW2J1aS5jb252ZW50aW9uYWwudW5pdCwgcXVpLmNvbnZlbnRpb25hbC51bml0XVxuICAgIGlmICh0aGlzLmRleE9yZGVySURDb3B5TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcGFnZS5jb3B5RGV4T3JkZXJJRC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZGV4T3JkZXJJRENvcHlMaXN0ZW5lcilcbiAgICB9XG4gICAgdGhpcy5kZXhPcmRlcklEQ29weUxpc3RlbmVyID0gKCkgPT4geyBzZXR1cENvcHlCdG4oZXZlbnQuaWQsIHBhZ2UuZGV4T3JkZXJJRCwgcGFnZS5jb3B5RGV4T3JkZXJJRCwgJyMxZTdkMTEnKSB9XG4gICAgcGFnZS5jb3B5RGV4T3JkZXJJRC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZGV4T3JkZXJJRENvcHlMaXN0ZW5lcilcbiAgICBwYWdlLmRleE9yZGVySUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKGV2ZW50LmlkLCAyMClcbiAgICBwYWdlLmRleE9yZGVySUQuc2V0QXR0cmlidXRlKCd0aXRsZScsIGV2ZW50LmlkKVxuICAgIGNvbnN0IHJhdGUgPSBhcHAoKS5jb252ZW50aW9uYWxSYXRlKGJhc2VJRCwgcXVvdGVJRCwgZXZlbnQucmF0ZSlcblxuICAgIHBhZ2UuZGV4T3JkZXJSYXRlLnRleHRDb250ZW50ID0gYCR7cmF0ZX0gJHtiYXNlVGlja2VyfS8ke3F1b3RlVGlja2VyfWBcbiAgICBwYWdlLmRleE9yZGVyUXR5LnRleHRDb250ZW50ID0gYCR7ZXZlbnQucXR5IC8gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yfSAke2Jhc2VUaWNrZXJ9YFxuICAgIGlmIChldmVudC5zZWxsKSB7XG4gICAgICBwYWdlLmRleE9yZGVyU2lkZS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1NFTEwpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2UuZGV4T3JkZXJTaWRlLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQlVZKVxuICAgIH1cbiAgICBEb2MuZW1wdHkocGFnZS5kZXhPcmRlclR4c1RhYmxlQm9keSlcbiAgICBEb2Muc2V0VmlzKGV2ZW50LnRyYW5zYWN0aW9ucyAmJiBldmVudC50cmFuc2FjdGlvbnMubGVuZ3RoID4gMCwgcGFnZS5kZXhPcmRlclR4c1RhYmxlKVxuICAgIGNvbnN0IHR4QXNzZXQgPSAodHhUeXBlOiBudW1iZXIsIHNlbGw6IGJvb2xlYW4pIDogU3VwcG9ydGVkQXNzZXQgfCB1bmRlZmluZWQgPT4ge1xuICAgICAgc3dpdGNoICh0eFR5cGUpIHtcbiAgICAgICAgY2FzZSB3YWxsZXRzLnR4VHlwZVN3YXA6XG4gICAgICAgIGNhc2Ugd2FsbGV0cy50eFR5cGVSZWZ1bmQ6XG4gICAgICAgIGNhc2Ugd2FsbGV0cy50eFR5cGVTcGxpdDpcbiAgICAgICAgICByZXR1cm4gc2VsbCA/IGJhc2VBc3NldCA6IHF1b3RlQXNzZXRcbiAgICAgICAgY2FzZSB3YWxsZXRzLnR4VHlwZVJlZGVlbTpcbiAgICAgICAgICByZXR1cm4gc2VsbCA/IHF1b3RlQXNzZXQgOiBiYXNlQXNzZXRcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGxldCBpID0gMDsgZXZlbnQudHJhbnNhY3Rpb25zICYmIGkgPCBldmVudC50cmFuc2FjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHR4ID0gZXZlbnQudHJhbnNhY3Rpb25zW2ldXG4gICAgICBjb25zdCByb3cgPSBwYWdlLmRleE9yZGVyVHhSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIHRtcGwuaWQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKHR4LmlkLCAyMClcbiAgICAgIHRtcGwuaWQuc2V0QXR0cmlidXRlKCd0aXRsZScsIHR4LmlkKVxuICAgICAgdG1wbC50eXBlLnRleHRDb250ZW50ID0gd2FsbGV0cy50eFR5cGVTdHJpbmcodHgudHlwZSlcbiAgICAgIGNvbnN0IGFzc2V0ID0gdHhBc3NldCh0eC50eXBlLCBldmVudC5zZWxsKVxuICAgICAgaWYgKCFhc3NldCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCd1bmV4cGVjdGVkIHR4IHR5cGUgaW4gZGV4IG9yZGVyIGV2ZW50JywgdHgudHlwZSlcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIGNvbnN0IGFzc2V0RXhwbG9yZXIgPSBDb2luRXhwbG9yZXJzW2Fzc2V0LmlkXVxuICAgICAgaWYgKGFzc2V0RXhwbG9yZXIgJiYgYXNzZXRFeHBsb3JlcltuZXRdKSB7XG4gICAgICAgIHRtcGwuZXhwbG9yZXJMaW5rLmhyZWYgPSBhc3NldEV4cGxvcmVyW25ldF0odHguaWQpXG4gICAgICB9XG4gICAgICB0bXBsLmFtdC50ZXh0Q29udGVudCA9IGAke0RvYy5mb3JtYXRDb2luVmFsdWUodHguYW1vdW50LCBhc3NldC51bml0SW5mbyl9ICR7YXNzZXQudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXQudG9Mb3dlckNhc2UoKX1gXG4gICAgICB0bXBsLmZlZXMudGV4dENvbnRlbnQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKHR4LmZlZXMsIGFzc2V0LnVuaXRJbmZvKX0gJHthc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdC50b0xvd2VyQ2FzZSgpfWBcbiAgICAgIHBhZ2UuZGV4T3JkZXJUeHNUYWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93KVxuICAgIH1cbiAgICB0aGlzLmZvcm1zLnNob3cocGFnZS5kZXhPcmRlckRldGFpbHNGb3JtKVxuICB9XG5cbiAgc2hvd0NleE9yZGVyRXZlbnREZXRhaWxzIChldmVudDogQ0VYT3JkZXJFdmVudCkge1xuICAgIGNvbnN0IHsgcGFnZSwgbWt0OiB7IGJhc2VJRCwgcXVvdGVJRCB9IH0gPSB0aGlzXG4gICAgY29uc3QgYmFzZUFzc2V0ID0gYXBwKCkuYXNzZXRzW2Jhc2VJRF1cbiAgICBjb25zdCBxdW90ZUFzc2V0ID0gYXBwKCkuYXNzZXRzW3F1b3RlSURdXG4gICAgY29uc3QgW2J1aSwgcXVpXSA9IFtiYXNlQXNzZXQudW5pdEluZm8sIHF1b3RlQXNzZXQudW5pdEluZm9dXG4gICAgY29uc3QgW2Jhc2VUaWNrZXIsIHF1b3RlVGlja2VyXSA9IFtidWkuY29udmVudGlvbmFsLnVuaXQsIHF1aS5jb252ZW50aW9uYWwudW5pdF1cblxuICAgIHBhZ2UuY2V4T3JkZXJJRC50ZXh0Q29udGVudCA9IHRyaW1TdHJpbmdXaXRoRWxsaXBzaXMoZXZlbnQuaWQsIDIwKVxuICAgIGlmICh0aGlzLmNleE9yZGVySURDb3B5TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcGFnZS5jb3B5Q2V4T3JkZXJJRC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2V4T3JkZXJJRENvcHlMaXN0ZW5lcilcbiAgICB9XG4gICAgdGhpcy5jZXhPcmRlcklEQ29weUxpc3RlbmVyID0gKCkgPT4geyBzZXR1cENvcHlCdG4oZXZlbnQuaWQsIHBhZ2UuY2V4T3JkZXJJRCwgcGFnZS5jb3B5Q2V4T3JkZXJJRCwgJyMxZTdkMTEnKSB9XG4gICAgcGFnZS5jb3B5Q2V4T3JkZXJJRC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2V4T3JkZXJJRENvcHlMaXN0ZW5lcilcbiAgICBwYWdlLmNleE9yZGVySUQuc2V0QXR0cmlidXRlKCd0aXRsZScsIGV2ZW50LmlkKVxuICAgIGNvbnN0IHJhdGUgPSBhcHAoKS5jb252ZW50aW9uYWxSYXRlKGJhc2VJRCwgcXVvdGVJRCwgZXZlbnQucmF0ZSlcbiAgICBwYWdlLmNleE9yZGVyUmF0ZS50ZXh0Q29udGVudCA9IGAke3JhdGV9ICR7YmFzZVRpY2tlcn0vJHtxdW90ZVRpY2tlcn1gXG4gICAgcGFnZS5jZXhPcmRlclF0eS50ZXh0Q29udGVudCA9IGAke2V2ZW50LnF0eSAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3Rvcn0gJHtiYXNlVGlja2VyfWBcbiAgICBpZiAoZXZlbnQuc2VsbCkge1xuICAgICAgcGFnZS5jZXhPcmRlclNpZGUudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9TRUxMKVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLmNleE9yZGVyU2lkZS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0JVWSlcbiAgICB9XG4gICAgcGFnZS5jZXhPcmRlckJhc2VGaWxsZWQudGV4dENvbnRlbnQgPSBgJHtldmVudC5iYXNlRmlsbGVkIC8gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yfSAke2Jhc2VUaWNrZXJ9YFxuICAgIHBhZ2UuY2V4T3JkZXJRdW90ZUZpbGxlZC50ZXh0Q29udGVudCA9IGAke2V2ZW50LnF1b3RlRmlsbGVkIC8gcXVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yfSAke3F1b3RlVGlja2VyfWBcbiAgICB0aGlzLmZvcm1zLnNob3cocGFnZS5jZXhPcmRlckRldGFpbHNGb3JtKVxuICB9XG5cbiAgc2hvd0RlcG9zaXRFdmVudERldGFpbHMgKGV2ZW50OiBEZXBvc2l0RXZlbnQsIHBlbmRpbmc6IGJvb2xlYW4pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgcGFnZS5kZXBvc2l0SUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKGV2ZW50LnRyYW5zYWN0aW9uLmlkLCAyMClcbiAgICBpZiAodGhpcy5kZXBvc2l0SURDb3B5TGlzdGVuZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcGFnZS5jb3B5RGVwb3NpdElELnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5kZXBvc2l0SURDb3B5TGlzdGVuZXIpXG4gICAgfVxuICAgIHRoaXMuZGVwb3NpdElEQ29weUxpc3RlbmVyID0gKCkgPT4geyBzZXR1cENvcHlCdG4oZXZlbnQudHJhbnNhY3Rpb24uaWQsIHBhZ2UuZGVwb3NpdElELCBwYWdlLmNvcHlEZXBvc2l0SUQsICcjMWU3ZDExJykgfVxuICAgIHBhZ2UuY29weURlcG9zaXRJRC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuZGVwb3NpdElEQ29weUxpc3RlbmVyKVxuICAgIHBhZ2UuZGVwb3NpdElELnNldEF0dHJpYnV0ZSgndGl0bGUnLCBldmVudC50cmFuc2FjdGlvbi5pZClcbiAgICBjb25zdCB1bml0SW5mbyA9IGFwcCgpLmFzc2V0c1tldmVudC5hc3NldElEXS51bml0SW5mb1xuICAgIGNvbnN0IHVuaXQgPSB1bml0SW5mby5jb252ZW50aW9uYWwudW5pdFxuICAgIHBhZ2UuZGVwb3NpdEFtdC50ZXh0Q29udGVudCA9IGAke0RvYy5mb3JtYXRDb2luVmFsdWUoZXZlbnQudHJhbnNhY3Rpb24uYW1vdW50LCB1bml0SW5mbyl9ICR7dW5pdH1gXG4gICAgcGFnZS5kZXBvc2l0RmVlcy50ZXh0Q29udGVudCA9IGAke0RvYy5mb3JtYXRDb2luVmFsdWUoZXZlbnQudHJhbnNhY3Rpb24uZmVlcywgdW5pdEluZm8pfSAke3VuaXR9YFxuICAgIHBhZ2UuZGVwb3NpdFN0YXR1cy50ZXh0Q29udGVudCA9IHBlbmRpbmcgPyBpbnRsLnByZXAoaW50bC5JRF9QRU5ESU5HKSA6IGludGwucHJlcChpbnRsLklEX0NPTVBMRVRFKVxuICAgIERvYy5zZXRWaXMoIXBlbmRpbmcsIHBhZ2UuZGVwb3NpdENyZWRpdFNlY3Rpb24pXG4gICAgaWYgKCFwZW5kaW5nKSB7XG4gICAgICBwYWdlLmRlcG9zaXRDcmVkaXQudGV4dENvbnRlbnQgPSBgJHtEb2MuZm9ybWF0Q29pblZhbHVlKGV2ZW50LmNleENyZWRpdCwgdW5pdEluZm8pfSAke3VuaXR9YFxuICAgIH1cbiAgICB0aGlzLmZvcm1zLnNob3cocGFnZS5kZXBvc2l0RGV0YWlsc0Zvcm0pXG4gIH1cblxuICBzaG93V2l0aGRyYXdhbEV2ZW50RGV0YWlscyAoZXZlbnQ6IFdpdGhkcmF3YWxFdmVudCwgcGVuZGluZzogYm9vbGVhbikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLndpdGhkcmF3YWxJRC50ZXh0Q29udGVudCA9IHRyaW1TdHJpbmdXaXRoRWxsaXBzaXMoZXZlbnQuaWQsIDIwKVxuICAgIGlmICh0aGlzLndpdGhkcmF3YWxJRENvcHlMaXN0ZW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBwYWdlLmNvcHlXaXRoZHJhd2FsSUQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLndpdGhkcmF3YWxJRENvcHlMaXN0ZW5lcilcbiAgICB9XG4gICAgdGhpcy53aXRoZHJhd2FsSURDb3B5TGlzdGVuZXIgPSAoKSA9PiB7IHNldHVwQ29weUJ0bihldmVudC5pZCwgcGFnZS53aXRoZHJhd2FsSUQsIHBhZ2UuY29weVdpdGhkcmF3YWxJRCwgJyMxZTdkMTEnKSB9XG4gICAgcGFnZS5jb3B5V2l0aGRyYXdhbElELmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy53aXRoZHJhd2FsSURDb3B5TGlzdGVuZXIpXG4gICAgcGFnZS53aXRoZHJhd2FsSUQuc2V0QXR0cmlidXRlKCd0aXRsZScsIGV2ZW50LmlkKVxuICAgIGNvbnN0IHVuaXRJbmZvID0gYXBwKCkuYXNzZXRzW2V2ZW50LmFzc2V0SURdLnVuaXRJbmZvXG4gICAgY29uc3QgdW5pdCA9IHVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XG4gICAgcGFnZS53aXRoZHJhd2FsQW10LnRleHRDb250ZW50ID0gYCR7RG9jLmZvcm1hdENvaW5WYWx1ZShldmVudC5jZXhEZWJpdCwgdW5pdEluZm8pfSAke3VuaXR9YFxuICAgIHBhZ2Uud2l0aGRyYXdhbFN0YXR1cy50ZXh0Q29udGVudCA9IHBlbmRpbmcgPyBpbnRsLnByZXAoaW50bC5JRF9QRU5ESU5HKSA6IGludGwucHJlcChpbnRsLklEX0NPTVBMRVRFKVxuICAgIGlmIChldmVudC50cmFuc2FjdGlvbikge1xuICAgICAgcGFnZS53aXRoZHJhd2FsVHhJRC50ZXh0Q29udGVudCA9IHRyaW1TdHJpbmdXaXRoRWxsaXBzaXMoZXZlbnQudHJhbnNhY3Rpb24uaWQsIDIwKVxuICAgICAgcGFnZS53aXRoZHJhd2FsVHhJRC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZXZlbnQudHJhbnNhY3Rpb24uaWQpXG4gICAgICBwYWdlLndpdGhkcmF3YWxSZWNlaXZlZC50ZXh0Q29udGVudCA9IGAke0RvYy5mb3JtYXRDb2luVmFsdWUoZXZlbnQudHJhbnNhY3Rpb24uYW1vdW50LCB1bml0SW5mbyl9ICR7dW5pdH1gXG4gICAgfVxuICAgIHRoaXMuZm9ybXMuc2hvdyhwYWdlLndpdGhkcmF3YWxEZXRhaWxzRm9ybSlcbiAgfVxuXG4gIHNob3dFdmVudERldGFpbHMgKGV2ZW50SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IFtldmVudF0gPSB0aGlzLmV2ZW50c1tldmVudElEXVxuICAgIGlmIChldmVudC5kZXhPcmRlckV2ZW50KSB0aGlzLnNob3dEZXhPcmRlckV2ZW50RGV0YWlscyhldmVudC5kZXhPcmRlckV2ZW50KVxuICAgIGlmIChldmVudC5jZXhPcmRlckV2ZW50KSB0aGlzLnNob3dDZXhPcmRlckV2ZW50RGV0YWlscyhldmVudC5jZXhPcmRlckV2ZW50KVxuICAgIGlmIChldmVudC5kZXBvc2l0RXZlbnQpIHRoaXMuc2hvd0RlcG9zaXRFdmVudERldGFpbHMoZXZlbnQuZGVwb3NpdEV2ZW50LCBldmVudC5wZW5kaW5nKVxuICAgIGlmIChldmVudC53aXRoZHJhd2FsRXZlbnQpIHRoaXMuc2hvd1dpdGhkcmF3YWxFdmVudERldGFpbHMoZXZlbnQud2l0aGRyYXdhbEV2ZW50LCBldmVudC5wZW5kaW5nKVxuICB9XG59XG5cbmZ1bmN0aW9uIHRyaW1TdHJpbmdXaXRoRWxsaXBzaXMgKHN0cjogc3RyaW5nLCBtYXhMZW46IG51bWJlcik6IHN0cmluZyB7XG4gIGlmIChzdHIubGVuZ3RoIDw9IG1heExlbikgcmV0dXJuIHN0clxuICByZXR1cm4gYCR7c3RyLnN1YnN0cmluZygwLCBtYXhMZW4gLyAyKX0uLi4ke3N0ci5zdWJzdHJpbmcoc3RyLmxlbmd0aCAtIG1heExlbiAvIDIpfWBcbn1cblxuZnVuY3Rpb24gc3VtQmFsYW5jZUVmZmVjdHMgKGFzc2V0SUQ6IG51bWJlciwgYmU6IEJhbGFuY2VFZmZlY3RzKTogbnVtYmVyIHtcbiAgbGV0IHN1bSA9IDBcbiAgaWYgKGJlLnNldHRsZWRbYXNzZXRJRF0pIHN1bSArPSBiZS5zZXR0bGVkW2Fzc2V0SURdXG4gIGlmIChiZS5wZW5kaW5nW2Fzc2V0SURdKSBzdW0gKz0gYmUucGVuZGluZ1thc3NldElEXVxuICBpZiAoYmUubG9ja2VkW2Fzc2V0SURdKSBzdW0gKz0gYmUubG9ja2VkW2Fzc2V0SURdXG4gIGlmIChiZS5yZXNlcnZlZFthc3NldElEXSkgc3VtICs9IGJlLnJlc2VydmVkW2Fzc2V0SURdXG4gIHJldHVybiBzdW1cbn1cbiIsImltcG9ydCB7XG4gIFBhZ2VFbGVtZW50LFxuICBCb3RDb25maWcsXG4gIE9yZGVyUGxhY2VtZW50LFxuICBhcHAsXG4gIFNwb3QsXG4gIE1hcmtldFJlcG9ydCxcbiAgT3JkZXJPcHRpb24sXG4gIENFWENvbmZpZyxcbiAgQmFzaWNNYXJrZXRNYWtpbmdDb25maWcsXG4gIEFyYk1hcmtldE1ha2luZ0NvbmZpZyxcbiAgU2ltcGxlQXJiQ29uZmlnLFxuICBBcmJNYXJrZXRNYWtpbmdQbGFjZW1lbnQsXG4gIEV4Y2hhbmdlQmFsYW5jZSxcbiAgTWFya2V0TWFraW5nU3RhdHVzLFxuICBNTUNFWFN0YXR1cyxcbiAgQmFsYW5jZU5vdGUsXG4gIEJvdEFzc2V0Q29uZmlnLFxuICBBcHByb3ZhbFN0YXR1cyxcbiAgU3VwcG9ydGVkQXNzZXQsXG4gIFdhbGxldFN0YXRlLFxuICBVbml0SW5mbyxcbiAgUHJvamVjdGVkQWxsb2MsXG4gIEFzc2V0Qm9va2luZ0ZlZXNcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCBEb2MsIHtcbiAgTnVtYmVySW5wdXQsXG4gIE1pbmlTbGlkZXIsXG4gIEluY3JlbWVudGFsSW5wdXQsXG4gIHRvRm91clNpZ0ZpZ3MsXG4gIHRvUHJlY2lzaW9uLFxuICBwYXJzZUZsb2F0RGVmYXVsdFxufSBmcm9tICcuL2RvYydcbmltcG9ydCBTdGF0ZSBmcm9tICcuL3N0YXRlJ1xuaW1wb3J0IEJhc2VQYWdlIGZyb20gJy4vYmFzZXBhZ2UnXG5pbXBvcnQgeyBzZXRPcHRpb25UZW1wbGF0ZXMgfSBmcm9tICcuL29wdHMnXG5pbXBvcnQge1xuICBNTSxcbiAgQ0VYRGlzcGxheUluZm9zLFxuICBib3RUeXBlQmFzaWNBcmIsXG4gIGJvdFR5cGVBcmJNTSxcbiAgYm90VHlwZUJhc2ljTU0sXG4gIHJ1bm5pbmdCb3RJbnZlbnRvcnksXG4gIHNldE1hcmtldEVsZW1lbnRzLFxuICBzZXRDZXhFbGVtZW50cyxcbiAgY2FsY3VsYXRlUXVvdGVMb3QsXG4gIFBsYWNlbWVudHNDaGFydCxcbiAgbGl2ZUJvdENvbmZpZyxcbiAgR2FwU3RyYXRlZ3lNdWx0aXBsaWVyLFxuICBHYXBTdHJhdGVneUFic29sdXRlLFxuICBHYXBTdHJhdGVneUFic29sdXRlUGx1cyxcbiAgR2FwU3RyYXRlZ3lQZXJjZW50LFxuICBHYXBTdHJhdGVneVBlcmNlbnRQbHVzLFxuICBmZWVzQW5kQ29tbWl0XG59IGZyb20gJy4vbW11dGlsJ1xuaW1wb3J0IHsgRm9ybXMsIGJpbmQgYXMgYmluZEZvcm0sIE5ld1dhbGxldEZvcm0sIFRva2VuQXBwcm92YWxGb3JtLCBEZXBvc2l0QWRkcmVzcywgQ0VYQ29uZmlndXJhdGlvbkZvcm0gfSBmcm9tICcuL2Zvcm1zJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQgKiBhcyBPcmRlclV0aWwgZnJvbSAnLi9vcmRlcnV0aWwnXG5cbmNvbnN0IHNwZWNMSyA9ICdsYXN0TU1TcGVjcydcbmNvbnN0IGxhc3RCb3RzTEsgPSAnbGFzdEJvdHMnXG5jb25zdCBsYXN0QXJiRXhjaGFuZ2VMSyA9ICdsYXN0QXJiRXhjaGFuZ2UnXG5jb25zdCBhcmJNTVJvd0NhY2hlS2V5ID0gJ2FyYm1tJ1xuXG5jb25zdCBkZWZhdWx0U3dhcFJlc2VydmVzID0ge1xuICBuOiA1MCxcbiAgcHJlYzogMCxcbiAgaW5jOiAxMCxcbiAgbWluUjogMCxcbiAgbWF4UjogMTAwMCxcbiAgcmFuZ2U6IDEwMDBcbn1cbmNvbnN0IGRlZmF1bHRPcmRlclJlc2VydmVzID0ge1xuICBmYWN0b3I6IDEuMCxcbiAgbWluUjogMCxcbiAgbWF4UjogMyxcbiAgcmFuZ2U6IDMsXG4gIHByZWM6IDNcbn1cbmNvbnN0IGRlZmF1bHRUcmFuc2ZlciA9IHtcbiAgZmFjdG9yOiAwLjEsXG4gIG1pblI6IDAsXG4gIG1heFI6IDEsXG4gIHJhbmdlOiAxXG59XG5jb25zdCBkZWZhdWx0U2xpcHBhZ2UgPSB7XG4gIGZhY3RvcjogMC4wNSxcbiAgbWluUjogMCxcbiAgbWF4UjogMC4zLFxuICByYW5nZTogMC4zLFxuICBwcmVjOiAzXG59XG5jb25zdCBkZWZhdWx0RHJpZnRUb2xlcmFuY2UgPSB7XG4gIHZhbHVlOiAwLjAwMixcbiAgbWluVjogMCxcbiAgbWF4VjogMC4wMixcbiAgcmFuZ2U6IDAuMDIsXG4gIHByZWM6IDVcbn1cbmNvbnN0IGRlZmF1bHRPcmRlclBlcnNpc3RlbmNlID0ge1xuICB2YWx1ZTogMjAsXG4gIG1pblY6IDAsXG4gIG1heFY6IDQwLCAvLyAxMCBtaW51dGVzIEAgMTUgc2Vjb25kIGVwb2Noc1xuICByYW5nZTogNDAsXG4gIHByZWM6IDBcbn1cbmNvbnN0IGRlZmF1bHRQcm9maXQgPSB7XG4gIHByZWM6IDMsXG4gIHZhbHVlOiAwLjAxLFxuICBtaW5WOiAwLjAwMSxcbiAgbWF4VjogMC4xLFxuICByYW5nZTogMC4xIC0gMC4wMDFcbn1cbmNvbnN0IGRlZmF1bHRMZXZlbFNwYWNpbmcgPSB7XG4gIHByZWM6IDMsXG4gIHZhbHVlOiAwLjAwNSxcbiAgbWluVjogMC4wMDEsXG4gIG1heFY6IDAuMDIsXG4gIHJhbmdlOiAwLjAyIC0gMC4wMDAxXG59XG5jb25zdCBkZWZhdWx0TWF0Y2hCdWZmZXIgPSB7XG4gIHZhbHVlOiAwLFxuICBwcmVjOiAzLFxuICBtaW5WOiAwLFxuICBtYXhWOiAxLFxuICByYW5nZTogMVxufVxuY29uc3QgZGVmYXVsdExldmVsc1BlclNpZGUgPSB7XG4gIHByZWM6IDAsXG4gIGluYzogMSxcbiAgdmFsdWU6IDEsXG4gIG1pblY6IDFcbn1cbmNvbnN0IGRlZmF1bHRMb3RzUGVyTGV2ZWwgPSB7XG4gIHByZWM6IDAsXG4gIHZhbHVlOiAxLFxuICBtaW5WOiAxLFxuICB1c2RJbmNyZW1lbnQ6IDEwMFxufVxuY29uc3QgZGVmYXVsdFVTRFBlclNpZGUgPSB7XG4gIHByZWM6IDJcbn1cblxuY29uc3QgZGVmYXVsdE1hcmtldE1ha2luZ0NvbmZpZzogQ29uZmlnU3RhdGUgPSB7XG4gIGdhcFN0cmF0ZWd5OiBHYXBTdHJhdGVneVBlcmNlbnRQbHVzLFxuICBzZWxsUGxhY2VtZW50czogW10sXG4gIGJ1eVBsYWNlbWVudHM6IFtdLFxuICBkcmlmdFRvbGVyYW5jZTogZGVmYXVsdERyaWZ0VG9sZXJhbmNlLnZhbHVlLFxuICBwcm9maXQ6IDAuMDIsXG4gIG9yZGVyUGVyc2lzdGVuY2U6IGRlZmF1bHRPcmRlclBlcnNpc3RlbmNlLnZhbHVlLFxuICBjZXhSZWJhbGFuY2U6IHRydWUsXG4gIHNpbXBsZUFyYkxvdHM6IDFcbn0gYXMgYW55IGFzIENvbmZpZ1N0YXRlXG5cbmNvbnN0IGRlZmF1bHRCb3RBc3NldENvbmZpZzogQm90QXNzZXRDb25maWcgPSB7XG4gIHN3YXBGZWVOOiBkZWZhdWx0U3dhcFJlc2VydmVzLm4sXG4gIG9yZGVyUmVzZXJ2ZXNGYWN0b3I6IGRlZmF1bHRPcmRlclJlc2VydmVzLmZhY3RvcixcbiAgc2xpcHBhZ2VCdWZmZXJGYWN0b3I6IGRlZmF1bHRTbGlwcGFnZS5mYWN0b3IsXG4gIHRyYW5zZmVyRmFjdG9yOiBkZWZhdWx0VHJhbnNmZXIuZmFjdG9yXG59XG5cbi8vIGNleEJ1dHRvbiBzdG9yZXMgcGFydHMgb2YgYSBDRVggc2VsZWN0aW9uIGJ1dHRvbi5cbmludGVyZmFjZSBjZXhCdXR0b24ge1xuICBuYW1lOiBzdHJpbmdcbiAgZGl2OiBQYWdlRWxlbWVudFxuICB0bXBsOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbn1cblxuLypcbiAqIENvbmZpZ1N0YXRlIGlzIGFuIGFtYWxnYW1hdGlvbiBvZiBCb3RDb25maWcsIEFyYk1hcmtldE1ha2luZ0NmZywgYW5kXG4gKiBCYXNpY01hcmtldE1ha2luZ0NmZy4gQ29uZmlnU3RhdGUgdHJhY2tzIHRoZSBnbG9iYWwgc3RhdGUgb2YgdGhlIG9wdGlvbnNcbiAqIHByZXNlbnRlZCBvbiB0aGUgcGFnZSwgd2l0aCBhIHNpbmdsZSBmaWVsZCBmb3IgZWFjaCBvcHRpb24gLyBjb250cm9sIGVsZW1lbnQuXG4gKiBDb25maWdTdGF0ZSBpcyBuZWNlc3NhcnkgYmVjYXVzZSB0aGVyZSBhcmUgZHVwbGljYXRlIGZpZWxkcyBpbiB0aGUgdmFyaW91c1xuICogY29uZmlnIHN0cnVjdHMsIGFuZCB0aGUgcGxhY2VtZW50IHR5cGVzIGFyZSBub3QgaWRlbnRpY2FsLlxuICovXG5pbnRlcmZhY2UgQ29uZmlnU3RhdGUge1xuICBnYXBTdHJhdGVneTogc3RyaW5nXG4gIHByb2ZpdDogbnVtYmVyXG4gIGRyaWZ0VG9sZXJhbmNlOiBudW1iZXJcbiAgb3JkZXJQZXJzaXN0ZW5jZTogbnVtYmVyIC8vIGVwb2Noc1xuICBjZXhSZWJhbGFuY2U6IGJvb2xlYW5cbiAgZGlzYWJsZWQ6IGJvb2xlYW5cbiAgYnV5UGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXVxuICBzZWxsUGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXVxuICBiYXNlT3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICBxdW90ZU9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgYmFzZUNvbmZpZzogQm90QXNzZXRDb25maWdcbiAgcXVvdGVDb25maWc6IEJvdEFzc2V0Q29uZmlnXG4gIHNpbXBsZUFyYkxvdHM6IG51bWJlclxufVxuXG5pbnRlcmZhY2UgQm90U3BlY3Mge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIGJvdFR5cGU6IHN0cmluZ1xuICBjZXhOYW1lPzogc3RyaW5nXG59XG5cbmludGVyZmFjZSBNYXJrZXRSb3cge1xuICB0cjogUGFnZUVsZW1lbnRcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGhvc3Q6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIGFyYnM6IHN0cmluZ1tdXG4gIHNwb3Q6IFNwb3Rcbn1cblxuaW50ZXJmYWNlIFVJT3B0cyB7XG4gIHVzaW5nVVNEUGVyU2lkZT86IGJvb2xlYW5cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFya2V0TWFrZXJTZXR0aW5nc1BhZ2UgZXh0ZW5kcyBCYXNlUGFnZSB7XG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBmb3JtczogRm9ybXNcbiAgb3B0czogVUlPcHRzXG4gIG5ld1dhbGxldEZvcm06IE5ld1dhbGxldEZvcm1cbiAgYXBwcm92ZVRva2VuRm9ybTogVG9rZW5BcHByb3ZhbEZvcm1cbiAgd2FsbGV0QWRkckZvcm06IERlcG9zaXRBZGRyZXNzXG4gIGNleENvbmZpZ0Zvcm06IENFWENvbmZpZ3VyYXRpb25Gb3JtXG4gIGN1cnJlbnRNYXJrZXQ6IHN0cmluZ1xuICBvcmlnaW5hbENvbmZpZzogQ29uZmlnU3RhdGVcbiAgdXBkYXRlZENvbmZpZzogQ29uZmlnU3RhdGVcbiAgY3JlYXRpbmdOZXdCb3Q6IGJvb2xlYW5cbiAgbWFya2V0UmVwb3J0OiBNYXJrZXRSZXBvcnRcbiAgcWNQcm9maXQ6IE51bWJlcklucHV0XG4gIHFjUHJvZml0U2xpZGVyOiBNaW5pU2xpZGVyXG4gIHFjTGV2ZWxTcGFjaW5nOiBOdW1iZXJJbnB1dFxuICBxY0xldmVsU3BhY2luZ1NsaWRlcjogTWluaVNsaWRlclxuICBxY01hdGNoQnVmZmVyOiBOdW1iZXJJbnB1dFxuICBxY01hdGNoQnVmZmVyU2xpZGVyOiBNaW5pU2xpZGVyXG4gIHFjTGV2ZWxzUGVyU2lkZTogSW5jcmVtZW50YWxJbnB1dFxuICBxY0xvdHNQZXJMZXZlbDogSW5jcmVtZW50YWxJbnB1dFxuICBxY1VTRFBlclNpZGU6IEluY3JlbWVudGFsSW5wdXRcbiAgY2V4QmFzZUJhbGFuY2U6IEV4Y2hhbmdlQmFsYW5jZVxuICBjZXhRdW90ZUJhbGFuY2U6IEV4Y2hhbmdlQmFsYW5jZVxuICBzcGVjczogQm90U3BlY3NcbiAgbWt0SUQ6IHN0cmluZ1xuICBmb3JtU3BlY3M6IEJvdFNwZWNzXG4gIGZvcm1DZXhlczogUmVjb3JkPHN0cmluZywgY2V4QnV0dG9uPlxuICBwbGFjZW1lbnRzQ2FjaGU6IFJlY29yZDxzdHJpbmcsIFtPcmRlclBsYWNlbWVudFtdLCBPcmRlclBsYWNlbWVudFtdXT5cbiAgYm90VHlwZVNlbGVjdG9yczogUGFnZUVsZW1lbnRbXVxuICBtYXJrZXRSb3dzOiBNYXJrZXRSb3dbXVxuICBsb3RzUGVyTGV2ZWxJbmNyZW1lbnQ6IG51bWJlclxuICBwbGFjZW1lbnRzQ2hhcnQ6IFBsYWNlbWVudHNDaGFydFxuICBiYXNlUGFuZTogQXNzZXRQYW5lXG4gIHF1b3RlUGFuZTogQXNzZXRQYW5lXG4gIGRyaWZ0VG9sZXJhbmNlOiBOdW1iZXJJbnB1dFxuICBkcmlmdFRvbGVyYW5jZVNsaWRlcjogTWluaVNsaWRlclxuICBvcmRlclBlcnNpc3RlbmNlOiBOdW1iZXJJbnB1dFxuICBvcmRlclBlcnNpc3RlbmNlU2xpZGVyOiBNaW5pU2xpZGVyXG5cbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50LCBzcGVjczogQm90U3BlY3MpIHtcbiAgICBzdXBlcigpXG5cbiAgICB0aGlzLnBsYWNlbWVudHNDYWNoZSA9IHt9XG4gICAgdGhpcy5vcHRzID0ge31cblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhtYWluKVxuXG4gICAgdGhpcy5mb3JtcyA9IG5ldyBGb3JtcyhwYWdlLmZvcm1zLCB7XG4gICAgICBjbG9zZWQ6ICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnNwZWNzPy5ob3N0IHx8ICF0aGlzLnNwZWNzPy5ib3RUeXBlKSBhcHAoKS5sb2FkUGFnZSgnbW0nKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLnBsYWNlbWVudHNDaGFydCA9IG5ldyBQbGFjZW1lbnRzQ2hhcnQocGFnZS5wbGFjZW1lbnRzQ2hhcnQpXG4gICAgdGhpcy5hcHByb3ZlVG9rZW5Gb3JtID0gbmV3IFRva2VuQXBwcm92YWxGb3JtKHBhZ2UuYXBwcm92ZVRva2VuRm9ybSwgKCkgPT4geyB0aGlzLnN1Ym1pdEJvdFR5cGUoKSB9KVxuICAgIHRoaXMud2FsbGV0QWRkckZvcm0gPSBuZXcgRGVwb3NpdEFkZHJlc3MocGFnZS53YWxsZXRBZGRyRm9ybSlcbiAgICB0aGlzLmNleENvbmZpZ0Zvcm0gPSBuZXcgQ0VYQ29uZmlndXJhdGlvbkZvcm0ocGFnZS5jZXhDb25maWdGb3JtLCAoY2V4TmFtZTogc3RyaW5nKSA9PiB0aGlzLmNleENvbmZpZ3VyZWQoY2V4TmFtZSkpXG4gICAgcGFnZS5xdW90ZVBhbmUgPSBwYWdlLmJhc2VQYW5lLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIHBhZ2UuYXNzZXRQYW5lQm94LmFwcGVuZENoaWxkKHBhZ2UucXVvdGVQYW5lKVxuICAgIHRoaXMuYmFzZVBhbmUgPSBuZXcgQXNzZXRQYW5lKHRoaXMsIHBhZ2UuYmFzZVBhbmUpXG4gICAgdGhpcy5xdW90ZVBhbmUgPSBuZXcgQXNzZXRQYW5lKHRoaXMsIHBhZ2UucXVvdGVQYW5lKVxuXG4gICAgYXBwKCkuaGVhZGVyU3BhY2UuYXBwZW5kQ2hpbGQocGFnZS5tbVRpdGxlKVxuXG4gICAgc2V0T3B0aW9uVGVtcGxhdGVzKHBhZ2UpXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKFxuICAgICAgcGFnZS5vcmRlck9wdFRtcGwsIHBhZ2UuYm9vbGVhbk9wdFRtcGwsIHBhZ2UucmFuZ2VPcHRUbXBsLCBwYWdlLnBsYWNlbWVudFJvd1RtcGwsXG4gICAgICBwYWdlLm9yYWNsZVRtcGwsIHBhZ2UuY2V4T3B0VG1wbCwgcGFnZS5hcmJCdHRuVG1wbCwgcGFnZS5tYXJrZXRSb3dUbXBsLCBwYWdlLm5lZWRSZWdUbXBsXG4gICAgKVxuICAgIHBhZ2UuYmFzZVBhbmUucmVtb3ZlQXR0cmlidXRlKCdpZCcpIC8vIGRvbid0IHJlbW92ZSBmcm9tIGxheW91dFxuXG4gICAgRG9jLmJpbmQocGFnZS5yZXNldEJ1dHRvbiwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNldE9yaWdpbmFsVmFsdWVzKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnVwZGF0ZUJ1dHRvbiwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNhdmVTZXR0aW5ncygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5jcmVhdGVCdXR0b24sICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5zYXZlU2V0dGluZ3MoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuZGVsZXRlQnR0biwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmRlbGV0ZSgpIH0pXG4gICAgYmluZEZvcm0ocGFnZS5ib3RUeXBlRm9ybSwgcGFnZS5ib3RUeXBlU3VibWl0LCAoKSA9PiB7IHRoaXMuc3VibWl0Qm90VHlwZSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5ub01hcmtldEJ0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93TWFya2V0U2VsZWN0Rm9ybSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5ib3RUeXBlSGVhZGVyLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMucmVzaG93Qm90VHlwZUZvcm0oKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuYm90VHlwZUNoYW5nZU1hcmtldCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dNYXJrZXRTZWxlY3RGb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLm1hcmtldEhlYWRlciwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dNYXJrZXRTZWxlY3RGb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLm1hcmtldEZpbHRlcklucHV0LCAnaW5wdXQnLCAoKSA9PiB7IHRoaXMuc29ydE1hcmtldFJvd3MoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuY2V4UmViYWxhbmNlQ2hlY2tib3gsICdjaGFuZ2UnLCAoKSA9PiB7IHRoaXMuYXV0b1JlYmFsYW5jZUNoYW5nZWQoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc3dpdGNoVG9BZHZhbmNlZCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dBZHZhbmNlZENvbmZpZygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zd2l0Y2hUb1F1aWNrQ29uZmlnLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc3dpdGNoVG9RdWlja0NvbmZpZygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5xY01hdGNoQnVmZmVyLCAnY2hhbmdlJywgKCkgPT4geyB0aGlzLm1hdGNoQnVmZmVyQ2hhbmdlZCgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zd2l0Y2hUb1VTRFBlclNpZGUsICdjbGljaycsICgpID0+IHsgdGhpcy5jaGFuZ2VTaWRlQ29tbWl0bWVudERpYWxvZygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zd2l0Y2hUb0xvdHNQZXJMZXZlbCwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLmNoYW5nZVNpZGVDb21taXRtZW50RGlhbG9nKCkgfSlcbiAgICAvLyBHYXAgU3RyYXRlZ3lcbiAgICBEb2MuYmluZChwYWdlLmdhcFN0cmF0ZWd5U2VsZWN0LCAnY2hhbmdlJywgKCkgPT4ge1xuICAgICAgaWYgKCFwYWdlLmdhcFN0cmF0ZWd5U2VsZWN0LnZhbHVlKSByZXR1cm5cbiAgICAgIGNvbnN0IGdhcFN0cmF0ZWd5ID0gcGFnZS5nYXBTdHJhdGVneVNlbGVjdC52YWx1ZVxuICAgICAgdGhpcy5jbGVhclBsYWNlbWVudHModGhpcy51cGRhdGVkQ29uZmlnLmdhcFN0cmF0ZWd5KVxuICAgICAgdGhpcy5sb2FkQ2FjaGVkUGxhY2VtZW50cyhnYXBTdHJhdGVneSlcbiAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5nYXBTdHJhdGVneSA9IGdhcFN0cmF0ZWd5XG4gICAgICB0aGlzLnNldEdhcEZhY3RvckxhYmVscyhnYXBTdHJhdGVneSlcbiAgICAgIHRoaXMudXBkYXRlTW9kaWZpZWRNYXJrZXJzKClcbiAgICB9KVxuXG4gICAgLy8gQnV5L1NlbGwgcGxhY2VtZW50c1xuICAgIERvYy5iaW5kKHBhZ2UuYWRkQnV5UGxhY2VtZW50QnRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLmFkZFBsYWNlbWVudCh0cnVlLCBudWxsKVxuICAgICAgcGFnZS5hZGRCdXlQbGFjZW1lbnRMb3RzLnZhbHVlID0gJydcbiAgICAgIHBhZ2UuYWRkQnV5UGxhY2VtZW50R2FwRmFjdG9yLnZhbHVlID0gJydcbiAgICAgIHRoaXMudXBkYXRlTW9kaWZpZWRNYXJrZXJzKClcbiAgICAgIHRoaXMucGxhY2VtZW50c0NoYXJ0LnJlbmRlcigpXG4gICAgICB0aGlzLnVwZGF0ZUFsbG9jYXRpb25zKClcbiAgICB9KVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkU2VsbFBsYWNlbWVudEJ0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5hZGRQbGFjZW1lbnQoZmFsc2UsIG51bGwpXG4gICAgICBwYWdlLmFkZFNlbGxQbGFjZW1lbnRMb3RzLnZhbHVlID0gJydcbiAgICAgIHBhZ2UuYWRkU2VsbFBsYWNlbWVudEdhcEZhY3Rvci52YWx1ZSA9ICcnXG4gICAgICB0aGlzLnVwZGF0ZU1vZGlmaWVkTWFya2VycygpXG4gICAgICB0aGlzLnBsYWNlbWVudHNDaGFydC5yZW5kZXIoKVxuICAgICAgdGhpcy51cGRhdGVBbGxvY2F0aW9ucygpXG4gICAgfSlcblxuICAgIHRoaXMuZHJpZnRUb2xlcmFuY2UgPSBuZXcgTnVtYmVySW5wdXQocGFnZS5kcmlmdFRvbGVyYW5jZUlucHV0LCB7XG4gICAgICBwcmVjOiBkZWZhdWx0RHJpZnRUb2xlcmFuY2UucHJlYyAtIDIsIC8vIGNvbnZlcnRpbmcgdG8gcGVyY2VudCBmb3IgZGlzcGxheVxuICAgICAgc2lnRmlnczogdHJ1ZSxcbiAgICAgIG1pbjogMCxcbiAgICAgIGNoYW5nZWQ6IChyYXdWOiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc3QgeyBtaW5WLCByYW5nZSwgcHJlYyB9ID0gZGVmYXVsdERyaWZ0VG9sZXJhbmNlXG4gICAgICAgIGNvbnN0IFt2XSA9IHRvRm91clNpZ0ZpZ3MocmF3ViAvIDEwMCwgcHJlYylcbiAgICAgICAgdGhpcy5kcmlmdFRvbGVyYW5jZVNsaWRlci5zZXRWYWx1ZSgodiAtIG1pblYpIC8gcmFuZ2UpXG4gICAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5kcmlmdFRvbGVyYW5jZSA9IHZcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5kcmlmdFRvbGVyYW5jZVNsaWRlciA9IG5ldyBNaW5pU2xpZGVyKHBhZ2UuZHJpZnRUb2xlcmFuY2VTbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UsIHByZWMgfSA9IGRlZmF1bHREcmlmdFRvbGVyYW5jZVxuICAgICAgY29uc3QgW3ZdID0gdG9Gb3VyU2lnRmlncyhtaW5WICsgciAqIHJhbmdlLCBwcmVjKVxuICAgICAgdGhpcy51cGRhdGVkQ29uZmlnLmRyaWZ0VG9sZXJhbmNlID0gdlxuICAgICAgdGhpcy5kcmlmdFRvbGVyYW5jZS5zZXRWYWx1ZSh2ICogMTAwKVxuICAgIH0pXG5cbiAgICB0aGlzLm9yZGVyUGVyc2lzdGVuY2UgPSBuZXcgTnVtYmVySW5wdXQocGFnZS5vcmRlclBlcnNpc3RlbmNlLCB7XG4gICAgICBjaGFuZ2VkOiAodjogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UgfSA9IGRlZmF1bHRPcmRlclBlcnNpc3RlbmNlXG4gICAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5vcmRlclBlcnNpc3RlbmNlID0gdlxuICAgICAgICB0aGlzLm9yZGVyUGVyc2lzdGVuY2VTbGlkZXIuc2V0VmFsdWUoKHYgLSBtaW5WKSAvIHJhbmdlKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLm9yZGVyUGVyc2lzdGVuY2VTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLm9yZGVyUGVyc2lzdGVuY2VTbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UsIHByZWMgfSA9IGRlZmF1bHRPcmRlclBlcnNpc3RlbmNlXG4gICAgICBjb25zdCByYXdWID0gbWluViArIHIgKiByYW5nZVxuICAgICAgY29uc3QgW3ZdID0gdG9QcmVjaXNpb24ocmF3ViwgcHJlYylcbiAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5vcmRlclBlcnNpc3RlbmNlID0gdlxuICAgICAgdGhpcy5vcmRlclBlcnNpc3RlbmNlLnNldFZhbHVlKHYpXG4gICAgfSlcblxuICAgIHRoaXMucWNQcm9maXQgPSBuZXcgTnVtYmVySW5wdXQocGFnZS5xY1Byb2ZpdCwge1xuICAgICAgcHJlYzogZGVmYXVsdFByb2ZpdC5wcmVjIC0gMiwgLy8gY29udmVydGluZyB0byBwZXJjZW50XG4gICAgICBzaWdGaWdzOiB0cnVlLFxuICAgICAgbWluOiBkZWZhdWx0UHJvZml0Lm1pblYgKiAxMDAsXG4gICAgICBjaGFuZ2VkOiAodlBjdDogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UgfSA9IGRlZmF1bHRQcm9maXRcbiAgICAgICAgY29uc3QgdiA9IHZQY3QgLyAxMDBcbiAgICAgICAgdGhpcy51cGRhdGVkQ29uZmlnLnByb2ZpdCA9IHZcbiAgICAgICAgcGFnZS5wcm9maXRJbnB1dC52YWx1ZSA9IHRoaXMucWNQcm9maXQuaW5wdXQudmFsdWVcbiAgICAgICAgdGhpcy5xY1Byb2ZpdFNsaWRlci5zZXRWYWx1ZSgodiAtIG1pblYpIC8gcmFuZ2UpXG4gICAgICAgIHRoaXMucXVpY2tDb25maWdVcGRhdGVkKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5xY1Byb2ZpdFNsaWRlciA9IG5ldyBNaW5pU2xpZGVyKHBhZ2UucWNQcm9maXRTbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UsIHByZWMgfSA9IGRlZmF1bHRQcm9maXRcbiAgICAgIGNvbnN0IFt2XSA9IHRvRm91clNpZ0ZpZ3MoKG1pblYgKyByICogcmFuZ2UpICogMTAwLCBwcmVjKVxuICAgICAgdGhpcy51cGRhdGVkQ29uZmlnLnByb2ZpdCA9IHYgLyAxMDBcbiAgICAgIHRoaXMucWNQcm9maXQuc2V0VmFsdWUodilcbiAgICAgIHBhZ2UucHJvZml0SW5wdXQudmFsdWUgPSB0aGlzLnFjUHJvZml0LmlucHV0LnZhbHVlXG4gICAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gICAgfSlcblxuICAgIHRoaXMucWNMZXZlbFNwYWNpbmcgPSBuZXcgTnVtYmVySW5wdXQocGFnZS5xY0xldmVsU3BhY2luZywge1xuICAgICAgcHJlYzogZGVmYXVsdExldmVsU3BhY2luZy5wcmVjIC0gMiwgLy8gY29udmVydGluZyB0byBwZXJjZW50XG4gICAgICBzaWdGaWdzOiB0cnVlLFxuICAgICAgbWluOiBkZWZhdWx0TGV2ZWxTcGFjaW5nLm1pblYgKiAxMDAsXG4gICAgICBjaGFuZ2VkOiAodlBjdDogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UgfSA9IGRlZmF1bHRMZXZlbFNwYWNpbmdcbiAgICAgICAgdGhpcy5xY0xldmVsU3BhY2luZ1NsaWRlci5zZXRWYWx1ZSgodlBjdCAvIDEwMCAtIG1pblYpIC8gcmFuZ2UpXG4gICAgICAgIHRoaXMucXVpY2tDb25maWdVcGRhdGVkKClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5xY0xldmVsU3BhY2luZ1NsaWRlciA9IG5ldyBNaW5pU2xpZGVyKHBhZ2UucWNMZXZlbFNwYWNpbmdTbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UgfSA9IGRlZmF1bHRMZXZlbFNwYWNpbmdcbiAgICAgIHRoaXMucWNMZXZlbFNwYWNpbmcuc2V0VmFsdWUobWluViArIHIgKiByYW5nZSAqIDEwMClcbiAgICAgIHRoaXMucXVpY2tDb25maWdVcGRhdGVkKClcbiAgICB9KVxuXG4gICAgdGhpcy5xY01hdGNoQnVmZmVyID0gbmV3IE51bWJlcklucHV0KHBhZ2UucWNNYXRjaEJ1ZmZlciwge1xuICAgICAgcHJlYzogZGVmYXVsdE1hdGNoQnVmZmVyLnByZWMgLSAyLCAvLyBjb252ZXJ0aW5nIHRvIHBlcmNlbnRcbiAgICAgIHNpZ0ZpZ3M6IHRydWUsXG4gICAgICBtaW46IGRlZmF1bHRNYXRjaEJ1ZmZlci5taW5WICogMTAwLFxuICAgICAgY2hhbmdlZDogKHZQY3Q6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IG1pblYsIHJhbmdlIH0gPSBkZWZhdWx0TWF0Y2hCdWZmZXJcbiAgICAgICAgdGhpcy5xY01hdGNoQnVmZmVyU2xpZGVyLnNldFZhbHVlKCh2UGN0IC8gMTAwIC0gbWluVikgLyByYW5nZSlcbiAgICAgICAgdGhpcy5xdWlja0NvbmZpZ1VwZGF0ZWQoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLnFjTWF0Y2hCdWZmZXJTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLnFjTWF0Y2hCdWZmZXJTbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgbWluViwgcmFuZ2UgfSA9IGRlZmF1bHRNYXRjaEJ1ZmZlclxuICAgICAgdGhpcy5xY01hdGNoQnVmZmVyLnNldFZhbHVlKG1pblYgKyByICogcmFuZ2UgKiAxMDApXG4gICAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gICAgfSlcblxuICAgIHRoaXMucWNMZXZlbHNQZXJTaWRlID0gbmV3IEluY3JlbWVudGFsSW5wdXQocGFnZS5xY0xldmVsc1BlclNpZGUsIHtcbiAgICAgIHByZWM6IGRlZmF1bHRMZXZlbHNQZXJTaWRlLnByZWMsXG4gICAgICBtaW46IGRlZmF1bHRMZXZlbHNQZXJTaWRlLm1pblYsXG4gICAgICBpbmM6IGRlZmF1bHRMZXZlbHNQZXJTaWRlLmluYyxcbiAgICAgIGNoYW5nZWQ6ICh2OiBudW1iZXIpID0+IHtcbiAgICAgICAgdGhpcy5xY1VTRFBlclNpZGUuc2V0VmFsdWUodGhpcy5sb3RTaXplVVNEKCkgKiB2ICogdGhpcy5xY0xvdHNQZXJMZXZlbC52YWx1ZSgpKVxuICAgICAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMucWNMb3RzUGVyTGV2ZWwgPSBuZXcgSW5jcmVtZW50YWxJbnB1dChwYWdlLnFjTG90c1BlckxldmVsLCB7XG4gICAgICBwcmVjOiBkZWZhdWx0TG90c1BlckxldmVsLnByZWMsXG4gICAgICBtaW46IGRlZmF1bHRMb3RzUGVyTGV2ZWwubWluVixcbiAgICAgIGluYzogMSwgLy8gc2V0IHNob3dRdWlja0NvbmZpZ1xuICAgICAgY2hhbmdlZDogKHY6IG51bWJlcikgPT4ge1xuICAgICAgICB0aGlzLnFjVVNEUGVyU2lkZS5zZXRWYWx1ZSh0aGlzLmxvdFNpemVVU0QoKSAqIHYgKiB0aGlzLnFjTGV2ZWxzUGVyU2lkZS52YWx1ZSgpKVxuICAgICAgICBwYWdlLnFjVVNEUGVyU2lkZUVjaG8udGV4dENvbnRlbnQgPSB0aGlzLnFjVVNEUGVyU2lkZS5pbnB1dC52YWx1ZSBhcyBzdHJpbmdcbiAgICAgICAgdGhpcy5xdWlja0NvbmZpZ1VwZGF0ZWQoKVxuICAgICAgfSxcbiAgICAgIHNldDogKHY6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCBbLCBzXSA9IHRvRm91clNpZ0ZpZ3ModiAqIHRoaXMucWNMZXZlbHNQZXJTaWRlLnZhbHVlKCkgKiB0aGlzLmxvdFNpemVVU0QoKSwgMilcbiAgICAgICAgcGFnZS5xY1VTRFBlclNpZGVFY2hvLnRleHRDb250ZW50ID0gc1xuICAgICAgICBwYWdlLnFjTG90c1BlckxldmVsRWNoby50ZXh0Q29udGVudCA9IHNcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5xY1VTRFBlclNpZGUgPSBuZXcgSW5jcmVtZW50YWxJbnB1dChwYWdlLnFjVVNEUGVyU2lkZSwge1xuICAgICAgcHJlYzogZGVmYXVsdFVTRFBlclNpZGUucHJlYyxcbiAgICAgIG1pbjogMSwgLy8gY2hhbmdlZCBieSBzaG93UXVpY2tDb25maWdcbiAgICAgIGluYzogMSwgLy8gY2hhbmdlZCBieSBzaG93UXVpY2tDb25maWdcbiAgICAgIGNoYW5nZWQ6ICh2OiBudW1iZXIpID0+IHtcbiAgICAgICAgdGhpcy5xY0xvdHNQZXJMZXZlbC5zZXRWYWx1ZSh2IC8gdGhpcy5xY0xldmVsc1BlclNpZGUudmFsdWUoKSAvIHRoaXMubG90U2l6ZVVTRCgpKVxuICAgICAgICBwYWdlLnFjTG90c1BlckxldmVsRWNoby50ZXh0Q29udGVudCA9IHRoaXMucWNMb3RzUGVyTGV2ZWwuaW5wdXQudmFsdWUgYXMgc3RyaW5nXG4gICAgICAgIHRoaXMucXVpY2tDb25maWdVcGRhdGVkKClcbiAgICAgIH0sXG4gICAgICBzZXQ6ICh2OiBudW1iZXIsIHM6IHN0cmluZykgPT4ge1xuICAgICAgICBwYWdlLnFjVVNEUGVyU2lkZUVjaG8udGV4dENvbnRlbnQgPSBzXG4gICAgICAgIHBhZ2UucWNMb3RzUGVyTGV2ZWxFY2hvLnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQodiAvIHRoaXMubG90U2l6ZVVTRCgpKSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgY29uc3QgbWF5YmVTdWJtaXRCdXlSb3cgPSAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgaWYgKGUua2V5ICE9PSAnRW50ZXInKSByZXR1cm5cbiAgICAgIGlmIChcbiAgICAgICAgIWlzTmFOKHBhcnNlRmxvYXQocGFnZS5hZGRCdXlQbGFjZW1lbnRHYXBGYWN0b3IudmFsdWUgfHwgJycpKSAmJlxuICAgICAgICAhaXNOYU4ocGFyc2VGbG9hdChwYWdlLmFkZEJ1eVBsYWNlbWVudExvdHMudmFsdWUgfHwgJycpKVxuICAgICAgKSB7XG4gICAgICAgIHBhZ2UuYWRkQnV5UGxhY2VtZW50QnRuLmNsaWNrKClcbiAgICAgIH1cbiAgICB9XG4gICAgRG9jLmJpbmQocGFnZS5hZGRCdXlQbGFjZW1lbnRHYXBGYWN0b3IsICdrZXl1cCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7IG1heWJlU3VibWl0QnV5Um93KGUpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5hZGRCdXlQbGFjZW1lbnRMb3RzLCAna2V5dXAnLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4geyBtYXliZVN1Ym1pdEJ1eVJvdyhlKSB9KVxuXG4gICAgY29uc3QgbWF5YmVTdWJtaXRTZWxsUm93ID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSAhPT0gJ0VudGVyJykgcmV0dXJuXG4gICAgICBpZiAoXG4gICAgICAgICFpc05hTihwYXJzZUZsb2F0KHBhZ2UuYWRkU2VsbFBsYWNlbWVudEdhcEZhY3Rvci52YWx1ZSB8fCAnJykpICYmXG4gICAgICAgICFpc05hTihwYXJzZUZsb2F0KHBhZ2UuYWRkU2VsbFBsYWNlbWVudExvdHMudmFsdWUgfHwgJycpKVxuICAgICAgKSB7XG4gICAgICAgIHBhZ2UuYWRkU2VsbFBsYWNlbWVudEJ0bi5jbGljaygpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkU2VsbFBsYWNlbWVudEdhcEZhY3RvciwgJ2tleXVwJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHsgbWF5YmVTdWJtaXRTZWxsUm93KGUpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5hZGRTZWxsUGxhY2VtZW50TG90cywgJ2tleXVwJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHsgbWF5YmVTdWJtaXRTZWxsUm93KGUpIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLnByb2ZpdElucHV0LCAnY2hhbmdlJywgKCkgPT4ge1xuICAgICAgRG9jLmhpZGUocGFnZS5wcm9maXRJbnB1dEVycilcbiAgICAgIGNvbnN0IHNob3dFcnJvciA9IChlcnJJRDogc3RyaW5nKSA9PiB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UucHJvZml0SW5wdXRFcnIpXG4gICAgICAgIHBhZ2UucHJvZml0SW5wdXRFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoZXJySUQpXG4gICAgICB9XG4gICAgICBjb25zdCBwcm9maXQgPSBwYXJzZUZsb2F0KHBhZ2UucHJvZml0SW5wdXQudmFsdWUgfHwgJycpIC8gMTAwXG4gICAgICBpZiAoaXNOYU4ocHJvZml0KSkgcmV0dXJuIHNob3dFcnJvcihpbnRsLklEX0lOVkFMSURfVkFMVUUpXG4gICAgICBpZiAocHJvZml0ID09PSAwKSByZXR1cm4gc2hvd0Vycm9yKGludGwuSURfTk9fWkVSTylcbiAgICAgIHRoaXMudXBkYXRlZENvbmZpZy5wcm9maXQgPSBwcm9maXRcbiAgICAgIHRoaXMudXBkYXRlTW9kaWZpZWRNYXJrZXJzKClcbiAgICB9KVxuXG4gICAgdGhpcy5ib3RUeXBlU2VsZWN0b3JzID0gRG9jLmFwcGx5U2VsZWN0b3IocGFnZS5ib3RUeXBlRm9ybSwgJ1tkYXRhLWJvdC10eXBlXScpXG4gICAgZm9yIChjb25zdCBkaXYgb2YgdGhpcy5ib3RUeXBlU2VsZWN0b3JzKSB7XG4gICAgICBEb2MuYmluZChkaXYsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKGRpdi5jbGFzc0xpc3QuY29udGFpbnMoJ2Rpc2FibGVkJykpIHJldHVyblxuICAgICAgICBEb2MuaGlkZShwYWdlLmJvdFR5cGVFcnIpXG4gICAgICAgIHBhZ2UuY2V4U2VsZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2Rpc2FibGVkJywgZGl2LmRhdGFzZXQuYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljTU0pXG4gICAgICAgIHRoaXMuc2V0Qm90VHlwZVNlbGVjdGVkKGRpdi5kYXRhc2V0LmJvdFR5cGUgYXMgc3RyaW5nKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICB0aGlzLm5ld1dhbGxldEZvcm0gPSBuZXcgTmV3V2FsbGV0Rm9ybShcbiAgICAgIHBhZ2UubmV3V2FsbGV0Rm9ybSxcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICAgICAgdGhpcy5zdWJtaXRCb3RUeXBlKClcbiAgICAgIH1cbiAgICApXG5cbiAgICBhcHAoKS5yZWdpc3Rlck5vdGVGZWVkZXIoe1xuICAgICAgYmFsYW5jZTogKG5vdGU6IEJhbGFuY2VOb3RlKSA9PiB7IHRoaXMuaGFuZGxlQmFsYW5jZU5vdGUobm90ZSkgfVxuICAgIH0pXG5cbiAgICB0aGlzLmluaXRpYWxpemUoc3BlY3MpXG4gIH1cblxuICB1bmxvYWQgKCkge1xuICAgIHRoaXMuZm9ybXMuZXhpdCgpXG4gIH1cblxuICBhc3luYyBpbml0aWFsaXplIChzcGVjcz86IEJvdFNwZWNzKSB7XG4gICAgdGhpcy5zZXR1cENFWGVzKClcbiAgICB0aGlzLmluaXRpYWxpemVNYXJrZXRSb3dzKClcblxuICAgIGNvbnN0IGlzUmVmcmVzaCA9IHNwZWNzICYmIE9iamVjdC5rZXlzKHNwZWNzKS5sZW5ndGggPT09IDBcbiAgICBpZiAoaXNSZWZyZXNoKSBzcGVjcyA9IFN0YXRlLmZldGNoTG9jYWwoc3BlY0xLKVxuICAgIGlmICghc3BlY3MgfHwgIWFwcCgpLndhbGxldE1hcFtzcGVjcy5iYXNlSURdIHx8ICFhcHAoKS53YWxsZXRNYXBbc3BlY3MucXVvdGVJRF0pIHtcbiAgICAgIHRoaXMuc2hvd01hcmtldFNlbGVjdEZvcm0oKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gSWYgd2UgaGF2ZSBzcGVjcyBzcGVjaWZ5aW5nIG9ubHkgYSBtYXJrZXQsIG1ha2Ugc3VyZSB0aGUgY2V4IG5hbWUgYW5kXG4gICAgLy8gYm90IHR5cGUgYXJlIHNldC5cbiAgICBpZiAoc3BlY3MgJiYgIXNwZWNzLmJvdFR5cGUpIHtcbiAgICAgIGNvbnN0IGJvdENmZyA9IGxpdmVCb3RDb25maWcoc3BlY3MuaG9zdCwgc3BlY3MuYmFzZUlELCBzcGVjcy5xdW90ZUlEKVxuICAgICAgc3BlY3MuY2V4TmFtZSA9IGJvdENmZz8uY2V4TmFtZSA/PyAnJ1xuICAgICAgc3BlY3MuYm90VHlwZSA9IGJvdFR5cGVCYXNpY01NXG4gICAgICBpZiAoYm90Q2ZnPy5hcmJNYXJrZXRNYWtpbmdDb25maWcpIHNwZWNzLmJvdFR5cGUgPSBib3RUeXBlQXJiTU1cbiAgICAgIGVsc2UgaWYgKGJvdENmZz8uc2ltcGxlQXJiQ29uZmlnKSBzcGVjcy5ib3RUeXBlID0gYm90VHlwZUJhc2ljQXJiXG4gICAgfVxuXG4gICAgLy8gTXVzdCBiZSBhIHJlY29uZmlnLlxuICAgIHRoaXMuc3BlY3MgPSBzcGVjc1xuICAgIGF3YWl0IHRoaXMuZmV0Y2hDRVhCYWxhbmNlcyhzcGVjcylcbiAgICB0aGlzLmNvbmZpZ3VyZVVJKClcbiAgfVxuXG4gIGFzeW5jIGNvbmZpZ3VyZVVJICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHNwZWNzIH0gPSB0aGlzXG4gICAgY29uc3QgeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUsIGJvdFR5cGUgfSA9IHNwZWNzXG5cbiAgICBjb25zdCBbeyBzeW1ib2w6IGJhc2VTeW1ib2wsIHRva2VuOiBiYXNlVG9rZW4gfSwgeyBzeW1ib2w6IHF1b3RlU3ltYm9sLCB0b2tlbjogcXVvdGVUb2tlbiB9XSA9IFthcHAoKS5hc3NldHNbYmFzZUlEXSwgYXBwKCkuYXNzZXRzW3F1b3RlSURdXVxuICAgIHRoaXMubWt0SUQgPSBgJHtiYXNlU3ltYm9sfV8ke3F1b3RlU3ltYm9sfWBcbiAgICBEb2MuaGlkZShcbiAgICAgIHBhZ2UuYm90U2V0dGluZ3NDb250YWluZXIsIHBhZ2UubWFya2V0Qm94LCBwYWdlLnVwZGF0ZUJ1dHRvbiwgcGFnZS5yZXNldEJ1dHRvbixcbiAgICAgIHBhZ2UuY3JlYXRlQnV0dG9uLCBwYWdlLm5vTWFya2V0LCBwYWdlLm1pc3NpbmdGaWF0UmF0ZXNcbiAgICApXG5cbiAgICBpZiAoW2Jhc2VJRCwgcXVvdGVJRCwgYmFzZVRva2VuPy5wYXJlbnRJRCA/PyBiYXNlSUQsIHF1b3RlVG9rZW4/LnBhcmVudElEID8/IHF1b3RlSURdLnNvbWUoKGFzc2V0SUQ6IG51bWJlcikgPT4gIWFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXSkpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UubWlzc2luZ0ZpYXRSYXRlcylcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIERvYy5zaG93KHBhZ2UubWFya2V0TG9hZGluZylcbiAgICBTdGF0ZS5zdG9yZUxvY2FsKHNwZWNMSywgc3BlY3MpXG5cbiAgICBjb25zdCBtbVN0YXR1cyA9IGFwcCgpLm1tU3RhdHVzXG4gICAgY29uc3Qgdmlld09ubHkgPSBpc1ZpZXdPbmx5KHNwZWNzLCBtbVN0YXR1cylcbiAgICBsZXQgYm90Q2ZnID0gbGl2ZUJvdENvbmZpZyhob3N0LCBiYXNlSUQsIHF1b3RlSUQpXG4gICAgaWYgKGJvdENmZykge1xuICAgICAgY29uc3Qgb2xkQm90VHlwZSA9IGJvdENmZy5hcmJNYXJrZXRNYWtpbmdDb25maWcgPyBib3RUeXBlQXJiTU0gOiBib3RDZmcuYmFzaWNNYXJrZXRNYWtpbmdDb25maWcgPyBib3RUeXBlQmFzaWNNTSA6IGJvdFR5cGVCYXNpY0FyYlxuICAgICAgaWYgKG9sZEJvdFR5cGUgIT09IGJvdFR5cGUpIGJvdENmZyA9IHVuZGVmaW5lZFxuICAgIH1cbiAgICBEb2Muc2V0VmlzKGJvdENmZywgcGFnZS5kZWxldGVCdHRuQm94KVxuXG4gICAgY29uc3Qgb2xkQ2ZnID0gdGhpcy5vcmlnaW5hbENvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRNYXJrZXRNYWtpbmdDb25maWcsIHtcbiAgICAgIGRpc2FibGVkOiB2aWV3T25seSxcbiAgICAgIGJhc2VPcHRpb25zOiB0aGlzLmRlZmF1bHRXYWxsZXRPcHRpb25zKGJhc2VJRCksXG4gICAgICBxdW90ZU9wdGlvbnM6IHRoaXMuZGVmYXVsdFdhbGxldE9wdGlvbnMocXVvdGVJRCksXG4gICAgICBidXlQbGFjZW1lbnRzOiBbXSxcbiAgICAgIHNlbGxQbGFjZW1lbnRzOiBbXSxcbiAgICAgIGJhc2VDb25maWc6IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRCb3RBc3NldENvbmZpZyksXG4gICAgICBxdW90ZUNvbmZpZzogT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdEJvdEFzc2V0Q29uZmlnKVxuICAgIH0pIGFzIENvbmZpZ1N0YXRlXG5cbiAgICBpZiAoYm90Q2ZnKSB7XG4gICAgICBjb25zdCB7IGJhc2ljTWFya2V0TWFraW5nQ29uZmlnOiBtbUNmZywgYXJiTWFya2V0TWFraW5nQ29uZmlnOiBhcmJNTUNmZywgc2ltcGxlQXJiQ29uZmlnOiBhcmJDZmcsIHVpQ29uZmlnOiB7IGNleFJlYmFsYW5jZSB9IH0gPSBib3RDZmdcbiAgICAgIHRoaXMuY3JlYXRpbmdOZXdCb3QgPSBmYWxzZVxuICAgICAgLy8gVGhpcyBpcyBraW5kYSBzbG9wcHksIGJ1dCB3ZSdsbCBjb3B5IGFueSByZWxldmFudCBpc3N1ZXMgZnJvbSB0aGVcbiAgICAgIC8vIG9sZCBjb25maWcgaW50byB0aGUgb3JpZ2luYWxDb25maWcuXG4gICAgICBjb25zdCBpZHggPSBvbGRDZmcgYXMgeyBbazogc3RyaW5nXTogYW55IH0gLy8gdHlwZXNjcmlwdFxuICAgICAgZm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMoYm90Q2ZnKSkgaWYgKGlkeFtrXSAhPT0gdW5kZWZpbmVkKSBpZHhba10gPSB2XG5cbiAgICAgIG9sZENmZy5iYXNlQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdEJvdEFzc2V0Q29uZmlnLCBib3RDZmcudWlDb25maWcuYmFzZUNvbmZpZylcbiAgICAgIG9sZENmZy5xdW90ZUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRCb3RBc3NldENvbmZpZywgYm90Q2ZnLnVpQ29uZmlnLnF1b3RlQ29uZmlnKVxuICAgICAgb2xkQ2ZnLmJhc2VPcHRpb25zID0gYm90Q2ZnLmJhc2VXYWxsZXRPcHRpb25zIHx8IHt9XG4gICAgICBvbGRDZmcucXVvdGVPcHRpb25zID0gYm90Q2ZnLnF1b3RlV2FsbGV0T3B0aW9ucyB8fCB7fVxuICAgICAgb2xkQ2ZnLmNleFJlYmFsYW5jZSA9IGNleFJlYmFsYW5jZVxuXG4gICAgICBpZiAobW1DZmcpIHtcbiAgICAgICAgb2xkQ2ZnLmJ1eVBsYWNlbWVudHMgPSBtbUNmZy5idXlQbGFjZW1lbnRzXG4gICAgICAgIG9sZENmZy5zZWxsUGxhY2VtZW50cyA9IG1tQ2ZnLnNlbGxQbGFjZW1lbnRzXG4gICAgICAgIG9sZENmZy5kcmlmdFRvbGVyYW5jZSA9IG1tQ2ZnLmRyaWZ0VG9sZXJhbmNlXG4gICAgICAgIG9sZENmZy5nYXBTdHJhdGVneSA9IG1tQ2ZnLmdhcFN0cmF0ZWd5XG4gICAgICB9IGVsc2UgaWYgKGFyYk1NQ2ZnKSB7XG4gICAgICAgIGNvbnN0IHsgYnV5UGxhY2VtZW50cywgc2VsbFBsYWNlbWVudHMgfSA9IGFyYk1NQ2ZnXG4gICAgICAgIG9sZENmZy5idXlQbGFjZW1lbnRzID0gQXJyYXkuZnJvbShidXlQbGFjZW1lbnRzLCAocDogQXJiTWFya2V0TWFraW5nUGxhY2VtZW50KSA9PiB7IHJldHVybiB7IGxvdHM6IHAubG90cywgZ2FwRmFjdG9yOiBwLm11bHRpcGxpZXIgfSB9KVxuICAgICAgICBvbGRDZmcuc2VsbFBsYWNlbWVudHMgPSBBcnJheS5mcm9tKHNlbGxQbGFjZW1lbnRzLCAocDogQXJiTWFya2V0TWFraW5nUGxhY2VtZW50KSA9PiB7IHJldHVybiB7IGxvdHM6IHAubG90cywgZ2FwRmFjdG9yOiBwLm11bHRpcGxpZXIgfSB9KVxuICAgICAgICBvbGRDZmcucHJvZml0ID0gYXJiTU1DZmcucHJvZml0XG4gICAgICAgIG9sZENmZy5kcmlmdFRvbGVyYW5jZSA9IGFyYk1NQ2ZnLmRyaWZ0VG9sZXJhbmNlXG4gICAgICAgIG9sZENmZy5vcmRlclBlcnNpc3RlbmNlID0gYXJiTU1DZmcub3JkZXJQZXJzaXN0ZW5jZVxuICAgICAgfSBlbHNlIGlmIChhcmJDZmcpIHtcbiAgICAgICAgLy8gVE9ETzogZXhwb3NlIG1heEFjdGl2ZUFyYnNcbiAgICAgICAgb2xkQ2ZnLnByb2ZpdCA9IGFyYkNmZy5wcm9maXRUcmlnZ2VyXG4gICAgICAgIG9sZENmZy5vcmRlclBlcnNpc3RlbmNlID0gYXJiQ2ZnLm51bUVwb2Noc0xlYXZlT3BlblxuICAgICAgICBvbGRDZmcuc2ltcGxlQXJiTG90cyA9IGJvdENmZy51aUNvbmZpZy5zaW1wbGVBcmJMb3RzID8/IDFcbiAgICAgIH1cbiAgICAgIERvYy5zZXRWaXMoIXZpZXdPbmx5LCBwYWdlLnVwZGF0ZUJ1dHRvbiwgcGFnZS5yZXNldEJ1dHRvbilcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jcmVhdGluZ05ld0JvdCA9IHRydWVcbiAgICAgIERvYy5zZXRWaXMoIXZpZXdPbmx5LCBwYWdlLmNyZWF0ZUJ1dHRvbilcbiAgICB9XG5cbiAgICAvLyBOb3cgdGhhdCB3ZSd2ZSB1cGRhdGVkIHRoZSBvcmlnaW5hbENvbmZpZywgd2UnbGwgY29weSBpdC5cbiAgICB0aGlzLnVwZGF0ZWRDb25maWcgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9sZENmZykpXG5cbiAgICBzd2l0Y2ggKGJvdFR5cGUpIHtcbiAgICAgIGNhc2UgYm90VHlwZUJhc2ljTU06XG4gICAgICAgIHBhZ2UuYm90VHlwZURpc3BsYXkudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9CT1RUWVBFX0JBU0lDX01NKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBib3RUeXBlQXJiTU06XG4gICAgICAgIHBhZ2UuYm90VHlwZURpc3BsYXkudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9CT1RUWVBFX0FSQl9NTSlcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgYm90VHlwZUJhc2ljQXJiOlxuICAgICAgICBwYWdlLmJvdFR5cGVEaXNwbGF5LnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQk9UVFlQRV9TSU1QTEVfQVJCKVxuICAgIH1cblxuICAgIHNldE1hcmtldEVsZW1lbnRzKGRvY3VtZW50LmJvZHksIGJhc2VJRCwgcXVvdGVJRCwgaG9zdClcbiAgICBEb2Muc2V0VmlzKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY0FyYiwgcGFnZS5kcmlmdFRvbGVyYW5jZUJveCwgcGFnZS5zd2l0Y2hUb0FkdmFuY2VkKVxuICAgIERvYy5zZXRWaXMoQm9vbGVhbihjZXhOYW1lKSwgLi4uRG9jLmFwcGx5U2VsZWN0b3IoZG9jdW1lbnQuYm9keSwgJ1tkYXRhLWNleC1zaG93XScpKVxuXG4gICAgRG9jLnNldFZpcyh2aWV3T25seSwgcGFnZS52aWV3T25seVJ1bm5pbmcpXG4gICAgRG9jLnNldFZpcyhjZXhOYW1lLCBwYWdlLmNleFJlYmFsYW5jZVNldHRpbmdzKVxuICAgIGlmIChjZXhOYW1lKSBzZXRDZXhFbGVtZW50cyhkb2N1bWVudC5ib2R5LCBjZXhOYW1lKVxuXG4gICAgYXdhaXQgdGhpcy5mZXRjaE1hcmtldFJlcG9ydCgpXG5cbiAgICBjb25zdCBsb3RTaXplVVNEID0gdGhpcy5sb3RTaXplVVNEKClcbiAgICB0aGlzLmxvdHNQZXJMZXZlbEluY3JlbWVudCA9IE1hdGgucm91bmQoTWF0aC5tYXgoMSwgZGVmYXVsdExvdHNQZXJMZXZlbC51c2RJbmNyZW1lbnQgLyBsb3RTaXplVVNEKSlcbiAgICB0aGlzLnFjTG90c1BlckxldmVsLmluYyA9IHRoaXMubG90c1BlckxldmVsSW5jcmVtZW50XG4gICAgdGhpcy5xY1VTRFBlclNpZGUuaW5jID0gdGhpcy5sb3RzUGVyTGV2ZWxJbmNyZW1lbnQgKiBsb3RTaXplVVNEXG4gICAgdGhpcy5xY1VTRFBlclNpZGUubWluID0gbG90U2l6ZVVTRFxuXG4gICAgdGhpcy5iYXNlUGFuZS5zZXRBc3NldChiYXNlSUQsIGZhbHNlKVxuICAgIHRoaXMucXVvdGVQYW5lLnNldEFzc2V0KHF1b3RlSUQsIHRydWUpXG4gICAgY29uc3QgeyBtYXJrZXRSZXBvcnQ6IHsgYmFzZUZpYXRSYXRlIH0gfSA9IHRoaXNcbiAgICB0aGlzLnBsYWNlbWVudHNDaGFydC5zZXRNYXJrZXQoeyBjZXhOYW1lOiBjZXhOYW1lIGFzIHN0cmluZywgYm90VHlwZSwgYmFzZUZpYXRSYXRlLCBkaWN0OiB0aGlzLnVwZGF0ZWRDb25maWcgfSlcblxuICAgIC8vIElmIHRoaXMgaXMgYSBuZXcgYm90LCBzaG93IHRoZSBxdWljayBjb25maWcgZm9ybS5cbiAgICBjb25zdCBpc1F1aWNrUGxhY2VtZW50cyA9ICFib3RDZmcgfHwgdGhpcy5pc1F1aWNrUGxhY2VtZW50cyh0aGlzLnVwZGF0ZWRDb25maWcuYnV5UGxhY2VtZW50cywgdGhpcy51cGRhdGVkQ29uZmlnLnNlbGxQbGFjZW1lbnRzKVxuICAgIGNvbnN0IGdhcFN0cmF0ZWd5ID0gYm90Q2ZnPy5iYXNpY01hcmtldE1ha2luZ0NvbmZpZz8uZ2FwU3RyYXRlZ3kgPz8gR2FwU3RyYXRlZ3lQZXJjZW50UGx1c1xuICAgIHBhZ2UuZ2FwU3RyYXRlZ3lTZWxlY3QudmFsdWUgPSBnYXBTdHJhdGVneVxuICAgIGlmIChib3RUeXBlID09PSBib3RUeXBlQmFzaWNBcmIgfHwgKGlzUXVpY2tQbGFjZW1lbnRzICYmIGdhcFN0cmF0ZWd5ID09PSBHYXBTdHJhdGVneVBlcmNlbnRQbHVzKSkgdGhpcy5zaG93UXVpY2tDb25maWcoKVxuICAgIGVsc2UgdGhpcy5zaG93QWR2YW5jZWRDb25maWcoKVxuXG4gICAgdGhpcy5zZXRPcmlnaW5hbFZhbHVlcygpXG5cbiAgICBEb2MuaGlkZShwYWdlLm1hcmtldExvYWRpbmcpXG4gICAgRG9jLnNob3cocGFnZS5ib3RTZXR0aW5nc0NvbnRhaW5lciwgcGFnZS5tYXJrZXRCb3gpXG4gIH1cblxuICBpbml0aWFsaXplTWFya2V0Um93cyAoKSB7XG4gICAgdGhpcy5tYXJrZXRSb3dzID0gW11cbiAgICBEb2MuZW1wdHkodGhpcy5wYWdlLm1hcmtldFNlbGVjdClcbiAgICBmb3IgKGNvbnN0IHsgaG9zdCwgbWFya2V0cywgYXNzZXRzLCBhdXRoOiB7IGVmZmVjdGl2ZVRpZXIsIHBlbmRpbmdTdHJlbmd0aCB9IH0gb2YgT2JqZWN0LnZhbHVlcyhhcHAoKS5leGNoYW5nZXMpKSB7XG4gICAgICBpZiAoZWZmZWN0aXZlVGllciArIHBlbmRpbmdTdHJlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zdCB7IG5lZWRSZWdUbXBsLCBuZWVkUmVnQm94IH0gPSB0aGlzLnBhZ2VcbiAgICAgICAgY29uc3QgYnR0biA9IG5lZWRSZWdUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoYnR0bilcbiAgICAgICAgRG9jLmJpbmQoYnR0biwgJ2NsaWNrJywgKCkgPT4geyBhcHAoKS5sb2FkUGFnZSgncmVnaXN0ZXInLCB7IGhvc3QsIGJhY2tUbzogJ21tc2V0dGluZ3MnIH0pIH0pXG4gICAgICAgIHRtcGwuaG9zdC50ZXh0Q29udGVudCA9IGhvc3RcbiAgICAgICAgbmVlZFJlZ0JveC5hcHBlbmRDaGlsZChidHRuKVxuICAgICAgICBEb2Muc2hvdyhuZWVkUmVnQm94KVxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgICAgZm9yIChjb25zdCB7IG5hbWUsIGJhc2VpZDogYmFzZUlELCBxdW90ZWlkOiBxdW90ZUlELCBzcG90LCBiYXNlc3ltYm9sOiBiYXNlU3ltYm9sLCBxdW90ZXN5bWJvbDogcXVvdGVTeW1ib2wgfSBvZiBPYmplY3QudmFsdWVzKG1hcmtldHMpKSB7XG4gICAgICAgIGlmICghYXBwKCkuYXNzZXRzW2Jhc2VJRF0gfHwgIWFwcCgpLmFzc2V0c1txdW90ZUlEXSkgY29udGludWVcbiAgICAgICAgY29uc3QgdHIgPSB0aGlzLnBhZ2UubWFya2V0Um93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRyKVxuICAgICAgICBjb25zdCBtciA9IHsgdHIsIHRtcGwsIGhvc3Q6IGhvc3QsIG5hbWUsIGJhc2VJRCwgcXVvdGVJRCwgc3BvdDogc3BvdCwgYXJiczogW10gfSBhcyBNYXJrZXRSb3dcbiAgICAgICAgdGhpcy5tYXJrZXRSb3dzLnB1c2gobXIpXG4gICAgICAgIHRoaXMucGFnZS5tYXJrZXRTZWxlY3QuYXBwZW5kQ2hpbGQodHIpXG4gICAgICAgIHRtcGwuYmFzZUljb24uc3JjID0gRG9jLmxvZ29QYXRoKGJhc2VTeW1ib2wpXG4gICAgICAgIHRtcGwucXVvdGVJY29uLnNyYyA9IERvYy5sb2dvUGF0aChxdW90ZVN5bWJvbClcbiAgICAgICAgdG1wbC5iYXNlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUoYXNzZXRzW2Jhc2VJRF0sIHRydWUpKVxuICAgICAgICB0bXBsLnF1b3RlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUoYXNzZXRzW3F1b3RlSURdLCB0cnVlKSlcbiAgICAgICAgdG1wbC5ob3N0LnRleHRDb250ZW50ID0gaG9zdFxuICAgICAgICBjb25zdCBjZXhIYXNNYXJrZXQgPSB0aGlzLmNleE1hcmtldFN1cHBvcnRGaWx0ZXIoYmFzZUlELCBxdW90ZUlEKVxuICAgICAgICBmb3IgKGNvbnN0IFtjZXhOYW1lLCBkaW5mb10gb2YgT2JqZWN0LmVudHJpZXMoQ0VYRGlzcGxheUluZm9zKSkge1xuICAgICAgICAgIGlmIChjZXhIYXNNYXJrZXQoY2V4TmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGltZyA9IHRoaXMucGFnZS5hcmJCdHRuVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgICAgICAgIGltZy5zcmMgPSBkaW5mby5sb2dvXG4gICAgICAgICAgICB0bXBsLmFyYnMuYXBwZW5kQ2hpbGQoaW1nKVxuICAgICAgICAgICAgbXIuYXJicy5wdXNoKGNleE5hbWUpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIERvYy5iaW5kKHRyLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuc2hvd0JvdFR5cGVGb3JtKGhvc3QsIGJhc2VJRCwgcXVvdGVJRCkgfSlcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMubWFya2V0Um93cy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IHsgbWFya2V0U2VsZWN0aW9uVGFibGUsIG1hcmtldEZpbHRlckJveCwgbm9NYXJrZXRzIH0gPSB0aGlzLnBhZ2VcbiAgICAgIERvYy5oaWRlKG1hcmtldFNlbGVjdGlvblRhYmxlLCBtYXJrZXRGaWx0ZXJCb3gpXG4gICAgICBEb2Muc2hvdyhub01hcmtldHMpXG4gICAgfSBlbHNlIERvYy5oaWRlKHRoaXMucGFnZS5ub01hcmtldHMpXG4gICAgY29uc3QgZmlhdFJhdGVzID0gYXBwKCkuZmlhdFJhdGVzTWFwXG4gICAgdGhpcy5tYXJrZXRSb3dzLnNvcnQoKGE6IE1hcmtldFJvdywgYjogTWFya2V0Um93KSA9PiB7XG4gICAgICBsZXQgW3ZvbEEsIHZvbEJdID0gW2Euc3BvdD8udm9sMjQgPz8gMCwgYi5zcG90Py52b2wyNCA/PyAwXVxuICAgICAgaWYgKGZpYXRSYXRlc1thLmJhc2VJRF0gJiYgZmlhdFJhdGVzW2IuYmFzZUlEXSkge1xuICAgICAgICB2b2xBICo9IGZpYXRSYXRlc1thLmJhc2VJRF1cbiAgICAgICAgdm9sQiAqPSBmaWF0UmF0ZXNbYi5iYXNlSURdXG4gICAgICB9XG4gICAgICByZXR1cm4gdm9sQiAtIHZvbEFcbiAgICB9KVxuICB9XG5cbiAgcnVubmluZ0JvdEludmVudG9yeSAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHJ1bm5pbmdCb3RJbnZlbnRvcnkoYXNzZXRJRClcbiAgfVxuXG4gIGFkanVzdGVkQmFsYW5jZXMgKGJhc2VXYWxsZXQ6IFdhbGxldFN0YXRlLCBxdW90ZVdhbGxldDogV2FsbGV0U3RhdGUpIHtcbiAgICBjb25zdCB7IGNleEJhc2VCYWxhbmNlLCBjZXhRdW90ZUJhbGFuY2UgfSA9IHRoaXNcbiAgICBjb25zdCBbYkludiwgcUludl0gPSBbdGhpcy5ydW5uaW5nQm90SW52ZW50b3J5KGJhc2VXYWxsZXQuYXNzZXRJRCksIHRoaXMucnVubmluZ0JvdEludmVudG9yeShxdW90ZVdhbGxldC5hc3NldElEKV1cbiAgICBjb25zdCBbY2V4QmFzZUF2YWlsLCBjZXhRdW90ZUF2YWlsXSA9IFsoY2V4QmFzZUJhbGFuY2U/LmF2YWlsYWJsZSB8fCAwKSAtIGJJbnYuY2V4LnRvdGFsLCAoY2V4UXVvdGVCYWxhbmNlPy5hdmFpbGFibGUgfHwgMCkgLSBxSW52LmNleC50b3RhbF1cbiAgICBjb25zdCBbZGV4QmFzZUF2YWlsLCBkZXhRdW90ZUF2YWlsXSA9IFtiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC0gYkludi5kZXgudG90YWwsIHF1b3RlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC0gcUludi5kZXgudG90YWxdXG4gICAgY29uc3QgYmFzZUF2YWlsID0gZGV4QmFzZUF2YWlsICsgY2V4QmFzZUF2YWlsXG4gICAgY29uc3QgcXVvdGVBdmFpbCA9IGRleFF1b3RlQXZhaWwgKyBjZXhRdW90ZUF2YWlsXG4gICAgcmV0dXJuIHsgYmFzZUF2YWlsLCBxdW90ZUF2YWlsLCBkZXhCYXNlQXZhaWwsIGRleFF1b3RlQXZhaWwsIGNleEJhc2VBdmFpbCwgY2V4UXVvdGVBdmFpbCB9XG4gIH1cblxuICBsb3RTaXplVVNEICgpIHtcbiAgICBjb25zdCB7IHNwZWNzOiB7IGhvc3QsIGJhc2VJRCB9LCBta3RJRCwgbWFya2V0UmVwb3J0OiB7IGJhc2VGaWF0UmF0ZSB9IH0gPSB0aGlzXG4gICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbaG9zdF1cbiAgICBjb25zdCBtYXJrZXQgPSB4Yy5tYXJrZXRzW21rdElEXVxuICAgIGNvbnN0IHsgbG90c2l6ZTogbG90U2l6ZSB9ID0gbWFya2V0XG4gICAgY29uc3QgeyB1bml0SW5mbzogdWkgfSA9IGFwcCgpLmFzc2V0c1tiYXNlSURdXG4gICAgcmV0dXJuIGxvdFNpemUgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAqIGJhc2VGaWF0UmF0ZVxuICB9XG5cbiAgLypcbiAgICAqIG1hcmtldFN0dWZmIGlzIGp1c3QgYSBidW5jaCBvZiB1c2VmdWwgcHJvcGVydGllcyBmb3IgdGhlIGN1cnJlbnQgc3BlY3NcbiAgICAqIGdhdGhlcmVkIGluIG9uZSBwbGFjZSBhbmQgd2l0aCBwcmVmZXJhYmxlIG5hbWVzLlxuICAgICovXG4gIG1hcmtldFN0dWZmICgpIHtcbiAgICBjb25zdCB7XG4gICAgICBwYWdlLCBzcGVjczogeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUsIGJvdFR5cGUgfSwgYmFzZVBhbmUsIHF1b3RlUGFuZSxcbiAgICAgIG1hcmtldFJlcG9ydDogeyBiYXNlRmlhdFJhdGUsIHF1b3RlRmlhdFJhdGUsIGJhc2VGZWVzLCBxdW90ZUZlZXMgfSxcbiAgICAgIGxvdHNQZXJMZXZlbEluY3JlbWVudCwgdXBkYXRlZENvbmZpZzogY2ZnLCBvcmlnaW5hbENvbmZpZzogb2xkQ2ZnLCBta3RJRFxuICAgIH0gPSB0aGlzXG4gICAgY29uc3QgeyBzeW1ib2w6IGJhc2VTeW1ib2wsIHVuaXRJbmZvOiBidWkgfSA9IGFwcCgpLmFzc2V0c1tiYXNlSURdXG4gICAgY29uc3QgeyBzeW1ib2w6IHF1b3RlU3ltYm9sLCB1bml0SW5mbzogcXVpIH0gPSBhcHAoKS5hc3NldHNbcXVvdGVJRF1cbiAgICBjb25zdCB4YyA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XVxuICAgIGNvbnN0IG1hcmtldCA9IHhjLm1hcmtldHNbbWt0SURdXG4gICAgY29uc3QgeyBsb3RzaXplOiBsb3RTaXplLCBzcG90IH0gPSBtYXJrZXRcbiAgICBjb25zdCBsb3RTaXplVVNEID0gbG90U2l6ZSAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciAqIGJhc2VGaWF0UmF0ZVxuICAgIGNvbnN0IGF0b21pY1JhdGUgPSAxIC8gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yICogYmFzZUZpYXRSYXRlIC8gcXVvdGVGaWF0UmF0ZSAqIHF1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIGNvbnN0IHhjUmF0ZSA9IHtcbiAgICAgIGNvbnY6IHF1b3RlRmlhdFJhdGUgLyBiYXNlRmlhdFJhdGUsXG4gICAgICBhdG9taWM6IGF0b21pY1JhdGUsXG4gICAgICBtc2c6IE1hdGgucm91bmQoYXRvbWljUmF0ZSAqIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IpLCAvLyB1bmFkanVzdGVkXG4gICAgICBzcG90XG4gICAgfVxuXG4gICAgbGV0IFtkZXhCYXNlTG90cywgZGV4UXVvdGVMb3RzXSA9IFtjZmcuc2ltcGxlQXJiTG90cywgY2ZnLnNpbXBsZUFyYkxvdHNdXG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY0FyYikge1xuICAgICAgZGV4QmFzZUxvdHMgPSB0aGlzLnVwZGF0ZWRDb25maWcuc2VsbFBsYWNlbWVudHMucmVkdWNlKChsb3RzOiBudW1iZXIsIHA6IE9yZGVyUGxhY2VtZW50KSA9PiBsb3RzICsgcC5sb3RzLCAwKVxuICAgICAgZGV4UXVvdGVMb3RzID0gdGhpcy51cGRhdGVkQ29uZmlnLmJ1eVBsYWNlbWVudHMucmVkdWNlKChsb3RzOiBudW1iZXIsIHA6IE9yZGVyUGxhY2VtZW50KSA9PiBsb3RzICsgcC5sb3RzLCAwKVxuICAgIH1cbiAgICBjb25zdCBxdW90ZUxvdCA9IGNhbGN1bGF0ZVF1b3RlTG90KGxvdFNpemUsIGJhc2VJRCwgcXVvdGVJRCwgc3BvdClcbiAgICBjb25zdCB3YWxsZXRTdHVmZiA9IHRoaXMud2FsbGV0U3R1ZmYoKVxuICAgIGNvbnN0IHsgYmFzZUZlZUFzc2V0SUQsIHF1b3RlRmVlQXNzZXRJRCwgYmFzZUlzQWNjb3VudExvY2tlciwgcXVvdGVJc0FjY291bnRMb2NrZXIgfSA9IHdhbGxldFN0dWZmXG5cbiAgICBjb25zdCB7IGNvbW1pdCwgZmVlcyB9ID0gZmVlc0FuZENvbW1pdChcbiAgICAgIGJhc2VJRCwgcXVvdGVJRCwgYmFzZUZlZXMsIHF1b3RlRmVlcywgbG90U2l6ZSwgZGV4QmFzZUxvdHMsIGRleFF1b3RlTG90cyxcbiAgICAgIGJhc2VGZWVBc3NldElELCBxdW90ZUZlZUFzc2V0SUQsIGJhc2VJc0FjY291bnRMb2NrZXIsIHF1b3RlSXNBY2NvdW50TG9ja2VyLFxuICAgICAgY2ZnLmJhc2VDb25maWcub3JkZXJSZXNlcnZlc0ZhY3RvciwgY2ZnLnF1b3RlQ29uZmlnLm9yZGVyUmVzZXJ2ZXNGYWN0b3JcbiAgICApXG5cbiAgICByZXR1cm4ge1xuICAgICAgcGFnZSwgY2ZnLCBvbGRDZmcsIGhvc3QsIHhjLCBiYXNlSUQsIHF1b3RlSUQsIGJvdFR5cGUsIGNleE5hbWUsIGJhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSxcbiAgICAgIHhjUmF0ZSwgYmFzZVN5bWJvbCwgcXVvdGVTeW1ib2wsIG1rdElELCBsb3RTaXplLCBsb3RTaXplVVNELCBsb3RzUGVyTGV2ZWxJbmNyZW1lbnQsXG4gICAgICBxdW90ZUxvdCwgY29tbWl0LCBiYXNlUGFuZSwgcXVvdGVQYW5lLCBmZWVzLCAuLi53YWxsZXRTdHVmZlxuICAgIH1cbiAgfVxuXG4gIHdhbGxldFN0dWZmICgpIHtcbiAgICBjb25zdCB7IHNwZWNzOiB7IGJhc2VJRCwgcXVvdGVJRCB9IH0gPSB0aGlzXG4gICAgY29uc3QgW2Jhc2VXYWxsZXQsIHF1b3RlV2FsbGV0XSA9IFthcHAoKS53YWxsZXRNYXBbYmFzZUlEXSwgYXBwKCkud2FsbGV0TWFwW3F1b3RlSURdXVxuICAgIGNvbnN0IFt7IHRva2VuOiBiYXNlVG9rZW4sIHVuaXRJbmZvOiBidWkgfSwgeyB0b2tlbjogcXVvdGVUb2tlbiwgdW5pdEluZm86IHF1aSB9XSA9IFthcHAoKS5hc3NldHNbYmFzZUlEXSwgYXBwKCkuYXNzZXRzW3F1b3RlSURdXVxuICAgIGNvbnN0IGJhc2VGZWVBc3NldElEID0gYmFzZVRva2VuID8gYmFzZVRva2VuLnBhcmVudElEIDogYmFzZUlEXG4gICAgY29uc3QgcXVvdGVGZWVBc3NldElEID0gcXVvdGVUb2tlbiA/IHF1b3RlVG9rZW4ucGFyZW50SUQgOiBxdW90ZUlEXG4gICAgY29uc3QgW2Jhc2VGZWVVSSwgcXVvdGVGZWVVSV0gPSBbYXBwKCkuYXNzZXRzW2Jhc2VGZWVBc3NldElEXS51bml0SW5mbywgYXBwKCkuYXNzZXRzW3F1b3RlRmVlQXNzZXRJRF0udW5pdEluZm9dXG4gICAgY29uc3QgdHJhaXRBY2NvdW50TG9ja2VyID0gMSA8PCAxNFxuICAgIGNvbnN0IGJhc2VJc0FjY291bnRMb2NrZXIgPSAoYmFzZVdhbGxldC50cmFpdHMgJiB0cmFpdEFjY291bnRMb2NrZXIpID4gMFxuICAgIGNvbnN0IHF1b3RlSXNBY2NvdW50TG9ja2VyID0gKHF1b3RlV2FsbGV0LnRyYWl0cyAmIHRyYWl0QWNjb3VudExvY2tlcikgPiAwXG4gICAgcmV0dXJuIHtcbiAgICAgIGJhc2VXYWxsZXQsIHF1b3RlV2FsbGV0LCBiYXNlRmVlVUksIHF1b3RlRmVlVUksIGJhc2VUb2tlbiwgcXVvdGVUb2tlbixcbiAgICAgIGJ1aSwgcXVpLCBiYXNlRmVlQXNzZXRJRCwgcXVvdGVGZWVBc3NldElELCBiYXNlSXNBY2NvdW50TG9ja2VyLCBxdW90ZUlzQWNjb3VudExvY2tlcixcbiAgICAgIC4uLnRoaXMuYWRqdXN0ZWRCYWxhbmNlcyhiYXNlV2FsbGV0LCBxdW90ZVdhbGxldClcbiAgICB9XG4gIH1cblxuICBzaG93QWR2YW5jZWRDb25maWcgKCkge1xuICAgIGNvbnN0IHsgcGFnZSB9ID0gdGhpc1xuICAgIERvYy5zaG93KHBhZ2UuYWR2YW5jZWRDb25maWcpXG4gICAgRG9jLmhpZGUocGFnZS5xdWlja0NvbmZpZylcbiAgICB0aGlzLnBsYWNlbWVudHNDaGFydC5yZW5kZXIoKVxuICB9XG5cbiAgaXNRdWlja1BsYWNlbWVudHMgKGJ1eVBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W10sIHNlbGxQbGFjZW1lbnRzOiBPcmRlclBsYWNlbWVudFtdKSB7XG4gICAgaWYgKGJ1eVBsYWNlbWVudHMubGVuZ3RoID09PSAwIHx8IGJ1eVBsYWNlbWVudHMubGVuZ3RoICE9PSBzZWxsUGxhY2VtZW50cy5sZW5ndGgpIHJldHVybiBmYWxzZVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnV5UGxhY2VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGJ1eVBsYWNlbWVudHNbaV0uZ2FwRmFjdG9yICE9PSBzZWxsUGxhY2VtZW50c1tpXS5nYXBGYWN0b3IpIHJldHVybiBmYWxzZVxuICAgICAgaWYgKGJ1eVBsYWNlbWVudHNbaV0ubG90cyAhPT0gc2VsbFBsYWNlbWVudHNbaV0ubG90cykgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIHJldHVybiB0cnVlXG4gIH1cblxuICBzd2l0Y2hUb1F1aWNrQ29uZmlnICgpIHtcbiAgICBjb25zdCB7IGNmZywgYm90VHlwZSwgbG90U2l6ZVVTRCB9ID0gdGhpcy5tYXJrZXRTdHVmZigpXG4gICAgY29uc3QgeyBidXlQbGFjZW1lbnRzOiBidXlzLCBzZWxsUGxhY2VtZW50czogc2VsbHMgfSA9IGNmZ1xuICAgIC8vIElmIHdlIGhhdmUgYm90aCBidXlzIGFuZCBzZWxscywgZ2V0IHRoZSBiZXN0IGFwcHJveGltYXRpb24gcXVpY2sgY29uZmlnXG4gICAgLy8gYXBwcm94aW1hdGlvbi5cbiAgICBpZiAoYnV5cy5sZW5ndGggPiAwICYmIHNlbGxzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGJlc3RCdXkgPSBidXlzLnJlZHVjZSgocHJldjogT3JkZXJQbGFjZW1lbnQsIGN1cnI6IE9yZGVyUGxhY2VtZW50KSA9PiBjdXJyLmdhcEZhY3RvciA8IHByZXYuZ2FwRmFjdG9yID8gY3VyciA6IHByZXYpXG4gICAgICBjb25zdCBiZXN0U2VsbCA9IHNlbGxzLnJlZHVjZSgocHJldjogT3JkZXJQbGFjZW1lbnQsIGN1cnI6IE9yZGVyUGxhY2VtZW50KSA9PiBjdXJyLmdhcEZhY3RvciA8IHByZXYuZ2FwRmFjdG9yID8gY3VyciA6IHByZXYpXG4gICAgICBjb25zdCBwbGFjZW1lbnRDb3VudCA9IGJ1eXMubGVuZ3RoICsgc2VsbHMubGVuZ3RoXG4gICAgICBjb25zdCBsZXZlbHNQZXJTaWRlID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcigocGxhY2VtZW50Q291bnQpIC8gMikpXG4gICAgICBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljTU0pIHtcbiAgICAgICAgY2ZnLnByb2ZpdCA9IChiZXN0QnV5LmdhcEZhY3RvciArIGJlc3RTZWxsLmdhcEZhY3RvcikgLyAyXG4gICAgICAgIGNvbnN0IHdvcnN0QnV5ID0gYnV5cy5yZWR1Y2UoKHByZXY6IE9yZGVyUGxhY2VtZW50LCBjdXJyOiBPcmRlclBsYWNlbWVudCkgPT4gY3Vyci5nYXBGYWN0b3IgPiBwcmV2LmdhcEZhY3RvciA/IGN1cnIgOiBwcmV2KVxuICAgICAgICBjb25zdCB3b3JzdFNlbGwgPSBzZWxscy5yZWR1Y2UoKHByZXY6IE9yZGVyUGxhY2VtZW50LCBjdXJyOiBPcmRlclBsYWNlbWVudCkgPT4gY3Vyci5nYXBGYWN0b3IgPiBwcmV2LmdhcEZhY3RvciA/IGN1cnIgOiBwcmV2KVxuICAgICAgICBjb25zdCByYW5nZSA9ICgod29yc3RCdXkuZ2FwRmFjdG9yIC0gYmVzdEJ1eS5nYXBGYWN0b3IpICsgKHdvcnN0U2VsbC5nYXBGYWN0b3IgLSBiZXN0U2VsbC5nYXBGYWN0b3IpKSAvIDJcbiAgICAgICAgY29uc3QgaW5jID0gcmFuZ2UgLyAobGV2ZWxzUGVyU2lkZSAtIDEpXG4gICAgICAgIHRoaXMucWNQcm9maXQuc2V0VmFsdWUoY2ZnLnByb2ZpdCAqIDEwMClcbiAgICAgICAgdGhpcy5xY1Byb2ZpdFNsaWRlci5zZXRWYWx1ZSgoY2ZnLnByb2ZpdCAtIGRlZmF1bHRQcm9maXQubWluVikgLyBkZWZhdWx0UHJvZml0LnJhbmdlKVxuICAgICAgICB0aGlzLnFjTGV2ZWxTcGFjaW5nLnNldFZhbHVlKGluYyAqIDEwMClcbiAgICAgICAgdGhpcy5xY0xldmVsU3BhY2luZ1NsaWRlci5zZXRWYWx1ZSgoaW5jIC0gZGVmYXVsdExldmVsU3BhY2luZy5taW5WKSAvIGRlZmF1bHRMZXZlbFNwYWNpbmcucmFuZ2UpXG4gICAgICB9IGVsc2UgaWYgKGJvdFR5cGUgPT09IGJvdFR5cGVBcmJNTSkge1xuICAgICAgICBjb25zdCBtdWx0U3VtID0gYnV5cy5yZWR1Y2UoKHY6IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IHYgKyBwLmdhcEZhY3RvciwgMCkgKyBzZWxscy5yZWR1Y2UoKHY6IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IHYgKyBwLmdhcEZhY3RvciwgMClcbiAgICAgICAgY29uc3QgYnVmZmVyID0gKChtdWx0U3VtIC8gcGxhY2VtZW50Q291bnQpIC0gMSkgfHwgZGVmYXVsdE1hdGNoQnVmZmVyLnZhbHVlXG4gICAgICAgIHRoaXMucWNNYXRjaEJ1ZmZlci5zZXRWYWx1ZShidWZmZXIgKiAxMDApXG4gICAgICAgIHRoaXMucWNNYXRjaEJ1ZmZlclNsaWRlci5zZXRWYWx1ZSgoYnVmZmVyIC0gZGVmYXVsdE1hdGNoQnVmZmVyLm1pblYpIC8gZGVmYXVsdE1hdGNoQnVmZmVyLnJhbmdlKVxuICAgICAgfVxuICAgICAgY29uc3QgbG90cyA9IGJ1eXMucmVkdWNlKCh2OiBudW1iZXIsIHA6IE9yZGVyUGxhY2VtZW50KSA9PiB2ICsgcC5sb3RzLCAwKSArIHNlbGxzLnJlZHVjZSgodjogbnVtYmVyLCBwOiBPcmRlclBsYWNlbWVudCkgPT4gdiArIHAubG90cywgMClcbiAgICAgIGNvbnN0IGxvdHNQZXJMZXZlbCA9IE1hdGgubWF4KDEsIE1hdGgucm91bmQobG90cyAvIDIgLyBsZXZlbHNQZXJTaWRlKSlcbiAgICAgIHRoaXMucWNMb3RzUGVyTGV2ZWwuc2V0VmFsdWUobG90c1BlckxldmVsKVxuICAgICAgdGhpcy5xY1VTRFBlclNpZGUuc2V0VmFsdWUobG90c1BlckxldmVsICogbGV2ZWxzUGVyU2lkZSAqIGxvdFNpemVVU0QpXG4gICAgICB0aGlzLnFjTGV2ZWxzUGVyU2lkZS5zZXRWYWx1ZShsZXZlbHNQZXJTaWRlKVxuICAgIH0gZWxzZSBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICB0aGlzLnFjTG90c1BlckxldmVsLnNldFZhbHVlKGNmZy5zaW1wbGVBcmJMb3RzKVxuICAgIH1cbiAgICB0aGlzLnNob3dRdWlja0NvbmZpZygpXG4gICAgdGhpcy5xdWlja0NvbmZpZ1VwZGF0ZWQoKVxuICB9XG5cbiAgc2hvd1F1aWNrQ29uZmlnICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGxvdFNpemVVU0QsIGJvdFR5cGUsIGxvdHNQZXJMZXZlbEluY3JlbWVudCB9ID0gdGhpcy5tYXJrZXRTdHVmZigpXG5cbiAgICBpZiAoIXRoaXMucWNMZXZlbHNQZXJTaWRlLmlucHV0LnZhbHVlKSB7XG4gICAgICB0aGlzLnFjTGV2ZWxzUGVyU2lkZS5zZXRWYWx1ZShkZWZhdWx0TGV2ZWxzUGVyU2lkZS52YWx1ZSlcbiAgICAgIHRoaXMucWNVU0RQZXJTaWRlLnNldFZhbHVlKGRlZmF1bHRMZXZlbHNQZXJTaWRlLnZhbHVlICogKHRoaXMucWNMb3RzUGVyTGV2ZWwudmFsdWUoKSB8fCBsb3RzUGVyTGV2ZWxJbmNyZW1lbnQpICogbG90U2l6ZVVTRClcbiAgICB9XG4gICAgaWYgKCF0aGlzLnFjTG90c1BlckxldmVsLmlucHV0LnZhbHVlKSB7XG4gICAgICB0aGlzLnFjTG90c1BlckxldmVsLnNldFZhbHVlKGxvdHNQZXJMZXZlbEluY3JlbWVudClcbiAgICAgIHRoaXMucWNVU0RQZXJTaWRlLnNldFZhbHVlKGxvdFNpemVVU0QgKiBsb3RzUGVyTGV2ZWxJbmNyZW1lbnQgKiB0aGlzLnFjTGV2ZWxzUGVyU2lkZS52YWx1ZSgpKVxuICAgIH1cbiAgICBpZiAoIXBhZ2UucWNMZXZlbFNwYWNpbmcudmFsdWUpIHtcbiAgICAgIHRoaXMucWNMZXZlbFNwYWNpbmcuc2V0VmFsdWUoZGVmYXVsdExldmVsU3BhY2luZy52YWx1ZSAqIDEwMClcbiAgICAgIHRoaXMucWNMZXZlbFNwYWNpbmdTbGlkZXIuc2V0VmFsdWUoKGRlZmF1bHRMZXZlbFNwYWNpbmcudmFsdWUgLSBkZWZhdWx0TGV2ZWxTcGFjaW5nLm1pblYpIC8gZGVmYXVsdExldmVsU3BhY2luZy5yYW5nZSlcbiAgICB9XG4gICAgaWYgKCFwYWdlLnFjTWF0Y2hCdWZmZXIudmFsdWUpIHBhZ2UucWNNYXRjaEJ1ZmZlci52YWx1ZSA9IFN0cmluZyhkZWZhdWx0TWF0Y2hCdWZmZXIudmFsdWUgKiAxMDApXG5cbiAgICBEb2MuaGlkZShwYWdlLmFkdmFuY2VkQ29uZmlnKVxuICAgIERvYy5zaG93KHBhZ2UucXVpY2tDb25maWcpXG5cbiAgICB0aGlzLnNob3dJbnB1dHNGb3JCb3QoYm90VHlwZSlcbiAgfVxuXG4gIHNob3dJbnB1dHNGb3JCb3QgKGJvdFR5cGU6IHN0cmluZykge1xuICAgIGNvbnN0IHsgcGFnZSwgb3B0czogeyB1c2luZ1VTRFBlclNpZGUgfSB9ID0gdGhpc1xuICAgIERvYy5oaWRlKFxuICAgICAgcGFnZS5tYXRjaE11bHRpcGxpZXJCb3gsIHBhZ2UucGxhY2VtZW50c0NoYXJ0Qm94LCBwYWdlLnBsYWNlbWVudENoYXJ0TGVnZW5kLFxuICAgICAgcGFnZS5sb3RzUGVyTGV2ZWxMYWJlbCwgcGFnZS5sZXZlbFNwYWNpbmdCb3gsIHBhZ2UuYXJiTG90c0xhYmVsLCBwYWdlLnFjTGV2ZWxQZXJTaWRlQm94XG4gICAgKVxuICAgIERvYy5zZXRWaXModXNpbmdVU0RQZXJTaWRlLCBwYWdlLnFjVVNEUGVyU2lkZUJveClcbiAgICBEb2Muc2V0VmlzKCF1c2luZ1VTRFBlclNpZGUsIHBhZ2UucWNMb3RzQm94KVxuICAgIHN3aXRjaCAoYm90VHlwZSkge1xuICAgICAgY2FzZSBib3RUeXBlQXJiTU06XG4gICAgICAgIERvYy5zaG93KFxuICAgICAgICAgIHBhZ2UucWNMZXZlbFBlclNpZGVCb3gsIHBhZ2UubWF0Y2hNdWx0aXBsaWVyQm94LCBwYWdlLnBsYWNlbWVudHNDaGFydEJveCxcbiAgICAgICAgICBwYWdlLnBsYWNlbWVudENoYXJ0TGVnZW5kLCBwYWdlLmxvdHNQZXJMZXZlbExhYmVsXG4gICAgICAgIClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgYm90VHlwZUJhc2ljTU06XG4gICAgICAgIERvYy5zaG93KFxuICAgICAgICAgIHBhZ2UucWNMZXZlbFBlclNpZGVCb3gsIHBhZ2UubGV2ZWxTcGFjaW5nQm94LCBwYWdlLnBsYWNlbWVudHNDaGFydEJveCxcbiAgICAgICAgICBwYWdlLmxvdHNQZXJMZXZlbExhYmVsXG4gICAgICAgIClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgYm90VHlwZUJhc2ljQXJiOlxuICAgICAgICBEb2Muc2hvdyhwYWdlLmFyYkxvdHNMYWJlbClcbiAgICB9XG4gIH1cblxuICBxdWlja0NvbmZpZ1VwZGF0ZWQgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgY2ZnLCBib3RUeXBlLCBjZXhOYW1lIH0gPSB0aGlzLm1hcmtldFN0dWZmKClcblxuICAgIERvYy5oaWRlKHBhZ2UucWNFcnJvcilcbiAgICBjb25zdCBzZXRFcnJvciA9IChtc2c6IHN0cmluZykgPT4ge1xuICAgICAgcGFnZS5xY0Vycm9yLnRleHRDb250ZW50ID0gbXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLnFjRXJyb3IpXG4gICAgfVxuXG4gICAgY29uc3QgbGV2ZWxzUGVyU2lkZSA9IGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY0FyYiA/IDEgOiB0aGlzLnFjTGV2ZWxzUGVyU2lkZS52YWx1ZSgpXG4gICAgaWYgKGlzTmFOKGxldmVsc1BlclNpZGUpKSB7XG4gICAgICBzZXRFcnJvcignaW52YWxpZCB2YWx1ZSBmb3IgbGV2ZWxzIHBlciBzaWRlJylcbiAgICB9XG5cbiAgICBjb25zdCBsb3RzUGVyTGV2ZWwgPSB0aGlzLnFjTG90c1BlckxldmVsLnZhbHVlKClcbiAgICBpZiAoaXNOYU4obG90c1BlckxldmVsKSkge1xuICAgICAgc2V0RXJyb3IoJ2ludmFsaWQgdmFsdWUgZm9yIGxvdHMgcGVyIGxldmVsJylcbiAgICB9XG5cbiAgICBjb25zdCBwcm9maXQgPSBwYXJzZUZsb2F0KHBhZ2UucWNQcm9maXQudmFsdWUgPz8gJycpIC8gMTAwXG4gICAgaWYgKGlzTmFOKHByb2ZpdCkpIHtcbiAgICAgIHNldEVycm9yKCdpbnZhbGlkIHZhbHVlIGZvciBwcm9maXQnKVxuICAgIH1cblxuICAgIGNvbnN0IGxldmVsU3BhY2luZyA9IGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY01NID8gcGFyc2VGbG9hdChwYWdlLnFjTGV2ZWxTcGFjaW5nLnZhbHVlID8/ICcnKSAvIDEwMCA6IDBcbiAgICBpZiAoaXNOYU4obGV2ZWxTcGFjaW5nKSkge1xuICAgICAgc2V0RXJyb3IoJ2ludmFsaWQgdmFsdWUgZm9yIGxldmVsIHNwYWNpbmcnKVxuICAgIH1cblxuICAgIGNvbnN0IG1hdGNoQnVmZmVyID0gYm90VHlwZSA9PT0gYm90VHlwZUFyYk1NID8gcGFyc2VGbG9hdChwYWdlLnFjTWF0Y2hCdWZmZXIudmFsdWUgPz8gJycpIC8gMTAwIDogMFxuICAgIGlmIChpc05hTihtYXRjaEJ1ZmZlcikpIHtcbiAgICAgIHNldEVycm9yKCdpbnZhbGlkIHZhbHVlIGZvciBtYXRjaCBidWZmZXInKVxuICAgIH1cbiAgICBjb25zdCBtdWx0aXBsaWVyID0gbWF0Y2hCdWZmZXIgKyAxXG5cbiAgICBjb25zdCBsZXZlbFNwYWNpbmdEaXNhYmxlZCA9IGxldmVsc1BlclNpZGUgPT09IDFcbiAgICBwYWdlLmxldmVsU3BhY2luZ0JveC5jbGFzc0xpc3QudG9nZ2xlKCdkaXNhYmxlZCcsIGxldmVsU3BhY2luZ0Rpc2FibGVkKVxuICAgIHBhZ2UucWNMZXZlbFNwYWNpbmcuZGlzYWJsZWQgPSBsZXZlbFNwYWNpbmdEaXNhYmxlZFxuICAgIGNmZy5zaW1wbGVBcmJMb3RzID0gbG90c1BlckxldmVsXG5cbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICB0aGlzLmNsZWFyUGxhY2VtZW50cyhjZXhOYW1lID8gYXJiTU1Sb3dDYWNoZUtleSA6IGNmZy5nYXBTdHJhdGVneSlcbiAgICAgIGZvciAobGV0IGxldmVsTiA9IDA7IGxldmVsTiA8IGxldmVsc1BlclNpZGU7IGxldmVsTisrKSB7XG4gICAgICAgIGNvbnN0IHBsYWNlbWVudCA9IHsgbG90czogbG90c1BlckxldmVsIH0gYXMgT3JkZXJQbGFjZW1lbnRcbiAgICAgICAgcGxhY2VtZW50LmdhcEZhY3RvciA9IGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY01NID8gcHJvZml0ICsgbGV2ZWxTcGFjaW5nICogbGV2ZWxOIDogbXVsdGlwbGllclxuICAgICAgICBjZmcuYnV5UGxhY2VtZW50cy5wdXNoKHBsYWNlbWVudClcbiAgICAgICAgY2ZnLnNlbGxQbGFjZW1lbnRzLnB1c2gocGxhY2VtZW50KVxuICAgICAgICAvLyBBZGQgcm93cyBpbiB0aGUgYWR2YW5jZWQgY29uZmlnIHRhYmxlLlxuICAgICAgICB0aGlzLmFkZFBsYWNlbWVudCh0cnVlLCBwbGFjZW1lbnQpXG4gICAgICAgIHRoaXMuYWRkUGxhY2VtZW50KGZhbHNlLCBwbGFjZW1lbnQpXG4gICAgICB9XG5cbiAgICAgIHRoaXMucGxhY2VtZW50c0NoYXJ0LnJlbmRlcigpXG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVBbGxvY2F0aW9ucygpXG4gIH1cblxuICB1cGRhdGVBbGxvY2F0aW9ucyAoKSB7XG4gICAgdGhpcy51cGRhdGVCYXNlQWxsb2NhdGlvbnMoKVxuICAgIHRoaXMudXBkYXRlUXVvdGVBbGxvY2F0aW9ucygpXG4gIH1cblxuICB1cGRhdGVCYXNlQWxsb2NhdGlvbnMgKCkge1xuICAgIGNvbnN0IHsgY29tbWl0LCBsb3RTaXplLCBiYXNlUGFuZSwgZmVlcyB9ID0gdGhpcy5tYXJrZXRTdHVmZigpXG5cbiAgICBiYXNlUGFuZS51cGRhdGVJbnZlbnRvcnkoY29tbWl0LmRleC5iYXNlLmxvdHMsIGNvbW1pdC5kZXgucXVvdGUubG90cywgbG90U2l6ZSwgY29tbWl0LmRleC5iYXNlLnZhbCwgY29tbWl0LmNleC5iYXNlLnZhbCwgZmVlcy5iYXNlKVxuICAgIGJhc2VQYW5lLnVwZGF0ZUNvbW1pdFRvdGFsKClcbiAgfVxuXG4gIHVwZGF0ZVF1b3RlQWxsb2NhdGlvbnMgKCkge1xuICAgIGNvbnN0IHsgY29tbWl0LCBxdW90ZUxvdDogbG90U2l6ZSwgcXVvdGVQYW5lLCBmZWVzIH0gPSB0aGlzLm1hcmtldFN0dWZmKClcblxuICAgIHF1b3RlUGFuZS51cGRhdGVJbnZlbnRvcnkoY29tbWl0LmRleC5xdW90ZS5sb3RzLCBjb21taXQuZGV4LmJhc2UubG90cywgbG90U2l6ZSwgY29tbWl0LmRleC5xdW90ZS52YWwsIGNvbW1pdC5jZXgucXVvdGUudmFsLCBmZWVzLnF1b3RlKVxuICAgIHF1b3RlUGFuZS51cGRhdGVDb21taXRUb3RhbCgpXG4gIH1cblxuICBtYXRjaEJ1ZmZlckNoYW5nZWQgKCkge1xuICAgIGNvbnN0IHsgcGFnZSB9ID0gdGhpc1xuICAgIHBhZ2UucWNNYXRjaEJ1ZmZlci52YWx1ZSA9IE1hdGgubWF4KDAsIHBhcnNlRmxvYXQocGFnZS5xY01hdGNoQnVmZmVyLnZhbHVlID8/ICcnKSB8fCBkZWZhdWx0TWF0Y2hCdWZmZXIudmFsdWUgKiAxMDApLnRvRml4ZWQoMilcbiAgICB0aGlzLnF1aWNrQ29uZmlnVXBkYXRlZCgpXG4gIH1cblxuICBzaG93QWRkcmVzcyAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgdGhpcy53YWxsZXRBZGRyRm9ybS5zZXRBc3NldChhc3NldElEKVxuICAgIHRoaXMuZm9ybXMuc2hvdyh0aGlzLnBhZ2Uud2FsbGV0QWRkckZvcm0pXG4gIH1cblxuICBjaGFuZ2VTaWRlQ29tbWl0bWVudERpYWxvZyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBvcHRzIH0gPSB0aGlzXG4gICAgb3B0cy51c2luZ1VTRFBlclNpZGUgPSAhb3B0cy51c2luZ1VTRFBlclNpZGVcbiAgICBEb2Muc2V0VmlzKG9wdHMudXNpbmdVU0RQZXJTaWRlLCBwYWdlLnFjVVNEUGVyU2lkZUJveClcbiAgICBEb2Muc2V0VmlzKCFvcHRzLnVzaW5nVVNEUGVyU2lkZSwgcGFnZS5xY0xvdHNCb3gpXG4gIH1cblxuICBhc3luYyBzaG93Qm90VHlwZUZvcm0gKGhvc3Q6IHN0cmluZywgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlciwgYm90VHlwZT86IHN0cmluZywgY29uZmlndXJlZENFWD86IHN0cmluZykge1xuICAgIGNvbnN0IHsgcGFnZSB9ID0gdGhpc1xuICAgIHRoaXMuZm9ybVNwZWNzID0geyBob3N0LCBiYXNlSUQsIHF1b3RlSUQsIGJvdFR5cGU6ICcnIH1cbiAgICBjb25zdCB2aWV3T25seSA9IGlzVmlld09ubHkodGhpcy5mb3JtU3BlY3MsIGFwcCgpLm1tU3RhdHVzKVxuICAgIGlmICh2aWV3T25seSkge1xuICAgICAgY29uc3QgYm90Q2ZnID0gbGl2ZUJvdENvbmZpZyhob3N0LCBiYXNlSUQsIHF1b3RlSUQpXG4gICAgICBjb25zdCBzcGVjcyA9IHRoaXMuc3BlY3MgPSB0aGlzLmZvcm1TcGVjc1xuICAgICAgc3dpdGNoICh0cnVlKSB7XG4gICAgICAgIGNhc2UgQm9vbGVhbihib3RDZmc/LnNpbXBsZUFyYkNvbmZpZyk6XG4gICAgICAgICAgc3BlY3MuYm90VHlwZSA9IGJvdFR5cGVCYXNpY0FyYlxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgQm9vbGVhbihib3RDZmc/LmFyYk1hcmtldE1ha2luZ0NvbmZpZyk6XG4gICAgICAgICAgc3BlY3MuYm90VHlwZSA9IGJvdFR5cGVBcmJNTVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgc3BlY3MuYm90VHlwZSA9IGJvdFR5cGVCYXNpY01NXG4gICAgICB9XG4gICAgICBzcGVjcy5jZXhOYW1lID0gYm90Q2ZnPy5jZXhOYW1lXG4gICAgICBhd2FpdCB0aGlzLmZldGNoQ0VYQmFsYW5jZXModGhpcy5mb3JtU3BlY3MpXG4gICAgICBhd2FpdCB0aGlzLmNvbmZpZ3VyZVVJKClcbiAgICAgIHRoaXMuZm9ybXMuY2xvc2UoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHNldE1hcmtldEVsZW1lbnRzKHBhZ2UuYm90VHlwZUZvcm0sIGJhc2VJRCwgcXVvdGVJRCwgaG9zdClcbiAgICBEb2MuZW1wdHkocGFnZS5ib3RUeXBlQmFzZVN5bWJvbCwgcGFnZS5ib3RUeXBlUXVvdGVTeW1ib2wpXG4gICAgY29uc3QgW2IsIHFdID0gW2FwcCgpLmFzc2V0c1tiYXNlSURdLCBhcHAoKS5hc3NldHNbcXVvdGVJRF1dXG4gICAgcGFnZS5ib3RUeXBlQmFzZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKGIsIHRydWUpKVxuICAgIHBhZ2UuYm90VHlwZVF1b3RlU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUocSwgdHJ1ZSkpXG4gICAgZm9yIChjb25zdCBkaXYgb2YgdGhpcy5ib3RUeXBlU2VsZWN0b3JzKSBkaXYuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgIGZvciAoY29uc3QgeyBkaXYgfSBvZiBPYmplY3QudmFsdWVzKHRoaXMuZm9ybUNleGVzKSkgZGl2LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICB0aGlzLnNldENFWEF2YWlsYWJpbGl0eShiYXNlSUQsIHF1b3RlSUQpXG4gICAgRG9jLmhpZGUocGFnZS5ub0NleGVzQ29uZmlndXJlZCwgcGFnZS5ub0NleE1hcmtldCwgcGFnZS5ub0NleE1hcmtldENvbmZpZ3VyZU1vcmUsIHBhZ2UuYm90VHlwZUVycilcbiAgICBjb25zdCBjZXhIYXNNYXJrZXQgPSB0aGlzLmNleE1hcmtldFN1cHBvcnRGaWx0ZXIoYmFzZUlELCBxdW90ZUlEKVxuICAgIGNvbnN0IHN1cHBvcnRpbmdDZXhlczogUmVjb3JkPHN0cmluZywgQ0VYQ29uZmlnPiA9IHt9XG4gICAgZm9yIChjb25zdCBjZXggb2YgT2JqZWN0LnZhbHVlcyhhcHAoKS5tbVN0YXR1cy5jZXhlcykpIHtcbiAgICAgIGlmIChjZXhIYXNNYXJrZXQoY2V4LmNvbmZpZy5uYW1lKSkgc3VwcG9ydGluZ0NleGVzW2NleC5jb25maWcubmFtZV0gPSBjZXguY29uZmlnXG4gICAgfVxuICAgIGNvbnN0IG5DZXhlcyA9IE9iamVjdC5rZXlzKHN1cHBvcnRpbmdDZXhlcykubGVuZ3RoXG4gICAgY29uc3QgYXJiRW5hYmxlZCA9IG5DZXhlcyA+IDBcbiAgICBmb3IgKGNvbnN0IGRpdiBvZiB0aGlzLmJvdFR5cGVTZWxlY3RvcnMpIGRpdi5jbGFzc0xpc3QudG9nZ2xlKCdkaXNhYmxlZCcsIGRpdi5kYXRhc2V0LmJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NICYmICFhcmJFbmFibGVkKVxuICAgIGlmIChPYmplY3Qua2V5cyhhcHAoKS5tbVN0YXR1cy5jZXhlcykubGVuZ3RoID09PSAwKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLm5vQ2V4ZXNDb25maWd1cmVkKVxuICAgICAgdGhpcy5zZXRCb3RUeXBlU2VsZWN0ZWQoYm90VHlwZUJhc2ljTU0pXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGxhc3RCb3RzID0gKFN0YXRlLmZldGNoTG9jYWwobGFzdEJvdHNMSykgfHwge30pIGFzIFJlY29yZDxzdHJpbmcsIEJvdFNwZWNzPlxuICAgICAgY29uc3QgbGFzdEJvdCA9IGxhc3RCb3RzW2Ake2Jhc2VJRH1fJHtxdW90ZUlEfV8ke2hvc3R9YF1cbiAgICAgIGxldCBjZXg6IENFWENvbmZpZyB8IHVuZGVmaW5lZFxuICAgICAgYm90VHlwZSA9IGJvdFR5cGUgPz8gKGxhc3RCb3QgPyBsYXN0Qm90LmJvdFR5cGUgOiBib3RUeXBlQXJiTU0pXG4gICAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljTU0pIHtcbiAgICAgICAgLy8gRm91ciB3YXlzIHRvIGF1dG8tc2VsZWN0IGEgY2V4LlxuICAgICAgICAvLyAxLiBDb21pbmcgYmFjayBmcm9tIHRoZSBjZXggY29uZmlndXJhdGlvbiBmb3JtLlxuICAgICAgICBpZiAoY29uZmlndXJlZENFWCkgY2V4ID0gc3VwcG9ydGluZ0NleGVzW2NvbmZpZ3VyZWRDRVhdXG4gICAgICAgIC8vIDIuIFdlIGhhdmUgYSBzYXZlZCBjb25maWd1cmF0aW9uLlxuICAgICAgICBpZiAoIWNleCAmJiBsYXN0Qm90KSBjZXggPSBzdXBwb3J0aW5nQ2V4ZXNbbGFzdEJvdC5jZXhOYW1lID8/ICcnXVxuICAgICAgICAvLyAzLiBUaGUgbGFzdCBleGNoYW5nZSB0aGF0IHRoZSB1c2VyIHNlbGVjdGVkLlxuICAgICAgICBpZiAoIWNleCkge1xuICAgICAgICAgIGNvbnN0IGxhc3RDRVggPSBTdGF0ZS5mZXRjaExvY2FsKGxhc3RBcmJFeGNoYW5nZUxLKVxuICAgICAgICAgIGlmIChsYXN0Q0VYKSBjZXggPSBzdXBwb3J0aW5nQ2V4ZXNbbGFzdENFWF1cbiAgICAgICAgfVxuICAgICAgICAvLyA0LiBBbnkgc3VwcG9ydGluZyBjZXguXG4gICAgICAgIGlmICghY2V4ICYmIG5DZXhlcyA+IDApIGNleCA9IE9iamVjdC52YWx1ZXMoc3VwcG9ydGluZ0NleGVzKVswXVxuICAgICAgfVxuICAgICAgaWYgKGNleCkge1xuICAgICAgICBwYWdlLmNleFNlbGVjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpXG4gICAgICAgIHRoaXMuc2V0Qm90VHlwZVNlbGVjdGVkKGJvdFR5cGUgPz8gKGxhc3RCb3QgPyBsYXN0Qm90LmJvdFR5cGUgOiBib3RUeXBlQXJiTU0pKVxuICAgICAgICB0aGlzLnNlbGVjdEZvcm1DRVgoY2V4Lm5hbWUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYWdlLmNleFNlbGVjdGlvbi5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpXG4gICAgICAgIERvYy5zaG93KHBhZ2Uubm9DZXhNYXJrZXQpXG4gICAgICAgIHRoaXMuc2V0Qm90VHlwZVNlbGVjdGVkKGJvdFR5cGVCYXNpY01NKVxuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgdW5jb25maWd1cmVkIGNleGVzLCBzaG93IGNvbmZpZ3VyZU1vcmUgbWVzc2FnZS5cbiAgICAgICAgY29uc3QgdW5jb25maWd1cmVkID0gT2JqZWN0LmtleXMoQ0VYRGlzcGxheUluZm9zKS5maWx0ZXIoKGNleE5hbWU6IHN0cmluZykgPT4gIWFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWVdKVxuICAgICAgICBjb25zdCBhbGxDb25maWd1cmVkID0gdW5jb25maWd1cmVkLmxlbmd0aCA9PT0gMCB8fCAodW5jb25maWd1cmVkLmxlbmd0aCA9PT0gMSAmJiAodW5jb25maWd1cmVkWzBdID09PSAnQmluYW5jZScgfHwgdW5jb25maWd1cmVkWzBdID09PSAnQmluYW5jZVVTJykpXG4gICAgICAgIGlmICghYWxsQ29uZmlndXJlZCkgRG9jLnNob3cocGFnZS5ub0NleE1hcmtldENvbmZpZ3VyZU1vcmUpXG4gICAgICB9XG4gICAgfVxuXG4gICAgRG9jLnNob3cocGFnZS5jZXhTZWxlY3Rpb24pXG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhbnkgY2V4ZXMgY29uZmlndXJlZC5cbiAgICB0aGlzLmZvcm1zLnNob3cocGFnZS5ib3RUeXBlRm9ybSlcbiAgfVxuXG4gIHJlc2hvd0JvdFR5cGVGb3JtICgpIHtcbiAgICBpZiAoaXNWaWV3T25seSh0aGlzLnNwZWNzLCBhcHAoKS5tbVN0YXR1cykpIHRoaXMuc2hvd01hcmtldFNlbGVjdEZvcm0oKVxuICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlELCBob3N0LCBjZXhOYW1lLCBib3RUeXBlIH0gPSB0aGlzLnNwZWNzXG4gICAgdGhpcy5zaG93Qm90VHlwZUZvcm0oaG9zdCwgYmFzZUlELCBxdW90ZUlELCBib3RUeXBlLCBjZXhOYW1lKVxuICB9XG5cbiAgc2V0Qm90VHlwZVNlbGVjdGVkIChzZWxlY3RlZFR5cGU6IHN0cmluZykge1xuICAgIGNvbnN0IHsgZm9ybVNwZWNzOiB7IGJhc2VJRCwgcXVvdGVJRCwgaG9zdCB9LCBib3RUeXBlU2VsZWN0b3JzLCBmb3JtQ2V4ZXMgfSA9IHRoaXNcbiAgICBmb3IgKGNvbnN0IHsgY2xhc3NMaXN0LCBkYXRhc2V0OiB7IGJvdFR5cGUgfSB9IG9mIGJvdFR5cGVTZWxlY3RvcnMpIGNsYXNzTGlzdC50b2dnbGUoJ3NlbGVjdGVkJywgYm90VHlwZSA9PT0gc2VsZWN0ZWRUeXBlKVxuICAgIC8vIElmIHdlIGRvbid0IGhhdmUgYSBjZXggc2VsZWN0ZWQsIGF0dGVtcHQgdG8gc2VsZWN0IG9uZVxuICAgIGlmIChzZWxlY3RlZFR5cGUgPT09IGJvdFR5cGVCYXNpY01NKSByZXR1cm5cbiAgICBjb25zdCBtbVN0YXR1cyA9IGFwcCgpLm1tU3RhdHVzXG4gICAgaWYgKE9iamVjdC5rZXlzKG1tU3RhdHVzLmNleGVzKS5sZW5ndGggPT09IDApIHJldHVyblxuICAgIGNvbnN0IGNleEhhc01hcmtldCA9IHRoaXMuY2V4TWFya2V0U3VwcG9ydEZpbHRlcihiYXNlSUQsIHF1b3RlSUQpXG4gICAgLy8gSWYgdGhlcmUgaXMgb25lIGN1cnJlbnRseSBzZWxlY3RlZCBhbmQgaXQgc3VwcG9ydHMgdGhpcyBtYXJrZXQsIGxlYXZlIGl0LlxuICAgIGNvbnN0IHNlbGVjdGVkcyA9IE9iamVjdC52YWx1ZXMoZm9ybUNleGVzKS5maWx0ZXIoKGNleDogY2V4QnV0dG9uKSA9PiBjZXguZGl2LmNsYXNzTGlzdC5jb250YWlucygnc2VsZWN0ZWQnKSlcbiAgICBpZiAoc2VsZWN0ZWRzLmxlbmd0aCAmJiBjZXhIYXNNYXJrZXQoc2VsZWN0ZWRzWzBdLm5hbWUpKSByZXR1cm5cbiAgICAvLyBTZWUgaWYgd2UgaGF2ZSBhIHNhdmVkIGNvbmZpZ3VyYXRpb24uXG4gICAgY29uc3QgbGFzdEJvdHMgPSAoU3RhdGUuZmV0Y2hMb2NhbChsYXN0Qm90c0xLKSB8fCB7fSkgYXMgUmVjb3JkPHN0cmluZywgQm90U3BlY3M+XG4gICAgY29uc3QgbGFzdEJvdCA9IGxhc3RCb3RzW2Ake2Jhc2VJRH1fJHtxdW90ZUlEfV8ke2hvc3R9YF1cbiAgICBpZiAobGFzdEJvdCkge1xuICAgICAgY29uc3QgY2V4ID0gbW1TdGF0dXMuY2V4ZXNbbGFzdEJvdC5jZXhOYW1lID8/ICcnXVxuICAgICAgaWYgKGNleCAmJiBjZXhIYXNNYXJrZXQoY2V4LmNvbmZpZy5uYW1lKSkge1xuICAgICAgICB0aGlzLnNlbGVjdEZvcm1DRVgoY2V4LmNvbmZpZy5uYW1lKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICB9XG4gICAgLy8gMi4gVGhlIGxhc3QgZXhjaGFuZ2UgdGhhdCB0aGUgdXNlciBzZWxlY3RlZC5cbiAgICBjb25zdCBsYXN0Q0VYID0gU3RhdGUuZmV0Y2hMb2NhbChsYXN0QXJiRXhjaGFuZ2VMSylcbiAgICBpZiAobGFzdENFWCkge1xuICAgICAgY29uc3QgY2V4ID0gbW1TdGF0dXMuY2V4ZXNbbGFzdENFWF1cbiAgICAgIGlmIChjZXggJiYgY2V4SGFzTWFya2V0KGNleC5jb25maWcubmFtZSkpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RGb3JtQ0VYKGNleC5jb25maWcubmFtZSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgfVxuICAgIC8vIDMuIEFueSBzdXBwb3J0aW5nIGNleC5cbiAgICBjb25zdCBjZXhlcyA9IE9iamVjdC52YWx1ZXMobW1TdGF0dXMuY2V4ZXMpLmZpbHRlcigoY2V4OiBNTUNFWFN0YXR1cykgPT4gY2V4SGFzTWFya2V0KGNleC5jb25maWcubmFtZSkpXG4gICAgaWYgKGNleGVzLmxlbmd0aCkgdGhpcy5zZWxlY3RGb3JtQ0VYKGNleGVzWzBdLmNvbmZpZy5uYW1lKVxuICB9XG5cbiAgc2hvd01hcmtldFNlbGVjdEZvcm0gKCkge1xuICAgIHRoaXMucGFnZS5tYXJrZXRGaWx0ZXJJbnB1dC52YWx1ZSA9ICcnXG4gICAgdGhpcy5zb3J0TWFya2V0Um93cygpXG4gICAgdGhpcy5mb3Jtcy5zaG93KHRoaXMucGFnZS5tYXJrZXRTZWxlY3RGb3JtKVxuICB9XG5cbiAgc29ydE1hcmtldFJvd3MgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBmaWx0ZXIgPSBwYWdlLm1hcmtldEZpbHRlcklucHV0LnZhbHVlPy50b0xvd2VyQ2FzZSgpXG4gICAgRG9jLmVtcHR5KHBhZ2UubWFya2V0U2VsZWN0KVxuICAgIGZvciAoY29uc3QgbXIgb2YgdGhpcy5tYXJrZXRSb3dzKSB7XG4gICAgICBtci50ci5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgICBpZiAoZmlsdGVyICYmICFtci5uYW1lLmluY2x1ZGVzKGZpbHRlcikpIGNvbnRpbnVlXG4gICAgICBwYWdlLm1hcmtldFNlbGVjdC5hcHBlbmRDaGlsZChtci50cilcbiAgICB9XG4gIH1cblxuICBoYW5kbGVCYWxhbmNlTm90ZSAobjogQmFsYW5jZU5vdGUpIHtcbiAgICB0aGlzLmFwcHJvdmVUb2tlbkZvcm0uaGFuZGxlQmFsYW5jZU5vdGUobilcbiAgICBpZiAoIXRoaXMubWFya2V0UmVwb3J0KSByZXR1cm5cbiAgICBjb25zdCB7IGJhc2VJRCwgcXVvdGVJRCwgcXVvdGVUb2tlbiwgYmFzZVRva2VuIH0gPSB0aGlzLm1hcmtldFN0dWZmKClcbiAgICBpZiAobi5hc3NldElEID09PSBiYXNlSUQgfHwgbi5hc3NldElEID09PSBiYXNlVG9rZW4/LnBhcmVudElEKSB7XG4gICAgICB0aGlzLmJhc2VQYW5lLnVwZGF0ZUJhbGFuY2VzKClcbiAgICB9IGVsc2UgaWYgKG4uYXNzZXRJRCA9PT0gcXVvdGVJRCB8fCBuLmFzc2V0SUQgPT09IHF1b3RlVG9rZW4/LnBhcmVudElEKSB7XG4gICAgICB0aGlzLnF1b3RlUGFuZS51cGRhdGVCYWxhbmNlcygpXG4gICAgfVxuICB9XG5cbiAgYXV0b1JlYmFsYW5jZUNoYW5nZWQgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgdXBkYXRlZENvbmZpZzogY2ZnIH0gPSB0aGlzXG4gICAgY2ZnLmNleFJlYmFsYW5jZSA9IHBhZ2UuY2V4UmViYWxhbmNlQ2hlY2tib3g/LmNoZWNrZWQgPz8gZmFsc2VcbiAgICB0aGlzLnVwZGF0ZUFsbG9jYXRpb25zKClcbiAgfVxuXG4gIGFzeW5jIHN1Ym1pdEJvdFR5cGUgKCkge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5wYWdlLmJvdFR5cGVGb3JtKVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnN1Ym1pdEJvdFdpdGhWYWxpZGF0aW9uKClcbiAgICB9IGZpbmFsbHkge1xuICAgICAgbG9hZGVkKClcbiAgICB9XG4gIH1cblxuICBhc3luYyBzdWJtaXRCb3RXaXRoVmFsaWRhdGlvbiAoKSB7XG4gICAgLy8gY2hlY2sgZm9yIHdhbGxldHNcbiAgICBjb25zdCB7IHBhZ2UsIGZvcm1zLCBmb3JtU3BlY3M6IHsgYmFzZUlELCBxdW90ZUlELCBob3N0IH0gfSA9IHRoaXNcblxuICAgIGlmICghYXBwKCkud2FsbGV0TWFwW2Jhc2VJRF0pIHtcbiAgICAgIHRoaXMubmV3V2FsbGV0Rm9ybS5zZXRBc3NldChiYXNlSUQpXG4gICAgICBmb3Jtcy5zaG93KHRoaXMucGFnZS5uZXdXYWxsZXRGb3JtKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmICghYXBwKCkud2FsbGV0TWFwW3F1b3RlSURdKSB7XG4gICAgICB0aGlzLm5ld1dhbGxldEZvcm0uc2V0QXNzZXQocXVvdGVJRClcbiAgICAgIGZvcm1zLnNob3codGhpcy5wYWdlLm5ld1dhbGxldEZvcm0pXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgLy8gQXJlIHRva2VucyBhcHByb3ZlZD9cbiAgICBjb25zdCBbYkFwcHJvdmFsLCBxQXBwcm92YWxdID0gdG9rZW5Bc3NldEFwcHJvdmFsU3RhdHVzZXMoaG9zdCwgYXBwKCkuYXNzZXRzW2Jhc2VJRF0sIGFwcCgpLmFzc2V0c1txdW90ZUlEXSlcbiAgICBpZiAoYkFwcHJvdmFsID09PSBBcHByb3ZhbFN0YXR1cy5Ob3RBcHByb3ZlZCkge1xuICAgICAgdGhpcy5hcHByb3ZlVG9rZW5Gb3JtLnNldEFzc2V0KGJhc2VJRCwgaG9zdClcbiAgICAgIGZvcm1zLnNob3cocGFnZS5hcHByb3ZlVG9rZW5Gb3JtKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmIChxQXBwcm92YWwgPT09IEFwcHJvdmFsU3RhdHVzLk5vdEFwcHJvdmVkKSB7XG4gICAgICB0aGlzLmFwcHJvdmVUb2tlbkZvcm0uc2V0QXNzZXQocXVvdGVJRCwgaG9zdClcbiAgICAgIGZvcm1zLnNob3cocGFnZS5hcHByb3ZlVG9rZW5Gb3JtKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3QgeyBib3RUeXBlU2VsZWN0b3JzIH0gPSB0aGlzXG4gICAgY29uc3Qgc2VsZWN0ZWRzID0gYm90VHlwZVNlbGVjdG9ycy5maWx0ZXIoKGRpdjogUGFnZUVsZW1lbnQpID0+IGRpdi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpXG4gICAgaWYgKHNlbGVjdGVkcy5sZW5ndGggPCAxKSB7XG4gICAgICBwYWdlLmJvdFR5cGVFcnIudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9OT19CT1RUWVBFKVxuICAgICAgRG9jLnNob3cocGFnZS5ib3RUeXBlRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IGJvdFR5cGUgPSB0aGlzLmZvcm1TcGVjcy5ib3RUeXBlID0gc2VsZWN0ZWRzWzBdLmRhdGFzZXQuYm90VHlwZSA/PyAnJ1xuICAgIGlmIChib3RUeXBlICE9PSBib3RUeXBlQmFzaWNNTSkge1xuICAgICAgY29uc3Qgc2VsZWN0ZWRzID0gT2JqZWN0LnZhbHVlcyh0aGlzLmZvcm1DZXhlcykuZmlsdGVyKChjZXg6IGNleEJ1dHRvbikgPT4gY2V4LmRpdi5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpXG4gICAgICBpZiAoc2VsZWN0ZWRzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgcGFnZS5ib3RUeXBlRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fQ0VYKVxuICAgICAgICBEb2Muc2hvdyhwYWdlLmJvdFR5cGVFcnIpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgY29uc3QgY2V4TmFtZSA9IHNlbGVjdGVkc1swXS5uYW1lXG4gICAgICB0aGlzLmZvcm1TcGVjcy5jZXhOYW1lID0gY2V4TmFtZVxuICAgICAgYXdhaXQgdGhpcy5mZXRjaENFWEJhbGFuY2VzKHRoaXMuZm9ybVNwZWNzKVxuICAgIH1cblxuICAgIHRoaXMuc3BlY3MgPSB0aGlzLmZvcm1TcGVjc1xuXG4gICAgdGhpcy5jb25maWd1cmVVSSgpXG4gICAgdGhpcy5mb3Jtcy5jbG9zZSgpXG4gIH1cblxuICBhc3luYyBmZXRjaENFWEJhbGFuY2VzIChzcGVjczogQm90U3BlY3MpIHtcbiAgICBjb25zdCB7IHBhZ2UgfSA9IHRoaXNcbiAgICBjb25zdCB7IGJhc2VJRCwgcXVvdGVJRCwgY2V4TmFtZSwgYm90VHlwZSB9ID0gc3BlY3NcbiAgICBpZiAoYm90VHlwZSA9PT0gYm90VHlwZUJhc2ljTU0gfHwgIWNleE5hbWUpIHJldHVyblxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIFRoaXMgd29uJ3Qgd29yayBpZiB3ZSBpbXBsZW1lbnQgbGl2ZSByZWNvbmZpZ3VyYXRpb24sIGJlY2F1c2UgbG9ja2VkXG4gICAgICAvLyBmdW5kcyB3b3VsZCBuZWVkIHRvIGJlIGNvbnNpZGVyZWQuXG4gICAgICB0aGlzLmNleEJhc2VCYWxhbmNlID0gYXdhaXQgTU0uY2V4QmFsYW5jZShjZXhOYW1lLCBiYXNlSUQpXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcGFnZS5ib3RUeXBlRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQ0VYQkFMQU5DRV9FUlIsIHsgY2V4TmFtZSwgYXNzZXRJRDogU3RyaW5nKGJhc2VJRCksIGVycjogU3RyaW5nKGUpIH0pXG4gICAgICBEb2Muc2hvdyhwYWdlLmJvdFR5cGVFcnIpXG4gICAgICB0aHJvdyBlXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuY2V4UXVvdGVCYWxhbmNlID0gYXdhaXQgTU0uY2V4QmFsYW5jZShjZXhOYW1lLCBxdW90ZUlEKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHBhZ2UuYm90VHlwZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0NFWEJBTEFOQ0VfRVJSLCB7IGNleE5hbWUsIGFzc2V0SUQ6IFN0cmluZyhxdW90ZUlEKSwgZXJyOiBTdHJpbmcoZSkgfSlcbiAgICAgIERvYy5zaG93KHBhZ2UuYm90VHlwZUVycilcbiAgICAgIHRocm93IGVcbiAgICB9XG4gIH1cblxuICBkZWZhdWx0V2FsbGV0T3B0aW9ucyAoYXNzZXRJRDogbnVtYmVyKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gICAgY29uc3Qgd2FsbGV0RGVmID0gYXBwKCkuY3VycmVudFdhbGxldERlZmluaXRpb24oYXNzZXRJRClcbiAgICBpZiAoIXdhbGxldERlZi5tdWx0aWZ1bmRpbmdvcHRzKSB7XG4gICAgICByZXR1cm4ge31cbiAgICB9XG4gICAgY29uc3Qgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9XG4gICAgZm9yIChjb25zdCBvcHQgb2Ygd2FsbGV0RGVmLm11bHRpZnVuZGluZ29wdHMpIHtcbiAgICAgIGlmIChvcHQucXVvdGVBc3NldE9ubHkgJiYgYXNzZXRJRCAhPT0gdGhpcy5zcGVjcy5xdW90ZUlEKSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG4gICAgICBvcHRpb25zW29wdC5rZXldID0gYCR7b3B0LmRlZmF1bHR9YFxuICAgIH1cbiAgICByZXR1cm4gb3B0aW9uc1xuICB9XG5cbiAgLypcbiAgICogdXBkYXRlTW9kaWZpZWRNYXJrZXJzIGNoZWNrcyBlYWNoIG9mIHRoZSBpbnB1dCBlbGVtZW50cyBvbiB0aGUgcGFnZSBhbmRcbiAgICogaWYgdGhlIGN1cnJlbnQgdmFsdWUgZG9lcyBub3QgbWF0Y2ggdGhlIG9yaWdpbmFsIHZhbHVlIChzaW5jZSB0aGUgbGFzdFxuICAgKiBzYXZlKSwgdGhlbiB0aGUgaW5wdXQgd2lsbCBoYXZlIGEgY29sb3JlZCBib3JkZXIuXG4gICAqL1xuICB1cGRhdGVNb2RpZmllZE1hcmtlcnMgKCkge1xuICAgIGlmICh0aGlzLmNyZWF0aW5nTmV3Qm90KSByZXR1cm5cbiAgICBjb25zdCB7IHBhZ2UsIG9yaWdpbmFsQ29uZmlnOiBvbGRDZmcsIHVwZGF0ZWRDb25maWc6IG5ld0NmZyB9ID0gdGhpc1xuXG4gICAgLy8gR2FwIHN0cmF0ZWd5IGlucHV0XG4gICAgY29uc3QgZ2FwU3RyYXRlZ3lNb2RpZmllZCA9IG9sZENmZy5nYXBTdHJhdGVneSAhPT0gbmV3Q2ZnLmdhcFN0cmF0ZWd5XG4gICAgcGFnZS5nYXBTdHJhdGVneVNlbGVjdC5jbGFzc0xpc3QudG9nZ2xlKCdtb2RpZmllZCcsIGdhcFN0cmF0ZWd5TW9kaWZpZWQpXG5cbiAgICBjb25zdCBwcm9maXRNb2RpZmllZCA9IG9sZENmZy5wcm9maXQgIT09IG5ld0NmZy5wcm9maXRcbiAgICBwYWdlLnByb2ZpdElucHV0LmNsYXNzTGlzdC50b2dnbGUoJ21vZGlmaWVkJywgcHJvZml0TW9kaWZpZWQpXG5cbiAgICAvLyBCdXkgcGxhY2VtZW50cyBJbnB1dFxuICAgIGxldCBidXlQbGFjZW1lbnRzTW9kaWZpZWQgPSBmYWxzZVxuICAgIGlmIChvbGRDZmcuYnV5UGxhY2VtZW50cy5sZW5ndGggIT09IG5ld0NmZy5idXlQbGFjZW1lbnRzLmxlbmd0aCkge1xuICAgICAgYnV5UGxhY2VtZW50c01vZGlmaWVkID0gdHJ1ZVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9sZENmZy5idXlQbGFjZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChvbGRDZmcuYnV5UGxhY2VtZW50c1tpXS5sb3RzICE9PSBuZXdDZmcuYnV5UGxhY2VtZW50c1tpXS5sb3RzIHx8XG4gICAgICAgICAgb2xkQ2ZnLmJ1eVBsYWNlbWVudHNbaV0uZ2FwRmFjdG9yICE9PSBuZXdDZmcuYnV5UGxhY2VtZW50c1tpXS5nYXBGYWN0b3IpIHtcbiAgICAgICAgICBidXlQbGFjZW1lbnRzTW9kaWZpZWQgPSB0cnVlXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBwYWdlLmJ1eVBsYWNlbWVudHNUYWJsZVdyYXBwZXIuY2xhc3NMaXN0LnRvZ2dsZSgnbW9kaWZpZWQnLCBidXlQbGFjZW1lbnRzTW9kaWZpZWQpXG5cbiAgICAvLyBTZWxsIHBsYWNlbWVudHMgaW5wdXRcbiAgICBsZXQgc2VsbFBsYWNlbWVudHNNb2RpZmllZCA9IGZhbHNlXG4gICAgaWYgKG9sZENmZy5zZWxsUGxhY2VtZW50cy5sZW5ndGggIT09IG5ld0NmZy5zZWxsUGxhY2VtZW50cy5sZW5ndGgpIHtcbiAgICAgIHNlbGxQbGFjZW1lbnRzTW9kaWZpZWQgPSB0cnVlXG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb2xkQ2ZnLnNlbGxQbGFjZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChvbGRDZmcuc2VsbFBsYWNlbWVudHNbaV0ubG90cyAhPT0gbmV3Q2ZnLnNlbGxQbGFjZW1lbnRzW2ldLmxvdHMgfHxcbiAgICAgICAgICBvbGRDZmcuc2VsbFBsYWNlbWVudHNbaV0uZ2FwRmFjdG9yICE9PSBuZXdDZmcuc2VsbFBsYWNlbWVudHNbaV0uZ2FwRmFjdG9yKSB7XG4gICAgICAgICAgc2VsbFBsYWNlbWVudHNNb2RpZmllZCA9IHRydWVcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHBhZ2Uuc2VsbFBsYWNlbWVudHNUYWJsZVdyYXBwZXIuY2xhc3NMaXN0LnRvZ2dsZSgnbW9kaWZpZWQnLCBzZWxsUGxhY2VtZW50c01vZGlmaWVkKVxuICB9XG5cbiAgLypcbiAgICogZ2FwRmFjdG9ySGVhZGVyVW5pdCByZXR1cm5zIHRoZSBoZWFkZXIgb24gdGhlIHBsYWNlbWVudHMgdGFibGUgYW5kIHRoZVxuICAgKiB1bml0cyBpbiB0aGUgZ2FwIGZhY3RvciByb3dzIG5lZWRlZCBmb3IgZWFjaCBnYXAgc3RyYXRlZ3kuXG4gICAqL1xuICBnYXBGYWN0b3JIZWFkZXJVbml0IChnYXBTdHJhdGVneTogc3RyaW5nKTogW3N0cmluZywgc3RyaW5nXSB7XG4gICAgc3dpdGNoIChnYXBTdHJhdGVneSkge1xuICAgICAgY2FzZSBHYXBTdHJhdGVneU11bHRpcGxpZXI6XG4gICAgICAgIHJldHVybiBbJ011bHRpcGxpZXInLCAneCddXG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5QWJzb2x1dGU6XG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5QWJzb2x1dGVQbHVzOiB7XG4gICAgICAgIGNvbnN0IHJhdGVVbml0ID0gYCR7YXBwKCkuYXNzZXRzW3RoaXMuc3BlY3MucXVvdGVJRF0uc3ltYm9sfS8ke2FwcCgpLmFzc2V0c1t0aGlzLnNwZWNzLmJhc2VJRF0uc3ltYm9sfWBcbiAgICAgICAgcmV0dXJuIFsnUmF0ZScsIHJhdGVVbml0XVxuICAgICAgfVxuICAgICAgY2FzZSBHYXBTdHJhdGVneVBlcmNlbnQ6XG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5UGVyY2VudFBsdXM6XG4gICAgICAgIHJldHVybiBbJ1BlcmNlbnQnLCAnJSddXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gZ2FwIHN0cmF0ZWd5ICR7Z2FwU3RyYXRlZ3l9YClcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBjaGVja0dhcEZhY3RvclJhbmdlIHJldHVybnMgYW4gZXJyb3Igc3RyaW5nIGlmIHRoZSB2YWx1ZSBpbnB1dCBmb3IgYVxuICAgKiBnYXAgZmFjdG9yIGlzIHZhbGlkIGZvciB0aGUgY3VycmVudGx5IHNlbGVjdGVkIGdhcCBzdHJhdGVneS5cbiAgICovXG4gIGNoZWNrR2FwRmFjdG9yUmFuZ2UgKGdhcEZhY3Rvcjogc3RyaW5nLCB2YWx1ZTogbnVtYmVyKTogKHN0cmluZyB8IG51bGwpIHtcbiAgICBzd2l0Y2ggKGdhcEZhY3Rvcikge1xuICAgICAgY2FzZSBHYXBTdHJhdGVneU11bHRpcGxpZXI6XG4gICAgICAgIGlmICh2YWx1ZSA8IDEgfHwgdmFsdWUgPiAxMDApIHtcbiAgICAgICAgICByZXR1cm4gJ011bHRpcGxpZXIgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDEwMCdcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgY2FzZSBHYXBTdHJhdGVneUFic29sdXRlOlxuICAgICAgY2FzZSBHYXBTdHJhdGVneUFic29sdXRlUGx1czpcbiAgICAgICAgaWYgKHZhbHVlIDw9IDApIHtcbiAgICAgICAgICByZXR1cm4gJ1JhdGUgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCdcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgY2FzZSBHYXBTdHJhdGVneVBlcmNlbnQ6XG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5UGVyY2VudFBsdXM6XG4gICAgICAgIGlmICh2YWx1ZSA8PSAwIHx8IHZhbHVlID4gMTApIHtcbiAgICAgICAgICByZXR1cm4gJ1BlcmNlbnQgbXVzdCBiZSBiZXR3ZWVuIDAgYW5kIDEwJ1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsXG4gICAgICBkZWZhdWx0OiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBnYXAgZmFjdG9yICR7Z2FwRmFjdG9yfWApXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogY29udmVydEdhcEZhY3RvciBjb252ZXJ0cyBiZXR3ZWVuIHRoZSBkaXNwbGF5ZWQgZ2FwIGZhY3RvciBpbiB0aGVcbiAgICogcGxhY2VtZW50IHRhYmxlcyBhbmQgdGhlIG51bWJlciB0aGF0IGlzIHBhc3NlZCB0byB0aGUgbWFya2V0IG1ha2VyLlxuICAgKiBGb3IgZ2FwIHN0cmF0ZWdpZXMgdGhhdCBpbnZvbHZlIGEgcGVyY2VudGFnZSBpdCBjb252ZXJ0cyBiZXR3ZWVuIHRoZVxuICAgKiBkZWNpbWFsIHZhbHVlIHJlcXVpcmVkIGJ5IHRoZSBiYWNrZW5kIGFuZCBhIHBlcmNlbnRhZ2UgZGlzcGxheWVkIHRvXG4gICAqIHRoZSB1c2VyLlxuICAgKi9cbiAgY29udmVydEdhcEZhY3RvciAoZ2FwRmFjdG9yOiBudW1iZXIsIGdhcFN0cmF0ZWd5OiBzdHJpbmcsIHRvRGlzcGxheTogYm9vbGVhbik6IG51bWJlciB7XG4gICAgc3dpdGNoIChnYXBTdHJhdGVneSkge1xuICAgICAgY2FzZSBHYXBTdHJhdGVneU11bHRpcGxpZXI6XG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5QWJzb2x1dGU6XG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5QWJzb2x1dGVQbHVzOlxuICAgICAgICByZXR1cm4gZ2FwRmFjdG9yXG4gICAgICBjYXNlIEdhcFN0cmF0ZWd5UGVyY2VudDpcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lQZXJjZW50UGx1czpcbiAgICAgICAgaWYgKHRvRGlzcGxheSkge1xuICAgICAgICAgIHJldHVybiBnYXBGYWN0b3IgKiAxMDBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZ2FwRmFjdG9yIC8gMTAwXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gZ2FwIGZhY3RvciAke2dhcFN0cmF0ZWd5fWApXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogYWRkUGxhY2VtZW50IGFkZHMgYSByb3cgdG8gYSBwbGFjZW1lbnQgdGFibGUuIFRoaXMgaXMgY2FsbGVkIGJvdGggd2hlblxuICAgKiB0aGUgcGFnZSBpcyBpbml0aWFsbHkgbG9hZGVkLCBhbmQgd2hlbiB0aGUgXCJhZGRcIiBidXR0b24gaXMgcHJlc3NlZCBvblxuICAgKiB0aGUgcGxhY2VtZW50IHRhYmxlLiBpbml0aWFsTG9hZFBsYWNlbWVudCBpcyBub24tbmlsIGlmIHRoaXMgaXMgYmVpbmdcbiAgICogY2FsbGVkIG9uIHRoZSBpbml0aWFsIGxvYWQuXG4gICAqL1xuICBhZGRQbGFjZW1lbnQgKGlzQnV5OiBib29sZWFuLCBpbml0aWFsTG9hZFBsYWNlbWVudDogT3JkZXJQbGFjZW1lbnQgfCBudWxsLCBnYXBTdHJhdGVneT86IHN0cmluZykge1xuICAgIGNvbnN0IHsgcGFnZSwgdXBkYXRlZENvbmZpZzogY2ZnIH0gPSB0aGlzXG5cbiAgICBsZXQgdGFibGVCb2R5OiBQYWdlRWxlbWVudCA9IHBhZ2Uuc2VsbFBsYWNlbWVudHNUYWJsZUJvZHlcbiAgICBsZXQgYWRkUGxhY2VtZW50Um93OiBQYWdlRWxlbWVudCA9IHBhZ2UuYWRkU2VsbFBsYWNlbWVudFJvd1xuICAgIGxldCBsb3RzRWxlbWVudDogUGFnZUVsZW1lbnQgPSBwYWdlLmFkZFNlbGxQbGFjZW1lbnRMb3RzXG4gICAgbGV0IGdhcEZhY3RvckVsZW1lbnQ6IFBhZ2VFbGVtZW50ID0gcGFnZS5hZGRTZWxsUGxhY2VtZW50R2FwRmFjdG9yXG4gICAgbGV0IGVyckVsZW1lbnQ6IFBhZ2VFbGVtZW50ID0gcGFnZS5zZWxsUGxhY2VtZW50c0VyclxuICAgIGlmIChpc0J1eSkge1xuICAgICAgdGFibGVCb2R5ID0gcGFnZS5idXlQbGFjZW1lbnRzVGFibGVCb2R5XG4gICAgICBhZGRQbGFjZW1lbnRSb3cgPSBwYWdlLmFkZEJ1eVBsYWNlbWVudFJvd1xuICAgICAgbG90c0VsZW1lbnQgPSBwYWdlLmFkZEJ1eVBsYWNlbWVudExvdHNcbiAgICAgIGdhcEZhY3RvckVsZW1lbnQgPSBwYWdlLmFkZEJ1eVBsYWNlbWVudEdhcEZhY3RvclxuICAgICAgZXJyRWxlbWVudCA9IHBhZ2UuYnV5UGxhY2VtZW50c0VyclxuICAgIH1cblxuICAgIERvYy5oaWRlKGVyckVsZW1lbnQpXG5cbiAgICAvLyB1cGRhdGVBcnJvd1ZpcyB1cGRhdGVzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBtb3ZlIHVwL2Rvd24gYXJyb3dzIGluXG4gICAgLy8gZWFjaCByb3cgb2YgdGhlIHBsYWNlbWVudCB0YWJsZS4gVGhlIHVwIGFycm93IGlzIG5vdCBzaG93biBvbiB0aGVcbiAgICAvLyB0b3Agcm93LCBhbmQgdGhlIGRvd24gYXJyb3cgaXMgbm90IHNob3duIG9uIHRoZSBib3R0b20gcm93LiBUaGV5XG4gICAgLy8gYXJlIGFsbCBoaWRkZW4gaWYgbWFya2V0IG1ha2luZyBpcyBydW5uaW5nLlxuICAgIGNvbnN0IHVwZGF0ZUFycm93VmlzID0gKCkgPT4ge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YWJsZUJvZHkuY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHJvdyA9IERvYy5wYXJzZVRlbXBsYXRlKHRhYmxlQm9keS5jaGlsZHJlbltpXSBhcyBIVE1MRWxlbWVudClcbiAgICAgICAgRG9jLnNldFZpcyhpICE9PSAwLCByb3cudXBCdG4pXG4gICAgICAgIERvYy5zZXRWaXMoaSAhPT0gdGFibGVCb2R5LmNoaWxkcmVuLmxlbmd0aCAtIDIsIHJvdy5kb3duQnRuKVxuICAgICAgfVxuICAgIH1cblxuICAgIERvYy5oaWRlKGVyckVsZW1lbnQpXG4gICAgY29uc3Qgc2V0RXJyID0gKGVycjogc3RyaW5nKSA9PiB7XG4gICAgICBlcnJFbGVtZW50LnRleHRDb250ZW50ID0gZXJyXG4gICAgICBEb2Muc2hvdyhlcnJFbGVtZW50KVxuICAgIH1cblxuICAgIGxldCBsb3RzOiBudW1iZXJcbiAgICBsZXQgYWN0dWFsR2FwRmFjdG9yOiBudW1iZXJcbiAgICBsZXQgZGlzcGxheWVkR2FwRmFjdG9yOiBudW1iZXJcbiAgICBpZiAoIWdhcFN0cmF0ZWd5KSBnYXBTdHJhdGVneSA9IHRoaXMuc3BlY3MuY2V4TmFtZSA/IEdhcFN0cmF0ZWd5TXVsdGlwbGllciA6IGNmZy5nYXBTdHJhdGVneVxuICAgIGNvbnN0IHBsYWNlbWVudHMgPSBpc0J1eSA/IGNmZy5idXlQbGFjZW1lbnRzIDogY2ZnLnNlbGxQbGFjZW1lbnRzXG4gICAgY29uc3QgdW5pdCA9IHRoaXMuZ2FwRmFjdG9ySGVhZGVyVW5pdChnYXBTdHJhdGVneSlbMV1cbiAgICBpZiAoaW5pdGlhbExvYWRQbGFjZW1lbnQpIHtcbiAgICAgIGxvdHMgPSBpbml0aWFsTG9hZFBsYWNlbWVudC5sb3RzXG4gICAgICBhY3R1YWxHYXBGYWN0b3IgPSBpbml0aWFsTG9hZFBsYWNlbWVudC5nYXBGYWN0b3JcbiAgICAgIGRpc3BsYXllZEdhcEZhY3RvciA9IHRoaXMuY29udmVydEdhcEZhY3RvcihhY3R1YWxHYXBGYWN0b3IsIGdhcFN0cmF0ZWd5LCB0cnVlKVxuICAgIH0gZWxzZSB7XG4gICAgICBsb3RzID0gcGFyc2VJbnQobG90c0VsZW1lbnQudmFsdWUgfHwgJzAnKVxuICAgICAgZGlzcGxheWVkR2FwRmFjdG9yID0gcGFyc2VGbG9hdChnYXBGYWN0b3JFbGVtZW50LnZhbHVlIHx8ICcwJylcbiAgICAgIGFjdHVhbEdhcEZhY3RvciA9IHRoaXMuY29udmVydEdhcEZhY3RvcihkaXNwbGF5ZWRHYXBGYWN0b3IsIGdhcFN0cmF0ZWd5LCBmYWxzZSlcbiAgICAgIGlmIChsb3RzID09PSAwKSB7XG4gICAgICAgIHNldEVycignTG90cyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJylcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGdhcEZhY3RvckVyciA9IHRoaXMuY2hlY2tHYXBGYWN0b3JSYW5nZShnYXBTdHJhdGVneSwgZGlzcGxheWVkR2FwRmFjdG9yKVxuICAgICAgaWYgKGdhcEZhY3RvckVycikge1xuICAgICAgICBzZXRFcnIoZ2FwRmFjdG9yRXJyKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgaWYgKHBsYWNlbWVudHMuZmluZCgocGxhY2VtZW50KSA9PiBwbGFjZW1lbnQuZ2FwRmFjdG9yID09PSBhY3R1YWxHYXBGYWN0b3IpXG4gICAgICApIHtcbiAgICAgICAgc2V0RXJyKCdEdXBsaWNhdGUgcGxhY2VtZW50JylcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIHBsYWNlbWVudHMucHVzaCh7IGxvdHMsIGdhcEZhY3RvcjogYWN0dWFsR2FwRmFjdG9yIH0pXG4gICAgfVxuXG4gICAgY29uc3QgbmV3Um93ID0gcGFnZS5wbGFjZW1lbnRSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgIGNvbnN0IG5ld1Jvd1RtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShuZXdSb3cpXG4gICAgbmV3Um93VG1wbC5wcmlvcml0eS50ZXh0Q29udGVudCA9IGAke3RhYmxlQm9keS5jaGlsZHJlbi5sZW5ndGh9YFxuICAgIG5ld1Jvd1RtcGwubG90cy50ZXh0Q29udGVudCA9IGAke2xvdHN9YFxuICAgIG5ld1Jvd1RtcGwuZ2FwRmFjdG9yLnRleHRDb250ZW50ID0gYCR7ZGlzcGxheWVkR2FwRmFjdG9yfSAke3VuaXR9YFxuICAgIERvYy5iaW5kKG5ld1Jvd1RtcGwucmVtb3ZlQnRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHBsYWNlbWVudHMuZmluZEluZGV4KChwbGFjZW1lbnQpID0+IHtcbiAgICAgICAgcmV0dXJuIHBsYWNlbWVudC5sb3RzID09PSBsb3RzICYmIHBsYWNlbWVudC5nYXBGYWN0b3IgPT09IGFjdHVhbEdhcEZhY3RvclxuICAgICAgfSlcbiAgICAgIGlmIChpbmRleCA9PT0gLTEpIHJldHVyblxuICAgICAgcGxhY2VtZW50cy5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICBuZXdSb3cucmVtb3ZlKClcbiAgICAgIHVwZGF0ZUFycm93VmlzKClcbiAgICAgIHRoaXMudXBkYXRlTW9kaWZpZWRNYXJrZXJzKClcbiAgICAgIHRoaXMucGxhY2VtZW50c0NoYXJ0LnJlbmRlcigpXG4gICAgICB0aGlzLnVwZGF0ZUFsbG9jYXRpb25zKClcbiAgICB9KVxuXG4gICAgRG9jLmJpbmQobmV3Um93VG1wbC51cEJ0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSBwbGFjZW1lbnRzLmZpbmRJbmRleCgocDogT3JkZXJQbGFjZW1lbnQpID0+IHAubG90cyA9PT0gbG90cyAmJiBwLmdhcEZhY3RvciA9PT0gYWN0dWFsR2FwRmFjdG9yKVxuICAgICAgaWYgKGluZGV4ID09PSAwKSByZXR1cm5cbiAgICAgIGNvbnN0IHByZXZQbGFjZW1lbnQgPSBwbGFjZW1lbnRzW2luZGV4IC0gMV1cbiAgICAgIHBsYWNlbWVudHNbaW5kZXggLSAxXSA9IHBsYWNlbWVudHNbaW5kZXhdXG4gICAgICBwbGFjZW1lbnRzW2luZGV4XSA9IHByZXZQbGFjZW1lbnRcbiAgICAgIG5ld1Jvd1RtcGwucHJpb3JpdHkudGV4dENvbnRlbnQgPSBgJHtpbmRleH1gXG4gICAgICBuZXdSb3cucmVtb3ZlKClcbiAgICAgIHRhYmxlQm9keS5pbnNlcnRCZWZvcmUobmV3Um93LCB0YWJsZUJvZHkuY2hpbGRyZW5baW5kZXggLSAxXSlcbiAgICAgIGNvbnN0IG1vdmVkRG93blRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShcbiAgICAgICAgdGFibGVCb2R5LmNoaWxkcmVuW2luZGV4XSBhcyBIVE1MRWxlbWVudFxuICAgICAgKVxuICAgICAgbW92ZWREb3duVG1wbC5wcmlvcml0eS50ZXh0Q29udGVudCA9IGAke2luZGV4ICsgMX1gXG4gICAgICB1cGRhdGVBcnJvd1ZpcygpXG4gICAgICB0aGlzLnVwZGF0ZU1vZGlmaWVkTWFya2VycygpXG4gICAgfSlcblxuICAgIERvYy5iaW5kKG5ld1Jvd1RtcGwuZG93bkJ0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW5kZXggPSBwbGFjZW1lbnRzLmZpbmRJbmRleCgocCkgPT4gcC5sb3RzID09PSBsb3RzICYmIHAuZ2FwRmFjdG9yID09PSBhY3R1YWxHYXBGYWN0b3IpXG4gICAgICBpZiAoaW5kZXggPT09IHBsYWNlbWVudHMubGVuZ3RoIC0gMSkgcmV0dXJuXG4gICAgICBjb25zdCBuZXh0UGxhY2VtZW50ID0gcGxhY2VtZW50c1tpbmRleCArIDFdXG4gICAgICBwbGFjZW1lbnRzW2luZGV4ICsgMV0gPSBwbGFjZW1lbnRzW2luZGV4XVxuICAgICAgcGxhY2VtZW50c1tpbmRleF0gPSBuZXh0UGxhY2VtZW50XG4gICAgICBuZXdSb3dUbXBsLnByaW9yaXR5LnRleHRDb250ZW50ID0gYCR7aW5kZXggKyAyfWBcbiAgICAgIG5ld1Jvdy5yZW1vdmUoKVxuICAgICAgdGFibGVCb2R5Lmluc2VydEJlZm9yZShuZXdSb3csIHRhYmxlQm9keS5jaGlsZHJlbltpbmRleCArIDFdKVxuICAgICAgY29uc3QgbW92ZWRVcFRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShcbiAgICAgICAgdGFibGVCb2R5LmNoaWxkcmVuW2luZGV4XSBhcyBIVE1MRWxlbWVudFxuICAgICAgKVxuICAgICAgbW92ZWRVcFRtcGwucHJpb3JpdHkudGV4dENvbnRlbnQgPSBgJHtpbmRleCArIDF9YFxuICAgICAgdXBkYXRlQXJyb3dWaXMoKVxuICAgICAgdGhpcy51cGRhdGVNb2RpZmllZE1hcmtlcnMoKVxuICAgIH0pXG5cbiAgICB0YWJsZUJvZHkuaW5zZXJ0QmVmb3JlKG5ld1JvdywgYWRkUGxhY2VtZW50Um93KVxuICAgIHVwZGF0ZUFycm93VmlzKClcbiAgfVxuXG4gIHNldEFyYk1NTGFiZWxzICgpIHtcbiAgICB0aGlzLnBhZ2UuYnV5R2FwRmFjdG9ySGRyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTUFUQ0hfQlVGRkVSKVxuICAgIHRoaXMucGFnZS5zZWxsR2FwRmFjdG9ySGRyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTUFUQ0hfQlVGRkVSKVxuICB9XG5cbiAgLypcbiAgICogc2V0R2FwRmFjdG9yTGFiZWxzIHNldHMgdGhlIGhlYWRlcnMgb24gdGhlIGdhcCBmYWN0b3IgY29sdW1uIG9mIGVhY2hcbiAgICogcGxhY2VtZW50IHRhYmxlLlxuICAgKi9cbiAgc2V0R2FwRmFjdG9yTGFiZWxzIChnYXBTdHJhdGVneTogc3RyaW5nKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGhlYWRlciA9IHRoaXMuZ2FwRmFjdG9ySGVhZGVyVW5pdChnYXBTdHJhdGVneSlbMF1cbiAgICBwYWdlLmJ1eUdhcEZhY3Rvckhkci50ZXh0Q29udGVudCA9IGhlYWRlclxuICAgIHBhZ2Uuc2VsbEdhcEZhY3Rvckhkci50ZXh0Q29udGVudCA9IGhlYWRlclxuICAgIERvYy5oaWRlKHBhZ2UucGVyY2VudFBsdXNJbmZvLCBwYWdlLnBlcmNlbnRJbmZvLCBwYWdlLmFic29sdXRlUGx1c0luZm8sIHBhZ2UuYWJzb2x1dGVJbmZvLCBwYWdlLm11bHRpcGxpZXJJbmZvKVxuICAgIHN3aXRjaCAoZ2FwU3RyYXRlZ3kpIHtcbiAgICAgIGNhc2UgJ3BlcmNlbnQtcGx1cyc6XG4gICAgICAgIHJldHVybiBEb2Muc2hvdyhwYWdlLnBlcmNlbnRQbHVzSW5mbylcbiAgICAgIGNhc2UgJ3BlcmNlbnQnOlxuICAgICAgICByZXR1cm4gRG9jLnNob3cocGFnZS5wZXJjZW50SW5mbylcbiAgICAgIGNhc2UgJ2Fic29sdXRlLXBsdXMnOlxuICAgICAgICByZXR1cm4gRG9jLnNob3cocGFnZS5hYnNvbHV0ZVBsdXNJbmZvKVxuICAgICAgY2FzZSAnYWJzb2x1dGUnOlxuICAgICAgICByZXR1cm4gRG9jLnNob3cocGFnZS5hYnNvbHV0ZUluZm8pXG4gICAgICBjYXNlICdtdWx0aXBsaWVyJzpcbiAgICAgICAgcmV0dXJuIERvYy5zaG93KHBhZ2UubXVsdGlwbGllckluZm8pXG4gICAgfVxuICB9XG5cbiAgY2xlYXJQbGFjZW1lbnRzIChjYWNoZUtleTogc3RyaW5nKSB7XG4gICAgY29uc3QgeyBwYWdlLCB1cGRhdGVkQ29uZmlnOiBjZmcgfSA9IHRoaXNcbiAgICB3aGlsZSAocGFnZS5idXlQbGFjZW1lbnRzVGFibGVCb2R5LmNoaWxkcmVuLmxlbmd0aCA+IDEpIHtcbiAgICAgIHBhZ2UuYnV5UGxhY2VtZW50c1RhYmxlQm9keS5jaGlsZHJlblswXS5yZW1vdmUoKVxuICAgIH1cbiAgICB3aGlsZSAocGFnZS5zZWxsUGxhY2VtZW50c1RhYmxlQm9keS5jaGlsZHJlbi5sZW5ndGggPiAxKSB7XG4gICAgICBwYWdlLnNlbGxQbGFjZW1lbnRzVGFibGVCb2R5LmNoaWxkcmVuWzBdLnJlbW92ZSgpXG4gICAgfVxuICAgIHRoaXMucGxhY2VtZW50c0NhY2hlW2NhY2hlS2V5XSA9IFtjZmcuYnV5UGxhY2VtZW50cywgY2ZnLnNlbGxQbGFjZW1lbnRzXVxuICAgIGNmZy5idXlQbGFjZW1lbnRzLnNwbGljZSgwLCBjZmcuYnV5UGxhY2VtZW50cy5sZW5ndGgpXG4gICAgY2ZnLnNlbGxQbGFjZW1lbnRzLnNwbGljZSgwLCBjZmcuc2VsbFBsYWNlbWVudHMubGVuZ3RoKVxuICB9XG5cbiAgbG9hZENhY2hlZFBsYWNlbWVudHMgKGNhY2hlS2V5OiBzdHJpbmcpIHtcbiAgICBjb25zdCBjID0gdGhpcy5wbGFjZW1lbnRzQ2FjaGVbY2FjaGVLZXldXG4gICAgaWYgKCFjKSByZXR1cm5cbiAgICBjb25zdCB7IHVwZGF0ZWRDb25maWc6IGNmZyB9ID0gdGhpc1xuICAgIGNmZy5idXlQbGFjZW1lbnRzLnNwbGljZSgwLCBjZmcuYnV5UGxhY2VtZW50cy5sZW5ndGgpXG4gICAgY2ZnLnNlbGxQbGFjZW1lbnRzLnNwbGljZSgwLCBjZmcuc2VsbFBsYWNlbWVudHMubGVuZ3RoKVxuICAgIGNmZy5idXlQbGFjZW1lbnRzLnB1c2goLi4uY1swXSlcbiAgICBjZmcuc2VsbFBsYWNlbWVudHMucHVzaCguLi5jWzFdKVxuICAgIGNvbnN0IGdhcFN0cmF0ZWd5ID0gY2FjaGVLZXkgPT09IGFyYk1NUm93Q2FjaGVLZXkgPyBHYXBTdHJhdGVneU11bHRpcGxpZXIgOiBjYWNoZUtleVxuICAgIGZvciAoY29uc3QgcCBvZiBjZmcuYnV5UGxhY2VtZW50cykgdGhpcy5hZGRQbGFjZW1lbnQodHJ1ZSwgcCwgZ2FwU3RyYXRlZ3kpXG4gICAgZm9yIChjb25zdCBwIG9mIGNmZy5zZWxsUGxhY2VtZW50cykgdGhpcy5hZGRQbGFjZW1lbnQoZmFsc2UsIHAsIGdhcFN0cmF0ZWd5KVxuICB9XG5cbiAgLypcbiAgICogc2V0T3JpZ2luYWxWYWx1ZXMgc2V0cyB0aGUgdXBkYXRlZENvbmZpZyBmaWVsZCB0byBiZSBlcXVhbCB0byB0aGVcbiAgICogYW5kIHNldHMgdGhlIHZhbHVlcyBkaXNwbGF5ZWQgYnV5IGVhY2ggZmllbGQgaW5wdXQgdG8gYmUgZXF1YWxcbiAgICogdG8gdGhlIHZhbHVlcyBzaW5jZSB0aGUgbGFzdCBzYXZlLlxuICAgKi9cbiAgc2V0T3JpZ2luYWxWYWx1ZXMgKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHBhZ2UsIG9yaWdpbmFsQ29uZmlnOiBvbGRDZmcsIHVwZGF0ZWRDb25maWc6IGNmZywgc3BlY3M6IHsgY2V4TmFtZSwgYm90VHlwZSB9XG4gICAgfSA9IHRoaXNcblxuICAgIHRoaXMuY2xlYXJQbGFjZW1lbnRzKGNleE5hbWUgPyBhcmJNTVJvd0NhY2hlS2V5IDogY2ZnLmdhcFN0cmF0ZWd5KVxuXG4gICAgY29uc3QgYXNzaWduID0gKHRvOiBhbnksIGZyb206IGFueSkgPT4geyAvLyBub3QgcmVjdXJzaXZlXG4gICAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhmcm9tKSkge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2KSkge1xuICAgICAgICAgIHRvW2tdLnNwbGljZSgwLCB0b1trXS5sZW5ndGgpXG4gICAgICAgICAgZm9yIChjb25zdCBpIG9mIHYpIHRvW2tdLnB1c2goaSlcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdiA9PT0gJ29iamVjdCcpIE9iamVjdC5hc3NpZ24odG9ba10sIHYpXG4gICAgICAgIGVsc2UgdG9ba10gPSBmcm9tW2tdXG4gICAgICB9XG4gICAgfVxuICAgIGFzc2lnbihjZmcsIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2xkQ2ZnKSkpXG5cbiAgICBjb25zdCB0b2wgPSBjZmcuZHJpZnRUb2xlcmFuY2UgPz8gZGVmYXVsdERyaWZ0VG9sZXJhbmNlLnZhbHVlXG4gICAgdGhpcy5kcmlmdFRvbGVyYW5jZS5zZXRWYWx1ZSh0b2wgKiAxMDApXG4gICAgdGhpcy5kcmlmdFRvbGVyYW5jZVNsaWRlci5zZXRWYWx1ZSh0b2wgLyBkZWZhdWx0RHJpZnRUb2xlcmFuY2UubWF4VilcblxuICAgIGNvbnN0IHBlcnNpc3QgPSBjZmcub3JkZXJQZXJzaXN0ZW5jZSA/PyBkZWZhdWx0T3JkZXJQZXJzaXN0ZW5jZS52YWx1ZVxuICAgIHRoaXMub3JkZXJQZXJzaXN0ZW5jZS5zZXRWYWx1ZShwZXJzaXN0KVxuICAgIHRoaXMub3JkZXJQZXJzaXN0ZW5jZVNsaWRlci5zZXRWYWx1ZShwZXJzaXN0IC8gZGVmYXVsdE9yZGVyUGVyc2lzdGVuY2UubWF4VilcblxuICAgIGNvbnN0IHByb2ZpdCA9IGNmZy5wcm9maXQgPz8gZGVmYXVsdFByb2ZpdC52YWx1ZVxuICAgIHBhZ2UucHJvZml0SW5wdXQudmFsdWUgPSBTdHJpbmcocHJvZml0ICogMTAwKVxuICAgIHRoaXMucWNQcm9maXQuc2V0VmFsdWUocHJvZml0ICogMTAwKVxuICAgIHRoaXMucWNQcm9maXRTbGlkZXIuc2V0VmFsdWUoKHByb2ZpdCAtIGRlZmF1bHRQcm9maXQubWluVikgLyBkZWZhdWx0UHJvZml0LnJhbmdlKVxuXG4gICAgaWYgKGNleE5hbWUpIHtcbiAgICAgIHBhZ2UuY2V4UmViYWxhbmNlQ2hlY2tib3guY2hlY2tlZCA9IGNmZy5jZXhSZWJhbGFuY2VcbiAgICAgIHRoaXMuYXV0b1JlYmFsYW5jZUNoYW5nZWQoKVxuICAgIH1cblxuICAgIC8vIEdhcCBzdHJhdGVneVxuICAgIGlmICghcGFnZS5nYXBTdHJhdGVneVNlbGVjdC5vcHRpb25zKSByZXR1cm5cbiAgICBBcnJheS5mcm9tKHBhZ2UuZ2FwU3RyYXRlZ3lTZWxlY3Qub3B0aW9ucykuZm9yRWFjaCgob3B0OiBIVE1MT3B0aW9uRWxlbWVudCkgPT4geyBvcHQuc2VsZWN0ZWQgPSBvcHQudmFsdWUgPT09IGNmZy5nYXBTdHJhdGVneSB9KVxuICAgIHRoaXMuc2V0R2FwRmFjdG9yTGFiZWxzKGNmZy5nYXBTdHJhdGVneSlcblxuICAgIGlmIChib3RUeXBlID09PSBib3RUeXBlQmFzaWNNTSkge1xuICAgICAgRG9jLnNob3cocGFnZS5nYXBTdHJhdGVneUJveClcbiAgICAgIERvYy5oaWRlKHBhZ2UucHJvZml0U2VsZWN0b3JCb3gsIHBhZ2Uub3JkZXJQZXJzaXN0ZW5jZUJveClcbiAgICAgIHRoaXMuc2V0R2FwRmFjdG9yTGFiZWxzKHBhZ2UuZ2FwU3RyYXRlZ3lTZWxlY3QudmFsdWUgfHwgJycpXG4gICAgfSBlbHNlIGlmIChjZXhOYW1lICYmIGFwcCgpLm1tU3RhdHVzLmNleGVzW2NleE5hbWVdKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLmdhcFN0cmF0ZWd5Qm94KVxuICAgICAgRG9jLnNob3cocGFnZS5wcm9maXRTZWxlY3RvckJveCwgcGFnZS5vcmRlclBlcnNpc3RlbmNlQm94KVxuICAgICAgdGhpcy5zZXRBcmJNTUxhYmVscygpXG4gICAgfVxuXG4gICAgLy8gQnV5L1NlbGwgcGxhY2VtZW50c1xuICAgIG9sZENmZy5idXlQbGFjZW1lbnRzLmZvckVhY2goKHApID0+IHsgdGhpcy5hZGRQbGFjZW1lbnQodHJ1ZSwgcCkgfSlcbiAgICBvbGRDZmcuc2VsbFBsYWNlbWVudHMuZm9yRWFjaCgocCkgPT4geyB0aGlzLmFkZFBsYWNlbWVudChmYWxzZSwgcCkgfSlcblxuICAgIHRoaXMuYmFzZVBhbmUuc2V0dXBXYWxsZXRTZXR0aW5ncygpXG4gICAgdGhpcy5xdW90ZVBhbmUuc2V0dXBXYWxsZXRTZXR0aW5ncygpXG5cbiAgICB0aGlzLnVwZGF0ZU1vZGlmaWVkTWFya2VycygpXG4gICAgaWYgKERvYy5pc0Rpc3BsYXllZChwYWdlLnF1aWNrQ29uZmlnKSkgdGhpcy5zd2l0Y2hUb1F1aWNrQ29uZmlnKClcbiAgfVxuXG4gIC8qXG4gICAqIHZhbGlkYXRlRmllbGRzIHZhbGlkYXRlcyBjb25maWd1cmF0aW9uIHZhbHVlcyBhbmQgb3B0aW9uYWxseSBzaG93cyBlcnJvclxuICAgKiBtZXNzYWdlcy5cbiAgICovXG4gIHZhbGlkYXRlRmllbGRzIChzaG93RXJyb3JzOiBib29sZWFuKTogYm9vbGVhbiB7XG4gICAgbGV0IG9rID0gdHJ1ZVxuICAgIGNvbnN0IHtcbiAgICAgIHBhZ2UsIHNwZWNzOiB7IGJvdFR5cGUgfSxcbiAgICAgIHVwZGF0ZWRDb25maWc6IHsgc2VsbFBsYWNlbWVudHMsIGJ1eVBsYWNlbWVudHMsIHByb2ZpdCB9XG4gICAgfSA9IHRoaXNcbiAgICBjb25zdCBzZXRFcnJvciA9IChlcnJFbDogUGFnZUVsZW1lbnQsIGVycklEOiBzdHJpbmcpID0+IHtcbiAgICAgIG9rID0gZmFsc2VcbiAgICAgIGlmICghc2hvd0Vycm9ycykgcmV0dXJuXG4gICAgICBlcnJFbC50ZXh0Q29udGVudCA9IGludGwucHJlcChlcnJJRClcbiAgICAgIERvYy5zaG93KGVyckVsKVxuICAgIH1cbiAgICBpZiAoc2hvd0Vycm9ycykge1xuICAgICAgRG9jLmhpZGUoXG4gICAgICAgIHBhZ2UuYnV5UGxhY2VtZW50c0VyciwgcGFnZS5zZWxsUGxhY2VtZW50c0VyciwgcGFnZS5wcm9maXRJbnB1dEVyclxuICAgICAgKVxuICAgIH1cbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiICYmIGJ1eVBsYWNlbWVudHMubGVuZ3RoICsgc2VsbFBsYWNlbWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBzZXRFcnJvcihwYWdlLmJ1eVBsYWNlbWVudHNFcnIsIGludGwuSURfTk9fUExBQ0VNRU5UUylcbiAgICAgIHNldEVycm9yKHBhZ2Uuc2VsbFBsYWNlbWVudHNFcnIsIGludGwuSURfTk9fUExBQ0VNRU5UUylcbiAgICB9XG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NKSB7XG4gICAgICBpZiAoaXNOYU4ocHJvZml0KSkgc2V0RXJyb3IocGFnZS5wcm9maXRJbnB1dEVyciwgaW50bC5JRF9JTlZBTElEX1ZBTFVFKVxuICAgICAgZWxzZSBpZiAocHJvZml0ID09PSAwKSBzZXRFcnJvcihwYWdlLnByb2ZpdElucHV0RXJyLCBpbnRsLklEX05PX1pFUk8pXG4gICAgfVxuICAgIHJldHVybiBva1xuICB9XG5cbiAgLypcbiAgICogc2F2ZVNldHRpbmdzIHVwZGF0ZXMgdGhlIHNldHRpbmdzIGluIHRoZSBiYWNrZW5kLCBhbmQgc2V0cyB0aGUgb3JpZ2luYWxDb25maWdcbiAgICogdG8gYmUgZXF1YWwgdG8gdGhlIHVwZGF0ZWRDb25maWcuXG4gICAqL1xuICBhc3luYyBzYXZlU2V0dGluZ3MgKCkge1xuICAgIC8vIE1ha2UgYSBjb3B5IGFuZCBkZWxldGUgZWl0aGVyIHRoZSBiYXNpYyBtbSBjb25maWcgb3IgdGhlIGFyYi1tbSBjb25maWcsXG4gICAgLy8gZGVwZW5kaW5nIG9uIHdoZXRoZXIgYSBjZXggaXMgc2VsZWN0ZWQuXG4gICAgaWYgKCF0aGlzLnZhbGlkYXRlRmllbGRzKHRydWUpKSByZXR1cm5cbiAgICBjb25zdCB7IGNmZywgYmFzZUlELCBxdW90ZUlELCBob3N0LCBib3RUeXBlLCBjZXhOYW1lIH0gPSB0aGlzLm1hcmtldFN0dWZmKClcblxuICAgIGNvbnN0IGJvdENmZzogQm90Q29uZmlnID0ge1xuICAgICAgaG9zdDogaG9zdCxcbiAgICAgIGJhc2VJRDogYmFzZUlELFxuICAgICAgcXVvdGVJRDogcXVvdGVJRCxcbiAgICAgIGNleE5hbWU6IGNleE5hbWUgPz8gJycsXG4gICAgICB1aUNvbmZpZzoge1xuICAgICAgICBzaW1wbGVBcmJMb3RzOiBjZmcuc2ltcGxlQXJiTG90cyxcbiAgICAgICAgYmFzZUNvbmZpZzogY2ZnLmJhc2VDb25maWcsXG4gICAgICAgIHF1b3RlQ29uZmlnOiBjZmcucXVvdGVDb25maWcsXG4gICAgICAgIGNleFJlYmFsYW5jZTogY2ZnLmNleFJlYmFsYW5jZVxuICAgICAgfSxcbiAgICAgIGJhc2VXYWxsZXRPcHRpb25zOiBjZmcuYmFzZU9wdGlvbnMsXG4gICAgICBxdW90ZVdhbGxldE9wdGlvbnM6IGNmZy5xdW90ZU9wdGlvbnNcbiAgICB9XG4gICAgc3dpdGNoIChib3RUeXBlKSB7XG4gICAgICBjYXNlIGJvdFR5cGVCYXNpY01NOlxuICAgICAgICBib3RDZmcuYmFzaWNNYXJrZXRNYWtpbmdDb25maWcgPSB0aGlzLmJhc2ljTU1Db25maWcoKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBib3RUeXBlQXJiTU06XG4gICAgICAgIGJvdENmZy5hcmJNYXJrZXRNYWtpbmdDb25maWcgPSB0aGlzLmFyYk1NQ29uZmlnKClcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgYm90VHlwZUJhc2ljQXJiOlxuICAgICAgICBib3RDZmcuc2ltcGxlQXJiQ29uZmlnID0gdGhpcy5iYXNpY0FyYkNvbmZpZygpXG4gICAgfVxuXG4gICAgYXBwKCkubG9nKCdtbScsICdzYXZpbmcgYm90IGNvbmZpZycsIGJvdENmZylcbiAgICBhd2FpdCBNTS51cGRhdGVCb3RDb25maWcoYm90Q2ZnKVxuICAgIGF3YWl0IGFwcCgpLmZldGNoTU1TdGF0dXMoKVxuICAgIHRoaXMub3JpZ2luYWxDb25maWcgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNmZykpXG4gICAgdGhpcy51cGRhdGVNb2RpZmllZE1hcmtlcnMoKVxuICAgIGNvbnN0IGxhc3RCb3RzID0gU3RhdGUuZmV0Y2hMb2NhbChsYXN0Qm90c0xLKSB8fCB7fVxuICAgIGxhc3RCb3RzW2Ake2Jhc2VJRH1fJHtxdW90ZUlEfV8ke2hvc3R9YF0gPSB0aGlzLnNwZWNzXG4gICAgU3RhdGUuc3RvcmVMb2NhbChsYXN0Qm90c0xLLCBsYXN0Qm90cylcbiAgICBpZiAoY2V4TmFtZSkgU3RhdGUuc3RvcmVMb2NhbChsYXN0QXJiRXhjaGFuZ2VMSywgY2V4TmFtZSlcbiAgICBhcHAoKS5sb2FkUGFnZSgnbW0nKVxuICB9XG5cbiAgYXN5bmMgZGVsZXRlICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHNwZWNzOiB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCB9IH0gPSB0aGlzXG4gICAgRG9jLmhpZGUocGFnZS5kZWxldGVFcnIpXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLmJvdFNldHRpbmdzQ29udGFpbmVyKVxuICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBNTS5yZW1vdmVCb3RDb25maWcoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlc3ApKSB7XG4gICAgICBwYWdlLmRlbGV0ZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FQSV9FUlJPUiwgeyBtc2c6IHJlc3AubXNnIH0pXG4gICAgICBEb2Muc2hvdyhwYWdlLmRlbGV0ZUVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBhd2FpdCBhcHAoKS5mZXRjaE1NU3RhdHVzKClcbiAgICBhcHAoKS5sb2FkUGFnZSgnbW0nKVxuICB9XG5cbiAgLypcbiAgICogYXJiTU1Db25maWcgcGFyc2VzIHRoZSBjb25maWd1cmF0aW9uIGZvciB0aGUgYXJiLW1tIGJvdC4gT25seSBvbmUgb2ZcbiAgICogYXJiTU1Db25maWcgb3IgYmFzaWNNTUNvbmZpZyBzaG91bGQgYmUgdXNlZCB3aGVuIHVwZGF0aW5nIHRoZSBib3RcbiAgICogY29uZmlndXJhdGlvbi4gV2hpY2ggaXMgdXNlZCBkZXBlbmRzIG9uIGlmIHRoZSB1c2VyIGhhcyBjb25maWd1cmVkIGFuZFxuICAgKiBzZWxlY3RlZCBhIENFWCBvciBub3QuXG4gICAqL1xuICBhcmJNTUNvbmZpZyAoKTogQXJiTWFya2V0TWFraW5nQ29uZmlnIHtcbiAgICBjb25zdCB7IHVwZGF0ZWRDb25maWc6IGNmZyB9ID0gdGhpc1xuICAgIGNvbnN0IGFyYkNmZzogQXJiTWFya2V0TWFraW5nQ29uZmlnID0ge1xuICAgICAgYnV5UGxhY2VtZW50czogW10sXG4gICAgICBzZWxsUGxhY2VtZW50czogW10sXG4gICAgICBwcm9maXQ6IGNmZy5wcm9maXQsXG4gICAgICBkcmlmdFRvbGVyYW5jZTogY2ZnLmRyaWZ0VG9sZXJhbmNlLFxuICAgICAgb3JkZXJQZXJzaXN0ZW5jZTogY2ZnLm9yZGVyUGVyc2lzdGVuY2VcbiAgICB9XG4gICAgZm9yIChjb25zdCBwIG9mIGNmZy5idXlQbGFjZW1lbnRzKSBhcmJDZmcuYnV5UGxhY2VtZW50cy5wdXNoKHsgbG90czogcC5sb3RzLCBtdWx0aXBsaWVyOiBwLmdhcEZhY3RvciB9KVxuICAgIGZvciAoY29uc3QgcCBvZiBjZmcuc2VsbFBsYWNlbWVudHMpIGFyYkNmZy5zZWxsUGxhY2VtZW50cy5wdXNoKHsgbG90czogcC5sb3RzLCBtdWx0aXBsaWVyOiBwLmdhcEZhY3RvciB9KVxuICAgIHJldHVybiBhcmJDZmdcbiAgfVxuXG4gIGJhc2ljQXJiQ29uZmlnICgpOiBTaW1wbGVBcmJDb25maWcge1xuICAgIGNvbnN0IHsgdXBkYXRlZENvbmZpZzogY2ZnIH0gPSB0aGlzXG4gICAgY29uc3QgYXJiQ2ZnOiBTaW1wbGVBcmJDb25maWcgPSB7XG4gICAgICBwcm9maXRUcmlnZ2VyOiBjZmcucHJvZml0LFxuICAgICAgbWF4QWN0aXZlQXJiczogMTAwLCAvLyBUT0RPXG4gICAgICBudW1FcG9jaHNMZWF2ZU9wZW46IGNmZy5vcmRlclBlcnNpc3RlbmNlXG4gICAgfVxuICAgIHJldHVybiBhcmJDZmdcbiAgfVxuXG4gIC8qXG4gICAqIGJhc2ljTU1Db25maWcgcGFyc2VzIHRoZSBjb25maWd1cmF0aW9uIGZvciB0aGUgYmFzaWMgbWFya2V0bWFrZXIuIE9ubHkgb2ZcbiAgICogb2YgYmFzaWRNTUNvbmZpZyBvciBhcmJNTUNvbmZpZyBzaG91bGQgYmUgdXNlZCB3aGVuIHVwZGF0aW5nIHRoZSBib3RcbiAgICogY29uZmlndXJhdGlvbi5cbiAgICovXG4gIGJhc2ljTU1Db25maWcgKCk6IEJhc2ljTWFya2V0TWFraW5nQ29uZmlnIHtcbiAgICBjb25zdCB7IHVwZGF0ZWRDb25maWc6IGNmZyB9ID0gdGhpc1xuICAgIGNvbnN0IG1tQ2ZnOiBCYXNpY01hcmtldE1ha2luZ0NvbmZpZyA9IHtcbiAgICAgIGdhcFN0cmF0ZWd5OiBjZmcuZ2FwU3RyYXRlZ3ksXG4gICAgICBzZWxsUGxhY2VtZW50czogY2ZnLnNlbGxQbGFjZW1lbnRzLFxuICAgICAgYnV5UGxhY2VtZW50czogY2ZnLmJ1eVBsYWNlbWVudHMsXG4gICAgICBkcmlmdFRvbGVyYW5jZTogY2ZnLmRyaWZ0VG9sZXJhbmNlXG4gICAgfVxuICAgIHJldHVybiBtbUNmZ1xuICB9XG5cbiAgLypcbiAgICogZmV0Y2hPcmFjbGVzIGZldGNoZXMgdGhlIGN1cnJlbnQgb3JhY2xlIHJhdGVzIGFuZCBmaWF0IHJhdGVzLCBhbmQgZGlzcGxheXNcbiAgICogdGhlbSBvbiB0aGUgc2NyZWVuLlxuICAgKi9cbiAgYXN5bmMgZmV0Y2hNYXJrZXRSZXBvcnQgKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgcGFnZSwgc3BlY3M6IHsgaG9zdCwgYmFzZUlELCBxdW90ZUlEIH0gfSA9IHRoaXNcblxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IE1NLnJlcG9ydChob3N0LCBiYXNlSUQsIHF1b3RlSUQpXG4gICAgRG9jLmhpZGUocGFnZS5vcmFjbGVzTG9hZGluZywgcGFnZS5vcmFjbGVzVGFibGUsIHBhZ2Uubm9PcmFjbGVzKVxuXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2Uub3JhY2xlc0Vyck1zZy50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2Uub3JhY2xlc0VycilcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHIgPSB0aGlzLm1hcmtldFJlcG9ydCA9IHJlcy5yZXBvcnQgYXMgTWFya2V0UmVwb3J0XG4gICAgaWYgKCFyLm9yYWNsZXMgfHwgci5vcmFjbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgRG9jLnNob3cocGFnZS5ub09yYWNsZXMpXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5oaWRlKHBhZ2Uubm9PcmFjbGVzKVxuICAgICAgRG9jLmVtcHR5KHBhZ2Uub3JhY2xlcylcbiAgICAgIGZvciAoY29uc3QgbyBvZiByLm9yYWNsZXMgPz8gW10pIHtcbiAgICAgICAgY29uc3QgdHIgPSBwYWdlLm9yYWNsZVRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgIHBhZ2Uub3JhY2xlcy5hcHBlbmRDaGlsZCh0cilcbiAgICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRyKVxuICAgICAgICB0bXBsLmxvZ28uc3JjID0gJ2ltZy8nICsgby5ob3N0ICsgJy5wbmcnXG4gICAgICAgIHRtcGwuaG9zdC50ZXh0Q29udGVudCA9IEV4Y2hhbmdlTmFtZXNbby5ob3N0XVxuICAgICAgICB0bXBsLnZvbHVtZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhvLnVzZFZvbClcbiAgICAgICAgdG1wbC5wcmljZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncygoby5iZXN0QnV5ICsgby5iZXN0U2VsbCkgLyAyKVxuICAgICAgfVxuICAgICAgcGFnZS5hdmdQcmljZS50ZXh0Q29udGVudCA9IHIucHJpY2UgPyBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moci5wcmljZSkgOiAnMCdcbiAgICAgIERvYy5zaG93KHBhZ2Uub3JhY2xlc1RhYmxlKVxuICAgIH1cblxuICAgIGlmIChyLmJhc2VGaWF0UmF0ZSA+IDApIHtcbiAgICAgIHBhZ2UuYmFzZUZpYXRSYXRlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHIuYmFzZUZpYXRSYXRlKVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLmJhc2VGaWF0UmF0ZS50ZXh0Q29udGVudCA9ICdOL0EnXG4gICAgfVxuXG4gICAgaWYgKHIucXVvdGVGaWF0UmF0ZSA+IDApIHtcbiAgICAgIHBhZ2UucXVvdGVGaWF0UmF0ZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhyLnF1b3RlRmlhdFJhdGUpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhZ2UucXVvdGVGaWF0UmF0ZS50ZXh0Q29udGVudCA9ICdOL0EnXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UuZmlhdFJhdGVzKVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlQ0VYU3VibWl0IGhhbmRsZXMgY2xpY2tzIG9uIHRoZSBDRVggY29uZmlndXJhdGlvbiBzdWJtaXNzaW9uIGJ1dHRvbi5cbiAgICovXG4gIGFzeW5jIGNleENvbmZpZ3VyZWQgKGNleE5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IHsgcGFnZSwgZm9ybVNwZWNzOiB7IGhvc3QsIGJhc2VJRCwgcXVvdGVJRCB9IH0gPSB0aGlzXG4gICAgY29uc3QgZGluZm8gPSBDRVhEaXNwbGF5SW5mb3NbY2V4TmFtZV1cbiAgICBmb3IgKGNvbnN0IHsgYmFzZUlELCBxdW90ZUlELCB0bXBsLCBhcmJzIH0gb2YgdGhpcy5tYXJrZXRSb3dzKSB7XG4gICAgICBpZiAoYXJicy5pbmRleE9mKGNleE5hbWUpICE9PSAtMSkgY29udGludWVcbiAgICAgIGNvbnN0IGNleEhhc01hcmtldCA9IHRoaXMuY2V4TWFya2V0U3VwcG9ydEZpbHRlcihiYXNlSUQsIHF1b3RlSUQpXG4gICAgICBpZiAoY2V4SGFzTWFya2V0KGNleE5hbWUpKSB7XG4gICAgICAgIGNvbnN0IGltZyA9IHBhZ2UuYXJiQnR0blRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgIGltZy5zcmMgPSBkaW5mby5sb2dvXG4gICAgICAgIHRtcGwuYXJicy5hcHBlbmRDaGlsZChpbWcpXG4gICAgICAgIGFyYnMucHVzaChjZXhOYW1lKVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnNldENFWEF2YWlsYWJpbGl0eShiYXNlSUQsIHF1b3RlSUQsIGNleE5hbWUpXG4gICAgdGhpcy5zaG93Qm90VHlwZUZvcm0oaG9zdCwgYmFzZUlELCBxdW90ZUlELCBib3RUeXBlQXJiTU0sIGNleE5hbWUpXG4gIH1cblxuICAvKlxuICAgKiBzZXR1cENFWGVzIHNob3VsZCBiZSBjYWxsZWQgZHVyaW5nIGluaXRpYWxpemF0aW9uLlxuICAgKi9cbiAgc2V0dXBDRVhlcyAoKSB7XG4gICAgdGhpcy5mb3JtQ2V4ZXMgPSB7fVxuICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3Qua2V5cyhDRVhEaXNwbGF5SW5mb3MpKSB0aGlzLmFkZENFWChuYW1lKVxuICB9XG5cbiAgLypcbiAgICogc2V0Q0VYQXZhaWxhYmlsaXR5IHNldHMgdGhlIGNvbG9yaW5nIGFuZCBtZXNzYWdpbmcgb2YgdGhlIENFWCBzZWxlY3Rpb25cbiAgICogYnV0dG9ucy5cbiAgICovXG4gIHNldENFWEF2YWlsYWJpbGl0eSAoYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlciwgc2VsZWN0ZWRDRVg/OiBzdHJpbmcpIHtcbiAgICBjb25zdCBjZXhIYXNNYXJrZXQgPSB0aGlzLmNleE1hcmtldFN1cHBvcnRGaWx0ZXIoYmFzZUlELCBxdW90ZUlEKVxuICAgIGZvciAoY29uc3QgeyBuYW1lLCBkaXYsIHRtcGwgfSBvZiBPYmplY3QudmFsdWVzKHRoaXMuZm9ybUNleGVzKSkge1xuICAgICAgY29uc3QgaGFzID0gY2V4SGFzTWFya2V0KG5hbWUpXG4gICAgICBjb25zdCBjZXhTdGF0dXMgPSBhcHAoKS5tbVN0YXR1cy5jZXhlc1tuYW1lXVxuICAgICAgRG9jLmhpZGUodG1wbC51bmF2YWlsYWJsZSwgdG1wbC5uZWVkc2NvbmZpZywgdG1wbC5kaXNjb25uZWN0ZWQpXG4gICAgICBEb2Muc2V0VmlzKEJvb2xlYW4oY2V4U3RhdHVzKSwgdG1wbC5yZWNvbmZpZylcbiAgICAgIHRtcGwubG9nby5jbGFzc0xpc3QucmVtb3ZlKCdncmV5c2NhbCcpXG4gICAgICBkaXYuY2xhc3NMaXN0LnRvZ2dsZSgnY29uZmlndXJlZCcsIEJvb2xlYW4oY2V4U3RhdHVzKSAmJiAhY2V4U3RhdHVzLmNvbm5lY3RFcnIpXG4gICAgICBpZiAoIWNleFN0YXR1cykge1xuICAgICAgICBEb2Muc2hvdyh0bXBsLm5lZWRzY29uZmlnKVxuICAgICAgfSBlbHNlIGlmIChjZXhTdGF0dXMuY29ubmVjdEVycikge1xuICAgICAgICBEb2Muc2hvdyh0bXBsLmRpc2Nvbm5lY3RlZClcbiAgICAgIH0gZWxzZSBpZiAoIWhhcykge1xuICAgICAgICBEb2Muc2hvdyh0bXBsLnVuYXZhaWxhYmxlKVxuICAgICAgICB0bXBsLmxvZ28uY2xhc3NMaXN0LmFkZCgnZ3JleXNjYWwnKVxuICAgICAgfSBlbHNlIGlmIChuYW1lID09PSBzZWxlY3RlZENFWCkgdGhpcy5zZWxlY3RGb3JtQ0VYKG5hbWUpXG4gICAgfVxuICB9XG5cbiAgc2VsZWN0Rm9ybUNFWCAoY2V4TmFtZTogc3RyaW5nKSB7XG4gICAgZm9yIChjb25zdCB7IG5hbWUsIGRpdiB9IG9mIE9iamVjdC52YWx1ZXModGhpcy5mb3JtQ2V4ZXMpKSB7XG4gICAgICBkaXYuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0ZWQnLCBuYW1lID09PSBjZXhOYW1lKVxuICAgIH1cbiAgfVxuXG4gIGFkZENFWCAoY2V4TmFtZTogc3RyaW5nKSB7XG4gICAgY29uc3QgZGluZm8gPSBDRVhEaXNwbGF5SW5mb3NbY2V4TmFtZV1cbiAgICBjb25zdCBkaXYgPSB0aGlzLnBhZ2UuY2V4T3B0VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgIHRtcGwubmFtZS50ZXh0Q29udGVudCA9IGRpbmZvLm5hbWVcbiAgICB0bXBsLmxvZ28uc3JjID0gZGluZm8ubG9nb1xuICAgIHRoaXMucGFnZS5jZXhTZWxlY3Rpb24uYXBwZW5kQ2hpbGQoZGl2KVxuICAgIHRoaXMuZm9ybUNleGVzW2NleE5hbWVdID0geyBuYW1lOiBjZXhOYW1lLCBkaXYsIHRtcGwgfVxuICAgIERvYy5iaW5kKGRpdiwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2V4U3RhdHVzID0gYXBwKCkubW1TdGF0dXMuY2V4ZXNbY2V4TmFtZV1cbiAgICAgIGlmICghY2V4U3RhdHVzIHx8IGNleFN0YXR1cy5jb25uZWN0RXJyKSB7XG4gICAgICAgIHRoaXMuc2hvd0NFWENvbmZpZ0Zvcm0oY2V4TmFtZSlcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBjb25zdCBjZXggPSB0aGlzLmZvcm1DZXhlc1tjZXhOYW1lXVxuICAgICAgaWYgKGNleC5kaXYuY2xhc3NMaXN0LmNvbnRhaW5zKCdzZWxlY3RlZCcpKSB7IC8vIHVuc2VsZWN0XG4gICAgICAgIGZvciAoY29uc3QgY2V4IG9mIE9iamVjdC52YWx1ZXModGhpcy5mb3JtQ2V4ZXMpKSBjZXguZGl2LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICAgICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQgfSA9IHRoaXMuZm9ybVNwZWNzXG4gICAgICAgIHRoaXMuc2V0Q0VYQXZhaWxhYmlsaXR5KGJhc2VJRCwgcXVvdGVJRClcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IGNleCBvZiBPYmplY3QudmFsdWVzKHRoaXMuZm9ybUNleGVzKSkgY2V4LmRpdi5jbGFzc0xpc3QudG9nZ2xlKCdzZWxlY3RlZCcsIGNleC5uYW1lID09PSBjZXhOYW1lKVxuICAgIH0pXG4gICAgRG9jLmJpbmQodG1wbC5yZWNvbmZpZywgJ2NsaWNrJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIHRoaXMuc2hvd0NFWENvbmZpZ0Zvcm0oY2V4TmFtZSlcbiAgICB9KVxuICB9XG5cbiAgc2hvd0NFWENvbmZpZ0Zvcm0gKGNleE5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmNleENvbmZpZ0Zvcm0uc2V0Q0VYKGNleE5hbWUpXG4gICAgdGhpcy5mb3Jtcy5zaG93KHBhZ2UuY2V4Q29uZmlnRm9ybSlcbiAgfVxuXG4gIC8qXG4gICAqIGNleE1hcmtldFN1cHBvcnRGaWx0ZXIgcmV0dXJucyBhIGxvb2t1cCBDRVhlcyB0aGF0IGhhdmUgYSBtYXRjaGluZyBtYXJrZXRcbiAgICogZm9yIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgYmFzZSBhbmQgcXVvdGUgYXNzZXRzLlxuICAgKi9cbiAgY2V4TWFya2V0U3VwcG9ydEZpbHRlciAoYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlcikge1xuICAgIGNvbnN0IGNleGVzOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPiA9IHt9XG4gICAgZm9yIChjb25zdCBbY2V4TmFtZSwgY2V4U3RhdHVzXSBvZiBPYmplY3QuZW50cmllcyhhcHAoKS5tbVN0YXR1cy5jZXhlcykpIHtcbiAgICAgIGZvciAoY29uc3QgeyBiYXNlSUQ6IGIsIHF1b3RlSUQ6IHEgfSBvZiBPYmplY3QudmFsdWVzKGNleFN0YXR1cy5tYXJrZXRzID8/IFtdKSkge1xuICAgICAgICBpZiAoYiA9PT0gYmFzZUlEICYmIHEgPT09IHF1b3RlSUQpIHtcbiAgICAgICAgICBjZXhlc1tjZXhOYW1lXSA9IHRydWVcbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAoY2V4TmFtZTogc3RyaW5nKSA9PiBCb29sZWFuKGNleGVzW2NleE5hbWVdKVxuICB9XG59XG5cbmZ1bmN0aW9uIGlzVmlld09ubHkgKHNwZWNzOiBCb3RTcGVjcywgbW1TdGF0dXM6IE1hcmtldE1ha2luZ1N0YXR1cyk6IGJvb2xlYW4ge1xuICBjb25zdCBib3RTdGF0dXMgPSBtbVN0YXR1cy5ib3RzLmZpbmQoKHsgY29uZmlnOiBjZmcgfSkgPT4gY2ZnLmhvc3QgPT09IHNwZWNzLmhvc3QgJiYgY2ZnLmJhc2VJRCA9PT0gc3BlY3MuYmFzZUlEICYmIGNmZy5xdW90ZUlEID09PSBzcGVjcy5xdW90ZUlEKVxuICByZXR1cm4gQm9vbGVhbihib3RTdGF0dXM/LnJ1bm5pbmcpXG59XG5cbmNvbnN0IEV4Y2hhbmdlTmFtZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICdiaW5hbmNlLmNvbSc6ICdCaW5hbmNlJyxcbiAgJ2NvaW5iYXNlLmNvbSc6ICdDb2luYmFzZScsXG4gICdiaXR0cmV4LmNvbSc6ICdCaXR0cmV4JyxcbiAgJ2hpdGJ0Yy5jb20nOiAnSGl0QlRDJyxcbiAgJ2V4bW8uY29tJzogJ0VYTU8nXG59XG5cbmZ1bmN0aW9uIHRva2VuQXNzZXRBcHByb3ZhbFN0YXR1c2VzIChob3N0OiBzdHJpbmcsIGI6IFN1cHBvcnRlZEFzc2V0LCBxOiBTdXBwb3J0ZWRBc3NldCkge1xuICBsZXQgYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMgPSBBcHByb3ZhbFN0YXR1cy5BcHByb3ZlZFxuICBsZXQgcXVvdGVBc3NldEFwcHJvdmFsU3RhdHVzID0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWRcblxuICBpZiAoYj8udG9rZW4pIHtcbiAgICBjb25zdCBiYXNlQXNzZXQgPSBhcHAoKS5hc3NldHNbYi5pZF1cbiAgICBjb25zdCBiYXNlVmVyc2lvbiA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XS5hc3NldHNbYi5pZF0udmVyc2lvblxuICAgIGlmIChiYXNlQXNzZXQ/LndhbGxldD8uYXBwcm92ZWQgJiYgYmFzZUFzc2V0LndhbGxldC5hcHByb3ZlZFtiYXNlVmVyc2lvbl0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgYmFzZUFzc2V0QXBwcm92YWxTdGF0dXMgPSBiYXNlQXNzZXQud2FsbGV0LmFwcHJvdmVkW2Jhc2VWZXJzaW9uXVxuICAgIH1cbiAgfVxuICBpZiAocT8udG9rZW4pIHtcbiAgICBjb25zdCBxdW90ZUFzc2V0ID0gYXBwKCkuYXNzZXRzW3EuaWRdXG4gICAgY29uc3QgcXVvdGVWZXJzaW9uID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdLmFzc2V0c1txLmlkXS52ZXJzaW9uXG4gICAgaWYgKHF1b3RlQXNzZXQ/LndhbGxldD8uYXBwcm92ZWQgJiYgcXVvdGVBc3NldC53YWxsZXQuYXBwcm92ZWRbcXVvdGVWZXJzaW9uXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXMgPSBxdW90ZUFzc2V0LndhbGxldC5hcHByb3ZlZFtxdW90ZVZlcnNpb25dXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIFtcbiAgICBiYXNlQXNzZXRBcHByb3ZhbFN0YXR1cyxcbiAgICBxdW90ZUFzc2V0QXBwcm92YWxTdGF0dXNcbiAgXVxufVxuXG5jbGFzcyBBc3NldFBhbmUge1xuICBwZzogTWFya2V0TWFrZXJTZXR0aW5nc1BhZ2VcbiAgZGl2OiBQYWdlRWxlbWVudFxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgYXNzZXRJRDogbnVtYmVyXG4gIHVpOiBVbml0SW5mb1xuICB3YWxsZXRDb25maWc6IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgZmVlQXNzZXRJRDogbnVtYmVyXG4gIGZlZVVJOiBVbml0SW5mb1xuICBpc1F1b3RlOiBib29sZWFuXG4gIGlzVG9rZW46IGJvb2xlYW5cbiAgbG90U2l6ZTogbnVtYmVyIC8vIG1pZ2h0IGJlIHF1b3RlIGNvbnZlcnRlZFxuICBsb3RTaXplQ29udjogbnVtYmVyXG4gIGNmZzogQm90QXNzZXRDb25maWdcbiAgaW52OiBQcm9qZWN0ZWRBbGxvY1xuICBuU3dhcEZlZXM6IEluY3JlbWVudGFsSW5wdXRcbiAgblN3YXBGZWVzU2xpZGVyOiBNaW5pU2xpZGVyXG4gIG9yZGVyUmVzZXJ2ZXM6IE51bWJlcklucHV0XG4gIG9yZGVyUmVzZXJ2ZXNTbGlkZXI6IE1pbmlTbGlkZXJcbiAgc2xpcHBhZ2VCdWZmZXI6IE51bWJlcklucHV0XG4gIHNsaXBwYWdlQnVmZmVyU2xpZGVyOiBNaW5pU2xpZGVyXG4gIG1pblRyYW5zZmVyOiBOdW1iZXJJbnB1dFxuICBtaW5UcmFuc2ZlclNsaWRlcjogTWluaVNsaWRlclxuXG4gIGNvbnN0cnVjdG9yIChwZzogTWFya2V0TWFrZXJTZXR0aW5nc1BhZ2UsIGRpdjogUGFnZUVsZW1lbnQpIHtcbiAgICB0aGlzLnBnID0gcGdcbiAgICB0aGlzLmRpdiA9IGRpdlxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG5cbiAgICB0aGlzLm5Td2FwRmVlcyA9IG5ldyBJbmNyZW1lbnRhbElucHV0KHBhZ2UublN3YXBGZWVzLCB7XG4gICAgICBwcmVjOiBkZWZhdWx0U3dhcFJlc2VydmVzLnByZWMsXG4gICAgICBpbmM6IGRlZmF1bHRTd2FwUmVzZXJ2ZXMuaW5jLFxuICAgICAgY2hhbmdlZDogKHY6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IG1pblIsIHJhbmdlIH0gPSBkZWZhdWx0U3dhcFJlc2VydmVzXG4gICAgICAgIHRoaXMuY2ZnLnN3YXBGZWVOID0gdlxuICAgICAgICB0aGlzLm5Td2FwRmVlc1NsaWRlci5zZXRWYWx1ZSgodiAtIG1pblIpIC8gcmFuZ2UpXG4gICAgICAgIHRoaXMucGcudXBkYXRlQWxsb2NhdGlvbnMoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLm5Td2FwRmVlc1NsaWRlciA9IG5ldyBNaW5pU2xpZGVyKHBhZ2UublN3YXBGZWVzU2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IG1pblIsIHJhbmdlLCBwcmVjIH0gPSBkZWZhdWx0U3dhcFJlc2VydmVzXG4gICAgICBjb25zdCBbdl0gPSB0b1ByZWNpc2lvbihtaW5SICsgciAqIHJhbmdlLCBwcmVjKVxuICAgICAgdGhpcy5jZmcuc3dhcEZlZU4gPSB2XG4gICAgICB0aGlzLm5Td2FwRmVlcy5zZXRWYWx1ZSh2KVxuICAgICAgdGhpcy5wZy51cGRhdGVBbGxvY2F0aW9ucygpXG4gICAgfSlcbiAgICB0aGlzLm9yZGVyUmVzZXJ2ZXMgPSBuZXcgTnVtYmVySW5wdXQocGFnZS5vcmRlclJlc2VydmVzRmFjdG9yLCB7XG4gICAgICBwcmVjOiBkZWZhdWx0T3JkZXJSZXNlcnZlcy5wcmVjLFxuICAgICAgbWluOiAwLFxuICAgICAgY2hhbmdlZDogKHY6IG51bWJlcikgPT4ge1xuICAgICAgICBjb25zdCB7IG1pblIsIHJhbmdlIH0gPSBkZWZhdWx0T3JkZXJSZXNlcnZlc1xuICAgICAgICB0aGlzLmNmZy5vcmRlclJlc2VydmVzRmFjdG9yID0gdlxuICAgICAgICB0aGlzLm9yZGVyUmVzZXJ2ZXNTbGlkZXIuc2V0VmFsdWUoKHYgLSBtaW5SKSAvIHJhbmdlKVxuICAgICAgICB0aGlzLnBnLnVwZGF0ZUFsbG9jYXRpb25zKClcbiAgICAgIH1cbiAgICB9KVxuICAgIHRoaXMub3JkZXJSZXNlcnZlc1NsaWRlciA9IG5ldyBNaW5pU2xpZGVyKHBhZ2Uub3JkZXJSZXNlcnZlc1NsaWRlciwgKHI6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3QgeyBtaW5SLCByYW5nZSwgcHJlYyB9ID0gZGVmYXVsdE9yZGVyUmVzZXJ2ZXNcbiAgICAgIGNvbnN0IFt2XSA9IHRvUHJlY2lzaW9uKG1pblIgKyByICogcmFuZ2UsIHByZWMpXG4gICAgICB0aGlzLm9yZGVyUmVzZXJ2ZXMuc2V0VmFsdWUodilcbiAgICAgIHRoaXMuY2ZnLm9yZGVyUmVzZXJ2ZXNGYWN0b3IgPSB2XG4gICAgICB0aGlzLnBnLnVwZGF0ZUFsbG9jYXRpb25zKClcbiAgICB9KVxuICAgIHRoaXMuc2xpcHBhZ2VCdWZmZXIgPSBuZXcgTnVtYmVySW5wdXQocGFnZS5zbGlwcGFnZUJ1ZmZlckZhY3Rvciwge1xuICAgICAgcHJlYzogZGVmYXVsdFNsaXBwYWdlLnByZWMsXG4gICAgICBtaW46IDAsXG4gICAgICBjaGFuZ2VkOiAodjogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgbWluUiwgcmFuZ2UgfSA9IGRlZmF1bHRTbGlwcGFnZVxuICAgICAgICB0aGlzLmNmZy5zbGlwcGFnZUJ1ZmZlckZhY3RvciA9IHZcbiAgICAgICAgdGhpcy5zbGlwcGFnZUJ1ZmZlclNsaWRlci5zZXRWYWx1ZSgodiAtIG1pblIpIC8gcmFuZ2UpXG4gICAgICAgIHRoaXMucGcudXBkYXRlQWxsb2NhdGlvbnMoKVxuICAgICAgfVxuICAgIH0pXG4gICAgdGhpcy5zbGlwcGFnZUJ1ZmZlclNsaWRlciA9IG5ldyBNaW5pU2xpZGVyKHBhZ2Uuc2xpcHBhZ2VCdWZmZXJTbGlkZXIsIChyOiBudW1iZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgbWluUiwgcmFuZ2UsIHByZWMgfSA9IGRlZmF1bHRTbGlwcGFnZVxuICAgICAgY29uc3QgW3ZdID0gdG9QcmVjaXNpb24obWluUiArIHIgKiByYW5nZSwgcHJlYylcbiAgICAgIHRoaXMuc2xpcHBhZ2VCdWZmZXIuc2V0VmFsdWUobWluUiArIHIgKiByYW5nZSlcbiAgICAgIHRoaXMuY2ZnLnNsaXBwYWdlQnVmZmVyRmFjdG9yID0gdlxuICAgICAgdGhpcy5wZy51cGRhdGVBbGxvY2F0aW9ucygpXG4gICAgfSlcbiAgICB0aGlzLm1pblRyYW5zZmVyID0gbmV3IE51bWJlcklucHV0KHBhZ2UubWluVHJhbnNmZXIsIHtcbiAgICAgIHNpZ0ZpZ3M6IHRydWUsXG4gICAgICBtaW46IDAsXG4gICAgICBjaGFuZ2VkOiAodjogbnVtYmVyKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgY2ZnIH0gPSB0aGlzXG4gICAgICAgIGNvbnN0IHRvdGFsSW52ZW50b3J5ID0gdGhpcy5jb21taXQoKVxuICAgICAgICBjb25zdCBbbWluViwgbWF4Vl0gPSBbdGhpcy5taW5UcmFuc2Zlci5taW4sIE1hdGgubWF4KHRoaXMubWluVHJhbnNmZXIubWluICogMiwgdG90YWxJbnZlbnRvcnkpXVxuICAgICAgICBjZmcudHJhbnNmZXJGYWN0b3IgPSAodiAtIG1pblYpIC8gKG1heFYgLSBtaW5WKVxuICAgICAgICB0aGlzLm1pblRyYW5zZmVyU2xpZGVyLnNldFZhbHVlKGNmZy50cmFuc2ZlckZhY3RvcilcbiAgICAgIH1cbiAgICB9KVxuICAgIHRoaXMubWluVHJhbnNmZXJTbGlkZXIgPSBuZXcgTWluaVNsaWRlcihwYWdlLm1pblRyYW5zZmVyU2xpZGVyLCAocjogbnVtYmVyKSA9PiB7XG4gICAgICBjb25zdCB7IGNmZyB9ID0gdGhpc1xuICAgICAgY29uc3QgdG90YWxJbnZlbnRvcnkgPSB0aGlzLmNvbW1pdCgpXG4gICAgICBjb25zdCBbbWluViwgbWF4Vl0gPSBbdGhpcy5taW5UcmFuc2Zlci5taW4sIE1hdGgubWF4KHRoaXMubWluVHJhbnNmZXIubWluLCB0b3RhbEludmVudG9yeSldXG4gICAgICBjZmcudHJhbnNmZXJGYWN0b3IgPSByXG4gICAgICB0aGlzLm1pblRyYW5zZmVyLnNldFZhbHVlKG1pblYgKyByICogKG1heFYgLSBtaW5WKSlcbiAgICB9KVxuXG4gICAgRG9jLmJpbmQocGFnZS5zaG93QmFsYW5jZSwgJ2NsaWNrJywgKCkgPT4geyBwZy5zaG93QWRkcmVzcyh0aGlzLmFzc2V0SUQpIH0pXG4gIH1cblxuICAvLyBsb3Qgc2l6ZSBjYW4gY2hhbmdlIGlmIHRoaXMgaXMgdGhlIHF1b3RlIGFzc2V0LCBrZWVwIGl0IHVwZGF0ZWQuXG4gIHNldExvdFNpemUgKGxvdFNpemU6IG51bWJlcikge1xuICAgIGNvbnN0IHsgdWkgfSA9IHRoaXNcbiAgICB0aGlzLmxvdFNpemUgPSBsb3RTaXplXG4gICAgdGhpcy5sb3RTaXplQ29udiA9IGxvdFNpemUgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICB9XG5cbiAgc2V0QXNzZXQgKGFzc2V0SUQ6IG51bWJlciwgaXNRdW90ZTogYm9vbGVhbikge1xuICAgIHRoaXMuYXNzZXRJRCA9IGFzc2V0SURcbiAgICB0aGlzLmlzUXVvdGUgPSBpc1F1b3RlXG4gICAgY29uc3QgY2ZnID0gdGhpcy5jZmcgPSBpc1F1b3RlID8gdGhpcy5wZy51cGRhdGVkQ29uZmlnLnF1b3RlQ29uZmlnIDogdGhpcy5wZy51cGRhdGVkQ29uZmlnLmJhc2VDb25maWdcbiAgICBjb25zdCB7IHBhZ2UsIGRpdiwgcGc6IHsgc3BlY3M6IHsgYm90VHlwZSwgYmFzZUlELCBjZXhOYW1lIH0sIG1rdElELCB1cGRhdGVkQ29uZmlnOiB7IGJhc2VPcHRpb25zLCBxdW90ZU9wdGlvbnMgfSB9IH0gPSB0aGlzXG4gICAgY29uc3QgeyBzeW1ib2wsIG5hbWUsIHRva2VuLCB1bml0SW5mbzogdWkgfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIHRoaXMudWkgPSB1aVxuICAgIHRoaXMud2FsbGV0Q29uZmlnID0gYXNzZXRJRCA9PT0gYmFzZUlEID8gYmFzZU9wdGlvbnMgOiBxdW90ZU9wdGlvbnNcbiAgICBjb25zdCB7IGNvbnZlbnRpb25hbDogeyB1bml0OiB0aWNrZXIgfSB9ID0gdWlcbiAgICB0aGlzLmZlZUFzc2V0SUQgPSB0b2tlbiA/IHRva2VuLnBhcmVudElEIDogYXNzZXRJRFxuICAgIGNvbnN0IHsgdW5pdEluZm86IGZlZVVJLCBuYW1lOiBmZWVOYW1lLCBzeW1ib2w6IGZlZVN5bWJvbCB9ID0gYXBwKCkuYXNzZXRzW3RoaXMuZmVlQXNzZXRJRF1cbiAgICB0aGlzLmZlZVVJID0gZmVlVUlcbiAgICB0aGlzLmludiA9IHsgYm9vazogMCwgYm9va2luZ0ZlZXM6IDAsIHN3YXBGZWVSZXNlcnZlczogMCwgY2V4OiAwLCBvcmRlclJlc2VydmVzOiAwLCBzbGlwcGFnZUJ1ZmZlcjogMCB9XG4gICAgdGhpcy5pc1Rva2VuID0gQm9vbGVhbih0b2tlbilcbiAgICBEb2Muc2V0VmlzKHRoaXMuaXNUb2tlbiwgcGFnZS5mZWVUb3RhbEJveCwgcGFnZS5mZWVSZXNlcnZlc0JveCwgcGFnZS5mZWVCYWxhbmNlcylcbiAgICBEb2Muc2V0VmlzKGlzUXVvdGUsIHBhZ2Uuc2xpcHBhZ2VCdWZmZXJCb3gpXG4gICAgRG9jLnNldFNyYyhkaXYsICdbZGF0YS1sb2dvXScsIERvYy5sb2dvUGF0aChzeW1ib2wpKVxuICAgIERvYy5zZXRUZXh0KGRpdiwgJ1tkYXRhLW5hbWVdJywgbmFtZSlcbiAgICBEb2Muc2V0VGV4dChkaXYsICdbZGF0YS10aWNrZXJdJywgdGlja2VyKVxuICAgIGNvbnN0IHsgY29udmVudGlvbmFsOiB7IHVuaXQ6IGZlZVRpY2tlciB9IH0gPSBmZWVVSVxuICAgIERvYy5zZXRUZXh0KGRpdiwgJ1tkYXRhLWZlZS10aWNrZXJdJywgZmVlVGlja2VyKVxuICAgIERvYy5zZXRUZXh0KGRpdiwgJ1tkYXRhLWZlZS1uYW1lXScsIGZlZU5hbWUpXG4gICAgRG9jLnNldFNyYyhkaXYsICdbZGF0YS1mZWUtbG9nb10nLCBEb2MubG9nb1BhdGgoZmVlU3ltYm9sKSlcbiAgICBEb2Muc2V0VmlzKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NLCBwYWdlLmNleE1pbkludkJveClcbiAgICBEb2Muc2V0VmlzKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY0FyYiwgcGFnZS5vcmRlclJlc2VydmVzQm94KVxuICAgIHRoaXMublN3YXBGZWVzLnNldFZhbHVlKGNmZy5zd2FwRmVlTiA/PyBkZWZhdWx0U3dhcFJlc2VydmVzLm4pXG4gICAgdGhpcy5uU3dhcEZlZXNTbGlkZXIuc2V0VmFsdWUoY2ZnLnN3YXBGZWVOIC8gZGVmYXVsdFN3YXBSZXNlcnZlcy5tYXhSKVxuICAgIGlmIChib3RUeXBlICE9PSBib3RUeXBlQmFzaWNBcmIpIHtcbiAgICAgIGNvbnN0IFt2XSA9IHRvUHJlY2lzaW9uKGNmZy5vcmRlclJlc2VydmVzRmFjdG9yID8/IGRlZmF1bHRPcmRlclJlc2VydmVzLmZhY3RvciwgZGVmYXVsdE9yZGVyUmVzZXJ2ZXMucHJlYylcbiAgICAgIHRoaXMub3JkZXJSZXNlcnZlcy5zZXRWYWx1ZSh2KVxuICAgICAgdGhpcy5vcmRlclJlc2VydmVzU2xpZGVyLnNldFZhbHVlKCh2IC0gZGVmYXVsdE9yZGVyUmVzZXJ2ZXMubWluUikgLyBkZWZhdWx0T3JkZXJSZXNlcnZlcy5yYW5nZSlcbiAgICB9XG4gICAgaWYgKGJvdFR5cGUgIT09IGJvdFR5cGVCYXNpY01NKSB7XG4gICAgICB0aGlzLm1pblRyYW5zZmVyLnByZWMgPSBNYXRoLmxvZzEwKHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgICAgY29uc3QgbWt0ID0gYXBwKCkubW1TdGF0dXMuY2V4ZXNbY2V4TmFtZSBhcyBzdHJpbmddLm1hcmtldHNbbWt0SURdXG4gICAgICB0aGlzLm1pblRyYW5zZmVyLm1pbiA9ICgoaXNRdW90ZSA/IG1rdC5xdW90ZU1pbldpdGhkcmF3IDogbWt0LmJhc2VNaW5XaXRoZHJhdykgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICB9XG4gICAgdGhpcy5zbGlwcGFnZUJ1ZmZlci5zZXRWYWx1ZShjZmcuc2xpcHBhZ2VCdWZmZXJGYWN0b3IpXG4gICAgY29uc3QgeyBtaW5SLCByYW5nZSB9ID0gZGVmYXVsdFNsaXBwYWdlXG4gICAgdGhpcy5zbGlwcGFnZUJ1ZmZlclNsaWRlci5zZXRWYWx1ZSgoY2ZnLnNsaXBwYWdlQnVmZmVyRmFjdG9yIC0gbWluUikgLyByYW5nZSlcbiAgICB0aGlzLnNldHVwV2FsbGV0U2V0dGluZ3MoKVxuICAgIHRoaXMudXBkYXRlQmFsYW5jZXMoKVxuICB9XG5cbiAgY29tbWl0ICgpIHtcbiAgICBjb25zdCB7IGludiwgaXNUb2tlbiB9ID0gdGhpc1xuICAgIGxldCBjb21taXQgPSBpbnYuYm9vayArIGludi5jZXggKyBpbnYub3JkZXJSZXNlcnZlcyArIGludi5zbGlwcGFnZUJ1ZmZlclxuICAgIGlmICghaXNUb2tlbikgY29tbWl0ICs9IGludi5ib29raW5nRmVlcyArIGludi5zd2FwRmVlUmVzZXJ2ZXNcbiAgICByZXR1cm4gY29tbWl0XG4gIH1cblxuICB1cGRhdGVJbnZlbnRvcnkgKGxvdHM6IG51bWJlciwgY291bnRlckxvdHM6IG51bWJlciwgbG90U2l6ZTogbnVtYmVyLCBkZXhDb21taXQ6IG51bWJlciwgY2V4Q29tbWl0OiBudW1iZXIsIGZlZXM6IEFzc2V0Qm9va2luZ0ZlZXMpIHtcbiAgICB0aGlzLnNldExvdFNpemUobG90U2l6ZSlcbiAgICBjb25zdCB7IHBhZ2UsIGNmZywgbG90U2l6ZUNvbnYsIGludiwgdWksIGZlZVVJLCBpc1Rva2VuLCBpc1F1b3RlLCBwZzogeyBzcGVjczogeyBjZXhOYW1lLCBib3RUeXBlIH0gfSB9ID0gdGhpc1xuICAgIHBhZ2UuYm9va0xvdHMudGV4dENvbnRlbnQgPSBTdHJpbmcobG90cylcbiAgICBwYWdlLmJvb2tMb3RTaXplLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGxvdFNpemVDb252KVxuICAgIGludi5ib29rID0gbG90cyAqIGxvdFNpemVDb252XG4gICAgcGFnZS5ib29rQ29tbWl0bWVudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhpbnYuYm9vaylcbiAgICBjb25zdCBmZWVzUGVyTG90Q29udiA9IGZlZXMuYm9va2luZ0ZlZXNQZXJMb3QgLyBmZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIHBhZ2UuYm9va2luZ0ZlZXNQZXJMb3QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZmVlc1BlckxvdENvbnYpXG4gICAgcGFnZS5zd2FwUmVzZXJ2ZXNGYWN0b3IudGV4dENvbnRlbnQgPSBmZWVzLnN3YXBSZXNlcnZlc0ZhY3Rvci50b0ZpeGVkKDIpXG4gICAgcGFnZS5ib29raW5nRmVlc0xvdHMudGV4dENvbnRlbnQgPSBTdHJpbmcobG90cylcbiAgICBpbnYuYm9va2luZ0ZlZXMgPSBmZWVzLmJvb2tpbmdGZWVzIC8gZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICBwYWdlLmJvb2tpbmdGZWVzLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGludi5ib29raW5nRmVlcylcbiAgICBpZiAoY2V4TmFtZSkge1xuICAgICAgaW52LmNleCA9IGNleENvbW1pdCAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgICBwYWdlLmNleE1pbkludi50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhpbnYuY2V4KVxuICAgIH1cbiAgICBpZiAoYm90VHlwZSAhPT0gYm90VHlwZUJhc2ljQXJiKSB7XG4gICAgICBjb25zdCB0b3RhbEludmVudG9yeSA9IE1hdGgubWF4KGNleENvbW1pdCwgZGV4Q29tbWl0KSAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgICBwYWdlLm9yZGVyUmVzZXJ2ZXNCYXNpcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyh0b3RhbEludmVudG9yeSlcbiAgICAgIGNvbnN0IG9yZGVyUmVzZXJ2ZXMgPSB0b3RhbEludmVudG9yeSAqIGNmZy5vcmRlclJlc2VydmVzRmFjdG9yXG4gICAgICBpbnYub3JkZXJSZXNlcnZlcyA9IG9yZGVyUmVzZXJ2ZXNcbiAgICAgIHBhZ2Uub3JkZXJSZXNlcnZlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhvcmRlclJlc2VydmVzKVxuICAgIH1cbiAgICBpZiAoaXNUb2tlbikge1xuICAgICAgY29uc3QgZmVlc1BlclN3YXBDb252ID0gZmVlcy50b2tlbkZlZXNQZXJTd2FwIC8gZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIHBhZ2UuZmVlUmVzZXJ2ZXNQZXJTd2FwLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGZlZXNQZXJTd2FwQ29udilcbiAgICAgIGludi5zd2FwRmVlUmVzZXJ2ZXMgPSBmZWVzUGVyU3dhcENvbnYgKiBjZmcuc3dhcEZlZU5cbiAgICAgIHBhZ2UuZmVlUmVzZXJ2ZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoaW52LnN3YXBGZWVSZXNlcnZlcylcbiAgICB9XG4gICAgaWYgKGlzUXVvdGUpIHtcbiAgICAgIGNvbnN0IGJhc2lzID0gaW52LmJvb2sgKyBpbnYuY2V4ICsgaW52Lm9yZGVyUmVzZXJ2ZXNcbiAgICAgIHBhZ2Uuc2xpcHBhZ2VCdWZmZXJCYXNpcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYmFzaXMgKiB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciwgdWkpXG4gICAgICBpbnYuc2xpcHBhZ2VCdWZmZXIgPSBiYXNpcyAqIGNmZy5zbGlwcGFnZUJ1ZmZlckZhY3RvclxuICAgICAgcGFnZS5zbGlwcGFnZUJ1ZmZlci50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoaW52LnNsaXBwYWdlQnVmZmVyICogdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IsIHVpKVxuICAgIH1cbiAgICBEb2Muc2V0VmlzKGZlZXMuYm9va2luZ0ZlZXNQZXJDb3VudGVyTG90ID4gMCwgcGFnZS5yZWRlbXB0aW9uRmVlc0JveClcbiAgICBpZiAoZmVlcy5ib29raW5nRmVlc1BlckNvdW50ZXJMb3QgPiAwKSB7XG4gICAgICBjb25zdCBmZWVzUGVyTG90Q29udiA9IGZlZXMuYm9va2luZ0ZlZXNQZXJDb3VudGVyTG90IC8gZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIHBhZ2UucmVkZW1wdGlvbkZlZXNQZXJMb3QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZmVlc1BlckxvdENvbnYpXG4gICAgICBwYWdlLnJlZGVtcHRpb25GZWVzTG90cy50ZXh0Q29udGVudCA9IFN0cmluZyhjb3VudGVyTG90cylcbiAgICAgIHBhZ2UucmVkZWVtUmVzZXJ2ZXNGYWN0b3IudGV4dENvbnRlbnQgPSBmZWVzLnJlZGVlbVJlc2VydmVzRmFjdG9yLnRvRml4ZWQoMilcbiAgICB9XG4gICAgdGhpcy51cGRhdGVDb21taXRUb3RhbCgpXG4gICAgdGhpcy51cGRhdGVUb2tlbkZlZXMoKVxuICAgIHRoaXMudXBkYXRlUmViYWxhbmNlKClcbiAgfVxuXG4gIHVwZGF0ZUNvbW1pdFRvdGFsICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGFzc2V0SUQsIHVpIH0gPSB0aGlzXG4gICAgY29uc3QgY29tbWl0ID0gdGhpcy5jb21taXQoKVxuICAgIHBhZ2UuY29tbWl0VG90YWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKE1hdGgucm91bmQoY29tbWl0ICogdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpLCB1aSlcbiAgICBwYWdlLmNvbW1pdFRvdGFsRmlhdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhjb21taXQgKiBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF0pXG4gIH1cblxuICB1cGRhdGVUb2tlbkZlZXMgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgaW52LCBmZWVBc3NldElELCBmZWVVSSwgaXNUb2tlbiB9ID0gdGhpc1xuICAgIGlmICghaXNUb2tlbikgcmV0dXJuXG4gICAgY29uc3QgZmVlUmVzZXJ2ZXMgPSBpbnYuYm9va2luZ0ZlZXMgKyBpbnYuc3dhcEZlZVJlc2VydmVzXG4gICAgcGFnZS5mZWVUb3RhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoZmVlUmVzZXJ2ZXMgKiBmZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvciwgZmVlVUkpXG4gICAgcGFnZS5mZWVUb3RhbEZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZmVlUmVzZXJ2ZXMgKiBhcHAoKS5maWF0UmF0ZXNNYXBbZmVlQXNzZXRJRF0pXG4gIH1cblxuICB1cGRhdGVSZWJhbGFuY2UgKCkge1xuICAgIGNvbnN0IHsgcGFnZSwgY2ZnLCBwZzogeyB1cGRhdGVkQ29uZmlnOiB7IGNleFJlYmFsYW5jZSB9LCBzcGVjczogeyBjZXhOYW1lIH0gfSB9ID0gdGhpc1xuICAgIGNvbnN0IHNob3dSZWJhbGFuY2UgPSBjZXhOYW1lICYmIGNleFJlYmFsYW5jZVxuICAgIERvYy5zZXRWaXMoc2hvd1JlYmFsYW5jZSwgcGFnZS5yZWJhbGFuY2VPcHRzKVxuICAgIGlmICghc2hvd1JlYmFsYW5jZSkgcmV0dXJuXG4gICAgY29uc3QgdG90YWxJbnZlbnRvcnkgPSB0aGlzLmNvbW1pdCgpXG4gICAgY29uc3QgW21pblYsIG1heFZdID0gW3RoaXMubWluVHJhbnNmZXIubWluLCBNYXRoLm1heCh0aGlzLm1pblRyYW5zZmVyLm1pbiAqIDIsIHRvdGFsSW52ZW50b3J5KV1cbiAgICBjb25zdCByYW5nZVYgPSBtYXhWIC0gbWluVlxuICAgIHRoaXMubWluVHJhbnNmZXIuc2V0VmFsdWUobWluViArIGNmZy50cmFuc2ZlckZhY3RvciAqIHJhbmdlVilcbiAgICB0aGlzLm1pblRyYW5zZmVyU2xpZGVyLnNldFZhbHVlKChjZmcudHJhbnNmZXJGYWN0b3IgLSBkZWZhdWx0VHJhbnNmZXIubWluUikgLyBkZWZhdWx0VHJhbnNmZXIucmFuZ2UpXG4gIH1cblxuICBzZXR1cFdhbGxldFNldHRpbmdzICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIGFzc2V0SUQsIHdhbGxldENvbmZpZyB9ID0gdGhpc1xuICAgIGNvbnN0IHdhbGxldFNldHRpbmdzID0gYXBwKCkuY3VycmVudFdhbGxldERlZmluaXRpb24oYXNzZXRJRClcbiAgICBEb2MuZW1wdHkocGFnZS53YWxsZXRTZXR0aW5ncylcbiAgICBEb2Muc2V0VmlzKCF3YWxsZXRTZXR0aW5ncy5tdWx0aWZ1bmRpbmdvcHRzLCBwYWdlLndhbGxldFNldHRpbmdzTm9uZSlcbiAgICBpZiAoIXdhbGxldFNldHRpbmdzLm11bHRpZnVuZGluZ29wdHMpIHJldHVyblxuICAgIGNvbnN0IG9wdFRvRGl2OiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD4gPSB7fVxuICAgIGNvbnN0IGRlcGVuZGVudE9wdHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHt9XG4gICAgY29uc3QgYWRkRGVwZW5kZW50T3B0ID0gKG9wdEtleTogc3RyaW5nLCBvcHRTZXR0aW5nOiBQYWdlRWxlbWVudCwgZGVwZW5kZW50T246IHN0cmluZykgPT4ge1xuICAgICAgaWYgKCFkZXBlbmRlbnRPcHRzW2RlcGVuZGVudE9uXSkgZGVwZW5kZW50T3B0c1tkZXBlbmRlbnRPbl0gPSBbXVxuICAgICAgZGVwZW5kZW50T3B0c1tkZXBlbmRlbnRPbl0ucHVzaChvcHRLZXkpXG4gICAgICBvcHRUb0RpdltvcHRLZXldID0gb3B0U2V0dGluZ1xuICAgIH1cbiAgICBjb25zdCBzZXREZXBlbmRlbnRPcHRzVmlzID0gKHBhcmVudE9wdEtleTogc3RyaW5nLCB2aXM6IGJvb2xlYW4pID0+IHtcbiAgICAgIGNvbnN0IG9wdEtleXMgPSBkZXBlbmRlbnRPcHRzW3BhcmVudE9wdEtleV1cbiAgICAgIGlmICghb3B0S2V5cykgcmV0dXJuXG4gICAgICBmb3IgKGNvbnN0IG9wdEtleSBvZiBvcHRLZXlzKSBEb2Muc2V0VmlzKHZpcywgb3B0VG9EaXZbb3B0S2V5XSlcbiAgICB9XG4gICAgY29uc3QgYWRkT3B0ID0gKG9wdDogT3JkZXJPcHRpb24pID0+IHtcbiAgICAgIGlmIChvcHQucXVvdGVBc3NldE9ubHkgJiYgIXRoaXMuaXNRdW90ZSkgcmV0dXJuXG4gICAgICBjb25zdCBjdXJyVmFsID0gd2FsbGV0Q29uZmlnW29wdC5rZXldXG4gICAgICBsZXQgZGl2OiBQYWdlRWxlbWVudCB8IHVuZGVmaW5lZFxuICAgICAgaWYgKG9wdC5pc2Jvb2xlYW4pIHtcbiAgICAgICAgZGl2ID0gcGFnZS5ib29sU2V0dGluZ1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgICAgIHRtcGwubmFtZS50ZXh0Q29udGVudCA9IG9wdC5kaXNwbGF5bmFtZVxuICAgICAgICB0bXBsLmlucHV0LmNoZWNrZWQgPSBjdXJyVmFsID09PSAndHJ1ZSdcbiAgICAgICAgRG9jLmJpbmQodG1wbC5pbnB1dCwgJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICB3YWxsZXRDb25maWdbb3B0LmtleV0gPSB0bXBsLmlucHV0LmNoZWNrZWQgPyAndHJ1ZScgOiAnZmFsc2UnXG4gICAgICAgICAgc2V0RGVwZW5kZW50T3B0c1ZpcyhvcHQua2V5LCBCb29sZWFuKHRtcGwuaW5wdXQuY2hlY2tlZCkpXG4gICAgICAgIH0pXG4gICAgICAgIGlmIChvcHQuZGVzY3JpcHRpb24pIHRtcGwudG9vbHRpcC5kYXRhc2V0LnRvb2x0aXAgPSBvcHQuZGVzY3JpcHRpb25cbiAgICAgIH0gZWxzZSBpZiAob3B0Lnh5UmFuZ2UpIHtcbiAgICAgICAgY29uc3QgeyBzdGFydCwgZW5kLCB4VW5pdCB9ID0gb3B0Lnh5UmFuZ2VcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBlbmQueCAtIHN0YXJ0LnhcbiAgICAgICAgZGl2ID0gcGFnZS5yYW5nZVNldHRpbmdUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgICAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBvcHQuZGlzcGxheW5hbWVcbiAgICAgICAgaWYgKG9wdC5kZXNjcmlwdGlvbikgdG1wbC50b29sdGlwLmRhdGFzZXQudG9vbHRpcCA9IG9wdC5kZXNjcmlwdGlvblxuICAgICAgICBpZiAoeFVuaXQpIHRtcGwudW5pdC50ZXh0Q29udGVudCA9IHhVbml0XG4gICAgICAgIGVsc2UgRG9jLmhpZGUodG1wbC51bml0KVxuXG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IE51bWJlcklucHV0KHRtcGwudmFsdWUsIHtcbiAgICAgICAgICBwcmVjOiAxLFxuICAgICAgICAgIGNoYW5nZWQ6IChyYXdWOiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IFt2LCBzXSA9IHRvRm91clNpZ0ZpZ3MocmF3ViwgMSlcbiAgICAgICAgICAgIHdhbGxldENvbmZpZ1tvcHQua2V5XSA9IHNcbiAgICAgICAgICAgIHNsaWRlci5zZXRWYWx1ZSgodiAtIHN0YXJ0LngpIC8gcmFuZ2UpXG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBzbGlkZXIgPSBuZXcgTWluaVNsaWRlcih0bXBsLnNsaWRlciwgKHI6IG51bWJlcikgPT4ge1xuICAgICAgICAgIGNvbnN0IHJhd1YgPSBzdGFydC54ICsgciAqIHJhbmdlXG4gICAgICAgICAgY29uc3QgW3YsIHNdID0gdG9Gb3VyU2lnRmlncyhyYXdWLCAxKVxuICAgICAgICAgIHdhbGxldENvbmZpZ1tvcHQua2V5XSA9IHNcbiAgICAgICAgICBpbnB1dC5zZXRWYWx1ZSh2KVxuICAgICAgICB9KVxuICAgICAgICAvLyBUT0RPOiBkZWZhdWx0IHZhbHVlIHNob3VsZCBiZSBzbWFsbGVyIG9yIG5vbmUgZm9yIGJhc2UgYXNzZXQuXG4gICAgICAgIGNvbnN0IFt2LCBzXSA9IHRvRm91clNpZ0ZpZ3MocGFyc2VGbG9hdERlZmF1bHQoY3VyclZhbCwgc3RhcnQueCksIDMpXG4gICAgICAgIHdhbGxldENvbmZpZ1tvcHQua2V5XSA9IHNcbiAgICAgICAgc2xpZGVyLnNldFZhbHVlKCh2IC0gc3RhcnQueCkgLyByYW5nZSlcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUodilcbiAgICAgICAgdG1wbC52YWx1ZS50ZXh0Q29udGVudCA9IHNcbiAgICAgIH1cbiAgICAgIGlmICghZGl2KSByZXR1cm4gY29uc29sZS5lcnJvcihcImRvbid0IGtub3cgaG93IHRvIGhhbmRsZSBvcHRcIiwgb3B0KVxuICAgICAgcGFnZS53YWxsZXRTZXR0aW5ncy5hcHBlbmRDaGlsZChkaXYpXG4gICAgICBpZiAob3B0LmRlcGVuZHNPbikge1xuICAgICAgICBhZGREZXBlbmRlbnRPcHQob3B0LmtleSwgZGl2LCBvcHQuZGVwZW5kc09uKVxuICAgICAgICBjb25zdCBwYXJlbnRPcHRWYWwgPSB3YWxsZXRDb25maWdbb3B0LmRlcGVuZHNPbl1cbiAgICAgICAgRG9jLnNldFZpcyhwYXJlbnRPcHRWYWwgPT09ICd0cnVlJywgZGl2KVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh3YWxsZXRTZXR0aW5ncy5tdWx0aWZ1bmRpbmdvcHRzICYmIHdhbGxldFNldHRpbmdzLm11bHRpZnVuZGluZ29wdHMubGVuZ3RoID4gMCkge1xuICAgICAgZm9yIChjb25zdCBvcHQgb2Ygd2FsbGV0U2V0dGluZ3MubXVsdGlmdW5kaW5nb3B0cykgYWRkT3B0KG9wdClcbiAgICB9XG4gICAgYXBwKCkuYmluZFRvb2x0aXBzKHBhZ2Uud2FsbGV0U2V0dGluZ3MpXG4gIH1cblxuICB1cGRhdGVCYWxhbmNlcyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBhc3NldElELCB1aSwgZmVlQXNzZXRJRCwgZmVlVUksIHBnOiB7IHNwZWNzOiB7IGNleE5hbWUsIGJhc2VJRCB9LCBjZXhCYXNlQmFsYW5jZSwgY2V4UXVvdGVCYWxhbmNlIH0gfSA9IHRoaXNcbiAgICBjb25zdCB7IGJhbGFuY2U6IHsgYXZhaWxhYmxlIH0gfSA9IGFwcCgpLndhbGxldE1hcFthc3NldElEXVxuICAgIGNvbnN0IGJvdEludiA9IHRoaXMucGcucnVubmluZ0JvdEludmVudG9yeShhc3NldElEKVxuICAgIGNvbnN0IGRleEF2YWlsID0gYXZhaWxhYmxlIC0gYm90SW52LmRleC50b3RhbFxuICAgIGxldCBjZXhBdmFpbCA9IDBcbiAgICBEb2Muc2V0VmlzKGNleE5hbWUsIHBhZ2UuYmFsYW5jZUJyZWFrZG93bilcbiAgICBpZiAoY2V4TmFtZSkge1xuICAgICAgcGFnZS5kZXhBdmFpbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhkZXhBdmFpbCAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgICAgY29uc3QgeyBhdmFpbGFibGU6IGNleFJhd0F2YWlsIH0gPSBhc3NldElEID09PSBiYXNlSUQgPyBjZXhCYXNlQmFsYW5jZSA6IGNleFF1b3RlQmFsYW5jZVxuICAgICAgY2V4QXZhaWwgPSBjZXhSYXdBdmFpbCAtIGJvdEludi5jZXgudG90YWxcbiAgICAgIHBhZ2UuY2V4QXZhaWwudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoY2V4QXZhaWwgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICB9XG4gICAgcGFnZS5hdmFpbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncygoZGV4QXZhaWwgKyBjZXhBdmFpbCkgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICBpZiAoYXNzZXRJRCA9PT0gZmVlQXNzZXRJRCkgcmV0dXJuXG4gICAgY29uc3QgeyBiYWxhbmNlOiB7IGF2YWlsYWJsZTogZmVlQXZhaWwgfSB9ID0gYXBwKCkud2FsbGV0TWFwW2ZlZUFzc2V0SURdXG4gICAgcGFnZS5mZWVBdmFpbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVBdmFpbCAvIGZlZVVJLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICB9XG59XG4iLCJpbXBvcnQge1xuICBhcHAsXG4gIFBhZ2VFbGVtZW50LFxuICBCb3RDb25maWcsXG4gIE1NQm90U3RhdHVzLFxuICBDRVhDb25maWcsXG4gIE1hcmtldE1ha2luZ1N0YXR1cyxcbiAgRXhjaGFuZ2VCYWxhbmNlLFxuICBSdW5TdGF0cyxcbiAgU3RhcnRDb25maWcsXG4gIE1hcmtldFdpdGhIb3N0LFxuICBSdW5uaW5nQm90SW52ZW50b3J5LFxuICBTcG90LFxuICBPcmRlclBsYWNlbWVudCxcbiAgVG9rZW4sXG4gIFVuaXRJbmZvLFxuICBNYXJrZXRSZXBvcnQsXG4gIEJvdEJhbGFuY2VBbGxvY2F0aW9uLFxuICBQcm9qZWN0ZWRBbGxvYyxcbiAgQmFsYW5jZU5vdGUsXG4gIEJvdEJhbGFuY2UsXG4gIE9yZGVyLFxuICBMb3RGZWVSYW5nZSxcbiAgQm9va2luZ0ZlZXNcbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7IGdldEpTT04sIHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0IERvYywgeyBjbGFtcCB9IGZyb20gJy4vZG9jJ1xuaW1wb3J0ICogYXMgT3JkZXJVdGlsIGZyb20gJy4vb3JkZXJ1dGlsJ1xuaW1wb3J0IHsgQ2hhcnQsIFJlZ2lvbiwgRXh0ZW50cywgVHJhbnNsYXRvciB9IGZyb20gJy4vY2hhcnRzJ1xuXG5leHBvcnQgY29uc3QgR2FwU3RyYXRlZ3lNdWx0aXBsaWVyID0gJ211bHRpcGxpZXInXG5leHBvcnQgY29uc3QgR2FwU3RyYXRlZ3lBYnNvbHV0ZSA9ICdhYnNvbHV0ZSdcbmV4cG9ydCBjb25zdCBHYXBTdHJhdGVneUFic29sdXRlUGx1cyA9ICdhYnNvbHV0ZS1wbHVzJ1xuZXhwb3J0IGNvbnN0IEdhcFN0cmF0ZWd5UGVyY2VudCA9ICdwZXJjZW50J1xuZXhwb3J0IGNvbnN0IEdhcFN0cmF0ZWd5UGVyY2VudFBsdXMgPSAncGVyY2VudC1wbHVzJ1xuXG5leHBvcnQgY29uc3QgYm90VHlwZUJhc2ljTU0gPSAnYmFzaWNNTSdcbmV4cG9ydCBjb25zdCBib3RUeXBlQXJiTU0gPSAnYXJiTU0nXG5leHBvcnQgY29uc3QgYm90VHlwZUJhc2ljQXJiID0gJ2Jhc2ljQXJiJ1xuXG5leHBvcnQgaW50ZXJmYWNlIENFWERpc3BsYXlJbmZvIHtcbiAgbmFtZTogc3RyaW5nXG4gIGxvZ286IHN0cmluZ1xufVxuXG5leHBvcnQgY29uc3QgQ0VYRGlzcGxheUluZm9zOiBSZWNvcmQ8c3RyaW5nLCBDRVhEaXNwbGF5SW5mbz4gPSB7XG4gICdCaW5hbmNlJzoge1xuICAgIG5hbWU6ICdCaW5hbmNlJyxcbiAgICBsb2dvOiAnL2ltZy9iaW5hbmNlLmNvbS5wbmcnXG4gIH0sXG4gICdCaW5hbmNlVVMnOiB7XG4gICAgbmFtZTogJ0JpbmFuY2UgVS5TLicsXG4gICAgbG9nbzogJy9pbWcvYmluYW5jZS51cy5wbmcnXG4gIH1cbn1cblxuLypcbiAqIE1hcmtldE1ha2VyQm90IGlzIHRoZSBmcm9udCBlbmQgcmVwcmVzZW50YXRpb24gb2YgdGhlIHNlcnZlcidzXG4gKiBtbS5NYXJrZXRNYWtlci4gTWFya2V0TWFrZXJCb3QgaXMgYSBzaW5nbGV0b24gYXNzaWduZWQgdG8gTU0gYmVsb3cuXG4gKi9cbmNsYXNzIE1hcmtldE1ha2VyQm90IHtcbiAgY2V4QmFsYW5jZUNhY2hlOiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8bnVtYmVyLCBFeGNoYW5nZUJhbGFuY2U+PiA9IHt9XG5cbiAgLypcbiAgICogdXBkYXRlQm90Q29uZmlnIGFwcGVuZHMgb3IgdXBkYXRlcyB0aGUgc3BlY2lmaWVkIEJvdENvbmZpZy5cbiAgICovXG4gIGFzeW5jIHVwZGF0ZUJvdENvbmZpZyAoY2ZnOiBCb3RDb25maWcpIHtcbiAgICByZXR1cm4gcG9zdEpTT04oJy9hcGkvdXBkYXRlYm90Y29uZmlnJywgY2ZnKVxuICB9XG5cbiAgLypcbiAgICogdXBkYXRlQ0VYQ29uZmlnIGFwcGVuZHMgb3IgdXBkYXRlcyB0aGUgc3BlY2lmaWVkIENFWENvbmZpZy5cbiAgICovXG4gIGFzeW5jIHVwZGF0ZUNFWENvbmZpZyAoY2ZnOiBDRVhDb25maWcpIHtcbiAgICByZXR1cm4gcG9zdEpTT04oJy9hcGkvdXBkYXRlY2V4Y29uZmlnJywgY2ZnKVxuICB9XG5cbiAgYXN5bmMgcmVtb3ZlQm90Q29uZmlnIChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpIHtcbiAgICByZXR1cm4gcG9zdEpTT04oJy9hcGkvcmVtb3ZlYm90Y29uZmlnJywgeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQgfSlcbiAgfVxuXG4gIGFzeW5jIHJlcG9ydCAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHBvc3RKU09OKCcvYXBpL21hcmtldHJlcG9ydCcsIHsgaG9zdCwgYmFzZUlELCBxdW90ZUlEIH0pXG4gIH1cblxuICBhc3luYyBzdGFydEJvdCAoY29uZmlnOiBTdGFydENvbmZpZykge1xuICAgIHJldHVybiBhd2FpdCBwb3N0SlNPTignL2FwaS9zdGFydG1hcmtldG1ha2luZ2JvdCcsIHsgY29uZmlnIH0pXG4gIH1cblxuICBhc3luYyBzdG9wQm90IChtYXJrZXQ6IE1hcmtldFdpdGhIb3N0KSA6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IHBvc3RKU09OKCcvYXBpL3N0b3BtYXJrZXRtYWtpbmdib3QnLCB7IG1hcmtldCB9KVxuICB9XG5cbiAgYXN5bmMgc3RhdHVzICgpIDogUHJvbWlzZTxNYXJrZXRNYWtpbmdTdGF0dXM+IHtcbiAgICByZXR1cm4gKGF3YWl0IGdldEpTT04oJy9hcGkvbWFya2V0bWFraW5nc3RhdHVzJykpLnN0YXR1c1xuICB9XG5cbiAgLy8gYm90U3RhdHMgcmV0dXJucyB0aGUgUnVuU3RhdHMgZm9yIGEgcnVubmluZyBib3Qgd2l0aCB0aGUgc3BlY2lmaWVkIHBhcmFtZXRlcnMuXG4gIGJvdFN0YXRzIChiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCBob3N0OiBzdHJpbmcsIHN0YXJ0VGltZTogbnVtYmVyKTogUnVuU3RhdHMgfCB1bmRlZmluZWQge1xuICAgIGZvciAoY29uc3QgYm90U3RhdHVzIG9mIE9iamVjdC52YWx1ZXMoYXBwKCkubW1TdGF0dXMuYm90cykpIHtcbiAgICAgIGlmICghYm90U3RhdHVzLnJ1blN0YXRzKSBjb250aW51ZVxuICAgICAgY29uc3QgcnVuU3RhdHMgPSBib3RTdGF0dXMucnVuU3RhdHNcbiAgICAgIGNvbnN0IGNmZyA9IGJvdFN0YXR1cy5jb25maWdcbiAgICAgIGlmIChjZmcuYmFzZUlEID09PSBiYXNlSUQgJiYgY2ZnLnF1b3RlSUQgPT09IHF1b3RlSUQgJiYgY2ZnLmhvc3QgPT09IGhvc3QgJiYgcnVuU3RhdHMuc3RhcnRUaW1lID09PSBzdGFydFRpbWUpIHtcbiAgICAgICAgcmV0dXJuIHJ1blN0YXRzXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY2FjaGVkQ2V4QmFsYW5jZSAoY2V4TmFtZTogc3RyaW5nLCBhc3NldElEOiBudW1iZXIpOiBFeGNoYW5nZUJhbGFuY2UgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmNleEJhbGFuY2VDYWNoZVtjZXhOYW1lXT8uW2Fzc2V0SURdXG4gIH1cblxuICBhc3luYyBjZXhCYWxhbmNlIChjZXhOYW1lOiBzdHJpbmcsIGFzc2V0SUQ6IG51bWJlcik6IFByb21pc2U8RXhjaGFuZ2VCYWxhbmNlPiB7XG4gICAgaWYgKCF0aGlzLmNleEJhbGFuY2VDYWNoZVtjZXhOYW1lXSkgdGhpcy5jZXhCYWxhbmNlQ2FjaGVbY2V4TmFtZV0gPSB7fVxuICAgIGNvbnN0IGNleEJhbGFuY2UgPSAoYXdhaXQgcG9zdEpTT04oJy9hcGkvY2V4YmFsYW5jZScsIHsgY2V4TmFtZSwgYXNzZXRJRCB9KSkuY2V4QmFsYW5jZVxuICAgIHRoaXMuY2V4QmFsYW5jZUNhY2hlW2NleE5hbWVdW2Fzc2V0SURdID0gY2V4QmFsYW5jZVxuICAgIHJldHVybiBjZXhCYWxhbmNlXG4gIH1cbn1cblxuLy8gTU0gaXMgdGhlIGZyb250IGVuZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgc2VydmVyJ3MgbW0uTWFya2V0TWFrZXIuXG5leHBvcnQgY29uc3QgTU0gPSBuZXcgTWFya2V0TWFrZXJCb3QoKVxuXG5leHBvcnQgZnVuY3Rpb24gcnVubmluZ0JvdEludmVudG9yeSAoYXNzZXRJRDogbnVtYmVyKTogUnVubmluZ0JvdEludmVudG9yeSB7XG4gIHJldHVybiBhcHAoKS5tbVN0YXR1cy5ib3RzLnJlZHVjZSgodiwgeyBydW5TdGF0cywgcnVubmluZyB9KSA9PiB7XG4gICAgaWYgKCFydW5uaW5nIHx8ICFydW5TdGF0cykgcmV0dXJuIHZcbiAgICBjb25zdCB7IGRleEJhbGFuY2VzOiBkLCBjZXhCYWxhbmNlczogYyB9ID0gcnVuU3RhdHNcbiAgICB2LmNleC5sb2NrZWQgKz0gY1thc3NldElEXT8ubG9ja2VkID8/IDBcbiAgICB2LmNleC5sb2NrZWQgKz0gY1thc3NldElEXT8ucmVzZXJ2ZWQgPz8gMFxuICAgIHYuY2V4LmF2YWlsICs9IGNbYXNzZXRJRF0/LmF2YWlsYWJsZSA/PyAwXG4gICAgdi5jZXgudG90YWwgPSB2LmNleC5hdmFpbCArIHYuY2V4LmxvY2tlZFxuICAgIHYuZGV4LmxvY2tlZCArPSBkW2Fzc2V0SURdPy5sb2NrZWQgPz8gMFxuICAgIHYuZGV4LmxvY2tlZCArPSBkW2Fzc2V0SURdPy5yZXNlcnZlZCA/PyAwXG4gICAgdi5kZXguYXZhaWwgKz0gZFthc3NldElEXT8uYXZhaWxhYmxlID8/IDBcbiAgICB2LmRleC50b3RhbCA9IHYuZGV4LmF2YWlsICsgdi5kZXgubG9ja2VkXG4gICAgdi5hdmFpbCArPSAoZFthc3NldElEXT8uYXZhaWxhYmxlID8/IDApICsgKGNbYXNzZXRJRF0/LmF2YWlsYWJsZSA/PyAwKVxuICAgIHYubG9ja2VkICs9IChkW2Fzc2V0SURdPy5sb2NrZWQgPz8gMCkgKyAoY1thc3NldElEXT8ubG9ja2VkID8/IDApXG4gICAgcmV0dXJuIHZcbiAgfSwgeyBhdmFpbDogMCwgbG9ja2VkOiAwLCBjZXg6IHsgYXZhaWw6IDAsIGxvY2tlZDogMCwgdG90YWw6IDAgfSwgZGV4OiB7IGF2YWlsOiAwLCBsb2NrZWQ6IDAsIHRvdGFsOiAwIH0gfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldE1hcmtldEVsZW1lbnRzIChhbmNlc3RvcjogUGFnZUVsZW1lbnQsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIsIGhvc3Q6IHN0cmluZykge1xuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLWhvc3RdJywgaG9zdClcbiAgY29uc3QgeyB1bml0SW5mbzogYnVpLCBuYW1lOiBiYXNlTmFtZSwgc3ltYm9sOiBiYXNlU3ltYm9sLCB0b2tlbjogYmFzZVRva2VuIH0gPSBhcHAoKS5hc3NldHNbYmFzZUlEXVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLWJhc2UtbmFtZV0nLCBiYXNlTmFtZSlcbiAgRG9jLnNldFNyYyhhbmNlc3RvciwgJ1tkYXRhLWJhc2UtbG9nb10nLCBEb2MubG9nb1BhdGgoYmFzZVN5bWJvbCkpXG4gIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtYmFzZS10aWNrZXJdJywgYnVpLmNvbnZlbnRpb25hbC51bml0KVxuICBjb25zdCB7IHVuaXRJbmZvOiBiYXNlRmVlVUksIG5hbWU6IGJhc2VGZWVOYW1lLCBzeW1ib2w6IGJhc2VGZWVTeW1ib2wgfSA9IGFwcCgpLmFzc2V0c1tiYXNlVG9rZW4gPyBiYXNlVG9rZW4ucGFyZW50SUQgOiBiYXNlSURdXG4gIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtYmFzZS1mZWUtbmFtZV0nLCBiYXNlRmVlTmFtZSlcbiAgRG9jLnNldFNyYyhhbmNlc3RvciwgJ1tkYXRhLWJhc2UtZmVlLWxvZ29dJywgRG9jLmxvZ29QYXRoKGJhc2VGZWVTeW1ib2wpKVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLWJhc2UtZmVlLXRpY2tlcl0nLCBiYXNlRmVlVUkuY29udmVudGlvbmFsLnVuaXQpXG4gIGNvbnN0IHsgdW5pdEluZm86IHF1aSwgbmFtZTogcXVvdGVOYW1lLCBzeW1ib2w6IHF1b3RlU3ltYm9sLCB0b2tlbjogcXVvdGVUb2tlbiB9ID0gYXBwKCkuYXNzZXRzW3F1b3RlSURdXG4gIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtcXVvdGUtbmFtZV0nLCBxdW90ZU5hbWUpXG4gIERvYy5zZXRTcmMoYW5jZXN0b3IsICdbZGF0YS1xdW90ZS1sb2dvXScsIERvYy5sb2dvUGF0aChxdW90ZVN5bWJvbCkpXG4gIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtcXVvdGUtdGlja2VyXScsIHF1aS5jb252ZW50aW9uYWwudW5pdClcbiAgY29uc3QgeyB1bml0SW5mbzogcXVvdGVGZWVVSSwgbmFtZTogcXVvdGVGZWVOYW1lLCBzeW1ib2w6IHF1b3RlRmVlU3ltYm9sIH0gPSBhcHAoKS5hc3NldHNbcXVvdGVUb2tlbiA/IHF1b3RlVG9rZW4ucGFyZW50SUQgOiBxdW90ZUlEXVxuICBEb2Muc2V0VGV4dChhbmNlc3RvciwgJ1tkYXRhLXF1b3RlLWZlZS1uYW1lXScsIHF1b3RlRmVlTmFtZSlcbiAgRG9jLnNldFNyYyhhbmNlc3RvciwgJ1tkYXRhLXF1b3RlLWZlZS1sb2dvXScsIERvYy5sb2dvUGF0aChxdW90ZUZlZVN5bWJvbCkpXG4gIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtcXVvdGUtZmVlLXRpY2tlcl0nLCBxdW90ZUZlZVVJLmNvbnZlbnRpb25hbC51bml0KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0Q2V4RWxlbWVudHMgKGFuY2VzdG9yOiBQYWdlRWxlbWVudCwgY2V4TmFtZTogc3RyaW5nKSB7XG4gIGNvbnN0IGRpbmZvID0gQ0VYRGlzcGxheUluZm9zW2NleE5hbWVdXG4gIERvYy5zZXRUZXh0KGFuY2VzdG9yLCAnW2RhdGEtY2V4LW5hbWVdJywgZGluZm8ubmFtZSlcbiAgRG9jLnNldFNyYyhhbmNlc3RvciwgJ1tkYXRhLWNleC1sb2dvXScsIGRpbmZvLmxvZ28pXG4gIGZvciAoY29uc3QgaW1nIG9mIERvYy5hcHBseVNlbGVjdG9yKGFuY2VzdG9yLCAnW2RhdGEtY2V4LWxvZ29dJykpIERvYy5zaG93KGltZylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZVF1b3RlTG90IChsb3RTaXplOiBudW1iZXIsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIsIHNwb3Q/OiBTcG90KSB7XG4gIGNvbnN0IGJhc2VSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Jhc2VJRF1cbiAgY29uc3QgcXVvdGVSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW3F1b3RlSURdXG4gIGNvbnN0IHsgdW5pdEluZm86IHsgY29udmVudGlvbmFsOiB7IGNvbnZlcnNpb25GYWN0b3I6IGJGYWN0b3IgfSB9IH0gPSBhcHAoKS5hc3NldHNbYmFzZUlEXVxuICBjb25zdCB7IHVuaXRJbmZvOiB7IGNvbnZlbnRpb25hbDogeyBjb252ZXJzaW9uRmFjdG9yOiBxRmFjdG9yIH0gfSB9ID0gYXBwKCkuYXNzZXRzW3F1b3RlSURdXG4gIGlmIChiYXNlUmF0ZSAmJiBxdW90ZVJhdGUpIHtcbiAgICByZXR1cm4gbG90U2l6ZSAqIGJhc2VSYXRlIC8gcXVvdGVSYXRlICogcUZhY3RvciAvIGJGYWN0b3JcbiAgfSBlbHNlIGlmIChzcG90KSB7XG4gICAgcmV0dXJuIGxvdFNpemUgKiBzcG90LnJhdGUgLyBPcmRlclV0aWwuUmF0ZUVuY29kaW5nRmFjdG9yXG4gIH1cbiAgcmV0dXJuIHFGYWN0b3Jcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQbGFjZW1lbnRDaGFydENvbmZpZyB7XG4gIGNleE5hbWU6IHN0cmluZ1xuICBib3RUeXBlOiBzdHJpbmdcbiAgYmFzZUZpYXRSYXRlOiBudW1iZXJcbiAgZGljdDoge1xuICAgIHByb2ZpdDogbnVtYmVyXG4gICAgYnV5UGxhY2VtZW50czogT3JkZXJQbGFjZW1lbnRbXVxuICAgIHNlbGxQbGFjZW1lbnRzOiBPcmRlclBsYWNlbWVudFtdXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFBsYWNlbWVudHNDaGFydCBleHRlbmRzIENoYXJ0IHtcbiAgY2ZnOiBQbGFjZW1lbnRDaGFydENvbmZpZ1xuICBsb2FkZWRDRVg6IHN0cmluZ1xuICBjZXhMb2dvOiBIVE1MSW1hZ2VFbGVtZW50XG5cbiAgY29uc3RydWN0b3IgKHBhcmVudDogUGFnZUVsZW1lbnQpIHtcbiAgICBzdXBlcihwYXJlbnQsIHtcbiAgICAgIHJlc2l6ZTogKCkgPT4gdGhpcy5yZXNpemVkKCksXG4gICAgICBjbGljazogKC8qIGU6IE1vdXNlRXZlbnQgKi8pID0+IHsgLyogcGFzcyAqLyB9LFxuICAgICAgem9vbTogKC8qIGJpZ2dlcjogYm9vbGVhbiAqLykgPT4geyAvKiBwYXNzICovIH1cbiAgICB9KVxuICB9XG5cbiAgcmVzaXplZCAoKSB7XG4gICAgdGhpcy5yZW5kZXIoKVxuICB9XG5cbiAgZHJhdyAoKSB7IC8qIHBhc3MgKi8gfVxuXG4gIHNldE1hcmtldCAoY2ZnOiBQbGFjZW1lbnRDaGFydENvbmZpZykge1xuICAgIHRoaXMuY2ZnID0gY2ZnXG4gICAgY29uc3QgeyBsb2FkZWRDRVgsIGNmZzogeyBjZXhOYW1lIH0gfSA9IHRoaXNcbiAgICBpZiAoY2V4TmFtZSAmJiBjZXhOYW1lICE9PSBsb2FkZWRDRVgpIHtcbiAgICAgIHRoaXMubG9hZGVkQ0VYID0gY2V4TmFtZVxuICAgICAgdGhpcy5jZXhMb2dvID0gbmV3IEltYWdlKClcbiAgICAgIERvYy5iaW5kKHRoaXMuY2V4TG9nbywgJ2xvYWQnLCAoKSA9PiB7IHRoaXMucmVuZGVyKCkgfSlcbiAgICAgIHRoaXMuY2V4TG9nby5zcmMgPSBDRVhEaXNwbGF5SW5mb3NbY2V4TmFtZSB8fCAnJ10ubG9nb1xuICAgIH1cbiAgICB0aGlzLnJlbmRlcigpXG4gIH1cblxuICByZW5kZXIgKCkge1xuICAgIGNvbnN0IHsgY3R4LCBjYW52YXMsIHRoZW1lLCBjZmcgfSA9IHRoaXNcbiAgICBpZiAoY2FudmFzLndpZHRoID09PSAwIHx8ICFjZmcpIHJldHVyblxuICAgIGNvbnN0IHsgZGljdDogeyBidXlQbGFjZW1lbnRzLCBzZWxsUGxhY2VtZW50cywgcHJvZml0IH0sIGJhc2VGaWF0UmF0ZSwgYm90VHlwZSB9ID0gY2ZnXG4gICAgaWYgKGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY0FyYikgcmV0dXJuXG5cbiAgICB0aGlzLmNsZWFyKClcblxuICAgIGNvbnN0IGRyYXdEYXNoZWRMaW5lID0gKHgwOiBudW1iZXIsIHkwOiBudW1iZXIsIHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIGNvbG9yOiBzdHJpbmcpID0+IHtcbiAgICAgIGN0eC5zYXZlKClcbiAgICAgIGN0eC5zZXRMaW5lRGFzaChbMywgNV0pXG4gICAgICBjdHgubGluZVdpZHRoID0gMS41XG4gICAgICBjdHguc3Ryb2tlU3R5bGUgPSBjb2xvclxuICAgICAgdGhpcy5saW5lKHgwLCB5MCwgeDEsIHkxKVxuICAgICAgY3R4LnJlc3RvcmUoKVxuICAgIH1cblxuICAgIGNvbnN0IGlzQmFzaWNNTSA9IGJvdFR5cGUgPT09IGJvdFR5cGVCYXNpY01NXG4gICAgY29uc3QgY3ggPSBjYW52YXMud2lkdGggLyAyXG4gICAgY29uc3QgW2NleEdhcEwsIGNleEdhcFJdID0gaXNCYXNpY01NID8gW2N4LCBjeF0gOiBbMC40OCAqIGNhbnZhcy53aWR0aCwgMC41MiAqIGNhbnZhcy53aWR0aF1cblxuICAgIGNvbnN0IGJ1eUxvdHMgPSBidXlQbGFjZW1lbnRzLnJlZHVjZSgodjogbnVtYmVyLCBwOiBPcmRlclBsYWNlbWVudCkgPT4gdiArIHAubG90cywgMClcbiAgICBjb25zdCBzZWxsTG90cyA9IHNlbGxQbGFjZW1lbnRzLnJlZHVjZSgodjogbnVtYmVyLCBwOiBPcmRlclBsYWNlbWVudCkgPT4gdiArIHAubG90cywgMClcbiAgICBjb25zdCBtYXhMb3RzID0gTWF0aC5tYXgoYnV5TG90cywgc2VsbExvdHMpXG5cbiAgICBsZXQgd2lkZXN0ID0gMFxuICAgIGxldCBmYXV4U3BhY2VyID0gMFxuICAgIGlmIChpc0Jhc2ljTU0pIHtcbiAgICAgIGNvbnN0IGxlZnRtb3N0ID0gYnV5UGxhY2VtZW50cy5yZWR1Y2UoKHY6IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IE1hdGgubWF4KHYsIHAuZ2FwRmFjdG9yKSwgMClcbiAgICAgIGNvbnN0IHJpZ2h0bW9zdCA9IHNlbGxQbGFjZW1lbnRzLnJlZHVjZSgodjogbnVtYmVyLCBwOiBPcmRlclBsYWNlbWVudCkgPT4gTWF0aC5tYXgodiwgcC5nYXBGYWN0b3IpLCAwKVxuICAgICAgd2lkZXN0ID0gTWF0aC5tYXgobGVmdG1vc3QsIHJpZ2h0bW9zdClcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRm9yIGFyYi1tbSwgd2UgZG9uJ3Qga25vdyBob3cgdGhlIG9yZGVycyB3aWxsIGJlIHNwYWNlZCBiZWNhdXNlIGl0XG4gICAgICAvLyBkZXBlbmRzIG9uIHRoZSB2d2FwLiBCdXQgd2UncmUganVzdCB0cnlpbmcgdG8gY2FwdHVyZSB0aGUgZ2VuZXJhbCBzZW5zZVxuICAgICAgLy8gb2YgaG93IHRoZSBwYXJhbWV0ZXJzIHdpbGwgYWZmZWN0IG9yZGVyIHBsYWNlbWVudCwgc28gd2UnbGwgZmFrZSBpdC5cbiAgICAgIC8vIEhpZ2hlciBtYXRjaCBidWZmZXIgdmFsdWVzIHdpbGwgbGVhZCB0byBvcmRlcnMgd2l0aCBsZXNzIGZhdm9yYWJsZVxuICAgICAgLy8gcmF0ZXMsIGUuZy4gdGhlIHNwYWNpbmcgd2lsbCBiZSBsYXJnZXIuXG4gICAgICBjb25zdCBwcyA9IFsuLi5idXlQbGFjZW1lbnRzLCAuLi5zZWxsUGxhY2VtZW50c11cbiAgICAgIGNvbnN0IG1hdGNoQnVmZmVyID0gcHMucmVkdWNlKChzdW06IG51bWJlciwgcDogT3JkZXJQbGFjZW1lbnQpID0+IHN1bSArIHAuZ2FwRmFjdG9yLCAwKSAvIHBzLmxlbmd0aFxuICAgICAgZmF1eFNwYWNlciA9IDAuMDEgKiAoMSArIG1hdGNoQnVmZmVyKVxuICAgICAgd2lkZXN0ID0gTWF0aC5taW4oMTAsIE1hdGgubWF4KGJ1eVBsYWNlbWVudHMubGVuZ3RoLCBzZWxsUGxhY2VtZW50cy5sZW5ndGgpKSAqIGZhdXhTcGFjZXIgLy8gYXJiLW1tXG4gICAgfVxuXG4gICAgLy8gTWFrZSB0aGUgcmFuZ2UgMTUlIG9uIGVhY2ggc2lkZSwgd2hpY2ggd2lsbCBpbmNsdWRlIHByb2ZpdCArIHBsYWNlbWVudHMsXG4gICAgLy8gdW5sZXNzIHRoZXkgaGF2ZSBvcmRlcnMgd2l0aCBsYXJnZXIgZ2FwIGZhY3RvcnMuXG4gICAgY29uc3QgbWluUmFuZ2UgPSBwcm9maXQgKyB3aWRlc3RcbiAgICBjb25zdCBkZWZhdWx0UmFuZ2UgPSAwLjE1NVxuICAgIGNvbnN0IHJhbmdlID0gTWF0aC5tYXgobWluUmFuZ2UgKiAxLjA1LCBkZWZhdWx0UmFuZ2UpXG5cbiAgICAvLyBJbmNyZWFzZSBkYXRhIGhlaWdodCBsb2dhcml0aG1pY2FsbHkgdXAgdG8gMSwwMDAsMDAwIFVTRC5cbiAgICBjb25zdCBtYXhDb21taXRVU0QgPSBtYXhMb3RzICogYmFzZUZpYXRSYXRlXG4gICAgY29uc3QgcmVnaW9uSGVpZ2h0ID0gMC4yICsgMC43ICogTWF0aC5sb2coY2xhbXAobWF4Q29tbWl0VVNELCAwLCAxZTYpKSAvIE1hdGgubG9nKDFlNilcblxuICAgIC8vIERyYXcgYSByZWdpb24gaW4gdGhlIG1pZGRsZSByZXByZXNlbnRpbmcgdGhlIGNleCBnYXAuXG4gICAgY29uc3QgcGxvdFJlZ2lvbiA9IG5ldyBSZWdpb24oY3R4LCBuZXcgRXh0ZW50cygwLCBjYW52YXMud2lkdGgsIDAsIGNhbnZhcy5oZWlnaHQpKVxuXG4gICAgaWYgKGlzQmFzaWNNTSkge1xuICAgICAgZHJhd0Rhc2hlZExpbmUoY3gsIDAsIGN4LCBjYW52YXMuaGVpZ2h0LCB0aGVtZS5nYXBMaW5lKVxuICAgIH0gZWxzZSB7IC8vIGFyYi1tbVxuICAgICAgcGxvdFJlZ2lvbi5wbG90KG5ldyBFeHRlbnRzKDAsIDEsIDAsIDEpLCAoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsIHRvb2xzOiBUcmFuc2xhdG9yKSA9PiB7XG4gICAgICAgIGNvbnN0IFt5MCwgeTFdID0gW3Rvb2xzLnkoMCksIHRvb2xzLnkoMSldXG4gICAgICAgIGRyYXdEYXNoZWRMaW5lKGNleEdhcEwsIHkwLCBjZXhHYXBMLCB5MSwgdGhlbWUuZ2FwTGluZSlcbiAgICAgICAgZHJhd0Rhc2hlZExpbmUoY2V4R2FwUiwgeTAsIGNleEdhcFIsIHkxLCB0aGVtZS5nYXBMaW5lKVxuICAgICAgICBjb25zdCB5ID0gdG9vbHMueSgwLjk1KVxuICAgICAgICBjdHguZHJhd0ltYWdlKHRoaXMuY2V4TG9nbywgY3ggLSA4LCB5LCAxNiwgMTYpXG4gICAgICAgIHRoaXMuYXBwbHlMYWJlbFN0eWxlKDE4KVxuICAgICAgICBjdHguZmlsbFRleHQoJ860JywgY3gsIHkgKyAyOSlcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgY29uc3QgcGxvdFNpZGUgPSAoaXNCdXk6IGJvb2xlYW4sIHBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W10pID0+IHtcbiAgICAgIGlmICghcGxhY2VtZW50cz8ubGVuZ3RoKSByZXR1cm5cbiAgICAgIGNvbnN0IFt4TWluLCB4TWF4XSA9IGlzQnV5ID8gWzAsIGNleEdhcExdIDogW2NleEdhcFIsIGNhbnZhcy53aWR0aF1cbiAgICAgIGNvbnN0IHJlZyA9IG5ldyBSZWdpb24oY3R4LCBuZXcgRXh0ZW50cyh4TWluLCB4TWF4LCBjYW52YXMuaGVpZ2h0ICogKDEgLSByZWdpb25IZWlnaHQpLCBjYW52YXMuaGVpZ2h0KSlcbiAgICAgIGNvbnN0IFtsLCByXSA9IGlzQnV5ID8gWy1yYW5nZSwgMF0gOiBbMCwgcmFuZ2VdXG4gICAgICByZWcucGxvdChuZXcgRXh0ZW50cyhsLCByLCAwLCBtYXhMb3RzKSwgKGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELCB0b29sczogVHJhbnNsYXRvcikgPT4ge1xuICAgICAgICBjdHgubGluZVdpZHRoID0gMi41XG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IGlzQnV5ID8gdGhlbWUuYnV5TGluZSA6IHRoZW1lLnNlbGxMaW5lXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBpc0J1eSA/IHRoZW1lLmJ1eUZpbGwgOiB0aGVtZS5zZWxsRmlsbFxuICAgICAgICBjdHguYmVnaW5QYXRoKClcbiAgICAgICAgY29uc3Qgc2lkZUZhY3RvciA9IGlzQnV5ID8gLTEgOiAxXG4gICAgICAgIGNvbnN0IGZpcnN0UHQgPSBwbGFjZW1lbnRzWzBdXG4gICAgICAgIGNvbnN0IHkwID0gdG9vbHMueSgwKVxuICAgICAgICBjb25zdCBmaXJzdFggPSB0b29scy54KChpc0Jhc2ljTU0gPyBmaXJzdFB0LmdhcEZhY3RvciA6IHByb2ZpdCArIGZhdXhTcGFjZXIpICogc2lkZUZhY3RvcilcbiAgICAgICAgY3R4Lm1vdmVUbyhmaXJzdFgsIHkwKVxuICAgICAgICBsZXQgY3VtdWxhdGl2ZUxvdHMgPSAwXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGxhY2VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IHAgPSBwbGFjZW1lbnRzW2ldXG4gICAgICAgICAgLy8gRm9yIGFyYi1tbSwgd2UgZG9uJ3Qga25vdyBleGFjdGx5XG4gICAgICAgICAgY29uc3QgcmF3WCA9IGlzQmFzaWNNTSA/IHAuZ2FwRmFjdG9yIDogcHJvZml0ICsgKGkgKyAxKSAqIGZhdXhTcGFjZXJcbiAgICAgICAgICBjb25zdCB4ID0gdG9vbHMueChyYXdYICogc2lkZUZhY3RvcilcbiAgICAgICAgICBjdHgubGluZVRvKHgsIHRvb2xzLnkoY3VtdWxhdGl2ZUxvdHMpKVxuICAgICAgICAgIGN1bXVsYXRpdmVMb3RzICs9IHAubG90c1xuICAgICAgICAgIGN0eC5saW5lVG8oeCwgdG9vbHMueShjdW11bGF0aXZlTG90cykpXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeEluZmluaXR5ID0gaXNCdXkgPyBjYW52YXMud2lkdGggKiAtMC4xIDogY2FudmFzLndpZHRoICogMS4xXG4gICAgICAgIGN0eC5saW5lVG8oeEluZmluaXR5LCB0b29scy55KGN1bXVsYXRpdmVMb3RzKSlcbiAgICAgICAgY3R4LnN0cm9rZSgpXG4gICAgICAgIGN0eC5saW5lVG8oeEluZmluaXR5LCB5MClcbiAgICAgICAgY3R4LmxpbmVUbyhmaXJzdFgsIHkwKVxuICAgICAgICBjdHguY2xvc2VQYXRoKClcbiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC4yNVxuICAgICAgICBjdHguZmlsbCgpXG4gICAgICB9LCB0cnVlKVxuICAgIH1cblxuICAgIHBsb3RTaWRlKGZhbHNlLCBzZWxsUGxhY2VtZW50cylcbiAgICBwbG90U2lkZSh0cnVlLCBidXlQbGFjZW1lbnRzKVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBob3N0ZWRNYXJrZXRJRCAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKSB7XG4gIHJldHVybiBgJHtob3N0fS0ke2Jhc2VJRH0tJHtxdW90ZUlEfWAgLy8gc2FtZSBhcyBNYXJrZXRXaXRoSG9zdC5TdHJpbmcoKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbGl2ZUJvdENvbmZpZyAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKTogQm90Q29uZmlnIHwgdW5kZWZpbmVkIHtcbiAgY29uc3QgcyA9IGxpdmVCb3RTdGF0dXMoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICBpZiAocykgcmV0dXJuIHMuY29uZmlnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaXZlQm90U3RhdHVzIChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpOiBNTUJvdFN0YXR1cyB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IHN0YXR1c2VzID0gKGFwcCgpLm1tU3RhdHVzLmJvdHMgfHwgW10pLmZpbHRlcigoczogTU1Cb3RTdGF0dXMpID0+IHtcbiAgICByZXR1cm4gcy5jb25maWcuYmFzZUlEID09PSBiYXNlSUQgJiYgcy5jb25maWcucXVvdGVJRCA9PT0gcXVvdGVJRCAmJiBzLmNvbmZpZy5ob3N0ID09PSBob3N0XG4gIH0pXG4gIGlmIChzdGF0dXNlcy5sZW5ndGgpIHJldHVybiBzdGF0dXNlc1swXVxufVxuXG5pbnRlcmZhY2UgTG90dGVyIHtcbiAgbG90czogbnVtYmVyXG59XG5cbmZ1bmN0aW9uIHN1bUxvdHMgKGxvdHM6IG51bWJlciwgcDogTG90dGVyKSB7XG4gIHJldHVybiBsb3RzICsgcC5sb3RzXG59XG5cbmludGVyZmFjZSBBbGxvY2F0aW9uUHJvamVjdGlvbiB7XG4gIGJQcm9qOiBQcm9qZWN0ZWRBbGxvY1xuICBxUHJvajogUHJvamVjdGVkQWxsb2NcbiAgYWxsb2M6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbn1cblxuZnVuY3Rpb24gZW1wdHlQcm9qZWN0aW9uICgpOiBQcm9qZWN0ZWRBbGxvYyB7XG4gIHJldHVybiB7IGJvb2s6IDAsIGJvb2tpbmdGZWVzOiAwLCBzd2FwRmVlUmVzZXJ2ZXM6IDAsIGNleDogMCwgb3JkZXJSZXNlcnZlczogMCwgc2xpcHBhZ2VCdWZmZXI6IDAgfVxufVxuXG5leHBvcnQgY2xhc3MgQm90TWFya2V0IHtcbiAgY2ZnOiBCb3RDb25maWdcbiAgaG9zdDogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIGJhc2VTeW1ib2w6IHN0cmluZ1xuICBiYXNlVGlja2VyOiBzdHJpbmdcbiAgYmFzZUZlZUlEOiBudW1iZXJcbiAgYmFzZUlzQWNjb3VudExvY2tlcjogYm9vbGVhblxuICBiYXNlRmVlU3ltYm9sOiBzdHJpbmdcbiAgYmFzZUZlZVRpY2tlcjogc3RyaW5nXG4gIGJhc2VUb2tlbj86IFRva2VuXG4gIHF1b3RlSUQ6IG51bWJlclxuICBxdW90ZVN5bWJvbDogc3RyaW5nXG4gIHF1b3RlVGlja2VyOiBzdHJpbmdcbiAgcXVvdGVGZWVJRDogbnVtYmVyXG4gIHF1b3RlSXNBY2NvdW50TG9ja2VyOiBib29sZWFuXG4gIHF1b3RlRmVlU3ltYm9sOiBzdHJpbmdcbiAgcXVvdGVGZWVUaWNrZXI6IHN0cmluZ1xuICBxdW90ZVRva2VuPzogVG9rZW5cbiAgYm90VHlwZTogc3RyaW5nXG4gIGNleE5hbWU6IHN0cmluZ1xuICBkaW5mbzogQ0VYRGlzcGxheUluZm9cbiAgYWxsb2M6IEJvdEJhbGFuY2VBbGxvY2F0aW9uXG4gIHByb2o6IEFsbG9jYXRpb25Qcm9qZWN0aW9uXG4gIGJ1aTogVW5pdEluZm9cbiAgYmFzZUZhY3RvcjogbnVtYmVyXG4gIGJhc2VGZWVVSTogVW5pdEluZm9cbiAgYmFzZUZlZUZhY3RvcjogbnVtYmVyXG4gIHF1aTogVW5pdEluZm9cbiAgcXVvdGVGYWN0b3I6IG51bWJlclxuICBxdW90ZUZlZVVJOiBVbml0SW5mb1xuICBxdW90ZUZlZUZhY3RvcjogbnVtYmVyXG4gIGlkOiBzdHJpbmcgLy8gaW5jbHVkZXMgaG9zdFxuICBta3RJRDogc3RyaW5nXG4gIGxvdFNpemU6IG51bWJlclxuICBsb3RTaXplQ29udjogbnVtYmVyXG4gIGxvdFNpemVVU0Q6IG51bWJlclxuICBxdW90ZUxvdDogbnVtYmVyXG4gIHF1b3RlTG90Q29udjogbnVtYmVyXG4gIHF1b3RlTG90VVNEOiBudW1iZXJcbiAgYmFzZUZlZUZpYXRSYXRlOiBudW1iZXJcbiAgcXVvdGVGZWVGaWF0UmF0ZTogbnVtYmVyXG4gIGJhc2VMb3RzOiBudW1iZXJcbiAgcXVvdGVMb3RzOiBudW1iZXJcbiAgbWFya2V0UmVwb3J0OiBNYXJrZXRSZXBvcnRcbiAgY2V4QmFzZUJhbGFuY2U/OiBFeGNoYW5nZUJhbGFuY2VcbiAgY2V4UXVvdGVCYWxhbmNlPzogRXhjaGFuZ2VCYWxhbmNlXG4gIG5CdXlQbGFjZW1lbnRzOiBudW1iZXJcbiAgblNlbGxQbGFjZW1lbnRzOiBudW1iZXJcblxuICBjb25zdHJ1Y3RvciAoY2ZnOiBCb3RDb25maWcpIHtcbiAgICBjb25zdCBob3N0ID0gdGhpcy5ob3N0ID0gY2ZnLmhvc3RcbiAgICBjb25zdCBiYXNlSUQgPSB0aGlzLmJhc2VJRCA9IGNmZy5iYXNlSURcbiAgICBjb25zdCBxdW90ZUlEID0gdGhpcy5xdW90ZUlEID0gY2ZnLnF1b3RlSURcbiAgICB0aGlzLmNleE5hbWUgPSBjZmcuY2V4TmFtZVxuICAgIGNvbnN0IHN0YXR1cyA9IGFwcCgpLm1tU3RhdHVzLmJvdHMuZmluZCgoeyBjb25maWc6IGMgfTogTU1Cb3RTdGF0dXMpID0+IGMuYmFzZUlEID09PSBiYXNlSUQgJiYgYy5xdW90ZUlEID09PSBxdW90ZUlEICYmIGMuaG9zdCA9PT0gaG9zdClcbiAgICBpZiAoIXN0YXR1cykgdGhyb3cgRXJyb3IoJ3doZXJlXFwncyB0aGUgYm90IHN0YXR1cz8nKVxuICAgIHRoaXMuY2ZnID0gc3RhdHVzLmNvbmZpZ1xuXG4gICAgY29uc3QgeyB0b2tlbjogYmFzZVRva2VuLCBzeW1ib2w6IGJhc2VTeW1ib2wsIHVuaXRJbmZvOiBidWkgfSA9IGFwcCgpLmFzc2V0c1tiYXNlSURdXG4gICAgdGhpcy5iYXNlU3ltYm9sID0gYmFzZVN5bWJvbFxuICAgIHRoaXMuYmFzZVRpY2tlciA9IGJ1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIHRoaXMuYnVpID0gYnVpXG4gICAgdGhpcy5iYXNlRmFjdG9yID0gYnVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgdGhpcy5iYXNlVG9rZW4gPSBiYXNlVG9rZW5cbiAgICBjb25zdCBiYXNlRmVlSUQgPSB0aGlzLmJhc2VGZWVJRCA9IGJhc2VUb2tlbiA/IGJhc2VUb2tlbi5wYXJlbnRJRCA6IGJhc2VJRFxuICAgIGNvbnN0IHsgdW5pdEluZm86IGJhc2VGZWVVSSwgc3ltYm9sOiBiYXNlRmVlU3ltYm9sLCB3YWxsZXQ6IGJhc2VXYWxsZXQgfSA9IGFwcCgpLmFzc2V0c1t0aGlzLmJhc2VGZWVJRF1cbiAgICBjb25zdCB0cmFpdEFjY291bnRMb2NrZXIgPSAxIDw8IDE0XG4gICAgdGhpcy5iYXNlSXNBY2NvdW50TG9ja2VyID0gKGJhc2VXYWxsZXQudHJhaXRzICYgdHJhaXRBY2NvdW50TG9ja2VyKSA+IDBcbiAgICB0aGlzLmJhc2VGZWVVSSA9IGJhc2VGZWVVSVxuICAgIHRoaXMuYmFzZUZlZVRpY2tlciA9IGJhc2VGZWVVSS5jb252ZW50aW9uYWwudW5pdFxuICAgIHRoaXMuYmFzZUZlZVN5bWJvbCA9IGJhc2VGZWVTeW1ib2xcbiAgICB0aGlzLmJhc2VGZWVGYWN0b3IgPSB0aGlzLmJhc2VGZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuXG4gICAgY29uc3QgeyB0b2tlbjogcXVvdGVUb2tlbiwgc3ltYm9sOiBxdW90ZVN5bWJvbCwgdW5pdEluZm86IHF1aSB9ID0gYXBwKCkuYXNzZXRzW3F1b3RlSURdXG4gICAgdGhpcy5xdW90ZVN5bWJvbCA9IHF1b3RlU3ltYm9sXG4gICAgdGhpcy5xdW90ZVRpY2tlciA9IHF1aS5jb252ZW50aW9uYWwudW5pdFxuICAgIHRoaXMucXVpID0gcXVpXG4gICAgdGhpcy5xdW90ZUZhY3RvciA9IHF1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIHRoaXMucXVvdGVUb2tlbiA9IHF1b3RlVG9rZW5cbiAgICBjb25zdCBxdW90ZUZlZUlEID0gdGhpcy5xdW90ZUZlZUlEID0gcXVvdGVUb2tlbiA/IHF1b3RlVG9rZW4ucGFyZW50SUQgOiBxdW90ZUlEXG4gICAgY29uc3QgeyB1bml0SW5mbzogcXVvdGVGZWVVSSwgc3ltYm9sOiBxdW90ZUZlZVN5bWJvbCwgd2FsbGV0OiBxdW90ZVdhbGxldCB9ID0gYXBwKCkuYXNzZXRzW3RoaXMucXVvdGVGZWVJRF1cbiAgICB0aGlzLnF1b3RlSXNBY2NvdW50TG9ja2VyID0gKHF1b3RlV2FsbGV0LnRyYWl0cyAmIHRyYWl0QWNjb3VudExvY2tlcikgPiAwXG4gICAgdGhpcy5xdW90ZUZlZVVJID0gcXVvdGVGZWVVSVxuICAgIHRoaXMucXVvdGVGZWVUaWNrZXIgPSBxdW90ZUZlZVVJLmNvbnZlbnRpb25hbC51bml0XG4gICAgdGhpcy5xdW90ZUZlZVN5bWJvbCA9IHF1b3RlRmVlU3ltYm9sXG4gICAgdGhpcy5xdW90ZUZlZUZhY3RvciA9IHRoaXMucXVvdGVGZWVVSS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuXG4gICAgdGhpcy5pZCA9IGhvc3RlZE1hcmtldElEKGhvc3QsIGJhc2VJRCwgcXVvdGVJRClcbiAgICB0aGlzLm1rdElEID0gYCR7YmFzZVN5bWJvbH1fJHtxdW90ZVN5bWJvbH1gXG5cbiAgICBjb25zdCB7IG1hcmtldHMgfSA9IGFwcCgpLmV4Y2hhbmdlc1tob3N0XVxuICAgIGNvbnN0IHsgbG90c2l6ZTogbG90U2l6ZSB9ID0gbWFya2V0c1t0aGlzLm1rdElEXVxuICAgIHRoaXMubG90U2l6ZSA9IGxvdFNpemVcbiAgICB0aGlzLmxvdFNpemVDb252ID0gbG90U2l6ZSAvIGJ1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgIHRoaXMucXVvdGVMb3QgPSBjYWxjdWxhdGVRdW90ZUxvdChsb3RTaXplLCBiYXNlSUQsIHF1b3RlSUQpXG4gICAgdGhpcy5xdW90ZUxvdENvbnYgPSB0aGlzLnF1b3RlTG90IC8gcXVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG5cbiAgICB0aGlzLmJhc2VGZWVGaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtiYXNlRmVlSURdXG4gICAgdGhpcy5xdW90ZUZlZUZpYXRSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW3F1b3RlRmVlSURdXG5cbiAgICBpZiAoY2ZnLmFyYk1hcmtldE1ha2luZ0NvbmZpZykge1xuICAgICAgdGhpcy5ib3RUeXBlID0gYm90VHlwZUFyYk1NXG4gICAgICB0aGlzLmJhc2VMb3RzID0gY2ZnLmFyYk1hcmtldE1ha2luZ0NvbmZpZy5zZWxsUGxhY2VtZW50cy5yZWR1Y2Uoc3VtTG90cywgMClcbiAgICAgIHRoaXMucXVvdGVMb3RzID0gY2ZnLmFyYk1hcmtldE1ha2luZ0NvbmZpZy5idXlQbGFjZW1lbnRzLnJlZHVjZShzdW1Mb3RzLCAwKVxuICAgICAgdGhpcy5uQnV5UGxhY2VtZW50cyA9IGNmZy5hcmJNYXJrZXRNYWtpbmdDb25maWcuYnV5UGxhY2VtZW50cy5sZW5ndGhcbiAgICAgIHRoaXMublNlbGxQbGFjZW1lbnRzID0gY2ZnLmFyYk1hcmtldE1ha2luZ0NvbmZpZy5zZWxsUGxhY2VtZW50cy5sZW5ndGhcbiAgICB9IGVsc2UgaWYgKGNmZy5zaW1wbGVBcmJDb25maWcpIHtcbiAgICAgIHRoaXMuYm90VHlwZSA9IGJvdFR5cGVCYXNpY0FyYlxuICAgICAgdGhpcy5iYXNlTG90cyA9IGNmZy51aUNvbmZpZy5zaW1wbGVBcmJMb3RzIGFzIG51bWJlclxuICAgICAgdGhpcy5xdW90ZUxvdHMgPSBjZmcudWlDb25maWcuc2ltcGxlQXJiTG90cyBhcyBudW1iZXJcbiAgICB9IGVsc2UgaWYgKGNmZy5iYXNpY01hcmtldE1ha2luZ0NvbmZpZykgeyAvLyBiYXNpY21tXG4gICAgICB0aGlzLmJvdFR5cGUgPSBib3RUeXBlQmFzaWNNTVxuICAgICAgdGhpcy5iYXNlTG90cyA9IGNmZy5iYXNpY01hcmtldE1ha2luZ0NvbmZpZy5zZWxsUGxhY2VtZW50cy5yZWR1Y2Uoc3VtTG90cywgMClcbiAgICAgIHRoaXMucXVvdGVMb3RzID0gY2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnLmJ1eVBsYWNlbWVudHMucmVkdWNlKHN1bUxvdHMsIDApXG4gICAgICB0aGlzLm5CdXlQbGFjZW1lbnRzID0gY2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnLmJ1eVBsYWNlbWVudHMubGVuZ3RoXG4gICAgICB0aGlzLm5TZWxsUGxhY2VtZW50cyA9IGNmZy5iYXNpY01hcmtldE1ha2luZ0NvbmZpZy5zZWxsUGxhY2VtZW50cy5sZW5ndGhcbiAgICB9XG4gIH1cblxuICBhc3luYyBpbml0aWFsaXplIChzdGFydHVwQmFsYW5jZUNhY2hlOiBSZWNvcmQ8bnVtYmVyLCBQcm9taXNlPEV4Y2hhbmdlQmFsYW5jZT4+KSB7XG4gICAgY29uc3QgeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQsIGxvdFNpemVDb252LCBxdW90ZUxvdENvbnYsIGNleE5hbWUgfSA9IHRoaXNcbiAgICBjb25zdCByZXMgPSBhd2FpdCBNTS5yZXBvcnQoaG9zdCwgYmFzZUlELCBxdW90ZUlEKVxuICAgIGNvbnN0IHIgPSB0aGlzLm1hcmtldFJlcG9ydCA9IHJlcy5yZXBvcnQgYXMgTWFya2V0UmVwb3J0XG4gICAgdGhpcy5sb3RTaXplVVNEID0gbG90U2l6ZUNvbnYgKiByLmJhc2VGaWF0UmF0ZVxuICAgIHRoaXMucXVvdGVMb3RVU0QgPSBxdW90ZUxvdENvbnYgKiByLnF1b3RlRmlhdFJhdGVcbiAgICB0aGlzLnByb2ogPSB0aGlzLnByb2plY3RlZEFsbG9jYXRpb25zKClcblxuICAgIGlmIChjZXhOYW1lKSB7XG4gICAgICBjb25zdCBiID0gc3RhcnR1cEJhbGFuY2VDYWNoZVtiYXNlSURdID0gc3RhcnR1cEJhbGFuY2VDYWNoZVtiYXNlSURdIHx8IE1NLmNleEJhbGFuY2UoY2V4TmFtZSwgYmFzZUlEKVxuICAgICAgY29uc3QgcSA9IHN0YXJ0dXBCYWxhbmNlQ2FjaGVbcXVvdGVJRF0gPSBzdGFydHVwQmFsYW5jZUNhY2hlW3F1b3RlSURdIHx8IE1NLmNleEJhbGFuY2UoY2V4TmFtZSwgcXVvdGVJRClcbiAgICAgIHRoaXMuY2V4QmFzZUJhbGFuY2UgPSBhd2FpdCBiXG4gICAgICB0aGlzLmNleFF1b3RlQmFsYW5jZSA9IGF3YWl0IHFcbiAgICB9XG4gIH1cblxuICBzdGF0dXMgKCkge1xuICAgIGNvbnN0IHsgYmFzZUlELCBxdW90ZUlEIH0gPSB0aGlzXG4gICAgY29uc3QgYm90U3RhdHVzID0gYXBwKCkubW1TdGF0dXMuYm90cy5maW5kKChzOiBNTUJvdFN0YXR1cykgPT4gcy5jb25maWcuYmFzZUlEID09PSBiYXNlSUQgJiYgcy5jb25maWcucXVvdGVJRCA9PT0gcXVvdGVJRClcbiAgICBpZiAoIWJvdFN0YXR1cykgcmV0dXJuIHsgYm90Q2ZnOiB7fSBhcyBCb3RDb25maWcsIHJ1bm5pbmc6IGZhbHNlLCBydW5TdGF0czoge30gYXMgUnVuU3RhdHMgfVxuICAgIGNvbnN0IHsgY29uZmlnOiBib3RDZmcsIHJ1bm5pbmcsIHJ1blN0YXRzIH0gPSBib3RTdGF0dXNcbiAgICByZXR1cm4geyBib3RDZmcsIHJ1bm5pbmcsIHJ1blN0YXRzIH1cbiAgfVxuXG4gIC8qXG4gICogYWRqdXN0ZWRCYWxhbmNlcyBjYWxjdWxhdGVzIHRoZSB1c2VyJ3MgYXZhaWxhYmxlIGJhbGFuY2VzIGFuZCBmZWUtYXNzZXRcbiAgKiBiYWxhbmNlcyBmb3IgYSBtYXJrZXQsIHdpdGggY29uc2lkZXJhdGlvbiBmb3IgY3VycmVudGx5IHJ1bm5pbmcgYm90cy5cbiAgKi9cbiAgYWRqdXN0ZWRCYWxhbmNlcyAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgYmFzZUlELCBxdW90ZUlELCBiYXNlRmVlSUQsIHF1b3RlRmVlSUQsIGNleEJhc2VCYWxhbmNlLCBjZXhRdW90ZUJhbGFuY2UsXG4gICAgICBiYXNlRmFjdG9yLCBxdW90ZUZhY3RvciwgYmFzZUZlZUZhY3RvciwgcXVvdGVGZWVGYWN0b3JcbiAgICB9ID0gdGhpc1xuICAgIGNvbnN0IFtiYXNlV2FsbGV0LCBxdW90ZVdhbGxldF0gPSBbYXBwKCkud2FsbGV0TWFwW2Jhc2VJRF0sIGFwcCgpLndhbGxldE1hcFtxdW90ZUlEXV1cbiAgICBjb25zdCBbYkludiwgcUludl0gPSBbcnVubmluZ0JvdEludmVudG9yeShiYXNlSUQpLCBydW5uaW5nQm90SW52ZW50b3J5KHF1b3RlSUQpXVxuICAgIC8vIEluIHRoZXNlIGF2YWlsYWJsZSBiYWxhbmNlIGNhbGNzLCBvbmx5IHN1YnRyYWN0IHRoZSBhdmFpbGFibGUgYmFsYW5jZSBvZlxuICAgIC8vIHJ1bm5pbmcgYm90cywgc2luY2UgdGhlIGxvY2tlZC9yZXNlcnZlZC9pbW1hdHVyZSBpcyBhbHJlYWR5IHN1YnRyYWN0ZWRcbiAgICAvLyBmcm9tIHRoZSB3YWxsZXQncyB0b3RhbCBhdmFpbGFibGUgYmFsYW5jZS5cbiAgICBjb25zdCBbY2V4QmFzZUF2YWlsLCBjZXhRdW90ZUF2YWlsXSA9IFsoY2V4QmFzZUJhbGFuY2U/LmF2YWlsYWJsZSB8fCAwKSAtIGJJbnYuY2V4LmF2YWlsLCAoY2V4UXVvdGVCYWxhbmNlPy5hdmFpbGFibGUgfHwgMCkgLSBxSW52LmNleC5hdmFpbF1cbiAgICBjb25zdCBbZGV4QmFzZUF2YWlsLCBkZXhRdW90ZUF2YWlsXSA9IFtiYXNlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC0gYkludi5kZXguYXZhaWwsIHF1b3RlV2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlIC0gcUludi5kZXguYXZhaWxdXG4gICAgY29uc3QgYmFzZUF2YWlsID0gZGV4QmFzZUF2YWlsICsgY2V4QmFzZUF2YWlsXG4gICAgY29uc3QgcXVvdGVBdmFpbCA9IGRleFF1b3RlQXZhaWwgKyBjZXhRdW90ZUF2YWlsXG4gICAgY29uc3QgYmFzZUZlZVdhbGxldCA9IGJhc2VGZWVJRCA9PT0gYmFzZUlEID8gYmFzZVdhbGxldCA6IGFwcCgpLndhbGxldE1hcFtiYXNlRmVlSURdXG4gICAgY29uc3QgcXVvdGVGZWVXYWxsZXQgPSBxdW90ZUZlZUlEID09PSBxdW90ZUlEID8gcXVvdGVXYWxsZXQgOiBhcHAoKS53YWxsZXRNYXBbcXVvdGVGZWVJRF1cblxuICAgIGxldCBbYmFzZUZlZUF2YWlsLCBkZXhCYXNlRmVlQXZhaWwsIGNleEJhc2VGZWVBdmFpbF0gPSBbYmFzZUF2YWlsLCBkZXhCYXNlQXZhaWwsIGNleEJhc2VBdmFpbF1cbiAgICBpZiAoYmFzZUZlZUlEICE9PSBiYXNlSUQpIHtcbiAgICAgIGNvbnN0IGJGZWVJbnYgPSBydW5uaW5nQm90SW52ZW50b3J5KGJhc2VJRClcbiAgICAgIGRleEJhc2VGZWVBdmFpbCA9IGJhc2VGZWVXYWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgLSBiRmVlSW52LmRleC50b3RhbFxuICAgICAgY2V4QmFzZUZlZUF2YWlsID0gKGNleEJhc2VCYWxhbmNlPy5hdmFpbGFibGUgfHwgMCkgLSBiRmVlSW52LmNleC50b3RhbFxuICAgICAgYmFzZUZlZUF2YWlsID0gZGV4QmFzZUZlZUF2YWlsICsgY2V4QmFzZUZlZUF2YWlsXG4gICAgfVxuICAgIGxldCBbcXVvdGVGZWVBdmFpbCwgZGV4UXVvdGVGZWVBdmFpbCwgY2V4UXVvdGVGZWVBdmFpbF0gPSBbcXVvdGVBdmFpbCwgZGV4UXVvdGVBdmFpbCwgY2V4UXVvdGVBdmFpbF1cbiAgICBpZiAocXVvdGVGZWVJRCAhPT0gcXVvdGVJRCkge1xuICAgICAgY29uc3QgcUZlZUludiA9IHJ1bm5pbmdCb3RJbnZlbnRvcnkocXVvdGVJRClcbiAgICAgIGRleFF1b3RlRmVlQXZhaWwgPSBxdW90ZUZlZVdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSAtIHFGZWVJbnYuZGV4LnRvdGFsXG4gICAgICBjZXhRdW90ZUZlZUF2YWlsID0gKGNleFF1b3RlQmFsYW5jZT8uYXZhaWxhYmxlIHx8IDApIC0gcUZlZUludi5jZXgudG90YWxcbiAgICAgIHF1b3RlRmVlQXZhaWwgPSBkZXhRdW90ZUZlZUF2YWlsICsgY2V4UXVvdGVGZWVBdmFpbFxuICAgIH1cbiAgICByZXR1cm4geyAvLyBjb252ZXJ0IHRvIGNvbnZlbnRpb2FubC5cbiAgICAgIGJhc2VBdmFpbDogYmFzZUF2YWlsIC8gYmFzZUZhY3RvcixcbiAgICAgIHF1b3RlQXZhaWw6IHF1b3RlQXZhaWwgLyBxdW90ZUZhY3RvcixcbiAgICAgIGRleEJhc2VBdmFpbDogZGV4QmFzZUF2YWlsIC8gYmFzZUZhY3RvcixcbiAgICAgIGRleFF1b3RlQXZhaWw6IGRleFF1b3RlQXZhaWwgLyBxdW90ZUZhY3RvcixcbiAgICAgIGNleEJhc2VBdmFpbDogY2V4QmFzZUF2YWlsIC8gYmFzZUZhY3RvcixcbiAgICAgIGNleFF1b3RlQXZhaWw6IGNleFF1b3RlQXZhaWwgLyBxdW90ZUZhY3RvcixcbiAgICAgIGJhc2VGZWVBdmFpbDogYmFzZUZlZUF2YWlsIC8gYmFzZUZlZUZhY3RvcixcbiAgICAgIHF1b3RlRmVlQXZhaWw6IHF1b3RlRmVlQXZhaWwgLyBxdW90ZUZlZUZhY3RvcixcbiAgICAgIGRleEJhc2VGZWVBdmFpbDogZGV4QmFzZUZlZUF2YWlsIC8gYmFzZUZlZUZhY3RvcixcbiAgICAgIGRleFF1b3RlRmVlQXZhaWw6IGRleFF1b3RlRmVlQXZhaWwgLyBxdW90ZUZlZUZhY3RvcixcbiAgICAgIGNleEJhc2VGZWVBdmFpbDogY2V4QmFzZUZlZUF2YWlsIC8gYmFzZUZlZUZhY3RvcixcbiAgICAgIGNleFF1b3RlRmVlQXZhaWw6IGNleFF1b3RlRmVlQXZhaWwgLyBxdW90ZUZlZUZhY3RvclxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIGZlZXNBbmRDb21taXQgZ2VuZXJhdGVzIGEgc25hcHNob3Qgb2YgY3VycmVudCBtYXJrZXQgZmVlcywgYXMgd2VsbCBhcyBhXG4gICAqIFwiY29tbWl0XCIsIHdoaWNoIGlzIHRoZSBmdW5kaW5nIGRlZGljYXRlZCB0byBiZWluZyBvbiBvcmRlci4gVGhlIGNvbW1pdFxuICAgKiB2YWx1ZXMgZG8gbm90IGluY2x1ZGUgYm9va2luZyBmZWVzLCBvcmRlciByZXNlcnZlcywgZXRjLiBqdXN0IHRoZSBvcmRlclxuICAgKiBxdWFudGl0eS5cbiAgICovXG4gIGZlZXNBbmRDb21taXQgKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGJhc2VJRCwgcXVvdGVJRCwgbWFya2V0UmVwb3J0OiB7IGJhc2VGZWVzLCBxdW90ZUZlZXMgfSwgbG90U2l6ZSxcbiAgICAgIGJhc2VMb3RzLCBxdW90ZUxvdHMsIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCwgYmFzZUlzQWNjb3VudExvY2tlciwgcXVvdGVJc0FjY291bnRMb2NrZXIsXG4gICAgICBjZmc6IHsgdWlDb25maWc6IHsgYmFzZUNvbmZpZywgcXVvdGVDb25maWcgfSB9XG4gICAgfSA9IHRoaXNcblxuICAgIHJldHVybiBmZWVzQW5kQ29tbWl0KFxuICAgICAgYmFzZUlELCBxdW90ZUlELCBiYXNlRmVlcywgcXVvdGVGZWVzLCBsb3RTaXplLCBiYXNlTG90cywgcXVvdGVMb3RzLFxuICAgICAgYmFzZUZlZUlELCBxdW90ZUZlZUlELCBiYXNlSXNBY2NvdW50TG9ja2VyLCBxdW90ZUlzQWNjb3VudExvY2tlcixcbiAgICAgIGJhc2VDb25maWcub3JkZXJSZXNlcnZlc0ZhY3RvciwgcXVvdGVDb25maWcub3JkZXJSZXNlcnZlc0ZhY3RvclxuICAgIClcbiAgfVxuXG4gIC8qXG4gICAqIHByb2plY3RlZEFsbG9jYXRpb25zIGNhbGN1bGF0ZXMgdGhlIHJlcXVpcmVkIGFzc2V0IGFsbG9jYXRpb25zIGZyb20gdGhlXG4gICAqIHVzZXIncyBjb25maWd1cmF0aW9uIHNldHRpbmdzIGFuZCB0aGUgY3VycmVudCBtYXJrZXQgc3RhdGUuXG4gICAqL1xuICBwcm9qZWN0ZWRBbGxvY2F0aW9ucyAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY2ZnOiB7IHVpQ29uZmlnOiB7IHF1b3RlQ29uZmlnLCBiYXNlQ29uZmlnIH0gfSxcbiAgICAgIGJhc2VGYWN0b3IsIHF1b3RlRmFjdG9yLCBiYXNlSUQsIHF1b3RlSUQsIGxvdFNpemVDb252LCBxdW90ZUxvdENvbnYsXG4gICAgICBiYXNlRmVlRmFjdG9yLCBxdW90ZUZlZUZhY3RvciwgYmFzZUZlZUlELCBxdW90ZUZlZUlELCBiYXNlVG9rZW4sXG4gICAgICBxdW90ZVRva2VuLCBjZXhOYW1lXG4gICAgfSA9IHRoaXNcbiAgICBjb25zdCB7IGNvbW1pdCwgZmVlcyB9ID0gdGhpcy5mZWVzQW5kQ29tbWl0KClcblxuICAgIGNvbnN0IGJQcm9qID0gZW1wdHlQcm9qZWN0aW9uKClcbiAgICBjb25zdCBxUHJvaiA9IGVtcHR5UHJvamVjdGlvbigpXG5cbiAgICBiUHJvai5ib29rID0gY29tbWl0LmRleC5iYXNlLmxvdHMgKiBsb3RTaXplQ29udlxuICAgIHFQcm9qLmJvb2sgPSBjb21taXQuY2V4LmJhc2UubG90cyAqIHF1b3RlTG90Q29udlxuXG4gICAgYlByb2oub3JkZXJSZXNlcnZlcyA9IE1hdGgubWF4KGNvbW1pdC5jZXguYmFzZS52YWwsIGNvbW1pdC5kZXguYmFzZS52YWwpICogYmFzZUNvbmZpZy5vcmRlclJlc2VydmVzRmFjdG9yIC8gYmFzZUZhY3RvclxuICAgIHFQcm9qLm9yZGVyUmVzZXJ2ZXMgPSBNYXRoLm1heChjb21taXQuY2V4LnF1b3RlLnZhbCwgY29tbWl0LmRleC5xdW90ZS52YWwpICogcXVvdGVDb25maWcub3JkZXJSZXNlcnZlc0ZhY3RvciAvIHF1b3RlRmFjdG9yXG5cbiAgICBpZiAoY2V4TmFtZSkge1xuICAgICAgYlByb2ouY2V4ID0gY29tbWl0LmNleC5iYXNlLmxvdHMgKiBsb3RTaXplQ29udlxuICAgICAgcVByb2ouY2V4ID0gY29tbWl0LmNleC5xdW90ZS5sb3RzICogcXVvdGVMb3RDb252XG4gICAgfVxuXG4gICAgYlByb2ouYm9va2luZ0ZlZXMgPSBmZWVzLmJhc2UuYm9va2luZ0ZlZXMgLyBiYXNlRmVlRmFjdG9yXG4gICAgcVByb2ouYm9va2luZ0ZlZXMgPSBmZWVzLnF1b3RlLmJvb2tpbmdGZWVzIC8gcXVvdGVGZWVGYWN0b3JcblxuICAgIGlmIChiYXNlVG9rZW4pIGJQcm9qLnN3YXBGZWVSZXNlcnZlcyA9IGZlZXMuYmFzZS50b2tlbkZlZXNQZXJTd2FwICogYmFzZUNvbmZpZy5zd2FwRmVlTiAvIGJhc2VGZWVGYWN0b3JcbiAgICBpZiAocXVvdGVUb2tlbikgcVByb2ouc3dhcEZlZVJlc2VydmVzID0gZmVlcy5xdW90ZS50b2tlbkZlZXNQZXJTd2FwICogcXVvdGVDb25maWcuc3dhcEZlZU4gLyBxdW90ZUZlZUZhY3RvclxuICAgIHFQcm9qLnNsaXBwYWdlQnVmZmVyID0gKHFQcm9qLmJvb2sgKyBxUHJvai5jZXggKyBxUHJvai5vcmRlclJlc2VydmVzKSAqIHF1b3RlQ29uZmlnLnNsaXBwYWdlQnVmZmVyRmFjdG9yXG5cbiAgICBjb25zdCBhbGxvYzogUmVjb3JkPG51bWJlciwgbnVtYmVyPiA9IHt9XG4gICAgY29uc3QgYWRkQWxsb2MgPSAoYXNzZXRJRDogbnVtYmVyLCBhbXQ6IG51bWJlcikgPT4geyBhbGxvY1thc3NldElEXSA9IChhbGxvY1thc3NldElEXSA/PyAwKSArIGFtdCB9XG4gICAgYWRkQWxsb2MoYmFzZUlELCBNYXRoLnJvdW5kKChiUHJvai5ib29rICsgYlByb2ouY2V4ICsgYlByb2oub3JkZXJSZXNlcnZlcykgKiBiYXNlRmFjdG9yKSlcbiAgICBhZGRBbGxvYyhiYXNlRmVlSUQsIE1hdGgucm91bmQoKGJQcm9qLmJvb2tpbmdGZWVzICsgYlByb2ouc3dhcEZlZVJlc2VydmVzKSAqIGJhc2VGZWVGYWN0b3IpKVxuICAgIGFkZEFsbG9jKHF1b3RlSUQsIE1hdGgucm91bmQoKHFQcm9qLmJvb2sgKyBxUHJvai5jZXggKyBxUHJvai5vcmRlclJlc2VydmVzICsgcVByb2ouc2xpcHBhZ2VCdWZmZXIpICogcXVvdGVGYWN0b3IpKVxuICAgIGFkZEFsbG9jKHF1b3RlRmVlSUQsIE1hdGgucm91bmQoKHFQcm9qLmJvb2tpbmdGZWVzICsgcVByb2ouc3dhcEZlZVJlc2VydmVzKSAqIHF1b3RlRmVlRmFjdG9yKSlcblxuICAgIHJldHVybiB7IHFQcm9qLCBiUHJvaiwgYWxsb2MgfVxuICB9XG5cbiAgLypcbiAgICogZnVuZGluZ1N0YXRlIGV4YW1pbmVzIHRoZSBwcm9qZWN0ZWQgYWxsb2NhdGlvbnMgYW5kIHRoZSB1c2VyJ3Mgd2FsbGV0XG4gICAqIGJhbGFuY2VzIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSB1c2VyIGNhbiBmdW5kIHRoZSBib3QgZnVsbHksIHVuYmFsYW5jZWQsXG4gICAqIG9yIHN0YXJ2ZWQsIGFuZCB3aGF0IGZ1bmRpbmcgc291cmNlIG9wdGlvbnMgbWlnaHQgYmUgYXZhaWxhYmxlLlxuICAgKi9cbiAgZnVuZGluZ1N0YXRlICgpIHtcbiAgICBjb25zdCB7XG4gICAgICBwcm9qOiB7IGJQcm9qLCBxUHJvaiB9LCBiYXNlSUQsIHF1b3RlSUQsIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCxcbiAgICAgIGNmZzogeyB1aUNvbmZpZzogeyBjZXhSZWJhbGFuY2UgfSB9LCBjZXhOYW1lXG4gICAgfSA9IHRoaXNcbiAgICBjb25zdCB7XG4gICAgICBiYXNlQXZhaWwsIHF1b3RlQXZhaWwsIGRleEJhc2VBdmFpbCwgZGV4UXVvdGVBdmFpbCwgY2V4QmFzZUF2YWlsLCBjZXhRdW90ZUF2YWlsLFxuICAgICAgZGV4QmFzZUZlZUF2YWlsLCBkZXhRdW90ZUZlZUF2YWlsXG4gICAgfSA9IHRoaXMuYWRqdXN0ZWRCYWxhbmNlcygpXG5cbiAgICBjb25zdCBjYW5SZWJhbGFuY2UgPSBCb29sZWFuKGNleE5hbWUgJiYgY2V4UmViYWxhbmNlKVxuXG4gICAgLy8gVGhyZWUgcG9zc2libGUgc3RhdGVzLlxuICAgIC8vIDEuIFdlIGhhdmUgdGhlIGZ1bmRpbmcgaW4gdGhlIHByb2plY3Rpb24sIGFuZCBpdHMgaW4gdGhlIHJpZ2h0IHBsYWNlcy5cbiAgICAvLyAgICBHaXZlIHRoZW0gc29tZSBvcHRpb25zIGZvciB3aGljaCB3YWxsZXQgdG8gcHVsbCBvcmRlciByZXNlcnZlcyBmcm9tLFxuICAgIC8vICAgIGJ1dCB0aGV5IGNhbiBzdGFydCBpbW1lZGlhdGVseS4uXG4gICAgLy8gMi4gV2UgaGF2ZSB0aGUgZnVuZGluZywgYnV0IGl0J3MgaW4gdGhlIHdyb25nIHBsYWNlIG9yIHRoZSB3cm9uZyBhc3NldCxcbiAgICAvLyAgICBidXQgd2UgaGF2ZSBkZXBvc2l0cyBhbmQgd2l0aGRyYXdzIGVuYWJsZWQuIFdlIGNhbiBvZmZlciB0aGVtIHRoZVxuICAgIC8vICAgIG9wdGlvbiB0byBzdGFydCBpbiBhbiB1bmJhbGFuY2VkIHN0YXRlLlxuICAgIC8vIDMuIFdlIGRvbid0IGhhdmUgdGhlIGZ1bmRzLiBXZSBvZmZlciB0aGVtIGFuIG9wdGlvbiB0byBzdGFydCBpbiBhXG4gICAgLy8gICAgc3RhcnZlZCBzdGF0ZS5cbiAgICBjb25zdCBjZXhNaW5CYXNlQWxsb2MgPSBiUHJvai5jZXhcbiAgICBsZXQgW2RleE1pbkJhc2VBbGxvYywgdHJhbnNmZXJhYmxlQmFzZUFsbG9jLCBkZXhCYXNlRmVlUmVxXSA9IFtiUHJvai5ib29rLCAwLCAwXVxuICAgIC8vIE9ubHkgYWRkIGJvb2tpbmcgZmVlcyBpZiB0aGlzIGlzIHRoZSBmZWUgYXNzZXQuXG4gICAgaWYgKGJhc2VJRCA9PT0gYmFzZUZlZUlEKSBkZXhNaW5CYXNlQWxsb2MgKz0gYlByb2ouYm9va2luZ0ZlZXNcbiAgICAvLyBCYXNlIGFzc2V0IGlzIGEgdG9rZW4uXG4gICAgZWxzZSBkZXhCYXNlRmVlUmVxICs9IGJQcm9qLmJvb2tpbmdGZWVzICsgYlByb2ouc3dhcEZlZVJlc2VydmVzXG4gICAgLy8gSWYgd2UgY2FuIHJlYmFsYW5jZSwgdGhlIG9yZGVyIHJlc2VydmVzIGNvdWxkIHBvdGVudGlhbGx5IGJlIHdpdGhkcmF3bi5cbiAgICBpZiAoY2FuUmViYWxhbmNlKSB0cmFuc2ZlcmFibGVCYXNlQWxsb2MgKz0gYlByb2oub3JkZXJSZXNlcnZlc1xuICAgIC8vIElmIHdlIGNhbid0IHJlYmFsYW5jZSwgb3JkZXIgcmVzZXJ2ZXMgYXJlIHJlcXVpcmVkIGluIGRleCBiYWxhbmNlLlxuICAgIGVsc2UgZGV4TWluQmFzZUFsbG9jICs9IGJQcm9qLm9yZGVyUmVzZXJ2ZXNcbiAgICAvLyBIYW5kbGUgdGhlIHNwZWNpYWwgY2FzZSB3aGVyZSB0aGUgYmFzZSBhc3NldCBpdCB0aGUgcXVvdGUgYXNzZXQncyBmZWVcbiAgICAvLyBhc3NldC5cbiAgICBpZiAoYmFzZUlEID09PSBxdW90ZUZlZUlEKSB7XG4gICAgICBpZiAoY2FuUmViYWxhbmNlKSB0cmFuc2ZlcmFibGVCYXNlQWxsb2MgKz0gcVByb2ouYm9va2luZ0ZlZXMgKyBxUHJvai5zd2FwRmVlUmVzZXJ2ZXNcbiAgICAgIGVsc2UgZGV4TWluQmFzZUFsbG9jICs9IHFQcm9qLmJvb2tpbmdGZWVzICsgcVByb2ouc3dhcEZlZVJlc2VydmVzXG4gICAgfVxuXG4gICAgbGV0IFtkZXhNaW5RdW90ZUFsbG9jLCBjZXhNaW5RdW90ZUFsbG9jLCB0cmFuc2ZlcmFibGVRdW90ZUFsbG9jLCBkZXhRdW90ZUZlZVJlcV0gPSBbcVByb2ouYm9vaywgcVByb2ouY2V4LCAwLCAwXVxuICAgIGlmIChxdW90ZUlEID09PSBxdW90ZUZlZUlEKSBkZXhNaW5RdW90ZUFsbG9jICs9IHFQcm9qLmJvb2tpbmdGZWVzXG4gICAgZWxzZSBkZXhRdW90ZUZlZVJlcSArPSBxUHJvai5ib29raW5nRmVlcyArIHFQcm9qLnN3YXBGZWVSZXNlcnZlc1xuICAgIGlmIChjYW5SZWJhbGFuY2UpIHRyYW5zZmVyYWJsZVF1b3RlQWxsb2MgKz0gcVByb2oub3JkZXJSZXNlcnZlcyArIHFQcm9qLnNsaXBwYWdlQnVmZmVyXG4gICAgZWxzZSB7XG4gICAgICAvLyBUaGUgc2xpcHBhZ2UgcmVzZXJ2ZXMgcmVzZXJ2ZXMgc2hvdWxkIGJlIHNwbGl0IGJldHdlZW4gY2V4IGFuZCBkZXguXG4gICAgICBkZXhNaW5RdW90ZUFsbG9jICs9IHFQcm9qLm9yZGVyUmVzZXJ2ZXNcbiAgICAgIGNvbnN0IGJhc2lzID0gcVByb2ouYm9vayArIHFQcm9qLmNleCArIHFQcm9qLm9yZGVyUmVzZXJ2ZXNcbiAgICAgIGRleE1pblF1b3RlQWxsb2MgKz0gKHFQcm9qLmJvb2sgKyBxUHJvai5vcmRlclJlc2VydmVzKSAvIGJhc2lzICogcVByb2ouc2xpcHBhZ2VCdWZmZXJcbiAgICAgIGNleE1pblF1b3RlQWxsb2MgKz0gcVByb2ouY2V4IC8gYmFzaXMgKiBxUHJvai5zbGlwcGFnZUJ1ZmZlclxuICAgIH1cbiAgICBpZiAocXVvdGVJRCA9PT0gYmFzZUZlZUlEKSB7XG4gICAgICBpZiAoY2FuUmViYWxhbmNlKSB0cmFuc2ZlcmFibGVRdW90ZUFsbG9jICs9IGJQcm9qLmJvb2tpbmdGZWVzICsgYlByb2ouc3dhcEZlZVJlc2VydmVzXG4gICAgICBlbHNlIGRleE1pblF1b3RlQWxsb2MgKz0gYlByb2ouYm9va2luZ0ZlZXMgKyBiUHJvai5zd2FwRmVlUmVzZXJ2ZXNcbiAgICB9XG5cbiAgICBjb25zdCBkZXhCYXNlRnVuZGVkID0gZGV4QmFzZUF2YWlsID49IGRleE1pbkJhc2VBbGxvY1xuICAgIGNvbnN0IGNleEJhc2VGdW5kZWQgPSBjZXhCYXNlQXZhaWwgPj0gY2V4TWluQmFzZUFsbG9jXG4gICAgY29uc3QgZGV4UXVvdGVGdW5kZWQgPSBkZXhRdW90ZUF2YWlsID49IGRleE1pblF1b3RlQWxsb2NcbiAgICBjb25zdCBjZXhRdW90ZUZ1bmRlZCA9IGNleFF1b3RlQXZhaWwgPj0gY2V4TWluUXVvdGVBbGxvY1xuICAgIGNvbnN0IHRvdGFsQmFzZVJlcSA9IGRleE1pbkJhc2VBbGxvYyArIGNleE1pbkJhc2VBbGxvYyArIHRyYW5zZmVyYWJsZUJhc2VBbGxvY1xuICAgIGNvbnN0IHRvdGFsUXVvdGVSZXEgPSBkZXhNaW5RdW90ZUFsbG9jICsgY2V4TWluUXVvdGVBbGxvYyArIHRyYW5zZmVyYWJsZVF1b3RlQWxsb2NcbiAgICBjb25zdCBiYXNlRnVuZGVkQW5kQmFsYW5jZWQgPSBkZXhCYXNlRnVuZGVkICYmIGNleEJhc2VGdW5kZWQgJiYgYmFzZUF2YWlsID49IHRvdGFsQmFzZVJlcVxuICAgIGNvbnN0IHF1b3RlRnVuZGVkQW5kQmFsYW5jZWQgPSBkZXhRdW90ZUZ1bmRlZCAmJiBjZXhRdW90ZUZ1bmRlZCAmJiBxdW90ZUF2YWlsID49IHRvdGFsUXVvdGVSZXFcbiAgICBjb25zdCBiYXNlRmVlc0Z1bmRlZCA9IGRleEJhc2VGZWVBdmFpbCA+PSBkZXhCYXNlRmVlUmVxXG4gICAgY29uc3QgcXVvdGVGZWVzRnVuZGVkID0gZGV4UXVvdGVGZWVBdmFpbCA+PSBkZXhRdW90ZUZlZVJlcVxuXG4gICAgY29uc3QgZnVuZGVkQW5kQmFsYW5jZWQgPSBiYXNlRnVuZGVkQW5kQmFsYW5jZWQgJiYgcXVvdGVGdW5kZWRBbmRCYWxhbmNlZCAmJiBiYXNlRmVlc0Z1bmRlZCAmJiBxdW90ZUZlZXNGdW5kZWRcblxuICAgIC8vIEFyZSB3ZSBmdW5kZWQgYnV0IG5vdCBiYWxhbmNlZCwgYnV0IGFibGUgdG8gcmViYWxhbmNlIHdpdGggYSBjZXg/XG4gICAgbGV0IGZ1bmRlZEFuZE5vdEJhbGFuY2VkID0gIWZ1bmRlZEFuZEJhbGFuY2VkXG4gICAgaWYgKCFmdW5kZWRBbmRCYWxhbmNlZCkge1xuICAgICAgY29uc3Qgb3JkZXJzRnVuZGVkID0gYmFzZUF2YWlsID49IHRvdGFsQmFzZVJlcSAmJiBxdW90ZUF2YWlsID49IHRvdGFsUXVvdGVSZXFcbiAgICAgIGNvbnN0IGZlZXNGdW5kZWQgPSBiYXNlRmVlc0Z1bmRlZCAmJiBxdW90ZUZlZXNGdW5kZWRcbiAgICAgIGZ1bmRlZEFuZE5vdEJhbGFuY2VkID0gb3JkZXJzRnVuZGVkICYmIGZlZXNGdW5kZWQgJiYgY2FuUmViYWxhbmNlXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGJhc2U6IHtcbiAgICAgICAgZGV4OiB7XG4gICAgICAgICAgYXZhaWw6IGRleEJhc2VBdmFpbCxcbiAgICAgICAgICByZXE6IGRleE1pbkJhc2VBbGxvYyxcbiAgICAgICAgICBmdW5kZWQ6IGRleEJhc2VGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgY2V4OiB7XG4gICAgICAgICAgYXZhaWw6IGNleEJhc2VBdmFpbCxcbiAgICAgICAgICByZXE6IGNleE1pbkJhc2VBbGxvYyxcbiAgICAgICAgICBmdW5kZWQ6IGNleEJhc2VGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmZXJhYmxlOiB0cmFuc2ZlcmFibGVCYXNlQWxsb2MsXG4gICAgICAgIGZlZXM6IHtcbiAgICAgICAgICBhdmFpbDogZGV4QmFzZUZlZUF2YWlsLFxuICAgICAgICAgIHJlcTogZGV4QmFzZUZlZVJlcSxcbiAgICAgICAgICBmdW5kZWQ6IGJhc2VGZWVzRnVuZGVkXG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmRlZEFuZEJhbGFuY2VkOiBiYXNlRnVuZGVkQW5kQmFsYW5jZWQsXG4gICAgICAgIGZ1bmRlZEFuZE5vdEJhbGFuY2VkOiAhYmFzZUZ1bmRlZEFuZEJhbGFuY2VkICYmIGJhc2VBdmFpbCA+PSB0b3RhbEJhc2VSZXEgJiYgY2FuUmViYWxhbmNlXG4gICAgICB9LFxuICAgICAgcXVvdGU6IHtcbiAgICAgICAgZGV4OiB7XG4gICAgICAgICAgYXZhaWw6IGRleFF1b3RlQXZhaWwsXG4gICAgICAgICAgcmVxOiBkZXhNaW5RdW90ZUFsbG9jLFxuICAgICAgICAgIGZ1bmRlZDogZGV4UXVvdGVGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgY2V4OiB7XG4gICAgICAgICAgYXZhaWw6IGNleFF1b3RlQXZhaWwsXG4gICAgICAgICAgcmVxOiBjZXhNaW5RdW90ZUFsbG9jLFxuICAgICAgICAgIGZ1bmRlZDogY2V4UXVvdGVGdW5kZWRcbiAgICAgICAgfSxcbiAgICAgICAgdHJhbnNmZXJhYmxlOiB0cmFuc2ZlcmFibGVRdW90ZUFsbG9jLFxuICAgICAgICBmZWVzOiB7XG4gICAgICAgICAgYXZhaWw6IGRleFF1b3RlRmVlQXZhaWwsXG4gICAgICAgICAgcmVxOiBkZXhRdW90ZUZlZVJlcSxcbiAgICAgICAgICBmdW5kZWQ6IHF1b3RlRmVlc0Z1bmRlZFxuICAgICAgICB9LFxuICAgICAgICBmdW5kZWRBbmRCYWxhbmNlZDogcXVvdGVGdW5kZWRBbmRCYWxhbmNlZCxcbiAgICAgICAgZnVuZGVkQW5kTm90QmFsYW5jZWQ6ICFxdW90ZUZ1bmRlZEFuZEJhbGFuY2VkICYmIHF1b3RlQXZhaWwgPj0gdG90YWxRdW90ZVJlcSAmJiBjYW5SZWJhbGFuY2VcbiAgICAgIH0sXG4gICAgICBmdW5kZWRBbmRCYWxhbmNlZCxcbiAgICAgIGZ1bmRlZEFuZE5vdEJhbGFuY2VkLFxuICAgICAgc3RhcnZlZDogIWZ1bmRlZEFuZEJhbGFuY2VkICYmICFmdW5kZWRBbmROb3RCYWxhbmNlZFxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUnVubmluZ01hcmtldE1ha2VyRGlzcGxheSB7XG4gIGRpdjogUGFnZUVsZW1lbnRcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIG1rdDogQm90TWFya2V0XG4gIHN0YXJ0VGltZTogbnVtYmVyXG4gIHRpY2tlcjogYW55XG5cbiAgY29uc3RydWN0b3IgKGRpdjogUGFnZUVsZW1lbnQsIHBhZ2U6IHN0cmluZykge1xuICAgIHRoaXMuZGl2ID0gZGl2XG4gICAgdGhpcy5wYWdlID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgIERvYy5iaW5kKHRoaXMucGFnZS5zdG9wQnR0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zdG9wKCkpXG4gICAgRG9jLmJpbmQodGhpcy5wYWdlLnJ1bkxvZ3NCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IG1rdDogeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QgfSwgc3RhcnRUaW1lIH0gPSB0aGlzXG4gICAgICBhcHAoKS5sb2FkUGFnZSgnbW1sb2dzJywgeyBiYXNlSUQsIHF1b3RlSUQsIGhvc3QsIHN0YXJ0VGltZSwgcmV0dXJuUGFnZTogcGFnZSB9KVxuICAgIH0pXG4gIH1cblxuICBhc3luYyBzdG9wICgpIHtcbiAgICBjb25zdCB7IHBhZ2UsIG1rdDogeyBob3N0LCBiYXNlSUQsIHF1b3RlSUQgfSB9ID0gdGhpc1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5zdG9wQnR0bilcbiAgICBhd2FpdCBNTS5zdG9wQm90KHsgaG9zdCwgYmFzZUlEOiBiYXNlSUQsIHF1b3RlSUQ6IHF1b3RlSUQgfSlcbiAgICBsb2FkZWQoKVxuICB9XG5cbiAgYXN5bmMgc2V0TWFya2V0IChob3N0OiBzdHJpbmcsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIpIHtcbiAgICBjb25zdCBib3RTdGF0dXMgPSBhcHAoKS5tbVN0YXR1cy5ib3RzLmZpbmQoKHsgY29uZmlnOiBjIH06IE1NQm90U3RhdHVzKSA9PiBjLmJhc2VJRCA9PT0gYmFzZUlEICYmIGMucXVvdGVJRCA9PT0gcXVvdGVJRCAmJiBjLmhvc3QgPT09IGhvc3QpXG4gICAgaWYgKCFib3RTdGF0dXMpIHJldHVyblxuICAgIGNvbnN0IG1rdCA9IG5ldyBCb3RNYXJrZXQoYm90U3RhdHVzLmNvbmZpZylcbiAgICBhd2FpdCBta3QuaW5pdGlhbGl6ZSh7fSlcbiAgICB0aGlzLnNldEJvdE1hcmtldChta3QpXG4gIH1cblxuICBhc3luYyBzZXRCb3RNYXJrZXQgKG1rdDogQm90TWFya2V0KSB7XG4gICAgdGhpcy5ta3QgPSBta3RcbiAgICBjb25zdCB7XG4gICAgICBwYWdlLCBkaXYsIG1rdDoge1xuICAgICAgICBob3N0LCBiYXNlSUQsIHF1b3RlSUQsIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCwgY2V4TmFtZSwgYmFzZUZlZVN5bWJvbCxcbiAgICAgICAgcXVvdGVGZWVTeW1ib2wsIGJhc2VGZWVUaWNrZXIsIHF1b3RlRmVlVGlja2VyLCBjZmcsIGJhc2VGYWN0b3IsIHF1b3RlRmFjdG9yXG4gICAgICB9XG4gICAgfSA9IHRoaXNcbiAgICBzZXRNYXJrZXRFbGVtZW50cyhkaXYsIGJhc2VJRCwgcXVvdGVJRCwgaG9zdClcbiAgICBEb2Muc2V0VmlzKGJhc2VGZWVJRCAhPT0gYmFzZUlELCBwYWdlLmJhc2VGZWVSZXNlcnZlc0JveClcbiAgICBEb2Muc2V0VmlzKHF1b3RlRmVlSUQgIT09IHF1b3RlSUQsIHBhZ2UucXVvdGVGZWVSZXNlcnZlc0JveClcbiAgICBEb2Muc2V0VmlzKEJvb2xlYW4oY2V4TmFtZSksIC4uLkRvYy5hcHBseVNlbGVjdG9yKGRpdiwgJ1tkYXRhLWNleC1zaG93XScpKVxuICAgIHBhZ2UuYmFzZUZlZUxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGJhc2VGZWVTeW1ib2wpXG4gICAgcGFnZS5iYXNlRmVlVGlja2VyLnRleHRDb250ZW50ID0gYmFzZUZlZVRpY2tlclxuICAgIHBhZ2UucXVvdGVGZWVMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChxdW90ZUZlZVN5bWJvbClcbiAgICBwYWdlLnF1b3RlRmVlVGlja2VyLnRleHRDb250ZW50ID0gcXVvdGVGZWVUaWNrZXJcblxuICAgIGNvbnN0IGJhc2ljQ2ZnID0gY2ZnLmJhc2ljTWFya2V0TWFraW5nQ29uZmlnXG4gICAgY29uc3QgZ2FwU3RyYXRlZ3kgPSBiYXNpY0NmZz8uZ2FwU3RyYXRlZ3kgPz8gR2FwU3RyYXRlZ3lQZXJjZW50XG4gICAgbGV0IGdhcEZhY3RvciA9IGNmZy5hcmJNYXJrZXRNYWtpbmdDb25maWc/LnByb2ZpdCA/PyBjZmcuc2ltcGxlQXJiQ29uZmlnPy5wcm9maXRUcmlnZ2VyID8/IDBcbiAgICBpZiAoYmFzaWNDZmcpIHtcbiAgICAgIGNvbnN0IGJ1eXMgPSBbLi4uYmFzaWNDZmcuYnV5UGxhY2VtZW50c10uc29ydCgoYTogT3JkZXJQbGFjZW1lbnQsIGI6IE9yZGVyUGxhY2VtZW50KSA9PiBhLmdhcEZhY3RvciAtIGIuZ2FwRmFjdG9yKVxuICAgICAgY29uc3Qgc2VsbHMgPSBbLi4uYmFzaWNDZmcuc2VsbFBsYWNlbWVudHNdLnNvcnQoKGE6IE9yZGVyUGxhY2VtZW50LCBiOiBPcmRlclBsYWNlbWVudCkgPT4gYS5nYXBGYWN0b3IgLSBiLmdhcEZhY3RvcilcbiAgICAgIGlmIChidXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgaWYgKHNlbGxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBnYXBGYWN0b3IgPSAoYnV5c1swXS5nYXBGYWN0b3IgKyBzZWxsc1swXS5nYXBGYWN0b3IpIC8gMlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGdhcEZhY3RvciA9IGJ1eXNbMF0uZ2FwRmFjdG9yXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBnYXBGYWN0b3IgPSBzZWxsc1swXS5nYXBGYWN0b3JcbiAgICB9XG4gICAgRG9jLmhpZGUocGFnZS5wcm9maXRMYWJlbCwgcGFnZS5nYXBMYWJlbCwgcGFnZS5tdWx0aXBsaWVyTGFiZWwsIHBhZ2UucHJvZml0VW5pdCwgcGFnZS5nYXBVbml0LCBwYWdlLm11bHRpcGxpZXJVbml0KVxuICAgIHN3aXRjaCAoZ2FwU3RyYXRlZ3kpIHtcbiAgICAgIGNhc2UgR2FwU3RyYXRlZ3lQZXJjZW50OlxuICAgICAgY2FzZSBHYXBTdHJhdGVneVBlcmNlbnRQbHVzOlxuICAgICAgICBEb2Muc2hvdyhwYWdlLnByb2ZpdExhYmVsLCBwYWdlLnByb2ZpdFVuaXQpXG4gICAgICAgIHBhZ2UuZ2FwRmFjdG9yLnRleHRDb250ZW50ID0gKGdhcEZhY3RvciAqIDEwMCkudG9GaXhlZCgyKVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBHYXBTdHJhdGVneU11bHRpcGxpZXI6XG4gICAgICAgIERvYy5zaG93KHBhZ2UubXVsdGlwbGllckxhYmVsLCBwYWdlLm11bHRpcGxpZXJVbml0KVxuICAgICAgICBwYWdlLmdhcEZhY3Rvci50ZXh0Q29udGVudCA9IChnYXBGYWN0b3IgKiAxMDApLnRvRml4ZWQoMilcbiAgICAgICAgYnJlYWtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHBhZ2UuZ2FwRmFjdG9yLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGdhcEZhY3RvciAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgKiBiYXNlRmFjdG9yIC8gcXVvdGVGYWN0b3IpXG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGUoKVxuICAgIHRoaXMucmVhZEJvb2soKVxuICB9XG5cbiAgaGFuZGxlQmFsYW5jZU5vdGUgKG46IEJhbGFuY2VOb3RlKSB7XG4gICAgaWYgKCF0aGlzLm1rdCkgcmV0dXJuXG4gICAgY29uc3QgeyBiYXNlSUQsIHF1b3RlSUQsIGJhc2VGZWVJRCwgcXVvdGVGZWVJRCB9ID0gdGhpcy5ta3RcbiAgICBpZiAobi5hc3NldElEICE9PSBiYXNlSUQgJiYgbi5hc3NldElEICE9PSBiYXNlRmVlSUQgJiYgbi5hc3NldElEICE9PSBxdW90ZUlEICYmIG4uYXNzZXRJRCAhPT0gcXVvdGVGZWVJRCkgcmV0dXJuXG4gICAgdGhpcy51cGRhdGUoKVxuICB9XG5cbiAgc2V0VGlja2VyICgpIHtcbiAgICB0aGlzLnBhZ2UucnVuVGltZS50ZXh0Q29udGVudCA9IERvYy5obXNTaW5jZSh0aGlzLnN0YXJ0VGltZSlcbiAgfVxuXG4gIHVwZGF0ZSAoKSB7XG4gICAgY29uc3Qge1xuICAgICAgZGl2LCBwYWdlLCBta3Q6IHtcbiAgICAgICAgYmFzZUlELCBxdW90ZUlELCBiYXNlRmVlSUQsIHF1b3RlRmVlSUQsIGJhc2VGYWN0b3IsIHF1b3RlRmFjdG9yLCBiYXNlRmVlRmFjdG9yLFxuICAgICAgICBxdW90ZUZlZUZhY3RvciwgbWFya2V0UmVwb3J0OiB7IGJhc2VGaWF0UmF0ZSwgcXVvdGVGaWF0UmF0ZSB9XG4gICAgICB9XG4gICAgfSA9IHRoaXNcbiAgICAvLyBHZXQgZnJlc2ggc3RhdHNcbiAgICBjb25zdCB7IGJvdENmZzogeyBjZXhOYW1lLCBiYXNpY01hcmtldE1ha2luZ0NvbmZpZzogYm1tQ2ZnIH0sIHJ1blN0YXRzIH0gPSB0aGlzLm1rdC5zdGF0dXMoKVxuICAgIERvYy5oaWRlKHBhZ2Uuc3RhdHMsIHBhZ2UuY2V4Um93LCBwYWdlLnBlbmRpbmdEZXBvc2l0Qm94LCBwYWdlLnBlbmRpbmdXaXRoZHJhd2FsQm94KVxuICAgIGlmICghcnVuU3RhdHMpIHtcbiAgICAgIGlmICh0aGlzLnRpY2tlcikge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGlja2VyKVxuICAgICAgICB0aGlzLnRpY2tlciA9IHVuZGVmaW5lZFxuICAgICAgfVxuICAgICAgcmV0dXJuXG4gICAgfSBlbHNlIGlmICghdGhpcy50aWNrZXIpIHtcbiAgICAgIHRoaXMuc3RhcnRUaW1lID0gcnVuU3RhdHMuc3RhcnRUaW1lXG4gICAgICB0aGlzLnNldFRpY2tlcigpXG4gICAgICB0aGlzLnRpY2tlciA9IHNldEludGVydmFsKCgpID0+IHRoaXMuc2V0VGlja2VyKCksIDEwMDApXG4gICAgfVxuXG4gICAgRG9jLnNob3cocGFnZS5zdGF0cylcbiAgICBzZXRTaWduZWRWYWx1ZShydW5TdGF0cy5wcm9maXRMb3NzLnByb2ZpdFJhdGlvICogMTAwLCBwYWdlLnByb2ZpdCwgcGFnZS5wcm9maXRTaWduLCAyKVxuICAgIHNldFNpZ25lZFZhbHVlKHJ1blN0YXRzLnByb2ZpdExvc3MucHJvZml0LCBwYWdlLnByb2ZpdExvc3MsIHBhZ2UucGxTaWduLCAyKVxuICAgIHRoaXMuc3RhcnRUaW1lID0gcnVuU3RhdHMuc3RhcnRUaW1lXG5cbiAgICBjb25zdCBzdW1tZWRCYWxhbmNlID0gKGI6IEJvdEJhbGFuY2UpID0+IHtcbiAgICAgIGlmICghYikgcmV0dXJuIDBcbiAgICAgIHJldHVybiBiLmF2YWlsYWJsZSArIGIubG9ja2VkICsgYi5wZW5kaW5nICsgYi5yZXNlcnZlZFxuICAgIH1cblxuICAgIGNvbnN0IGRleEJhc2VJbnYgPSBzdW1tZWRCYWxhbmNlKHJ1blN0YXRzLmRleEJhbGFuY2VzW2Jhc2VJRF0pIC8gYmFzZUZhY3RvclxuICAgIHBhZ2Uud2FsbGV0QmFzZUludmVudG9yeS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhkZXhCYXNlSW52KVxuICAgIHBhZ2Uud2FsbGV0QmFzZUludkZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoZGV4QmFzZUludiAqIGJhc2VGaWF0UmF0ZSwgMilcbiAgICBjb25zdCBkZXhRdW90ZUludiA9IHN1bW1lZEJhbGFuY2UocnVuU3RhdHMuZGV4QmFsYW5jZXNbcXVvdGVJRF0pIC8gcXVvdGVGYWN0b3JcbiAgICBwYWdlLndhbGxldFF1b3RlSW52ZW50b3J5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGRleFF1b3RlSW52KVxuICAgIHBhZ2Uud2FsbGV0UXVvdGVJbnZGaWF0LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGRleFF1b3RlSW52ICogcXVvdGVGaWF0UmF0ZSwgMilcblxuICAgIERvYy5zZXRWaXMoY2V4TmFtZSwgcGFnZS5jZXhSb3cpXG4gICAgaWYgKGNleE5hbWUpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UucGVuZGluZ0RlcG9zaXRCb3gsIHBhZ2UucGVuZGluZ1dpdGhkcmF3YWxCb3gpXG4gICAgICBzZXRDZXhFbGVtZW50cyhkaXYsIGNleE5hbWUpXG4gICAgICBjb25zdCBjZXhCYXNlSW52ID0gc3VtbWVkQmFsYW5jZShydW5TdGF0cy5jZXhCYWxhbmNlc1tiYXNlSURdKSAvIGJhc2VGYWN0b3JcbiAgICAgIHBhZ2UuY2V4QmFzZUludmVudG9yeS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhjZXhCYXNlSW52KVxuICAgICAgcGFnZS5jZXhCYXNlSW52ZW50b3J5RmlhdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhjZXhCYXNlSW52ICogYmFzZUZpYXRSYXRlLCAyKVxuICAgICAgY29uc3QgY2V4UXVvdGVJbnYgPSBzdW1tZWRCYWxhbmNlKHJ1blN0YXRzLmNleEJhbGFuY2VzW3F1b3RlSURdKSAvIHF1b3RlRmFjdG9yXG4gICAgICBwYWdlLmNleFF1b3RlSW52ZW50b3J5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGNleFF1b3RlSW52KVxuICAgICAgcGFnZS5jZXhRdW90ZUludmVudG9yeUZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoY2V4UXVvdGVJbnYgKiBxdW90ZUZpYXRSYXRlLCAyKVxuICAgIH1cblxuICAgIGlmIChiYXNlRmVlSUQgIT09IGJhc2VJRCkge1xuICAgICAgY29uc3QgZmVlQmFsYW5jZSA9IHN1bW1lZEJhbGFuY2UocnVuU3RhdHMuZGV4QmFsYW5jZXNbYmFzZUZlZUlEXSkgLyBiYXNlRmVlRmFjdG9yXG4gICAgICBwYWdlLmJhc2VGZWVSZXNlcnZlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVCYWxhbmNlKVxuICAgIH1cbiAgICBpZiAocXVvdGVGZWVJRCAhPT0gcXVvdGVJRCkge1xuICAgICAgY29uc3QgZmVlQmFsYW5jZSA9IHN1bW1lZEJhbGFuY2UocnVuU3RhdHMuZGV4QmFsYW5jZXNbcXVvdGVGZWVJRF0pIC8gcXVvdGVGZWVGYWN0b3JcbiAgICAgIHBhZ2UucXVvdGVGZWVSZXNlcnZlcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVCYWxhbmNlKVxuICAgIH1cblxuICAgIHBhZ2UucGVuZGluZ0RlcG9zaXRzLnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQocnVuU3RhdHMucGVuZGluZ0RlcG9zaXRzKSlcbiAgICBwYWdlLnBlbmRpbmdXaXRoZHJhd2Fscy50ZXh0Q29udGVudCA9IFN0cmluZyhNYXRoLnJvdW5kKHJ1blN0YXRzLnBlbmRpbmdXaXRoZHJhd2FscykpXG4gICAgcGFnZS5jb21wbGV0ZWRNYXRjaGVzLnRleHRDb250ZW50ID0gU3RyaW5nKE1hdGgucm91bmQocnVuU3RhdHMuY29tcGxldGVkTWF0Y2hlcykpXG4gICAgRG9jLnNldFZpcyhydW5TdGF0cy50cmFkZWRVU0QsIHBhZ2UudHJhZGVkVVNEQm94KVxuICAgIGlmIChydW5TdGF0cy50cmFkZWRVU0QgPiAwKSBwYWdlLnRyYWRlZFVTRC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhydW5TdGF0cy50cmFkZWRVU0QpXG4gICAgRG9jLnNldFZpcyhiYXNlRmlhdFJhdGUsIHBhZ2Uucm91bmRUcmlwRmVlc0JveClcbiAgICBpZiAoYmFzZUZpYXRSYXRlKSBwYWdlLnJvdW5kVHJpcEZlZXNVU0QudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoKHJ1blN0YXRzLmZlZUdhcD8ucm91bmRUcmlwRmVlcyAvIGJhc2VGYWN0b3IgKiBiYXNlRmlhdFJhdGUpIHx8IDApXG4gICAgY29uc3QgYmFzaXNQcmljZSA9IGFwcCgpLmNvbnZlbnRpb25hbFJhdGUoYmFzZUlELCBxdW90ZUlELCBydW5TdGF0cy5mZWVHYXA/LmJhc2lzUHJpY2UgfHwgMClcbiAgICBwYWdlLmJhc2lzUHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3MoYmFzaXNQcmljZSlcblxuICAgIGNvbnN0IGRpc3BsYXlGZWVHYXAgPSAhYm1tQ2ZnIHx8IGJtbUNmZy5nYXBTdHJhdGVneSA9PT0gR2FwU3RyYXRlZ3lBYnNvbHV0ZVBsdXMgfHwgYm1tQ2ZnLmdhcFN0cmF0ZWd5ID09PSBHYXBTdHJhdGVneVBlcmNlbnRQbHVzXG4gICAgRG9jLnNldFZpcyhkaXNwbGF5RmVlR2FwLCBwYWdlLmZlZUdhcEJveClcbiAgICBpZiAoZGlzcGxheUZlZUdhcCkge1xuICAgICAgY29uc3QgZmVlR2FwID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIHJ1blN0YXRzLmZlZUdhcD8uZmVlR2FwIHx8IDApXG4gICAgICBwYWdlLmZlZUdhcC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhmZWVHYXApXG4gICAgICBwYWdlLmZlZUdhcFBjdC50ZXh0Q29udGVudCA9IChmZWVHYXAgLyBiYXNpc1ByaWNlICogMTAwIHx8IDApLnRvRml4ZWQoMilcbiAgICB9XG4gICAgRG9jLnNldFZpcyhibW1DZmcsIHBhZ2UuZ2FwU3RyYXRlZ3lCb3gpXG4gICAgaWYgKGJtbUNmZykgcGFnZS5nYXBTdHJhdGVneS50ZXh0Q29udGVudCA9IGJtbUNmZy5nYXBTdHJhdGVneVxuXG4gICAgY29uc3QgcmVtb3RlR2FwID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZShiYXNlSUQsIHF1b3RlSUQsIHJ1blN0YXRzLmZlZUdhcD8ucmVtb3RlR2FwIHx8IDApXG4gICAgRG9jLnNldFZpcyhyZW1vdGVHYXAsIHBhZ2UucmVtb3RlR2FwQm94KVxuICAgIGlmIChyZW1vdGVHYXApIHtcbiAgICAgIHBhZ2UucmVtb3RlR2FwLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHJlbW90ZUdhcClcbiAgICAgIHBhZ2UucmVtb3RlR2FwUGN0LnRleHRDb250ZW50ID0gKHJlbW90ZUdhcCAvIGJhc2lzUHJpY2UgKiAxMDAgfHwgMCkudG9GaXhlZCgyKVxuICAgIH1cbiAgfVxuXG4gIHJlYWRCb29rICgpIHtcbiAgICBpZiAoIXRoaXMubWt0KSByZXR1cm5cbiAgICBjb25zdCB7IHBhZ2UsIG1rdDogeyBob3N0LCBta3RJRCB9IH0gPSB0aGlzXG4gICAgY29uc3Qgb3JkZXJzID0gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdLm1hcmtldHNbbWt0SURdLm9yZGVycyB8fCBbXVxuICAgIHBhZ2UubkJvb2tlZE9yZGVycy50ZXh0Q29udGVudCA9IFN0cmluZyhvcmRlcnMuZmlsdGVyKChvcmQ6IE9yZGVyKSA9PiBvcmQuc3RhdHVzID09PSBPcmRlclV0aWwuU3RhdHVzQm9va2VkKS5sZW5ndGgpXG4gIH1cbn1cblxuZnVuY3Rpb24gc2V0U2lnbmVkVmFsdWUgKHY6IG51bWJlciwgdkVsOiBQYWdlRWxlbWVudCwgc2lnbkVsOiBQYWdlRWxlbWVudCwgbWF4RGVjaW1hbHM/OiBudW1iZXIpIHtcbiAgdkVsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHYsIG1heERlY2ltYWxzKVxuICBzaWduRWwuY2xhc3NMaXN0LnRvZ2dsZSgnaWNvLXBsdXMnLCB2ID4gMClcbiAgc2lnbkVsLmNsYXNzTGlzdC50b2dnbGUoJ3RleHQtZ29vZCcsIHYgPiAwKVxuICAvLyBzaWduRWwuY2xhc3NMaXN0LnRvZ2dsZSgnaWNvLW1pbnVzJywgdiA8IDApXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmZWVzQW5kQ29tbWl0IChcbiAgYmFzZUlEOiBudW1iZXIsIHF1b3RlSUQ6IG51bWJlciwgYmFzZUZlZXM6IExvdEZlZVJhbmdlLCBxdW90ZUZlZXM6IExvdEZlZVJhbmdlLFxuICBsb3RTaXplOiBudW1iZXIsIGJhc2VMb3RzOiBudW1iZXIsIHF1b3RlTG90czogbnVtYmVyLCBiYXNlRmVlSUQ6IG51bWJlciwgcXVvdGVGZWVJRDogbnVtYmVyLFxuICBiYXNlSXNBY2NvdW50TG9ja2VyOiBib29sZWFuLCBxdW90ZUlzQWNjb3VudExvY2tlcjogYm9vbGVhbiwgYmFzZU9yZGVyUmVzZXJ2ZXNGYWN0b3I6IG51bWJlcixcbiAgcXVvdGVPcmRlclJlc2VydmVzRmFjdG9yOiBudW1iZXJcbikge1xuICBjb25zdCBxdW90ZUxvdCA9IGNhbGN1bGF0ZVF1b3RlTG90KGxvdFNpemUsIGJhc2VJRCwgcXVvdGVJRClcbiAgY29uc3QgW2NleEJhc2VMb3RzLCBjZXhRdW90ZUxvdHNdID0gW3F1b3RlTG90cywgYmFzZUxvdHNdXG4gIGNvbnN0IGNvbW1pdCA9IHtcbiAgICBkZXg6IHtcbiAgICAgIGJhc2U6IHtcbiAgICAgICAgbG90czogYmFzZUxvdHMsXG4gICAgICAgIHZhbDogYmFzZUxvdHMgKiBsb3RTaXplXG4gICAgICB9LFxuICAgICAgcXVvdGU6IHtcbiAgICAgICAgbG90czogcXVvdGVMb3RzLFxuICAgICAgICB2YWw6IHF1b3RlTG90cyAqIHF1b3RlTG90XG4gICAgICB9XG4gICAgfSxcbiAgICBjZXg6IHtcbiAgICAgIGJhc2U6IHtcbiAgICAgICAgbG90czogY2V4QmFzZUxvdHMsXG4gICAgICAgIHZhbDogY2V4QmFzZUxvdHMgKiBsb3RTaXplXG4gICAgICB9LFxuICAgICAgcXVvdGU6IHtcbiAgICAgICAgbG90czogY2V4UXVvdGVMb3RzLFxuICAgICAgICB2YWw6IGNleFF1b3RlTG90cyAqIHF1b3RlTG90XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbGV0IGJhc2VUb2tlbkZlZXNQZXJTd2FwID0gMFxuICBsZXQgYmFzZVJlZGVlbVJlc2VydmVzUGVyTG90ID0gMFxuICBpZiAoYmFzZUlEICE9PSBiYXNlRmVlSUQpIHsgLy8gdG9rZW5cbiAgICBiYXNlVG9rZW5GZWVzUGVyU3dhcCArPSBiYXNlRmVlcy5lc3RpbWF0ZWQuc3dhcFxuICAgIGlmIChiYXNlRmVlSUQgPT09IHF1b3RlRmVlSUQpIGJhc2VUb2tlbkZlZXNQZXJTd2FwICs9IHF1b3RlRmVlcy5lc3RpbWF0ZWQucmVkZWVtXG4gIH1cbiAgbGV0IGJhc2VCb29raW5nRmVlc1BlckxvdCA9IGJhc2VGZWVzLm1heC5zd2FwXG4gIGlmIChiYXNlSUQgPT09IHF1b3RlRmVlSUQpIGJhc2VCb29raW5nRmVlc1BlckxvdCArPSBxdW90ZUZlZXMubWF4LnJlZGVlbVxuICBpZiAoYmFzZUlzQWNjb3VudExvY2tlcikge1xuICAgIGJhc2VCb29raW5nRmVlc1BlckxvdCArPSBiYXNlRmVlcy5tYXgucmVmdW5kXG4gICAgaWYgKCFxdW90ZUlzQWNjb3VudExvY2tlciAmJiBiYXNlRmVlSUQgIT09IHF1b3RlRmVlSUQpIGJhc2VSZWRlZW1SZXNlcnZlc1BlckxvdCA9IGJhc2VGZWVzLm1heC5yZWRlZW1cbiAgfVxuXG4gIGxldCBxdW90ZVRva2VuRmVlc1BlclN3YXAgPSAwXG4gIGxldCBxdW90ZVJlZGVlbVJlc2VydmVzUGVyTG90ID0gMFxuICBpZiAocXVvdGVJRCAhPT0gcXVvdGVGZWVJRCkge1xuICAgIHF1b3RlVG9rZW5GZWVzUGVyU3dhcCArPSBxdW90ZUZlZXMuZXN0aW1hdGVkLnN3YXBcbiAgICBpZiAocXVvdGVGZWVJRCA9PT0gYmFzZUZlZUlEKSBxdW90ZVRva2VuRmVlc1BlclN3YXAgKz0gYmFzZUZlZXMuZXN0aW1hdGVkLnJlZGVlbVxuICB9XG4gIGxldCBxdW90ZUJvb2tpbmdGZWVzUGVyTG90ID0gcXVvdGVGZWVzLm1heC5zd2FwXG4gIGlmIChxdW90ZUlEID09PSBiYXNlRmVlSUQpIHF1b3RlQm9va2luZ0ZlZXNQZXJMb3QgKz0gYmFzZUZlZXMubWF4LnJlZGVlbVxuICBpZiAocXVvdGVJc0FjY291bnRMb2NrZXIpIHtcbiAgICBxdW90ZUJvb2tpbmdGZWVzUGVyTG90ICs9IHF1b3RlRmVlcy5tYXgucmVmdW5kXG4gICAgaWYgKCFiYXNlSXNBY2NvdW50TG9ja2VyICYmIHF1b3RlRmVlSUQgIT09IGJhc2VGZWVJRCkgcXVvdGVSZWRlZW1SZXNlcnZlc1BlckxvdCA9IHF1b3RlRmVlcy5tYXgucmVkZWVtXG4gIH1cblxuICBjb25zdCBiYXNlUmVzZXJ2ZXNGYWN0b3IgPSAxICsgYmFzZU9yZGVyUmVzZXJ2ZXNGYWN0b3JcbiAgY29uc3QgcXVvdGVSZXNlcnZlc0ZhY3RvciA9IDEgKyBxdW90ZU9yZGVyUmVzZXJ2ZXNGYWN0b3JcblxuICBjb25zdCBiYXNlQm9va2luZ0ZlZXMgPSAoYmFzZUJvb2tpbmdGZWVzUGVyTG90ICogYmFzZUxvdHMpICogYmFzZVJlc2VydmVzRmFjdG9yXG4gIGNvbnN0IGJhc2VSZWRlZW1GZWVzID0gKGJhc2VSZWRlZW1SZXNlcnZlc1BlckxvdCAqIHF1b3RlTG90cykgKiBxdW90ZVJlc2VydmVzRmFjdG9yXG4gIGNvbnN0IHF1b3RlQm9va2luZ0ZlZXMgPSAocXVvdGVCb29raW5nRmVlc1BlckxvdCAqIHF1b3RlTG90cykgKiBxdW90ZVJlc2VydmVzRmFjdG9yXG4gIGNvbnN0IHF1b3RlUmVkZWVtRmVlcyA9IChxdW90ZVJlZGVlbVJlc2VydmVzUGVyTG90ICogYmFzZUxvdHMpICogYmFzZVJlc2VydmVzRmFjdG9yXG5cbiAgY29uc3QgZmVlczogQm9va2luZ0ZlZXMgPSB7XG4gICAgYmFzZToge1xuICAgICAgLi4uYmFzZUZlZXMsXG4gICAgICBib29raW5nRmVlc1BlckxvdDogYmFzZUJvb2tpbmdGZWVzUGVyTG90LFxuICAgICAgYm9va2luZ0ZlZXNQZXJDb3VudGVyTG90OiBiYXNlUmVkZWVtUmVzZXJ2ZXNQZXJMb3QsXG4gICAgICBib29raW5nRmVlczogYmFzZUJvb2tpbmdGZWVzICsgYmFzZVJlZGVlbUZlZXMsXG4gICAgICBzd2FwUmVzZXJ2ZXNGYWN0b3I6IGJhc2VSZXNlcnZlc0ZhY3RvcixcbiAgICAgIHJlZGVlbVJlc2VydmVzRmFjdG9yOiBxdW90ZVJlc2VydmVzRmFjdG9yLFxuICAgICAgdG9rZW5GZWVzUGVyU3dhcDogYmFzZVRva2VuRmVlc1BlclN3YXBcbiAgICB9LFxuICAgIHF1b3RlOiB7XG4gICAgICAuLi5xdW90ZUZlZXMsXG4gICAgICBib29raW5nRmVlc1BlckxvdDogcXVvdGVCb29raW5nRmVlc1BlckxvdCxcbiAgICAgIGJvb2tpbmdGZWVzUGVyQ291bnRlckxvdDogcXVvdGVSZWRlZW1SZXNlcnZlc1BlckxvdCxcbiAgICAgIGJvb2tpbmdGZWVzOiBxdW90ZUJvb2tpbmdGZWVzICsgcXVvdGVSZWRlZW1GZWVzLFxuICAgICAgc3dhcFJlc2VydmVzRmFjdG9yOiBxdW90ZVJlc2VydmVzRmFjdG9yLFxuICAgICAgcmVkZWVtUmVzZXJ2ZXNGYWN0b3I6IGJhc2VSZXNlcnZlc0ZhY3RvcixcbiAgICAgIHRva2VuRmVlc1BlclN3YXA6IHF1b3RlVG9rZW5GZWVzUGVyU3dhcFxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IGNvbW1pdCwgZmVlcyB9XG59XG4iLCJpbXBvcnQgeyBDb3JlTm90ZSwgUGFnZUVsZW1lbnQgfSBmcm9tICcuL3JlZ2lzdHJ5J1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQgU3RhdGUgZnJvbSAnLi9zdGF0ZSdcbmltcG9ydCB7IHNldENvaW5IcmVmIH0gZnJvbSAnLi9jb2luZXhwbG9yZXJzJ1xuaW1wb3J0IERvYyBmcm9tICcuL2RvYydcblxuZXhwb3J0IGNvbnN0IElHTk9SRSA9IDBcbmV4cG9ydCBjb25zdCBEQVRBID0gMVxuZXhwb3J0IGNvbnN0IFBPS0UgPSAyXG5leHBvcnQgY29uc3QgU1VDQ0VTUyA9IDNcbmV4cG9ydCBjb25zdCBXQVJOSU5HID0gNFxuZXhwb3J0IGNvbnN0IEVSUk9SID0gNVxuXG4vKlxuICogbWFrZSBjb25zdHJ1Y3RzIGEgbmV3IG5vdGlmaWNhdGlvbi4gVGhlIG5vdGlmaWNhdGlvbiBzdHJ1Y3R1cmUgaXMgYSBtaXJyb3Igb2ZcbiAqIHRoZSBzdHJ1Y3R1cmUgb2Ygbm90aWZpY2F0aW9ucyBzZW50IGZyb20gdGhlIHdlYiBzZXJ2ZXIuXG4gKiBOT1RFOiBJJ20gaG9waW5nIHRvIG1ha2UgdGhpcyBmdW5jdGlvbiBvYnNvbGV0ZSwgc2luY2UgZXJyb3JzIGdlbmVyYXRlZCBpblxuICogamF2YXNjcmlwdCBzaG91bGQgdXN1YWxseSBiZSBkaXNwbGF5ZWQvY2FjaGVkIHNvbWV3aGVyZSBiZXR0ZXIuIEZvciBleGFtcGxlLFxuICogaWYgdGhlIGVycm9yIGlzIGdlbmVyYXRlZCBkdXJpbmcgc3VibWlzc2lvbiBvZiBhIGZvcm0sIHRoZSBlcnJvciBzaG91bGQgYmVcbiAqIGRpc3BsYXllZCBvbiBvciBuZWFyIHRoZSBmb3JtIGl0c2VsZiwgbm90IGluIHRoZSBub3RpZmljYXRpb25zLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWFrZSAoc3ViamVjdDogc3RyaW5nLCBkZXRhaWxzOiBzdHJpbmcsIHNldmVyaXR5OiBudW1iZXIpOiBDb3JlTm90ZSB7XG4gIHJldHVybiB7XG4gICAgc3ViamVjdDogc3ViamVjdCxcbiAgICBkZXRhaWxzOiBkZXRhaWxzLFxuICAgIHNldmVyaXR5OiBzZXZlcml0eSxcbiAgICBzdGFtcDogbmV3IERhdGUoKS5nZXRUaW1lKCksXG4gICAgYWNrZWQ6IGZhbHNlLFxuICAgIHR5cGU6ICdpbnRlcm5hbCcsXG4gICAgdG9waWM6ICdpbnRlcm5hbCcsXG4gICAgaWQ6ICcnXG4gIH1cbn1cblxuY29uc3QgTm90ZVR5cGVPcmRlciA9ICdvcmRlcidcbmNvbnN0IE5vdGVUeXBlTWF0Y2ggPSAnbWF0Y2gnXG5jb25zdCBOb3RlVHlwZUJvbmRQb3N0ID0gJ2JvbmRwb3N0J1xuY29uc3QgTm90ZVR5cGVDb25uRXZlbnQgPSAnY29ubidcblxudHlwZSBEZXNrdG9wTnRmblNldHRpbmdMYWJlbCA9IHtcbiAgW3g6IHN0cmluZ106IHN0cmluZ1xufVxuXG5leHBvcnQgdHlwZSBEZXNrdG9wTnRmblNldHRpbmcgPSB7XG4gIFt4OiBzdHJpbmddOiBib29sZWFuXG59XG5cbmZ1bmN0aW9uIGRlc2t0b3BOdGZuU2V0dGluZ3NLZXkgKCk6IHN0cmluZyB7XG4gIHJldHVybiBgZGVza3RvcF9ub3RpZmljYXRpb25zLSR7d2luZG93LmxvY2F0aW9uLmhvc3R9YFxufVxuXG5leHBvcnQgY29uc3QgZGVza3RvcE50Zm5MYWJlbHM6IERlc2t0b3BOdGZuU2V0dGluZ0xhYmVsID0ge1xuICBbTm90ZVR5cGVPcmRlcl06IGludGwuSURfQlJPV1NFUl9OVEZOX09SREVSUyxcbiAgW05vdGVUeXBlTWF0Y2hdOiBpbnRsLklEX0JST1dTRVJfTlRGTl9NQVRDSEVTLFxuICBbTm90ZVR5cGVCb25kUG9zdF06IGludGwuSURfQlJPV1NFUl9OVEZOX0JPTkRTLFxuICBbTm90ZVR5cGVDb25uRXZlbnRdOiBpbnRsLklEX0JST1dTRVJfTlRGTl9DT05ORUNUSU9OU1xufVxuXG5leHBvcnQgY29uc3QgZGVmYXVsdERlc2t0b3BOdGZuU2V0dGluZ3M6IERlc2t0b3BOdGZuU2V0dGluZyA9IHtcbiAgW05vdGVUeXBlT3JkZXJdOiB0cnVlLFxuICBbTm90ZVR5cGVNYXRjaF06IHRydWUsXG4gIFtOb3RlVHlwZUJvbmRQb3N0XTogdHJ1ZSxcbiAgW05vdGVUeXBlQ29ubkV2ZW50XTogdHJ1ZVxufVxuXG5sZXQgZGVza3RvcE50Zm5TZXR0aW5nczogRGVza3RvcE50Zm5TZXR0aW5nXG5cbi8vIEJyb3dzZXJOb3RpZmllciBpcyBhIHdyYXBwZXIgYXJvdW5kIHRoZSBicm93c2VyJ3Mgbm90aWZpY2F0aW9uIEFQSS5cbmNsYXNzIEJyb3dzZXJOb3RpZmllciB7XG4gIHN0YXRpYyBudGZuUGVybWlzc2lvbkdyYW50ZWQgKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB3aW5kb3cuTm90aWZpY2F0aW9uLnBlcm1pc3Npb24gPT09ICdncmFudGVkJ1xuICB9XG5cbiAgc3RhdGljIG50Zm5QZXJtaXNzaW9uRGVuaWVkICgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gd2luZG93Lk5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uID09PSAnZGVuaWVkJ1xuICB9XG5cbiAgc3RhdGljIGFzeW5jIHJlcXVlc3ROdGZuUGVybWlzc2lvbiAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCEoJ05vdGlmaWNhdGlvbicgaW4gd2luZG93KSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGlmIChCcm93c2VyTm90aWZpZXIubnRmblBlcm1pc3Npb25HcmFudGVkKCkpIHtcbiAgICAgIEJyb3dzZXJOb3RpZmllci5zZW5kRGVza3RvcE5vdGlmaWNhdGlvbihpbnRsLnByZXAoaW50bC5JRF9CUk9XU0VSX05URk5fRU5BQkxFRCkpXG4gICAgfSBlbHNlIGlmICghQnJvd3Nlck5vdGlmaWVyLm50Zm5QZXJtaXNzaW9uRGVuaWVkKCkpIHtcbiAgICAgIGF3YWl0IE5vdGlmaWNhdGlvbi5yZXF1ZXN0UGVybWlzc2lvbigpXG4gICAgICBCcm93c2VyTm90aWZpZXIuc2VuZERlc2t0b3BOb3RpZmljYXRpb24oaW50bC5wcmVwKGludGwuSURfQlJPV1NFUl9OVEZOX0VOQUJMRUQpKVxuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBzZW5kRGVza3RvcE5vdGlmaWNhdGlvbiAodGl0bGU6IHN0cmluZywgYm9keT86IHN0cmluZykge1xuICAgIGlmICghQnJvd3Nlck5vdGlmaWVyLm50Zm5QZXJtaXNzaW9uR3JhbnRlZCgpKSByZXR1cm5cbiAgICBjb25zdCBudGZuID0gbmV3IHdpbmRvdy5Ob3RpZmljYXRpb24odGl0bGUsIHtcbiAgICAgIGJvZHk6IGJvZHksXG4gICAgICBpY29uOiAnL2ltZy9zb2Z0ZW5lZC1pY29uLnBuZydcbiAgICB9KVxuICAgIHJldHVybiBudGZuXG4gIH1cbn1cblxuLy8gT1NEZXNrdG9wTm90aWZpZXIgbWFuYWdlcyBPUyBkZXNrdG9wIG5vdGlmaWNhdGlvbnMgdmlhIHRoZSBzYW1lIGludGVyZmFjZVxuLy8gYXMgQnJvd3Nlck5vdGlmaWVyLCBidXQgc2VuZHMgbm90aWZpY2F0aW9ucyB1c2luZyBhbiB1bmRlcmx5aW5nIEdvXG4vLyBub3RpZmljYXRpb24gbGlicmFyeSBleHBvc2VkIHRvIHRoZSB3ZWJ2aWV3LlxuY2xhc3MgT1NEZXNrdG9wTm90aWZpZXIge1xuICBzdGF0aWMgbnRmblBlcm1pc3Npb25HcmFudGVkICgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgc3RhdGljIG50Zm5QZXJtaXNzaW9uRGVuaWVkICgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyByZXF1ZXN0TnRmblBlcm1pc3Npb24gKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGF3YWl0IE9TRGVza3RvcE5vdGlmaWVyLnNlbmREZXNrdG9wTm90aWZpY2F0aW9uKGludGwucHJlcChpbnRsLklEX0JST1dTRVJfTlRGTl9FTkFCTEVEKSlcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBzZW5kRGVza3RvcE5vdGlmaWNhdGlvbiAodGl0bGU6IHN0cmluZywgYm9keT86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIHdlYnZpZXcvbGludXggb3Igd2Vidmlldy93aW5kb3dzXG4gICAgaWYgKGlzRGVza3RvcFdlYnZpZXcoKSkgYXdhaXQgd2luZG93LnNlbmRPU05vdGlmaWNhdGlvbih0aXRsZSwgYm9keSlcbiAgICAvLyB3ZWJraXQvZGFyd2luXG4gICAgLy8gU2VlOiBjbGllbnQvY21kL2Jpc29udy1kZXNrdG9wL2FwcF9kYXJ3aW4uZ28jTDY3My0jTDY5N1xuICAgIGVsc2UgaWYgKGlzRGVza3RvcFdlYmtpdCgpKSBhd2FpdCB3aW5kb3cud2Via2l0Lm1lc3NhZ2VIYW5kbGVycy5id0hhbmRsZXIucG9zdE1lc3NhZ2UoWydzZW5kT1NOb3RpZmljYXRpb24nLCB0aXRsZSwgYm9keV0pXG4gICAgZWxzZSBjb25zb2xlLmVycm9yKCdzZW5kRGVza3RvcE5vdGlmaWNhdGlvbjogdW5rbm93biBlbnZpcm9ubWVudCcpXG4gIH1cbn1cblxuLy8gaXNEZXNrdG9wV2VidmlldyBjaGVja3MgaWYgd2UgYXJlIHJ1bm5pbmcgaW4gd2Vidmlld1xuZnVuY3Rpb24gaXNEZXNrdG9wV2VidmlldyAoKTogYm9vbGVhbiB7XG4gIHJldHVybiB3aW5kb3cuaXNXZWJ2aWV3ICE9PSB1bmRlZmluZWRcbn1cblxuLy8gaXNEZXNrdG9wRGFyd2luIHJldHVybnMgdHJ1ZSBpZiB3ZSBhcmUgcnVubmluZyBpbiBhIHdlYnZpZXcgb24gZGFyd2luXG4vLyBJdCB0ZXN0cyBmb3IgdGhlIGV4aXN0ZW5jZSBvZiB0aGUgYndIYW5kbGVyIHdlYmtpdCBtZXNzYWdlIGhhbmRsZXIuXG5mdW5jdGlvbiBpc0Rlc2t0b3BXZWJraXQgKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gd2luZG93LndlYmtpdD8ubWVzc2FnZUhhbmRsZXJzPy5id0hhbmRsZXIgIT09IHVuZGVmaW5lZFxufVxuXG4vLyBkZXRlcm1pbmUgd2hldGhlciB3ZSdyZSBydW5uaW5nIGluIGEgd2VidmlldyBvciBpbiBicm93c2VyLCBhbmQgZXhwb3J0XG4vLyB0aGUgYXBwcm9wcmlhdGUgbm90aWZpZXIgYWNjb3JkaW5nbHkuXG5leHBvcnQgY29uc3QgTm90aWZpZXIgPSBpc0Rlc2t0b3BXZWJ2aWV3KCkgfHwgaXNEZXNrdG9wV2Via2l0KCkgPyBPU0Rlc2t0b3BOb3RpZmllciA6IEJyb3dzZXJOb3RpZmllclxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVza3RvcE5vdGlmeSAobm90ZTogQ29yZU5vdGUpIHtcbiAgaWYgKCFkZXNrdG9wTnRmblNldHRpbmdzLmJyb3dzZXJOdGZuRW5hYmxlZCB8fCAhZGVza3RvcE50Zm5TZXR0aW5nc1tub3RlLnR5cGVdKSByZXR1cm5cbiAgYXdhaXQgTm90aWZpZXIuc2VuZERlc2t0b3BOb3RpZmljYXRpb24obm90ZS5zdWJqZWN0LCBwbGFpbk5vdGUobm90ZS5kZXRhaWxzKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZldGNoRGVza3RvcE50Zm5TZXR0aW5ncyAoKTogRGVza3RvcE50Zm5TZXR0aW5nIHtcbiAgaWYgKGRlc2t0b3BOdGZuU2V0dGluZ3MgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBkZXNrdG9wTnRmblNldHRpbmdzXG4gIH1cbiAgY29uc3QgayA9IGRlc2t0b3BOdGZuU2V0dGluZ3NLZXkoKVxuICBkZXNrdG9wTnRmblNldHRpbmdzID0gKFN0YXRlLmZldGNoTG9jYWwoaykgPz8ge30pIGFzIERlc2t0b3BOdGZuU2V0dGluZ1xuICByZXR1cm4gZGVza3RvcE50Zm5TZXR0aW5nc1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlTnRmblNldHRpbmcgKG5vdGVUeXBlOiBzdHJpbmcsIGVuYWJsZWQ6IGJvb2xlYW4pIHtcbiAgZmV0Y2hEZXNrdG9wTnRmblNldHRpbmdzKClcbiAgZGVza3RvcE50Zm5TZXR0aW5nc1tub3RlVHlwZV0gPSBlbmFibGVkXG4gIFN0YXRlLnN0b3JlTG9jYWwoZGVza3RvcE50Zm5TZXR0aW5nc0tleSgpLCBkZXNrdG9wTnRmblNldHRpbmdzKVxufVxuXG5jb25zdCBjb2luRXhwbG9yZXJUb2tlblJlID0gL1xce1xce1xceyhbXnxdKylcXHwoW159XSspXFx9XFx9XFx9L2dcbmNvbnN0IG9yZGVyVG9rZW5SZSA9IC9cXHtcXHtcXHtvcmRlclxcfChbXn1dKylcXH1cXH1cXH0vZ1xuXG4vKlxuICogaW5zZXJ0UmljaE5vdGUgcmVwbGFjZXMgdHggYW5kIG9yZGVyIGhhc2ggdG9rZW5zIGluIHRoZSBpbnB1dCBzdHJpbmcgd2l0aFxuICogPGE+IGVsZW1lbnRzIHRoYXQgbGluayB0byB0aGUgYXNzZXQncyBjaGFpbiBleHBsb3JlciBhbmQgb3JkZXIgZGV0YWlsc1xuICogdmlldywgYW5kIGluc2VydHMgdGhlIHJlc3VsdGluZyBIVE1MIGludG8gdGhlIHN1cHBsaWVkIHBhcmVudCBlbGVtZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0UmljaE5vdGUgKHBhcmVudDogUGFnZUVsZW1lbnQsIGlucHV0U3RyaW5nOiBzdHJpbmcpIHtcbiAgY29uc3QgcyA9IGlucHV0U3RyaW5nLnJlcGxhY2Uob3JkZXJUb2tlblJlLCAoX21hdGNoLCBvcmRlclRva2VuKSA9PiB7XG4gICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxuICAgIGxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgJy9vcmRlci8nICsgb3JkZXJUb2tlbilcbiAgICBsaW5rLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnc3VidGxlbGluaycpXG4gICAgbGluay50ZXh0Q29udGVudCA9IG9yZGVyVG9rZW4uc2xpY2UoMCwgOClcbiAgICByZXR1cm4gbGluay5vdXRlckhUTUxcbiAgfSkucmVwbGFjZShjb2luRXhwbG9yZXJUb2tlblJlLCAoX21hdGNoLCBhc3NldElELCBoYXNoKSA9PiB7XG4gICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxuICAgIGxpbmsuc2V0QXR0cmlidXRlKCdkYXRhLWV4cGxvcmVyLWNvaW4nLCBoYXNoKVxuICAgIGxpbmsuc2V0QXR0cmlidXRlKCd0YXJnZXQnLCAnX2JsYW5rJylcbiAgICBsaW5rLnRleHRDb250ZW50ID0gaGFzaC5zbGljZSgwLCA4KVxuICAgIHNldENvaW5IcmVmKGFzc2V0SUQsIGxpbmspXG4gICAgcmV0dXJuIGxpbmsub3V0ZXJIVE1MXG4gIH0pXG4gIGNvbnN0IGVscyA9IERvYy5ub2Rlcml6ZShzKS5ib2R5XG4gIHdoaWxlIChlbHMuZmlyc3RDaGlsZCkgcGFyZW50LmFwcGVuZENoaWxkKGVscy5maXJzdENoaWxkKVxufVxuXG4vKlxuICogcGxhaW5Ob3RlIHJlcGxhY2VzIHR4IGFuZCBvcmRlciBoYXNoIHRva2VucyB0b2tlbnMgaW4gdGhlIGlucHV0IHN0cmluZyB3aXRoXG4gKiBzaG9ydGVuZWQgaGFzaGVzLCBmb3IgcmVuZGVyaW5nIGluIGJyb3dzZXIgbm90aWZpY2F0aW9ucyBhbmQgcG9wdXBzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGxhaW5Ob3RlIChpbnB1dFN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgcmVwbGFjZWRTdHJpbmcgPSBpbnB1dFN0cmluZy5yZXBsYWNlKGNvaW5FeHBsb3JlclRva2VuUmUsIChfbWF0Y2gsIF9hc3NldElELCBoYXNoKSA9PiB7XG4gICAgcmV0dXJuIGhhc2guc2xpY2UoMCwgOClcbiAgfSlcbiAgcmV0dXJuIHJlcGxhY2VkU3RyaW5nXG59XG4iLCJpbXBvcnQgRG9jIGZyb20gJy4vZG9jJ1xuaW1wb3J0IHtcbiAgUGFnZUVsZW1lbnQsXG4gIFhZUmFuZ2UsXG4gIE9yZGVyT3B0aW9uXG59IGZyb20gJy4vcmVnaXN0cnknXG5cbmludGVyZmFjZSBPcHRpb25zUmVwb3J0ZXJzIHtcbiAgZW5hYmxlOiAoKSA9PiB2b2lkXG4gIGRpc2FibGU6ICgpID0+IHZvaWRcbn1cblxuLy8gSGF2aW5nIHRoZSBjYWxsZXIgc2V0IHRoZXNlIHZhcnMgb24gbG9hZCB1c2luZyBhbiBleHBvcnRlZCBmdW5jdGlvbiBtYWtlc1xuLy8gbGlmZSBlYXNpZXIuXG5sZXQgb3JkZXJPcHRUbXBsOiBIVE1MRWxlbWVudCwgYm9vbGVhbk9wdFRtcGw6IEhUTUxFbGVtZW50LCByYW5nZU9wdFRtcGw6IEhUTUxFbGVtZW50XG5cbi8vIHNldE9wdGlvblRlbXBsYXRlcyBzZXRzIHRoZSBwYWNrYWdlIHZhcnMgZm9yIHRoZSB0ZW1wbGF0ZXMgYW5kIGFwcGxpY2F0aW9uLlxuZXhwb3J0IGZ1bmN0aW9uIHNldE9wdGlvblRlbXBsYXRlcyAocGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+KTogdm9pZCB7XG4gIFtib29sZWFuT3B0VG1wbCwgcmFuZ2VPcHRUbXBsLCBvcmRlck9wdFRtcGxdID0gW3BhZ2UuYm9vbGVhbk9wdFRtcGwsIHBhZ2UucmFuZ2VPcHRUbXBsLCBwYWdlLm9yZGVyT3B0VG1wbF1cbn1cblxuY29uc3QgdGhyZWVTaWdGaWdzID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KERvYy5sYW5ndWFnZXMoKSwge1xuICBtaW5pbXVtU2lnbmlmaWNhbnREaWdpdHM6IDMsXG4gIG1heGltdW1TaWduaWZpY2FudERpZ2l0czogM1xufSlcblxuLypcbiAqIE9wdGlvbiBpcyBhIGJhc2UgY2xhc3MgZm9yIG9wdGlvbiBlbGVtZW50cy4gT3B0aW9uIHN0b3JlcyBzb21lIGNvbW1vblxuICogcGFyYW1ldGVycyBhbmQgbW9uaXRvcnMgdGhlIHRvZ2dsZSBzd2l0Y2gsIGNhbGxpbmcgdGhlIGNoaWxkIGNsYXNzJ3NcbiAqIGVuYWJsZS9kaXNhYmxlIG1ldGhvZHMgd2hlbiB0aGUgdXNlciBtYW51YWxseSB0dXJucyB0aGUgb3B0aW9uIG9uIG9yIG9mZi5cbiAqL1xuZXhwb3J0IGNsYXNzIE9wdGlvbiB7XG4gIG9wdDogT3JkZXJPcHRpb25cbiAgbm9kZTogSFRNTEVsZW1lbnRcbiAgdG1wbDogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIG9uOiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IgKG9wdDogT3JkZXJPcHRpb24sIHN5bWJvbDogc3RyaW5nLCByZXBvcnQ6IE9wdGlvbnNSZXBvcnRlcnMpIHtcbiAgICB0aGlzLm9wdCA9IG9wdFxuICAgIGNvbnN0IG5vZGUgPSB0aGlzLm5vZGUgPSBvcmRlck9wdFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XG4gICAgY29uc3QgdG1wbCA9IHRoaXMudG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKG5vZGUpXG5cbiAgICB0bXBsLm9wdE5hbWUudGV4dENvbnRlbnQgPSBvcHQuZGlzcGxheW5hbWVcbiAgICB0bXBsLnRvb2x0aXAuZGF0YXNldC50b29sdGlwID0gb3B0LmRlc2NyaXB0aW9uXG5cbiAgICAvLyBjb25zdCBpc0Jhc2VDaGFpbiA9IChpc1N3YXBPcHRpb24gJiYgb3JkZXIuc2VsbCkgfHwgKCFpc1N3YXBPcHRpb24gJiYgIW9yZGVyLnNlbGwpXG4gICAgLy8gY29uc3Qgc3ltYm9sID0gaXNCYXNlQ2hhaW4gPyB0aGlzLmJhc2VTeW1ib2woKSA6IHRoaXMucXVvdGVTeW1ib2woKVxuICAgIGlmIChzeW1ib2wpIHRtcGwuY2hhaW5JY29uLnNyYyA9IERvYy5sb2dvUGF0aChzeW1ib2wpXG4gICAgZWxzZSBEb2MuaGlkZSh0bXBsLmNoYWluSWNvbilcblxuICAgIHRoaXMub24gPSBmYWxzZVxuICAgIERvYy5iaW5kKG5vZGUsICdjbGljaycsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLm9uKSByZXR1cm5cbiAgICAgIHRoaXMub24gPSB0cnVlXG4gICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgIHJlcG9ydC5lbmFibGUoKVxuICAgIH0pXG4gICAgRG9jLmJpbmQodG1wbC50b2dnbGUsICdjbGljaycsIGUgPT4ge1xuICAgICAgaWYgKCF0aGlzLm9uKSByZXR1cm5cbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKClcbiAgICAgIHRoaXMub24gPSBmYWxzZVxuICAgICAgbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXG4gICAgICByZXBvcnQuZGlzYWJsZSgpXG4gICAgfSlcbiAgfVxufVxuXG4vKlxuICogQm9vbGVhbk9wdGlvbiBpcyBhIHNpbXBsZSBvbi9vZmYgb3B0aW9uIHdpdGggYSBzaG9ydCBzdW1tYXJ5IG9mIGl0J3MgZWZmZWN0cy5cbiAqIEJvb2xlYW5PcmRlck9wdGlvbiBpcyB0aGUgaGFuZGxlciBmb3IgYSAqQm9vbGVhbkNvbmZpZyBmcm9tIGNsaWVudC9hc3NldC5cbiAqL1xuZXhwb3J0IGNsYXNzIEJvb2xlYW5PcHRpb24gZXh0ZW5kcyBPcHRpb24ge1xuICBjb250cm9sOiBIVE1MRWxlbWVudFxuICBjaGFuZ2VkOiAoKSA9PiB2b2lkXG4gIGRpY3Q6IFJlY29yZDxzdHJpbmcsIGFueT5cblxuICBjb25zdHJ1Y3RvciAob3B0OiBPcmRlck9wdGlvbiwgc3ltYm9sOiBzdHJpbmcsIGRpY3Q6IFJlY29yZDxzdHJpbmcsIGFueT4sIGNoYW5nZWQ6ICgpID0+IHZvaWQpIHtcbiAgICBzdXBlcihvcHQsIHN5bWJvbCwge1xuICAgICAgZW5hYmxlOiAoKSA9PiB0aGlzLmVuYWJsZSgpLFxuICAgICAgZGlzYWJsZTogKCkgPT4gdGhpcy5kaXNhYmxlKClcbiAgICB9KVxuICAgIHRoaXMuZGljdCA9IGRpY3RcbiAgICB0aGlzLmNoYW5nZWQgPSAoKSA9PiBjaGFuZ2VkKClcbiAgICBpZiAob3B0LmJvb2xlYW4gPT09IHVuZGVmaW5lZCkgdGhyb3cgRXJyb3IoJ25vdCBhIGJvb2xlYW4gb3B0JylcbiAgICBjb25zdCBjZmcgPSBvcHQuYm9vbGVhblxuICAgIGNvbnN0IGNvbnRyb2wgPSB0aGlzLmNvbnRyb2wgPSBib29sZWFuT3B0VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAvLyBBcHBlbmQgdG8gcGFyZW50J3Mgb3B0aW9ucyBkaXYuXG4gICAgdGhpcy50bXBsLmNvbnRyb2xzLmFwcGVuZENoaWxkKGNvbnRyb2wpXG4gICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKGNvbnRyb2wpXG4gICAgdG1wbC5yZWFzb24udGV4dENvbnRlbnQgPSBjZmcucmVhc29uXG4gICAgdGhpcy5vbiA9IHR5cGVvZiBkaWN0W29wdC5rZXldICE9PSAndW5kZWZpbmVkJyA/IGRpY3Rbb3B0LmtleV0gOiBvcHQuZGVmYXVsdFxuICAgIGlmICh0aGlzLm9uKSB0aGlzLm5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuICB9XG5cbiAgc3RvcmUgKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLm9uID09PSB0aGlzLm9wdC5kZWZhdWx0KSBkZWxldGUgdGhpcy5kaWN0W3RoaXMub3B0LmtleV1cbiAgICBlbHNlIHRoaXMuZGljdFt0aGlzLm9wdC5rZXldID0gdGhpcy5vblxuICAgIHRoaXMuY2hhbmdlZCgpXG4gIH1cblxuICBlbmFibGUgKCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcmUoKVxuICB9XG5cbiAgZGlzYWJsZSAoKTogdm9pZCB7XG4gICAgdGhpcy5zdG9yZSgpXG4gIH1cbn1cblxuLypcbiAqIFhZUmFuZ2VPcHRpb24gaXMgYW4gb3JkZXIgb3B0aW9uIHRoYXQgY29udGFpbnMgYW4gWFlSYW5nZUhhbmRsZXIuIFRoZSBsb2dpY1xuICogZm9yIGhhbmRsaW5nIHRoZSBzbGlkZXIgdG8gaXMgZGVmaW5lZCBpbiBYWVJhbmdlSGFuZGxlciBzbyB0aGF0IHRoZSBzbGlkZXJcbiAqIGNhbiBiZSB1c2VkIHdpdGhvdXQgYmVpbmcgY29udGFpbmVkIGluIGFuIG9yZGVyIG9wdGlvbi5cbiAqL1xuZXhwb3J0IGNsYXNzIFhZUmFuZ2VPcHRpb24gZXh0ZW5kcyBPcHRpb24ge1xuICBoYW5kbGVyOiBYWVJhbmdlSGFuZGxlclxuICB4OiBudW1iZXJcbiAgY2hhbmdlZDogKCkgPT4gdm9pZFxuICBkaWN0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG5cbiAgY29uc3RydWN0b3IgKG9wdDogT3JkZXJPcHRpb24sIHN5bWJvbDogc3RyaW5nLCBkaWN0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBjaGFuZ2VkOiAoKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIob3B0LCBzeW1ib2wsIHtcbiAgICAgIGVuYWJsZTogKCkgPT4gdGhpcy5lbmFibGUoKSxcbiAgICAgIGRpc2FibGU6ICgpID0+IHRoaXMuZGlzYWJsZSgpXG4gICAgfSlcbiAgICB0aGlzLmRpY3QgPSBkaWN0XG4gICAgdGhpcy5jaGFuZ2VkID0gY2hhbmdlZFxuICAgIGlmIChvcHQueHlSYW5nZSA9PT0gdW5kZWZpbmVkKSB0aHJvdyBFcnJvcignbm90IGFuIHh5IHJhbmdlIG9wdCcpXG4gICAgY29uc3QgY2ZnID0gb3B0Lnh5UmFuZ2VcbiAgICBjb25zdCBzZXRWYWwgPSBkaWN0W29wdC5rZXldXG4gICAgdGhpcy5vbiA9IHR5cGVvZiBzZXRWYWwgIT09ICd1bmRlZmluZWQnXG4gICAgaWYgKHRoaXMub24pIHtcbiAgICAgIHRoaXMubm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgICB0aGlzLnggPSBzZXRWYWxcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy54ID0gb3B0LmRlZmF1bHRcbiAgICB9XG4gICAgY29uc3Qgc2VsZWN0ZWQgPSAoKSA9PiB7IHRoaXMubm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpIH1cbiAgICB0aGlzLmhhbmRsZXIgPSBuZXcgWFlSYW5nZUhhbmRsZXIoY2ZnLCB0aGlzLngsIHsgY2hhbmdlZCwgc2VsZWN0ZWQsIHNldHRpbmdzRGljdDogZGljdCwgc2V0dGluZ3NLZXk6IG9wdC5rZXkgfSlcbiAgICB0aGlzLnRtcGwuY29udHJvbHMuYXBwZW5kQ2hpbGQodGhpcy5oYW5kbGVyLmNvbnRyb2wpXG4gIH1cblxuICBlbmFibGUgKCk6IHZvaWQge1xuICAgIHRoaXMuZGljdFt0aGlzLm9wdC5rZXldID0gdGhpcy54XG4gICAgdGhpcy5jaGFuZ2VkKClcbiAgfVxuXG4gIGRpc2FibGUgKCk6IHZvaWQge1xuICAgIGRlbGV0ZSB0aGlzLmRpY3RbdGhpcy5vcHQua2V5XVxuICAgIHRoaXMuY2hhbmdlZCgpXG4gIH1cblxuICBzZXRWYWx1ZSAoeDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5oYW5kbGVyLnNldFZhbHVlKHgpXG4gICAgdGhpcy5vbiA9IHRydWVcbiAgICB0aGlzLm5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuICB9XG59XG5cbmludGVyZmFjZSBBY2NlcHRPcHRzIHtcbiAgc2tpcENoYW5nZT86IGJvb2xlYW5cbiAgc2tpcFVwZGF0ZT86IGJvb2xlYW4gLy8gSW1wbGllcyBza2lwQ2hhbmdlXG59XG5cbmludGVyZmFjZSBSYW5nZUhhbmRsZXJPcHRzIHtcbiAgcm91bmRZPzogYm9vbGVhblxuICByb3VuZFg/OiBib29sZWFuXG4gIHVwZGF0ZWQ/OiAoeDpudW1iZXIsIHk6bnVtYmVyKSA9PiB2b2lkLCAvLyBmaXJlcyB3aGlsZSBkcmFnZ2luZy5cbiAgY2hhbmdlZD86ICgpID0+IHZvaWQsIC8vIGRvZXMgbm90IGZpcmUgd2hpbGUgZHJhZ2dpbmcgYnV0IGRvZXMgd2hlbiBkcmFnZ2luZyBlbmRzLlxuICBzZWxlY3RlZD86ICgpID0+IHZvaWQsXG4gIGRpc2FibGVkPzogYm9vbGVhblxuICBzZXR0aW5nc0RpY3Q/OiB7W2tleTogc3RyaW5nXTogYW55fVxuICBzZXR0aW5nc0tleT86IHN0cmluZ1xuICBjb252ZXJ0PzogKHg6IG51bWJlciwgeTogbnVtYmVyKSA9PiBhbnlcbn1cblxuLypcbiAqIFhZUmFuZ2VIYW5kbGVyIGlzIHRoZSBoYW5kbGVyIGZvciBhbiAqWFlSYW5nZSBmcm9tIGNsaWVudC9hc3NldC4gWFlSYW5nZVxuICogaGFzIGEgc2xpZGVyIHdoaWNoIGFsbG93cyBhZGp1c3RpbmcgdGhlIHggYW5kIHksIGxpbmVhcmx5IGJldHdlZW4gdHdvIGxpbWl0cy5cbiAqIFRoZSB1c2VyIGNhbiBhbHNvIG1hbnVhbGx5IGVudGVyIHZhbHVlcyBmb3IgeCBvciB5LlxuICovXG5leHBvcnQgY2xhc3MgWFlSYW5nZUhhbmRsZXIge1xuICBjb250cm9sOiBIVE1MRWxlbWVudFxuICByYW5nZTogWFlSYW5nZVxuICB0bXBsOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgaW5pdFZhbDogbnVtYmVyXG4gIHNldHRpbmdzRGljdD86IHtba2V5OiBzdHJpbmddOiBhbnl9XG4gIHNldHRpbmdzS2V5OiBzdHJpbmdcbiAgeDogbnVtYmVyXG4gIHNjcm9sbGluZ1g6IG51bWJlclxuICB5OiBudW1iZXJcbiAgcjogbnVtYmVyXG4gIHJvdW5kWDogYm9vbGVhblxuICByb3VuZFk6IGJvb2xlYW5cbiAgZGlzYWJsZWQ6IGJvb2xlYW5cbiAgdXBkYXRlZDogKHg6bnVtYmVyLCB5Om51bWJlcikgPT4gdm9pZCAvLyBjYWxsZWQgd2hpbGUgZHJhZ2dpbmdcbiAgY2hhbmdlZDogKCkgPT4gdm9pZCAvLyBub3QgY2FsbGVkIHdoaWxlIGRyYWdnaW5nLCBidXQgY2FsbGVkIHdoZW4gZG9uZSBkcmFnZ2luZ1xuICBzZWxlY3RlZDogKCkgPT4gdm9pZFxuICBjb252ZXJ0OiAoeDogbnVtYmVyLCB5OiBudW1iZXIpID0+IGFueVxuXG4gIGNvbnN0cnVjdG9yIChcbiAgICByYW5nZTogWFlSYW5nZSxcbiAgICBpbml0VmFsOiBudW1iZXIsXG4gICAgb3B0czogUmFuZ2VIYW5kbGVyT3B0c1xuICApIHtcbiAgICBjb25zdCBjb250cm9sID0gdGhpcy5jb250cm9sID0gcmFuZ2VPcHRUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgIGNvbnN0IHRtcGwgPSB0aGlzLnRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShjb250cm9sKVxuICAgIHRtcGwucmFuZ2VMYmxTdGFydC50ZXh0Q29udGVudCA9IHJhbmdlLnN0YXJ0LmxhYmVsXG4gICAgdG1wbC5yYW5nZUxibEVuZC50ZXh0Q29udGVudCA9IHJhbmdlLmVuZC5sYWJlbFxuICAgIHRtcGwueFVuaXQudGV4dENvbnRlbnQgPSByYW5nZS54VW5pdFxuICAgIHRtcGwueVVuaXQudGV4dENvbnRlbnQgPSByYW5nZS55VW5pdFxuICAgIHRoaXMucmFuZ2UgPSByYW5nZVxuICAgIHRoaXMuaW5pdFZhbCA9IGluaXRWYWxcbiAgICB0aGlzLnNldHRpbmdzRGljdCA9IG9wdHMuc2V0dGluZ3NEaWN0XG4gICAgdGhpcy5zZXR0aW5nc0tleSA9IG9wdHMuc2V0dGluZ3NLZXkgPz8gJydcbiAgICB0aGlzLnJvdW5kWCA9IEJvb2xlYW4ob3B0cy5yb3VuZFgpXG4gICAgdGhpcy5yb3VuZFkgPSBCb29sZWFuKG9wdHMucm91bmRZKVxuXG4gICAgdGhpcy5zZXREaXNhYmxlZChCb29sZWFuKG9wdHMuZGlzYWJsZWQpKVxuICAgIHRoaXMuY2hhbmdlZCA9IG9wdHMuY2hhbmdlZCA/PyAoKCkgPT4geyAvKiBwYXNzICovIH0pXG4gICAgdGhpcy5zZWxlY3RlZCA9IG9wdHMuc2VsZWN0ZWQgPz8gKCgpID0+IHsgLyogcGFzcyAqLyB9KVxuICAgIHRoaXMudXBkYXRlZCA9IG9wdHMudXBkYXRlZCA/PyAoKCkgPT4geyAvKiBwYXNzICovIH0pXG4gICAgdGhpcy5jb252ZXJ0ID0gb3B0cy5jb252ZXJ0IHx8ICgoeDogbnVtYmVyKSA9PiB4KVxuXG4gICAgY29uc3QgeyBzbGlkZXIsIGhhbmRsZSB9ID0gdG1wbFxuICAgIGNvbnN0IHJhbmdlWCA9IHJhbmdlLmVuZC54IC0gcmFuZ2Uuc3RhcnQueFxuICAgIGNvbnN0IHJhbmdlWSA9IHJhbmdlLmVuZC55IC0gcmFuZ2Uuc3RhcnQueVxuICAgIGNvbnN0IG5vcm1hbGl6ZVggPSAoeDogbnVtYmVyKSA9PiAoeCAtIHJhbmdlLnN0YXJ0LngpIC8gcmFuZ2VYXG5cbiAgICAvLyByLCB4LCBhbmQgeSB3aWxsIGJlIHVwZGF0ZWQgYnkgdGhlIHZhcmlvdXMgaW5wdXQgZXZlbnQgaGFuZGxlcnMuIHIgaXNcbiAgICAvLyB4IChvciB5KSBub3JtYWxpemVkIG9uIGl0cyByYW5nZSwgZS5nLiBbeF9taW4sIHhfbWF4XSAtPiBbMCwgMV1cbiAgICB0aGlzLnIgPSBub3JtYWxpemVYKGluaXRWYWwpXG4gICAgdGhpcy5zY3JvbGxpbmdYID0gdGhpcy54ID0gaW5pdFZhbFxuICAgIHRoaXMueSA9IHRoaXMuciAqIHJhbmdlWSArIHJhbmdlLnN0YXJ0LnlcbiAgICB0aGlzLmFjY2VwdCh0aGlzLnNjcm9sbGluZ1gsIHsgc2tpcFVwZGF0ZTogdHJ1ZSB9KVxuXG4gICAgLy8gU2V0IHVwIHRoZSBoYW5kbGVycyBmb3IgdGhlIHggYW5kIHkgdGV4dCBpbnB1dCBmaWVsZHMuXG4gICAgY29uc3QgY2xpY2tPdXRYID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSByZXR1cm5cbiAgICAgIGlmIChlLnR5cGUgIT09ICdjaGFuZ2UnICYmIGUudGFyZ2V0ID09PSB0bXBsLnhJbnB1dCkgcmV0dXJuXG4gICAgICBjb25zdCBzID0gdG1wbC54SW5wdXQudmFsdWVcbiAgICAgIGlmIChzKSB7XG4gICAgICAgIGNvbnN0IHh4ID0gcGFyc2VGbG9hdChzKVxuICAgICAgICBpZiAoIWlzTmFOKHh4KSkge1xuICAgICAgICAgIHRoaXMuc2Nyb2xsaW5nWCA9IGNsYW1wKHh4LCByYW5nZS5zdGFydC54LCByYW5nZS5lbmQueClcbiAgICAgICAgICB0aGlzLnIgPSBub3JtYWxpemVYKHRoaXMuc2Nyb2xsaW5nWClcbiAgICAgICAgICB0aGlzLnkgPSB0aGlzLnIgKiByYW5nZVkgKyByYW5nZS5zdGFydC55XG4gICAgICAgICAgdGhpcy5hY2NlcHQodGhpcy5zY3JvbGxpbmdYKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBEb2MuaGlkZSh0bXBsLnhJbnB1dClcbiAgICAgIERvYy5zaG93KHRtcGwueClcbiAgICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdjbGljaycsIGNsaWNrT3V0WClcbiAgICAgIHRoaXMuY2hhbmdlZCgpXG4gICAgfVxuXG4gICAgRG9jLmJpbmQodG1wbC54LCAnY2xpY2snLCBlID0+IHtcbiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSByZXR1cm5cbiAgICAgIERvYy5oaWRlKHRtcGwueClcbiAgICAgIERvYy5zaG93KHRtcGwueElucHV0KVxuICAgICAgdG1wbC54SW5wdXQuZm9jdXMoKVxuICAgICAgdG1wbC54SW5wdXQudmFsdWUgPSB0aHJlZVNpZ0ZpZ3MuZm9ybWF0KHRoaXMuc2Nyb2xsaW5nWClcbiAgICAgIERvYy5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjbGlja091dFgpXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHRtcGwueElucHV0LCAnY2hhbmdlJywgY2xpY2tPdXRYKVxuXG4gICAgY29uc3QgY2xpY2tPdXRZID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSByZXR1cm5cbiAgICAgIGlmIChlLnR5cGUgIT09ICdjaGFuZ2UnICYmIGUudGFyZ2V0ID09PSB0bXBsLnlJbnB1dCkgcmV0dXJuXG4gICAgICBjb25zdCBzID0gdG1wbC55SW5wdXQudmFsdWVcbiAgICAgIGlmIChzKSB7XG4gICAgICAgIGNvbnN0IHl5ID0gcGFyc2VGbG9hdChzKVxuICAgICAgICBpZiAoIWlzTmFOKHl5KSkge1xuICAgICAgICAgIHRoaXMueSA9IGNsYW1wKHl5LCByYW5nZS5zdGFydC55LCByYW5nZS5lbmQueSlcbiAgICAgICAgICB0aGlzLnIgPSAodGhpcy55IC0gcmFuZ2Uuc3RhcnQueSkgLyByYW5nZVlcbiAgICAgICAgICB0aGlzLnNjcm9sbGluZ1ggPSByYW5nZS5zdGFydC54ICsgdGhpcy5yICogcmFuZ2VYXG4gICAgICAgICAgdGhpcy5hY2NlcHQodGhpcy5zY3JvbGxpbmdYKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBEb2MuaGlkZSh0bXBsLnlJbnB1dClcbiAgICAgIERvYy5zaG93KHRtcGwueSlcbiAgICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdjbGljaycsIGNsaWNrT3V0WSlcbiAgICAgIHRoaXMuY2hhbmdlZCgpXG4gICAgfVxuXG4gICAgRG9jLmJpbmQodG1wbC55LCAnY2xpY2snLCBlID0+IHtcbiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSByZXR1cm5cbiAgICAgIERvYy5oaWRlKHRtcGwueSlcbiAgICAgIERvYy5zaG93KHRtcGwueUlucHV0KVxuICAgICAgdG1wbC55SW5wdXQuZm9jdXMoKVxuICAgICAgdG1wbC55SW5wdXQudmFsdWUgPSB0aHJlZVNpZ0ZpZ3MuZm9ybWF0KHRoaXMueSlcbiAgICAgIERvYy5iaW5kKGRvY3VtZW50LCAnY2xpY2snLCBjbGlja091dFkpXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHRtcGwueUlucHV0LCAnY2hhbmdlJywgY2xpY2tPdXRZKVxuXG4gICAgLy8gUmVhZCB0aGUgc2xpZGVyLlxuICAgIERvYy5iaW5kKGhhbmRsZSwgJ21vdXNlZG93bicsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAodGhpcy5kaXNhYmxlZCkgcmV0dXJuXG4gICAgICBpZiAoZS5idXR0b24gIT09IDApIHJldHVyblxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICB0aGlzLnNlbGVjdGVkKClcbiAgICAgIGNvbnN0IHN0YXJ0WCA9IGUucGFnZVhcbiAgICAgIGNvbnN0IHcgPSBzbGlkZXIuY2xpZW50V2lkdGggLSBoYW5kbGUub2Zmc2V0V2lkdGhcbiAgICAgIGNvbnN0IHN0YXJ0TGVmdCA9IG5vcm1hbGl6ZVgodGhpcy5zY3JvbGxpbmdYKSAqIHdcbiAgICAgIGNvbnN0IGxlZnQgPSAoZWU6IE1vdXNlRXZlbnQpID0+IE1hdGgubWF4KE1hdGgubWluKHN0YXJ0TGVmdCArIChlZS5wYWdlWCAtIHN0YXJ0WCksIHcpLCAwKVxuICAgICAgY29uc3QgdHJhY2tNb3VzZSA9IChlZTogTW91c2VFdmVudCwgZW1pdD86IGJvb2xlYW4pID0+IHtcbiAgICAgICAgZWUucHJldmVudERlZmF1bHQoKVxuICAgICAgICB0aGlzLnIgPSBsZWZ0KGVlKSAvIHdcbiAgICAgICAgdGhpcy5zY3JvbGxpbmdYID0gdGhpcy5yICogcmFuZ2VYICsgcmFuZ2Uuc3RhcnQueFxuICAgICAgICB0aGlzLnkgPSB0aGlzLnIgKiByYW5nZVkgKyByYW5nZS5zdGFydC55XG4gICAgICAgIHRoaXMuYWNjZXB0KHRoaXMuc2Nyb2xsaW5nWCwgeyBza2lwQ2hhbmdlOiAhZW1pdCB9KVxuICAgICAgfVxuICAgICAgY29uc3QgbW91c2VVcCA9IChlZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICB0cmFja01vdXNlKGVlLCB0cnVlKVxuICAgICAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdHJhY2tNb3VzZSlcbiAgICAgICAgRG9jLnVuYmluZChkb2N1bWVudCwgJ21vdXNldXAnLCBtb3VzZVVwKVxuICAgICAgICB0aGlzLmNoYW5nZWQoKVxuICAgICAgfVxuICAgICAgRG9jLmJpbmQoZG9jdW1lbnQsICdtb3VzZW1vdmUnLCB0cmFja01vdXNlKVxuICAgICAgRG9jLmJpbmQoZG9jdW1lbnQsICdtb3VzZXVwJywgbW91c2VVcClcbiAgICB9KVxuXG4gICAgRG9jLmJpbmQodG1wbC5zbGlkZXJCb3gsICdjbGljaycsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAodGhpcy5kaXNhYmxlZCkgcmV0dXJuXG4gICAgICBpZiAoZS5idXR0b24gIT09IDApIHJldHVyblxuICAgICAgY29uc3QgeCA9IGUucGFnZVhcbiAgICAgIGNvbnN0IG0gPSBEb2MubGF5b3V0TWV0cmljcyh0bXBsLnNsaWRlcilcbiAgICAgIHRoaXMuciA9IGNsYW1wKCh4IC0gbS5ib2R5TGVmdCkgLyBtLndpZHRoLCAwLCAxKVxuICAgICAgdGhpcy5zY3JvbGxpbmdYID0gdGhpcy5yICogcmFuZ2VYICsgcmFuZ2Uuc3RhcnQueFxuICAgICAgdGhpcy55ID0gdGhpcy5yICogcmFuZ2VZICsgcmFuZ2Uuc3RhcnQueVxuICAgICAgdGhpcy5hY2NlcHQodGhpcy5zY3JvbGxpbmdYKVxuICAgIH0pXG4gIH1cblxuICBzZXREaXNhYmxlZCAoZGlzYWJsZWQ6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmNvbnRyb2wuY2xhc3NMaXN0LnRvZ2dsZSgnZGlzYWJsZWQnLCBkaXNhYmxlZClcbiAgICB0aGlzLmRpc2FibGVkID0gZGlzYWJsZWRcbiAgfVxuXG4gIHNldFhMYWJlbCAoczogc3RyaW5nKSB7XG4gICAgdGhpcy50bXBsLngudGV4dENvbnRlbnQgPSBzXG4gIH1cblxuICBzZXRZTGFiZWwgKHM6IHN0cmluZykge1xuICAgIHRoaXMudG1wbC55LnRleHRDb250ZW50ID0gc1xuICB9XG5cbiAgYWNjZXB0ICh4OiBudW1iZXIsIGNmZz86IEFjY2VwdE9wdHMpOiB2b2lkIHtcbiAgICBjb25zdCB0bXBsID0gdGhpcy50bXBsXG4gICAgaWYgKHRoaXMucm91bmRYKSB4ID0gTWF0aC5yb3VuZCh4KVxuICAgIGlmICh0aGlzLnJvdW5kWSkgdGhpcy55ID0gTWF0aC5yb3VuZCh0aGlzLnkpXG4gICAgdG1wbC54LnRleHRDb250ZW50ID0gdGhyZWVTaWdGaWdzLmZvcm1hdCh4KVxuICAgIHRtcGwueS50ZXh0Q29udGVudCA9IHRocmVlU2lnRmlncy5mb3JtYXQodGhpcy55KVxuICAgIGlmICh0aGlzLnJvdW5kWSkgdG1wbC55LnRleHRDb250ZW50ID0gYCR7dGhpcy55fWBcbiAgICBjb25zdCByRWZmZWN0aXZlID0gY2xhbXAodGhpcy5yLCAwLCAxKVxuICAgIHRtcGwuaGFuZGxlLnN0eWxlLmxlZnQgPSBgY2FsYygke3JFZmZlY3RpdmUgKiAxMDB9JSAtICR7ckVmZmVjdGl2ZSAqIDE0fXB4KWBcbiAgICB0aGlzLnggPSB4XG4gICAgdGhpcy5zY3JvbGxpbmdYID0geFxuICAgIGNmZyA9IGNmZyA/PyB7fVxuICAgIGlmICh0aGlzLnNldHRpbmdzRGljdCkgdGhpcy5zZXR0aW5nc0RpY3RbdGhpcy5zZXR0aW5nc0tleV0gPSB0aGlzLmNvbnZlcnQodGhpcy54LCB0aGlzLnkpXG4gICAgaWYgKCFjZmcuc2tpcFVwZGF0ZSkge1xuICAgICAgdGhpcy51cGRhdGVkKHgsIHRoaXMueSlcbiAgICAgIGlmICghY2ZnLnNraXBDaGFuZ2UpIHRoaXMuY2hhbmdlZCgpXG4gICAgfVxuICB9XG5cbiAgc2V0VmFsdWUgKHg6IG51bWJlciwgc2tpcFVwZGF0ZT86IGJvb2xlYW4pIHtcbiAgICBjb25zdCByYW5nZSA9IHRoaXMucmFuZ2VcbiAgICB0aGlzLnIgPSAoeCAtIHJhbmdlLnN0YXJ0LngpIC8gKHJhbmdlLmVuZC54IC0gcmFuZ2Uuc3RhcnQueClcbiAgICB0aGlzLnkgPSByYW5nZS5zdGFydC55ICsgdGhpcy5yICogKHJhbmdlLmVuZC55IC0gcmFuZ2Uuc3RhcnQueSlcbiAgICB0aGlzLmFjY2VwdCh4LCB7IHNraXBVcGRhdGUgfSlcbiAgfVxuXG4gIG1vZGlmaWVkICgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy54ICE9PSB0aGlzLmluaXRWYWxcbiAgfVxuXG4gIHJlc2V0ICgpIHtcbiAgICB0aGlzLnNldFZhbHVlKHRoaXMuaW5pdFZhbCwgdHJ1ZSlcbiAgfVxufVxuXG5jb25zdCBjbGFtcCA9ICh2OiBudW1iZXIsIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciA9PiB2IDwgbWluID8gbWluIDogdiA+IG1heCA/IG1heCA6IHZcbiIsImltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCAqIGFzIE9yZGVyVXRpbCBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCB7IGJpbmQgYXMgYmluZEZvcm0sIEFjY2VsZXJhdGVPcmRlckZvcm0gfSBmcm9tICcuL2Zvcm1zJ1xuaW1wb3J0IHsgcG9zdEpTT04gfSBmcm9tICcuL2h0dHAnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7XG4gIGFwcCxcbiAgT3JkZXIsXG4gIFBhZ2VFbGVtZW50LFxuICBPcmRlck5vdGUsXG4gIE1hdGNoTm90ZSxcbiAgTWF0Y2gsXG4gIENvaW5cbn0gZnJvbSAnLi9yZWdpc3RyeSdcbmltcG9ydCB7IHNldE9wdGlvblRlbXBsYXRlcyB9IGZyb20gJy4vb3B0cydcbmltcG9ydCB7IGZvcm1hdENvaW5JRCwgc2V0Q29pbkhyZWYgfSBmcm9tICcuL2NvaW5leHBsb3JlcnMnXG5cbi8vIGxvY2tUaW1lTWFrZXJNcyBtdXN0IG1hdGNoIHRoZSB2YWx1ZSByZXR1cm5lZCBmcm9tIExvY2tUaW1lTWFrZXIgZnVuYyBpblxuLy8gYmlzb253LlxuY29uc3QgbG9ja1RpbWVNYWtlck1zID0gMjAgKiA2MCAqIDYwICogMTAwMFxuLy8gbG9ja1RpbWVUYWtlck1zIG11c3QgbWF0Y2ggdGhlIHZhbHVlIHJldHVybmVkIGZyb20gTG9ja1RpbWVUYWtlciBmdW5jIGluXG4vLyBiaXNvbncuXG5jb25zdCBsb2NrVGltZVRha2VyTXMgPSA4ICogNjAgKiA2MCAqIDEwMDBcblxuY29uc3QgYW5pbWF0aW9uTGVuZ3RoID0gNTAwXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9yZGVyUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgb3JkZXJJRDogc3RyaW5nXG4gIG9yZGVyOiBPcmRlclxuICBwYWdlOiBSZWNvcmQ8c3RyaW5nLCBQYWdlRWxlbWVudD5cbiAgY3VycmVudEZvcm06IEhUTUxFbGVtZW50XG4gIHNlY29uZFRpY2tlcjogbnVtYmVyXG4gIHJlZnJlc2hPblBvcHVwQ2xvc2U6IGJvb2xlYW5cbiAgYWNjZWxlcmF0ZU9yZGVyRm9ybTogQWNjZWxlcmF0ZU9yZGVyRm9ybVxuICBzdGFtcGVyczogUGFnZUVsZW1lbnRbXVxuXG4gIGNvbnN0cnVjdG9yIChtYWluOiBIVE1MRWxlbWVudCkge1xuICAgIHN1cGVyKClcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMobWFpbilcbiAgICB0aGlzLnN0YW1wZXJzID0gRG9jLmFwcGx5U2VsZWN0b3IobWFpbiwgJ1tkYXRhLXN0YW1wXScpXG4gICAgLy8gRmluZCB0aGUgb3JkZXJcbiAgICB0aGlzLm9yZGVySUQgPSBtYWluLmRhdGFzZXQub2lkIHx8ICcnXG5cbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXMocGFnZS5tYXRjaENhcmRUbXBsKVxuXG4gICAgY29uc3Qgc2V0U3RhbXAgPSAoKSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IHNwYW4gb2YgdGhpcy5zdGFtcGVycykge1xuICAgICAgICBzcGFuLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShwYXJzZUludChzcGFuLmRhdGFzZXQuc3RhbXAgfHwgJycpKVxuICAgICAgfVxuICAgIH1cbiAgICBzZXRTdGFtcCgpXG5cbiAgICBwYWdlLmZvcm1zLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtLWNsb3NlcicpLmZvckVhY2goZWwgPT4ge1xuICAgICAgRG9jLmJpbmQoZWwsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMucmVmcmVzaE9uUG9wdXBDbG9zZSkge1xuICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gICAgICB9KVxuICAgIH0pXG5cbiAgICAvLyBTb21lIHN0YXRpYyBlbGVtZW50cyBvbiB0aGlzIHBhZ2UgY29udGFpbiBhc3NldHMgdGhhdCBjYW4gYmUgbGlua2VkXG4gICAgLy8gdG8gYmxvY2tjaGFpbiBleHBsb3JlcnMgKHN1Y2ggYXMgRXRoZXJzY2FuKSBzbyB1c2VycyBjYW4gZWFzaWx5XG4gICAgLy8gZXhhbWluZSBmdW5kaW5nL2FjY2VsZXJhdGlvbiBjb2lucyBkYXRhIHRoZXJlLiBXZSdkIG5lZWQgdG8gc2V0IHVwXG4gICAgLy8gc3VjaCBoeXBlcmxpbmtzIGhlcmUuXG4gICAgbWFpbi5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1leHBsb3Jlci1pZF0nKS5mb3JFYWNoKChsaW5rOiBQYWdlRWxlbWVudCkgPT4ge1xuICAgICAgY29uc3QgYXNzZXRJRCA9IHBhcnNlSW50KGxpbmsuZGF0YXNldC5leHBsb3JlcklkIHx8ICcnKVxuICAgICAgc2V0Q29pbkhyZWYoYXNzZXRJRCwgbGluaylcbiAgICB9KVxuXG4gICAgaWYgKHBhZ2UuY2FuY2VsQnR0bikge1xuICAgICAgRG9jLmJpbmQocGFnZS5jYW5jZWxCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5jYW5jZWxGb3JtKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBEb2MuYmluZChwYWdlLmFjY2VsZXJhdGVCdHRuLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLnNob3dBY2NlbGVyYXRlRm9ybSgpXG4gICAgfSlcblxuICAgIGNvbnN0IHN1Y2Nlc3MgPSAoKSA9PiB7XG4gICAgICB0aGlzLnJlZnJlc2hPblBvcHVwQ2xvc2UgPSB0cnVlXG4gICAgfVxuICAgIC8vIERvIG5vdCBjYWxsIGNsZWFuVGVtcGxhdGVzIGJlZm9yZSBjcmVhdGluZyB0aGUgQWNjZWxlcmF0ZU9yZGVyRm9ybVxuICAgIHNldE9wdGlvblRlbXBsYXRlcyhwYWdlKVxuICAgIHRoaXMuYWNjZWxlcmF0ZU9yZGVyRm9ybSA9IG5ldyBBY2NlbGVyYXRlT3JkZXJGb3JtKHBhZ2UuYWNjZWxlcmF0ZUZvcm0sIHN1Y2Nlc3MpXG4gICAgRG9jLmNsZWFuVGVtcGxhdGVzKHBhZ2UuYm9vbGVhbk9wdFRtcGwsIHBhZ2UucmFuZ2VPcHRUbXBsLCBwYWdlLm9yZGVyT3B0VG1wbClcblxuICAgIC8vIElmIHRoZSB1c2VyIGNsaWNrcyBvdXRzaWRlIG9mIGEgZm9ybSwgaXQgc2hvdWxkIGNsb3NlIHRoZSBwYWdlIG92ZXJsYXkuXG4gICAgRG9jLmJpbmQocGFnZS5mb3JtcywgJ21vdXNlZG93bicsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoIURvYy5tb3VzZUluRWxlbWVudChlLCB0aGlzLmN1cnJlbnRGb3JtKSkge1xuICAgICAgICBpZiAodGhpcy5yZWZyZXNoT25Qb3B1cENsb3NlKSB7XG4gICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gQ2FuY2VsIG9yZGVyIGZvcm1cbiAgICBiaW5kRm9ybShwYWdlLmNhbmNlbEZvcm0sIHBhZ2UuY2FuY2VsU3VibWl0LCBhc3luYyAoKSA9PiB7IHRoaXMuc3VibWl0Q2FuY2VsKCkgfSlcblxuICAgIHRoaXMuc2Vjb25kVGlja2VyID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHNldFN0YW1wKClcbiAgICB9LCAxMDAwMCkgLy8gdXBkYXRlIGV2ZXJ5IDEwIHNlY29uZHNcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBvcmRlcjogKG5vdGU6IE9yZGVyTm90ZSkgPT4geyB0aGlzLmhhbmRsZU9yZGVyTm90ZShub3RlKSB9LFxuICAgICAgbWF0Y2g6IChub3RlOiBNYXRjaE5vdGUpID0+IHsgdGhpcy5oYW5kbGVNYXRjaE5vdGUobm90ZSkgfVxuICAgIH0pXG5cbiAgICB0aGlzLnN0YXJ0KClcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0ICgpIHtcbiAgICBsZXQgb3JkID0gYXBwKCkub3JkZXIodGhpcy5vcmRlcklEKVxuICAgIC8vIGFwcCgpLm9yZGVyIGNhbiBvbmx5IGFjY2VzcyBhY3RpdmUgb3JkZXJzLiBJZiB0aGUgb3JkZXIgaXMgbm90IGFjdGl2ZSxcbiAgICAvLyB3ZSdsbCBuZWVkIHRvIGdldCB0aGUgZGF0YSBmcm9tIHRoZSBkYXRhYmFzZS5cbiAgICBpZiAob3JkKSB0aGlzLm9yZGVyID0gb3JkXG4gICAgZWxzZSB7XG4gICAgICBvcmQgPSBhd2FpdCB0aGlzLmZldGNoT3JkZXIoKVxuICAgIH1cbiAgICAvLyBTd2FwIG91dCB0aGUgZG90LW5vdGF0aW9uIHN5bWJvbHMgd2l0aCB0b2tlbi1hd2FyZSBzeW1ib2xzLlxuICAgIHRoaXMucGFnZS5ta3RCYXNlU3ltYm9sLnJlcGxhY2VXaXRoKERvYy5zeW1ib2xpemUoYXBwKCkuYXNzZXRzW29yZC5iYXNlSURdKSlcbiAgICB0aGlzLnBhZ2UubWt0UXVvdGVTeW1ib2wucmVwbGFjZVdpdGgoRG9jLnN5bWJvbGl6ZShhcHAoKS5hc3NldHNbb3JkLnF1b3RlSURdKSlcblxuICAgIHRoaXMuc2V0QWNjZWxlcmF0aW9uQnV0dG9uVmlzKClcbiAgICB0aGlzLnNob3dNYXRjaENhcmRzKClcbiAgfVxuXG4gIHVubG9hZCAoKSB7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLnNlY29uZFRpY2tlcilcbiAgfVxuXG4gIC8qIGZldGNoT3JkZXIgZmV0Y2hlcyB0aGUgb3JkZXIgZnJvbSB0aGUgY2xpZW50LiAqL1xuICBhc3luYyBmZXRjaE9yZGVyICgpOiBQcm9taXNlPE9yZGVyPiB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvb3JkZXInLCB0aGlzLm9yZGVySUQpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHRocm93IHJlcy5tc2dcbiAgICB0aGlzLm9yZGVyID0gcmVzLm9yZGVyXG4gICAgcmV0dXJuIHRoaXMub3JkZXJcbiAgfVxuXG4gIC8qXG4gICAqIHNldEltbXV0YWJsZU1hdGNoQ2FyZEVsZW1lbnRzIHNldHMgdGhlIG1hdGNoIGNhcmQgZWxlbWVudHMgdGhhdCBhcmUgbmV2ZXJcbiAgICogY2hhbmdlZC5cbiAgICovXG4gIHNldEltbXV0YWJsZU1hdGNoQ2FyZEVsZW1lbnRzIChtYXRjaENhcmQ6IEhUTUxFbGVtZW50LCBtYXRjaDogTWF0Y2gpIHtcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUobWF0Y2hDYXJkKVxuXG4gICAgdG1wbC5tYXRjaElELnRleHRDb250ZW50ID0gbWF0Y2gubWF0Y2hJRFxuXG4gICAgY29uc3QgdGltZSA9IG5ldyBEYXRlKG1hdGNoLnN0YW1wKVxuICAgIHRtcGwubWF0Y2hUaW1lLnRleHRDb250ZW50ID0gdGltZS50b0xvY2FsZVRpbWVTdHJpbmcoRG9jLmxhbmd1YWdlcygpLCB7XG4gICAgICB5ZWFyOiAnbnVtZXJpYycsXG4gICAgICBtb250aDogJ3Nob3J0JyxcbiAgICAgIGRheTogJ251bWVyaWMnXG4gICAgfSlcblxuICAgIHRtcGwubWF0Y2hUaW1lQWdvLmRhdGFzZXQuc3RhbXAgPSBtYXRjaC5zdGFtcC50b1N0cmluZygpXG4gICAgdG1wbC5tYXRjaFRpbWVBZ28udGV4dENvbnRlbnQgPSBEb2MudGltZVNpbmNlKG1hdGNoLnN0YW1wKVxuICAgIHRoaXMuc3RhbXBlcnMucHVzaCh0bXBsLm1hdGNoVGltZUFnbylcblxuICAgIGNvbnN0IG9yZGVyUG9ydGlvbiA9IE9yZGVyVXRpbC5vcmRlclBvcnRpb24odGhpcy5vcmRlciwgbWF0Y2gpXG4gICAgY29uc3QgYmFzZVN5bWJvbCA9IERvYy5iaXBTeW1ib2wodGhpcy5vcmRlci5iYXNlSUQpXG4gICAgY29uc3QgcXVvdGVTeW1ib2wgPSBEb2MuYmlwU3ltYm9sKHRoaXMub3JkZXIucXVvdGVJRClcbiAgICBjb25zdCBiYXNlVW5pdEluZm8gPSBhcHAoKS51bml0SW5mbyh0aGlzLm9yZGVyLmJhc2VJRClcbiAgICBjb25zdCBxdW90ZVVuaXRJbmZvID0gYXBwKCkudW5pdEluZm8odGhpcy5vcmRlci5xdW90ZUlEKVxuICAgIGNvbnN0IFtiVW5pdCwgcVVuaXRdID0gW2Jhc2VVbml0SW5mby5jb252ZW50aW9uYWwudW5pdC50b0xvd2VyQ2FzZSgpLCBxdW90ZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0LnRvTG93ZXJDYXNlKCldXG4gICAgY29uc3QgcXVvdGVBbW91bnQgPSBPcmRlclV0aWwuYmFzZVRvUXVvdGUobWF0Y2gucmF0ZSwgbWF0Y2gucXR5KVxuXG4gICAgaWYgKG1hdGNoLmlzQ2FuY2VsKSB7XG4gICAgICBEb2Muc2hvdyh0bXBsLmNhbmNlbEluZm9EaXYpXG4gICAgICBEb2MuaGlkZSh0bXBsLmluZm9EaXYsIHRtcGwuc3RhdHVzLCB0bXBsLnN0YXR1c0hkcilcblxuICAgICAgaWYgKHRoaXMub3JkZXIuc2VsbCkge1xuICAgICAgICB0bXBsLmNhbmNlbEFtb3VudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWF0Y2gucXR5LCBiYXNlVW5pdEluZm8pXG4gICAgICAgIHRtcGwuY2FuY2VsSWNvbi5zcmMgPSBEb2MubG9nb1BhdGhGcm9tSUQodGhpcy5vcmRlci5iYXNlSUQpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0bXBsLmNhbmNlbEFtb3VudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocXVvdGVBbW91bnQsIHF1b3RlVW5pdEluZm8pXG4gICAgICAgIHRtcGwuY2FuY2VsSWNvbi5zcmMgPSBEb2MubG9nb1BhdGhGcm9tSUQodGhpcy5vcmRlci5xdW90ZUlEKVxuICAgICAgfVxuXG4gICAgICB0bXBsLmNhbmNlbE9yZGVyUG9ydGlvbi50ZXh0Q29udGVudCA9IG9yZGVyUG9ydGlvblxuXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBEb2Muc2hvdyh0bXBsLmluZm9EaXYpXG4gICAgRG9jLmhpZGUodG1wbC5jYW5jZWxJbmZvRGl2KVxuXG4gICAgdG1wbC5vcmRlclBvcnRpb24udGV4dENvbnRlbnQgPSBvcmRlclBvcnRpb25cblxuICAgIGlmIChtYXRjaC5zaWRlID09PSBPcmRlclV0aWwuTWFrZXIpIHtcbiAgICAgIHRtcGwuc2lkZS50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX01BS0VSKVxuICAgICAgRG9jLnNob3coXG4gICAgICAgIHRtcGwubWFrZXJTd2FwWW91LFxuICAgICAgICB0bXBsLm1ha2VyUmVkZWVtWW91LFxuICAgICAgICB0bXBsLnRha2VyU3dhcFRoZW0sXG4gICAgICAgIHRtcGwudGFrZXJSZWRlZW1UaGVtXG4gICAgICApXG4gICAgICBEb2MuaGlkZShcbiAgICAgICAgdG1wbC50YWtlclN3YXBZb3UsXG4gICAgICAgIHRtcGwudGFrZXJSZWRlZW1Zb3UsXG4gICAgICAgIHRtcGwubWFrZXJTd2FwVGhlbSxcbiAgICAgICAgdG1wbC5tYWtlclJlZGVlbVRoZW1cbiAgICAgIClcbiAgICB9IGVsc2Uge1xuICAgICAgdG1wbC5zaWRlLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfVEFLRVIpXG4gICAgICBEb2MuaGlkZShcbiAgICAgICAgdG1wbC5tYWtlclN3YXBZb3UsXG4gICAgICAgIHRtcGwubWFrZXJSZWRlZW1Zb3UsXG4gICAgICAgIHRtcGwudGFrZXJTd2FwVGhlbSxcbiAgICAgICAgdG1wbC50YWtlclJlZGVlbVRoZW1cbiAgICAgIClcbiAgICAgIERvYy5zaG93KFxuICAgICAgICB0bXBsLnRha2VyU3dhcFlvdSxcbiAgICAgICAgdG1wbC50YWtlclJlZGVlbVlvdSxcbiAgICAgICAgdG1wbC5tYWtlclN3YXBUaGVtLFxuICAgICAgICB0bXBsLm1ha2VyUmVkZWVtVGhlbVxuICAgICAgKVxuICAgIH1cblxuICAgIGlmICgobWF0Y2guc2lkZSA9PT0gT3JkZXJVdGlsLk1ha2VyICYmIHRoaXMub3JkZXIuc2VsbCkgfHxcbiAgICAgICAgICAobWF0Y2guc2lkZSA9PT0gT3JkZXJVdGlsLlRha2VyICYmICF0aGlzLm9yZGVyLnNlbGwpKSB7XG4gICAgICB0bXBsLm1ha2VyU3dhcEFzc2V0LnRleHRDb250ZW50ID0gYlVuaXRcbiAgICAgIHRtcGwudGFrZXJTd2FwQXNzZXQudGV4dENvbnRlbnQgPSBxVW5pdFxuICAgICAgdG1wbC5tYWtlclJlZGVlbUFzc2V0LnRleHRDb250ZW50ID0gcVVuaXRcbiAgICAgIHRtcGwudGFrZXJSZWRlZW1Bc3NldC50ZXh0Q29udGVudCA9IGJVbml0XG4gICAgfSBlbHNlIHtcbiAgICAgIHRtcGwubWFrZXJTd2FwQXNzZXQudGV4dENvbnRlbnQgPSBxVW5pdFxuICAgICAgdG1wbC50YWtlclN3YXBBc3NldC50ZXh0Q29udGVudCA9IGJVbml0XG4gICAgICB0bXBsLm1ha2VyUmVkZWVtQXNzZXQudGV4dENvbnRlbnQgPSBiVW5pdFxuICAgICAgdG1wbC50YWtlclJlZGVlbUFzc2V0LnRleHRDb250ZW50ID0gcVVuaXRcbiAgICB9XG5cbiAgICBjb25zdCByYXRlID0gYXBwKCkuY29udmVudGlvbmFsUmF0ZSh0aGlzLm9yZGVyLmJhc2VJRCwgdGhpcy5vcmRlci5xdW90ZUlELCBtYXRjaC5yYXRlKVxuICAgIHRtcGwucmF0ZS50ZXh0Q29udGVudCA9IGAke3JhdGV9ICR7YlVuaXR9LyR7cVVuaXR9YFxuXG4gICAgaWYgKHRoaXMub3JkZXIuc2VsbCkge1xuICAgICAgdG1wbC5yZWZ1bmRBc3NldC50ZXh0Q29udGVudCA9IGJhc2VTeW1ib2xcbiAgICAgIHRtcGwuZnJvbUFtb3VudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWF0Y2gucXR5LCBiYXNlVW5pdEluZm8pXG4gICAgICB0bXBsLnRvQW1vdW50LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShxdW90ZUFtb3VudCwgcXVvdGVVbml0SW5mbylcbiAgICAgIHRtcGwuZnJvbUljb24uc3JjID0gRG9jLmxvZ29QYXRoRnJvbUlEKHRoaXMub3JkZXIuYmFzZUlEKVxuICAgICAgdG1wbC50b0ljb24uc3JjID0gRG9jLmxvZ29QYXRoRnJvbUlEKHRoaXMub3JkZXIucXVvdGVJRClcbiAgICB9IGVsc2Uge1xuICAgICAgdG1wbC5yZWZ1bmRBc3NldC50ZXh0Q29udGVudCA9IHF1b3RlU3ltYm9sXG4gICAgICB0bXBsLmZyb21BbW91bnQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHF1b3RlQW1vdW50LCBxdW90ZVVuaXRJbmZvKVxuICAgICAgdG1wbC50b0Ftb3VudC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUobWF0Y2gucXR5LCBiYXNlVW5pdEluZm8pXG4gICAgICB0bXBsLmZyb21JY29uLnNyYyA9IERvYy5sb2dvUGF0aEZyb21JRCh0aGlzLm9yZGVyLnF1b3RlSUQpXG4gICAgICB0bXBsLnRvSWNvbi5zcmMgPSBEb2MubG9nb1BhdGhGcm9tSUQodGhpcy5vcmRlci5iYXNlSUQpXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogc2V0TXV0YWJsZU1hdGNoQ2FyZEVsZW1lbnRzIHNldHMgdGhlIG1hdGNoIGNhcmQgZWxlbWVudHMgd2hpY2ggbWF5IGdldFxuICAgKiB1cGRhdGVkIG9uIGVhY2ggdXBkYXRlIHRvIHRoZSBtYXRjaC5cbiAgICovXG4gIHNldE11dGFibGVNYXRjaENhcmRFbGVtZW50cyAobWF0Y2hDYXJkOiBIVE1MRWxlbWVudCwgbTogTWF0Y2gpIHtcbiAgICBpZiAobS5pc0NhbmNlbCkgcmV0dXJuXG5cbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUobWF0Y2hDYXJkKVxuICAgIHRtcGwuc3RhdHVzLnRleHRDb250ZW50ID0gT3JkZXJVdGlsLm1hdGNoU3RhdHVzU3RyaW5nKG0pXG5cbiAgICBjb25zdCB0cnlTaG93Q29pbiA9IChwZW5kaW5nRWw6IFBhZ2VFbGVtZW50LCBjb2luTGluazogUGFnZUVsZW1lbnQsIGNvaW46IENvaW4pID0+IHtcbiAgICAgIGlmICghY29pbikge1xuICAgICAgICBEb2MuaGlkZShjb2luTGluaylcbiAgICAgICAgRG9jLnNob3cocGVuZGluZ0VsKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvaW5MaW5rLnRleHRDb250ZW50ID0gZm9ybWF0Q29pbklEKGNvaW4uc3RyaW5nSUQpXG4gICAgICBjb2luTGluay5kYXRhc2V0LmV4cGxvcmVyQ29pbiA9IGNvaW4uc3RyaW5nSURcbiAgICAgIHNldENvaW5IcmVmKGNvaW4uYXNzZXRJRCwgY29pbkxpbmspXG4gICAgICBEb2Muc2hvdyhjb2luTGluaylcbiAgICAgIERvYy5oaWRlKHBlbmRpbmdFbClcbiAgICB9XG5cbiAgICB0cnlTaG93Q29pbih0bXBsLm1ha2VyU3dhcFBlbmRpbmcsIHRtcGwubWFrZXJTd2FwQ29pbiwgbWFrZXJTd2FwQ29pbihtKSlcbiAgICB0cnlTaG93Q29pbih0bXBsLnRha2VyU3dhcFBlbmRpbmcsIHRtcGwudGFrZXJTd2FwQ29pbiwgdGFrZXJTd2FwQ29pbihtKSlcbiAgICB0cnlTaG93Q29pbih0bXBsLm1ha2VyUmVkZWVtUGVuZGluZywgdG1wbC5tYWtlclJlZGVlbUNvaW4sIG1ha2VyUmVkZWVtQ29pbihtKSlcbiAgICB0cnlTaG93Q29pbih0bXBsLnRha2VyUmVkZWVtUGVuZGluZywgdG1wbC50YWtlclJlZGVlbUNvaW4sIHRha2VyUmVkZWVtQ29pbihtKSlcbiAgICBpZiAoIW0ucmVmdW5kKSB7XG4gICAgICAvLyBTcGVjaWFsIG1lc3NhZ2luZyBmb3IgcGVuZGluZyByZWZ1bmRzLlxuICAgICAgbGV0IGxvY2tUaW1lID0gbG9ja1RpbWVNYWtlck1zXG4gICAgICBpZiAobS5zaWRlID09PSBPcmRlclV0aWwuVGFrZXIpIGxvY2tUaW1lID0gbG9ja1RpbWVUYWtlck1zXG4gICAgICBjb25zdCByZWZ1bmRBZnRlciA9IG5ldyBEYXRlKG0uc3RhbXAgKyBsb2NrVGltZSlcbiAgICAgIGlmIChEYXRlLm5vdygpID4gcmVmdW5kQWZ0ZXIuZ2V0VGltZSgpKSB0bXBsLnJlZnVuZFBlbmRpbmcudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9SRUZVTkRfSU1NSU5FTlQpXG4gICAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgcmVmdW5kQWZ0ZXJTdHIgPSByZWZ1bmRBZnRlci50b0xvY2FsZVRpbWVTdHJpbmcoRG9jLmxhbmd1YWdlcygpLCB7XG4gICAgICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgICAgICAgIG1vbnRoOiAnc2hvcnQnLFxuICAgICAgICAgIGRheTogJ251bWVyaWMnXG4gICAgICAgIH0pXG4gICAgICAgIHRtcGwucmVmdW5kUGVuZGluZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX1JFRlVORF9XSUxMX0hBUFBFTl9BRlRFUiwgeyByZWZ1bmRBZnRlclRpbWU6IHJlZnVuZEFmdGVyU3RyIH0pXG4gICAgICB9XG4gICAgICBEb2MuaGlkZSh0bXBsLnJlZnVuZENvaW4pXG4gICAgICBEb2Muc2hvdyh0bXBsLnJlZnVuZFBlbmRpbmcpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRtcGwucmVmdW5kQ29pbi50ZXh0Q29udGVudCA9IGZvcm1hdENvaW5JRChtLnJlZnVuZC5zdHJpbmdJRClcbiAgICAgIHRtcGwucmVmdW5kQ29pbi5kYXRhc2V0LmV4cGxvcmVyQ29pbiA9IG0ucmVmdW5kLnN0cmluZ0lEXG4gICAgICBzZXRDb2luSHJlZihtLnJlZnVuZC5hc3NldElELCB0bXBsLnJlZnVuZENvaW4pXG4gICAgICBEb2Muc2hvdyh0bXBsLnJlZnVuZENvaW4pXG4gICAgICBEb2MuaGlkZSh0bXBsLnJlZnVuZFBlbmRpbmcpXG4gICAgfVxuXG4gICAgaWYgKG0uc3RhdHVzID09PSBPcmRlclV0aWwuTWFrZXJTd2FwQ2FzdCAmJiAhbS5yZXZva2VkICYmICFtLnJlZnVuZCkge1xuICAgICAgY29uc3QgYyA9IG1ha2VyU3dhcENvaW4obSlcbiAgICAgIHRtcGwubWFrZXJTd2FwTXNnLnRleHRDb250ZW50ID0gY29uZmlybWF0aW9uU3RyaW5nKGMpXG4gICAgICBEb2MuaGlkZSh0bXBsLnRha2VyU3dhcE1zZywgdG1wbC5tYWtlclJlZGVlbU1zZywgdG1wbC50YWtlclJlZGVlbU1zZylcbiAgICAgIERvYy5zaG93KHRtcGwubWFrZXJTd2FwTXNnKVxuICAgIH0gZWxzZSBpZiAobS5zdGF0dXMgPT09IE9yZGVyVXRpbC5UYWtlclN3YXBDYXN0ICYmICFtLnJldm9rZWQgJiYgIW0ucmVmdW5kKSB7XG4gICAgICBjb25zdCBjID0gdGFrZXJTd2FwQ29pbihtKVxuICAgICAgdG1wbC50YWtlclN3YXBNc2cudGV4dENvbnRlbnQgPSBjb25maXJtYXRpb25TdHJpbmcoYylcbiAgICAgIERvYy5oaWRlKHRtcGwubWFrZXJTd2FwTXNnLCB0bXBsLm1ha2VyUmVkZWVtTXNnLCB0bXBsLnRha2VyUmVkZWVtTXNnKVxuICAgICAgRG9jLnNob3codG1wbC50YWtlclN3YXBNc2cpXG4gICAgfSBlbHNlIGlmIChpbkNvbmZpcm1pbmdNYWtlclJlZGVlbShtKSAmJiAhbS5yZXZva2VkICYmICFtLnJlZnVuZCkge1xuICAgICAgdG1wbC5tYWtlclJlZGVlbU1zZy50ZXh0Q29udGVudCA9IGNvbmZpcm1hdGlvblN0cmluZyhtLnJlZGVlbSlcbiAgICAgIERvYy5oaWRlKHRtcGwubWFrZXJTd2FwTXNnLCB0bXBsLnRha2VyU3dhcE1zZywgdG1wbC50YWtlclJlZGVlbU1zZylcbiAgICAgIERvYy5zaG93KHRtcGwubWFrZXJSZWRlZW1Nc2cpXG4gICAgfSBlbHNlIGlmIChpbkNvbmZpcm1pbmdUYWtlclJlZGVlbShtKSAmJiAhbS5yZXZva2VkICYmICFtLnJlZnVuZCkge1xuICAgICAgdG1wbC50YWtlclJlZGVlbU1zZy50ZXh0Q29udGVudCA9IGNvbmZpcm1hdGlvblN0cmluZyhtLnJlZGVlbSlcbiAgICAgIERvYy5oaWRlKHRtcGwubWFrZXJTd2FwTXNnLCB0bXBsLnRha2VyU3dhcE1zZywgdG1wbC5tYWtlclJlZGVlbU1zZylcbiAgICAgIERvYy5zaG93KHRtcGwudGFrZXJSZWRlZW1Nc2cpXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5oaWRlKHRtcGwubWFrZXJTd2FwTXNnLCB0bXBsLnRha2VyU3dhcE1zZywgdG1wbC5tYWtlclJlZGVlbU1zZywgdG1wbC50YWtlclJlZGVlbU1zZylcbiAgICB9XG5cbiAgICBpZiAoIW0ucmV2b2tlZCkge1xuICAgICAgLy8gTWF0Y2ggaXMgc3RpbGwgZm9sbG93aW5nIHRoZSB1c3VhbCBzdWNjZXNzLXBhdGgsIGl0IGlzIGRlc2lyYWJsZSBmb3IgdGhlXG4gICAgICAvLyB1c2VyIHRvIHNlZSBpdCBpbiBmdWxsIChldmVuIGlmIHRvIGxlYXJuIGhvdyBhdG9taWMgc3dhcCBpcyBzdXBwb3NlZCB0b1xuICAgICAgLy8gd29yaykuXG5cbiAgICAgIERvYy5zZXRWaXMobWFrZXJTd2FwQ29pbihtKSB8fCBtLmFjdGl2ZSwgdG1wbC5tYWtlclN3YXApXG4gICAgICBEb2Muc2V0VmlzKHRha2VyU3dhcENvaW4obSkgfHwgbS5hY3RpdmUsIHRtcGwudGFrZXJTd2FwKVxuICAgICAgRG9jLnNldFZpcyhtYWtlclJlZGVlbUNvaW4obSkgfHwgbS5hY3RpdmUsIHRtcGwubWFrZXJSZWRlZW0pXG4gICAgICAvLyBXaGVuIG1ha2VyIGlzbid0IGF3YXJlIG9mIHRha2VyIHJlZGVlbSBjb2luLCBvbmNlIHRoZSBtYXRjaCBiZWNvbWVzIGluYWN0aXZlXG4gICAgICAvLyAobm90aGluZyBlbHNlIG1ha2VyIGlzIGV4cGVjdGVkIHRvIGRvIGluIHRoaXMgbWF0Y2gpIGp1c3QgaGlkZSB0YWtlciByZWRlZW0uXG4gICAgICBEb2Muc2V0VmlzKHRha2VyUmVkZWVtQ29pbihtKSB8fCBtLmFjdGl2ZSwgdG1wbC50YWtlclJlZGVlbSlcbiAgICAgIC8vIFJlZnVuZGluZyBpc24ndCBhIHVzdWFsIHBhcnQgb2Ygc3VjY2Vzcy1wYXRoLCBidXQgZG9uJ3QgcnVsZSBpdCBvdXQuXG4gICAgICBEb2Muc2V0VmlzKG0ucmVmdW5kLCB0bXBsLnJlZnVuZClcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTWF0Y2ggZGl2ZXJnZWQgZnJvbSB0aGUgdXN1YWwgc3VjY2Vzcy1wYXRoLCBzaW5jZSB0aGlzIGNvdWxkIGhhdmUgaGFwcGVuZWRcbiAgICAgIC8vIGF0IGFueSBzdGVwIGl0IGlzIGhhcmQgKG1heWJlIGltcG9zc2libGUpIHRvIHByZWRpY3QgdGhlIGZpbmFsIHN0YXRlIHRoaXNcbiAgICAgIC8vIG1hdGNoIHdpbGwgZW5kIHVwIGluLCBzbyBzaG93IG9ubHkgc3RlcHMgdGhhdCBhbHJlYWR5IGhhcHBlbmVkIHBsdXMgYWxsXG4gICAgICAvLyB0aGUgcG9zc2liaWxpdGllcyBvbiB0aGUgbmV4dCBzdGVwIGFoZWFkLlxuXG4gICAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIHN3YXAgY29pbnMgYWZ0ZXIgcmV2b2NhdGlvbiwgd2Ugd29uJ3Qgc2hvdyB0aGUgcGVuZGluZyBtZXNzYWdlLlxuICAgICAgRG9jLnNldFZpcyhtYWtlclN3YXBDb2luKG0pLCB0bXBsLm1ha2VyU3dhcClcbiAgICAgIERvYy5zZXRWaXModGFrZXJTd2FwQ29pbihtKSwgdG1wbC50YWtlclN3YXApXG4gICAgICBjb25zdCB0YWtlclJlZnVuZHNBZnRlciA9IG5ldyBEYXRlKG0uc3RhbXAgKyBsb2NrVGltZVRha2VyTXMpXG4gICAgICBjb25zdCB0YWtlckxvY2tUaW1lRXhwaXJlZCA9IERhdGUubm93KCkgPiB0YWtlclJlZnVuZHNBZnRlci5nZXRUaW1lKClcbiAgICAgIC8vIFdoZW4gbWF0Y2ggaXMgcmV2b2tlZCBhbmQgYm90aCBzd2FwcyBhcmUgcHJlc2VudCwgbWFrZXIgcmVkZWVtIG1pZ2h0IHN0aWxsIHNob3cgdXA6XG4gICAgICAvLyAtIGFzIG1ha2VyLCB3ZSdsbCB0cnkgdG8gcmVkZWVtIHVudGlsIHRha2VyIGxvY2t0aW1lIGV4cGlyZXMgKGlmIHRha2VyIHJlZnVuZHNcbiAgICAgIC8vICAgd2Ugd29uJ3QgYmUgYWJsZSB0byByZWRlZW07IGV2ZW4gaWYgdGFrZXIgaGFzbid0IHJlZnVuZGVkIGp1c3QgeWV0IC0gaXRcbiAgICAgIC8vICAgYmVjb21lcyB0b28gZGFuZ2Vyb3VzIHRvIHJlZGVlbSBhZnRlciB0YWtlciBsb2NrdGltZSBleHBpcmVkIGJlY2F1c2UgbWFrZXJcbiAgICAgIC8vICAgcmV2ZWFscyBoaXMgc2VjcmV0IHdoZW4gcmVkZWVtaW5nLCBhbmQgdGFrZXIgbWlnaHQgYmUgYWJsZSB0byBzdWJtaXQgYm90aFxuICAgICAgLy8gICByZWRlZW0gYW5kIHJlZnVuZCB0cmFuc2FjdGlvbnMgYmVmb3JlIG1ha2VyJ3MgcmVkZWVtIGdldHMgbWluZWQpLCBzbyB3ZSdsbFxuICAgICAgLy8gICBoYXZlIHRvIHNob3cgcmVkZWVtIHBlbmRpbmcgZWxlbWVudCB1bnRpbCBtYWtlciByZWRlZW0gc2hvd3MgdXAsIG9yIHVudGlsXG4gICAgICAvLyAgIHdlIGdpdmUgdXAgb24gcmVkZWVtaW5nIGR1ZSB0byB0YWtlciBsb2NrdGltZSBleHBpcnkuXG4gICAgICAvLyAtIGFzIHRha2VyLCB3ZSBzaG91bGQgZXhwZWN0IG1ha2VyIHJlZGVlbWluZyBhbnkgdGltZSwgc28gd2UnbGwgaGF2ZSB0byBzaG93XG4gICAgICAvLyAgIHJlZGVlbSBwZW5kaW5nIGVsZW1lbnQgdW50aWwgbWFrZXIgcmVkZWVtIHNob3dzIHVwLCBvciB1bnRpbCB3ZSByZWZ1bmQuXG4gICAgICBEb2Muc2V0VmlzKG1ha2VyUmVkZWVtQ29pbihtKSB8fCAodGFrZXJTd2FwQ29pbihtKSAmJiBtLmFjdGl2ZSAmJiAhbS5yZWZ1bmQgJiYgIXRha2VyTG9ja1RpbWVFeHBpcmVkKSwgdG1wbC5tYWtlclJlZGVlbSlcbiAgICAgIC8vIFdoZW4gbWFrZXIgaXNuJ3QgYXdhcmUgb2YgdGFrZXIgcmVkZWVtIGNvaW4sIG9uY2UgdGhlIG1hdGNoIGJlY29tZXMgaW5hY3RpdmVcbiAgICAgIC8vIChub3RoaW5nIGVsc2UgbWFrZXIgaXMgZXhwZWN0ZWQgdG8gZG8gaW4gdGhpcyBtYXRjaCkganVzdCBoaWRlIHRha2VyIHJlZGVlbS5cbiAgICAgIERvYy5zZXRWaXModGFrZXJSZWRlZW1Db2luKG0pIHx8IChtYWtlclJlZGVlbUNvaW4obSkgJiYgbS5hY3RpdmUgJiYgIW0ucmVmdW5kKSwgdG1wbC50YWtlclJlZGVlbSlcbiAgICAgIC8vIEFzIHRha2VyLCBzaG93IHJlZnVuZCBwbGFjZWhvbGRlciBvbmx5IGlmIHdlIGhhdmUgb3V0c3RhbmRpbmcgc3dhcCB0byByZWZ1bmQuXG4gICAgICAvLyBUaGVyZSBpcyBubyBuZWVkIHRvIHdhaXQgZm9yIGFueXRoaW5nIGVsc2UsIHdlIGNhbiBzaG93IHJlZnVuZCBwbGFjZWhvbGRlclxuICAgICAgLy8gKHRvIGluZm9ybSB0aGUgdXNlciB0aGF0IGl0IGlzIGxpa2VseSB0byBoYXBwZW4pIHJpZ2h0IGFmdGVyIG1hdGNoIHJldm9jYXRpb24uXG4gICAgICBsZXQgZXhwZWN0aW5nUmVmdW5kID0gQm9vbGVhbih0YWtlclN3YXBDb2luKG0pKSAvLyBhcyB0YWtlclxuICAgICAgaWYgKG0uc2lkZSA9PT0gT3JkZXJVdGlsLk1ha2VyKSB7XG4gICAgICAgIC8vIEFzIG1ha2VyLCBzaG93IHJlZnVuZCBwbGFjZWhvbGRlciBvbmx5IGlmIHdlIGhhdmUgb3V0c3RhbmRpbmcgc3dhcCB0byByZWZ1bmQuXG4gICAgICAgIC8vIElmIHdlIGRvbid0IGhhdmUgdGFrZXIgc3dhcCB0aGVyZSBpcyBubyBuZWVkIHRvIHdhaXQgZm9yIGFueXRoaW5nIGVsc2UsIHdlXG4gICAgICAgIC8vIGNhbiBzaG93IHJlZnVuZCBwbGFjZWhvbGRlciAodG8gaW5mb3JtIHRoZSB1c2VyIHRoYXQgaXQgaXMgbGlrZWx5IHRvIGhhcHBlbilcbiAgICAgICAgLy8gcmlnaHQgYWZ0ZXIgbWF0Y2ggcmV2b2NhdGlvbi5cbiAgICAgICAgZXhwZWN0aW5nUmVmdW5kID0gQm9vbGVhbihtYWtlclN3YXBDb2luKG0pKVxuICAgICAgICAvLyBJZiB3ZSBkaXNjb3ZlciB0YWtlciBzd2FwIHdlJ2xsIGJlIHRyeWluZyB0byByZWRlZW0gaXQgKGluc3RlYWQgb2YgdHJ5aW5nXG4gICAgICAgIC8vIHRvIHJlZnVuZCBvdXIgb3duIHN3YXApIHVudGlsIHRha2VyIHJlZnVuZHMsIHNvIHN0YXJ0IHNob3dpbmcgcmVmdW5kXG4gICAgICAgIC8vIHBsYWNlaG9sZGVyIG9ubHkgYWZ0ZXIgdGFrZXIgaXMgZXhwZWN0ZWQgdG8gc3RhcnQgaGlzIHJlZnVuZCBwcm9jZXNzIGluXG4gICAgICAgIC8vIHRoaXMgY2FzZS5cbiAgICAgICAgaWYgKHRha2VyU3dhcENvaW4obSkpIHtcbiAgICAgICAgICBleHBlY3RpbmdSZWZ1bmQgPSBleHBlY3RpbmdSZWZ1bmQgJiYgdGFrZXJMb2NrVGltZUV4cGlyZWRcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgRG9jLnNldFZpcyhtLnJlZnVuZCB8fCAobS5hY3RpdmUgJiYgIW0ucmVkZWVtICYmICFtLmNvdW50ZXJSZWRlZW0gJiYgZXhwZWN0aW5nUmVmdW5kKSwgdG1wbC5yZWZ1bmQpXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogYWRkTmV3TWF0Y2hDYXJkIGFkZHMgYSBuZXcgY2FyZCB0byB0aGUgbGlzdCBvZiBtYXRjaCBjYXJkcy5cbiAgICovXG4gIGFkZE5ld01hdGNoQ2FyZCAobWF0Y2g6IE1hdGNoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IG1hdGNoQ2FyZCA9IHBhZ2UubWF0Y2hDYXJkVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICBhcHAoKS5iaW5kVXJsSGFuZGxlcnMobWF0Y2hDYXJkKVxuICAgIG1hdGNoQ2FyZC5kYXRhc2V0Lm1hdGNoSUQgPSBtYXRjaC5tYXRjaElEXG4gICAgdGhpcy5zZXRJbW11dGFibGVNYXRjaENhcmRFbGVtZW50cyhtYXRjaENhcmQsIG1hdGNoKVxuICAgIHRoaXMuc2V0TXV0YWJsZU1hdGNoQ2FyZEVsZW1lbnRzKG1hdGNoQ2FyZCwgbWF0Y2gpXG4gICAgcGFnZS5tYXRjaEJveC5hcHBlbmRDaGlsZChtYXRjaENhcmQpXG4gIH1cblxuICAvKlxuICAgKiBzaG93TWF0Y2hDYXJkcyBjcmVhdGVzIGNhcmRzIGZvciBlYWNoIG1hdGNoIGluIHRoZSBvcmRlci5cbiAgICovXG4gIHNob3dNYXRjaENhcmRzICgpIHtcbiAgICBjb25zdCBvcmRlciA9IHRoaXMub3JkZXJcbiAgICBpZiAoIW9yZGVyKSByZXR1cm5cbiAgICBpZiAoIW9yZGVyLm1hdGNoZXMpIHJldHVyblxuICAgIG9yZGVyLm1hdGNoZXMuc29ydCgoYSwgYikgPT4gYS5zdGFtcCAtIGIuc3RhbXApXG4gICAgb3JkZXIubWF0Y2hlcy5mb3JFYWNoKChtYXRjaCkgPT4gdGhpcy5hZGROZXdNYXRjaENhcmQobWF0Y2gpKVxuICB9XG5cbiAgLyogc2hvd0NhbmNlbCBzaG93cyBhIGZvcm0gdG8gY29uZmlybSBzdWJtaXNzaW9uIG9mIGEgY2FuY2VsIG9yZGVyLiAqL1xuICBzaG93Q2FuY2VsICgpIHtcbiAgICBjb25zdCBvcmRlciA9IHRoaXMub3JkZXJcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgcmVtYWluaW5nID0gb3JkZXIucXR5IC0gb3JkZXIuZmlsbGVkXG4gICAgY29uc3QgYXNzZXQgPSBPcmRlclV0aWwuaXNNYXJrZXRCdXkob3JkZXIpID8gYXBwKCkuYXNzZXRzW29yZGVyLnF1b3RlSURdIDogYXBwKCkuYXNzZXRzW29yZGVyLmJhc2VJRF1cbiAgICBwYWdlLmNhbmNlbFJlbWFpbi50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUocmVtYWluaW5nLCBhc3NldC51bml0SW5mbylcbiAgICBwYWdlLmNhbmNlbFVuaXQudGV4dENvbnRlbnQgPSBhc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdC50b1VwcGVyQ2FzZSgpXG4gICAgdGhpcy5zaG93Rm9ybShwYWdlLmNhbmNlbEZvcm0pXG4gIH1cblxuICAvKiBzaG93Rm9ybSBzaG93cyBhIG1vZGFsIGZvcm0gd2l0aCBhIGxpdHRsZSBhbmltYXRpb24uICovXG4gIGFzeW5jIHNob3dGb3JtIChmb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIHRoaXMuY3VycmVudEZvcm0gPSBmb3JtXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuY2FuY2VsRm9ybSwgcGFnZS5hY2NlbGVyYXRlRm9ybSlcbiAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gJzEwMDAwcHgnXG4gICAgRG9jLnNob3cocGFnZS5mb3JtcywgZm9ybSlcbiAgICBjb25zdCBzaGlmdCA9IChwYWdlLmZvcm1zLm9mZnNldFdpZHRoICsgZm9ybS5vZmZzZXRXaWR0aCkgLyAyXG4gICAgYXdhaXQgRG9jLmFuaW1hdGUoYW5pbWF0aW9uTGVuZ3RoLCBwcm9ncmVzcyA9PiB7XG4gICAgICBmb3JtLnN0eWxlLnJpZ2h0ID0gYCR7KDEgLSBwcm9ncmVzcykgKiBzaGlmdH1weGBcbiAgICB9LCAnZWFzZU91dEhhcmQnKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMHB4J1xuICB9XG5cbiAgLyogc3VibWl0Q2FuY2VsIHN1Ym1pdHMgYSBjYW5jZWxsYXRpb24gZm9yIHRoZSBvcmRlci4gKi9cbiAgYXN5bmMgc3VibWl0Q2FuY2VsICgpIHtcbiAgICAvLyB0aGlzIHdpbGwgYmUgdGhlIHBhZ2UuY2FuY2VsU3VibWl0IGJ1dHRvbiAoZXZ0LmN1cnJlbnRUYXJnZXQpXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IG9yZGVyID0gdGhpcy5vcmRlclxuICAgIGNvbnN0IHJlcSA9IHtcbiAgICAgIG9yZGVySUQ6IG9yZGVyLmlkXG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5jYW5jZWxGb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2NhbmNlbCcsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSByZXR1cm5cbiAgICBwYWdlLnN0YXR1cy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0NBTkNFTElORylcbiAgICBEb2MuaGlkZShwYWdlLmZvcm1zKVxuICAgIG9yZGVyLmNhbmNlbGxpbmcgPSB0cnVlXG4gIH1cblxuICAvKlxuICAgKiBzZXRBY2NlbGVyYXRpb25CdXR0b25WaXMgc2hvd3MgdGhlIGFjY2VsZXJhdGlvbiBidXR0b24gaWYgdGhlIG9yZGVyIGNhblxuICAgKiBiZSBhY2NlbGVyYXRlZC5cbiAgICovXG4gIHNldEFjY2VsZXJhdGlvbkJ1dHRvblZpcyAoKSB7XG4gICAgY29uc3Qgb3JkZXIgPSB0aGlzLm9yZGVyXG4gICAgaWYgKCFvcmRlcikgcmV0dXJuXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5zZXRWaXMoYXBwKCkuY2FuQWNjZWxlcmF0ZU9yZGVyKG9yZGVyKSwgcGFnZS5hY2NlbGVyYXRlQnR0biwgcGFnZS5hY3Rpb25zTGFiZWwpXG4gIH1cblxuICAvKiBzaG93QWNjZWxlcmF0ZUZvcm0gc2hvd3MgYSBmb3JtIHRvIGFjY2VsZXJhdGUgYW4gb3JkZXIgKi9cbiAgYXN5bmMgc2hvd0FjY2VsZXJhdGVGb3JtICgpIHtcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMucGFnZS5hY2NlbGVyYXRlQnR0bilcbiAgICB0aGlzLmFjY2VsZXJhdGVPcmRlckZvcm0ucmVmcmVzaCh0aGlzLm9yZGVyKVxuICAgIGxvYWRlZCgpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UuYWNjZWxlcmF0ZUZvcm0pXG4gIH1cblxuICAvKlxuICAgKiBoYW5kbGVPcmRlck5vdGUgaXMgdGhlIGhhbmRsZXIgZm9yIHRoZSAnb3JkZXInLXR5cGUgbm90aWZpY2F0aW9uLCB3aGljaCBhcmVcbiAgICogdXNlZCB0byB1cGRhdGUgYW4gb3JkZXIncyBzdGF0dXMuXG4gICAqL1xuICBoYW5kbGVPcmRlck5vdGUgKG5vdGU6IE9yZGVyTm90ZSkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBvcmRlciA9IG5vdGUub3JkZXJcbiAgICBpZiAob3JkZXIuaWQgIT09IHRoaXMub3JkZXJJRCkgcmV0dXJuXG4gICAgdGhpcy5vcmRlciA9IG9yZGVyXG4gICAgY29uc3QgYnR0biA9IHBhZ2UuY2FuY2VsQnR0blxuICAgIGlmIChidHRuICYmIG9yZGVyLnN0YXR1cyA+IE9yZGVyVXRpbC5TdGF0dXNCb29rZWQpIERvYy5oaWRlKGJ0dG4pXG4gICAgcGFnZS5zdGF0dXMudGV4dENvbnRlbnQgPSBPcmRlclV0aWwuc3RhdHVzU3RyaW5nKG9yZGVyKVxuICAgIGZvciAoY29uc3QgbSBvZiBvcmRlci5tYXRjaGVzIHx8IFtdKSB0aGlzLnByb2Nlc3NNYXRjaChtKVxuICAgIHRoaXMuc2V0QWNjZWxlcmF0aW9uQnV0dG9uVmlzKClcbiAgfVxuXG4gIC8qIGhhbmRsZU1hdGNoTm90ZSBoYW5kbGVzIGEgJ21hdGNoJyBub3RpZmljYXRpb24uICovXG4gIGhhbmRsZU1hdGNoTm90ZSAobm90ZTogTWF0Y2hOb3RlKSB7XG4gICAgaWYgKG5vdGUub3JkZXJJRCAhPT0gdGhpcy5vcmRlcklEKSByZXR1cm5cbiAgICB0aGlzLnByb2Nlc3NNYXRjaChub3RlLm1hdGNoKVxuICAgIHRoaXMuc2V0QWNjZWxlcmF0aW9uQnV0dG9uVmlzKClcbiAgfVxuXG4gIC8qXG4gICAqIHByb2Nlc3NNYXRjaCBzeW5jaHJvbml6ZXMgYSBtYXRjaCdzIGNhcmQgd2l0aCBhIG1hdGNoIHJlY2VpdmVkIGluIGFcbiAgICogJ29yZGVyJyBvciAnbWF0Y2gnIG5vdGlmaWNhdGlvbi5cbiAgICovXG4gIHByb2Nlc3NNYXRjaCAobTogTWF0Y2gpIHtcbiAgICBsZXQgY2FyZDogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbFxuICAgIGZvciAoY29uc3QgZGl2IG9mIERvYy5hcHBseVNlbGVjdG9yKHRoaXMucGFnZS5tYXRjaEJveCwgJy5tYXRjaC1jYXJkJykpIHtcbiAgICAgIGlmIChkaXYuZGF0YXNldC5tYXRjaElEID09PSBtLm1hdGNoSUQpIHtcbiAgICAgICAgY2FyZCA9IGRpdlxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY2FyZCkge1xuICAgICAgdGhpcy5zZXRNdXRhYmxlTWF0Y2hDYXJkRWxlbWVudHMoY2FyZCwgbSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hZGROZXdNYXRjaENhcmQobSlcbiAgICB9XG4gIH1cbn1cblxuLypcbiAqIGNvbmZpcm1hdGlvblN0cmluZyBpcyBhIHN0cmluZyBkZXNjcmliaW5nIHRoZSBzdGF0ZSBvZiBjb25maXJtYXRpb25zIGZvciBhXG4gKiBjb2luLlxuICogKi9cbmZ1bmN0aW9uIGNvbmZpcm1hdGlvblN0cmluZyAoY29pbjogQ29pbikge1xuICBpZiAoIWNvaW4uY29uZnMgfHwgY29pbi5jb25mcy5yZXF1aXJlZCA9PT0gMCkgcmV0dXJuICcnXG4gIHJldHVybiBgJHtjb2luLmNvbmZzLmNvdW50fSAvICR7Y29pbi5jb25mcy5yZXF1aXJlZH0gJHtpbnRsLnByZXAoaW50bC5JRF9DT05GSVJNQVRJT05TKX1gXG59XG5cbi8vIG1ha2VyU3dhcENvaW4gcmV0dXJuJ3MgdGhlIG1ha2VyJ3Mgc3dhcCBjb2luLlxuZnVuY3Rpb24gbWFrZXJTd2FwQ29pbiAobTogTWF0Y2gpIDogQ29pbiB7XG4gIHJldHVybiAobS5zaWRlID09PSBPcmRlclV0aWwuTWFrZXIpID8gbS5zd2FwIDogbS5jb3VudGVyU3dhcFxufVxuXG4vLyB0YWtlclN3YXBDb2luIHJldHVybidzIHRoZSB0YWtlcidzIHN3YXAgY29pbi5cbmZ1bmN0aW9uIHRha2VyU3dhcENvaW4gKG06IE1hdGNoKSB7XG4gIHJldHVybiAobS5zaWRlID09PSBPcmRlclV0aWwuTWFrZXIpID8gbS5jb3VudGVyU3dhcCA6IG0uc3dhcFxufVxuXG4vLyBtYWtlclJlZGVlbUNvaW4gcmV0dXJuJ3MgdGhlIG1ha2VyJ3MgcmVkZWVtIGNvaW4uXG5mdW5jdGlvbiBtYWtlclJlZGVlbUNvaW4gKG06IE1hdGNoKSB7XG4gIHJldHVybiAobS5zaWRlID09PSBPcmRlclV0aWwuTWFrZXIpID8gbS5yZWRlZW0gOiBtLmNvdW50ZXJSZWRlZW1cbn1cblxuLy8gdGFrZXJSZWRlZW1Db2luIHJldHVybidzIHRoZSB0YWtlcidzIHJlZGVlbSBjb2luLlxuZnVuY3Rpb24gdGFrZXJSZWRlZW1Db2luIChtOiBNYXRjaCkge1xuICByZXR1cm4gKG0uc2lkZSA9PT0gT3JkZXJVdGlsLk1ha2VyKSA/IG0uY291bnRlclJlZGVlbSA6IG0ucmVkZWVtXG59XG5cbi8qXG4qIGluQ29uZmlybWluZ01ha2VyUmVkZWVtIHdpbGwgYmUgdHJ1ZSBpZiB3ZSBhcmUgdGhlIG1ha2VyLCBhbmQgd2UgYXJlIHdhaXRpbmdcbiogb24gY29uZmlybWF0aW9ucyBmb3Igb3VyIG93biByZWRlZW0uXG4qL1xuZnVuY3Rpb24gaW5Db25maXJtaW5nTWFrZXJSZWRlZW0gKG06IE1hdGNoKSB7XG4gIHJldHVybiBtLnN0YXR1cyA8IE9yZGVyVXRpbC5NYXRjaENvbmZpcm1lZCAmJiBtLnNpZGUgPT09IE9yZGVyVXRpbC5NYWtlciAmJiBtLnN0YXR1cyA+PSBPcmRlclV0aWwuTWFrZXJSZWRlZW1lZFxufVxuXG4vKlxuKiBpbkNvbmZpcm1pbmdUYWtlclJlZGVlbSB3aWxsIGJlIHRydWUgaWYgd2UgYXJlIHRoZSB0YWtlciwgYW5kIHdlIGFyZSB3YWl0aW5nXG4qIG9uIGNvbmZpcm1hdGlvbnMgZm9yIG91ciBvd24gcmVkZWVtLlxuKi9cbmZ1bmN0aW9uIGluQ29uZmlybWluZ1Rha2VyUmVkZWVtIChtOiBNYXRjaCkge1xuICByZXR1cm4gbS5zdGF0dXMgPCBPcmRlclV0aWwuTWF0Y2hDb25maXJtZWQgJiYgbS5zaWRlID09PSBPcmRlclV0aWwuVGFrZXIgJiYgbS5zdGF0dXMgPj0gT3JkZXJVdGlsLk1hdGNoQ29tcGxldGVcbn1cbiIsImltcG9ydCB7XG4gIE1hcmtldE9yZGVyQm9vayxcbiAgTWluaU9yZGVyXG59IGZyb20gJy4vcmVnaXN0cnknXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9yZGVyQm9vayB7XG4gIGJhc2U6IG51bWJlclxuICBiYXNlU3ltYm9sOiBzdHJpbmdcbiAgcXVvdGU6IG51bWJlclxuICBxdW90ZVN5bWJvbDogc3RyaW5nXG4gIGJ1eXM6IE1pbmlPcmRlcltdXG4gIHNlbGxzOiBNaW5pT3JkZXJbXVxuXG4gIGNvbnN0cnVjdG9yIChta3RCb29rOiBNYXJrZXRPcmRlckJvb2ssIGJhc2VTeW1ib2w6IHN0cmluZywgcXVvdGVTeW1ib2w6IHN0cmluZykge1xuICAgIHRoaXMuYmFzZSA9IG1rdEJvb2suYmFzZVxuICAgIHRoaXMuYmFzZVN5bWJvbCA9IGJhc2VTeW1ib2xcbiAgICB0aGlzLnF1b3RlID0gbWt0Qm9vay5xdW90ZVxuICAgIHRoaXMucXVvdGVTeW1ib2wgPSBxdW90ZVN5bWJvbFxuICAgIC8vIEJvb2tzIGFyZSBzb3J0ZWQgbWlkLWdhcCBmaXJzdC5cbiAgICB0aGlzLmJ1eXMgPSBta3RCb29rLmJvb2suYnV5cyB8fCBbXVxuICAgIHRoaXMuc2VsbHMgPSBta3RCb29rLmJvb2suc2VsbHMgfHwgW11cbiAgfVxuXG4gIC8qIGFkZCBhZGRzIGFuIG9yZGVyIHRvIHRoZSBvcmRlciBib29rLiAqL1xuICBhZGQgKG9yZDogTWluaU9yZGVyKSB7XG4gICAgaWYgKG9yZC5xdHlBdG9taWMgPT09IDApIHtcbiAgICAgIC8vIFRPRE86IFNvbWVib2R5LCBmb3IgdGhlIGxvdmUgb2YgZ29kLCBmaWd1cmUgb3V0IHdoeSB0aGUgaGVsbCB0aGlzIGhlbHBzXG4gICAgICAvLyB3aXRoIHRoZSBnaG9zdCBvcmRlcnMgcHJvYmxlbS4gQXMgZmFyIGFzIEkga25vdywgdGhpcyBvcmRlciBpcyBhIGJvb2tlZFxuICAgICAgLy8gb3JkZXIgdGhhdCBoYWQgbW9yZSB0aGFuIG9uZSBtYXRjaCBpbiBhbiBlcG9jaCBhbmQgY29tcGxldGVseSBmaWxsZWQuXG4gICAgICAvLyBCZWNhdXNlIHRoZSBmaXJzdCBtYXRjaCBkaWRuJ3QgZXhoYXVzdCB0aGUgb3JkZXIsIHRoZXJlIHdvdWxkIGJlIGFcbiAgICAgIC8vICd1cGRhdGVfcmVtYWluaW5nJyBub3RpZmljYXRpb24gc2NoZWR1bGVkIGZvciB0aGUgb3JkZXIuIEJ1dCBieSB0aGVcbiAgICAgIC8vIHRpbWUgT3JkZXJSb3V0ZXIgZ2VuZXJhdGVzIHRoZSBub3RpZmljYXRpb24gbG9uZyBhZnRlciBtYXRjaGluZywgdGhlXG4gICAgICAvLyBvcmRlciBoYXMgemVybyBxdHkgbGVmdCB0byBmaWxsLiBJdCdzIGFsbCBnb29kIHRob3VnaCwga2luZGEsIGJlY2F1c2VcbiAgICAgIC8vIHRoZSBub3RpZmljYXRpb24gaXMgcXVpY2tseSBmb2xsb3dlZCB3aXRoIGFuICd1bmJvb2tfb3JkZXInXG4gICAgICAvLyBub3RpZmljYXRpb24uIEkgaGF2ZSB0cmllZCBteSBkYW1uZWRlc3QgdG8gY2F0Y2ggYW4gdXBkYXRlX3JlbWFpbmluZ1xuICAgICAgLy8gbm90ZSB3aXRob3V0IGFuIGFjY29tcGFueWluZyB1bmJvb2tfb3JkZXIgbm90ZSwgYW5kIGhhdmUgdGh1cyBmYWlsZWQuXG4gICAgICAvLyBZZXQsIHRoaXMgZml4IHNvbWVob3cgc2VlbXMgdG8gd29yay4gSXQncyBpbmZ1cmlhdGluZywgdGJoLlxuICAgICAgd2luZG93LmxvZygnemVyb3F0eScsICd6ZXJvIHF1YW50aXR5IG9yZGVyIGVuY291bnRlcmVkJywgb3JkKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IHNpZGUgPSBvcmQuc2VsbCA/IHRoaXMuc2VsbHMgOiB0aGlzLmJ1eXNcbiAgICBzaWRlLnNwbGljZShmaW5kSWR4KHNpZGUsIG9yZC5yYXRlLCAhb3JkLnNlbGwpLCAwLCBvcmQpXG4gIH1cblxuICAvKiByZW1vdmUgcmVtb3ZlcyBhbiBvcmRlciBmcm9tIHRoZSBvcmRlciBib29rLiAqL1xuICByZW1vdmUgKHRva2VuOiBzdHJpbmcpIHtcbiAgICBpZiAodGhpcy5yZW1vdmVGcm9tU2lkZSh0aGlzLnNlbGxzLCB0b2tlbikpIHJldHVyblxuICAgIHRoaXMucmVtb3ZlRnJvbVNpZGUodGhpcy5idXlzLCB0b2tlbilcbiAgfVxuXG4gIC8qIHJlbW92ZUZyb21TaWRlIHJlbW92ZXMgYW4gb3JkZXIgZnJvbSB0aGUgbGlzdCBvZiBvcmRlcnMuICovXG4gIHJlbW92ZUZyb21TaWRlIChzaWRlOiBNaW5pT3JkZXJbXSwgdG9rZW46IHN0cmluZykge1xuICAgIGNvbnN0IFtvcmQsIGldID0gdGhpcy5maW5kT3JkZXIoc2lkZSwgdG9rZW4pXG4gICAgaWYgKG9yZCkge1xuICAgICAgc2lkZS5zcGxpY2UoaSwgMSlcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgLyogZmluZE9yZGVyIGZpbmRzIGFuIG9yZGVyIGluIGEgc3BlY2lmaWVkIHNpZGUgKi9cbiAgZmluZE9yZGVyIChzaWRlOiBNaW5pT3JkZXJbXSwgdG9rZW46IHN0cmluZyk6IFtNaW5pT3JkZXIgfCBudWxsLCBudW1iZXJdIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZGUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzaWRlW2ldLnRva2VuID09PSB0b2tlbikge1xuICAgICAgICByZXR1cm4gW3NpZGVbaV0sIGldXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBbbnVsbCwgLTFdXG4gIH1cblxuICAvKiB1cGRhdGVzIHRoZSByZW1haW5pbmcgcXVhbnRpdHkgb2YgYW4gb3JkZXIuICovXG4gIHVwZGF0ZVJlbWFpbmluZyAodG9rZW46IHN0cmluZywgcXR5OiBudW1iZXIsIHF0eUF0b21pYzogbnVtYmVyKSB7XG4gICAgaWYgKHRoaXMudXBkYXRlUmVtYWluaW5nU2lkZSh0aGlzLnNlbGxzLCB0b2tlbiwgcXR5LCBxdHlBdG9taWMpKSByZXR1cm5cbiAgICB0aGlzLnVwZGF0ZVJlbWFpbmluZ1NpZGUodGhpcy5idXlzLCB0b2tlbiwgcXR5LCBxdHlBdG9taWMpXG4gIH1cblxuICAvKlxuICAgKiB1cGRhdGVSZW1haW5pbmdTaWRlIGxvb2tzIGZvciB0aGUgb3JkZXIgaW4gdGhlIHNpZGUgYW5kIHVwZGF0ZXMgdGhlXG4gICAqIHF1YW50aXR5LCByZXR1cm5pbmcgdHJ1ZSBvbiBzdWNjZXNzLCBmYWxzZSBpZiBvcmRlciBub3QgZm91bmQuXG4gICAqL1xuICB1cGRhdGVSZW1haW5pbmdTaWRlIChzaWRlOiBNaW5pT3JkZXJbXSwgdG9rZW46IHN0cmluZywgcXR5OiBudW1iZXIsIHF0eUF0b21pYzogbnVtYmVyKSB7XG4gICAgY29uc3Qgb3JkID0gdGhpcy5maW5kT3JkZXIoc2lkZSwgdG9rZW4pWzBdXG4gICAgaWYgKG9yZCkge1xuICAgICAgb3JkLnF0eSA9IHF0eVxuICAgICAgb3JkLnF0eUF0b21pYyA9IHF0eUF0b21pY1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICAvKlxuICAgKiBzZXRFcG9jaCBzZXRzIHRoZSBjdXJyZW50IGVwb2NoIGFuZCBjbGVhciBhbnkgb3JkZXJzIGZyb20gcHJldmlvdXMgZXBvY2hzLlxuICAgKi9cbiAgc2V0RXBvY2ggKGVwb2NoSWR4OiBudW1iZXIpIHtcbiAgICBjb25zdCBhcHByb3ZlID0gKG9yZDogTWluaU9yZGVyKSA9PiBvcmQuZXBvY2ggPT09IHVuZGVmaW5lZCB8fCBvcmQuZXBvY2ggPT09IDAgfHwgb3JkLmVwb2NoID09PSBlcG9jaElkeFxuICAgIHRoaXMuc2VsbHMgPSB0aGlzLnNlbGxzLmZpbHRlcihhcHByb3ZlKVxuICAgIHRoaXMuYnV5cyA9IHRoaXMuYnV5cy5maWx0ZXIoYXBwcm92ZSlcbiAgfVxuXG4gIC8qIGVtcHR5IHdpbGwgcmV0dXJuIHRydWUgaWYgYm90aCB0aGUgYnV5cyBhbmQgc2VsbHMgbGlzdHMgYXJlIGVtcHR5LiAqL1xuICBlbXB0eSAoKSB7XG4gICAgcmV0dXJuICF0aGlzLnNlbGxzLmxlbmd0aCAmJiAhdGhpcy5idXlzLmxlbmd0aFxuICB9XG5cbiAgLyogY291bnQgaXMgdGhlIHRvdGFsIGNvdW50IG9mIGJvdGggYnV5IGFuZCBzZWxsIG9yZGVycy4gKi9cbiAgY291bnQgKCkge1xuICAgIHJldHVybiB0aGlzLnNlbGxzLmxlbmd0aCArIHRoaXMuYnV5cy5sZW5ndGhcbiAgfVxuXG4gIC8qIGJlc3RHYXBPcmRlciB3aWxsIHJldHVybiB0aGUgYmVzdCBub24tZXBvY2ggb3JkZXIgaWYgb25lIGV4aXN0cywgb3IgdGhlXG4gICAqIGJlc3QgZXBvY2ggb3JkZXIgaWYgdGhlcmUgYXJlIG9ubHkgZXBvY2ggb3JkZXJzLCBvciBudWxsIGlmIHRoZXJlIGFyZSBub1xuICAgKiBvcmRlcnMuXG4gICAqL1xuICBiZXN0R2FwT3JkZXIgKHNpZGU6IE1pbmlPcmRlcltdKSB7XG4gICAgbGV0IGJlc3QgPSBudWxsXG4gICAgZm9yIChjb25zdCBvcmQgb2Ygc2lkZSkge1xuICAgICAgaWYgKCFvcmQuZXBvY2gpIHJldHVybiBvcmRcbiAgICAgIGlmICghYmVzdCkge1xuICAgICAgICBiZXN0ID0gb3JkXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBiZXN0XG4gIH1cblxuICBiZXN0R2FwQnV5ICgpIHtcbiAgICByZXR1cm4gdGhpcy5iZXN0R2FwT3JkZXIodGhpcy5idXlzKVxuICB9XG5cbiAgYmVzdEdhcFNlbGwgKCkge1xuICAgIHJldHVybiB0aGlzLmJlc3RHYXBPcmRlcih0aGlzLnNlbGxzKVxuICB9XG59XG5cbi8qXG4gKiBmaW5kSWR4IGZpbmQgdGhlIGluZGV4IGF0IHdoaWNoIHRvIGluc2VydCB0aGUgb3JkZXIgaW50byB0aGUgbGlzdCBvZiBvcmRlcnMuXG4gKi9cbmZ1bmN0aW9uIGZpbmRJZHggKHNpZGU6IE1pbmlPcmRlcltdLCByYXRlOiBudW1iZXIsIGxlc3M6IGJvb2xlYW4pOiBudW1iZXIge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNpZGUubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoKHNpZGVbaV0ucmF0ZSA8IHJhdGUpID09PSBsZXNzKSByZXR1cm4gaVxuICB9XG4gIHJldHVybiBzaWRlLmxlbmd0aFxufVxuIiwiaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0ICogYXMgT3JkZXJVdGlsIGZyb20gJy4vb3JkZXJ1dGlsJ1xuaW1wb3J0ICogYXMgaW50bCBmcm9tICcuL2xvY2FsZXMnXG5pbXBvcnQgeyBwb3N0SlNPTiB9IGZyb20gJy4vaHR0cCdcbmltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnQsXG4gIE9yZGVyRmlsdGVyLFxuICBPcmRlclxufSBmcm9tICcuL3JlZ2lzdHJ5J1xuXG5jb25zdCBvcmRlckJhdGNoU2l6ZSA9IDUwXG5jb25zdCBhbmltYXRpb25MZW5ndGggPSA1MDBcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT3JkZXJzUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgbWFpbjogSFRNTEVsZW1lbnRcbiAgb2Zmc2V0OiBzdHJpbmdcbiAgbG9hZGluZzogYm9vbGVhblxuICBjdXJyZW50Rm9ybTogUGFnZUVsZW1lbnRcbiAgb3JkZXJUbXBsOiBQYWdlRWxlbWVudFxuICBmaWx0ZXJTdGF0ZTogT3JkZXJGaWx0ZXJcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG5cbiAgY29uc3RydWN0b3IgKG1haW46IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMubWFpbiA9IG1haW5cbiAgICAvLyBpZiBvZmZzZXQgaXMgJycsIHRoZXJlIGFyZSBubyBtb3JlIG9yZGVycyBhdmFpbGFibGUgdG8gYXV0by1sb2FkIGZvclxuICAgIC8vIG5ldmVyLWVuZGluZyBzY3JvbGxpbmcuXG4gICAgdGhpcy5vZmZzZXQgPSAnJ1xuICAgIHRoaXMubG9hZGluZyA9IGZhbHNlXG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZSA9IERvYy5pZERlc2NlbmRhbnRzKG1haW4pXG4gICAgdGhpcy5vcmRlclRtcGwgPSBwYWdlLnJvd1RtcGxcbiAgICB0aGlzLm9yZGVyVG1wbC5yZW1vdmUoKVxuXG4gICAgLy8gZmlsdGVyU3RhdGUgd2lsbCBzdG9yZSBhcnJheXMgb2Ygc3RyaW5ncy4gVGhlIGFzc2V0cyBhbmQgc3RhdHVzZXNcbiAgICAvLyBzdWItZmlsdGVycyB3aWxsIG5lZWQgdG8gYmUgY29udmVydGVkIHRvIGludHMgZm9yIEpTT04gZW5jb2RpbmcuXG4gICAgY29uc3QgZmlsdGVyU3RhdGU6IE9yZGVyRmlsdGVyID0gdGhpcy5maWx0ZXJTdGF0ZSA9IHtcbiAgICAgIGhvc3RzOiBbXSxcbiAgICAgIGFzc2V0czogW10sXG4gICAgICBzdGF0dXNlczogW11cbiAgICB9XG5cbiAgICBjb25zdCBzZWFyY2ggPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpXG4gICAgY29uc3QgcmVhZEZpbHRlciA9IChmb3JtOiBIVE1MRWxlbWVudCwgZmlsdGVyS2V5OiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHYgPSBzZWFyY2guZ2V0KGZpbHRlcktleSlcbiAgICAgIGlmICghdiB8fCB2Lmxlbmd0aCA9PT0gMCkgcmV0dXJuXG4gICAgICBjb25zdCBzdWJGaWx0ZXIgPSB2LnNwbGl0KCcsJylcbiAgICAgIGlmICh2KSB7XG4gICAgICAgIChmaWx0ZXJTdGF0ZSBhcyBhbnkpW2ZpbHRlcktleV0gPSBzdWJGaWx0ZXIgLy8gS2luZGEgamFua3lcbiAgICAgIH1cbiAgICAgIGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKGJ0dG4gPT4ge1xuICAgICAgICBpZiAoc3ViRmlsdGVyLmluZGV4T2YoYnR0bi52YWx1ZSkgPj0gMCkgYnR0bi5jaGVja2VkID0gdHJ1ZVxuICAgICAgfSlcbiAgICB9XG4gICAgcmVhZEZpbHRlcihwYWdlLmhvc3RGaWx0ZXIsICdob3N0cycpXG4gICAgcmVhZEZpbHRlcihwYWdlLmFzc2V0RmlsdGVyLCAnYXNzZXRzJylcbiAgICByZWFkRmlsdGVyKHBhZ2Uuc3RhdHVzRmlsdGVyLCAnc3RhdHVzZXMnKVxuXG4gICAgY29uc3QgYXBwbHlCdXR0b25zOiBIVE1MRWxlbWVudFtdID0gW11cbiAgICBjb25zdCBtb25pdG9yRmlsdGVyID0gKGZvcm06IEhUTUxFbGVtZW50LCBmaWx0ZXJLZXk6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgYXBwbHlCdHRuID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcuYXBwbHktYnR0bicpIGFzIEhUTUxFbGVtZW50XG4gICAgICBhcHBseUJ1dHRvbnMucHVzaChhcHBseUJ0dG4pXG4gICAgICBEb2MuYmluZChhcHBseUJ0dG4sICdjbGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy5zdWJtaXRGaWx0ZXIoKVxuICAgICAgICBhcHBseUJ1dHRvbnMuZm9yRWFjaChidHRuID0+IERvYy5oaWRlKGJ0dG4pKVxuICAgICAgfSlcbiAgICAgIGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKGJ0dG4gPT4ge1xuICAgICAgICBEb2MuYmluZChidHRuLCAnY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHN1YkZpbHRlciA9IHBhcnNlU3ViRmlsdGVyKGZvcm0pXG4gICAgICAgICAgaWYgKGNvbXBhcmVTdWJGaWx0ZXIoc3ViRmlsdGVyLCAoZmlsdGVyU3RhdGUgYXMgYW55KVtmaWx0ZXJLZXldKSkge1xuICAgICAgICAgICAgLy8gU2FtZSBhcyBjdXJyZW50bHkgbG9hZGVkLiBIaWRlIHRoZSBhcHBseSBidXR0b24uXG4gICAgICAgICAgICBEb2MuaGlkZShhcHBseUJ0dG4pXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIERvYy5zaG93KGFwcGx5QnR0bilcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH1cblxuICAgIG1vbml0b3JGaWx0ZXIocGFnZS5ob3N0RmlsdGVyLCAnaG9zdHMnKVxuICAgIG1vbml0b3JGaWx0ZXIocGFnZS5hc3NldEZpbHRlciwgJ2Fzc2V0cycpXG4gICAgbW9uaXRvckZpbHRlcihwYWdlLnN0YXR1c0ZpbHRlciwgJ3N0YXR1c2VzJylcblxuICAgIERvYy5iaW5kKHRoaXMubWFpbiwgJ3Njcm9sbCcsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmxvYWRpbmcpIHJldHVyblxuICAgICAgY29uc3QgYmVsb3dCb3R0b20gPSBwYWdlLm9yZGVyc1RhYmxlLm9mZnNldEhlaWdodCAtIHRoaXMubWFpbi5vZmZzZXRIZWlnaHQgLSB0aGlzLm1haW4uc2Nyb2xsVG9wXG4gICAgICBpZiAoYmVsb3dCb3R0b20gPCAwKSB7XG4gICAgICAgIHRoaXMubmV4dFBhZ2UoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBwYWdlLmZvcm1zLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtLWNsb3NlcicpLmZvckVhY2goZWwgPT4ge1xuICAgICAgRG9jLmJpbmQoZWwsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICAgIH0pXG4gICAgfSlcblxuICAgIC8vIElmIHRoZSB1c2VyIGNsaWNrcyBvdXRzaWRlIG9mIGEgZm9ybSwgaXQgc2hvdWxkIGNsb3NlIHRoZSBwYWdlIG92ZXJsYXkuXG4gICAgRG9jLmJpbmQocGFnZS5mb3JtcywgJ21vdXNlZG93bicsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBpZiAoIURvYy5tb3VzZUluRWxlbWVudChlLCB0aGlzLmN1cnJlbnRGb3JtKSkge1xuICAgICAgICBEb2MuaGlkZShwYWdlLmZvcm1zKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLmV4cG9ydE9yZGVycywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5leHBvcnRPcmRlcnMoKVxuICAgIH0pXG5cbiAgICBwYWdlLnNob3dBcmNoaXZlZERhdGVGaWVsZC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICBpZiAocGFnZS5zaG93QXJjaGl2ZWREYXRlRmllbGQuY2hlY2tlZCkgRG9jLnNob3cocGFnZS5hcmNoaXZlZERhdGVGaWVsZClcbiAgICAgIGVsc2UgRG9jLmhpZGUocGFnZS5hcmNoaXZlZERhdGVGaWVsZCwgcGFnZS5kZWxldGVBcmNoaXZlZFJlY29yZHNFcnIpXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgICBwYWdlLnNob3dBcmNoaXZlZERhdGVGaWVsZC5jaGVja2VkID0gZmFsc2VcbiAgICAgIHBhZ2Uuc2F2ZU1hdGNoZXNUb0ZpbGUuY2hlY2tlZCA9IGZhbHNlXG4gICAgICBwYWdlLnNhdmVPcmRlcnNUb0ZpbGUuY2hlY2tlZCA9IGZhbHNlXG4gICAgICBwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc0Vyci50ZXh0Q29udGVudCA9ICcnXG4gICAgICBwYWdlLmFyY2hpdmVkUmVjb3Jkc0xvY2F0aW9uLnRleHRDb250ZW50ID0gJydcbiAgICAgIHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzTXNnLnRleHRDb250ZW50ID0gJydcbiAgICAgIERvYy5oaWRlKHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZXN1bHQsIHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzRXJyLFxuICAgICAgICBwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc01zZywgcGFnZS5hcmNoaXZlZFJlY29yZHNMb2NhdGlvbiwgcGFnZS5hcmNoaXZlZERhdGVGaWVsZClcbiAgICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5kZWxldGVBcmNoaXZlZFJlY29yZHNGb3JtKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc1N1Ym1pdCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgbGV0IGRhdGUgPSAwXG4gICAgICBpZiAocGFnZS5zaG93QXJjaGl2ZWREYXRlRmllbGQuY2hlY2tlZCkge1xuICAgICAgICBkYXRlID0gRGF0ZS5wYXJzZShwYWdlLm9sZGVyVGhhbi52YWx1ZSB8fCAnJylcbiAgICAgICAgaWYgKGlzTmFOKGRhdGUpIHx8IGRhdGUgPD0gMCkge1xuICAgICAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzRXJyLCBpbnRsLnByZXAoaW50bC5JRF9JTlZBTElEX0RBVEVfRVJSX01TRykpXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzKGRhdGUpXG4gICAgfSlcblxuICAgIHRoaXMuc3VibWl0RmlsdGVyKClcbiAgfVxuXG4gIC8qIHNob3dGb3JtIHNob3dzIGEgbW9kYWwgZm9ybSB3aXRoIGEgbGl0dGxlIGFuaW1hdGlvbi4gKi9cbiAgYXN5bmMgc2hvd0Zvcm0gKGZvcm06IEhUTUxFbGVtZW50KSB7XG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IGZvcm1cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5kZWxldGVBcmNoaXZlZFJlY29yZHNGb3JtKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMTAwMDBweCdcbiAgICBEb2Muc2hvdyhwYWdlLmZvcm1zLCBmb3JtKVxuICAgIGNvbnN0IHNoaWZ0ID0gKHBhZ2UuZm9ybXMub2Zmc2V0V2lkdGggKyBmb3JtLm9mZnNldFdpZHRoKSAvIDJcbiAgICBhd2FpdCBEb2MuYW5pbWF0ZShhbmltYXRpb25MZW5ndGgsIHByb2dyZXNzID0+IHtcbiAgICAgIGZvcm0uc3R5bGUucmlnaHQgPSBgJHsoMSAtIHByb2dyZXNzKSAqIHNoaWZ0fXB4YFxuICAgIH0sICdlYXNlT3V0SGFyZCcpXG4gICAgZm9ybS5zdHlsZS5yaWdodCA9ICcwcHgnXG4gIH1cblxuICAvKiBzZXRPcmRlcnMgZW1wdGllcyB0aGUgb3JkZXIgdGFibGUgYW5kIGFwcGVuZHMgdGhlIHNwZWNpZmllZCBvcmRlcnMuICovXG4gIHNldE9yZGVycyAob3JkZXJzOiBPcmRlcltdKSB7XG4gICAgRG9jLmVtcHR5KHRoaXMucGFnZS50YWJsZUJvZHkpXG4gICAgdGhpcy5hcHBlbmRPcmRlcnMob3JkZXJzKVxuICB9XG5cbiAgLyogYXBwZW5kT3JkZXJzIGFwcGVuZHMgb3JkZXJzIHRvIHRoZSBvcmRlcnMgdGFibGUuICovXG4gIGFwcGVuZE9yZGVycyAob3JkZXJzOiBPcmRlcltdKSB7XG4gICAgY29uc3QgdGJvZHkgPSB0aGlzLnBhZ2UudGFibGVCb2R5XG4gICAgZm9yIChjb25zdCBvcmQgb2Ygb3JkZXJzKSB7XG4gICAgICBjb25zdCB0ciA9IHRoaXMub3JkZXJUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudFxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRyKVxuICAgICAgbGV0IGZyb21TeW1ib2wsIHRvU3ltYm9sLCBmcm9tVW5pdCwgdG9Vbml0LCBmcm9tUXR5XG4gICAgICBsZXQgdG9RdHkgPSAnJ1xuICAgICAgY29uc3QgeGMgPSBhcHAoKS5leGNoYW5nZXNbb3JkLmhvc3RdIHx8IHVuZGVmaW5lZFxuICAgICAgaWYgKCghYXBwKCkuYXNzZXRzW29yZC5iYXNlSURdICYmICF4Yy5hc3NldHNbb3JkLmJhc2VJRF0pIHx8ICghYXBwKCkuYXNzZXRzW29yZC5xdW90ZUlEXSAmJiAheGMuYXNzZXRzW29yZC5xdW90ZUlEXSkpIGNvbnRpbnVlXG4gICAgICBjb25zdCBbYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvXSA9IFthcHAoKS51bml0SW5mbyhvcmQuYmFzZUlELCB4YyksIGFwcCgpLnVuaXRJbmZvKG9yZC5xdW90ZUlELCB4YyldXG4gICAgICBpZiAob3JkLnNlbGwpIHtcbiAgICAgICAgW2Zyb21TeW1ib2wsIHRvU3ltYm9sXSA9IFtvcmQuYmFzZVN5bWJvbCwgb3JkLnF1b3RlU3ltYm9sXTtcbiAgICAgICAgW2Zyb21Vbml0LCB0b1VuaXRdID0gW2Jhc2VVbml0SW5mby5jb252ZW50aW9uYWwudW5pdCwgcXVvdGVVbml0SW5mby5jb252ZW50aW9uYWwudW5pdF1cbiAgICAgICAgZnJvbVF0eSA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgICBpZiAob3JkLnR5cGUgPT09IE9yZGVyVXRpbC5MaW1pdCkge1xuICAgICAgICAgIHRvUXR5ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmQucXR5IC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvciAqIG9yZC5yYXRlLCBxdW90ZVVuaXRJbmZvKVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBbZnJvbVN5bWJvbCwgdG9TeW1ib2xdID0gW29yZC5xdW90ZVN5bWJvbCwgb3JkLmJhc2VTeW1ib2xdO1xuICAgICAgICBbZnJvbVVuaXQsIHRvVW5pdF0gPSBbcXVvdGVVbml0SW5mby5jb252ZW50aW9uYWwudW5pdCwgYmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0XVxuICAgICAgICBpZiAob3JkLnR5cGUgPT09IE9yZGVyVXRpbC5NYXJrZXQpIHtcbiAgICAgICAgICBmcm9tUXR5ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmQucXR5LCBiYXNlVW5pdEluZm8pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZnJvbVF0eSA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkLnF0eSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3IgKiBvcmQucmF0ZSwgcXVvdGVVbml0SW5mbylcbiAgICAgICAgICB0b1F0eSA9IERvYy5mb3JtYXRDb2luVmFsdWUob3JkLnF0eSwgYmFzZVVuaXRJbmZvKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG1rdElEID0gYCR7YmFzZVVuaXRJbmZvLmNvbnZlbnRpb25hbC51bml0fS0ke3F1b3RlVW5pdEluZm8uY29udmVudGlvbmFsLnVuaXR9YFxuICAgICAgdG1wbC5ob3N0LnRleHRDb250ZW50ID0gYCR7bWt0SUR9IEAgJHtvcmQuaG9zdH1gXG5cbiAgICAgIHRtcGwuZnJvbVF0eS50ZXh0Q29udGVudCA9IGZyb21RdHlcbiAgICAgIHRtcGwuZnJvbUxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKGZyb21TeW1ib2wpXG4gICAgICB0bXBsLmZyb21TeW1ib2wudGV4dENvbnRlbnQgPSBmcm9tVW5pdFxuICAgICAgdG1wbC50b1F0eS50ZXh0Q29udGVudCA9IHRvUXR5XG4gICAgICB0bXBsLnRvTG9nby5zcmMgPSBEb2MubG9nb1BhdGgodG9TeW1ib2wpXG4gICAgICB0bXBsLnRvU3ltYm9sLnRleHRDb250ZW50ID0gdG9Vbml0XG4gICAgICB0bXBsLnR5cGUudGV4dENvbnRlbnQgPSBgJHtPcmRlclV0aWwudHlwZVN0cmluZyhvcmQpfSAke09yZGVyVXRpbC5zZWxsU3RyaW5nKG9yZCl9YFxuICAgICAgbGV0IHJhdGUgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGFwcCgpLmNvbnZlbnRpb25hbFJhdGUob3JkLmJhc2VJRCwgb3JkLnF1b3RlSUQsIG9yZC5yYXRlLCB4YykpXG4gICAgICBpZiAob3JkLnR5cGUgPT09IE9yZGVyVXRpbC5NYXJrZXQpIHJhdGUgPSBPcmRlclV0aWwuYXZlcmFnZU1hcmtldE9yZGVyUmF0ZVN0cmluZyhvcmQpXG4gICAgICB0bXBsLnJhdGUudGV4dENvbnRlbnQgPSByYXRlXG4gICAgICB0bXBsLnN0YXR1cy50ZXh0Q29udGVudCA9IE9yZGVyVXRpbC5zdGF0dXNTdHJpbmcob3JkKVxuICAgICAgdG1wbC5maWxsZWQudGV4dENvbnRlbnQgPSBgJHsoT3JkZXJVdGlsLmZpbGxlZChvcmQpIC8gb3JkLnF0eSAqIDEwMCkudG9GaXhlZCgxKX0lYFxuICAgICAgdG1wbC5zZXR0bGVkLnRleHRDb250ZW50ID0gYCR7KE9yZGVyVXRpbC5zZXR0bGVkKG9yZCkgLyBvcmQucXR5ICogMTAwKS50b0ZpeGVkKDEpfSVgXG4gICAgICBjb25zdCBkYXRlVGltZSA9IG5ldyBEYXRlKG9yZC5zdWJtaXRUaW1lKS50b0xvY2FsZVN0cmluZygpXG4gICAgICB0bXBsLnRpbWVBZ28udGV4dENvbnRlbnQgPSBgJHtEb2MudGltZVNpbmNlKG9yZC5zdWJtaXRUaW1lKX0gYWdvYFxuICAgICAgdG1wbC50aW1lLnRleHRDb250ZW50ID0gZGF0ZVRpbWVcbiAgICAgIGNvbnN0IGxpbmsgPSBEb2MudG1wbEVsZW1lbnQodHIsICdsaW5rJylcbiAgICAgIGxpbmsuaHJlZiA9IGBvcmRlci8ke29yZC5pZH1gXG4gICAgICBhcHAoKS5iaW5kSW50ZXJuYWxOYXZpZ2F0aW9uKHRyKVxuICAgICAgdGJvZHkuYXBwZW5kQ2hpbGQodHIpXG4gICAgfVxuICAgIGlmIChvcmRlcnMubGVuZ3RoID09PSBvcmRlckJhdGNoU2l6ZSkge1xuICAgICAgdGhpcy5vZmZzZXQgPSBvcmRlcnNbb3JkZXJzLmxlbmd0aCAtIDFdLmlkXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMub2Zmc2V0ID0gJydcbiAgICB9XG4gIH1cblxuICAvKiBzdWJtaXRGaWx0ZXIgc3VibWl0cyB0aGUgY3VycmVudCBmaWx0ZXIgYW5kIHJlbG9hZHMgdGhlIG9yZGVyIHRhYmxlLiAqL1xuICBhc3luYyBzdWJtaXRGaWx0ZXIgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLm9mZnNldCA9ICcnXG4gICAgY29uc3QgZmlsdGVyU3RhdGUgPSB0aGlzLmZpbHRlclN0YXRlXG4gICAgZmlsdGVyU3RhdGUuaG9zdHMgPSBwYXJzZVN1YkZpbHRlcihwYWdlLmhvc3RGaWx0ZXIpXG4gICAgZmlsdGVyU3RhdGUuYXNzZXRzID0gcGFyc2VTdWJGaWx0ZXIocGFnZS5hc3NldEZpbHRlcikubWFwKChzOiBzdHJpbmcpID0+IHBhcnNlSW50KHMpKVxuICAgIGZpbHRlclN0YXRlLnN0YXR1c2VzID0gcGFyc2VTdWJGaWx0ZXIocGFnZS5zdGF0dXNGaWx0ZXIpLm1hcCgoczogc3RyaW5nKSA9PiBwYXJzZUludChzKSlcbiAgICB0aGlzLnNldE9yZGVycyhhd2FpdCB0aGlzLmZldGNoT3JkZXJzKCkpXG4gIH1cblxuICAvKiBmZXRjaE9yZGVycyBmZXRjaGVzIG9yZGVycyB1c2luZyB0aGUgY3VycmVudCBmaWx0ZXIuICovXG4gIGFzeW5jIGZldGNoT3JkZXJzICgpIHtcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMubWFpbilcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9vcmRlcnMnLCB0aGlzLmN1cnJlbnRGaWx0ZXIoKSlcbiAgICBsb2FkZWQoKVxuICAgIHJldHVybiByZXMub3JkZXJzXG4gIH1cblxuICAvKiBleHBvcnRPcmRlcnMgZG93bmxvYWRzIGEgY3N2IG9mIHRoZSB1c2VyJ3Mgb3JkZXJzIGJhc2VkIG9uIHRoZSBjdXJyZW50IGZpbHRlci4gKi9cbiAgZXhwb3J0T3JkZXJzICgpIHtcbiAgICB0aGlzLm9mZnNldCA9ICcnXG4gICAgY29uc3QgZmlsdGVyU3RhdGUgPSB0aGlzLmN1cnJlbnRGaWx0ZXIoKVxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpXG4gICAgY29uc3Qgc2VhcmNoID0gbmV3IFVSTFNlYXJjaFBhcmFtcygnJylcbiAgICBjb25zdCBzZXRRdWVyeSA9IChrOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHN1YkZpbHRlciA9IChmaWx0ZXJTdGF0ZSBhcyBhbnkpW2tdXG4gICAgICBzdWJGaWx0ZXIuZm9yRWFjaCgodjogYW55KSA9PiB7XG4gICAgICAgIHNlYXJjaC5hcHBlbmQoaywgdilcbiAgICAgIH0pXG4gICAgfVxuICAgIHNldFF1ZXJ5KCdob3N0cycpXG4gICAgc2V0UXVlcnkoJ2Fzc2V0cycpXG4gICAgc2V0UXVlcnkoJ3N0YXR1c2VzJylcbiAgICB1cmwuc2VhcmNoID0gc2VhcmNoLnRvU3RyaW5nKClcbiAgICB1cmwucGF0aG5hbWUgPSAnL29yZGVycy9leHBvcnQnXG4gICAgd2luZG93Lm9wZW4odXJsLnRvU3RyaW5nKCkpXG4gIH1cblxuICAvKiBkZWxldGVBcmNoaXZlZFJlY29yZHMgcmVtb3ZlcyB0aGUgdXNlcidzIGFyY2hpdmVkIG9yZGVycyBhbmQgbWF0Y2hlc1xuICAgKiBjcmVhdGVkIGJlZm9yZSB1c2VyIHNwZWNpZmllZCBkYXRlIHRpbWUgaW4gbWlsbGlzZWNvbmQuIERlbGV0ZWQgYXJjaGl2ZWRcbiAgICogcmVjb3JkcyBhcmUgc2F2ZWQgdG8gYSBDU1YgZmlsZSBpZiB0aGUgdXNlciBzcGVjaWZ5IHNvLlxuICAgKi9cbiAgYXN5bmMgZGVsZXRlQXJjaGl2ZWRSZWNvcmRzIChvbGRlclRoYW5Ncz86IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBzYXZlTWF0Y2hlc1RvRklsZSA9IHBhZ2Uuc2F2ZU1hdGNoZXNUb0ZpbGUuY2hlY2tlZCB8fCBmYWxzZVxuICAgIGNvbnN0IHNhdmVPcmRlcnNUb0ZpbGUgPSBwYWdlLnNhdmVPcmRlcnNUb0ZpbGUuY2hlY2tlZCB8fCBmYWxzZVxuICAgIGNvbnN0IHJlcUJvZHkgPSB7XG4gICAgICBvbGRlclRoYW5Nczogb2xkZXJUaGFuTXMsXG4gICAgICBzYXZlTWF0Y2hlc1RvRmlsZTogc2F2ZU1hdGNoZXNUb0ZJbGUsXG4gICAgICBzYXZlT3JkZXJzVG9GaWxlOiBzYXZlT3JkZXJzVG9GaWxlXG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5tYWluKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2RlbGV0ZWFyY2hpdmVkcmVjb3JkcycsIHJlcUJvZHkpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcmV0dXJuIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzRXJyLCByZXMubXNnKVxuICAgIH1cblxuICAgIGlmIChyZXMuYXJjaGl2ZWRSZWNvcmRzRGVsZXRlZCA+IDApIHtcbiAgICAgIHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzTXNnLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfREVMRVRFX0FSQ0hJVkVEX1JFQ09SRFNfUkVTVUxULCB7IG5SZWNvcmRzOiByZXMuYXJjaGl2ZWRSZWNvcmRzRGVsZXRlZCB9KVxuICAgICAgaWYgKHNhdmVNYXRjaGVzVG9GSWxlIHx8IHNhdmVPcmRlcnNUb0ZpbGUpIHtcbiAgICAgICAgcGFnZS5hcmNoaXZlZFJlY29yZHNMb2NhdGlvbi50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FSQ0hJVkVEX1JFQ09SRFNfUEFUSCwgeyBwYXRoOiByZXMuYXJjaGl2ZWRSZWNvcmRzUGF0aCB9KVxuICAgICAgICBEb2Muc2hvdyhwYWdlLmFyY2hpdmVkUmVjb3Jkc0xvY2F0aW9uKVxuICAgICAgfVxuICAgICAgLy8gVXBkYXRlIHRoZSBvcmRlciBwYWdlLlxuICAgICAgdGhpcy5zdWJtaXRGaWx0ZXIoKVxuICAgIH0gZWxzZSB7XG4gICAgICBwYWdlLmRlbGV0ZUFyY2hpdmVkUmVjb3Jkc01zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX05PX0FSQ0hJVkVEX1JFQ09SRFMpXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZXN1bHQsIHBhZ2UuZGVsZXRlQXJjaGl2ZWRSZWNvcmRzTXNnKVxuICB9XG5cbiAgLypcbiAgICogY3VycmVudEZpbHRlciBjb252ZXJ0cyB0aGUgbG9jYWwgZmlsdGVyIHR5cGUgKHdoaWNoIGlzIGFsbCBzdHJpbmdzKSB0byB0aGVcbiAgICogc2VydmVyJ3MgZmlsdGVyIHR5cGUuXG4gICAqL1xuICBjdXJyZW50RmlsdGVyICgpOiBPcmRlckZpbHRlciB7XG4gICAgY29uc3QgZmlsdGVyU3RhdGUgPSB0aGlzLmZpbHRlclN0YXRlIGFzIE9yZGVyRmlsdGVyXG4gICAgcmV0dXJuIHtcbiAgICAgIGhvc3RzOiBmaWx0ZXJTdGF0ZS5ob3N0cyxcbiAgICAgIGFzc2V0czogZmlsdGVyU3RhdGUuYXNzZXRzPy5tYXAoKHM6IGFueSkgPT4gcGFyc2VJbnQocykpLFxuICAgICAgc3RhdHVzZXM6IGZpbHRlclN0YXRlLnN0YXR1c2VzPy5tYXAoKHM6IGFueSkgPT4gcGFyc2VJbnQocykpLFxuICAgICAgbjogb3JkZXJCYXRjaFNpemUsXG4gICAgICBvZmZzZXQ6IHRoaXMub2Zmc2V0XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogbmV4dFBhZ2UgcmVzdWJtaXRzIHRoZSBmaWx0ZXIgd2l0aCB0aGUgb2Zmc2V0IHNldCB0byB0aGUgbGFzdCBsb2FkZWQgb3JkZXIuXG4gICAqL1xuICBhc3luYyBuZXh0UGFnZSAoKSB7XG4gICAgaWYgKHRoaXMub2Zmc2V0ID09PSAnJyB8fCB0aGlzLmxvYWRpbmcpIHJldHVyblxuICAgIHRoaXMubG9hZGluZyA9IHRydWVcbiAgICBEb2Muc2hvdyh0aGlzLnBhZ2Uub3JkZXJMb2FkZXIpXG4gICAgY29uc3Qgb3JkZXJzID0gYXdhaXQgdGhpcy5mZXRjaE9yZGVycygpXG4gICAgdGhpcy5sb2FkaW5nID0gZmFsc2VcbiAgICBEb2MuaGlkZSh0aGlzLnBhZ2Uub3JkZXJMb2FkZXIpXG4gICAgdGhpcy5hcHBlbmRPcmRlcnMob3JkZXJzKVxuICB9XG59XG5cbi8qXG4gKiBwYXJzZVN1YkZpbHRlciBwYXJzZXMgYSBib29sLW1hcCBmcm9tIHRoZSBjaGVja2JveCBpbnB1dHMgaW4gdGhlIHNwZWNpZmllZFxuICogYW5jZXN0b3IgZWxlbWVudC5cbiAqL1xuZnVuY3Rpb24gcGFyc2VTdWJGaWx0ZXIgKGZvcm06IEhUTUxFbGVtZW50KTogc3RyaW5nW10ge1xuICBjb25zdCBlbnRyaWVzOiBzdHJpbmdbXSA9IFtdXG4gIGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKS5mb3JFYWNoKGJveCA9PiB7XG4gICAgaWYgKGJveC5jaGVja2VkKSBlbnRyaWVzLnB1c2goYm94LnZhbHVlKVxuICB9KVxuICByZXR1cm4gZW50cmllc1xufVxuXG4vKiBjb21wYXJlU3ViRmlsdGVyIGNvbXBhcmVzIHRoZSB0d28gZmlsdGVyIGFycmF5cyBmb3IgdW5vcmRlcmVkIGVxdWl2YWxlbmNlLiAqL1xuZnVuY3Rpb24gY29tcGFyZVN1YkZpbHRlciAoZmlsdGVyMTogYW55W10sIGZpbHRlcjI6IGFueVtdKTogYm9vbGVhbiB7XG4gIGlmIChmaWx0ZXIxLmxlbmd0aCAhPT0gZmlsdGVyMi5sZW5ndGgpIHJldHVybiBmYWxzZVxuICBmb3IgKGNvbnN0IGVudHJ5IG9mIGZpbHRlcjEpIHtcbiAgICBpZiAoZmlsdGVyMi5pbmRleE9mKGVudHJ5KSA9PT0gLTEpIHJldHVybiBmYWxzZVxuICB9XG4gIHJldHVybiB0cnVlXG59XG4iLCJpbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7XG4gIGFwcCxcbiAgT3JkZXIsXG4gIFRyYWRlRm9ybSxcbiAgT3JkZXJPcHRpb24sXG4gIE1hdGNoXG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgeyBCb29sZWFuT3B0aW9uLCBYWVJhbmdlT3B0aW9uIH0gZnJvbSAnLi9vcHRzJ1xuaW1wb3J0IERvYyBmcm9tICcuL2RvYydcblxuZXhwb3J0IGNvbnN0IExpbWl0ID0gMSAvLyBUT0RPOiBEZWxldGUgZm9yIHRoZSB2ZXJzaW9ucyBiZWxvd1xuZXhwb3J0IGNvbnN0IE1hcmtldCA9IDIgLy8gVE9ETzogRGVsZXRlIGZvciB0aGUgdmVyc2lvbnMgYmVsb3dcbmV4cG9ydCBjb25zdCBDYW5jZWwgPSAzIC8vIFRPRE86IERlbGV0ZSBmb3IgdGhlIHZlcnNpb25zIGJlbG93XG5cbmV4cG9ydCBjb25zdCBPcmRlclR5cGVMaW1pdCA9IDFcbmV4cG9ydCBjb25zdCBPcmRlclR5cGVNYXJrZXQgPSAyXG5leHBvcnQgY29uc3QgT3JkZXJUeXBlQ2FuY2VsID0gM1xuXG4vKiBUaGUgdGltZS1pbi1mb3JjZSBzcGVjaWZpZXJzIGFyZSBhIG1pcnJvciBvZiBkZXgvb3JkZXIuVGltZUluRm9yY2UuICovXG5leHBvcnQgY29uc3QgSW1tZWRpYXRlVGlGID0gMFxuZXhwb3J0IGNvbnN0IFN0YW5kaW5nVGlGID0gMVxuXG4vKiBUaGUgb3JkZXIgc3RhdHVzZXMgYXJlIGEgbWlycm9yIG9mIGRleC9vcmRlci5PcmRlclN0YXR1cy4gKi9cbmV4cG9ydCBjb25zdCBTdGF0dXNVbmtub3duID0gMFxuZXhwb3J0IGNvbnN0IFN0YXR1c0Vwb2NoID0gMVxuZXhwb3J0IGNvbnN0IFN0YXR1c0Jvb2tlZCA9IDJcbmV4cG9ydCBjb25zdCBTdGF0dXNFeGVjdXRlZCA9IDNcbmV4cG9ydCBjb25zdCBTdGF0dXNDYW5jZWxlZCA9IDRcbmV4cG9ydCBjb25zdCBTdGF0dXNSZXZva2VkID0gNVxuXG4vKiBUaGUgbWF0Y2ggc3RhdHVzZXMgYXJlIGEgbWlycm9yIG9mIGRleC9vcmRlci5NYXRjaFN0YXR1cy4gKi9cbmV4cG9ydCBjb25zdCBOZXdseU1hdGNoZWQgPSAwXG5leHBvcnQgY29uc3QgTWFrZXJTd2FwQ2FzdCA9IDFcbmV4cG9ydCBjb25zdCBUYWtlclN3YXBDYXN0ID0gMlxuZXhwb3J0IGNvbnN0IE1ha2VyUmVkZWVtZWQgPSAzXG5leHBvcnQgY29uc3QgTWF0Y2hDb21wbGV0ZSA9IDRcbmV4cG9ydCBjb25zdCBNYXRjaENvbmZpcm1lZCA9IDVcblxuLyogVGhlIG1hdGNoIHNpZGVzIGFyZSBhIG1pcnJvciBvZiBkZXgvb3JkZXIuTWF0Y2hTaWRlLiAqL1xuZXhwb3J0IGNvbnN0IE1ha2VyID0gMCAvLyBUT0RPOiBEZWxldGUgZm9yIHRoZSB2ZXJzaW9ucyBiZWxvd1xuZXhwb3J0IGNvbnN0IFRha2VyID0gMSAvLyBUT0RPOiBEZWxldGUgZm9yIHRoZSB2ZXJzaW9ucyBiZWxvd1xuXG5leHBvcnQgY29uc3QgTWF0Y2hTaWRlTWFrZXIgPSAwXG5leHBvcnQgY29uc3QgTWF0Y2hTaWRlVGFrZXIgPSAxXG5cbi8qXG4gKiBSYXRlRW5jb2RpbmdGYWN0b3IgaXMgdXNlZCB3aGVuIGVuY29kaW5nIGFuIGF0b21pYyBleGNoYW5nZSByYXRlIGFzIGFuXG4gKiBpbnRlZ2VyLiBTZWUgZG9jcyBvbiBtZXNzYWdlLXJhdGUgZW5jb2RpbmcgQFxuICogaHR0cHM6Ly9naXRodWIuY29tL2RlY3JlZC9kY3JkZXgvYmxvYi9tYXN0ZXIvc3BlYy9jb21tLm1lZGlhd2lraSNSYXRlX0VuY29kaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBSYXRlRW5jb2RpbmdGYWN0b3IgPSAxZThcblxuZXhwb3J0IGZ1bmN0aW9uIHNlbGxTdHJpbmcgKG9yZDogT3JkZXIpIHtcbiAgY29uc3Qga2V5ID0gb3JkLnNlbGwgPyBpbnRsLklEX1NFTEwgOiBpbnRsLklEX0JVWVxuICBjb25zdCBsYW5nID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmxhbmcudG9Mb3dlckNhc2UoKVxuICByZXR1cm4gaW50bC5wcmVwKGtleSkudG9Mb2NhbGVMb3dlckNhc2UobGFuZylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHR5cGVTdHJpbmcgKG9yZDogT3JkZXIpIHtcbiAgcmV0dXJuIG9yZC50eXBlID09PSBMaW1pdCA/IChvcmQudGlmID09PSBJbW1lZGlhdGVUaUYgPyBpbnRsLnByZXAoaW50bC5JRF9MSU1JVF9PUkRFUl9JTU1FRElBVEVfVElGKSA6IGludGwucHJlcChpbnRsLklEX0xJTUlUX09SREVSKSkgOiBpbnRsLnByZXAoaW50bC5JRF9NQVJLRVRfT1JERVIpXG59XG5cbi8qIGlzTWFya2V0QnV5IHdpbGwgcmV0dXJuIHRydWUgaWYgdGhlIG9yZGVyIGlzIGEgbWFya2V0IGJ1eSBvcmRlci4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc01hcmtldEJ1eSAob3JkOiBPcmRlcikge1xuICByZXR1cm4gb3JkLnR5cGUgPT09IE1hcmtldCAmJiAhb3JkLnNlbGxcbn1cblxuLypcbiAqIGhhc0FjdGl2ZU1hdGNoZXMgcmV0dXJucyB0cnVlIGlmIHRoZSBvcmRlciBoYXMgbWF0Y2hlcyB0aGF0IGhhdmUgbm90IGNvbXBsZXRlZFxuICogc2V0dGxlbWVudCB5ZXQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBoYXNBY3RpdmVNYXRjaGVzIChvcmRlcjogT3JkZXIpIHtcbiAgaWYgKCFvcmRlci5tYXRjaGVzKSByZXR1cm4gZmFsc2VcbiAgZm9yIChjb25zdCBtYXRjaCBvZiBvcmRlci5tYXRjaGVzKSB7XG4gICAgaWYgKG1hdGNoLmFjdGl2ZSkgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gZmFsc2Vcbn1cblxuLyoqXG4gKiBzdGF0dXNTdHJpbmcgY29udmVydHMgdGhlIG9yZGVyIHN0YXR1cyB0byBhIHN0cmluZy5cbiAqXG4gKiBJTVBPUlRBTlQ6IHdlIGhhdmUgc2ltaWxhciBmdW5jdGlvbiBpbiBHb2xhbmcsIGl0IG11c3QgbWF0Y2ggdGhpcyBvbmUgZXhhY3RseSxcbiAqIHdoZW4gdXBkYXRpbmcgbWFrZSBzdXJlIHRvIHVwZGF0ZSBib3RoIVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhdHVzU3RyaW5nIChvcmRlcjogT3JkZXIpOiBzdHJpbmcge1xuICBpZiAoIW9yZGVyLmlkKSByZXR1cm4gaW50bC5wcmVwKGludGwuSURfT1JERVJfU1VCTUlUVElORykgLy8gb3JkZXIgSUQgaXMgZW1wdHkuXG4gIGNvbnN0IGlzTGl2ZSA9IGhhc0FjdGl2ZU1hdGNoZXMob3JkZXIpXG4gIHN3aXRjaCAob3JkZXIuc3RhdHVzKSB7XG4gICAgY2FzZSBTdGF0dXNVbmtub3duOiByZXR1cm4gaW50bC5wcmVwKGludGwuSURfVU5LTk9XTilcbiAgICBjYXNlIFN0YXR1c0Vwb2NoOiByZXR1cm4gaW50bC5wcmVwKGludGwuSURfRVBPQ0gpXG4gICAgY2FzZSBTdGF0dXNCb29rZWQ6XG4gICAgICBpZiAob3JkZXIuY2FuY2VsbGluZykgcmV0dXJuIGludGwucHJlcChpbnRsLklEX0NBTkNFTElORylcbiAgICAgIHJldHVybiBpc0xpdmUgPyBgJHtpbnRsLnByZXAoaW50bC5JRF9CT09LRUQpfS8ke2ludGwucHJlcChpbnRsLklEX1NFVFRMSU5HKX1gIDogaW50bC5wcmVwKGludGwuSURfQk9PS0VEKVxuICAgIGNhc2UgU3RhdHVzRXhlY3V0ZWQ6XG4gICAgICBpZiAoaXNMaXZlKSByZXR1cm4gaW50bC5wcmVwKGludGwuSURfU0VUVExJTkcpXG4gICAgICBpZiAob3JkZXIuZmlsbGVkID09PSAwICYmIG9yZGVyLnR5cGUgIT09IENhbmNlbCkgcmV0dXJuIGludGwucHJlcChpbnRsLklEX05PX01BVENIKVxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX0VYRUNVVEVEKVxuICAgIGNhc2UgU3RhdHVzQ2FuY2VsZWQ6XG4gICAgICByZXR1cm4gaXNMaXZlID8gYCR7aW50bC5wcmVwKGludGwuSURfQ0FOQ0VMRUQpfS8ke2ludGwucHJlcChpbnRsLklEX1NFVFRMSU5HKX1gIDogaW50bC5wcmVwKGludGwuSURfQ0FOQ0VMRUQpXG4gICAgY2FzZSBTdGF0dXNSZXZva2VkOlxuICAgICAgcmV0dXJuIGlzTGl2ZSA/IGAke2ludGwucHJlcChpbnRsLklEX1JFVk9LRUQpfS8ke2ludGwucHJlcChpbnRsLklEX1NFVFRMSU5HKX1gIDogaW50bC5wcmVwKGludGwuSURfUkVWT0tFRClcbiAgfVxuICByZXR1cm4gaW50bC5wcmVwKGludGwuSURfVU5LTk9XTilcbn1cblxuLyogZmlsbGVkIHN1bXMgdGhlIHF1YW50aXRpZXMgb2Ygbm9uLWNhbmNlbCBtYXRjaGVzIGF2YWlsYWJsZS4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaWxsZWQgKG9yZGVyOiBPcmRlcikge1xuICBpZiAoIW9yZGVyLm1hdGNoZXMpIHJldHVybiAwXG4gIGNvbnN0IHF0eSA9IGlzTWFya2V0QnV5KG9yZGVyKSA/IChtOiBNYXRjaCkgPT4gbS5xdHkgKiBtLnJhdGUgLyBSYXRlRW5jb2RpbmdGYWN0b3IgOiAobTogTWF0Y2gpID0+IG0ucXR5XG4gIHJldHVybiBvcmRlci5tYXRjaGVzLnJlZHVjZSgoZmlsbGVkLCBtYXRjaCkgPT4ge1xuICAgIGlmIChtYXRjaC5pc0NhbmNlbCkgcmV0dXJuIGZpbGxlZFxuICAgIHJldHVybiBmaWxsZWQgKyBxdHkobWF0Y2gpXG4gIH0sIDApXG59XG5cbi8qIHNldHRsZWQgc3VtcyB0aGUgcXVhbnRpdGllcyBvZiB0aGUgbWF0Y2hlcyB0aGF0IGhhdmUgY29tcGxldGVkLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldHRsZWQgKG9yZGVyOiBPcmRlcikge1xuICBpZiAoIW9yZGVyLm1hdGNoZXMpIHJldHVybiAwXG4gIGNvbnN0IHF0eSA9IGlzTWFya2V0QnV5KG9yZGVyKSA/IChtOiBNYXRjaCkgPT4gbS5xdHkgKiBtLnJhdGUgLyBSYXRlRW5jb2RpbmdGYWN0b3IgOiAobTogTWF0Y2gpID0+IG0ucXR5XG4gIHJldHVybiBvcmRlci5tYXRjaGVzLnJlZHVjZSgoc2V0dGxlZCwgbWF0Y2gpID0+IHtcbiAgICBpZiAobWF0Y2guaXNDYW5jZWwpIHJldHVybiBzZXR0bGVkXG4gICAgY29uc3QgcmVkZWVtZWQgPSAobWF0Y2guc2lkZSA9PT0gTWFrZXIgJiYgbWF0Y2guc3RhdHVzID49IE1ha2VyUmVkZWVtZWQpIHx8XG4gICAgICAobWF0Y2guc2lkZSA9PT0gVGFrZXIgJiYgbWF0Y2guc3RhdHVzID49IE1hdGNoQ29tcGxldGUpXG4gICAgcmV0dXJuIHJlZGVlbWVkID8gc2V0dGxlZCArIHF0eShtYXRjaCkgOiBzZXR0bGVkXG4gIH0sIDApXG59XG5cbi8qIGF2ZXJhZ2VSYXRlU3RyaW5nIHJldHVybnMgYSBmb3JtYXR0aW5nIHN0cmluZyBjb250YWluaW5nIHRoZSBhdmVyYWdlIHJhdGUgb2ZcbnRoZSBtYXRjaGVzIHRoYXQgaGF2ZSBiZWVuIGZpbGxlZCBmb3IgYSBtYXJrZXQgb3JkZXIuICovXG5leHBvcnQgZnVuY3Rpb24gYXZlcmFnZU1hcmtldE9yZGVyUmF0ZVN0cmluZyAob3JkOiBPcmRlcik6IHN0cmluZyB7XG4gIGlmICghb3JkLm1hdGNoZXM/Lmxlbmd0aCkgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BUktFVF9PUkRFUilcbiAgbGV0IHJhdGVTdHIgPSBEb2MuZm9ybWF0Q29pblZhbHVlKGFwcCgpLmNvbnZlbnRpb25hbFJhdGUob3JkLmJhc2VJRCwgb3JkLnF1b3RlSUQsIGF2ZXJhZ2VSYXRlKG9yZCkpKVxuICBpZiAob3JkLm1hdGNoZXMubGVuZ3RoID4gMSkgcmF0ZVN0ciA9ICd+ICcgKyByYXRlU3RyIC8vIFwiflwiIG9ubHkgbWFrZXMgc2Vuc2UgaWYgdGhlIG9yZGVyIGhhcyBtb3JlIHRoYW4gb25lIG1hdGNoLlxuICByZXR1cm4gcmF0ZVN0clxufVxuXG4vKiBhdmVyYWdlUmF0ZSByZXR1cm5zIGEgdGhlIGF2ZXJhZ2UgcmF0ZSBvZiB0aGUgbWF0Y2hlcyB0aGF0IGhhdmUgYmVlbiBmaWxsZWRcbmluIGFuIG9yZGVyLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGF2ZXJhZ2VSYXRlIChvcmQ6IE9yZGVyKTogbnVtYmVyIHtcbiAgaWYgKCFvcmQubWF0Y2hlcz8ubGVuZ3RoKSByZXR1cm4gMFxuICBsZXQgcmF0ZVByb2R1Y3QgPSAwXG4gIGxldCBiYXNlUXR5ID0gMFxuICBmb3IgKGNvbnN0IG0gb2Ygb3JkLm1hdGNoZXMpIHtcbiAgICBiYXNlUXR5ICs9IG0ucXR5XG4gICAgcmF0ZVByb2R1Y3QgKz0gKG0ucmF0ZSAqIG0ucXR5KSAvLyBvcmRlciB+IDFlMTZcbiAgfVxuICByZXR1cm4gcmF0ZVByb2R1Y3QgLyBiYXNlUXR5XG59XG5cbi8qIGJhc2VUb1F1b3RlIHJldHVybnMgdGhlIHF1YW50aXR5IG9mIHRoZSBxdW90ZSBhc3NldC4gKi9cbmV4cG9ydCBmdW5jdGlvbiBiYXNlVG9RdW90ZSAocmF0ZTogbnVtYmVyLCBiYXNlOiBudW1iZXIpIDogbnVtYmVyIHtcbiAgcmV0dXJuIHJhdGUgKiBiYXNlIC8gUmF0ZUVuY29kaW5nRmFjdG9yXG59XG5cbi8qIG9yZGVyUG9ydGlvbiByZXR1cm5zIGEgc3RyaW5nIHN0YXRpbmcgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIG9yZGVyIGEgbWF0Y2hcbiAgIG1ha2VzIHVwLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9yZGVyUG9ydGlvbiAob3JkZXI6IE9yZGVyLCBtYXRjaDogTWF0Y2gpIDogc3RyaW5nIHtcbiAgbGV0IG1hdGNoUXR5ID0gbWF0Y2gucXR5XG4gIGlmIChpc01hcmtldEJ1eShvcmRlcikpIHtcbiAgICBtYXRjaFF0eSA9IGJhc2VUb1F1b3RlKG1hdGNoLnJhdGUsIG1hdGNoLnF0eSlcbiAgfVxuICByZXR1cm4gKChtYXRjaFF0eSAvIG9yZGVyLnF0eSkgKiAxMDApLnRvRml4ZWQoMSkgKyAnICUnXG59XG5cbi8qXG4gKiBtYXRjaFN0YXR1c1N0cmluZyBpcyBhIHN0cmluZyB1c2VkIHRvIGNyZWF0ZSBhIGRpc3BsYXlhYmxlIHN0cmluZyBkZXNjcmliaW5nXG4gKiBkZXNjcmliaW5nIHRoZSBtYXRjaCBzdGF0dXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXRjaFN0YXR1c1N0cmluZyAobTogTWF0Y2gpIHtcbiAgaWYgKG0ucmV2b2tlZCkge1xuICAgIC8vIFdoZW4gcmV2b2tlZCwgbWF0Y2ggc3RhdHVzIGlzIGxlc3MgaW1wb3J0YW50IHRoYW4gcGVuZGluZyBhY3Rpb24gaWYgc3RpbGxcbiAgICAvLyBhY3RpdmUsIG9yIHRoZSBvdXRjb21lIGlmIGluYWN0aXZlLlxuICAgIGlmIChtLmFjdGl2ZSkge1xuICAgICAgaWYgKG0ucmVkZWVtKSByZXR1cm4gcmV2b2tlZE1hdGNoU3RhdHVzKGludGwuSURfTUFUQ0hfU1RBVFVTX1JFREVNUFRJT05fU0VOVCkgLy8gbXVzdCByZXF1aXJlIGNvbmZpcm1hdGlvbiBpZiBhY3RpdmVcbiAgICAgIC8vIElmIG1ha2VyIGFuZCB3ZSBoYXZlIG5vdCByZWRlZW1lZCwgd2FpdGluZyB0byByZWZ1bmQsIGFzc3VtaW5nIGl0J3Mgbm90XG4gICAgICAvLyByZXZva2VkIHdoaWxlIHdhaXRpbmcgZm9yIGNvbmZzIG9uIGFuIHVuc3BlbnQvdW5leHBpcmVkIHRha2VyIHN3YXAuXG4gICAgICBpZiAobS5zaWRlID09PSBNYWtlcikgcmV0dXJuIHJldm9rZWRNYXRjaFN0YXR1cyhpbnRsLklEX01BVENIX1NUQVRVU19SRUZVTkRfUEVORElORylcbiAgICAgIC8vIEFzIHRha2VyLCByZXNvbHV0aW9uIGRlcGVuZHMgb24gbWFrZXIncyBhY3Rpb25zIHdoaWxlIHdhaXRpbmcgdG8gcmVmdW5kLlxuICAgICAgaWYgKG0uY291bnRlclJlZGVlbSkgcmV0dXJuIHJldm9rZWRNYXRjaFN0YXR1cyhpbnRsLklEX01BVENIX1NUQVRVU19SRURFRU1fUEVORElORykgLy8gdGhpcyBzaG91bGQgYmUgdmVyeSBicmllZiBpZiB3ZSBzZWUgdGhlIG1ha2VyJ3MgcmVkZWVtXG4gICAgICByZXR1cm4gcmV2b2tlZE1hdGNoU3RhdHVzKGludGwuSURfTUFUQ0hfU1RBVFVTX1JFRlVORF9QRU5ESU5HKSAvLyBtYXkgc3dpdGNoIHRvIHJlZGVlbSBpZiBtYWtlciByZWRlZW1zIG9uIHRoZSBzbHlcbiAgICB9XG4gICAgaWYgKG0ucmVmdW5kKSB7XG4gICAgICByZXR1cm4gcmV2b2tlZE1hdGNoU3RhdHVzKGludGwuSURfTUFUQ0hfU1RBVFVTX1JFRlVOREVEKVxuICAgIH1cbiAgICBpZiAobS5yZWRlZW0pIHtcbiAgICAgIHJldHVybiByZXZva2VkTWF0Y2hTdGF0dXMoaW50bC5JRF9NQVRDSF9TVEFUVVNfUkVERU1QVElPTl9DT05GSVJNRUQpXG4gICAgfVxuICAgIHJldHVybiByZXZva2VkTWF0Y2hTdGF0dXMoaW50bC5JRF9NQVRDSF9TVEFUVVNfQ09NUExFVEUpIC8vIGkuZS4gd2Ugc2VudCBubyBzd2FwXG4gIH1cblxuICBzd2l0Y2ggKG0uc3RhdHVzKSB7XG4gICAgY2FzZSBOZXdseU1hdGNoZWQ6XG4gICAgICByZXR1cm4gaW50bC5wcmVwKGludGwuSURfTUFUQ0hfU1RBVFVTX05FV0xZX01BVENIRUQpXG4gICAgY2FzZSBNYWtlclN3YXBDYXN0OlxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BVENIX1NUQVRVU19NQUtFUl9TV0FQX0NBU1QpXG4gICAgY2FzZSBUYWtlclN3YXBDYXN0OlxuICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BVENIX1NUQVRVU19UQUtFUl9TV0FQX0NBU1QpXG4gICAgY2FzZSBNYWtlclJlZGVlbWVkOlxuICAgICAgaWYgKG0uc2lkZSA9PT0gTWFrZXIpIHtcbiAgICAgICAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BVENIX1NUQVRVU19SRURFTVBUSU9OX1NFTlQpXG4gICAgICB9XG4gICAgICByZXR1cm4gaW50bC5wcmVwKGludGwuSURfTUFUQ0hfU1RBVFVTX01BS0VSX1JFREVFTUVEKVxuICAgIGNhc2UgTWF0Y2hDb21wbGV0ZTpcbiAgICAgIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9NQVRDSF9TVEFUVVNfUkVERU1QVElPTl9TRU5UKVxuICAgIGNhc2UgTWF0Y2hDb25maXJtZWQ6XG4gICAgICByZXR1cm4gaW50bC5wcmVwKGludGwuSURfTUFUQ0hfU1RBVFVTX1JFREVNUFRJT05fQ09ORklSTUVEKVxuICB9XG4gIHJldHVybiBpbnRsLnByZXAoaW50bC5JRF9VTktOT1dOKVxufVxuXG4vLyByZXZva2VkTWF0Y2hTdGF0dXMgaXMgYSBoZWxwZXIgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSByZXZva2VkIG1hdGNoIHN0YXR1c1xuLy8gc3RyaW5nLlxuZnVuY3Rpb24gcmV2b2tlZE1hdGNoU3RhdHVzIChtYXRjaFN0YXR1czogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGludGwucHJlcChpbnRsLklEX01BVENIX1NUQVRVU19SRVZPS0VELCB7IHN0YXR1czogaW50bC5wcmVwKG1hdGNoU3RhdHVzKSB9KVxufVxuXG4vKlxuICogb3B0aW9uRWxlbWVudCBpcyBhIGdldHRlciBmb3IgYW4gZWxlbWVudCBtYXRjaGluZyB0aGUgKk9yZGVyT3B0aW9uIGZyb21cbiAqIGNsaWVudC9hc3NldC4gY2hhbmdlIGlzIGEgZnVuY3Rpb24gd2l0aCBubyBhcmd1bWVudHMgdGhhdCBpcyBjYWxsZWQgd2hlbiB0aGVcbiAqIHJldHVybmVkIG9wdGlvbidzIHZhbHVlIGhhcyBjaGFuZ2VkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gb3B0aW9uRWxlbWVudCAob3B0OiBPcmRlck9wdGlvbiwgb3JkZXI6IFRyYWRlRm9ybSwgY2hhbmdlOiAoKSA9PiB2b2lkLCBpc1N3YXA6IGJvb2xlYW4pOiBIVE1MRWxlbWVudCB7XG4gIGNvbnN0IGlzQmFzZUNoYWluID0gKGlzU3dhcCAmJiBvcmRlci5zZWxsKSB8fCAoIWlzU3dhcCAmJiAhb3JkZXIuc2VsbClcbiAgY29uc3Qgc3ltYm9sID0gaXNCYXNlQ2hhaW4gPyBkZXhBc3NldFN5bWJvbChvcmRlci5ob3N0LCBvcmRlci5iYXNlKSA6IGRleEFzc2V0U3ltYm9sKG9yZGVyLmhvc3QsIG9yZGVyLnF1b3RlKVxuXG4gIHN3aXRjaCAodHJ1ZSkge1xuICAgIGNhc2UgISFvcHQuYm9vbGVhbjpcbiAgICAgIHJldHVybiBuZXcgQm9vbGVhbk9wdGlvbihvcHQsIHN5bWJvbCwgb3JkZXIub3B0aW9ucywgY2hhbmdlKS5ub2RlXG4gICAgY2FzZSAhIW9wdC54eVJhbmdlOlxuICAgICAgcmV0dXJuIG5ldyBYWVJhbmdlT3B0aW9uKG9wdCwgc3ltYm9sLCBvcmRlci5vcHRpb25zLCBjaGFuZ2UpLm5vZGVcbiAgICBkZWZhdWx0OlxuICAgICAgY29uc29sZS5lcnJvcignbm8gb3B0aW9uIHR5cGUgc3BlY2lmaWVkJywgb3B0KVxuICB9XG4gIGNvbnNvbGUuZXJyb3IoJ3Vua25vd24gb3B0aW9uIHR5cGUnLCBvcHQpXG4gIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxufVxuXG5mdW5jdGlvbiBkZXhBc3NldFN5bWJvbCAoaG9zdDogc3RyaW5nLCBhc3NldElEOiBudW1iZXIpOiBzdHJpbmcge1xuICByZXR1cm4gYXBwKCkuZXhjaGFuZ2VzW2hvc3RdLmFzc2V0c1thc3NldElEXS5zeW1ib2xcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ2FuY2VsbGFibGUgKG9yZDogT3JkZXIpOiBib29sZWFuIHtcbiAgcmV0dXJuIG9yZC50eXBlID09PSBMaW1pdCAmJiBvcmQudGlmID09PSBTdGFuZGluZ1RpRiAmJiBvcmQuc3RhdHVzIDwgU3RhdHVzRXhlY3V0ZWRcbn1cbiIsImltcG9ydCBEb2MgZnJvbSAnLi9kb2MnXG5pbXBvcnQgQmFzZVBhZ2UgZnJvbSAnLi9iYXNlcGFnZSdcbmltcG9ydCB7IHBvc3RKU09OIH0gZnJvbSAnLi9odHRwJ1xuaW1wb3J0IHtcbiAgTmV3V2FsbGV0Rm9ybSxcbiAgREVYQWRkcmVzc0Zvcm0sXG4gIERpc2NvdmVyQWNjb3VudEZvcm0sXG4gIENvbmZpcm1SZWdpc3RyYXRpb25Gb3JtLFxuICBGZWVBc3NldFNlbGVjdGlvbkZvcm0sXG4gIFdhbGxldFdhaXRGb3JtLFxuICBzbGlkZVN3YXBcbn0gZnJvbSAnLi9mb3JtcydcbmltcG9ydCB7XG4gIGFwcCxcbiAgRXhjaGFuZ2UsXG4gIFBhZ2VFbGVtZW50LFxuICBQcmVwYWlkQm9uZElEXG59IGZyb20gJy4vcmVnaXN0cnknXG5cbmludGVyZmFjZSBSZWdpc3RyYXRpb25QYWdlRGF0YSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBiYWNrVG8/OiBzdHJpbmdcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVnaXN0cmF0aW9uUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgYm9keTogSFRNTEVsZW1lbnRcbiAgZGF0YTogUmVnaXN0cmF0aW9uUGFnZURhdGFcbiAgeGM6IEV4Y2hhbmdlXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBkZXhBZGRyRm9ybTogREVYQWRkcmVzc0Zvcm1cbiAgZGlzY292ZXJBY2N0Rm9ybTogRGlzY292ZXJBY2NvdW50Rm9ybVxuICBuZXdXYWxsZXRGb3JtOiBOZXdXYWxsZXRGb3JtXG4gIHJlZ0Fzc2V0Rm9ybTogRmVlQXNzZXRTZWxlY3Rpb25Gb3JtXG4gIHdhbGxldFdhaXRGb3JtOiBXYWxsZXRXYWl0Rm9ybVxuICBjb25maXJtUmVnaXN0ZXJGb3JtOiBDb25maXJtUmVnaXN0cmF0aW9uRm9ybVxuXG4gIGNvbnN0cnVjdG9yIChib2R5OiBIVE1MRWxlbWVudCwgZGF0YTogUmVnaXN0cmF0aW9uUGFnZURhdGEpIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5ib2R5ID0gYm9keVxuICAgIHRoaXMuZGF0YSA9IGRhdGFcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoYm9keSlcblxuICAgIGlmIChkYXRhLmhvc3QgJiYgcGFnZS5kZXhBZGRyRm9ybS5jbGFzc0xpc3QuY29udGFpbnMoJ3NlbGVjdGVkJykpIHtcbiAgICAgIHBhZ2UuZGV4QWRkckZvcm0uY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgICAgcGFnZS5kaXNjb3ZlckFjY3RGb3JtLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcbiAgICAgIHBhZ2UuZGlzY292ZXJBY2N0Rm9ybS5kYXRhc2V0Lmhvc3QgPSBkYXRhLmhvc3RcbiAgICB9XG5cbiAgICAvLyBIaWRlIHRoZSBmb3JtIGNsb3NlcnMgZm9yIHRoZSByZWdpc3RyYXRpb24gcHJvY2VzcyBleGNlcHQgZm9yIHRoZVxuICAgIC8vIHBhc3N3b3JkIHJlc2V0IGZvcm0gY2xvc2VyLlxuICAgIGZvciAoY29uc3QgZWwgb2YgYm9keS5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKSkgaWYgKGVsICE9PSBwYWdlLnJlc2V0UGFzc0Zvcm1DbG9zZXIpIERvYy5oaWRlKGVsKVxuXG4gICAgdGhpcy5uZXdXYWxsZXRGb3JtID0gbmV3IE5ld1dhbGxldEZvcm0oXG4gICAgICBwYWdlLm5ld1dhbGxldEZvcm0sXG4gICAgICBhc3NldElEID0+IHRoaXMubmV3V2FsbGV0Q3JlYXRlZChhc3NldElELCB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0udGllciksXG4gICAgICAoKSA9PiB0aGlzLmFuaW1hdGVSZWdBc3NldChwYWdlLm5ld1dhbGxldEZvcm0pXG4gICAgKVxuXG4gICAgLy8gQUREIERFWFxuICAgIHRoaXMuZGV4QWRkckZvcm0gPSBuZXcgREVYQWRkcmVzc0Zvcm0ocGFnZS5kZXhBZGRyRm9ybSwgYXN5bmMgKHhjLCBjZXJ0RmlsZSkgPT4ge1xuICAgICAgdGhpcy5yZXF1ZXN0RmVlcGF5bWVudChwYWdlLmRleEFkZHJGb3JtLCB4YywgY2VydEZpbGUpXG4gICAgfSlcblxuICAgIGNvbnN0IGFkZHIgPSBwYWdlLmRpc2NvdmVyQWNjdEZvcm0uZGF0YXNldC5ob3N0XG4gICAgaWYgKGFkZHIpIHtcbiAgICAgIHRoaXMuZGlzY292ZXJBY2N0Rm9ybSA9IG5ldyBEaXNjb3ZlckFjY291bnRGb3JtKHBhZ2UuZGlzY292ZXJBY2N0Rm9ybSwgYWRkciwgYXN5bmMgKHhjKSA9PiB7XG4gICAgICAgIHRoaXMucmVxdWVzdEZlZXBheW1lbnQocGFnZS5kaXNjb3ZlckFjY3RGb3JtLCB4YywgJycpXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIFNFTEVDVCBSRUcgQVNTRVRcbiAgICB0aGlzLnJlZ0Fzc2V0Rm9ybSA9IG5ldyBGZWVBc3NldFNlbGVjdGlvbkZvcm0ocGFnZS5yZWdBc3NldEZvcm0sIGFzeW5jIChhc3NldElEOiBudW1iZXIsIHRpZXI6IG51bWJlcikgPT4ge1xuICAgICAgaWYgKGFzc2V0SUQgPT09IFByZXBhaWRCb25kSUQpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlckRFWFN1Y2Nlc3MoKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBjb25zdCB3YWxsZXQgPSBhc3NldC53YWxsZXRcbiAgICAgIGlmICh3YWxsZXQpIHtcbiAgICAgICAgY29uc3QgYm9uZEFzc2V0ID0gdGhpcy54Yy5ib25kQXNzZXRzW2Fzc2V0LnN5bWJvbF1cbiAgICAgICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UucmVnQXNzZXRGb3JtKVxuICAgICAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGllciwgYm9uZHNGZWVCdWZmZXIpXG4gICAgICAgIGlmICh3YWxsZXQuc3luY2VkICYmIHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA+PSAyICogYm9uZEFzc2V0LmFtb3VudCArIGJvbmRzRmVlQnVmZmVyKSB7XG4gICAgICAgICAgdGhpcy5hbmltYXRlQ29uZmlybUZvcm0ocGFnZS5yZWdBc3NldEZvcm0pXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy53YWxsZXRXYWl0Rm9ybS5zZXRXYWxsZXQoYXNzZXRJRCwgYm9uZHNGZWVCdWZmZXIsIHRpZXIpXG4gICAgICAgIHNsaWRlU3dhcChwYWdlLnJlZ0Fzc2V0Rm9ybSwgcGFnZS53YWxsZXRXYWl0KVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS50aWVyID0gdGllclxuICAgICAgdGhpcy5uZXdXYWxsZXRGb3JtLnNldEFzc2V0KGFzc2V0SUQpXG4gICAgICBzbGlkZVN3YXAocGFnZS5yZWdBc3NldEZvcm0sIHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICB9KVxuXG4gICAgdGhpcy53YWxsZXRXYWl0Rm9ybSA9IG5ldyBXYWxsZXRXYWl0Rm9ybShwYWdlLndhbGxldFdhaXQsICgpID0+IHtcbiAgICAgIHRoaXMuYW5pbWF0ZUNvbmZpcm1Gb3JtKHBhZ2Uud2FsbGV0V2FpdClcbiAgICB9LCAoKSA9PiB7IHRoaXMuYW5pbWF0ZVJlZ0Fzc2V0KHBhZ2Uud2FsbGV0V2FpdCkgfSlcblxuICAgIC8vIFNVQk1JVCBERVggUkVHSVNUUkFUSU9OXG4gICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtID0gbmV3IENvbmZpcm1SZWdpc3RyYXRpb25Gb3JtKHBhZ2UuY29uZmlybVJlZ0Zvcm0sICgpID0+IHtcbiAgICAgIHRoaXMucmVnaXN0ZXJERVhTdWNjZXNzKClcbiAgICB9LCAoKSA9PiB7XG4gICAgICB0aGlzLmFuaW1hdGVSZWdBc3NldChwYWdlLmNvbmZpcm1SZWdGb3JtKVxuICAgIH0pXG5cbiAgICBjb25zdCBjdXJyZW50Rm9ybSA9IERvYy5zYWZlU2VsZWN0b3IocGFnZS5mb3JtcywgJzpzY29wZSA+IGZvcm0uc2VsZWN0ZWQnKVxuICAgIGN1cnJlbnRGb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcbiAgICBzd2l0Y2ggKGN1cnJlbnRGb3JtKSB7XG4gICAgICBjYXNlIHBhZ2UuZGV4QWRkckZvcm06XG4gICAgICAgIHRoaXMuZGV4QWRkckZvcm0uYW5pbWF0ZSgpXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIHBhZ2UuZGlzY292ZXJBY2N0Rm9ybTpcbiAgICAgICAgdGhpcy5kaXNjb3ZlckFjY3RGb3JtLmFuaW1hdGUoKVxuICAgIH1cbiAgICBEb2Muc2hvdyhjdXJyZW50Rm9ybSlcblxuICAgIC8vIFRoZXJlJ3Mgbm90aGluZyBvbiB0aGUgcGFnZS5kaXNjb3ZlckFjY3RGb3JtIGV4Y2VwdCB0byByZWNlaXZlIHVzZXIgcGFzc1xuICAgIC8vIGJlZm9yZSBhdHRlbXB0aW5nIHRvIGRpc2NvdmVyIHVzZXIgYWNjb3VudCBhbmQgdGhlcmUncyBubyBuZWVkIHRvIGhhdmVcbiAgICAvLyB0aGVtIGNsaWNrIGFub3RoZXIgYnV0dG9uIHdoZW4gd2UgY2FuIGNhcnJ5IG9uIHdpdGhvdXQgdXNlciBpbnRlcmFjdGlvbi5cbiAgICBpZiAoY3VycmVudEZvcm0gPT09IHBhZ2UuZGlzY292ZXJBY2N0Rm9ybSkge1xuICAgICAgdGhpcy5kaXNjb3ZlckFjY3RGb3JtLnBhZ2Uuc3VibWl0LmNsaWNrKClcbiAgICB9XG5cbiAgICBpZiAoYXBwKCkuYXV0aGVkKSB0aGlzLmF1dGgoKVxuICB9XG5cbiAgLy8gYXV0aCBzaG91bGQgYmUgY2FsbGVkIG9uY2UgdXNlciBpcyBrbm93biB0byBiZSBhdXRoZWQgd2l0aCB0aGUgc2VydmVyLlxuICBhc3luYyBhdXRoICgpIHtcbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICB9XG5cbiAgYXN5bmMgcmVxdWVzdEZlZXBheW1lbnQgKG9sZEZvcm06IEhUTUxFbGVtZW50LCB4YzogRXhjaGFuZ2UsIGNlcnRGaWxlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnhjID0geGNcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0RXhjaGFuZ2UoeGMsIGNlcnRGaWxlKVxuICAgIHRoaXMud2FsbGV0V2FpdEZvcm0uc2V0RXhjaGFuZ2UoeGMpXG4gICAgdGhpcy5yZWdBc3NldEZvcm0uc2V0RXhjaGFuZ2UoeGMsIGNlcnRGaWxlKVxuICAgIHRoaXMuYW5pbWF0ZVJlZ0Fzc2V0KG9sZEZvcm0pXG4gIH1cblxuICAvKiBTd2FwIGluIHRoZSBhc3NldCBzZWxlY3Rpb24gZm9ybSBhbmQgcnVuIHRoZSBhbmltYXRpb24uICovXG4gIGFzeW5jIGFuaW1hdGVSZWdBc3NldCAob2xkRm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICBEb2MuaGlkZShvbGRGb3JtKVxuICAgIHRoaXMucmVnQXNzZXRGb3JtLmFuaW1hdGUoKVxuICAgIERvYy5zaG93KHRoaXMucGFnZS5yZWdBc3NldEZvcm0pXG4gIH1cblxuICAvKiBTd2FwIGluIHRoZSBjb25maXJtYXRpb24gZm9ybSBhbmQgcnVuIHRoZSBhbmltYXRpb24uICovXG4gIGFzeW5jIGFuaW1hdGVDb25maXJtRm9ybSAob2xkRm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uYW5pbWF0ZSgpXG4gICAgRG9jLmhpZGUob2xkRm9ybSlcbiAgICBEb2Muc2hvdyh0aGlzLnBhZ2UuY29uZmlybVJlZ0Zvcm0pXG4gIH1cblxuICAvLyBSZXRyaWV2ZSBhbiBlc3RpbWF0ZSBmb3IgdGhlIHR4IGZlZSBuZWVkZWQgdG8gY3JlYXRlIG5ldyBib25kIHJlc2VydmVzLlxuICBhc3luYyBnZXRCb25kc0ZlZUJ1ZmZlciAoYXNzZXRJRDogbnVtYmVyLCBmb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcoZm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9ib25kc2ZlZWJ1ZmZlcicsIHsgYXNzZXRJRCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHJldHVybiAwXG4gICAgfVxuICAgIHJldHVybiByZXMuZmVlQnVmZmVyXG4gIH1cblxuICAvKiBnZXRzIHRoZSBjb250ZW50cyBvZiB0aGUgY2VydCBmaWxlICovXG4gIGFzeW5jIGdldENlcnRGaWxlICgpIHtcbiAgICBsZXQgY2VydCA9ICcnXG4gICAgaWYgKHRoaXMuZGV4QWRkckZvcm0ucGFnZS5jZXJ0RmlsZS52YWx1ZSkge1xuICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmRleEFkZHJGb3JtLnBhZ2UuY2VydEZpbGUuZmlsZXNcbiAgICAgIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGgpIGNlcnQgPSBhd2FpdCBmaWxlc1swXS50ZXh0KClcbiAgICB9XG4gICAgcmV0dXJuIGNlcnRcbiAgfVxuXG4gIC8qIENhbGxlZCBhZnRlciBzdWNjZXNzZnVsIHJlZ2lzdHJhdGlvbiB0byBhIERFWC4gKi9cbiAgYXN5bmMgcmVnaXN0ZXJERVhTdWNjZXNzICgpIHtcbiAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgIGFwcCgpLnVwZGF0ZU1lbnVJdGVtc0Rpc3BsYXkoKVxuICAgIGF3YWl0IGFwcCgpLmxvYWRQYWdlKHRoaXMuZGF0YS5iYWNrVG8gfHwgJ21hcmtldHMnKVxuICB9XG5cbiAgYXN5bmMgbmV3V2FsbGV0Q3JlYXRlZCAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIpIHtcbiAgICB0aGlzLnJlZ0Fzc2V0Rm9ybS5yZWZyZXNoKClcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgYXBwKCkuZmV0Y2hVc2VyKClcbiAgICBpZiAoIXVzZXIpIHJldHVyblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBhc3NldCA9IHVzZXIuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3Qgd2FsbGV0ID0gYXNzZXQud2FsbGV0XG4gICAgY29uc3QgYm9uZEFtdCA9IHRoaXMueGMuYm9uZEFzc2V0c1thc3NldC5zeW1ib2xdLmFtb3VudFxuXG4gICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICB0aGlzLndhbGxldFdhaXRGb3JtLnNldFdhbGxldChhc3NldElELCBib25kc0ZlZUJ1ZmZlciwgdGllcilcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0QXNzZXQoYXNzZXRJRCwgdGllciwgYm9uZHNGZWVCdWZmZXIpXG4gICAgaWYgKHdhbGxldC5zeW5jZWQgJiYgd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlID49IDIgKiBib25kQW10ICsgYm9uZHNGZWVCdWZmZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuYW5pbWF0ZUNvbmZpcm1Gb3JtKHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGF3YWl0IHNsaWRlU3dhcChwYWdlLm5ld1dhbGxldEZvcm0sIHBhZ2Uud2FsbGV0V2FpdClcbiAgfVxufVxuIiwiZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICBsb2c6ICguLi5hcmdzOiBhbnkpID0+IHZvaWRcbiAgICBlbmFibGVMb2dnZXI6IChsb2dnZXJJRDogc3RyaW5nLCBlbmFibGU6IGJvb2xlYW4pID0+IHZvaWRcbiAgICByZWNvcmRMb2dnZXI6IChsb2dnZXJJRDogc3RyaW5nLCBlbmFibGU6IGJvb2xlYW4pID0+IHZvaWRcbiAgICBkdW1wTG9nZ2VyOiAobG9nZ2VySUQ6IHN0cmluZykgPT4gdm9pZFxuICAgIHRlc3RGb3JtYXRGb3VyU2lnRmlnczogKCkgPT4gdm9pZFxuICAgIHRlc3RGb3JtYXRSYXRlRnVsbFByZWNpc2lvbjogKCkgPT4gdm9pZFxuICAgIHVzZXI6ICgpID0+IFVzZXJcbiAgICBjZXhCb29rOiAoKSA9PiBQcm9taXNlPHZvaWQ+XG4gICAgbW1TdGF0dXM6ICgpID0+IE1hcmtldE1ha2luZ1N0YXR1c1xuICAgIGlzV2Vidmlldz86ICgpID0+IGJvb2xlYW5cbiAgICB3ZWJraXQ6IGFueSB8IHVuZGVmaW5lZFxuICAgIG9wZW5Vcmw6ICh1cmw6IHN0cmluZykgPT4gdm9pZFxuICAgIHNlbmRPU05vdGlmaWNhdGlvbiAodGl0bGU6IHN0cmluZywgYm9keT86IHN0cmluZyk6IHZvaWRcbiAgICBjbGVhckxvY2FsZSAoKTogdm9pZFxuICB9XG59XG5cbmV4cG9ydCBlbnVtIENvbm5lY3Rpb25TdGF0dXMge1xuICBEaXNjb25uZWN0ZWQgPSAwLFxuICBDb25uZWN0ZWQgPSAxLFxuICBJbnZhbGlkQ2VydCA9IDIsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9uZE9wdGlvbnMge1xuICBib25kQXNzZXRJRDogbnVtYmVyXG4gIHRhcmdldFRpZXI6IG51bWJlclxuICBtYXhCb25kZWRBbXQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlcHV0YXRpb24ge1xuICBib25kZWRUaWVyOiBudW1iZXJcbiAgcGVuYWx0aWVzOiBudW1iZXJcbiAgbGVnYWN5VGllcjogYm9vbGVhblxuICBzY29yZTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXhjaGFuZ2VBdXRoIHtcbiAgcmVwOiBSZXB1dGF0aW9uXG4gIGJvbmRBc3NldElEOiBudW1iZXJcbiAgcGVuZGluZ1N0cmVuZ3RoOiBudW1iZXJcbiAgd2Vha1N0cmVuZ3RoOiBudW1iZXJcbiAgbGl2ZVN0cmVuZ3RoOiBudW1iZXJcbiAgdGFyZ2V0VGllcjogbnVtYmVyXG4gIGVmZmVjdGl2ZVRpZXI6IG51bWJlclxuICBtYXhCb25kZWRBbXQ6IG51bWJlclxuICBwZW5hbHR5Q29tcHM6IG51bWJlclxuICBwZW5kaW5nQm9uZHM6IFBlbmRpbmdCb25kU3RhdGVbXVxuICBleHBpcmVkQm9uZHM6IGFueVtdXG4gIGNvbXBlbnNhdGlvbjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXhjaGFuZ2Uge1xuICBob3N0OiBzdHJpbmdcbiAgYWNjdElEOiBzdHJpbmdcbiAgYXV0aDogRXhjaGFuZ2VBdXRoXG4gIG1hcmtldHM6IFJlY29yZDxzdHJpbmcsIE1hcmtldD5cbiAgYXNzZXRzOiBSZWNvcmQ8bnVtYmVyLCBBc3NldD5cbiAgY29ubmVjdGlvblN0YXR1czogQ29ubmVjdGlvblN0YXR1c1xuICB2aWV3T25seTogYm9vbGVhblxuICBib25kQXNzZXRzOiBSZWNvcmQ8c3RyaW5nLCBCb25kQXNzZXQ+XG4gIGNhbmRsZUR1cnM6IHN0cmluZ1tdXG4gIG1heFNjb3JlOiBudW1iZXJcbiAgcGVuYWx0eVRocmVzaG9sZDogbnVtYmVyXG4gIGRpc2FibGVkOmJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBDYW5kbGUge1xuICBzdGFydFN0YW1wOiBudW1iZXJcbiAgZW5kU3RhbXA6IG51bWJlclxuICBtYXRjaFZvbHVtZTogbnVtYmVyXG4gIHF1b3RlVm9sdW1lOiBudW1iZXJcbiAgaGlnaFJhdGU6IG51bWJlclxuICBsb3dSYXRlOiBudW1iZXJcbiAgc3RhcnRSYXRlOiBudW1iZXJcbiAgZW5kUmF0ZTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FuZGxlc1BheWxvYWQge1xuICBkdXI6IHN0cmluZ1xuICBtczogbnVtYmVyXG4gIGNhbmRsZXM6IENhbmRsZVtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFya2V0IHtcbiAgbmFtZTogc3RyaW5nXG4gIGJhc2VpZDogbnVtYmVyXG4gIGJhc2VzeW1ib2w6IHN0cmluZ1xuICBxdW90ZWlkOiBudW1iZXJcbiAgcXVvdGVzeW1ib2w6IHN0cmluZ1xuICBsb3RzaXplOiBudW1iZXJcbiAgcGFyY2Vsc2l6ZTogbnVtYmVyXG4gIHJhdGVzdGVwOiBudW1iZXJcbiAgZXBvY2hsZW46IG51bWJlclxuICBzdGFydGVwb2NoOiBudW1iZXJcbiAgYnV5YnVmZmVyOiBudW1iZXJcbiAgb3JkZXJzOiBPcmRlcltdXG4gIHNwb3Q6IFNwb3QgfCB1bmRlZmluZWRcbiAgYXRvbVRvQ29udjogbnVtYmVyXG4gIGluZmxpZ2h0OiBJbkZsaWdodE9yZGVyW11cbiAgbWluaW11bVJhdGU6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEluRmxpZ2h0T3JkZXIgZXh0ZW5kcyBPcmRlciB7XG4gIHRlbXBJRDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3JkZXIge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgYmFzZVN5bWJvbDogc3RyaW5nXG4gIHF1b3RlSUQ6IG51bWJlclxuICBxdW90ZVN5bWJvbDogc3RyaW5nXG4gIG1hcmtldDogc3RyaW5nXG4gIHR5cGU6IG51bWJlclxuICBpZDogc3RyaW5nXG4gIHN0YW1wOiBudW1iZXJcbiAgc3VibWl0VGltZTogbnVtYmVyXG4gIHNpZzogc3RyaW5nXG4gIHN0YXR1czogbnVtYmVyXG4gIGVwb2NoOiBudW1iZXJcbiAgcXR5OiBudW1iZXJcbiAgc2VsbDogYm9vbGVhblxuICBmaWxsZWQ6IG51bWJlclxuICBtYXRjaGVzOiBNYXRjaFtdXG4gIGNhbmNlbGxpbmc6IGJvb2xlYW5cbiAgY2FuY2VsZWQ6IGJvb2xlYW5cbiAgZmVlc1BhaWQ6IEZlZUJyZWFrZG93blxuICBmdW5kaW5nQ29pbnM6IENvaW5bXVxuICBhY2NlbGVyYXRpb25Db2luczogQ29pbltdXG4gIGxvY2tlZGFtdDogbnVtYmVyXG4gIHJhdGU6IG51bWJlciAvLyBsaW1pdCBvbmx5XG4gIHRpZjogbnVtYmVyIC8vIGxpbWl0IG9ubHlcbiAgdGFyZ2V0T3JkZXJJRDogc3RyaW5nIC8vIGNhbmNlbCBvbmx5XG4gIHJlYWR5VG9UaWNrOiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWF0Y2gge1xuICBtYXRjaElEOiBzdHJpbmdcbiAgc3RhdHVzOiBudW1iZXJcbiAgYWN0aXZlOiBib29sZWFuXG4gIHJldm9rZWQ6IGJvb2xlYW5cbiAgcmF0ZTogbnVtYmVyXG4gIHF0eTogbnVtYmVyXG4gIHNpZGU6IG51bWJlclxuICBmZWVSYXRlOiBudW1iZXJcbiAgc3dhcDogQ29pblxuICBjb3VudGVyU3dhcDogQ29pblxuICByZWRlZW06IENvaW5cbiAgY291bnRlclJlZGVlbTogQ29pblxuICByZWZ1bmQ6IENvaW5cbiAgc3RhbXA6IG51bWJlclxuICBpc0NhbmNlbDogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNwb3Qge1xuICBzdGFtcDogbnVtYmVyXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICByYXRlOiBudW1iZXJcbiAgYm9va1ZvbHVtZTogbnVtYmVyIC8vIFVudXNlZD9cbiAgY2hhbmdlMjQ6IG51bWJlclxuICB2b2wyNDogbnVtYmVyXG4gIGxvdzI0OiBudW1iZXJcbiAgaGlnaDI0OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBc3NldCB7XG4gIGlkOiBudW1iZXJcbiAgc3ltYm9sOiBzdHJpbmdcbiAgdmVyc2lvbjogbnVtYmVyXG4gIG1heEZlZVJhdGU6IG51bWJlclxuICBzd2FwU2l6ZTogbnVtYmVyXG4gIHN3YXBTaXplQmFzZTogbnVtYmVyXG4gIHJlZGVlbVNpemU6IG51bWJlclxuICBzd2FwQ29uZjogbnVtYmVyXG4gIHVuaXRJbmZvOiBVbml0SW5mb1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvbmRBc3NldCB7XG4gIHZlcjogbnVtYmVyXG4gIGlkOiBudW1iZXJcbiAgY29uZnM6IG51bWJlclxuICBhbW91bnQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBlbmRpbmdCb25kU3RhdGUge1xuICBzeW1ib2w6IHN0cmluZ1xuICBhc3NldElEOiBudW1iZXJcbiAgY29pbklEOiBzdHJpbmdcbiAgY29uZnM6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlZUJyZWFrZG93biB7XG4gIHN3YXA6IG51bWJlclxuICByZWRlbXB0aW9uOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdXBwb3J0ZWRBc3NldCB7XG4gIGlkOiBudW1iZXJcbiAgc3ltYm9sOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIHdhbGxldDogV2FsbGV0U3RhdGVcbiAgaW5mbz86IFdhbGxldEluZm9cbiAgdG9rZW4/OiBUb2tlblxuICB1bml0SW5mbzogVW5pdEluZm9cbiAgd2FsbGV0Q3JlYXRpb25QZW5kaW5nOiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVG9rZW4ge1xuICBwYXJlbnRJRDogbnVtYmVyXG4gIG5hbWU6IHN0cmluZ1xuICB1bml0SW5mbzogVW5pdEluZm9cbiAgY29udHJhY3RBZGRyZXNzOiBzdHJpbmdcbiAgZGVmaW5pdGlvbjogV2FsbGV0RGVmaW5pdGlvblxufVxuXG5leHBvcnQgZW51bSBBcHByb3ZhbFN0YXR1cyB7XG4gIEFwcHJvdmVkID0gMCxcbiAgUGVuZGluZyA9IDEsXG4gIE5vdEFwcHJvdmVkID0gMlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlZVN0YXRlIHtcbiAgcmF0ZTogbnVtYmVyXG4gIHNlbmQ6IG51bWJlclxuICBzd2FwOiBudW1iZXJcbiAgcmVkZWVtOiBudW1iZXJcbiAgcmVmdW5kOiBudW1iZXJcbiAgc3RhbXBNUzogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3luY1N0YXR1cyB7XG4gIHN5bmNlZDogYm9vbGVhblxuICB0YXJnZXRIZWlnaHQ6IG51bWJlclxuICBzdGFydGluZ0Jsb2NrczogbnVtYmVyXG4gIGJsb2NrczogbnVtYmVyXG4gIHR4czogbnVtYmVyIHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2FsbGV0U3RhdGUge1xuICBzeW1ib2w6IHN0cmluZ1xuICBhc3NldElEOiBudW1iZXJcbiAgdmVyc2lvbjogbnVtYmVyXG4gIHR5cGU6IHN0cmluZ1xuICB0cmFpdHM6IG51bWJlclxuICBvcGVuOiBib29sZWFuXG4gIHJ1bm5pbmc6IGJvb2xlYW5cbiAgZGlzYWJsZWQ6IGJvb2xlYW5cbiAgYmFsYW5jZTogV2FsbGV0QmFsYW5jZVxuICBhZGRyZXNzOiBzdHJpbmdcbiAgdW5pdHM6IHN0cmluZ1xuICBlbmNyeXB0ZWQ6IGJvb2xlYW5cbiAgcGVlckNvdW50OiBudW1iZXJcbiAgc3luY2VkOiBib29sZWFuXG4gIHN5bmNQcm9ncmVzczogbnVtYmVyXG4gIHN5bmNTdGF0dXM6IFN5bmNTdGF0dXNcbiAgYXBwcm92ZWQ6IFJlY29yZDxudW1iZXIsIEFwcHJvdmFsU3RhdHVzPlxuICBmZWVTdGF0ZT86IEZlZVN0YXRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2FsbGV0SW5mbyB7XG4gIG5hbWU6IHN0cmluZ1xuICB2ZXJzaW9uOiBudW1iZXJcbiAgYXZhaWxhYmxld2FsbGV0czogV2FsbGV0RGVmaW5pdGlvbltdXG4gIHZlcnNpb25zOiBudW1iZXJbXVxuICBlbXB0eWlkeDogbnVtYmVyXG4gIHVuaXRpbmZvOiBVbml0SW5mb1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldEJhbGFuY2Uge1xuICBhdmFpbGFibGU6IG51bWJlclxuICBpbW1hdHVyZTogbnVtYmVyXG4gIGxvY2tlZDogbnVtYmVyXG4gIHN0YW1wOiBzdHJpbmcgLy8gdGltZS5UaW1lXG4gIG9yZGVybG9ja2VkOiBudW1iZXJcbiAgY29udHJhY3Rsb2NrZWQ6IG51bWJlclxuICBib25kbG9ja2VkOiBudW1iZXJcbiAgYm9uZFJlc2VydmVzOiBudW1iZXJcbiAgcmVzZXJ2ZXNEZWZpY2l0OiBudW1iZXJcbiAgb3RoZXI6IFJlY29yZDxzdHJpbmcsIEN1c3RvbUJhbGFuY2U+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tQmFsYW5jZSB7XG4gIGFtdDogbnVtYmVyXG4gIGxvY2tlZDogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldERlZmluaXRpb24ge1xuICBzZWVkZWQ6IGJvb2xlYW5cbiAgdHlwZTogc3RyaW5nXG4gIHRhYjogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgY29uZmlncGF0aDogc3RyaW5nXG4gIGNvbmZpZ29wdHM6IENvbmZpZ09wdGlvbltdXG4gIG11bHRpZnVuZGluZ29wdHM6IE9yZGVyT3B0aW9uW11cbiAgbm9hdXRoOiBib29sZWFuXG4gIGd1aWRlbGluazogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlnT3B0aW9uIHtcbiAga2V5OiBzdHJpbmdcbiAgZGlzcGxheW5hbWU6IHN0cmluZ1xuICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gIGRlZmF1bHQ6IGFueVxuICBtYXg6IGFueVxuICBtaW46IGFueVxuICBub2VjaG86IGJvb2xlYW5cbiAgaXNib29sZWFuOiBib29sZWFuXG4gIGlzZGF0ZTogYm9vbGVhblxuICBkaXNhYmxld2hlbmFjdGl2ZTogYm9vbGVhblxuICBpc0JpcnRoZGF5Q29uZmlnOiBib29sZWFuXG4gIHJlcGVhdGFibGU/OiBzdHJpbmdcbiAgcmVwZWF0Tj86IG51bWJlclxuICByZWdBc3NldD86IG51bWJlclxuICByZXF1aXJlZD86IGJvb2xlYW5cbiAgZGVwZW5kc09uPzogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29pbiB7XG4gIGlkOiBzdHJpbmdcbiAgc3RyaW5nSUQ6IHN0cmluZ1xuICBhc3NldElEOiBudW1iZXJcbiAgc3ltYm9sOiBzdHJpbmdcbiAgY29uZnM6IENvbmZpcm1hdGlvbnNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb25maXJtYXRpb25zIHtcbiAgcmVxdWlyZWQ6IG51bWJlclxuICBjb3VudDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5pdEluZm8ge1xuICBhdG9taWNVbml0OiBzdHJpbmdcbiAgY29udmVudGlvbmFsOiBEZW5vbWluYXRpb25cbiAgZGVub21pbmF0aW9uczogRGVub21pbmF0aW9uW11cbiAgZmVlUmF0ZURlbm9tOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZW5vbWluYXRpb24ge1xuICB1bml0OiBzdHJpbmdcbiAgY29udmVyc2lvbkZhY3RvcjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXh0ZW5zaW9uQ29uZmlndXJlZFdhbGxldCB7XG4gIGhpZGRlbkZpZWxkczogc3RyaW5nW11cbiAgZGlzYWJsZVdhbGxldFR5cGU6IGJvb2xlYW5cbiAgZGlzYWJsZVBhc3N3b3JkOiBib29sZWFuXG4gIGRpc2FibGVTdGFraW5nOiBib29sZWFuXG4gIGRpc2FibGVQcml2YWN5OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXh0ZW5zaW9uTW9kZUNvbmZpZyB7XG4gIG5hbWU6IHN0cmluZ1xuICByZXN0cmljdGVkV2FsbGV0czogUmVjb3JkPHN0cmluZywgRXh0ZW5zaW9uQ29uZmlndXJlZFdhbGxldD5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBVc2VyIHtcbiAgZXhjaGFuZ2VzOiBSZWNvcmQ8c3RyaW5nLCBFeGNoYW5nZT5cbiAgaW5pdGVkOiBib29sZWFuXG4gIHNlZWRnZW50aW1lOiBudW1iZXJcbiAgYXNzZXRzOiBSZWNvcmQ8bnVtYmVyLCBTdXBwb3J0ZWRBc3NldD5cbiAgZmlhdFJhdGVzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIGJvdHM6IEJvdFJlcG9ydFtdXG4gIG5ldDogbnVtYmVyXG4gIGV4dGVuc2lvbk1vZGVDb25maWc6IEV4dGVuc2lvbk1vZGVDb25maWdcbiAgYWN0aW9uczogQWN0aW9uUmVxdWlyZWROb3RlW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb3JlTm90ZSB7XG4gIHR5cGU6IHN0cmluZ1xuICB0b3BpYzogc3RyaW5nXG4gIHN1YmplY3Q6IHN0cmluZ1xuICBkZXRhaWxzOiBzdHJpbmdcbiAgc2V2ZXJpdHk6IG51bWJlclxuICBzdGFtcDogbnVtYmVyXG4gIGFja2VkOiBib29sZWFuXG4gIGlkOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb25kTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgYXNzZXQ6IG51bWJlclxuICBjb25maXJtYXRpb25zOiBudW1iZXJcbiAgZGV4OiBzdHJpbmdcbiAgY29pbklEOiBzdHJpbmcgfCBudWxsXG4gIHRpZXI6IG51bWJlciB8IG51bGxcbiAgYXV0aDogRXhjaGFuZ2VBdXRoIHwgbnVsbFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlcHV0YXRpb25Ob3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBob3N0OiBzdHJpbmdcbiAgcmVwOiBSZXB1dGF0aW9uXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFsYW5jZU5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGFzc2V0SUQ6IG51bWJlclxuICBiYWxhbmNlOiBXYWxsZXRCYWxhbmNlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmF0ZU5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIGZpYXRSYXRlczogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldENvbmZpZ05vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIHdhbGxldDogV2FsbGV0U3RhdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXYWxsZXRTeW5jTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgYXNzZXRJRDogbnVtYmVyXG4gIHN5bmNTdGF0dXM6IFN5bmNTdGF0dXNcbiAgc3luY1Byb2dyZXNzOiBudW1iZXJcbn1cblxuZXhwb3J0IHR5cGUgV2FsbGV0U3RhdGVOb3RlID0gV2FsbGV0Q29uZmlnTm90ZVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldENyZWF0aW9uTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgYXNzZXRJRDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFzZVdhbGxldE5vdGUge1xuICByb3V0ZTogc3RyaW5nXG4gIGFzc2V0SUQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRpcENoYW5nZU5vdGUgZXh0ZW5kcyBCYXNlV2FsbGV0Tm90ZSB7XG4gIHRpcDogbnVtYmVyXG4gIGRhdGE6IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1c3RvbVdhbGxldE5vdGUgZXh0ZW5kcyBCYXNlV2FsbGV0Tm90ZSB7XG4gIHBheWxvYWQ6IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zYWN0aW9uTm90ZSBleHRlbmRzIEJhc2VXYWxsZXROb3RlIHtcbiAgdHJhbnNhY3Rpb246IFdhbGxldFRyYW5zYWN0aW9uXG4gIG5ldzogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFjdGlvblJlcXVpcmVkTm90ZSBleHRlbmRzIEJhc2VXYWxsZXROb3RlIHtcbiAgdW5pcXVlSUQ6IHN0cmluZ1xuICBhY3Rpb25JRDogc3RyaW5nXG4gIHBheWxvYWQ6IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFjdGlvblJlc29sdmVkTm90ZSBleHRlbmRzIEJhc2VXYWxsZXROb3RlIHtcbiAgdW5pcXVlSUQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zYWN0aW9uQWN0aW9uTm90ZSB7XG4gIHR4OiBXYWxsZXRUcmFuc2FjdGlvblxuICBub25jZTogbnVtYmVyXG4gIG5ld0ZlZXM6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdhbGxldE5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIHBheWxvYWQ6IEJhc2VXYWxsZXROb3RlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29yZUFjdGlvblJlcXVpcmVkTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgcGF5bG9hZDogQWN0aW9uUmVxdWlyZWROb3RlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVqZWN0ZWRSZWRlbXB0aW9uRGF0YSB7XG4gIGFzc2V0SUQ6IG51bWJlclxuICBvcmRlcklEOiBzdHJpbmdcbiAgY29pbklEOiBzdHJpbmdcbiAgY29pbkZtdDogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3BvdFByaWNlTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgaG9zdDogc3RyaW5nXG4gIHNwb3RzOiBSZWNvcmQ8c3RyaW5nLCBTcG90PlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJ1blN0YXRzTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgaG9zdDogc3RyaW5nXG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxuICBzdGF0cz86IFJ1blN0YXRzXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUnVuRXZlbnROb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIHN0YXJ0VGltZTogbnVtYmVyXG4gIGV2ZW50OiBNYXJrZXRNYWtpbmdFdmVudFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1ha2VyUHJvZ3JhbSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBiYXNlSUQ6IG51bWJlclxuICBxdW90ZUlEOiBudW1iZXJcbiAgbG90czogbnVtYmVyXG4gIG9yYWNsZVdlaWdodGluZzogbnVtYmVyXG4gIG9yYWNsZUJpYXM6IG51bWJlclxuICBkcmlmdFRvbGVyYW5jZTogbnVtYmVyXG4gIGdhcEZhY3RvcjogbnVtYmVyXG4gIGdhcFN0cmF0ZWd5OiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb3RPcmRlciB7XG4gIGhvc3Q6IHN0cmluZ1xuICBtYXJrZXRJRDogc3RyaW5nXG4gIG9yZGVySUQ6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJvdFJlcG9ydCB7XG4gIHByb2dyYW1JRDogbnVtYmVyXG4gIHByb2dyYW06IE1ha2VyUHJvZ3JhbVxuICBydW5uaW5nOiBib29sZWFuXG4gIG9yZGVyczogQm90T3JkZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb3RGZWVzIHtcbiAgc3dhcDogbnVtYmVyXG4gIHJlZGVlbTogbnVtYmVyXG4gIHJlZnVuZDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG90RmVlUmFuZ2Uge1xuICBtYXg6IExvdEZlZXNcbiAgZXN0aW1hdGVkOiBMb3RGZWVzXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXNzZXRCb29raW5nRmVlcyBleHRlbmRzIExvdEZlZVJhbmdlIHtcbiAgYm9va2luZ0ZlZXNQZXJMb3Q6IG51bWJlclxuICBib29raW5nRmVlc1BlckNvdW50ZXJMb3Q6IG51bWJlclxuICBib29raW5nRmVlczogbnVtYmVyXG4gIHN3YXBSZXNlcnZlc0ZhY3RvcjogbnVtYmVyIC8vICgxICsgb3JkZXJSZXNlcnZlc0ZhY3RvcilcbiAgcmVkZWVtUmVzZXJ2ZXNGYWN0b3I6IG51bWJlclxuICB0b2tlbkZlZXNQZXJTd2FwOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb29raW5nRmVlcyB7XG4gIGJhc2U6IEFzc2V0Qm9va2luZ0ZlZXNcbiAgcXVvdGU6QXNzZXRCb29raW5nRmVlc1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcmtldFJlcG9ydCB7XG4gIHByaWNlOiBudW1iZXJcbiAgb3JhY2xlczogT3JhY2xlUmVwb3J0W11cbiAgYmFzZUZpYXRSYXRlOiBudW1iZXJcbiAgcXVvdGVGaWF0UmF0ZTogbnVtYmVyXG4gIGJhc2VGZWVzOiBMb3RGZWVSYW5nZVxuICBxdW90ZUZlZXM6IExvdEZlZVJhbmdlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWF0Y2hOb3RlIGV4dGVuZHMgQ29yZU5vdGUge1xuICBvcmRlcklEOiBzdHJpbmdcbiAgbWF0Y2g6IE1hdGNoXG4gIGhvc3Q6IHN0cmluZ1xuICBtYXJrZXRJRDogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29ubkV2ZW50Tm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgaG9zdDogc3RyaW5nXG4gIGNvbm5lY3Rpb25TdGF0dXM6IENvbm5lY3Rpb25TdGF0dXNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcmRlck5vdGUgZXh0ZW5kcyBDb3JlTm90ZSB7XG4gIG9yZGVyOiBPcmRlclxuICB0ZW1wSUQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlY2VudE1hdGNoIHtcbiAgcmF0ZTogbnVtYmVyXG4gIHF0eTogbnVtYmVyXG4gIHN0YW1wOiBudW1iZXJcbiAgc2VsbDogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVwb2NoTm90ZSBleHRlbmRzIENvcmVOb3RlIHtcbiAgaG9zdDogc3RyaW5nXG4gIG1hcmtldElEOiBzdHJpbmdcbiAgZXBvY2g6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFQSVJlc3BvbnNlIHtcbiAgcmVxdWVzdFN1Y2Nlc3NmdWw6IGJvb2xlYW5cbiAgb2s6IGJvb2xlYW5cbiAgbXNnOiBzdHJpbmdcbiAgZXJyPzogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9nTWVzc2FnZSB7XG4gIHRpbWU6IHN0cmluZ1xuICBtc2c6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5vdGVFbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBub3RlOiBDb3JlTm90ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJhbGFuY2VSZXNwb25zZSBleHRlbmRzIEFQSVJlc3BvbnNlIHtcbiAgYmFsYW5jZTogV2FsbGV0QmFsYW5jZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIExheW91dE1ldHJpY3Mge1xuICBib2R5VG9wOiBudW1iZXJcbiAgYm9keUxlZnQ6IG51bWJlclxuICB3aWR0aDogbnVtYmVyXG4gIGhlaWdodDogbnVtYmVyXG4gIGNlbnRlclg6IG51bWJlclxuICBjZW50ZXJZOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQYWdlRWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgdmFsdWU/OiBzdHJpbmdcbiAgc3JjPzogc3RyaW5nXG4gIGZpbGVzPzogRmlsZUxpc3RcbiAgY2hlY2tlZD86IGJvb2xlYW5cbiAgaHJlZj86IHN0cmluZ1xuICBodG1sRm9yPzogc3RyaW5nXG4gIG5hbWU/OiBzdHJpbmdcbiAgb3B0aW9ucz86IEhUTUxPcHRpb25FbGVtZW50W11cbiAgc2VsZWN0ZWRJbmRleD86IG51bWJlclxuICBkaXNhYmxlZD86IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb29sZWFuQ29uZmlnIHtcbiAgcmVhc29uOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBYWVJhbmdlUG9pbnQge1xuICBsYWJlbDogc3RyaW5nXG4gIHg6IG51bWJlclxuICB5OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBYWVJhbmdlIHtcbiAgc3RhcnQ6IFhZUmFuZ2VQb2ludFxuICBlbmQ6IFhZUmFuZ2VQb2ludFxuICB4VW5pdDogc3RyaW5nXG4gIHlVbml0OiBzdHJpbmdcbiAgcm91bmRYPzogYm9vbGVhblxuICByb3VuZFk/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3JkZXJPcHRpb24gZXh0ZW5kcyBDb25maWdPcHRpb24ge1xuICBib29sZWFuPzogQm9vbGVhbkNvbmZpZ1xuICB4eVJhbmdlPzogWFlSYW5nZVxuICBzaG93QnlEZWZhdWx0PzogYm9vbGVhblxuICBxdW90ZUFzc2V0T25seT86IGJvb2xlYW5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBTd2FwRXN0aW1hdGUge1xuICBsb3RzOiBudW1iZXJcbiAgdmFsdWU6IG51bWJlclxuICBtYXhGZWVzOiBudW1iZXJcbiAgcmVhbGlzdGljV29yc3RDYXNlOiBudW1iZXJcbiAgcmVhbGlzdGljQmVzdENhc2U6IG51bWJlclxuICBmZWVSZXNlcnZlc1BlckxvdDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVkZWVtRXN0aW1hdGUge1xuICByZWFsaXN0aWNCZXN0Q2FzZTogbnVtYmVyXG4gIHJlYWxpc3RpY1dvcnN0Q2FzZTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJlU3dhcCB7XG4gIGVzdGltYXRlOiBTd2FwRXN0aW1hdGVcbiAgb3B0aW9uczogT3JkZXJPcHRpb25bXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByZVJlZGVlbSB7XG4gIGVzdGltYXRlOiBSZWRlZW1Fc3RpbWF0ZVxuICBvcHRpb25zOiBPcmRlck9wdGlvbltdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3JkZXJFc3RpbWF0ZSB7XG4gIHN3YXA6IFByZVN3YXBcbiAgcmVkZWVtOiBQcmVSZWRlZW1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBNYXhPcmRlckVzdGltYXRlIHtcbiAgc3dhcDogU3dhcEVzdGltYXRlXG4gIHJlZGVlbTogUmVkZWVtRXN0aW1hdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNYXhTZWxsIHtcbiAgbWF4U2VsbDogTWF4T3JkZXJFc3RpbWF0ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1heEJ1eSB7XG4gIG1heEJ1eTogTWF4T3JkZXJFc3RpbWF0ZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYWRlRm9ybSB7XG4gIGhvc3Q6IHN0cmluZ1xuICBpc0xpbWl0OiBib29sZWFuXG4gIHNlbGw6IGJvb2xlYW5cbiAgYmFzZTogbnVtYmVyXG4gIHF1b3RlOiBudW1iZXJcbiAgcXR5OiBudW1iZXJcbiAgcmF0ZTogbnVtYmVyXG4gIHRpZm5vdzogYm9vbGVhblxuICBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9va1VwZGF0ZSB7XG4gIGFjdGlvbjogc3RyaW5nXG4gIGhvc3Q6IHN0cmluZ1xuICBtYXJrZXRJRDogc3RyaW5nXG4gIG1hdGNoZXNTdW1tYXJ5OiBSZWNlbnRNYXRjaFtdXG4gIHBheWxvYWQ6IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1pbmlPcmRlciB7XG4gIHF0eTogbnVtYmVyXG4gIHF0eUF0b21pYzogbnVtYmVyXG4gIHJhdGU6IG51bWJlclxuICBtc2dSYXRlOiBudW1iZXJcbiAgZXBvY2g6IG51bWJlclxuICBzZWxsOiBib29sZWFuXG4gIHRva2VuOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb3JlT3JkZXJCb29rIHtcbiAgc2VsbHM6IE1pbmlPcmRlcltdXG4gIGJ1eXM6IE1pbmlPcmRlcltdXG4gIGVwb2NoOiBNaW5pT3JkZXJbXVxuICByZWNlbnRNYXRjaGVzOiBSZWNlbnRNYXRjaFtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFya2V0T3JkZXJCb29rIHtcbiAgYmFzZTogbnVtYmVyXG4gIHF1b3RlOiBudW1iZXJcbiAgYm9vazogQ29yZU9yZGVyQm9va1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlbWFpbmRlclVwZGF0ZSB7XG4gIHRva2VuOiBzdHJpbmdcbiAgcXR5OiBudW1iZXJcbiAgcXR5QXRvbWljOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBPcmRlckZpbHRlck1hcmtldCB7XG4gIGJhc2VJRDogbnVtYmVyXG4gIHF1b3RlSUQ6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyRmlsdGVyIHtcbiAgbj86IG51bWJlclxuICBvZmZzZXQ/OiBzdHJpbmdcbiAgaG9zdHM/OiBzdHJpbmdbXVxuICBhc3NldHM/OiBudW1iZXJbXVxuICBtYXJrZXQ/OiBPcmRlckZpbHRlck1hcmtldFxuICBzdGF0dXNlcz86IG51bWJlcltdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3JkZXJQbGFjZW1lbnQge1xuICBsb3RzOiBudW1iZXJcbiAgZ2FwRmFjdG9yOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBdXRvUmViYWxhbmNlQ29uZmlnIHtcbiAgbWluQmFzZVRyYW5zZmVyOiBudW1iZXJcbiAgbWluUXVvdGVUcmFuc2ZlcjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFzaWNNYXJrZXRNYWtpbmdDb25maWcge1xuICBnYXBTdHJhdGVneTogc3RyaW5nXG4gIHNlbGxQbGFjZW1lbnRzOiBPcmRlclBsYWNlbWVudFtdXG4gIGJ1eVBsYWNlbWVudHM6IE9yZGVyUGxhY2VtZW50W11cbiAgZHJpZnRUb2xlcmFuY2U6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFyYk1hcmtldE1ha2luZ1BsYWNlbWVudCB7XG4gIGxvdHM6IG51bWJlclxuICBtdWx0aXBsaWVyOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBcmJNYXJrZXRNYWtpbmdDb25maWcge1xuICBidXlQbGFjZW1lbnRzOiBBcmJNYXJrZXRNYWtpbmdQbGFjZW1lbnRbXVxuICBzZWxsUGxhY2VtZW50czogQXJiTWFya2V0TWFraW5nUGxhY2VtZW50W11cbiAgcHJvZml0OiBudW1iZXJcbiAgZHJpZnRUb2xlcmFuY2U6IG51bWJlclxuICBvcmRlclBlcnNpc3RlbmNlOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaW1wbGVBcmJDb25maWcge1xuICBwcm9maXRUcmlnZ2VyOiBudW1iZXJcbiAgbWF4QWN0aXZlQXJiczogbnVtYmVyXG4gIG51bUVwb2Noc0xlYXZlT3BlbjogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90Q0VYQ2ZnIHtcbiAgbmFtZTogc3RyaW5nXG4gIGF1dG9SZWJhbGFuY2U/OiBBdXRvUmViYWxhbmNlQ29uZmlnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90QmFsYW5jZUFsbG9jYXRpb24ge1xuICBkZXg6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbiAgY2V4OiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm90QXNzZXRDb25maWcge1xuICBzd2FwRmVlTjogbnVtYmVyXG4gIG9yZGVyUmVzZXJ2ZXNGYWN0b3I6IG51bWJlclxuICBzbGlwcGFnZUJ1ZmZlckZhY3RvcjogbnVtYmVyXG4gIHRyYW5zZmVyRmFjdG9yOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVSUNvbmZpZyB7XG4gIGJhc2VDb25maWc6IEJvdEFzc2V0Q29uZmlnXG4gIHF1b3RlQ29uZmlnOiBCb3RBc3NldENvbmZpZ1xuICBzaW1wbGVBcmJMb3RzPzogbnVtYmVyXG4gIGNleFJlYmFsYW5jZTogYm9vbGVhblxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0YXJ0Q29uZmlnIGV4dGVuZHMgTWFya2V0V2l0aEhvc3Qge1xuICBhdXRvUmViYWxhbmNlPzogQXV0b1JlYmFsYW5jZUNvbmZpZ1xuICBhbGxvYzogQm90QmFsYW5jZUFsbG9jYXRpb25cbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb3RDb25maWcge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIGJhc2VXYWxsZXRPcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxuICBxdW90ZVdhbGxldE9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gIGNleE5hbWU6IHN0cmluZ1xuICB1aUNvbmZpZzogVUlDb25maWdcbiAgYmFzaWNNYXJrZXRNYWtpbmdDb25maWc/OiBCYXNpY01hcmtldE1ha2luZ0NvbmZpZ1xuICBhcmJNYXJrZXRNYWtpbmdDb25maWc/OiBBcmJNYXJrZXRNYWtpbmdDb25maWdcbiAgc2ltcGxlQXJiQ29uZmlnPzogU2ltcGxlQXJiQ29uZmlnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ0VYQ29uZmlnIHtcbiAgbmFtZTogc3RyaW5nXG4gIGFwaUtleTogc3RyaW5nXG4gIGFwaVNlY3JldDogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFya2V0V2l0aEhvc3Qge1xuICBob3N0OiBzdHJpbmdcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTU1DRVhTdGF0dXMge1xuICBjb25maWc6IENFWENvbmZpZ1xuICBjb25uZWN0ZWQ6IGJvb2xlYW5cbiAgY29ubmVjdEVycjogc3RyaW5nXG4gIG1hcmtldHM6IFJlY29yZDxzdHJpbmcsIENFWE1hcmtldD5cbiAgYmFsYW5jZXM6IFJlY29yZDxudW1iZXIsIEV4Y2hhbmdlQmFsYW5jZT5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb3RCYWxhbmNlIHtcbiAgYXZhaWxhYmxlOiBudW1iZXJcbiAgbG9ja2VkOiBudW1iZXJcbiAgcGVuZGluZzogbnVtYmVyXG4gIHJlc2VydmVkOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb3RCYWxhbmNlcyB7XG4gIGRleDogQm90QmFsYW5jZVxuICBjZXg6IEJvdEJhbGFuY2Vcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCb3RJbnZlbnRvcnkge1xuICBhdmFpbDogbnVtYmVyXG4gIGxvY2tlZDogbnVtYmVyIC8vIGluY2x1ZGVzIEJvdEJhbGFuY2UucmVzZXJ2ZWRcbiAgdG90YWw6IG51bWJlciAvLyBhdmFpbCArIGxvY2tlZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJ1bm5pbmdCb3RJbnZlbnRvcnkge1xuICBhdmFpbDogbnVtYmVyXG4gIGxvY2tlZDogbnVtYmVyXG4gIGRleDogQm90SW52ZW50b3J5XG4gIGNleDogQm90SW52ZW50b3J5XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ0VYTm90aWZpY2F0aW9uIGV4dGVuZHMgQ29yZU5vdGUge1xuICBjZXhOYW1lOiBzdHJpbmdcbiAgbm90ZTogYW55XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ0VYQmFsYW5jZVVwZGF0ZSB7XG4gIGFzc2V0SUQ6IG51bWJlclxuICBiYWxhbmNlOiBFeGNoYW5nZUJhbGFuY2Vcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGZWVFc3RpbWF0ZXMgZXh0ZW5kcyBMb3RGZWVSYW5nZSB7XG4gIGJvb2tpbmdGZWVzUGVyTG90OiBudW1iZXJcbiAgYm9va2luZ0ZlZXM6IG51bWJlclxuICB0b2tlbkZlZXNQZXJTd2FwOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcm9qZWN0ZWRBbGxvYyB7XG4gIC8vIGJvb2sgaXMgaW52ZW50b3J5IGRlZGljYXRlZCBlaXRoZXIgdG8gYWN0aXZlIG9yZGVycyBmb3IgYmFzaWNtbSBhbmQgYXJibW0sXG4gIC8vIG9yIG9uIHJlc2VydmUgZm9yIG9yZGVycyBpbiB0aGUgY2FzZSBvZiBiYXNpY2FyYi4gYm9vayArIGJvb2tpbmdGZWVzIGlzIHRoZVxuICAvLyBzdGFydmF0aW9uIHRocmVzaG9sZCBmb3IgREVYLCBtZWFuaW5nIGl0J3MgaW1wb3NzaWJsZSB0byBzdGFydCBhIGJvdFxuICAvLyB1bnN0YXJ2ZWQgaWYgdGhlcmUgbm8gd2F5IHRvIGdldCBib29rICsgYm9va2luZ0ZlZXMgdG8gQmlzb24gV2FsbGV0LiBBIHVzZXJcbiAgLy8gY291bGQgcG90ZW50aWFsbHkgYWRqdXN0IG9yZGVyIHJlc2VydmVzIG9yIHN3YXAgZmVlIHJlc2VydmVzIHRvIGZyZWUgdXBcbiAgLy8gbW9yZSBmdW5kcywgYnV0IHdpdGggcG9zc2libGUgZGVncmFkYXRpb24gb2YgYm90IHBlcmZvcm1hbmNlLlxuICBib29rOiBudW1iZXJcbiAgLy8gYm9va2luZyBmZWVzIGlzIGZ1bmRpbmcgZGVkaWNhdGVkIHRvIGNvdmVyaW5nIHRoZSBmZWVzIGZvciBmdW5kZWQgb3JkZXJzLlxuICAvLyBib29raW5nRmVlcyBhcmUgaW4gdGhlIHVuaXRzIG9mIHRoZSBwYXJlbnQgY2hhaW4gZm9yIHRva2VuIGFzc2V0cy5cbiAgYm9va2luZ0ZlZXM6IG51bWJlclxuICAvLyBzd2FwRmVlUmVzZXJ2ZXMgaXMgb25seSByZXF1aXJlZCBmb3IgdG9rZW4gYXNzZXRzLiBUaGVzZSBhcmUgZmVlc1xuICAvLyByZXNlcnZlZCBmb3IgZnVuZGluZyBzd2Fwcy4gVGhlc2UgZmVlcyBhcmUgb25seSBkZWJpdGVkLCBzbyB3aWxsIGRlZmluaXRlbHlcbiAgLy8gcnVuIG91dCBldmVudHVhbGx5LCBidXQgd2UnbGwgZ2V0IGEgVUkgdGhhdCBlbmFibGVkIG1hbnVhbCBhbmQvb3IgYXV0b1xuICAvLyByZWZpbGwgc29vbi4gc3dhcEZlZVJlc2VydmVzIGFyZSBpbiB0aGUgdW5pdHMgb2YgdGhlIHBhcmVudCBjaGFpbi5cbiAgc3dhcEZlZVJlc2VydmVzOiBudW1iZXJcbiAgLy8gY2V4IGlzIHRoZSBpbnZlbnRvcnkgZGVkaWNhdGVkIHRvIGZ1bmRpbmcgY291bnRlci1vcmRlcnMgb24gY2V4IGZvciBhblxuICAvLyBhcmJtbSBvciBzaW1wbGVhcmIgYm90LiBjZXggaXMgdGhlIHN0YXJ2YXRpb24gdGhyZXNob2xkIGZvciBDRVguXG4gIGNleDogbnVtYmVyXG4gIC8vIG9yZGVyUmVzZXJ2ZXMgaXMgaW52ZW50b3J5IHJlc2VydmVkIGZvciBmYWNpbGl0YXRpbmcgd2l0aGRyYXdzIGFuZFxuICAvLyBkZXBvc2l0cyBvciBmb3IgcmVwbGFjaW5nIG1hdGNoZWQgb3JkZXJzLiBJdCdzIGEgZ29vZCBpZGVhIHRvIGhhdmUgYVxuICAvLyBsaXR0bGUgZXh0cmEgYXJvdW5kLCBvdGhlcndpc2UgYSB0cmFkZSBzZXF1ZW5jZSBnb25lIHdyb25nIGNvdWxkIHB1dFxuICAvLyB0aGUgYm90IGluIGEgc3RhcnZlZCBvciB1bmJhbGFuY2VkIHN0YXRlLlxuICBvcmRlclJlc2VydmVzOiBudW1iZXJcbiAgLy8gc2xpcHBhZ2VCdWZmZXIgaXMgb25seSByZXF1aXJlZCBmb3IgdGhlIHF1b3RlIGFzc2V0LiBUaGlzIGFjY291bnRzIGZvclxuICAvLyB2YXJpYXRpb25zIGluIHJhdGUsIGJlY2F1c2UgdGhlIHF1b3RlIGFzc2V0J3MgXCJsb3Qgc2l6ZVwiIHZhcmllcyB3aXRoXG4gIC8vIHJhdGUuIElmIHRoZSByYXRlIGdvZXMgZG93biwgdGhlIHF1b3RlLWNvbnZlcnRlZCBsb3Qgc2l6ZSBnb2VzIHVwLCBzb1xuICAvLyB3ZSdsbCBsZXQgdGhlIHVzZXIgY2hvb3NlIHRvIHJlc2VydmUgYSBsaXR0bGUgZXh0cmEgZm9yIHRoaXMgY2FzZS5cbiAgc2xpcHBhZ2VCdWZmZXI6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlZUdhcFN0YXRzIHtcbiAgYmFzaXNQcmljZTogbnVtYmVyXG4gIGZlZUdhcDogbnVtYmVyXG4gIHJlbW90ZUdhcDogbnVtYmVyXG4gIHJvdW5kVHJpcEZlZXM6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJ1blN0YXRzIHtcbiAgaW5pdGlhbEJhbGFuY2VzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIGRleEJhbGFuY2VzOiBSZWNvcmQ8bnVtYmVyLCBCb3RCYWxhbmNlPlxuICBjZXhCYWxhbmNlczogUmVjb3JkPG51bWJlciwgQm90QmFsYW5jZT5cbiAgcHJvZml0TG9zczogUHJvZml0TG9zc1xuICBzdGFydFRpbWU6IG51bWJlclxuICBwZW5kaW5nRGVwb3NpdHM6IG51bWJlclxuICBwZW5kaW5nV2l0aGRyYXdhbHM6IG51bWJlclxuICBjb21wbGV0ZWRNYXRjaGVzOiBudW1iZXJcbiAgdHJhZGVkVVNEOiBudW1iZXJcbiAgZmVlR2FwOiBGZWVHYXBTdGF0c1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1NQm90U3RhdHVzIHtcbiAgY29uZmlnOiBCb3RDb25maWdcbiAgcnVubmluZzogYm9vbGVhblxuICBydW5TdGF0cz86IFJ1blN0YXRzXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFya2V0TWFraW5nU3RhdHVzIHtcbiAgY2V4ZXM6IFJlY29yZDxzdHJpbmcsIE1NQ0VYU3RhdHVzPlxuICBib3RzOiBNTUJvdFN0YXR1c1tdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgREVYT3JkZXJFdmVudCB7XG4gIGlkOiBzdHJpbmdcbiAgcmF0ZTogbnVtYmVyXG4gIHF0eTogbnVtYmVyXG4gIHNlbGw6IGJvb2xlYW5cbiAgdHJhbnNhY3Rpb25zOiBXYWxsZXRUcmFuc2FjdGlvbltdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ0VYT3JkZXJFdmVudCB7XG4gIGlkOiBzdHJpbmdcbiAgcmF0ZTogbnVtYmVyXG4gIHF0eTogbnVtYmVyXG4gIHNlbGw6IGJvb2xlYW5cbiAgYmFzZUZpbGxlZDogbnVtYmVyXG4gIHF1b3RlRmlsbGVkOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXBvc2l0RXZlbnQge1xuICBhc3NldElEOiBudW1iZXJcbiAgdHJhbnNhY3Rpb246IFdhbGxldFRyYW5zYWN0aW9uXG4gIGNleENyZWRpdDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2l0aGRyYXdhbEV2ZW50IHtcbiAgaWQ6IHN0cmluZ1xuICBhc3NldElEOiBudW1iZXJcbiAgdHJhbnNhY3Rpb246IFdhbGxldFRyYW5zYWN0aW9uXG4gIGNleERlYml0OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCYWxhbmNlRWZmZWN0cyB7XG4gIHNldHRsZWQ6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbiAgcGVuZGluZzogUmVjb3JkPG51bWJlciwgbnVtYmVyPlxuICBsb2NrZWQ6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbiAgcmVzZXJ2ZWQ6IFJlY29yZDxudW1iZXIsIG51bWJlcj5cbn1cblxuZXhwb3J0IGludGVyZmFjZSBNYXJrZXRNYWtpbmdFdmVudCB7XG4gIGlkOiBudW1iZXJcbiAgdGltZXN0YW1wOiBudW1iZXJcbiAgYmFsYW5jZUVmZmVjdHM6IEJhbGFuY2VFZmZlY3RzXG4gIHBlbmRpbmc6IGJvb2xlYW5cbiAgZGV4T3JkZXJFdmVudD86IERFWE9yZGVyRXZlbnRcbiAgY2V4T3JkZXJFdmVudD86IENFWE9yZGVyRXZlbnRcbiAgZGVwb3NpdEV2ZW50PzogRGVwb3NpdEV2ZW50XG4gIHdpdGhkcmF3YWxFdmVudD86IFdpdGhkcmF3YWxFdmVudFxufVxuXG5pbnRlcmZhY2UgTWFya2V0RGF5IHtcbiAgdm9sOiBudW1iZXJcbiAgcXVvdGVWb2w6IG51bWJlclxuICBwcmljZUNoYW5nZTogbnVtYmVyXG4gIHByaWNlQ2hhbmdlUGN0OiBudW1iZXJcbiAgYXZnUHJpY2U6IG51bWJlclxuICBsYXN0UHJpY2U6IG51bWJlclxuICBvcGVuUHJpY2U6IG51bWJlclxuICBoaWdoUHJpY2U6IG51bWJlclxuICBsb3dQcmljZTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ0VYTWFya2V0IHtcbiAgYmFzZUlEOiBudW1iZXJcbiAgcXVvdGVJRDogbnVtYmVyXG4gIGJhc2VNaW5XaXRoZHJhdzogbnVtYmVyXG4gIHF1b3RlTWluV2l0aGRyYXc6IG51bWJlclxuICBkYXk6IE1hcmtldERheVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yYWNsZVJlcG9ydCB7XG4gIGhvc3Q6IHN0cmluZ1xuICB1c2RWb2w6IG51bWJlclxuICBiZXN0QnV5OiBudW1iZXJcbiAgYmVzdFNlbGw6IG51bWJlclxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4Y2hhbmdlQmFsYW5jZSB7XG4gIGF2YWlsYWJsZTogbnVtYmVyXG4gIGxvY2tlZDogbnVtYmVyXG59XG5cbi8vIGNoYW5naW5nIHRoZSBvcmRlciBvZiB0aGUgZWxlbWVudHMgaW4gdGhpcyBlbnVtIHdpbGwgYWZmZWN0XG4vLyB0aGUgc29ydGluZyBvZiB0aGUgcGVlcnMgdGFibGUgaW4gd2FsbGV0cy50cy5cbmV4cG9ydCBlbnVtIFBlZXJTb3VyY2Uge1xuICBXYWxsZXREZWZhdWx0LFxuICBVc2VyQWRkZWQsXG4gIERpc2NvdmVyZWQsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFsYW5jZVN0YXRlIHtcbiAgZmlhdFJhdGVzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIGJhbGFuY2VzOiBSZWNvcmQ8bnVtYmVyLCBCb3RCYWxhbmNlPlxuICBpbnZNb2RzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW1vdW50IHtcbiAgYXRvbXM6IG51bWJlclxuICBjb252ZW50aW9uYWw6IG51bWJlclxuICBmbXQ6IHN0cmluZ1xuICB1c2Q6IG51bWJlclxuICBmbXRVU0Q6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFByb2ZpdExvc3Mge1xuICBpbml0aWFsOiBSZWNvcmQ8bnVtYmVyLCBBbW91bnQ+XG4gIGluaXRpYWxVU0Q6IG51bWJlclxuICBtb2RzOiBSZWNvcmQ8bnVtYmVyLCBBbW91bnQ+XG4gIG1vZHNVU0Q6IG51bWJlclxuICBmaW5hbDogUmVjb3JkPG51bWJlciwgQW1vdW50PlxuICBmaW5hbFVTRDogbnVtYmVyXG4gIGRpZmZzOiBSZWNvcmQ8bnVtYmVyLCBBbW91bnQ+XG4gIHByb2ZpdDogbnVtYmVyXG4gIHByb2ZpdFJhdGlvOiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFtcGVkQm90Q29uZmlnIHtcbiAgdGltZXN0YW1wOiBudW1iZXJcbiAgY2ZnOiBCb3RDb25maWdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNYXJrZXRNYWtpbmdSdW5PdmVydmlldyB7XG4gIGVuZFRpbWU6IG51bWJlclxuICBjZmdzOiBTdGFtcGVkQm90Q29uZmlnW11cbiAgaW5pdGlhbEJhbGFuY2VzOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIHByb2ZpdExvc3M6IFByb2ZpdExvc3NcbiAgZmluYWxTdGF0ZTogQmFsYW5jZVN0YXRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2FsbGV0UGVlciB7XG4gIGFkZHI6IHN0cmluZ1xuICBzb3VyY2U6IFBlZXJTb3VyY2VcbiAgY29ubmVjdGVkOiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGlja2V0VHJhbnNhY3Rpb24ge1xuICBoYXNoOiBzdHJpbmdcbiAgdGlja2V0UHJpY2U6IG51bWJlclxuICBmZWVzOiBudW1iZXJcbiAgc3RhbXA6IG51bWJlclxuICBibG9ja0hlaWdodDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGlja2V0IHtcbiAgdHg6IFRpY2tldFRyYW5zYWN0aW9uXG4gIHN0YXR1czogbnVtYmVyXG4gIHNwZW5kZXI6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRCQ2hvaWNlIHtcbiAgaWQ6IHN0cmluZ1xuICBkZXNjcmlwdGlvbjogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVEJBZ2VuZGEge1xuICBpZDogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgY3VycmVudENob2ljZTogc3RyaW5nXG4gIGNob2ljZXM6IFRCQ2hvaWNlW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUS2V5UG9saWN5UmVzdWx0IHtcbiAga2V5OiBzdHJpbmdcbiAgcG9saWN5OiBzdHJpbmdcbiAgdGlja2V0Pzogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVEJUcmVhc3VyeVNwZW5kIHtcbiAgaGFzaDogc3RyaW5nXG4gIHZhbHVlOiBudW1iZXJcbiAgY3VycmVudFBvbGljeTogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhbmNlcyB7XG4gIGFnZW5kYXM6IFRCQWdlbmRhW11cbiAgdHNwZW5kczogVEJUcmVhc3VyeVNwZW5kW11cbiAgdHJlYXN1cnlLZXlzOiBUS2V5UG9saWN5UmVzdWx0W11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUaWNrZXRTdGF0cyB7XG4gIHRvdGFsUmV3YXJkczogbnVtYmVyXG4gIHRpY2tldENvdW50OiBudW1iZXJcbiAgdm90ZXM6IG51bWJlclxuICByZXZva2VzOiBudW1iZXJcbiAgbWVtcG9vbDogbnVtYmVyXG4gIHF1ZXVlZDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGlja2V0U3Rha2luZ1N0YXR1cyB7XG4gIHRpY2tldFByaWNlOiBudW1iZXJcbiAgdm90aW5nU3Vic2lkeTogbnVtYmVyXG4gIHZzcDogc3RyaW5nXG4gIGlzUlBDOiBib29sZWFuXG4gIHRpY2tldHM6IFRpY2tldFtdXG4gIHN0YW5jZXM6IFN0YW5jZXNcbiAgc3RhdHM6IFRpY2tldFN0YXRzXG59XG5cbi8vIFZvdGluZ1NlcnZpY2VQcm92aWRlciBpcyBpbmZvcm1hdGlvbiBhYm91dCBhIHZvdGluZyBzZXJ2aWNlIHByb3ZpZGVyLlxuZXhwb3J0IGludGVyZmFjZSBWb3RpbmdTZXJ2aWNlUHJvdmlkZXIge1xuICB1cmw6IHN0cmluZ1xuICBuZXR3b3JrOiBudW1iZXJcbiAgbGF1bmNoZWQ6IG51bWJlclxuICBsYXN0VXBkYXRlZDogbnVtYmVyXG4gIGFwaVZlcnNpb25zOiBudW1iZXJbXVxuICBmZWVQZXJjZW50YWdlOiBudW1iZXJcbiAgY2xvc2VkOiBib29sZWFuXG4gIHZvdGluZzogbnVtYmVyXG4gIHZvdGVkOiBudW1iZXJcbiAgcmV2b2tlZDogbnVtYmVyXG4gIHZzcGRWZXJzaW9uOiBzdHJpbmdcbiAgYmxvY2tIZWlnaHQ6IG51bWJlclxuICBuZXRTaGFyZTogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm9uZFR4SW5mbyB7XG4gIGJvbmRJRDogc3RyaW5nXG4gIGxvY2tUaW1lOiBudW1iZXJcbiAgYWNjb3VudElEOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXYWxsZXRUcmFuc2FjdGlvbiB7XG4gIHR5cGU6IG51bWJlclxuICBpZDogc3RyaW5nXG4gIGFtb3VudDogbnVtYmVyXG4gIGZlZXM6IG51bWJlclxuICB0aW1lc3RhbXA6IG51bWJlclxuICBibG9ja051bWJlcjogbnVtYmVyXG4gIHRva2VuSUQ/OiBudW1iZXJcbiAgcmVjaXBpZW50Pzogc3RyaW5nXG4gIGJvbmRJbmZvPzogQm9uZFR4SW5mb1xuICBhZGRpdGlvbmFsRGF0YTogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFR4SGlzdG9yeVJlc3VsdCB7XG4gIHR4cyA6IFdhbGxldFRyYW5zYWN0aW9uW11cbiAgbGFzdFR4OiBib29sZWFuXG59XG5cbmV4cG9ydCBjb25zdCBQcmVwYWlkQm9uZElEID0gMjE0NzQ4MzY0N1xuXG5leHBvcnQgaW50ZXJmYWNlIEFwcGxpY2F0aW9uIHtcbiAgYXNzZXRzOiBSZWNvcmQ8bnVtYmVyLCBTdXBwb3J0ZWRBc3NldD5cbiAgc2VlZEdlblRpbWU6IG51bWJlclxuICB1c2VyOiBVc2VyXG4gIG1tU3RhdHVzOiBNYXJrZXRNYWtpbmdTdGF0dXNcbiAgaGVhZGVyOiBIVE1MRWxlbWVudFxuICBoZWFkZXJTcGFjZTogSFRNTEVsZW1lbnRcbiAgd2FsbGV0TWFwOiBSZWNvcmQ8bnVtYmVyLCBXYWxsZXRTdGF0ZT5cbiAgZXhjaGFuZ2VzOiBSZWNvcmQ8c3RyaW5nLCBFeGNoYW5nZT5cbiAgZmlhdFJhdGVzTWFwOiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+XG4gIHNob3dQb3B1cHM6IGJvb2xlYW5cbiAgY29tbWl0SGFzaDogc3RyaW5nXG4gIGF1dGhlZDogYm9vbGVhblxuICBzdGFydCAoKTogUHJvbWlzZTx2b2lkPlxuICByZWNvbm5lY3RlZCAoKTogdm9pZFxuICBmZXRjaFVzZXIgKCk6IFByb21pc2U8VXNlciB8IHZvaWQ+XG4gIGZldGNoTU1TdGF0dXMgKCk6IFByb21pc2U8VXNlciB8IHZvaWQ+XG4gIGxvYWRQYWdlIChwYWdlOiBzdHJpbmcsIGRhdGE/OiBhbnksIHNraXBQdXNoPzogYm9vbGVhbik6IFByb21pc2U8Ym9vbGVhbj5cbiAgYXR0YWNoIChkYXRhOiBhbnkpOiB2b2lkXG4gIGJpbmRUb29sdGlwcyAoYW5jZXN0b3I6IEhUTUxFbGVtZW50KTogdm9pZFxuICBiaW5kVXJsSGFuZGxlcnMgKGFuY2VzdG9yOiBIVE1MRWxlbWVudCk6IHZvaWRcbiAgYXR0YWNoSGVhZGVyICgpOiB2b2lkXG4gIHVwZGF0ZU1hcmtldEVsZW1lbnRzIChhbmNlc3RvcjogUGFnZUVsZW1lbnQsIGJhc2VJRDogbnVtYmVyLCBxdW90ZUlEOiBudW1iZXIsIHhjPzogRXhjaGFuZ2UpOiB2b2lkXG4gIHNob3dEcm9wZG93biAoaWNvbjogSFRNTEVsZW1lbnQsIGRpYWxvZzogSFRNTEVsZW1lbnQpOiB2b2lkXG4gIGFja05vdGVzICgpOiB2b2lkXG4gIHNldE5vdGVUaW1lcyAobm90ZUxpc3Q6IEhUTUxFbGVtZW50KTogdm9pZFxuICBiaW5kSW50ZXJuYWxOYXZpZ2F0aW9uIChhbmNlc3RvcjogSFRNTEVsZW1lbnQpOiB2b2lkXG4gIHVwZGF0ZU1lbnVJdGVtc0Rpc3BsYXkgKCk6IHZvaWRcbiAgYXR0YWNoQ29tbW9uIChub2RlOiBIVE1MRWxlbWVudCk6IHZvaWRcbiAgdXBkYXRlQm9uZENvbmZzIChkZXhBZGRyOiBzdHJpbmcsIGNvaW5JRDogc3RyaW5nLCBjb25mczogbnVtYmVyLCBhc3NldElEOiBudW1iZXIpOiB2b2lkXG4gIGhhbmRsZUJvbmROb3RlIChub3RlOiBCb25kTm90ZSk6IHZvaWRcbiAgbG9nZ2VkSW4gKG5vdGVzOiBDb3JlTm90ZVtdLCBwb2tlczogQ29yZU5vdGVbXSk6IHZvaWRcbiAgc2V0UG9rZXMocG9rZXM6IENvcmVOb3RlW10pOiB2b2lkXG4gIGJvdFN0YXR1cyAoaG9zdDogc3RyaW5nLCBiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyKTogTU1Cb3RTdGF0dXMgfCB1bmRlZmluZWRcbiAgbm90aWZ5IChub3RlOiBDb3JlTm90ZSk6IHZvaWRcbiAgbG9nIChsb2dnZXJJRDogc3RyaW5nLCAuLi5tc2c6IGFueSk6IHZvaWRcbiAgcHJlcGVuZFBva2VFbGVtZW50IChub3RlOiBDb3JlTm90ZSk6IHZvaWRcbiAgcHJlcGVuZE5vdGVFbGVtZW50IChub3RlOiBDb3JlTm90ZSwgc2tpcFNhdmU/OiBib29sZWFuKTogdm9pZFxuICBwcmVwZW5kTGlzdEVsZW1lbnQgKG5vdGVMaXN0OiBIVE1MRWxlbWVudCwgbm90ZTogQ29yZU5vdGUsIGVsOiBOb3RlRWxlbWVudCk6IHZvaWRcbiAgbG9hZGluZyAoZWw6IEhUTUxFbGVtZW50KTogKCkgPT4gdm9pZFxuICBvcmRlcnMgKGhvc3Q6IHN0cmluZywgbWt0SUQ6IHN0cmluZyk6IE9yZGVyW11cbiAgaGF2ZUFjdGl2ZU9yZGVycyAoYXNzZXRJRDogbnVtYmVyKTogYm9vbGVhblxuICBvcmRlciAob2lkOiBzdHJpbmcpOiBPcmRlciB8IG51bGxcbiAgY2FuQWNjZWxlcmF0ZU9yZGVyKG9yZGVyOiBPcmRlcik6IGJvb2xlYW5cbiAgdW5pdEluZm8gKGFzc2V0SUQ6IG51bWJlciwgeGM/OiBFeGNoYW5nZSk6IFVuaXRJbmZvXG4gIGJhc2VDaGFpblN5bWJvbCAoYXNzZXRJRDogbnVtYmVyKTogc3RyaW5nXG4gIGV4dGVuc2lvbldhbGxldCAoYXNzZXRJRDogbnVtYmVyKTogRXh0ZW5zaW9uQ29uZmlndXJlZFdhbGxldCB8IHVuZGVmaW5lZFxuICBjb252ZW50aW9uYWxSYXRlIChiYXNlSUQ6IG51bWJlciwgcXVvdGVJRDogbnVtYmVyLCBlbmNSYXRlOiBudW1iZXIsIHhjPzogRXhjaGFuZ2UpOiBudW1iZXJcbiAgd2FsbGV0RGVmaW5pdGlvbiAoYXNzZXRJRDogbnVtYmVyLCB3YWxsZXRUeXBlOiBzdHJpbmcpOiBXYWxsZXREZWZpbml0aW9uXG4gIGN1cnJlbnRXYWxsZXREZWZpbml0aW9uIChhc3NldElEOiBudW1iZXIpOiBXYWxsZXREZWZpbml0aW9uXG4gIGZldGNoQmFsYW5jZSAoYXNzZXRJRDogbnVtYmVyKTogUHJvbWlzZTxXYWxsZXRCYWxhbmNlPlxuICBjaGVja1Jlc3BvbnNlIChyZXNwOiBBUElSZXNwb25zZSk6IGJvb2xlYW5cbiAgc2lnbk91dCAoKTogUHJvbWlzZTx2b2lkPlxuICByZWdpc3Rlck5vdGVGZWVkZXIgKHJlY2VpdmVyczogUmVjb3JkPHN0cmluZywgKG46IENvcmVOb3RlKSA9PiB2b2lkPik6IHZvaWRcbiAgdHhIaXN0b3J5KGFzc2V0SUQ6IG51bWJlciwgbjogbnVtYmVyLCBhZnRlcj86IHN0cmluZyk6IFByb21pc2U8VHhIaXN0b3J5UmVzdWx0PlxuICBnZXRXYWxsZXRUeChhc3NldElEOiBudW1iZXIsIHR4aWQ6IHN0cmluZyk6IFdhbGxldFRyYW5zYWN0aW9uIHwgdW5kZWZpbmVkXG4gIGNsZWFyVHhIaXN0b3J5KGFzc2V0SUQ6IG51bWJlcik6IHZvaWRcbiAgcGFyZW50QXNzZXQoYXNzZXRJRDogbnVtYmVyKTogU3VwcG9ydGVkQXNzZXRcbiAgbmVlZHNDdXN0b21Qcm92aWRlciAoYXNzZXRJRDogbnVtYmVyKTogUHJvbWlzZTxib29sZWFuPlxufVxuXG4vLyBUT0RPOiBEZWZpbmUgYW4gaW50ZXJmYWNlIGZvciBBcHBsaWNhdGlvbj9cbmxldCBhcHBsaWNhdGlvbjogQXBwbGljYXRpb25cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyQXBwbGljYXRpb24gKGE6IEFwcGxpY2F0aW9uKSB7XG4gIGFwcGxpY2F0aW9uID0gYVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwICgpOiBBcHBsaWNhdGlvbiB7XG4gIHJldHVybiBhcHBsaWNhdGlvblxufVxuIiwiaW1wb3J0IERvYyBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IFN0YXRlIGZyb20gJy4vc3RhdGUnXG5pbXBvcnQgeyBwb3N0SlNPTiB9IGZyb20gJy4vaHR0cCdcbmltcG9ydCAqIGFzIGZvcm1zIGZyb20gJy4vZm9ybXMnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCB7IHNldENvaW5IcmVmIH0gZnJvbSAnLi9jb2luZXhwbG9yZXJzJ1xuaW1wb3J0IHtcbiAgdXBkYXRlTnRmblNldHRpbmcsXG4gIERlc2t0b3BOdGZuU2V0dGluZyxcbiAgZmV0Y2hEZXNrdG9wTnRmblNldHRpbmdzLFxuICBkZXNrdG9wTnRmbkxhYmVscyxcbiAgTm90aWZpZXJcbn0gZnJvbSAnLi9ub3RpZmljYXRpb25zJ1xuaW1wb3J0IHtcbiAgYXBwLFxuICBFeGNoYW5nZSxcbiAgUGFnZUVsZW1lbnQsXG4gIFByZXBhaWRCb25kSURcbn0gZnJvbSAnLi9yZWdpc3RyeSdcblxuY29uc3QgYW5pbWF0aW9uTGVuZ3RoID0gMzAwXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNldHRpbmdzUGFnZSBleHRlbmRzIEJhc2VQYWdlIHtcbiAgYm9keTogSFRNTEVsZW1lbnRcbiAgY3VycmVudERFWDogRXhjaGFuZ2VcbiAgcGFnZTogUmVjb3JkPHN0cmluZywgUGFnZUVsZW1lbnQ+XG4gIGZvcm1zOiBQYWdlRWxlbWVudFtdXG4gIGZpYXRSYXRlU291cmNlczogUGFnZUVsZW1lbnRbXVxuICByZWdBc3NldEZvcm06IGZvcm1zLkZlZUFzc2V0U2VsZWN0aW9uRm9ybVxuICBjb25maXJtUmVnaXN0ZXJGb3JtOiBmb3Jtcy5Db25maXJtUmVnaXN0cmF0aW9uRm9ybVxuICBuZXdXYWxsZXRGb3JtOiBmb3Jtcy5OZXdXYWxsZXRGb3JtXG4gIHdhbGxldFdhaXRGb3JtOiBmb3Jtcy5XYWxsZXRXYWl0Rm9ybVxuICBkZXhBZGRyRm9ybTogZm9ybXMuREVYQWRkcmVzc0Zvcm1cbiAgYXBwUGFzc1Jlc2V0Rm9ybTogZm9ybXMuQXBwUGFzc1Jlc2V0Rm9ybVxuICBjdXJyZW50Rm9ybTogUGFnZUVsZW1lbnRcbiAga2V5dXA6IChlOiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG5cbiAgY29uc3RydWN0b3IgKGJvZHk6IEhUTUxFbGVtZW50KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMuYm9keSA9IGJvZHlcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlID0gRG9jLmlkRGVzY2VuZGFudHMoYm9keSlcblxuICAgIHRoaXMuZm9ybXMgPSBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLmZvcm1zLCAnOnNjb3BlID4gZm9ybScpXG4gICAgdGhpcy5maWF0UmF0ZVNvdXJjZXMgPSBEb2MuYXBwbHlTZWxlY3RvcihwYWdlLmZpYXRSYXRlU291cmNlcywgJ2lucHV0W3R5cGU9Y2hlY2tib3hdJylcblxuICAgIHBhZ2UuZGFya01vZGUuY2hlY2tlZCA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUuZGFya01vZGVMSykgPT09ICcxJ1xuICAgIERvYy5iaW5kKHBhZ2UuZGFya01vZGUsICdjbGljaycsICgpID0+IHtcbiAgICAgIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUuZGFya01vZGVMSywgcGFnZS5kYXJrTW9kZS5jaGVja2VkIHx8IGZhbHNlID8gJzEnIDogJzAnKVxuICAgICAgaWYgKHBhZ2UuZGFya01vZGUuY2hlY2tlZCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2RhcmsnKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdkYXJrJylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcGFnZS5zaG93UG9rZXMuY2hlY2tlZCA9IFN0YXRlLmZldGNoTG9jYWwoU3RhdGUucG9wdXBzTEspID09PSAnMSdcbiAgICBEb2MuYmluZChwYWdlLnNob3dQb2tlcywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2hvdyA9IHBhZ2Uuc2hvd1Bva2VzLmNoZWNrZWQgfHwgZmFsc2VcbiAgICAgIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUucG9wdXBzTEssIHNob3cgPyAnMScgOiAnMCcpXG4gICAgICBhcHAoKS5zaG93UG9wdXBzID0gc2hvd1xuICAgIH0pXG5cbiAgICBwYWdlLmNvbW1pdEhhc2gudGV4dENvbnRlbnQgPSBhcHAoKS5jb21taXRIYXNoLnN1YnN0cmluZygwLCA3KVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkQURleCwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5kZXhBZGRyRm9ybS5yZWZyZXNoKClcbiAgICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5kZXhBZGRyRm9ybSlcbiAgICB9KVxuXG4gICAgdGhpcy5maWF0UmF0ZVNvdXJjZXMuZm9yRWFjaChzcmMgPT4ge1xuICAgICAgRG9jLmJpbmQoc3JjLCAnY2hhbmdlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS90b2dnbGVyYXRlc291cmNlJywge1xuICAgICAgICAgIGRpc2FibGU6ICFzcmMuY2hlY2tlZCxcbiAgICAgICAgICBzb3VyY2U6IHNyYy52YWx1ZVxuICAgICAgICB9KVxuICAgICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgICAgIHNyYy5jaGVja2VkID0gIXNyYy5jaGVja2VkXG4gICAgICAgIH1cbiAgICAgICAgLy8gVXBkYXRlIGFzc2V0IHJhdGUgdmFsdWVzIGFuZCBkaXNhYmxlIGNvbnZlcnNpb24gc3RhdHVzLlxuICAgICAgICBhd2FpdCBhcHAoKS5mZXRjaFVzZXIoKVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgLy8gQXNzZXQgc2VsZWN0aW9uXG4gICAgdGhpcy5yZWdBc3NldEZvcm0gPSBuZXcgZm9ybXMuRmVlQXNzZXRTZWxlY3Rpb25Gb3JtKHBhZ2UucmVnQXNzZXRGb3JtLCBhc3luYyAoYXNzZXRJRDogbnVtYmVyLCB0aWVyOiBudW1iZXIpID0+IHtcbiAgICAgIGlmIChhc3NldElEID09PSBQcmVwYWlkQm9uZElEKSB7XG4gICAgICAgIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBjb25zdCB3YWxsZXQgPSBhc3NldC53YWxsZXRcbiAgICAgIGlmICh3YWxsZXQpIHtcbiAgICAgICAgY29uc3QgYm9uZEFzc2V0ID0gdGhpcy5jdXJyZW50REVYLmJvbmRBc3NldHNbYXNzZXQuc3ltYm9sXVxuICAgICAgICBjb25zdCBib25kc0ZlZUJ1ZmZlciA9IGF3YWl0IHRoaXMuZ2V0Qm9uZHNGZWVCdWZmZXIoYXNzZXRJRCwgcGFnZS5yZWdBc3NldEZvcm0pXG4gICAgICAgIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybS5zZXRBc3NldChhc3NldElELCB0aWVyLCBib25kc0ZlZUJ1ZmZlcilcbiAgICAgICAgaWYgKHdhbGxldC5zeW5jZWQgJiYgd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlID49IDIgKiBib25kQXNzZXQuYW1vdW50ICsgYm9uZHNGZWVCdWZmZXIpIHtcbiAgICAgICAgICB0aGlzLmFuaW1hdGVDb25maXJtRm9ybShwYWdlLnJlZ0Fzc2V0Rm9ybSlcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICB0aGlzLndhbGxldFdhaXRGb3JtLnNldFdhbGxldChhc3NldElELCBib25kc0ZlZUJ1ZmZlciwgdGllcilcbiAgICAgICAgdGhpcy5zbGlkZVN3YXAocGFnZS53YWxsZXRXYWl0KVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnNldEFzc2V0KGFzc2V0SUQsIHRpZXIsIDApXG4gICAgICB0aGlzLm5ld1dhbGxldEZvcm0uc2V0QXNzZXQoYXNzZXRJRClcbiAgICAgIHRoaXMuc2xpZGVTd2FwKHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICB9KVxuXG4gICAgLy8gQXBwcm92ZSBmZWUgcGF5bWVudFxuICAgIHRoaXMuY29uZmlybVJlZ2lzdGVyRm9ybSA9IG5ldyBmb3Jtcy5Db25maXJtUmVnaXN0cmF0aW9uRm9ybShwYWdlLmNvbmZpcm1SZWdGb3JtLCAoKSA9PiB7XG4gICAgICB0aGlzLnJlZ2lzdGVyREVYU3VjY2VzcygpXG4gICAgfSwgKCkgPT4ge1xuICAgICAgdGhpcy5hbmltYXRlUmVnQXNzZXQocGFnZS5jb25maXJtUmVnRm9ybSlcbiAgICB9KVxuXG4gICAgLy8gQ3JlYXRlIGEgbmV3IHdhbGxldFxuICAgIHRoaXMubmV3V2FsbGV0Rm9ybSA9IG5ldyBmb3Jtcy5OZXdXYWxsZXRGb3JtKFxuICAgICAgcGFnZS5uZXdXYWxsZXRGb3JtLFxuICAgICAgYXNzZXRJRCA9PiB0aGlzLm5ld1dhbGxldENyZWF0ZWQoYXNzZXRJRCwgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLnRpZXIpLFxuICAgICAgKCkgPT4gdGhpcy5hbmltYXRlUmVnQXNzZXQocGFnZS5uZXdXYWxsZXRGb3JtKVxuICAgIClcblxuICAgIHRoaXMud2FsbGV0V2FpdEZvcm0gPSBuZXcgZm9ybXMuV2FsbGV0V2FpdEZvcm0ocGFnZS53YWxsZXRXYWl0LCAoKSA9PiB7XG4gICAgICB0aGlzLmFuaW1hdGVDb25maXJtRm9ybShwYWdlLndhbGxldFdhaXQpXG4gICAgfSwgKCkgPT4geyB0aGlzLmFuaW1hdGVSZWdBc3NldChwYWdlLndhbGxldFdhaXQpIH0pXG5cbiAgICAvLyBFbnRlciBhbiBhZGRyZXNzIGZvciBhIG5ldyBERVhcbiAgICB0aGlzLmRleEFkZHJGb3JtID0gbmV3IGZvcm1zLkRFWEFkZHJlc3NGb3JtKHBhZ2UuZGV4QWRkckZvcm0sIGFzeW5jICh4YzogRXhjaGFuZ2UsIGNlcnRGaWxlOiBzdHJpbmcpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudERFWCA9IHhjXG4gICAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0RXhjaGFuZ2UoeGMsIGNlcnRGaWxlKVxuICAgICAgdGhpcy53YWxsZXRXYWl0Rm9ybS5zZXRFeGNoYW5nZSh4YylcbiAgICAgIHRoaXMucmVnQXNzZXRGb3JtLnNldEV4Y2hhbmdlKHhjLCBjZXJ0RmlsZSlcbiAgICAgIHRoaXMuYW5pbWF0ZVJlZ0Fzc2V0KHBhZ2UuZGV4QWRkckZvcm0pXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHBhZ2UuaW1wb3J0QWNjb3VudCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5wcmVwYXJlQWNjb3VudEltcG9ydChwYWdlLmF1dGhvcml6ZUFjY291bnRJbXBvcnRGb3JtKSlcbiAgICBmb3Jtcy5iaW5kKHBhZ2UuYXV0aG9yaXplQWNjb3VudEltcG9ydEZvcm0sIHBhZ2UuYXV0aG9yaXplSW1wb3J0QWNjb3VudENvbmZpcm0sICgpID0+IHRoaXMuaW1wb3J0QWNjb3VudCgpKVxuXG4gICAgRG9jLmJpbmQocGFnZS5jaGFuZ2VBcHBQVywgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93Rm9ybShwYWdlLmNoYW5nZUFwcFBXRm9ybSkpXG4gICAgZm9ybXMuYmluZChwYWdlLmNoYW5nZUFwcFBXRm9ybSwgcGFnZS5zdWJtaXROZXdQVywgKCkgPT4gdGhpcy5jaGFuZ2VBcHBQVygpKVxuXG4gICAgdGhpcy5hcHBQYXNzUmVzZXRGb3JtID0gbmV3IGZvcm1zLkFwcFBhc3NSZXNldEZvcm0ocGFnZS5yZXNldEFwcFBXRm9ybSwgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgYXBwKCkubG9hZFBhZ2UoJ2xvZ2luJylcbiAgICAgIERvYy5oaWRlKHBhZ2UuZm9ybXMpXG4gICAgfSlcbiAgICBEb2MuYmluZChwYWdlLnJlc2V0QXBwUFcsICdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuYXBwUGFzc1Jlc2V0Rm9ybS5yZWZyZXNoKClcbiAgICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5yZXNldEFwcFBXRm9ybSlcbiAgICAgIHRoaXMuYXBwUGFzc1Jlc2V0Rm9ybS5mb2N1cygpXG4gICAgfSlcblxuICAgIERvYy5iaW5kKHBhZ2UuYWNjb3VudEZpbGUsICdjaGFuZ2UnLCAoKSA9PiB0aGlzLm9uQWNjb3VudEZpbGVDaGFuZ2UoKSlcbiAgICBEb2MuYmluZChwYWdlLnJlbW92ZUFjY291bnQsICdjbGljaycsICgpID0+IHRoaXMuY2xlYXJBY2NvdW50RmlsZSgpKVxuICAgIERvYy5iaW5kKHBhZ2UuYWRkQWNjb3VudCwgJ2NsaWNrJywgKCkgPT4gcGFnZS5hY2NvdW50RmlsZS5jbGljaygpKVxuXG4gICAgRG9jLmJpbmQocGFnZS5leHBvcnRTZWVkLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLmV4cG9ydFNlZWRFcnIpXG4gICAgICB0aGlzLnNob3dGb3JtKHBhZ2UuZXhwb3J0U2VlZEF1dGgpXG4gICAgfSlcbiAgICBmb3Jtcy5iaW5kKHBhZ2UuZXhwb3J0U2VlZEF1dGgsIHBhZ2UuZXhwb3J0U2VlZFN1Ym1pdCwgKCkgPT4gdGhpcy5zdWJtaXRFeHBvcnRTZWVkUmVxKCkpXG5cbiAgICBEb2MuYmluZChwYWdlLmdhbWVDb2RlTGluaywgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93Rm9ybShwYWdlLmdhbWVDb2RlRm9ybSkpXG4gICAgRG9jLmJpbmQocGFnZS5nYW1lQ29kZVN1Ym1pdCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zdWJtaXRHYW1lQ29kZSgpKVxuXG4gICAgY29uc3QgY2xvc2VQb3B1cHMgPSAoKSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLmZvcm1zKVxuICAgICAgcGFnZS5leHBvcnRTZWVkUFcudmFsdWUgPSAnJ1xuICAgICAgcGFnZS5sZWdhY3lTZWVkLnRleHRDb250ZW50ID0gJydcbiAgICAgIHBhZ2UubW5lbW9uaWMudGV4dENvbnRlbnQgPSAnJ1xuICAgIH1cblxuICAgIERvYy5iaW5kKHBhZ2UuZm9ybXMsICdtb3VzZWRvd24nLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKCFEb2MubW91c2VJbkVsZW1lbnQoZSwgdGhpcy5jdXJyZW50Rm9ybSkpIHsgY2xvc2VQb3B1cHMoKSB9XG4gICAgfSlcblxuICAgIHRoaXMua2V5dXAgPSAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICBjbG9zZVBvcHVwcygpXG4gICAgICB9XG4gICAgfVxuICAgIERvYy5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuXG4gICAgcGFnZS5mb3Jtcy5xdWVyeVNlbGVjdG9yQWxsKCcuZm9ybS1jbG9zZXInKS5mb3JFYWNoKGVsID0+IHtcbiAgICAgIERvYy5iaW5kKGVsLCAnY2xpY2snLCAoKSA9PiB7IGNsb3NlUG9wdXBzKCkgfSlcbiAgICB9KVxuXG4gICAgdGhpcy5yZW5kZXJEZXNrdG9wTnRmblNldHRpbmdzKClcbiAgfVxuXG4gIHVwZGF0ZU50Zm5TZXR0aW5nIChlOiBFdmVudCkge1xuICAgIGNvbnN0IGNoZWNrYm94ID0gZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudFxuICAgIGNvbnN0IG5vdGVUeXBlID0gY2hlY2tib3guZ2V0QXR0cmlidXRlKCduYW1lJylcbiAgICBpZiAobm90ZVR5cGUgPT09IG51bGwpIHJldHVyblxuICAgIGNvbnN0IGVuYWJsZWQgPSBjaGVja2JveC5jaGVja2VkXG4gICAgdXBkYXRlTnRmblNldHRpbmcobm90ZVR5cGUsIGVuYWJsZWQpXG4gIH1cblxuICBnZXRCcm93c2VyTnRmblNldHRpbmdzICgpOiBEZXNrdG9wTnRmblNldHRpbmcge1xuICAgIGNvbnN0IHBlcm1pc3Npb25zID0gZmV0Y2hEZXNrdG9wTnRmblNldHRpbmdzKClcbiAgICByZXR1cm4gcGVybWlzc2lvbnNcbiAgfVxuXG4gIGFzeW5jIHJlbmRlckRlc2t0b3BOdGZuU2V0dGluZ3MgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBudGZuU2V0dGluZ3MgPSB0aGlzLmdldEJyb3dzZXJOdGZuU2V0dGluZ3MoKVxuICAgIGNvbnN0IGxhYmVscyA9IGRlc2t0b3BOdGZuTGFiZWxzXG4gICAgY29uc3QgdG1wbCA9IHBhZ2UuYnJvd3Nlck50Zm5DaGVja2JveFRlbXBsYXRlXG4gICAgdG1wbC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJylcbiAgICBjb25zdCBjb250YWluZXIgPSBwYWdlLmJyb3dzZXJOdGZuQ2hlY2tib3hDb250YWluZXJcbiAgICBEb2MuZW1wdHkocGFnZS5icm93c2VyTnRmbkNoZWNrYm94Q29udGFpbmVyKVxuXG4gICAgT2JqZWN0LmtleXMobGFiZWxzKS5mb3JFYWNoKChub3RlVHlwZSkgPT4ge1xuICAgICAgY29uc3QgaHRtbCA9IHRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBjb25zdCBlbmFibGVkID0gbnRmblNldHRpbmdzW25vdGVUeXBlXVxuICAgICAgY29uc3QgY2hlY2tib3ggPSBEb2MudG1wbEVsZW1lbnQoaHRtbCwgJ2NoZWNrYm94JylcbiAgICAgIERvYy50bXBsRWxlbWVudChodG1sLCAnbGFiZWwnKS50ZXh0Q29udGVudCA9IGludGwucHJlcChsYWJlbHNbbm90ZVR5cGVdKVxuICAgICAgY2hlY2tib3guc2V0QXR0cmlidXRlKCduYW1lJywgbm90ZVR5cGUpXG4gICAgICBpZiAoZW5hYmxlZCkgY2hlY2tib3guc2V0QXR0cmlidXRlKCdjaGVja2VkJywgJ2NoZWNrZWQnKVxuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGh0bWwpXG4gICAgICBEb2MuYmluZChjaGVja2JveCwgJ2NsaWNrJywgdGhpcy51cGRhdGVOdGZuU2V0dGluZylcbiAgICB9KVxuXG4gICAgY29uc3QgZW5hYmxlZENoZWNrYm94ID0gcGFnZS5icm93c2VyTnRmbkVuYWJsZWRcblxuICAgIERvYy5iaW5kKGVuYWJsZWRDaGVja2JveCwgJ2NsaWNrJywgYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICBpZiAoTm90aWZpZXIubnRmblBlcm1pc3Npb25EZW5pZWQoKSkgcmV0dXJuXG4gICAgICBjb25zdCBjaGVja2JveCA9IGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnRcbiAgICAgIGlmIChjaGVja2JveC5jaGVja2VkKSB7XG4gICAgICAgIGF3YWl0IE5vdGlmaWVyLnJlcXVlc3ROdGZuUGVybWlzc2lvbigpXG4gICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSAhTm90aWZpZXIubnRmblBlcm1pc3Npb25EZW5pZWQoKVxuICAgICAgfVxuICAgICAgdGhpcy51cGRhdGVOdGZuU2V0dGluZyhlKVxuICAgICAgY2hlY2tib3guZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2NoYW5nZScpKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChlbmFibGVkQ2hlY2tib3gsICdjaGFuZ2UnLCAoZTogRXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IGNoZWNrYm94ID0gZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudFxuICAgICAgY29uc3QgcGVybURlbmllZCA9IE5vdGlmaWVyLm50Zm5QZXJtaXNzaW9uRGVuaWVkKClcbiAgICAgIERvYy5zZXRWaXMoY2hlY2tib3guY2hlY2tlZCwgcGFnZS5icm93c2VyTnRmbkNoZWNrYm94Q29udGFpbmVyKVxuICAgICAgRG9jLnNldFZpcyhwZXJtRGVuaWVkLCBwYWdlLmJyb3dzZXJOdGZuQmxvY2tlZE1zZylcbiAgICAgIGNoZWNrYm94LmRpc2FibGVkID0gcGVybURlbmllZFxuICAgIH0pXG5cbiAgICBlbmFibGVkQ2hlY2tib3guY2hlY2tlZCA9IChOb3RpZmllci5udGZuUGVybWlzc2lvbkdyYW50ZWQoKSAmJiBudGZuU2V0dGluZ3MuYnJvd3Nlck50Zm5FbmFibGVkKVxuICAgIGVuYWJsZWRDaGVja2JveC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpXG4gIH1cblxuICAvKlxuICAgKiBzbGlkZVN3YXAgYW5pbWF0ZXMgdGhlIHJlcGxhY2VtZW50IG9mIHRoZSBjdXJyZW50bHkgc2hvd24gZm9ybSB3aXRoIHRoZVxuICAgKiBuZXdGb3JtIGFuZCBzZXRzIHRoaXMuY3VycmVudEZvcm0uXG4gICAqL1xuICBzbGlkZVN3YXAgKG5ld0Zvcm06IFBhZ2VFbGVtZW50KSB7XG4gICAgZm9ybXMuc2xpZGVTd2FwKHRoaXMuY3VycmVudEZvcm0sIG5ld0Zvcm0pXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IG5ld0Zvcm1cbiAgfVxuXG4gIC8vIFJldHJpZXZlIGFuIGVzdGltYXRlIGZvciB0aGUgdHggZmVlIG5lZWRlZCB0byBjcmVhdGUgbmV3IGJvbmQgcmVzZXJ2ZXMuXG4gIGFzeW5jIGdldEJvbmRzRmVlQnVmZmVyIChhc3NldElEOiBudW1iZXIsIGZvcm06IEhUTUxFbGVtZW50KSB7XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhmb3JtKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2JvbmRzZmVlYnVmZmVyJywgeyBhc3NldElEIH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcmV0dXJuIDBcbiAgICB9XG4gICAgcmV0dXJuIHJlcy5mZWVCdWZmZXJcbiAgfVxuXG4gIGFzeW5jIG5ld1dhbGxldENyZWF0ZWQgKGFzc2V0SUQ6IG51bWJlciwgdGllcjogbnVtYmVyKSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgaWYgKCF1c2VyKSByZXR1cm5cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYXNzZXQgPSB1c2VyLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHdhbGxldCA9IGFzc2V0LndhbGxldFxuICAgIGNvbnN0IGJvbmRBbXQgPSB0aGlzLmN1cnJlbnRERVguYm9uZEFzc2V0c1thc3NldC5zeW1ib2xdLmFtb3VudFxuXG4gICAgY29uc3QgYm9uZHNGZWVCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJvbmRzRmVlQnVmZmVyKGFzc2V0SUQsIHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICB0aGlzLmNvbmZpcm1SZWdpc3RlckZvcm0uc2V0RmVlcyhhc3NldElELCBib25kc0ZlZUJ1ZmZlcilcbiAgICBpZiAod2FsbGV0LnN5bmNlZCAmJiB3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgPj0gMiAqIGJvbmRBbXQgKyBib25kc0ZlZUJ1ZmZlcikge1xuICAgICAgYXdhaXQgdGhpcy5hbmltYXRlQ29uZmlybUZvcm0ocGFnZS5uZXdXYWxsZXRGb3JtKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy53YWxsZXRXYWl0Rm9ybS5zZXRXYWxsZXQoYXNzZXRJRCwgYm9uZHNGZWVCdWZmZXIsIHRpZXIpXG4gICAgdGhpcy5zbGlkZVN3YXAocGFnZS53YWxsZXRXYWl0KVxuICB9XG5cbiAgYXN5bmMgb25BY2NvdW50RmlsZUNoYW5nZSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGZpbGVzID0gcGFnZS5hY2NvdW50RmlsZS5maWxlc1xuICAgIGlmICghZmlsZXMgfHwgIWZpbGVzLmxlbmd0aCkgcmV0dXJuXG4gICAgcGFnZS5zZWxlY3RlZEFjY291bnQudGV4dENvbnRlbnQgPSBmaWxlc1swXS5uYW1lXG4gICAgRG9jLnNob3cocGFnZS5yZW1vdmVBY2NvdW50KVxuICAgIERvYy5oaWRlKHBhZ2UuYWRkQWNjb3VudClcbiAgfVxuXG4gIC8qIGNsZWFyQWNjb3VudEZpbGUgY2xlYW51cCBhY2NvdW50RmlsZSB2YWx1ZSBhbmQgc2VsZWN0ZWRBY2NvdW50IHRleHQgKi9cbiAgY2xlYXJBY2NvdW50RmlsZSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UuYWNjb3VudEZpbGUudmFsdWUgPSAnJ1xuICAgIHBhZ2Uuc2VsZWN0ZWRBY2NvdW50LnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9ORV9TRUxFQ1RFRClcbiAgICBEb2MuaGlkZShwYWdlLnJlbW92ZUFjY291bnQpXG4gICAgRG9jLnNob3cocGFnZS5hZGRBY2NvdW50KVxuICB9XG5cbiAgYXN5bmMgcHJlcGFyZUFjY291bnRJbXBvcnQgKGF1dGhvcml6ZUFjY291bnRJbXBvcnRGb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBwYWdlLmltcG9ydEFjY291bnRFcnIudGV4dENvbnRlbnQgPSAnJ1xuICAgIHRoaXMuc2hvd0Zvcm0oYXV0aG9yaXplQWNjb3VudEltcG9ydEZvcm0pXG4gIH1cblxuICAvLyBpbXBvcnRBY2NvdW50IGltcG9ydHMgdGhlIGFjY291bnRcbiAgYXN5bmMgaW1wb3J0QWNjb3VudCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGxldCBhY2NvdW50U3RyaW5nID0gJydcbiAgICBpZiAocGFnZS5hY2NvdW50RmlsZS52YWx1ZSkge1xuICAgICAgY29uc3QgZmlsZXMgPSBwYWdlLmFjY291bnRGaWxlLmZpbGVzXG4gICAgICBpZiAoIWZpbGVzIHx8ICFmaWxlcy5sZW5ndGgpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignaW1wb3J0QWNjb3VudDogbm8gZmlsZSBzcGVjaWZpZWQnKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGFjY291bnRTdHJpbmcgPSBhd2FpdCBmaWxlc1swXS50ZXh0KClcbiAgICB9XG4gICAgbGV0IGFjY291bnRcbiAgICB0cnkge1xuICAgICAgYWNjb3VudCA9IEpTT04ucGFyc2UoYWNjb3VudFN0cmluZylcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBwYWdlLmltcG9ydEFjY291bnRFcnIudGV4dENvbnRlbnQgPSBlLm1lc3NhZ2VcbiAgICAgIERvYy5zaG93KHBhZ2UuaW1wb3J0QWNjb3VudEVycilcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAodHlwZW9mIGFjY291bnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmltcG9ydEFjY291bnRFcnIsIGludGwucHJlcChpbnRsLklEX0FDQ1RfVU5ERUZJTkVEKSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCB7IGJvbmRzID0gW10sIC4uLmFjY3RJbmYgfSA9IGFjY291bnRcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBhY2NvdW50OiBhY2N0SW5mLFxuICAgICAgYm9uZHM6IGJvbmRzXG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5ib2R5KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2ltcG9ydGFjY291bnQnLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5pbXBvcnRBY2NvdW50RXJyLCByZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGF3YWl0IGFwcCgpLmZldGNoVXNlcigpXG4gICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgICAvLyBJbml0aWFsIG1ldGhvZCBvZiBkaXNwbGF5aW5nIGltcG9ydGVkIGFjY291bnQuXG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG4gIH1cblxuICBhc3luYyBzdWJtaXRFeHBvcnRTZWVkUmVxICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgcHcgPSBwYWdlLmV4cG9ydFNlZWRQVy52YWx1ZVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcodGhpcy5ib2R5KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2V4cG9ydHNlZWQnLCB7IHBhc3M6IHB3IH0pXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5leHBvcnRTZWVkRXJyLCByZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHBhZ2UuZXhwb3J0U2VlZFBXLnZhbHVlID0gJydcbiAgICBpZiAocmVzLnNlZWQubGVuZ3RoID09PSAxMjggJiYgcmVzLnNlZWQuc3BsaXQoJyAnKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIHBhZ2UubGVnYWN5U2VlZC50ZXh0Q29udGVudCA9IHJlcy5zZWVkLm1hdGNoKC8uezEsMzJ9L2cpLm1hcCgoY2h1bms6IHN0cmluZykgPT4gY2h1bmsubWF0Y2goLy57MSw4fS9nKT8uam9pbignICcpKS5qb2luKCdcXG4nKVxuICAgIH0gZWxzZSBwYWdlLm1uZW1vbmljLnRleHRDb250ZW50ID0gcmVzLnNlZWRcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UuYXV0aG9yaXplU2VlZERpc3BsYXkpXG4gIH1cblxuICAvKiBzaG93Rm9ybSBzaG93cyBhIG1vZGFsIGZvcm0gd2l0aCBhIGxpdHRsZSBhbmltYXRpb24uICovXG4gIGFzeW5jIHNob3dGb3JtIChmb3JtOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gZm9ybVxuICAgIHRoaXMuZm9ybXMuZm9yRWFjaChmb3JtID0+IERvYy5oaWRlKGZvcm0pKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMTAwMDBweCdcbiAgICBEb2Muc2hvdyhwYWdlLmZvcm1zLCBmb3JtKVxuICAgIGNvbnN0IHNoaWZ0ID0gKHBhZ2UuZm9ybXMub2Zmc2V0V2lkdGggKyBmb3JtLm9mZnNldFdpZHRoKSAvIDJcbiAgICBhd2FpdCBEb2MuYW5pbWF0ZShhbmltYXRpb25MZW5ndGgsIHByb2dyZXNzID0+IHtcbiAgICAgIGZvcm0uc3R5bGUucmlnaHQgPSBgJHsoMSAtIHByb2dyZXNzKSAqIHNoaWZ0fXB4YFxuICAgIH0sICdlYXNlT3V0SGFyZCcpXG4gICAgZm9ybS5zdHlsZS5yaWdodCA9ICcwJ1xuICB9XG5cbiAgLyogZ2V0cyB0aGUgY29udGVudHMgb2YgdGhlIGNlcnQgZmlsZSAqL1xuICBhc3luYyBnZXRDZXJ0RmlsZSAoKSB7XG4gICAgbGV0IGNlcnQgPSAnJ1xuICAgIGlmICh0aGlzLmRleEFkZHJGb3JtLnBhZ2UuY2VydEZpbGUudmFsdWUpIHtcbiAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5kZXhBZGRyRm9ybS5wYWdlLmNlcnRGaWxlLmZpbGVzXG4gICAgICBpZiAoZmlsZXMgJiYgZmlsZXMubGVuZ3RoKSBjZXJ0ID0gYXdhaXQgZmlsZXNbMF0udGV4dCgpXG4gICAgfVxuICAgIHJldHVybiBjZXJ0XG4gIH1cblxuICAvKiBDYWxsZWQgYWZ0ZXIgc3VjY2Vzc2Z1bCByZWdpc3RyYXRpb24gdG8gYSBERVguICovXG4gIGFzeW5jIHJlZ2lzdGVyREVYU3VjY2VzcyAoKSB7XG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXG4gIH1cblxuICAvKiBDaGFuZ2UgYXBwbGljYXRpb24gcGFzc3dvcmQgICovXG4gIGFzeW5jIGNoYW5nZUFwcFBXICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5jaGFuZ2VQV0Vyck1zZylcblxuICAgIGNvbnN0IGNsZWFyVmFsdWVzID0gKCkgPT4ge1xuICAgICAgcGFnZS5hcHBQVy52YWx1ZSA9ICcnXG4gICAgICBwYWdlLm5ld0FwcFBXLnZhbHVlID0gJydcbiAgICAgIHBhZ2UuY29uZmlybU5ld1BXLnZhbHVlID0gJydcbiAgICB9XG4gICAgLy8gRW5zdXJlIHBhc3N3b3JkIGZpZWxkcyBhcmUgbm9uZW1wdHkuXG4gICAgaWYgKCFwYWdlLmFwcFBXLnZhbHVlIHx8ICFwYWdlLm5ld0FwcFBXLnZhbHVlIHx8ICFwYWdlLmNvbmZpcm1OZXdQVy52YWx1ZSkge1xuICAgICAgRG9jLnNob3dGb3JtRXJyb3IocGFnZS5jaGFuZ2VQV0Vyck1zZywgaW50bC5wcmVwKGludGwuSURfTk9fQVBQX1BBU1NfRVJST1JfTVNHKSlcbiAgICAgIGNsZWFyVmFsdWVzKClcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyBFbnN1cmUgcGFzc3dvcmQgY29uZmlybWF0aW9uIG1hdGNoZXMuXG4gICAgaWYgKHBhZ2UubmV3QXBwUFcudmFsdWUgIT09IHBhZ2UuY29uZmlybU5ld1BXLnZhbHVlKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmNoYW5nZVBXRXJyTXNnLCBpbnRsLnByZXAoaW50bC5JRF9QQVNTV09SRF9OT1RfTUFUQ0gpKVxuICAgICAgY2xlYXJWYWx1ZXMoKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5jaGFuZ2VBcHBQVylcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBhcHBQVzogcGFnZS5hcHBQVy52YWx1ZSxcbiAgICAgIG5ld0FwcFBXOiBwYWdlLm5ld0FwcFBXLnZhbHVlXG4gICAgfVxuICAgIGNsZWFyVmFsdWVzKClcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9jaGFuZ2VhcHBwYXNzJywgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UuY2hhbmdlUFdFcnJNc2csIHJlcy5tc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgRG9jLmhpZGUocGFnZS5mb3JtcylcbiAgfVxuXG4gIC8qXG4gICAqIHVubG9hZCBpcyBjYWxsZWQgYnkgdGhlIEFwcGxpY2F0aW9uIHdoZW4gdGhlIHVzZXIgbmF2aWdhdGVzIGF3YXkgZnJvbVxuICAgKiB0aGUgL3NldHRpbmdzIHBhZ2UuXG4gICAqL1xuICB1bmxvYWQgKCkge1xuICAgIERvYy51bmJpbmQoZG9jdW1lbnQsICdrZXl1cCcsIHRoaXMua2V5dXApXG4gIH1cblxuICAvKiBTd2FwIGluIHRoZSBhc3NldCBzZWxlY3Rpb24gZm9ybSBhbmQgcnVuIHRoZSBhbmltYXRpb24uICovXG4gIGFzeW5jIGFuaW1hdGVSZWdBc3NldCAob2xkRm9ybTogSFRNTEVsZW1lbnQpIHtcbiAgICBEb2MuaGlkZShvbGRGb3JtKVxuICAgIGNvbnN0IGZvcm0gPSB0aGlzLnBhZ2UucmVnQXNzZXRGb3JtXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IGZvcm1cbiAgICB0aGlzLnJlZ0Fzc2V0Rm9ybS5hbmltYXRlKClcbiAgICBEb2Muc2hvdyhmb3JtKVxuICB9XG5cbiAgLyogU3dhcCBpbiB0aGUgY29uZmlybWF0aW9uIGZvcm0gYW5kIHJ1biB0aGUgYW5pbWF0aW9uLiAqL1xuICBhc3luYyBhbmltYXRlQ29uZmlybUZvcm0gKG9sZEZvcm06IEhUTUxFbGVtZW50KSB7XG4gICAgdGhpcy5jb25maXJtUmVnaXN0ZXJGb3JtLmFuaW1hdGUoKVxuICAgIGNvbnN0IGZvcm0gPSB0aGlzLnBhZ2UuY29uZmlybVJlZ0Zvcm1cbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gZm9ybVxuICAgIERvYy5oaWRlKG9sZEZvcm0pXG4gICAgRG9jLnNob3coZm9ybSlcbiAgfVxuXG4gIGFzeW5jIHN1Ym1pdEdhbWVDb2RlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5nYW1lQ29kZUVycilcbiAgICBjb25zdCBjb2RlID0gcGFnZS5nYW1lQ29kZUlucHV0LnZhbHVlXG4gICAgaWYgKCFjb2RlKSB7XG4gICAgICBwYWdlLmdhbWVDb2RlRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTk9fQ09ERV9QUk9WSURFRClcbiAgICAgIERvYy5zaG93KHBhZ2UuZ2FtZUNvZGVFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgbXNnID0gcGFnZS5nYW1lQ29kZU1zZy52YWx1ZSB8fCAnJ1xuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5nYW1lQ29kZUZvcm0pXG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3JlZGVlbWdhbWVjb2RlJywgeyBjb2RlLCBtc2cgfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXNwKSkge1xuICAgICAgcGFnZS5nYW1lQ29kZUVyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FQSV9FUlJPUiwgeyBtc2c6IHJlc3AubXNnIH0pXG4gICAgICBEb2Muc2hvdyhwYWdlLmdhbWVDb2RlRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2UuZ2FtZUNvZGVTdWNjZXNzKVxuICAgIHBhZ2UuZ2FtZVJlZGVlbVR4LmRhdGFzZXQuZXhwbG9yZXJDb2luID0gcmVzcC5jb2luU3RyaW5nXG4gICAgY29uc3QgZGNyQmlwSUQgPSA0MlxuICAgIHNldENvaW5IcmVmKGRjckJpcElELCBwYWdlLmdhbWVSZWRlZW1UeClcbiAgICBwYWdlLmdhbWVSZWRlZW1UeC50ZXh0Q29udGVudCA9IHJlc3AuY29pblN0cmluZ1xuICAgIGNvbnN0IHVpID0gYXBwKCkudW5pdEluZm8oZGNyQmlwSUQpXG4gICAgcGFnZS5nYW1lUmVkZWVtVmFsdWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHJlc3Aud2luLCB1aSlcbiAgfVxufVxuIiwiLy8gU3RhdGUgaXMgYSBzZXQgb2Ygc3RhdGljIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgdXNlciBzdGF0ZS4gSXQgaGFzXG4vLyB1dGlsaXRpZXMgZm9yIHNldHRpbmcgYW5kIHJldHJpZXZpbmcgY29va2llcyBhbmQgc3RvcmluZyB1c2VyIGNvbmZpZ3VyYXRpb25cbi8vIHRvIGxvY2FsU3RvcmFnZS5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0YXRlIHtcbiAgLy8gQ29va2llIGtleXMuXG4gIHN0YXRpYyBkYXJrTW9kZUxLID0gJ2RhcmtNb2RlJ1xuICBzdGF0aWMgYXV0aENLID0gJ2RleGF1dGgnXG4gIHN0YXRpYyBwd0tleUNLID0gJ3Nlc3Npb25rZXknXG4gIC8vIExvY2FsIHN0b3JhZ2Uga2V5cyAoZm9yIGRhdGEgdGhhdCB3ZSBkb24ndCBuZWVkIGF0IHRoZSBzZXJ2ZXIpLlxuICBzdGF0aWMgcG9wdXBzTEsgPSAncG9wdXBzJ1xuICBzdGF0aWMgbG9nZ2Vyc0xLID0gJ2xvZ2dlcnMnXG4gIHN0YXRpYyByZWNvcmRlcnNMSyA9ICdyZWNvcmRlcnMnXG4gIHN0YXRpYyBsYXN0TWFya2V0TEsgPSAnc2VsZWN0ZWRNYXJrZXQnXG4gIHN0YXRpYyBkZXB0aFpvb21MSyA9ICdkZXB0aFpvb20nXG4gIHN0YXRpYyBsYXN0TU1NYXJrZXRMSyA9ICdtbU1hcmtldCdcbiAgc3RhdGljIG9wdGlvbnNFeHBhbnNpb25MSyA9ICdtbU9wdHNFeHBhbmQnXG4gIHN0YXRpYyBsZWZ0TWFya2V0RG9ja0xLID0gJ2xlZnRtYXJrZXRkb2NrJ1xuICBzdGF0aWMgc2VsZWN0ZWRBc3NldExLID0gJ3NlbGVjdGVkYXNzZXQnXG4gIHN0YXRpYyBub3RpZmljYXRpb25zTEsgPSAnbm90aWZpY2F0aW9ucycgLy8gREVQUkVDQVRFRCBiZWZvcmUgdjFcbiAgc3RhdGljIG9yZGVyRGlzY2xhaW1lckFja2VkTEsgPSAnb3JkQWNrJ1xuICBzdGF0aWMgbGFzdENhbmRsZUR1cmF0aW9uTEsgPSAnbGFzdENhbmRsZUR1cmF0aW9uJ1xuICBzdGF0aWMgbG9jYWxlU3BlY3NLZXkgPSAnbG9jYWxlU3BlY3NMSydcbiAgc3RhdGljIGxvY2FsZUtleSA9ICdsb2NhbGVMSydcblxuICBzdGF0aWMgc2V0Q29va2llIChjbmFtZTogc3RyaW5nLCBjdmFsdWU6IHN0cmluZykge1xuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSgpXG4gICAgLy8gU2V0IGNvb2tpZSB0byBleHBpcmUgaW4gdGVuIHllYXJzLlxuICAgIGQuc2V0VGltZShkLmdldFRpbWUoKSArICg4NjQwMCAqIDM2NSAqIDEwICogMTAwMCkpXG4gICAgY29uc3QgZXhwaXJlcyA9ICdleHBpcmVzPScgKyBkLnRvVVRDU3RyaW5nKClcbiAgICBkb2N1bWVudC5jb29raWUgPSBjbmFtZSArICc9JyArIGN2YWx1ZSArICc7JyArIGV4cGlyZXMgKyAnO3BhdGg9LydcbiAgfVxuXG4gIC8qXG4gICAqIGdldENvb2tpZSByZXR1cm5zIHRoZSB2YWx1ZSBhdCB0aGUgc3BlY2lmaWVkIGNvb2tpZSBuYW1lLCBvdGhlcndpc2UgbnVsbC5cbiAgICovXG4gIHN0YXRpYyBnZXRDb29raWUgKGNuYW1lOiBzdHJpbmcpIHtcbiAgICBmb3IgKGNvbnN0IGNzdHIgb2YgZG9jdW1lbnQuY29va2llLnNwbGl0KCc7JykpIHtcbiAgICAgIGNvbnN0IFtrLCB2XSA9IGNzdHIuc3BsaXQoJz0nKVxuICAgICAgaWYgKGsudHJpbSgpID09PSBjbmFtZSkgcmV0dXJuIHZcbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIC8qXG4gICAqIHJlbW92ZUNvb2tpZSB0ZWxscyB0aGUgYnJvd3NlciB0byBzdG9wIHVzaW5nIGNvb2tpZS4gSXQncyBub3QgZW5vdWdoIHRvIHNpbXBseVxuICAgKiBlcmFzZSBjb29raWUgdmFsdWUgYmVjYXVzZSBicm93c2VyIHdpbGwgc3RpbGwgc2VuZCBpdCB0byB0aGUgc2VydmVyICh3aXRoIGVtcHR5XG4gICAqIHZhbHVlKSwgYW5kIHRoYXQncyBub3Qgd2hhdCBzZXJ2ZXIgZXhwZWN0cy5cbiAgICovXG4gIHN0YXRpYyByZW1vdmVDb29raWUgKGNLZXk6IHN0cmluZykge1xuICAgIGRvY3VtZW50LmNvb2tpZSA9IGAke2NLZXl9PTtleHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MDEgR01UO2BcbiAgfVxuXG4gIC8qXG4gICAqIGlzRGFyayByZXR1cm5zIHRydWUgaWYgdGhlIGRhcmstbW9kZSBjb29raWUgaXMgY3VycmVudGx5IHNldCB0byAnMScgPSB0cnVlLlxuICAgKi9cbiAgc3RhdGljIGlzRGFyayAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIFN0YXRlLmZldGNoTG9jYWwoU3RhdGUuZGFya01vZGVMSykgPT09ICcxJ1xuICB9XG5cbiAgLyogc3RvcmVMb2NhbCBwdXRzIHRoZSBrZXktdmFsdWUgcGFpciBpbnRvIFdpbmRvdy5sb2NhbFN0b3JhZ2UuICovXG4gIHN0YXRpYyBzdG9yZUxvY2FsIChrOiBzdHJpbmcsIHY6IGFueSkge1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrLCBKU09OLnN0cmluZ2lmeSh2KSlcbiAgfVxuXG4gIC8qXG4gICogZmV0Y2hMb2NhbCB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBrZXkgaW4gV2luZG93LmxvY2FsU3RvcmFnZSwgb3JcbiAgKiBudWxsIGlmIHRoZSBubyB2YWx1ZSBleGlzdHMgZm9yIHRoZSBrZXkuXG4gICovXG4gIHN0YXRpYyBmZXRjaExvY2FsIChrOiBzdHJpbmcpIHtcbiAgICBjb25zdCB2ID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGspXG4gICAgaWYgKHYgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKHYpXG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKiByZW1vdmVMb2NhbCByZW1vdmVzIHRoZSBrZXktdmFsdWUgcGFpciBmcm9tIFdpbmRvdy5sb2NhbFN0b3JhZ2UuICovXG4gIHN0YXRpYyByZW1vdmVMb2NhbCAoazogc3RyaW5nKSB7XG4gICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGspXG4gIH1cbn1cblxuLy8gU2V0dGluZyBkZWZhdWx0cyBoZXJlLCB1bmxlc3Mgc3BlY2lmaWMgY29va2llIChvciBsb2NhbCBzdG9yYWdlKSB2YWx1ZSB3YXMgYWxyZWFkeSBjaG9zZW4gYnkgdGhlIHVzZXIuXG5pZiAoU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5kYXJrTW9kZUxLKSA9PT0gbnVsbCkgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5kYXJrTW9kZUxLLCAnMScpXG5pZiAoU3RhdGUuZmV0Y2hMb2NhbChTdGF0ZS5wb3B1cHNMSykgPT09IG51bGwpIFN0YXRlLnN0b3JlTG9jYWwoU3RhdGUucG9wdXBzTEssICcxJylcbmlmIChTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLmxlZnRNYXJrZXREb2NrTEspID09PSBudWxsKSBTdGF0ZS5zdG9yZUxvY2FsKFN0YXRlLmxlZnRNYXJrZXREb2NrTEssICcxJylcbiIsImltcG9ydCBEb2MsIHsgQW5pbWF0aW9uLCBBbmlUb2dnbGUsIHBhcnNlRmxvYXREZWZhdWx0LCBzZXR1cENvcHlCdG4gfSBmcm9tICcuL2RvYydcbmltcG9ydCBCYXNlUGFnZSBmcm9tICcuL2Jhc2VwYWdlJ1xuaW1wb3J0IHsgcG9zdEpTT04sIEVycm9ycyB9IGZyb20gJy4vaHR0cCdcbmltcG9ydCB7XG4gIE5ld1dhbGxldEZvcm0sXG4gIFdhbGxldENvbmZpZ0Zvcm0sXG4gIERlcG9zaXRBZGRyZXNzLFxuICBiaW5kIGFzIGJpbmRGb3JtLFxuICBzaG93U3VjY2Vzc1xufSBmcm9tICcuL2Zvcm1zJ1xuaW1wb3J0IFN0YXRlIGZyb20gJy4vc3RhdGUnXG5pbXBvcnQgKiBhcyBpbnRsIGZyb20gJy4vbG9jYWxlcydcbmltcG9ydCAqIGFzIE9yZGVyVXRpbCBmcm9tICcuL29yZGVydXRpbCdcbmltcG9ydCB7XG4gIGFwcCxcbiAgUGFnZUVsZW1lbnQsXG4gIFN1cHBvcnRlZEFzc2V0LFxuICBXYWxsZXREZWZpbml0aW9uLFxuICBCYWxhbmNlTm90ZSxcbiAgV2FsbGV0U3RhdGVOb3RlLFxuICBXYWxsZXRTeW5jTm90ZSxcbiAgUmF0ZU5vdGUsXG4gIE9yZGVyLFxuICBPcmRlckZpbHRlcixcbiAgV2FsbGV0Q3JlYXRpb25Ob3RlLFxuICBCYXNlV2FsbGV0Tm90ZSxcbiAgV2FsbGV0Tm90ZSxcbiAgQ3VzdG9tV2FsbGV0Tm90ZSxcbiAgVGlwQ2hhbmdlTm90ZSxcbiAgRXhjaGFuZ2UsXG4gIE1hcmtldCxcbiAgUGVlclNvdXJjZSxcbiAgV2FsbGV0UGVlcixcbiAgQXBwcm92YWxTdGF0dXMsXG4gIFdhbGxldFN0YXRlLFxuICBVbml0SW5mbyxcbiAgVGlja2V0U3Rha2luZ1N0YXR1cyxcbiAgVm90aW5nU2VydmljZVByb3ZpZGVyLFxuICBUaWNrZXQsXG4gIFRpY2tldFN0YXRzLFxuICBUeEhpc3RvcnlSZXN1bHQsXG4gIFRyYW5zYWN0aW9uTm90ZSxcbiAgV2FsbGV0VHJhbnNhY3Rpb24sXG4gIEZlZVN0YXRlXG59IGZyb20gJy4vcmVnaXN0cnknXG5pbXBvcnQgeyBDb2luRXhwbG9yZXJzIH0gZnJvbSAnLi9jb2luZXhwbG9yZXJzJ1xuXG5pbnRlcmZhY2UgRGVjcmVkVGlja2V0VGlwVXBkYXRlIHtcbiAgdGlja2V0UHJpY2U6IG51bWJlclxuICB2b3RpbmdTdWJzaWR5OiBudW1iZXJcbiAgc3RhdHM6IFRpY2tldFN0YXRzXG59XG5cbmludGVyZmFjZSBUaWNrZXRQdXJjaGFzZVVwZGF0ZSBleHRlbmRzIEJhc2VXYWxsZXROb3RlIHtcbiAgZXJyPzogc3RyaW5nXG4gIHJlbWFpbmluZzpudW1iZXJcbiAgdGlja2V0cz86IFRpY2tldFtdXG4gIHN0YXRzPzogVGlja2V0U3RhdHNcbn1cblxuY29uc3QgYW5pbWF0aW9uTGVuZ3RoID0gMzAwXG5jb25zdCB0cmFpdFJlc2Nhbm5lciA9IDFcbmNvbnN0IHRyYWl0TG9nRmlsZXIgPSAxIDw8IDJcbmNvbnN0IHRyYWl0UmVjb3ZlcmVyID0gMSA8PCA1XG5jb25zdCB0cmFpdFdpdGhkcmF3ZXIgPSAxIDw8IDZcbmNvbnN0IHRyYWl0UmVzdG9yZXIgPSAxIDw8IDhcbmNvbnN0IHRyYWl0VHhGZWVFc3RpbWF0b3IgPSAxIDw8IDlcbmNvbnN0IHRyYWl0UGVlck1hbmFnZXIgPSAxIDw8IDEwXG5jb25zdCB0cmFpdFRva2VuQXBwcm92ZXIgPSAxIDw8IDEzXG5jb25zdCB0cmFpdFRpY2tldEJ1eWVyID0gMSA8PCAxNVxuY29uc3QgdHJhaXRIaXN0b3JpYW4gPSAxIDw8IDE2XG5jb25zdCB0cmFpdEZ1bmRzTWl4ZXIgPSAxIDw8IDE3XG5cbmNvbnN0IHRyYWl0c0V4dHJhT3B0cyA9IHRyYWl0TG9nRmlsZXIgfCB0cmFpdFJlY292ZXJlciB8IHRyYWl0UmVzdG9yZXIgfCB0cmFpdFJlc2Nhbm5lciB8IHRyYWl0UGVlck1hbmFnZXIgfCB0cmFpdFRva2VuQXBwcm92ZXJcblxuZXhwb3J0IGNvbnN0IHRpY2tldFN0YXR1c1Vua25vd24gPSAwXG5leHBvcnQgY29uc3QgdGlja2V0U3RhdHVzVW5taW5lZCA9IDFcbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNJbW1hdHVyZSA9IDJcbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNMaXZlID0gM1xuZXhwb3J0IGNvbnN0IHRpY2tldFN0YXR1c1ZvdGVkID0gNFxuZXhwb3J0IGNvbnN0IHRpY2tldFN0YXR1c01pc3NlZCA9IDVcbmV4cG9ydCBjb25zdCB0aWNrZXRTdGF0dXNFeHBpcmVkID0gNlxuZXhwb3J0IGNvbnN0IHRpY2tldFN0YXR1c1Vuc3BlbnQgPSA3XG5leHBvcnQgY29uc3QgdGlja2V0U3RhdHVzUmV2b2tlZCA9IDhcblxuZXhwb3J0IGNvbnN0IHRpY2tldFN0YXR1c1RyYW5zbGF0aW9uS2V5cyA9IFtcbiAgaW50bC5JRF9USUNLRVRfU1RBVFVTX1VOS05PV04sXG4gIGludGwuSURfVElDS0VUX1NUQVRVU19VTk1JTkVELFxuICBpbnRsLklEX1RJQ0tFVF9TVEFUVVNfSU1NQVRVUkUsXG4gIGludGwuSURfVElDS0VUX1NUQVRVU19MSVZFLFxuICBpbnRsLklEX1RJQ0tFVF9TVEFUVVNfVk9URUQsXG4gIGludGwuSURfVElDS0VUX1NUQVRVU19NSVNTRUQsXG4gIGludGwuSURfVElDS0VUX1NUQVRVU19FWFBJUkVELFxuICBpbnRsLklEX1RJQ0tFVF9TVEFUVVNfVU5TUEVOVCxcbiAgaW50bC5JRF9USUNLRVRfU1RBVFVTX1JFVk9LRURcbl1cblxuZXhwb3J0IGNvbnN0IHR4VHlwZVVua25vd24gPSAwXG5leHBvcnQgY29uc3QgdHhUeXBlU2VuZCA9IDFcbmV4cG9ydCBjb25zdCB0eFR5cGVSZWNlaXZlID0gMlxuZXhwb3J0IGNvbnN0IHR4VHlwZVN3YXAgPSAzXG5leHBvcnQgY29uc3QgdHhUeXBlUmVkZWVtID0gNFxuZXhwb3J0IGNvbnN0IHR4VHlwZVJlZnVuZCA9IDVcbmV4cG9ydCBjb25zdCB0eFR5cGVTcGxpdCA9IDZcbmV4cG9ydCBjb25zdCB0eFR5cGVDcmVhdGVCb25kID0gN1xuZXhwb3J0IGNvbnN0IHR4VHlwZVJlZGVlbUJvbmQgPSA4XG5leHBvcnQgY29uc3QgdHhUeXBlQXBwcm92ZVRva2VuID0gOVxuZXhwb3J0IGNvbnN0IHR4VHlwZUFjY2VsZXJhdGlvbiA9IDEwXG5leHBvcnQgY29uc3QgdHhUeXBlU2VsZlNlbmQgPSAxMVxuZXhwb3J0IGNvbnN0IHR4VHlwZVJldm9rZVRva2VuQXBwcm92YWwgPSAxMlxuZXhwb3J0IGNvbnN0IHR4VHlwZVRpY2tldFB1cmNoYXNlID0gMTNcbmV4cG9ydCBjb25zdCB0eFR5cGVUaWNrZXRWb3RlID0gMTRcbmV4cG9ydCBjb25zdCB0eFR5cGVUaWNrZXRSZXZvY2F0aW9uID0gMTVcbmV4cG9ydCBjb25zdCB0eFR5cGVTd2FwT3JTZW5kID0gMTZcbmV4cG9ydCBjb25zdCB0eFR5cGVNaXhpbmcgPSAxN1xuXG5jb25zdCBwb3NpdGl2ZVR4VHlwZXMgOiBudW1iZXJbXSA9IFtcbiAgdHhUeXBlUmVjZWl2ZSxcbiAgdHhUeXBlUmVkZWVtLFxuICB0eFR5cGVSZWZ1bmQsXG4gIHR4VHlwZVJlZGVlbUJvbmQsXG4gIHR4VHlwZVRpY2tldFZvdGUsXG4gIHR4VHlwZVRpY2tldFJldm9jYXRpb25cbl1cblxuY29uc3QgbmVnYXRpdmVUeFR5cGVzIDogbnVtYmVyW10gPSBbXG4gIHR4VHlwZVNlbmQsXG4gIHR4VHlwZVN3YXAsXG4gIHR4VHlwZUNyZWF0ZUJvbmQsXG4gIHR4VHlwZVRpY2tldFB1cmNoYXNlLFxuICB0eFR5cGVTd2FwT3JTZW5kXG5dXG5cbmNvbnN0IG5vQW10VHhUeXBlcyA6IG51bWJlcltdID0gW1xuICB0eFR5cGVTcGxpdCxcbiAgdHhUeXBlQXBwcm92ZVRva2VuLFxuICB0eFR5cGVBY2NlbGVyYXRpb24sXG4gIHR4VHlwZVJldm9rZVRva2VuQXBwcm92YWxcbl1cblxuZnVuY3Rpb24gdHhUeXBlU2lnbkFuZENsYXNzICh0eFR5cGU6IG51bWJlcik6IFtzdHJpbmcsIHN0cmluZ10ge1xuICBpZiAocG9zaXRpdmVUeFR5cGVzLmluY2x1ZGVzKHR4VHlwZSkpIHJldHVybiBbJysnLCAncG9zaXRpdmUtdHgnXVxuICBpZiAobmVnYXRpdmVUeFR5cGVzLmluY2x1ZGVzKHR4VHlwZSkpIHJldHVybiBbJy0nLCAnbmVnYXRpdmUtdHgnXVxuICByZXR1cm4gWycnLCAnJ11cbn1cblxuY29uc3QgdHhUeXBlVHJhbnNsYXRpb25LZXlzID0gW1xuICBpbnRsLklEX1RYX1RZUEVfVU5LTk9XTixcbiAgaW50bC5JRF9UWF9UWVBFX1NFTkQsXG4gIGludGwuSURfVFhfVFlQRV9SRUNFSVZFLFxuICBpbnRsLklEX1RYX1RZUEVfU1dBUCxcbiAgaW50bC5JRF9UWF9UWVBFX1JFREVFTSxcbiAgaW50bC5JRF9UWF9UWVBFX1JFRlVORCxcbiAgaW50bC5JRF9UWF9UWVBFX1NQTElULFxuICBpbnRsLklEX1RYX1RZUEVfQ1JFQVRFX0JPTkQsXG4gIGludGwuSURfVFhfVFlQRV9SRURFRU1fQk9ORCxcbiAgaW50bC5JRF9UWF9UWVBFX0FQUFJPVkVfVE9LRU4sXG4gIGludGwuSURfVFhfVFlQRV9BQ0NFTEVSQVRJT04sXG4gIGludGwuSURfVFhfVFlQRV9TRUxGX1RSQU5TRkVSLFxuICBpbnRsLklEX1RYX1RZUEVfUkVWT0tFX1RPS0VOX0FQUFJPVkFMLFxuICBpbnRsLklEX1RYX1RZUEVfVElDS0VUX1BVUkNIQVNFLFxuICBpbnRsLklEX1RYX1RZUEVfVElDS0VUX1ZPVEUsXG4gIGludGwuSURfVFhfVFlQRV9USUNLRVRfUkVWT0NBVElPTixcbiAgaW50bC5JRF9UWF9UWVBFX1NXQVBfT1JfU0VORCxcbiAgaW50bC5JRF9UWF9UWVBFX01JWFxuXVxuXG5leHBvcnQgZnVuY3Rpb24gdHhUeXBlU3RyaW5nICh0eFR5cGU6IG51bWJlcikgOiBzdHJpbmcge1xuICByZXR1cm4gaW50bC5wcmVwKHR4VHlwZVRyYW5zbGF0aW9uS2V5c1t0eFR5cGVdKVxufVxuXG5jb25zdCB0aWNrZXRQYWdlU2l6ZSA9IDEwXG5jb25zdCBzY2FuU3RhcnRNZW1wb29sID0gLTFcblxuaW50ZXJmYWNlIFJlY29uZmlnUmVxdWVzdCB7XG4gIGFzc2V0SUQ6IG51bWJlclxuICB3YWxsZXRUeXBlOiBzdHJpbmdcbiAgY29uZmlnOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gIG5ld1dhbGxldFBXPzogc3RyaW5nXG59XG5cbmludGVyZmFjZSBSZXNjYW5SZWNvdmVyeVJlcXVlc3Qge1xuICBhc3NldElEOiBudW1iZXJcbiAgYXBwUFc/OiBzdHJpbmdcbiAgZm9yY2U/OiBib29sZWFuXG59XG5cbmludGVyZmFjZSBXYWxsZXRSZXN0b3JhdGlvbiB7XG4gIHRhcmdldDogc3RyaW5nXG4gIHNlZWQ6IHN0cmluZ1xuICBzZWVkTmFtZTogc3RyaW5nXG4gIGluc3RydWN0aW9uczogc3RyaW5nXG59XG5cbmludGVyZmFjZSBBc3NldEJ1dHRvbiB7XG4gIHRtcGw6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBidHRuOiBQYWdlRWxlbWVudFxufVxuXG5pbnRlcmZhY2UgVGlja2V0UGFnaW5hdGlvbiB7XG4gIG51bWJlcjogbnVtYmVyXG4gIGhpc3Rvcnk6IFRpY2tldFtdXG4gIHNjYW5uZWQ6IGJvb2xlYW4gLy8gUmVhY2hlZCB0aGUgZW5kIG9mIGhpc3RvcnkuIEFsbCB0aWNrZXRzIGNhY2hlZC5cbn1cblxuaW50ZXJmYWNlIFdhbGxldHNQYWdlRGF0YSB7XG4gIGdvQmFjaz86IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgcmVjb25maWdTZXR0aW5ncyB7XG4gIHNraXBBbmltYXRpb24/OiBib29sZWFuXG4gIGVsZXZhdGVQcm92aWRlcnM/OiBib29sZWFuXG59XG5cbmxldCBuZXQgPSAwXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdhbGxldHNQYWdlIGV4dGVuZHMgQmFzZVBhZ2Uge1xuICBib2R5OiBIVE1MRWxlbWVudFxuICBkYXRhPzogV2FsbGV0c1BhZ2VEYXRhXG4gIHBhZ2U6IFJlY29yZDxzdHJpbmcsIFBhZ2VFbGVtZW50PlxuICBhc3NldEJ1dHRvbnM6IFJlY29yZDxudW1iZXIsIEFzc2V0QnV0dG9uPlxuICBuZXdXYWxsZXRGb3JtOiBOZXdXYWxsZXRGb3JtXG4gIHJlY29uZmlnRm9ybTogV2FsbGV0Q29uZmlnRm9ybVxuICB3YWxsZXRDZmdHdWlkZTogUGFnZUVsZW1lbnRcbiAgZGVwb3NpdEFkZHJGb3JtOiBEZXBvc2l0QWRkcmVzc1xuICBrZXl1cDogKGU6IEtleWJvYXJkRXZlbnQpID0+IHZvaWRcbiAgY2hhbmdlV2FsbGV0UFc6IGJvb2xlYW5cbiAgZGlzcGxheWVkOiBIVE1MRWxlbWVudFxuICBhbmltYXRpb246IEFuaW1hdGlvblxuICBmb3JtczogUGFnZUVsZW1lbnRbXVxuICBmb3JjZVJlcTogUmVzY2FuUmVjb3ZlcnlSZXF1ZXN0XG4gIGZvcmNlVXJsOiBzdHJpbmdcbiAgY3VycmVudEZvcm06IFBhZ2VFbGVtZW50XG4gIHJlc3RvcmVJbmZvQ2FyZDogSFRNTEVsZW1lbnRcbiAgc2VsZWN0ZWRBc3NldElEOiBudW1iZXJcbiAgc3Rha2VTdGF0dXM6IFRpY2tldFN0YWtpbmdTdGF0dXNcbiAgbWF4U2VuZDogbnVtYmVyXG4gIHVuYXBwcm92aW5nVG9rZW5WZXJzaW9uOiBudW1iZXJcbiAgdGlja2V0UGFnZTogVGlja2V0UGFnaW5hdGlvblxuICBvbGRlc3RUeDogV2FsbGV0VHJhbnNhY3Rpb24gfCB1bmRlZmluZWRcbiAgY3VyclR4OiBXYWxsZXRUcmFuc2FjdGlvbiB8IHVuZGVmaW5lZFxuICBtaXhpbmc6IGJvb2xlYW5cbiAgbWl4ZXJUb2dnbGU6IEFuaVRvZ2dsZVxuICBzdGFtcGVyczogUGFnZUVsZW1lbnRbXVxuICBzZWNvbmRUaWNrZXI6IG51bWJlclxuXG4gIGNvbnN0cnVjdG9yIChib2R5OiBIVE1MRWxlbWVudCwgZGF0YT86IFdhbGxldHNQYWdlRGF0YSkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLmJvZHkgPSBib2R5XG4gICAgdGhpcy5kYXRhID0gZGF0YVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2UgPSBEb2MuaWREZXNjZW5kYW50cyhib2R5KVxuICAgIHRoaXMuc3RhbXBlcnMgPSBbXVxuICAgIG5ldCA9IGFwcCgpLnVzZXIubmV0XG5cbiAgICBjb25zdCBzZXRTdGFtcCA9ICgpID0+IHtcbiAgICAgIGZvciAoY29uc3Qgc3BhbiBvZiB0aGlzLnN0YW1wZXJzKSB7XG4gICAgICAgIGlmIChzcGFuLmRhdGFzZXQuc3RhbXApIHtcbiAgICAgICAgICBzcGFuLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShwYXJzZUludChzcGFuLmRhdGFzZXQuc3RhbXAgfHwgJycpICogMTAwMClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnNlY29uZFRpY2tlciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBzZXRTdGFtcCgpXG4gICAgfSwgMTAwMDApIC8vIHVwZGF0ZSBldmVyeSAxMCBzZWNvbmRzXG5cbiAgICBEb2MuY2xlYW5UZW1wbGF0ZXMocGFnZS5yZXN0b3JlSW5mb0NhcmQsIHBhZ2UuY29ubmVjdGVkSWNvblRtcGwsIHBhZ2UuZGlzY29ubmVjdGVkSWNvblRtcGwsIHBhZ2UucmVtb3ZlSWNvblRtcGwpXG4gICAgdGhpcy5yZXN0b3JlSW5mb0NhcmQgPSBwYWdlLnJlc3RvcmVJbmZvQ2FyZC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICBEb2Muc2hvdyhwYWdlLmNvbm5lY3RlZEljb25UbXBsLCBwYWdlLmRpc2Nvbm5lY3RlZEljb25UbXBsLCBwYWdlLnJlbW92ZUljb25UbXBsKVxuXG4gICAgdGhpcy5mb3JtcyA9IERvYy5hcHBseVNlbGVjdG9yKHBhZ2UuZm9ybXMsICc6c2NvcGUgPiBmb3JtJylcbiAgICBwYWdlLmZvcm1zLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtLWNsb3NlcicpLmZvckVhY2goZWwgPT4ge1xuICAgICAgRG9jLmJpbmQoZWwsICdjbGljaycsICgpID0+IHsgdGhpcy5jbG9zZVBvcHVwcygpIH0pXG4gICAgfSlcbiAgICBEb2MuYmluZChwYWdlLmNhbmNlbEZvcmNlLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMuY2xvc2VQb3B1cHMoKSB9KVxuXG4gICAgdGhpcy5zZWxlY3RlZEFzc2V0SUQgPSAtMVxuICAgIERvYy5jbGVhblRlbXBsYXRlcyhcbiAgICAgIHBhZ2UuaWNvblNlbGVjdFRtcGwsIHBhZ2UuYmFsYW5jZURldGFpbFJvdywgcGFnZS5yZWNlbnRPcmRlclRtcGwsIHBhZ2UudnNwUm93VG1wbCxcbiAgICAgIHBhZ2UudGlja2V0SGlzdG9yeVJvd1RtcGwsIHBhZ2Uudm90aW5nQ2hvaWNlVG1wbCwgcGFnZS52b3RpbmdBZ2VuZGFUbXBsLCBwYWdlLnRzcGVuZFRtcGwsXG4gICAgICBwYWdlLnRrZXlUbXBsLCBwYWdlLnR4SGlzdG9yeVJvd1RtcGwsIHBhZ2UudHhIaXN0b3J5RGF0ZVJvd1RtcGxcbiAgICApXG5cbiAgICBEb2MuYmluZChwYWdlLmNyZWF0ZVdhbGxldCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93TmV3V2FsbGV0KHRoaXMuc2VsZWN0ZWRBc3NldElEKSlcbiAgICBEb2MuYmluZChwYWdlLmNvbm5lY3RCdHRuLCAnY2xpY2snLCAoKSA9PiB0aGlzLmRvQ29ubmVjdCh0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgRG9jLmJpbmQocGFnZS5zZW5kLCAnY2xpY2snLCAoKSA9PiB0aGlzLnNob3dTZW5kRm9ybSh0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgRG9jLmJpbmQocGFnZS5yZWNlaXZlLCAnY2xpY2snLCAoKSA9PiB0aGlzLnNob3dEZXBvc2l0KHRoaXMuc2VsZWN0ZWRBc3NldElEKSlcbiAgICBEb2MuYmluZChwYWdlLnVubG9ja0J0dG4sICdjbGljaycsICgpID0+IHRoaXMub3BlbldhbGxldCh0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgRG9jLmJpbmQocGFnZS5sb2NrQnR0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5sb2NrKHRoaXMuc2VsZWN0ZWRBc3NldElEKSlcbiAgICBEb2MuYmluZChwYWdlLnJlY29uZmlndXJlQnR0biwgJ2NsaWNrJywgKCkgPT4gdGhpcy5zaG93UmVjb25maWcodGhpcy5zZWxlY3RlZEFzc2V0SUQpKVxuICAgIERvYy5iaW5kKHBhZ2UubmVlZHNQcm92aWRlckJ0dG4sICdjbGljaycsICgpID0+IHRoaXMuc2hvd1JlY29uZmlnKHRoaXMuc2VsZWN0ZWRBc3NldElEKSlcbiAgICBEb2MuYmluZChwYWdlLnJlc2NhbldhbGxldCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5yZXNjYW5XYWxsZXQodGhpcy5zZWxlY3RlZEFzc2V0SUQpKVxuICAgIERvYy5iaW5kKHBhZ2UuZWFybGllclR4cywgJ2NsaWNrJywgKCkgPT4gdGhpcy5sb2FkRWFybGllclR4cygpKVxuXG4gICAgRG9jLmJpbmQocGFnZS5jb3B5VHhJREJ0biwgJ2NsaWNrJywgKCkgPT4geyBzZXR1cENvcHlCdG4odGhpcy5jdXJyVHg/LmlkIHx8ICcnLCBwYWdlLnR4RGV0YWlsc0lELCBwYWdlLmNvcHlUeElEQnRuLCAnIzFlN2QxMScpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5jb3B5UmVjaXBpZW50QnRuLCAnY2xpY2snLCAoKSA9PiB7IHNldHVwQ29weUJ0bih0aGlzLmN1cnJUeD8ucmVjaXBpZW50IHx8ICcnLCBwYWdlLnR4RGV0YWlsc1JlY2lwaWVudCwgcGFnZS5jb3B5UmVjaXBpZW50QnRuLCAnIzFlN2QxMScpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5jb3B5Qm9uZElEQnRuLCAnY2xpY2snLCAoKSA9PiB7IHNldHVwQ29weUJ0bih0aGlzLmN1cnJUeD8uYm9uZEluZm8/LmJvbmRJRCB8fCAnJywgcGFnZS50eERldGFpbHNCb25kSUQsIHBhZ2UuY29weUJvbmRJREJ0biwgJyMxZTdkMTEnKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UuY29weUJvbmRBY2NvdW50SURCdG4sICdjbGljaycsICgpID0+IHsgc2V0dXBDb3B5QnRuKHRoaXMuY3VyclR4Py5ib25kSW5mbz8uYWNjb3VudElEIHx8ICcnLCBwYWdlLnR4RGV0YWlsc0JvbmRBY2NvdW50SUQsIHBhZ2UuY29weUJvbmRBY2NvdW50SURCdG4sICcjMWU3ZDExJykgfSlcbiAgICBEb2MuYmluZChwYWdlLmhpZGVNaXhUeHNDaGVja2JveCwgJ2NoYW5nZScsICgpID0+IHsgdGhpcy5zaG93VHhIaXN0b3J5KHRoaXMuc2VsZWN0ZWRBc3NldElEKSB9KVxuXG4gICAgLy8gQmluZCB0aGUgbmV3IHdhbGxldCBmb3JtLlxuICAgIHRoaXMubmV3V2FsbGV0Rm9ybSA9IG5ldyBOZXdXYWxsZXRGb3JtKHBhZ2UubmV3V2FsbGV0Rm9ybSwgKGFzc2V0SUQ6IG51bWJlcikgPT4ge1xuICAgICAgY29uc3QgZm10UGFyYW1zID0geyBhc3NldE5hbWU6IGFwcCgpLmFzc2V0c1thc3NldElEXS5uYW1lIH1cbiAgICAgIHRoaXMuYXNzZXRVcGRhdGVkKGFzc2V0SUQsIHBhZ2UubmV3V2FsbGV0Rm9ybSwgaW50bC5wcmVwKGludGwuSURfTkVXX1dBTExFVF9TVUNDRVNTLCBmbXRQYXJhbXMpKVxuICAgICAgdGhpcy5zb3J0QXNzZXRCdXR0b25zKClcbiAgICAgIHRoaXMudXBkYXRlVGlja2V0QnV5ZXIoYXNzZXRJRClcbiAgICAgIHRoaXMudXBkYXRlUHJpdmFjeShhc3NldElEKVxuICAgIH0pXG5cbiAgICAvLyBCaW5kIHRoZSB3YWxsZXQgcmVjb25maWcgZm9ybS5cbiAgICB0aGlzLnJlY29uZmlnRm9ybSA9IG5ldyBXYWxsZXRDb25maWdGb3JtKHBhZ2UucmVjb25maWdJbnB1dHMsIGZhbHNlKVxuXG4gICAgdGhpcy53YWxsZXRDZmdHdWlkZSA9IERvYy50bXBsRWxlbWVudChwYWdlLnJlY29uZmlnRm9ybSwgJ3dhbGxldENmZ0d1aWRlJylcblxuICAgIC8vIEJpbmQgdGhlIHNlbmQgZm9ybS5cbiAgICBiaW5kRm9ybShwYWdlLnNlbmRGb3JtLCBwYWdlLnN1Ym1pdFNlbmRGb3JtLCBhc3luYyAoKSA9PiB7IHRoaXMuc3RlcFNlbmQoKSB9KVxuICAgIC8vIFNlbmQgY29uZmlybWF0aW9uIGZvcm0uXG4gICAgYmluZEZvcm0ocGFnZS52U2VuZEZvcm0sIHBhZ2UudlNlbmQsIGFzeW5jICgpID0+IHsgdGhpcy5zZW5kKCkgfSlcbiAgICAvLyBCaW5kIHRoZSB3YWxsZXQgcmVjb25maWd1cmF0aW9uIHN1Ym1pc3Npb24uXG4gICAgYmluZEZvcm0ocGFnZS5yZWNvbmZpZ0Zvcm0sIHBhZ2Uuc3VibWl0UmVjb25maWcsICgpID0+IHRoaXMucmVjb25maWcoKSlcblxuICAgIHBhZ2UuZm9ybXMucXVlcnlTZWxlY3RvckFsbCgnLmZvcm0tY2xvc2VyJykuZm9yRWFjaChlbCA9PiB7XG4gICAgICBEb2MuYmluZChlbCwgJ2NsaWNrJywgKCkgPT4gdGhpcy5jbG9zZVBvcHVwcygpKVxuICAgIH0pXG5cbiAgICBEb2MuYmluZChwYWdlLmZvcm1zLCAnbW91c2Vkb3duJywgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgIGlmICghRG9jLm1vdXNlSW5FbGVtZW50KGUsIHRoaXMuY3VycmVudEZvcm0pKSB7IHRoaXMuY2xvc2VQb3B1cHMoKSB9XG4gICAgfSlcblxuICAgIHRoaXMubWl4ZXJUb2dnbGUgPSBuZXcgQW5pVG9nZ2xlKHBhZ2UudG9nZ2xlTWl4ZXIsIHBhZ2UubWl4aW5nRXJyLCBmYWxzZSwgKG5ld1N0YXRlOiBib29sZWFuKSA9PiB7IHJldHVybiB0aGlzLnVwZGF0ZU1peGVyU3RhdGUobmV3U3RhdGUpIH0pXG5cbiAgICB0aGlzLmtleXVwID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgaWYgKERvYy5pc0Rpc3BsYXllZCh0aGlzLnBhZ2UuZm9ybXMpKSB0aGlzLmNsb3NlUG9wdXBzKClcbiAgICAgIH1cbiAgICB9XG4gICAgRG9jLmJpbmQoZG9jdW1lbnQsICdrZXl1cCcsIHRoaXMua2V5dXApXG5cbiAgICBEb2MuYmluZChwYWdlLmRvd25sb2FkTG9ncywgJ2NsaWNrJywgYXN5bmMgKCkgPT4geyB0aGlzLmRvd25sb2FkTG9ncygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5leHBvcnRXYWxsZXQsICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5kaXNwbGF5RXhwb3J0V2FsbGV0QXV0aCgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5yZWNvdmVyV2FsbGV0LCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc2hvd1JlY292ZXJXYWxsZXQoKSB9KVxuICAgIGJpbmRGb3JtKHBhZ2UuZXhwb3J0V2FsbGV0QXV0aCwgcGFnZS5leHBvcnRXYWxsZXRBdXRoU3VibWl0LCBhc3luYyAoKSA9PiB7IHRoaXMuZXhwb3J0V2FsbGV0QXV0aFN1Ym1pdCgpIH0pXG4gICAgYmluZEZvcm0ocGFnZS5yZWNvdmVyV2FsbGV0Q29uZmlybSwgcGFnZS5yZWNvdmVyV2FsbGV0U3VibWl0LCAoKSA9PiB7IHRoaXMucmVjb3ZlcldhbGxldCgpIH0pXG4gICAgYmluZEZvcm0ocGFnZS5jb25maXJtRm9yY2UsIHBhZ2UuY29uZmlybUZvcmNlU3VibWl0LCBhc3luYyAoKSA9PiB7IHRoaXMuY29uZmlybUZvcmNlU3VibWl0KCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmRpc2FibGVXYWxsZXQsICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5zaG93VG9nZ2xlV2FsbGV0U3RhdHVzKHRydWUpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5lbmFibGVXYWxsZXQsICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5zaG93VG9nZ2xlV2FsbGV0U3RhdHVzKGZhbHNlKSB9KVxuICAgIGJpbmRGb3JtKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzQ29uZmlybSwgcGFnZS50b2dnbGVXYWxsZXRTdGF0dXNTdWJtaXQsIGFzeW5jICgpID0+IHsgdGhpcy50b2dnbGVXYWxsZXRTdGF0dXMoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UubWFuYWdlUGVlcnMsICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5zaG93TWFuYWdlUGVlcnNGb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLmFkZFBlZXJTdWJtaXQsICdjbGljaycsIGFzeW5jICgpID0+IHsgdGhpcy5zdWJtaXRBZGRQZWVyKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnVuYXBwcm92ZVRva2VuQWxsb3dhbmNlLCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc2hvd1VuYXBwcm92ZVRva2VuQWxsb3dhbmNlVGFibGVGb3JtKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnVuYXBwcm92ZVRva2VuU3VibWl0LCAnY2xpY2snLCBhc3luYyAoKSA9PiB7IHRoaXMuc3VibWl0VW5hcHByb3ZlVG9rZW5BbGxvd2FuY2UoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc2hvd1ZTUHMsICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93VlNQUGlja2VyKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnZzcERpc3BsYXksICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93VlNQUGlja2VyKCkgfSlcbiAgICBiaW5kRm9ybShwYWdlLnZzcFBpY2tlciwgcGFnZS5jdXN0b21Wc3BTdWJtaXQsIGFzeW5jICgpID0+IHsgdGhpcy5zZXRDdXN0b21WU1AoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UucHVyY2hhc2VUaWNrZXRzQnR0biwgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dQdXJjaGFzZVRpY2tldHNEaWFsb2coKSB9KVxuICAgIGJpbmRGb3JtKHBhZ2UucHVyY2hhc2VUaWNrZXRzRm9ybSwgcGFnZS5wdXJjaGFzZXJTdWJtaXQsICgpID0+IHsgdGhpcy5wdXJjaGFzZVRpY2tldHMoKSB9KVxuICAgIERvYy5iaW5kKHBhZ2UucHVyY2hhc2VySW5wdXQsICdjaGFuZ2UnLCAoKSA9PiB7IHRoaXMucHVyY2hhc2VySW5wdXRDaGFuZ2VkKCkgfSlcbiAgICBEb2MuYmluZChwYWdlLnRpY2tldEhpc3RvcnksICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93VGlja2V0SGlzdG9yeSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS50aWNrZXRIaXN0b3J5TmV4dFBhZ2UsICdjbGljaycsICgpID0+IHsgdGhpcy5uZXh0VGlja2V0UGFnZSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS50aWNrZXRIaXN0b3J5UHJldlBhZ2UsICdjbGljaycsICgpID0+IHsgdGhpcy5wcmV2VGlja2V0UGFnZSgpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5zZXRWb3RlcywgJ2NsaWNrJywgKCkgPT4geyB0aGlzLnNob3dTZXRWb3Rlc0RpYWxvZygpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5wdXJjaGFzZVRpY2tldHNFcnJDbG9zZXIsICdjbGljaycsICgpID0+IHsgRG9jLmhpZGUocGFnZS5wdXJjaGFzZVRpY2tldHNFcnJCb3gpIH0pXG4gICAgRG9jLmJpbmQocGFnZS5wcml2YWN5SW5mb0J0dG4sICdjbGljaycsICgpID0+IHsgdGhpcy5zaG93Rm9ybShwYWdlLm1peGluZ0luZm8pIH0pXG5cbiAgICAvLyBOZXcgZGVwb3NpdCBhZGRyZXNzIGJ1dHRvbi5cbiAgICB0aGlzLmRlcG9zaXRBZGRyRm9ybSA9IG5ldyBEZXBvc2l0QWRkcmVzcyhwYWdlLmRlcG9zaXQpXG5cbiAgICAvLyBDbGlja2luZyBvbiB0aGUgYXZhaWxhYmxlIGFtb3VudCBvbiB0aGUgU2VuZCBmb3JtIHBvcHVsYXRlcyB0aGVcbiAgICAvLyBhbW91bnQgZmllbGQuXG4gICAgRG9jLmJpbmQocGFnZS53YWxsZXRCYWwsICdjbGljaycsICgpID0+IHsgdGhpcy5wb3B1bGF0ZU1heFNlbmQoKSB9KVxuXG4gICAgLy8gRGlzcGxheSBmaWF0IHZhbHVlIGZvciBjdXJyZW50IHNlbmQgYW1vdW50LlxuICAgIERvYy5iaW5kKHBhZ2Uuc2VuZEFtdCwgJ2lucHV0JywgKCkgPT4ge1xuICAgICAgY29uc3QgeyB1bml0SW5mbzogdWkgfSA9IGFwcCgpLmFzc2V0c1t0aGlzLnNlbGVjdGVkQXNzZXRJRF1cbiAgICAgIGNvbnN0IGFtdCA9IHBhcnNlRmxvYXREZWZhdWx0KHBhZ2Uuc2VuZEFtdC52YWx1ZSlcbiAgICAgIGNvbnN0IGNvbnZlcnNpb25GYWN0b3IgPSB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvclxuICAgICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5zZW5kVmFsdWUsIGFtdCAqIGNvbnZlcnNpb25GYWN0b3IsIGFwcCgpLmZpYXRSYXRlc01hcFt0aGlzLnNlbGVjdGVkQXNzZXRJRF0sIHVpKVxuICAgIH0pXG5cbiAgICAvLyBDbGlja2luZyBvbiBtYXhTZW5kIG9uIHRoZSBzZW5kIGZvcm0gc2hvdWxkIHBvcHVsYXRlIHRoZSBhbW91bnQgZmllbGQuXG4gICAgRG9jLmJpbmQocGFnZS5tYXhTZW5kLCAnY2xpY2snLCAoKSA9PiB7IHRoaXMucG9wdWxhdGVNYXhTZW5kKCkgfSlcblxuICAgIC8vIFZhbGlkYXRlIHNlbmQgYWRkcmVzcyBvbiBpbnB1dC5cbiAgICBEb2MuYmluZChwYWdlLnNlbmRBZGRyLCAnaW5wdXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1t0aGlzLnNlbGVjdGVkQXNzZXRJRF1cbiAgICAgIERvYy5oaWRlKHBhZ2UudmFsaWRBZGRyKVxuICAgICAgcGFnZS5zZW5kQWRkci5jbGFzc0xpc3QucmVtb3ZlKCdpcy1pbnZhbGlkJylcbiAgICAgIGNvbnN0IGFkZHIgPSBwYWdlLnNlbmRBZGRyLnZhbHVlIHx8ICcnXG4gICAgICBpZiAoIWFzc2V0IHx8IGFkZHIgPT09ICcnKSByZXR1cm5cbiAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgdGhpcy52YWxpZGF0ZVNlbmRBZGRyZXNzKGFkZHIsIGFzc2V0LmlkKVxuICAgICAgaWYgKHZhbGlkKSBEb2Muc2hvdyhwYWdlLnZhbGlkQWRkcilcbiAgICAgIGVsc2UgcGFnZS5zZW5kQWRkci5jbGFzc0xpc3QuYWRkKCdpcy1pbnZhbGlkJylcbiAgICB9KVxuXG4gICAgLy8gQSBsaW5rIG9uIHRoZSB3YWxsZXQgcmVjb25maWd1cmF0aW9uIGZvcm0gdG8gc2hvdy9oaWRlIHRoZSBwYXNzd29yZCBmaWVsZC5cbiAgICBEb2MuYmluZChwYWdlLnNob3dDaGFuZ2VQVywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5jaGFuZ2VXYWxsZXRQVyA9ICF0aGlzLmNoYW5nZVdhbGxldFBXXG4gICAgICB0aGlzLnNldFBXU2V0dGluZ1Zpeih0aGlzLmNoYW5nZVdhbGxldFBXKVxuICAgIH0pXG5cbiAgICAvLyBDaGFuZ2luZyB0aGUgdHlwZSBvZiB3YWxsZXQuXG4gICAgRG9jLmJpbmQocGFnZS5jaGFuZ2VXYWxsZXRUeXBlU2VsZWN0LCAnY2hhbmdlJywgKCkgPT4ge1xuICAgICAgdGhpcy5jaGFuZ2VXYWxsZXRUeXBlKClcbiAgICB9KVxuICAgIERvYy5iaW5kKHBhZ2Uuc2hvd0NoYW5nZVR5cGUsICdjbGljaycsICgpID0+IHtcbiAgICAgIGlmIChEb2MuaXNIaWRkZW4ocGFnZS5jaGFuZ2VXYWxsZXRUeXBlKSkge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLmNoYW5nZVdhbGxldFR5cGUsIHBhZ2UuY2hhbmdlVHlwZUhpZGVJY29uKVxuICAgICAgICBEb2MuaGlkZShwYWdlLmNoYW5nZVR5cGVTaG93SWNvbilcbiAgICAgICAgcGFnZS5jaGFuZ2VUeXBlTXNnLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfS0VFUF9XQUxMRVRfVFlQRSlcbiAgICAgIH0gZWxzZSB0aGlzLnNob3dSZWNvbmZpZyh0aGlzLnNlbGVjdGVkQXNzZXRJRCwgeyBza2lwQW5pbWF0aW9uOiB0cnVlIH0pXG4gICAgfSlcblxuICAgIGFwcCgpLnJlZ2lzdGVyTm90ZUZlZWRlcih7XG4gICAgICBmaWF0cmF0ZXVwZGF0ZTogKG5vdGU6IFJhdGVOb3RlKSA9PiB7IHRoaXMuaGFuZGxlUmF0ZXNOb3RlKG5vdGUpIH0sXG4gICAgICBiYWxhbmNlOiAobm90ZTogQmFsYW5jZU5vdGUpID0+IHsgdGhpcy5oYW5kbGVCYWxhbmNlTm90ZShub3RlKSB9LFxuICAgICAgd2FsbGV0c3RhdGU6IChub3RlOiBXYWxsZXRTdGF0ZU5vdGUpID0+IHsgdGhpcy5oYW5kbGVXYWxsZXRTdGF0ZU5vdGUobm90ZSkgfSxcbiAgICAgIHdhbGxldGNvbmZpZzogKG5vdGU6IFdhbGxldFN0YXRlTm90ZSkgPT4geyB0aGlzLmhhbmRsZVdhbGxldFN0YXRlTm90ZShub3RlKSB9LFxuICAgICAgd2FsbGV0c3luYzogKG5vdGU6IFdhbGxldFN5bmNOb3RlKSA9PiB7IHRoaXMudXBkYXRlU3luY0FuZFBlZXJzKG5vdGUuYXNzZXRJRCkgfSxcbiAgICAgIGNyZWF0ZXdhbGxldDogKG5vdGU6IFdhbGxldENyZWF0aW9uTm90ZSkgPT4geyB0aGlzLmhhbmRsZUNyZWF0ZVdhbGxldE5vdGUobm90ZSkgfSxcbiAgICAgIHdhbGxldG5vdGU6IChub3RlOiBXYWxsZXROb3RlKSA9PiB7IHRoaXMuaGFuZGxlQ3VzdG9tV2FsbGV0Tm90ZShub3RlKSB9XG4gICAgfSlcblxuICAgIGNvbnN0IGZpcnN0QXNzZXQgPSB0aGlzLnNvcnRBc3NldEJ1dHRvbnMoKVxuICAgIGxldCBzZWxlY3RlZEFzc2V0ID0gZmlyc3RBc3NldC5pZFxuICAgIGNvbnN0IGFzc2V0SURTdHIgPSBTdGF0ZS5mZXRjaExvY2FsKFN0YXRlLnNlbGVjdGVkQXNzZXRMSylcbiAgICBpZiAoYXNzZXRJRFN0cikgc2VsZWN0ZWRBc3NldCA9IE51bWJlcihhc3NldElEU3RyKVxuICAgIHRoaXMuc2V0U2VsZWN0ZWRBc3NldChzZWxlY3RlZEFzc2V0KVxuXG4gICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgZm9yIChjb25zdCByb3cgb2YgdGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5jaGlsZHJlbikge1xuICAgICAgICBjb25zdCBhZ2UgPSBEb2MudG1wbEVsZW1lbnQocm93IGFzIFBhZ2VFbGVtZW50LCAnYWdlJylcbiAgICAgICAgYWdlLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShwYXJzZUludChhZ2UuZGF0YXNldC50aW1lc3RhbXAgYXMgc3RyaW5nKSlcbiAgICAgIH1cbiAgICB9LCA1MDAwKVxuICB9XG5cbiAgY2xvc2VQb3B1cHMgKCkge1xuICAgIERvYy5oaWRlKHRoaXMucGFnZS5mb3JtcylcbiAgICB0aGlzLmN1cnJUeCA9IHVuZGVmaW5lZFxuICAgIGlmICh0aGlzLmFuaW1hdGlvbikgdGhpcy5hbmltYXRpb24uc3RvcCgpXG4gIH1cblxuICBhc3luYyBzYWZlUG9zdCAocGF0aDogc3RyaW5nLCBhcmdzOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IGFzc2V0SUQgPSB0aGlzLnNlbGVjdGVkQXNzZXRJRFxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHBhdGgsIGFyZ3MpXG4gICAgaWYgKGFzc2V0SUQgIT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSB0aHJvdyBFcnJvcignYXNzZXQgY2hhbmdlZCBkdXJpbmcgcmVxdWVzdC4gYWJvcnRpbmcnKVxuICAgIHJldHVybiByZXNcbiAgfVxuXG4gIC8vIHN0ZXBTZW5kIG1ha2VzIGEgcmVxdWVzdCB0byBnZXQgYW4gZXN0aW1hdGVkIGZlZSBhbmQgZGlzcGxheXMgdGhlIGNvbmZpcm1cbiAgLy8gc2VuZCBmb3JtLlxuICBhc3luYyBzdGVwU2VuZCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UudlNlbmRFcnIsIHBhZ2Uuc2VuZEVyciwgcGFnZS52U2VuZEVzdGltYXRlcywgcGFnZS50eEZlZU5vdEF2YWlsYWJsZSlcbiAgICBjb25zdCBhc3NldElEID0gcGFyc2VJbnQocGFnZS5zZW5kRm9ybS5kYXRhc2V0LmFzc2V0SUQgfHwgJycpXG4gICAgY29uc3QgdG9rZW4gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF0udG9rZW5cbiAgICBjb25zdCBzdWJ0cmFjdCA9IHBhZ2Uuc3VidHJhY3RDaGVja0JveC5jaGVja2VkIHx8IGZhbHNlXG4gICAgY29uc3QgY29udmVyc2lvbkZhY3RvciA9IGFwcCgpLnVuaXRJbmZvKGFzc2V0SUQpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgY29uc3QgdmFsdWUgPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXREZWZhdWx0KHBhZ2Uuc2VuZEFtdC52YWx1ZSwgMCkgKiBjb252ZXJzaW9uRmFjdG9yKVxuICAgIGNvbnN0IGFkZHIgPSBwYWdlLnNlbmRBZGRyLnZhbHVlIHx8ICcnXG4gICAgaWYgKGFkZHIgPT09ICcnKSByZXR1cm4gRG9jLnNob3dGb3JtRXJyb3IocGFnZS5zZW5kRXJyLCBpbnRsLnByZXAoaW50bC5JRF9JTlZBTElEX0FERFJFU1NfTVNHLCB7IGFkZHJlc3M6IGFkZHIgfSkpXG4gICAgY29uc3QgeyB3YWxsZXQsIHVuaXRJbmZvOiB1aSwgc3ltYm9sIH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cblxuICAgIC8vIHR4ZmVlIHdpbGwgbm90IGJlIGF2YWlsYWJsZSBpZiB3YWxsZXQgaXMgbm90IGEgZmVlIGVzdGltYXRvciBvciB0aGVcbiAgICAvLyByZXF1ZXN0IGZhaWxlZC5cbiAgICBsZXQgdHhmZWUgPSAwXG4gICAgaWYgKCh3YWxsZXQudHJhaXRzICYgdHJhaXRUeEZlZUVzdGltYXRvcikgIT09IDApIHtcbiAgICAgIGNvbnN0IG9wZW4gPSB7XG4gICAgICAgIGFkZHI6IHBhZ2Uuc2VuZEFkZHIudmFsdWUsXG4gICAgICAgIGFzc2V0SUQ6IGFzc2V0SUQsXG4gICAgICAgIHN1YnRyYWN0OiBzdWJ0cmFjdCxcbiAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5zZW5kRm9ybSlcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3R4ZmVlJywgb3BlbilcbiAgICAgIGxvYWRlZCgpXG4gICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgICBwYWdlLnR4RmVlTm90QXZhaWxhYmxlLmRhdGFzZXQudG9vbHRpcCA9IGludGwucHJlcChpbnRsLklEX1RYRkVFX0VSUl9NU0csIHsgZXJyOiByZXMubXNnIH0pXG4gICAgICAgIERvYy5zaG93KHBhZ2UudHhGZWVOb3RBdmFpbGFibGUpXG4gICAgICAgIC8vIFdlIHN0aWxsIHdhbnQgdG8gZW5zdXJlIHVzZXIgYWRkcmVzcyBpcyB2YWxpZCBiZWZvcmUgcHJvY2VlZGluZyB0byBzZW5kXG4gICAgICAgIC8vIGNvbmZpcm0gZm9ybSBpZiB0aGVyZSdzIGFuIGVycm9yIHdoaWxlIGNhbGN1bGF0aW5nIHRoZSB0cmFuc2FjdGlvbiBmZWUuXG4gICAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgdGhpcy52YWxpZGF0ZVNlbmRBZGRyZXNzKGFkZHIsIGFzc2V0SUQpXG4gICAgICAgIGlmICghdmFsaWQpIHJldHVybiBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLnNlbmRFcnIsIGludGwucHJlcChpbnRsLklEX0lOVkFMSURfQUREUkVTU19NU0csIHsgYWRkcmVzczogYWRkciB8fCAnJyB9KSlcbiAgICAgIH0gZWxzZSBpZiAocmVzLm9rKSB7XG4gICAgICAgIGlmICghcmVzLnZhbGlkYWRkcmVzcykgcmV0dXJuIERvYy5zaG93Rm9ybUVycm9yKHBhZ2Uuc2VuZEVyciwgaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9BRERSRVNTX01TRywgeyBhZGRyZXNzOiBwYWdlLnNlbmRBZGRyLnZhbHVlIHx8ICcnIH0pKVxuICAgICAgICB0eGZlZSA9IHJlcy50eGZlZVxuICAgICAgICBEb2Muc2hvdyhwYWdlLnZTZW5kRXN0aW1hdGVzKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBWYWxpZGF0ZSBvbmx5IHRoZSBzZW5kIGFkZHJlc3MgZm9yIGFzc2V0cyB0aGF0IGFyZSBub3QgZmVlIGVzdGltYXRvcnMuXG4gICAgICBjb25zdCB2YWxpZCA9IGF3YWl0IHRoaXMudmFsaWRhdGVTZW5kQWRkcmVzcyhhZGRyLCBhc3NldElEKVxuICAgICAgaWYgKCF2YWxpZCkgcmV0dXJuIERvYy5zaG93Rm9ybUVycm9yKHBhZ2Uuc2VuZEVyciwgaW50bC5wcmVwKGludGwuSURfSU5WQUxJRF9BRERSRVNTX01TRywgeyBhZGRyZXNzOiBhZGRyIHx8ICcnIH0pKVxuICAgIH1cblxuICAgIHBhZ2UudlNlbmRTeW1ib2wudGV4dENvbnRlbnQgPSBzeW1ib2wudG9VcHBlckNhc2UoKVxuICAgIHBhZ2UudlNlbmRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChzeW1ib2wpXG5cbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIGNvbnN0IHsgdW5pdEluZm86IGZlZVVJLCBzeW1ib2w6IGZlZVN5bWJvbCB9ID0gYXBwKCkuYXNzZXRzW3Rva2VuLnBhcmVudElEXVxuICAgICAgcGFnZS52U2VuZEZlZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHR4ZmVlLCBmZWVVSSkgKyAnICcgKyBmZWVTeW1ib2xcbiAgICB9IGVsc2Uge1xuICAgICAgcGFnZS52U2VuZEZlZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHR4ZmVlLCB1aSlcbiAgICB9XG4gICAgY29uc3QgeGNSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Fzc2V0SURdXG4gICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS52U2VuZEZlZUZpYXQsIHR4ZmVlLCB4Y1JhdGUsIHVpKVxuICAgIHBhZ2UudlNlbmREZXN0aW5hdGlvbkFtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHZhbHVlIC0gdHhmZWUsIHVpKVxuICAgIHBhZ2UudlRvdGFsU2VuZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHZhbHVlLCB1aSlcbiAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLnZUb3RhbFNlbmRGaWF0LCB2YWx1ZSwgeGNSYXRlLCB1aSlcbiAgICBwYWdlLnZTZW5kQWRkci50ZXh0Q29udGVudCA9IHBhZ2Uuc2VuZEFkZHIudmFsdWUgfHwgJydcbiAgICBjb25zdCBiYWwgPSB3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGUgLSB2YWx1ZVxuICAgIHBhZ2UuYmFsYW5jZUFmdGVyU2VuZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKGJhbCwgdWkpXG4gICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5iYWxhbmNlQWZ0ZXJTZW5kRmlhdCwgYmFsLCB4Y1JhdGUsIHVpKVxuICAgIERvYy5zaG93KHBhZ2UuYXBwcm94U2lnbilcbiAgICAvLyBOT1RFOiBBbGwgdG9rZW5zIHRha2UgdGhpcyByb3V0ZSBiZWNhdXNlIHRoZXkgY2Fubm90IHBheSB0aGUgZmVlLlxuICAgIGlmICghc3VidHJhY3QpIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UuYXBwcm94U2lnbilcbiAgICAgIHBhZ2UudlNlbmREZXN0aW5hdGlvbkFtdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHZhbHVlLCB1aSlcbiAgICAgIGxldCB0b3RhbFNlbmQgPSB2YWx1ZVxuICAgICAgaWYgKCF0b2tlbikgdG90YWxTZW5kICs9IHR4ZmVlXG4gICAgICBwYWdlLnZUb3RhbFNlbmQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbih0b3RhbFNlbmQsIHVpKVxuICAgICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS52VG90YWxTZW5kRmlhdCwgdG90YWxTZW5kLCB4Y1JhdGUsIHVpKVxuICAgICAgbGV0IGJhbCA9IHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSAtIHZhbHVlXG4gICAgICBpZiAoIXRva2VuKSBiYWwgLT0gdHhmZWVcbiAgICAgIC8vIGhhbmRsZSBlZGdlIGNhc2VzIHdoZXJlIGJhbCBpcyBub3QgZW5vdWdoIHRvIGNvdmVyIHRvdGFsU2VuZC5cbiAgICAgIC8vIHdlIGRvbid0IHdhbnQgYSBtaW51cyBkaXNwbGF5IG9mIHVzZXIgYmFsLlxuICAgICAgaWYgKGJhbCA8PSAwKSB7XG4gICAgICAgIHBhZ2UuYmFsYW5jZUFmdGVyU2VuZC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKDAsIHVpKVxuICAgICAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLmJhbGFuY2VBZnRlclNlbmRGaWF0LCAwLCB4Y1JhdGUsIHVpKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGFnZS5iYWxhbmNlQWZ0ZXJTZW5kLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24oYmFsLCB1aSlcbiAgICAgICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5iYWxhbmNlQWZ0ZXJTZW5kRmlhdCwgYmFsLCB4Y1JhdGUsIHVpKVxuICAgICAgfVxuICAgIH1cbiAgICBEb2MuaGlkZShwYWdlLnNlbmRGb3JtKVxuICAgIGF3YWl0IHRoaXMuc2hvd0Zvcm0ocGFnZS52U2VuZEZvcm0pXG4gIH1cblxuICAvLyBjYW5jZWxTZW5kIGRpc3BsYXlzIHRoZSBzZW5kIGZvcm0gaWYgdXNlciB3YW50cyB0byBtYWtlIG1vZGlmaWNhdGlvbi5cbiAgYXN5bmMgY2FuY2VsU2VuZCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UudlNlbmRGb3JtLCBwYWdlLnNlbmRFcnIpXG4gICAgYXdhaXQgdGhpcy5zaG93Rm9ybShwYWdlLnNlbmRGb3JtKVxuICB9XG5cbiAgLypcbiAgICogdmFsaWRhdGVTZW5kQWRkcmVzcyB2YWxpZGF0ZXMgdGhlIHByb3ZpZGVkIGFkZHJlc3MgZm9yIGFuIGFzc2V0LlxuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVTZW5kQWRkcmVzcyAoYWRkcjogc3RyaW5nLCBhc3NldElEOiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBjb25zdCByZXNwID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvdmFsaWRhdGVhZGRyZXNzJywgeyBhZGRyOiBhZGRyLCBhc3NldElEOiBhc3NldElEIH0pXG4gICAgcmV0dXJuIGFwcCgpLmNoZWNrUmVzcG9uc2UocmVzcClcbiAgfVxuXG4gIC8qXG4gICAqIHNldFBXU2V0dGluZ1ZpeiBzZXRzIHRoZSB2aXNpYmlsaXR5IG9mIHRoZSBwYXNzd29yZCBmaWVsZCBzZWN0aW9uLlxuICAgKi9cbiAgc2V0UFdTZXR0aW5nVml6ICh2aXNpYmxlOiBib29sZWFuKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGlmICh2aXNpYmxlKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnNob3dJY29uKVxuICAgICAgRG9jLnNob3cocGFnZS5oaWRlSWNvbiwgcGFnZS5jaGFuZ2VQVylcbiAgICAgIHBhZ2Uuc3dpdGNoUFdNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9LRUVQX1dBTExFVF9QQVNTKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5oaWRlKHBhZ2UuaGlkZUljb24sIHBhZ2UuY2hhbmdlUFcpXG4gICAgRG9jLnNob3cocGFnZS5zaG93SWNvbilcbiAgICBwYWdlLnN3aXRjaFBXTXNnLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfTkVXX1dBTExFVF9QQVNTKVxuICB9XG5cbiAgLypcbiAgICogYXNzZXRWZXJzaW9uVXNlZEJ5REVYZXMgcmV0dXJucyBhIG1hcCBvZiB0aGUgdmVyc2lvbnMgb2YgdGhlXG4gICAqIGN1cnJlbnRseSBzZWxlY3RlZCBhc3NldCB0byB0aGUgREVYZXMgdGhhdCB1c2UgdGhhdCB2ZXJzaW9uLlxuICAgKi9cbiAgYXNzZXRWZXJzaW9uVXNlZEJ5REVYZXMgKCk6IFJlY29yZDxudW1iZXIsIHN0cmluZ1tdPiB7XG4gICAgY29uc3QgYXNzZXRJRCA9IHRoaXMuc2VsZWN0ZWRBc3NldElEXG4gICAgY29uc3QgdmVyc2lvblRvREVYZXMgPSB7fSBhcyBSZWNvcmQ8bnVtYmVyLCBzdHJpbmdbXT5cbiAgICBjb25zdCBleGNoYW5nZXMgPSBhcHAoKS5leGNoYW5nZXNcblxuICAgIGZvciAoY29uc3QgaG9zdCBpbiBleGNoYW5nZXMpIHtcbiAgICAgIGNvbnN0IGV4Y2hhbmdlID0gZXhjaGFuZ2VzW2hvc3RdXG4gICAgICBjb25zdCBleGNoYW5nZUFzc2V0ID0gZXhjaGFuZ2UuYXNzZXRzW2Fzc2V0SURdXG4gICAgICBpZiAoIWV4Y2hhbmdlQXNzZXQpIGNvbnRpbnVlXG4gICAgICBpZiAoIXZlcnNpb25Ub0RFWGVzW2V4Y2hhbmdlQXNzZXQudmVyc2lvbl0pIHtcbiAgICAgICAgdmVyc2lvblRvREVYZXNbZXhjaGFuZ2VBc3NldC52ZXJzaW9uXSA9IFtdXG4gICAgICB9XG4gICAgICB2ZXJzaW9uVG9ERVhlc1tleGNoYW5nZUFzc2V0LnZlcnNpb25dLnB1c2goZXhjaGFuZ2UuaG9zdClcbiAgICB9XG5cbiAgICByZXR1cm4gdmVyc2lvblRvREVYZXNcbiAgfVxuXG4gIC8qXG4gICAqIHN1Ym1pdFVuYXBwcm92ZVRva2VuQWxsb3dhbmNlIHN1Ym1pdHMgYSByZXF1ZXN0IHRvIHRoZSBzZXJ2ZXIgdG9cbiAgICogdW5hcHByb3ZlIGEgdmVyc2lvbiBvZiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHRva2VuJ3Mgc3dhcCBjb250cmFjdC5cbiAgICovXG4gIGFzeW5jIHN1Ym1pdFVuYXBwcm92ZVRva2VuQWxsb3dhbmNlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgcGF0aCA9ICcvYXBpL3VuYXBwcm92ZXRva2VuJ1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHBhdGgsIHtcbiAgICAgIGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElELFxuICAgICAgdmVyc2lvbjogdGhpcy51bmFwcHJvdmluZ1Rva2VuVmVyc2lvblxuICAgIH0pXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UudW5hcHByb3ZlVG9rZW5FcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLnVuYXBwcm92ZVRva2VuRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3QgYXNzZXRFeHBsb3JlciA9IENvaW5FeHBsb3JlcnNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgaWYgKGFzc2V0RXhwbG9yZXIgJiYgYXNzZXRFeHBsb3JlcltuZXRdKSB7XG4gICAgICBwYWdlLnVuYXBwcm92ZVRva2VuVHhJRC5ocmVmID0gYXNzZXRFeHBsb3JlcltuZXRdKHJlcy50eElEKVxuICAgIH1cbiAgICBwYWdlLnVuYXBwcm92ZVRva2VuVHhJRC50ZXh0Q29udGVudCA9IHJlcy50eElEXG4gICAgRG9jLmhpZGUocGFnZS51bmFwcHJvdmVUb2tlblN1Ym1pc3Npb25FbGVtZW50cywgcGFnZS51bmFwcHJvdmVUb2tlbkVycilcbiAgICBEb2Muc2hvdyhwYWdlLnVuYXBwcm92ZVRva2VuVHhNc2cpXG4gIH1cblxuICAvKlxuICAgKiBzaG93VW5hcHByb3ZlVG9rZW5BbGxvd2FuY2VGb3JtIGRpc3BsYXlzIHRoZSBmb3JtIGZvciB1bmFwcHJvdmluZ1xuICAgKiBhIHNwZWNpZmljIHZlcnNpb24gb2YgdGhlIGN1cnJlbnRseSBzZWxlY3RlZCB0b2tlbidzIHN3YXAgY29udHJhY3QuXG4gICAqL1xuICBhc3luYyBzaG93VW5hcHByb3ZlVG9rZW5BbGxvd2FuY2VGb3JtICh2ZXJzaW9uOiBudW1iZXIpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy51bmFwcHJvdmluZ1Rva2VuVmVyc2lvbiA9IHZlcnNpb25cbiAgICBEb2Muc2hvdyhwYWdlLnVuYXBwcm92ZVRva2VuU3VibWlzc2lvbkVsZW1lbnRzKVxuICAgIERvYy5oaWRlKHBhZ2UudW5hcHByb3ZlVG9rZW5UeE1zZywgcGFnZS51bmFwcHJvdmVUb2tlbkVycilcbiAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1t0aGlzLnNlbGVjdGVkQXNzZXRJRF1cbiAgICBpZiAoIWFzc2V0IHx8ICFhc3NldC50b2tlbikgcmV0dXJuXG4gICAgY29uc3QgcGFyZW50QXNzZXQgPSBhcHAoKS5hc3NldHNbYXNzZXQudG9rZW4ucGFyZW50SURdXG4gICAgaWYgKCFwYXJlbnRBc3NldCkgcmV0dXJuXG4gICAgRG9jLmVtcHR5KHBhZ2UudG9rZW5BbGxvd2FuY2VSZW1vdmVTeW1ib2wpXG4gICAgcGFnZS50b2tlbkFsbG93YW5jZVJlbW92ZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKGFzc2V0LCB0cnVlKSlcbiAgICBwYWdlLnRva2VuQWxsb3dhbmNlUmVtb3ZlVmVyc2lvbi50ZXh0Q29udGVudCA9IHZlcnNpb24udG9TdHJpbmcoKVxuXG4gICAgY29uc3QgcGF0aCA9ICcvYXBpL2FwcHJvdmV0b2tlbmZlZSdcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTihwYXRoLCB7XG4gICAgICBhc3NldElEOiB0aGlzLnNlbGVjdGVkQXNzZXRJRCxcbiAgICAgIHZlcnNpb246IHZlcnNpb24sXG4gICAgICBhcHByb3Zpbmc6IGZhbHNlXG4gICAgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS51bmFwcHJvdmVUb2tlbkVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UudW5hcHByb3ZlVG9rZW5FcnIpXG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBmZWVUZXh0ID0gYCR7RG9jLmZvcm1hdENvaW5WYWx1ZShyZXMudHhGZWUsIHBhcmVudEFzc2V0LnVuaXRJbmZvKX0gJHtwYXJlbnRBc3NldC51bml0SW5mby5jb252ZW50aW9uYWwudW5pdH1gXG4gICAgICBjb25zdCByYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW3BhcmVudEFzc2V0LmlkXVxuICAgICAgaWYgKHJhdGUpIHtcbiAgICAgICAgZmVlVGV4dCArPSBgICgke0RvYy5mb3JtYXRGaWF0Q29udmVyc2lvbihyZXMudHhGZWUsIHJhdGUsIHBhcmVudEFzc2V0LnVuaXRJbmZvKX0gVVNEKWBcbiAgICAgIH1cbiAgICAgIHBhZ2UudW5hcHByb3ZhbEZlZUVzdGltYXRlLnRleHRDb250ZW50ID0gZmVlVGV4dFxuICAgIH1cbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UudW5hcHByb3ZlVG9rZW5Gb3JtKVxuICB9XG5cbiAgLypcbiAgICogc2hvd1VuYXBwcm92ZVRva2VuQWxsb3dhbmNlVGFibGVGb3JtIGRpc3BsYXlzIGEgdGFibGUgc2hvd2luZyBlYWNoIG9mIHRoZVxuICAgKiB2ZXJzaW9ucyBvZiBhIHRva2VuJ3Mgc3dhcCBjb250cmFjdCB0aGF0IGhhdmUgYmVlbiBhcHByb3ZlZCBhbmQgYWxsb3dzIHRoZVxuICAgKiB1c2VyIHRvIHVuYXBwcm92ZSBhbnkgb2YgdGhlbS5cbiAgICovXG4gIGFzeW5jIHNob3dVbmFwcHJvdmVUb2tlbkFsbG93YW5jZVRhYmxlRm9ybSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW3RoaXMuc2VsZWN0ZWRBc3NldElEXVxuICAgIGlmICghYXNzZXQgfHwgIWFzc2V0LndhbGxldCB8fCAhYXNzZXQud2FsbGV0LmFwcHJvdmVkKSByZXR1cm5cbiAgICB3aGlsZSAocGFnZS50b2tlblZlcnNpb25Cb2R5LmZpcnN0Q2hpbGQpIHtcbiAgICAgIHBhZ2UudG9rZW5WZXJzaW9uQm9keS5yZW1vdmVDaGlsZChwYWdlLnRva2VuVmVyc2lvbkJvZHkuZmlyc3RDaGlsZClcbiAgICB9XG4gICAgRG9jLmVtcHR5KHBhZ2UudG9rZW5WZXJzaW9uVGFibGVBc3NldFN5bWJvbClcbiAgICBwYWdlLnRva2VuVmVyc2lvblRhYmxlQXNzZXRTeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShhc3NldCwgdHJ1ZSkpXG4gICAgY29uc3QgdmVyc2lvblRvREVYZXMgPSB0aGlzLmFzc2V0VmVyc2lvblVzZWRCeURFWGVzKClcblxuICAgIGxldCBzaG93VGFibGUgPSBmYWxzZVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGFzc2V0LndhbGxldC52ZXJzaW9uOyBpKyspIHtcbiAgICAgIGNvbnN0IGFwcHJvdmFsU3RhdHVzID0gYXNzZXQud2FsbGV0LmFwcHJvdmVkW2ldXG4gICAgICBpZiAoYXBwcm92YWxTdGF0dXMgPT09IHVuZGVmaW5lZCB8fCBhcHByb3ZhbFN0YXR1cyAhPT0gQXBwcm92YWxTdGF0dXMuQXBwcm92ZWQpIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cbiAgICAgIHNob3dUYWJsZSA9IHRydWVcbiAgICAgIGNvbnN0IHJvdyA9IHBhZ2UudG9rZW5WZXJzaW9uUm93LmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIHRtcGwudmVyc2lvbi50ZXh0Q29udGVudCA9IGkudG9TdHJpbmcoKVxuICAgICAgaWYgKHZlcnNpb25Ub0RFWGVzW2ldKSB7XG4gICAgICAgIHRtcGwudXNlZEJ5LnRleHRDb250ZW50ID0gdmVyc2lvblRvREVYZXNbaV0uam9pbignLCAnKVxuICAgICAgfVxuICAgICAgY29uc3QgcmVtb3ZlSWNvbiA9IHRoaXMucGFnZS5yZW1vdmVJY29uVG1wbC5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgIERvYy5iaW5kKHJlbW92ZUljb24sICdjbGljaycsICgpID0+IHtcbiAgICAgICAgdGhpcy5zaG93VW5hcHByb3ZlVG9rZW5BbGxvd2FuY2VGb3JtKGkpXG4gICAgICB9KVxuICAgICAgdG1wbC5yZW1vdmUuYXBwZW5kQ2hpbGQocmVtb3ZlSWNvbilcbiAgICAgIHBhZ2UudG9rZW5WZXJzaW9uQm9keS5hcHBlbmRDaGlsZChyb3cpXG4gICAgfVxuICAgIERvYy5zZXRWaXMoc2hvd1RhYmxlLCBwYWdlLnRva2VuVmVyc2lvblRhYmxlKVxuICAgIERvYy5zZXRWaXMoIXNob3dUYWJsZSwgcGFnZS50b2tlblZlcnNpb25Ob25lKVxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS51bmFwcHJvdmVUb2tlblRhYmxlRm9ybSlcbiAgfVxuXG4gIC8qXG4gICAqIHVwZGF0ZVdhbGxldFBlZXJzIHJldHJpZXZlcyB0aGUgd2FsbGV0IHBlZXJzIGFuZCBkaXNwbGF5cyB0aGVtIGluIHRoZVxuICAgKiB3YWxsZXQgcGVlcnMgdGFibGUuXG4gICAqL1xuICBhc3luYyB1cGRhdGVXYWxsZXRQZWVyc1RhYmxlICgpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG5cbiAgICBEb2MuaGlkZShwYWdlLnBlZXJTcGlubmVyKVxuXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvZ2V0d2FsbGV0cGVlcnMnLCB7XG4gICAgICBhc3NldElEOiB0aGlzLnNlbGVjdGVkQXNzZXRJRFxuICAgIH0pXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHBhZ2UubWFuYWdlUGVlcnNFcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICBEb2Muc2hvdyhwYWdlLm1hbmFnZVBlZXJzRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgd2hpbGUgKHBhZ2UucGVlcnNUYWJsZUJvZHkuZmlyc3RDaGlsZCkge1xuICAgICAgcGFnZS5wZWVyc1RhYmxlQm9keS5yZW1vdmVDaGlsZChwYWdlLnBlZXJzVGFibGVCb2R5LmZpcnN0Q2hpbGQpXG4gICAgfVxuXG4gICAgY29uc3QgcGVlcnMgOiBXYWxsZXRQZWVyW10gPSByZXMucGVlcnMgfHwgW11cbiAgICBwZWVycy5zb3J0KChhOiBXYWxsZXRQZWVyLCBiOiBXYWxsZXRQZWVyKSA6IG51bWJlciA9PiB7XG4gICAgICByZXR1cm4gYS5zb3VyY2UgLSBiLnNvdXJjZVxuICAgIH0pXG5cbiAgICBjb25zdCBkZWZhdWx0VGV4dCA9IGludGwucHJlcChpbnRsLklEX0RFRkFVTFQpXG4gICAgY29uc3QgYWRkZWRUZXh0ID0gaW50bC5wcmVwKGludGwuSURfQURERUQpXG4gICAgY29uc3QgZGlzY292ZXJlZFRleHQgPSBpbnRsLnByZXAoaW50bC5JRF9ESVNDT1ZFUkVEKVxuXG4gICAgcGVlcnMuZm9yRWFjaCgocGVlcjogV2FsbGV0UGVlcikgPT4ge1xuICAgICAgY29uc3Qgcm93ID0gcGFnZS5wZWVyVGFibGVSb3cuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuXG4gICAgICB0bXBsLmFkZHIudGV4dENvbnRlbnQgPSBwZWVyLmFkZHJcblxuICAgICAgc3dpdGNoIChwZWVyLnNvdXJjZSkge1xuICAgICAgICBjYXNlIFBlZXJTb3VyY2UuV2FsbGV0RGVmYXVsdDpcbiAgICAgICAgICB0bXBsLnNvdXJjZS50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBQZWVyU291cmNlLlVzZXJBZGRlZDpcbiAgICAgICAgICB0bXBsLnNvdXJjZS50ZXh0Q29udGVudCA9IGFkZGVkVGV4dFxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgUGVlclNvdXJjZS5EaXNjb3ZlcmVkOlxuICAgICAgICAgIHRtcGwuc291cmNlLnRleHRDb250ZW50ID0gZGlzY292ZXJlZFRleHRcbiAgICAgICAgICBicmVha1xuICAgICAgfVxuXG4gICAgICBsZXQgY29ubmVjdGlvbkljb25cbiAgICAgIGlmIChwZWVyLmNvbm5lY3RlZCkge1xuICAgICAgICBjb25uZWN0aW9uSWNvbiA9IHRoaXMucGFnZS5jb25uZWN0ZWRJY29uVG1wbC5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbm5lY3Rpb25JY29uID0gdGhpcy5wYWdlLmRpc2Nvbm5lY3RlZEljb25UbXBsLmNsb25lTm9kZSh0cnVlKVxuICAgICAgfVxuICAgICAgdG1wbC5jb25uZWN0ZWQuYXBwZW5kQ2hpbGQoY29ubmVjdGlvbkljb24pXG5cbiAgICAgIGlmIChwZWVyLnNvdXJjZSA9PT0gUGVlclNvdXJjZS5Vc2VyQWRkZWQpIHtcbiAgICAgICAgY29uc3QgcmVtb3ZlSWNvbiA9IHRoaXMucGFnZS5yZW1vdmVJY29uVG1wbC5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgICAgRG9jLmJpbmQocmVtb3ZlSWNvbiwgJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIERvYy5oaWRlKHBhZ2UubWFuYWdlUGVlcnNFcnIpXG4gICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvcmVtb3Zld2FsbGV0cGVlcicsIHtcbiAgICAgICAgICAgIGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElELFxuICAgICAgICAgICAgYWRkcjogcGVlci5hZGRyXG4gICAgICAgICAgfSlcbiAgICAgICAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgICAgICAgcGFnZS5tYW5hZ2VQZWVyc0Vyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgICAgICAgIERvYy5zaG93KHBhZ2UubWFuYWdlUGVlcnNFcnIpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5zcGluVW50aWxQZWVyc1VwZGF0ZSgpXG4gICAgICAgIH0pXG4gICAgICAgIHRtcGwucmVtb3ZlLmFwcGVuZENoaWxkKHJlbW92ZUljb24pXG4gICAgICB9XG5cbiAgICAgIHBhZ2UucGVlcnNUYWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93KVxuICAgIH0pXG4gIH1cblxuICAvLyBzaG93TWFuYWdlUGVlcnNGb3JtIGRpc3BsYXlzIHRoZSBtYW5hZ2UgcGVlcnMgZm9ybS5cbiAgYXN5bmMgc2hvd01hbmFnZVBlZXJzRm9ybSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGF3YWl0IHRoaXMudXBkYXRlV2FsbGV0UGVlcnNUYWJsZSgpXG4gICAgRG9jLmhpZGUocGFnZS5tYW5hZ2VQZWVyc0VycilcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UubWFuYWdlUGVlcnNGb3JtKVxuICB9XG5cbiAgLy8gc3VibWl0QWRkUGVlcnMgc2VuZHMgYSByZXF1ZXN0IGZvciB0aGUgdGhlIHdhbGxldCB0byBjb25uZWN0IHRvIGEgbmV3XG4gIC8vIHBlZXIuXG4gIGFzeW5jIHN1Ym1pdEFkZFBlZXIgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLm1hbmFnZVBlZXJzRXJyKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2FkZHdhbGxldHBlZXInLCB7XG4gICAgICBhc3NldElEOiB0aGlzLnNlbGVjdGVkQXNzZXRJRCxcbiAgICAgIGFkZHI6IHBhZ2UuYWRkUGVlcklucHV0LnZhbHVlXG4gICAgfSlcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5tYW5hZ2VQZWVyc0Vyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UubWFuYWdlUGVlcnNFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5zcGluVW50aWxQZWVyc1VwZGF0ZSgpXG4gICAgcGFnZS5hZGRQZWVySW5wdXQudmFsdWUgPSAnJ1xuICB9XG5cbiAgLypcbiAgICogc3BpblVudGlsUGVlcnNVcGRhdGUgd2lsbCBzaG93IHRoZSBzcGlubmVyIG9uIHRoZSBtYW5hZ2UgcGVlcnMgZm9yay5cbiAgICogSWYgaXQgaXMgc3RpbGwgc2hvd2luZyBhZnRlciAxMCBzZWNvbmRzLCB0aGUgcGVlcnMgdGFibGUgd2lsbCBiZSB1cGRhdGVkXG4gICAqIGluc3RlYWQgb2Ygd2FpdGluZyBmb3IgYSBub3RpZmljYXRpb24uXG4gICAqL1xuICBhc3luYyBzcGluVW50aWxQZWVyc1VwZGF0ZSAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5zaG93KHBhZ2UucGVlclNwaW5uZXIpXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoRG9jLmlzRGlzcGxheWVkKHBhZ2UucGVlclNwaW5uZXIpKSB7XG4gICAgICAgIHRoaXMudXBkYXRlV2FsbGV0UGVlcnNUYWJsZSgpXG4gICAgICB9XG4gICAgfSwgMTAwMDApXG4gIH1cblxuICAvKlxuICAgKiBzaG93VG9nZ2xlV2FsbGV0U3RhdHVzIGRpc3BsYXlzIHRoZSB0b2dnbGVXYWxsZXRTdGF0dXNDb25maXJtIGZvcm0gd2l0aFxuICAgKiByZWxldmFudCBoZWxwIG1lc3NhZ2UuXG4gICAqL1xuICBzaG93VG9nZ2xlV2FsbGV0U3RhdHVzIChkaXNhYmxlOiBib29sZWFuKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzRXJyLCBwYWdlLndhbGxldFN0YXR1c0Rpc2FibGUsIHBhZ2UuZGlzYWJsZVdhbGxldE1zZywgcGFnZS53YWxsZXRTdGF0dXNFbmFibGUsIHBhZ2UuZW5hYmxlV2FsbGV0TXNnKVxuICAgIGlmIChkaXNhYmxlKSBEb2Muc2hvdyhwYWdlLndhbGxldFN0YXR1c0Rpc2FibGUsIHBhZ2UuZGlzYWJsZVdhbGxldE1zZylcbiAgICBlbHNlIERvYy5zaG93KHBhZ2Uud2FsbGV0U3RhdHVzRW5hYmxlLCBwYWdlLmVuYWJsZVdhbGxldE1zZylcbiAgICB0aGlzLnNob3dGb3JtKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzQ29uZmlybSlcbiAgfVxuXG4gIC8qXG4gICAqIHRvZ2dsZVdhbGxldFN0YXR1cyB0b2dnbGVzIGEgd2FsbGV0cyBzdGF0dXMgdG8gZWl0aGVyIGRpc2FibGVkIG9yIGVuYWJsZWQuXG4gICAqL1xuICBhc3luYyB0b2dnbGVXYWxsZXRTdGF0dXMgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnRvZ2dsZVdhbGxldFN0YXR1c0VycilcblxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW3RoaXMuc2VsZWN0ZWRBc3NldElEXVxuICAgIGNvbnN0IGRpc2FibGUgPSAhYXNzZXQud2FsbGV0LmRpc2FibGVkXG4gICAgY29uc3QgdXJsID0gJy9hcGkvdG9nZ2xld2FsbGV0c3RhdHVzJ1xuICAgIGNvbnN0IHJlcSA9IHtcbiAgICAgIGFzc2V0SUQ6IHRoaXMuc2VsZWN0ZWRBc3NldElELFxuICAgICAgZGlzYWJsZTogZGlzYWJsZVxuICAgIH1cblxuICAgIGNvbnN0IGZtdFBhcmFtcyA9IHsgYXNzZXROYW1lOiBhc3NldC5uYW1lIH1cbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzQ29uZmlybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTih1cmwsIHJlcSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBpZiAocmVzLmNvZGUgPT09IEVycm9ycy5hY3RpdmVPcmRlcnNFcnIpIHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzRXJyLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQUNUSVZFX09SREVSU19FUlJfTVNHLCBmbXRQYXJhbXMpXG4gICAgICBlbHNlIHBhZ2UudG9nZ2xlV2FsbGV0U3RhdHVzRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgRG9jLnNob3cocGFnZS50b2dnbGVXYWxsZXRTdGF0dXNFcnIpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBsZXQgc3VjY2Vzc01zZyA9IGludGwucHJlcChpbnRsLklEX1dBTExFVF9ESVNBQkxFRF9NU0csIGZtdFBhcmFtcylcbiAgICBpZiAoIWRpc2FibGUpIHN1Y2Nlc3NNc2cgPSBpbnRsLnByZXAoaW50bC5JRF9XQUxMRVRfRU5BQkxFRF9NU0csIGZtdFBhcmFtcylcbiAgICB0aGlzLmFzc2V0VXBkYXRlZCh0aGlzLnNlbGVjdGVkQXNzZXRJRCwgcGFnZS50b2dnbGVXYWxsZXRTdGF0dXNDb25maXJtLCBzdWNjZXNzTXNnKVxuICB9XG5cbiAgLypcbiAgICogc2hvd0JveCBzaG93cyB0aGUgYm94IHdpdGggYSBmYWRlLWluIGFuaW1hdGlvbi5cbiAgICovXG4gIGFzeW5jIHNob3dCb3ggKGJveDogSFRNTEVsZW1lbnQsIGZvY3VzZXI/OiBQYWdlRWxlbWVudCkge1xuICAgIGJveC5zdHlsZS5vcGFjaXR5ID0gJzAnXG4gICAgRG9jLnNob3coYm94KVxuICAgIGlmIChmb2N1c2VyKSBmb2N1c2VyLmZvY3VzKClcbiAgICBhd2FpdCBEb2MuYW5pbWF0ZShhbmltYXRpb25MZW5ndGgsIHByb2dyZXNzID0+IHtcbiAgICAgIGJveC5zdHlsZS5vcGFjaXR5ID0gYCR7cHJvZ3Jlc3N9YFxuICAgIH0sICdlYXNlT3V0JylcbiAgICBib3guc3R5bGUub3BhY2l0eSA9ICcxJ1xuICAgIHRoaXMuZGlzcGxheWVkID0gYm94XG4gIH1cblxuICAvKiBzaG93Rm9ybSBzaG93cyBhIG1vZGFsIGZvcm0gd2l0aCBhIGxpdHRsZSBhbmltYXRpb24uICovXG4gIGFzeW5jIHNob3dGb3JtIChmb3JtOiBQYWdlRWxlbWVudCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmN1cnJlbnRGb3JtID0gZm9ybVxuICAgIHRoaXMuZm9ybXMuZm9yRWFjaChmb3JtID0+IERvYy5oaWRlKGZvcm0pKVxuICAgIGZvcm0uc3R5bGUucmlnaHQgPSAnMTAwMDBweCdcbiAgICBEb2Muc2hvdyhwYWdlLmZvcm1zLCBmb3JtKVxuICAgIGNvbnN0IHNoaWZ0ID0gKHBhZ2UuZm9ybXMub2Zmc2V0V2lkdGggKyBmb3JtLm9mZnNldFdpZHRoKSAvIDJcbiAgICBhd2FpdCBEb2MuYW5pbWF0ZShhbmltYXRpb25MZW5ndGgsIHByb2dyZXNzID0+IHtcbiAgICAgIGZvcm0uc3R5bGUucmlnaHQgPSBgJHsoMSAtIHByb2dyZXNzKSAqIHNoaWZ0fXB4YFxuICAgIH0sICdlYXNlT3V0SGFyZCcpXG4gICAgZm9ybS5zdHlsZS5yaWdodCA9ICcwJ1xuICB9XG5cbiAgYXN5bmMgc2hvd1N1Y2Nlc3MgKG1zZzogc3RyaW5nKSB7XG4gICAgdGhpcy5mb3Jtcy5mb3JFYWNoKGZvcm0gPT4gRG9jLmhpZGUoZm9ybSkpXG4gICAgdGhpcy5jdXJyZW50Rm9ybSA9IHRoaXMucGFnZS5jaGVja21hcmtGb3JtXG4gICAgdGhpcy5hbmltYXRpb24gPSBzaG93U3VjY2Vzcyh0aGlzLnBhZ2UsIG1zZylcbiAgICBhd2FpdCB0aGlzLmFuaW1hdGlvbi53YWl0KClcbiAgICB0aGlzLmFuaW1hdGlvbiA9IG5ldyBBbmltYXRpb24oMTUwMCwgKCkgPT4geyAvKiBwYXNzICovIH0sICcnLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50Rm9ybSA9PT0gdGhpcy5wYWdlLmNoZWNrbWFya0Zvcm0pIHRoaXMuY2xvc2VQb3B1cHMoKVxuICAgIH0pXG4gIH1cblxuICAvKiBTaG93IHRoZSBuZXcgd2FsbGV0IGZvcm0uICovXG4gIGFzeW5jIHNob3dOZXdXYWxsZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBib3ggPSBwYWdlLm5ld1dhbGxldEZvcm1cbiAgICB0aGlzLm5ld1dhbGxldEZvcm0uc2V0QXNzZXQoYXNzZXRJRClcbiAgICBjb25zdCBkZWZhdWx0c0xvYWRlZCA9IHRoaXMubmV3V2FsbGV0Rm9ybS5sb2FkRGVmYXVsdHMoKVxuICAgIGF3YWl0IHRoaXMuc2hvd0Zvcm0oYm94KVxuICAgIGF3YWl0IGRlZmF1bHRzTG9hZGVkXG4gIH1cblxuICAvLyBzb3J0QXNzZXRCdXR0b25zIGRpc3BsYXlzIHN1cHBvcnRlZCBhc3NldHMsIHNvcnRlZC4gUmV0dXJucyBmaXJzdCBhc3NldCBpbiB0aGVcbiAgLy8gbGlzdC5cbiAgc29ydEFzc2V0QnV0dG9ucyAoKTogU3VwcG9ydGVkQXNzZXQge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmFzc2V0QnV0dG9ucyA9IHt9XG4gICAgRG9jLmVtcHR5KHBhZ2UuYXNzZXRTZWxlY3QpXG4gICAgY29uc3Qgc29ydGVkQXNzZXRzID0gWy4uLk9iamVjdC52YWx1ZXMoYXBwKCkuYXNzZXRzKV1cbiAgICBzb3J0ZWRBc3NldHMuc29ydCgoYTogU3VwcG9ydGVkQXNzZXQsIGI6IFN1cHBvcnRlZEFzc2V0KSA9PiB7XG4gICAgICBpZiAoYS53YWxsZXQgJiYgIWIud2FsbGV0KSByZXR1cm4gLTFcbiAgICAgIGlmICghYS53YWxsZXQgJiYgYi53YWxsZXQpIHJldHVybiAxXG4gICAgICBpZiAoIWEud2FsbGV0ICYmICFiLndhbGxldCkgcmV0dXJuIGEuc3ltYm9sID09PSAnZGNyJyA/IC0xIDogMVxuICAgICAgY29uc3QgW2FCYWwsIGJCYWxdID0gW2Eud2FsbGV0LmJhbGFuY2UsIGIud2FsbGV0LmJhbGFuY2VdXG4gICAgICBjb25zdCBbYVRvdGFsLCBiVG90YWxdID0gW2FCYWwuYXZhaWxhYmxlICsgYUJhbC5pbW1hdHVyZSArIGFCYWwubG9ja2VkLCBiQmFsLmF2YWlsYWJsZSArIGJCYWwuaW1tYXR1cmUgKyBiQmFsLmxvY2tlZF1cbiAgICAgIGlmIChhVG90YWwgPT09IDAgJiYgYlRvdGFsID09PSAwKSByZXR1cm4gYS5zeW1ib2wubG9jYWxlQ29tcGFyZShiLnN5bWJvbClcbiAgICAgIGVsc2UgaWYgKGFUb3RhbCA9PT0gMCkgcmV0dXJuIDFcbiAgICAgIGVsc2UgaWYgKGFUb3RhbCA9PT0gMCkgcmV0dXJuIC0xXG4gICAgICBjb25zdCBbYUZpYXQsIGJGaWF0XSA9IFthcHAoKS5maWF0UmF0ZXNNYXBbYS5pZF0sIGFwcCgpLmZpYXRSYXRlc01hcFtiLmlkXV1cbiAgICAgIGlmIChhRmlhdCAmJiAhYkZpYXQpIHJldHVybiAtMVxuICAgICAgaWYgKCFhRmlhdCAmJiBiRmlhdCkgcmV0dXJuIDFcbiAgICAgIHJldHVybiBiRmlhdCAqIGJUb3RhbCAtIGFGaWF0ICogYVRvdGFsXG4gICAgfSlcbiAgICBmb3IgKGNvbnN0IGEgb2Ygc29ydGVkQXNzZXRzKSB7XG4gICAgICBjb25zdCBidHRuID0gcGFnZS5pY29uU2VsZWN0VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIHBhZ2UuYXNzZXRTZWxlY3QuYXBwZW5kQ2hpbGQoYnR0bilcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShidHRuKVxuICAgICAgdGhpcy5hc3NldEJ1dHRvbnNbYS5pZF0gPSB7IHRtcGwsIGJ0dG4gfVxuICAgICAgdGhpcy51cGRhdGVBc3NldEJ1dHRvbihhLmlkKVxuICAgICAgRG9jLmJpbmQoYnR0biwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkQXNzZXQoYS5pZClcbiAgICAgICAgU3RhdGUuc3RvcmVMb2NhbChTdGF0ZS5zZWxlY3RlZEFzc2V0TEssIFN0cmluZyhhLmlkKSlcbiAgICAgIH0pXG4gICAgfVxuICAgIHBhZ2UuYXNzZXRTZWxlY3QuY2xhc3NMaXN0LnJlbW92ZSgnaW52aXNpYmxlJylcbiAgICByZXR1cm4gc29ydGVkQXNzZXRzWzBdXG4gIH1cblxuICB1cGRhdGVBc3NldEJ1dHRvbiAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgYSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHsgYnR0biwgdG1wbCB9ID0gdGhpcy5hc3NldEJ1dHRvbnNbYXNzZXRJRF1cbiAgICBEb2MuaGlkZSh0bXBsLmZpYXRCb3gsIHRtcGwubm9XYWxsZXQpXG4gICAgYnR0bi5jbGFzc0xpc3QuYWRkKCdub3dhbGxldCcpXG4gICAgdG1wbC5pbWcuc3JjIHx8PSBEb2MubG9nb1BhdGgoYS5zeW1ib2wpIC8vIGRvbid0IGluaXRpYXRlIEdFVCBpZiBhbHJlYWR5IHNldCAoZS5nLiB1cGRhdGUgb24gc29tZSBub3RpZmljYXRpb24pXG4gICAgY29uc3Qgc3ltYm9sUGFydHMgPSBhLnN5bWJvbC5zcGxpdCgnLicpXG4gICAgaWYgKHN5bWJvbFBhcnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgY29uc3QgcGFyZW50U3ltYm9sID0gc3ltYm9sUGFydHNbMV1cbiAgICAgIHRtcGwucGFyZW50SW1nLmNsYXNzTGlzdC5yZW1vdmUoJ2QtaGlkZScpXG4gICAgICB0bXBsLnBhcmVudEltZy5zcmMgfHw9IERvYy5sb2dvUGF0aChwYXJlbnRTeW1ib2wpXG4gICAgfVxuICAgIGlmICh0aGlzLnNlbGVjdGVkQXNzZXRJRCA9PT0gYXNzZXRJRCkgYnR0bi5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpXG4gICAgdG1wbC5uYW1lLnRleHRDb250ZW50ID0gYS5uYW1lXG4gICAgaWYgKGEud2FsbGV0KSB7XG4gICAgICBidHRuLmNsYXNzTGlzdC5yZW1vdmUoJ25vd2FsbGV0JylcbiAgICAgIGNvbnN0IHsgd2FsbGV0OiB7IGJhbGFuY2U6IGIgfSwgdW5pdEluZm86IHVpIH0gPSBhXG4gICAgICBjb25zdCB0b3RhbEJhbGFuY2UgPSBiLmF2YWlsYWJsZSArIGIubG9ja2VkICsgYi5pbW1hdHVyZVxuICAgICAgY29uc3QgW3MsIHVuaXRdID0gRG9jLmZvcm1hdEJlc3RVbml0c0ZvdXJTaWdGaWdzKHRvdGFsQmFsYW5jZSwgdWkpXG4gICAgICB0bXBsLmJhbGFuY2UudGV4dENvbnRlbnQgPSBzXG4gICAgICB0bXBsLnVuaXQudGV4dENvbnRlbnQgPSB1bml0XG4gICAgICBEb2Muc2hvdyh0bXBsLmJhbGFuY2VCb3gpXG4gICAgICBjb25zdCBmaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFthLmlkXVxuICAgICAgaWYgKGZpYXRSYXRlKSB7XG4gICAgICAgIERvYy5zaG93KHRtcGwuZmlhdEJveClcbiAgICAgICAgdG1wbC5maWF0LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHRvdGFsQmFsYW5jZSAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yICogZmlhdFJhdGUpXG4gICAgICB9XG4gICAgfSBlbHNlIERvYy5zaG93KHRtcGwubm9XYWxsZXQpXG4gIH1cblxuICBhc3luYyBzZXRTZWxlY3RlZEFzc2V0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCB7IGFzc2V0U2VsZWN0IH0gPSB0aGlzLnBhZ2VcbiAgICBmb3IgKGNvbnN0IGIgb2YgYXNzZXRTZWxlY3QuY2hpbGRyZW4pIGIuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKVxuICAgIHRoaXMuYXNzZXRCdXR0b25zW2Fzc2V0SURdLmJ0dG4uY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxuICAgIHRoaXMuc2VsZWN0ZWRBc3NldElEID0gYXNzZXRJRFxuICAgIHRoaXMucGFnZS5oaWRlTWl4VHhzQ2hlY2tib3guY2hlY2tlZCA9IHRydWVcbiAgICB0aGlzLnVwZGF0ZURpc3BsYXllZEFzc2V0KGFzc2V0SUQpXG4gICAgdGhpcy5zaG93QXZhaWxhYmxlTWFya2V0cyhhc3NldElEKVxuICAgIGNvbnN0IGEgPSB0aGlzLnNob3dSZWNlbnRBY3Rpdml0eShhc3NldElEKVxuICAgIGNvbnN0IGIgPSB0aGlzLnNob3dUeEhpc3RvcnkoYXNzZXRJRClcbiAgICBjb25zdCBjID0gdGhpcy51cGRhdGVUaWNrZXRCdXllcihhc3NldElEKVxuICAgIGNvbnN0IGQgPSB0aGlzLnVwZGF0ZVByaXZhY3koYXNzZXRJRClcbiAgICBmb3IgKGNvbnN0IHAgb2YgW2EsIGIsIGMsIGRdKSBhd2FpdCBwXG4gIH1cblxuICB1cGRhdGVEaXNwbGF5ZWRBc3NldCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgaWYgKGFzc2V0SUQgIT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSByZXR1cm5cbiAgICBjb25zdCB7IHN5bWJvbCwgd2FsbGV0LCBuYW1lLCB0b2tlbiwgdW5pdEluZm8gfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHsgcGFnZSwgYm9keSB9ID0gdGhpc1xuICAgIERvYy5zZXRUZXh0KGJvZHksICdbZGF0YS1hc3NldC1uYW1lXScsIG5hbWUpXG4gICAgRG9jLnNldFRleHQoYm9keSwgJ1tkYXRhLXRpY2tlcl0nLCB1bml0SW5mby5jb252ZW50aW9uYWwudW5pdClcbiAgICBwYWdlLmFzc2V0TG9nby5zcmMgPSBEb2MubG9nb1BhdGgoc3ltYm9sKVxuICAgIERvYy5oaWRlKFxuICAgICAgcGFnZS5iYWxhbmNlQm94LCBwYWdlLmZpYXRCYWxhbmNlQm94LCBwYWdlLmNyZWF0ZVdhbGxldCwgcGFnZS53YWxsZXREZXRhaWxzLFxuICAgICAgcGFnZS5zZW5kUmVjZWl2ZSwgcGFnZS5jb25uZWN0QnR0bkJveCwgcGFnZS5zdGF0dXNMb2NrZWQsIHBhZ2Uuc3RhdHVzUmVhZHksXG4gICAgICBwYWdlLnN0YXR1c09mZiwgcGFnZS51bmxvY2tCdHRuQm94LCBwYWdlLmxvY2tCdHRuQm94LCBwYWdlLmNvbm5lY3RCdHRuQm94LFxuICAgICAgcGFnZS5wZWVyQ291bnRCb3gsIHBhZ2Uuc3luY1Byb2dyZXNzQm94LCBwYWdlLnN0YXR1c0Rpc2FibGVkLCBwYWdlLnRva2VuSW5mb0JveCxcbiAgICAgIHBhZ2UubmVlZHNQcm92aWRlckJveCwgcGFnZS5mZWVTdGF0ZUJveCwgcGFnZS50eFN5bmNCb3gsIHBhZ2UudHhQcm9ncmVzcyxcbiAgICAgIHBhZ2UudHhGaW5kaW5nQWRkcnNcbiAgICApXG4gICAgdGhpcy5jaGVja05lZWRzUHJvdmlkZXIoYXNzZXRJRClcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIGNvbnN0IHBhcmVudEFzc2V0ID0gYXBwKCkuYXNzZXRzW3Rva2VuLnBhcmVudElEXVxuICAgICAgcGFnZS50b2tlblBhcmVudExvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHBhcmVudEFzc2V0LnN5bWJvbClcbiAgICAgIHBhZ2UudG9rZW5QYXJlbnROYW1lLnRleHRDb250ZW50ID0gcGFyZW50QXNzZXQubmFtZVxuICAgICAgcGFnZS5jb250cmFjdEFkZHJlc3MudGV4dENvbnRlbnQgPSB0b2tlbi5jb250cmFjdEFkZHJlc3NcbiAgICAgIERvYy5zaG93KHBhZ2UudG9rZW5JbmZvQm94KVxuICAgIH1cbiAgICBpZiAod2FsbGV0KSB7XG4gICAgICB0aGlzLnVwZGF0ZURpc3BsYXllZEFzc2V0QmFsYW5jZSgpXG4gICAgICBjb25zdCB7IGZlZVN0YXRlLCBydW5uaW5nLCBkaXNhYmxlZCwgdHlwZTogd2FsbGV0VHlwZSB9ID0gd2FsbGV0XG5cbiAgICAgIGNvbnN0IHdhbGxldERlZiA9IGFwcCgpLndhbGxldERlZmluaXRpb24oYXNzZXRJRCwgd2FsbGV0VHlwZSlcbiAgICAgIHBhZ2Uud2FsbGV0VHlwZS50ZXh0Q29udGVudCA9IHdhbGxldERlZi50YWJcbiAgICAgIGlmIChmZWVTdGF0ZSkgdGhpcy51cGRhdGVGZWVTdGF0ZShmZWVTdGF0ZSlcbiAgICAgIGlmIChkaXNhYmxlZCkgRG9jLnNob3cocGFnZS5zdGF0dXNEaXNhYmxlZCkgLy8gd2FsbGV0IGlzIGRpc2FibGVkXG4gICAgICBlbHNlIGlmIChydW5uaW5nKSB7XG4gICAgICAgIHRoaXMudXBkYXRlU3luY0FuZFBlZXJzKHdhbGxldC5hc3NldElEKVxuICAgICAgfSBlbHNlIERvYy5zaG93KHBhZ2Uuc3RhdHVzT2ZmLCBwYWdlLmNvbm5lY3RCdHRuQm94KSAvLyB3YWxsZXQgbm90IHJ1bm5pbmdcbiAgICB9IGVsc2UgRG9jLnNob3cocGFnZS5jcmVhdGVXYWxsZXQpIC8vIG5vIHdhbGxldFxuXG4gICAgcGFnZS53YWxsZXREZXRhaWxzQm94LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmlzaWJsZScpXG4gIH1cblxuICB1cGRhdGVTeW5jQW5kUGVlcnMgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHsgcGFnZSwgc2VsZWN0ZWRBc3NldElEIH0gPSB0aGlzXG4gICAgaWYgKGFzc2V0SUQgIT09IHNlbGVjdGVkQXNzZXRJRCkgcmV0dXJuXG4gICAgY29uc3QgeyBwZWVyQ291bnQsIHN5bmNQcm9ncmVzcywgc3luY1N0YXR1cywgZW5jcnlwdGVkLCBvcGVuLCBydW5uaW5nIH0gPSBhcHAoKS53YWxsZXRNYXBbYXNzZXRJRF1cbiAgICBpZiAoIXJ1bm5pbmcpIHJldHVyblxuICAgIERvYy5zaG93KHBhZ2Uuc2VuZFJlY2VpdmUsIHBhZ2UucGVlckNvdW50Qm94LCBwYWdlLnN5bmNQcm9ncmVzc0JveClcbiAgICBwYWdlLnBlZXJDb3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhwZWVyQ291bnQpXG4gICAgcGFnZS5zeW5jUHJvZ3Jlc3MudGV4dENvbnRlbnQgPSBgJHsoc3luY1Byb2dyZXNzICogMTAwKS50b0ZpeGVkKDEpfSVgXG4gICAgaWYgKG9wZW4pIHtcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3RhdHVzUmVhZHkpXG4gICAgICBpZiAoIWFwcCgpLmhhdmVBY3RpdmVPcmRlcnMoYXNzZXRJRCkgJiYgZW5jcnlwdGVkKSBEb2Muc2hvdyhwYWdlLmxvY2tCdHRuQm94KVxuICAgIH0gZWxzZSBEb2Muc2hvdyhwYWdlLnN0YXR1c0xvY2tlZCwgcGFnZS51bmxvY2tCdHRuQm94KSAvLyB3YWxsZXQgbm90IHVubG9ja2VkXG4gICAgRG9jLnNldFZpcyhzeW5jU3RhdHVzLnR4cyAhPT0gdW5kZWZpbmVkLCBwYWdlLnR4U3luY0JveClcbiAgICBpZiAoc3luY1N0YXR1cy50eHMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgRG9jLmhpZGUocGFnZS50eFByb2dyZXNzLCBwYWdlLnR4RmluZGluZ0FkZHJzKVxuICAgICAgaWYgKHN5bmNTdGF0dXMudHhzID09PSAwICYmIHN5bmNTdGF0dXMuYmxvY2tzID49IHN5bmNTdGF0dXMudGFyZ2V0SGVpZ2h0KSBEb2Muc2hvdyhwYWdlLnR4RmluZGluZ0FkZHJzKVxuICAgICAgZWxzZSB7XG4gICAgICAgIERvYy5zaG93KHBhZ2UudHhQcm9ncmVzcylcbiAgICAgICAgY29uc3QgcHJvZyA9IHN5bmNTdGF0dXMudHhzIC8gc3luY1N0YXR1cy50YXJnZXRIZWlnaHRcbiAgICAgICAgcGFnZS50eFByb2dyZXNzLnRleHRDb250ZW50ID0gYCR7KHByb2cgKiAxMDApLnRvRml4ZWQoMSl9JWBcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB1cGRhdGVGZWVTdGF0ZSAoZmVlU3RhdGU6IEZlZVN0YXRlKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzZWxlY3RlZEFzc2V0SUQ6IGFzc2V0SUQgfSA9IHRoaXNcbiAgICBEb2MuaGlkZShwYWdlLmZlZVN0YXRlQm94KVxuICAgIGNvbnN0IHsgdW5pdEluZm86IHVpLCB0b2tlbiB9ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG4gICAgY29uc3QgZmlhdFJhdGUgPSBhcHAoKS5maWF0UmF0ZXNNYXBbYXNzZXRJRF1cbiAgICBpZiAoIWZpYXRSYXRlKSByZXR1cm5cbiAgICBjb25zdCBmZWVBc3NldElEID0gdG9rZW4gPyB0b2tlbi5wYXJlbnRJRCA6IGFzc2V0SURcbiAgICBjb25zdCBmZWVGaWF0UmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFtmZWVBc3NldElEXVxuICAgIGlmICh0b2tlbiAmJiAhZmVlRmlhdFJhdGUpIHJldHVyblxuICAgIERvYy5zaG93KHBhZ2UuZmVlU3RhdGVCb3gpXG4gICAgY29uc3QgZmVlVUkgPSB0b2tlbiA/IGFwcCgpLmFzc2V0c1t0b2tlbi5wYXJlbnRJRF0udW5pdEluZm8gOiB1aVxuICAgIERvYy5mb3JtYXRCZXN0UmF0ZUVsZW1lbnQocGFnZS5mZWVTdGF0ZU5ldFJhdGUsIGZlZUFzc2V0SUQsIGZlZVN0YXRlLnJhdGUsIGZlZVVJKVxuICAgIERvYy5mb3JtYXRCZXN0VmFsdWVFbGVtZW50KHBhZ2UuZmVlU3RhdGVTZW5kRmVlcywgZmVlQXNzZXRJRCwgZmVlU3RhdGUuc2VuZCwgZmVlVUkpXG4gICAgRG9jLmZvcm1hdEJlc3RWYWx1ZUVsZW1lbnQocGFnZS5mZWVTdGF0ZVN3YXBGZWVzLCBmZWVBc3NldElELCBmZWVTdGF0ZS5zd2FwLCBmZWVVSSlcbiAgICBEb2MuZm9ybWF0QmVzdFZhbHVlRWxlbWVudChwYWdlLmZlZVN0YXRlUmVkZWVtRmVlcywgZmVlQXNzZXRJRCwgZmVlU3RhdGUucmVkZWVtLCBmZWVVSSlcbiAgICBwYWdlLmZlZVN0YXRlWGNSYXRlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKGZpYXRSYXRlKVxuICAgIGNvbnN0IHNlbmRGaWF0ID0gZmVlU3RhdGUuc2VuZCAvIGZlZVVJLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yICogZmVlRmlhdFJhdGVcbiAgICBwYWdlLmZlZVN0YXRlU2VuZEZpYXQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moc2VuZEZpYXQpXG4gICAgY29uc3Qgc3dhcEZpYXQgPSBmZWVTdGF0ZS5zd2FwIC8gZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgKiBmZWVGaWF0UmF0ZVxuICAgIHBhZ2UuZmVlU3RhdGVTd2FwRmlhdC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhzd2FwRmlhdClcbiAgICBjb25zdCByZWRlZW1GaWF0ID0gZmVlU3RhdGUucmVkZWVtIC8gZmVlVUkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IgKiBmZWVGaWF0UmF0ZVxuICAgIHBhZ2UuZmVlU3RhdGVSZWRlZW1GaWF0LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHJlZGVlbUZpYXQpXG4gICAgRG9jLnNob3cocGFnZS5mZWVTdGF0ZUJveClcbiAgfVxuXG4gIGFzeW5jIGNoZWNrTmVlZHNQcm92aWRlciAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgbmVlZHMgPSBhd2FpdCBhcHAoKS5uZWVkc0N1c3RvbVByb3ZpZGVyKGFzc2V0SUQpXG4gICAgY29uc3QgeyBwYWdlOiB7IG5lZWRzUHJvdmlkZXJCb3g6IGJveCwgbmVlZHNQcm92aWRlckJ0dG46IGJ0dG4gfSB9ID0gdGhpc1xuICAgIERvYy5zZXRWaXMobmVlZHMsIGJveClcbiAgICBpZiAoIW5lZWRzKSByZXR1cm5cbiAgICBEb2MuYmxpbmsoYnR0bilcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVRpY2tldEJ1eWVyIChhc3NldElEOiBudW1iZXIpIHtcbiAgICB0aGlzLnRpY2tldFBhZ2UgPSB7XG4gICAgICBudW1iZXI6IDAsXG4gICAgICBoaXN0b3J5OiBbXSxcbiAgICAgIHNjYW5uZWQ6IGZhbHNlXG4gICAgfVxuICAgIGNvbnN0IHsgd2FsbGV0LCB1bml0SW5mbzogdWkgfSA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShcbiAgICAgIHBhZ2Uuc3Rha2luZ0JveCwgcGFnZS5waWNrVlNQLCBwYWdlLnN0YWtpbmdTdW1tYXJ5LCBwYWdlLnN0YWtpbmdFcnIsXG4gICAgICBwYWdlLnZzcERpc3BsYXlCb3gsIHBhZ2UudGlja2V0UHJpY2VCb3gsIHBhZ2UucHVyY2hhc2VUaWNrZXRzQm94LFxuICAgICAgcGFnZS5zdGFraW5nUnBjU3B2TXNnLCBwYWdlLnRpY2tldHNEaXNhYmxlZFxuICAgIClcbiAgICBpZiAoIXdhbGxldD8ucnVubmluZyB8fCAod2FsbGV0LnRyYWl0cyAmIHRyYWl0VGlja2V0QnV5ZXIpID09PSAwKSByZXR1cm5cbiAgICBEb2Muc2hvdyhwYWdlLnN0YWtpbmdCb3gpXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnN0YWtpbmdCb3gpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS9zdGFrZXN0YXR1cycsIGFzc2V0SUQpXG4gICAgbG9hZGVkKClcbiAgICBpZiAoIWFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgLy8gTG9vayBmb3IgY29tbW9uIGVycm9yIGZvciBSUEMgKyBTUFYgd2FsbGV0LlxuICAgICAgaWYgKHJlcy5tc2cuaW5jbHVkZXMoJ2Rpc2Nvbm5lY3RlZCBmcm9tIGNvbnNlbnN1cyBSUEMnKSkge1xuICAgICAgICBEb2Muc2hvdyhwYWdlLnN0YWtpbmdScGNTcHZNc2cpXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgRG9jLnNob3cocGFnZS5zdGFraW5nRXJyKVxuICAgICAgcGFnZS5zdGFraW5nRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2Uuc3Rha2luZ1N1bW1hcnksIHBhZ2UudGlja2V0UHJpY2VCb3gpXG4gICAgY29uc3Qgc3Rha2VTdGF0dXMgPSByZXMuc3RhdHVzIGFzIFRpY2tldFN0YWtpbmdTdGF0dXNcbiAgICB0aGlzLnN0YWtlU3RhdHVzID0gc3Rha2VTdGF0dXNcbiAgICBwYWdlLnN0YWtpbmdBZ2VuZGFDb3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhzdGFrZVN0YXR1cy5zdGFuY2VzLmFnZW5kYXMubGVuZ3RoKVxuICAgIHBhZ2Uuc3Rha2luZ1RzcGVuZENvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKHN0YWtlU3RhdHVzLnN0YW5jZXMudHNwZW5kcy5sZW5ndGgpXG4gICAgcGFnZS5wdXJjaGFzZXJDdXJyZW50UHJpY2UudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3Moc3Rha2VTdGF0dXMudGlja2V0UHJpY2UgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICBwYWdlLnB1cmNoYXNlckJhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUod2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlLCB1aSlcbiAgICB0aGlzLnVwZGF0ZVRpY2tldFN0YXRzKHN0YWtlU3RhdHVzLnN0YXRzLCB1aSwgc3Rha2VTdGF0dXMudGlja2V0UHJpY2UsIHN0YWtlU3RhdHVzLnZvdGluZ1N1YnNpZHkpXG4gICAgLy8gSWYgdGhpcyBpcyBhbiBleHRlbnNpb24gd2FsbGV0LCB3ZSdsbCBtaWdodCB0byBkaXNhYmxlIGFsbCBjb250cm9scy5cbiAgICBjb25zdCBkaXNhYmxlU3Rha2luZyA9IGFwcCgpLmV4dGVuc2lvbldhbGxldCh0aGlzLnNlbGVjdGVkQXNzZXRJRCk/LmRpc2FibGVTdGFraW5nXG4gICAgaWYgKGRpc2FibGVTdGFraW5nKSB7XG4gICAgICBEb2MuaGlkZShwYWdlLnNldFZvdGVzLCBwYWdlLnNob3dWU1BzKVxuICAgICAgRG9jLnNob3cocGFnZS50aWNrZXRzRGlzYWJsZWQpXG4gICAgICBwYWdlLmV4dGVuc2lvbk1vZGVBcHBOYW1lLnRleHRDb250ZW50ID0gYXBwKCkudXNlci5leHRlbnNpb25Nb2RlQ29uZmlnLm5hbWVcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRoaXMuc2V0VlNQVml6KHN0YWtlU3RhdHVzLnZzcClcbiAgfVxuXG4gIHNldFZTUFZpeiAodnNwOiBzdHJpbmcpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHN0YWtlU3RhdHVzIH0gPSB0aGlzXG4gICAgRG9jLmhpZGUocGFnZS52c3BEaXNwbGF5Qm94KVxuICAgIGlmICh2c3ApIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudnNwRGlzcGxheUJveCwgcGFnZS5wdXJjaGFzZVRpY2tldHNCb3gpXG4gICAgICBEb2MuaGlkZShwYWdlLnBpY2tWU1ApXG4gICAgICBwYWdlLnZzcFVSTC50ZXh0Q29udGVudCA9IHZzcFxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zZXRWaXMoIXN0YWtlU3RhdHVzLmlzUlBDLCBwYWdlLnBpY2tWU1ApXG4gICAgRG9jLnNldFZpcyhzdGFrZVN0YXR1cy5pc1JQQywgcGFnZS5wdXJjaGFzZVRpY2tldHNCb3gpXG4gIH1cblxuICB1cGRhdGVUaWNrZXRTdGF0cyAoc3RhdHM6IFRpY2tldFN0YXRzLCB1aTogVW5pdEluZm8sIHRpY2tldFByaWNlPzogbnVtYmVyLCB2b3RpbmdTdWJzaWR5PzogbnVtYmVyKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzdGFrZVN0YXR1cyB9ID0gdGhpc1xuICAgIHN0YWtlU3RhdHVzLnN0YXRzID0gc3RhdHNcbiAgICBpZiAodGlja2V0UHJpY2UpIHN0YWtlU3RhdHVzLnRpY2tldFByaWNlID0gdGlja2V0UHJpY2VcbiAgICBpZiAodm90aW5nU3Vic2lkeSkgc3Rha2VTdGF0dXMudm90aW5nU3Vic2lkeSA9IHZvdGluZ1N1YnNpZHlcbiAgICBjb25zdCBsaXZlVGlja2V0Q291bnQgPSBzdGFrZVN0YXR1cy50aWNrZXRzLmZpbHRlcigodGt0OiBUaWNrZXQpID0+IHRrdC5zdGF0dXMgPD0gdGlja2V0U3RhdHVzTGl2ZSAmJiB0a3Quc3RhdHVzID49IHRpY2tldFN0YXR1c1VubWluZWQpLmxlbmd0aFxuICAgIHBhZ2Uuc3Rha2luZ1RpY2tldENvdW50LnRleHRDb250ZW50ID0gU3RyaW5nKGxpdmVUaWNrZXRDb3VudClcbiAgICBwYWdlLmltbWF0dXJlVGlja2V0Q291bnQudGV4dENvbnRlbnQgPSBTdHJpbmcoc3RhdHMubWVtcG9vbClcbiAgICBEb2Muc2V0VmlzKHN0YXRzLm1lbXBvb2wgPiAwLCBwYWdlLmltbWF0dXJlVGlja2V0Q291bnRCb3gpXG4gICAgcGFnZS5xdWV1ZWRUaWNrZXRDb3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhzdGF0cy5xdWV1ZWQpXG4gICAgcGFnZS5mb3JtUXVldWVkVGl4LnRleHRDb250ZW50ID0gU3RyaW5nKHN0YXRzLnF1ZXVlZClcbiAgICBEb2Muc2V0VmlzKHN0YXRzLnF1ZXVlZCA+IDAsIHBhZ2UuZm9ybVF1ZXVlVGl4Qm94LCBwYWdlLnF1ZXVlZFRpY2tldENvdW50Qm94KVxuICAgIHBhZ2UudG90YWxUaWNrZXRDb3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhzdGF0cy50aWNrZXRDb3VudClcbiAgICBwYWdlLnRvdGFsVGlja2V0UmV3YXJkcy50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhzdGF0cy50b3RhbFJld2FyZHMgLyB1aS5jb252ZW50aW9uYWwuY29udmVyc2lvbkZhY3RvcilcbiAgICBwYWdlLnRvdGFsVGlja2V0Vm90ZXMudGV4dENvbnRlbnQgPSBTdHJpbmcoc3RhdHMudm90ZXMpXG4gICAgaWYgKHRpY2tldFByaWNlKSBwYWdlLnRpY2tldFByaWNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHRpY2tldFByaWNlIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgaWYgKHZvdGluZ1N1YnNpZHkpIHBhZ2Uudm90aW5nU3Vic2lkeS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyh2b3RpbmdTdWJzaWR5IC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gIH1cblxuICBhc3luYyBzaG93VlNQUGlja2VyICgpIHtcbiAgICBjb25zdCBhc3NldElEID0gdGhpcy5zZWxlY3RlZEFzc2V0SURcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgdGhpcy5zaG93Rm9ybShwYWdlLnZzcFBpY2tlcilcbiAgICBEb2MuZW1wdHkocGFnZS52c3BQaWNrZXJMaXN0KVxuICAgIERvYy5oaWRlKHBhZ2Uuc3Rha2luZ0VycilcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UudnNwUGlja2VyKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuc2FmZVBvc3QoJy9hcGkvbGlzdHZzcHMnLCBhc3NldElEKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3Rha2luZ0VycilcbiAgICAgIHBhZ2Uuc3Rha2luZ0Vyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCB2c3BzID0gcmVzLnZzcHMgYXMgVm90aW5nU2VydmljZVByb3ZpZGVyW11cbiAgICBmb3IgKGNvbnN0IHZzcCBvZiB2c3BzKSB7XG4gICAgICBjb25zdCByb3cgPSBwYWdlLnZzcFJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLnZzcFBpY2tlckxpc3QuYXBwZW5kQ2hpbGQocm93KVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIHRtcGwudXJsLnRleHRDb250ZW50ID0gdnNwLnVybFxuICAgICAgdG1wbC5mZWVSYXRlLnRleHRDb250ZW50ID0gdnNwLmZlZVBlcmNlbnRhZ2UudG9GaXhlZCgyKVxuICAgICAgdG1wbC52b3RpbmcudGV4dENvbnRlbnQgPSBTdHJpbmcodnNwLnZvdGluZylcbiAgICAgIERvYy5iaW5kKHJvdywgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBEb2MuaGlkZShwYWdlLnN0YWtpbmdFcnIpXG4gICAgICAgIHRoaXMuc2V0VlNQKGFzc2V0SUQsIHZzcClcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgc2hvd1B1cmNoYXNlVGlja2V0c0RpYWxvZyAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIHBhZ2UucHVyY2hhc2VySW5wdXQudmFsdWUgPSAnJ1xuICAgIERvYy5oaWRlKHBhZ2UucHVyY2hhc2VyRXJyKVxuICAgIHRoaXMuc2hvd0Zvcm0odGhpcy5wYWdlLnB1cmNoYXNlVGlja2V0c0Zvcm0pXG4gICAgcGFnZS5wdXJjaGFzZXJJbnB1dC5mb2N1cygpXG4gIH1cblxuICBwdXJjaGFzZXJJbnB1dENoYW5nZWQgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBuID0gcGFyc2VJbnQocGFnZS5wdXJjaGFzZXJJbnB1dC52YWx1ZSB8fCAnMCcpXG4gICAgaWYgKG4gPD0gMSkge1xuICAgICAgcGFnZS5wdXJjaGFzZXJJbnB1dC52YWx1ZSA9ICcxJ1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHBhZ2UucHVyY2hhc2VySW5wdXQudmFsdWUgPSBTdHJpbmcobilcbiAgfVxuXG4gIGFzeW5jIHB1cmNoYXNlVGlja2V0cyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzZWxlY3RlZEFzc2V0SUQ6IGFzc2V0SUQgfSA9IHRoaXNcbiAgICAvLyBEUkFGVCBOT1RFOiBUaGUgdXNlciB3aWxsIGdldCBhbiBhY3R1YWwgdGlja2V0IGNvdW50IHNvbWV3aGVyZSBpbiB0aGVcbiAgICAvLyByYW5nZSAxIDw9IHRpY2tldHNfcHVyY2hhc2VkIDw9IG4uIFNlZSBub3RlcyBpblxuICAgIC8vICgqc3B2V2FsbGV0KS5QdXJjaGFzZVRpY2tldHMuXG4gICAgLy8gSG93IGRvIHdlIGhhbmRsZSB0aGlzIGF0IHRoZSBVSS4gT3IgZG8gd2UgaGFuZGxlIGl0IGFsbCBpbiB0aGUgYmFja2VuZFxuICAgIC8vIHNvbWVob3c/XG4gICAgY29uc3QgbiA9IHBhcnNlSW50KHBhZ2UucHVyY2hhc2VySW5wdXQudmFsdWUgfHwgJzAnKVxuICAgIGlmIChuIDwgMSkgcmV0dXJuXG4gICAgLy8gVE9ETzogQWRkIGNvbmZpcm1hdGlvbiBkaWFsb2cuXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnB1cmNoYXNlVGlja2V0c0Zvcm0pXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS9wdXJjaGFzZXRpY2tldHMnLCB7IGFzc2V0SUQsIG4gfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLnB1cmNoYXNlckVyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIERvYy5zaG93KHBhZ2UucHVyY2hhc2VyRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuc2hvd1N1Y2Nlc3MoaW50bC5wcmVwKGludGwuSURfVElDS0VUU19QVVJDSEFTRUQsIHsgbjogbi50b0xvY2FsZVN0cmluZyhEb2MubGFuZ3VhZ2VzKCkpIH0pKVxuICB9XG5cbiAgcHJvY2Vzc1RpY2tldFB1cmNoYXNlVXBkYXRlICh3YWxsZXROb3RlOiBDdXN0b21XYWxsZXROb3RlKSB7XG4gICAgY29uc3QgeyBzdGFrZVN0YXR1cywgc2VsZWN0ZWRBc3NldElELCBwYWdlIH0gPSB0aGlzXG4gICAgY29uc3QgeyBhc3NldElEIH0gPSB3YWxsZXROb3RlXG4gICAgY29uc3QgeyBlcnIsIHJlbWFpbmluZywgdGlja2V0cywgc3RhdHMgfSA9IHdhbGxldE5vdGUucGF5bG9hZCBhcyBUaWNrZXRQdXJjaGFzZVVwZGF0ZVxuICAgIGlmIChhc3NldElEICE9PSBzZWxlY3RlZEFzc2V0SUQpIHJldHVyblxuICAgIGlmIChlcnIpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UucHVyY2hhc2VUaWNrZXRzRXJyQm94KVxuICAgICAgcGFnZS5wdXJjaGFzZVRpY2tldHNFcnIudGV4dENvbnRlbnQgPSBlcnJcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAodGlja2V0cykgc3Rha2VTdGF0dXMudGlja2V0cyA9IHRpY2tldHMuY29uY2F0KHN0YWtlU3RhdHVzLnRpY2tldHMpXG4gICAgaWYgKHN0YXRzKSB0aGlzLnVwZGF0ZVRpY2tldFN0YXRzKHN0YXRzLCBhcHAoKS5hc3NldHNbYXNzZXRJRF0udW5pdEluZm8pXG4gICAgc3Rha2VTdGF0dXMuc3RhdHMucXVldWVkID0gcmVtYWluaW5nXG4gICAgcGFnZS5xdWV1ZWRUaWNrZXRDb3VudC50ZXh0Q29udGVudCA9IFN0cmluZyhyZW1haW5pbmcpXG4gICAgcGFnZS5mb3JtUXVldWVkVGl4LnRleHRDb250ZW50ID0gU3RyaW5nKHJlbWFpbmluZylcbiAgICBEb2Muc2V0VmlzKHJlbWFpbmluZyA+IDAsIHBhZ2UucXVldWVkVGlja2V0Q291bnRCb3gpXG4gIH1cblxuICBhc3luYyBzZXRWU1AgKGFzc2V0SUQ6IG51bWJlciwgdnNwOiBWb3RpbmdTZXJ2aWNlUHJvdmlkZXIpIHtcbiAgICB0aGlzLmNsb3NlUG9wdXBzKClcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnN0YWtpbmdCb3gpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS9zZXR2c3AnLCB7IGFzc2V0SUQsIHVybDogdnNwLnVybCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93KHBhZ2Uuc3Rha2luZ0VycilcbiAgICAgIHBhZ2Uuc3Rha2luZ0Vyci50ZXh0Q29udGVudCA9IHJlcy5tc2dcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICB0aGlzLnNldFZTUFZpeih2c3AudXJsKVxuICB9XG5cbiAgc2V0Q3VzdG9tVlNQICgpIHtcbiAgICBjb25zdCBhc3NldElEID0gdGhpcy5zZWxlY3RlZEFzc2V0SURcbiAgICBjb25zdCB2c3AgPSB7IHVybDogdGhpcy5wYWdlLmN1c3RvbVZzcFVybC52YWx1ZSB9IGFzIFZvdGluZ1NlcnZpY2VQcm92aWRlclxuICAgIHRoaXMuc2V0VlNQKGFzc2V0SUQsIHZzcClcbiAgfVxuXG4gIHBhZ2VPZlRpY2tldHMgKHBnTnVtOiBudW1iZXIpIHtcbiAgICBjb25zdCB7IHN0YWtlU3RhdHVzLCB0aWNrZXRQYWdlIH0gPSB0aGlzXG4gICAgbGV0IHN0YXJ0T2Zmc2V0ID0gcGdOdW0gKiB0aWNrZXRQYWdlU2l6ZVxuICAgIGNvbnN0IHBhZ2VPZlRpY2tldHM6IFRpY2tldFtdID0gW11cbiAgICBpZiAoc3RhcnRPZmZzZXQgPCBzdGFrZVN0YXR1cy50aWNrZXRzLmxlbmd0aCkge1xuICAgICAgcGFnZU9mVGlja2V0cy5wdXNoKC4uLnN0YWtlU3RhdHVzLnRpY2tldHMuc2xpY2Uoc3RhcnRPZmZzZXQsIHN0YXJ0T2Zmc2V0ICsgdGlja2V0UGFnZVNpemUpKVxuICAgICAgaWYgKHBhZ2VPZlRpY2tldHMubGVuZ3RoIDwgdGlja2V0UGFnZVNpemUpIHtcbiAgICAgICAgY29uc3QgbmVlZCA9IHRpY2tldFBhZ2VTaXplIC0gcGFnZU9mVGlja2V0cy5sZW5ndGhcbiAgICAgICAgcGFnZU9mVGlja2V0cy5wdXNoKC4uLnRpY2tldFBhZ2UuaGlzdG9yeS5zbGljZSgwLCBuZWVkKSlcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc3RhcnRPZmZzZXQgLT0gc3Rha2VTdGF0dXMudGlja2V0cy5sZW5ndGhcbiAgICAgIHBhZ2VPZlRpY2tldHMucHVzaCguLi50aWNrZXRQYWdlLmhpc3Rvcnkuc2xpY2Uoc3RhcnRPZmZzZXQsIHN0YXJ0T2Zmc2V0ICsgdGlja2V0UGFnZVNpemUpKVxuICAgIH1cbiAgICByZXR1cm4gcGFnZU9mVGlja2V0c1xuICB9XG5cbiAgZGlzcGxheVRpY2tldFBhZ2UgKHBhZ2VOdW1iZXI6IG51bWJlciwgcGFnZU9mVGlja2V0czogVGlja2V0W10pIHtcbiAgICBjb25zdCB7IHBhZ2UsIHNlbGVjdGVkQXNzZXRJRDogYXNzZXRJRCB9ID0gdGhpc1xuICAgIGNvbnN0IHVpID0gYXBwKCkudW5pdEluZm8oYXNzZXRJRClcbiAgICBjb25zdCBjb2luTGluayA9IENvaW5FeHBsb3JlcnNbYXNzZXRJRF1bYXBwKCkudXNlci5uZXRdXG4gICAgRG9jLmVtcHR5KHBhZ2UudGlja2V0SGlzdG9yeVJvd3MpXG4gICAgcGFnZS50aWNrZXRIaXN0b3J5UGFnZS50ZXh0Q29udGVudCA9IFN0cmluZyhwYWdlTnVtYmVyKVxuICAgIGZvciAoY29uc3QgeyB0eCwgc3RhdHVzIH0gb2YgcGFnZU9mVGlja2V0cykge1xuICAgICAgY29uc3QgdHIgPSBwYWdlLnRpY2tldEhpc3RvcnlSb3dUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgcGFnZS50aWNrZXRIaXN0b3J5Um93cy5hcHBlbmRDaGlsZCh0cilcbiAgICAgIGFwcCgpLmJpbmRVcmxIYW5kbGVycyh0cilcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZSh0cilcbiAgICAgIHRtcGwuYWdlLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZSh0eC5zdGFtcCAqIDEwMDApXG4gICAgICB0bXBsLnByaWNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24odHgudGlja2V0UHJpY2UsIHVpKVxuICAgICAgdG1wbC5zdGF0dXMudGV4dENvbnRlbnQgPSBpbnRsLnByZXAodGlja2V0U3RhdHVzVHJhbnNsYXRpb25LZXlzW3N0YXR1c10pXG4gICAgICB0bXBsLmhhc2hTdGFydC50ZXh0Q29udGVudCA9IHR4Lmhhc2guc2xpY2UoMCwgNilcbiAgICAgIHRtcGwuaGFzaEVuZC50ZXh0Q29udGVudCA9IHR4Lmhhc2guc2xpY2UoLTYpXG4gICAgICB0bXBsLmRldGFpbHNMaW5rVXJsLnNldEF0dHJpYnV0ZSgnaHJlZicsIGNvaW5MaW5rKHR4Lmhhc2gpKVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHRpY2tldFBhZ2VOIChwYWdlTnVtYmVyOiBudW1iZXIpIHtcbiAgICBjb25zdCB7IHBhZ2UsIHN0YWtlU3RhdHVzLCB0aWNrZXRQYWdlLCBzZWxlY3RlZEFzc2V0SUQ6IGFzc2V0SUQgfSA9IHRoaXNcbiAgICBjb25zdCBwYWdlT2ZUaWNrZXRzID0gdGhpcy5wYWdlT2ZUaWNrZXRzKHBhZ2VOdW1iZXIpXG4gICAgaWYgKHBhZ2VPZlRpY2tldHMubGVuZ3RoIDwgdGlja2V0UGFnZVNpemUgJiYgIXRpY2tldFBhZ2Uuc2Nhbm5lZCkge1xuICAgICAgY29uc3QgbiA9IHRpY2tldFBhZ2VTaXplIC0gcGFnZU9mVGlja2V0cy5sZW5ndGhcbiAgICAgIGNvbnN0IGxhc3RMaXN0ID0gdGlja2V0UGFnZS5oaXN0b3J5Lmxlbmd0aCA+IDAgPyB0aWNrZXRQYWdlLmhpc3RvcnkgOiBzdGFrZVN0YXR1cy50aWNrZXRzXG4gICAgICBjb25zdCBzY2FuU3RhcnQgPSBsYXN0TGlzdC5sZW5ndGggPiAwID8gbGFzdExpc3RbbGFzdExpc3QubGVuZ3RoIC0gMV0udHguYmxvY2tIZWlnaHQgOiBzY2FuU3RhcnRNZW1wb29sXG4gICAgICBjb25zdCBza2lwTiA9IGxhc3RMaXN0LmZpbHRlcigodGt0OiBUaWNrZXQpID0+IHRrdC50eC5ibG9ja0hlaWdodCA9PT0gc2NhblN0YXJ0KS5sZW5ndGhcbiAgICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS50aWNrZXRIaXN0b3J5Rm9ybSlcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuc2FmZVBvc3QoJy9hcGkvdGlja2V0cGFnZScsIHsgYXNzZXRJRCwgc2NhblN0YXJ0LCBuLCBza2lwTiB9KVxuICAgICAgbG9hZGVkKClcbiAgICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2Vycm9yIGZldGNoaW5nIHRpY2tldCBwYWdlJywgcmVzLm1zZylcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICB0aGlzLnRpY2tldFBhZ2UuaGlzdG9yeS5wdXNoKC4uLnJlcy50aWNrZXRzKVxuICAgICAgcGFnZU9mVGlja2V0cy5wdXNoKC4uLnJlcy50aWNrZXRzKVxuICAgICAgaWYgKHJlcy50aWNrZXRzLmxlbmd0aCA8IG4pIHRoaXMudGlja2V0UGFnZS5zY2FubmVkID0gdHJ1ZVxuICAgIH1cblxuICAgIGNvbnN0IHRvdGFsVGl4ID0gc3Rha2VTdGF0dXMudGlja2V0cy5sZW5ndGggKyB0aWNrZXRQYWdlLmhpc3RvcnkubGVuZ3RoXG4gICAgRG9jLnNldFZpcyh0b3RhbFRpeCA+PSB0aWNrZXRQYWdlU2l6ZSwgcGFnZS50aWNrZXRIaXN0b3J5UGFnaW5hdGlvbilcbiAgICBEb2Muc2V0VmlzKHRvdGFsVGl4ID4gMCwgcGFnZS50aWNrZXRIaXN0b3J5VGFibGUpXG4gICAgRG9jLnNldFZpcyh0b3RhbFRpeCA9PT0gMCwgcGFnZS5ub1RpY2tldHNNZXNzYWdlKVxuICAgIGlmIChwYWdlT2ZUaWNrZXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8gUHJvYmFibHkgZW5kZWQgd2l0aCBhIHBhZ2Ugb2Ygc2l6ZSB0aWNrZXRQYWdlU2l6ZSwgc28gZGlkbid0IGtub3cgd2VcbiAgICAgIC8vIGhhZCBoaXQgdGhlIGVuZCB1bnRpbCB0aGUgdXNlciBjbGlja2VkIHRoZSBhcnJvdyBhbmQgd2Ugd2VudCBsb29raW5nXG4gICAgICAvLyBmb3IgdGhlIG5leHQuIFdvdWxkIGJlIGdvb2QgdG8gZmlndXJlIG91dCBhIHdheSB0byBoaWRlIHRoZSBhcnJvdyBpblxuICAgICAgLy8gdGhhdCBjYXNlLlxuICAgICAgRG9jLmhpZGUocGFnZS50aWNrZXRIaXN0b3J5TmV4dFBhZ2UpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5kaXNwbGF5VGlja2V0UGFnZShwYWdlTnVtYmVyLCBwYWdlT2ZUaWNrZXRzKVxuICAgIHRpY2tldFBhZ2UubnVtYmVyID0gcGFnZU51bWJlclxuICAgIGNvbnN0IGF0RW5kID0gcGFnZU51bWJlciAqIHRpY2tldFBhZ2VTaXplICsgcGFnZU9mVGlja2V0cy5sZW5ndGggPT09IHRvdGFsVGl4XG4gICAgRG9jLnNldFZpcyghYXRFbmQgfHwgIXRpY2tldFBhZ2Uuc2Nhbm5lZCwgcGFnZS50aWNrZXRIaXN0b3J5TmV4dFBhZ2UpXG4gICAgRG9jLnNldFZpcyhwYWdlTnVtYmVyID4gMCwgcGFnZS50aWNrZXRIaXN0b3J5UHJldlBhZ2UpXG4gIH1cblxuICBhc3luYyBzaG93VGlja2V0SGlzdG9yeSAoKSB7XG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UudGlja2V0SGlzdG9yeUZvcm0pXG4gICAgYXdhaXQgdGhpcy50aWNrZXRQYWdlTih0aGlzLnRpY2tldFBhZ2UubnVtYmVyKVxuICB9XG5cbiAgYXN5bmMgbmV4dFRpY2tldFBhZ2UgKCkge1xuICAgIGF3YWl0IHRoaXMudGlja2V0UGFnZU4odGhpcy50aWNrZXRQYWdlLm51bWJlciArIDEpXG4gIH1cblxuICBhc3luYyBwcmV2VGlja2V0UGFnZSAoKSB7XG4gICAgYXdhaXQgdGhpcy50aWNrZXRQYWdlTih0aGlzLnRpY2tldFBhZ2UubnVtYmVyIC0gMSlcbiAgfVxuXG4gIHNob3dTZXRWb3Rlc0RpYWxvZyAoKSB7XG4gICAgY29uc3QgeyBwYWdlLCBzdGFrZVN0YXR1cywgc2VsZWN0ZWRBc3NldElEOiBhc3NldElEIH0gPSB0aGlzXG4gICAgY29uc3QgdWkgPSBhcHAoKS51bml0SW5mbyhhc3NldElEKVxuICAgIERvYy5oaWRlKHBhZ2Uudm90aW5nRm9ybUVycilcbiAgICBjb25zdCBjb2luTGluayA9IENvaW5FeHBsb3JlcnNbYXNzZXRJRF1bYXBwKCkudXNlci5uZXRdXG4gICAgY29uc3QgdXBwZXJDYXNlID0gKHM6IHN0cmluZykgPT4gcy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHMuc2xpY2UoMSlcblxuICAgIGNvbnN0IHNldFZvdGVzID0gYXN5bmMgKHJlcTogYW55KSA9PiB7XG4gICAgICBEb2MuaGlkZShwYWdlLnZvdGluZ0Zvcm1FcnIpXG4gICAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2Uudm90aW5nRm9ybSlcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuc2FmZVBvc3QoJy9hcGkvc2V0dm90ZXMnLCByZXEpXG4gICAgICBsb2FkZWQoKVxuICAgICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgICAgRG9jLnNob3cocGFnZS52b3RpbmdGb3JtRXJyKVxuICAgICAgICBwYWdlLnZvdGluZ0Zvcm1FcnIudGV4dENvbnRlbnQgPSByZXMubXNnXG4gICAgICAgIHRocm93IEVycm9yKHJlcy5tc2cpXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgc2V0QWdlbmRhQ2hvaWNlID0gYXN5bmMgKGFnZW5kYUlEOiBzdHJpbmcsIGNob2ljZUlEOiBzdHJpbmcpID0+IHtcbiAgICAgIGF3YWl0IHNldFZvdGVzKHsgYXNzZXRJRCwgY2hvaWNlczogeyBbYWdlbmRhSURdOiBjaG9pY2VJRCB9IH0pXG4gICAgICBmb3IgKGNvbnN0IGFnZW5kYSBvZiBzdGFrZVN0YXR1cy5zdGFuY2VzLmFnZW5kYXMpIGlmIChhZ2VuZGEuaWQgPT09IGFnZW5kYUlEKSBhZ2VuZGEuY3VycmVudENob2ljZSA9IGNob2ljZUlEXG4gICAgfVxuXG4gICAgRG9jLmVtcHR5KHBhZ2Uudm90aW5nQWdlbmRhcylcbiAgICBmb3IgKGNvbnN0IGFnZW5kYSBvZiBzdGFrZVN0YXR1cy5zdGFuY2VzLmFnZW5kYXMpIHtcbiAgICAgIGNvbnN0IGRpdiA9IHBhZ2Uudm90aW5nQWdlbmRhVG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICAgIHBhZ2Uudm90aW5nQWdlbmRhcy5hcHBlbmRDaGlsZChkaXYpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgICAgdG1wbC5kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGFnZW5kYS5kZXNjcmlwdGlvblxuICAgICAgZm9yIChjb25zdCBjaG9pY2Ugb2YgYWdlbmRhLmNob2ljZXMpIHtcbiAgICAgICAgY29uc3QgZGl2ID0gcGFnZS52b3RpbmdDaG9pY2VUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgICB0bXBsLmNob2ljZXMuYXBwZW5kQ2hpbGQoZGl2KVxuICAgICAgICBjb25zdCBjaG9pY2VUbXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgICAgICBjaG9pY2VUbXBsLmlkLnRleHRDb250ZW50ID0gdXBwZXJDYXNlKGNob2ljZS5pZClcbiAgICAgICAgY2hvaWNlVG1wbC5pZC5kYXRhc2V0LnRvb2x0aXAgPSBjaG9pY2UuZGVzY3JpcHRpb25cbiAgICAgICAgY2hvaWNlVG1wbC5yYWRpby52YWx1ZSA9IGNob2ljZS5pZFxuICAgICAgICBjaG9pY2VUbXBsLnJhZGlvLm5hbWUgPSBhZ2VuZGEuaWRcbiAgICAgICAgRG9jLmJpbmQoY2hvaWNlVG1wbC5yYWRpbywgJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICBpZiAoIWNob2ljZVRtcGwucmFkaW8uY2hlY2tlZCkgcmV0dXJuXG4gICAgICAgICAgc2V0QWdlbmRhQ2hvaWNlKGFnZW5kYS5pZCwgY2hvaWNlLmlkKVxuICAgICAgICB9KVxuICAgICAgICBpZiAoY2hvaWNlLmlkID09PSBhZ2VuZGEuY3VycmVudENob2ljZSkgY2hvaWNlVG1wbC5yYWRpby5jaGVja2VkID0gdHJ1ZVxuICAgICAgfVxuICAgICAgYXBwKCkuYmluZFRvb2x0aXBzKHRtcGwuY2hvaWNlcylcbiAgICB9XG5cbiAgICBjb25zdCBzZXRUc3BlbmRWb3RlID0gYXN5bmMgKHR4SGFzaDogc3RyaW5nLCBwb2xpY3lJRDogc3RyaW5nKSA9PiB7XG4gICAgICBhd2FpdCBzZXRWb3Rlcyh7IGFzc2V0SUQsIHRTcGVuZFBvbGljeTogeyBbdHhIYXNoXTogcG9saWN5SUQgfSB9KVxuICAgICAgZm9yIChjb25zdCB0c3BlbmQgb2Ygc3Rha2VTdGF0dXMuc3RhbmNlcy50c3BlbmRzKSBpZiAodHNwZW5kLmhhc2ggPT09IHR4SGFzaCkgdHNwZW5kLmN1cnJlbnRQb2xpY3kgPSBwb2xpY3lJRFxuICAgIH1cblxuICAgIERvYy5lbXB0eShwYWdlLnZvdGluZ1RzcGVuZHMpXG4gICAgZm9yIChjb25zdCB0c3BlbmQgb2Ygc3Rha2VTdGF0dXMuc3RhbmNlcy50c3BlbmRzKSB7XG4gICAgICBjb25zdCBkaXYgPSBwYWdlLnRzcGVuZFRtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgICBwYWdlLnZvdGluZ1RzcGVuZHMuYXBwZW5kQ2hpbGQoZGl2KVxuICAgICAgYXBwKCkuYmluZFVybEhhbmRsZXJzKGRpdilcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShkaXYpXG4gICAgICBmb3IgKGNvbnN0IG9wdCBvZiBbdG1wbC55ZXMsIHRtcGwubm9dKSB7XG4gICAgICAgIG9wdC5uYW1lID0gdHNwZW5kLmhhc2hcbiAgICAgICAgaWYgKHRzcGVuZC5jdXJyZW50UG9saWN5ID09PSBvcHQudmFsdWUpIG9wdC5jaGVja2VkID0gdHJ1ZVxuICAgICAgICBEb2MuYmluZChvcHQsICdjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgaWYgKCFvcHQuY2hlY2tlZCkgcmV0dXJuXG4gICAgICAgICAgc2V0VHNwZW5kVm90ZSh0c3BlbmQuaGFzaCwgb3B0LnZhbHVlID8/ICcnKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgaWYgKHRzcGVuZC52YWx1ZSA+IDApIHRtcGwudmFsdWUudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Rm91clNpZ0ZpZ3ModHNwZW5kLnZhbHVlIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgICBlbHNlIERvYy5oaWRlKHRtcGwudmFsdWUpXG4gICAgICB0bXBsLmhhc2gudGV4dENvbnRlbnQgPSB0c3BlbmQuaGFzaFxuICAgICAgdG1wbC5leHBsb3Jlckxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgY29pbkxpbmsodHNwZW5kLmhhc2gpKVxuICAgIH1cblxuICAgIGNvbnN0IHNldFRLZXlQb2xpY3kgPSBhc3luYyAoa2V5OiBzdHJpbmcsIHBvbGljeTogc3RyaW5nKSA9PiB7XG4gICAgICBhd2FpdCBzZXRWb3Rlcyh7IGFzc2V0SUQsIHRyZWFzdXJ5UG9saWN5OiB7IFtrZXldOiBwb2xpY3kgfSB9KVxuICAgICAgZm9yIChjb25zdCB0a2V5IG9mIHN0YWtlU3RhdHVzLnN0YW5jZXMudHJlYXN1cnlLZXlzKSBpZiAodGtleS5rZXkgPT09IGtleSkgdGtleS5wb2xpY3kgPSBwb2xpY3lcbiAgICB9XG5cbiAgICBEb2MuZW1wdHkocGFnZS52b3RpbmdUS2V5cylcbiAgICBmb3IgKGNvbnN0IGtleVBvbGljeSBvZiAoc3Rha2VTdGF0dXMuc3RhbmNlcy50cmVhc3VyeUtleXMgPz8gW10pKSB7XG4gICAgICBjb25zdCBkaXYgPSBwYWdlLnRrZXlUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgcGFnZS52b3RpbmdUS2V5cy5hcHBlbmRDaGlsZChkaXYpXG4gICAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUoZGl2KVxuICAgICAgZm9yIChjb25zdCBvcHQgb2YgW3RtcGwueWVzLCB0bXBsLm5vXSkge1xuICAgICAgICBvcHQubmFtZSA9IGtleVBvbGljeS5rZXlcbiAgICAgICAgaWYgKGtleVBvbGljeS5wb2xpY3kgPT09IG9wdC52YWx1ZSkgb3B0LmNoZWNrZWQgPSB0cnVlXG4gICAgICAgIERvYy5iaW5kKG9wdCwgJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICBpZiAoIW9wdC5jaGVja2VkKSByZXR1cm5cbiAgICAgICAgICBzZXRUS2V5UG9saWN5KGtleVBvbGljeS5rZXksIG9wdC52YWx1ZSA/PyAnJylcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICAgIHRtcGwua2V5LnRleHRDb250ZW50ID0ga2V5UG9saWN5LmtleVxuICAgIH1cblxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS52b3RpbmdGb3JtKVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlUHJpdmFjeSAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgZGlzYWJsZVByaXZhY3kgPSBhcHAoKS5leHRlbnNpb25XYWxsZXQoYXNzZXRJRCk/LmRpc2FibGVQcml2YWN5XG4gICAgdGhpcy5taXhpbmcgPSBmYWxzZVxuICAgIGNvbnN0IHsgd2FsbGV0IH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5taXhpbmdCb3gsIHBhZ2UubWl4ZXJPZmYsIHBhZ2UubWl4ZXJPbilcbiAgICAvLyBUT0RPOiBTaG93IHNwZWNpYWwgbWVzc2FnaW5nIGlmIHRoZSBhc3NldCBzdXBwb3J0cyBtaXhpbmcgYnV0IG5vdCB0aGlzXG4gICAgLy8gd2FsbGV0IHR5cGUuXG4gICAgaWYgKGRpc2FibGVQcml2YWN5IHx8ICF3YWxsZXQ/LnJ1bm5pbmcgfHwgKHdhbGxldC50cmFpdHMgJiB0cmFpdEZ1bmRzTWl4ZXIpID09PSAwKSByZXR1cm5cbiAgICBEb2Muc2hvdyhwYWdlLm1peGluZ0JveCwgcGFnZS5taXhlckxvYWRpbmcpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5zYWZlUG9zdCgnL2FwaS9taXhpbmdzdGF0cycsIHsgYXNzZXRJRCB9KVxuICAgIERvYy5oaWRlKHBhZ2UubWl4ZXJMb2FkaW5nKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLm1peGluZ0VycilcbiAgICAgIHBhZ2UubWl4aW5nRXJyLnRleHRDb250ZW50ID0gcmVzLm1zZ1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5taXhpbmcgPSByZXMuc3RhdHMuZW5hYmxlZCBhcyBib29sZWFuXG4gICAgaWYgKHRoaXMubWl4aW5nKSBEb2Muc2hvdyhwYWdlLm1peGVyT24pXG4gICAgZWxzZSBEb2Muc2hvdyhwYWdlLm1peGVyT2ZmKVxuICAgIHRoaXMubWl4ZXJUb2dnbGUuc2V0U3RhdGUodGhpcy5taXhpbmcpXG4gIH1cblxuICBhc3luYyB1cGRhdGVNaXhlclN0YXRlIChvbjogYm9vbGVhbikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLm1peGluZ0VycilcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UubWl4aW5nQm94KVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL2NvbmZpZ3VyZW1peGVyJywgeyBhc3NldElEOiB0aGlzLnNlbGVjdGVkQXNzZXRJRCwgZW5hYmxlZDogb24gfSlcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBwYWdlLm1peGluZ0Vyci50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0FQSV9FUlJPUiwgeyBtc2c6IHJlcy5tc2cgfSlcbiAgICAgIERvYy5zaG93KHBhZ2UubWl4aW5nRXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zZXRWaXMob24sIHBhZ2UubWl4ZXJPbilcbiAgICBEb2Muc2V0VmlzKCFvbiwgcGFnZS5taXhlck9mZilcbiAgICB0aGlzLm1peGVyVG9nZ2xlLnNldFN0YXRlKG9uKVxuICB9XG5cbiAgdXBkYXRlRGlzcGxheWVkQXNzZXRCYWxhbmNlICgpOiB2b2lkIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgY29uc3QgeyB3YWxsZXQsIHVuaXRJbmZvOiB1aSwgaWQ6IGFzc2V0SUQgfSA9IGFzc2V0XG4gICAgY29uc3QgYmFsID0gd2FsbGV0LmJhbGFuY2VcbiAgICBEb2Muc2hvdyhwYWdlLmJhbGFuY2VCb3gsIHBhZ2Uud2FsbGV0RGV0YWlscylcbiAgICBjb25zdCB0b3RhbExvY2tlZCA9IGJhbC5sb2NrZWQgKyBiYWwuY29udHJhY3Rsb2NrZWQgKyBiYWwuYm9uZGxvY2tlZFxuICAgIGNvbnN0IHRvdGFsQmFsYW5jZSA9IGJhbC5hdmFpbGFibGUgKyB0b3RhbExvY2tlZCArIGJhbC5pbW1hdHVyZVxuICAgIHBhZ2UuYmFsYW5jZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUodG90YWxCYWxhbmNlLCB1aSlcbiAgICBwYWdlLmJhbGFuY2VVbml0LnRleHRDb250ZW50ID0gdWkuY29udmVudGlvbmFsLnVuaXRcbiAgICBjb25zdCByYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Fzc2V0SURdXG4gICAgaWYgKHJhdGUpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UuZmlhdEJhbGFuY2VCb3gpXG4gICAgICBwYWdlLmZpYXRCYWxhbmNlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZpYXRDb252ZXJzaW9uKHRvdGFsQmFsYW5jZSwgcmF0ZSwgdWkpXG4gICAgfVxuICAgIERvYy5lbXB0eShwYWdlLmJhbGFuY2VEZXRhaWxCb3gpXG5cbiAgICBjb25zdCBhZGRCYWxhbmNlUm93ID0gKGNhdDogc3RyaW5nLCBiYWw6IG51bWJlciwgdG9vbHRpcE1zZz86IHN0cmluZykgPT4ge1xuICAgICAgY29uc3Qgcm93ID0gcGFnZS5iYWxhbmNlRGV0YWlsUm93LmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgcGFnZS5iYWxhbmNlRGV0YWlsQm94LmFwcGVuZENoaWxkKHJvdylcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICB0bXBsLm5hbWUudGV4dENvbnRlbnQgPSBjYXRcbiAgICAgIGlmICh0b29sdGlwTXNnKSB7XG4gICAgICAgIHRtcGwudG9vbHRpcE1zZy5kYXRhc2V0LnRvb2x0aXAgPSB0b29sdGlwTXNnXG4gICAgICAgIERvYy5zaG93KHRtcGwudG9vbHRpcE1zZylcbiAgICAgIH1cbiAgICAgIHRtcGwuYmFsYW5jZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRDb2luVmFsdWUoYmFsLCB1aSlcbiAgICAgIHJldHVybiByb3dcbiAgICB9XG5cbiAgICBsZXQgbGFzdFN1YkxvY2tlZFJvdzogUGFnZUVsZW1lbnQgfCB1bmRlZmluZWRcbiAgICBsZXQgbGFzdFByaW1hcnlSb3c6IFBhZ2VFbGVtZW50IHwgdW5kZWZpbmVkXG4gICAgY29uc3QgYWRkUHJpbWFyeUJhbGFuY2UgPSAoY2F0OiBzdHJpbmcsIGJhbDogbnVtYmVyLCB0b29sdGlwTXNnPzogc3RyaW5nKSA9PiB7XG4gICAgICBsYXN0U3ViTG9ja2VkUm93ID0gdW5kZWZpbmVkXG4gICAgICBsYXN0UHJpbWFyeVJvdyA9IGFkZEJhbGFuY2VSb3coY2F0LCBiYWwsIHRvb2x0aXBNc2cpXG4gICAgfVxuICAgIGNvbnN0IGFkZFN1YkJhbGFuY2UgPSAoY2F0OiBzdHJpbmcsIGJhbDogbnVtYmVyLCB0b29sdGlwTXNnPzogc3RyaW5nKSA9PiB7XG4gICAgICBsYXN0U3ViTG9ja2VkUm93ID0gYWRkQmFsYW5jZVJvdyhjYXQsIGJhbCwgdG9vbHRpcE1zZylcbiAgICAgIGxhc3RTdWJMb2NrZWRSb3cuY2xhc3NMaXN0LmFkZCgnc3ViJylcbiAgICB9XG4gICAgY29uc3Qgc2V0Um93Q2xhc3NlcyA9ICgpID0+IHtcbiAgICAgIGlmICghbGFzdFN1YkxvY2tlZFJvdykgcmV0dXJuXG4gICAgICAobGFzdFByaW1hcnlSb3cgYXMgUGFnZUVsZW1lbnQpLmNsYXNzTGlzdC5hZGQoJ2l0ZW1pemVkJylcbiAgICAgIGxhc3RTdWJMb2NrZWRSb3cuY2xhc3NMaXN0LmFkZCgnbGFzdCcpXG4gICAgfVxuXG4gICAgYWRkUHJpbWFyeUJhbGFuY2UoaW50bC5wcmVwKGludGwuSURfQVZBSUxBQkxFX1RJVExFKSwgYmFsLmF2YWlsYWJsZSwgJycpXG4gICAgaWYgKGJhbC5vdGhlcj8uU2hpZWxkZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgdHJhbnNwYXJlbnQgPSBiYWwuYXZhaWxhYmxlIC0gYmFsLm90aGVyLlNoaWVsZGVkLmFtdFxuICAgICAgYWRkU3ViQmFsYW5jZShpbnRsLnByZXAoaW50bC5JRF9UUkFOU1BBUkVOVCksIHRyYW5zcGFyZW50KVxuICAgICAgYWRkU3ViQmFsYW5jZShpbnRsLnByZXAoaW50bC5JRF9TSElFTERFRCksIGJhbC5vdGhlci5TaGllbGRlZC5hbXQpXG4gICAgfVxuICAgIHNldFJvd0NsYXNzZXMoKVxuXG4gICAgYWRkUHJpbWFyeUJhbGFuY2UoaW50bC5wcmVwKGludGwuSURfTE9DS0VEX1RJVExFKSwgdG90YWxMb2NrZWQsIGludGwucHJlcChpbnRsLklEX0xPQ0tFRF9CQUxfTVNHKSlcbiAgICBpZiAoYmFsLm9yZGVybG9ja2VkID4gMCkgYWRkU3ViQmFsYW5jZShpbnRsLnByZXAoaW50bC5JRF9PUkRFUiksIGJhbC5vcmRlcmxvY2tlZCwgaW50bC5wcmVwKGludGwuSURfTE9DS0VEX09SREVSX0JBTF9NU0cpKVxuICAgIGlmIChiYWwuY29udHJhY3Rsb2NrZWQgPiAwKSBhZGRTdWJCYWxhbmNlKGludGwucHJlcChpbnRsLklEX1NXQVBQSU5HKSwgYmFsLmNvbnRyYWN0bG9ja2VkLCBpbnRsLnByZXAoaW50bC5JRF9MT0NLRURfU1dBUFBJTkdfQkFMX01TRykpXG4gICAgaWYgKGJhbC5ib25kbG9ja2VkID4gMCkgYWRkU3ViQmFsYW5jZShpbnRsLnByZXAoaW50bC5JRF9CT05ERUQpLCBiYWwuYm9uZGxvY2tlZCwgaW50bC5wcmVwKGludGwuSURfTE9DS0VEX0JPTkRfQkFMX01TRykpXG4gICAgaWYgKGJhbC5ib25kUmVzZXJ2ZXMgPiAwKSBhZGRTdWJCYWxhbmNlKGludGwucHJlcChpbnRsLklEX0JPTkRfUkVTRVJWRVMpLCBiYWwuYm9uZFJlc2VydmVzLCBpbnRsLnByZXAoaW50bC5JRF9CT05EX1JFU0VSVkVTX01TRykpXG4gICAgaWYgKGJhbD8ub3RoZXI/LlN0YWtlZCAhPT0gdW5kZWZpbmVkKSBhZGRTdWJCYWxhbmNlKCdTdGFrZWQnLCBiYWwub3RoZXIuU3Rha2VkLmFtdClcbiAgICBzZXRSb3dDbGFzc2VzKClcblxuICAgIGlmIChiYWwuaW1tYXR1cmUpIGFkZFByaW1hcnlCYWxhbmNlKGludGwucHJlcChpbnRsLklEX0lNTUFUVVJFX1RJVExFKSwgYmFsLmltbWF0dXJlLCBpbnRsLnByZXAoaW50bC5JRF9JTU1BVFVSRV9CQUxfTVNHKSlcbiAgICBpZiAoYmFsPy5vdGhlcj8uVW5taXhlZCAhPT0gdW5kZWZpbmVkKSBhZGRTdWJCYWxhbmNlKCdVbm1peGVkJywgYmFsLm90aGVyLlVubWl4ZWQuYW10KVxuICAgIHNldFJvd0NsYXNzZXMoKVxuXG4gICAgLy8gVE9ETzogaGFuZGxlIHJlc2VydmVzIGRlZmljaXQgd2l0aCBhIG5vdGlmaWNhdGlvbi5cbiAgICAvLyBpZiAoYmFsLnJlc2VydmVzRGVmaWNpdCA+IDApIGFkZFByaW1hcnlCYWxhbmNlKGludGwucHJlcChpbnRsLklEX1JFU0VSVkVTX0RFRklDSVQpLCBiYWwucmVzZXJ2ZXNEZWZpY2l0LCBpbnRsLnByZXAoaW50bC5JRF9SRVNFUlZFU19ERUZJQ0lUX01TRykpXG5cbiAgICBwYWdlLnB1cmNoYXNlckJhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhiYWwuYXZhaWxhYmxlIC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgYXBwKCkuYmluZFRvb2x0aXBzKHBhZ2UuYmFsYW5jZURldGFpbEJveClcbiAgfVxuXG4gIHNob3dBdmFpbGFibGVNYXJrZXRzIChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgZXhjaGFuZ2VzID0gYXBwKCkudXNlci5leGNoYW5nZXNcbiAgICBjb25zdCBtYXJrZXRzOiBbc3RyaW5nLCBFeGNoYW5nZSwgTWFya2V0XVtdID0gW11cbiAgICBmb3IgKGNvbnN0IHhjIG9mIE9iamVjdC52YWx1ZXMoZXhjaGFuZ2VzKSkge1xuICAgICAgaWYgKCF4Yy5tYXJrZXRzKSBjb250aW51ZVxuICAgICAgZm9yIChjb25zdCBta3Qgb2YgT2JqZWN0LnZhbHVlcyh4Yy5tYXJrZXRzKSkge1xuICAgICAgICBpZiAobWt0LmJhc2VpZCA9PT0gYXNzZXRJRCB8fCBta3QucXVvdGVpZCA9PT0gYXNzZXRJRCkgbWFya2V0cy5wdXNoKFt4Yy5ob3N0LCB4YywgbWt0XSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzcG90Vm9sdW1lID0gKGFzc2V0SUQ6IG51bWJlciwgbWt0OiBNYXJrZXQpOiBudW1iZXIgPT4ge1xuICAgICAgY29uc3Qgc3BvdCA9IG1rdC5zcG90XG4gICAgICBpZiAoIXNwb3QpIHJldHVybiAwXG4gICAgICBjb25zdCBjb252ZXJzaW9uRmFjdG9yID0gYXBwKCkudW5pdEluZm8oYXNzZXRJRCkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3JcbiAgICAgIGNvbnN0IHZvbHVtZSA9IGFzc2V0SUQgPT09IG1rdC5iYXNlaWQgPyBzcG90LnZvbDI0IDogc3BvdC52b2wyNCAqIHNwb3QucmF0ZSAvIE9yZGVyVXRpbC5SYXRlRW5jb2RpbmdGYWN0b3JcbiAgICAgIHJldHVybiB2b2x1bWUgLyBjb252ZXJzaW9uRmFjdG9yXG4gICAgfVxuXG4gICAgbWFya2V0cy5zb3J0KChhOiBbc3RyaW5nLCBFeGNoYW5nZSwgTWFya2V0XSwgYjogW3N0cmluZywgRXhjaGFuZ2UsIE1hcmtldF0pOiBudW1iZXIgPT4ge1xuICAgICAgY29uc3QgW2hvc3RBLCwgbWt0QV0gPSBhXG4gICAgICBjb25zdCBbaG9zdEIsLCBta3RCXSA9IGJcbiAgICAgIGlmICghbWt0QS5zcG90ICYmICFta3RCLnNwb3QpIHJldHVybiBob3N0QS5sb2NhbGVDb21wYXJlKGhvc3RCKVxuICAgICAgcmV0dXJuIHNwb3RWb2x1bWUoYXNzZXRJRCwgbWt0QikgLSBzcG90Vm9sdW1lKGFzc2V0SUQsIG1rdEEpXG4gICAgfSlcbiAgICBEb2MuZW1wdHkocGFnZS5hdmFpbGFibGVNYXJrZXRzKVxuXG4gICAgZm9yIChjb25zdCBbaG9zdCwgeGMsIG1rdF0gb2YgbWFya2V0cykge1xuICAgICAgY29uc3QgeyBzcG90LCBiYXNlaWQsIGJhc2VzeW1ib2wsIHF1b3RlaWQsIHF1b3Rlc3ltYm9sIH0gPSBta3RcbiAgICAgIGNvbnN0IHJvdyA9IHBhZ2UubWFya2V0Um93LmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgcGFnZS5hdmFpbGFibGVNYXJrZXRzLmFwcGVuZENoaWxkKHJvdylcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShyb3cpXG4gICAgICB0bXBsLmhvc3QudGV4dENvbnRlbnQgPSBob3N0XG4gICAgICB0bXBsLmJhc2VMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChiYXNlc3ltYm9sKVxuICAgICAgdG1wbC5xdW90ZUxvZ28uc3JjID0gRG9jLmxvZ29QYXRoKHF1b3Rlc3ltYm9sKVxuICAgICAgRG9jLmVtcHR5KHRtcGwuYmFzZVN5bWJvbCwgdG1wbC5xdW90ZVN5bWJvbClcbiAgICAgIHRtcGwuYmFzZVN5bWJvbC5hcHBlbmRDaGlsZChEb2Muc3ltYm9saXplKHhjLmFzc2V0c1tiYXNlaWRdLCB0cnVlKSlcbiAgICAgIHRtcGwucXVvdGVTeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZSh4Yy5hc3NldHNbcXVvdGVpZF0sIHRydWUpKVxuXG4gICAgICBpZiAoc3BvdCkge1xuICAgICAgICBjb25zdCBjb252UmF0ZSA9IGFwcCgpLmNvbnZlbnRpb25hbFJhdGUoYmFzZWlkLCBxdW90ZWlkLCBzcG90LnJhdGUsIGV4Y2hhbmdlc1tob3N0XSlcbiAgICAgICAgdG1wbC5wcmljZS50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGb3VyU2lnRmlncyhjb252UmF0ZSlcbiAgICAgICAgY29uc3QgZm10U3ltYm9sID0gKHM6IHN0cmluZykgPT4gcy5zcGxpdCgnLicpWzBdLnRvVXBwZXJDYXNlKClcbiAgICAgICAgdG1wbC5wcmljZVF1b3RlVW5pdC50ZXh0Q29udGVudCA9IGZtdFN5bWJvbChxdW90ZXN5bWJvbClcbiAgICAgICAgdG1wbC5wcmljZUJhc2VVbml0LnRleHRDb250ZW50ID0gZm10U3ltYm9sKGJhc2VzeW1ib2wpXG4gICAgICAgIHRtcGwudm9sdW1lLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZvdXJTaWdGaWdzKHNwb3RWb2x1bWUoYXNzZXRJRCwgbWt0KSlcbiAgICAgICAgdG1wbC52b2x1bWVVbml0LnRleHRDb250ZW50ID0gYXNzZXRJRCA9PT0gYmFzZWlkID8gZm10U3ltYm9sKGJhc2VzeW1ib2wpIDogZm10U3ltYm9sKHF1b3Rlc3ltYm9sKVxuICAgICAgfSBlbHNlIERvYy5oaWRlKHRtcGwucHJpY2VCb3gsIHRtcGwudm9sdW1lQm94KVxuICAgICAgRG9jLmJpbmQocm93LCAnY2xpY2snLCAoKSA9PiBhcHAoKS5sb2FkUGFnZSgnbWFya2V0cycsIHsgaG9zdCwgYmFzZUlEOiBiYXNlaWQsIHF1b3RlSUQ6IHF1b3RlaWQgfSkpXG4gICAgfVxuICAgIHBhZ2UubWFya2V0c092ZXJ2aWV3Qm94LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmlzaWJsZScpXG4gIH1cblxuICBhc3luYyBzaG93UmVjZW50QWN0aXZpdHkgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2Uub3JkZXJBY3Rpdml0eUJveClcbiAgICBjb25zdCBmaWx0ZXI6IE9yZGVyRmlsdGVyID0ge1xuICAgICAgbjogMjAsXG4gICAgICBhc3NldHM6IFthc3NldElEXSxcbiAgICAgIGhvc3RzOiBbXSxcbiAgICAgIHN0YXR1c2VzOiBbXVxuICAgIH1cbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9vcmRlcnMnLCBmaWx0ZXIpXG4gICAgbG9hZGVkKClcbiAgICBEb2MuaGlkZShwYWdlLm5vQWN0aXZpdHksIHBhZ2Uub3JkZXJBY3Rpdml0eSlcbiAgICBpZiAoIXJlcy5vcmRlcnMgfHwgcmVzLm9yZGVycy5sZW5ndGggPT09IDApIHtcbiAgICAgIERvYy5zaG93KHBhZ2Uubm9BY3Rpdml0eSlcbiAgICAgIHBhZ2Uub3JkZXJBY3Rpdml0eUJveC5jbGFzc0xpc3QucmVtb3ZlKCdpbnZpc2libGUnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIERvYy5zaG93KHBhZ2Uub3JkZXJBY3Rpdml0eSlcbiAgICBEb2MuZW1wdHkocGFnZS5yZWNlbnRPcmRlcnMpXG4gICAgZm9yIChjb25zdCBvcmQgb2YgKHJlcy5vcmRlcnMgYXMgT3JkZXJbXSkpIHtcbiAgICAgIGNvbnN0IHJvdyA9IHBhZ2UucmVjZW50T3JkZXJUbXBsLmNsb25lTm9kZSh0cnVlKSBhcyBQYWdlRWxlbWVudFxuICAgICAgcGFnZS5yZWNlbnRPcmRlcnMuYXBwZW5kQ2hpbGQocm93KVxuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHJvdylcbiAgICAgIGxldCBmcm9tOiBTdXBwb3J0ZWRBc3NldCwgdG86IFN1cHBvcnRlZEFzc2V0XG4gICAgICBjb25zdCBbYmFzZVVuaXRJbmZvLCBxdW90ZVVuaXRJbmZvXSA9IFthcHAoKS51bml0SW5mbyhvcmQuYmFzZUlEKSwgYXBwKCkudW5pdEluZm8ob3JkLnF1b3RlSUQpXVxuICAgICAgaWYgKG9yZC5zZWxsKSB7XG4gICAgICAgIFtmcm9tLCB0b10gPSBbYXBwKCkuYXNzZXRzW29yZC5iYXNlSURdLCBhcHAoKS5hc3NldHNbb3JkLnF1b3RlSURdXVxuICAgICAgICB0bXBsLmZyb21RdHkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHksIGJhc2VVbml0SW5mbylcbiAgICAgICAgaWYgKG9yZC50eXBlID09PSBPcmRlclV0aWwuTGltaXQpIHtcbiAgICAgICAgICB0bXBsLnRvUXR5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmQucXR5IC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvciAqIG9yZC5yYXRlLCBxdW90ZVVuaXRJbmZvKVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBbZnJvbSwgdG9dID0gW2FwcCgpLmFzc2V0c1tvcmQucXVvdGVJRF0sIGFwcCgpLmFzc2V0c1tvcmQuYmFzZUlEXV1cbiAgICAgICAgaWYgKG9yZC50eXBlID09PSBPcmRlclV0aWwuTWFya2V0KSB7XG4gICAgICAgICAgdG1wbC5mcm9tUXR5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmQucXR5LCBiYXNlVW5pdEluZm8pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG1wbC5mcm9tUXR5LnRleHRDb250ZW50ID0gRG9jLmZvcm1hdENvaW5WYWx1ZShvcmQucXR5IC8gT3JkZXJVdGlsLlJhdGVFbmNvZGluZ0ZhY3RvciAqIG9yZC5yYXRlLCBxdW90ZVVuaXRJbmZvKVxuICAgICAgICAgIHRtcGwudG9RdHkudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKG9yZC5xdHksIGJhc2VVbml0SW5mbylcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0bXBsLmZyb21Mb2dvLnNyYyA9IERvYy5sb2dvUGF0aChmcm9tLnN5bWJvbClcbiAgICAgIERvYy5lbXB0eSh0bXBsLmZyb21TeW1ib2wsIHRtcGwudG9TeW1ib2wpXG4gICAgICB0bXBsLmZyb21TeW1ib2wuYXBwZW5kQ2hpbGQoRG9jLnN5bWJvbGl6ZShmcm9tLCB0cnVlKSlcbiAgICAgIHRtcGwudG9Mb2dvLnNyYyA9IERvYy5sb2dvUGF0aCh0by5zeW1ib2wpXG4gICAgICB0bXBsLnRvU3ltYm9sLmFwcGVuZENoaWxkKERvYy5zeW1ib2xpemUodG8sIHRydWUpKVxuICAgICAgdG1wbC5zdGF0dXMudGV4dENvbnRlbnQgPSBPcmRlclV0aWwuc3RhdHVzU3RyaW5nKG9yZClcbiAgICAgIHRtcGwuZmlsbGVkLnRleHRDb250ZW50ID0gYCR7KE9yZGVyVXRpbC5maWxsZWQob3JkKSAvIG9yZC5xdHkgKiAxMDApLnRvRml4ZWQoMSl9JWBcbiAgICAgIHRtcGwuYWdlLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZShvcmQuc3VibWl0VGltZSlcbiAgICAgIHRtcGwubGluay5ocmVmID0gYG9yZGVyLyR7b3JkLmlkfWBcbiAgICAgIGFwcCgpLmJpbmRJbnRlcm5hbE5hdmlnYXRpb24ocm93KVxuICAgIH1cbiAgICBwYWdlLm9yZGVyQWN0aXZpdHlCb3guY2xhc3NMaXN0LnJlbW92ZSgnaW52aXNpYmxlJylcbiAgfVxuXG4gIHVwZGF0ZVR4SGlzdG9yeVJvdyAocm93OiBQYWdlRWxlbWVudCwgdHg6IFdhbGxldFRyYW5zYWN0aW9uLCBhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgIGxldCBhbXRBc3NldElEID0gYXNzZXRJRFxuICAgIGxldCBmZWVzQXNzZXRJRCA9IGFzc2V0SURcbiAgICBpZiAodHgudG9rZW5JRCkge1xuICAgICAgYW10QXNzZXRJRCA9IHR4LnRva2VuSURcbiAgICAgIGlmIChhc3NldElEICE9PSB0eC50b2tlbklEKSBmZWVzQXNzZXRJRCA9IGFzc2V0SURcbiAgICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBhc3NldCA9IGFwcCgpLmFzc2V0c1thc3NldElEXVxuICAgICAgICBpZiAoYXNzZXQudG9rZW4pIGZlZXNBc3NldElEID0gYXNzZXQudG9rZW4ucGFyZW50SURcbiAgICAgICAgZWxzZSBjb25zb2xlLmVycm9yKGB1bmFibGUgdG8gZGV0ZXJtaW5lIGZlZSBhc3NldCBmb3IgdHggJHt0eC5pZH1gKVxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBhbXRBc3NldFVJID0gYXBwKCkudW5pdEluZm8oYW10QXNzZXRJRClcbiAgICBjb25zdCBmZWVzQXNzZXRVSSA9IGFwcCgpLnVuaXRJbmZvKGZlZXNBc3NldElEKVxuICAgIHRtcGwuYWdlLnRleHRDb250ZW50ID0gRG9jLnRpbWVTaW5jZSh0eC50aW1lc3RhbXAgKiAxMDAwKVxuICAgIHRtcGwuYWdlLmRhdGFzZXQudGltZXN0YW1wID0gU3RyaW5nKHR4LnRpbWVzdGFtcCAqIDEwMDApXG4gICAgRG9jLnNldFZpcyh0eC50aW1lc3RhbXAgPT09IDAsIHRtcGwucGVuZGluZylcbiAgICBEb2Muc2V0VmlzKHR4LnRpbWVzdGFtcCAhPT0gMCwgdG1wbC5hZ2UpXG4gICAgaWYgKHR4LnRpbWVzdGFtcCA+IDApIHRtcGwuYWdlLmRhdGFzZXQuc3RhbXAgPSBTdHJpbmcodHgudGltZXN0YW1wKVxuICAgIGxldCB0eFR5cGUgPSB0eFR5cGVTdHJpbmcodHgudHlwZSlcbiAgICBpZiAodHgudG9rZW5JRCAmJiB0eC50b2tlbklEICE9PSBhc3NldElEKSB7XG4gICAgICBjb25zdCB0b2tlbkFzc2V0ID0gYXBwKCkuYXNzZXRzW3R4LnRva2VuSURdXG4gICAgICBjb25zdCB0b2tlblN5bWJvbCA9IHRva2VuQXNzZXQudW5pdEluZm8uY29udmVudGlvbmFsLnVuaXRcbiAgICAgIHR4VHlwZSA9IGAke3Rva2VuU3ltYm9sfSAke3R4VHlwZX1gXG4gICAgfVxuICAgIHRtcGwudHlwZS50ZXh0Q29udGVudCA9IHR4VHlwZVxuICAgIHRtcGwuaWQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKHR4LmlkLCAxMilcbiAgICB0bXBsLmlkLnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0eC5pZClcbiAgICB0bXBsLmZlZXMudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0Q29pblZhbHVlKHR4LmZlZXMsIGZlZXNBc3NldFVJKVxuICAgIGlmIChub0FtdFR4VHlwZXMuaW5jbHVkZXModHgudHlwZSkpIHtcbiAgICAgIHRtcGwuYW1vdW50LnRleHRDb250ZW50ID0gJy0nXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IFt1LCBjXSA9IHR4VHlwZVNpZ25BbmRDbGFzcyh0eC50eXBlKVxuICAgICAgY29uc3QgYW10ID0gRG9jLmZvcm1hdENvaW5WYWx1ZSh0eC5hbW91bnQsIGFtdEFzc2V0VUkpXG4gICAgICB0bXBsLmFtb3VudC50ZXh0Q29udGVudCA9IGAke3V9JHthbXR9YFxuICAgICAgaWYgKGMgIT09ICcnKSB0bXBsLmFtb3VudC5jbGFzc0xpc3QuYWRkKGMpXG4gICAgfVxuICB9XG5cbiAgdHhIaXN0b3J5Um93ICh0eDogV2FsbGV0VHJhbnNhY3Rpb24sIGFzc2V0SUQ6IG51bWJlcikgOiBQYWdlRWxlbWVudCB7XG4gICAgY29uc3Qgcm93ID0gdGhpcy5wYWdlLnR4SGlzdG9yeVJvd1RtcGwuY2xvbmVOb2RlKHRydWUpIGFzIFBhZ2VFbGVtZW50XG4gICAgcm93LmRhdGFzZXQudHhpZCA9IHR4LmlkXG4gICAgRG9jLmJpbmQocm93LCAnY2xpY2snLCAoKSA9PiB0aGlzLnNob3dUeERldGFpbHNQb3B1cCh0eC5pZCkpXG4gICAgdGhpcy51cGRhdGVUeEhpc3RvcnlSb3cocm93LCB0eCwgYXNzZXRJRClcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgIHRoaXMuc3RhbXBlcnMucHVzaCh0bXBsLmFnZSlcbiAgICByZXR1cm4gcm93XG4gIH1cblxuICB0eEhpc3RvcnlEYXRlUm93IChkYXRlOiBzdHJpbmcpIDogUGFnZUVsZW1lbnQge1xuICAgIGNvbnN0IHJvdyA9IHRoaXMucGFnZS50eEhpc3RvcnlEYXRlUm93VG1wbC5jbG9uZU5vZGUodHJ1ZSkgYXMgUGFnZUVsZW1lbnRcbiAgICBjb25zdCB0bXBsID0gRG9jLnBhcnNlVGVtcGxhdGUocm93KVxuICAgIHRtcGwuZGF0ZS50ZXh0Q29udGVudCA9IGRhdGVcbiAgICByZXR1cm4gcm93XG4gIH1cblxuICBzZXRUeERldGFpbHNQb3B1cEVsZW1lbnRzICh0eDogV2FsbGV0VHJhbnNhY3Rpb24pIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG5cbiAgICAvLyBCbG9jayBleHBsb3JlclxuICAgIGNvbnN0IGFzc2V0RXhwbG9yZXIgPSBDb2luRXhwbG9yZXJzW3RoaXMuc2VsZWN0ZWRBc3NldElEXVxuICAgIGlmIChhc3NldEV4cGxvcmVyICYmIGFzc2V0RXhwbG9yZXJbbmV0XSkge1xuICAgICAgcGFnZS50eFZpZXdCbG9ja0V4cGxvcmVyLmhyZWYgPSBhc3NldEV4cGxvcmVyW25ldF0odHguaWQpXG4gICAgfVxuXG4gICAgLy8gVHggdHlwZVxuICAgIGxldCB0eFR5cGUgPSB0eFR5cGVTdHJpbmcodHgudHlwZSlcbiAgICBpZiAodHgudG9rZW5JRCAmJiB0eC50b2tlbklEICE9PSB0aGlzLnNlbGVjdGVkQXNzZXRJRCkge1xuICAgICAgY29uc3QgdG9rZW5TeW1ib2wgPSBhcHAoKS5hc3NldHNbdHgudG9rZW5JRF0uc3ltYm9sLnNwbGl0KCcuJylbMF0udG9VcHBlckNhc2UoKVxuICAgICAgdHhUeXBlID0gYCR7dG9rZW5TeW1ib2x9ICR7dHhUeXBlfWBcbiAgICB9XG4gICAgcGFnZS50eERldGFpbHNUeXBlLnRleHRDb250ZW50ID0gdHhUeXBlXG4gICAgRG9jLnNldFZpcyh0eC50eXBlID09PSB0eFR5cGVTd2FwT3JTZW5kLCBwYWdlLnR4VHlwZVRvb2x0aXApXG4gICAgcGFnZS50eFR5cGVUb29sdGlwLmRhdGFzZXQudG9vbHRpcCA9IGludGwucHJlcChpbnRsLklEX1NXQVBfT1JfU0VORF9UT09MVElQKVxuXG4gICAgLy8gQW1vdW50XG4gICAgaWYgKG5vQW10VHhUeXBlcy5pbmNsdWRlcyh0eC50eXBlKSkge1xuICAgICAgRG9jLmhpZGUocGFnZS50eERldGFpbHNBbXRTZWN0aW9uKVxuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgYXNzZXRJRCA9IHRoaXMuc2VsZWN0ZWRBc3NldElEXG4gICAgICBpZiAodHgudG9rZW5JRCkgYXNzZXRJRCA9IHR4LnRva2VuSURcbiAgICAgIERvYy5zaG93KHBhZ2UudHhEZXRhaWxzQW10U2VjdGlvbilcbiAgICAgIGNvbnN0IHVpID0gYXBwKCkudW5pdEluZm8oYXNzZXRJRClcbiAgICAgIGNvbnN0IGFtdCA9IERvYy5mb3JtYXRDb2luVmFsdWUodHguYW1vdW50LCB1aSlcbiAgICAgIGNvbnN0IFtzLCBjXSA9IHR4VHlwZVNpZ25BbmRDbGFzcyh0eC50eXBlKVxuICAgICAgcGFnZS50eERldGFpbHNBbW91bnQudGV4dENvbnRlbnQgPSBgJHtzfSR7YW10fSAke3VpLmNvbnZlbnRpb25hbC51bml0fWBcbiAgICAgIGlmIChjICE9PSAnJykgcGFnZS50eERldGFpbHNBbW91bnQuY2xhc3NMaXN0LmFkZChjKVxuICAgIH1cblxuICAgIC8vIEZlZVxuICAgIGxldCBmZWVBc3NldCA9IHRoaXMuc2VsZWN0ZWRBc3NldElEXG4gICAgaWYgKHR4LnRva2VuSUQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgYXNzZXQgPSBhcHAoKS5hc3NldHNbdHgudG9rZW5JRF1cbiAgICAgIGlmIChhc3NldC50b2tlbikge1xuICAgICAgICBmZWVBc3NldCA9IGFzc2V0LnRva2VuLnBhcmVudElEXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKGB3YWxsZXQgdHJhbnNhY3Rpb24gJHt0eC5pZH0gaXMgc3VwcG9zZWQgdG8gYmUgYSB0b2tlbiB0eCwgYnV0IGFzc2V0ICR7dHgudG9rZW5JRH0gaXMgbm90IGEgdG9rZW5gKVxuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBmZWVVSSA9IGFwcCgpLnVuaXRJbmZvKGZlZUFzc2V0KVxuICAgIGNvbnN0IGZlZSA9IERvYy5mb3JtYXRDb2luVmFsdWUodHguZmVlcywgZmVlVUkpXG4gICAgcGFnZS50eERldGFpbHNGZWUudGV4dENvbnRlbnQgPSBgJHtmZWV9ICR7ZmVlVUkuY29udmVudGlvbmFsLnVuaXR9YFxuXG4gICAgLy8gVGltZSAvIGJsb2NrIG51bWJlclxuICAgIHBhZ2UudHhEZXRhaWxzQmxvY2tOdW1iZXIudGV4dENvbnRlbnQgPSBgJHt0eC5ibG9ja051bWJlcn1gXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHR4LnRpbWVzdGFtcCAqIDEwMDApXG4gICAgY29uc3QgZGF0ZVN0ciA9IGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKClcbiAgICBjb25zdCB0aW1lU3RyID0gZGF0ZS50b0xvY2FsZVRpbWVTdHJpbmcoKVxuICAgIHBhZ2UudHhEZXRhaWxzVGltZXN0YW1wLnRleHRDb250ZW50ID0gYCR7ZGF0ZVN0cn0gJHt0aW1lU3RyfWBcbiAgICBEb2Muc2V0VmlzKHR4LmJsb2NrTnVtYmVyID09PSAwLCBwYWdlLnRpbWVzdGFtcFBlbmRpbmcsIHBhZ2UuYmxvY2tOdW1iZXJQZW5kaW5nKVxuICAgIERvYy5zZXRWaXModHguYmxvY2tOdW1iZXIgIT09IDAsIHBhZ2UudHhEZXRhaWxzQmxvY2tOdW1iZXIsIHBhZ2UudHhEZXRhaWxzVGltZXN0YW1wKVxuXG4gICAgLy8gVHggSURcbiAgICBwYWdlLnR4RGV0YWlsc0lELnRleHRDb250ZW50ID0gdHJpbVN0cmluZ1dpdGhFbGxpcHNpcyh0eC5pZCwgMjApXG4gICAgcGFnZS50eERldGFpbHNJRC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgdHguaWQpXG5cbiAgICAvLyBSZWNpcGllbnRcbiAgICBpZiAodHgucmVjaXBpZW50KSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnR4RGV0YWlsc1JlY2lwaWVudFNlY3Rpb24pXG4gICAgICBwYWdlLnR4RGV0YWlsc1JlY2lwaWVudC50ZXh0Q29udGVudCA9IHRyaW1TdHJpbmdXaXRoRWxsaXBzaXModHgucmVjaXBpZW50LCAyMClcbiAgICAgIHBhZ2UudHhEZXRhaWxzUmVjaXBpZW50LnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0eC5yZWNpcGllbnQpXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UudHhEZXRhaWxzUmVjaXBpZW50U2VjdGlvbilcbiAgICB9XG5cbiAgICAvLyBCb25kIEluZm9cbiAgICBpZiAodHguYm9uZEluZm8pIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudHhEZXRhaWxzQm9uZElEU2VjdGlvbiwgcGFnZS50eERldGFpbHNCb25kTG9ja3RpbWVTZWN0aW9uKVxuICAgICAgRG9jLnNldFZpcyh0eC5ib25kSW5mby5hY2NvdW50SUQgIT09ICcnLCBwYWdlLnR4RGV0YWlsc0JvbmRBY2NvdW50SURTZWN0aW9uKVxuICAgICAgcGFnZS50eERldGFpbHNCb25kSUQudGV4dENvbnRlbnQgPSB0cmltU3RyaW5nV2l0aEVsbGlwc2lzKHR4LmJvbmRJbmZvLmJvbmRJRCwgMjApXG4gICAgICBwYWdlLnR4RGV0YWlsc0JvbmRJRC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgdHguYm9uZEluZm8uYm9uZElEKVxuICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHR4LmJvbmRJbmZvLmxvY2tUaW1lICogMTAwMClcbiAgICAgIGNvbnN0IGRhdGVTdHIgPSBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpXG4gICAgICBjb25zdCB0aW1lU3RyID0gZGF0ZS50b0xvY2FsZVRpbWVTdHJpbmcoKVxuICAgICAgcGFnZS50eERldGFpbHNCb25kTG9ja3RpbWUudGV4dENvbnRlbnQgPSBgJHtkYXRlU3RyfSAke3RpbWVTdHJ9YFxuICAgICAgcGFnZS50eERldGFpbHNCb25kQWNjb3VudElELnRleHRDb250ZW50ID0gdHJpbVN0cmluZ1dpdGhFbGxpcHNpcyh0eC5ib25kSW5mby5hY2NvdW50SUQsIDIwKVxuICAgICAgcGFnZS50eERldGFpbHNCb25kQWNjb3VudElELnNldEF0dHJpYnV0ZSgndGl0bGUnLCB0eC5ib25kSW5mby5hY2NvdW50SUQpXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UudHhEZXRhaWxzQm9uZElEU2VjdGlvbiwgcGFnZS50eERldGFpbHNCb25kTG9ja3RpbWVTZWN0aW9uLCBwYWdlLnR4RGV0YWlsc0JvbmRBY2NvdW50SURTZWN0aW9uKVxuICAgIH1cblxuICAgIC8vIE5vbmNlXG4gICAgaWYgKHR4LmFkZGl0aW9uYWxEYXRhICYmIHR4LmFkZGl0aW9uYWxEYXRhLk5vbmNlKSB7XG4gICAgICBEb2Muc2hvdyhwYWdlLnR4RGV0YWlsc05vbmNlU2VjdGlvbilcbiAgICAgIHBhZ2UudHhEZXRhaWxzTm9uY2UudGV4dENvbnRlbnQgPSBgJHt0eC5hZGRpdGlvbmFsRGF0YS5Ob25jZX1gXG4gICAgfSBlbHNlIHtcbiAgICAgIERvYy5oaWRlKHBhZ2UudHhEZXRhaWxzTm9uY2VTZWN0aW9uKVxuICAgIH1cbiAgfVxuXG4gIHNob3dUeERldGFpbHNQb3B1cCAoaWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHR4ID0gYXBwKCkuZ2V0V2FsbGV0VHgodGhpcy5zZWxlY3RlZEFzc2V0SUQsIGlkKVxuICAgIGlmICghdHgpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYHdhbGxldCB0cmFuc2FjdGlvbiAke2lkfSBub3QgZm91bmRgKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuY3VyclR4ID0gdHhcbiAgICB0aGlzLnNldFR4RGV0YWlsc1BvcHVwRWxlbWVudHModHgpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UudHhEZXRhaWxzKVxuICB9XG5cbiAgdHhIaXN0b3J5VGFibGVOZXdlc3REYXRlICgpIDogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5jaGlsZHJlbi5sZW5ndGggPj0gMSkge1xuICAgICAgY29uc3QgdG1wbCA9IERvYy5wYXJzZVRlbXBsYXRlKHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuY2hpbGRyZW5bMF0gYXMgUGFnZUVsZW1lbnQpXG4gICAgICByZXR1cm4gdG1wbC5kYXRlLnRleHRDb250ZW50IHx8ICcnXG4gICAgfVxuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgdHhEYXRlICh0eDogV2FsbGV0VHJhbnNhY3Rpb24pIDogc3RyaW5nIHtcbiAgICBpZiAodHgudGltZXN0YW1wID09PSAwKSB7XG4gICAgICByZXR1cm4gKG5ldyBEYXRlKCkpLnRvTG9jYWxlRGF0ZVN0cmluZygpXG4gICAgfVxuICAgIHJldHVybiAobmV3IERhdGUodHgudGltZXN0YW1wICogMTAwMCkpLnRvTG9jYWxlRGF0ZVN0cmluZygpXG4gIH1cblxuICBoYW5kbGVUeE5vdGUgKHR4OiBXYWxsZXRUcmFuc2FjdGlvbiwgbmV3VHg6IGJvb2xlYW4pIHtcbiAgICBjb25zdCB3ID0gYXBwKCkuYXNzZXRzW3RoaXMuc2VsZWN0ZWRBc3NldElEXS53YWxsZXRcbiAgICBjb25zdCBoaWRlTWl4aW5nID0gKHcudHJhaXRzICYgdHJhaXRGdW5kc01peGVyKSAhPT0gMCAmJiAhIXRoaXMucGFnZS5oaWRlTWl4VHhzLmNoZWNrZWRcbiAgICBpZiAoaGlkZU1peGluZyAmJiB0eC50eXBlID09PSB0eFR5cGVNaXhpbmcpIHJldHVyblxuICAgIGlmIChuZXdUeCkge1xuICAgICAgaWYgKCF0aGlzLm9sZGVzdFR4KSB7XG4gICAgICAgIERvYy5zaG93KHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZSlcbiAgICAgICAgRG9jLmhpZGUodGhpcy5wYWdlLm5vVHhIaXN0b3J5KVxuICAgICAgICB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmFwcGVuZENoaWxkKHRoaXMudHhIaXN0b3J5RGF0ZVJvdyh0aGlzLnR4RGF0ZSh0eCkpKVxuICAgICAgICB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmFwcGVuZENoaWxkKHRoaXMudHhIaXN0b3J5Um93KHR4LCB0aGlzLnNlbGVjdGVkQXNzZXRJRCkpXG4gICAgICAgIHRoaXMub2xkZXN0VHggPSB0eFxuICAgICAgfSBlbHNlIGlmICh0aGlzLnR4RGF0ZSh0eCkgIT09IHRoaXMudHhIaXN0b3J5VGFibGVOZXdlc3REYXRlKCkpIHtcbiAgICAgICAgdGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5pbnNlcnRCZWZvcmUodGhpcy50eEhpc3RvcnlSb3codHgsIHRoaXMuc2VsZWN0ZWRBc3NldElEKSwgdGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5jaGlsZHJlblswXSlcbiAgICAgICAgdGhpcy5wYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5pbnNlcnRCZWZvcmUodGhpcy50eEhpc3RvcnlEYXRlUm93KHRoaXMudHhEYXRlKHR4KSksIHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuY2hpbGRyZW5bMF0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5Lmluc2VydEJlZm9yZSh0aGlzLnR4SGlzdG9yeVJvdyh0eCwgdGhpcy5zZWxlY3RlZEFzc2V0SUQpLCB0aGlzLnBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmNoaWxkcmVuWzFdKVxuICAgICAgfVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGZvciAoY29uc3Qgcm93IG9mIHRoaXMucGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuY2hpbGRyZW4pIHtcbiAgICAgIGNvbnN0IHBlUm93ID0gcm93IGFzIFBhZ2VFbGVtZW50XG4gICAgICBpZiAocGVSb3cuZGF0YXNldC50eGlkID09PSB0eC5pZCkge1xuICAgICAgICB0aGlzLnVwZGF0ZVR4SGlzdG9yeVJvdyhwZVJvdywgdHgsIHRoaXMuc2VsZWN0ZWRBc3NldElEKVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHguaWQgPT09IHRoaXMuY3VyclR4Py5pZCkge1xuICAgICAgdGhpcy5zZXRUeERldGFpbHNQb3B1cEVsZW1lbnRzKHR4KVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFR4SGlzdG9yeSAoYXNzZXRJRDogbnVtYmVyLCBoaWRlTWl4VHhzOiBib29sZWFuLCBhZnRlcj86IHN0cmluZykgOiBQcm9taXNlPFR4SGlzdG9yeVJlc3VsdD4ge1xuICAgIGxldCBudW1Ub0ZldGNoID0gMTBcbiAgICBpZiAoaGlkZU1peFR4cykgbnVtVG9GZXRjaCA9IDE1XG5cbiAgICBjb25zdCByZXMgOiBUeEhpc3RvcnlSZXN1bHQgPSB7IHR4czogW10sIGxhc3RUeDogZmFsc2UgfVxuICAgIGxldCByZWYgPSBhZnRlclxuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0MDsgaSsrKSB7XG4gICAgICBjb25zdCBjdXJyUmVzID0gYXdhaXQgYXBwKCkudHhIaXN0b3J5KGFzc2V0SUQsIG51bVRvRmV0Y2gsIHJlZilcbiAgICAgIGlmIChjdXJyUmVzLnR4cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlZiA9IGN1cnJSZXMudHhzW2N1cnJSZXMudHhzLmxlbmd0aCAtIDFdLmlkXG4gICAgICB9XG4gICAgICBsZXQgdHhzID0gY3VyclJlcy50eHNcbiAgICAgIGlmIChoaWRlTWl4VHhzKSB7XG4gICAgICAgIHR4cyA9IHR4cy5maWx0ZXIoKHR4KSA9PiB0eC50eXBlICE9PSB0eFR5cGVNaXhpbmcpXG4gICAgICB9XG4gICAgICBpZiAocmVzLnR4cy5sZW5ndGggKyB0eHMubGVuZ3RoID4gMTApIHtcbiAgICAgICAgY29uc3QgbnVtVG9QdXNoID0gMTAgLSByZXMudHhzLmxlbmd0aFxuICAgICAgICByZXMudHhzLnB1c2goLi4udHhzLnNsaWNlKDAsIG51bVRvUHVzaCkpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoY3VyclJlcy5sYXN0VHgpIHJlcy5sYXN0VHggPSB0cnVlXG4gICAgICAgIHJlcy50eHMucHVzaCguLi50eHMpXG4gICAgICB9XG4gICAgICBpZiAocmVzLnR4cy5sZW5ndGggPj0gMTAgfHwgY3VyclJlcy5sYXN0VHgpIGJyZWFrXG4gICAgfVxuICAgIHJldHVybiByZXNcbiAgfVxuXG4gIGFzeW5jIHNob3dUeEhpc3RvcnkgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBsZXQgdHhSZXMgOiBUeEhpc3RvcnlSZXN1bHRcbiAgICBEb2MuaGlkZShwYWdlLnR4SGlzdG9yeVRhYmxlLCBwYWdlLnR4SGlzdG9yeUJveCwgcGFnZS5ub1R4SGlzdG9yeSwgcGFnZS5lYXJsaWVyVHhzLCBwYWdlLnR4SGlzdG9yeU5vdEF2YWlsYWJsZSwgcGFnZS5oaWRlTWl4VHhzKVxuICAgIERvYy5lbXB0eShwYWdlLnR4SGlzdG9yeVRhYmxlQm9keSlcbiAgICBjb25zdCB3ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdLndhbGxldFxuICAgIGlmICghdyB8fCB3LmRpc2FibGVkIHx8ICh3LnRyYWl0cyAmIHRyYWl0SGlzdG9yaWFuKSA9PT0gMCkge1xuICAgICAgRG9jLnNob3cocGFnZS50eEhpc3RvcnlOb3RBdmFpbGFibGUpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLm9sZGVzdFR4ID0gdW5kZWZpbmVkXG5cbiAgICBjb25zdCBpc01peGluZyA9ICh3LnRyYWl0cyAmIHRyYWl0RnVuZHNNaXhlcikgIT09IDBcbiAgICBEb2Muc2V0VmlzKGlzTWl4aW5nLCBwYWdlLmhpZGVNaXhUeHMpXG4gICAgRG9jLnNob3cocGFnZS50eEhpc3RvcnlCb3gpXG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgaGlkZU1peGluZyA9IGlzTWl4aW5nICYmICEhcGFnZS5oaWRlTWl4VHhzQ2hlY2tib3guY2hlY2tlZFxuICAgICAgdHhSZXMgPSBhd2FpdCB0aGlzLmdldFR4SGlzdG9yeShhc3NldElELCBoaWRlTWl4aW5nKVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgRG9jLnNob3cocGFnZS5ub1R4SGlzdG9yeSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBpZiAodHhSZXMudHhzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgRG9jLnNob3cocGFnZS5ub1R4SGlzdG9yeSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGxldCBvbGRlc3REYXRlID0gdGhpcy50eERhdGUodHhSZXMudHhzWzBdKVxuICAgIHBhZ2UudHhIaXN0b3J5VGFibGVCb2R5LmFwcGVuZENoaWxkKHRoaXMudHhIaXN0b3J5RGF0ZVJvdyhvbGRlc3REYXRlKSlcbiAgICBmb3IgKGNvbnN0IHR4IG9mIHR4UmVzLnR4cykge1xuICAgICAgY29uc3QgZGF0ZSA9IHRoaXMudHhEYXRlKHR4KVxuICAgICAgaWYgKGRhdGUgIT09IG9sZGVzdERhdGUpIHtcbiAgICAgICAgb2xkZXN0RGF0ZSA9IGRhdGVcbiAgICAgICAgcGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuYXBwZW5kQ2hpbGQodGhpcy50eEhpc3RvcnlEYXRlUm93KGRhdGUpKVxuICAgICAgfVxuICAgICAgY29uc3Qgcm93ID0gdGhpcy50eEhpc3RvcnlSb3codHgsIGFzc2V0SUQpXG4gICAgICBwYWdlLnR4SGlzdG9yeVRhYmxlQm9keS5hcHBlbmRDaGlsZChyb3cpXG4gICAgfVxuICAgIHRoaXMub2xkZXN0VHggPSB0eFJlcy50eHNbdHhSZXMudHhzLmxlbmd0aCAtIDFdXG4gICAgRG9jLnNob3cocGFnZS50eEhpc3RvcnlUYWJsZSlcbiAgICBEb2Muc2V0VmlzKCF0eFJlcy5sYXN0VHgsIHBhZ2UuZWFybGllclR4cylcbiAgfVxuXG4gIGFzeW5jIGxvYWRFYXJsaWVyVHhzICgpIHtcbiAgICBpZiAoIXRoaXMub2xkZXN0VHgpIHJldHVyblxuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBsZXQgdHhSZXMgOiBUeEhpc3RvcnlSZXN1bHRcbiAgICBjb25zdCB3ID0gYXBwKCkuYXNzZXRzW3RoaXMuc2VsZWN0ZWRBc3NldElEXS53YWxsZXRcbiAgICBjb25zdCBoaWRlTWl4aW5nID0gKHcudHJhaXRzICYgdHJhaXRGdW5kc01peGVyKSAhPT0gMCAmJiAhIXBhZ2UuaGlkZU1peFR4c0NoZWNrYm94LmNoZWNrZWRcbiAgICB0cnkge1xuICAgICAgdHhSZXMgPSBhd2FpdCB0aGlzLmdldFR4SGlzdG9yeSh0aGlzLnNlbGVjdGVkQXNzZXRJRCwgaGlkZU1peGluZywgdGhpcy5vbGRlc3RUeC5pZClcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGxldCBvbGRlc3REYXRlID0gdGhpcy50eERhdGUodGhpcy5vbGRlc3RUeClcbiAgICBmb3IgKGNvbnN0IHR4IG9mIHR4UmVzLnR4cykge1xuICAgICAgY29uc3QgZGF0ZSA9IHRoaXMudHhEYXRlKHR4KVxuICAgICAgaWYgKGRhdGUgIT09IG9sZGVzdERhdGUpIHtcbiAgICAgICAgb2xkZXN0RGF0ZSA9IGRhdGVcbiAgICAgICAgcGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuYXBwZW5kQ2hpbGQodGhpcy50eEhpc3RvcnlEYXRlUm93KGRhdGUpKVxuICAgICAgfVxuICAgICAgY29uc3Qgcm93ID0gdGhpcy50eEhpc3RvcnlSb3codHgsIHRoaXMuc2VsZWN0ZWRBc3NldElEKVxuICAgICAgcGFnZS50eEhpc3RvcnlUYWJsZUJvZHkuYXBwZW5kQ2hpbGQocm93KVxuICAgIH1cbiAgICBEb2Muc2V0VmlzKCF0eFJlcy5sYXN0VHgsIHBhZ2UuZWFybGllclR4cylcbiAgICBpZiAodHhSZXMudHhzLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMub2xkZXN0VHggPSB0eFJlcy50eHNbdHhSZXMudHhzLmxlbmd0aCAtIDFdXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcmVzY2FuV2FsbGV0IChhc3NldElEOiBudW1iZXIpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgRG9jLmhpZGUocGFnZS5yZWNvbmZpZ0VycilcblxuICAgIGNvbnN0IHVybCA9ICcvYXBpL3Jlc2NhbndhbGxldCdcbiAgICBjb25zdCByZXEgPSB7IGFzc2V0SUQ6IGFzc2V0SUQgfVxuXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmJvZHkpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04odXJsLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAocmVzLmNvZGUgPT09IEVycm9ycy5hY3RpdmVPcmRlcnNFcnIpIHtcbiAgICAgIHRoaXMuZm9yY2VVcmwgPSB1cmxcbiAgICAgIHRoaXMuZm9yY2VSZXEgPSByZXFcbiAgICAgIHRoaXMuc2hvd0NvbmZpcm1Gb3JjZSgpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UucmVjb25maWdFcnIsIHJlcy5tc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgdGhpcy5hc3NldFVwZGF0ZWQoYXNzZXRJRCwgcGFnZS5yZWNvbmZpZ0Zvcm0sIGludGwucHJlcChpbnRsLklEX1JFU0NBTl9TVEFSVEVEKSlcbiAgfVxuXG4gIHNob3dDb25maXJtRm9yY2UgKCkge1xuICAgIERvYy5oaWRlKHRoaXMucGFnZS5jb25maXJtRm9yY2VFcnIpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UuY29uZmlybUZvcmNlKVxuICB9XG5cbiAgc2hvd1JlY292ZXJXYWxsZXQgKCkge1xuICAgIERvYy5oaWRlKHRoaXMucGFnZS5yZWNvdmVyV2FsbGV0RXJyKVxuICAgIHRoaXMuc2hvd0Zvcm0odGhpcy5wYWdlLnJlY292ZXJXYWxsZXRDb25maXJtKVxuICB9XG5cbiAgLyogU2hvdyB0aGUgb3BlbiB3YWxsZXQgZm9ybSBpZiB0aGUgcGFzc3dvcmQgaXMgbm90IGNhY2hlZCwgYW5kIG90aGVyd2lzZVxuICAgKiBhdHRlbXB0IHRvIG9wZW4gdGhlIHdhbGxldC5cbiAgICovXG4gIGFzeW5jIG9wZW5XYWxsZXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIGNvbnN0IG9wZW4gPSB7XG4gICAgICBhc3NldElEOiBhc3NldElEXG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL29wZW53YWxsZXQnLCBvcGVuKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdvcGVud2FsbGV0IGVycm9yJywgcmVzKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuYXNzZXRVcGRhdGVkKGFzc2V0SUQsIHVuZGVmaW5lZCwgaW50bC5wcmVwKGludGwuSURfV0FMTEVUX1VOTE9DS0VEKSlcbiAgfVxuXG4gIC8qIFNob3cgdGhlIGZvcm0gdXNlZCB0byBjaGFuZ2Ugd2FsbGV0IGNvbmZpZ3VyYXRpb24gc2V0dGluZ3MuICovXG4gIGFzeW5jIHNob3dSZWNvbmZpZyAoYXNzZXRJRDogbnVtYmVyLCBjZmc/OiByZWNvbmZpZ1NldHRpbmdzKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKFxuICAgICAgcGFnZS5jaGFuZ2VXYWxsZXRUeXBlLCBwYWdlLmNoYW5nZVR5cGVIaWRlSWNvbiwgcGFnZS5yZWNvbmZpZ0VycixcbiAgICAgIHBhZ2Uuc2hvd0NoYW5nZVR5cGUsIHBhZ2UuY2hhbmdlVHlwZUhpZGVJY29uLCBwYWdlLnJlY29uZmlnRXJyLFxuICAgICAgcGFnZS5lbmFibGVXYWxsZXQsIHBhZ2UuZGlzYWJsZVdhbGxldFxuICAgIClcbiAgICAvLyBIaWRlIHVwZGF0ZSBwYXNzd29yZCBzZWN0aW9uIGJ5IGRlZmF1bHRcbiAgICB0aGlzLmNoYW5nZVdhbGxldFBXID0gZmFsc2VcbiAgICB0aGlzLnNldFBXU2V0dGluZ1Zpeih0aGlzLmNoYW5nZVdhbGxldFBXKVxuICAgIGNvbnN0IGFzc2V0ID0gYXBwKCkuYXNzZXRzW2Fzc2V0SURdXG5cbiAgICBjb25zdCBjdXJyZW50RGVmID0gYXBwKCkuY3VycmVudFdhbGxldERlZmluaXRpb24oYXNzZXRJRClcbiAgICBjb25zdCB3YWxsZXREZWZzID0gYXNzZXQudG9rZW4gPyBbYXNzZXQudG9rZW4uZGVmaW5pdGlvbl0gOiBhc3NldC5pbmZvID8gYXNzZXQuaW5mby5hdmFpbGFibGV3YWxsZXRzIDogW11cbiAgICBjb25zdCBkaXNhYmxlV2FsbGV0VHlwZSA9IGFwcCgpLmV4dGVuc2lvbldhbGxldChhc3NldElEKT8uZGlzYWJsZVdhbGxldFR5cGVcbiAgICBpZiAod2FsbGV0RGVmcy5sZW5ndGggPiAxICYmICFkaXNhYmxlV2FsbGV0VHlwZSkge1xuICAgICAgRG9jLmVtcHR5KHBhZ2UuY2hhbmdlV2FsbGV0VHlwZVNlbGVjdClcbiAgICAgIERvYy5zaG93KHBhZ2Uuc2hvd0NoYW5nZVR5cGUsIHBhZ2UuY2hhbmdlVHlwZVNob3dJY29uKVxuICAgICAgcGFnZS5jaGFuZ2VUeXBlTXNnLnRleHRDb250ZW50ID0gaW50bC5wcmVwKGludGwuSURfQ0hBTkdFX1dBTExFVF9UWVBFKVxuICAgICAgZm9yIChjb25zdCB3RGVmIG9mIHdhbGxldERlZnMpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJykgYXMgSFRNTE9wdGlvbkVsZW1lbnRcbiAgICAgICAgaWYgKHdEZWYudHlwZSA9PT0gY3VycmVudERlZi50eXBlKSBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlXG4gICAgICAgIG9wdGlvbi52YWx1ZSA9IG9wdGlvbi50ZXh0Q29udGVudCA9IHdEZWYudHlwZVxuICAgICAgICBwYWdlLmNoYW5nZVdhbGxldFR5cGVTZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjZmc/LmVsZXZhdGVQcm92aWRlcnMpIHtcbiAgICAgIGZvciAoY29uc3Qgb3B0IG9mIChjdXJyZW50RGVmLmNvbmZpZ29wdHMpKSBpZiAob3B0LmtleSA9PT0gJ3Byb3ZpZGVycycpIG9wdC5yZXF1aXJlZCA9IHRydWVcbiAgICB9XG5cbiAgICBjb25zdCB3YWxsZXQgPSBhcHAoKS53YWxsZXRNYXBbYXNzZXRJRF1cbiAgICBEb2Muc2V0VmlzKHdhbGxldC50cmFpdHMgJiB0cmFpdExvZ0ZpbGVyLCBwYWdlLmRvd25sb2FkTG9ncylcbiAgICBEb2Muc2V0VmlzKHdhbGxldC50cmFpdHMgJiB0cmFpdFJlY292ZXJlciwgcGFnZS5yZWNvdmVyV2FsbGV0KVxuICAgIERvYy5zZXRWaXMod2FsbGV0LnRyYWl0cyAmIHRyYWl0UmVzdG9yZXIsIHBhZ2UuZXhwb3J0V2FsbGV0KVxuICAgIERvYy5zZXRWaXMod2FsbGV0LnRyYWl0cyAmIHRyYWl0UmVzY2FubmVyLCBwYWdlLnJlc2NhbldhbGxldClcbiAgICBEb2Muc2V0VmlzKHdhbGxldC50cmFpdHMgJiB0cmFpdFBlZXJNYW5hZ2VyICYmICF3YWxsZXQuZGlzYWJsZWQsIHBhZ2UubWFuYWdlUGVlcnMpXG4gICAgRG9jLnNldFZpcyh3YWxsZXQudHJhaXRzICYgdHJhaXRUb2tlbkFwcHJvdmVyICYmICF3YWxsZXQuZGlzYWJsZWQsIHBhZ2UudW5hcHByb3ZlVG9rZW5BbGxvd2FuY2UpXG5cbiAgICBEb2Muc2V0VmlzKHdhbGxldC50cmFpdHMgJiB0cmFpdHNFeHRyYU9wdHMsIHBhZ2Uub3RoZXJBY3Rpb25zTGFiZWwpXG5cbiAgICBpZiAod2FsbGV0LmRpc2FibGVkKSBEb2Muc2hvdyhwYWdlLmVuYWJsZVdhbGxldClcbiAgICBlbHNlIERvYy5zaG93KHBhZ2UuZGlzYWJsZVdhbGxldClcblxuICAgIHRoaXMuc2hvd09ySGlkZVJlY292ZXJ5U3VwcG9ydE1zZyh3YWxsZXQsIGN1cnJlbnREZWYuc2VlZGVkKVxuXG4gICAgcGFnZS5yZWNmZ0Fzc2V0TG9nby5zcmMgPSBEb2MubG9nb1BhdGgoYXNzZXQuc3ltYm9sKVxuICAgIHBhZ2UucmVjZmdBc3NldE5hbWUudGV4dENvbnRlbnQgPSBhc3NldC5uYW1lXG4gICAgaWYgKCFjZmc/LnNraXBBbmltYXRpb24pIHRoaXMuc2hvd0Zvcm0ocGFnZS5yZWNvbmZpZ0Zvcm0pXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnJlY29uZmlnRm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS93YWxsZXRzZXR0aW5ncycsIHsgYXNzZXRJRCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UucmVjb25maWdFcnIsIHJlcy5tc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgYXNzZXRIYXNBY3RpdmVPcmRlcnMgPSBhcHAoKS5oYXZlQWN0aXZlT3JkZXJzKGFzc2V0SUQpXG4gICAgdGhpcy5yZWNvbmZpZ0Zvcm0udXBkYXRlKGFzc2V0LmlkLCBjdXJyZW50RGVmLmNvbmZpZ29wdHMgfHwgW10sIGFzc2V0SGFzQWN0aXZlT3JkZXJzKVxuICAgIHRoaXMuc2V0R3VpZGVMaW5rKGN1cnJlbnREZWYuZ3VpZGVsaW5rKVxuICAgIHRoaXMucmVjb25maWdGb3JtLnNldENvbmZpZyhyZXMubWFwKVxuICAgIHRoaXMudXBkYXRlRGlzcGxheWVkUmVjb25maWdGaWVsZHMoY3VycmVudERlZilcbiAgfVxuXG4gIHNob3dPckhpZGVSZWNvdmVyeVN1cHBvcnRNc2cgKHdhbGxldDogV2FsbGV0U3RhdGUsIHNlZWRlZDogYm9vbGVhbikge1xuICAgIHRoaXMuc2V0UmVjb3ZlcnlTdXBwb3J0TXNnVml6KHNlZWRlZCAmJiAhd2FsbGV0LnJ1bm5pbmcgJiYgIXdhbGxldC5kaXNhYmxlZCAmJiBCb29sZWFuKHdhbGxldC50cmFpdHMgJiB0cmFpdFJlY292ZXJlciksIHdhbGxldC5zeW1ib2wpXG4gIH1cblxuICBzZXRSZWNvdmVyeVN1cHBvcnRNc2dWaXogKHZpejogYm9vbGVhbiwgc3ltYm9sOiBzdHJpbmcpIHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgaWYgKHZpeikge1xuICAgICAgcGFnZS5yZWNvbmZpZ1N1cHBvcnRNc2cudGV4dENvbnRlbnQgPSBpbnRsLnByZXAoaW50bC5JRF9XQUxMRVRfUkVDT1ZFUllfU1VQUE9SVF9NU0csIHsgd2FsbGV0U3ltYm9sOiBzeW1ib2wudG9Mb2NhbGVVcHBlckNhc2UoKSB9KVxuICAgICAgRG9jLnNob3cocGFnZS5yZWNvbmZpZ1N1cHBvcnRNc2cpXG4gICAgICBwYWdlLnN1Ym1pdFJlY29uZmlnLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJylcbiAgICAgIHBhZ2Uuc3VibWl0UmVjb25maWcuY2xhc3NMaXN0LmFkZCgnZ3JleScpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgcGFnZS5zdWJtaXRSZWNvbmZpZy5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcbiAgICBwYWdlLnN1Ym1pdFJlY29uZmlnLmNsYXNzTGlzdC5yZW1vdmUoJ2dyZXknKVxuICAgIERvYy5lbXB0eShwYWdlLnJlY29uZmlnU3VwcG9ydE1zZylcbiAgICBEb2MuaGlkZShwYWdlLnJlY29uZmlnU3VwcG9ydE1zZylcbiAgfVxuXG4gIGNoYW5nZVdhbGxldFR5cGUgKCkge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCB3YWxsZXRUeXBlID0gcGFnZS5jaGFuZ2VXYWxsZXRUeXBlU2VsZWN0LnZhbHVlIHx8ICcnXG4gICAgY29uc3Qgd2FsbGV0RGVmID0gYXBwKCkud2FsbGV0RGVmaW5pdGlvbih0aGlzLnNlbGVjdGVkQXNzZXRJRCwgd2FsbGV0VHlwZSlcbiAgICB0aGlzLnJlY29uZmlnRm9ybS51cGRhdGUodGhpcy5zZWxlY3RlZEFzc2V0SUQsIHdhbGxldERlZi5jb25maWdvcHRzIHx8IFtdLCBmYWxzZSlcbiAgICBjb25zdCB3YWxsZXQgPSBhcHAoKS53YWxsZXRNYXBbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgY29uc3QgY3VycmVudERlZiA9IGFwcCgpLmN1cnJlbnRXYWxsZXREZWZpbml0aW9uKHRoaXMuc2VsZWN0ZWRBc3NldElEKVxuICAgIGlmICh3YWxsZXREZWYudHlwZSAhPT0gY3VycmVudERlZi50eXBlKSB0aGlzLnNldFJlY292ZXJ5U3VwcG9ydE1zZ1ZpeihmYWxzZSwgd2FsbGV0LnN5bWJvbClcbiAgICBlbHNlIHRoaXMuc2hvd09ySGlkZVJlY292ZXJ5U3VwcG9ydE1zZyh3YWxsZXQsIHdhbGxldERlZi5zZWVkZWQpXG4gICAgdGhpcy5zZXRHdWlkZUxpbmsod2FsbGV0RGVmLmd1aWRlbGluaylcbiAgICB0aGlzLnVwZGF0ZURpc3BsYXllZFJlY29uZmlnRmllbGRzKHdhbGxldERlZilcbiAgfVxuXG4gIHNldEd1aWRlTGluayAoZ3VpZGVMaW5rOiBzdHJpbmcpIHtcbiAgICBEb2MuaGlkZSh0aGlzLndhbGxldENmZ0d1aWRlKVxuICAgIGlmIChndWlkZUxpbmsgIT09ICcnKSB7XG4gICAgICB0aGlzLndhbGxldENmZ0d1aWRlLmhyZWYgPSBndWlkZUxpbmtcbiAgICAgIERvYy5zaG93KHRoaXMud2FsbGV0Q2ZnR3VpZGUpXG4gICAgfVxuICB9XG5cbiAgdXBkYXRlRGlzcGxheWVkUmVjb25maWdGaWVsZHMgKHdhbGxldERlZjogV2FsbGV0RGVmaW5pdGlvbikge1xuICAgIGNvbnN0IGRpc2FibGVQYXNzd29yZCA9IGFwcCgpLmV4dGVuc2lvbldhbGxldCh0aGlzLnNlbGVjdGVkQXNzZXRJRCk/LmRpc2FibGVQYXNzd29yZFxuICAgIGlmICh3YWxsZXREZWYuc2VlZGVkIHx8IHdhbGxldERlZi50eXBlID09PSAndG9rZW4nIHx8IGRpc2FibGVQYXNzd29yZCkge1xuICAgICAgRG9jLmhpZGUodGhpcy5wYWdlLnNob3dDaGFuZ2VQVywgdGhpcy5yZWNvbmZpZ0Zvcm0uZmlsZVNlbGVjdG9yKVxuICAgICAgdGhpcy5jaGFuZ2VXYWxsZXRQVyA9IGZhbHNlXG4gICAgICB0aGlzLnNldFBXU2V0dGluZ1ZpeihmYWxzZSlcbiAgICB9IGVsc2UgRG9jLnNob3codGhpcy5wYWdlLnNob3dDaGFuZ2VQVywgdGhpcy5yZWNvbmZpZ0Zvcm0uZmlsZVNlbGVjdG9yKVxuICB9XG5cbiAgLyogRGlzcGxheSBhIGRlcG9zaXQgYWRkcmVzcy4gKi9cbiAgYXN5bmMgc2hvd0RlcG9zaXQgKGFzc2V0SUQ6IG51bWJlcikge1xuICAgIHRoaXMuZGVwb3NpdEFkZHJGb3JtLnNldEFzc2V0KGFzc2V0SUQpXG4gICAgdGhpcy5zaG93Rm9ybSh0aGlzLnBhZ2UuZGVwb3NpdClcbiAgfVxuXG4gIC8qIFNob3cgdGhlIGZvcm0gdG8gZWl0aGVyIHNlbmQgb3Igd2l0aGRyYXcgZnVuZHMuICovXG4gIGFzeW5jIHNob3dTZW5kRm9ybSAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGJveCA9IHBhZ2Uuc2VuZEZvcm1cbiAgICBjb25zdCB7IHdhbGxldCwgdW5pdEluZm86IHVpLCBzeW1ib2wsIHRva2VuIH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICBEb2MuaGlkZShwYWdlLnRvZ2dsZVN1YnRyYWN0KVxuICAgIHBhZ2Uuc3VidHJhY3RDaGVja0JveC5jaGVja2VkID0gZmFsc2VcblxuICAgIGNvbnN0IGlzV2l0aGRyYXdlciA9ICh3YWxsZXQudHJhaXRzICYgdHJhaXRXaXRoZHJhd2VyKSAhPT0gMFxuICAgIGlmIChpc1dpdGhkcmF3ZXIpIHtcbiAgICAgIERvYy5zaG93KHBhZ2UudG9nZ2xlU3VidHJhY3QpXG4gICAgfVxuXG4gICAgRG9jLmhpZGUocGFnZS52YWxpZEFkZHIsIHBhZ2Uuc2VuZEVyciwgcGFnZS5tYXhTZW5kRGlzcGxheSwgcGFnZS5zZW5kVG9rZW5Nc2dCb3gpXG4gICAgcGFnZS5zZW5kQWRkci5jbGFzc0xpc3QucmVtb3ZlKCdpbnZhbGlkJylcbiAgICBwYWdlLnNlbmRBZGRyLnZhbHVlID0gJydcbiAgICBwYWdlLnNlbmRBbXQudmFsdWUgPSAnJ1xuICAgIGNvbnN0IHhjUmF0ZSA9IGFwcCgpLmZpYXRSYXRlc01hcFthc3NldElEXVxuICAgIERvYy5zaG93RmlhdFZhbHVlKHBhZ2Uuc2VuZFZhbHVlLCAwLCB4Y1JhdGUsIHVpKVxuICAgIHBhZ2Uud2FsbGV0QmFsLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24od2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlLCB1aSlcbiAgICBwYWdlLnNlbmRMb2dvLnNyYyA9IERvYy5sb2dvUGF0aChzeW1ib2wpXG4gICAgcGFnZS5zZW5kTmFtZS50ZXh0Q29udGVudCA9IHVpLmNvbnZlbnRpb25hbC51bml0XG4gICAgaWYgKHRva2VuKSB7XG4gICAgICBjb25zdCBwYXJlbnRBc3NldCA9IGFwcCgpLmFzc2V0c1t0b2tlbi5wYXJlbnRJRF1cbiAgICAgIHBhZ2Uuc2VuZFRva2VuUGFyZW50TG9nby5zcmMgPSBEb2MubG9nb1BhdGgocGFyZW50QXNzZXQuc3ltYm9sKVxuICAgICAgcGFnZS5zZW5kVG9rZW5QYXJlbnROYW1lLnRleHRDb250ZW50ID0gcGFyZW50QXNzZXQubmFtZVxuICAgICAgRG9jLnNob3cocGFnZS5zZW5kVG9rZW5Nc2dCb3gpXG4gICAgfVxuICAgIC8vIHBhZ2Uuc2VuZEZlZS50ZXh0Q29udGVudCA9IHdhbGxldC5mZWVyYXRlXG4gICAgLy8gcGFnZS5zZW5kVW5pdC50ZXh0Q29udGVudCA9IHdhbGxldC51bml0c1xuXG4gICAgaWYgKHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSA+IDAgJiYgKHdhbGxldC50cmFpdHMgJiB0cmFpdFR4RmVlRXN0aW1hdG9yKSAhPT0gMCkge1xuICAgICAgY29uc3QgZmVlUmVxID0ge1xuICAgICAgICBhc3NldElEOiBhc3NldElELFxuICAgICAgICBzdWJ0cmFjdDogaXNXaXRoZHJhd2VyLFxuICAgICAgICBtYXhXaXRoZHJhdzogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZVxuICAgICAgfVxuXG4gICAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHRoaXMuYm9keSlcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKCcvYXBpL3R4ZmVlJywgZmVlUmVxKVxuICAgICAgbG9hZGVkKClcbiAgICAgIGlmIChhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgICAgbGV0IGNhblNlbmQgPSB3YWxsZXQuYmFsYW5jZS5hdmFpbGFibGVcbiAgICAgICAgaWYgKCF0b2tlbikge1xuICAgICAgICAgIGNhblNlbmQgLT0gcmVzLnR4ZmVlXG4gICAgICAgICAgaWYgKGNhblNlbmQgPCAwKSBjYW5TZW5kID0gMFxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5tYXhTZW5kID0gY2FuU2VuZFxuICAgICAgICBwYWdlLm1heFNlbmQudGV4dENvbnRlbnQgPSBEb2MuZm9ybWF0RnVsbFByZWNpc2lvbihjYW5TZW5kLCB1aSlcbiAgICAgICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5tYXhTZW5kRmlhdCwgY2FuU2VuZCwgeGNSYXRlLCB1aSlcbiAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgY29uc3QgZmVlVUkgPSBhcHAoKS5hc3NldHNbdG9rZW4ucGFyZW50SURdLnVuaXRJbmZvXG4gICAgICAgICAgcGFnZS5tYXhTZW5kRmVlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24ocmVzLnR4ZmVlLCBmZWVVSSkgKyAnICcgKyBmZWVVSS5jb252ZW50aW9uYWwudW5pdFxuICAgICAgICAgIERvYy5zaG93RmlhdFZhbHVlKHBhZ2UubWF4U2VuZEZlZUZpYXQsIHJlcy50eGZlZSwgYXBwKCkuZmlhdFJhdGVzTWFwW3Rva2VuLnBhcmVudElEXSwgZmVlVUkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGFnZS5tYXhTZW5kRmVlLnRleHRDb250ZW50ID0gRG9jLmZvcm1hdEZ1bGxQcmVjaXNpb24ocmVzLnR4ZmVlLCB1aSlcbiAgICAgICAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLm1heFNlbmRGZWVGaWF0LCByZXMudHhmZWUsIHhjUmF0ZSwgdWkpXG4gICAgICAgIH1cbiAgICAgICAgRG9jLnNob3cocGFnZS5tYXhTZW5kRGlzcGxheSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLnNlbmRWYWx1ZSwgMCwgeGNSYXRlLCB1aSlcbiAgICBwYWdlLndhbGxldEJhbC50ZXh0Q29udGVudCA9IERvYy5mb3JtYXRGdWxsUHJlY2lzaW9uKHdhbGxldC5iYWxhbmNlLmF2YWlsYWJsZSwgdWkpXG4gICAgYm94LmRhdGFzZXQuYXNzZXRJRCA9IFN0cmluZyhhc3NldElEKVxuICAgIHRoaXMuc2hvd0Zvcm0oYm94KVxuICB9XG5cbiAgLyogZG9Db25uZWN0IGNvbm5lY3RzIHRvIGEgd2FsbGV0IHZpYSB0aGUgY29ubmVjdHdhbGxldCBBUEkgcm91dGUuICovXG4gIGFzeW5jIGRvQ29ubmVjdCAoYXNzZXRJRDogbnVtYmVyKSB7XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyh0aGlzLmJvZHkpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04oJy9hcGkvY29ubmVjdHdhbGxldCcsIHsgYXNzZXRJRCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIGNvbnN0IHsgc3ltYm9sIH0gPSBhcHAoKS5hc3NldHNbYXNzZXRJRF1cbiAgICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICAgIHBhZ2UuZXJyb3JNb2RhbE1zZy50ZXh0Q29udGVudCA9IGludGwucHJlcChpbnRsLklEX0NPTk5FQ1RfV0FMTEVUX0VSUl9NU0csIHsgYXNzZXROYW1lOiBzeW1ib2wsIGVyck1zZzogcmVzLm1zZyB9KVxuICAgICAgdGhpcy5zaG93Rm9ybShwYWdlLmVycm9yTW9kYWwpXG4gICAgfVxuICAgIHRoaXMudXBkYXRlRGlzcGxheWVkQXNzZXQoYXNzZXRJRClcbiAgfVxuXG4gIGFzc2V0VXBkYXRlZCAoYXNzZXRJRDogbnVtYmVyLCBvbGRGb3JtPzogUGFnZUVsZW1lbnQsIHN1Y2Nlc3NNc2c/OiBzdHJpbmcpIHtcbiAgICBpZiAoYXNzZXRJRCAhPT0gdGhpcy5zZWxlY3RlZEFzc2V0SUQpIHJldHVyblxuICAgIHRoaXMudXBkYXRlRGlzcGxheWVkQXNzZXQoYXNzZXRJRClcbiAgICBpZiAob2xkRm9ybSAmJiBPYmplY3QuaXModGhpcy5jdXJyZW50Rm9ybSwgb2xkRm9ybSkpIHtcbiAgICAgIGlmIChzdWNjZXNzTXNnKSB0aGlzLnNob3dTdWNjZXNzKHN1Y2Nlc3NNc2cpXG4gICAgICBlbHNlIHRoaXMuY2xvc2VQb3B1cHMoKVxuICAgIH1cbiAgfVxuXG4gIC8qIHBvcHVsYXRlTWF4U2VuZCBwb3B1bGF0ZXMgdGhlIGFtb3VudCBmaWVsZCB3aXRoIHRoZSBtYXggYW1vdW50IHRoZSB3YWxsZXRcbiAgICAgY2FuIHNlbmQuIFRoZSBtYXggc2VuZCBhbW91bnQgY2FuIGJlIHRoZSBtYXhpbXVtIGFtb3VudCBiYXNlZCBvbiBvdXJcbiAgICAgcHJlLWVzdGltYXRpb24gb3IgdGhlIGFzc2V0J3Mgd2FsbGV0IGJhbGFuY2UuXG4gICovXG4gIGFzeW5jIHBvcHVsYXRlTWF4U2VuZCAoKSB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IHsgaWQ6IGFzc2V0SUQsIHVuaXRJbmZvOiB1aSwgd2FsbGV0IH0gPSBhcHAoKS5hc3NldHNbdGhpcy5zZWxlY3RlZEFzc2V0SURdXG4gICAgLy8gUG9wdWxhdGUgc2VuZCBhbW91bnQgd2l0aCBtYXggc2VuZCB2YWx1ZSBhbmQgZW5zdXJlIHdlIGRvbid0IGNoZWNrXG4gICAgLy8gc3VidHJhY3QgY2hlY2tib3ggZm9yIGFzc2V0cyB0aGF0IGRvbid0IGhhdmUgYSB3aXRoZHJhdyBtZXRob2QuXG4gICAgY29uc3QgeGNSYXRlID0gYXBwKCkuZmlhdFJhdGVzTWFwW2Fzc2V0SURdXG4gICAgaWYgKCh3YWxsZXQudHJhaXRzICYgdHJhaXRXaXRoZHJhd2VyKSA9PT0gMCkge1xuICAgICAgcGFnZS5zZW5kQW10LnZhbHVlID0gU3RyaW5nKHRoaXMubWF4U2VuZCAvIHVpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yKVxuICAgICAgRG9jLnNob3dGaWF0VmFsdWUocGFnZS5zZW5kVmFsdWUsIHRoaXMubWF4U2VuZCwgeGNSYXRlLCB1aSlcbiAgICAgIHBhZ2Uuc3VidHJhY3RDaGVja0JveC5jaGVja2VkID0gZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgYW10ID0gd2FsbGV0LmJhbGFuY2UuYXZhaWxhYmxlXG4gICAgICBwYWdlLnNlbmRBbXQudmFsdWUgPSBTdHJpbmcoYW10IC8gdWkuY29udmVudGlvbmFsLmNvbnZlcnNpb25GYWN0b3IpXG4gICAgICBEb2Muc2hvd0ZpYXRWYWx1ZShwYWdlLnNlbmRWYWx1ZSwgYW10LCB4Y1JhdGUsIHVpKVxuICAgICAgcGFnZS5zdWJ0cmFjdENoZWNrQm94LmNoZWNrZWQgPSB0cnVlXG4gICAgfVxuICB9XG5cbiAgLyogc2VuZCBzdWJtaXRzIHRoZSBzZW5kIGZvcm0gdG8gdGhlIEFQSS4gKi9cbiAgYXN5bmMgc2VuZCAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIGNvbnN0IGFzc2V0SUQgPSBwYXJzZUludChwYWdlLnNlbmRGb3JtLmRhdGFzZXQuYXNzZXRJRCA/PyAnJylcbiAgICBjb25zdCBzdWJ0cmFjdCA9IHBhZ2Uuc3VidHJhY3RDaGVja0JveC5jaGVja2VkID8/IGZhbHNlXG4gICAgY29uc3QgY29udmVyc2lvbkZhY3RvciA9IGFwcCgpLnVuaXRJbmZvKGFzc2V0SUQpLmNvbnZlbnRpb25hbC5jb252ZXJzaW9uRmFjdG9yXG4gICAgY29uc3QgcHcgPSBwYWdlLnZTZW5kUHcudmFsdWUgfHwgJydcbiAgICBwYWdlLnZTZW5kUHcudmFsdWUgPSAnJ1xuICAgIGlmIChwdyA9PT0gJycpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UudlNlbmRFcnIsIGludGwucHJlcChpbnRsLklEX05PX1BBU1NfRVJST1JfTVNHKSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCBvcGVuID0ge1xuICAgICAgYXNzZXRJRDogYXNzZXRJRCxcbiAgICAgIGFkZHJlc3M6IHBhZ2Uuc2VuZEFkZHIudmFsdWUsXG4gICAgICBzdWJ0cmFjdDogc3VidHJhY3QsXG4gICAgICB2YWx1ZTogTWF0aC5yb3VuZChwYXJzZUZsb2F0RGVmYXVsdChwYWdlLnNlbmRBbXQudmFsdWUpICogY29udmVyc2lvbkZhY3RvciksXG4gICAgICBwdzogcHdcbiAgICB9XG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnZTZW5kRm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9zZW5kJywgb3BlbilcbiAgICBsb2FkZWQoKVxuICAgIGlmICghYXBwKCkuY2hlY2tSZXNwb25zZShyZXMpKSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLnZTZW5kRXJyLCByZXMubXNnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIGNvbnN0IG5hbWUgPSBhcHAoKS5hc3NldHNbYXNzZXRJRF0ubmFtZVxuICAgIHRoaXMuYXNzZXRVcGRhdGVkKGFzc2V0SUQsIHBhZ2UudlNlbmRGb3JtLCBpbnRsLnByZXAoaW50bC5JRF9TRU5EX1NVQ0NFU1MsIHsgYXNzZXROYW1lOiBuYW1lIH0pKVxuICB9XG5cbiAgLyogdXBkYXRlIHdhbGxldCBjb25maWd1cmF0aW9uICovXG4gIGFzeW5jIHJlY29uZmlnICgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwYWdlID0gdGhpcy5wYWdlXG4gICAgY29uc3QgYXNzZXRJRCA9IHRoaXMuc2VsZWN0ZWRBc3NldElEXG4gICAgRG9jLmhpZGUocGFnZS5yZWNvbmZpZ0VycilcbiAgICBsZXQgd2FsbGV0VHlwZSA9IGFwcCgpLmN1cnJlbnRXYWxsZXREZWZpbml0aW9uKGFzc2V0SUQpLnR5cGVcbiAgICBpZiAoIURvYy5pc0hpZGRlbihwYWdlLmNoYW5nZVdhbGxldFR5cGUpKSB7XG4gICAgICB3YWxsZXRUeXBlID0gcGFnZS5jaGFuZ2VXYWxsZXRUeXBlU2VsZWN0LnZhbHVlIHx8ICcnXG4gICAgfVxuXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLnJlY29uZmlnRm9ybSlcbiAgICBjb25zdCByZXE6IFJlY29uZmlnUmVxdWVzdCA9IHtcbiAgICAgIGFzc2V0SUQ6IGFzc2V0SUQsXG4gICAgICBjb25maWc6IHRoaXMucmVjb25maWdGb3JtLm1hcChhc3NldElEKSxcbiAgICAgIHdhbGxldFR5cGU6IHdhbGxldFR5cGVcbiAgICB9XG4gICAgaWYgKHRoaXMuY2hhbmdlV2FsbGV0UFcpIHJlcS5uZXdXYWxsZXRQVyA9IHBhZ2UubmV3UFcudmFsdWVcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnNhZmVQb3N0KCcvYXBpL3JlY29uZmlndXJld2FsbGV0JywgcmVxKVxuICAgIHBhZ2UubmV3UFcudmFsdWUgPSAnJ1xuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIERvYy5zaG93Rm9ybUVycm9yKHBhZ2UucmVjb25maWdFcnIsIHJlcy5tc2cpXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHRoaXMuZGF0YT8uZ29CYWNrKSB7XG4gICAgICBhcHAoKS5sb2FkUGFnZSh0aGlzLmRhdGEuZ29CYWNrKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHRoaXMuYXNzZXRVcGRhdGVkKGFzc2V0SUQsIHBhZ2UucmVjb25maWdGb3JtLCBpbnRsLnByZXAoaW50bC5JRF9SRUNPTkZJR19TVUNDRVNTKSlcbiAgICB0aGlzLnVwZGF0ZVRpY2tldEJ1eWVyKGFzc2V0SUQpXG4gICAgYXBwKCkuY2xlYXJUeEhpc3RvcnkoYXNzZXRJRClcbiAgICB0aGlzLnNob3dUeEhpc3RvcnkoYXNzZXRJRClcbiAgICB0aGlzLnVwZGF0ZVByaXZhY3koYXNzZXRJRClcbiAgICB0aGlzLmNoZWNrTmVlZHNQcm92aWRlcihhc3NldElEKVxuICB9XG5cbiAgLyogbG9jayBpbnN0cnVjdHMgdGhlIEFQSSB0byBsb2NrIHRoZSB3YWxsZXQuICovXG4gIGFzeW5jIGxvY2sgKGFzc2V0SUQ6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UubmV3V2FsbGV0Rm9ybSlcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTignL2FwaS9jbG9zZXdhbGxldCcsIHsgYXNzZXRJRDogYXNzZXRJRCB9KVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKCFhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHJldHVyblxuICAgIHRoaXMudXBkYXRlRGlzcGxheWVkQXNzZXQoYXNzZXRJRClcbiAgICB0aGlzLnVwZGF0ZVByaXZhY3koYXNzZXRJRClcbiAgfVxuXG4gIGFzeW5jIGRvd25sb2FkTG9ncyAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qgc2VhcmNoID0gbmV3IFVSTFNlYXJjaFBhcmFtcygnJylcbiAgICBzZWFyY2guYXBwZW5kKCdhc3NldGlkJywgYCR7dGhpcy5zZWxlY3RlZEFzc2V0SUR9YClcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuICAgIHVybC5zZWFyY2ggPSBzZWFyY2gudG9TdHJpbmcoKVxuICAgIHVybC5wYXRobmFtZSA9ICcvd2FsbGV0cy9sb2dmaWxlJ1xuICAgIHdpbmRvdy5vcGVuKHVybC50b1N0cmluZygpKVxuICB9XG5cbiAgLy8gZGlzcGxheUV4cG9ydFdhbGxldEF1dGggZGlzcGxheXMgYSBmb3JtIHRvIHdhcm4gdGhlIHVzZXIgYWJvdXQgdGhlXG4gIC8vIGRhbmdlcnMgb2YgZXhwb3J0aW5nIGEgd2FsbGV0LCBhbmQgYXNrcyB0aGVtIHRvIGVudGVyIHRoZWlyIHBhc3N3b3JkLlxuICBhc3luYyBkaXNwbGF5RXhwb3J0V2FsbGV0QXV0aCAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcGFnZSA9IHRoaXMucGFnZVxuICAgIERvYy5oaWRlKHBhZ2UuZXhwb3J0V2FsbGV0RXJyKVxuICAgIHBhZ2UuZXhwb3J0V2FsbGV0UFcudmFsdWUgPSAnJ1xuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5leHBvcnRXYWxsZXRBdXRoKVxuICB9XG5cbiAgLy8gZXhwb3J0V2FsbGV0QXV0aFN1Ym1pdCBpcyBjYWxsZWQgYWZ0ZXIgdGhlIHVzZXIgZW50ZXJzIHRoZWlyIHBhc3N3b3JkIHRvXG4gIC8vIGF1dGhvcml6ZSBsb29raW5nIHVwIHRoZSBpbmZvcm1hdGlvbiB0byByZXN0b3JlIHRoZWlyIHdhbGxldCBpbiBhblxuICAvLyBleHRlcm5hbCB3YWxsZXQuXG4gIGFzeW5jIGV4cG9ydFdhbGxldEF1dGhTdWJtaXQgKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBjb25zdCByZXEgPSB7XG4gICAgICBhc3NldElEOiB0aGlzLnNlbGVjdGVkQXNzZXRJRCxcbiAgICAgIHBhc3M6IHBhZ2UuZXhwb3J0V2FsbGV0UFcudmFsdWVcbiAgICB9XG4gICAgY29uc3QgdXJsID0gJy9hcGkvcmVzdG9yZXdhbGxldGluZm8nXG4gICAgY29uc3QgbG9hZGVkID0gYXBwKCkubG9hZGluZyhwYWdlLmZvcm1zKVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBvc3RKU09OKHVybCwgcmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKGFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkge1xuICAgICAgcGFnZS5leHBvcnRXYWxsZXRQVy52YWx1ZSA9ICcnXG4gICAgICB0aGlzLmRpc3BsYXlSZXN0b3JlV2FsbGV0SW5mbyhyZXMucmVzdG9yYXRpb25pbmZvKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmV4cG9ydFdhbGxldEVyciwgcmVzLm1zZylcbiAgICB9XG4gIH1cblxuICAvLyBkaXNwbGF5UmVzdG9yZVdhbGxldEluZm8gZGlzcGxheXMgdGhlIGluZm9ybWF0aW9uIG5lZWRlZCB0byByZXN0b3JlIGFcbiAgLy8gd2FsbGV0IGluIGV4dGVybmFsIHdhbGxldHMuXG4gIGFzeW5jIGRpc3BsYXlSZXN0b3JlV2FsbGV0SW5mbyAoaW5mbzogV2FsbGV0UmVzdG9yYXRpb25bXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuZW1wdHkocGFnZS5yZXN0b3JlSW5mb0NhcmRzTGlzdClcbiAgICBmb3IgKGNvbnN0IHdyIG9mIGluZm8pIHtcbiAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLnJlc3RvcmVJbmZvQ2FyZC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnRcbiAgICAgIGNvbnN0IHRtcGwgPSBEb2MucGFyc2VUZW1wbGF0ZShjYXJkKVxuICAgICAgdG1wbC5uYW1lLnRleHRDb250ZW50ID0gd3IudGFyZ2V0XG4gICAgICB0bXBsLnNlZWQudGV4dENvbnRlbnQgPSB3ci5zZWVkXG4gICAgICB0bXBsLnNlZWROYW1lLnRleHRDb250ZW50ID0gYCR7d3Iuc2VlZE5hbWV9OmBcbiAgICAgIHRtcGwuaW5zdHJ1Y3Rpb25zLnRleHRDb250ZW50ID0gd3IuaW5zdHJ1Y3Rpb25zXG4gICAgICBwYWdlLnJlc3RvcmVJbmZvQ2FyZHNMaXN0LmFwcGVuZENoaWxkKGNhcmQpXG4gICAgfVxuICAgIHRoaXMuc2hvd0Zvcm0ocGFnZS5yZXN0b3JlV2FsbGV0SW5mbylcbiAgfVxuXG4gIGFzeW5jIHJlY292ZXJXYWxsZXQgKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICBEb2MuaGlkZShwYWdlLnJlY292ZXJXYWxsZXRFcnIpXG4gICAgY29uc3QgcmVxID0ge1xuICAgICAgYXNzZXRJRDogdGhpcy5zZWxlY3RlZEFzc2V0SURcbiAgICB9XG4gICAgY29uc3QgdXJsID0gJy9hcGkvcmVjb3ZlcndhbGxldCdcbiAgICBjb25zdCBsb2FkZWQgPSBhcHAoKS5sb2FkaW5nKHBhZ2UuZm9ybXMpXG4gICAgY29uc3QgcmVzID0gYXdhaXQgcG9zdEpTT04odXJsLCByZXEpXG4gICAgbG9hZGVkKClcbiAgICBpZiAocmVzLmNvZGUgPT09IEVycm9ycy5hY3RpdmVPcmRlcnNFcnIpIHtcbiAgICAgIHRoaXMuZm9yY2VVcmwgPSB1cmxcbiAgICAgIHRoaXMuZm9yY2VSZXEgPSByZXFcbiAgICAgIHRoaXMuc2hvd0NvbmZpcm1Gb3JjZSgpXG4gICAgfSBlbHNlIGlmIChhcHAoKS5jaGVja1Jlc3BvbnNlKHJlcykpIHtcbiAgICAgIHRoaXMuY2xvc2VQb3B1cHMoKVxuICAgIH0gZWxzZSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLnJlY292ZXJXYWxsZXRFcnIsIHJlcy5tc2cpXG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogY29uZmlybUZvcmNlU3VibWl0IHJlc3VibWl0cyBlaXRoZXIgdGhlIHJlY292ZXIgb3IgcmVzY2FuIHJlcXVlc3RzIHdpdGhcbiAgICogZm9yY2Ugc2V0IHRvIHRydWUuIFRoZXNlIHR3byByZXF1ZXN0cyByZXF1aXJlIGZvcmNlIHRvIGJlIHNldCB0byB0cnVlIGlmXG4gICAqIHRoZXkgYXJlIGNhbGxlZCB3aGlsZSB0aGUgd2FsbGV0IGlzIG1hbmFnaW5nIGFjdGl2ZSBvcmRlcnMuXG4gICAqL1xuICBhc3luYyBjb25maXJtRm9yY2VTdWJtaXQgKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBhZ2UgPSB0aGlzLnBhZ2VcbiAgICB0aGlzLmZvcmNlUmVxLmZvcmNlID0gdHJ1ZVxuICAgIGNvbnN0IGxvYWRlZCA9IGFwcCgpLmxvYWRpbmcocGFnZS5mb3JtcylcbiAgICBjb25zdCByZXMgPSBhd2FpdCBwb3N0SlNPTih0aGlzLmZvcmNlVXJsLCB0aGlzLmZvcmNlUmVxKVxuICAgIGxvYWRlZCgpXG4gICAgaWYgKGFwcCgpLmNoZWNrUmVzcG9uc2UocmVzKSkgdGhpcy5jbG9zZVBvcHVwcygpXG4gICAgZWxzZSB7XG4gICAgICBEb2Muc2hvd0Zvcm1FcnJvcihwYWdlLmNvbmZpcm1Gb3JjZUVyciwgcmVzLm1zZylcbiAgICB9XG4gIH1cblxuICAvKiBoYW5kbGVCYWxhbmNlIGhhbmRsZXMgbm90aWZpY2F0aW9ucyB1cGRhdGluZyBhIHdhbGxldCdzIGJhbGFuY2UgYW5kIGFzc2V0cydcbiAgICAgdmFsdWUgaW4gZGVmYXVsdCBmaWF0IHJhdGUuXG4gIC4gKi9cbiAgaGFuZGxlQmFsYW5jZU5vdGUgKG5vdGU6IEJhbGFuY2VOb3RlKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGVBc3NldEJ1dHRvbihub3RlLmFzc2V0SUQpXG4gICAgaWYgKG5vdGUuYXNzZXRJRCA9PT0gdGhpcy5zZWxlY3RlZEFzc2V0SUQpIHRoaXMudXBkYXRlRGlzcGxheWVkQXNzZXRCYWxhbmNlKClcbiAgfVxuXG4gIC8qIGhhbmRsZVJhdGVzTm90ZSBoYW5kbGVzIGZpYXQgcmF0ZSBub3RpZmljYXRpb25zLCB1cGRhdGluZyB0aGUgZmlhdCB2YWx1ZSBvZlxuICAgKiAgYWxsIHN1cHBvcnRlZCBhc3NldHMuXG4gICAqL1xuICBoYW5kbGVSYXRlc05vdGUgKG5vdGU6IFJhdGVOb3RlKTogdm9pZCB7XG4gICAgdGhpcy51cGRhdGVBc3NldEJ1dHRvbih0aGlzLnNlbGVjdGVkQXNzZXRJRClcbiAgICBpZiAoIW5vdGUuZmlhdFJhdGVzW3RoaXMuc2VsZWN0ZWRBc3NldElEXSkgcmV0dXJuXG4gICAgdGhpcy51cGRhdGVEaXNwbGF5ZWRBc3NldEJhbGFuY2UoKVxuICAgIGNvbnN0IHsgZmVlU3RhdGUgfSA9IGFwcCgpLndhbGxldE1hcFt0aGlzLnNlbGVjdGVkQXNzZXRJRF1cbiAgICBpZiAoZmVlU3RhdGUpIHRoaXMudXBkYXRlRmVlU3RhdGUoZmVlU3RhdGUpXG4gIH1cblxuICAvKlxuICAgKiBoYW5kbGVXYWxsZXRTdGF0ZU5vdGUgaXMgYSBoYW5kbGVyIGZvciBib3RoIHRoZSAnd2FsbGV0c3RhdGUnIGFuZFxuICAgKiAnd2FsbGV0Y29uZmlnJyBub3RpZmljYXRpb25zLlxuICAgKi9cbiAgaGFuZGxlV2FsbGV0U3RhdGVOb3RlIChub3RlOiBXYWxsZXRTdGF0ZU5vdGUpOiB2b2lkIHtcbiAgICBjb25zdCB7IGFzc2V0SUQsIGZlZVN0YXRlIH0gPSBub3RlLndhbGxldFxuICAgIHRoaXMudXBkYXRlQXNzZXRCdXR0b24oYXNzZXRJRClcbiAgICB0aGlzLmFzc2V0VXBkYXRlZChhc3NldElEKVxuICAgIGlmIChub3RlLnRvcGljID09PSAnV2FsbGV0UGVlcnNVcGRhdGUnICYmXG4gICAgICAgIGFzc2V0SUQgPT09IHRoaXMuc2VsZWN0ZWRBc3NldElEICYmXG4gICAgICAgIERvYy5pc0Rpc3BsYXllZCh0aGlzLnBhZ2UubWFuYWdlUGVlcnNGb3JtKSkge1xuICAgICAgdGhpcy51cGRhdGVXYWxsZXRQZWVyc1RhYmxlKClcbiAgICB9XG4gICAgaWYgKGZlZVN0YXRlICYmIGFzc2V0SUQgPT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSB0aGlzLnVwZGF0ZUZlZVN0YXRlKGZlZVN0YXRlKVxuICB9XG5cbiAgLypcbiAgICogaGFuZGxlQ3JlYXRlV2FsbGV0Tm90ZSBpcyBhIGhhbmRsZXIgZm9yICdjcmVhdGV3YWxsZXQnIG5vdGlmaWNhdGlvbnMuXG4gICAqL1xuICBoYW5kbGVDcmVhdGVXYWxsZXROb3RlIChub3RlOiBXYWxsZXRDcmVhdGlvbk5vdGUpIHtcbiAgICB0aGlzLnVwZGF0ZUFzc2V0QnV0dG9uKG5vdGUuYXNzZXRJRClcbiAgICB0aGlzLmFzc2V0VXBkYXRlZChub3RlLmFzc2V0SUQpXG4gICAgdGhpcy5zaG93VHhIaXN0b3J5KG5vdGUuYXNzZXRJRClcbiAgfVxuXG4gIGhhbmRsZUN1c3RvbVdhbGxldE5vdGUgKG5vdGU6IFdhbGxldE5vdGUpIHtcbiAgICBjb25zdCB3YWxsZXROb3RlID0gbm90ZS5wYXlsb2FkIGFzIEJhc2VXYWxsZXROb3RlXG4gICAgc3dpdGNoICh3YWxsZXROb3RlLnJvdXRlKSB7XG4gICAgICBjYXNlICd0aXBDaGFuZ2UnOiB7XG4gICAgICAgIGNvbnN0IG4gPSB3YWxsZXROb3RlIGFzIFRpcENoYW5nZU5vdGVcbiAgICAgICAgc3dpdGNoIChuLmFzc2V0SUQpIHtcbiAgICAgICAgICBjYXNlIDQyOiB7IC8vIGRjclxuICAgICAgICAgICAgaWYgKCF0aGlzLnN0YWtlU3RhdHVzKSByZXR1cm5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBuLmRhdGEgYXMgRGVjcmVkVGlja2V0VGlwVXBkYXRlXG4gICAgICAgICAgICBjb25zdCBzeW5jZWQgPSBhcHAoKS53YWxsZXRNYXBbbi5hc3NldElEXS5zeW5jZWRcbiAgICAgICAgICAgIGlmIChzeW5jZWQpIHtcbiAgICAgICAgICAgICAgY29uc3QgdWkgPSBhcHAoKS51bml0SW5mbyhuLmFzc2V0SUQpXG4gICAgICAgICAgICAgIHRoaXMudXBkYXRlVGlja2V0U3RhdHMoZGF0YS5zdGF0cywgdWksIGRhdGEudGlja2V0UHJpY2UsIGRhdGEudm90aW5nU3Vic2lkeSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3RpY2tldFB1cmNoYXNlVXBkYXRlJzoge1xuICAgICAgICB0aGlzLnByb2Nlc3NUaWNrZXRQdXJjaGFzZVVwZGF0ZSh3YWxsZXROb3RlIGFzIEN1c3RvbVdhbGxldE5vdGUpXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICBjYXNlICd0cmFuc2FjdGlvbic6IHtcbiAgICAgICAgY29uc3QgbiA9IHdhbGxldE5vdGUgYXMgVHJhbnNhY3Rpb25Ob3RlXG4gICAgICAgIGlmIChuLmFzc2V0SUQgPT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSB0aGlzLmhhbmRsZVR4Tm90ZShuLnRyYW5zYWN0aW9uLCBuLm5ldylcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGNhc2UgJ3RyYW5zYWN0aW9uSGlzdG9yeVN5bmNlZCcgOiB7XG4gICAgICAgIGNvbnN0IG4gPSB3YWxsZXROb3RlXG4gICAgICAgIGlmIChuLmFzc2V0SUQgPT09IHRoaXMuc2VsZWN0ZWRBc3NldElEKSB0aGlzLnNob3dUeEhpc3Rvcnkobi5hc3NldElEKVxuICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIHVubG9hZCBpcyBjYWxsZWQgYnkgdGhlIEFwcGxpY2F0aW9uIHdoZW4gdGhlIHVzZXIgbmF2aWdhdGVzIGF3YXkgZnJvbVxuICAgKiB0aGUgL3dhbGxldHMgcGFnZS5cbiAgICovXG4gIHVubG9hZCAoKTogdm9pZCB7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLnNlY29uZFRpY2tlcilcbiAgICBEb2MudW5iaW5kKGRvY3VtZW50LCAna2V5dXAnLCB0aGlzLmtleXVwKVxuICB9XG59XG5cbmZ1bmN0aW9uIHRyaW1TdHJpbmdXaXRoRWxsaXBzaXMgKHN0cjogc3RyaW5nLCBtYXhMZW46IG51bWJlcik6IHN0cmluZyB7XG4gIGlmIChzdHIubGVuZ3RoIDw9IG1heExlbikgcmV0dXJuIHN0clxuICByZXR1cm4gYCR7c3RyLnN1YnN0cmluZygwLCBtYXhMZW4gLyAyKX0uLi4ke3N0ci5zdWJzdHJpbmcoc3RyLmxlbmd0aCAtIG1heExlbiAvIDIpfWBcbn1cbiIsIi8vIE1lc3NhZ2VTb2NrZXQgaXMgYSBXZWJTb2NrZXQgbWFuYWdlciB0aGF0IHVzZXMgdGhlIERlY3JlZCBERVggTWVzc2FnZSBmb3JtYXRcbi8vIGZvciBjb21tdW5pY2F0aW9ucy5cbi8vXG4vLyBNZXNzYWdlIHJlcXVlc3QgZm9ybWF0OlxuLy8ge1xuLy8gICByb3V0ZTogJ25hbWUnLFxuLy8gICBpZDogaW50LFxuLy8gICBwYXlsb2FkOiBhbnl0aGluZyBvciBub3RoaW5nXG4vLyB9XG4vL1xuLy8gTWVzc2FnZSByZXNwb25zZSBwYXlsb2FkIHdpbGwgYmUgYSByZXN1bHQgb2JqZWN0IHdpdGggZWl0aGVyIGEgdmFsaWQgJ3Jlc3VsdCdcbi8vIGZpZWxkIG9yIGFuICdlcnJvcicgZmllbGRcbi8vXG4vLyBGdW5jdGlvbnMgZm9yIGV4dGVybmFsIHVzZTpcbi8vIHJlZ2lzdGVyUm91dGUgKHJvdXRlLCBoYW5kbGVyKSAtLSByZWdpc3RlciBhIGZ1bmN0aW9uIHRvIGhhbmRsZSBldmVudHNcbi8vIG9mIHRoZSBnaXZlbiB0eXBlXG4vLyByZXF1ZXN0IChyb3V0ZSwgcGF5bG9hZCkgLS0gY3JlYXRlIGEgSlNPTiBtZXNzYWdlIGluIHRoZSBhYm92ZSBmb3JtYXQgYW5kXG4vLyBzZW5kIGl0XG4vL1xuLy8gQmFzZWQgb24gbWVzc2FnZXNvY2tldF9zZXJ2aWNlLmpzIGJ5IEpvbmF0aGFuIENoYXBwZWxvdyBAIGRjcmRhdGEsIHdoaWNoIGlzXG4vLyBiYXNlZCBvbiB3c19ldmVudHNfZGlzcGF0Y2hlci5qcyBieSBJc21hZWwgQ2VsaXNcbmNvbnN0IHR5cGVSZXF1ZXN0ID0gMVxuXG5mdW5jdGlvbiBmb3J3YXJkIChyb3V0ZTogc3RyaW5nLCBwYXlsb2FkOiBhbnksIGhhbmRsZXJzOiBSZWNvcmQ8c3RyaW5nLCAoKHBheWxvYWQ6IGFueSkgPT4gdm9pZClbXT4pIHtcbiAgaWYgKCFyb3V0ZSAmJiBwYXlsb2FkLmVycm9yKSB7XG4gICAgY29uc3QgZXJyID0gcGF5bG9hZC5lcnJvclxuICAgIGNvbnNvbGUuZXJyb3IoYHdlYnNvY2tldCBlcnJvciAoY29kZSAke2Vyci5jb2RlfSk6ICR7ZXJyLm1lc3NhZ2V9YClcbiAgICByZXR1cm5cbiAgfVxuICBpZiAodHlwZW9mIGhhbmRsZXJzW3JvdXRlXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhgdW5oYW5kbGVkIG1lc3NhZ2UgZm9yICR7cm91dGV9OiAke3BheWxvYWR9YClcbiAgICByZXR1cm5cbiAgfVxuICAvLyBjYWxsIGVhY2ggaGFuZGxlclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGhhbmRsZXJzW3JvdXRlXS5sZW5ndGg7IGkrKykge1xuICAgIGhhbmRsZXJzW3JvdXRlXVtpXShwYXlsb2FkKVxuICB9XG59XG5cbmxldCBpZCA9IDBcblxudHlwZSBOb3RlUmVjZWl2ZXIgPSAocGF5bG9hZDogYW55KSA9PiB2b2lkXG5cbmNsYXNzIE1lc3NhZ2VTb2NrZXQge1xuICB1cmk6IHN0cmluZ1xuICBjb25uZWN0aW9uOiBXZWJTb2NrZXQgfCBudWxsXG4gIGhhbmRsZXJzOiBSZWNvcmQ8c3RyaW5nLCBOb3RlUmVjZWl2ZXJbXT5cbiAgcXVldWU6IFtzdHJpbmcsIGFueV1bXVxuICBtYXhRbGVuZ3RoOiBudW1iZXJcbiAgcmVsb2FkZXI6ICgpID0+IHZvaWQgLy8gYXBwZWFycyB1bnVzZWRcblxuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgdGhpcy5oYW5kbGVycyA9IHt9XG4gICAgdGhpcy5xdWV1ZSA9IFtdXG4gICAgdGhpcy5tYXhRbGVuZ3RoID0gNVxuICB9XG5cbiAgcmVnaXN0ZXJSb3V0ZSAocm91dGU6IHN0cmluZywgaGFuZGxlcjogTm90ZVJlY2VpdmVyKSB7XG4gICAgdGhpcy5oYW5kbGVyc1tyb3V0ZV0gPSB0aGlzLmhhbmRsZXJzW3JvdXRlXSB8fCBbXVxuICAgIHRoaXMuaGFuZGxlcnNbcm91dGVdLnB1c2goaGFuZGxlcilcbiAgfVxuXG4gIGRlcmVnaXN0ZXJSb3V0ZSAocm91dGU6IHN0cmluZykge1xuICAgIHRoaXMuaGFuZGxlcnNbcm91dGVdID0gW11cbiAgfVxuXG4gIC8vIHJlcXVlc3Qgc2VuZHMgYSByZXF1ZXN0LXR5cGUgbWVzc2FnZSB0byB0aGUgc2VydmVyXG4gIHJlcXVlc3QgKHJvdXRlOiBzdHJpbmcsIHBheWxvYWQ6IGFueSkge1xuICAgIGlmICghdGhpcy5jb25uZWN0aW9uIHx8IHRoaXMuY29ubmVjdGlvbi5yZWFkeVN0YXRlICE9PSB3aW5kb3cuV2ViU29ja2V0Lk9QRU4pIHtcbiAgICAgIHdoaWxlICh0aGlzLnF1ZXVlLmxlbmd0aCA+IHRoaXMubWF4UWxlbmd0aCAtIDEpIHRoaXMucXVldWUuc2hpZnQoKVxuICAgICAgdGhpcy5xdWV1ZS5wdXNoKFtyb3V0ZSwgcGF5bG9hZF0pXG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgaWQrK1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICByb3V0ZTogcm91dGUsXG4gICAgICB0eXBlOiB0eXBlUmVxdWVzdCxcbiAgICAgIGlkOiBpZCxcbiAgICAgIHBheWxvYWQ6IHBheWxvYWRcbiAgICB9KVxuXG4gICAgd2luZG93LmxvZygnd3MnLCAnc2VuZGluZycsIG1lc3NhZ2UpXG4gICAgdGhpcy5jb25uZWN0aW9uLnNlbmQobWVzc2FnZSlcbiAgfVxuXG4gIGNsb3NlIChyZWFzb246IHN0cmluZykge1xuICAgIHdpbmRvdy5sb2coJ3dzJywgJ2Nsb3NlLCByZWFzb246JywgcmVhc29uLCB0aGlzLmhhbmRsZXJzKVxuICAgIHRoaXMuaGFuZGxlcnMgPSB7fVxuICAgIGlmICh0aGlzLmNvbm5lY3Rpb24pIHRoaXMuY29ubmVjdGlvbi5jbG9zZSgpXG4gIH1cblxuICBjb25uZWN0ICh1cmk6IHN0cmluZywgcmVsb2FkZXI6ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLnVyaSA9IHVyaVxuICAgIHRoaXMucmVsb2FkZXIgPSByZWxvYWRlclxuICAgIGxldCByZXRyeXMgPSAwXG4gICAgY29uc3QgZ28gPSAoKSA9PiB7XG4gICAgICB3aW5kb3cubG9nKCd3cycsIGBjb25uZWN0aW5nIHRvICR7dXJpfWApXG4gICAgICBsZXQgY29ubjogV2ViU29ja2V0IHwgbnVsbCA9IHRoaXMuY29ubmVjdGlvbiA9IG5ldyB3aW5kb3cuV2ViU29ja2V0KHVyaSlcbiAgICAgIGlmICghY29ubikgcmV0dXJuXG4gICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIC8vIHJlYWR5U3RhdGUgaXMgc3RpbGwgV2ViU29ja2V0LkNPTk5FQ1RJTkcuIENhbmNlbCBhbmQgdHJpZ2dlciBvbmNsb3NlLlxuICAgICAgICBpZiAoY29ubikgY29ubi5jbG9zZSgpXG4gICAgICB9LCA1MDApXG5cbiAgICAgIC8vIHVubWFyc2hhbCBtZXNzYWdlLCBhbmQgZm9yd2FyZCB0aGUgbWVzc2FnZSB0byByZWdpc3RlcmVkIGhhbmRsZXJzXG4gICAgICBjb25uLm9ubWVzc2FnZSA9IChldnQ6IE1lc3NhZ2VFdmVudCkgPT4ge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gSlNPTi5wYXJzZShldnQuZGF0YSlcbiAgICAgICAgZm9yd2FyZChtZXNzYWdlLnJvdXRlLCBtZXNzYWdlLnBheWxvYWQsIHRoaXMuaGFuZGxlcnMpXG4gICAgICB9XG5cbiAgICAgIC8vIFN0dWIgb3V0IHN0YW5kYXJkIGZ1bmN0aW9uc1xuICAgICAgY29ubi5vbmNsb3NlID0gKGV2dDogQ2xvc2VFdmVudCkgPT4ge1xuICAgICAgICB3aW5kb3cubG9nKCd3cycsICdvbmNsb3NlJylcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpXG4gICAgICAgIGNvbm4gPSB0aGlzLmNvbm5lY3Rpb24gPSBudWxsXG4gICAgICAgIGZvcndhcmQoJ2Nsb3NlJywgbnVsbCwgdGhpcy5oYW5kbGVycylcbiAgICAgICAgcmV0cnlzKytcbiAgICAgICAgLy8gMS4yLCAxLjYsIDIuMCwgMi40LCAzLjEsIDMuOCwgNC44LCA2LjAsIDcuNSwgOS4zLCAuLi5cbiAgICAgICAgY29uc3QgZGVsYXkgPSBNYXRoLm1pbihNYXRoLnBvdygxLjI1LCByZXRyeXMpLCAxMClcbiAgICAgICAgY29uc29sZS5lcnJvcihgd2Vic29ja2V0IGRpc2Nvbm5lY3RlZCAoJHtldnQuY29kZX0pLCB0cnlpbmcgYWdhaW4gaW4gJHtkZWxheS50b0ZpeGVkKDEpfSBzZWNvbmRzYClcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgZ28oKVxuICAgICAgICB9LCBkZWxheSAqIDEwMDApXG4gICAgICB9XG5cbiAgICAgIGNvbm4ub25vcGVuID0gKCkgPT4ge1xuICAgICAgICB3aW5kb3cubG9nKCd3cycsICdvbm9wZW4nKVxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dClcbiAgICAgICAgaWYgKHJldHJ5cyA+IDApIHtcbiAgICAgICAgICByZXRyeXMgPSAwXG4gICAgICAgICAgcmVsb2FkZXIoKVxuICAgICAgICB9XG4gICAgICAgIGZvcndhcmQoJ29wZW4nLCBudWxsLCB0aGlzLmhhbmRsZXJzKVxuICAgICAgICBjb25zdCBxdWV1ZSA9IHRoaXMucXVldWVcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdXG4gICAgICAgIGZvciAoY29uc3QgW3JvdXRlLCBtZXNzYWdlXSBvZiBxdWV1ZSkge1xuICAgICAgICAgIHRoaXMucmVxdWVzdChyb3V0ZSwgbWVzc2FnZSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25uLm9uZXJyb3IgPSAoZXZ0OiBFdmVudCkgPT4ge1xuICAgICAgICB3aW5kb3cubG9nKCd3cycsICdvbmVycm9yOicsIGV2dClcbiAgICAgICAgZm9yd2FyZCgnZXJyb3InLCBldnQsIHRoaXMuaGFuZGxlcnMpXG4gICAgICB9XG4gICAgfVxuICAgIGdvKClcbiAgfVxufVxuXG5jb25zdCB3cyA9IG5ldyBNZXNzYWdlU29ja2V0KClcbmV4cG9ydCBkZWZhdWx0IHdzXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCBBcHBsaWNhdGlvbiBmcm9tICcuL2pzL2FwcCdcbmltcG9ydCB7IHJlZ2lzdGVyQXBwbGljYXRpb24gfSBmcm9tICcuL2pzL3JlZ2lzdHJ5J1xuaW1wb3J0ICcuL2Nzcy9ib290c3RyYXAuc2NzcydcbmltcG9ydCAnLi9jc3MvYXBwbGljYXRpb24uc2NzcydcblxuY29uc3QgYXBwID0gbmV3IEFwcGxpY2F0aW9uKClcbnJlZ2lzdGVyQXBwbGljYXRpb24oYXBwKVxuYXBwLnN0YXJ0KClcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==