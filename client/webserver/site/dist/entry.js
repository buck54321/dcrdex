/*! For license information please see entry.js.LICENSE.txt */
(()=>{var e={61:(e,t,n)=>{var r=n(698).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var a=t&&t.prototype instanceof m?t:m,o=Object.create(a.prototype),i=new I(r||[]);return s(o,"_invoke",{value:S(e,n,i)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var f={};function m(){}function v(){}function y(){}var g={};h(g,c,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(R([])));w&&w!==n&&o.call(w,c)&&(g=w);var k=y.prototype=m.prototype=Object.create(g);function x(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(a,s,i,c){var l=p(e[a],e,s);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==r(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(h).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var a;s(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(o,o):o()}})}function S(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var s=n.delegate;if(s){var i=E(s,n);if(i){if(i===f)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=p(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var a=p(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,f;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function R(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:void 0,done:!0}}return v.prototype=y,s(k,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:v,configurable:!0}),v.displayName=h(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,h(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(C.prototype),h(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var s=new C(d(e,n,r,a),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},x(k),h(k,u,"Generator"),h(k,c,(function(){return this})),h(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(F),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var i=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(i&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),F(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;F(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},698:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},687:(e,t,n)=>{var r=n(61)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,s,i=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw a}}return i}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function i(e){a(s,r,o,i,c,"next",e)}function c(e){a(s,r,o,i,c,"throw",e)}i(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function c(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===i(t)?t:String(t)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d,p,f,m,v,y,g,b=n(687),w=n.n(b),k="ID_NO_PASS_ERROR_MSG",x="ID_NO_APP_PASS_ERROR_MSG",C="ID_SET_BUTTON_BUY",S="ID_SET_BUTTON_SELL",E="ID_OFF",A="ID_READY",F="ID_NO_WALLET",I="ID_DISABLED_MSG",R="ID_WALLET_SYNC_PROGRESS",D="ID_HIDE_ADDITIONAL_SETTINGS",O="ID_SHOW_ADDITIONAL_SETTINGS",T="ID_BUY",P="ID_SELL",L="ID_NOT_SUPPORTED",B="ID_VERSION_NOT_SUPPORTED",M="ID_CONNECTION_FAILED",W="ID_ORDER_PREVIEW",q="ID_CALCULATING",N="ID_ESTIMATE_UNAVAILABLE",U="ID_NO_ZERO_RATE",_="ID_NO_ZERO_QUANTITY",z="ID_TRADE",V="ID_NO_ASSET_WALLET",j="ID_EXECUTED",H="ID_BOOKED",G="ID_CANCELING",K="ID_PASSWORD_NOT_MATCH",X="ID_ACCT_UNDEFINED",Q="ID_KEEP_WALLET_PASS",Y="ID_NEW_WALLET_PASS",J="ID_LOT",Z="ID_LOTS",$="ID_UNKNOWN",ee="ID_EPOCH",te="ID_ORDER_SUBMITTING",ne="ID_SETTLING",re="ID_NO_MATCH",ae="ID_CANCELED",oe="ID_REVOKED",se="ID_WAITING_FOR_CONFS",ie="ID_NONE_SELECTED",ce="ID_REGISTRATION_FEE_SUCCESS",le="ID_API_ERROR",ue="ID_ADD",he="ID_CREATE",de="ID_SETUP_WALLET",pe="ID_WALLET_READY",fe="ID_CHANGE_WALLET_TYPE",me="ID_KEEP_WALLET_TYPE",ve="WALLET_READY",ye="WALLET_PENDING",ge="SETUP_NEEDED",be="SEND_SUCCESS",we="RECONFIG_SUCCESS",ke="RESCAN_STARTED",xe="NEW_WALLET_SUCCESS",Ce="WALLET_UNLOCKED",Se="ID_SELLING",Ee="ID_BUYING",Ae="WALLET_DISABLED",Fe="WALLET_ENABLED",Ie="ACTIVE_ORDERS_ERR_MSG",Re="AVAILABLE",De="LOCKED",Oe="IMMATURE",Te="FEE_BALANCE",Pe="CANDLES_LOADING",Le="DEPTH_LOADING",Be="INVALID_ADDRESS_MSG",Me="TXFEE_ERR_MSG",We="ACTIVE_ORDERS_LOGOUT_ERR_MSG",qe="INVALID_DATE_ERR_MSG",Ne="NO_ARCHIVED_RECORDS",Ue="DELETE_ARCHIVED_RECORDS_RESULT",_e="ARCHIVED_RECORDS_PATH",ze="DEFAULT",Ve="USER_ADDED",je="DISCOVERED",He="UNSUPPORTED_ASSET_INFO_ERR_MSG",Ge="LIMIT_ORDER",Ke="LIMIT_ORDER_IMMEDIATE_TIF",Xe="MARKET_ORDER",Qe="MATCH_STATUS_NEWLY_MATCHED",Ye="MATCH_STATUS_MAKER_SWAP_CAST",Je="MATCH_STATUS_TAKER_SWAP_CAST",Ze="MATCH_STATUS_MAKER_REDEEMED",$e="MATCH_STATUS_REDEMPTION_SENT",et="MATCH_REDEMPTION_CONFIRMED",tt="MATCH_STATUS_REVOKED",nt="MATCH_STATUS_REFUNDED",rt="MATCH_STATUS_REFUND_PENDING",at="MATCH_STATUS_REDEEM_PENDING",ot="MATCH_STATUS_COMPLETE",st="TAKER_FOUND_MAKER_REDEMPTION",it="OPEN_WALLET_ERR_MSG",ct="ORDER_ACCELERATION_FEE_ERR_MSG",lt="ORDER_ACCELERATION_FEE_ERR_MSG",ut="CONNECTED",ht="DISCONNECTED",dt="INVALID_CERTIFICATE",pt="ID_CONFIRMATIONS",ft="TAKER",mt="MAKER",vt="EMPTY_DEX_ADDRESS_MSG",yt="SELECT_WALLET_FOR_FEE_PAYMENT",gt="UNAVAILABLE",bt="WALLET_SYNC_FINISHING_UP",wt="CONNECTING_WALLET_ERR_MSG",kt=(h(d={},k,"password cannot be empty"),h(d,x,"app password cannot be empty"),h(d,K,"passwords do not match"),h(d,C,"Place order to buy  {{ asset }}"),h(d,S,"Place order to sell {{ asset }}"),h(d,E,"off"),h(d,A,"ready"),h(d,De,"locked"),h(d,F,"no wallet"),h(d,R,"wallet is {{ syncProgress }}% synced"),h(d,D,"hide additional settings"),h(d,O,"show additional settings"),h(d,T,"Buy"),h(d,P,"Sell"),h(d,L,"{{ asset }} is not supported"),h(d,B,"{{ asset }} (v{{version}}) is not supported"),h(d,M,"Connection to dex server failed. You can close dexc and try again later or wait for it to reconnect."),h(d,W,"Total: {{ total }} {{ asset }}"),h(d,q,"calculating..."),h(d,N,"estimate unavailable"),h(d,U,"zero rate not allowed"),h(d,_,"zero quantity not allowed"),h(d,z,"trade"),h(d,V,"No {{ asset }} wallet"),h(d,j,"executed"),h(d,H,"booked"),h(d,G,"canceling"),h(d,X,"Account undefined."),h(d,Q,"keep current wallet password"),h(d,Y,"set a new wallet password"),h(d,J,"lot"),h(d,Z,"lots"),h(d,$,"unknown"),h(d,ee,"epoch"),h(d,ne,"settling"),h(d,re,"no match"),h(d,ae,"canceled"),h(d,oe,"revoked"),h(d,se,"Waiting for confirmations..."),h(d,ie,"none selected"),h(d,ce,"Fidelity bond accepted!"),h(d,le,"API error"),h(d,ue,"Add"),h(d,he,"Create"),h(d,pe,"Ready"),h(d,de,"Setup"),h(d,fe,"change the wallet type"),h(d,me,"don't change the wallet type"),h(d,ve,"Wallet Ready"),h(d,ge,"Setup Needed"),h(d,ye,"Creating Wallet"),h(d,be,"{{ assetName }} Sent!"),h(d,we,"Wallet Reconfigured!"),h(d,ke,"Wallet Rescan Running"),h(d,xe,"{{ assetName }} Wallet Created!"),h(d,Ce,"Wallet Unlocked"),h(d,Se,"Selling"),h(d,Ee,"Buying"),h(d,Fe,"{{ assetName }} Wallet Enabled"),h(d,Ae,"{{ assetName }} Wallet Disabled"),h(d,I,"wallet is disabled"),h(d,Ie,"{{ assetName }} wallet is actively managing orders"),h(d,Re,"available"),h(d,Oe,"immature"),h(d,Te,"fee balance"),h(d,Pe,"waiting for candlesticks"),h(d,Le,"retrieving depth data"),h(d,Be,"invalid address: {{ address }}"),h(d,"TXFEE_UNSUPPORTED","fee estimation is not supported for this wallet type"),h(d,Me,"fee estimation failed: {{ err }}"),h(d,We,"cannot logout with active orders"),h(d,qe,"error: invalid date or time"),h(d,Ne,"No archived records found"),h(d,Ue,"Message: {{ nRecords }} archived records has been deleted"),h(d,_e,"File Location: {{ path }}"),h(d,te,"submitting"),h(d,ze,"Default"),h(d,Ve,"Added"),h(d,je,"Discovered"),h(d,He,"no supported asset info for id = {{ assetID }}, and no exchange info provided"),h(d,Ge,"limit"),h(d,Ke,"limit (i)"),h(d,Xe,"market"),h(d,Qe,"Newly Matched"),h(d,Ye,"Maker Swap Sent"),h(d,Je,"Taker Swap Sent"),h(d,Ze,"Maker Redeemed"),h(d,$e,"Redemption Sent"),h(d,tt,"Revoked - {{ status }}"),h(d,rt,"Refund PENDING"),h(d,nt,"Refunded"),h(d,at,"Redeem PENDING"),h(d,et,"Redemption Confirmed"),h(d,ot,"Complete"),h(d,st,"redeemed by {{ makerAddr }}"),h(d,it,"Error opening wallet: {{ msg }}"),h(d,ct,"Error estimating acceleration fee: {{ msg }}"),h(d,lt,"Error accelerating order: {{ msg }}"),h(d,ut,"Connected"),h(d,ht,"Disconnected"),h(d,dt,"Invalid Certificate"),h(d,pt,"confirmations"),h(d,ft,"Taker"),h(d,mt,"Maker"),h(d,gt,"unavailable"),h(d,vt,"DEX address cannot be empty"),h(d,yt,"Select a valid wallet to post a bond"),h(d,bt,"finishing up"),h(d,wt,"Failed to connect {{ assetName }} wallet: {{ errMsg }}"),d),xt=(h(p={},k,"senha não pode ser vazia"),h(p,x,"senha do app não pode ser vazia"),h(p,K,"senhas diferentes"),h(p,C,"Ordem de compra de {{ asset }}"),h(p,S,"Ordem de venda de {{ asset }}"),h(p,E,"desligar"),h(p,A,"pronto"),h(p,De,"trancado"),h(p,F,"sem carteira"),h(p,R,"carteira está {{ syncProgress }}% sincronizada"),h(p,D,"esconder configurações adicionais"),h(p,O,"mostrar configurações adicionais"),h(p,T,"Comprar"),h(p,P,"Vender"),h(p,L,"{{ asset }} não tem suporte"),h(p,M,"Conexão ao server dex falhou. Pode fechar dexc e tentar novamente depois ou esperar para tentar se reconectar."),h(p,W,"Total: {{ total }} {{ asset }}"),h(p,q,"calculando..."),h(p,N,"estimativa indisponível"),h(p,U,"taxa não pode ser zero"),h(p,_,"quantidade não pode ser zero"),h(p,z,"troca"),h(p,V,"Sem carteira {{ asset }}"),h(p,j,"executado"),h(p,H,"reservado"),h(p,G,"cancelando"),h(p,X,"conta não definida."),h(p,Q,"manter senha da carteira"),h(p,Y,"definir nova senha para carteira"),h(p,J,"lote"),h(p,Z,"lotes"),h(p,$,"desconhecido"),h(p,ee,"epoque"),h(p,ne,"assentando"),h(p,re,"sem combinações"),h(p,ae,"cancelado"),h(p,oe,"revocado"),h(p,se,"Esperando confirmações..."),h(p,ie,"nenhuma selecionado"),h(p,ce,"Sucesso no pagamento da taxa de registro!"),h(p,le,"Erro de API"),h(p,ue,"Adicionar"),h(p,he,"Criar"),h(p,pe,"Escolher"),h(p,de,"Configurar"),h(p,fe,"trocar o tipo de carteira"),h(p,me,"Não trocara tipo de carteira"),h(p,ve,"Carteira Pronta"),h(p,ge,"Configuração Necessária"),h(p,Re,"disponível"),h(p,Oe,"imaturo"),p),Ct=(h(f={},k,"密码不能为空"),h(f,x,"应用密码不能为空"),h(f,K,"密码不相同"),h(f,C,"来自{{ asset }}的买入订单"),h(f,S,"来自{{ asset }}的卖出订单"),h(f,E,"关闭"),h(f,A,"准备就绪"),h(f,De,"锁"),h(f,F,"未连接钱包"),h(f,R,"钱包同步进度{{ syncProgress }}%"),h(f,D,"隐藏其它设置"),h(f,O,"显示其它设置"),h(f,T,"买入"),h(f,P,"卖出"),h(f,L,"{{ asset }}不受支持"),h(f,M,"连接到服务器 dex 失败。您可以关闭 dexc 并稍后重试或等待尝试重新连接。"),h(f,W,"总计： {{ total }} {{ asset }}"),h(f,q,"计算中..."),h(f,N,"估计不可用"),h(f,U,"汇率不能为零"),h(f,_,"数量不能为零"),h(f,z,"交易"),h(f,V,"没有钱包 {{ asset }}"),h(f,j,"执行"),h(f,H,"保留"),h(f,G,"取消"),h(f,X,"帐户未定义。"),h(f,Q,"保留钱包密码"),h(f,Y,"设置新的钱包密码"),h(f,J,"批处理"),h(f,Z,"批"),h(f,ee,"时间"),h(f,le,"接口错误"),h(f,ue,"添加"),h(f,he,"创建"),h(f,Re,"可用"),h(f,Oe,"不成熟"),f),St=(h(m={},k,"hasło nie może być puste"),h(m,x,"hasło aplikacji nie może być puste"),h(m,K,"hasła nie są jednakowe"),h(m,C,"Złóż zlecenie, aby kupić  {{ asset }}"),h(m,S,"Złóż zlecenie, aby sprzedać {{ asset }}"),h(m,E,"wyłączony"),h(m,A,"gotowy"),h(m,De,"zablokowany"),h(m,F,"brak portfela"),h(m,R,"portfel zsynchronizowany w {{ syncProgress }}%"),h(m,D,"ukryj dodatkowe ustawienia"),h(m,O,"pokaż dodatkowe ustawienia"),h(m,T,"Kup"),h(m,P,"Sprzedaj"),h(m,L,"{{ asset }} nie jest wspierany"),h(m,M,"Połączenie z serwerem dex nie powiodło się. Możesz zamknąć dexc i spróbować ponownie później, lub poczekać na wznowienie połączenia."),h(m,W,"W sumie: {{ total }} {{ asset }}"),h(m,q,"obliczanie..."),h(m,N,"brak szacunkowego wyliczenia"),h(m,U,"zero nie może być ceną"),h(m,_,"zero nie może być ilością"),h(m,z,"handluj"),h(m,V,"Brak portfela {{ asset }}"),h(m,j,"wykonano"),h(m,H,"zapisano"),h(m,G,"anulowanie"),h(m,X,"Niezdefiniowane konto."),h(m,Q,"zachowaj obecne hasło portfela"),h(m,Y,"ustaw nowe hasło portfela"),h(m,J,"lot"),h(m,Z,"loty(ów)"),h(m,$,"nieznane"),h(m,ee,"epoka"),h(m,ne,"rozliczanie"),h(m,re,"brak spasowania"),h(m,ae,"anulowano"),h(m,oe,"unieważniono"),h(m,se,"Oczekiwanie na potwierdzenia..."),h(m,ie,"brak zaznaczenia"),h(m,ce,"Płatność rejestracyjna powiodła się!"),h(m,le,"błąd API"),h(m,ue,"Dodaj"),h(m,he,"Utwórz"),h(m,pe,"Gotowy"),h(m,de,"Konfiguracja"),h(m,fe,"zmień typ portfela"),h(m,me,"nie zmieniaj typu portfela"),h(m,ve,"Portfel jest gotowy"),h(m,ge,"Potrzebna konfiguracja"),h(m,Re,"dostępne"),h(m,Oe,"niedojrzałe"),m),Et=(h(v={},k,"Passwort darf nicht leer sein"),h(v,x,"App-Passwort darf nicht leer sein"),h(v,K,"Passwörter stimmen nicht überein"),h(v,C,"Platziere Auftrag zum Kauf von  {{ asset }}"),h(v,S,"Platziere Auftrag zum Verkauf von {{ asset }}"),h(v,E,"aus"),h(v,A,"bereit"),h(v,De,"gesperrt"),h(v,F,"kein Wallet"),h(v,R,"Wallet ist zu {{ syncProgress }}% synchronisiert"),h(v,D,"zusätzliche Einstellungen ausblenden"),h(v,O,"zusätzliche Einstellungen anzeigen"),h(v,T,"Kaufen"),h(v,P,"Verkaufen"),h(v,L,"{{ asset }} wird nicht unterstützt"),h(v,M,"Die Verbindung zum Dex-Server fehlgeschlagen. Du kannst dexc schließen und es später erneut versuchen oder warten bis die Verbindung wiederhergestellt ist."),h(v,W,"Insgesamt: {{ total }} {{ asset }}"),h(v,q,"kalkuliere..."),h(v,N,"Schätzung nicht verfügbar"),h(v,U,"Null-Satz nicht erlaubt"),h(v,_,"Null-Menge nicht erlaubt"),h(v,z,"Handel"),h(v,V,"Kein {{ asset }} Wallet"),h(v,j,"ausgeführt"),h(v,H,"gebucht"),h(v,G,"Abbruch"),h(v,X,"Account undefiniert."),h(v,Q,"aktuelles Passwort für das Wallet behalten"),h(v,Y,"ein neues Passwort für das Wallet festlegen"),h(v,J,"Lot"),h(v,Z,"Lots"),h(v,$,"unbekannt"),h(v,ee,"Epoche"),h(v,ne,"Abwicklung"),h(v,re,"kein Match"),h(v,ae,"abgebrochen"),h(v,oe,"widerrufen"),h(v,se,"Warten auf Bestätigungen..."),h(v,ie,"keine ausgewählt"),h(v,ce,"Zahlung der Registrierungsgebühr erfolgreich!"),h(v,le,"API Fehler"),h(v,ue,"Hinzufügen"),h(v,he,"Erstellen"),h(v,pe,"Bereit"),h(v,de,"Einrichten"),h(v,fe,"den Wallet-Typ ändern"),h(v,me,"den Wallet-Typ nicht ändern"),h(v,ve,"Wallet bereit"),h(v,ge,"Einrichtung erforderlich"),h(v,ye,"Erstelle Wallet"),h(v,be,"{{ assetName }} gesendet!"),h(v,we,"Wallet neu konfiguriert!"),h(v,ke,"Wallet Rescan läuft"),h(v,xe,"{{ assetName }} Wallet erstellt!"),h(v,Ce,"Wallet entsperrt"),v),At=(h(y={},k,"لا يمكن أن تكون كلمة المرور فارغة"),h(y,x,"لا يمكن أن تكون كلمة مرور التطبيق فارغة"),h(y,K,"كلمات المرور غير متطابقة"),h(y,C,"ضع طلبًا للشراء  {{ asset }}"),h(y,S,"ضع طلبًا للبيع {{ asset }}"),h(y,E,"إيقاف"),h(y,A,"متوقف"),h(y,De,"مقفل"),h(y,F,"لا توجد أي محفظة"),h(y,R,"تمت مزامنة {{ syncProgress }}% المحفظة"),h(y,D,"إخفاء الإعدادات الإضافية"),h(y,O,"عرض الإعدادات الإضافية"),h(y,T,"شراء"),h(y,P,"بيع"),h(y,L,"{{ asset }} غير مدعوم"),h(y,M,"فشل الاتصال بخادم dex. يمكنك إغلاق dexc والمحاولة مرة أخرى لاحقًا أو انتظار إعادة الاتصال."),h(y,W,"إجمالي: {{ total }} {{ asset }}"),h(y,q,"جاري الحساب ..."),h(y,N,"التقديرات غير متاحة"),h(y,U,"معدل الصفر غير مسموح به"),h(y,_,"غير مسموح بالكمية الصفرية"),h(y,z,"التداول"),h(y,V,"لا توجد {{ asset }} محفظة"),h(y,j,"تم تنفيذها"),h(y,H,"تم الحجز"),h(y,G,"جارٍ الإلغاء"),h(y,X,"حساب غير محدد."),h(y,Q,"احتفظ بكلمة مرور المحفظة الحالية"),h(y,Y,"قم بتعيين كلمة مرور جديدة للمحفظة"),h(y,J,"الحصة"),h(y,Z,"الحصص"),h(y,$,"غير معروف"),h(y,ee,"الحقبة الزمنية"),h(y,ne,"الإعدادات"),h(y,re,"غير متطابقة"),h(y,ae,"ملغاة"),h(y,oe,"مستعادة"),h(y,se,"في انتظار التأكيدات ..."),h(y,ie,"لم يتم تحديد أي شيء"),h(y,ce,"تم دفع رسوم التسجيل بنجاح!"),h(y,le,"خطأ في واجهة برمجة التطبيقات"),h(y,ue,"إضافة"),h(y,he,"إنشاء"),h(y,pe,"جاهزة"),h(y,de,"إعداد"),h(y,fe,"تغيير نوع المحفظة"),h(y,me,"لا تغير نوع المحفظة"),h(y,ve,"المحفظة جاهزة"),h(y,ge,"الإعداد مطلوب"),h(y,ye,"إنشاء المحفظة"),h(y,be,"{{ assetName }} تم الإرسال!"),h(y,we,"تمت إعادة تهيئة المحفظة!!"),h(y,ke,"إعادة فحص المحفظة قيد التشغيل"),h(y,xe,"{{ assetName }} تم إنشاء المحفظة!"),h(y,Ce,"المحفظة غير مقفلة"),h(y,Se,"البيع"),h(y,Ee,"Bالشراء"),h(y,Fe,"{{ assetName }} المحفظة ممكنة"),h(y,Ae,"{{ assetName }} المحفظة معطلة"),h(y,I,"تم تعطيل المحفظة"),h(y,Ie,"{{ assetName }} تدير المحفظة  الطلبات بفعالية"),y),Ft={"en-us":kt,"pt-br":xt,"zh-cn":Ct,"pl-pl":St,"de-de":Et,ar:At},It=kt;function Rt(e,t){return function(e,t){return e.replace(/{{\s?([^{}\s]*)\s?}}/g,(function(e,n){return t[n]}))}(g[e]||It[e],t||{})}function Dt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ot(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.localeDiscrepancies=function(){for(var e=kt,t=0,n=Object.entries(Ft);t<n.length;t++){var a=r(n[t],2),o=a[0],s=a[1];if(s!==e)for(var i=0,c=Object.entries(e);i<c.length;i++){var l=r(c[i],2),u=l[0],h=l[1];s[u]||console.log("".concat(o," needs a tranlation for: ").concat(h))}}};var Tt=new window.DOMParser,Pt={0:"btc",42:"dcr",2:"ltc",20:"dgb",22:"mona",28:"vtc",3:"doge",145:"bch",60:"eth",133:"zec",6e4:"dextt.eth",60001:"usdc.eth"},Lt=navigator.languages.filter((function(e){return"c"!==e})),Bt=Object.values(Pt),Mt=new Intl.NumberFormat(Lt),Wt=new Intl.NumberFormat(Lt,{minimumSignificantDigits:3,maximumSignificantDigits:3}),qt=new Intl.NumberFormat(Lt,{minimumSignificantDigits:5,maximumSignificantDigits:5}),Nt={},Ut={};function _t(e){return zt(Ut,e,e)}function zt(e,t,n){var r="".concat(t,"-").concat(n),a=e[r];return a||(a=new Intl.NumberFormat(Lt,{minimumFractionDigits:t,maximumFractionDigits:n}),e[r]=a),a}function Vt(e,t){var n=8;if(t){var r=t.conventional.conversionFactor;e/=r,n=Math.round(Math.log10(r))}return[e,n]}var jt=function(){function e(){s(this,e)}var t;return u(e,null,[{key:"idel",value:function(e,t){return e.querySelector("#".concat(t))}},{key:"bind",value:function(e,t,n){e.addEventListener(t,n)}},{key:"unbind",value:function(e,t,n){e.removeEventListener(t,n)}},{key:"noderize",value:function(e){return Tt.parseFromString(e,"text/html")}},{key:"mouseInElement",value:function(e,t){if(t.contains(e.target))return!0;var n=t.getBoundingClientRect();return e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom}},{key:"layoutMetrics",value:function(e){var t=e.getBoundingClientRect(),n=document.documentElement,r=t.top+n.scrollTop,a=t.left+n.scrollLeft,o=e.offsetWidth,s=e.offsetHeight;return{bodyTop:r,bodyLeft:a,width:o,height:s,centerX:a+o/2,centerY:r+s/2}}},{key:"descendentMetrics",value:function(t,n){var r=e.layoutMetrics(t),a=e.layoutMetrics(n);return{bodyTop:a.bodyTop-r.bodyTop,bodyLeft:a.bodyLeft-r.bodyLeft,width:a.width,height:a.height,centerX:a.centerX-r.bodyLeft,centerY:a.centerY-r.bodyTop}}},{key:"empty",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)for(var o=a[r];o.firstChild;)o.removeChild(o.firstChild)}},{key:"setContent",value:function(t){e.empty(t);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var o=0,s=r;o<s.length;o++){var i=s[o];t.appendChild(i)}}},{key:"hide",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)a[r].classList.add("d-hide")}},{key:"show",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)a[r].classList.remove("d-hide")}},{key:"setVis",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t?e.show.apply(e,r):e.hide.apply(e,r)}},{key:"isHidden",value:function(e){return e.classList.contains("d-hide")}},{key:"isDisplayed",value:function(e){return!e.classList.contains("d-hide")}},{key:"animate",value:(t=o(w().mark((function e(t,n,r){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Ht(t,n,r).wait();case 2:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"applySelector",value:function(e,t){return Array.from(e.querySelectorAll(t))}},{key:"kids",value:function(e){return Array.from(e.children)}},{key:"safeSelector",value:function(e,t){return e.querySelector(t)||(console.warn("no element found for selector '".concat(t,"' on element ->"),e),document.createElement("div"))}},{key:"idDescendants",value:function(t){var n,r={},a=Dt(e.applySelector(t,"[id]"));try{for(a.s();!(n=a.n()).done;){var o=n.value;r[o.id]=o}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"formatCoinValue",value:function(e,t){var n=r(Vt(e,t),2),a=n[0],o=n[1];return Number.isInteger(a)?Mt.format(a):function(e){return zt(Nt,2,e)}(o).format(a)}},{key:"formatThreeSigFigs",value:function(e){return e>=1e3?Mt.format(Math.round(e)):Wt.format(e)}},{key:"formatFiveSigFigs",value:function(e,t){return e>=1e4?Mt.format(Math.round(e)):e<1e5?_t(null!=t?t:8).format(e):qt.format(e)}},{key:"formatFullPrecision",value:function(e,t){var n=r(Vt(e,t),2),a=n[0];return _t(n[1]).format(a)}},{key:"formatFiatConversion",value:function(e,t,n){if(!t||0===t)return Rt(gt);var a=r(Vt(e,n),1)[0]*t;return _t(2).format(a)}},{key:"languages",value:function(){return Lt}},{key:"logoPath",value:function(e){return-1===Bt.indexOf(e)&&(e=e.substring(0,1)),"/img/coins/".concat(e,".png")}},{key:"bipSymbol",value:function(e){return Pt[e]}},{key:"logoPathFromID",value:function(t){return e.logoPath(Pt[t])}},{key:"symbolize",value:function(e){var t=e.split("."),n=document.createElement("span");if(n.textContent=t[0].toUpperCase(),1===t.length)return n;var r=document.createElement("span");r.classList.add("token-aware-symbol"),r.appendChild(n);var a=document.createElement("sup");return a.textContent=t[1].toUpperCase(),r.appendChild(a),r}},{key:"shortSymbol",value:function(e){return e.split(".")[0].toUpperCase()}},{key:"cleanTemplates",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e.remove(),e.removeAttribute("id")}))}},{key:"tmplElement",value:function(e,t){return e.querySelector('[data-tmpl="'.concat(t,'"]'))||document.createElement("div")}},{key:"parseTemplate",value:function(t){var n,r={},a=Dt(e.applySelector(t,"[data-tmpl]"));try{for(a.s();!(n=a.n()).done;){var o=n.value;r[o.dataset.tmpl||""]=o}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"timeSince",value:function(t){return e.formatDuration((new Date).getTime()-t)}},{key:"formatDuration",value:function(e){var t,n,a,o,s,i,c=Math.floor(e),l="",u=0,h=function(e,t){return(e>0||u>0)&&u++,e>0&&(l+="".concat(e," ").concat(t," ")),u>=2},d=r(en(c,Qt),2);if(t=d[0],c=d[1],h(t,"y"))return l;var p=r(en(c,Yt),2);if(n=p[0],c=p[1],h(n,"mo"))return l;var f=r(en(c,Jt),2);if(a=f[0],c=f[1],h(a,"d"))return l;var m=r(en(c,Zt),2);if(o=m[0],c=m[1],h(o,"h"))return l;var v=r(en(c,$t),2);if(s=v[0],c=v[1],h(s,"m"))return l;var y=r(en(c,1e3),2);return i=y[0],c=y[1],h(i,"s"),l||"0 s"}},{key:"disableMouseWheel",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++)a[r].addEventListener("wheel",(function(e){e.preventDefault()}))}},{key:"showFormError",value:function(t,n){t.textContent=n,e.show(t)}}]),e}(),Ht=function(){function e(t,n,r,a){s(this,e),h(this,"done",void 0),h(this,"endAnimation",void 0),h(this,"thread",void 0),this.done=a,this.thread=this.run(t,n,r)}var t,n,r;return u(e,[{key:"run",value:(r=o(w().mark((function t(n,r,a){var o,s,i,c,l,u;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=n>=0?n:31536e7,o=a?Gt[a]:Gt.linear,s=(new Date).getTime(),i=n===e.Forever?Number.MAX_SAFE_INTEGER:s+n,c=i-s,l=1e3/30,u=s,this.endAnimation=!1;case 8:if(!(u<i)){t.next=17;break}if(!this.endAnimation){t.next=11;break}return t.abrupt("return",this.runCompletionFunction());case 11:return r(o((u-s)/c)),t.next=14,Xt(l);case 14:u=(new Date).getTime(),t.next=8;break;case 17:r(1),this.runCompletionFunction();case 19:case"end":return t.stop()}}),t,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"wait",value:(n=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.thread;case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"stop",value:function(){this.endAnimation=!0}},{key:"stopAndWait",value:(t=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop(),e.next=3,this.wait();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"runCompletionFunction",value:function(){this.done&&this.done()}}]),e}();h(Ht,"Forever",void 0),Ht.Forever=-1;var Gt={linear:function(e){return e},easeIn:function(e){return e*e},easeOut:function(e){return e*(2-e)},easeInHard:function(e){return e*e*e},easeOutHard:function(e){return--e*e*e+1},easeOutElastic:function(e){var t=2*Math.PI/3;return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*t)+1}},Kt=function(){function e(t){s(this,e),h(this,"icons",void 0),h(this,"status",void 0);var n=function(e){return t.querySelector("[data-state=".concat(e,"]"))};this.icons={},this.icons.sleeping=n("sleeping"),this.icons.locked=n("locked"),this.icons.unlocked=n("unlocked"),this.icons.nowallet=n("nowallet"),this.icons.syncing=n("syncing"),this.icons.nopeers=n("nopeers"),this.icons.disabled=n("disabled"),this.status=n("status")}return u(e,[{key:"sleeping",value:function(){var e=this.icons;jt.hide(e.locked,e.unlocked,e.nowallet,e.syncing,e.disabled),jt.show(e.sleeping),this.status&&(this.status.textContent=Rt(E))}},{key:"locked",value:function(){var e=this.icons;jt.hide(e.unlocked,e.nowallet,e.sleeping,e.disabled),jt.show(e.locked),this.status&&(this.status.textContent=Rt(De))}},{key:"unlocked",value:function(){var e=this.icons;jt.hide(e.locked,e.nowallet,e.sleeping,e.disabled),jt.show(e.unlocked),this.status&&(this.status.textContent=Rt(A))}},{key:"nowallet",value:function(){var e=this.icons;jt.hide(e.locked,e.unlocked,e.sleeping,e.syncing,e.disabled),jt.show(e.nowallet),this.status&&(this.status.textContent=Rt(F))}},{key:"disabled",value:function(){var e=this.icons;jt.hide(e.locked,e.unlocked,e.sleeping,e.syncing,e.nowallet,e.nopeers),jt.show(e.disabled),e.disabled.dataset.tooltip=Rt(I)}},{key:"setSyncing",value:function(e){var t=this.icons.syncing;if(e&&e.running&&!e.disabled){if(0===e.peerCount)return jt.show(this.icons.nopeers),void jt.hide(t);if(jt.hide(this.icons.nopeers),!e.synced)return jt.show(t),void(t.dataset.tooltip=Rt(R,{syncProgress:(100*e.syncProgress).toFixed(1)}));jt.hide(t)}else jt.hide(t)}},{key:"readWallet",value:function(e){if(this.setSyncing(e),!e)return this.nowallet();switch(!0){case e.disabled:this.disabled();break;case!e.running:this.sleeping();break;case!e.open:this.locked();break;case e.open:this.unlocked();break;default:console.error("wallet in unknown state",e)}}}]),e}();function Xt(e){return new Promise((function(t){return setTimeout(t,e)}))}var Qt=31536e6,Yt=2592e6,Jt=864e5,Zt=36e5,$t=6e4;function en(e,t){var n=Math.floor(e/t);return[n,e-n*t]}function tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var nn=function(){function e(){s(this,e)}return u(e,null,[{key:"setCookie",value:function(e,t){var n=new Date;n.setTime(n.getTime()+31536e7);var r="expires="+n.toUTCString();document.cookie=e+"="+t+";"+r+";path=/"}},{key:"getCookie",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(document.cookie.split(";"));try{for(n.s();!(t=n.n()).done;){var a=r(t.value.split("="),2),o=a[0],s=a[1];if(o.trim()===e)return s}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"removeCookie",value:function(e){document.cookie="".concat(e,"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")}},{key:"isDark",value:function(){return document.cookie.split(";").filter((function(t){return t.includes("".concat(e.darkModeCK,"=1"))})).length}},{key:"passwordIsCached",value:function(){return!!this.getCookie(e.pwKeyCK)}},{key:"storeLocal",value:function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}},{key:"fetchLocal",value:function(e){var t=window.localStorage.getItem(e);return null!==t?JSON.parse(t):null}},{key:"removeLocal",value:function(e){window.localStorage.removeItem(e)}}]),e}();function rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function an(e,t){return an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},an(e,t)}function on(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&an(e,t)}function sn(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return rn(e)}function cn(e){return cn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cn(e)}h(nn,"darkModeCK","darkMode"),h(nn,"authCK","dexauth"),h(nn,"pwKeyCK","sessionkey"),h(nn,"popupsLK","popups"),h(nn,"loggersLK","loggers"),h(nn,"recordersLK","recorders"),h(nn,"lastMarketLK","selectedMarket"),h(nn,"depthZoomLK","depthZoom"),h(nn,"lastMMMarketLK","mmMarket"),h(nn,"optionsExpansionLK","mmOptsExpand"),h(nn,"leftMarketDockLK","leftmarketdock"),h(nn,"selectedAssetLK","selectedasset"),h(nn,"notificationsLK","notifications"),h(nn,"orderDisclaimerAckedLK","ordAck"),h(nn,"lastCandleDurationLK","lastCandleDuration"),null===nn.getCookie(nn.darkModeCK)&&nn.setCookie(nn.darkModeCK,"1"),null===nn.fetchLocal(nn.popupsLK)&&nn.storeLocal(nn.popupsLK,"1"),null===nn.fetchLocal(nn.leftMarketDockLK)&&nn.storeLocal(nn.leftMarketDockLK,"1");var ln=function(){function e(){s(this,e)}return u(e,[{key:"unload",value:function(){}}]),e}();function un(e,t,n){return hn.apply(this,arguments)}function hn(){return(hn=o(w().mark((function e(t,n,r){var a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.fetch(n,{method:t,headers:new window.Headers({"content-type":"application/json"}),body:r});case 3:if(200===(a=e.sent).status){e.next=6;break}throw a;case 6:return e.next=8,a.json();case 8:return(o=e.sent).requestSuccessful=!0,e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(0),e.t0.requestSuccessful=!1,e.next=18,e.t0.text();case 18:return e.t0.msg=e.sent,e.abrupt("return",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function dn(e,t){return pn.apply(this,arguments)}function pn(){return(pn=o(w().mark((function e(t,n){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",un("POST",t,JSON.stringify(n)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fn(e){return mn.apply(this,arguments)}function mn(){return(mn=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",un("GET",t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var vn=function(e){return e[e.walletErr=0]="walletErr",e[e.walletAuthErr=1]="walletAuthErr",e[e.walletBalanceErr=2]="walletBalanceErr",e[e.dupeDEXErr=3]="dupeDEXErr",e[e.assetSupportErr=4]="assetSupportErr",e[e.registerErr=5]="registerErr",e[e.signatureErr=6]="signatureErr",e[e.zeroFeeErr=7]="zeroFeeErr",e[e.feeMismatchErr=8]="feeMismatchErr",e[e.feeSendErr=9]="feeSendErr",e[e.passwordErr=10]="passwordErr",e[e.emptyHostErr=11]="emptyHostErr",e[e.connectionErr=12]="connectionErr",e[e.acctKeyErr=13]="acctKeyErr",e[e.unknownOrderErr=14]="unknownOrderErr",e[e.orderParamsErr=15]="orderParamsErr",e[e.dbErr=16]="dbErr",e[e.authErr=17]="authErr",e[e.connectWalletErr=18]="connectWalletErr",e[e.missingWalletErr=19]="missingWalletErr",e[e.encryptionErr=20]="encryptionErr",e[e.decodeErr=21]="decodeErr",e[e.accountVerificationErr=22]="accountVerificationErr",e[e.accountProofErr=23]="accountProofErr",e[e.parseKeyErr=24]="parseKeyErr",e[e.marketErr=25]="marketErr",e[e.addressParseErr=26]="addressParseErr",e[e.addrErr=27]="addrErr",e[e.fileReadErr=28]="fileReadErr",e[e.unknownDEXErr=29]="unknownDEXErr",e[e.accountRetrieveErr=30]="accountRetrieveErr",e[e.accountDisableErr=31]="accountDisableErr",e[e.suspendedAcctErr=32]="suspendedAcctErr",e[e.existenceCheckErr=33]="existenceCheckErr",e[e.createWalletErr=34]="createWalletErr",e[e.activeOrdersErr=35]="activeOrdersErr",e[e.newAddrErr=36]="newAddrErr",e}({});function yn(n){return function(t){if(Array.isArray(t))return e(t)}(n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||t(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var gn,bn,wn,kn,xn=function(e){return e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected",e[e.InvalidCert=2]="InvalidCert",e}({}),Cn=function(e){return e[e.WalletDefault=0]="WalletDefault",e[e.UserAdded=1]="UserAdded",e[e.Discovered=2]="Discovered",e}({});function Sn(){return gn}function En(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cn(e);if(t){var a=cn(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return sn(this,n)}}function An(e){var t=[e.booleanOptTmpl,e.rangeOptTmpl,e.orderOptTmpl];wn=t[0],kn=t[1],bn=t[2]}var Fn=new Intl.NumberFormat(jt.languages(),{minimumSignificantDigits:3,maximumSignificantDigits:3}),In=u((function e(t,n,r){var a=this;s(this,e),h(this,"opt",void 0),h(this,"node",void 0),h(this,"tmpl",void 0),h(this,"on",void 0),this.opt=t;var o=this.node=bn.cloneNode(!0),i=this.tmpl=jt.parseTemplate(o);i.optName.textContent=t.displayname,i.tooltip.dataset.tooltip=t.description,n?i.chainIcon.src=jt.logoPath(n):jt.hide(i.chainIcon),this.on=!1,jt.bind(o,"click",(function(){a.on||(a.on=!0,o.classList.add("selected"),r.enable())})),jt.bind(i.toggle,"click",(function(e){a.on&&(e.stopPropagation(),a.on=!1,o.classList.remove("selected"),r.disable())}))})),Rn=function(e){on(n,e);var t=En(n);function n(e,r,a,o){var i;if(s(this,n),h(rn(i=t.call(this,e,r,{enable:function(){return i.enable()},disable:function(){return i.disable()}})),"control",void 0),h(rn(i),"changed",void 0),h(rn(i),"dict",void 0),i.dict=a,i.changed=function(){return o()},void 0===e.boolean)throw Error("not a boolean opt");var c=e.boolean,l=i.control=wn.cloneNode(!0);return i.tmpl.controls.appendChild(l),jt.parseTemplate(l).reason.textContent=c.reason,i.on=void 0!==a[e.key]?a[e.key]:e.default,i.on&&i.node.classList.add("selected"),i}return u(n,[{key:"store",value:function(){this.on===this.opt.default?delete this.dict[this.opt.key]:this.dict[this.opt.key]=this.on,this.changed()}},{key:"enable",value:function(){this.store()}},{key:"disable",value:function(){this.store()}}]),n}(In),Dn=function(e){on(n,e);var t=En(n);function n(e,r,a,o){var i;if(s(this,n),h(rn(i=t.call(this,e,r,{enable:function(){return i.enable()},disable:function(){return i.disable()}})),"handler",void 0),h(rn(i),"x",void 0),h(rn(i),"changed",void 0),h(rn(i),"dict",void 0),i.dict=a,i.changed=o,void 0===e.xyRange)throw Error("not an xy range opt");var c=e.xyRange,l=a[e.key];return i.on=void 0!==l,i.on?(i.node.classList.add("selected"),i.x=l):i.x=e.default,i.handler=new On(c,i.x,(function(e){i.x=e,i.dict[i.opt.key]=e}),(function(){i.changed()}),(function(){i.node.classList.add("selected")})),i.tmpl.controls.appendChild(i.handler.control),i}return u(n,[{key:"enable",value:function(){this.dict[this.opt.key]=this.x,this.changed()}},{key:"disable",value:function(){delete this.dict[this.opt.key],this.changed()}},{key:"setValue",value:function(e){this.handler.setValue(e),this.on=!0,this.node.classList.add("selected")}}]),n}(In),On=function(){function e(t,n,r,a,o,i){var c=this;s(this,e),h(this,"control",void 0),h(this,"cfg",void 0),h(this,"tmpl",void 0),h(this,"x",void 0),h(this,"scrollingX",void 0),h(this,"y",void 0),h(this,"r",void 0),h(this,"roundY",void 0),h(this,"updated",void 0),h(this,"changed",void 0),h(this,"selected",void 0),h(this,"setConfig",void 0);var l=this.control=kn.cloneNode(!0),u=this.tmpl=jt.parseTemplate(l);this.roundY=Boolean(i),this.cfg=t,this.changed=a,this.selected=o,this.updated=r;var d=u.slider,p=u.handle,f=t.end.x-t.start.x,m=t.end.y-t.start.y,v=function(e){return(e-t.start.x)/f},y=function(e){f=e.end.x-e.start.x,m=e.end.y-e.start.y,t=c.cfg=e,u.rangeLblStart.textContent=t.start.label,u.rangeLblEnd.textContent=t.end.label,u.xUnit.textContent=t.xUnit,u.yUnit.textContent=t.yUnit,c.y=c.r*m+t.start.y,c.r=(c.y-t.start.y)/m,c.scrollingX=c.r*f+t.start.x};y(t),this.setConfig=function(e){y(e),c.accept(c.scrollingX)},this.r=v(n),this.scrollingX=this.x=n,this.y=this.r*m+t.start.y;var g=function e(n){if("change"===n.type||n.target!==u.xInput){var r=u.xInput.value;if(r){var a=parseFloat(r);isNaN(a)||(c.scrollingX=Tn(a,t.start.x,t.end.x),c.r=v(c.scrollingX),c.y=c.r*m+t.start.y,c.accept(c.scrollingX))}jt.hide(u.xInput),jt.show(u.x),jt.unbind(document,"click",e),c.changed()}};jt.bind(u.x,"click",(function(e){jt.hide(u.x),jt.show(u.xInput),u.xInput.focus(),u.xInput.value=Fn.format(c.scrollingX),jt.bind(document,"click",g),e.stopPropagation()})),jt.bind(u.xInput,"change",g);var b=function e(n){if("change"===n.type||n.target!==u.yInput){var r=u.yInput.value;if(r){var a=parseFloat(r);isNaN(a)||(c.y=Tn(a,t.start.y,t.end.y),c.r=(c.y-t.start.y)/m,c.scrollingX=t.start.x+c.r*f,c.accept(c.scrollingX))}jt.hide(u.yInput),jt.show(u.y),jt.unbind(document,"click",e),c.changed()}};jt.bind(u.y,"click",(function(e){jt.hide(u.y),jt.show(u.yInput),u.yInput.focus(),u.yInput.value=Fn.format(c.y),jt.bind(document,"click",b),e.stopPropagation()})),jt.bind(u.yInput,"change",b),jt.bind(p,"mousedown",(function(e){if(0===e.button){e.preventDefault(),c.selected();var n=e.pageX,r=d.clientWidth-p.offsetWidth,a=v(c.scrollingX)*r,o=function(e){e.preventDefault(),c.r=function(e){return Math.max(Math.min(a+(e.pageX-n),r),0)}(e)/r,c.scrollingX=c.r*f+t.start.x,c.y=c.r*m+t.start.y,c.accept(c.scrollingX)};jt.bind(document,"mousemove",o),jt.bind(document,"mouseup",(function e(t){o(t),jt.unbind(document,"mousemove",o),jt.unbind(document,"mouseup",e),c.changed()}))}})),this.accept(this.scrollingX,!0)}return u(e,[{key:"accept",value:function(e,t){var n=this.tmpl;this.roundY&&(this.y=Math.round(this.y)),n.x.textContent=Fn.format(e),n.y.textContent=Fn.format(this.y),this.roundY&&(n.y.textContent="".concat(this.y)),n.handle.style.left="calc(".concat(100*this.r,"% - ").concat(14*this.r,"px)"),this.x=e,this.scrollingX=e,t||this.updated(e,this.y)}},{key:"setValue",value:function(e){var t=this.cfg;this.r=(e-t.start.x)/(t.end.x-t.start.x),this.y=t.start.y+this.r*(t.end.y-t.start.y),this.accept(e,!0)}}]),e}(),Tn=function(e,t,n){return e<t?t:e>n?n:e};function Pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ln=1,Bn=2,Mn=0,Wn=1,qn=2,Nn=3,Un=3,_n=4,zn=0,Vn=1,jn=1e8;function Hn(e){var t=e.sell?P:T,n=document.documentElement.lang.toLowerCase();return Rt(t).toLocaleLowerCase(n)}function Gn(e){return e.type===Ln?e.tif===Mn?Rt(Ke):Rt(Ge):Rt(Xe)}function Kn(e){return e.type===Bn&&!e.sell}function Xn(e){if(!e.matches)return!1;var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(e.matches);try{for(n.s();!(t=n.n()).done;)if(t.value.active)return!0}catch(e){n.e(e)}finally{n.f()}return!1}function Qn(e){if(!e.id)return Rt(te);var t=Xn(e);switch(e.status){case 0:return Rt($);case Wn:return Rt(ee);case qn:return e.cancelling?Rt(G):t?"".concat(Rt(H),"/").concat(Rt(ne)):Rt(H);case Nn:return t?Rt(ne):0===e.filled&&3!==e.type?Rt(re):Rt(j);case 4:return t?"".concat(Rt(ae),"/").concat(Rt(ne)):Rt(ae);case 5:return t?"".concat(Rt(oe),"/").concat(Rt(ne)):Rt(oe)}return Rt($)}function Yn(e){if(!e.matches)return 0;var t=Kn(e)?function(e){return e.qty*e.rate/jn}:function(e){return e.qty};return e.matches.reduce((function(e,n){return n.isCancel?e:e+t(n)}),0)}function Jn(e){if(!e.matches)return 0;var t=Kn(e)?function(e){return e.qty*e.rate/jn}:function(e){return e.qty};return e.matches.reduce((function(e,n){return n.isCancel?e:n.side===zn&&n.status>=Un||n.side===Vn&&n.status>=_n?e+t(n):e}),0)}function Zn(e,t){return e*t/jn}function $n(e){return Rt(tt,{status:Rt(e)})}function er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cn(e);if(t){var a=cn(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return sn(this,n)}}function tr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rr=jt.bind,ar=2*Math.PI,or=String.fromCharCode(59914),sr=String.fromCharCode(59915),ir={axisLabel:"#b1b1b1",gridBorder:"#383f4b",gridLines:"#383f4b",gapLine:"#6b6b6b",value:"#9a9a9a",zoom:"#5b5b5b",zoomHover:"#aaa",sellLine:"#ae3333",buyLine:"#05a35a",sellFill:"#591a1a",buyFill:"#02572f",crosshairs:"#888",legendFill:"black",legendText:"#d5d5d5"},cr={axisLabel:"#1b1b1b",gridBorder:"#ddd",gridLines:"#ddd",gapLine:"#595959",value:"#4d4d4d",zoom:"#777",zoomHover:"#333",sellLine:"#99302b",buyLine:"#207a46",sellFill:"#bd5959",buyFill:"#4cad75",crosshairs:"#595959",legendFill:"#e6e6e6",legendText:"#1b1b1b"},lr=function(){function e(t,n){var r=this;s(this,e),h(this,"parent",void 0),h(this,"report",void 0),h(this,"theme",void 0),h(this,"canvas",void 0),h(this,"visible",void 0),h(this,"renderScheduled",void 0),h(this,"ctx",void 0),h(this,"mousePos",void 0),h(this,"rect",void 0),h(this,"wheelLimiter",void 0),h(this,"boundResizer",void 0),h(this,"plotRegion",void 0),h(this,"xRegion",void 0),h(this,"yRegion",void 0),h(this,"dataExtents",void 0),h(this,"unattachers",void 0),this.parent=t,this.report=n,this.theme=nn.isDark()?ir:cr,this.canvas=document.createElement("canvas"),this.visible=!0,t.appendChild(this.canvas);var a=this.canvas.getContext("2d");if(a){this.ctx=a,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.mousePos=null,rr(this.canvas,"mousemove",(function(e){r.rect&&(r.mousePos={x:e.clientX-r.rect.left,y:e.clientY-r.rect.y},r.draw())})),rr(this.canvas,"mouseleave",(function(){r.mousePos=null,r.draw()})),new ResizeObserver((function(){return r.resize()})).observe(this.parent),this.wheelLimiter=null,rr(this.canvas,"wheel",(function(e){r.wheel(e)})),rr(this.canvas,"click",(function(e){r.click(e)}));var o=function(){r.visible="hidden"!==document.visibilityState,r.visible&&r.renderScheduled&&(r.renderScheduled=!1,r.draw())};rr(document,"visibilitychange",o),this.unattachers=[function(){jt.unbind(document,"visibilitychange",o)}]}else console.error("error getting canvas context")}return u(e,[{key:"wheeled",value:function(){var e=this;this.wheelLimiter=window.setTimeout((function(){e.wheelLimiter=null}),100)}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"draw",value:function(){this.render()}},{key:"click",value:function(e){this.report.click(e)}},{key:"wheel",value:function(e){this.zoom(e.deltaY<0),e.preventDefault()}},{key:"resize",value:function(){var e=this;this.canvas.width=this.parent.clientWidth,this.canvas.height=this.parent.clientHeight;var t=new pr(40,this.canvas.width,10,this.canvas.height-30),n=new pr(40,this.canvas.width,this.canvas.height-30,this.canvas.height),r=new pr(0,40,10,this.canvas.height-30);this.plotRegion=new fr(this.ctx,t),this.xRegion=new fr(this.ctx,n),this.yRegion=new fr(this.ctx,r),window.requestAnimationFrame((function(){e.rect=e.canvas.getBoundingClientRect(),e.report.resize()}))}},{key:"zoom",value:function(e){this.wheelLimiter||this.report.zoom(e)}},{key:"unattach",value:function(){var e,t=tr(this.unattachers);try{for(t.s();!(e=t.n()).done;)(0,e.value)()}catch(e){t.e(e)}finally{t.f()}this.unattachers=[]}},{key:"render",value:function(){console.error("child class must override render method")}},{key:"applyLabelStyle",value:function(e){this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.font="".concat(null!=e?e:"14","px 'sans', sans-serif"),this.ctx.fillStyle=this.theme.axisLabel}},{key:"plotXLabels",value:function(e,t,n,r){var a=this,o=new pr(t,n,0,1);this.xRegion.plot(o,(function(o,s){a.applyLabelStyle();var i=(n+t)/2,c=t,l=i;e.lbls.forEach((function(e){o.fillText(e.txt,s.x(e.val),s.y(.5)),i>=c&&i<e.val&&(l=(c+e.val)/2),c=e.val})),o.font="11px 'sans', sans-serif",2===r.length?(o.fillText(r[0],s.x(l),s.y(.63)),o.fillText(r[1],s.x(l),s.y(.23))):1===r.length&&o.fillText(r[0],s.x(l),s.y(.5))}),!0),this.plotRegion.plot(o,(function(t,n){t.lineWidth=1,t.strokeStyle=a.theme.gridLines,e.lbls.forEach((function(e){gr(t,n.x(e.val),n.y(0),n.x(e.val),n.y(1))}))}),!0)}},{key:"plotYLabels",value:function(e,t,n,r,a){var o=this,s=new pr(0,1,n,r);this.yRegion.plot(s,(function(e,n){o.applyLabelStyle();var s=r/2,i=0,c=s;t.lbls.forEach((function(t){e.fillText(t.txt,n.x(.5),n.y(t.val)),s>=i&&s<t.val&&(c=(i+t.val)/2),i=t.val})),e.fillText(a,n.x(.5),n.y(c))}),!0),e.plot(s,(function(e,n){e.lineWidth=1,e.strokeStyle=o.theme.gridLines,t.lbls.forEach((function(t){gr(e,n.x(0),n.y(t.val),n.x(1),n.y(t.val))}))}),!0)}},{key:"doYLabels",value:function(e,t,n,r){this.applyLabelStyle();var a=mr(this.ctx,e.height(),this.dataExtents.y.min,this.dataExtents.y.max,50,t,n,r),o=(a.widest||0)+20;return this.yRegion.extents.x.max=o,this.yRegion.extents.y.max=e.extents.y.max,this.plotRegion.extents.x.min=o,this.xRegion.extents.x.min=o,this.plotYLabels(e,a,this.dataExtents.y.min,this.dataExtents.y.max,n),a}},{key:"drawFrame",value:function(){var e=this;this.plotRegion.plot(new pr(0,1,0,1),(function(t,n){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.beginPath(),n.dataCoords((function(){t.moveTo(0,0),t.lineTo(0,1),t.lineTo(1,1),t.lineTo(1,0),t.lineTo(0,0)})),t.stroke()}))}}]),e}(),ur=function(e){on(n,e);var t=er(n);function n(e,r,a){var o;return s(this,n),h(rn(o=t.call(this,e,{resize:function(){return o.resized()},click:function(e){return o.clicked(e)},zoom:function(e){return o.zoomed(e)}})),"reporters",void 0),h(rn(o),"book",void 0),h(rn(o),"zoomLevel",void 0),h(rn(o),"lotSize",void 0),h(rn(o),"rateStep",void 0),h(rn(o),"lines",void 0),h(rn(o),"markers",void 0),h(rn(o),"zoomInBttn",void 0),h(rn(o),"zoomOutBttn",void 0),h(rn(o),"baseUnit",void 0),h(rn(o),"quoteUnit",void 0),o.reporters=r,o.zoomLevel=a,o.lines=[],o.markers={buys:[],sells:[]},o.setZoomBttns(),o.resize(),o}return u(n,[{key:"setZoomBttns",value:function(){this.zoomInBttn=new fr(this.ctx,new pr(0,0,0,0)),this.zoomOutBttn=new fr(this.ctx,new pr(0,0,0,0))}},{key:"resized",value:function(){this.setZoomBttns(),this.book&&this.draw()}},{key:"zoomed",value:function(e){this.zoomLevel&&this.book.buys&&this.book.sells&&(this.wheeled(),this.zoomLevel*=e?2/3:1.5,this.zoomLevel=br(this.zoomLevel,.005,2),this.draw(),this.reporters.zoom(this.zoomLevel))}},{key:"clicked",value:function(e){if(this.dataExtents){var t=e.clientX-this.rect.left,n=e.clientY-this.rect.y;if(this.zoomInBttn.contains(t,n))this.zoom(!0);else if(this.zoomOutBttn.contains(t,n))this.zoom(!1);else{var r=this.plotRegion.translator(this.dataExtents);this.reporters.click(r.unx(t))}}}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"set",value:function(e,t,n,a,o){this.book=e,this.lotSize=t/a.conventional.conversionFactor;var s=[o.conventional.conversionFactor,a.conventional.conversionFactor],i=s[0],c=s[1];if(this.rateStep=n/jn*i/c,this.baseUnit=a.conventional.unit,this.quoteUnit=o.conventional.unit,!this.zoomLevel){var l=r(this.gap(),2),u=l[0],h=l[1],d=Math.max(h/u*5,.05);this.zoomLevel=Math.min(d,2)}this.draw()}},{key:"render",value:function(){var e=this;if(this.book&&this.visible&&0!==this.canvas.width){this.clear();var t=this.ctx,n=this.mousePos,a=this.book.buys,o=this.book.sells,s=r(this.gap(),2),i=s[0],c=s[1],l=this.zoomLevel*i/2,u=i+l,h=i-l,d=yn(this.markers.buys),p=yn(this.markers.sells);d.sort((function(e,t){return t.rate-e.rate})),p.sort((function(e,t){return e.rate-t.rate}));for(var f=[],m=[],v=[],y=[],g=[],b={buyBase:0,buyQuote:0,sellBase:0,sellQuote:0},w=0,k=0,x=0;x<a.length;x++){var C=a[x];if(k+=C.qty,C.rate>=h&&v.push([C.rate,k]),!C.epoch)for(w+=C.qty,m.push([C.rate,w]),b.buyBase+=C.qty,b.buyQuote+=C.qty*C.rate;d.length&&xr(d[0].rate,C.rate);){var S=d.shift();S&&f.push({rate:S.rate,qty:C.epoch?k:w,sell:C.sell,active:S.active})}}var E=m.length?yr(m)[1]:0;m.push([h,E]);var A=v.length?yr(v)[1]:0;v.push([h,A]),k=w=0;for(var F=0;F<o.length;F++){var I=o[F];if(k+=I.qty,I.rate<=u&&g.push([I.rate,k]),!I.epoch)for(w+=I.qty,y.push([I.rate,w]),b.sellBase+=I.qty,b.sellQuote+=I.qty*I.rate;p.length&&xr(p[0].rate,I.rate);){var R=p.shift();R&&f.push({rate:R.rate,qty:I.epoch?k:w,sell:I.sell,active:R.active})}}var D=y.length?yr(y)[1]:0;y.push([u,D]);var O=g.length?yr(g)[1]:0;g.push([u,O]);var T=this.xRegion.extents.y.min,P=(T+30)/T,L=(O&&A?Math.max(A,O):O||A||1)*P,B=new pr(h,u,0,L);this.dataExtents=B,this.doYLabels(this.plotRegion,this.lotSize,this.baseUnit);var M=mr(t,this.plotRegion.width(),B.x.min,B.x.max,100,this.rateStep,"");this.plotXLabels(M,h,u,["".concat(this.quoteUnit,"/"),this.baseUnit]);var W=null;this.drawFrame(),this.plotRegion.plot(B,(function(t,r){t.lineWidth=1,t.strokeStyle=e.theme.gridBorder,t.lineWidth=2.5,t.strokeStyle=e.theme.gapLine,gr(t,r.x(i),r.y(0),r.x(i),r.y(.3*B.y.max)),t.font="30px 'demi-sans', sans-serif",t.textAlign="center",t.textBaseline="middle",t.fillStyle=e.theme.value;var a=.5*B.y.max;t.fillText(kr(i),r.x(i),r.y(a)),t.font="12px 'sans', sans-serif",t.fillText("".concat((c/i*100).toFixed(2),"% spread"),r.x(i),r.y(a)+24),t.textAlign="center",t.textBaseline="middle";var o=e.plotRegion.extents.midX,s=r.y(.9*L),l=B.xRange/i*100,d="".concat(l.toFixed(1),"%"),p=t.measureText(d).width;t.font="13px 'sans', sans-serif",t.fillText(d,o,s+1);var v=o-p/2-10-20,g=s-10;e.zoomOutBttn.setExtents(v,v+20,g,g+20);var b=n&&e.zoomOutBttn.contains(n.x,n.y);e.zoomOutBttn.plot(new pr(0,1,0,1),(function(t){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,b&&(t.fillStyle=e.theme.zoomHover,t.font="13px 'icomoon'"),t.fillText(sr,e.zoomOutBttn.extents.midX,e.zoomOutBttn.extents.midY)})),v=o+p/2+10,e.zoomInBttn.setExtents(v,v+20,g,g+20),b=n&&e.zoomInBttn.contains(n.x,n.y),e.zoomInBttn.plot(new pr(0,1,0,1),(function(t){t.font="12px 'icomoon'",t.fillStyle=e.theme.zoom,b&&(t.fillStyle=e.theme.zoomHover,t.font="14px 'icomoon'"),t.fillText(or,e.zoomInBttn.extents.midX,e.zoomInBttn.extents.midY)}));var w,k=function(e,n){e>u||e<h||(t.save(),t.setLineDash([3,5]),t.lineWidth=1.5,t.strokeStyle=n,gr(t,r.x(e),r.y(0),r.x(e),r.y(L)),t.restore())},x=tr(e.lines||[]);try{for(x.s();!(w=x.n()).done;){var C=w.value;k(C.rate,C.color)}}catch(e){x.e(e)}finally{x.f()}for(var S=.005*(u-h),E=[],A=0,F=f||[];A<F.length;A++){var I=F[A],R=n&&Cr(I.rate,r.unx(n.x),S);R&&E.push(I.rate),t.save(),t.lineWidth=R||I.active?5:3,t.strokeStyle=I.sell?e.theme.sellLine:e.theme.buyLine,t.fillStyle=I.sell?e.theme.sellFill:e.theme.buyFill;var D=R||I.active?10:8;t.beginPath();var O={x:r.x(I.rate),y:r.y(I.qty)-8},T=O.y-Math.sqrt(3)*D/2;t.moveTo(O.x,O.y),t.lineTo(O.x-D/2,T),t.lineTo(O.x+D/2,T),t.closePath(),t.stroke(),t.fill(),t.restore()}if(n&&e.plotRegion.contains(n.x,n.y)){var P=r.unx(n.x),M=y,q=function(e){return e>=P},N=e.theme.sellLine;P<i&&(M=m,q=function(e){return e<=P},N=e.theme.buyLine);for(var U=M[0],_=0;_<M.length;_++){var z=M[_];if(q(z[0]))break;U=z}k(P,e.theme.crosshairs),W={rate:P,depth:U[1],dotColor:N,hoverMarkers:E}}})),t.lineWidth=1.5,t.setLineDash([3,3]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(g),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(v),t.lineWidth=2.5,t.setLineDash([]),t.fillStyle=this.theme.sellFill,t.strokeStyle=this.theme.sellLine,this.drawDepth(y),t.fillStyle=this.theme.buyFill,t.strokeStyle=this.theme.buyLine,this.drawDepth(m),W&&this.plotRegion.plot(B,(function(e,t){W&&function(e,t,n,r,a){e.fillStyle=r,e.beginPath(),e.arc(t,n,5,0,ar),e.fill()}(e,t.x(W.rate),t.y(W.depth),W.dotColor)})),this.reporters.volume(b),this.reporters.mouse(W)}else this.renderScheduled=!0}},{key:"drawDepth",value:function(e){var t,n=e[0],r=n[1];this.plotRegion.plot(this.dataExtents,(function(a,o){o.dataCoords((function(){a.beginPath(),a.moveTo(n[0],n[1]);for(var o=0;o<e.length;o++)t=e[o][0],a.lineTo(t,r),r=e[o][1],a.lineTo(t,r)})),a.stroke(),o.dataCoords((function(){a.lineTo(t,0),a.lineTo(n[0],0)})),a.closePath(),a.globalAlpha=.25,a.fill()}))}},{key:"gap",value:function(){var e=[this.book.bestGapBuy(),this.book.bestGapSell()],t=e[0],n=e[1];return t?n?[(n.rate+t.rate)/2,n.rate-t.rate]:[t.rate,0]:n?[n.rate,0]:[1,0]}},{key:"setLines",value:function(e){this.lines=e}},{key:"setMarkers",value:function(e){this.markers=e}}]),n}(lr),hr=function(e){on(n,e);var t=er(n);function n(e,r){var a;return s(this,n),h(rn(a=t.call(this,e,{resize:function(){return a.resized()},click:function(){a.clicked()},zoom:function(e){return a.zoomed(e)}})),"reporters",void 0),h(rn(a),"data",void 0),h(rn(a),"zoomLevel",void 0),h(rn(a),"numToShow",void 0),h(rn(a),"candleRegion",void 0),h(rn(a),"volumeRegion",void 0),h(rn(a),"resizeTimer",void 0),h(rn(a),"zoomLevels",void 0),h(rn(a),"market",void 0),h(rn(a),"rateConversionFactor",void 0),a.reporters=r,a.zoomLevel=1,a.numToShow=100,a.resize(),a}return u(n,[{key:"resized",value:function(){var e=this,t=this.plotRegion.extents,n=new pr(t.x.min,t.x.max,t.y.min,t.y.min+.85*t.yRange);this.candleRegion=new fr(this.ctx,n);var r=new pr(t.x.min,t.x.max,t.y.min+.85*t.yRange,t.y.max);this.volumeRegion=new fr(this.ctx,r),this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=window.setTimeout((function(){return e.draw()}),100)}},{key:"clicked",value:function(){}},{key:"zoomed",value:function(e){var t=this.zoomLevels.indexOf(this.numToShow);if(e){if(0===t)return;this.numToShow=this.zoomLevels[t-1]}else{if(this.zoomLevels.length<=t+1||this.numToShow>this.data.candles.length)return;this.numToShow=this.zoomLevels[t+1]}this.draw()}},{key:"render",value:function(){var e=this,t=this.data;if(t&&this.visible&&0!==this.canvas.width){var n=t.ms,r=this.mousePos,a=t.candles||[],o=Math.min(this.numToShow,a.length),s=a.slice(a.length-o);if(this.clear(),0!==o){var i,c=function(e){return Sr(e.endStamp,n)},l=function(e){return c(e)+n},u=function(e){return c(e)+.2*n},h=.6*n,d=s[0],p=s[o-1],f=[d.highRate,d.lowRate,d.matchVolume],m=f[0],v=f[1],y=f[2],g=tr(s);try{for(g.s();!(i=g.n()).done;){var b=i.value;b.highRate>m&&(m=b.highRate),b.lowRate<v&&(v=b.lowRate),b.matchVolume>y&&(y=b.matchVolume)}}catch(e){g.e(e)}finally{g.f()}var w=this.market.ratestep,k=new pr(c(d),l(p),v,m);v===m&&(k.y.min-=w,k.y.max+=w),this.dataExtents=k;var x=this.rateConversionFactor;this.doYLabels(this.candleRegion,w,this.market.quotesymbol,(function(e){return kr(e/x)})),this.candleRegion.extents.x.min=this.yRegion.extents.x.max,this.volumeRegion.extents.x.min=this.yRegion.extents.x.max;var C=function(e,t,n,r){var a=e[0],o=e[e.length-1],s=Sr(a.endStamp,t),i=Sr(o.endStamp,t)+t,c=i-s,l=Math.min(e.length,n/100),u=Sr(c/l,t);if(0===u)return console.error("zero tick",t,c,l),{lbls:[]};var h=s,d=(new Date).getTimezoneOffset(),p=function(e){return(e-=6e4*d)-e%864e5},f=p(s),m=0;p(a.endStamp)===p(o.endStamp)&&(f=0);var v,y=[];for(v=t<864e5?function(e,t){return p(t)!==f?"".concat(vr[e.getMonth()]).concat(e.getDate()," ").concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0")):"".concat(e.getHours(),":").concat(String(e.getMinutes()).padStart(2,"0"))}:function(e){var t=e.getFullYear();return t!==m?"".concat(vr[e.getMonth()]).concat(e.getDate()," '").concat(String(t).slice(2,4)):"".concat(vr[e.getMonth()]).concat(e.getDate())};h<=i;){var g=new Date(h);y.push({val:h,txt:v(g,h)}),f=p(h),m=g.getFullYear(),h+=u}return{lbls:y}}(s,n,this.plotRegion.width());this.plotXLabels(C,c(d),l(p),[]),this.drawFrame();var S=null;if(r&&(this.plotRegion.plot(new pr(k.x.min,k.x.max,0,1),(function(t,a){var o,i=Sr(a.unx(r.x),n),l=tr(s);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(c(u)===i){S=u,t.fillStyle=e.theme.gridLines,t.fillRect(a.x(c(u)),a.y(0),a.w(n),a.h(1));break}}}catch(e){l.e(e)}finally{l.f()}})),S)){var E=this.xRegion.extents.y;this.xRegion.plot(new pr(k.x.min,k.x.max,E.min,E.max),(function(t,n){if(S){e.applyLabelStyle();var r="".concat(new Date(c(S)).toLocaleString()," - ").concat(new Date(l(S)).toLocaleString()),a=t.measureText(r).width+50,o=n.x((c(S)+l(S))/2),s=o-a/2,i=e.xRegion.extents.x;s<i.min?s=i.min:s+a>i.max&&(s=i.max-a),o=s+a/2;var u=E.min+(e.xRegion.height()-16)/2;t.fillStyle=e.theme.legendFill,t.strokeStyle=e.theme.gridBorder;var h=[s-25,u-2,a+50,20];t.fillRect.apply(t,h),t.strokeRect.apply(t,h),e.applyLabelStyle(),t.fillText(r,o,e.xRegion.extents.midY,a)}}))}var A=new pr(c(d),l(p),0,y);this.volumeRegion.plot(A,(function(t,n){t.fillStyle=e.theme.gridBorder;var r,a=tr(s);try{for(a.s();!(r=a.n()).done;){var o=r.value;t.fillRect(n.x(u(o)),n.y(0),n.w(h),n.h(o.matchVolume))}}catch(e){a.e(e)}finally{a.f()}})),this.candleRegion.plot(k,(function(t,n){t.lineWidth=1;var r,a=tr(s);try{for(a.s();!(r=a.n()).done;){var o=r.value,i=o.startRate>o.endRate,c=[n.x(u(o)),n.y(o.startRate),n.w(h),n.h(o.endRate-o.startRate)],l=c[0],d=c[1],p=c[2],f=c[3],m=[n.y(o.highRate),n.y(o.lowRate),p/2+l],v=m[0],y=m[1],g=m[2];t.strokeStyle=i?e.theme.sellLine:e.theme.buyLine,t.fillStyle=i?e.theme.sellFill:e.theme.buyFill,t.beginPath(),t.moveTo(g,v),t.lineTo(g,y),t.stroke(),t.fillRect(l,d,p,f),t.strokeRect(l,d,p,f)}}catch(e){a.e(e)}finally{a.f()}})),this.reporters.mouse(S)}}else this.renderScheduled=!0}},{key:"setCandles",value:function(e,t,n,r){if(this.data=e,e.candles){this.market=t;var a=[r.conventional.conversionFactor,n.conventional.conversionFactor],o=a[0],s=a[1];this.rateConversionFactor=jn*o/s;var i=25;this.zoomLevels=[];for(var c=Math.max(e.candles.length,1e3);i<c;)this.zoomLevels.push(i),i*=2;this.numToShow=100,this.draw()}}}]),n}(lr),dr=function(e){on(n,e);var t=er(n);function n(e,r){var a;s(this,n),h(rn(a=t.call(this,e,{resize:function(){return a.resized()},click:function(){},zoom:function(){}})),"ani",void 0),h(rn(a),"size",void 0),h(rn(a),"region",void 0),h(rn(a),"colorShift",void 0),h(rn(a),"opts",void 0),h(rn(a),"msgRegion",void 0),h(rn(a),"fontSize",void 0),a.canvas.classList.add("fill-abs"),a.canvas.style.zIndex="5",a.opts=null!=r?r:{};var o=1500*Math.random();a.colorShift=360*Math.random();var i=[1,.65,.75],c=[3,3,2],l=[Math.PI,10*Math.PI/9,Math.PI/2.5],u=[0,0,1.5*Math.PI],d=function(e,t,n){return i[e]*Math.cos(c[e]*t+l[e]*n+u[e])},p=function(e,t){var n=e*Math.PI*2;return(d(0,n,t)+d(1,n,t)+d(2,n,t))/3};return a.resize(),a.ani=new Ht(Ht.Forever,(function(){for(var e=((new Date).getTime()-o)/1500*Math.PI*2,t=[],n=0;n<75;n++)t.push(p(n/74,e));a.drawValues(t)})),a}return u(n,[{key:"resized",value:function(){var e=this.opts,t=[this.canvas.width,this.canvas.height],n=t[0],r=t[1],a=.8*n,o=.8*r;a>150&&(a=150),o>100&&(o=100);var s=(n-a)/2,i=(r-o)/2;if(e.message){this.fontSize=br(.15*o,10,14),this.applyLabelStyle(this.fontSize);var c=.5*this.fontSize,l=this.fontSize/2+c;i-=l,this.msgRegion=new fr(this.ctx,new pr(0,n,i+o,i+o+2*l))}this.region=new fr(this.ctx,new pr(s,s+a,i,i+o))}},{key:"drawValues",value:function(e){var t=this;if(this.region){this.clear();var n=function(e){return"hsl(".concat(e,", 35%, 50%)")},r=this.region,a=this.msgRegion,o=this.canvas,s=o.width,i=o.height,c=this.opts,l=c.backgroundColor,u=c.message,h=this.colorShift,d=this.ctx;l&&(d.fillStyle=!0===l?window.getComputedStyle(document.body,null).getPropertyValue("background-color"):l,d.fillRect(0,0,s,i)),r.plot(new pr(0,1,-1,1),(function(t,r){t.lineWidth=4,t.lineCap="round";var a=h+(new Date).getTime()%2e3/2e3*360,o=t.createLinearGradient(r.x(0),0,r.x(1),0);o.addColorStop(0,n(a)),t.strokeStyle=o,t.beginPath(),t.moveTo(r.x(0),r.y(e[0]));for(var s=1;s<e.length;s++){var i=s/(e.length-1);o.addColorStop(i,n(300*i+a)),t.lineTo(r.x(i),r.y(e[s]))}t.stroke()})),u&&a.plot(new pr(0,1,0,1),(function(e,n){e.fillText(u,n.x(.5),n.y(.5),t.msgRegion.width())}))}}},{key:"render",value:function(){}},{key:"stop",value:function(){this.ani.stop(),this.canvas.remove()}}]),n}(lr),pr=function(){function e(t,n,r,a){s(this,e),h(this,"x",void 0),h(this,"y",void 0),this.setExtents(t,n,r,a)}return u(e,[{key:"setExtents",value:function(e,t,n,r){this.x={min:e,max:t},this.y={min:n,max:r}}},{key:"xRange",get:function(){return this.x.max-this.x.min}},{key:"midX",get:function(){return(this.x.max+this.x.min)/2}},{key:"yRange",get:function(){return this.y.max-this.y.min}},{key:"midY",get:function(){return(this.y.max+this.y.min)/2}}]),e}(),fr=function(){function e(t,n){s(this,e),h(this,"context",void 0),h(this,"extents",void 0),this.context=t,this.extents=n}return u(e,[{key:"setExtents",value:function(e,t,n,r){this.extents.setExtents(e,t,n,r)}},{key:"width",value:function(){return this.extents.xRange}},{key:"height",value:function(){return this.extents.yRange}},{key:"contains",value:function(e,t){var n=this.extents;return e<n.x.max&&e>n.x.min&&t<n.y.max&&t>n.y.min}},{key:"translator",value:function(e){var t=this.extents,n=e.x.min,r=e.y.min,a=e.yRange,o=e.xRange,s=t.x.min,i=t.x.max-s,c=t.y.max,l=c-t.y.min,u=i/o,h=l/a;return{x:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return(e-n)*u+s})),y:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return c-(e-r)*h})),unx:function(e){return(e-s)/u+n},uny:function(e){return r-(e-c)/h},w:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return e/o*i})),h:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return-e/a*l})),dataCoords:function(){}}}},{key:"clear",value:function(){var e=this.extents;this.context.clearRect(e.x.min,e.y.min,e.xRange,e.yRange)}},{key:"plot",value:function(e,t,n){var r=this.context,a=this.extents;r.save(),n||(r.beginPath(),r.rect(a.x.min,a.y.min,a.xRange,a.yRange),r.clip());var o=this.translator(e),s=e.yRange,i=a.xRange/e.xRange,c=a.yRange/s,l=e.x.min,u=e.y.min,h=a.x.min+l-l*i,d=-a.y.min-(s-u)*c;o.dataCoords=function(e){r.save(),r.transform(1,0,0,-1,-l,u),r.transform(i,0,0,c,h,d),e(),r.restore()},t(this.context,o),r.restore()}}]),e}();function mr(e,t,n,r,a,o,s,i){i=i||kr;var c=t/a,l=r-n;if(c<1||l<=0)return{lbls:[]};for(var u=l/c,h=u+o-u%o,d=n+h-n%h,p=Math.max(Math.abs(r),Math.abs(n)),f=Math.round(Math.log10(p/h))+2,m=[],v=0;d<r;){var y=i(d=Number(d.toPrecision(f)));v=Math.max(v,e.measureText(y).width),m.push({val:d,txt:y}),d+=h}var g=e.measureText(s).width;return g>v&&(v=g),{widest:v,lbls:m}}var vr=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function yr(e){return e[e.length-1]}function gr(e,t,n,r,a,o){e.beginPath(),e.moveTo(t,n),e.lineTo(r,a),o||e.stroke()}function br(e,t,n){return e<t?t:e>n?n:e}var wr={minimumSignificantDigits:4,maximumSignificantDigits:5};function kr(e){return e.toLocaleString("en-us",wr)}function xr(e,t){return Cr(e,t,1e-8)}function Cr(e,t,n){return Math.abs(e-t)<Math.abs(n)}function Sr(e,t){return e-e%t}function Er(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ar(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ar(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fr=function(){function e(t,n,r,a){var o=this;s(this,e),h(this,"page",void 0),h(this,"form",void 0),h(this,"pwCache",void 0),h(this,"success",void 0),h(this,"current",void 0),h(this,"pwHiders",void 0),h(this,"subform",void 0),h(this,"walletCfgGuide",void 0),h(this,"parentSyncer",void 0),h(this,"createUpdater",void 0),this.form=t,this.success=n,this.pwCache=r||null;var i=this.page=jt.parseTemplate(t);this.pwHiders=Array.from(t.querySelectorAll(".hide-pw")),this.refresh(),a&&(jt.show(i.goBack),jt.bind(i.goBack,"click",(function(){a()}))),jt.empty(i.walletTabTmpl),i.walletTabTmpl.removeAttribute("id"),this.subform=new Rr(i.walletSettings,!0),this.walletCfgGuide=jt.tmplElement(t,"walletCfgGuide"),Vr(t,i.submitAdd,(function(){return o.submit()})),Vr(t,i.oneBttn,(function(){return o.submit()})),Sn().registerNoteFeeder({walletstate:function(e){o.reportWalletState(e.wallet)},createwallet:function(e){o.reportCreationUpdate(e)}})}var t,n,r,a,i,c,l;return u(e,[{key:"reportWalletState",value:function(e){this.parentSyncer&&this.parentSyncer(e)}},{key:"reportCreationUpdate",value:function(e){this.createUpdater&&this.createUpdater(e)}},{key:"refresh",value:function(){nn.passwordIsCached()||this.pwCache&&this.pwCache.pw?jt.hide.apply(jt,yn(this.pwHiders)):jt.show.apply(jt,yn(this.pwHiders))}},{key:"createWallet",value:(l=o(w().mark((function e(t,n,r,a){var o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={assetID:t,pass:this.page.newWalletPass.value||"",config:this.subform.map(t),appPass:r,walletType:n,parentForm:a},s=new dr(this.page.mainForm,{backgroundColor:!0}),e.next=4,dn("/api/newwallet",o);case 4:return i=e.sent,s.stop(),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"submit",value:(c=o(w().mark((function e(){var t,n,r,a,o,s,i,c,l,u;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=t.appPass,r=t.newWalletPass,(a=n.value||(this.pwCache?this.pwCache.pw:""))||nn.passwordIsCached()){e.next=8;break}return t.newWalletErr.textContent=Rt(x),jt.show(t.newWalletErr),e.abrupt("return");case 8:return jt.hide(t.newWalletErr),o=this.current,s=o.asset,i=o.parentAsset,c=this.current.selectedDef,i&&(l={assetID:i.id,config:this.subform.map(i.id),walletType:c.type}),e.next=14,this.createWallet(s.id,c.type,a,l);case 14:if(u=e.sent,Sn().checkResponse(u)){e.next=18;break}return this.setError(u.msg),e.abrupt("return");case 18:if(this.pwCache&&(this.pwCache.pw=a),t.appPass.value="",r.value="",!i){e.next=26;break}return e.next=24,this.runParentSync();case 24:e.next=27;break;case 26:this.success(this.current.asset.id);case 27:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"runParentSync",value:(i=o(w().mark((function e(){var t,n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=this.current,r=n.parentAsset,a=n.asset,r){e.next=3;break}return e.abrupt("return");case 3:return t.parentSyncPct.textContent="0",t.parentName.textContent=r.name,t.parentLogo.src=jt.logoPath(r.symbol),t.childName.textContent=a.name,t.childLogo.src=jt.logoPath(a.symbol),jt.hide(t.mainForm),jt.show(t.parentSyncing),e.prev=10,e.next=13,this.syncParent(r);case 13:this.success(this.current.asset.id),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),this.setError(e.t0.message||e.t0);case 19:jt.show(t.mainForm),jt.hide(t.parentSyncing);case 21:case"end":return e.stop()}}),e,this,[[10,16]])}))),function(){return i.apply(this,arguments)})},{key:"syncParent",value:function(e){var t=this,n=this.page,r=this.current.asset;return new Promise((function(a,o){var s=Sn().assets[e.id].wallet;if(s&&s.synced)return a();t.parentSyncer=function(t){t.assetID===e.id&&(n.parentSyncPct.textContent=(100*t.syncProgress).toFixed(1))},t.createUpdater=function(e){if(e.assetID===r.id){switch(e.topic){case"QueuedCreationFailed":o(new Error("".concat(e.subject,": ").concat(e.details)));break;case"QueuedCreationSuccess":a();break;default:return}t.parentSyncer=null,t.createUpdater=null}}}))}},{key:"setAsset",value:(a=o(w().mark((function e(t){var n,r,a,o,s,i,c,l,u,h,d,p=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.parseAsset(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=this.page,r=n.walletTypeTabs,a=this.current,o=a.winfo,s=a.asset,i=a.parentAsset,n.assetName.textContent=o.name,n.newWalletPass.value="",jt.empty(r),jt.hide(r,n.newWalletErr),n.header.classList.remove("bordertop"),this.page.assetLogo.src=jt.logoPath(s.symbol),c=i?i.info:null,!((l=c?c.availablewallets:o.availablewallets?o.availablewallets:[o.definition]).length>1)){e.next=34;break}jt.show(r),u=Er(l),e.prev=16,d=w().mark((function e(){var t,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=h.value,(a=n.walletTabTmpl.cloneNode(!0)).dataset.tooltip=t.description,a.textContent=t.tab,r.appendChild(a),jt.bind(a,"click",(function(){var e,n=Er(jt.kids(r));try{for(n.s();!(e=n.n()).done;)e.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}a.classList.add("selected"),p.update(t)}));case 6:case"end":return e.stop()}}),e)})),u.s();case 19:if((h=u.n()).done){e.next=23;break}return e.delegateYield(d(),"t0",21);case 21:e.next=19;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(16),u.e(e.t1);case 28:return e.prev=28,u.f(),e.finish(28);case 31:Sn().bindTooltips(r),r.firstChild.classList.add("selected");case 34:return e.next=36,this.update(this.current.selectedDef);case 36:if(!s.walletCreationPending){e.next=39;break}return e.next=39,this.runParentSync();case 39:case"end":return e.stop()}}),e,this,[[16,25,28,31]])}))),function(e){return a.apply(this,arguments)})},{key:"parseAsset",value:function(e){if(this.current&&this.current.asset.id===e)return!1;var t=Sn().assets[e],n=t.token;if(!n){if(!t.info)throw Error("this non-token asset has no wallet info!");return this.current={asset:t,winfo:t.info,selectedDef:t.info.availablewallets[0]},!0}var r=Sn().user.assets[n.parentID];if(r.wallet)return this.current={asset:t,winfo:n,selectedDef:n.definition},!0;if(!r.info)throw Error("this parent has no wallet info!");return this.current={asset:t,parentAsset:r,winfo:n,selectedDef:r.info.availablewallets[0]},!0}},{key:"update",value:(r=o(w().mark((function e(t){var n,r,a,o,s,i,c,l,u,h,d,p,f,m,v,y,g,b,k;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,this.current.selectedDef=t,r=nn.passwordIsCached()||this.pwCache&&this.pwCache.pw,jt.hide(n.auth,n.oneBttnBox,n.newWalletPassBox),a=t.guidelink,(o=t.configopts||[]).map((function(e){return e.isBirthdayConfig&&Sn().seedGenTime>0&&(e.default=jr(new Date)),e})),s=!1,i=Er(o),e.prev=9,i.s();case 11:if((c=i.n()).done){e.next=18;break}if(!c.value.required){e.next=16;break}return s=!0,e.abrupt("break",18);case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:if(l=this.current,u=l.asset,h=l.parentAsset,d=l.winfo,p=t.seeded||Boolean(u.token),r&&p&&!s?jt.show(n.oneBttnBox):p?(jt.show(n.auth),n.newWalletPass.value="",n.submitAdd.textContent=Rt(he)):(jt.show(n.auth),t.noauth||jt.show(n.newWalletPassBox),n.submitAdd.textContent=Rt(ue)),h){f=JSON.parse(JSON.stringify(o)),m=Er(f);try{for(m.s();!(v=m.n()).done;)v.value.regAsset=h.id}catch(e){m.e(e)}finally{m.f()}if((y=d.definition.configopts||[]).length>0){g=JSON.parse(JSON.stringify(y)),b=Er(g);try{for(b.s();!(k=b.n()).done;)k.value.regAsset=u.id}catch(e){b.e(e)}finally{b.f()}f.push.apply(f,yn(g))}this.subform.update(u.id,f,!1)}else this.subform.update(u.id,o,!1);return this.setGuideLink(a),this.subform.dynamicOpts.children.length||this.subform.defaultSettings.children.length?jt.show(n.walletSettingsHeader):jt.hide(n.walletSettingsHeader),t.seeded||Boolean(this.current.asset.token)?jt.hide(this.subform.fileSelector):jt.show(this.subform.fileSelector),this.refresh(),e.next=36,this.loadDefaults();case 36:case"end":return e.stop()}}),e,this,[[9,20,23,26]])}))),function(e){return r.apply(this,arguments)})},{key:"setGuideLink",value:function(e){jt.hide(this.walletCfgGuide),""!==e&&(this.walletCfgGuide.href=e,jt.show(this.walletCfgGuide))}},{key:"setError",value:(n=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.page.newWalletErr.textContent=t,jt.show(this.page.newWalletErr);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"loadDefaults",value:(t=o(w().mark((function e(){var t,n,r,a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.current,n=t.asset,r=t.parentAsset,(a=t.selectedDef).configpath){e.next=3;break}return e.abrupt("return");case 3:if(o=n.id,!r){e.next=8;break}if(!a.seeded){e.next=7;break}return e.abrupt("return");case 7:o=r.id;case 8:return s=Sn().loading(this.form),e.next=11,dn("/api/defaultwalletcfg",{assetID:o,type:a.type});case 11:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=16;break}return this.setError(i.msg),e.abrupt("return");case 16:this.subform.setLoadedConfig(i.config);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ir=0,Rr=function(){function e(t,n){var r=this;s(this,e),h(this,"page",void 0),h(this,"form",void 0),h(this,"configElements",void 0),h(this,"configOpts",void 0),h(this,"sectionize",void 0),h(this,"allSettings",void 0),h(this,"dynamicOpts",void 0),h(this,"textInputTmpl",void 0),h(this,"dateInputTmpl",void 0),h(this,"checkboxTmpl",void 0),h(this,"repeatableTmpl",void 0),h(this,"fileSelector",void 0),h(this,"fileInput",void 0),h(this,"errMsg",void 0),h(this,"showOther",void 0),h(this,"showIcon",void 0),h(this,"hideIcon",void 0),h(this,"showHideMsg",void 0),h(this,"otherSettings",void 0),h(this,"loadedSettingsMsg",void 0),h(this,"loadedSettings",void 0),h(this,"defaultSettingsMsg",void 0),h(this,"defaultSettings",void 0),h(this,"assetHasActiveOrders",void 0),h(this,"assetID",void 0),this.page=jt.idDescendants(t),this.form=t,this.configElements=[],this.configOpts=[],this.sectionize=n,this.allSettings=jt.tmplElement(t,"allSettings"),this.dynamicOpts=jt.tmplElement(t,"dynamicOpts"),this.textInputTmpl=jt.tmplElement(t,"textInput"),this.textInputTmpl.remove(),this.dateInputTmpl=jt.tmplElement(t,"dateInput"),this.dateInputTmpl.remove(),this.checkboxTmpl=jt.tmplElement(t,"checkbox"),this.checkboxTmpl.remove(),this.repeatableTmpl=jt.tmplElement(t,"repeatableInput"),this.repeatableTmpl.remove(),this.fileSelector=jt.tmplElement(t,"fileSelector"),this.fileInput=jt.tmplElement(t,"fileInput"),this.errMsg=jt.tmplElement(t,"errMsg"),this.showOther=jt.tmplElement(t,"showOther"),this.showIcon=jt.tmplElement(t,"showIcon"),this.hideIcon=jt.tmplElement(t,"hideIcon"),this.showHideMsg=jt.tmplElement(t,"showHideMsg"),this.otherSettings=jt.tmplElement(t,"otherSettings"),this.loadedSettingsMsg=jt.tmplElement(t,"loadedSettingsMsg"),this.loadedSettings=jt.tmplElement(t,"loadedSettings"),this.defaultSettingsMsg=jt.tmplElement(t,"defaultSettingsMsg"),this.defaultSettings=jt.tmplElement(t,"defaultSettings"),n||jt.hide(this.showOther),jt.bind(this.fileSelector,"click",(function(){return r.fileInput.click()})),jt.bind(this.fileInput,"change",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.fileInputChanged());case 1:case"end":return e.stop()}}),e)})))),jt.bind(this.showOther,"click",(function(){r.setOtherSettingsViz(r.hideIcon.classList.contains("d-hide"))}))}var t;return u(e,[{key:"fileInputChanged",value:(t=o(w().mark((function e(){var t,n,r,a,o,s,i,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(jt.hide(this.errMsg),this.fileInput.value){e.next=3;break}return e.abrupt("return");case 3:if((n=this.fileInput.files)&&0!==n.length){e.next=6;break}return e.abrupt("return");case 6:return r=Sn().loading(this.form),e.next=9,n[0].text();case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,dn("/api/parseconfig",{configtext:a});case 14:if(o=e.sent,r(),Sn().checkResponse(o)){e.next=20;break}return this.errMsg.textContent=o.msg,jt.show(this.errMsg),e.abrupt("return");case 20:if(0!==Object.keys(o.map).length){e.next=22;break}return e.abrupt("return");case 22:(t=this.dynamicOpts).append.apply(t,yn(this.setConfig(o.map))),this.reorder(this.dynamicOpts),s=[this.loadedSettings.children.length,this.defaultSettings.children.length],c=s[1],0===(i=s[0])&&jt.hide(this.loadedSettings,this.loadedSettingsMsg),0===c&&jt.hide(this.defaultSettings,this.defaultSettingsMsg),i+c===0&&jt.hide(this.showOther,this.otherSettings);case 28:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addOpt",value:function(e,t,n,r){var a,o,s,i=this;if(t.isboolean)s=this.checkboxTmpl.cloneNode(!0);else if(t.isdate)s=this.dateInputTmpl.cloneNode(!0);else if(t.repeatable){if((s=this.repeatableTmpl.cloneNode(!0)).classList.add("repeatable"),jt.bind(jt.tmplElement(s,"add"),"click",(function(){i.addOpt(e,t,s,!0)})),!r)for(var c=0;c<(t.repeatN?t.repeatN-1:0);c++)this.addOpt(e,t,n,!0)}else s=this.textInputTmpl.cloneNode(!0);-1!==((null===(a=Sn().user.extensionModeConfig)||void 0===a||null===(o=a.restrictedWallets[Gr(this.assetID)])||void 0===o?void 0:o.hiddenFields)||[]).indexOf(t.key)&&jt.hide(s),this.configElements.push([t,s]);var l=s.querySelector("input");l.dataset.configKey=t.key,Ir++;var u="wcfg-"+String(Ir);l.id=u;var h=jt.safeSelector(s,"label");if(h.htmlFor=u,h.prepend(t.displayname),void 0!==t.regAsset){var d=new window.Image(15,15);d.src=jt.logoPathFromID(t.regAsset||-1),h.prepend(d)}if(n?n.after(s):e.appendChild(s),t.noecho&&(l.type="password",l.autocomplete="off"),t.description&&(h.dataset.tooltip=t.description),t.isboolean)l.checked=t.default;else if(t.isdate){var p=function(e){return e?Hr("now"===e?new Date:new Date(1e3*e)):""};l.max=p(t.max),l.min=p(t.min);var f=t.default?new Date(1e3*t.default):new Date;l.value=Hr(f)}else l.value=null!==t.default?t.default:"";return l.disabled=Boolean(t.disablewhenactive&&this.assetHasActiveOrders),s}},{key:"update",value:function(e,t,n){if(this.assetHasActiveOrders=n,this.configElements=[],this.configOpts=t||[],this.assetID=e,jt.empty(this.dynamicOpts,this.defaultSettings,this.loadedSettings),0===this.configOpts.length)return jt.hide(this.form);jt.show(this.form),this.setOtherSettingsViz(!1),jt.hide(this.loadedSettingsMsg,this.loadedSettings,this.defaultSettingsMsg,this.defaultSettings,this.errMsg);var r,a=[],o=Er(this.configOpts);try{for(o.s();!(r=o.n()).done;){var s=r.value;this.sectionize&&null!==s.default?a.push(s):this.addOpt(this.dynamicOpts,s)}}catch(e){o.e(e)}finally{o.f()}if(a.length){var i,c=Er(a);try{for(c.s();!(i=c.n()).done;){var l=i.value;this.addOpt(this.defaultSettings,l)}}catch(e){c.e(e)}finally{c.f()}jt.show(this.showOther,this.defaultSettingsMsg,this.defaultSettings)}else jt.hide(this.showOther);Sn().bindTooltips(this.allSettings),this.dynamicOpts.children.length?jt.show(this.dynamicOpts):jt.hide(this.dynamicOpts)}},{key:"setOtherSettingsViz",value:function(e){if(e)return jt.hide(this.showIcon),jt.show(this.hideIcon,this.otherSettings),void(this.showHideMsg.textContent=Rt(D));jt.hide(this.hideIcon,this.otherSettings),jt.show(this.showIcon),this.showHideMsg.textContent=Rt(O)}},{key:"setConfig",value:function(e){for(var t,n=[],a={},o=[],s=0,i=yn(this.configElements);s<i.length;s++){var c=i[s],l=r(c,2),u=l[0],h=l[1],d=e[u.key];if(void 0!==d)if(u.repeatable){if(a[u.key]){h.remove(),o.push(c);continue}a[u.key]=!0;var p=d.split(u.repeatable),f=p[0];n.push(h),jt.safeSelector(h,"input").value=f;for(var m=1;m<(u.repeatN||1);m++)n.push(this.addOpt(h.parentElement,u,h,!0));for(var v=1;v<p.length;v++){var y=this.addOpt(h.parentElement,u,h,!0);jt.safeSelector(y,"input").value=p[v],n.push(y)}}else{n.push(h);var g=jt.safeSelector(h,"input");u.isboolean?g.checked="1"===(t=d)||"true"===t.toLowerCase():u.isdate?g.value=Hr(new Date(1e3*parseInt(d))):g.value=d}}for(var b=0,w=o;b<w.length;b++){var k=w[b],x=this.configElements.indexOf(k);x>=0&&this.configElements.splice(x,1)}return n}},{key:"setLoadedConfig",value:function(e){var t,n=this.setConfig(e);this.sectionize&&0!==n.length&&((t=this.loadedSettings).append.apply(t,yn(n)),this.reorder(this.loadedSettings),jt.show(this.loadedSettings,this.loadedSettingsMsg),0===this.defaultSettings.children.length&&jt.hide(this.defaultSettings,this.defaultSettingsMsg))}},{key:"map",value:function(e){var t,n={},a=Er(this.configElements);try{for(a.s();!(t=a.n()).done;){var o=r(t.value,2),s=o[0],i=o[1],c=jt.safeSelector(i,"input");if(void 0===s.regAsset||s.regAsset===e)if(s.isboolean&&s.key)n[s.key]=c.checked?"1":"0";else if(s.isdate&&s.key){var l=c.min?jr(new Date(c.min+"T00:00")):Number.MIN_SAFE_INTEGER,u=c.max?jr(new Date(c.max+"T00:00")):Number.MAX_SAFE_INTEGER,h=c.value?jr(new Date(c.value+"T00:00")):0;h<l?h=l:h>u&&(h=u),n[s.key]=""+h}else c.value&&(s.repeatable&&n[s.key]?n[s.key]+=s.repeatable+c.value:n[s.key]=c.value)}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"reorder",value:function(e){var t=this,n={};e.querySelectorAll("input").forEach((function(e){var a=e.dataset.configKey;if(a){var o,s=[],i=Er(t.configElements);try{for(i.s();!(o=i.n()).done;){var c=r(o.value,2),l=c[0],u=c[1];l.key===a&&s.push(u)}}catch(e){i.e(e)}finally{i.f()}n[a]=s}}));var a,o=Er(this.configOpts);try{for(o.s();!(a=o.n()).done;){var s,i=a.value,c=Er(n[i.key]||[]);try{for(c.s();!(s=c.n()).done;){var l=s.value;e.append(l)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){o.e(e)}finally{o.f()}}}]),e}(),Dr=function(){function e(t,n,r,a){var o=this;s(this,e),h(this,"form",void 0),h(this,"success",void 0),h(this,"page",void 0),h(this,"xc",void 0),h(this,"certFile",void 0),h(this,"bondAssetID",void 0),h(this,"pwCache",void 0),this.form=t,this.success=n,this.page=jt.parseTemplate(t),this.certFile="",this.pwCache=a,jt.bind(this.page.goBack,"click",(function(){return r()})),jt.bind(this.page.bondStrengthField,"input",(function(){var e=Sn().assets[o.bondAssetID];if(e){var t=e.unitInfo,n=o.xc.bondAssets[e.symbol];o.page.bondAmt.textContent=jt.formatCoinValue(o.totalBondAmount(n.amount),t)}})),Vr(t,this.page.submit,(function(){return o.submitForm()}))}var t,n;return u(e,[{key:"setExchange",value:function(e,t){this.xc=e,this.certFile=t;var n=this.page;nn.passwordIsCached()||this.pwCache&&this.pwCache.pw?jt.hide(n.passBox):jt.show(n.passBox),n.host.textContent=e.host}},{key:"setAsset",value:function(e){var t=Sn().assets[e],n=t.unitInfo;this.bondAssetID=t.id;var r=this.page,a=this.xc.bondAssets[t.symbol];r.bondAmt.textContent=jt.formatCoinValue(this.totalBondAmount(a.amount),n),r.bondUnit.textContent=n.conventional.unit.toUpperCase(),r.logo.src=jt.logoPath(t.symbol)}},{key:"totalBondAmount",value:function(e){var t;return+(null!==(t=this.page.bondStrengthField.value)&&void 0!==t?t:1)*e}},{key:"animate",value:(n=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,jt.animate(400,(function(e){t.style.transform="scale(".concat(e,")"),t.style.opacity=String(Math.pow(e,4));var n="".concat(500*(1-e),"px");t.style.top=n,t.style.left=n}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"submitForm",value:(t=o(w().mark((function e(){var t,n,r,a,o,s,i,c,l;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.page).submit.classList.contains("selected")){e.next=3;break}return e.abrupt("return");case 3:if(n=Sn().assets[this.bondAssetID]){e.next=8;break}return t.regErr.innerText=Rt(yt),jt.show(t.regErr),e.abrupt("return");case 8:return jt.hide(t.regErr),r=this.xc.bondAssets[n.wallet.symbol],e.next=12,this.certFile;case 12:return a=e.sent,o=this.xc.host,s=t.appPass.value||(this.pwCache?this.pwCache.pw:""),i={addr:o,cert:a,pass:s,bond:this.totalBondAmount(r.amount),asset:r.id},t.appPass.value="",c=Sn().loading(this.form),e.next=20,dn("/api/postbond",i);case 20:if(l=e.sent,c(),Sn().checkResponse(l)){e.next=26;break}return t.regErr.textContent=l.msg,jt.show(t.regErr),e.abrupt("return");case 26:this.success();case 27:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Or=function(){function e(t,n){var r=this;s(this,e),h(this,"form",void 0),h(this,"success",void 0),h(this,"xc",void 0),h(this,"page",void 0),h(this,"assetTmpls",void 0),this.form=t,this.success=n,this.page=jt.parseTemplate(t),jt.cleanTemplates(this.page.marketTmpl,this.page.assetTmpl),Sn().registerNoteFeeder({createwallet:function(e){"QueuedCreationSuccess"===e.topic&&r.walletCreated(e.assetID)}})}var t;return u(e,[{key:"setExchange",value:function(e){var t=this;this.xc=e,this.assetTmpls={};var n=this.page;jt.empty(n.assets,n.allMarkets);for(var a=function(e){return e.conventional.conversionFactor},o=function(t,r){var o=n.marketTmpl.cloneNode(!0),s=jt.parseTemplate(o),i=e.assets[t.baseid],c=Sn().unitInfo(t.baseid,e),l=e.assets[t.quoteid],u=Sn().unitInfo(t.quoteid,e);if(0===a(c)||0===a(u))return null;if(void 0!==r){var h=r===t.baseid,d=e.assets[h?t.quoteid:t.baseid].symbol;s.logo.src=jt.logoPath(d)}else{var p=s.logo.cloneNode(!0);s.logo.src=jt.logoPath(i.symbol),p.src=jt.logoPath(l.symbol);var f=s.logo.parentNode;f&&f.insertBefore(p,s.logo.nextSibling)}var m=i.symbol.toUpperCase(),v=l.symbol.toUpperCase();if(s.baseName.replaceWith(jt.symbolize(m)),s.quoteName.replaceWith(jt.symbolize(v)),s.lotSize.textContent=jt.formatCoinValue(t.lotsize,c),s.lotSizeSymbol.replaceWith(jt.symbolize(m)),t.spot){jt.show(s.quoteLotSize);var y=a(u)/a(c),g=t.lotsize*t.spot.rate/jn*y,b=jt.formatCoinValue(g,u);s.quoteLotSize.textContent="(~".concat(b," ").concat(v,")")}return o},s=function(){var a=r(c[i],2),s=a[0],l=a[1],u=Sn().assets[l.id];if(!u)return"continue";var h=u.unitInfo,d=n.assetTmpl.cloneNode(!0);jt.bind(d,"click",(function(){t.success(l.id)}));var p=t.assetTmpls[l.id]=jt.parseTemplate(d);n.assets.appendChild(d),p.logo.src=jt.logoPath(s);var f=jt.formatCoinValue(l.amount,h);p.feeAmt.textContent=String(f),p.feeSymbol.replaceWith(jt.symbolize(u.symbol)),p.confs.textContent=String(l.confs),Tr(p.ready,u);for(var m=0,v=0,y=Object.values(e.markets);v<y.length;v++){var g=y[v];if(g.baseid===l.id||g.quoteid===l.id){var b=o(g,l.id);b&&(m++,p.markets.appendChild(b))}}m<3&&jt.hide(p.fader)},i=0,c=Object.entries(e.bondAssets);i<c.length;i++)s();n.host.textContent=e.host;for(var l=0,u=Object.values(e.markets);l<u.length;l++){var h=u[l],d=o(h);d&&n.allMarkets.appendChild(d)}}},{key:"walletCreated",value:function(e){var t=this.assetTmpls[e],n=Sn().assets[e];Tr(t.ready,n)}},{key:"refresh",value:function(){this.setExchange(this.xc)}},{key:"animate",value:(t=o(w().mark((function e(){var t,n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.form,r=t.how,(a=Array.from(t.assets.children)).push(t.allmkts),n.style.opacity="0",e.next=11,jt.animate(350,(function(e){for(var t=0,o=a;t<o.length;t++){var s=o[t];s.style.marginTop="".concat(75*(1-e),"px"),s.style.transform="scale(".concat(e,")")}n.style.opacity=Math.pow(e,4).toFixed(1),n.style.paddingTop="".concat(50*(1-e),"px"),r.style.fontSize="".concat(24*e,"px")}),"easeOut");case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function Tr(e,t){t.wallet?e.textContent=Rt(ve):t.walletCreationPending?e.textContent=Rt(ye):e.textContent=Rt(ge),e.classList.remove("readygreen","setuporange"),e.classList.add(t.wallet?"readygreen":"setuporange")}var Pr=function(){function e(t,n,r){var a=this;s(this,e),h(this,"form",void 0),h(this,"success",void 0),h(this,"goBack",void 0),h(this,"page",void 0),h(this,"assetID",void 0),h(this,"parentID",void 0),h(this,"xc",void 0),h(this,"bondAsset",void 0),h(this,"progressCache",void 0),h(this,"progressed",void 0),h(this,"funded",void 0),h(this,"bondFeeBuffer",void 0),h(this,"parentAssetSynced",void 0),this.form=t,this.success=n,this.page=jt.parseTemplate(t),this.assetID=-1,this.progressCache=[],this.progressed=!1,this.funded=!1,jt.bind(this.page.goBack,"click",(function(){a.assetID=-1,r()})),Sn().registerNoteFeeder({walletstate:function(e){return a.reportWalletState(e.wallet)},balance:function(e){return a.reportBalance(e.assetID)}})}return u(e,[{key:"setExchange",value:function(e){this.xc=e}},{key:"setWallet",value:function(e,t){var n;this.assetID=e.assetID,this.progressCache=[],this.progressed=!1,this.funded=!1,this.bondFeeBuffer=t,this.parentAssetSynced=!1;var r=this.page,a=Sn().assets[e.assetID];this.parentID=null===(n=a.token)||void 0===n?void 0:n.parentID;var o,s=this.bondAsset=this.xc.bondAssets[a.symbol],i=function(e,t){jt.empty(e),e.appendChild(jt.symbolize(t))},c=Er(jt.applySelector(this.form,".unit"));try{for(c.s();!(o=c.n()).done;)i(o.value,a.symbol)}catch(e){c.e(e)}finally{c.f()}if(r.logo.src=jt.logoPath(a.symbol),r.depoAddr.textContent=e.address,r.fee.textContent=jt.formatCoinValue(s.amount,a.unitInfo),jt.hide(r.syncUncheck,r.syncCheck,r.balUncheck,r.balCheck,r.syncRemainBox),jt.show(r.balanceBox),t>0)if(r.totalForBond.textContent=jt.formatCoinValue(2*s.amount+t,a.unitInfo),jt.hide(r.sendEnough),jt.hide(r.txFeeBox,r.sendEnoughForToken,r.txFeeBalanceBox),jt.hide(r.sendEnoughWithEst),a.token){jt.show(r.txFeeBox,r.sendEnoughForToken,r.txFeeBalanceBox);var l=Sn().assets[a.token.parentID];r.txFee.textContent=jt.formatCoinValue(t,l.unitInfo),r.parentFees.textContent=jt.formatCoinValue(t,l.unitInfo),r.tokenFees.textContent=jt.formatCoinValue(s.amount,a.unitInfo),i(r.txFeeUnit,l.symbol),i(r.parentUnit,l.symbol),i(r.parentBalUnit,l.symbol),r.parentBal.textContent=l.wallet?jt.formatCoinValue(l.wallet.balance.available,l.unitInfo):"0"}else jt.show(r.sendEnoughWithEst);else jt.show(r.sendEnough);jt.show(e.synced?r.syncCheck:e.syncProgress>=1?r.syncSpinner:r.syncUncheck),jt.show(e.balance.available>=2*s.amount+t?r.balCheck:r.balUncheck),r.progress.textContent=(100*e.syncProgress).toFixed(1),e.synced&&(this.progressed=!0),this.reportBalance(e.assetID)}},{key:"reportWalletState",value:function(e){this.progressed&&this.funded||(e.assetID===this.assetID&&this.reportProgress(e.synced,e.syncProgress),this.reportBalance(e.assetID))}},{key:"reportBalance",value:function(e){if(!this.funded&&-1!==this.assetID&&(e===this.assetID||e===this.parentID)){var t=this.page,n=Sn().assets[this.assetID],r=n.wallet.balance.available;if(t.balance.textContent=jt.formatCoinValue(r,n.unitInfo),n.token){var a=Sn().assets[n.token.parentID],o=a.wallet.balance.available;if(t.parentBal.textContent=jt.formatCoinValue(o,a.unitInfo),o<this.bondFeeBuffer)return}r<2*this.bondAsset.amount+this.bondFeeBuffer||(jt.show(t.balCheck),jt.hide(t.balUncheck,t.balanceBox,t.sendEnough),this.funded=!0,this.progressed&&this.success())}}},{key:"reportProgress",value:function(e,t){var n=this.page;if(e)return n.progress.textContent="100",jt.hide(n.syncUncheck,n.syncRemainBox,n.syncSpinner),jt.show(n.syncCheck),this.progressed=!0,void(this.funded&&this.success());if(1===t?(jt.hide(n.syncUncheck),jt.show(n.syncSpinner)):(jt.hide(n.syncSpinner),jt.show(n.syncUncheck)),n.progress.textContent=(100*t).toFixed(1),t>=.999)return jt.hide(n.syncRemaining),jt.show(n.syncFinishingUp),jt.show(n.syncRemainBox),void(n.syncFinishingUp.textContent=Rt(bt));var r=this.progressCache;if(r.push({stamp:(new Date).getTime(),progress:t}),!(r.length<2)){for(;r.length>20;)r.shift();var a=[r[0],r[r.length-1]],o=a[0],s=a[1],i=s.progress-o.progress;if(0!==i){jt.hide(n.syncFinishingUp),jt.show(n.syncRemaining),jt.show(n.syncRemainBox);var c=i/(s.stamp-o.stamp),l=(1-s.progress)/c;n.syncRemain.textContent=jt.formatDuration(l)}}}}]),e}(),Lr=function(){function e(t,n,r){var a=this;s(this,e),h(this,"form",void 0),h(this,"success",void 0),h(this,"pwCache",void 0),h(this,"page",void 0),h(this,"currentAsset",void 0),this.page=jt.idDescendants(t),this.form=t,this.pwCache=r||null,this.success=n,Vr(t,this.page.submitUnlock,(function(){return a.submit()}))}var t;return u(e,[{key:"refresh",value:function(e){var t=this.page;this.currentAsset=e,t.uwAssetLogo.src=jt.logoPath(e.symbol),t.uwAssetName.textContent=e.name,t.uwAppPass.value="",t.unlockErr.textContent="",jt.hide(t.unlockErr),nn.passwordIsCached()||this.pwCache&&this.pwCache.pw?jt.hide(t.uwAppPassBox):jt.show(t.uwAppPassBox)}},{key:"setError",value:function(e){this.page.unlockErr.textContent=e,jt.show(this.page.unlockErr)}},{key:"showErrorOnly",value:function(e){this.setError(e),jt.hide(this.page.uwAppPassBox),jt.hide(this.page.submitUnlockDiv)}},{key:"submit",value:(t=o(w().mark((function e(){var t,n,r,a,o,s;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.uwAppPass.value||(this.pwCache?this.pwCache.pw:""))||nn.passwordIsCached()){e.next=6;break}return t.unlockErr.textContent=Rt(x),jt.show(t.unlockErr),e.abrupt("return");case 6:return r=this.currentAsset.id,jt.hide(this.page.unlockErr),a={assetID:r,pass:n},t.uwAppPass.value="",o=Sn().loading(this.form),e.next=13,dn("/api/openwallet",a);case 13:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=18;break}return this.setError(s.msg),e.abrupt("return");case 18:this.pwCache&&(this.pwCache.pw=n),this.success(r);case 20:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Br=function(){function e(t,n){var r=this;s(this,e),h(this,"form",void 0),h(this,"page",void 0),h(this,"order",void 0),h(this,"acceleratedRate",void 0),h(this,"earlyAcceleration",void 0),h(this,"currencyUnit",void 0),h(this,"success",void 0),this.form=t,this.success=n;var a=this.page=jt.idDescendants(t);jt.bind(a.accelerateSubmit,"click",(function(){r.submit()})),jt.bind(a.submitEarlyConfirm,"click",(function(){r.sendAccelerateRequest()}))}var t,n,r,a;return u(e,[{key:"displayEarlyAccelerationMsg",value:function(){var e=this.page;this.earlyAcceleration&&(e.recentAccelerationTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60)),e.recentSwapTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60)),this.earlyAcceleration.wasAcceleration?(jt.show(e.recentAccelerationMsg),jt.hide(e.recentSwapMsg),e.recentAccelerationTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60))):(jt.show(e.recentSwapMsg),jt.hide(e.recentAccelerationMsg),e.recentSwapTime.textContent="".concat(Math.floor(this.earlyAcceleration.timePast/60))),jt.hide(e.configureAccelerationDiv,e.accelerateErr),jt.show(e.earlyAccelerationDiv))}},{key:"sendAccelerateRequest",value:(a=o(w().mark((function e(){var t,n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.order,n=this.page,r={pw:n.acceleratePass.value,orderID:t.id,newRate:this.acceleratedRate},n.acceleratePass.value="",a=Sn().loading(n.accelerateMainDiv),e.next=7,dn("/api/accelerateorder",r);case 7:o=e.sent,a(),Sn().checkResponse(o)?(n.accelerateTxID.textContent=o.txID,jt.hide(n.accelerateMainDiv,n.preAccelerateErr,n.accelerateErr),jt.show(n.accelerateMsgDiv,n.accelerateSuccess),this.success()):(n.accelerateErr.textContent=Rt(lt,{msg:o.msg}),jt.hide(n.earlyAccelerationDiv),jt.show(n.accelerateErr,n.configureAccelerationDiv));case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"submit",value:(r=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.earlyAcceleration?this.displayEarlyAccelerationMsg():this.sendAccelerateRequest();case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"refresh",value:(n=o(w().mark((function e(t){var n,r,a,o,s,i,c=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.order=t,e.next=4,dn("/api/preaccelerate",t.id);case 4:if(r=e.sent,Sn().checkResponse(r)){e.next=10;break}return n.preAccelerateErr.textContent=Rt(lt,{msg:r.msg}),jt.hide(n.accelerateMainDiv,n.accelerateSuccess),jt.show(n.accelerateMsgDiv,n.preAccelerateErr),e.abrupt("return");case 10:jt.hide(n.accelerateMsgDiv,n.preAccelerateErr,n.accelerateErr,n.feeEstimateDiv,n.earlyAccelerationDiv),jt.show(n.accelerateMainDiv,n.accelerateSuccess,n.configureAccelerationDiv),a=r.preAccelerate,this.earlyAcceleration=a.earlyAcceleration,this.currencyUnit=a.suggestedRange.yUnit,n.accelerateAvgFeeRate.textContent="".concat(a.swapRate," ").concat(a.suggestedRange.yUnit),n.accelerateCurrentFeeRate.textContent="".concat(a.suggestedRate," ").concat(a.suggestedRange.yUnit),this.acceleratedRate=a.suggestedRange.start.y,o=function(){},s=function(e,t){c.acceleratedRate=t},i=new On(a.suggestedRange,a.suggestedRange.start.x,s,(function(){return c.updateAccelerationEstimate()}),o,!0),jt.empty(n.sliderContainer),n.sliderContainer.appendChild(i.control),this.updateAccelerationEstimate();case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateAccelerationEstimate",value:(t=o(w().mark((function e(){var t,n,r,a,o,s,i,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.order,r={orderID:n.id,newRate:this.acceleratedRate},a=Sn().loading(t.sliderContainer),e.next=6,dn("/api/accelerationestimate",r);case 6:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=12;break}return t.accelerateErr.textContent=Rt(ct,{msg:o.msg}),jt.show(t.accelerateErr),e.abrupt("return");case 12:t.feeRateEstimate.textContent="".concat(this.acceleratedRate," ").concat(this.currencyUnit),n.sell?(s=n.baseID,i=n.baseSymbol):(s=n.quoteID,i=n.quoteSymbol),c=Sn().unitInfo(s),t.feeEstimate.textContent="".concat(o.fee/c.conventional.conversionFactor," ").concat(i),jt.show(t.feeEstimateDiv);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Mr=function(){function e(t,n,r,a){var o=this;s(this,e),h(this,"form",void 0),h(this,"success",void 0),h(this,"pwCache",void 0),h(this,"page",void 0),h(this,"knownExchanges",void 0),h(this,"dexToUpdate",void 0),this.form=t,this.success=n,this.pwCache=r||null;var i=this.page=jt.parseTemplate(t);i.selectedCert.textContent=Rt(ie),jt.bind(i.skipRegistration,"change",(function(){return o.showOrHidePWBox()})),jt.bind(i.certFile,"change",(function(){return o.onCertFileChange()})),jt.bind(i.removeCert,"click",(function(){return o.clearCertFile()})),jt.bind(i.addCert,"click",(function(){return i.certFile.click()})),jt.bind(i.showCustom,"click",(function(){jt.hide(i.showCustom),jt.show(i.customBox,i.auth)})),this.knownExchanges=Array.from(i.knownXCs.querySelectorAll(".known-exchange"));var c,l=Er(this.knownExchanges);try{var u=function(){var e=c.value;jt.bind(e,"click",(function(){var t,n=e.dataset.host,a=Er(o.knownExchanges);try{for(a.s();!(t=a.n()).done;)t.value.classList.remove("selected")}catch(e){a.e(e)}finally{a.f()}if(o.skipRegistration()||nn.passwordIsCached()||r&&r.pw)return o.checkDEX(n);e.classList.add("selected"),i.appPW.focus(),i.addr.value=n}))};for(l.s();!(c=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}Vr(t,i.submit,(function(){return o.checkDEX()})),a&&(jt.hide(i.addDexHdr,i.skipRegistrationBox),jt.show(i.updateDexHdr),this.dexToUpdate=a),this.refresh()}var t,n,r;return u(e,[{key:"refresh",value:function(){var e=this.page;e.addr.value="",e.appPW.value="",this.clearCertFile(),jt.hide(e.err),0===this.knownExchanges.length||this.dexToUpdate?(jt.show(e.customBox,e.auth),jt.hide(e.showCustom,e.knownXCs,e.pickServerMsg,e.addCustomMsg)):(jt.hide(e.customBox),jt.show(e.showCustom));var t,n=Er(this.knownExchanges);try{for(n.s();!(t=n.n()).done;)t.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}this.showOrHidePWBox()}},{key:"showOrHidePWBox",value:function(){var e=!(nn.passwordIsCached()||this.pwCache&&this.pwCache.pw||this.skipRegistration()),t=this.page;e?jt.show(t.appPWBox,t.auth):(jt.hide(t.appPWBox),jt.setVis(jt.isDisplayed(t.customBox),t.auth))}},{key:"skipRegistration",value:function(){var e;return null!==(e=this.page.skipRegistration.checked)&&void 0!==e&&e}},{key:"animate",value:(r=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,jt.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"checkDEX",value:(n=o(w().mark((function e(t){var n,r,a,o,s,i,c,l,u;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,jt.hide(n.err),""!==(t=t||n.addr.value)){e.next=7;break}return n.err.textContent=Rt(vt),jt.show(n.err),e.abrupt("return");case 7:if(r="",!n.certFile.value){e.next=14;break}if(!(a=n.certFile.files)||!a.length){e.next=14;break}return e.next=13,a[0].text();case 13:r=e.sent;case 14:return o=this.skipRegistration(),s="",o||nn.passwordIsCached()||(s=n.appPW.value||(this.pwCache?this.pwCache.pw:"")),this.dexToUpdate?(i="/api/updatedexhost",c={newHost:t,cert:r,pw:s,oldHost:this.dexToUpdate}):(i=o?"/api/adddex":"/api/discoveracct",c={addr:t,cert:r,pass:s}),l=Sn().loading(this.form),e.next=21,dn(i,c);case 21:if(u=e.sent,l(),Sn().checkResponse(u)){e.next=26;break}return String(u.msg).includes("certificate required")?jt.show(n.needCert):(n.err.textContent=u.msg,jt.show(n.err)),e.abrupt("return");case 26:if(this.dexToUpdate||!(o||u.paid||Object.keys(u.xc.pendingBonds).length>0)){e.next=32;break}return e.next=29,Sn().fetchUser();case 29:return e.next=31,Sn().loadPage("markets");case 31:return e.abrupt("return");case 32:this.pwCache&&(this.pwCache.pw=s),this.success(u.xc,r);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onCertFileChange",value:(t=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.certFile.files)&&n.length){e.next=4;break}return e.abrupt("return");case 4:t.selectedCert.textContent=n[0].name,jt.show(t.removeCert),jt.hide(t.addCert);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"clearCertFile",value:function(){var e=this.page;e.certFile.value="",e.selectedCert.textContent=Rt(ie),jt.hide(e.removeCert),jt.show(e.addCert)}}]),e}(),Wr=function(){function e(t,n,r,a){var o=this;s(this,e),h(this,"form",void 0),h(this,"addr",void 0),h(this,"success",void 0),h(this,"pwCache",void 0),h(this,"page",void 0),this.form=t,this.addr=n,this.success=r,this.pwCache=a||null;var i=this.page=jt.parseTemplate(t);i.dexHost.textContent=n,Vr(t,i.submit,(function(){return o.checkDEX()})),this.refresh()}var t,n;return u(e,[{key:"refresh",value:function(){var e=this.page;e.appPW.value="",jt.hide(e.err),nn.passwordIsCached()||this.pwCache&&this.pwCache.pw?jt.hide(e.appPWBox):jt.show(e.appPWBox)}},{key:"animate",value:(n=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,jt.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"checkDEX",value:(t=o(w().mark((function e(){var t,n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.err),n="",nn.passwordIsCached()||(n=t.appPW.value||(this.pwCache?this.pwCache.pw:"")),r={addr:this.addr,pass:n},a=Sn().loading(this.form),e.next=8,dn("/api/discoveracct",r);case 8:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=14;break}return t.err.textContent=o.msg,jt.show(t.err),e.abrupt("return");case 14:if(!o.paid){e.next=20;break}return e.next=17,Sn().fetchUser();case 17:return e.next=19,Sn().loadPage("markets");case 19:return e.abrupt("return");case 20:this.pwCache&&(this.pwCache.pw=n),this.success(o.xc);case 22:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),qr=function(){function e(t,n,r){var a=this;s(this,e),h(this,"form",void 0),h(this,"success",void 0),h(this,"pwCache",void 0),h(this,"headerTxt",void 0),h(this,"page",void 0),this.success=n,this.form=t,this.pwCache=r||null;var o=this.page=jt.parseTemplate(t);this.headerTxt=o.header.textContent||"",Vr(t,o.submit,(function(){a.submit()})),Sn().registerNoteFeeder({login:function(e){a.handleLoginNote(e)}})}var t,n;return u(e,[{key:"handleLoginNote",value:function(e){if(""!==e.details){var t=jt.idel(this.form,"loaderMsg");t&&(t.textContent=e.details)}}},{key:"focus",value:function(){this.page.pw.focus()}},{key:"submit",value:(n=o(w().mark((function e(){var t,n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,jt.hide(t.errMsg),n=t.pw.value||"",t.pw.value="",r=t.rememberPass.checked,""!==n){e.next=9;break}return t.errMsg.textContent=Rt(k),jt.show(t.errMsg),e.abrupt("return");case 9:return a=Sn().loading(this.form),e.next=12,dn("/api/login",{pass:n,rememberPass:r});case 12:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=18;break}return t.errMsg.textContent=o.msg,jt.show(t.errMsg),e.abrupt("return");case 18:o.notes&&(o.notes.reverse(),Sn().setNotes(o.notes)),this.pwCache&&(this.pwCache.pw=n),this.success();case 21:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"animate",value:(t=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.form,jt.animate(550,(function(e){t.style.transform="scale(".concat(.9+.1*e,")"),t.style.opacity=String(Math.pow(e,4))}),"easeOut");case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Nr=function(){function e(t){var n=this;s(this,e),h(this,"form",void 0),h(this,"page",void 0),h(this,"assetID",void 0),this.form=t;var r=this.page=jt.idDescendants(t);jt.bind(r.newDepAddrBttn,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.newDepositAddress();case 1:case"end":return e.stop()}}),e)})))),jt.bind(r.copyAddressBtn,"click",(function(){n.copyAddress()}))}var t,n,r;return u(e,[{key:"setAsset",value:(r=o(w().mark((function e(t){var n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assetID=t,n=this.page,jt.hide(n.depositErr),r=Sn().assets[t],n.depositLogo.src=jt.logoPath(r.symbol),a=Sn().walletMap[t],n.depositName.textContent=r.name,n.depositAddress.textContent=a.address,n.qrcode.src="/generateqrcode?address=".concat(a.address),0!=(2&a.traits)?jt.show(n.newDepAddrBttn):jt.hide(n.newDepAddrBttn);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"newDepositAddress",value:(n=o(w().mark((function e(){var t,n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.depositErr),n=Sn().loading(this.form),e.next=5,dn("/api/depositaddress",{assetID:this.assetID});case 5:if(r=e.sent,n(),Sn().checkResponse(r)){e.next=11;break}return t.depositErr.textContent=r.msg,jt.show(t.depositErr),e.abrupt("return");case 11:t.depositAddress.textContent=r.address,t.qrcode.src="/generateqrcode?address=".concat(r.address);case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"copyAddress",value:(t=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,navigator.clipboard.writeText(t.depositAddress.textContent||"").then((function(){jt.show(t.copyAlert),setTimeout((function(){jt.hide(t.copyAlert)}),800)})).catch((function(e){console.error("Unable to copy: ",e)}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ur=300;function _r(e,t){return zr.apply(this,arguments)}function zr(){return(zr=o(w().mark((function e(t,n){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.body.offsetWidth/2,e.next=3,jt.animate(Ur,(function(e){t.style.right="".concat(e*r,"px")}),"easeInHard");case 3:return jt.hide(t),t.style.right="0",n.style.right=String(-r),jt.show(n),n.querySelector("input")&&jt.safeSelector(n,"input").focus(),e.next=10,jt.animate(Ur,(function(e){n.style.right="".concat(e*r-r,"px")}),"easeOutHard");case 10:n.style.right="0";case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vr(e,t,n){var r=function(e){e.preventDefault&&e.preventDefault(),n(e)};jt.bind(t,"click",r),jt.bind(e,"submit",r)}function jr(e){return Math.floor(e.getTime()/1e3)}function Hr(e){return function(e){return new Date(e.getTime()-60*e.getTimezoneOffset()*1e3)}(e).toISOString().split("T")[0]}function Gr(e){var t=Sn().user.assets[e];return t.token?Sn().user.assets[t.token.parentID].symbol:t.symbol}var Kr=function(e){on(y,e);var t,n,r,a,i,c,l,d,p,f,m,v=(f=y,m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(f);if(m){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function y(e,t){var n;s(this,y),h(rn(n=v.call(this)),"body",void 0),h(rn(n),"pwCache",void 0),h(rn(n),"currentDEX",void 0),h(rn(n),"page",void 0),h(rn(n),"loginForm",void 0),h(rn(n),"dexAddrForm",void 0),h(rn(n),"discoverAcctForm",void 0),h(rn(n),"newWalletForm",void 0),h(rn(n),"regAssetForm",void 0),h(rn(n),"walletWaitForm",void 0),h(rn(n),"confirmRegisterForm",void 0),n.body=e,n.pwCache={pw:""};var r=n.page=jt.idDescendants(e);t.host&&r.dexAddrForm.classList.contains("selected")&&(r.dexAddrForm.classList.remove("selected"),r.discoverAcctForm.classList.add("selected"),r.discoverAcctForm.dataset.host=t.host),e.querySelectorAll(".form-closer").forEach((function(e){return jt.hide(e)})),Vr(r.appPWForm,r.appPWSubmit,(function(){return n.setAppPass()})),jt.bind(r.showSeedRestore,"click",(function(){jt.show(r.seedRestore),jt.hide(r.showSeedRestore)})),n.loginForm=new qr(r.loginForm,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:n.discoverAcctForm?(n.discoverAcctForm.refresh(),_r(r.loginForm,r.discoverAcctForm)):(n.dexAddrForm.refresh(),_r(r.loginForm,r.dexAddrForm));case 3:case"end":return e.stop()}}),e)}))),n.pwCache),n.newWalletForm=new Fr(r.newWalletForm,(function(e){return n.newWalletCreated(e)}),n.pwCache,(function(){return n.animateRegAsset(r.newWalletForm)})),n.dexAddrForm=new Mr(r.dexAddrForm,function(){var e=o(w().mark((function e(t,a){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.requestFeepayment(r.dexAddrForm,t,a);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.pwCache);var a=r.discoverAcctForm.dataset.host;a&&(n.discoverAcctForm=new Wr(r.discoverAcctForm,a,function(){var e=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.requestFeepayment(r.discoverAcctForm,t,"");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.pwCache)),n.regAssetForm=new Or(r.regAssetForm,function(){var e=o(w().mark((function e(t){var a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.confirmRegisterForm.setAsset(t),a=Sn().assets[t],!(o=a.wallet)){e.next=14;break}return s=n.currentDEX.bondAssets[a.symbol],e.next=7,n.getBondsFeeBuffer(t,r.regAssetForm);case 7:if(i=e.sent,!(o.synced&&o.balance.available>=2*s.amount+i)){e.next=11;break}return n.animateConfirmForm(r.regAssetForm),e.abrupt("return");case 11:return n.walletWaitForm.setWallet(o,i),_r(r.regAssetForm,r.walletWait),e.abrupt("return");case 14:n.newWalletForm.setAsset(t),_r(r.regAssetForm,r.newWalletForm);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.walletWaitForm=new Pr(r.walletWait,(function(){n.animateConfirmForm(r.walletWait)}),(function(){n.animateRegAsset(r.walletWait)})),n.confirmRegisterForm=new Dr(r.confirmRegForm,(function(){n.registerDEXSuccess()}),(function(){n.animateRegAsset(r.confirmRegForm)}),n.pwCache);var i=jt.safeSelector(r.forms,":scope > form.selected");switch(i.classList.remove("selected"),i){case r.loginForm:n.loginForm.animate();break;case r.dexAddrForm:n.dexAddrForm.animate();break;case r.discoverAcctForm:n.discoverAcctForm.animate()}return jt.show(i),Sn().authed()&&n.auth(),n}return u(y,[{key:"unload",value:function(){this.pwCache.pw=""}},{key:"auth",value:(p=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:case"end":return e.stop()}}),e)}))),function(){return p.apply(this,arguments)})},{key:"requestFeepayment",value:(d=o(w().mark((function e(t,n,r){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.currentDEX=n,this.confirmRegisterForm.setExchange(n,r),this.walletWaitForm.setExchange(n),this.regAssetForm.setExchange(n),this.animateRegAsset(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"animateRegAsset",value:(l=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:jt.hide(t),this.regAssetForm.animate(),jt.show(this.page.regAssetForm);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"animateConfirmForm",value:(c=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.confirmRegisterForm.animate(),jt.hide(t),jt.show(this.page.confirmRegForm);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getBondsFeeBuffer",value:(i=o(w().mark((function e(t,n){var r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sn().loading(n),e.next=3,dn("/api/bondsfeebuffer",{assetID:t});case 3:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",a.feeBuffer);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"setAppPass",value:(a=o(w().mark((function e(){var t,n,r,a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,jt.hide(t.appPWErrMsg),n=t.appPW.value||"",r=t.appPWAgain.value,""!==n){e.next=8;break}return t.appPWErrMsg.textContent=Rt(k),jt.show(t.appPWErrMsg),e.abrupt("return");case 8:if(n===r){e.next=12;break}return t.appPWErrMsg.textContent=Rt(K),jt.show(t.appPWErrMsg),e.abrupt("return");case 12:return Sn().setNotes([]),t.appPW.value="",t.appPWAgain.value="",a=Sn().loading(t.appPWForm),o=t.seedInput.value,s=t.rememberPass.checked,e.next=20,dn("/api/init",{pass:n,seed:o,rememberPass:s});case 20:if(i=e.sent,a(),Sn().checkResponse(i)){e.next=26;break}return t.appPWErrMsg.textContent=i.msg,jt.show(t.appPWErrMsg),e.abrupt("return");case 26:return this.pwCache.pw=n,this.auth(),Sn().updateMenuItemsDisplay(),this.newWalletForm.refresh(),this.dexAddrForm.refresh(),e.next=33,_r(t.appPWForm,t.dexAddrForm);case 33:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getCertFile",value:(r=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.dexAddrForm.page.certFile.value){e.next=7;break}if(!(n=this.dexAddrForm.page.certFile.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:t=e.sent;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"registerDEXSuccess",value:(n=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:return e.next=4,Sn().loadPage("markets");case 4:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"newWalletCreated",value:(t=o(w().mark((function e(t){var n,r,a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.regAssetForm.refresh(),e.next=3,Sn().fetchUser();case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:return r=this.page,a=n.assets[t],o=a.wallet,s=this.currentDEX.bondAssets[a.symbol].amount,e.next=12,this.getBondsFeeBuffer(t,r.newWalletForm);case 12:if(i=e.sent,!(o.synced&&o.balance.available>=2*s+i)){e.next=17;break}return e.next=16,this.animateConfirmForm(r.newWalletForm);case 16:return e.abrupt("return");case 17:return this.walletWaitForm.setWallet(o,i),e.next=20,_r(r.newWalletForm,r.walletWait);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),y}(ln);var Xr=function(e){on(i,e);var t,n,r,a=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(n);if(r){var a=cn(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return sn(this,e)});function i(e){var t;return s(this,i),h(rn(t=a.call(this)),"form",void 0),h(rn(t),"loginForm",void 0),t.form=jt.idel(e,"loginForm"),jt.show(t.form),t.loginForm=new qr(t.form,(function(){t.loggedIn()})),t.loginForm.focus(),t}return u(i,[{key:"loggedIn",value:(t=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:return e.next=4,Sn().loadPage("markets");case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),i}(ln);function Qr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Jr=function(e){on(V,e);var t,n,a,i,c,l,d,p,f,m,v,y,g,b,C,S,E,A,F,I,R,D,O,T,P,L,B,M,W,q,N,U,_,z=(U=V,_=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(U);if(_){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function V(e){var t;s(this,V),h(rn(t=z.call(this)),"body",void 0),h(rn(t),"page",void 0),h(rn(t),"assetButtons",void 0),h(rn(t),"newWalletForm",void 0),h(rn(t),"reconfigForm",void 0),h(rn(t),"walletCfgGuide",void 0),h(rn(t),"unlockForm",void 0),h(rn(t),"depositAddrForm",void 0),h(rn(t),"keyup",void 0),h(rn(t),"changeWalletPW",void 0),h(rn(t),"displayed",void 0),h(rn(t),"animation",void 0),h(rn(t),"forms",void 0),h(rn(t),"forceReq",void 0),h(rn(t),"forceUrl",void 0),h(rn(t),"currentForm",void 0),h(rn(t),"restoreInfoCard",void 0),h(rn(t),"selectedAssetID",void 0),h(rn(t),"maxSend",void 0),t.body=e;var n=t.page=jt.idDescendants(e);jt.cleanTemplates(n.restoreInfoCard,n.connectedIconTmpl,n.disconnectedIconTmpl,n.removeIconTmpl),t.restoreInfoCard=n.restoreInfoCard.cloneNode(!0),jt.show(n.connectedIconTmpl,n.disconnectedIconTmpl,n.removeIconTmpl),t.forms=jt.applySelector(n.forms,":scope > form"),n.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){t.closePopups()}))})),jt.bind(n.cancelForce,"click",(function(){t.closePopups()})),t.selectedAssetID=-1,jt.cleanTemplates(n.iconSelectTmpl,n.balanceDetailRow,n.recentOrderTmpl),jt.bind(n.createWallet,"click",(function(){return t.showNewWallet(t.selectedAssetID)})),jt.bind(n.connectBttn,"click",(function(){return t.doConnect(t.selectedAssetID)})),jt.bind(n.send,"click",(function(){return t.showSendForm(t.selectedAssetID)})),jt.bind(n.receive,"click",(function(){return t.showDeposit(t.selectedAssetID)})),jt.bind(n.unlockBttn,"click",(function(){return t.openWallet(t.selectedAssetID)})),jt.bind(n.lockBttn,"click",(function(){return t.lock(t.selectedAssetID)})),jt.bind(n.reconfigureBttn,"click",(function(){return t.showReconfig(t.selectedAssetID)})),jt.bind(n.rescanWallet,"click",(function(){return t.rescanWallet(t.selectedAssetID)})),t.newWalletForm=new Fr(n.newWalletForm,(function(e){var r={assetName:Sn().assets[e].name};t.assetUpdated(e,n.newWalletForm,Rt(xe,r)),t.sortAssetButtons()})),t.reconfigForm=new Rr(n.reconfigInputs,!1),t.walletCfgGuide=jt.tmplElement(n.reconfigForm,"walletCfgGuide"),t.unlockForm=new Lr(n.unlockWalletForm,(function(e){return t.openWalletSuccess(e,n.unlockWalletForm)})),Vr(n.sendForm,n.submitSendForm,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.stepSend();case 1:case"end":return e.stop()}}),e)})))),Vr(n.vSendForm,n.vSend,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.send();case 1:case"end":return e.stop()}}),e)})))),jt.bind(n.vCancelSend,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.cancelSend();case 1:case"end":return e.stop()}}),e)})))),Vr(n.reconfigForm,n.submitReconfig,(function(){return t.reconfig()})),n.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){return t.closePopups()}))})),jt.bind(n.forms,"mousedown",(function(e){jt.mouseInElement(e,t.currentForm)||t.closePopups()})),t.keyup=function(e){"Escape"===e.key&&jt.isDisplayed(t.page.forms)&&t.closePopups()},jt.bind(document,"keyup",t.keyup),jt.bind(n.downloadLogs,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.downloadLogs();case 1:case"end":return e.stop()}}),e)})))),jt.bind(n.exportWallet,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.displayExportWalletAuth();case 1:case"end":return e.stop()}}),e)})))),jt.bind(n.recoverWallet,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showRecoverWallet();case 1:case"end":return e.stop()}}),e)})))),Vr(n.exportWalletAuth,n.exportWalletAuthSubmit,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.exportWalletAuthSubmit();case 1:case"end":return e.stop()}}),e)})))),Vr(n.recoverWalletConfirm,n.recoverWalletSubmit,(function(){t.recoverWallet()})),Vr(n.confirmForce,n.confirmForceSubmit,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.confirmForceSubmit();case 1:case"end":return e.stop()}}),e)})))),jt.bind(n.disableWallet,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showToggleWalletStatus(!0);case 1:case"end":return e.stop()}}),e)})))),jt.bind(n.enableWallet,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showToggleWalletStatus(!1);case 1:case"end":return e.stop()}}),e)})))),Vr(n.toggleWalletStatusConfirm,n.toggleWalletStatusSubmit,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toggleWalletStatus();case 1:case"end":return e.stop()}}),e)})))),jt.bind(n.managePeers,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.showManagePeersForm();case 1:case"end":return e.stop()}}),e)})))),jt.bind(n.addPeerSubmit,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.submitAddPeer();case 1:case"end":return e.stop()}}),e)})))),t.depositAddrForm=new Nr(n.deposit),jt.bind(n.walletBal,"click",(function(){t.populateMaxSend()})),jt.bind(n.sendAmt,"input",(function(){var e=Sn().assets[t.selectedAssetID].unitInfo,r=parseFloat(n.sendAmt.value||"0"),a=e.conventional.conversionFactor;t.showFiatValue(t.selectedAssetID,r*a,n.sendValue)})),jt.bind(n.maxSend,"click",(function(){t.populateMaxSend()})),jt.bind(n.sendAddr,"input",o(w().mark((function e(){var r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Sn().assets[t.selectedAssetID],jt.hide(n.validAddr),n.sendAddr.classList.remove("invalid"),a=n.sendAddr.value||"",r&&""!==a){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,t.validateSendAddress(a,r.id);case 8:e.sent?jt.show(n.validAddr):n.sendAddr.classList.add("invalid");case 10:case"end":return e.stop()}}),e)})))),jt.bind(n.showChangePW,"click",(function(){t.changeWalletPW=!t.changeWalletPW,t.setPWSettingViz(t.changeWalletPW)})),jt.bind(n.changeWalletTypeSelect,"change",(function(){t.changeWalletType()})),jt.bind(n.showChangeType,"click",(function(){jt.isHidden(n.changeWalletType)?(jt.show(n.changeWalletType,n.changeTypeHideIcon),jt.hide(n.changeTypeShowIcon),n.changeTypeMsg.textContent=Rt(me)):t.showReconfig(t.selectedAssetID,!0)})),Sn().registerNoteFeeder({fiatrateupdate:function(e){t.handleRatesNote(e)},balance:function(e){t.handleBalanceNote(e)},walletstate:function(e){t.handleWalletStateNote(e)},walletconfig:function(e){t.handleWalletStateNote(e)},createwallet:function(e){t.handleCreateWalletNote(e)}});var r=t.sortAssetButtons().id,a=nn.fetchLocal(nn.selectedAssetLK);return a&&(r=Number(a)),t.setSelectedAsset(r),t}return u(V,[{key:"closePopups",value:function(){jt.hide(this.page.forms),this.animation&&this.animation.stop()}},{key:"stepSend",value:(N=o(w().mark((function e(){var t,n,r,a,o,s,i,c,l,u,h,d,p,f,m,v,y,g,b,k,x;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,jt.hide(t.vSendErr,t.sendErr,t.vSendEstimates,t.txFeeNotAvailable),n=parseInt(t.sendForm.dataset.assetID||""),r=Sn().assets[n].token,a=t.subtractCheckBox.checked||!1,o=Sn().unitInfo(n).conventional.conversionFactor,s=Math.round(parseFloat(t.sendAmt.value||"")*o),""!==(i=t.sendAddr.value||"")){e.next=10;break}return e.abrupt("return",jt.showFormError(t.sendErr,Rt(Be,{address:i})));case 10:if(c=Sn().assets[n],l=c.wallet,u=c.unitInfo,h=c.symbol,d=0,0==(1024&l.traits)){e.next=36;break}return p={addr:t.sendAddr.value,assetID:n,subtract:a,value:s},f=Sn().loading(t.sendForm),e.next=17,dn("/api/txfee",p);case 17:if(m=e.sent,f(),Sn().checkResponse(m)){e.next=29;break}return t.txFeeNotAvailable.dataset.tooltip=Rt(Me,{err:m.msg}),jt.show(t.txFeeNotAvailable),e.next=24,this.validateSendAddress(i,n);case 24:if(e.sent){e.next=27;break}return e.abrupt("return",jt.showFormError(t.sendErr,Rt(Be,{address:i||""})));case 27:e.next=34;break;case 29:if(!m.ok){e.next=34;break}if(m.validaddress){e.next=32;break}return e.abrupt("return",jt.showFormError(t.sendErr,Rt(Be,{address:t.sendAddr.value||""})));case 32:d=m.txfee,jt.show(t.vSendEstimates);case 34:e.next=41;break;case 36:return e.next=38,this.validateSendAddress(i,n);case 38:if(e.sent){e.next=41;break}return e.abrupt("return",jt.showFormError(t.sendErr,Rt(Be,{address:i||""})));case 41:return t.vSendSymbol.textContent=h.toUpperCase(),t.vSendLogo.src=jt.logoPath(h),r?(v=Sn().assets[r.parentID],y=v.unitInfo,g=v.symbol,t.vSendFee.textContent=jt.formatFullPrecision(d,y)+" "+g):t.vSendFee.textContent=jt.formatFullPrecision(d,u),this.showFiatValue(n,d,t.vSendFeeFiat),t.vSendDestinationAmt.textContent=jt.formatFullPrecision(s-d,u),t.vTotalSend.textContent=jt.formatFullPrecision(s,u),this.showFiatValue(n,s,t.vTotalSendFiat),t.vSendAddr.textContent=t.sendAddr.value||"",b=l.balance.available-s,t.balanceAfterSend.textContent=jt.formatFullPrecision(b,u),this.showFiatValue(n,b,t.balanceAfterSendFiat),jt.show(t.approxSign),a||(jt.hide(t.approxSign),t.vSendDestinationAmt.textContent=jt.formatFullPrecision(s,u),k=s,r||(k+=d),t.vTotalSend.textContent=jt.formatFullPrecision(k,u),this.showFiatValue(n,k,t.vTotalSendFiat),x=l.balance.available-s,r||(x-=d),x<=0?(t.balanceAfterSend.textContent=jt.formatFullPrecision(0,u),this.showFiatValue(n,0,t.balanceAfterSendFiat)):(t.balanceAfterSend.textContent=jt.formatFullPrecision(x,u),this.showFiatValue(n,x,t.balanceAfterSendFiat))),jt.hide(t.sendForm),e.next=57,this.showForm(t.vSendForm);case 57:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"cancelSend",value:(q=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.vSendForm,t.sendErr),e.next=4,this.showForm(t.sendForm);case 4:case"end":return e.stop()}}),e,this)}))),function(){return q.apply(this,arguments)})},{key:"validateSendAddress",value:(W=o(w().mark((function e(t,n){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dn("/api/validateaddress",{addr:t,assetID:n});case 2:return r=e.sent,e.abrupt("return",Sn().checkResponse(r));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return W.apply(this,arguments)})},{key:"setPWSettingViz",value:function(e){var t=this.page;if(e)return jt.hide(t.showIcon),jt.show(t.hideIcon,t.changePW),void(t.switchPWMsg.textContent=Rt(Q));jt.hide(t.hideIcon,t.changePW),jt.show(t.showIcon),t.switchPWMsg.textContent=Rt(Y)}},{key:"updateWalletPeersTable",value:(M=o(w().mark((function e(){var t,n,r,a,s,i,c=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.peerSpinner),e.next=4,dn("/api/getwalletpeers",{assetID:this.selectedAssetID});case 4:if(n=e.sent,Sn().checkResponse(n)){e.next=9;break}return t.managePeersErr.textContent=n.msg,jt.show(t.managePeersErr),e.abrupt("return");case 9:for(;t.peersTableBody.firstChild;)t.peersTableBody.removeChild(t.peersTableBody.firstChild);(r=n.peers||[]).sort((function(e,t){return e.source-t.source})),a=Rt(ze),s=Rt(Ve),i=Rt(je),r.forEach((function(e){var n,r=t.peerTableRow.cloneNode(!0),l=jt.parseTemplate(r);switch(l.addr.textContent=e.addr,e.source){case Cn.WalletDefault:l.source.textContent=a;break;case Cn.UserAdded:l.source.textContent=s;break;case Cn.Discovered:l.source.textContent=i}if(n=e.connected?c.page.connectedIconTmpl.cloneNode(!0):c.page.disconnectedIconTmpl.cloneNode(!0),l.connected.appendChild(n),e.source===Cn.UserAdded){var u=c.page.removeIconTmpl.cloneNode(!0);jt.bind(u,"click",o(w().mark((function n(){var r;return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return jt.hide(t.managePeersErr),n.next=3,dn("/api/removewalletpeer",{assetID:c.selectedAssetID,addr:e.addr});case 3:if(r=n.sent,Sn().checkResponse(r)){n.next=8;break}return t.managePeersErr.textContent=r.msg,jt.show(t.managePeersErr),n.abrupt("return");case 8:c.spinUntilPeersUpdate();case 9:case"end":return n.stop()}}),n)})))),l.remove.appendChild(u)}t.peersTableBody.appendChild(r)}));case 16:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"showManagePeersForm",value:(B=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,e.next=3,this.updateWalletPeersTable();case 3:jt.hide(t.managePeersErr),this.showForm(t.managePeersForm);case 5:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"submitAddPeer",value:(L=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.managePeersErr),e.next=4,dn("/api/addwalletpeer",{assetID:this.selectedAssetID,addr:t.addPeerInput.value});case 4:if(n=e.sent,Sn().checkResponse(n)){e.next=9;break}return t.managePeersErr.textContent=n.msg,jt.show(t.managePeersErr),e.abrupt("return");case 9:this.spinUntilPeersUpdate(),t.addPeerInput.value="";case 11:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"spinUntilPeersUpdate",value:(P=o(w().mark((function e(){var t,n=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,jt.show(t.peerSpinner),setTimeout((function(){jt.isDisplayed(t.peerSpinner)&&n.updateWalletPeersTable()}),1e4);case 3:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"showToggleWalletStatus",value:function(e){var t=this.page;jt.hide(t.toggleWalletStatusErr,t.walletStatusDisable,t.disableWalletMsg,t.walletStatusEnable,t.enableWalletMsg),e?jt.show(t.walletStatusDisable,t.disableWalletMsg):jt.show(t.walletStatusEnable,t.enableWalletMsg),this.showForm(t.toggleWalletStatusConfirm)}},{key:"toggleWalletStatus",value:(T=o(w().mark((function e(){var t,n,r,a,o,s,i,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.toggleWalletStatusErr),n=Sn().assets[this.selectedAssetID],r=!n.wallet.disabled,a={assetID:this.selectedAssetID,disable:r},o={assetName:n.name},s=Sn().loading(t.toggleWalletStatusConfirm),e.next=10,dn("/api/togglewalletstatus",a);case 10:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=16;break}return i.code===vn.activeOrdersErr?t.toggleWalletStatusErr.textContent=Rt(Ie,o):t.toggleWalletStatusErr.textContent=i.msg,jt.show(t.toggleWalletStatusErr),e.abrupt("return");case 16:c=Rt(Ae,o),r||(c=Rt(Fe,o)),this.assetUpdated(this.selectedAssetID,t.toggleWalletStatusConfirm,c);case 19:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"showBox",value:(O=o(w().mark((function e(t,n){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.style.opacity="0",jt.show(t),n&&n.focus(),e.next=5,jt.animate(300,(function(e){t.style.opacity="".concat(e)}),"easeOut");case 5:t.style.opacity="1",this.displayed=t;case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"showForm",value:(D=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return jt.hide(e)})),t.style.right="10000px",jt.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,jt.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return D.apply(this,arguments)})},{key:"showSuccess",value:(R=o(w().mark((function e(t){var n,a,o,s,i,c,l,u,h,d=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).successMessage.textContent=t,this.currentForm=n.checkmarkForm,this.forms.forEach((function(e){return jt.hide(e)})),jt.show(n.forms,n.checkmarkForm),n.checkmarkForm.style.right="0",n.checkmark.style.fontSize="0px",a=nn.isDark()?[223,226,225]:[51,51,51],o=r(a,3),s=o[0],i=o[1],c=o[2],l=16-s,u=163-i,h=16-c,this.animation=new Ht(1200,(function(e){n.checkmark.style.fontSize="".concat(80*e,"px"),n.checkmark.style.color="rgb(".concat(s+e*l,", ").concat(i+e*u,", ").concat(c+e*h,")")}),"easeOutElastic",(function(){d.animation=new Ht(1500,(function(){}),"",(function(){d.currentForm===n.checkmarkForm&&d.closePopups()}))}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"showNewWallet",value:(I=o(w().mark((function e(t){var n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=n.newWalletForm,this.newWalletForm.setAsset(t),a=this.newWalletForm.loadDefaults(),e.next=6,this.showForm(r);case 6:return e.next=8,a;case 8:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"sortAssetButtons",value:function(){var e=this,t=this.page;this.assetButtons={},jt.empty(t.assetSelect);var n=yn(Object.values(Sn().assets));n.sort((function(e,t){return e.wallet&&!t.wallet?-1:!e.wallet&&t.wallet?1:e.symbol.localeCompare(t.symbol)}));var r,a=Qr(n);try{var o=function(){var n=r.value,a=t.iconSelectTmpl.cloneNode(!0);t.assetSelect.appendChild(a);var o=jt.parseTemplate(a);e.assetButtons[n.id]={tmpl:o,bttn:a},e.updateAssetButton(n.id),jt.bind(a,"click",(function(){e.setSelectedAsset(n.id),nn.storeLocal(nn.selectedAssetLK,String(n.id))}))};for(a.s();!(r=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return t.assetSelect.classList.remove("invisible"),n[0]}},{key:"updateAssetButton",value:function(e){var t,n=Sn().assets[e],r=this.assetButtons[e],a=r.bttn,o=r.tmpl;if(jt.hide(o.fiat,o.noWallet),a.classList.add("nowallet"),(t=o.img).src||(t.src=jt.logoPath(n.symbol)),o.name.textContent=n.name,n.wallet){a.classList.remove("nowallet");var s=n.wallet.balance,i=n.unitInfo,c=s.available+s.locked+s.immature;o.balance.textContent=jt.formatCoinValue(c,i);var l=Sn().fiatRatesMap[n.id];l&&(jt.show(o.fiat),o.fiat.textContent=jt.formatFiatConversion(c,l,i))}else jt.show(o.noWallet)}},{key:"setSelectedAsset",value:function(e){var t,n=Qr(this.page.assetSelect.children);try{for(n.s();!(t=n.n()).done;)t.value.classList.remove("selected")}catch(e){n.e(e)}finally{n.f()}this.assetButtons[e].bttn.classList.add("selected"),this.selectedAssetID=e,this.updateDisplayedAsset(e),this.showAvailableMarkets(e),this.showRecentActivity(e)}},{key:"updateDisplayedAsset",value:function(e){if(e===this.selectedAssetID){var t,n=Sn().assets[e],r=n.symbol,a=n.wallet,o=n.name,s=this.page,i=Qr(document.querySelectorAll("[data-asset-name]"));try{for(i.s();!(t=i.n()).done;)t.value.textContent=o}catch(e){i.e(e)}finally{i.f()}if(s.assetLogo.src=jt.logoPath(r),jt.hide(s.balanceBox,s.fiatBalanceBox,s.createWalletBox,s.walletDetails,s.sendReceive,s.connectBttnBox,s.statusLocked,s.statusReady,s.statusOff,s.unlockBttnBox,s.lockBttnBox,s.connectBttnBox,s.peerCountBox,s.syncProgressBox,s.statusDisabled),a){this.updateDisplayedAssetBalance();var c=Sn().walletDefinition(e,a.type);s.walletType.textContent=c.tab;var l=function(e){var t=Sn().assets[e];if(t.token){var n=t.token.definition.configopts;return n&&n.length>0}if(!t.info)throw Error("this asset isn't an asset, I guess");var r=t.info.availablewallets,a=r[0].configopts;return r.length>1||a&&a.length>0}(e);jt.setVis(l,s.passwordWrapper),a.disabled?jt.show(s.statusDisabled):a.running?(jt.show(s.sendReceive,s.peerCountBox,s.syncProgressBox),s.peerCount.textContent=String(a.peerCount),s.syncProgress.textContent="".concat((100*a.syncProgress).toFixed(1),"%"),a.open?(jt.show(s.statusReady),!Sn().haveActiveOrders(e)&&a.encrypted&&jt.show(s.lockBttnBox)):jt.show(s.statusLocked,s.unlockBttnBox)):jt.show(s.statusOff,s.connectBttnBox)}else jt.show(s.createWalletBox);s.walletDetailsBox.classList.remove("invisible")}}},{key:"updateDisplayedAssetBalance",value:function(){var e=this.page,t=Sn().assets[this.selectedAssetID],n=t.wallet,a=t.unitInfo,o=t.symbol,s=t.id,i=n.balance;jt.show(e.balanceBox,e.walletDetails);var c=i.locked+i.contractlocked+i.bondlocked,l=i.available+c+i.immature;e.balance.textContent=jt.formatCoinValue(l,a),jt.empty(e.balanceUnit),e.balanceUnit.appendChild(jt.symbolize(o));var u=Sn().fiatRatesMap[s];u&&(jt.show(e.fiatBalanceBox),e.fiatBalance.textContent=jt.formatFiatConversion(l,u,a));var h=!1;jt.empty(e.balanceDetailBox);var d=function(t,n){var r=e.balanceDetailRow.cloneNode(!0);h&&(r.classList.add("first-other"),h=!1),e.balanceDetailBox.appendChild(r);var o=jt.parseTemplate(r);o.category.textContent=t,o.subBalance.textContent=jt.formatCoinValue(n,a)};d("Available",i.available),d("Locked",c),d("Immature",i.immature);var p=Object.entries(i.other||{});p.sort((function(e,t){return e[0].localeCompare(t[0])})),h=!0,i.contractlocked>0&&d("Swapping (locked)",i.contractlocked),i.bondlocked>0&&d("Bonded (locked)",i.bondlocked);for(var f=0,m=p;f<m.length;f++){var v=r(m[f],2);d(v[0],v[1])}}},{key:"showAvailableMarkets",value:function(e){for(var t=this.page,n=Sn().user.exchanges,a=[],o=0,s=Object.values(n);o<s.length;o++){var i=s[o];if(i.markets)for(var c=0,l=Object.values(i.markets);c<l.length;c++){var u=l[c];u.baseid!==e&&u.quoteid!==e||a.push([i.host,u])}}var h=function(e,t){var n=t.spot;if(!n)return 0;var r=Sn().unitInfo(e).conventional.conversionFactor;return(e===t.baseid?n.vol24:n.vol24*n.rate/jn)/r};a.sort((function(t,n){var a=r(t,2),o=a[0],s=a[1],i=r(n,2),c=i[0],l=i[1];return s.spot||l.spot?h(e,l)-h(e,s):o.localeCompare(c)})),jt.empty(t.availableMarkets);for(var d=function(){var a=r(f[p],2),o=a[0],s=a[1],i=s.spot,c=s.baseid,l=s.basesymbol,u=s.quoteid,d=s.quotesymbol,m=t.marketRow.cloneNode(!0);t.availableMarkets.appendChild(m);var v=jt.parseTemplate(m);if(v.host.textContent=o,v.baseLogo.src=jt.logoPath(l),v.quoteLogo.src=jt.logoPath(d),jt.empty(v.baseSymbol,v.quoteSymbol),v.baseSymbol.appendChild(jt.symbolize(l)),v.quoteSymbol.appendChild(jt.symbolize(d)),i){var y=Sn().conventionalRate(c,u,i.rate,n[o]);v.price.textContent=ea(y),v.priceQuoteUnit.textContent=d.toUpperCase(),v.priceBaseUnit.textContent=l.toUpperCase(),v.volume.textContent=ea(h(e,s)),v.volumeUnit.textContent=e===c?l.toUpperCase():d.toUpperCase()}else jt.hide(v.priceBox,v.volumeBox);jt.bind(m,"click",(function(){return Sn().loadPage("markets",{host:o,base:c,quote:u})}))},p=0,f=a;p<f.length;p++)d();t.marketsOverviewBox.classList.remove("invisible")}},{key:"showRecentActivity",value:(F=o(w().mark((function e(t){var n,r,a,o,s,i,c,l,u,h,d,p,f,m,v,y;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=Sn().loading(n.orderActivityBox),a={n:20,assets:[t],hosts:[],statuses:[]},e.next=5,dn("/api/orders",a);case 5:if(o=e.sent,r(),jt.hide(n.noActivity,n.orderActivity),o.orders&&0!==o.orders.length){e.next=12;break}return jt.show(n.noActivity),n.orderActivityBox.classList.remove("invisible"),e.abrupt("return");case 12:for(jt.show(n.orderActivity),jt.empty(n.recentOrders),s=0,i=o.orders;s<i.length;s++)c=i[s],l=n.recentOrderTmpl.cloneNode(!0),n.recentOrders.appendChild(l),u=jt.parseTemplate(l),h=void 0,d=void 0,p=[Sn().unitInfo(c.baseID),Sn().unitInfo(c.quoteID)],f=p[0],m=p[1],c.sell?(v=[c.baseSymbol,c.quoteSymbol],h=v[0],d=v[1],u.fromQty.textContent=jt.formatCoinValue(c.qty,f),c.type===Ln&&(u.toQty.textContent=jt.formatCoinValue(c.qty/jn*c.rate,m))):(y=[c.quoteSymbol,c.baseSymbol],h=y[0],d=y[1],c.type===Bn?u.fromQty.textContent=jt.formatCoinValue(c.qty,f):(u.fromQty.textContent=jt.formatCoinValue(c.qty/jn*c.rate,m),u.toQty.textContent=jt.formatCoinValue(c.qty,f))),u.fromLogo.src=jt.logoPath(h),jt.empty(u.fromSymbol,u.toSymbol),u.fromSymbol.appendChild(jt.symbolize(h)),u.toLogo.src=jt.logoPath(d),u.toSymbol.appendChild(jt.symbolize(d)),u.status.textContent=Qn(c),u.filled.textContent="".concat((Yn(c)/c.qty*100).toFixed(1),"%"),u.age.textContent=jt.timeSince(c.submitTime),u.link.href="order/".concat(c.id),Sn().bindInternalNavigation(l);n.orderActivityBox.classList.remove("invisible");case 16:case"end":return e.stop()}}),e,this)}))),function(e){return F.apply(this,arguments)})},{key:"rescanWallet",value:(A=o(w().mark((function e(t){var n,r,a,o,s;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,jt.hide(n.reconfigErr),r="/api/rescanwallet",a={assetID:t},o=Sn().loading(this.body),e.next=7,dn(r,a);case 7:if(s=e.sent,o(),s.code!==vn.activeOrdersErr){e.next=14;break}return this.forceUrl=r,this.forceReq=a,this.showConfirmForce(),e.abrupt("return");case 14:if(Sn().checkResponse(s)){e.next=17;break}return jt.showFormError(n.reconfigErr,s.msg),e.abrupt("return");case 17:this.assetUpdated(t,n.reconfigForm,Rt(ke));case 18:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"showConfirmForce",value:function(){jt.hide(this.page.confirmForceErr),this.showForm(this.page.confirmForce)}},{key:"showRecoverWallet",value:function(){jt.hide(this.page.recoverWalletErr),this.showForm(this.page.recoverWalletConfirm)}},{key:"openWallet",value:(E=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nn.passwordIsCached()){e.next=4;break}this.showOpen(t),e.next=9;break;case 4:return n={assetID:t},e.next=7,dn("/api/openwallet",n);case 7:r=e.sent,Sn().checkResponse(r)?this.openWalletSuccess(t):this.showOpen(t,Rt(it,{msg:r.msg}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"showOpen",value:(S=o(w().mark((function e(t,n){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.page,this.unlockForm.refresh(Sn().assets[t]),n&&this.unlockForm.showErrorOnly(n),this.showForm(r.unlockWalletForm);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"showReconfig",value:(C=o(w().mark((function e(t,n){var r,a,o,s,i,c,l,u,h,d,p,f,m,v,y;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.page,jt.hide(o.changeWalletType,o.changeTypeHideIcon,o.reconfigErr,o.showChangeType,o.changeTypeHideIcon,o.reconfigErr,o.enableWallet,o.disableWallet),this.changeWalletPW=!1,this.setPWSettingViz(this.changeWalletPW),s=Sn().assets[t],i=Sn().currentWalletDefinition(t),c=s.token?[s.token.definition]:s.info?s.info.availablewallets:[],l=null===(r=Sn().user.extensionModeConfig)||void 0===r||null===(a=r.restrictedWallets[Gr(t)])||void 0===a?void 0:a.disableWalletType,c.length>1&&!l){jt.empty(o.changeWalletTypeSelect),jt.show(o.showChangeType,o.changeTypeShowIcon),o.changeTypeMsg.textContent=Rt(fe),u=Qr(c);try{for(u.s();!(h=u.n()).done;)d=h.value,p=document.createElement("option"),d.type===i.type&&(p.selected=!0),p.value=p.textContent=d.type,o.changeWalletTypeSelect.appendChild(p)}catch(e){u.e(e)}finally{u.f()}}return f=Sn().walletMap[t],jt.setVis(4&f.traits,o.downloadLogs),jt.setVis(32&f.traits,o.recoverWallet),jt.setVis(256&f.traits,o.exportWallet),jt.setVis(1&f.traits,o.rescanWallet),jt.setVis(2048&f.traits,o.managePeers),jt.setVis(0&f.traits,o.otherActionsLabel),f.disabled?jt.show(o.enableWallet):jt.show(o.disableWallet),o.recfgAssetLogo.src=jt.logoPath(s.symbol),o.recfgAssetName.textContent=s.name,n||this.showForm(o.reconfigForm),m=Sn().loading(o.reconfigForm),e.next=23,dn("/api/walletsettings",{assetID:t});case 23:if(v=e.sent,m(),Sn().checkResponse(v)){e.next=28;break}return jt.showFormError(o.reconfigErr,v.msg),e.abrupt("return");case 28:y=Sn().haveActiveOrders(t),this.reconfigForm.update(s.id,i.configopts||[],y),this.setGuideLink(i.guidelink),this.reconfigForm.setConfig(v.map),this.updateDisplayedReconfigFields(i);case 33:case"end":return e.stop()}}),e,this)}))),function(e,t){return C.apply(this,arguments)})},{key:"changeWalletType",value:function(){var e=this.page.changeWalletTypeSelect.value||"",t=Sn().walletDefinition(this.selectedAssetID,e);this.reconfigForm.update(this.selectedAssetID,t.configopts||[],!1),this.setGuideLink(t.guidelink),this.updateDisplayedReconfigFields(t)}},{key:"setGuideLink",value:function(e){jt.hide(this.walletCfgGuide),""!==e&&(this.walletCfgGuide.href=e,jt.show(this.walletCfgGuide))}},{key:"updateDisplayedReconfigFields",value:function(e){var t,n,r=null===(t=Sn().user.extensionModeConfig)||void 0===t||null===(n=t.restrictedWallets[Gr(this.selectedAssetID)])||void 0===n?void 0:n.disablePassword;e.seeded||"token"===e.type||r?(jt.hide(this.page.showChangePW,this.reconfigForm.fileSelector),this.changeWalletPW=!1,this.setPWSettingViz(!1)):jt.show(this.page.showChangePW,this.reconfigForm.fileSelector)}},{key:"showDeposit",value:(b=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.depositAddrForm.setAsset(t),this.showForm(this.page.deposit);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"showSendForm",value:(g=o(w().mark((function e(t){var n,r,a,o,s,i,c,l,u,h,d,p,f,m,v,y;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=n.sendForm,a=Sn().assets[t],o=a.wallet,s=a.name,i=a.unitInfo,c=a.symbol,l=a.token,jt.hide(n.toggleSubtract),n.subtractCheckBox.checked=!1,(u=0!=(64&o.traits))&&jt.show(n.toggleSubtract),jt.hide(n.validAddr,n.sendErr,n.maxSendDisplay),n.sendAddr.classList.remove("invalid"),n.sendAddr.value="",n.sendAmt.value="",this.showFiatValue(t,0,n.sendValue),n.walletBal.textContent=jt.formatFullPrecision(o.balance.available,i),n.sendLogo.src=jt.logoPath(c),n.sendName.textContent=s,!(o.balance.available>0&&0!=(1024&o.traits))){e.next=23;break}return h={assetID:t,subtract:u,value:o.balance.available},d=Sn().loading(this.body),e.next=20,dn("/api/txfee",h);case 20:p=e.sent,d(),Sn().checkResponse(p)&&(f=o.balance.available,l||(f-=p.txfee)<0&&(f=0),this.maxSend=f,n.maxSend.textContent=jt.formatFullPrecision(f,i),this.showFiatValue(t,f,n.maxSendFiat),l?(m=Sn().assets[l.parentID],v=m.unitInfo,y=m.symbol,n.maxSendFee.textContent=jt.formatFullPrecision(p.txfee,v)+" "+y,this.showFiatValue(l.parentID,p.txfee,n.maxSendFeeFiat)):(n.maxSendFee.textContent=jt.formatFullPrecision(p.txfee,i),this.showFiatValue(t,p.txfee,n.maxSendFeeFiat)),jt.show(n.maxSendDisplay));case 23:this.showFiatValue(t,0,n.sendValue),n.walletBal.textContent=jt.formatFullPrecision(o.balance.available,i),n.sendLogo.src=jt.logoPath(o.symbol),n.sendName.textContent=s,r.dataset.assetID=String(t),this.showForm(r);case 29:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"doConnect",value:(y=o(w().mark((function e(t){var n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Sn().loading(this.body),e.next=3,dn("/api/connectwallet",{assetID:t});case 3:r=e.sent,n(),Sn().checkResponse(r)||(a=Sn().assets[t].symbol,(o=this.page).errorModalMsg.textContent=Rt(wt,{assetName:a,errMsg:r.msg}),this.showForm(o.errorModal)),this.updateDisplayedAsset(t);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"openWalletSuccess",value:(v=o(w().mark((function e(t,n){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assetUpdated(t,n,Rt(Ce));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"assetUpdated",value:function(e,t,n){e===this.selectedAssetID&&(this.updateDisplayedAsset(e),t&&Object.is(this.currentForm,t)&&(n?this.showSuccess(n):this.closePopups()))}},{key:"populateMaxSend",value:(m=o(w().mark((function e(){var t,n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=Sn().assets[this.selectedAssetID]){e.next=4;break}return e.abrupt("return");case 4:0==(64&n.wallet.traits)?(t.sendAmt.value=String(this.maxSend/n.unitInfo.conventional.conversionFactor),this.showFiatValue(n.id,this.maxSend,t.sendValue),t.subtractCheckBox.checked=!1):(r=n.wallet.balance.available,t.sendAmt.value=String(r/n.unitInfo.conventional.conversionFactor),this.showFiatValue(n.id,r,t.sendValue),t.subtractCheckBox.checked=!0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"send",value:(f=o(w().mark((function e(){var t,n,r,a,o,s,i,c,l,u,h,d;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.page,o=parseInt(null!==(t=a.sendForm.dataset.assetID)&&void 0!==t?t:""),s=null!==(n=a.subtractCheckBox.checked)&&void 0!==n&&n,i=Sn().unitInfo(o).conventional.conversionFactor,c=a.vSendPw.value||"",a.vSendPw.value="",""!==c){e.next=9;break}return jt.showFormError(a.vSendErr,Rt(k)),e.abrupt("return");case 9:return l={assetID:o,address:a.sendAddr.value,subtract:s,value:Math.round(parseFloat(null!==(r=a.sendAmt.value)&&void 0!==r?r:"")*i),pw:c},u=Sn().loading(a.vSendForm),e.next=13,dn("/api/send",l);case 13:if(h=e.sent,u(),Sn().checkResponse(h)){e.next=18;break}return jt.showFormError(a.vSendErr,h.msg),e.abrupt("return");case 18:d=Sn().assets[o].name,this.assetUpdated(o,a.vSendForm,Rt(be,{assetName:d}));case 20:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"reconfig",value:(p=o(w().mark((function e(){var t,n,r,a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=this.selectedAssetID,jt.hide(n.reconfigErr),n.appPW.value||nn.passwordIsCached()){e.next=6;break}return jt.showFormError(n.reconfigErr,Rt(x)),e.abrupt("return");case 6:return a=Sn().currentWalletDefinition(r).type,jt.isHidden(n.changeWalletType)||(a=n.changeWalletTypeSelect.value||""),o=Sn().loading(n.reconfigForm),s={assetID:r,config:this.reconfigForm.map(r),appPW:null!==(t=n.appPW.value)&&void 0!==t?t:"",walletType:a},this.changeWalletPW&&(s.newWalletPW=n.newPW.value),e.next=13,dn("/api/reconfigurewallet",s);case 13:if(i=e.sent,n.appPW.value="",n.newPW.value="",o(),Sn().checkResponse(i)){e.next=20;break}return jt.showFormError(n.reconfigErr,i.msg),e.abrupt("return");case 20:this.assetUpdated(r,n.reconfigForm,Rt(we));case 21:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"lock",value:(d=o(w().mark((function e(t){var n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=Sn().loading(n.newWalletForm),e.next=4,dn("/api/closewallet",{assetID:t});case 4:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=8;break}return e.abrupt("return");case 8:this.updateDisplayedAsset(t);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"downloadLogs",value:(l=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new URLSearchParams("")).append("assetid","".concat(this.selectedAssetID)),(n=new URL(window.location.href)).search=t.toString(),n.pathname="/wallets/logfile",window.open(n.toString());case 6:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"displayExportWalletAuth",value:(c=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,jt.hide(t.exportWalletErr),t.exportWalletPW.value="",this.showForm(t.exportWalletAuth);case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"exportWalletAuthSubmit",value:(i=o(w().mark((function e(){var t,n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n={assetID:this.selectedAssetID,pass:t.exportWalletPW.value},r=Sn().loading(t.forms),e.next=6,dn("/api/restorewalletinfo",n);case 6:a=e.sent,r(),Sn().checkResponse(a)?(t.exportWalletPW.value="",this.displayRestoreWalletInfo(a.restorationinfo)):jt.showFormError(t.exportWalletErr,a.msg);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"displayRestoreWalletInfo",value:(a=o(w().mark((function e(t){var n,r,a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,jt.empty(n.restoreInfoCardsList),r=Qr(t);try{for(r.s();!(a=r.n()).done;)o=a.value,s=this.restoreInfoCard.cloneNode(!0),(i=jt.parseTemplate(s)).name.textContent=o.target,i.seed.textContent=o.seed,i.seedName.textContent="".concat(o.seedName,":"),i.instructions.textContent=o.instructions,n.restoreInfoCardsList.appendChild(s)}catch(e){r.e(e)}finally{r.f()}this.showForm(n.restoreWalletInfo);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"recoverWallet",value:(n=o(w().mark((function e(){var t,n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.recoverWalletErr),n={assetID:this.selectedAssetID,appPW:t.recoverWalletPW.value},t.recoverWalletPW.value="",r="/api/recoverwallet",a=Sn().loading(t.forms),e.next=8,dn(r,n);case 8:o=e.sent,a(),o.code===vn.activeOrdersErr?(this.forceUrl=r,this.forceReq=n,this.showConfirmForce()):Sn().checkResponse(o)?this.closePopups():jt.showFormError(t.recoverWalletErr,o.msg);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"confirmForceSubmit",value:(t=o(w().mark((function e(){var t,n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,this.forceReq.force=!0,n=Sn().loading(t.forms),e.next=5,dn(this.forceUrl,this.forceReq);case 5:r=e.sent,n(),Sn().checkResponse(r)?this.closePopups():jt.showFormError(t.confirmForceErr,r.msg);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleBalanceNote",value:function(e){this.updateAssetButton(e.assetID),e.assetID===this.selectedAssetID&&this.updateDisplayedAssetBalance()}},{key:"handleRatesNote",value:function(e){this.updateAssetButton(this.selectedAssetID),e.fiatRates[this.selectedAssetID]&&this.updateDisplayedAssetBalance()}},{key:"showFiatValue",value:function(e,t,n){var r=Sn().fiatRatesMap[e];r?(n.textContent=jt.formatFiatConversion(t,r,Sn().unitInfo(e)),jt.show(n.parentElement)):jt.hide(n.parentElement)}},{key:"handleWalletStateNote",value:function(e){this.updateAssetButton(e.wallet.assetID),this.assetUpdated(e.wallet.assetID),"WalletPeersUpdate"===e.topic&&e.wallet.assetID===this.selectedAssetID&&jt.isDisplayed(this.page.managePeersForm)&&this.updateWalletPeersTable()}},{key:"handleCreateWalletNote",value:function(e){this.updateAssetButton(e.assetID),this.assetUpdated(e.assetID)}},{key:"unload",value:function(){jt.unbind(document,"keyup",this.keyup)}}]),V}(ln),Zr=new Intl.NumberFormat(jt.languages(),{maximumSignificantDigits:4}),$r=new Intl.NumberFormat(jt.languages(),{minimumFractionDigits:1,maximumFractionDigits:1});function ea(e){return e>=1e3||Math.round(e)===e?$r.format(e):Zr.format(e)}function ta(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var na=["bonds"];var ra=function(e){on(k,e);var t,n,r,a,i,c,l,d,p,f,m,v,y,g,b=(y=k,g=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(y);if(g){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function k(e){var t;s(this,k),h(rn(t=b.call(this)),"body",void 0),h(rn(t),"currentDEX",void 0),h(rn(t),"page",void 0),h(rn(t),"forms",void 0),h(rn(t),"fiatRateSources",void 0),h(rn(t),"regAssetForm",void 0),h(rn(t),"confirmRegisterForm",void 0),h(rn(t),"newWalletForm",void 0),h(rn(t),"walletWaitForm",void 0),h(rn(t),"dexAddrForm",void 0),h(rn(t),"currentForm",void 0),h(rn(t),"pwCache",void 0),h(rn(t),"keyup",void 0),t.body=e;var n=t.page=jt.idDescendants(e);t.forms=jt.applySelector(n.forms,":scope > form"),t.fiatRateSources=jt.applySelector(n.fiatRateSources,"input[type=checkbox]"),jt.bind(n.darkMode,"click",(function(){nn.setCookie(nn.darkModeCK,n.darkMode.checked?"1":"0"),n.darkMode.checked?document.body.classList.add("dark"):document.body.classList.remove("dark")})),n.showPokes.checked="1"===nn.fetchLocal(nn.popupsLK),jt.bind(n.showPokes,"click",(function(){var e=n.showPokes.checked||!1;nn.storeLocal(nn.popupsLK,e?"1":"0"),Sn().showPopups=e})),n.commitHash.textContent=Sn().commitHash.substring(0,7),jt.bind(n.addADex,"click",(function(){t.dexAddrForm.refresh(),t.showForm(n.dexAddrForm)})),t.fiatRateSources.forEach((function(e){jt.bind(e,"change",o(w().mark((function t(){var n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,dn("/api/toggleratesource",{disable:!e.checked,source:e.value});case 2:return n=t.sent,Sn().checkResponse(n)||(e.checked=!e.checked),t.next=6,Sn().fetchUser();case 6:case"end":return t.stop()}}),t)}))))})),t.regAssetForm=new Or(n.regAssetForm,function(){var e=o(w().mark((function e(r){var a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.confirmRegisterForm.setAsset(r),a=Sn().assets[r],!(o=a.wallet)){e.next=15;break}return s=t.currentDEX.bondAssets[a.symbol],e.next=7,t.getBondsFeeBuffer(r,n.regAssetForm);case 7:if(i=e.sent,!(o.synced&&o.balance.available>=2*s.amount+i)){e.next=11;break}return t.animateConfirmForm(n.regAssetForm),e.abrupt("return");case 11:return t.walletWaitForm.setWallet(o,i),t.currentForm=n.walletWait,_r(n.regAssetForm,n.walletWait),e.abrupt("return");case 15:t.newWalletForm.setAsset(r),t.currentForm=n.newWalletForm,_r(n.regAssetForm,n.newWalletForm);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.confirmRegisterForm=new Dr(n.confirmRegForm,(function(){t.registerDEXSuccess()}),(function(){t.animateRegAsset(n.confirmRegForm)}),t.pwCache),t.newWalletForm=new Fr(n.newWalletForm,(function(e){return t.newWalletCreated(e)}),t.pwCache,(function(){return t.animateRegAsset(n.newWalletForm)})),t.walletWaitForm=new Pr(n.walletWait,(function(){t.animateConfirmForm(n.walletWait)}),(function(){t.animateRegAsset(n.walletWait)})),t.dexAddrForm=new Mr(n.dexAddrForm,function(){var e=o(w().mark((function e(r,a){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.currentDEX=r,t.confirmRegisterForm.setExchange(r,a),t.walletWaitForm.setExchange(r),t.regAssetForm.setExchange(r),t.animateRegAsset(n.dexAddrForm);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),jt.bind(n.importAccount,"click",(function(){return t.prepareAccountImport(n.authorizeAccountImportForm)})),Vr(n.authorizeAccountImportForm,n.authorizeImportAccountConfirm,(function(){return t.importAccount()})),jt.bind(n.changeAppPW,"click",(function(){return t.showForm(n.changeAppPWForm)})),Vr(n.changeAppPWForm,n.submitNewPW,(function(){return t.changeAppPW()})),jt.bind(n.accountFile,"change",(function(){return t.onAccountFileChange()})),jt.bind(n.removeAccount,"click",(function(){return t.clearAccountFile()})),jt.bind(n.addAccount,"click",(function(){return n.accountFile.click()})),jt.bind(n.exportSeed,"click",(function(){return t.showForm(n.exportSeedAuth)})),Vr(n.exportSeedAuth,n.exportSeedSubmit,(function(){return t.submitExportSeedReq()}));var r=function(){jt.hide(n.forms),n.exportSeedPW.value="",n.seedDiv.textContent=""};return jt.bind(n.forms,"mousedown",(function(e){jt.mouseInElement(e,t.currentForm)||r()})),t.keyup=function(e){"Escape"===e.key&&r()},jt.bind(document,"keyup",t.keyup),n.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){r()}))})),t}return u(k,[{key:"getBondsFeeBuffer",value:(v=o(w().mark((function e(t,n){var r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Sn().loading(n),e.next=3,dn("/api/bondsfeebuffer",{assetID:t});case 3:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=7;break}return e.abrupt("return",0);case 7:return e.abrupt("return",a.feeBuffer);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)})},{key:"newWalletCreated",value:(m=o(w().mark((function e(t){var n,r,a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:return r=this.page,a=n.assets[t],o=a.wallet,s=this.currentDEX.bondAssets[a.symbol].amount,e.next=11,this.getBondsFeeBuffer(t,r.newWalletForm);case 11:if(i=e.sent,!(o.synced&&o.balance.available>=2*s+i)){e.next=16;break}return e.next=15,this.animateConfirmForm(r.newWalletForm);case 15:return e.abrupt("return");case 16:return this.walletWaitForm.setWallet(o,i),this.currentForm=r.walletWait,e.next=20,_r(r.newWalletForm,r.walletWait);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"onAccountFileChange",value:(f=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,(n=t.accountFile.files)&&n.length){e.next=4;break}return e.abrupt("return");case 4:t.selectedAccount.textContent=n[0].name,jt.show(t.removeAccount),jt.hide(t.addAccount);case 7:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"clearAccountFile",value:function(){var e=this.page;e.accountFile.value="",e.selectedAccount.textContent=Rt(ie),jt.hide(e.removeAccount),jt.show(e.addAccount)}},{key:"prepareAccountImport",value:(p=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.page.importAccountErr.textContent="",this.showForm(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"importAccount",value:(d=o(w().mark((function e(){var t,n,r,a,o,s,i,c,l,u,h,d;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,n=t.importAccountAppPass.value,t.importAccountAppPass.value="",r="",!t.accountFile.value){e.next=12;break}if((a=t.accountFile.files)&&a.length){e.next=9;break}return console.error("importAccount: no file specified"),e.abrupt("return");case 9:return e.next=11,a[0].text();case 11:r=e.sent;case 12:e.prev=12,o=JSON.parse(r),e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(12),t.importAccountErr.textContent=e.t0.message,jt.show(t.importAccountErr),e.abrupt("return");case 21:if(void 0!==o){e.next=25;break}return t.importAccountErr.textContent=Rt(X),jt.show(t.importAccountErr),e.abrupt("return");case 25:return i=(s=o).bonds,c=void 0===i?[]:i,l=ta(s,na),u={pw:n,account:l,bonds:c},h=Sn().loading(this.body),e.next=30,dn("/api/importaccount",u);case 30:if(d=e.sent,h(),Sn().checkResponse(d)){e.next=36;break}return t.importAccountErr.textContent=d.msg,jt.show(t.importAccountErr),e.abrupt("return");case 36:return e.next=38,Sn().fetchUser();case 38:jt.hide(t.forms),window.location.reload();case 40:case"end":return e.stop()}}),e,this,[[12,16]])}))),function(){return d.apply(this,arguments)})},{key:"submitExportSeedReq",value:(l=o(w().mark((function e(){var t,n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.exportSeedPW.value,r=Sn().loading(this.body),e.next=5,dn("/api/exportseed",{pass:n});case 5:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=11;break}return t.exportAccountErr.textContent=a.msg,jt.show(t.exportSeedE),e.abrupt("return");case 11:t.exportSeedPW.value="",t.seedDiv.textContent=a.seed,this.showForm(t.authorizeSeedDisplay);case 14:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"showForm",value:(c=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return jt.hide(e)})),t.style.right="10000px",jt.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,jt.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getCertFile",value:(i=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="",!this.dexAddrForm.page.certFile.value){e.next=7;break}if(!(n=this.dexAddrForm.page.certFile.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:t=e.sent;case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"registerDEXSuccess",value:(a=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.forms),e.next=4,Sn().fetchUser();case 4:window.location.reload();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"changeAppPW",value:(r=o(w().mark((function e(){var t,n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,jt.hide(t.changePWErrMsg),n=function(){t.appPW.value="",t.newAppPW.value="",t.confirmNewPW.value=""},t.appPW.value&&t.newAppPW.value&&t.confirmNewPW.value){e.next=8;break}return t.changePWErrMsg.textContent=Rt(x),jt.show(t.changePWErrMsg),n(),e.abrupt("return");case 8:if(t.newAppPW.value===t.confirmNewPW.value){e.next=13;break}return t.changePWErrMsg.textContent=Rt(K),jt.show(t.changePWErrMsg),n(),e.abrupt("return");case 13:return r=Sn().loading(t.changeAppPW),a={appPW:t.appPW.value,newAppPW:t.newAppPW.value},n(),e.next=18,dn("/api/changeapppass",a);case 18:if(o=e.sent,r(),Sn().checkResponse(o)){e.next=24;break}return t.changePWErrMsg.textContent=o.msg,jt.show(t.changePWErrMsg),e.abrupt("return");case 24:jt.hide(t.forms);case 25:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"unload",value:function(){jt.unbind(document,"keyup",this.keyup)}},{key:"animateRegAsset",value:(n=o(w().mark((function e(t){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:jt.hide(t),n=this.page.regAssetForm,this.currentForm=n,this.regAssetForm.animate(),jt.show(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"animateConfirmForm",value:(t=o(w().mark((function e(t){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.confirmRegisterForm.animate(),n=this.page.confirmRegForm,this.currentForm=n,jt.hide(t),jt.show(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),k}(ln);function aa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oa=function(){function e(t,n,r){s(this,e),h(this,"base",void 0),h(this,"baseSymbol",void 0),h(this,"quote",void 0),h(this,"quoteSymbol",void 0),h(this,"buys",void 0),h(this,"sells",void 0),this.base=t.base,this.baseSymbol=n,this.quote=t.quote,this.quoteSymbol=r,this.buys=t.book.buys||[],this.sells=t.book.sells||[]}return u(e,[{key:"add",value:function(e){if(0!==e.qtyAtomic){var t=e.sell?this.sells:this.buys;t.splice(function(e,t,n){for(var r=0;r<e.length;r++)if(e[r].rate<t===n)return r;return e.length}(t,e.rate,!e.sell),0,e)}else window.log("zeroqty","zero quantity order encountered",e)}},{key:"remove",value:function(e){this.removeFromSide(this.sells,e)||this.removeFromSide(this.buys,e)}},{key:"removeFromSide",value:function(e,t){var n=r(this.findOrder(e,t),2),a=n[0],o=n[1];return!!a&&(e.splice(o,1),!0)}},{key:"findOrder",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].token===t)return[e[n],n];return[null,-1]}},{key:"updateRemaining",value:function(e,t,n){this.updateRemainingSide(this.sells,e,t,n)||this.updateRemainingSide(this.buys,e,t,n)}},{key:"updateRemainingSide",value:function(e,t,n,r){var a=this.findOrder(e,t)[0];return!!a&&(a.qty=n,a.qtyAtomic=r,!0)}},{key:"setEpoch",value:function(e){var t=function(t){return void 0===t.epoch||0===t.epoch||t.epoch===e};this.sells=this.sells.filter(t),this.buys=this.buys.filter(t)}},{key:"empty",value:function(){return!this.sells.length&&!this.buys.length}},{key:"count",value:function(){return this.sells.length+this.buys.length}},{key:"bestGapOrder",value:function(e){var t,n=null,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return aa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?aa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(!a.epoch)return a;n||(n=a)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"bestGapBuy",value:function(){return this.bestGapOrder(this.buys)}},{key:"bestGapSell",value:function(){return this.bestGapOrder(this.sells)}}]),e}();function sa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ia(e,t,n){if(e||!t.error){if(void 0!==n[e])for(var r=0;r<n[e].length;r++)n[e][r](t)}else{var a=t.error;console.error("websocket error (code ".concat(a.code,"): ").concat(a.message))}}var ca=0;const la=new(function(){function e(){s(this,e),h(this,"uri",void 0),h(this,"connection",void 0),h(this,"handlers",void 0),h(this,"queue",void 0),h(this,"maxQlength",void 0),h(this,"reloader",void 0),this.handlers={},this.queue=[],this.maxQlength=5}return u(e,[{key:"registerRoute",value:function(e,t){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push(t)}},{key:"deregisterRoute",value:function(e){this.handlers[e]=[]}},{key:"request",value:function(e,t){if(this.connection&&this.connection.readyState===window.WebSocket.OPEN){ca++;var n=JSON.stringify({route:e,type:1,id:ca,payload:t});window.log("ws","sending",n),this.connection.send(n)}else{for(;this.queue.length>this.maxQlength-1;)this.queue.shift();this.queue.push([e,t])}}},{key:"close",value:function(e){window.log("ws","close, reason:",e,this.handlers),this.handlers={},this.connection&&this.connection.close()}},{key:"connect",value:function(e,t){var n=this;this.uri=e,this.reloader=t;var a=0;!function o(){window.log("ws","connecting to ".concat(e));var s=n.connection=new window.WebSocket(e);if(s){var i=setTimeout((function(){s&&s.close()}),500);s.onmessage=function(e){var t=JSON.parse(e.data);ia(t.route,t.payload,n.handlers)},s.onclose=function(e){window.log("ws","onclose"),clearTimeout(i),s=n.connection=null,ia("close",null,n.handlers),a++;var t=Math.min(Math.pow(1.25,a),10);console.error("websocket disconnected (".concat(e.code,"), trying again in ").concat(t.toFixed(1)," seconds")),setTimeout((function(){o()}),1e3*t)},s.onopen=function(){window.log("ws","onopen"),clearTimeout(i),a>0&&(a=0,t()),ia("open",null,n.handlers);var e=n.queue;n.queue=[];var o,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return sa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}(e);try{for(s.s();!(o=s.n()).done;){var c=r(o.value,2),l=c[0],u=c[1];n.request(l,u)}}catch(e){s.e(e)}finally{s.f()}},s.onerror=function(e){window.log("ws","onerror:",e),ia("error",e,n.handlers)}}}()}}]),e}());function ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function da(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return pa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fa=jt.bind,ma="book",va="book_order",ya="unbook_order",ga="update_remaining",ba="epoch_order",wa="candles",ka="candle_update",xa=document.createElement("span");xa.classList.add("ico-check");var Ca="buygreen-bg",Sa="sellred-bg",Ea="5m",Aa=new Intl.NumberFormat(document.documentElement.lang,{minimumFractionDigits:1,maximumFractionDigits:2}),Fa=4294967295,Ia=function(e){on(R,e);var t,n,r,a,i,c,l,d,p,f,m,v,y,g,b,k,x,E,A,F,I=(A=R,F=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(A);if(F){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function R(e,t){var n;s(this,R),h(rn(n=I.call(this)),"page",void 0),h(rn(n),"main",void 0),h(rn(n),"maxLoaded",void 0),h(rn(n),"maxOrderUpdateCounter",void 0),h(rn(n),"market",void 0),h(rn(n),"currentForm",void 0),h(rn(n),"openAsset",void 0),h(rn(n),"openFunc",void 0),h(rn(n),"currentCreate",void 0),h(rn(n),"maxEstimateTimer",void 0),h(rn(n),"book",void 0),h(rn(n),"cancelData",void 0),h(rn(n),"metaOrders",void 0),h(rn(n),"preorderCache",void 0),h(rn(n),"currentOrder",void 0),h(rn(n),"depthLines",void 0),h(rn(n),"activeMarkerRate",void 0),h(rn(n),"hovers",void 0),h(rn(n),"ogTitle",void 0),h(rn(n),"depthChart",void 0),h(rn(n),"candleChart",void 0),h(rn(n),"candleDur",void 0),h(rn(n),"balanceWgt",void 0),h(rn(n),"marketList",void 0),h(rn(n),"quoteUnits",void 0),h(rn(n),"baseUnits",void 0),h(rn(n),"unlockForm",void 0),h(rn(n),"newWalletForm",void 0),h(rn(n),"depositAddrForm",void 0),h(rn(n),"keyup",void 0),h(rn(n),"secondTicker",void 0),h(rn(n),"candlesLoading",void 0),h(rn(n),"accelerateOrderForm",void 0),h(rn(n),"recentMatches",void 0),h(rn(n),"recentMatchesSortKey",void 0),h(rn(n),"recentMatchesSortDirection",void 0),h(rn(n),"stats",void 0),h(rn(n),"loadingAnimations",void 0);var r=n.page=jt.idDescendants(e);if(n.main=e,!n.main.parentElement)return sn(n);n.maxOrderUpdateCounter=0,n.metaOrders={},n.recentMatches=[],n.preorderCache={},n.depthLines={hover:[],input:[]},n.hovers=[],n.recentMatchesSortKey="age",n.recentMatchesSortDirection=-1,n.ogTitle=document.title;var a={click:function(e){n.reportDepthClick(e)},volume:function(e){n.reportDepthVolume(e)},mouse:function(e){n.reportDepthMouse(e)},zoom:function(e){n.reportDepthZoom(e)}};n.depthChart=new ur(r.depthChart,a,nn.fetchLocal(nn.depthZoomLK));var i={mouse:function(e){n.reportMouseCandle(e)}};n.candleChart=new hr(r.candlesChart,i),n.accelerateOrderForm=new Br(r.accelerateForm,(function(){})),n.candleDur=nn.fetchLocal(nn.lastCandleDurationLK)||"1h";var c=jt.tmplElement(r.notRegistered,"registerBttn");fa(c,"click",(function(){Sn().loadPage("register",{host:n.market.dex.host})})),r.walletInfoTmpl.removeAttribute("id");var l=r.walletInfoTmpl,u=r.walletInfoTmpl.cloneNode(!0);l.after(u);var d=n.balanceWgt=new Oa(l,u),p=d.base.stateIcons.icons,f=d.quote.stateIcons.icons;fa(d.base.tmpl.connect,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),fa(d.quote.tmpl.connect,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),fa(d.base.tmpl.expired,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),fa(d.quote.tmpl.expired,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),fa(p.sleeping,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),fa(f.sleeping,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),fa(p.locked,"click",(function(){n.showOpen(n.market.base,n.walletUnlocked)})),fa(f.locked,"click",(function(){n.showOpen(n.market.quote,n.walletUnlocked)})),fa(p.disabled,"click",(function(){n.showToggleWalletStatus(n.market.base)})),fa(f.disabled,"click",(function(){n.showToggleWalletStatus(n.market.quote)})),fa(d.base.tmpl.newWalletBttn,"click",(function(){n.showCreate(n.market.base)})),fa(d.quote.tmpl.newWalletBttn,"click",(function(){n.showCreate(n.market.quote)})),jt.bind(d.base.tmpl.walletAddr,"click",(function(){n.showDeposit(n.market.base.id)})),jt.bind(d.quote.tmpl.walletAddr,"click",(function(){n.showDeposit(n.market.quote.id)})),n.depositAddrForm=new Nr(r.deposit),Vr(r.toggleWalletStatusConfirm,r.toggleWalletStatusSubmit,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.toggleWalletStatus();case 1:case"end":return e.stop()}}),e)})))),An(r),jt.cleanTemplates(r.rowTemplate,r.durBttnTemplate,r.booleanOptTmpl,r.rangeOptTmpl,r.orderOptTmpl,r.userOrderTmpl),n.quoteUnits=e.querySelectorAll("[data-unit=quote]"),n.baseUnits=e.querySelectorAll("[data-unit=base]"),fa(r.buyBttn,"click",(function(){Ba(r.sellBttn,r.buyBttn),r.submitBttn.classList.remove(Sa),r.submitBttn.classList.add(Ca),r.maxLbl.textContent=Rt(T),n.setOrderBttnText(),n.setOrderVisibility(),n.drawChartLines()})),fa(r.sellBttn,"click",(function(){Ba(r.buyBttn,r.sellBttn),r.submitBttn.classList.add(Sa),r.submitBttn.classList.remove(Ca),r.maxLbl.textContent=Rt(P),n.setOrderBttnText(),n.setOrderVisibility(),n.drawChartLines()})),fa(r.limitBttn,"click",(function(){Ba(r.marketBttn,r.limitBttn),n.setOrderVisibility(),r.rateField.value&&(n.depthLines.input=[{rate:parseFloat(r.rateField.value||"0"),color:n.isSell()?n.depthChart.theme.sellLine:n.depthChart.theme.buyLine}],n.drawChartLines())})),fa(r.marketBttn,"click",(function(){Ba(r.limitBttn,r.marketBttn),n.setOrderVisibility(),n.setMarketBuyOrderEstimate(),n.depthLines.input=[],n.drawChartLines()})),fa(r.maxOrd,"click",(function(){if(n.isSell()){var e=n.market.maxSell;if(!e)return;r.lotField.value=String(e.swap.lots)}else r.lotField.value=String(n.market.maxBuys[n.adjustedRate()].swap.lots);n.lotChanged()})),jt.disableMouseWheel(r.rateField,r.lotField,r.qtyField,r.mktBuyField),la.registerRoute(ma,(function(e){n.handleBookRoute(e)})),la.registerRoute(va,(function(e){n.handleBookOrderRoute(e)})),la.registerRoute(ya,(function(e){n.handleUnbookOrderRoute(e)})),la.registerRoute(ga,(function(e){n.handleUpdateRemainingRoute(e)})),la.registerRoute(ba,(function(e){n.handleEpochOrderRoute(e)})),la.registerRoute(wa,(function(e){n.handleCandlesRoute(e)})),la.registerRoute(ka,(function(e){n.handleCandleUpdateRoute(e)})),la.registerRoute("epoch_match_summary",(function(e){n.handleEpochMatchSummary(e)})),n.unlockForm=new Lr(r.unlockWalletForm,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.openFunc();case 1:case"end":return e.stop()}}),e)})))),n.newWalletForm=new Fr(r.newWalletForm,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.createWallet();case 1:case"end":return e.stop()}}),e)})))),Vr(r.orderForm,r.submitBttn,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stepSubmit();case 1:case"end":return e.stop()}}),e)})))),Vr(r.verifyForm,r.vSubmit,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitOrder();case 1:case"end":return e.stop()}}),e)})))),jt.bind(r.vUnlockSubmit,"click",o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitEstimateUnlock();case 1:case"end":return e.stop()}}),e)})))),Vr(r.cancelForm,r.cancelSubmit,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.submitCancel();case 1:case"end":return e.stop()}}),e)})))),jt.bind(r.vFeeDetails,"click",(function(){return n.showForm(r.vDetailPane)})),jt.bind(r.closeDetailPane,"click",(function(){return n.showVerifyForm()})),r.recentMatchesTable.querySelectorAll("[data-ordercol]").forEach((function(e){return fa(e,"click",(function(){return m(e.dataset.ordercol||"")}))}));var m=function(e){v(),n.recentMatchesSortKey===e?n.recentMatchesSortDirection*=-1:(n.recentMatchesSortKey=e,n.recentMatchesSortDirection=1),n.refreshRecentMatchesTable(),y()},v=function(){r.recentMatchesTable.querySelectorAll("[data-ordercol]").forEach((function(e){return e.classList.remove("sorted-asc","sorted-dsc")}))},y=function(){var e=n.recentMatchesSortKey,t=1===n.recentMatchesSortDirection?"sorted-asc":"sorted-dsc";jt.safeSelector(r.recentMatchesTable,"[data-ordercol=".concat(e,"]")).classList.add(t)};y();var g=function(){jt.hide(r.forms),r.vPass.value="",r.cancelPass.value=""};fa(r.forms,"mousedown",(function(e){if(jt.isDisplayed(r.vDetailPane)&&!jt.mouseInElement(e,r.vDetailPane))return n.showVerifyForm();jt.mouseInElement(e,n.currentForm)||g()})),n.keyup=function(e){"Escape"===e.key&&g()},fa(document,"keyup",n.keyup),r.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){g()}))})),fa(r.lotField,"change",(function(){n.lotChanged()})),fa(r.lotField,"keyup",(function(){n.lotChanged()})),fa(r.qtyField,"change",(function(){n.quantityChanged(!0)})),fa(r.qtyField,"keyup",(function(){n.quantityChanged(!1)})),fa(r.mktBuyField,"change",(function(){n.marketBuyChanged()})),fa(r.mktBuyField,"keyup",(function(){n.marketBuyChanged()})),fa(r.rateField,"change",(function(){n.rateFieldChanged()})),fa(r.rateField,"keyup",(function(){n.previewQuoteAmt(!0)})),fa(r.marketSearchV1,"change",(function(){n.filterMarkets()})),fa(r.marketSearchV1,"keyup",(function(){n.filterMarkets()}));var b=function(e){jt.setVis(!e,r.disclaimer,r.disclaimerAck),jt.setVis(e,r.showDisclaimer)};fa(r.disclaimerAck,"click",(function(){nn.storeLocal(nn.orderDisclaimerAckedLK,!0),b(!0)})),fa(r.showDisclaimer,"click",(function(){nn.storeLocal(nn.orderDisclaimerAckedLK,!1),b(!1)})),b(nn.fetchLocal(nn.orderDisclaimerAckedLK));var k=function(){n.depthLines.hover=[],n.drawChartLines()};fa(r.buyRows,"mouseleave",k),fa(r.sellRows,"mouseleave",k),fa(r.userOrders,"mouseleave",(function(){n.activeMarkerRate=null,n.setDepthMarkers()}));var x=r.marketStatsV1,C=x.cloneNode(!0);C.classList.add("listopen"),jt.hide(x,C),C.removeAttribute("id"),Sn().headerSpace.appendChild(C),n.stats=[{row:x,tmpl:jt.parseTemplate(x)},{row:C,tmpl:jt.parseTemplate(C)}];var S=function(){nn.storeLocal(nn.leftMarketDockLK,"0"),r.leftMarketDock.classList.remove("default"),r.leftMarketDock.classList.add("stashed");var e,t=da(n.stats);try{for(t.s();!(e=t.n()).done;)e.value.row.classList.remove("listopen")}catch(e){t.e(e)}finally{t.f()}},E=function(){nn.storeLocal(nn.leftMarketDockLK,"1"),r.leftMarketDock.classList.remove("default","stashed");var e,t=da(n.stats);try{for(t.s();!(e=t.n()).done;)e.value.row.classList.add("listopen")}catch(e){t.e(e)}finally{t.f()}};jt.bind(r.leftHider,"click",(function(){return S()})),jt.bind(r.marketReopener,"click",(function(){return E()}));var A,F=da(n.stats);try{for(F.s();!(A=F.n()).done;){var D=A.value;jt.bind(D.tmpl.marketSelect,"click",(function(){0===r.leftMarketDock.clientWidth?E():S()}))}}catch(e){F.e(e)}finally{F.f()}n.marketList=new Ra(r.marketListV1);var O,L=da(n.marketList.markets);try{var B=function(){var e=O.value;fa(e.node,"click",(function(){n.startLoadingAnimations(),n.setMarket(e.mkt.xc.host,e.mkt.baseid,e.mkt.quoteid)}))};for(L.s();!(O=L.n()).done;)B()}catch(e){L.e(e)}finally{L.f()}return"1"!==nn.fetchLocal(nn.leftMarketDockLK)&&S(),Sn().registerNoteFeeder({order:function(e){n.handleOrderNote(e)},match:function(e){n.handleMatchNote(e)},epoch:function(e){n.handleEpochNote(e)},conn:function(e){n.handleConnNote(e)},balance:function(e){n.handleBalanceNote(e)},bondpost:function(e){n.handleBondUpdate(e)},spots:function(e){n.handlePriceUpdate(e)}}),n.loadingAnimations={},n.startLoadingAnimations(),n.secondTicker=window.setInterval((function(){for(var e=0,t=Object.values(n.metaOrders);e<t.length;e++){var a=t[e];a.details.age.textContent=jt.timeSince(a.ord.submitTime)}var o,s=da(jt.applySelector(r.recentMatchesLiveList,"[data-tmpl=age]"));try{for(s.s();!(o=s.n()).done;){var i,c=o.value;c.textContent=jt.timeSince(parseFloat(null!==(i=c.dataset.sinceStamp)&&void 0!==i?i:"0"))}}catch(e){s.e(e)}finally{s.f()}}),1e3),n.init(t),n}return u(R,[{key:"init",value:(E=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t&&t.host&&void 0!==t.base&&void 0!==t.quote?Ta(t.host,parseInt(t.base),parseInt(t.quote)):nn.fetchLocal(nn.lastMarketLK))&&this.marketList.exists(n.host,n.base,n.quote)||(r=this.marketList.first())&&(n={host:r.mkt.xc.host,base:r.mkt.baseid,quote:r.mkt.quoteid}),n&&this.setMarket(n.host,n.base,n.quote),this.setRegistrationStatusVisibility(),this.setBalanceVisibility();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"startLoadingAnimations",value:function(){var e=this.page,t=this.loadingAnimations,n=this.depthChart,r=this.candleChart;n.canvas.classList.add("invisible"),r.canvas.classList.add("invisible"),t.candles&&t.candles.stop(),t.candles=new dr(e.candlesChart,{message:Rt(Pe)}),t.depth&&t.depth.stop(),t.depth=new dr(e.depthChart,{message:Rt(Le)})}},{key:"isSell",value:function(){return this.page.sellBttn.classList.contains("selected")}},{key:"isLimit",value:function(){return this.page.limitBttn.classList.contains("selected")}},{key:"hasPendingBonds",value:function(){return Object.keys(this.market.dex.pendingBonds).length>0}},{key:"setCurrMarketPrice",value:function(){var e=this.market;if(e){var t=Sn().exchanges[e.dex.host],n=t.markets[e.cfg.name];if(n.spot){var r,a=da(this.stats);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=t.assets[n.baseid].unitInfo.conventional.conversionFactor;o.tmpl.volume.textContent=Ua(n.spot.vol24/s),_a(o.tmpl,t,n)}}catch(e){a.e(e)}finally{a.f()}this.page.obPrice.textContent=jt.formatFullPrecision(n.spot.rate/this.market.rateConversionFactor),this.page.obPrice.classList.remove("sellcolor","buycolor"),this.page.obPrice.classList.add(n.spot.change24>=0?"buycolor":"sellcolor"),jt.setVis(n.spot.change24>=0,this.page.obUp),jt.setVis(n.spot.change24<0,this.page.obDown)}}}},{key:"setMarketDetails",value:function(){if(this.market){var e,t=da(this.stats);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.tmpl.baseIcon.src=jt.logoPath(this.market.cfg.basesymbol),n.tmpl.quoteIcon.src=jt.logoPath(this.market.cfg.quotesymbol),jt.empty(n.tmpl.baseSymbol,n.tmpl.quoteSymbol),n.tmpl.baseSymbol.appendChild(jt.symbolize(this.market.cfg.basesymbol)),n.tmpl.quoteSymbol.appendChild(jt.symbolize(this.market.cfg.quotesymbol))}}catch(e){t.e(e)}finally{t.f()}}}},{key:"setHighLow",value:function(){var e=0,t=0,n=this.market.cfg.spot;if(n&&n.low24&&n.high24)e=n.high24,t=n.low24;else{var r,a=null===(r=this.market)||void 0===r?void 0:r.candleCaches[Ea];if(!a){if(this.candleDur!==Ea)return void this.requestCandles(Ea);var o,s=da(this.stats);try{for(s.s();!(o=s.n()).done;){var i=o.value;i.tmpl.high.textContent="-",i.tmpl.low.textContent="-"}}catch(e){s.e(e)}finally{s.f()}return}for(var c=(new Date).getTime()-864e5,l=a.candles.length-1;l>=0;l--){var u=a.candles[l];if(u.endStamp<c)break;(0===t||u.lowRate>0&&u.lowRate<t)&&(t=u.lowRate),u.highRate>e&&(e=u.highRate)}}var h,d=Sn().unitInfo(this.market.cfg.quoteid,this.market.dex).conventional.conversionFactor,p=da(this.stats);try{for(p.s();!(h=p.n()).done;){var f=h.value;f.tmpl.high.textContent=e>0?Ua(e/d):"-",f.tmpl.low.textContent=t>0?Ua(t/d):"-"}}catch(e){p.e(e)}finally{p.f()}}},{key:"assetsAreSupported",value:function(){var e,t,n,r,a=this.market,o=a.base,s=a.quote,i=a.baseCfg,c=a.quoteCfg;if(!o||!s){var l=o?c.symbol:i.symbol;return{isSupported:!1,text:Rt(L,{asset:l.toUpperCase()})}}var u=o.token?null===(e=Sn().assets[o.token.parentID].info)||void 0===e?void 0:e.versions:null===(t=o.info)||void 0===t?void 0:t.versions,h=s.token?null===(n=Sn().assets[s.token.parentID].info)||void 0===n?void 0:n.versions:null===(r=s.info)||void 0===r?void 0:r.versions,d="";return u.includes(i.version)?h.includes(c.version)||(d=Rt(B,{asset:s.symbol.toUpperCase(),version:c.version+""})):d=Rt(B,{asset:o.symbol.toUpperCase(),version:i.version+""}),{isSupported:u.includes(i.version)&&h.includes(c.version),text:d}}},{key:"setOrderVisibility",value:function(){var e=this.page;this.isLimit()?(jt.show(e.priceBox,e.tifBox,e.qtyBox,e.maxBox),jt.hide(e.mktBuyBox),this.previewQuoteAmt(!0)):(jt.hide(e.tifBox,e.maxBox,e.priceBox),this.isSell()?(jt.hide(e.mktBuyBox),jt.show(e.qtyBox),this.previewQuoteAmt(!0)):(jt.show(e.mktBuyBox),jt.hide(e.qtyBox),this.previewQuoteAmt(!1)))}},{key:"resolveOrderFormVisibility",value:function(){var e=this.page;if(jt.hide(e.orderForm,e.orderTypeBttns),this.assetsAreSupported().isSupported&&!(this.market.dex.tier<1)){var t=this.market,n=t.base,r=t.quote;n&&Sn().assets[n.id].wallet&&r&&Sn().assets[r.id].wallet&&jt.show(e.orderForm,e.orderTypeBttns)}}},{key:"setLoaderMsgVisibility",value:function(){var e=this.page,t=this.assetsAreSupported(),n=t.isSupported,r=t.text;n?jt.hide(e.loaderMsg):(e.loaderMsg.textContent=r,jt.show(e.loaderMsg),jt.hide(e.notRegistered),jt.hide(e.noWallet))}},{key:"setRegistrationStatusView",value:function(e,t,n){var r=this.page;r.regStatusTitle.textContent=e,r.regStatusConfsDisplay.textContent=t,r.registrationStatus.classList.remove("completed","error","waiting"),r.registrationStatus.classList.add(n)}},{key:"updateRegistrationStatusView",value:function(){var e=this.page,t=this.market.dex;if(e.regStatusDex.textContent=t.host,t.tier>=1)this.setRegistrationStatusView(Rt(ce),"","completed");else{var n=Object.values(t.pendingBonds).map((function(e){var n=t.bondAssets[e.symbol].confs;return"".concat(e.confs," / ").concat(n)})).join(", ");this.setRegistrationStatusView(Rt(se),n,"waiting")}}},{key:"setRegistrationStatusVisibility",value:function(){var e=this,t=this.page,n=this.market;if(n&&n.dex&&n.dex.connectionStatus===xn.Connected)if(this.updateRegistrationStatusView(),n.dex.tier>=1){var r=function(){jt.hide(t.registrationStatus,t.bondRequired),e.resolveOrderFormVisibility()};if(jt.isHidden(t.orderForm))return void setTimeout(r,5e3);r()}else n.dex.viewOnly?(t.unregisteredDex.textContent=n.dex.host,jt.show(t.notRegistered)):this.hasPendingBonds()?jt.show(t.registrationStatus):(t.acctTier.textContent="".concat(n.dex.tier),t.dexSettingsLink.href="/dexsettings/".concat(n.dex.host),jt.show(t.bondRequired))}},{key:"setOrderBttnText",value:function(){this.isSell()?this.page.submitBttn.textContent=Rt(S,{asset:jt.shortSymbol(this.market.baseCfg.symbol)}):this.page.submitBttn.textContent=Rt(C,{asset:jt.shortSymbol(this.market.baseCfg.symbol)})}},{key:"setCandleDurBttns",value:function(){var e=this,t=this.page,n=this.market;jt.empty(t.durBttnBox);var r,a=da(n.dex.candleDurs);try{var o=function(){var n=r.value,a=t.durBttnTemplate.cloneNode(!0);a.textContent=n,jt.bind(a,"click",(function(){return e.candleDurationSelected(n)})),t.durBttnBox.appendChild(a)};for(a.s();!(r=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}this.loadCandles()}},{key:"setMarket",value:(x=o(w().mark((function e(t,n,r){var a,o,s,i,c,l,u,h,d,p,f,m,v,y;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Sn().user.exchanges[t],(o=this.page).lotField.value="",o.qtyField.value="",o.rateField.value="",jt.hide(o.notRegistered,o.bondRequired,o.noWallet),a&&a.markets&&a.connectionStatus===xn.Connected){e.next=10;break}return o.chartErrMsg.textContent=Rt(M),jt.show(o.chartErrMsg),e.abrupt("return");case 10:s=da(this.stats);try{for(s.s();!(i=s.n()).done;)c=i.value,jt.show(c.row)}catch(e){s.e(e)}finally{s.f()}l=a.assets[n],u=a.assets[r],h=[Sn().unitInfo(n,a),Sn().unitInfo(r,a)],p=h[1],f=jn/(d=h[0]).conventional.conversionFactor*p.conventional.conversionFactor,jt.hide(o.maxOrd,o.chartErrMsg),this.maxEstimateTimer&&(window.clearTimeout(this.maxEstimateTimer),this.maxEstimateTimer=null),m=Pa(l.symbol,u.symbol),v=Sn().assets[n],y=Sn().assets[r],this.market={dex:a,sid:m,cfg:a.markets[m],base:v,quote:y,baseUnitInfo:d,quoteUnitInfo:p,maxSell:null,maxBuys:{},maxSellRequested:!1,candleCaches:{},baseCfg:l,quoteCfg:u,rateConversionFactor:f,sellBalance:0,buyBalance:0},jt.setVis(!(v&&y&&v.wallet&&y.wallet),o.noWallet),this.setMarketDetails(),this.setCurrMarketPrice(),this.refreshRecentMatchesTable(),la.request("loadmarket",Ta(t,n,r)),this.setLoaderMsgVisibility(),this.setRegistrationStatusVisibility(),this.resolveOrderFormVisibility(),this.setOrderBttnText(),this.setCandleDurBttns(),this.previewQuoteAmt(!1);case 33:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return x.apply(this,arguments)})},{key:"reportDepthClick",value:function(e){this.page.rateField.value=String(e),this.rateFieldChanged()}},{key:"reportDepthVolume",value:function(e){var t=this.page,n=this.market,r=n.baseUnitInfo,a=n.quoteUnitInfo;t.sellBookedBase.textContent=jt.formatCoinValue(e.sellBase*r.conventional.conversionFactor,r),t.sellBookedQuote.textContent=jt.formatCoinValue(e.sellQuote*a.conventional.conversionFactor,a),t.buyBookedBase.textContent=jt.formatCoinValue(e.buyBase*r.conventional.conversionFactor,r),t.buyBookedQuote.textContent=jt.formatCoinValue(e.buyQuote*a.conventional.conversionFactor,a)}},{key:"reportDepthMouse",value:function(e){for(;this.hovers.length;)this.hovers.shift().classList.remove("hover");var t=this.page;if(e){jt.show(t.hoverData,t.depthHoverData);for(var n=0,r=Object.values(this.metaOrders);n<r.length;n++){var a=r[n],o=a.div,s=a.ord;s.status===qn&&e.hoverMarkers.indexOf(s.rate)>-1&&(o.classList.add("hover"),this.hovers.push(o))}t.hoverPrice.textContent=jt.formatCoinValue(e.rate),t.hoverVolume.textContent=jt.formatCoinValue(e.depth),t.hoverVolume.style.color=e.dotColor}else jt.hide(t.hoverData,t.depthHoverData)}},{key:"reportDepthZoom",value:function(e){nn.storeLocal(nn.depthZoomLK,e)}},{key:"reportMouseCandle",value:function(e){var t=this.page;e?(jt.show(t.hoverData,t.candleHoverData),t.candleStart.textContent=jt.formatCoinValue(e.startRate/this.market.rateConversionFactor),t.candleEnd.textContent=jt.formatCoinValue(e.endRate/this.market.rateConversionFactor),t.candleHigh.textContent=jt.formatCoinValue(e.highRate/this.market.rateConversionFactor),t.candleLow.textContent=jt.formatCoinValue(e.lowRate/this.market.rateConversionFactor),t.candleVol.textContent=jt.formatCoinValue(e.matchVolume,this.market.baseUnitInfo)):jt.hide(t.hoverData,t.candleHoverData)}},{key:"parseOrder",value:function(){var e=this.page,t=e.qtyField,n=this.isLimit(),r=this.isSell(),a=this.market,o=a.baseUnitInfo.conventional.conversionFactor;return n||r||(t=e.mktBuyField,o=a.quoteUnitInfo.conventional.conversionFactor),{host:a.dex.host,isLimit:n,sell:r,base:a.base.id,quote:a.quote.id,qty:La(t.value||"",o),rate:La(e.rateField.value||"",a.rateConversionFactor),tifnow:e.tifNow.checked||!1,options:{}}}},{key:"previewQuoteAmt",value:function(e){var t=this.page;if(this.market.base&&this.market.quote){var n=this.parseOrder(),r=this.adjustedRate();if(t.orderErr.textContent="",r&&(n.sell?this.preSell():this.preBuy()),this.depthLines.input=[],r&&this.isLimit()&&(this.depthLines.input=[{rate:n.rate/this.market.rateConversionFactor,color:n.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}]),this.drawChartLines(),!e||!r||!n.qty)return t.orderPreview.textContent="",void this.drawChartLines();var a=Sn().assets[n.quote],o=n.qty*n.rate/jn,s=jt.formatCoinValue(o,this.market.quoteUnitInfo);t.orderPreview.textContent=Rt(W,{total:s,asset:a.symbol.toUpperCase()}),this.isSell()?this.preSell():this.preBuy()}}},{key:"preSell",value:function(){var e=this,t=this.market,n=Sn().assets[t.base.id].wallet;n.balance.available<t.cfg.lotsize?this.setMaxOrder(null):t.maxSell?this.setMaxOrder(t.maxSell.swap):t.maxSellRequested||(t.maxSellRequested=!0,this.scheduleMaxEstimate("/api/maxsell",{},0,(function(r){t.maxSellRequested=!1,t.maxSell=r.maxSell,t.sellBalance=n.balance.available,e.setMaxOrder(r.maxSell.swap)})))}},{key:"preBuy",value:function(){var e=this,t=this.market,n=this.adjustedRate(),r=Sn().assets[t.quote.id].wallet;if(r){var a=t.cfg.lotsize*(n/jn);if(r.balance.available<a)this.setMaxOrder(null);else if(t.maxBuys[n])this.setMaxOrder(t.maxBuys[n].swap);else{var o=Object.keys(t.maxBuys).length?350:0;this.scheduleMaxEstimate("/api/maxbuy",{rate:n},o,(function(r){t.maxBuys[n]=r.maxBuy,t.buyBalance=Sn().assets[t.quote.id].wallet.balance.available,e.setMaxOrder(r.maxBuy.swap)}))}}}},{key:"scheduleMaxEstimate",value:function(e,t,n,r){var a=this,s=this.page;this.maxLoaded||(this.maxLoaded=Sn().loading(s.maxOrd));var i=[this.market.base.id,this.market.quote.id],c=i[0],l=i[1],u=[Sn().assets[c].wallet,Sn().assets[l].wallet],h=u[0],d=u[1];if(h&&h.running&&d&&d.running){this.maxEstimateTimer&&window.clearTimeout(this.maxEstimateTimer),jt.show(s.maxOrd,s.maxLotBox),jt.hide(s.maxAboveZero),s.maxFromLots.textContent=Rt(q),s.maxFromLotsLbl.textContent="",this.maxOrderUpdateCounter++;var p=this.maxOrderUpdateCounter;this.maxEstimateTimer=window.setTimeout(o(w().mark((function n(){var o;return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.maxEstimateTimer=null,p===a.maxOrderUpdateCounter){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,dn(e,ha({host:a.market.dex.host,base:c,quote:l},t));case 5:if(o=n.sent,p===a.maxOrderUpdateCounter){n.next=8;break}return n.abrupt("return");case 8:if(Sn().checkResponse(o)){n.next=13;break}return console.warn("max order estimate not available:",o),s.maxFromLots.textContent=Rt(N),a.maxLoaded&&(a.maxLoaded(),a.maxLoaded=null),n.abrupt("return");case 13:r(o);case 14:case"end":return n.stop()}}),n)}))),n)}}},{key:"setMaxOrder",value:function(e){var t=this.page;this.maxLoaded&&(this.maxLoaded(),this.maxLoaded=null),jt.show(t.maxOrd,t.maxLotBox,t.maxAboveZero);var n=this.isSell(),r=0;if(e&&(r=e.lots),t.maxFromLots.textContent=r.toString(),t.maxFromLotsLbl.textContent=Rt(1===r?J:Z),e){var a=n?this.market.base:this.market.quote;t.maxFromAmt.textContent=jt.formatCoinValue(e.value||0,a.unitInfo),t.maxFromTicker.textContent=a.symbol.toUpperCase()}else jt.hide(t.maxAboveZero)}},{key:"validateOrder",value:function(e){var t=this.page;return e.isLimit&&!e.rate?(jt.show(t.orderErr),t.orderErr.textContent=Rt(U),!1):!!e.qty||(jt.show(t.orderErr),t.orderErr.textContent=Rt(_),!1)}},{key:"handleBook",value:function(e){var t,n=this.market,r=n.cfg,a=n.baseUnitInfo,o=n.quoteUnitInfo,s=n.baseCfg,i=n.quoteCfg;this.book=new oa(e,s.symbol,i.symbol),this.loadTable();var c,l=da(e.book.epoch||[]);try{for(l.s();!(c=l.n()).done;){var u=c.value;u.rate>0&&this.book.add(u),this.addTableOrder(u)}}catch(e){l.e(e)}finally{l.f()}if(!this.book)return this.depthChart.clear(),jt.empty(this.page.buyRows),void jt.empty(this.page.sellRows);jt.show(this.page.epochLine),this.loadingAnimations.depth&&this.loadingAnimations.depth.stop(),this.depthChart.canvas.classList.remove("invisible"),this.depthChart.set(this.book,r.lotsize,r.ratestep,a,o),this.recentMatches=null!==(t=e.book.recentMatches)&&void 0!==t?t:[],this.refreshRecentMatchesTable()}},{key:"midGapConventional",value:function(){var e=this.midGap();if(!e)return e;var t=this.market,n=t.baseUnitInfo,r=t.quoteUnitInfo;return e*n.conventional.conversionFactor/r.conventional.conversionFactor}},{key:"midGap",value:function(){var e=this.book;if(e)return e.buys&&e.buys.length?e.sells&&e.sells.length?(e.buys[0].msgRate+e.sells[0].msgRate)/2/jn:e.buys[0].msgRate/jn:e.sells&&e.sells.length?e.sells[0].msgRate/jn:null}},{key:"setMarketBuyOrderEstimate",value:function(){var e=this.market,t=e.cfg.lotsize,n=Sn().user.exchanges[e.dex.host].markets[e.sid].buybuffer,r=this.midGapConventional();r&&(this.page.minMktBuy.textContent=jt.formatCoinValue(t*n*r,e.baseUnitInfo))}},{key:"refreshActiveOrders",value:function(){var e=this,t=this.page,n=this.metaOrders,r=this.market;for(var a in n)delete n[a];var o=Sn().orders(r.dex.host,Pa(r.baseCfg.symbol,r.quoteCfg.symbol));o.sort((function(e,t){return t.submitTime-e.submitTime})),jt.empty(t.userOrders),jt.setVis(null==o?void 0:o.length,t.userOrders),jt.setVis(!(null!=o&&o.length),t.userNoOrders);var s,i=!1,c=da(o);try{var l=function(){var r=s.value,a=t.userOrderTmpl.cloneNode(!0);t.userOrders.appendChild(a);var o=jt.tmplElement(a,"header"),c=jt.parseTemplate(o),l=jt.tmplElement(a,"details"),u=jt.parseTemplate(l),h={div:a,header:c,details:u,ord:r};r.id&&(n[r.id]=h),r.readyToTick||(o.classList.add("unready-user-order"),i=!0),c.sideLight.classList.add(r.sell?"sell":"buy"),u.side.textContent=c.side.textContent=Hn(r),u.side.classList.add(r.sell?"sellcolor":"buycolor"),c.side.classList.add(r.sell?"sellcolor":"buycolor"),u.qty.textContent=c.qty.textContent=Ua(r.qty/e.market.baseUnitInfo.conventional.conversionFactor),u.rate.textContent=c.rate.textContent=Ua(r.rate/e.market.rateConversionFactor),c.baseSymbol.textContent=r.baseSymbol.toUpperCase(),u.type.textContent=Gn(r),e.updateMetaOrder(h),jt.bind(a,"mouseenter",(function(){e.activeMarkerRate=r.rate,e.setDepthMarkers()})),r.id?(r.type===Ln&&1===r.tif&&r.status<Nn&&(jt.show(u.cancelBttn),fa(u.cancelBttn,"click",(function(t){t.stopPropagation(),e.showCancel(a,r.id)}))),fa(u.accelerateBttn,"click",(function(t){t.stopPropagation(),e.showAccelerate(r)})),Sn().canAccelerateOrder(r)&&jt.show(u.accelerateBttn),u.link.href="order/".concat(r.id),Sn().bindInternalNavigation(a)):(jt.hide(u.accelerateBttn),jt.hide(u.cancelBttn),jt.hide(u.link)),jt.bind(o,"click",(function(){if(jt.isDisplayed(l))return jt.hide(l),c.expander.classList.add("ico-arrowdown"),void c.expander.classList.remove("ico-arrowup");jt.show(l),c.expander.classList.remove("ico-arrowdown"),c.expander.classList.add("ico-arrowup")})),Sn().bindTooltips(a)};for(c.s();!(s=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}jt.setVis(i,t.unreadyOrdersMsg),this.setDepthMarkers()}},{key:"updateMetaOrder",value:function(e){var t=e.header,n=e.details,r=e.ord;r.status<=qn||Xn(r)?t.activeLight.classList.add("active"):t.activeLight.classList.remove("active"),n.status.textContent=t.status.textContent=Qn(r),n.age.textContent=jt.timeSince(r.submitTime),n.filled.textContent="".concat((Yn(r)/r.qty*100).toFixed(1),"%"),n.settled.textContent="".concat((Jn(r)/r.qty*100).toFixed(1),"%")}},{key:"setDepthMarkers",value:function(){for(var e={buys:[],sells:[]},t=this.market.rateConversionFactor,n=0,r=Object.values(this.metaOrders);n<r.length;n++){var a=r[n].ord;a.rate&&a.status===qn&&(a.sell?e.sells.push({rate:a.rate/t,active:a.rate===this.activeMarkerRate}):e.buys.push({rate:a.rate/t,active:a.rate===this.activeMarkerRate}))}this.depthChart.setMarkers(e),this.book&&this.depthChart.draw()}},{key:"updateTitle",value:function(){var e=this.midGapConventional();if(e){var t=this.market,n=t.baseCfg,r=t.quoteCfg,a=n.symbol.toUpperCase(),o=r.symbol.toUpperCase();document.title="".concat(jt.formatCoinValue(e)," | ").concat(a).concat(o," | ").concat(this.ogTitle)}}},{key:"handleBookRoute",value:function(e){Sn().log("book","handleBookRoute:",e);var t=e.payload,n=this.market,r=this.page,a=n.dex.host,o=[n.baseCfg,n.quoteCfg],s=o[0],i=o[1];t.base===s.id&&t.quote===i.id&&(this.refreshActiveOrders(),this.handleBook(t),this.updateTitle(),this.marketList.select(a,s.id,i.id),nn.storeLocal(nn.lastMarketLK,{host:e.host,base:t.base,quote:t.quote}),r.lotSize.textContent=jt.formatCoinValue(n.cfg.lotsize,n.baseUnitInfo),r.rateStep.textContent=jt.formatCoinValue(n.cfg.ratestep/n.rateConversionFactor),this.baseUnits.forEach((function(e){jt.empty(e),e.appendChild(jt.symbolize(s.symbol))})),this.quoteUnits.forEach((function(e){jt.empty(e),e.appendChild(jt.symbolize(i.symbol))})),this.balanceWgt.setWallets(a,s.id,i.id),this.setMarketBuyOrderEstimate(),this.refreshActiveOrders())}},{key:"handleBookOrderRoute",value:function(e){if(Sn().log("book","handleBookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.rate>0&&this.book.add(t),this.addTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUnbookOrderRoute",value:function(e){if(Sn().log("book","handleUnbookOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.remove(t.token),this.removeTableOrder(t),this.updateTitle(),this.depthChart.draw()}}},{key:"handleUpdateRemainingRoute",value:function(e){if(Sn().log("book","handleUpdateRemainingRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;this.book.updateRemaining(t.token,t.qty,t.qtyAtomic),this.updateTableOrder(t),this.depthChart.draw()}}},{key:"handleEpochOrderRoute",value:function(e){if(Sn().log("book","handleEpochOrderRoute:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){var t=e.payload;t.msgRate>0&&this.book.add(t),t.qtyAtomic>0&&this.addTableOrder(t),this.depthChart.draw()}}},{key:"handleCandlesRoute",value:function(e){if(this.candlesLoading&&(clearTimeout(this.candlesLoading.timer),this.candlesLoading.loaded(),this.candlesLoading=null),e.host===this.market.dex.host&&e.marketID===this.market.cfg.name){var t=e.payload.dur;this.market.candleCaches[t]=e.payload,this.setHighLow(),this.candleDur===t&&(this.loadingAnimations.candles&&this.loadingAnimations.candles.stop(),this.candleChart.canvas.classList.remove("invisible"),this.candleChart.setCandles(e.payload,this.market.cfg,this.market.baseUnitInfo,this.market.quoteUnitInfo))}}},{key:"handleEpochMatchSummary",value:function(e){this.addRecentMatches(e.payload),this.refreshRecentMatchesTable()}},{key:"handleCandleUpdateRoute",value:function(e){if(e.host===this.market.dex.host){var t=e.payload,n=t.dur,r=t.candle,a=this.market.candleCaches[n];if(a){var o=a.candles;0===o.length?o.push(r):o[o.length-1].startStamp===r.startStamp?o[o.length-1]=r:o.push(r),this.candleDur===n&&this.candleChart.draw()}}}},{key:"showForm",value:(k=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,jt.hide.apply(jt,yn(Array.from(n.forms.children))),t.style.right="10000px",jt.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,jt.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"showOpen",value:(b=o(w().mark((function e(t,n){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.page,this.openAsset=t,this.openFunc=n,this.unlockForm.refresh(Sn().assets[t.id]),this.showForm(r.unlockWalletForm),r.uwAppPass.focus();case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"showToggleWalletStatus",value:function(e){var t=this.page;this.openAsset=e,jt.hide(t.toggleWalletStatusErr,t.walletStatusDisable,t.disableWalletMsg),jt.show(t.walletStatusEnable,t.enableWalletMsg),this.showForm(t.toggleWalletStatusConfirm)}},{key:"toggleWalletStatus",value:(g=o(w().mark((function e(){var t,n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,jt.hide(t.toggleWalletStatusErr),n={assetID:this.openAsset.id,disable:!1},r=Sn().loading(t.toggleWalletStatusConfirm),e.next=7,dn("/api/togglewalletstatus",n);case 7:if(a=e.sent,r(),Sn().checkResponse(a)){e.next=13;break}return t.toggleWalletStatusErr.textContent=a.msg,jt.show(t.toggleWalletStatusErr),e.abrupt("return");case 13:jt.hide(this.page.forms),this.balanceWgt.updateAsset(this.openAsset.id);case 15:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"showVerify",value:function(){this.preorderCache={};var e,t=this.page,n=this.currentOrder=this.parseOrder(),r=n.sell,a=Sn().assets[n.base],o=Sn().assets[n.quote],s=r?o:a,i=r?a:o,c=function(e){switch(e.dataset.icon){case"from":if(i.token){var t=Sn().assets[i.token.parentID];e.src=jt.logoPath(t.symbol)}else e.src=jt.logoPath(i.symbol);break;case"to":if(s.token){var n=Sn().assets[s.token.parentID];e.src=jt.logoPath(n.symbol)}else e.src=jt.logoPath(s.symbol)}},l=da(jt.applySelector(t.vDetailPane,"[data-icon]"));try{for(l.s();!(e=l.n()).done;)c(e.value)}catch(e){l.e(e)}finally{l.f()}var u,h=da(jt.applySelector(t.vFeeSummary,"[data-icon]"));try{for(h.s();!(u=h.n()).done;)c(u.value)}catch(e){h.e(e)}finally{h.f()}jt.hide(t.vUnlockPreorder,t.vPreorderErr),jt.show(t.vPreorder),t.vBuySell.textContent=Rt(r?Se:Ee);var d=Rt(r?P:T);if(t.vSideSubmit.textContent=d,t.vOrderHost.textContent=n.host,n.isLimit){jt.show(t.verifyLimit),jt.hide(t.verifyMarket);var p="Limit ".concat(d," Order");t.vOrderType.textContent=n.tifnow?p+" (immediate)":p,t.vRate.textContent=jt.formatCoinValue(n.rate/this.market.rateConversionFactor),t.vQty.textContent=jt.formatCoinValue(n.qty,a.unitInfo);var f=n.rate/jn*n.qty;t.vTotal.textContent=jt.formatCoinValue(f,o.unitInfo),this.showFiatValue(o.id,f,t.vFiatTotal)}else{jt.hide(t.verifyLimit),jt.show(t.verifyMarket),t.vOrderType.textContent="Market ".concat(d," Order");var m=n.sell?this.market.baseUnitInfo:this.market.quoteUnitInfo;t.vmFromTotal.textContent=jt.formatCoinValue(n.qty,m),t.vmFromAsset.textContent=i.symbol.toUpperCase(),this.showFiatValue(i.id,n.qty,t.vmFromTotalFiat);var v=this.midGap();if(v){jt.show(t.vMarketEstimate);var y=n.sell?n.qty*v:n.qty/v;t.vmToTotal.textContent=jt.formatCoinValue(y,s.unitInfo),t.vmToAsset.textContent=s.symbol.toUpperCase(),this.showFiatValue(s.id,y,t.vmTotalFiat)}else jt.hide(t.vMarketEstimate)}r?(t.vHeader.classList.add(Sa),t.vHeader.classList.remove(Ca),t.vSubmit.classList.add(Sa),t.vSubmit.classList.remove(Ca)):(t.vHeader.classList.add(Ca),t.vHeader.classList.remove(Sa),t.vSubmit.classList.add(Ca),t.vSubmit.classList.remove(Sa)),this.showVerifyForm(),t.vPass.focus(),a.wallet.open&&o.wallet.open?this.preOrder(n):(jt.hide(t.vPreorder),nn.passwordIsCached()?this.unlockWalletsForEstimates(""):jt.show(t.vUnlockPreorder))}},{key:"showFiatValue",value:function(e,t,n){if(n){var r=Sn().fiatRatesMap[e];n.textContent=jt.formatFiatConversion(t,r,Sn().unitInfo(e)),r?jt.show(n.parentElement):jt.hide(n.parentElement)}}},{key:"showVerifyForm",value:(y=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,jt.hide(t.vErr),this.showForm(t.verifyForm);case 3:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"submitEstimateUnlock",value:(v=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page.vUnlockPass.value||"",e.next=3,this.unlockWalletsForEstimates(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"unlockWalletsForEstimates",value:(m=o(w().mark((function e(t){var n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=Sn().loading(n.verifyForm),e.next=4,this.attemptWalletUnlock(t);case 4:if(a=e.sent,r(),!a){e.next=8;break}return e.abrupt("return",this.setPreorderErr(a));case 8:jt.show(n.vPreorder),jt.hide(n.vUnlockPreorder),this.preOrder(this.parseOrder());case 11:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"attemptWalletUnlock",value:(f=o(w().mark((function e(t){var n,r,a,o,s,i,c,l,u;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.market,r=n.base,a=n.quote,o=[],r.wallet.open||o.push(r.id),a.wallet.open||o.push(a.id),s={pass:t,assetID:-1},i=0,c=o;case 6:if(!(i<c.length)){e.next=17;break}return l=c[i],s.assetID=l,e.next=11,dn("/api/openwallet",s);case 11:if(u=e.sent,Sn().checkResponse(u)){e.next=14;break}return e.abrupt("return",u.msg);case 14:i++,e.next=6;break;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"fetchPreorder",value:(p=o(w().mark((function e(t){var n,r,a,o,s;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=JSON.stringify(t.options),!(a=this.preorderCache[r])){e.next=5;break}return e.abrupt("return",a);case 5:return jt.hide(n.vPreorderErr),o=Sn().loading(n.verifyForm),e.next=9,dn("/api/preorder",Ma(t));case 9:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=13;break}return e.abrupt("return",{err:s.msg});case 13:return this.preorderCache[r]=s.estimate,e.abrupt("return",s.estimate);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"setPreorderErr",value:function(e){var t=this.page;jt.hide(t.vPreorder),jt.show(t.vPreorderErr),t.vPreorderErrTip.dataset.tooltip=e}},{key:"showPreOrderAdvancedOptions",value:function(){var e=this.page;jt.hide(e.showAdvancedOptions),jt.show(e.hideAdvancedOptions,e.vOtherOrderOpts)}},{key:"hidePreOrderAdvancedOptions",value:function(){var e=this.page;jt.hide(e.hideAdvancedOptions,e.vOtherOrderOpts),jt.show(e.showAdvancedOptions)}},{key:"reloadOrderOpts",value:function(e,t,n,r){var a=this.page;jt.empty(a.vDefaultOrderOpts,a.vOtherOrderOpts);var o,s=function(t,n){var o=function(e,t,n,r){var a,o,s=r&&t.sell||!r&&!t.sell,i=(a=t.host,o=s?t.base:t.quote,Sn().exchanges[a].assets[o].symbol);switch(!0){case!!e.boolean:return new Rn(e,i,t.options,n).node;case!!e.xyRange:return new Dn(e,i,t.options,n).node;default:console.error("no option type specified",e)}return console.error("unknown option type",e),document.createElement("div")}(t,e,r,n);t.showByDefault?a.vDefaultOrderOpts.appendChild(o):a.vOtherOrderOpts.appendChild(o)},i=da(t.options||[]);try{for(i.s();!(o=i.n()).done;)s(o.value,!0)}catch(e){i.e(e)}finally{i.f()}var c,l=da(n.options||[]);try{for(l.s();!(c=l.n()).done;)s(c.value,!1)}catch(e){l.e(e)}finally{l.f()}Sn().bindTooltips(a.vDefaultOrderOpts),Sn().bindTooltips(a.vOtherOrderOpts)}},{key:"preOrder",value:(d=o(w().mark((function e(t){var n,r,a=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.page,r=function(){var e=o(w().mark((function e(){var s,i,c,l,u;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetchPreorder(t);case 2:if(!(s=e.sent).err){e.next=5;break}return e.abrupt("return",a.setPreorderErr(s.err));case 5:i=s,jt.hide(n.vPreorderErr),jt.show(n.vPreorder),c=i.swap,l=i.redeem,c.options=c.options||[],l.options=l.options||[],a.setFeeEstimates(c,l,t),u=function(){var e=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:jt.animate(400,(function(e){n.vFeeSummary.style.backgroundColor="rgba(128, 128, 128, ".concat(.5-.5*e,")")}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),jt.bind(n.showAdvancedOptions,"click",(function(){a.showPreOrderAdvancedOptions()})),jt.bind(n.hideAdvancedOptions,"click",(function(){a.hidePreOrderAdvancedOptions()})),a.reloadOrderOpts(t,c,l,u);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"setFeeEstimates",value:function(e,t,n){var r=this.page,a=this.market;if(e.estimate&&t.estimate){jt.show(r.vPreorderEstimates);var o=a.baseUnitInfo,s=a.quoteUnitInfo,i=a.rateConversionFactor,c=function(e){return e<.05?"< 0.1":Aa.format(e)},l=1,u=1,h=o,d=s;if(a.base.token){var p=Sn().assets[a.base.token.parentID];h=p.unitInfo;var f=Sn().fiatRatesMap[a.base.id],m=Sn().fiatRatesMap[p.id];l=f&&m?m/f*o.conventional.conversionFactor/p.unitInfo.conventional.conversionFactor:0}if(a.quote.token){var v=Sn().assets[a.quote.token.parentID];d=v.unitInfo;var y=Sn().fiatRatesMap[a.quote.id],g=Sn().fiatRatesMap[v.id];u=y&&g?g/y*s.conventional.conversionFactor/v.unitInfo.conventional.conversionFactor:0}var b=h,w=d,k=l,x=u;if(this.currentOrder.sell){var C=[b,w];w=C[0],b=C[1];var S=[k,x];x=S[0],k=S[1]}var E=e.estimate.value||0,A=x>0?E/x:E,F=e.estimate.realisticBestCase/A*100;r.vSwapFeesLowPct.textContent=x<=0?"":"(".concat(c(F),"%)"),r.vSwapFeesLow.textContent=jt.formatCoinValue(e.estimate.realisticBestCase,w);var I=e.estimate.realisticWorstCase/A*100;r.vSwapFeesHighPct.textContent=x<=0?"":"(".concat(c(I),"%)"),r.vSwapFeesHigh.textContent=jt.formatCoinValue(e.estimate.realisticWorstCase,w);var R=e.estimate.maxFees/A*100;r.vSwapFeesMaxPct.textContent=x<=0?"":"(".concat(c(R),"%)"),r.vSwapFeesMax.textContent=jt.formatCoinValue(e.estimate.maxFees,w);var D=this.midGap()||n.rate/i,O=n.sell?E*D:E/D,T=k>0?O/k:O,P=t.estimate.realisticBestCase/T*100;r.vRedeemFeesLowPct.textContent=k<=0?"":"(".concat(c(P),"%)"),r.vRedeemFeesLow.textContent=jt.formatCoinValue(t.estimate.realisticBestCase,b);var L=t.estimate.realisticWorstCase/T*100;r.vRedeemFeesHighPct.textContent=k<=0?"":"(".concat(c(L),"%)"),r.vRedeemFeesHigh.textContent=jt.formatCoinValue(t.estimate.realisticWorstCase,b),l&&u?(jt.show(r.vFeeSummaryPct),jt.hide(r.vFeeSummary),r.vFeeSummaryLow.textContent=c(F+P),r.vFeeSummaryHigh.textContent=c(I+L)):(jt.hide(r.vFeeSummaryPct),jt.show(r.vFeeSummary),r.summarySwapFeesLow.textContent=r.vSwapFeesLow.textContent,r.summarySwapFeesHigh.textContent=r.vSwapFeesHigh.textContent,r.summaryRedeemFeesLow.textContent=r.vRedeemFeesLow.textContent,r.summaryRedeemFeesHigh.textContent=r.vRedeemFeesHigh.textContent)}else jt.hide(r.vPreorderEstimates)}},{key:"submitCancel",value:(l=o(w().mark((function e(){var t,n,r,a,o,s;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.cancelData,r=n.order,a={orderID:r.id,pw:t.cancelPass.value},t.cancelPass.value="",o=Sn().loading(t.cancelSubmit),e.next=8,dn("/api/cancel",a);case 8:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=14;break}return t.cancelErr.textContent=s.msg,jt.show(t.cancelErr),e.abrupt("return");case 14:jt.hide(n.bttn,t.forms),r.cancelling=!0;case 16:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"showCancel",value:function(e,t){var n=this.metaOrders[t].ord,r=this.page,a=n.qty-n.filled,o=Kn(n)?this.market.quote:this.market.base;r.cancelRemain.textContent=jt.formatCoinValue(a,o.unitInfo),r.cancelUnit.textContent=o.symbol.toUpperCase(),jt.hide(r.cancelErr),this.showForm(r.cancelForm),r.cancelPass.focus(),this.cancelData={bttn:jt.tmplElement(e,"cancelBttn"),order:n}}},{key:"showAccelerate",value:function(e){var t=Sn().loading(this.main);this.accelerateOrderForm.refresh(e),t(),this.showForm(this.page.accelerateForm)}},{key:"showCreate",value:function(e){var t=this.page;this.currentCreate=e,this.newWalletForm.setAsset(e.id),this.showForm(t.newWalletForm)}},{key:"stepSubmit",value:function(){var e=this.page,t=this.market;if(jt.hide(e.orderErr),this.validateOrder(this.parseOrder())){var n=Sn().walletMap[t.base.id],r=Sn().walletMap[t.quote.id];return n?r?void this.showVerify():(e.orderErr.textContent=Rt(V,{asset:t.quote.symbol}),void jt.show(e.orderErr)):(e.orderErr.textContent=Rt(V,{asset:t.base.symbol}),void jt.show(e.orderErr))}}},{key:"showDeposit",value:(c=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.depositAddrForm.setAsset(t),this.showForm(this.page.deposit);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"handlePriceUpdate",value:function(e){e.host===this.market.dex.host&&e.spots[this.market.cfg.name]&&this.setCurrMarketPrice(),this.marketList.updateSpots(e)}},{key:"handleBondUpdate",value:(i=o(w().mark((function e(t){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=t.dex)===this.market.dex.host){e.next=3;break}return e.abrupt("return");case 3:if("AccountRegistered"!==t.topic){e.next=6;break}return e.next=6,Sn().fetchUser();case 6:this.market.dex=Sn().exchanges[n],this.setRegistrationStatusVisibility();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"handleMatchNote",value:function(e){var t=this.metaOrders[e.orderID];if(!t)return this.refreshActiveOrders();Sn().canAccelerateOrder(t.ord)?jt.show(t.details.accelerateBttn):jt.hide(t.details.accelerateBttn)}},{key:"handleOrderNote",value:function(e){var t=e.order,n=this.metaOrders[t.id];if(!n||"AsyncOrderFailure"===e.topic||"OrderLoaded"===e.topic&&t.readyToTick)return this.refreshActiveOrders();var r=n.status;n.ord=t,"MissedCancel"===e.topic&&jt.show(n.details.cancelBttn),t.filled===t.qty&&jt.hide(n.details.cancelBttn),Sn().canAccelerateOrder(t)?jt.show(n.details.accelerateBttn):jt.hide(n.details.accelerateBttn),this.updateMetaOrder(n),(r===Wn&&t.status===qn||r===qn&&t.status>qn)&&this.setDepthMarkers()}},{key:"handleEpochNote",value:function(e){if(Sn().log("book","handleEpochNote:",e),e.host===this.market.dex.host&&e.marketID===this.market.sid){this.book&&(this.book.setEpoch(e.epoch),this.depthChart.draw()),this.clearOrderTableEpochs();for(var t=0,n=Object.values(this.metaOrders);t<n.length;t++){var r=n[t],a=r.ord,o=r.details,s=r.header,i=e.epoch>a.epoch;switch(!0){case a.type===Ln&&a.status===Wn&&i:var c=a.tif===Mn?Rt(j):Rt(H);o.status.textContent=s.status.textContent=c,a.status=a.tif===Mn?Nn:qn;break;case a.type===Bn&&a.status===Wn:o.status.textContent=s.status.textContent=Rt(j),a.status=Nn}}}}},{key:"recentMatchesSortCompare",value:function(){var e=this;switch(this.recentMatchesSortKey){case"rate":return function(t,n){return e.recentMatchesSortDirection*(t.rate-n.rate)};case"qty":return function(t,n){return e.recentMatchesSortDirection*(t.qty-n.qty)};case"age":return function(t,n){return e.recentMatchesSortDirection*(t.stamp-n.stamp)}}}},{key:"refreshRecentMatchesTable",value:function(){var e=this.page,t=this.recentMatches;if(jt.empty(e.recentMatchesLiveList),t){var n=this.recentMatchesSortCompare();t.sort(n);var r,a=da(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e.recentMatchesTemplate.cloneNode(!0),i=jt.parseTemplate(s);Sn().bindTooltips(s),i.rate.textContent=jt.formatCoinValue(o.rate/this.market.rateConversionFactor),i.qty.textContent=jt.formatCoinValue(o.qty,this.market.baseUnitInfo),i.age.textContent=jt.timeSince(o.stamp),i.age.dataset.sinceStamp=String(o.stamp),s.classList.add(o.sell?"sellcolor":"buycolor"),e.recentMatchesLiveList.append(s)}}catch(e){a.e(e)}finally{a.f()}}}},{key:"addRecentMatches",value:function(e){this.recentMatches=[].concat(yn(e),yn(this.recentMatches)).slice(0,100)}},{key:"setBalanceVisibility",value:function(){var e=this.market;e&&e.dex&&this.balanceWgt.setBalanceVisibility(e.dex.connectionStatus===xn.Connected)}},{key:"handleBalanceNote",value:function(e){this.setBalanceVisibility(),this.preorderCache={};var t=this.market;if(t&&t.dex&&t.dex.connectionStatus===xn.Connected){var n=e.balance.available;switch(e.assetID){case t.baseCfg.id:if(!t.maxSell)break;"number"==typeof t.sellBalance&&t.sellBalance!==n&&(t.maxSell=null),this.isSell()&&this.preSell();break;case t.quoteCfg.id:if(!Object.keys(t.maxBuys).length)break;"number"==typeof t.buyBalance&&t.buyBalance!==n&&(t.maxBuys={}),this.isSell()||this.preBuy()}}}},{key:"submitOrder",value:(a=o(w().mark((function e(){var t,n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,jt.hide(t.orderErr,t.vErr),n=this.currentOrder,r=t.vPass.value,t.vPass.value="",a={order:Ma(n),pw:r},this.validateOrder(n)){e.next=8;break}return e.abrupt("return");case 8:return t.vSubmit.classList.add("d-hide"),t.vLoader.classList.remove("d-hide"),e.next=12,dn("/api/tradeasync",a);case 12:if(o=e.sent,t.vSubmit.classList.remove("d-hide"),t.vLoader.classList.add("d-hide"),Sn().checkResponse(o)){e.next=19;break}return t.vErr.textContent=o.msg,jt.show(t.vErr),e.abrupt("return");case 19:jt.hide(t.forms),this.refreshActiveOrders();case 21:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"createWallet",value:(r=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Sn().fetchUser();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:n=t.assets[this.currentCreate.id],jt.hide(this.page.forms),this.balanceWgt.updateAsset(n.id),jt.setVis(!(this.market.base.wallet&&this.market.quote.wallet),this.page.noWallet),this.resolveOrderFormVisibility();case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"walletUnlocked",value:(n=o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:jt.hide(this.page.forms),this.balanceWgt.updateAsset(this.openAsset.id);case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"lotChanged",value:function(){var e=this.page,t=parseInt(e.lotField.value||"0");if(t<=0)return e.lotField.value="0",e.qtyField.value="",void this.previewQuoteAmt(!1);var n=this.market.cfg.lotsize;e.lotField.value=String(t),e.qtyField.value=String(t*n/this.market.baseUnitInfo.conventional.conversionFactor),this.previewQuoteAmt(!0)}},{key:"quantityChanged",value:function(e){var t=this.page,n=this.parseOrder();if(n.qty<0)return t.lotField.value="0",t.qtyField.value="",void this.previewQuoteAmt(!1);var r=this.market.cfg.lotsize,a=Math.floor(n.qty/r),o=a*r;t.lotField.value=String(a),(n.isLimit||n.sell)&&(e&&(t.qtyField.value=String(o/this.market.baseUnitInfo.conventional.conversionFactor)),this.previewQuoteAmt(!0))}},{key:"marketBuyChanged",value:function(){var e=this.page,t=La(e.mktBuyField.value||"",this.market.quoteUnitInfo.conventional.conversionFactor),n=this.midGap();if(!n||!t)return e.mktBuyLots.textContent="0",void(e.mktBuyScore.textContent="0");var r=this.market.cfg.lotsize,a=t/n;e.mktBuyLots.textContent=(a/r).toFixed(1),e.mktBuyScore.textContent=jt.formatCoinValue(a,this.market.baseUnitInfo)}},{key:"rateFieldChanged",value:function(){var e=this.adjustedRate();if(e<=0)return this.depthLines.input=[],this.drawChartLines(),void(this.page.rateField.value="0");var t=this.parseOrder(),n=e/this.market.rateConversionFactor;this.page.rateField.value=String(n),this.depthLines.input=[{rate:n,color:t.sell?this.depthChart.theme.sellLine:this.depthChart.theme.buyLine}],this.drawChartLines(),this.previewQuoteAmt(!0)}},{key:"adjustedRate",value:function(){var e=this.page.rateField.value;if(!e)return NaN;var t=La(e,this.market.rateConversionFactor);return t-t%this.market.cfg.ratestep}},{key:"loadTable",value:function(){this.loadTableSide(!0),this.loadTableSide(!1)}},{key:"binOrdersByRateAndEpoch",value:function(e){if(!e||!e.length)return[];var t=[],n=[],r=[],a=e[0].msgRate;e[0].epoch?n.push(e[0]):r.push(e[0]);for(var o=1;o<e.length;o++)e[o].msgRate!==a&&(t.push(r),t.push(n),n=[],r=[],a=e[o].msgRate),e[o].epoch?n.push(e[o]):r.push(e[o]);return t.push(r),t.push(n),t.filter((function(e){return e.length>0}))}},{key:"loadTableSide",value:function(e){var t=this,n=e?this.book.sells:this.book.buys,r=e?this.page.sellRows:this.page.buyRows;jt.empty(r),n&&n.length&&this.binOrdersByRateAndEpoch(n).forEach((function(e){r.appendChild(t.orderTableRow(e))}))}},{key:"addTableOrder",value:function(e){var t=e.sell?this.page.sellRows:this.page.buyRows,n=t.firstChild;if(0!==e.rate){for(n&&0===n.manager.getRate()&&(n=n.nextSibling);n;){if(0===n.manager.compare(e))return void n.manager.insertOrder(e);if(n.manager.compare(e)>0){var r=this.orderTableRow([e]);return void t.insertBefore(r,n)}n=n.nextSibling}var a=this.orderTableRow([e]);t.appendChild(a)}else{if(0===e.qtyAtomic)return;n&&0===n.manager.getRate()?n.manager.insertOrder(e):(n=this.orderTableRow([e]),t.insertBefore(n,t.firstChild))}}},{key:"removeTableOrder",value:function(e){for(var t=e.token,n=0,r=[this.page.sellRows,this.page.buyRows];n<r.length;n++)for(var a=r[n],o=0,s=Array.from(a.children);o<s.length;o++)if(s[o].manager.removeOrder(t))return}},{key:"updateTableOrder",value:function(e){for(var t=0,n=[this.page.sellRows,this.page.buyRows];t<n.length;t++)for(var r=n[t],a=0,o=Array.from(r.children);a<o.length;a++)if(o[a].manager.updateOrderQty(e))return}},{key:"clearOrderTableEpochs",value:function(){this.clearOrderTableEpochSide(this.page.sellRows),this.clearOrderTableEpochSide(this.page.buyRows)}},{key:"clearOrderTableEpochSide",value:function(e){for(var t=0,n=Array.from(e.children);t<n.length;t++)n[t].manager.removeEpochOrders()}},{key:"orderTableRow",value:function(e){var t=this,n=this.page.rowTemplate.cloneNode(!0),r=this.market,a=r.baseUnitInfo,o=r.rateConversionFactor,s=new Wa(n,e,a,o);return n.manager=s,fa(n,"click",(function(){t.reportDepthClick(n.manager.getRate()/o)})),0!==n.manager.getRate()&&jt.bind(n,"mouseenter",(function(){var e=t.depthChart;t.depthLines.hover=[{rate:n.manager.getRate()/o,color:n.manager.isSell()?e.theme.sellLine:e.theme.buyLine}],t.drawChartLines()})),n}},{key:"handleConnNote",value:(t=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.marketList.setConnectionStatus(t),t.connectionStatus!==xn.Connected){e.next=6;break}return e.next=4,Sn().fetchUser();case 4:return e.next=6,Sn().loadPage("markets");case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"filterMarkets",value:function(){var e,t=null===(e=this.page.marketSearchV1.value)||void 0===e?void 0:e.toLowerCase(),n=t?function(e){return e.name.includes(t)}:function(){return!0};this.marketList.setFilter(n)}},{key:"drawChartLines",value:function(){this.depthChart.setLines([].concat(yn(this.depthLines.hover),yn(this.depthLines.input))),this.depthChart.draw()}},{key:"candleDurationSelected",value:function(e){var t,n;null!==(t=this.market)&&void 0!==t&&null!==(n=t.dex)&&void 0!==n&&n.candleDurs.includes(e)||(e="1h"),this.candleDur=e,this.loadCandles(),nn.storeLocal(nn.lastCandleDurationLK,e)}},{key:"loadCandles",value:function(){var e,t=da(jt.kids(this.page.durBttnBox));try{for(t.s();!(e=t.n()).done;){var n=e.value;n.textContent===this.candleDur?n.classList.add("selected"):n.classList.remove("selected")}}catch(e){t.e(e)}finally{t.f()}var r=this.market,a=r.candleCaches,o=r.cfg,s=r.baseUnitInfo,i=r.quoteUnitInfo,c=a[this.candleDur];c?this.candleChart.setCandles(c,o,s,i):this.requestCandles()}},{key:"requestCandles",value:function(e){var t=this;this.candlesLoading={loaded:function(){},timer:window.setTimeout((function(){t.candlesLoading&&(t.candlesLoading=null,console.error("candles not received"))}),1e4)};var n=this.market,r=n.dex,a=n.baseCfg,o=n.quoteCfg;la.request("loadcandles",{host:r.host,base:a.id,quote:o.id,dur:e||this.candleDur})}},{key:"unload",value:function(){la.request("unmarket",{}),la.deregisterRoute(ma),la.deregisterRoute(va),la.deregisterRoute(ya),la.deregisterRoute(ga),la.deregisterRoute(ba),la.deregisterRoute(wa),la.deregisterRoute(ka),this.depthChart.unattach(),this.candleChart.unattach(),jt.unbind(document,"keyup",this.keyup),clearInterval(this.secondTicker)}}]),R}(ln),Ra=function(){function e(t){s(this,e),h(this,"div",void 0),h(this,"rowTmpl",void 0),h(this,"markets",void 0),h(this,"selected",void 0),this.div=t,this.rowTmpl=jt.idel(t,"marketTmplV1"),jt.cleanTemplates(this.rowTmpl),this.reloadMarketsPane()}return u(e,[{key:"updateSpots",value:function(e){var t,n=da(this.markets);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.mkt.xc.host===e.host){if(!e.spots[r.mkt.name])return;var a=Sn().exchanges[r.mkt.xc.host],o=a.markets[r.mkt.name];_a(r.tmpl,a,o)}}}catch(e){n.e(e)}finally{n.f()}}},{key:"reloadMarketsPane",value:function(){jt.empty(this.div),this.markets=[];for(var e,t,n,r,a,o=0,s=function(){for(var e=[],t=Sn().assets,n=function(e,n){return n.map((function(n){var r=t[n.baseid],a=r?r.name:n.basesymbol,o=Sn().unitInfo(n.baseid,e);return Object.assign({xc:e,baseName:a,bui:o},n)}))},r=0,a=Object.values(Sn().exchanges);r<a.length;r++){var o=a[r];e.push.apply(e,yn(n(o,Object.values(o.markets||{}))))}return e.sort((function(e,t){if(!e.spot)return t.spot?1:e.name===t.name?e.xc.host.localeCompare(t.xc.host):e.name.localeCompare(t.name);if(!t.spot)return-1;var n=e.spot.vol24/e.lotsize;return t.spot.vol24/t.lotsize-n})),e}();o<s.length;o++){var i=s[o];this.markets.push((e=i,void 0,void 0,void 0,void 0,t=Sn().unitInfo(e.baseid,e.xc),n=Sn().unitInfo(e.quoteid,e.xc),r=jn/t.conventional.conversionFactor*n.conventional.conversionFactor,a=new Da(this.rowTmpl,e,r),this.div.appendChild(a.node),a))}Sn().bindTooltips(this.div)}},{key:"find",value:function(e,t,n){var r,a=da(this.markets);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.mkt.xc.host===e&&o.mkt.baseid===t&&o.mkt.quoteid===n)return o}}catch(e){a.e(e)}finally{a.f()}return null}},{key:"exists",value:function(e,t,n){return null!==this.find(e,t,n)}},{key:"first",value:function(){return this.markets[0]}},{key:"select",value:function(e,t,n){var r=this.find(e,t,n);if(!r)return console.error("select: no market row for ".concat(e,", ").concat(t,"-").concat(n));var a,o=da(this.markets);try{for(o.s();!(a=o.n()).done;)a.value.node.classList.remove("selected")}catch(e){o.e(e)}finally{o.f()}this.selected=r,this.selected.node.classList.add("selected")}},{key:"setConnectionStatus",value:function(e){var t,n=da(this.markets);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.mkt.xc.host===e.host&&(e.connectionStatus===xn.Connected?jt.hide(r.tmpl.disconnectedIco):jt.show(r.tmpl.disconnectedIco))}}catch(e){n.e(e)}finally{n.f()}}},{key:"setFilter",value:function(e){var t,n=da(this.markets);try{for(n.s();!(t=n.n()).done;){var r=t.value;e(r)?jt.show(r.node):jt.hide(r.node)}}catch(e){n.e(e)}finally{n.f()}}}]),e}(),Da=u((function e(t,n,r){s(this,e),h(this,"node",void 0),h(this,"mkt",void 0),h(this,"name",void 0),h(this,"baseID",void 0),h(this,"quoteID",void 0),h(this,"lotSize",void 0),h(this,"rateStep",void 0),h(this,"tmpl",void 0),h(this,"rateConversionFactor",void 0),this.mkt=n,this.name=n.name,this.baseID=n.baseid,this.quoteID=n.quoteid,this.lotSize=n.lotsize,this.rateStep=n.ratestep,this.rateConversionFactor=r,this.node=t.cloneNode(!0);var a,o,i,c,l=this.tmpl=jt.parseTemplate(this.node);l.baseIcon.src=jt.logoPath(n.basesymbol),l.quoteIcon.src=jt.logoPath(n.quotesymbol),l.baseSymbol.appendChild(jt.symbolize(n.basesymbol)),l.quoteSymbol.appendChild(jt.symbolize(n.quotesymbol)),l.baseName.textContent=n.baseName,l.host.textContent=n.xc.host,l.host.style.color=(i=n.xc.host,(c=Object.keys(Sn().exchanges)).sort(),a=c.indexOf(i),o=za[a%za.length],"hsl(".concat(360*o,", 35%, 50%)")),l.host.dataset.tooltip=n.xc.host,_a(l,n.xc,n),this.mkt.xc.connectionStatus!==xn.Connected&&jt.show(l.disconnectedIco)})),Oa=function(){function e(t,n){var r=this;s(this,e),h(this,"base",void 0),h(this,"quote",void 0),h(this,"dex",void 0),jt.hide(t,n);var a=jt.parseTemplate(t);this.base={id:0,parentID:Fa,cfg:null,node:t,tmpl:a,iconBox:a.walletState,stateIcons:new Kt(a.walletState)},a.balanceRowTmpl.remove();var o=jt.parseTemplate(n);this.quote={id:0,parentID:Fa,cfg:null,node:n,tmpl:o,iconBox:o.walletState,stateIcons:new Kt(o.walletState)},o.balanceRowTmpl.remove(),Sn().registerNoteFeeder({balance:function(e){r.updateAsset(e.assetID)},walletstate:function(e){r.updateAsset(e.wallet.assetID)},createwallet:function(e){r.updateAsset(e.assetID)}})}return u(e,[{key:"setBalanceVisibility",value:function(e){e?jt.show(this.base.node,this.quote.node):jt.hide(this.base.node,this.quote.node)}},{key:"setWallets",value:function(e,t,n){var r=function(e){var t=Sn().assets[e];return null!=t&&t.token?t.token.parentID:Fa};this.dex=Sn().user.exchanges[e],this.base.id=t,this.base.parentID=r(t),this.base.cfg=this.dex.assets[t],this.quote.id=n,this.quote.parentID=r(n),this.quote.cfg=this.dex.assets[n],this.updateWallet(this.base),this.updateWallet(this.quote)}},{key:"updateWallet",value:function(e){var t=e.cfg,n=e.tmpl,r=e.iconBox,a=e.stateIcons,o=e.id;if(t){var s=Sn().assets[o];if(jt.hide(n.newWalletRow,n.expired,n.unsupported,n.connect,n.spinner,n.walletState,n.balanceRows,n.walletAddr),n.logo.src=jt.logoPath(t.symbol),n.addWalletSymbol.textContent=t.symbol.toUpperCase(),jt.empty(n.symbol),n.symbol.appendChild(jt.symbolize(t.symbol)),s){jt.show(r);var i=s.wallet;if(a.readWallet(i),!i)return s.walletCreationPending?void jt.show(n.spinner):void jt.show(n.newWalletRow);jt.show(n.walletAddr);var c=i.balance;if(c||i.running||i.disabled){if(!c)return Sn().fetchBalance(o),void jt.show(n.spinner);jt.show(n.balanceRows),jt.empty(n.balanceRows);var l=function(t,r,a,o){var s=n.balanceRowTmpl.cloneNode(!0);n.balanceRows.appendChild(s);var i=jt.parseTemplate(s);i.title.textContent=t,i.bal.textContent=jt.formatCoinValue(r,a),o&&(i.bal.append(o),e.parentBal=i.bal)};if(l(Rt(Re),c.available,s.unitInfo),l(Rt(De),c.locked+c.contractlocked+c.bondlocked,s.unitInfo),l(Rt(Oe),c.immature,s.unitInfo),s.token){var u=Sn().assets[s.token.parentID],h=u.wallet.balance,d=u.unitInfo,p=u.symbol,f=document.createElement("img");f.src=jt.logoPath(p),f.classList.add("micro-icon"),l(Rt(Te),h.available,d,f)}(new Date).getTime()-new Date(c.stamp).getTime()>36e5&&!i.disabled?(jt.show(n.expired),i.running&&Sn().fetchBalance(o)):jt.hide(n.expired)}else jt.show(n.connect)}else jt.show(n.unsupported)}}},{key:"updateParent",value:function(e){var t,n=Sn().assets[e.parentID],r=n.wallet.balance,a=n.unitInfo;null!==(t=e.parentBal)&&void 0!==t&&t.firstChild&&(e.parentBal.firstChild.textContent=jt.formatCoinValue(r.available,a))}},{key:"updateAsset",value:function(e){e===this.base.id?this.updateWallet(this.base):e===this.quote.id&&this.updateWallet(this.quote),e===this.base.parentID&&this.updateParent(this.base),e===this.quote.parentID&&this.updateParent(this.quote)}}]),e}();function Ta(e,t,n){return{host:e,base:t,quote:n}}function Pa(e,t){return"".concat(e,"_").concat(t)}function La(e,t){return e?Math.round(parseFloat(e)*t):0}function Ba(e,t){e.classList.remove("selected"),t.classList.add("selected")}function Ma(e){for(var t={},n=0,a=Object.entries(e.options);n<a.length;n++){var o=r(a[n],2),s=o[0],i=o[1];t[s]=JSON.stringify(i)}return Object.assign({},e,{options:t})}var Wa=function(){function e(t,n,r,a){s(this,e),h(this,"tableRow",void 0),h(this,"orderBin",void 0),h(this,"sell",void 0),h(this,"msgRate",void 0),h(this,"epoch",void 0),h(this,"baseUnitInfo",void 0),h(this,"rateConversionFactor",void 0),this.tableRow=t,this.orderBin=n,this.sell=n[0].sell,this.msgRate=n[0].msgRate,this.epoch=!!n[0].epoch,this.baseUnitInfo=r,this.rateConversionFactor=a,this.setRateEl(),this.setEpochEl(),this.updateQtyNumOrdersEl()}return u(e,[{key:"setEpochEl",value:function(){var e=jt.tmplElement(this.tableRow,"epoch");this.isEpoch()&&e.appendChild(xa.cloneNode())}},{key:"setRateEl",value:function(){var e=jt.tmplElement(this.tableRow,"rate");if(0===this.msgRate)e.innerText="market";else{var t=this.isSell()?"sellcolor":"buycolor";e.innerText=jt.formatFullPrecision(this.msgRate/this.rateConversionFactor),e.classList.add(t)}}},{key:"updateQtyNumOrdersEl",value:function(){var e=this.orderBin.reduce((function(e,t){return e+t.qtyAtomic}),0),t=this.orderBin.length,n=jt.tmplElement(this.tableRow,"qty"),r=jt.tmplElement(this.tableRow,"numorders");n.innerText=jt.formatFullPrecision(e,this.baseUnitInfo),t>1?(r.removeAttribute("hidden"),r.innerText=String(t),r.title="quantity is comprised of ".concat(t," orders")):r.setAttribute("hidden","true")}},{key:"insertOrder",value:function(e){this.orderBin.push(e),this.updateQtyNumOrdersEl()}},{key:"updateOrderQty",value:function(e){for(var t=e.token,n=e.qty,r=e.qtyAtomic,a=0;a<this.orderBin.length;a++)if(this.orderBin[a].token===t)return this.orderBin[a].qty=n,this.orderBin[a].qtyAtomic=r,this.updateQtyNumOrdersEl(),!0;return!1}},{key:"removeOrder",value:function(e){var t=this.orderBin.findIndex((function(t){return t.token===e}));return!(t<0||(this.orderBin.splice(t,1),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove(),0))}},{key:"removeEpochOrders",value:function(e){this.orderBin=this.orderBin.filter((function(t){return!(t.epoch&&t.epoch!==e)})),this.orderBin.length?this.updateQtyNumOrdersEl():this.tableRow.remove()}},{key:"getRate",value:function(){return this.msgRate}},{key:"isEpoch",value:function(){return this.epoch}},{key:"isSell",value:function(){return this.sell}},{key:"compare",value:function(e){return this.getRate()===e.msgRate&&this.isEpoch()===!!e.epoch?0:this.getRate()!==e.msgRate?this.getRate()>e.msgRate===e.sell?1:-1:this.isEpoch()?1:-1}}]),e}(),qa=new Intl.NumberFormat(jt.languages(),{maximumSignificantDigits:4}),Na=new Intl.NumberFormat(jt.languages(),{minimumFractionDigits:1,maximumFractionDigits:1});function Ua(e){return e>=1e3||Math.round(e)===e?Na.format(e):qa.format(e)}function _a(e,t,n){if(n.spot){e.price.textContent=Ua(Sn().conventionalRate(n.baseid,n.quoteid,n.spot.rate,t));var r=n.spot.change24>0?"+":"";e.change.classList.remove("buycolor","sellcolor"),e.change.classList.add(n.spot.change24>=0?"buycolor":"sellcolor"),e.change.textContent="".concat(r).concat((100*n.spot.change24).toFixed(1),"%")}}var za=[.5,1/4,3/4,1/8,5/8,3/8,7/8];function Va(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ja(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ja(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function ja(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ha,Ga,Ka,Xa,Qa,Ya,Ja,Za,$a=function(e){on(p,e);var t,n,r,a,i,c,l,d=(c=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(c);if(l){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function p(e){var t;s(this,p),h(rn(t=d.call(this)),"main",void 0),h(rn(t),"offset",void 0),h(rn(t),"loading",void 0),h(rn(t),"currentForm",void 0),h(rn(t),"orderTmpl",void 0),h(rn(t),"filterState",void 0),h(rn(t),"page",void 0),t.main=e,t.offset="",t.loading=!1;var n=t.page=jt.idDescendants(e);t.orderTmpl=n.rowTmpl,t.orderTmpl.remove();var r=t.filterState={hosts:[],assets:[],statuses:[]},a=new URLSearchParams(window.location.search),o=function(e,t){var n=a.get(t);if(n&&0!==n.length){var o=n.split(",");n&&(r[t]=o),e.querySelectorAll("input").forEach((function(e){o.indexOf(e.value)>=0&&(e.checked=!0)}))}};o(n.hostFilter,"hosts"),o(n.assetFilter,"assets"),o(n.statusFilter,"statuses");var i=[],c=function(e,n){var a=e.querySelector(".apply-bttn");i.push(a),jt.bind(a,"click",(function(){t.submitFilter(),i.forEach((function(e){return jt.hide(e)}))})),e.querySelectorAll("input").forEach((function(t){jt.bind(t,"change",(function(){!function(e,t){if(e.length!==t.length)return!1;var n,r=Va(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(-1===t.indexOf(a))return!1}}catch(e){r.e(e)}finally{r.f()}return!0}(eo(e),r[n])?jt.show(a):jt.hide(a)}))}))};return c(n.hostFilter,"hosts"),c(n.assetFilter,"assets"),c(n.statusFilter,"statuses"),jt.bind(t.main,"scroll",(function(){t.loading||n.ordersTable.offsetHeight-t.main.offsetHeight-t.main.scrollTop<0&&t.nextPage()})),n.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){jt.hide(n.forms)}))})),jt.bind(n.forms,"mousedown",(function(e){jt.mouseInElement(e,t.currentForm)||jt.hide(n.forms)})),jt.bind(n.exportOrders,"click",(function(){t.exportOrders()})),n.showArchivedDateField.addEventListener("change",(function(){n.showArchivedDateField.checked?jt.show(n.archivedDateField):jt.hide(n.archivedDateField,n.deleteArchivedRecordsErr)})),jt.bind(n.deleteArchivedRecords,"click",(function(){var e=t.page;e.showArchivedDateField.checked=!1,e.saveMatchesToFile.checked=!1,e.saveOrdersToFile.checked=!1,e.deleteArchivedRecordsErr.textContent="",e.archivedRecordsLocation.textContent="",e.deleteArchivedRecordsMsg.textContent="",jt.hide(e.deleteArchivedResult,e.deleteArchivedRecordsErr,e.deleteArchivedRecordsMsg,e.archivedRecordsLocation,e.archivedDateField),t.showForm(e.deleteArchivedRecordsForm)})),jt.bind(n.deleteArchivedRecordsSubmit,"click",(function(){var e=0;n.showArchivedDateField.checked&&(e=Date.parse(n.olderThan.value||""),isNaN(e)||e<=0)?jt.showFormError(n.deleteArchivedRecordsErr,Rt(qe)):t.deleteArchivedRecords(e)})),t.submitFilter(),t}return u(p,[{key:"showForm",value:(i=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,jt.hide(n.deleteArchivedRecordsForm),t.style.right="10000px",jt.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,jt.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0px";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setOrders",value:function(e){jt.empty(this.page.tableBody),this.appendOrders(e)}},{key:"appendOrders",value:function(e){var t,n=this,r=this.page.tableBody,a=Va(e);try{var o=function(){var e,a,o,s=t.value,i=n.orderTmpl.cloneNode(!0),c=function(e,t){jt.tmplElement(i,e).textContent=t},l="".concat(s.baseSymbol.toUpperCase(),"-").concat(s.quoteSymbol.toUpperCase());c("host","".concat(l," @ ").concat(s.host));var u="",h=[Sn().unitInfo(s.baseID),Sn().unitInfo(s.quoteID)],d=h[0],p=h[1];if(s.sell){var f=[s.baseSymbol,s.quoteSymbol];e=f[0],a=f[1],o=jt.formatCoinValue(s.qty,d),s.type===Ln&&(u=jt.formatCoinValue(s.qty/jn*s.rate,p))}else{var m=[s.quoteSymbol,s.baseSymbol];e=m[0],a=m[1],s.type===Bn?o=jt.formatCoinValue(s.qty,d):(o=jt.formatCoinValue(s.qty/jn*s.rate,p),u=jt.formatCoinValue(s.qty,d))}c("fromQty",o),jt.tmplElement(i,"fromLogo").src=jt.logoPath(e),c("fromSymbol",e),c("toQty",u),jt.tmplElement(i,"toLogo").src=jt.logoPath(a),c("toSymbol",a),c("type","".concat(Gn(s)," ").concat(Hn(s))),c("rate",jt.formatCoinValue(Sn().conventionalRate(s.baseID,s.quoteID,s.rate))),c("status",Qn(s)),c("filled","".concat((Yn(s)/s.qty*100).toFixed(1),"%")),c("settled","".concat((Jn(s)/s.qty*100).toFixed(1),"%"));var v=new Date(s.submitTime).toLocaleString();c("time","".concat(jt.timeSince(s.submitTime)," ago, ").concat(v)),jt.tmplElement(i,"link").href="order/".concat(s.id),Sn().bindInternalNavigation(i),r.appendChild(i)};for(a.s();!(t=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}50===e.length?this.offset=e[e.length-1].id:this.offset=""}},{key:"submitFilter",value:(a=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,this.offset="",(n=this.filterState).hosts=eo(t.hostFilter),n.assets=eo(t.assetFilter).map((function(e){return parseInt(e)})),n.statuses=eo(t.statusFilter).map((function(e){return parseInt(e)})),e.t0=this,e.next=9,this.fetchOrders();case 9:e.t1=e.sent,e.t0.setOrders.call(e.t0,e.t1);case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"fetchOrders",value:(r=o(w().mark((function e(){var t,n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Sn().loading(this.main),e.next=3,dn("/api/orders",this.currentFilter());case 3:return n=e.sent,t(),e.abrupt("return",n.orders);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"exportOrders",value:function(){this.offset="";var e=this.currentFilter(),t=new URL(window.location.href),n=new URLSearchParams(""),r=function(t){e[t].forEach((function(e){n.append(t,e)}))};r("hosts"),r("assets"),r("statuses"),t.search=n.toString(),t.pathname="/orders/export",window.open(t.toString())}},{key:"deleteArchivedRecords",value:(n=o(w().mark((function e(t){var n,r,a,o,s,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,r=n.saveMatchesToFile.checked||!1,a=n.saveOrdersToFile.checked||!1,o={olderThanMs:t,saveMatchesToFile:r,saveOrdersToFile:a},s=Sn().loading(this.main),e.next=7,dn("/api/deletearchivedrecords",o);case 7:if(i=e.sent,s(),Sn().checkResponse(i)){e.next=11;break}return e.abrupt("return",jt.showFormError(n.deleteArchivedRecordsErr,i.msg));case 11:i.archivedRecordsDeleted>0?(n.deleteArchivedRecordsMsg.textContent=Rt(Ue,{nRecords:i.archivedRecordsDeleted}),(r||a)&&(n.archivedRecordsLocation.textContent=Rt(_e,{path:i.archivedRecordsPath}),jt.show(n.archivedRecordsLocation)),this.submitFilter()):n.deleteArchivedRecordsMsg.textContent=Rt(Ne),jt.show(n.deleteArchivedResult,n.deleteArchivedRecordsMsg);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"currentFilter",value:function(){var e=this.filterState;return{hosts:e.hosts,assets:e.assets.map((function(e){return parseInt(e)})),statuses:e.statuses.map((function(e){return parseInt(e)})),n:50,offset:this.offset}}},{key:"nextPage",value:(t=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==this.offset&&!this.loading){e.next=2;break}return e.abrupt("return");case 2:return this.loading=!0,jt.show(this.page.orderLoader),e.next=6,this.fetchOrders();case 6:t=e.sent,this.loading=!1,jt.hide(this.page.orderLoader),this.appendOrders(t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),p}(ln);function eo(e){var t=[];return e.querySelectorAll("input").forEach((function(e){e.checked&&t.push(e.value)})),t}function to(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return no(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?no(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function no(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ro,ao="TakerFoundMakerRedemption:",oo=function(e){on(p,e);var t,n,r,a,i,c,l,d=(c=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(c);if(l){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function p(e){var t;s(this,p),h(rn(t=d.call(this)),"orderID",void 0),h(rn(t),"order",void 0),h(rn(t),"page",void 0),h(rn(t),"currentForm",void 0),h(rn(t),"secondTicker",void 0),h(rn(t),"refreshOnPopupClose",void 0),h(rn(t),"accelerateOrderForm",void 0),h(rn(t),"stampers",void 0);var n=t.page=jt.idDescendants(e);t.stampers=jt.applySelector(e,"[data-stamp]"),ro=parseInt(e.dataset.net||""),t.orderID=e.dataset.oid||"",jt.cleanTemplates(n.matchCardTmpl);var r=function(){var e,n=to(t.stampers);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.textContent=jt.timeSince(parseInt(r.dataset.stamp||""))}}catch(e){n.e(e)}finally{n.f()}};return r(),n.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){t.refreshOnPopupClose?window.location.replace(window.location.href):jt.hide(n.forms)}))})),e.querySelectorAll("[data-explorer-id]").forEach((function(e){ho(parseInt(e.dataset.explorerId||""),e)})),n.cancelBttn&&jt.bind(n.cancelBttn,"click",(function(){t.showForm(n.cancelForm)})),jt.bind(n.accelerateBttn,"click",(function(){t.showAccelerateForm()})),An(n),t.accelerateOrderForm=new Br(n.accelerateForm,(function(){t.refreshOnPopupClose=!0})),jt.cleanTemplates(n.booleanOptTmpl,n.rangeOptTmpl,n.orderOptTmpl),jt.bind(n.forms,"mousedown",(function(e){if(!jt.mouseInElement(e,t.currentForm)){if(t.refreshOnPopupClose)return void window.location.reload();jt.hide(n.forms),n.cancelPass.value=""}})),Vr(n.cancelForm,n.cancelSubmit,o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.submitCancel();case 1:case"end":return e.stop()}}),e)})))),t.secondTicker=window.setInterval((function(){r()}),1e4),Sn().registerNoteFeeder({order:function(e){t.handleOrderNote(e)},match:function(e){t.handleMatchNote(e)}}),t.start(),t}return u(p,[{key:"start",value:(i=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=Sn().order(this.orderID))){e.next=5;break}this.order=t,e.next=8;break;case 5:return e.next=7,this.fetchOrder();case 7:t=e.sent;case 8:this.page.mktBaseSymbol.replaceWith(jt.symbolize(t.baseSymbol)),this.page.mktQuoteSymbol.replaceWith(jt.symbolize(t.quoteSymbol)),this.setAccelerationButtonVis(),this.showMatchCards();case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"unload",value:function(){clearInterval(this.secondTicker)}},{key:"fetchOrder",value:(a=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dn("/api/order",this.orderID);case 2:if(t=e.sent,Sn().checkResponse(t)){e.next=5;break}throw t.msg;case 5:return this.order=t.order,e.abrupt("return",this.order);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setImmutableMatchCardElements",value:function(e,t){var n=jt.parseTemplate(e);n.matchID.textContent=t.matchID;var r=new Date(t.stamp);n.matchTime.textContent=r.toLocaleTimeString("en-GB",{year:"numeric",month:"short",day:"numeric"}),n.matchTimeAgo.dataset.stamp=t.stamp.toString(),n.matchTimeAgo.textContent=jt.timeSince(t.stamp),this.stampers.push(n.matchTimeAgo);var a=function(e,t){var n=t.qty;return Kn(e)&&(n=Zn(t.rate,t.qty)),(n/e.qty*100).toFixed(1)+" %"}(this.order,t),o=jt.bipSymbol(this.order.baseID),s=jt.bipSymbol(this.order.quoteID),i=Sn().unitInfo(this.order.baseID),c=Sn().unitInfo(this.order.quoteID),l=Zn(t.rate,t.qty);if(t.isCancel)return jt.show(n.cancelInfoDiv),jt.hide(n.infoDiv,n.status,n.statusHdr),this.order.sell?(n.cancelAmount.textContent=jt.formatCoinValue(t.qty,i),n.cancelIcon.src=jt.logoPathFromID(this.order.baseID)):(n.cancelAmount.textContent=jt.formatCoinValue(l,c),n.cancelIcon.src=jt.logoPathFromID(this.order.quoteID)),void(n.cancelOrderPortion.textContent=a);jt.show(n.infoDiv),jt.hide(n.cancelInfoDiv),n.orderPortion.textContent=a,t.side===zn?(n.side.textContent=Rt(mt),jt.show(n.makerSwapYou,n.makerRedeemYou,n.takerSwapThem,n.takerRedeemThem),jt.hide(n.takerSwapYou,n.takerRedeemYou,n.makerSwapThem,n.makerRedeemThem)):(n.side.textContent=Rt(ft),jt.hide(n.makerSwapYou,n.makerRedeemYou,n.takerSwapThem,n.takerRedeemThem),jt.show(n.takerSwapYou,n.takerRedeemYou,n.makerSwapThem,n.makerRedeemThem)),t.side===zn&&this.order.sell||t.side===Vn&&!this.order.sell?(n.makerSwapAsset.textContent=o,n.takerSwapAsset.textContent=s,n.makerRedeemAsset.textContent=s,n.takerRedeemAsset.textContent=o):(n.makerSwapAsset.textContent=s,n.takerSwapAsset.textContent=o,n.makerRedeemAsset.textContent=o,n.takerRedeemAsset.textContent=s);var u=Sn().conventionalRate(this.order.baseID,this.order.quoteID,t.rate);n.rate.textContent="".concat(u," ").concat(o,"/").concat(s),this.order.sell?(n.refundAsset.textContent=o,n.fromAmount.textContent=jt.formatCoinValue(t.qty,i),n.toAmount.textContent=jt.formatCoinValue(l,c),n.fromIcon.src=jt.logoPathFromID(this.order.baseID),n.toIcon.src=jt.logoPathFromID(this.order.quoteID)):(n.refundAsset.textContent=s,n.fromAmount.textContent=jt.formatCoinValue(l,c),n.toAmount.textContent=jt.formatCoinValue(t.qty,i),n.fromIcon.src=jt.logoPathFromID(this.order.quoteID),n.toIcon.src=jt.logoPathFromID(this.order.baseID))}},{key:"setMutableMatchCardElements",value:function(e,t){if(!t.isCancel){var n=jt.parseTemplate(e);n.status.textContent=function(e){if(e.revoked)return e.active?e.redeem?$n($e):e.side===zn?$n(rt):e.counterRedeem?$n(at):$n(rt):e.refund?$n(nt):e.redeem?$n(et):$n(ot);switch(e.status){case 0:return Rt(Qe);case 1:return Rt(Ye);case 2:return Rt(Je);case Un:return e.side===zn?Rt($e):Rt(Ze);case _n:return Rt($e);case 5:return Rt(et)}return Rt($)}(t);var r=function(e,t,r){var a=n[t],o=n[e];if(!r)return jt.show(n[e]),void jt.hide(n[t]);a.textContent=function(e){if(e.startsWith(ao)){var t=e.substring(26);return Rt(st,{makerAddr:t})}return e}(r.stringID),a.dataset.explorerCoin=r.stringID,ho(r.assetID,a),jt.hide(o),jt.show(a)};if(r("makerSwapPending","makerSwapCoin",io(t)),r("takerSwapPending","takerSwapCoin",co(t)),r("makerRedeemPending","makerRedeemCoin",lo(t)),r("takerRedeemPending","takerRedeemCoin",uo(t)),r("refundPending","refundCoin",t.refund),1!==t.status||t.revoked||t.refund)if(2!==t.status||t.revoked||t.refund)!function(e){return e.status<5&&e.side===zn&&e.status>=Un}(t)||t.revoked||t.refund?!function(e){return e.status<5&&e.side===Vn&&e.status>=_n}(t)||t.revoked||t.refund?jt.hide(n.makerSwapMsg,n.takerSwapMsg,n.makerRedeemMsg,n.takerRedeemMsg):(n.takerRedeemMsg.textContent=so(t.redeem),jt.hide(n.makerSwapMsg,n.takerSwapMsg,n.makerRedeemMsg),jt.show(n.takerRedeemMsg)):(n.makerRedeemMsg.textContent=so(t.redeem),jt.hide(n.makerSwapMsg,n.takerSwapMsg,n.takerRedeemMsg),jt.show(n.makerRedeemMsg));else{var a=co(t);n.takerSwapMsg.textContent=so(a),jt.hide(n.makerSwapMsg,n.makerRedeemMsg,n.takerRedeemMsg),jt.show(n.takerSwapMsg)}else{var o=io(t);n.makerSwapMsg.textContent=so(o),jt.hide(n.takerSwapMsg,n.makerRedeemMsg,n.takerRedeemMsg),jt.show(n.makerSwapMsg)}jt.setVis(!t.isCancel&&(io(t)||!t.revoked),n.makerSwap),jt.setVis(!t.isCancel&&(co(t)||!t.revoked),n.takerSwap),jt.setVis(!t.isCancel&&(lo(t)||!t.revoked),n.makerRedeem),jt.setVis(!t.isCancel&&(uo(t)||!t.revoked&&t.active||t.side===Vn&&t.active&&(t.counterRedeem||!t.refund)),n.takerRedeem),jt.setVis(!t.isCancel&&(t.refund||t.revoked&&t.active&&!t.counterRedeem),n.refund)}}},{key:"addNewMatchCard",value:function(e){var t=this.page,n=t.matchCardTmpl.cloneNode(!0);n.dataset.matchID=e.matchID,this.setImmutableMatchCardElements(n,e),this.setMutableMatchCardElements(n,e),t.matchBox.appendChild(n)}},{key:"showMatchCards",value:function(){var e=this,t=this.order;t&&t.matches&&(t.matches.sort((function(e,t){return e.stamp-t.stamp})),t.matches.forEach((function(t){return e.addNewMatchCard(t)})))}},{key:"showCancel",value:function(){var e=this.order,t=this.page,n=e.qty-e.filled,r=Kn(e)?Sn().assets[e.quoteID]:Sn().assets[e.baseID];t.cancelRemain.textContent=jt.formatCoinValue(n,r.unitInfo),t.cancelUnit.textContent=r.unitInfo.conventional.unit.toUpperCase(),this.showForm(t.cancelForm)}},{key:"showForm",value:(r=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,jt.hide(n.cancelForm,n.accelerateForm),t.style.right="10000px",jt.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,jt.animate(500,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0px";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"submitCancel",value:(n=o(w().mark((function e(){var t,n,r,a,o;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=this.order,r={orderID:n.id,pw:t.cancelPass.value},t.cancelPass.value="",a=Sn().loading(t.cancelForm),e.next=7,dn("/api/cancel",r);case 7:if(o=e.sent,a(),Sn().checkResponse(o)){e.next=11;break}return e.abrupt("return");case 11:t.status.textContent=Rt(G),jt.hide(t.forms),n.cancelling=!0;case 14:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setAccelerationButtonVis",value:function(){var e=this.order;if(e){var t=this.page;jt.setVis(Sn().canAccelerateOrder(e),t.accelerateBttn,t.actionsLabel)}}},{key:"showAccelerateForm",value:(t=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Sn().loading(this.page.accelerateBttn),this.accelerateOrderForm.refresh(this.order),t(),this.showForm(this.page.accelerateForm);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleOrderNote",value:function(e){var t=this.page,n=e.order;if(n.id===this.orderID){this.order=n;var r=t.cancelBttn;r&&n.status>qn&&jt.hide(r),t.status.textContent=Qn(n);var a,o=to(n.matches||[]);try{for(o.s();!(a=o.n()).done;){var s=a.value;this.processMatch(s)}}catch(e){o.e(e)}finally{o.f()}this.setAccelerationButtonVis()}}},{key:"handleMatchNote",value:function(e){e.orderID===this.orderID&&(this.processMatch(e.match),this.setAccelerationButtonVis())}},{key:"processMatch",value:function(e){var t,n=null,r=to(jt.applySelector(this.page.matchBox,".match-card"));try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.dataset.matchID===e.matchID){n=a;break}}}catch(e){r.e(e)}finally{r.f()}n?this.setMutableMatchCardElements(n,e):this.addNewMatchCard(e)}}]),p}(ln);function so(e){return e.confs&&0!==e.confs.required?"".concat(e.confs.count," / ").concat(e.confs.required," ").concat(Rt(pt)):""}function io(e){return e.side===zn?e.swap:e.counterSwap}function co(e){return e.side===zn?e.counterSwap:e.swap}function lo(e){return e.side===zn?e.redeem:e.counterRedeem}function uo(e){return e.side===zn?e.counterRedeem:e.redeem}function ho(e,t){var n=fo[e];if(n){var r=n[ro];r&&(t.classList.remove("plainlink"),t.classList.add("subtlelink"),t.href=r(t.dataset.explorerCoin||""))}}var po=(h(Ha={},0,(function(e){if(e.startsWith(ao)){var t=e.substring(26);return"https://etherscan.io/address/".concat(t)}return 42===e.length?"https://etherscan.io/address/".concat(e):"https://etherscan.io/tx/".concat(e)})),h(Ha,1,(function(e){if(e.startsWith(ao)){var t=e.substring(26);return"https://goerli.etherscan.io/address/".concat(t)}return 42===e.length?"https://goerli.etherscan.io/address/".concat(e):"https://goerli.etherscan.io/tx/".concat(e)})),Ha),fo={42:(Ga={},h(Ga,0,(function(e){var t=r(e.split(":"),2),n=t[0],a=t[1];return"https://explorer.dcrdata.org/tx/".concat(n,"/out/").concat(a)})),h(Ga,1,(function(e){var t=r(e.split(":"),2),n=t[0],a=t[1];return"https://testnet.dcrdata.org/tx/".concat(n,"/out/").concat(a)})),Ga),0:(Ka={},h(Ka,0,(function(e){return"https://mempool.space/tx/".concat(e.split(":")[0])})),h(Ka,1,(function(e){return"https://mempool.space/testnet/tx/".concat(e.split(":")[0])})),Ka),2:(Xa={},h(Xa,0,(function(e){return"https://ltc.bitaps.com/".concat(e.split(":")[0])})),h(Xa,1,(function(e){return"https://sochain.com/tx/LTCTEST/".concat(e.split(":")[0])})),Xa),20:(Qa={},h(Qa,0,(function(e){return"https://digiexplorer.info/tx/".concat(e.split(":")[0])})),h(Qa,1,(function(e){return"https://testnetexplorer.digibyteservers.io/tx/".concat(e.split(":")[0])})),Qa),60:po,60001:po,3:(Ya={},h(Ya,0,(function(e){return"https://dogeblocks.com/tx/".concat(e.split(":")[0])})),h(Ya,1,(function(e){return"https://blockexplorer.one/dogecoin/testnet/tx/".concat(e.split(":")[0])})),Ya),133:(Ja={},h(Ja,0,(function(e){return"https://zcashblockexplorer.com/transactions/".concat(e.split(":")[0])})),h(Ja,1,(function(e){return"https://blockexplorer.one/zcash/testnet/tx/".concat(e.split(":")[0])})),Ja),145:(Za={},h(Za,0,(function(e){return"https://bch.loping.net/tx/".concat(e.split(":")[0])})),h(Za,1,(function(e){return"https://tbch4.loping.net/tx/".concat(e.split(":")[0])})),Za)};var mo=function(e){on(g,e);var t,n,a,i,c,l,d,p,f,m,v,y=(m=g,v=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(m);if(v){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function g(e){var t;s(this,g),h(rn(t=y.call(this)),"body",void 0),h(rn(t),"forms",void 0),h(rn(t),"currentForm",void 0),h(rn(t),"page",void 0),h(rn(t),"host",void 0),h(rn(t),"keyup",void 0),h(rn(t),"dexAddrForm",void 0),t.body=e,t.host=e.dataset.host?e.dataset.host:"";var n=t.page=jt.idDescendants(e);t.forms=jt.applySelector(n.forms,":scope > form"),jt.bind(n.exportDexBtn,"click",(function(){return t.prepareAccountExport(n.authorizeAccountExportForm)})),jt.bind(n.disableAcctBtn,"click",(function(){return t.prepareAccountDisable(n.disableAccountForm)})),jt.bind(n.updateBondOptionsBtn,"click",(function(){return t.prepareUpdateBondOptions()})),jt.bind(n.updateCertBtn,"click",(function(){return n.certFileInput.click()})),jt.bind(n.updateHostBtn,"click",(function(){return t.prepareUpdateHost()})),jt.bind(n.certFileInput,"change",(function(){return t.onCertFileChange()})),t.dexAddrForm=new Mr(n.dexAddrForm,function(){var e=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location.assign("/dexsettings/".concat(t.host));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),void 0,t.host),Vr(n.updateBondOptionsForm,n.updateBondOptionsConfirm,(function(){return t.updateBondOptions()})),Vr(n.authorizeAccountExportForm,n.authorizeExportAccountConfirm,(function(){return t.exportAccount()})),Vr(n.disableAccountForm,n.disableAccountConfirm,(function(){return t.disableAccount()}));var r=function(){jt.hide(n.forms)};return jt.bind(n.forms,"mousedown",(function(e){jt.mouseInElement(e,t.currentForm)||r()})),t.keyup=function(e){"Escape"===e.key&&r()},jt.bind(document,"keyup",t.keyup),n.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){r()}))})),Sn().registerNoteFeeder({conn:function(){t.setConnectionStatus()}}),t.setConnectionStatus(),t}return u(g,[{key:"unload",value:function(){jt.unbind(document,"keyup",this.keyup)}},{key:"showForm",value:(f=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,this.currentForm=t,this.forms.forEach((function(e){return jt.hide(e)})),t.style.right="10000px",jt.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,jt.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"exportAccount",value:(p=o(w().mark((function e(){var t,n,r,a,o,s,i,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.exportAccountAppPass.value,r=t.exportAccountHost.textContent,t.exportAccountAppPass.value="",a={pw:n,host:r},o=Sn().loading(this.body),e.next=8,dn("/api/exportaccount",a);case 8:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=14;break}return t.exportAccountErr.textContent=s.msg,jt.show(t.exportAccountErr),e.abrupt("return");case 14:s.account.bonds=s.bonds,i=JSON.parse(JSON.stringify(s.account)),(c=document.createElement("a")).setAttribute("download","dcrAccount-"+r+".json"),c.setAttribute("href","data:text/json,"+JSON.stringify(i,null,2)),c.click(),jt.hide(t.forms);case 21:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"disableAccount",value:(d=o(w().mark((function e(){var t,n,r,a,o,s;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.page,n=t.disableAccountAppPW.value,r=t.disableAccountHost.textContent,t.disableAccountAppPW.value="",a={pw:n,host:r},o=Sn().loading(this.body),e.next=8,dn("/api/disableaccount",a);case 8:if(s=e.sent,o(),Sn().checkResponse(s)){e.next=14;break}return t.disableAccountErr.textContent=s.msg,jt.show(t.disableAccountErr),e.abrupt("return");case 14:jt.hide(t.forms),window.location.assign("/settings");case 16:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"prepareAccountExport",value:(l=o(w().mark((function e(t){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).exportAccountHost.textContent=this.host,n.exportAccountErr.textContent="",nn.passwordIsCached()?this.exportAccount():this.showForm(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"prepareAccountDisable",value:(c=o(w().mark((function e(t){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.page).disableAccountHost.textContent=this.host,n.disableAccountErr.textContent="",this.showForm(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"prepareUpdateBondOptions",value:(i=o(w().mark((function e(){var t,n,a,o,s,i,c,l;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.page,n=Sn().user.exchanges[this.host],t.bondTargetTier.setAttribute("placeholder",n.bondOptions.targetTier.toString()),jt.empty(t.bondAssetSelect),a=0,o=Object.entries(n.bondAssets);a<o.length;a++)s=r(o[a],2),i=s[0],c=s[1],(l=document.createElement("option")).value=c.id.toString(),l.textContent=i.toUpperCase(),c.id===n.bondOptions.bondAsset&&(l.selected=!0),t.bondAssetSelect.appendChild(l);t.bondOptionsErr.textContent="",jt.hide(t.bondOptionsErr),this.showForm(t.updateBondOptionsForm);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"prepareUpdateHost",value:(a=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.page,this.dexAddrForm.refresh(),this.showForm(t.dexAddrForm);case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onCertFileChange",value:(n=o(w().mark((function e(){var t,n,r,a,o,s;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.page,jt.hide(t.errMsg),!(n=t.certFileInput.files)||!n.length){e.next=7;break}return e.next=6,n[0].text();case 6:r=e.sent;case 7:if(r){e.next=9;break}return e.abrupt("return");case 9:return a={host:this.host,cert:r},o=Sn().loading(this.body),e.next=13,dn("/api/updatecert",a);case 13:s=e.sent,o(),Sn().checkResponse(s)?(jt.show(t.updateCertMsg),setTimeout((function(){jt.hide(t.updateCertMsg)}),5e3)):(t.errMsg.textContent=s.msg,jt.show(t.errMsg));case 16:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setConnectionStatus",value:function(){var e=this.page,t=Sn().user.exchanges[this.host],n=function(t){t?(jt.hide(e.disconnectedIcon),jt.show(e.connectedIcon)):(jt.show(e.disconnectedIcon),jt.hide(e.connectedIcon))};if(t)switch(t.connectionStatus){case xn.Connected:n(!0),e.connectionStatus.textContent=Rt(ut);break;case xn.Disconnected:n(!1),e.connectionStatus.textContent=Rt(ht);break;case xn.InvalidCert:n(!1),e.connectionStatus.textContent="".concat(Rt(ht)," - ").concat(Rt(dt))}}},{key:"updateBondOptions",value:(t=o(w().mark((function e(){var t,n,r,a,o,s,i,c,l;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.page,a=parseInt(null!==(t=r.bondTargetTier.value)&&void 0!==t?t:""),o=parseInt(null!==(n=r.bondAssetSelect.value)&&void 0!==n?n:""),s={host:this.host,targetTier:a,bondAsset:o},i=Sn().loading(this.body),e.next=7,dn("/api/updatebondoptions",s);case 7:c=e.sent,i(),Sn().checkResponse(c)?(jt.hide(r.bondOptionsErr),jt.show(r.bondOptionsMsg),setTimeout((function(){jt.hide(r.bondOptionsMsg),jt.hide(r.forms)}),5e3),(l=Sn().user.exchanges[this.host]).bondOptions.bondAsset=o,l.bondOptions.targetTier=a):(r.bondOptionsErr.textContent=c.msg,jt.show(r.bondOptionsErr));case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),g}(ln);function vo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vo(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function go(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return bo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){throw e})),f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){i=!0,o=e})),f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function bo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wo="multiplier",ko="absolute",xo="absolute-plus",Co="percent",So="percent-plus",Eo={key:"oracleWeighting",displayname:"Oracle Weight",description:"Enable the oracle and set its weight in calculating our target price.",default:.1,max:1,min:0},Ao=Uo(Eo,{start:{label:"0%",x:0,y:0},end:{label:"100%",x:1,y:100},xUnit:"",yUnit:"%"}),Fo={key:"oracleBias",displayname:"Oracle Bias",description:"Apply an adjustment to the oracles rate, up to +/-1%.",default:0,max:.01,min:-.01},Io={start:{label:"-1%",x:-.01,y:-1},end:{label:"1%",x:.01,y:1},xUnit:"",yUnit:"%"},Ro=Uo(Fo,Io),Do={start:{label:"0%",x:0,y:0},end:{label:"1%",x:.01,y:1},xUnit:"",yUnit:"%"},Oo=Uo({key:"driftTolerance",displayname:"Drift Tolerance",description:"How far from the ideal price will we allow orders to drift. Typically a fraction of a percent.",default:.001,max:.01,min:0},Do),To={key:"gapMultiplier",displayname:"Spread Multiplier",description:"Increase the spread for reduced risk and higher potential profits, but with a lower fill rate. The baseline value, 1, is the break-even value, where tx fees and profits are equivalent in an otherwise static market.",default:2,max:10,min:1},Po={start:{label:"1x",x:1,y:100},end:{label:"100x",x:100,y:1e4},xUnit:"X",yUnit:"%"},Lo=Uo(To,Po),Bo={key:"gapPercent",displayname:"Percent Spread",description:"The spread is set as a percent of current spot price.",default:.005,max:1,min:0},Mo={start:{label:"0%",x:0,y:0},end:{label:"10%",x:.1,y:10},xUnit:"X",yUnit:"%"},Wo=Uo(Bo,Mo),qo=function(e){on(m,e);var t,n,a,i,c,l,d,p,f=(d=m,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(d);if(p){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function m(e,t){var n,a,i,c;s(this,m),h(rn(c=f.call(this)),"page",void 0),h(rn(c),"data",void 0),h(rn(c),"createOpts",void 0),h(rn(c),"gapRanges",void 0),h(rn(c),"currentMarket",void 0),h(rn(c),"currentForm",void 0),h(rn(c),"keyup",void 0),h(rn(c),"programs",void 0),h(rn(c),"editProgram",void 0),h(rn(c),"gapMultiplierOpt",void 0),h(rn(c),"gapPercentOpt",void 0),h(rn(c),"driftToleranceOpt",void 0),h(rn(c),"biasOpt",void 0),h(rn(c),"weightOpt",void 0),h(rn(c),"pwHandler",void 0),h(rn(c),"newWalletForm",void 0),h(rn(c),"specifiedPrice",void 0),h(rn(c),"currentReport",void 0);var l=c.page=jt.idDescendants(e);c.data=t,c.programs={},c.editProgram=null,c.pwHandler=null,c.createOpts=(h(n={},Fo.key,Fo.default),h(n,Eo.key,Eo.default),h(n,Oo.key,Oo.default),n),c.gapRanges=(h(a={},To.key,To.default),h(a,Bo.key,Bo.default),a),l.forms.querySelectorAll(".form-closer").forEach((function(e){jt.bind(e,"click",(function(){c.closePopups()}))})),An(l),jt.cleanTemplates(l.assetRowTmpl,l.booleanOptTmpl,l.rangeOptTmpl,l.orderOptTmpl,l.runningProgramTmpl,l.oracleTmpl);var u=function(t,n){t.stopPropagation();var a=n?l.baseSelect:l.quoteSelect,o=jt.descendentMetrics(e,a);l.assetDropdown.style.left="".concat(o.bodyLeft,"px"),l.assetDropdown.style.top="".concat(o.bodyTop,"px");for(var s=n?c.currentMarket.quoteid:c.currentMarket.baseid,i=n?c.currentMarket.basesymbol:c.currentMarket.quotesymbol,u=new Set,h=new Set,d=0,p=No();d<p.length;d++){var f=p[d];h.add(f.basesymbol),h.add(f.quotesymbol);var m=r(n?[f.quoteid,f.baseid]:[f.baseid,f.quoteid],2),v=m[0],y=m[1],g=r(n?[f.quotesymbol,f.basesymbol]:[f.basesymbol,f.quotesymbol],2),b=g[0],w=g[1];v===s?u.add(w):y===s&&u.add(b)}var k=Array.from(u);k.sort((function(e,t){return e.localeCompare(t)}));for(var x=0,C=k;x<C.length;x++){var S=C[x];h.delete(S)}var E=Array.from(h);E.sort((function(e,t){return e.localeCompare(t)})),jt.empty(l.assetDropdown);var A=function(e,t){var r,a=go(e);try{var o=function(){var e=r.value,a=c.assetRow(e);jt.bind(a,"click",(function(t){if(t.stopPropagation(),e===i)return c.hideAssetDropdown();c.leaveEditMode(),n?c.setCreationBase(e):c.setCreationQuote(e)})),t||a.classList.add("ghost"),l.assetDropdown.appendChild(a)};for(a.s();!(r=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}};A(k,!0),A(E,!1),jt.show(l.assetDropdown),jt.bind(document,"click",(function e(t){jt.mouseInElement(t,l.assetDropdown)||(c.hideAssetDropdown(),jt.unbind(document,"click",e))}))};jt.bind(l.baseSelect,"click",(function(e){return u(e,!0)})),jt.bind(l.quoteSelect,"click",(function(e){return u(e,!1)})),jt.bind(l.marketSelect,"change",(function(){var e,t=r(null===(e=l.marketSelect.value)||void 0===e?void 0:e.split(" "),2),n=t[0],a=t[1];c.setMarketSubchoice(n,a)})),c.gapMultiplierOpt=new Dn(Lo,"",c.gapRanges,(function(){return c.createOptsUpdated()})),c.gapPercentOpt=new Dn(Wo,"",c.gapRanges,(function(){return c.createOptsUpdated()})),c.driftToleranceOpt=new Dn(Oo,"",c.createOpts,(function(){return c.createOptsUpdated()})),c.biasOpt=new Dn(Ro,"",c.createOpts,(function(){return c.createOptsUpdated()})),c.weightOpt=new Dn(Ao,"",c.createOpts,(function(){return c.createOptsUpdated()})),l.options.appendChild(c.gapMultiplierOpt.node),jt.hide(c.gapMultiplierOpt.node),l.options.appendChild(c.gapPercentOpt.node),l.options.appendChild(c.driftToleranceOpt.node),l.options.appendChild(c.weightOpt.node),l.options.appendChild(c.biasOpt.node),jt.bind(l.showAdvanced,"click",(function(){nn.storeLocal(nn.optionsExpansionLK,!0),jt.hide(l.showAdvanced),jt.show(l.hideAdvanced,l.options)})),jt.bind(l.hideAdvanced,"click",(function(){nn.storeLocal(nn.optionsExpansionLK,!1),jt.hide(l.hideAdvanced,l.options),jt.show(l.showAdvanced)})),jt.bind(l.runBttn,"click",c.authedRoute(function(){var e=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.createBot(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),jt.bind(l.lotsInput,"change",(function(){var e;l.lotsInput.value=String(Math.round(parseFloat(null!==(e=l.lotsInput.value)&&void 0!==e?e:"0")))})),jt.bind(l.exitEditMode,"click",(function(){return c.leaveEditMode()})),jt.bind(l.manualPriceBttn,"click",(function(){jt.hide(l.basisPrice,l.manualPriceBttn),jt.show(l.manualPriceInput),l.manualPriceInput.focus()}));var d=function(){l.manualPriceInput.value="",jt.show(l.basisPrice,l.manualPriceBttn),jt.hide(l.manualPriceInput)};jt.bind(l.manualPriceInput,"keyup",(function(e){switch(e.key){case"Escape":d();break;case"Enter":case"NumpadEnter":n=parseFloat(null!==(t=l.manualPriceInput.value)&&void 0!==t?t:"0"),l.basisPrice.textContent=jt.formatFiveSigFigs(n),c.specifiedPrice=n,c.setCurrentBasisPrice(n),jt.show(l.basisPrice,l.manualPriceBttn),jt.hide(l.manualPriceInput,l.noFiatBox)}var t,n})),jt.bind(l.manualPriceInput,"blur",(function(){jt.isHidden(l.basisPrice)&&d()})),jt.bind(l.gapStrategySelect,"change",(function(){return c.updateGapStrategyInputs(c.currentReport)}));var p=function(){var e=o(w().mark((function e(){var t,n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(n=null!==(t=l.pwInput.value)&&void 0!==t?t:"")){e.next=3;break}return e.abrupt("return");case 3:if(null!==(r=c.pwHandler)){e.next=6;break}return e.abrupt("return");case 6:return c.pwHandler=null,e.next=9,r(n);case 9:c.currentForm===l.pwForm&&c.closePopups();case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Vr(l.pwForm,l.pwSubmit,(function(){return p()})),jt.bind(l.pwInput,"keyup",(function(e){"Enter"!==e.key&&"NumpadEnter"!==e.key||p()})),c.newWalletForm=new Fr(l.newWalletForm,(function(e){return c.newWalletCreated(e)})),jt.bind(l.createBaseWallet,"click",(function(){c.newWalletForm.setAsset(c.currentMarket.baseid),c.showForm(l.newWalletForm)})),jt.bind(l.createQuoteWallet,"click",(function(){c.newWalletForm.setAsset(c.currentMarket.quoteid),c.showForm(l.newWalletForm)})),jt.bind(l.forms,"mousedown",(function(e){jt.mouseInElement(e,c.currentForm)||c.closePopups()})),c.keyup=function(e){"Escape"===e.key&&c.closePopups()};var v=nn.fetchLocal(nn.lastMMMarketLK),y=null;if(v&&v.host){var g=Sn().exchanges[v.host];if(g){var b=v.basesymbol+"_"+v.quotesymbol,k=g.markets[b];k&&(y=Object.assign({host:g.host},k))}}return nn.fetchLocal(nn.optionsExpansionLK)&&(jt.show(l.hideAdvanced,l.options),jt.hide(l.showAdvanced)),Sn().registerNoteFeeder({bot:function(e){c.handleBotNote(e)}}),c.setMarket([null!==(i=y)&&void 0!==i?i:No()[0]]),c.populateRunningPrograms(),l.createBox.classList.remove("invisible"),l.programsBox.classList.remove("invisible"),c}return u(m,[{key:"unload",value:function(){jt.unbind(document,"keyup",this.keyup)}},{key:"showForm",value:(l=o(w().mark((function e(t){var n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentForm=t,n=this.page,jt.hide(n.pwForm,n.newWalletForm),t.style.right="10000px",jt.show(n.forms,t),r=(n.forms.offsetWidth+t.offsetWidth)/2,e.next=8,jt.animate(300,(function(e){t.style.right="".concat((1-e)*r,"px")}),"easeOutHard");case 8:t.style.right="0";case 9:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"closePopups",value:function(){this.pwHandler=null,this.page.pwInput.value="",jt.hide(this.page.forms)}},{key:"hideAssetDropdown",value:function(){var e=this.page;e.assetDropdown.scrollTop=0,jt.hide(e.assetDropdown)}},{key:"assetRow",value:function(e){var t=this.page.assetRowTmpl.cloneNode(!0),n=jt.parseTemplate(t);return n.logo.src=jt.logoPath(e),jt.empty(n.symbol),n.symbol.appendChild(jt.symbolize(e)),t}},{key:"setCurrentReport",value:function(e){this.currentReport=e,this.setCurrentBasisPrice(e?e.basisPrice:0),this.updateGapStrategyInputs(e);var t=this.page;if(e&&e.basisPrice>0)this.fetchMaxBuy(Math.round(e.basisPrice/this.currentMarket.atomToConv*jn)),t.basisPrice.textContent=jt.formatFiveSigFigs(e.basisPrice),jt.show(t.absMaxBox,t.basisPrice),jt.hide(t.manualPriceInput,t.noFiatBox),this.page.gapFactorMax.textContent=jt.formatFiveSigFigs(e.basisPrice);else{t.lotEstQuoteLots.textContent="[no rate]",t.basisPrice.textContent="must set manually",jt.hide(t.basisPrice,t.absMaxBox),jt.show(t.manualPriceInput),t.manualPriceInput.focus();var n=Sn().user;0===Object.keys(n.fiatRates).length&&jt.show(t.noFiatBox)}e&&e.breakEvenSpread>0?(jt.show(t.breakEvenGapBox),t.breakEvenGap.textContent=jt.formatFiveSigFigs(e.breakEvenSpread)):jt.hide(t.breakEvenGapBox)}},{key:"updateGapStrategyInputVisibility",value:function(){var e=this.page;switch(e.gapStrategySelect.value){case wo:jt.show(this.gapMultiplierOpt.node),jt.hide(e.absInputBox,e.absMaxBox,this.gapPercentOpt.node);break;case Co:case So:jt.show(this.gapPercentOpt.node),jt.hide(e.absInputBox,e.absMaxBox,this.gapMultiplierOpt.node);break;case ko:case xo:jt.hide(this.gapMultiplierOpt.node,this.gapPercentOpt.node),jt.show(e.absInputBox,e.absMaxBox)}}},{key:"updateGapStrategyInputs",value:function(e){switch(this.updateGapStrategyInputVisibility(),this.page.gapStrategySelect.value){case wo:e&&e.breakEvenSpread>0?(Po.start.y=e.breakEvenSpread,Po.end.y=100*e.breakEvenSpread,Po.yUnit=this.rateUnit()):(Po.start.y=100,Po.end.y=1e4,Po.yUnit="%"),this.gapMultiplierOpt.handler.setConfig(Po);break;case Co:case So:e&&e.breakEvenSpread>0?(Mo.end.y=e.basisPrice,Mo.yUnit=this.rateUnit(),this.gapPercentOpt.handler.setConfig(Mo)):(Mo.end.y=10,Mo.yUnit="%")}}},{key:"setCurrentBasisPrice",value:function(e){if(e>0){var t=this.rateUnit();Io.start.y=-.01*e,Io.end.y=.01*e,Io.yUnit=t,Do.start.y=0,Do.end.y=.01*e,Do.yUnit=t}else Io.start.y=-1,Io.end.y=1,Io.yUnit="%",Do.start.y=0,Do.end.y=1,Do.yUnit="%";this.biasOpt.handler.setConfig(Io),this.driftToleranceOpt.handler.setConfig(Do)}},{key:"rateUnit",value:function(){var e=this.currentMarket.quotesymbol.split(".")[0],t=this.currentMarket.basesymbol.split(".")[0];return"".concat(e,"/").concat(t)}},{key:"setMarket",value:(c=o(w().mark((function e(t,n){var r,a,o,s,i,c,l,u,h,d,p,f,m,v;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.page,a=t[0],this.currentMarket=a,this.specifiedPrice=0,this.setCurrentReport(null),r.manualPriceInput.value="",nn.storeLocal(nn.lastMMMarketLK,a),jt.empty(r.baseSelect,r.quoteSelect),r.baseSelect.appendChild(this.assetRow(a.basesymbol)),r.quoteSelect.appendChild(this.assetRow(a.quotesymbol)),this.hideAssetDropdown(),o=function(e,t){jt.setContent(t,jt.symbolize(e.basesymbol),new Text("-"),jt.symbolize(e.quotesymbol),new Text(" @ "),new Text(e.host))},jt.hide(r.marketSelect,r.marketOneChoice),1===t.length)jt.show(r.marketOneChoice),o(a,r.marketOneChoice);else{jt.show(r.marketSelect),jt.empty(r.marketSelect),s=go(t);try{for(s.s();!(i=s.n()).done;)c=i.value,l=document.createElement("option"),r.marketSelect.appendChild(l),l.value="".concat(c.host," ").concat(c.name),o(c,l)}catch(e){s.e(e)}finally{s.f()}}if(!n){e.next=16;break}return e.abrupt("return");case 16:if(jt.setContent(r.lotEstBaseSymbol,jt.symbolize(a.basesymbol)),jt.setContent(r.lotEstQuoteSymbol,jt.symbolize(a.quotesymbol)),u=function(e,t){jt.show(t);var n=jt.parseTemplate(t);return n.assetLogo.src=jt.logoPath(e.symbol),n.assetName.textContent=e.name,!1},jt.hide(r.lotEstQuoteBox,r.lotEstQuoteNoWallet,r.lotEstBaseBox,r.lotEstBaseNoWallet,r.availHeader,r.lotEstimateBox,r.marketInfo,r.oraclesBox,r.lotsBox,r.options,r.advancedBox),h=[Sn().assets[a.baseid],Sn().assets[a.quoteid]],p=h[1],!(d=h[0]).wallet||!p.wallet){e.next=35;break}return jt.show(r.lotEstQuoteBox,r.lotEstBaseBox,r.availHeader,r.fetchingMarkets,r.lotsBox,r.advancedBox),nn.fetchLocal(nn.optionsExpansionLK)&&jt.show(r.options),f=Sn().loading(r.options),m=this.fetchOracleAndMaxBuy(),v=this.fetchMaxSell(),e.next=29,m;case 29:return e.next=31,v;case 31:return f(),jt.show(r.lotEstimateBox,r.marketInfo,r.oraclesBox),jt.hide(r.fetchingMarkets),e.abrupt("return");case 35:jt.show(r.lotEstimateBox),p.wallet?r.lotEstQuoteLots.textContent="0":u(p,r.lotEstQuoteNoWallet),d.wallet?r.lotEstBaseLots.textContent="0":u(d,r.lotEstBaseNoWallet);case 38:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"fetchMaxSell",value:(i=o(w().mark((function e(){var t,n,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.currentMarket,n=this.page,e.next=3,dn("/api/maxsell",{host:t.host,base:t.baseid,quote:t.quoteid});case 3:if(r=e.sent,this.currentMarket===t){e.next=6;break}return e.abrupt("return");case 6:if(Sn().checkResponse(r)){e.next=10;break}return n.lotEstBaseLots.textContent="0",console.error(r),e.abrupt("return");case 10:n.lotEstBaseLots.textContent=String(r.maxSell.swap.lots);case 11:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"fetchOracleAndMaxBuy",value:(a=o(w().mark((function e(){var t,n,r,a,o,s,i,c,l,u,h,d,p;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.currentMarket,r=this.page,e.next=3,dn("/api/marketreport",{host:n.host,baseID:n.baseid,quoteID:n.quoteid});case 3:if(a=e.sent,Sn().checkResponse(a)){e.next=8;break}return r.lotEstQuoteLots.textContent="0",console.error(a),e.abrupt("return");case 8:if(o=a.report,jt.hide(r.manualPriceBttn),this.setCurrentReport(o),o.oracles&&0!==o.oracles.length){e.next=13;break}return e.abrupt("return");case 13:jt.empty(r.oracles),s=0,i=0,c=go(null!==(t=o.oracles)&&void 0!==t?t:[]);try{for(c.s();!(l=c.n()).done;)u=l.value,h=r.oracleTmpl.cloneNode(!0),r.oracles.appendChild(h),(d=jt.parseTemplate(h)).logo.src="img/"+u.host+".png",d.host.textContent=zo[u.host],d.volume.textContent=jt.formatThreeSigFigs(u.usdVol),p=(u.bestBuy+u.bestSell)/2,i+=u.usdVol*p,s+=u.usdVol,d.price.textContent=jt.formatThreeSigFigs((u.bestBuy+u.bestSell)/2)}catch(e){c.e(e)}finally{c.f()}r.avgPrice.textContent=jt.formatFiveSigFigs(i/s);case 19:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"fetchMaxBuy",value:(n=o(w().mark((function e(t){var n,r,a;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.currentMarket,r=this.page,e.next=3,dn("/api/maxbuy",{host:n.host,base:n.baseid,quote:n.quoteid,rate:null!=t?t:0});case 3:if(a=e.sent,this.currentMarket===n){e.next=6;break}return e.abrupt("return");case 6:r.lotEstQuoteLots.textContent=String(a.maxBuy.swap.lots);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setEditProgram",value:function(e){var t=this,n=this.createOpts,r=this.page,a=e.program,o=[Sn().assets[a.baseID],Sn().assets[a.quoteID]],s=o[0],i=o[1],c=Sn().exchanges[a.host].markets["".concat(s.symbol,"_").concat(i.symbol)];this.setMarket([yo({host:a.host},c)],!0);for(var l=0,u=Object.values(this.programs);l<u.length;l++){var h=u[l];h.programID!==e.programID&&jt.hide(h.div)}switch(this.editProgram=e,r.createBox.classList.add("edit"),r.programsBox.classList.add("edit"),r.lotsInput.value=String(a.lots),n.oracleWeighting=a.oracleWeighting,this.weightOpt.setValue(a.oracleWeighting),n.oracleBias=a.oracleBias,this.biasOpt.setValue(a.oracleBias),n.driftTolerance=a.driftTolerance,this.driftToleranceOpt.setValue(a.driftTolerance),r.gapStrategySelect.value=a.gapStrategy,this.updateGapStrategyInputVisibility(),this.createOptsUpdated(),a.gapStrategy){case Co:case So:this.gapPercentOpt.setValue(a.gapFactor);break;case wo:this.gapMultiplierOpt.setValue(a.gapFactor)}jt.bind(r.programsBox,"click",(function(){return t.leaveEditMode()}))}},{key:"leaveEditMode",value:function(){var e=this,t=this.page;jt.unbind(t.programsBox,"click",(function(){return e.leaveEditMode()}));for(var n=0,r=Object.values(this.programs);n<r.length;n++){var a=r[n];jt.show(a.div)}t.createBox.classList.remove("edit"),t.programsBox.classList.remove("edit"),this.editProgram=null,this.setMarket([this.currentMarket])}},{key:"populateRunningPrograms",value:function(){var e=this.page,t=Sn().user.bots;jt.empty(e.runningPrograms),this.programs={};var n,r=go(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.runningPrograms.appendChild(this.programDiv(a))}}catch(e){r.e(e)}finally{r.f()}this.setProgramsHeader()}},{key:"setProgramsHeader",value:function(){var e=this.page;e.runningPrograms.children.length>0?(jt.show(e.programsHeader),jt.hide(e.noProgramsMessage)):(jt.hide(e.programsHeader),jt.show(e.noProgramsMessage))}},{key:"programDiv",value:function(e){var t=this,n=this.page.runningProgramTmpl.cloneNode(!0),r=jt.parseTemplate(n),a=function(){var t=o(w().mark((function t(a,o){var s,i;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return jt.hide(r.startErr),s=Sn().loading(n),t.next=4,dn(a,{programID:e.programID,appPW:o});case 4:i=t.sent,s(),Sn().checkResponse(i)||(r.startErr.textContent=i.msg,jt.show(r.startErr));case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();jt.bind(r.pauseBttn,"click",(function(){return a("/api/stopbot")})),jt.bind(r.startBttn,"click",this.authedRoute(function(){var e=o(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a("/api/startbot",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),jt.bind(r.retireBttn,"click",(function(){return a("/api/retirebot")})),jt.bind(r.configureBttn,"click",(function(n){n.stopPropagation(),t.setEditProgram(t.programs[e.programID])}));var s=[Sn().assets[e.program.baseID],Sn().assets[e.program.quoteID]],i=s[0],c=s[1];return r.base.appendChild(this.assetRow(i.symbol)),r.quote.appendChild(this.assetRow(c.symbol)),r.baseSymbol.textContent=i.symbol.toUpperCase(),r.quoteSymbol.textContent=c.symbol.toUpperCase(),r.host.textContent=e.program.host,this.updateProgramDiv(r,e),this.programs[e.programID]=Object.assign({tmpl:r,div:n},e),n}},{key:"authedRoute",value:function(e){var t=this;return o(w().mark((function n(){return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!nn.passwordIsCached()){n.next=4;break}return n.next=3,e("");case 3:return n.abrupt("return",n.sent);case 4:return t.pwHandler=e,n.next=7,t.showForm(t.page.pwForm);case 7:case"end":return n.stop()}}),n)})))}},{key:"updateProgramDiv",value:function(e,t){var n=t.program;jt.hide(e.programRunning,e.programPaused),t.running?jt.show(e.programRunning):jt.show(e.programPaused),e.lots.textContent=String(n.lots),e.boost.textContent="".concat((100*n.gapFactor).toFixed(1),"%"),e.driftTolerance.textContent="".concat((100*n.driftTolerance).toFixed(2),"%"),e.oracleWeight.textContent="".concat((100*n.oracleWeighting).toFixed(0),"%"),e.oracleBias.textContent="".concat((100*n.oracleBias).toFixed(1),"%")}},{key:"setMarketSubchoice",value:function(e,t){e===this.currentMarket.host&&t===this.currentMarket.name||this.leaveEditMode(),this.currentMarket=Object.assign({host:e},Sn().exchanges[e].markets[t])}},{key:"createOptsUpdated",value:function(){this.createOpts.oracleWeighting?jt.show(this.biasOpt.node):jt.hide(this.biasOpt.node)}},{key:"handleBotNote",value:function(e){var t=this.page,n=e.report;switch(e.topic){case"BotCreated":t.runningPrograms.prepend(this.programDiv(n)),this.setProgramsHeader();break;case"BotRetired":this.programs[n.programID].div.remove(),delete this.programs[n.programID],this.setProgramsHeader();break;default:var r=this.programs[n.programID];Object.assign(r,n),this.updateProgramDiv(r.tmpl,n)}}},{key:"setCreationBase",value:function(e){for(var t=this.currentMarket.quotesymbol,n=No(),r=[],a=0,o=n;a<o.length;a++){var s=o[a];s.basesymbol===e&&s.quotesymbol===t&&r.push(s)}for(var i=0,c=n;i<c.length;i++){var l=c[i];l.quotesymbol===e&&l.basesymbol===t&&r.push(l)}if(r.length>0)return this.setMarket(r);for(var u=0,h=n;u<h.length;u++){var d=h[u];if(d.basesymbol===e)return this.setMarket([d])}for(var p=0,f=n;p<f.length;p++){var m=f[p];if(m.quotesymbol===e)return this.setMarket([m])}}},{key:"setCreationQuote",value:function(e){for(var t=this.currentMarket.basesymbol,n=No(),r=[],a=0,o=n;a<o.length;a++){var s=o[a];s.quotesymbol===e&&s.basesymbol===t&&r.push(s)}for(var i=0,c=n;i<c.length;i++){var l=c[i];l.basesymbol===e&&l.quotesymbol===t&&r.push(l)}if(r.length>0)return this.setMarket(r);for(var u=0,h=n;u<h.length;u++){var d=h[u];if(d.quotesymbol===e)return this.setMarket([d])}for(var p=0,f=n;p<f.length;p++){var m=f[p];if(m.basesymbol===e)return this.setMarket([m])}}},{key:"createBot",value:(t=o(w().mark((function e(t){var n,r,a,o,s,i,c,l,u,h,d,p;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.page,r=this.currentMarket,a=this.currentReport,jt.hide(n.createErr),o=function(e){n.createErr.textContent=e,jt.show(n.createErr)},0!==(s=parseInt(n.lotsInput.value||"0"))){e.next=6;break}return e.abrupt("return",o("must specify > 0 lots"));case 6:i=Object.assign({host:r.host,baseID:r.baseid,quoteID:r.quoteid},this.createOpts,{lots:s,gapStrategy:""}),c=n.gapStrategySelect.value,i.gapStrategy=null!=c?c:"",l={botType:"MakerV0",program:i,programID:0,appPW:t,manualRate:0},e.t0=c,e.next=e.t0===ko||e.t0===xo?13:e.t0===Co||e.t0===So?22:24;break;case 13:if(0!==(u=parseFloat(n.absInput.value||"0"))){e.next=18;break}return e.abrupt("return",o("gap must be specified for strategy = absolute"));case 18:if(!(null!=a&&a.basisPrice&&u>=a.basisPrice)){e.next=20;break}return e.abrupt("return",o("gap width cannot be > current spot price"));case 20:return i.gapFactor=u,e.abrupt("break",25);case 22:return i.gapFactor=this.gapRanges.gapPercent,e.abrupt("break",25);case 24:i.gapFactor=this.gapRanges.gapMultiplier;case 25:if(h="/api/createbot",null===this.editProgram){e.next=31;break}l.programID=this.editProgram.programID,h="/api/updatebotprogram",e.next=36;break;case 31:if(this.currentReport&&0!==this.currentReport.basisPrice){e.next=36;break}if(0!==this.specifiedPrice){e.next=35;break}return o("price must be set manually"),e.abrupt("return");case 35:l.program.manualRate=this.specifiedPrice;case 36:return d=Sn().loading(n.botCreator),e.next=39,dn(h,l);case 39:if(p=e.sent,d(),Sn().checkResponse(p)){e.next=45;break}return n.createErr.textContent=p.msg,jt.show(n.createErr),e.abrupt("return");case 45:this.leaveEditMode(),n.lotsInput.value="";case 47:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"newWalletCreated",value:function(e){var t=this.currentMarket;if(e===t.baseid)this.setCreationBase(t.basesymbol);else{if(e!==t.quoteid)return;this.setCreationQuote(t.quotesymbol)}this.closePopups()}}]),m}(ln);function No(){for(var e=[],t=function(e){return Object.values(e.markets).map((function(t){return Object.assign({host:e.host},t)}))},n=0,r=Object.values(Sn().user.exchanges);n<r.length;n++){var a=r[n];e.push.apply(e,yn(t(a)))}return e.sort((function(e,t){return e.spot?t.spot?t.spot.vol24/t.lotsize-e.spot.vol24/e.lotsize:1:t.spot?-1:e.name.localeCompare(t.name)})),e}function Uo(e,t){var n=function(e){return{key:e.key,displayname:e.displayname,description:e.description,default:e.default,max:e.max,min:e.min,noecho:!1,isboolean:!1,isdate:!1,disablewhenactive:!1,isBirthdayConfig:!1,noauth:!1}}(e);return n.xyRange=t,n}var _o,zo={"binance.com":"Binance","coinbase.com":"Coinbase","bittrex.com":"Bittrex","hitbtc.com":"HitBTC","exmo.com":"EXMO"};function Vo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vo(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ho(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Go(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Go(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function Go(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ko=jt.idel,Xo=jt.bind,Qo=jt.unbind,Yo={login:Xr,register:Kr,markets:Ia,wallets:Jr,settings:ra,orders:$a,order:oo,dexsettings:mo,mm:qo},Jo=function(){function e(){var t=this;s(this,e),h(this,"notes",void 0),h(this,"pokes",void 0),h(this,"user",void 0),h(this,"seedGenTime",void 0),h(this,"commitHash",void 0),h(this,"showPopups",void 0),h(this,"loggers",void 0),h(this,"recorders",void 0),h(this,"main",void 0),h(this,"header",void 0),h(this,"headerSpace",void 0),h(this,"assets",void 0),h(this,"exchanges",void 0),h(this,"walletMap",void 0),h(this,"fiatRatesMap",void 0),h(this,"tooltip",void 0),h(this,"page",void 0),h(this,"loadedPage",void 0),h(this,"popupNotes",void 0),h(this,"popupTmpl",void 0),h(this,"noteReceivers",void 0),this.notes=[],this.pokes=[],this.seedGenTime=0,this.commitHash="0e733c7fbccf5b737a9b8ca78a5c0ce683ad7a19",this.noteReceivers=[],this.fiatRatesMap={},this.showPopups="1"===nn.fetchLocal(nn.popupsLK),console.log("Decred DEX Client App, Build",this.commitHash.substring(0,7)),this.loggers=nn.fetchLocal(nn.loggersLK)||{},window.enableLogger=function(e,n){return n?t.loggers[e]=!0:delete t.loggers[e],nn.storeLocal(nn.loggersLK,t.loggers),"".concat(e," logger ").concat(n?"enabled":"disabled")},window.log=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];t.log.apply(t,[e].concat(r))};var n=nn.fetchLocal(nn.recordersLK)||[];this.recorders={};var r,a=Ho(n);try{for(a.s();!(r=a.n()).done;){var o=r.value;console.log("recording",o),this.recorders[o]=[]}}catch(e){a.e(e)}finally{a.f()}window.recordLogger=function(e,n){return n?t.recorders[e]=[]:delete t.recorders[e],nn.storeLocal(nn.recordersLK,Object.keys(t.recorders)),"".concat(e," recorder ").concat(n?"enabled":"disabled")},window.dumpLogger=function(e){var n=t.recorders[e];if(!n)return"no recorder for logger ".concat(e);var r=document.createElement("a");r.href="data:application/octet-stream;base64,".concat(window.btoa(JSON.stringify(n,null,4))),r.download="".concat(e,".json"),document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r)}),0)},g=Ft[document.documentElement.lang.toLowerCase()]}var t,n,a,i,c;return u(e,[{key:"start",value:(c=o(w().mark((function e(){var t,n,r,a=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xo(window,"popstate",(function(e){var t=e.state.page;(t||""===t)&&a.loadPage(t,e.state.data,!0)})),this.main=Ko(document,"main"),t=this.main.dataset.handler,e.next=5,this.fetchUser();case 5:$o((n=new URL(window.location.href)).pathname)!==t&&(n.pathname="/".concat(t),n.search="",window.history.replaceState({page:t},"",n)),this.attachHeader(),this.attachCommon(this.header),this.attach({}),r=nn.fetchLocal(nn.notificationsLK),this.setNotes(r||[]),la.connect((void 0,o="https:"===window.location.protocol?"wss":"ws","".concat(o,"://").concat(window.location.host,"/ws")),this.reconnected),la.registerRoute("notify",(function(e){a.notify(e)}));case 14:case"end":return e.stop()}var o}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"reconnected",value:function(){window.location.reload()}},{key:"fetchUser",value:(i=o(w().mark((function e(){var t,n,a,o,s,i,c;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fn("/api/user");case 2:if(t=e.sent,this.checkResponse(t)){e.next=5;break}return e.abrupt("return");case 5:for(n=t,this.seedGenTime=n.seedgentime,this.user=n,this.assets=n.assets,this.exchanges=n.exchanges,this.walletMap={},this.fiatRatesMap=n.fiatRates,a=0,o=Object.entries(n.assets);a<o.length;a++)s=r(o[a],2),i=s[0],(c=s[1]).wallet&&(this.walletMap[i]=c.wallet);return this.updateMenuItemsDisplay(),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"authed",value:function(){return this.user&&this.user.authed}},{key:"loadPage",value:(a=o(w().mark((function e(t,n,r){var a,o,s,i,c,l,u,h;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tooltip.style.left="-10000px",jt.hide(this.page.noteBox,this.page.profileBox),a=new URL("/".concat(t),window.location.origin),o=$o(t),e.next=6,window.fetch(a.toString());case 6:if((s=e.sent).ok){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,s.text();case 11:return i=e.sent,c=jt.noderize(i),l=Ko(c,"main"),u=l.dataset.handler,r||(h=u===o?a.toString():"/".concat(u),window.history.pushState({page:t,data:n},"",h)),document.title=c.title,this.main.replaceWith(l),this.main=l,this.noteReceivers=[],jt.empty(this.headerSpace),this.attach(n),e.abrupt("return",!0);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"attach",value:function(e){var t=this.main.dataset.handler;if(t){this.attachCommon(this.main),this.loadedPage&&this.loadedPage.unload();var n=Yo[t];this.loadedPage=n?new n(this.main,e):null,this.bindTooltips(this.main)}else console.error("cannot attach to content with no specified handler")}},{key:"bindTooltips",value:function(e){var t=this;e.querySelectorAll("[data-tooltip]").forEach((function(e){Xo(e,"mouseenter",(function(){t.tooltip.textContent=e.dataset.tooltip||"";var n=jt.layoutMetrics(e),r=n.centerX-t.tooltip.offsetWidth/2;r<0&&(r=5),r+t.tooltip.offsetWidth>document.body.offsetWidth&&(r=document.body.offsetWidth-t.tooltip.offsetWidth-5),t.tooltip.style.left="".concat(r,"px"),t.tooltip.style.top="".concat(n.bodyTop-t.tooltip.offsetHeight-5,"px")})),Xo(e,"mouseleave",(function(){t.tooltip.style.left="-10000px"}))}))}},{key:"attachHeader",value:function(){var e=this;this.header=Ko(document.body,"header"),this.headerSpace=jt.idel(this.header,"headerSpace"),this.popupNotes=Ko(document.body,"popupNotes"),this.popupTmpl=jt.tmplElement(this.popupNotes,"note"),this.popupTmpl?this.popupTmpl.remove():console.error("popupTmpl element not found"),this.tooltip=Ko(document.body,"tooltip");var t=this.page=jt.idDescendants(this.header);t.noteTmpl.removeAttribute("id"),t.noteTmpl.remove(),t.pokeTmpl.removeAttribute("id"),t.pokeTmpl.remove(),t.loader.remove(),jt.show(t.loader),Xo(t.noteBell,"click",o(w().mark((function n(){var r,a,o;return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:jt.hide(t.pokeList),jt.show(t.noteList),e.ackNotes(),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),e.showDropdown(t.noteBell,t.noteBox),jt.hide(t.noteIndicator),r=Ho(e.notes);try{for(r.s();!(a=r.n()).done;)(o=a.value).acked&&o.el.classList.remove("firstview")}catch(e){r.e(e)}finally{r.f()}e.setNoteTimes(t.noteList),e.setNoteTimes(t.pokeList),e.storeNotes();case 12:case"end":return n.stop()}}),n)})))),Xo(t.burgerIcon,"click",(function(){jt.hide(t.logoutErr),e.showDropdown(t.burgerIcon,t.profileBox)})),Xo(t.innerNoteIcon,"click",(function(){jt.hide(t.noteBox)})),Xo(t.innerBurgerIcon,"click",(function(){jt.hide(t.profileBox)})),Xo(t.profileSignout,"click",o(w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.signOut();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))),Xo(t.pokeCat,"click",(function(){e.setNoteTimes(t.pokeList),t.pokeCat.classList.add("active"),t.noteCat.classList.remove("active"),jt.hide(t.noteList),jt.show(t.pokeList),e.ackNotes()})),Xo(t.noteCat,"click",(function(){e.setNoteTimes(t.noteList),t.noteCat.classList.add("active"),t.pokeCat.classList.remove("active"),jt.hide(t.pokeList),jt.show(t.noteList),e.ackNotes()}))}},{key:"showDropdown",value:function(e,t){var n=this,r=e.getBoundingClientRect();jt.hide(this.page.noteBox,this.page.profileBox),jt.show(t),t.style.right="".concat(window.innerWidth-r.left-r.width+5,"px"),t.style.top="".concat(r.top-4,"px"),Xo(document,"click",(function e(r){jt.mouseInElement(r,t)||(jt.hide(t),Qo(document,"click",e),t===n.page.noteBox&&jt.isDisplayed(n.page.noteList)&&n.ackNotes())}))}},{key:"ackNotes",value:function(){var e,t=[],n=Ho(this.notes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.acked?r.el.classList.remove("firstview"):(r.acked=!0,r.id&&r.severity>2&&t.push(r.id))}}catch(e){n.e(e)}finally{n.f()}t.length&&la.request("acknotes",t),jt.hide(this.page.noteIndicator)}},{key:"setNoteTimes",value:function(e){for(var t=0,n=Array.from(e.children);t<n.length;t++){var r=n[t];jt.safeSelector(r,"span.note-time").textContent=jt.timeSince(r.note.stamp)}}},{key:"bindInternalNavigation",value:function(e){var t=this,n=new URL(window.location.href);e.querySelectorAll("a").forEach((function(e){if(e.href){var r=new URL(e.href);if(r.origin===n.origin){var a=r.pathname.substring(1),o={};r.search&&r.searchParams.forEach((function(e,t){o[t]=e})),jt.bind(e,"click",(function(e){e.preventDefault(),t.loadPage(a,o)}))}}}))}},{key:"storeNotes",value:function(){nn.storeLocal(nn.notificationsLK,this.notes.map((function(e){return{subject:e.subject,details:e.details,severity:e.severity,stamp:e.stamp,id:e.id,acked:e.acked}})))}},{key:"updateMenuItemsDisplay",value:function(){var e=this.page,t=this.user;if(e){if(!t||!t.authed)return e.profileBox.classList.remove("authed"),void jt.hide(e.noteBell,e.walletsMenuEntry,e.marketsMenuEntry);e.profileBox.classList.add("authed"),jt.show(e.noteBell,e.walletsMenuEntry),Object.keys(t.exchanges).length>0?jt.show(e.marketsMenuEntry):jt.hide(e.marketsMenuEntry)}}},{key:"attachCommon",value:function(e){this.bindInternalNavigation(e)}},{key:"updateBondConfs",value:function(e,t,n,r){var a=this.exchanges[e],o=this.assets[r].symbol;a.pendingBonds[t]={confs:n,assetID:r,symbol:o}}},{key:"updateTier",value:function(e,t){this.exchanges[e].tier=t}},{key:"handleBondNote",value:function(e){switch(e.topic){case"RegUpdate":null!==e.coinID&&this.updateBondConfs(e.dex,e.coinID,e.confirmations,e.asset);break;case"BondConfirmed":null!==e.tier&&this.updateTier(e.dex,e.tier)}}},{key:"setNotes",value:function(e){this.log("notes","setNotes",e),this.notes=[],jt.empty(this.page.noteList);for(var t=0;t<e.length;t++)this.prependNoteElement(e[t],!0);this.storeNotes()}},{key:"updateUser",value:function(e){var t=this.user,n=this.assets,a=this.walletMap;if("fiatrateupdate"!==e.type){if(t)switch(e.type){case"order":var o=e,s=o.order,i=t.exchanges[s.host].markets[s.market],c=o.tempID;if("AsyncOrderSubmitted"===e.topic){var l=s;l.tempID=c,i.inflight?i.inflight.push(l):i.inflight=[l];break}if("AsyncOrderFailure"===e.topic){i.inflight=i.inflight.filter((function(e){return e.tempID!==c}));break}for(var u in i.inflight||[])if(i.inflight[u].tempID===c){i.inflight=i.inflight.filter((function(e){return e.tempID!==c}));break}i.orders?function(e,t){for(var n in e.orders||[])if(e.orders[n].id===t.id)return e.orders[n]=t,!0;return!1}(i,s)||i.orders.push(s):i.orders=[s];break;case"balance":var h=e,d=t.assets[h.assetID];if(!d)break;var p=d.wallet;p&&(p.balance=h.balance);break;case"bondpost":this.handleBondNote(e);break;case"walletstate":case"walletconfig":if(!n)return;var f=e.wallet;n[f.assetID].wallet=f,a[f.assetID]=f;break;case"match":var m=e,v=this.order(m.orderID);v&&function(e,t){for(var n in e.matches)if(e.matches[n].matchID===t.matchID)return void(e.matches[n]=t);e.matches=e.matches||[],e.matches.push(t)}(v,m.match);break;case"conn":var y=e,g=t.exchanges[y.host];g&&(g.connectionStatus=y.connectionStatus);break;case"spots":var b=e,w=t.exchanges[b.host];if(!w||!w.markets)break;for(var k=0,x=Object.entries(b.spots);k<x.length;k++){var C=r(x[k],2),S=C[0],E=C[1];w.markets[S].spot=E}break;case"fiatrateupdate":this.fiatRatesMap=e.fiatRates;break;case"bot":var A=e,F=[A.report,this.user.bots],I=F[0],R=F[1],D=R.findIndex((function(e){return e.programID===I.programID}));"BotRetired"===A.topic?D>=0&&R.splice(D,1):D>=0?R[D]=A.report:R.push(A.report)}}else this.fiatRatesMap=e.fiatRates}},{key:"notify",value:function(e){this.log("notes","notify",e),this.updateUser(e);var t,n=Ho(this.noteReceivers);try{for(n.s();!(t=n.n()).done;){var r=t.value[e.type];if(r)try{r(e)}catch(t){console.error("note feeder error:",t.message?t.message:t),console.log(e),console.log(t.stack)}}}catch(e){n.e(e)}finally{n.f()}if(!(e.severity<2)){var a=this.popupTmpl,s=this.popupNotes;if(this.showPopups){var i=a.cloneNode(!0);jt.tmplElement(i,"text").textContent="".concat(e.subject,": ").concat(e.details);var c=jt.tmplElement(i,"indicator");for(2===e.severity?jt.hide(c):ts(c,e.severity),s.appendChild(i);s.children.length>5;)s.removeChild(s.firstChild);setTimeout(o(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jt.animate(500,(function(e){i.style.opacity=String(1-e)}));case 2:i.remove();case 3:case"end":return e.stop()}}),e)}))),6e3)}2===e.severity?this.prependPokeElement(e):this.prependNoteElement(e)}}},{key:"registerNoteFeeder",value:function(e){this.noteReceivers.push(e)}},{key:"log",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];this.loggers[e]&&(t=console).log.apply(t,["".concat(es(),"[").concat(e,"]:")].concat(r)),this.recorders[e]&&this.recorders[e].push({time:es(),msg:r})}},{key:"prependPokeElement",value:function(e){var t=r(this.makePoke(e),2),n=t[0],a=t[1];for(this.pokes.push(a);this.pokes.length>100;)this.pokes.shift();this.prependListElement(this.page.pokeList,a,n)}},{key:"prependNoteElement",value:function(e,t){var n=r(this.makeNote(e),2),a=n[0],o=n[1];for(this.notes.push(o);this.notes.length>100;)this.notes.shift();var s=this.page.noteList;if(this.prependListElement(s,o,a),t||this.storeNotes(),!(0===this.notes.length||jt.isDisplayed(this.page.noteBox)&&jt.isDisplayed(s))){var i=0,c=this.notes.reduce((function(e,t){return t.acked||i++,!t.acked&&t.severity>e?t.severity:e}),0),l=this.page.noteIndicator;ts(l,c),i?(l.textContent=String(i>99?"".concat(99,"+"):i),jt.show(l)):jt.hide(l)}}},{key:"prependListElement",value:function(e,t,n){for(n.note=t,e.prepend(n);e.children.length>100;)e.removeChild(e.lastChild);this.setNoteTimes(e)}},{key:"makeNote",value:function(e){var t=this.page.noteTmpl.cloneNode(!0);if(e.severity>2){var n=3===e.severity?"good":4===e.severity?"warn":"bad";jt.safeSelector(t,"div.note-indicator").classList.add(n)}return jt.safeSelector(t,"div.note-subject").textContent=e.subject,jt.safeSelector(t,"div.note-details").textContent=e.details,[t,jo({el:t},e)]}},{key:"makePoke",value:function(e){var t=this.page.pokeTmpl.cloneNode(!0),n=new Date(e.stamp);return jt.tmplElement(t,"dateTime").textContent="".concat(n.toLocaleDateString(),", ").concat(n.toLocaleTimeString()),jt.tmplElement(t,"details").textContent="".concat(e.subject,": ").concat(e.details),[t,jo({el:t},e)]}},{key:"loading",value:function(e){var t=this.page.loader.cloneNode(!0);return e.appendChild(t),function(){t.remove()}}},{key:"orders",value:function(e,t){var n=[],r=this.user.exchanges[e].markets[t];return r.orders&&(n=n.concat(r.orders)),r.inflight&&(n=n.concat(r.inflight)),n}},{key:"haveActiveOrders",value:function(e){for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++){var r=n[t];if(r.markets)for(var a=0,o=Object.values(r.markets);a<o.length;a++){var s=o[a];if(s.orders){var i,c=Ho(s.orders);try{for(c.s();!(i=c.n()).done;){var l=i.value;if((l.baseID===e||l.quoteID===e)&&(l.status<Nn||Xn(l)))return!0}}catch(e){c.e(e)}finally{c.f()}}}}return!1}},{key:"order",value:function(e){for(var t=0,n=Object.values(this.user.exchanges);t<n.length;t++){var r=n[t];if(r&&r.markets)for(var a=0,o=Object.values(r.markets);a<o.length;a++){var s=o[a];if(s.orders){var i,c=Ho(s.orders);try{for(c.s();!(i=c.n()).done;){var l=i.value;if(l.id===e)return l}}catch(e){c.e(e)}finally{c.f()}}}}return null}},{key:"canAccelerateOrder",value:function(e){var t;t=e.sell?e.baseID:e.quoteID;var n=this.walletMap[t];if(!(n&&16&n.traits))return!1;if(e.matches)for(var r=0;r<e.matches.length;r++){var a=e.matches[r];if(a.swap&&a.swap.confs&&0===a.swap.confs.count)return!0}return!1}},{key:"unitInfo",value:function(e,t){var n=this.assets[e];if(n)return n.unitInfo;if(!t||!t.assets)throw Error(Rt(He,{assetID:"".concat(e)}));return t.assets[e].unitInfo}},{key:"conventionalRate",value:function(e,t,n,r){var a=[this.unitInfo(e,r),this.unitInfo(t,r)],o=a[1];return n*(a[0].conventional.conversionFactor/o.conventional.conversionFactor)/jn}},{key:"walletDefinition",value:function(e,t){var n=this.assets[e];if(n.token)return n.token.definition;if(!n.info)throw Error("where's the wallet info?");return""===t?n.info.availablewallets[n.info.emptyidx]:n.info.availablewallets.filter((function(e){return e.type===t}))[0]}},{key:"currentWalletDefinition",value:function(e){var t=this.assets[e];return t.token?t.token.definition:this.walletDefinition(e,this.assets[e].wallet.type)}},{key:"fetchBalance",value:(n=o(w().mark((function e(t){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dn("/api/balance",{assetID:t});case 2:if(n=e.sent,this.checkResponse(n)){e.next=5;break}throw new Error("failed to fetch balance for asset ID ".concat(t));case 5:return e.abrupt("return",n.balance);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"checkResponse",value:function(e){return e.requestSuccessful&&e.ok}},{key:"signOut",value:(t=o(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dn("/api/logout");case 2:if(t=e.sent,this.checkResponse(t)){e.next=7;break}return t.code===vn.activeOrdersErr?this.page.logoutErr.textContent=Rt(We):this.page.logoutErr.textContent=t.msg,jt.show(this.page.logoutErr),e.abrupt("return");case 7:nn.removeCookie(nn.authCK),nn.removeCookie(nn.pwKeyCK),nn.removeLocal(nn.notificationsLK),window.location.href="/login";case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Zo=(h(_o={},3,"good"),h(_o,5,"bad"),h(_o,4,"warn"),_o);function $o(e){return e.replace(/^\//,"").split("/")[0].split("?")[0].split("#")[0]}function es(){var e=new Date,t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),r=e.getSeconds().toString().padStart(2,"0"),a=e.getMilliseconds().toString().padStart(3,"0");return"".concat(t,":").concat(n,":").concat(r,".").concat(a)}function ts(e,t){e.classList.remove("bad","warn","good"),e.classList.add(Zo[t])}var ns=new Jo;gn=ns,ns.start()})()})();
//# sourceMappingURL=entry.js.map